var Kp=Object.defineProperty;var Xp=(xt,$t,Ct)=>$t in xt?Kp(xt,$t,{enumerable:!0,configurable:!0,writable:!0,value:Ct}):xt[$t]=Ct;var Qp=(xt,$t)=>()=>($t||xt(($t={exports:{}}).exports,$t),$t.exports);var so=(xt,$t,Ct)=>(Xp(xt,typeof $t!="symbol"?$t+"":$t,Ct),Ct),Su=(xt,$t,Ct)=>{if(!$t.has(xt))throw TypeError("Cannot "+Ct)};var Kn=(xt,$t,Ct)=>(Su(xt,$t,"read from private field"),Ct?Ct.call(xt):$t.get(xt)),Yr=(xt,$t,Ct)=>{if($t.has(xt))throw TypeError("Cannot add the same private member more than once");$t instanceof WeakSet?$t.add(xt):$t.set(xt,Ct)},gs=(xt,$t,Ct,kt)=>(Su(xt,$t,"write to private field"),kt?kt.call(xt,Ct):$t.set(xt,Ct),Ct);var Au=(xt,$t,Ct,kt)=>({set _(Mt){gs(xt,$t,Mt,Ct)},get _(){return Kn(xt,$t,kt)}}),es=(xt,$t,Ct)=>(Su(xt,$t,"access private method"),Ct);var Jp=Qp((exports,module)=>{function _mergeNamespaces(xt,$t){for(var Ct=0;Ct<$t.length;Ct++){const kt=$t[Ct];if(typeof kt!="string"&&!Array.isArray(kt)){for(const Mt in kt)if(Mt!=="default"&&!(Mt in xt)){const Ft=Object.getOwnPropertyDescriptor(kt,Mt);Ft&&Object.defineProperty(xt,Mt,Ft.get?Ft:{enumerable:!0,get:()=>kt[Mt]})}}}return Object.freeze(Object.defineProperty(xt,Symbol.toStringTag,{value:"Module"}))}(function(){const $t=document.createElement("link").relList;if($t&&$t.supports&&$t.supports("modulepreload"))return;for(const Mt of document.querySelectorAll('link[rel="modulepreload"]'))kt(Mt);new MutationObserver(Mt=>{for(const Ft of Mt)if(Ft.type==="childList")for(const jt of Ft.addedNodes)jt.tagName==="LINK"&&jt.rel==="modulepreload"&&kt(jt)}).observe(document,{childList:!0,subtree:!0});function Ct(Mt){const Ft={};return Mt.integrity&&(Ft.integrity=Mt.integrity),Mt.referrerPolicy&&(Ft.referrerPolicy=Mt.referrerPolicy),Mt.crossOrigin==="use-credentials"?Ft.credentials="include":Mt.crossOrigin==="anonymous"?Ft.credentials="omit":Ft.credentials="same-origin",Ft}function kt(Mt){if(Mt.ep)return;Mt.ep=!0;const Ft=Ct(Mt);fetch(Mt.href,Ft)}})();var commonjsGlobal$2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(xt){return xt&&xt.__esModule&&Object.prototype.hasOwnProperty.call(xt,"default")?xt.default:xt}function getAugmentedNamespace(xt){if(xt.__esModule)return xt;var $t=xt.default;if(typeof $t=="function"){var Ct=function kt(){return this instanceof kt?Reflect.construct($t,arguments,this.constructor):$t.apply(this,arguments)};Ct.prototype=$t.prototype}else Ct={};return Object.defineProperty(Ct,"__esModule",{value:!0}),Object.keys(xt).forEach(function(kt){var Mt=Object.getOwnPropertyDescriptor(xt,kt);Object.defineProperty(Ct,kt,Mt.get?Mt:{enumerable:!0,get:function(){return xt[kt]}})}),Ct}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$2=Symbol.for("react.element"),n$3=Symbol.for("react.portal"),p$4=Symbol.for("react.fragment"),q$4=Symbol.for("react.strict_mode"),r$3=Symbol.for("react.profiler"),t$4=Symbol.for("react.provider"),u$3=Symbol.for("react.context"),v$4=Symbol.for("react.forward_ref"),w$3=Symbol.for("react.suspense"),x$6=Symbol.for("react.memo"),y$6=Symbol.for("react.lazy"),z$3=Symbol.iterator;function A$3(xt){return xt===null||typeof xt!="object"?null:(xt=z$3&&xt[z$3]||xt["@@iterator"],typeof xt=="function"?xt:null)}var B$5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$5=Object.assign,D$6={};function E$4(xt,$t,Ct){this.props=xt,this.context=$t,this.refs=D$6,this.updater=Ct||B$5}E$4.prototype.isReactComponent={};E$4.prototype.setState=function(xt,$t){if(typeof xt!="object"&&typeof xt!="function"&&xt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,xt,$t,"setState")};E$4.prototype.forceUpdate=function(xt){this.updater.enqueueForceUpdate(this,xt,"forceUpdate")};function F$3(){}F$3.prototype=E$4.prototype;function G$3(xt,$t,Ct){this.props=xt,this.context=$t,this.refs=D$6,this.updater=Ct||B$5}var H$3=G$3.prototype=new F$3;H$3.constructor=G$3;C$5(H$3,E$4.prototype);H$3.isPureReactComponent=!0;var I$3=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$3={current:null},L$3={key:!0,ref:!0,__self:!0,__source:!0};function M$4(xt,$t,Ct){var kt,Mt={},Ft=null,jt=null;if($t!=null)for(kt in $t.ref!==void 0&&(jt=$t.ref),$t.key!==void 0&&(Ft=""+$t.key),$t)J$1.call($t,kt)&&!L$3.hasOwnProperty(kt)&&(Mt[kt]=$t[kt]);var Bt=arguments.length-2;if(Bt===1)Mt.children=Ct;else if(1<Bt){for(var Vt=Array(Bt),zt=0;zt<Bt;zt++)Vt[zt]=arguments[zt+2];Mt.children=Vt}if(xt&&xt.defaultProps)for(kt in Bt=xt.defaultProps,Bt)Mt[kt]===void 0&&(Mt[kt]=Bt[kt]);return{$$typeof:l$2,type:xt,key:Ft,ref:jt,props:Mt,_owner:K$3.current}}function N$3(xt,$t){return{$$typeof:l$2,type:xt.type,key:$t,ref:xt.ref,props:xt.props,_owner:xt._owner}}function O$2(xt){return typeof xt=="object"&&xt!==null&&xt.$$typeof===l$2}function escape$2(xt){var $t={"=":"=0",":":"=2"};return"$"+xt.replace(/[=:]/g,function(Ct){return $t[Ct]})}var P$3=/\/+/g;function Q$3(xt,$t){return typeof xt=="object"&&xt!==null&&xt.key!=null?escape$2(""+xt.key):$t.toString(36)}function R$2(xt,$t,Ct,kt,Mt){var Ft=typeof xt;(Ft==="undefined"||Ft==="boolean")&&(xt=null);var jt=!1;if(xt===null)jt=!0;else switch(Ft){case"string":case"number":jt=!0;break;case"object":switch(xt.$$typeof){case l$2:case n$3:jt=!0}}if(jt)return jt=xt,Mt=Mt(jt),xt=kt===""?"."+Q$3(jt,0):kt,I$3(Mt)?(Ct="",xt!=null&&(Ct=xt.replace(P$3,"$&/")+"/"),R$2(Mt,$t,Ct,"",function(zt){return zt})):Mt!=null&&(O$2(Mt)&&(Mt=N$3(Mt,Ct+(!Mt.key||jt&&jt.key===Mt.key?"":(""+Mt.key).replace(P$3,"$&/")+"/")+xt)),$t.push(Mt)),1;if(jt=0,kt=kt===""?".":kt+":",I$3(xt))for(var Bt=0;Bt<xt.length;Bt++){Ft=xt[Bt];var Vt=kt+Q$3(Ft,Bt);jt+=R$2(Ft,$t,Ct,Vt,Mt)}else if(Vt=A$3(xt),typeof Vt=="function")for(xt=Vt.call(xt),Bt=0;!(Ft=xt.next()).done;)Ft=Ft.value,Vt=kt+Q$3(Ft,Bt++),jt+=R$2(Ft,$t,Ct,Vt,Mt);else if(Ft==="object")throw $t=String(xt),Error("Objects are not valid as a React child (found: "+($t==="[object Object]"?"object with keys {"+Object.keys(xt).join(", ")+"}":$t)+"). If you meant to render a collection of children, use an array instead.");return jt}function S$4(xt,$t,Ct){if(xt==null)return xt;var kt=[],Mt=0;return R$2(xt,kt,"","",function(Ft){return $t.call(Ct,Ft,Mt++)}),kt}function T$2(xt){if(xt._status===-1){var $t=xt._result;$t=$t(),$t.then(function(Ct){(xt._status===0||xt._status===-1)&&(xt._status=1,xt._result=Ct)},function(Ct){(xt._status===0||xt._status===-1)&&(xt._status=2,xt._result=Ct)}),xt._status===-1&&(xt._status=0,xt._result=$t)}if(xt._status===1)return xt._result.default;throw xt._result}var U$3={current:null},V$2={transition:null},W$3={ReactCurrentDispatcher:U$3,ReactCurrentBatchConfig:V$2,ReactCurrentOwner:K$3};function X$6(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$4,forEach:function(xt,$t,Ct){S$4(xt,function(){$t.apply(this,arguments)},Ct)},count:function(xt){var $t=0;return S$4(xt,function(){$t++}),$t},toArray:function(xt){return S$4(xt,function($t){return $t})||[]},only:function(xt){if(!O$2(xt))throw Error("React.Children.only expected to receive a single React element child.");return xt}};react_production_min.Component=E$4;react_production_min.Fragment=p$4;react_production_min.Profiler=r$3;react_production_min.PureComponent=G$3;react_production_min.StrictMode=q$4;react_production_min.Suspense=w$3;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$3;react_production_min.act=X$6;react_production_min.cloneElement=function(xt,$t,Ct){if(xt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+xt+".");var kt=C$5({},xt.props),Mt=xt.key,Ft=xt.ref,jt=xt._owner;if($t!=null){if($t.ref!==void 0&&(Ft=$t.ref,jt=K$3.current),$t.key!==void 0&&(Mt=""+$t.key),xt.type&&xt.type.defaultProps)var Bt=xt.type.defaultProps;for(Vt in $t)J$1.call($t,Vt)&&!L$3.hasOwnProperty(Vt)&&(kt[Vt]=$t[Vt]===void 0&&Bt!==void 0?Bt[Vt]:$t[Vt])}var Vt=arguments.length-2;if(Vt===1)kt.children=Ct;else if(1<Vt){Bt=Array(Vt);for(var zt=0;zt<Vt;zt++)Bt[zt]=arguments[zt+2];kt.children=Bt}return{$$typeof:l$2,type:xt.type,key:Mt,ref:Ft,props:kt,_owner:jt}};react_production_min.createContext=function(xt){return xt={$$typeof:u$3,_currentValue:xt,_currentValue2:xt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},xt.Provider={$$typeof:t$4,_context:xt},xt.Consumer=xt};react_production_min.createElement=M$4;react_production_min.createFactory=function(xt){var $t=M$4.bind(null,xt);return $t.type=xt,$t};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(xt){return{$$typeof:v$4,render:xt}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(xt){return{$$typeof:y$6,_payload:{_status:-1,_result:xt},_init:T$2}};react_production_min.memo=function(xt,$t){return{$$typeof:x$6,type:xt,compare:$t===void 0?null:$t}};react_production_min.startTransition=function(xt){var $t=V$2.transition;V$2.transition={};try{xt()}finally{V$2.transition=$t}};react_production_min.unstable_act=X$6;react_production_min.useCallback=function(xt,$t){return U$3.current.useCallback(xt,$t)};react_production_min.useContext=function(xt){return U$3.current.useContext(xt)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(xt){return U$3.current.useDeferredValue(xt)};react_production_min.useEffect=function(xt,$t){return U$3.current.useEffect(xt,$t)};react_production_min.useId=function(){return U$3.current.useId()};react_production_min.useImperativeHandle=function(xt,$t,Ct){return U$3.current.useImperativeHandle(xt,$t,Ct)};react_production_min.useInsertionEffect=function(xt,$t){return U$3.current.useInsertionEffect(xt,$t)};react_production_min.useLayoutEffect=function(xt,$t){return U$3.current.useLayoutEffect(xt,$t)};react_production_min.useMemo=function(xt,$t){return U$3.current.useMemo(xt,$t)};react_production_min.useReducer=function(xt,$t,Ct){return U$3.current.useReducer(xt,$t,Ct)};react_production_min.useRef=function(xt){return U$3.current.useRef(xt)};react_production_min.useState=function(xt){return U$3.current.useState(xt)};react_production_min.useSyncExternalStore=function(xt,$t,Ct){return U$3.current.useSyncExternalStore(xt,$t,Ct)};react_production_min.useTransition=function(){return U$3.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React$1=getDefaultExportFromCjs$1(reactExports),ReactOriginal=_mergeNamespaces({__proto__:null,default:React$1},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k$2=Symbol.for("react.element"),l$1=Symbol.for("react.fragment"),m$5=Object.prototype.hasOwnProperty,n$2=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$3={key:!0,ref:!0,__self:!0,__source:!0};function q$3(xt,$t,Ct){var kt,Mt={},Ft=null,jt=null;Ct!==void 0&&(Ft=""+Ct),$t.key!==void 0&&(Ft=""+$t.key),$t.ref!==void 0&&(jt=$t.ref);for(kt in $t)m$5.call($t,kt)&&!p$3.hasOwnProperty(kt)&&(Mt[kt]=$t[kt]);if(xt&&xt.defaultProps)for(kt in $t=xt.defaultProps,$t)Mt[kt]===void 0&&(Mt[kt]=$t[kt]);return{$$typeof:k$2,type:xt,key:Ft,ref:jt,props:Mt,_owner:n$2.current}}reactJsxRuntime_production_min.Fragment=l$1;reactJsxRuntime_production_min.jsx=q$3;reactJsxRuntime_production_min.jsxs=q$3;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(xt){function $t(Rn,Dn){var An=Rn.length;Rn.push(Dn);e:for(;0<An;){var Sn=An-1>>>1,vn=Rn[Sn];if(0<Mt(vn,Dn))Rn[Sn]=Dn,Rn[An]=vn,An=Sn;else break e}}function Ct(Rn){return Rn.length===0?null:Rn[0]}function kt(Rn){if(Rn.length===0)return null;var Dn=Rn[0],An=Rn.pop();if(An!==Dn){Rn[0]=An;e:for(var Sn=0,vn=Rn.length,_n=vn>>>1;Sn<_n;){var Tn=2*(Sn+1)-1,Pn=Rn[Tn],Ln=Tn+1,Vn=Rn[Ln];if(0>Mt(Pn,An))Ln<vn&&0>Mt(Vn,Pn)?(Rn[Sn]=Vn,Rn[Ln]=An,Sn=Ln):(Rn[Sn]=Pn,Rn[Tn]=An,Sn=Tn);else if(Ln<vn&&0>Mt(Vn,An))Rn[Sn]=Vn,Rn[Ln]=An,Sn=Ln;else break e}}return Dn}function Mt(Rn,Dn){var An=Rn.sortIndex-Dn.sortIndex;return An!==0?An:Rn.id-Dn.id}if(typeof performance=="object"&&typeof performance.now=="function"){var Ft=performance;xt.unstable_now=function(){return Ft.now()}}else{var jt=Date,Bt=jt.now();xt.unstable_now=function(){return jt.now()-Bt}}var Vt=[],zt=[],Ht=1,Gt=null,qt=3,Wt=!1,Yt=!1,Kt=!1,Xt=typeof setTimeout=="function"?setTimeout:null,Qt=typeof clearTimeout=="function"?clearTimeout:null,Jt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Zt(Rn){for(var Dn=Ct(zt);Dn!==null;){if(Dn.callback===null)kt(zt);else if(Dn.startTime<=Rn)kt(zt),Dn.sortIndex=Dn.expirationTime,$t(Vt,Dn);else break;Dn=Ct(zt)}}function sn(Rn){if(Kt=!1,Zt(Rn),!Yt)if(Ct(Vt)!==null)Yt=!0,$n(ln);else{var Dn=Ct(zt);Dn!==null&&wn(sn,Dn.startTime-Rn)}}function ln(Rn,Dn){Yt=!1,Kt&&(Kt=!1,Qt(cn),cn=-1),Wt=!0;var An=qt;try{for(Zt(Dn),Gt=Ct(Vt);Gt!==null&&(!(Gt.expirationTime>Dn)||Rn&&!gn());){var Sn=Gt.callback;if(typeof Sn=="function"){Gt.callback=null,qt=Gt.priorityLevel;var vn=Sn(Gt.expirationTime<=Dn);Dn=xt.unstable_now(),typeof vn=="function"?Gt.callback=vn:Gt===Ct(Vt)&&kt(Vt),Zt(Dn)}else kt(Vt);Gt=Ct(Vt)}if(Gt!==null)var _n=!0;else{var Tn=Ct(zt);Tn!==null&&wn(sn,Tn.startTime-Dn),_n=!1}return _n}finally{Gt=null,qt=An,Wt=!1}}var dn=!1,hn=null,cn=-1,pn=5,yn=-1;function gn(){return!(xt.unstable_now()-yn<pn)}function En(){if(hn!==null){var Rn=xt.unstable_now();yn=Rn;var Dn=!0;try{Dn=hn(!0,Rn)}finally{Dn?bn():(dn=!1,hn=null)}}else dn=!1}var bn;if(typeof Jt=="function")bn=function(){Jt(En)};else if(typeof MessageChannel<"u"){var xn=new MessageChannel,Cn=xn.port2;xn.port1.onmessage=En,bn=function(){Cn.postMessage(null)}}else bn=function(){Xt(En,0)};function $n(Rn){hn=Rn,dn||(dn=!0,bn())}function wn(Rn,Dn){cn=Xt(function(){Rn(xt.unstable_now())},Dn)}xt.unstable_IdlePriority=5,xt.unstable_ImmediatePriority=1,xt.unstable_LowPriority=4,xt.unstable_NormalPriority=3,xt.unstable_Profiling=null,xt.unstable_UserBlockingPriority=2,xt.unstable_cancelCallback=function(Rn){Rn.callback=null},xt.unstable_continueExecution=function(){Yt||Wt||(Yt=!0,$n(ln))},xt.unstable_forceFrameRate=function(Rn){0>Rn||125<Rn?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):pn=0<Rn?Math.floor(1e3/Rn):5},xt.unstable_getCurrentPriorityLevel=function(){return qt},xt.unstable_getFirstCallbackNode=function(){return Ct(Vt)},xt.unstable_next=function(Rn){switch(qt){case 1:case 2:case 3:var Dn=3;break;default:Dn=qt}var An=qt;qt=Dn;try{return Rn()}finally{qt=An}},xt.unstable_pauseExecution=function(){},xt.unstable_requestPaint=function(){},xt.unstable_runWithPriority=function(Rn,Dn){switch(Rn){case 1:case 2:case 3:case 4:case 5:break;default:Rn=3}var An=qt;qt=Rn;try{return Dn()}finally{qt=An}},xt.unstable_scheduleCallback=function(Rn,Dn,An){var Sn=xt.unstable_now();switch(typeof An=="object"&&An!==null?(An=An.delay,An=typeof An=="number"&&0<An?Sn+An:Sn):An=Sn,Rn){case 1:var vn=-1;break;case 2:vn=250;break;case 5:vn=1073741823;break;case 4:vn=1e4;break;default:vn=5e3}return vn=An+vn,Rn={id:Ht++,callback:Dn,priorityLevel:Rn,startTime:An,expirationTime:vn,sortIndex:-1},An>Sn?(Rn.sortIndex=An,$t(zt,Rn),Ct(Vt)===null&&Rn===Ct(zt)&&(Kt?(Qt(cn),cn=-1):Kt=!0,wn(sn,An-Sn))):(Rn.sortIndex=vn,$t(Vt,Rn),Yt||Wt||(Yt=!0,$n(ln))),Rn},xt.unstable_shouldYield=gn,xt.unstable_wrapCallback=function(Rn){var Dn=qt;return function(){var An=qt;qt=Dn;try{return Rn.apply(this,arguments)}finally{qt=An}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$2(xt){for(var $t="https://reactjs.org/docs/error-decoder.html?invariant="+xt,Ct=1;Ct<arguments.length;Ct++)$t+="&args[]="+encodeURIComponent(arguments[Ct]);return"Minified React error #"+xt+"; visit "+$t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea$1={};function fa(xt,$t){ha(xt,$t),ha(xt+"Capture",$t)}function ha(xt,$t){for(ea$1[xt]=$t,xt=0;xt<$t.length;xt++)da.add($t[xt])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma$1={};function oa(xt){return ja.call(ma$1,xt)?!0:ja.call(la,xt)?!1:ka.test(xt)?ma$1[xt]=!0:(la[xt]=!0,!1)}function pa$1(xt,$t,Ct,kt){if(Ct!==null&&Ct.type===0)return!1;switch(typeof $t){case"function":case"symbol":return!0;case"boolean":return kt?!1:Ct!==null?!Ct.acceptsBooleans:(xt=xt.toLowerCase().slice(0,5),xt!=="data-"&&xt!=="aria-");default:return!1}}function qa(xt,$t,Ct,kt){if($t===null||typeof $t>"u"||pa$1(xt,$t,Ct,kt))return!0;if(kt)return!1;if(Ct!==null)switch(Ct.type){case 3:return!$t;case 4:return $t===!1;case 5:return isNaN($t);case 6:return isNaN($t)||1>$t}return!1}function v$3(xt,$t,Ct,kt,Mt,Ft,jt){this.acceptsBooleans=$t===2||$t===3||$t===4,this.attributeName=kt,this.attributeNamespace=Mt,this.mustUseProperty=Ct,this.propertyName=xt,this.type=$t,this.sanitizeURL=Ft,this.removeEmptyString=jt}var z$2={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(xt){z$2[xt]=new v$3(xt,0,!1,xt,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(xt){var $t=xt[0];z$2[$t]=new v$3($t,1,!1,xt[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(xt){z$2[xt]=new v$3(xt,2,!1,xt.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(xt){z$2[xt]=new v$3(xt,2,!1,xt,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(xt){z$2[xt]=new v$3(xt,3,!1,xt.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(xt){z$2[xt]=new v$3(xt,3,!0,xt,null,!1,!1)});["capture","download"].forEach(function(xt){z$2[xt]=new v$3(xt,4,!1,xt,null,!1,!1)});["cols","rows","size","span"].forEach(function(xt){z$2[xt]=new v$3(xt,6,!1,xt,null,!1,!1)});["rowSpan","start"].forEach(function(xt){z$2[xt]=new v$3(xt,5,!1,xt.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa$1(xt){return xt[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(xt){var $t=xt.replace(ra,sa$1);z$2[$t]=new v$3($t,1,!1,xt,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(xt){var $t=xt.replace(ra,sa$1);z$2[$t]=new v$3($t,1,!1,xt,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(xt){var $t=xt.replace(ra,sa$1);z$2[$t]=new v$3($t,1,!1,xt,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(xt){z$2[xt]=new v$3(xt,1,!1,xt.toLowerCase(),null,!1,!1)});z$2.xlinkHref=new v$3("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(xt){z$2[xt]=new v$3(xt,1,!1,xt.toLowerCase(),null,!0,!0)});function ta(xt,$t,Ct,kt){var Mt=z$2.hasOwnProperty($t)?z$2[$t]:null;(Mt!==null?Mt.type!==0:kt||!(2<$t.length)||$t[0]!=="o"&&$t[0]!=="O"||$t[1]!=="n"&&$t[1]!=="N")&&(qa($t,Ct,Mt,kt)&&(Ct=null),kt||Mt===null?oa($t)&&(Ct===null?xt.removeAttribute($t):xt.setAttribute($t,""+Ct)):Mt.mustUseProperty?xt[Mt.propertyName]=Ct===null?Mt.type===3?!1:"":Ct:($t=Mt.attributeName,kt=Mt.attributeNamespace,Ct===null?xt.removeAttribute($t):(Mt=Mt.type,Ct=Mt===3||Mt===4&&Ct===!0?"":""+Ct,kt?xt.setAttributeNS(kt,$t,Ct):xt.setAttribute($t,Ct))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(xt){return xt===null||typeof xt!="object"?null:(xt=Ja&&xt[Ja]||xt["@@iterator"],typeof xt=="function"?xt:null)}var A$2=Object.assign,La;function Ma(xt){if(La===void 0)try{throw Error()}catch(Ct){var $t=Ct.stack.trim().match(/\n( *(at )?)/);La=$t&&$t[1]||""}return`
`+La+xt}var Na=!1;function Oa(xt,$t){if(!xt||Na)return"";Na=!0;var Ct=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if($t)if($t=function(){throw Error()},Object.defineProperty($t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct($t,[])}catch(zt){var kt=zt}Reflect.construct(xt,[],$t)}else{try{$t.call()}catch(zt){kt=zt}xt.call($t.prototype)}else{try{throw Error()}catch(zt){kt=zt}xt()}}catch(zt){if(zt&&kt&&typeof zt.stack=="string"){for(var Mt=zt.stack.split(`
`),Ft=kt.stack.split(`
`),jt=Mt.length-1,Bt=Ft.length-1;1<=jt&&0<=Bt&&Mt[jt]!==Ft[Bt];)Bt--;for(;1<=jt&&0<=Bt;jt--,Bt--)if(Mt[jt]!==Ft[Bt]){if(jt!==1||Bt!==1)do if(jt--,Bt--,0>Bt||Mt[jt]!==Ft[Bt]){var Vt=`
`+Mt[jt].replace(" at new "," at ");return xt.displayName&&Vt.includes("<anonymous>")&&(Vt=Vt.replace("<anonymous>",xt.displayName)),Vt}while(1<=jt&&0<=Bt);break}}}finally{Na=!1,Error.prepareStackTrace=Ct}return(xt=xt?xt.displayName||xt.name:"")?Ma(xt):""}function Pa(xt){switch(xt.tag){case 5:return Ma(xt.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return xt=Oa(xt.type,!1),xt;case 11:return xt=Oa(xt.type.render,!1),xt;case 1:return xt=Oa(xt.type,!0),xt;default:return""}}function Qa(xt){if(xt==null)return null;if(typeof xt=="function")return xt.displayName||xt.name||null;if(typeof xt=="string")return xt;switch(xt){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof xt=="object")switch(xt.$$typeof){case Ca:return(xt.displayName||"Context")+".Consumer";case Ba:return(xt._context.displayName||"Context")+".Provider";case Da:var $t=xt.render;return xt=xt.displayName,xt||(xt=$t.displayName||$t.name||"",xt=xt!==""?"ForwardRef("+xt+")":"ForwardRef"),xt;case Ga:return $t=xt.displayName||null,$t!==null?$t:Qa(xt.type)||"Memo";case Ha:$t=xt._payload,xt=xt._init;try{return Qa(xt($t))}catch{}}return null}function Ra(xt){var $t=xt.type;switch(xt.tag){case 24:return"Cache";case 9:return($t.displayName||"Context")+".Consumer";case 10:return($t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return xt=$t.render,xt=xt.displayName||xt.name||"",$t.displayName||(xt!==""?"ForwardRef("+xt+")":"ForwardRef");case 7:return"Fragment";case 5:return $t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa($t);case 8:return $t===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof $t=="function")return $t.displayName||$t.name||null;if(typeof $t=="string")return $t}return null}function Sa(xt){switch(typeof xt){case"boolean":case"number":case"string":case"undefined":return xt;case"object":return xt;default:return""}}function Ta(xt){var $t=xt.type;return(xt=xt.nodeName)&&xt.toLowerCase()==="input"&&($t==="checkbox"||$t==="radio")}function Ua(xt){var $t=Ta(xt)?"checked":"value",Ct=Object.getOwnPropertyDescriptor(xt.constructor.prototype,$t),kt=""+xt[$t];if(!xt.hasOwnProperty($t)&&typeof Ct<"u"&&typeof Ct.get=="function"&&typeof Ct.set=="function"){var Mt=Ct.get,Ft=Ct.set;return Object.defineProperty(xt,$t,{configurable:!0,get:function(){return Mt.call(this)},set:function(jt){kt=""+jt,Ft.call(this,jt)}}),Object.defineProperty(xt,$t,{enumerable:Ct.enumerable}),{getValue:function(){return kt},setValue:function(jt){kt=""+jt},stopTracking:function(){xt._valueTracker=null,delete xt[$t]}}}}function Va(xt){xt._valueTracker||(xt._valueTracker=Ua(xt))}function Wa(xt){if(!xt)return!1;var $t=xt._valueTracker;if(!$t)return!0;var Ct=$t.getValue(),kt="";return xt&&(kt=Ta(xt)?xt.checked?"true":"false":xt.value),xt=kt,xt!==Ct?($t.setValue(xt),!0):!1}function Xa(xt){if(xt=xt||(typeof document<"u"?document:void 0),typeof xt>"u")return null;try{return xt.activeElement||xt.body}catch{return xt.body}}function Ya(xt,$t){var Ct=$t.checked;return A$2({},$t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:Ct??xt._wrapperState.initialChecked})}function Za(xt,$t){var Ct=$t.defaultValue==null?"":$t.defaultValue,kt=$t.checked!=null?$t.checked:$t.defaultChecked;Ct=Sa($t.value!=null?$t.value:Ct),xt._wrapperState={initialChecked:kt,initialValue:Ct,controlled:$t.type==="checkbox"||$t.type==="radio"?$t.checked!=null:$t.value!=null}}function ab(xt,$t){$t=$t.checked,$t!=null&&ta(xt,"checked",$t,!1)}function bb(xt,$t){ab(xt,$t);var Ct=Sa($t.value),kt=$t.type;if(Ct!=null)kt==="number"?(Ct===0&&xt.value===""||xt.value!=Ct)&&(xt.value=""+Ct):xt.value!==""+Ct&&(xt.value=""+Ct);else if(kt==="submit"||kt==="reset"){xt.removeAttribute("value");return}$t.hasOwnProperty("value")?cb(xt,$t.type,Ct):$t.hasOwnProperty("defaultValue")&&cb(xt,$t.type,Sa($t.defaultValue)),$t.checked==null&&$t.defaultChecked!=null&&(xt.defaultChecked=!!$t.defaultChecked)}function db(xt,$t,Ct){if($t.hasOwnProperty("value")||$t.hasOwnProperty("defaultValue")){var kt=$t.type;if(!(kt!=="submit"&&kt!=="reset"||$t.value!==void 0&&$t.value!==null))return;$t=""+xt._wrapperState.initialValue,Ct||$t===xt.value||(xt.value=$t),xt.defaultValue=$t}Ct=xt.name,Ct!==""&&(xt.name=""),xt.defaultChecked=!!xt._wrapperState.initialChecked,Ct!==""&&(xt.name=Ct)}function cb(xt,$t,Ct){($t!=="number"||Xa(xt.ownerDocument)!==xt)&&(Ct==null?xt.defaultValue=""+xt._wrapperState.initialValue:xt.defaultValue!==""+Ct&&(xt.defaultValue=""+Ct))}var eb=Array.isArray;function fb(xt,$t,Ct,kt){if(xt=xt.options,$t){$t={};for(var Mt=0;Mt<Ct.length;Mt++)$t["$"+Ct[Mt]]=!0;for(Ct=0;Ct<xt.length;Ct++)Mt=$t.hasOwnProperty("$"+xt[Ct].value),xt[Ct].selected!==Mt&&(xt[Ct].selected=Mt),Mt&&kt&&(xt[Ct].defaultSelected=!0)}else{for(Ct=""+Sa(Ct),$t=null,Mt=0;Mt<xt.length;Mt++){if(xt[Mt].value===Ct){xt[Mt].selected=!0,kt&&(xt[Mt].defaultSelected=!0);return}$t!==null||xt[Mt].disabled||($t=xt[Mt])}$t!==null&&($t.selected=!0)}}function gb(xt,$t){if($t.dangerouslySetInnerHTML!=null)throw Error(p$2(91));return A$2({},$t,{value:void 0,defaultValue:void 0,children:""+xt._wrapperState.initialValue})}function hb(xt,$t){var Ct=$t.value;if(Ct==null){if(Ct=$t.children,$t=$t.defaultValue,Ct!=null){if($t!=null)throw Error(p$2(92));if(eb(Ct)){if(1<Ct.length)throw Error(p$2(93));Ct=Ct[0]}$t=Ct}$t==null&&($t=""),Ct=$t}xt._wrapperState={initialValue:Sa(Ct)}}function ib(xt,$t){var Ct=Sa($t.value),kt=Sa($t.defaultValue);Ct!=null&&(Ct=""+Ct,Ct!==xt.value&&(xt.value=Ct),$t.defaultValue==null&&xt.defaultValue!==Ct&&(xt.defaultValue=Ct)),kt!=null&&(xt.defaultValue=""+kt)}function jb(xt){var $t=xt.textContent;$t===xt._wrapperState.initialValue&&$t!==""&&$t!==null&&(xt.value=$t)}function kb(xt){switch(xt){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(xt,$t){return xt==null||xt==="http://www.w3.org/1999/xhtml"?kb($t):xt==="http://www.w3.org/2000/svg"&&$t==="foreignObject"?"http://www.w3.org/1999/xhtml":xt}var mb$1,nb=function(xt){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function($t,Ct,kt,Mt){MSApp.execUnsafeLocalFunction(function(){return xt($t,Ct,kt,Mt)})}:xt}(function(xt,$t){if(xt.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in xt)xt.innerHTML=$t;else{for(mb$1=mb$1||document.createElement("div"),mb$1.innerHTML="<svg>"+$t.valueOf().toString()+"</svg>",$t=mb$1.firstChild;xt.firstChild;)xt.removeChild(xt.firstChild);for(;$t.firstChild;)xt.appendChild($t.firstChild)}});function ob(xt,$t){if($t){var Ct=xt.firstChild;if(Ct&&Ct===xt.lastChild&&Ct.nodeType===3){Ct.nodeValue=$t;return}}xt.textContent=$t}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(xt){qb.forEach(function($t){$t=$t+xt.charAt(0).toUpperCase()+xt.substring(1),pb[$t]=pb[xt]})});function rb(xt,$t,Ct){return $t==null||typeof $t=="boolean"||$t===""?"":Ct||typeof $t!="number"||$t===0||pb.hasOwnProperty(xt)&&pb[xt]?(""+$t).trim():$t+"px"}function sb(xt,$t){xt=xt.style;for(var Ct in $t)if($t.hasOwnProperty(Ct)){var kt=Ct.indexOf("--")===0,Mt=rb(Ct,$t[Ct],kt);Ct==="float"&&(Ct="cssFloat"),kt?xt.setProperty(Ct,Mt):xt[Ct]=Mt}}var tb=A$2({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(xt,$t){if($t){if(tb[xt]&&($t.children!=null||$t.dangerouslySetInnerHTML!=null))throw Error(p$2(137,xt));if($t.dangerouslySetInnerHTML!=null){if($t.children!=null)throw Error(p$2(60));if(typeof $t.dangerouslySetInnerHTML!="object"||!("__html"in $t.dangerouslySetInnerHTML))throw Error(p$2(61))}if($t.style!=null&&typeof $t.style!="object")throw Error(p$2(62))}}function vb(xt,$t){if(xt.indexOf("-")===-1)return typeof $t.is=="string";switch(xt){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(xt){return xt=xt.target||xt.srcElement||window,xt.correspondingUseElement&&(xt=xt.correspondingUseElement),xt.nodeType===3?xt.parentNode:xt}var yb=null,zb=null,Ab=null;function Bb(xt){if(xt=Cb(xt)){if(typeof yb!="function")throw Error(p$2(280));var $t=xt.stateNode;$t&&($t=Db($t),yb(xt.stateNode,xt.type,$t))}}function Eb(xt){zb?Ab?Ab.push(xt):Ab=[xt]:zb=xt}function Fb(){if(zb){var xt=zb,$t=Ab;if(Ab=zb=null,Bb(xt),$t)for(xt=0;xt<$t.length;xt++)Bb($t[xt])}}function Gb(xt,$t){return xt($t)}function Hb(){}var Ib=!1;function Jb(xt,$t,Ct){if(Ib)return xt($t,Ct);Ib=!0;try{return Gb(xt,$t,Ct)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(xt,$t){var Ct=xt.stateNode;if(Ct===null)return null;var kt=Db(Ct);if(kt===null)return null;Ct=kt[$t];e:switch($t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(kt=!kt.disabled)||(xt=xt.type,kt=!(xt==="button"||xt==="input"||xt==="select"||xt==="textarea")),xt=!kt;break e;default:xt=!1}if(xt)return null;if(Ct&&typeof Ct!="function")throw Error(p$2(231,$t,typeof Ct));return Ct}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt){var zt=Array.prototype.slice.call(arguments,3);try{$t.apply(Ct,zt)}catch(Ht){this.onError(Ht)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(xt){Ob=!0,Pb=xt}};function Tb(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt){if(Tb.apply(this,arguments),Ob){if(Ob){var zt=Pb;Ob=!1,Pb=null}else throw Error(p$2(198));Qb||(Qb=!0,Rb=zt)}}function Vb(xt){var $t=xt,Ct=xt;if(xt.alternate)for(;$t.return;)$t=$t.return;else{xt=$t;do $t=xt,$t.flags&4098&&(Ct=$t.return),xt=$t.return;while(xt)}return $t.tag===3?Ct:null}function Wb(xt){if(xt.tag===13){var $t=xt.memoizedState;if($t===null&&(xt=xt.alternate,xt!==null&&($t=xt.memoizedState)),$t!==null)return $t.dehydrated}return null}function Xb(xt){if(Vb(xt)!==xt)throw Error(p$2(188))}function Yb(xt){var $t=xt.alternate;if(!$t){if($t=Vb(xt),$t===null)throw Error(p$2(188));return $t!==xt?null:xt}for(var Ct=xt,kt=$t;;){var Mt=Ct.return;if(Mt===null)break;var Ft=Mt.alternate;if(Ft===null){if(kt=Mt.return,kt!==null){Ct=kt;continue}break}if(Mt.child===Ft.child){for(Ft=Mt.child;Ft;){if(Ft===Ct)return Xb(Mt),xt;if(Ft===kt)return Xb(Mt),$t;Ft=Ft.sibling}throw Error(p$2(188))}if(Ct.return!==kt.return)Ct=Mt,kt=Ft;else{for(var jt=!1,Bt=Mt.child;Bt;){if(Bt===Ct){jt=!0,Ct=Mt,kt=Ft;break}if(Bt===kt){jt=!0,kt=Mt,Ct=Ft;break}Bt=Bt.sibling}if(!jt){for(Bt=Ft.child;Bt;){if(Bt===Ct){jt=!0,Ct=Ft,kt=Mt;break}if(Bt===kt){jt=!0,kt=Ft,Ct=Mt;break}Bt=Bt.sibling}if(!jt)throw Error(p$2(189))}}if(Ct.alternate!==kt)throw Error(p$2(190))}if(Ct.tag!==3)throw Error(p$2(188));return Ct.stateNode.current===Ct?xt:$t}function Zb(xt){return xt=Yb(xt),xt!==null?$b(xt):null}function $b(xt){if(xt.tag===5||xt.tag===6)return xt;for(xt=xt.child;xt!==null;){var $t=$b(xt);if($t!==null)return $t;xt=xt.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B$4=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc$1(xt){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,xt,void 0,(xt.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(xt){return xt>>>=0,xt===0?32:31-(pc(xt)/qc|0)|0}var rc=64,sc=4194304;function tc(xt){switch(xt&-xt){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return xt&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return xt&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return xt}}function uc(xt,$t){var Ct=xt.pendingLanes;if(Ct===0)return 0;var kt=0,Mt=xt.suspendedLanes,Ft=xt.pingedLanes,jt=Ct&268435455;if(jt!==0){var Bt=jt&~Mt;Bt!==0?kt=tc(Bt):(Ft&=jt,Ft!==0&&(kt=tc(Ft)))}else jt=Ct&~Mt,jt!==0?kt=tc(jt):Ft!==0&&(kt=tc(Ft));if(kt===0)return 0;if($t!==0&&$t!==kt&&!($t&Mt)&&(Mt=kt&-kt,Ft=$t&-$t,Mt>=Ft||Mt===16&&(Ft&4194240)!==0))return $t;if(kt&4&&(kt|=Ct&16),$t=xt.entangledLanes,$t!==0)for(xt=xt.entanglements,$t&=kt;0<$t;)Ct=31-oc($t),Mt=1<<Ct,kt|=xt[Ct],$t&=~Mt;return kt}function vc(xt,$t){switch(xt){case 1:case 2:case 4:return $t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return $t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(xt,$t){for(var Ct=xt.suspendedLanes,kt=xt.pingedLanes,Mt=xt.expirationTimes,Ft=xt.pendingLanes;0<Ft;){var jt=31-oc(Ft),Bt=1<<jt,Vt=Mt[jt];Vt===-1?(!(Bt&Ct)||Bt&kt)&&(Mt[jt]=vc(Bt,$t)):Vt<=$t&&(xt.expiredLanes|=Bt),Ft&=~Bt}}function xc(xt){return xt=xt.pendingLanes&-1073741825,xt!==0?xt:xt&1073741824?1073741824:0}function yc(){var xt=rc;return rc<<=1,!(rc&4194240)&&(rc=64),xt}function zc(xt){for(var $t=[],Ct=0;31>Ct;Ct++)$t.push(xt);return $t}function Ac(xt,$t,Ct){xt.pendingLanes|=$t,$t!==536870912&&(xt.suspendedLanes=0,xt.pingedLanes=0),xt=xt.eventTimes,$t=31-oc($t),xt[$t]=Ct}function Bc(xt,$t){var Ct=xt.pendingLanes&~$t;xt.pendingLanes=$t,xt.suspendedLanes=0,xt.pingedLanes=0,xt.expiredLanes&=$t,xt.mutableReadLanes&=$t,xt.entangledLanes&=$t,$t=xt.entanglements;var kt=xt.eventTimes;for(xt=xt.expirationTimes;0<Ct;){var Mt=31-oc(Ct),Ft=1<<Mt;$t[Mt]=0,kt[Mt]=-1,xt[Mt]=-1,Ct&=~Ft}}function Cc(xt,$t){var Ct=xt.entangledLanes|=$t;for(xt=xt.entanglements;Ct;){var kt=31-oc(Ct),Mt=1<<kt;Mt&$t|xt[kt]&$t&&(xt[kt]|=$t),Ct&=~Mt}}var C$4=0;function Dc(xt){return xt&=-xt,1<xt?4<xt?xt&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(xt,$t){switch(xt){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete($t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete($t.pointerId)}}function Tc(xt,$t,Ct,kt,Mt,Ft){return xt===null||xt.nativeEvent!==Ft?(xt={blockedOn:$t,domEventName:Ct,eventSystemFlags:kt,nativeEvent:Ft,targetContainers:[Mt]},$t!==null&&($t=Cb($t),$t!==null&&Fc($t)),xt):(xt.eventSystemFlags|=kt,$t=xt.targetContainers,Mt!==null&&$t.indexOf(Mt)===-1&&$t.push(Mt),xt)}function Uc(xt,$t,Ct,kt,Mt){switch($t){case"focusin":return Lc=Tc(Lc,xt,$t,Ct,kt,Mt),!0;case"dragenter":return Mc=Tc(Mc,xt,$t,Ct,kt,Mt),!0;case"mouseover":return Nc=Tc(Nc,xt,$t,Ct,kt,Mt),!0;case"pointerover":var Ft=Mt.pointerId;return Oc.set(Ft,Tc(Oc.get(Ft)||null,xt,$t,Ct,kt,Mt)),!0;case"gotpointercapture":return Ft=Mt.pointerId,Pc.set(Ft,Tc(Pc.get(Ft)||null,xt,$t,Ct,kt,Mt)),!0}return!1}function Vc(xt){var $t=Wc(xt.target);if($t!==null){var Ct=Vb($t);if(Ct!==null){if($t=Ct.tag,$t===13){if($t=Wb(Ct),$t!==null){xt.blockedOn=$t,Ic(xt.priority,function(){Gc(Ct)});return}}else if($t===3&&Ct.stateNode.current.memoizedState.isDehydrated){xt.blockedOn=Ct.tag===3?Ct.stateNode.containerInfo:null;return}}}xt.blockedOn=null}function Xc(xt){if(xt.blockedOn!==null)return!1;for(var $t=xt.targetContainers;0<$t.length;){var Ct=Yc(xt.domEventName,xt.eventSystemFlags,$t[0],xt.nativeEvent);if(Ct===null){Ct=xt.nativeEvent;var kt=new Ct.constructor(Ct.type,Ct);wb=kt,Ct.target.dispatchEvent(kt),wb=null}else return $t=Cb(Ct),$t!==null&&Fc($t),xt.blockedOn=Ct,!1;$t.shift()}return!0}function Zc(xt,$t,Ct){Xc(xt)&&Ct.delete($t)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(xt,$t){xt.blockedOn===$t&&(xt.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(xt){function $t(Mt){return ad(Mt,xt)}if(0<Kc.length){ad(Kc[0],xt);for(var Ct=1;Ct<Kc.length;Ct++){var kt=Kc[Ct];kt.blockedOn===xt&&(kt.blockedOn=null)}}for(Lc!==null&&ad(Lc,xt),Mc!==null&&ad(Mc,xt),Nc!==null&&ad(Nc,xt),Oc.forEach($t),Pc.forEach($t),Ct=0;Ct<Qc.length;Ct++)kt=Qc[Ct],kt.blockedOn===xt&&(kt.blockedOn=null);for(;0<Qc.length&&(Ct=Qc[0],Ct.blockedOn===null);)Vc(Ct),Ct.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(xt,$t,Ct,kt){var Mt=C$4,Ft=cd.transition;cd.transition=null;try{C$4=1,fd(xt,$t,Ct,kt)}finally{C$4=Mt,cd.transition=Ft}}function gd(xt,$t,Ct,kt){var Mt=C$4,Ft=cd.transition;cd.transition=null;try{C$4=4,fd(xt,$t,Ct,kt)}finally{C$4=Mt,cd.transition=Ft}}function fd(xt,$t,Ct,kt){if(dd){var Mt=Yc(xt,$t,Ct,kt);if(Mt===null)hd(xt,$t,kt,id$3,Ct),Sc(xt,kt);else if(Uc(Mt,xt,$t,Ct,kt))kt.stopPropagation();else if(Sc(xt,kt),$t&4&&-1<Rc.indexOf(xt)){for(;Mt!==null;){var Ft=Cb(Mt);if(Ft!==null&&Ec(Ft),Ft=Yc(xt,$t,Ct,kt),Ft===null&&hd(xt,$t,kt,id$3,Ct),Ft===Mt)break;Mt=Ft}Mt!==null&&kt.stopPropagation()}else hd(xt,$t,kt,null,Ct)}}var id$3=null;function Yc(xt,$t,Ct,kt){if(id$3=null,xt=xb(kt),xt=Wc(xt),xt!==null)if($t=Vb(xt),$t===null)xt=null;else if(Ct=$t.tag,Ct===13){if(xt=Wb($t),xt!==null)return xt;xt=null}else if(Ct===3){if($t.stateNode.current.memoizedState.isDehydrated)return $t.tag===3?$t.stateNode.containerInfo:null;xt=null}else $t!==xt&&(xt=null);return id$3=xt,null}function jd(xt){switch(xt){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md$1=null;function nd(){if(md$1)return md$1;var xt,$t=ld,Ct=$t.length,kt,Mt="value"in kd?kd.value:kd.textContent,Ft=Mt.length;for(xt=0;xt<Ct&&$t[xt]===Mt[xt];xt++);var jt=Ct-xt;for(kt=1;kt<=jt&&$t[Ct-kt]===Mt[Ft-kt];kt++);return md$1=Mt.slice(xt,1<kt?1-kt:void 0)}function od(xt){var $t=xt.keyCode;return"charCode"in xt?(xt=xt.charCode,xt===0&&$t===13&&(xt=13)):xt=$t,xt===10&&(xt=13),32<=xt||xt===13?xt:0}function pd(){return!0}function qd(){return!1}function rd(xt){function $t(Ct,kt,Mt,Ft,jt){this._reactName=Ct,this._targetInst=Mt,this.type=kt,this.nativeEvent=Ft,this.target=jt,this.currentTarget=null;for(var Bt in xt)xt.hasOwnProperty(Bt)&&(Ct=xt[Bt],this[Bt]=Ct?Ct(Ft):Ft[Bt]);return this.isDefaultPrevented=(Ft.defaultPrevented!=null?Ft.defaultPrevented:Ft.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$2($t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var Ct=this.nativeEvent;Ct&&(Ct.preventDefault?Ct.preventDefault():typeof Ct.returnValue!="unknown"&&(Ct.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var Ct=this.nativeEvent;Ct&&(Ct.stopPropagation?Ct.stopPropagation():typeof Ct.cancelBubble!="unknown"&&(Ct.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),$t}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(xt){return xt.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$2({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$2({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(xt){return xt.relatedTarget===void 0?xt.fromElement===xt.srcElement?xt.toElement:xt.fromElement:xt.relatedTarget},movementX:function(xt){return"movementX"in xt?xt.movementX:(xt!==yd&&(yd&&xt.type==="mousemove"?(wd=xt.screenX-yd.screenX,xd=xt.screenY-yd.screenY):xd=wd=0,yd=xt),wd)},movementY:function(xt){return"movementY"in xt?xt.movementY:xd}}),Bd=rd(Ad),Cd=A$2({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$2({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$2({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$2({},sd,{clipboardData:function(xt){return"clipboardData"in xt?xt.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$2({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(xt){var $t=this.nativeEvent;return $t.getModifierState?$t.getModifierState(xt):(xt=Od[xt])?!!$t[xt]:!1}function zd(){return Pd}var Qd=A$2({},ud,{key:function(xt){if(xt.key){var $t=Md[xt.key]||xt.key;if($t!=="Unidentified")return $t}return xt.type==="keypress"?(xt=od(xt),xt===13?"Enter":String.fromCharCode(xt)):xt.type==="keydown"||xt.type==="keyup"?Nd[xt.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(xt){return xt.type==="keypress"?od(xt):0},keyCode:function(xt){return xt.type==="keydown"||xt.type==="keyup"?xt.keyCode:0},which:function(xt){return xt.type==="keypress"?od(xt):xt.type==="keydown"||xt.type==="keyup"?xt.keyCode:0}}),Rd=rd(Qd),Sd=A$2({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$2({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$2({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$2({},Ad,{deltaX:function(xt){return"deltaX"in xt?xt.deltaX:"wheelDeltaX"in xt?-xt.wheelDeltaX:0},deltaY:function(xt){return"deltaY"in xt?xt.deltaY:"wheelDeltaY"in xt?-xt.wheelDeltaY:"wheelDelta"in xt?-xt.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae$2=ia&&"CompositionEvent"in window,be$1=null;ia&&"documentMode"in document&&(be$1=document.documentMode);var ce$2=ia&&"TextEvent"in window&&!be$1,de$1=ia&&(!ae$2||be$1&&8<be$1&&11>=be$1),ee=" ",fe$2=!1;function ge$2(xt,$t){switch(xt){case"keyup":return $d.indexOf($t.keyCode)!==-1;case"keydown":return $t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$1(xt){return xt=xt.detail,typeof xt=="object"&&"data"in xt?xt.data:null}var ie$1=!1;function je$1(xt,$t){switch(xt){case"compositionend":return he$1($t);case"keypress":return $t.which!==32?null:(fe$2=!0,ee);case"textInput":return xt=$t.data,xt===ee&&fe$2?null:xt;default:return null}}function ke$1(xt,$t){if(ie$1)return xt==="compositionend"||!ae$2&&ge$2(xt,$t)?(xt=nd(),md$1=ld=kd=null,ie$1=!1,xt):null;switch(xt){case"paste":return null;case"keypress":if(!($t.ctrlKey||$t.altKey||$t.metaKey)||$t.ctrlKey&&$t.altKey){if($t.char&&1<$t.char.length)return $t.char;if($t.which)return String.fromCharCode($t.which)}return null;case"compositionend":return de$1&&$t.locale!=="ko"?null:$t.data;default:return null}}var le$2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me$2(xt){var $t=xt&&xt.nodeName&&xt.nodeName.toLowerCase();return $t==="input"?!!le$2[xt.type]:$t==="textarea"}function ne$2(xt,$t,Ct,kt){Eb(kt),$t=oe$2($t,"onChange"),0<$t.length&&(Ct=new td("onChange","change",null,Ct,kt),xt.push({event:Ct,listeners:$t}))}var pe$2=null,qe$1=null;function re$6(xt){se$2(xt,0)}function te$1(xt){var $t=ue$2(xt);if(Wa($t))return xt}function ve$1(xt,$t){if(xt==="change")return $t}var we$1=!1;if(ia){var xe$1;if(ia){var ye$2="oninput"in document;if(!ye$2){var ze$1=document.createElement("div");ze$1.setAttribute("oninput","return;"),ye$2=typeof ze$1.oninput=="function"}xe$1=ye$2}else xe$1=!1;we$1=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae$1(){pe$2&&(pe$2.detachEvent("onpropertychange",Be),qe$1=pe$2=null)}function Be(xt){if(xt.propertyName==="value"&&te$1(qe$1)){var $t=[];ne$2($t,qe$1,xt,xb(xt)),Jb(re$6,$t)}}function Ce$1(xt,$t,Ct){xt==="focusin"?(Ae$1(),pe$2=$t,qe$1=Ct,pe$2.attachEvent("onpropertychange",Be)):xt==="focusout"&&Ae$1()}function De$1(xt){if(xt==="selectionchange"||xt==="keyup"||xt==="keydown")return te$1(qe$1)}function Ee$2(xt,$t){if(xt==="click")return te$1($t)}function Fe$1(xt,$t){if(xt==="input"||xt==="change")return te$1($t)}function Ge$1(xt,$t){return xt===$t&&(xt!==0||1/xt===1/$t)||xt!==xt&&$t!==$t}var He=typeof Object.is=="function"?Object.is:Ge$1;function Ie$2(xt,$t){if(He(xt,$t))return!0;if(typeof xt!="object"||xt===null||typeof $t!="object"||$t===null)return!1;var Ct=Object.keys(xt),kt=Object.keys($t);if(Ct.length!==kt.length)return!1;for(kt=0;kt<Ct.length;kt++){var Mt=Ct[kt];if(!ja.call($t,Mt)||!He(xt[Mt],$t[Mt]))return!1}return!0}function Je$1(xt){for(;xt&&xt.firstChild;)xt=xt.firstChild;return xt}function Ke$1(xt,$t){var Ct=Je$1(xt);xt=0;for(var kt;Ct;){if(Ct.nodeType===3){if(kt=xt+Ct.textContent.length,xt<=$t&&kt>=$t)return{node:Ct,offset:$t-xt};xt=kt}e:{for(;Ct;){if(Ct.nextSibling){Ct=Ct.nextSibling;break e}Ct=Ct.parentNode}Ct=void 0}Ct=Je$1(Ct)}}function Le$1(xt,$t){return xt&&$t?xt===$t?!0:xt&&xt.nodeType===3?!1:$t&&$t.nodeType===3?Le$1(xt,$t.parentNode):"contains"in xt?xt.contains($t):xt.compareDocumentPosition?!!(xt.compareDocumentPosition($t)&16):!1:!1}function Me$1(){for(var xt=window,$t=Xa();$t instanceof xt.HTMLIFrameElement;){try{var Ct=typeof $t.contentWindow.location.href=="string"}catch{Ct=!1}if(Ct)xt=$t.contentWindow;else break;$t=Xa(xt.document)}return $t}function Ne$1(xt){var $t=xt&&xt.nodeName&&xt.nodeName.toLowerCase();return $t&&($t==="input"&&(xt.type==="text"||xt.type==="search"||xt.type==="tel"||xt.type==="url"||xt.type==="password")||$t==="textarea"||xt.contentEditable==="true")}function Oe$1(xt){var $t=Me$1(),Ct=xt.focusedElem,kt=xt.selectionRange;if($t!==Ct&&Ct&&Ct.ownerDocument&&Le$1(Ct.ownerDocument.documentElement,Ct)){if(kt!==null&&Ne$1(Ct)){if($t=kt.start,xt=kt.end,xt===void 0&&(xt=$t),"selectionStart"in Ct)Ct.selectionStart=$t,Ct.selectionEnd=Math.min(xt,Ct.value.length);else if(xt=($t=Ct.ownerDocument||document)&&$t.defaultView||window,xt.getSelection){xt=xt.getSelection();var Mt=Ct.textContent.length,Ft=Math.min(kt.start,Mt);kt=kt.end===void 0?Ft:Math.min(kt.end,Mt),!xt.extend&&Ft>kt&&(Mt=kt,kt=Ft,Ft=Mt),Mt=Ke$1(Ct,Ft);var jt=Ke$1(Ct,kt);Mt&&jt&&(xt.rangeCount!==1||xt.anchorNode!==Mt.node||xt.anchorOffset!==Mt.offset||xt.focusNode!==jt.node||xt.focusOffset!==jt.offset)&&($t=$t.createRange(),$t.setStart(Mt.node,Mt.offset),xt.removeAllRanges(),Ft>kt?(xt.addRange($t),xt.extend(jt.node,jt.offset)):($t.setEnd(jt.node,jt.offset),xt.addRange($t)))}}for($t=[],xt=Ct;xt=xt.parentNode;)xt.nodeType===1&&$t.push({element:xt,left:xt.scrollLeft,top:xt.scrollTop});for(typeof Ct.focus=="function"&&Ct.focus(),Ct=0;Ct<$t.length;Ct++)xt=$t[Ct],xt.element.scrollLeft=xt.left,xt.element.scrollTop=xt.top}}var Pe$2=ia&&"documentMode"in document&&11>=document.documentMode,Qe$1=null,Re$1=null,Se$2=null,Te$2=!1;function Ue$1(xt,$t,Ct){var kt=Ct.window===Ct?Ct.document:Ct.nodeType===9?Ct:Ct.ownerDocument;Te$2||Qe$1==null||Qe$1!==Xa(kt)||(kt=Qe$1,"selectionStart"in kt&&Ne$1(kt)?kt={start:kt.selectionStart,end:kt.selectionEnd}:(kt=(kt.ownerDocument&&kt.ownerDocument.defaultView||window).getSelection(),kt={anchorNode:kt.anchorNode,anchorOffset:kt.anchorOffset,focusNode:kt.focusNode,focusOffset:kt.focusOffset}),Se$2&&Ie$2(Se$2,kt)||(Se$2=kt,kt=oe$2(Re$1,"onSelect"),0<kt.length&&($t=new td("onSelect","select",null,$t,Ct),xt.push({event:$t,listeners:kt}),$t.target=Qe$1)))}function Ve$2(xt,$t){var Ct={};return Ct[xt.toLowerCase()]=$t.toLowerCase(),Ct["Webkit"+xt]="webkit"+$t,Ct["Moz"+xt]="moz"+$t,Ct}var We={animationend:Ve$2("Animation","AnimationEnd"),animationiteration:Ve$2("Animation","AnimationIteration"),animationstart:Ve$2("Animation","AnimationStart"),transitionend:Ve$2("Transition","TransitionEnd")},Xe$1={},Ye$1={};ia&&(Ye$1=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze$1(xt){if(Xe$1[xt])return Xe$1[xt];if(!We[xt])return xt;var $t=We[xt],Ct;for(Ct in $t)if($t.hasOwnProperty(Ct)&&Ct in Ye$1)return Xe$1[xt]=$t[Ct];return xt}var $e=Ze$1("animationend"),af=Ze$1("animationiteration"),bf=Ze$1("animationstart"),cf=Ze$1("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(xt,$t){df.set(xt,$t),fa($t,[xt])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(xt,$t,Ct){var kt=xt.type||"unknown-event";xt.currentTarget=Ct,Ub(kt,$t,void 0,xt),xt.currentTarget=null}function se$2(xt,$t){$t=($t&4)!==0;for(var Ct=0;Ct<xt.length;Ct++){var kt=xt[Ct],Mt=kt.event;kt=kt.listeners;e:{var Ft=void 0;if($t)for(var jt=kt.length-1;0<=jt;jt--){var Bt=kt[jt],Vt=Bt.instance,zt=Bt.currentTarget;if(Bt=Bt.listener,Vt!==Ft&&Mt.isPropagationStopped())break e;nf(Mt,Bt,zt),Ft=Vt}else for(jt=0;jt<kt.length;jt++){if(Bt=kt[jt],Vt=Bt.instance,zt=Bt.currentTarget,Bt=Bt.listener,Vt!==Ft&&Mt.isPropagationStopped())break e;nf(Mt,Bt,zt),Ft=Vt}}}if(Qb)throw xt=Rb,Qb=!1,Rb=null,xt}function D$5(xt,$t){var Ct=$t[of];Ct===void 0&&(Ct=$t[of]=new Set);var kt=xt+"__bubble";Ct.has(kt)||(pf($t,xt,2,!1),Ct.add(kt))}function qf(xt,$t,Ct){var kt=0;$t&&(kt|=4),pf(Ct,xt,kt,$t)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(xt){if(!xt[rf]){xt[rf]=!0,da.forEach(function(Ct){Ct!=="selectionchange"&&(mf.has(Ct)||qf(Ct,!1,xt),qf(Ct,!0,xt))});var $t=xt.nodeType===9?xt:xt.ownerDocument;$t===null||$t[rf]||($t[rf]=!0,qf("selectionchange",!1,$t))}}function pf(xt,$t,Ct,kt){switch(jd($t)){case 1:var Mt=ed;break;case 4:Mt=gd;break;default:Mt=fd}Ct=Mt.bind(null,$t,Ct,xt),Mt=void 0,!Lb||$t!=="touchstart"&&$t!=="touchmove"&&$t!=="wheel"||(Mt=!0),kt?Mt!==void 0?xt.addEventListener($t,Ct,{capture:!0,passive:Mt}):xt.addEventListener($t,Ct,!0):Mt!==void 0?xt.addEventListener($t,Ct,{passive:Mt}):xt.addEventListener($t,Ct,!1)}function hd(xt,$t,Ct,kt,Mt){var Ft=kt;if(!($t&1)&&!($t&2)&&kt!==null)e:for(;;){if(kt===null)return;var jt=kt.tag;if(jt===3||jt===4){var Bt=kt.stateNode.containerInfo;if(Bt===Mt||Bt.nodeType===8&&Bt.parentNode===Mt)break;if(jt===4)for(jt=kt.return;jt!==null;){var Vt=jt.tag;if((Vt===3||Vt===4)&&(Vt=jt.stateNode.containerInfo,Vt===Mt||Vt.nodeType===8&&Vt.parentNode===Mt))return;jt=jt.return}for(;Bt!==null;){if(jt=Wc(Bt),jt===null)return;if(Vt=jt.tag,Vt===5||Vt===6){kt=Ft=jt;continue e}Bt=Bt.parentNode}}kt=kt.return}Jb(function(){var zt=Ft,Ht=xb(Ct),Gt=[];e:{var qt=df.get(xt);if(qt!==void 0){var Wt=td,Yt=xt;switch(xt){case"keypress":if(od(Ct)===0)break e;case"keydown":case"keyup":Wt=Rd;break;case"focusin":Yt="focus",Wt=Fd;break;case"focusout":Yt="blur",Wt=Fd;break;case"beforeblur":case"afterblur":Wt=Fd;break;case"click":if(Ct.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Wt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Wt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Wt=Vd;break;case $e:case af:case bf:Wt=Hd;break;case cf:Wt=Xd;break;case"scroll":Wt=vd;break;case"wheel":Wt=Zd;break;case"copy":case"cut":case"paste":Wt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Wt=Td}var Kt=($t&4)!==0,Xt=!Kt&&xt==="scroll",Qt=Kt?qt!==null?qt+"Capture":null:qt;Kt=[];for(var Jt=zt,Zt;Jt!==null;){Zt=Jt;var sn=Zt.stateNode;if(Zt.tag===5&&sn!==null&&(Zt=sn,Qt!==null&&(sn=Kb(Jt,Qt),sn!=null&&Kt.push(tf(Jt,sn,Zt)))),Xt)break;Jt=Jt.return}0<Kt.length&&(qt=new Wt(qt,Yt,null,Ct,Ht),Gt.push({event:qt,listeners:Kt}))}}if(!($t&7)){e:{if(qt=xt==="mouseover"||xt==="pointerover",Wt=xt==="mouseout"||xt==="pointerout",qt&&Ct!==wb&&(Yt=Ct.relatedTarget||Ct.fromElement)&&(Wc(Yt)||Yt[uf]))break e;if((Wt||qt)&&(qt=Ht.window===Ht?Ht:(qt=Ht.ownerDocument)?qt.defaultView||qt.parentWindow:window,Wt?(Yt=Ct.relatedTarget||Ct.toElement,Wt=zt,Yt=Yt?Wc(Yt):null,Yt!==null&&(Xt=Vb(Yt),Yt!==Xt||Yt.tag!==5&&Yt.tag!==6)&&(Yt=null)):(Wt=null,Yt=zt),Wt!==Yt)){if(Kt=Bd,sn="onMouseLeave",Qt="onMouseEnter",Jt="mouse",(xt==="pointerout"||xt==="pointerover")&&(Kt=Td,sn="onPointerLeave",Qt="onPointerEnter",Jt="pointer"),Xt=Wt==null?qt:ue$2(Wt),Zt=Yt==null?qt:ue$2(Yt),qt=new Kt(sn,Jt+"leave",Wt,Ct,Ht),qt.target=Xt,qt.relatedTarget=Zt,sn=null,Wc(Ht)===zt&&(Kt=new Kt(Qt,Jt+"enter",Yt,Ct,Ht),Kt.target=Zt,Kt.relatedTarget=Xt,sn=Kt),Xt=sn,Wt&&Yt)t:{for(Kt=Wt,Qt=Yt,Jt=0,Zt=Kt;Zt;Zt=vf(Zt))Jt++;for(Zt=0,sn=Qt;sn;sn=vf(sn))Zt++;for(;0<Jt-Zt;)Kt=vf(Kt),Jt--;for(;0<Zt-Jt;)Qt=vf(Qt),Zt--;for(;Jt--;){if(Kt===Qt||Qt!==null&&Kt===Qt.alternate)break t;Kt=vf(Kt),Qt=vf(Qt)}Kt=null}else Kt=null;Wt!==null&&wf(Gt,qt,Wt,Kt,!1),Yt!==null&&Xt!==null&&wf(Gt,Xt,Yt,Kt,!0)}}e:{if(qt=zt?ue$2(zt):window,Wt=qt.nodeName&&qt.nodeName.toLowerCase(),Wt==="select"||Wt==="input"&&qt.type==="file")var ln=ve$1;else if(me$2(qt))if(we$1)ln=Fe$1;else{ln=De$1;var dn=Ce$1}else(Wt=qt.nodeName)&&Wt.toLowerCase()==="input"&&(qt.type==="checkbox"||qt.type==="radio")&&(ln=Ee$2);if(ln&&(ln=ln(xt,zt))){ne$2(Gt,ln,Ct,Ht);break e}dn&&dn(xt,qt,zt),xt==="focusout"&&(dn=qt._wrapperState)&&dn.controlled&&qt.type==="number"&&cb(qt,"number",qt.value)}switch(dn=zt?ue$2(zt):window,xt){case"focusin":(me$2(dn)||dn.contentEditable==="true")&&(Qe$1=dn,Re$1=zt,Se$2=null);break;case"focusout":Se$2=Re$1=Qe$1=null;break;case"mousedown":Te$2=!0;break;case"contextmenu":case"mouseup":case"dragend":Te$2=!1,Ue$1(Gt,Ct,Ht);break;case"selectionchange":if(Pe$2)break;case"keydown":case"keyup":Ue$1(Gt,Ct,Ht)}var hn;if(ae$2)e:{switch(xt){case"compositionstart":var cn="onCompositionStart";break e;case"compositionend":cn="onCompositionEnd";break e;case"compositionupdate":cn="onCompositionUpdate";break e}cn=void 0}else ie$1?ge$2(xt,Ct)&&(cn="onCompositionEnd"):xt==="keydown"&&Ct.keyCode===229&&(cn="onCompositionStart");cn&&(de$1&&Ct.locale!=="ko"&&(ie$1||cn!=="onCompositionStart"?cn==="onCompositionEnd"&&ie$1&&(hn=nd()):(kd=Ht,ld="value"in kd?kd.value:kd.textContent,ie$1=!0)),dn=oe$2(zt,cn),0<dn.length&&(cn=new Ld(cn,xt,null,Ct,Ht),Gt.push({event:cn,listeners:dn}),hn?cn.data=hn:(hn=he$1(Ct),hn!==null&&(cn.data=hn)))),(hn=ce$2?je$1(xt,Ct):ke$1(xt,Ct))&&(zt=oe$2(zt,"onBeforeInput"),0<zt.length&&(Ht=new Ld("onBeforeInput","beforeinput",null,Ct,Ht),Gt.push({event:Ht,listeners:zt}),Ht.data=hn))}se$2(Gt,$t)})}function tf(xt,$t,Ct){return{instance:xt,listener:$t,currentTarget:Ct}}function oe$2(xt,$t){for(var Ct=$t+"Capture",kt=[];xt!==null;){var Mt=xt,Ft=Mt.stateNode;Mt.tag===5&&Ft!==null&&(Mt=Ft,Ft=Kb(xt,Ct),Ft!=null&&kt.unshift(tf(xt,Ft,Mt)),Ft=Kb(xt,$t),Ft!=null&&kt.push(tf(xt,Ft,Mt))),xt=xt.return}return kt}function vf(xt){if(xt===null)return null;do xt=xt.return;while(xt&&xt.tag!==5);return xt||null}function wf(xt,$t,Ct,kt,Mt){for(var Ft=$t._reactName,jt=[];Ct!==null&&Ct!==kt;){var Bt=Ct,Vt=Bt.alternate,zt=Bt.stateNode;if(Vt!==null&&Vt===kt)break;Bt.tag===5&&zt!==null&&(Bt=zt,Mt?(Vt=Kb(Ct,Ft),Vt!=null&&jt.unshift(tf(Ct,Vt,Bt))):Mt||(Vt=Kb(Ct,Ft),Vt!=null&&jt.push(tf(Ct,Vt,Bt)))),Ct=Ct.return}jt.length!==0&&xt.push({event:$t,listeners:jt})}var xf$1=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(xt){return(typeof xt=="string"?xt:""+xt).replace(xf$1,`
`).replace(yf,"")}function Af(xt,$t,Ct){if($t=zf($t),zf(xt)!==$t&&Ct)throw Error(p$2(425))}function Bf(){}var Cf=null,Df=null;function Ef(xt,$t){return xt==="textarea"||xt==="noscript"||typeof $t.children=="string"||typeof $t.children=="number"||typeof $t.dangerouslySetInnerHTML=="object"&&$t.dangerouslySetInnerHTML!==null&&$t.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(xt){return Hf.resolve(null).then(xt).catch(If)}:Ff;function If(xt){setTimeout(function(){throw xt})}function Kf(xt,$t){var Ct=$t,kt=0;do{var Mt=Ct.nextSibling;if(xt.removeChild(Ct),Mt&&Mt.nodeType===8)if(Ct=Mt.data,Ct==="/$"){if(kt===0){xt.removeChild(Mt),bd($t);return}kt--}else Ct!=="$"&&Ct!=="$?"&&Ct!=="$!"||kt++;Ct=Mt}while(Ct);bd($t)}function Lf(xt){for(;xt!=null;xt=xt.nextSibling){var $t=xt.nodeType;if($t===1||$t===3)break;if($t===8){if($t=xt.data,$t==="$"||$t==="$!"||$t==="$?")break;if($t==="/$")return null}}return xt}function Mf(xt){xt=xt.previousSibling;for(var $t=0;xt;){if(xt.nodeType===8){var Ct=xt.data;if(Ct==="$"||Ct==="$!"||Ct==="$?"){if($t===0)return xt;$t--}else Ct==="/$"&&$t++}xt=xt.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(xt){var $t=xt[Of];if($t)return $t;for(var Ct=xt.parentNode;Ct;){if($t=Ct[uf]||Ct[Of]){if(Ct=$t.alternate,$t.child!==null||Ct!==null&&Ct.child!==null)for(xt=Mf(xt);xt!==null;){if(Ct=xt[Of])return Ct;xt=Mf(xt)}return $t}xt=Ct,Ct=xt.parentNode}return null}function Cb(xt){return xt=xt[Of]||xt[uf],!xt||xt.tag!==5&&xt.tag!==6&&xt.tag!==13&&xt.tag!==3?null:xt}function ue$2(xt){if(xt.tag===5||xt.tag===6)return xt.stateNode;throw Error(p$2(33))}function Db(xt){return xt[Pf]||null}var Sf=[],Tf=-1;function Uf(xt){return{current:xt}}function E$3(xt){0>Tf||(xt.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$2(xt,$t){Tf++,Sf[Tf]=xt.current,xt.current=$t}var Vf={},H$2=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(xt,$t){var Ct=xt.type.contextTypes;if(!Ct)return Vf;var kt=xt.stateNode;if(kt&&kt.__reactInternalMemoizedUnmaskedChildContext===$t)return kt.__reactInternalMemoizedMaskedChildContext;var Mt={},Ft;for(Ft in Ct)Mt[Ft]=$t[Ft];return kt&&(xt=xt.stateNode,xt.__reactInternalMemoizedUnmaskedChildContext=$t,xt.__reactInternalMemoizedMaskedChildContext=Mt),Mt}function Zf(xt){return xt=xt.childContextTypes,xt!=null}function $f(){E$3(Wf),E$3(H$2)}function ag(xt,$t,Ct){if(H$2.current!==Vf)throw Error(p$2(168));G$2(H$2,$t),G$2(Wf,Ct)}function bg(xt,$t,Ct){var kt=xt.stateNode;if($t=$t.childContextTypes,typeof kt.getChildContext!="function")return Ct;kt=kt.getChildContext();for(var Mt in kt)if(!(Mt in $t))throw Error(p$2(108,Ra(xt)||"Unknown",Mt));return A$2({},Ct,kt)}function cg(xt){return xt=(xt=xt.stateNode)&&xt.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$2.current,G$2(H$2,xt),G$2(Wf,Wf.current),!0}function dg(xt,$t,Ct){var kt=xt.stateNode;if(!kt)throw Error(p$2(169));Ct?(xt=bg(xt,$t,Xf),kt.__reactInternalMemoizedMergedChildContext=xt,E$3(Wf),E$3(H$2),G$2(H$2,xt)):E$3(Wf),G$2(Wf,Ct)}var eg=null,fg=!1,gg=!1;function hg(xt){eg===null?eg=[xt]:eg.push(xt)}function ig(xt){fg=!0,hg(xt)}function jg(){if(!gg&&eg!==null){gg=!0;var xt=0,$t=C$4;try{var Ct=eg;for(C$4=1;xt<Ct.length;xt++){var kt=Ct[xt];do kt=kt(!0);while(kt!==null)}eg=null,fg=!1}catch(Mt){throw eg!==null&&(eg=eg.slice(xt+1)),ac(fc,jg),Mt}finally{C$4=$t,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(xt,$t){kg[lg++]=ng,kg[lg++]=mg,mg=xt,ng=$t}function ug(xt,$t,Ct){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=xt;var kt=rg;xt=sg;var Mt=32-oc(kt)-1;kt&=~(1<<Mt),Ct+=1;var Ft=32-oc($t)+Mt;if(30<Ft){var jt=Mt-Mt%5;Ft=(kt&(1<<jt)-1).toString(32),kt>>=jt,Mt-=jt,rg=1<<32-oc($t)+Mt|Ct<<Mt|kt,sg=Ft+xt}else rg=1<<Ft|Ct<<Mt|kt,sg=xt}function vg(xt){xt.return!==null&&(tg(xt,1),ug(xt,1,0))}function wg(xt){for(;xt===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;xt===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$2=!1,zg=null;function Ag(xt,$t){var Ct=Bg(5,null,null,0);Ct.elementType="DELETED",Ct.stateNode=$t,Ct.return=xt,$t=xt.deletions,$t===null?(xt.deletions=[Ct],xt.flags|=16):$t.push(Ct)}function Cg(xt,$t){switch(xt.tag){case 5:var Ct=xt.type;return $t=$t.nodeType!==1||Ct.toLowerCase()!==$t.nodeName.toLowerCase()?null:$t,$t!==null?(xt.stateNode=$t,xg=xt,yg=Lf($t.firstChild),!0):!1;case 6:return $t=xt.pendingProps===""||$t.nodeType!==3?null:$t,$t!==null?(xt.stateNode=$t,xg=xt,yg=null,!0):!1;case 13:return $t=$t.nodeType!==8?null:$t,$t!==null?(Ct=qg!==null?{id:rg,overflow:sg}:null,xt.memoizedState={dehydrated:$t,treeContext:Ct,retryLane:1073741824},Ct=Bg(18,null,null,0),Ct.stateNode=$t,Ct.return=xt,xt.child=Ct,xg=xt,yg=null,!0):!1;default:return!1}}function Dg(xt){return(xt.mode&1)!==0&&(xt.flags&128)===0}function Eg(xt){if(I$2){var $t=yg;if($t){var Ct=$t;if(!Cg(xt,$t)){if(Dg(xt))throw Error(p$2(418));$t=Lf(Ct.nextSibling);var kt=xg;$t&&Cg(xt,$t)?Ag(kt,Ct):(xt.flags=xt.flags&-4097|2,I$2=!1,xg=xt)}}else{if(Dg(xt))throw Error(p$2(418));xt.flags=xt.flags&-4097|2,I$2=!1,xg=xt}}}function Fg(xt){for(xt=xt.return;xt!==null&&xt.tag!==5&&xt.tag!==3&&xt.tag!==13;)xt=xt.return;xg=xt}function Gg(xt){if(xt!==xg)return!1;if(!I$2)return Fg(xt),I$2=!0,!1;var $t;if(($t=xt.tag!==3)&&!($t=xt.tag!==5)&&($t=xt.type,$t=$t!=="head"&&$t!=="body"&&!Ef(xt.type,xt.memoizedProps)),$t&&($t=yg)){if(Dg(xt))throw Hg(),Error(p$2(418));for(;$t;)Ag(xt,$t),$t=Lf($t.nextSibling)}if(Fg(xt),xt.tag===13){if(xt=xt.memoizedState,xt=xt!==null?xt.dehydrated:null,!xt)throw Error(p$2(317));e:{for(xt=xt.nextSibling,$t=0;xt;){if(xt.nodeType===8){var Ct=xt.data;if(Ct==="/$"){if($t===0){yg=Lf(xt.nextSibling);break e}$t--}else Ct!=="$"&&Ct!=="$!"&&Ct!=="$?"||$t++}xt=xt.nextSibling}yg=null}}else yg=xg?Lf(xt.stateNode.nextSibling):null;return!0}function Hg(){for(var xt=yg;xt;)xt=Lf(xt.nextSibling)}function Ig(){yg=xg=null,I$2=!1}function Jg(xt){zg===null?zg=[xt]:zg.push(xt)}var Kg=ua.ReactCurrentBatchConfig;function Lg(xt,$t,Ct){if(xt=Ct.ref,xt!==null&&typeof xt!="function"&&typeof xt!="object"){if(Ct._owner){if(Ct=Ct._owner,Ct){if(Ct.tag!==1)throw Error(p$2(309));var kt=Ct.stateNode}if(!kt)throw Error(p$2(147,xt));var Mt=kt,Ft=""+xt;return $t!==null&&$t.ref!==null&&typeof $t.ref=="function"&&$t.ref._stringRef===Ft?$t.ref:($t=function(jt){var Bt=Mt.refs;jt===null?delete Bt[Ft]:Bt[Ft]=jt},$t._stringRef=Ft,$t)}if(typeof xt!="string")throw Error(p$2(284));if(!Ct._owner)throw Error(p$2(290,xt))}return xt}function Mg(xt,$t){throw xt=Object.prototype.toString.call($t),Error(p$2(31,xt==="[object Object]"?"object with keys {"+Object.keys($t).join(", ")+"}":xt))}function Ng(xt){var $t=xt._init;return $t(xt._payload)}function Og(xt){function $t(Qt,Jt){if(xt){var Zt=Qt.deletions;Zt===null?(Qt.deletions=[Jt],Qt.flags|=16):Zt.push(Jt)}}function Ct(Qt,Jt){if(!xt)return null;for(;Jt!==null;)$t(Qt,Jt),Jt=Jt.sibling;return null}function kt(Qt,Jt){for(Qt=new Map;Jt!==null;)Jt.key!==null?Qt.set(Jt.key,Jt):Qt.set(Jt.index,Jt),Jt=Jt.sibling;return Qt}function Mt(Qt,Jt){return Qt=Pg(Qt,Jt),Qt.index=0,Qt.sibling=null,Qt}function Ft(Qt,Jt,Zt){return Qt.index=Zt,xt?(Zt=Qt.alternate,Zt!==null?(Zt=Zt.index,Zt<Jt?(Qt.flags|=2,Jt):Zt):(Qt.flags|=2,Jt)):(Qt.flags|=1048576,Jt)}function jt(Qt){return xt&&Qt.alternate===null&&(Qt.flags|=2),Qt}function Bt(Qt,Jt,Zt,sn){return Jt===null||Jt.tag!==6?(Jt=Qg(Zt,Qt.mode,sn),Jt.return=Qt,Jt):(Jt=Mt(Jt,Zt),Jt.return=Qt,Jt)}function Vt(Qt,Jt,Zt,sn){var ln=Zt.type;return ln===ya?Ht(Qt,Jt,Zt.props.children,sn,Zt.key):Jt!==null&&(Jt.elementType===ln||typeof ln=="object"&&ln!==null&&ln.$$typeof===Ha&&Ng(ln)===Jt.type)?(sn=Mt(Jt,Zt.props),sn.ref=Lg(Qt,Jt,Zt),sn.return=Qt,sn):(sn=Rg(Zt.type,Zt.key,Zt.props,null,Qt.mode,sn),sn.ref=Lg(Qt,Jt,Zt),sn.return=Qt,sn)}function zt(Qt,Jt,Zt,sn){return Jt===null||Jt.tag!==4||Jt.stateNode.containerInfo!==Zt.containerInfo||Jt.stateNode.implementation!==Zt.implementation?(Jt=Sg(Zt,Qt.mode,sn),Jt.return=Qt,Jt):(Jt=Mt(Jt,Zt.children||[]),Jt.return=Qt,Jt)}function Ht(Qt,Jt,Zt,sn,ln){return Jt===null||Jt.tag!==7?(Jt=Tg(Zt,Qt.mode,sn,ln),Jt.return=Qt,Jt):(Jt=Mt(Jt,Zt),Jt.return=Qt,Jt)}function Gt(Qt,Jt,Zt){if(typeof Jt=="string"&&Jt!==""||typeof Jt=="number")return Jt=Qg(""+Jt,Qt.mode,Zt),Jt.return=Qt,Jt;if(typeof Jt=="object"&&Jt!==null){switch(Jt.$$typeof){case va:return Zt=Rg(Jt.type,Jt.key,Jt.props,null,Qt.mode,Zt),Zt.ref=Lg(Qt,null,Jt),Zt.return=Qt,Zt;case wa:return Jt=Sg(Jt,Qt.mode,Zt),Jt.return=Qt,Jt;case Ha:var sn=Jt._init;return Gt(Qt,sn(Jt._payload),Zt)}if(eb(Jt)||Ka(Jt))return Jt=Tg(Jt,Qt.mode,Zt,null),Jt.return=Qt,Jt;Mg(Qt,Jt)}return null}function qt(Qt,Jt,Zt,sn){var ln=Jt!==null?Jt.key:null;if(typeof Zt=="string"&&Zt!==""||typeof Zt=="number")return ln!==null?null:Bt(Qt,Jt,""+Zt,sn);if(typeof Zt=="object"&&Zt!==null){switch(Zt.$$typeof){case va:return Zt.key===ln?Vt(Qt,Jt,Zt,sn):null;case wa:return Zt.key===ln?zt(Qt,Jt,Zt,sn):null;case Ha:return ln=Zt._init,qt(Qt,Jt,ln(Zt._payload),sn)}if(eb(Zt)||Ka(Zt))return ln!==null?null:Ht(Qt,Jt,Zt,sn,null);Mg(Qt,Zt)}return null}function Wt(Qt,Jt,Zt,sn,ln){if(typeof sn=="string"&&sn!==""||typeof sn=="number")return Qt=Qt.get(Zt)||null,Bt(Jt,Qt,""+sn,ln);if(typeof sn=="object"&&sn!==null){switch(sn.$$typeof){case va:return Qt=Qt.get(sn.key===null?Zt:sn.key)||null,Vt(Jt,Qt,sn,ln);case wa:return Qt=Qt.get(sn.key===null?Zt:sn.key)||null,zt(Jt,Qt,sn,ln);case Ha:var dn=sn._init;return Wt(Qt,Jt,Zt,dn(sn._payload),ln)}if(eb(sn)||Ka(sn))return Qt=Qt.get(Zt)||null,Ht(Jt,Qt,sn,ln,null);Mg(Jt,sn)}return null}function Yt(Qt,Jt,Zt,sn){for(var ln=null,dn=null,hn=Jt,cn=Jt=0,pn=null;hn!==null&&cn<Zt.length;cn++){hn.index>cn?(pn=hn,hn=null):pn=hn.sibling;var yn=qt(Qt,hn,Zt[cn],sn);if(yn===null){hn===null&&(hn=pn);break}xt&&hn&&yn.alternate===null&&$t(Qt,hn),Jt=Ft(yn,Jt,cn),dn===null?ln=yn:dn.sibling=yn,dn=yn,hn=pn}if(cn===Zt.length)return Ct(Qt,hn),I$2&&tg(Qt,cn),ln;if(hn===null){for(;cn<Zt.length;cn++)hn=Gt(Qt,Zt[cn],sn),hn!==null&&(Jt=Ft(hn,Jt,cn),dn===null?ln=hn:dn.sibling=hn,dn=hn);return I$2&&tg(Qt,cn),ln}for(hn=kt(Qt,hn);cn<Zt.length;cn++)pn=Wt(hn,Qt,cn,Zt[cn],sn),pn!==null&&(xt&&pn.alternate!==null&&hn.delete(pn.key===null?cn:pn.key),Jt=Ft(pn,Jt,cn),dn===null?ln=pn:dn.sibling=pn,dn=pn);return xt&&hn.forEach(function(gn){return $t(Qt,gn)}),I$2&&tg(Qt,cn),ln}function Kt(Qt,Jt,Zt,sn){var ln=Ka(Zt);if(typeof ln!="function")throw Error(p$2(150));if(Zt=ln.call(Zt),Zt==null)throw Error(p$2(151));for(var dn=ln=null,hn=Jt,cn=Jt=0,pn=null,yn=Zt.next();hn!==null&&!yn.done;cn++,yn=Zt.next()){hn.index>cn?(pn=hn,hn=null):pn=hn.sibling;var gn=qt(Qt,hn,yn.value,sn);if(gn===null){hn===null&&(hn=pn);break}xt&&hn&&gn.alternate===null&&$t(Qt,hn),Jt=Ft(gn,Jt,cn),dn===null?ln=gn:dn.sibling=gn,dn=gn,hn=pn}if(yn.done)return Ct(Qt,hn),I$2&&tg(Qt,cn),ln;if(hn===null){for(;!yn.done;cn++,yn=Zt.next())yn=Gt(Qt,yn.value,sn),yn!==null&&(Jt=Ft(yn,Jt,cn),dn===null?ln=yn:dn.sibling=yn,dn=yn);return I$2&&tg(Qt,cn),ln}for(hn=kt(Qt,hn);!yn.done;cn++,yn=Zt.next())yn=Wt(hn,Qt,cn,yn.value,sn),yn!==null&&(xt&&yn.alternate!==null&&hn.delete(yn.key===null?cn:yn.key),Jt=Ft(yn,Jt,cn),dn===null?ln=yn:dn.sibling=yn,dn=yn);return xt&&hn.forEach(function(En){return $t(Qt,En)}),I$2&&tg(Qt,cn),ln}function Xt(Qt,Jt,Zt,sn){if(typeof Zt=="object"&&Zt!==null&&Zt.type===ya&&Zt.key===null&&(Zt=Zt.props.children),typeof Zt=="object"&&Zt!==null){switch(Zt.$$typeof){case va:e:{for(var ln=Zt.key,dn=Jt;dn!==null;){if(dn.key===ln){if(ln=Zt.type,ln===ya){if(dn.tag===7){Ct(Qt,dn.sibling),Jt=Mt(dn,Zt.props.children),Jt.return=Qt,Qt=Jt;break e}}else if(dn.elementType===ln||typeof ln=="object"&&ln!==null&&ln.$$typeof===Ha&&Ng(ln)===dn.type){Ct(Qt,dn.sibling),Jt=Mt(dn,Zt.props),Jt.ref=Lg(Qt,dn,Zt),Jt.return=Qt,Qt=Jt;break e}Ct(Qt,dn);break}else $t(Qt,dn);dn=dn.sibling}Zt.type===ya?(Jt=Tg(Zt.props.children,Qt.mode,sn,Zt.key),Jt.return=Qt,Qt=Jt):(sn=Rg(Zt.type,Zt.key,Zt.props,null,Qt.mode,sn),sn.ref=Lg(Qt,Jt,Zt),sn.return=Qt,Qt=sn)}return jt(Qt);case wa:e:{for(dn=Zt.key;Jt!==null;){if(Jt.key===dn)if(Jt.tag===4&&Jt.stateNode.containerInfo===Zt.containerInfo&&Jt.stateNode.implementation===Zt.implementation){Ct(Qt,Jt.sibling),Jt=Mt(Jt,Zt.children||[]),Jt.return=Qt,Qt=Jt;break e}else{Ct(Qt,Jt);break}else $t(Qt,Jt);Jt=Jt.sibling}Jt=Sg(Zt,Qt.mode,sn),Jt.return=Qt,Qt=Jt}return jt(Qt);case Ha:return dn=Zt._init,Xt(Qt,Jt,dn(Zt._payload),sn)}if(eb(Zt))return Yt(Qt,Jt,Zt,sn);if(Ka(Zt))return Kt(Qt,Jt,Zt,sn);Mg(Qt,Zt)}return typeof Zt=="string"&&Zt!==""||typeof Zt=="number"?(Zt=""+Zt,Jt!==null&&Jt.tag===6?(Ct(Qt,Jt.sibling),Jt=Mt(Jt,Zt),Jt.return=Qt,Qt=Jt):(Ct(Qt,Jt),Jt=Qg(Zt,Qt.mode,sn),Jt.return=Qt,Qt=Jt),jt(Qt)):Ct(Qt,Jt)}return Xt}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(xt){var $t=Wg.current;E$3(Wg),xt._currentValue=$t}function bh(xt,$t,Ct){for(;xt!==null;){var kt=xt.alternate;if((xt.childLanes&$t)!==$t?(xt.childLanes|=$t,kt!==null&&(kt.childLanes|=$t)):kt!==null&&(kt.childLanes&$t)!==$t&&(kt.childLanes|=$t),xt===Ct)break;xt=xt.return}}function ch$1(xt,$t){Xg=xt,Zg=Yg=null,xt=xt.dependencies,xt!==null&&xt.firstContext!==null&&(xt.lanes&$t&&(dh=!0),xt.firstContext=null)}function eh(xt){var $t=xt._currentValue;if(Zg!==xt)if(xt={context:xt,memoizedValue:$t,next:null},Yg===null){if(Xg===null)throw Error(p$2(308));Yg=xt,Xg.dependencies={lanes:0,firstContext:xt}}else Yg=Yg.next=xt;return $t}var fh=null;function gh(xt){fh===null?fh=[xt]:fh.push(xt)}function hh(xt,$t,Ct,kt){var Mt=$t.interleaved;return Mt===null?(Ct.next=Ct,gh($t)):(Ct.next=Mt.next,Mt.next=Ct),$t.interleaved=Ct,ih(xt,kt)}function ih(xt,$t){xt.lanes|=$t;var Ct=xt.alternate;for(Ct!==null&&(Ct.lanes|=$t),Ct=xt,xt=xt.return;xt!==null;)xt.childLanes|=$t,Ct=xt.alternate,Ct!==null&&(Ct.childLanes|=$t),Ct=xt,xt=xt.return;return Ct.tag===3?Ct.stateNode:null}var jh=!1;function kh(xt){xt.updateQueue={baseState:xt.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(xt,$t){xt=xt.updateQueue,$t.updateQueue===xt&&($t.updateQueue={baseState:xt.baseState,firstBaseUpdate:xt.firstBaseUpdate,lastBaseUpdate:xt.lastBaseUpdate,shared:xt.shared,effects:xt.effects})}function mh(xt,$t){return{eventTime:xt,lane:$t,tag:0,payload:null,callback:null,next:null}}function nh(xt,$t,Ct){var kt=xt.updateQueue;if(kt===null)return null;if(kt=kt.shared,K$2&2){var Mt=kt.pending;return Mt===null?$t.next=$t:($t.next=Mt.next,Mt.next=$t),kt.pending=$t,ih(xt,Ct)}return Mt=kt.interleaved,Mt===null?($t.next=$t,gh(kt)):($t.next=Mt.next,Mt.next=$t),kt.interleaved=$t,ih(xt,Ct)}function oh(xt,$t,Ct){if($t=$t.updateQueue,$t!==null&&($t=$t.shared,(Ct&4194240)!==0)){var kt=$t.lanes;kt&=xt.pendingLanes,Ct|=kt,$t.lanes=Ct,Cc(xt,Ct)}}function ph(xt,$t){var Ct=xt.updateQueue,kt=xt.alternate;if(kt!==null&&(kt=kt.updateQueue,Ct===kt)){var Mt=null,Ft=null;if(Ct=Ct.firstBaseUpdate,Ct!==null){do{var jt={eventTime:Ct.eventTime,lane:Ct.lane,tag:Ct.tag,payload:Ct.payload,callback:Ct.callback,next:null};Ft===null?Mt=Ft=jt:Ft=Ft.next=jt,Ct=Ct.next}while(Ct!==null);Ft===null?Mt=Ft=$t:Ft=Ft.next=$t}else Mt=Ft=$t;Ct={baseState:kt.baseState,firstBaseUpdate:Mt,lastBaseUpdate:Ft,shared:kt.shared,effects:kt.effects},xt.updateQueue=Ct;return}xt=Ct.lastBaseUpdate,xt===null?Ct.firstBaseUpdate=$t:xt.next=$t,Ct.lastBaseUpdate=$t}function qh(xt,$t,Ct,kt){var Mt=xt.updateQueue;jh=!1;var Ft=Mt.firstBaseUpdate,jt=Mt.lastBaseUpdate,Bt=Mt.shared.pending;if(Bt!==null){Mt.shared.pending=null;var Vt=Bt,zt=Vt.next;Vt.next=null,jt===null?Ft=zt:jt.next=zt,jt=Vt;var Ht=xt.alternate;Ht!==null&&(Ht=Ht.updateQueue,Bt=Ht.lastBaseUpdate,Bt!==jt&&(Bt===null?Ht.firstBaseUpdate=zt:Bt.next=zt,Ht.lastBaseUpdate=Vt))}if(Ft!==null){var Gt=Mt.baseState;jt=0,Ht=zt=Vt=null,Bt=Ft;do{var qt=Bt.lane,Wt=Bt.eventTime;if((kt&qt)===qt){Ht!==null&&(Ht=Ht.next={eventTime:Wt,lane:0,tag:Bt.tag,payload:Bt.payload,callback:Bt.callback,next:null});e:{var Yt=xt,Kt=Bt;switch(qt=$t,Wt=Ct,Kt.tag){case 1:if(Yt=Kt.payload,typeof Yt=="function"){Gt=Yt.call(Wt,Gt,qt);break e}Gt=Yt;break e;case 3:Yt.flags=Yt.flags&-65537|128;case 0:if(Yt=Kt.payload,qt=typeof Yt=="function"?Yt.call(Wt,Gt,qt):Yt,qt==null)break e;Gt=A$2({},Gt,qt);break e;case 2:jh=!0}}Bt.callback!==null&&Bt.lane!==0&&(xt.flags|=64,qt=Mt.effects,qt===null?Mt.effects=[Bt]:qt.push(Bt))}else Wt={eventTime:Wt,lane:qt,tag:Bt.tag,payload:Bt.payload,callback:Bt.callback,next:null},Ht===null?(zt=Ht=Wt,Vt=Gt):Ht=Ht.next=Wt,jt|=qt;if(Bt=Bt.next,Bt===null){if(Bt=Mt.shared.pending,Bt===null)break;qt=Bt,Bt=qt.next,qt.next=null,Mt.lastBaseUpdate=qt,Mt.shared.pending=null}}while(!0);if(Ht===null&&(Vt=Gt),Mt.baseState=Vt,Mt.firstBaseUpdate=zt,Mt.lastBaseUpdate=Ht,$t=Mt.shared.interleaved,$t!==null){Mt=$t;do jt|=Mt.lane,Mt=Mt.next;while(Mt!==$t)}else Ft===null&&(Mt.shared.lanes=0);rh|=jt,xt.lanes=jt,xt.memoizedState=Gt}}function sh(xt,$t,Ct){if(xt=$t.effects,$t.effects=null,xt!==null)for($t=0;$t<xt.length;$t++){var kt=xt[$t],Mt=kt.callback;if(Mt!==null){if(kt.callback=null,kt=Ct,typeof Mt!="function")throw Error(p$2(191,Mt));Mt.call(kt)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(xt){if(xt===th)throw Error(p$2(174));return xt}function yh$1(xt,$t){switch(G$2(wh,$t),G$2(vh,xt),G$2(uh,th),xt=$t.nodeType,xt){case 9:case 11:$t=($t=$t.documentElement)?$t.namespaceURI:lb(null,"");break;default:xt=xt===8?$t.parentNode:$t,$t=xt.namespaceURI||null,xt=xt.tagName,$t=lb($t,xt)}E$3(uh),G$2(uh,$t)}function zh(){E$3(uh),E$3(vh),E$3(wh)}function Ah(xt){xh(wh.current);var $t=xh(uh.current),Ct=lb($t,xt.type);$t!==Ct&&(G$2(vh,xt),G$2(uh,Ct))}function Bh(xt){vh.current===xt&&(E$3(uh),E$3(vh))}var L$2=Uf(0);function Ch(xt){for(var $t=xt;$t!==null;){if($t.tag===13){var Ct=$t.memoizedState;if(Ct!==null&&(Ct=Ct.dehydrated,Ct===null||Ct.data==="$?"||Ct.data==="$!"))return $t}else if($t.tag===19&&$t.memoizedProps.revealOrder!==void 0){if($t.flags&128)return $t}else if($t.child!==null){$t.child.return=$t,$t=$t.child;continue}if($t===xt)break;for(;$t.sibling===null;){if($t.return===null||$t.return===xt)return null;$t=$t.return}$t.sibling.return=$t.return,$t=$t.sibling}return null}var Dh=[];function Eh(){for(var xt=0;xt<Dh.length;xt++)Dh[xt]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M$3=null,N$2=null,O$1=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P$2(){throw Error(p$2(321))}function Mh(xt,$t){if($t===null)return!1;for(var Ct=0;Ct<$t.length&&Ct<xt.length;Ct++)if(!He(xt[Ct],$t[Ct]))return!1;return!0}function Nh(xt,$t,Ct,kt,Mt,Ft){if(Hh=Ft,M$3=$t,$t.memoizedState=null,$t.updateQueue=null,$t.lanes=0,Fh.current=xt===null||xt.memoizedState===null?Oh:Ph,xt=Ct(kt,Mt),Jh){Ft=0;do{if(Jh=!1,Kh=0,25<=Ft)throw Error(p$2(301));Ft+=1,O$1=N$2=null,$t.updateQueue=null,Fh.current=Qh,xt=Ct(kt,Mt)}while(Jh)}if(Fh.current=Rh,$t=N$2!==null&&N$2.next!==null,Hh=0,O$1=N$2=M$3=null,Ih=!1,$t)throw Error(p$2(300));return xt}function Sh(){var xt=Kh!==0;return Kh=0,xt}function Th(){var xt={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O$1===null?M$3.memoizedState=O$1=xt:O$1=O$1.next=xt,O$1}function Uh(){if(N$2===null){var xt=M$3.alternate;xt=xt!==null?xt.memoizedState:null}else xt=N$2.next;var $t=O$1===null?M$3.memoizedState:O$1.next;if($t!==null)O$1=$t,N$2=xt;else{if(xt===null)throw Error(p$2(310));N$2=xt,xt={memoizedState:N$2.memoizedState,baseState:N$2.baseState,baseQueue:N$2.baseQueue,queue:N$2.queue,next:null},O$1===null?M$3.memoizedState=O$1=xt:O$1=O$1.next=xt}return O$1}function Vh(xt,$t){return typeof $t=="function"?$t(xt):$t}function Wh(xt){var $t=Uh(),Ct=$t.queue;if(Ct===null)throw Error(p$2(311));Ct.lastRenderedReducer=xt;var kt=N$2,Mt=kt.baseQueue,Ft=Ct.pending;if(Ft!==null){if(Mt!==null){var jt=Mt.next;Mt.next=Ft.next,Ft.next=jt}kt.baseQueue=Mt=Ft,Ct.pending=null}if(Mt!==null){Ft=Mt.next,kt=kt.baseState;var Bt=jt=null,Vt=null,zt=Ft;do{var Ht=zt.lane;if((Hh&Ht)===Ht)Vt!==null&&(Vt=Vt.next={lane:0,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null}),kt=zt.hasEagerState?zt.eagerState:xt(kt,zt.action);else{var Gt={lane:Ht,action:zt.action,hasEagerState:zt.hasEagerState,eagerState:zt.eagerState,next:null};Vt===null?(Bt=Vt=Gt,jt=kt):Vt=Vt.next=Gt,M$3.lanes|=Ht,rh|=Ht}zt=zt.next}while(zt!==null&&zt!==Ft);Vt===null?jt=kt:Vt.next=Bt,He(kt,$t.memoizedState)||(dh=!0),$t.memoizedState=kt,$t.baseState=jt,$t.baseQueue=Vt,Ct.lastRenderedState=kt}if(xt=Ct.interleaved,xt!==null){Mt=xt;do Ft=Mt.lane,M$3.lanes|=Ft,rh|=Ft,Mt=Mt.next;while(Mt!==xt)}else Mt===null&&(Ct.lanes=0);return[$t.memoizedState,Ct.dispatch]}function Xh(xt){var $t=Uh(),Ct=$t.queue;if(Ct===null)throw Error(p$2(311));Ct.lastRenderedReducer=xt;var kt=Ct.dispatch,Mt=Ct.pending,Ft=$t.memoizedState;if(Mt!==null){Ct.pending=null;var jt=Mt=Mt.next;do Ft=xt(Ft,jt.action),jt=jt.next;while(jt!==Mt);He(Ft,$t.memoizedState)||(dh=!0),$t.memoizedState=Ft,$t.baseQueue===null&&($t.baseState=Ft),Ct.lastRenderedState=Ft}return[Ft,kt]}function Yh(){}function Zh(xt,$t){var Ct=M$3,kt=Uh(),Mt=$t(),Ft=!He(kt.memoizedState,Mt);if(Ft&&(kt.memoizedState=Mt,dh=!0),kt=kt.queue,$h(ai.bind(null,Ct,kt,xt),[xt]),kt.getSnapshot!==$t||Ft||O$1!==null&&O$1.memoizedState.tag&1){if(Ct.flags|=2048,bi(9,ci.bind(null,Ct,kt,Mt,$t),void 0,null),Q$2===null)throw Error(p$2(349));Hh&30||di(Ct,$t,Mt)}return Mt}function di(xt,$t,Ct){xt.flags|=16384,xt={getSnapshot:$t,value:Ct},$t=M$3.updateQueue,$t===null?($t={lastEffect:null,stores:null},M$3.updateQueue=$t,$t.stores=[xt]):(Ct=$t.stores,Ct===null?$t.stores=[xt]:Ct.push(xt))}function ci(xt,$t,Ct,kt){$t.value=Ct,$t.getSnapshot=kt,ei($t)&&fi(xt)}function ai(xt,$t,Ct){return Ct(function(){ei($t)&&fi(xt)})}function ei(xt){var $t=xt.getSnapshot;xt=xt.value;try{var Ct=$t();return!He(xt,Ct)}catch{return!0}}function fi(xt){var $t=ih(xt,1);$t!==null&&gi($t,xt,1,-1)}function hi(xt){var $t=Th();return typeof xt=="function"&&(xt=xt()),$t.memoizedState=$t.baseState=xt,xt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:xt},$t.queue=xt,xt=xt.dispatch=ii.bind(null,M$3,xt),[$t.memoizedState,xt]}function bi(xt,$t,Ct,kt){return xt={tag:xt,create:$t,destroy:Ct,deps:kt,next:null},$t=M$3.updateQueue,$t===null?($t={lastEffect:null,stores:null},M$3.updateQueue=$t,$t.lastEffect=xt.next=xt):(Ct=$t.lastEffect,Ct===null?$t.lastEffect=xt.next=xt:(kt=Ct.next,Ct.next=xt,xt.next=kt,$t.lastEffect=xt)),xt}function ji(){return Uh().memoizedState}function ki(xt,$t,Ct,kt){var Mt=Th();M$3.flags|=xt,Mt.memoizedState=bi(1|$t,Ct,void 0,kt===void 0?null:kt)}function li(xt,$t,Ct,kt){var Mt=Uh();kt=kt===void 0?null:kt;var Ft=void 0;if(N$2!==null){var jt=N$2.memoizedState;if(Ft=jt.destroy,kt!==null&&Mh(kt,jt.deps)){Mt.memoizedState=bi($t,Ct,Ft,kt);return}}M$3.flags|=xt,Mt.memoizedState=bi(1|$t,Ct,Ft,kt)}function mi(xt,$t){return ki(8390656,8,xt,$t)}function $h(xt,$t){return li(2048,8,xt,$t)}function ni(xt,$t){return li(4,2,xt,$t)}function oi(xt,$t){return li(4,4,xt,$t)}function pi$4(xt,$t){if(typeof $t=="function")return xt=xt(),$t(xt),function(){$t(null)};if($t!=null)return xt=xt(),$t.current=xt,function(){$t.current=null}}function qi(xt,$t,Ct){return Ct=Ct!=null?Ct.concat([xt]):null,li(4,4,pi$4.bind(null,$t,xt),Ct)}function ri(){}function si(xt,$t){var Ct=Uh();$t=$t===void 0?null:$t;var kt=Ct.memoizedState;return kt!==null&&$t!==null&&Mh($t,kt[1])?kt[0]:(Ct.memoizedState=[xt,$t],xt)}function ti(xt,$t){var Ct=Uh();$t=$t===void 0?null:$t;var kt=Ct.memoizedState;return kt!==null&&$t!==null&&Mh($t,kt[1])?kt[0]:(xt=xt(),Ct.memoizedState=[xt,$t],xt)}function ui(xt,$t,Ct){return Hh&21?(He(Ct,$t)||(Ct=yc(),M$3.lanes|=Ct,rh|=Ct,xt.baseState=!0),$t):(xt.baseState&&(xt.baseState=!1,dh=!0),xt.memoizedState=Ct)}function vi(xt,$t){var Ct=C$4;C$4=Ct!==0&&4>Ct?Ct:4,xt(!0);var kt=Gh.transition;Gh.transition={};try{xt(!1),$t()}finally{C$4=Ct,Gh.transition=kt}}function wi(){return Uh().memoizedState}function xi(xt,$t,Ct){var kt=yi(xt);if(Ct={lane:kt,action:Ct,hasEagerState:!1,eagerState:null,next:null},zi(xt))Ai($t,Ct);else if(Ct=hh(xt,$t,Ct,kt),Ct!==null){var Mt=R$1();gi(Ct,xt,kt,Mt),Bi(Ct,$t,kt)}}function ii(xt,$t,Ct){var kt=yi(xt),Mt={lane:kt,action:Ct,hasEagerState:!1,eagerState:null,next:null};if(zi(xt))Ai($t,Mt);else{var Ft=xt.alternate;if(xt.lanes===0&&(Ft===null||Ft.lanes===0)&&(Ft=$t.lastRenderedReducer,Ft!==null))try{var jt=$t.lastRenderedState,Bt=Ft(jt,Ct);if(Mt.hasEagerState=!0,Mt.eagerState=Bt,He(Bt,jt)){var Vt=$t.interleaved;Vt===null?(Mt.next=Mt,gh($t)):(Mt.next=Vt.next,Vt.next=Mt),$t.interleaved=Mt;return}}catch{}finally{}Ct=hh(xt,$t,Mt,kt),Ct!==null&&(Mt=R$1(),gi(Ct,xt,kt,Mt),Bi(Ct,$t,kt))}}function zi(xt){var $t=xt.alternate;return xt===M$3||$t!==null&&$t===M$3}function Ai(xt,$t){Jh=Ih=!0;var Ct=xt.pending;Ct===null?$t.next=$t:($t.next=Ct.next,Ct.next=$t),xt.pending=$t}function Bi(xt,$t,Ct){if(Ct&4194240){var kt=$t.lanes;kt&=xt.pendingLanes,Ct|=kt,$t.lanes=Ct,Cc(xt,Ct)}}var Rh={readContext:eh,useCallback:P$2,useContext:P$2,useEffect:P$2,useImperativeHandle:P$2,useInsertionEffect:P$2,useLayoutEffect:P$2,useMemo:P$2,useReducer:P$2,useRef:P$2,useState:P$2,useDebugValue:P$2,useDeferredValue:P$2,useTransition:P$2,useMutableSource:P$2,useSyncExternalStore:P$2,useId:P$2,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(xt,$t){return Th().memoizedState=[xt,$t===void 0?null:$t],xt},useContext:eh,useEffect:mi,useImperativeHandle:function(xt,$t,Ct){return Ct=Ct!=null?Ct.concat([xt]):null,ki(4194308,4,pi$4.bind(null,$t,xt),Ct)},useLayoutEffect:function(xt,$t){return ki(4194308,4,xt,$t)},useInsertionEffect:function(xt,$t){return ki(4,2,xt,$t)},useMemo:function(xt,$t){var Ct=Th();return $t=$t===void 0?null:$t,xt=xt(),Ct.memoizedState=[xt,$t],xt},useReducer:function(xt,$t,Ct){var kt=Th();return $t=Ct!==void 0?Ct($t):$t,kt.memoizedState=kt.baseState=$t,xt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xt,lastRenderedState:$t},kt.queue=xt,xt=xt.dispatch=xi.bind(null,M$3,xt),[kt.memoizedState,xt]},useRef:function(xt){var $t=Th();return xt={current:xt},$t.memoizedState=xt},useState:hi,useDebugValue:ri,useDeferredValue:function(xt){return Th().memoizedState=xt},useTransition:function(){var xt=hi(!1),$t=xt[0];return xt=vi.bind(null,xt[1]),Th().memoizedState=xt,[$t,xt]},useMutableSource:function(){},useSyncExternalStore:function(xt,$t,Ct){var kt=M$3,Mt=Th();if(I$2){if(Ct===void 0)throw Error(p$2(407));Ct=Ct()}else{if(Ct=$t(),Q$2===null)throw Error(p$2(349));Hh&30||di(kt,$t,Ct)}Mt.memoizedState=Ct;var Ft={value:Ct,getSnapshot:$t};return Mt.queue=Ft,mi(ai.bind(null,kt,Ft,xt),[xt]),kt.flags|=2048,bi(9,ci.bind(null,kt,Ft,Ct,$t),void 0,null),Ct},useId:function(){var xt=Th(),$t=Q$2.identifierPrefix;if(I$2){var Ct=sg,kt=rg;Ct=(kt&~(1<<32-oc(kt)-1)).toString(32)+Ct,$t=":"+$t+"R"+Ct,Ct=Kh++,0<Ct&&($t+="H"+Ct.toString(32)),$t+=":"}else Ct=Lh++,$t=":"+$t+"r"+Ct.toString(32)+":";return xt.memoizedState=$t},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(xt){var $t=Uh();return ui($t,N$2.memoizedState,xt)},useTransition:function(){var xt=Wh(Vh)[0],$t=Uh().memoizedState;return[xt,$t]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(xt){var $t=Uh();return N$2===null?$t.memoizedState=xt:ui($t,N$2.memoizedState,xt)},useTransition:function(){var xt=Xh(Vh)[0],$t=Uh().memoizedState;return[xt,$t]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(xt,$t){if(xt&&xt.defaultProps){$t=A$2({},$t),xt=xt.defaultProps;for(var Ct in xt)$t[Ct]===void 0&&($t[Ct]=xt[Ct]);return $t}return $t}function Di(xt,$t,Ct,kt){$t=xt.memoizedState,Ct=Ct(kt,$t),Ct=Ct==null?$t:A$2({},$t,Ct),xt.memoizedState=Ct,xt.lanes===0&&(xt.updateQueue.baseState=Ct)}var Ei={isMounted:function(xt){return(xt=xt._reactInternals)?Vb(xt)===xt:!1},enqueueSetState:function(xt,$t,Ct){xt=xt._reactInternals;var kt=R$1(),Mt=yi(xt),Ft=mh(kt,Mt);Ft.payload=$t,Ct!=null&&(Ft.callback=Ct),$t=nh(xt,Ft,Mt),$t!==null&&(gi($t,xt,Mt,kt),oh($t,xt,Mt))},enqueueReplaceState:function(xt,$t,Ct){xt=xt._reactInternals;var kt=R$1(),Mt=yi(xt),Ft=mh(kt,Mt);Ft.tag=1,Ft.payload=$t,Ct!=null&&(Ft.callback=Ct),$t=nh(xt,Ft,Mt),$t!==null&&(gi($t,xt,Mt,kt),oh($t,xt,Mt))},enqueueForceUpdate:function(xt,$t){xt=xt._reactInternals;var Ct=R$1(),kt=yi(xt),Mt=mh(Ct,kt);Mt.tag=2,$t!=null&&(Mt.callback=$t),$t=nh(xt,Mt,kt),$t!==null&&(gi($t,xt,kt,Ct),oh($t,xt,kt))}};function Fi(xt,$t,Ct,kt,Mt,Ft,jt){return xt=xt.stateNode,typeof xt.shouldComponentUpdate=="function"?xt.shouldComponentUpdate(kt,Ft,jt):$t.prototype&&$t.prototype.isPureReactComponent?!Ie$2(Ct,kt)||!Ie$2(Mt,Ft):!0}function Gi(xt,$t,Ct){var kt=!1,Mt=Vf,Ft=$t.contextType;return typeof Ft=="object"&&Ft!==null?Ft=eh(Ft):(Mt=Zf($t)?Xf:H$2.current,kt=$t.contextTypes,Ft=(kt=kt!=null)?Yf(xt,Mt):Vf),$t=new $t(Ct,Ft),xt.memoizedState=$t.state!==null&&$t.state!==void 0?$t.state:null,$t.updater=Ei,xt.stateNode=$t,$t._reactInternals=xt,kt&&(xt=xt.stateNode,xt.__reactInternalMemoizedUnmaskedChildContext=Mt,xt.__reactInternalMemoizedMaskedChildContext=Ft),$t}function Hi(xt,$t,Ct,kt){xt=$t.state,typeof $t.componentWillReceiveProps=="function"&&$t.componentWillReceiveProps(Ct,kt),typeof $t.UNSAFE_componentWillReceiveProps=="function"&&$t.UNSAFE_componentWillReceiveProps(Ct,kt),$t.state!==xt&&Ei.enqueueReplaceState($t,$t.state,null)}function Ii(xt,$t,Ct,kt){var Mt=xt.stateNode;Mt.props=Ct,Mt.state=xt.memoizedState,Mt.refs={},kh(xt);var Ft=$t.contextType;typeof Ft=="object"&&Ft!==null?Mt.context=eh(Ft):(Ft=Zf($t)?Xf:H$2.current,Mt.context=Yf(xt,Ft)),Mt.state=xt.memoizedState,Ft=$t.getDerivedStateFromProps,typeof Ft=="function"&&(Di(xt,$t,Ft,Ct),Mt.state=xt.memoizedState),typeof $t.getDerivedStateFromProps=="function"||typeof Mt.getSnapshotBeforeUpdate=="function"||typeof Mt.UNSAFE_componentWillMount!="function"&&typeof Mt.componentWillMount!="function"||($t=Mt.state,typeof Mt.componentWillMount=="function"&&Mt.componentWillMount(),typeof Mt.UNSAFE_componentWillMount=="function"&&Mt.UNSAFE_componentWillMount(),$t!==Mt.state&&Ei.enqueueReplaceState(Mt,Mt.state,null),qh(xt,Ct,Mt,kt),Mt.state=xt.memoizedState),typeof Mt.componentDidMount=="function"&&(xt.flags|=4194308)}function Ji(xt,$t){try{var Ct="",kt=$t;do Ct+=Pa(kt),kt=kt.return;while(kt);var Mt=Ct}catch(Ft){Mt=`
Error generating stack: `+Ft.message+`
`+Ft.stack}return{value:xt,source:$t,stack:Mt,digest:null}}function Ki(xt,$t,Ct){return{value:xt,source:null,stack:Ct??null,digest:$t??null}}function Li(xt,$t){try{console.error($t.value)}catch(Ct){setTimeout(function(){throw Ct})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(xt,$t,Ct){Ct=mh(-1,Ct),Ct.tag=3,Ct.payload={element:null};var kt=$t.value;return Ct.callback=function(){Oi||(Oi=!0,Pi=kt),Li(xt,$t)},Ct}function Qi(xt,$t,Ct){Ct=mh(-1,Ct),Ct.tag=3;var kt=xt.type.getDerivedStateFromError;if(typeof kt=="function"){var Mt=$t.value;Ct.payload=function(){return kt(Mt)},Ct.callback=function(){Li(xt,$t)}}var Ft=xt.stateNode;return Ft!==null&&typeof Ft.componentDidCatch=="function"&&(Ct.callback=function(){Li(xt,$t),typeof kt!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var jt=$t.stack;this.componentDidCatch($t.value,{componentStack:jt!==null?jt:""})}),Ct}function Si(xt,$t,Ct){var kt=xt.pingCache;if(kt===null){kt=xt.pingCache=new Mi;var Mt=new Set;kt.set($t,Mt)}else Mt=kt.get($t),Mt===void 0&&(Mt=new Set,kt.set($t,Mt));Mt.has(Ct)||(Mt.add(Ct),xt=Ti.bind(null,xt,$t,Ct),$t.then(xt,xt))}function Ui(xt){do{var $t;if(($t=xt.tag===13)&&($t=xt.memoizedState,$t=$t!==null?$t.dehydrated!==null:!0),$t)return xt;xt=xt.return}while(xt!==null);return null}function Vi(xt,$t,Ct,kt,Mt){return xt.mode&1?(xt.flags|=65536,xt.lanes=Mt,xt):(xt===$t?xt.flags|=65536:(xt.flags|=128,Ct.flags|=131072,Ct.flags&=-52805,Ct.tag===1&&(Ct.alternate===null?Ct.tag=17:($t=mh(-1,1),$t.tag=2,nh(Ct,$t,1))),Ct.lanes|=1),xt)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(xt,$t,Ct,kt){$t.child=xt===null?Vg($t,null,Ct,kt):Ug($t,xt.child,Ct,kt)}function Yi(xt,$t,Ct,kt,Mt){Ct=Ct.render;var Ft=$t.ref;return ch$1($t,Mt),kt=Nh(xt,$t,Ct,kt,Ft,Mt),Ct=Sh(),xt!==null&&!dh?($t.updateQueue=xt.updateQueue,$t.flags&=-2053,xt.lanes&=~Mt,Zi(xt,$t,Mt)):(I$2&&Ct&&vg($t),$t.flags|=1,Xi(xt,$t,kt,Mt),$t.child)}function $i(xt,$t,Ct,kt,Mt){if(xt===null){var Ft=Ct.type;return typeof Ft=="function"&&!aj(Ft)&&Ft.defaultProps===void 0&&Ct.compare===null&&Ct.defaultProps===void 0?($t.tag=15,$t.type=Ft,bj(xt,$t,Ft,kt,Mt)):(xt=Rg(Ct.type,null,kt,$t,$t.mode,Mt),xt.ref=$t.ref,xt.return=$t,$t.child=xt)}if(Ft=xt.child,!(xt.lanes&Mt)){var jt=Ft.memoizedProps;if(Ct=Ct.compare,Ct=Ct!==null?Ct:Ie$2,Ct(jt,kt)&&xt.ref===$t.ref)return Zi(xt,$t,Mt)}return $t.flags|=1,xt=Pg(Ft,kt),xt.ref=$t.ref,xt.return=$t,$t.child=xt}function bj(xt,$t,Ct,kt,Mt){if(xt!==null){var Ft=xt.memoizedProps;if(Ie$2(Ft,kt)&&xt.ref===$t.ref)if(dh=!1,$t.pendingProps=kt=Ft,(xt.lanes&Mt)!==0)xt.flags&131072&&(dh=!0);else return $t.lanes=xt.lanes,Zi(xt,$t,Mt)}return cj(xt,$t,Ct,kt,Mt)}function dj(xt,$t,Ct){var kt=$t.pendingProps,Mt=kt.children,Ft=xt!==null?xt.memoizedState:null;if(kt.mode==="hidden")if(!($t.mode&1))$t.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$2(ej,fj),fj|=Ct;else{if(!(Ct&1073741824))return xt=Ft!==null?Ft.baseLanes|Ct:Ct,$t.lanes=$t.childLanes=1073741824,$t.memoizedState={baseLanes:xt,cachePool:null,transitions:null},$t.updateQueue=null,G$2(ej,fj),fj|=xt,null;$t.memoizedState={baseLanes:0,cachePool:null,transitions:null},kt=Ft!==null?Ft.baseLanes:Ct,G$2(ej,fj),fj|=kt}else Ft!==null?(kt=Ft.baseLanes|Ct,$t.memoizedState=null):kt=Ct,G$2(ej,fj),fj|=kt;return Xi(xt,$t,Mt,Ct),$t.child}function gj(xt,$t){var Ct=$t.ref;(xt===null&&Ct!==null||xt!==null&&xt.ref!==Ct)&&($t.flags|=512,$t.flags|=2097152)}function cj(xt,$t,Ct,kt,Mt){var Ft=Zf(Ct)?Xf:H$2.current;return Ft=Yf($t,Ft),ch$1($t,Mt),Ct=Nh(xt,$t,Ct,kt,Ft,Mt),kt=Sh(),xt!==null&&!dh?($t.updateQueue=xt.updateQueue,$t.flags&=-2053,xt.lanes&=~Mt,Zi(xt,$t,Mt)):(I$2&&kt&&vg($t),$t.flags|=1,Xi(xt,$t,Ct,Mt),$t.child)}function hj(xt,$t,Ct,kt,Mt){if(Zf(Ct)){var Ft=!0;cg($t)}else Ft=!1;if(ch$1($t,Mt),$t.stateNode===null)ij(xt,$t),Gi($t,Ct,kt),Ii($t,Ct,kt,Mt),kt=!0;else if(xt===null){var jt=$t.stateNode,Bt=$t.memoizedProps;jt.props=Bt;var Vt=jt.context,zt=Ct.contextType;typeof zt=="object"&&zt!==null?zt=eh(zt):(zt=Zf(Ct)?Xf:H$2.current,zt=Yf($t,zt));var Ht=Ct.getDerivedStateFromProps,Gt=typeof Ht=="function"||typeof jt.getSnapshotBeforeUpdate=="function";Gt||typeof jt.UNSAFE_componentWillReceiveProps!="function"&&typeof jt.componentWillReceiveProps!="function"||(Bt!==kt||Vt!==zt)&&Hi($t,jt,kt,zt),jh=!1;var qt=$t.memoizedState;jt.state=qt,qh($t,kt,jt,Mt),Vt=$t.memoizedState,Bt!==kt||qt!==Vt||Wf.current||jh?(typeof Ht=="function"&&(Di($t,Ct,Ht,kt),Vt=$t.memoizedState),(Bt=jh||Fi($t,Ct,Bt,kt,qt,Vt,zt))?(Gt||typeof jt.UNSAFE_componentWillMount!="function"&&typeof jt.componentWillMount!="function"||(typeof jt.componentWillMount=="function"&&jt.componentWillMount(),typeof jt.UNSAFE_componentWillMount=="function"&&jt.UNSAFE_componentWillMount()),typeof jt.componentDidMount=="function"&&($t.flags|=4194308)):(typeof jt.componentDidMount=="function"&&($t.flags|=4194308),$t.memoizedProps=kt,$t.memoizedState=Vt),jt.props=kt,jt.state=Vt,jt.context=zt,kt=Bt):(typeof jt.componentDidMount=="function"&&($t.flags|=4194308),kt=!1)}else{jt=$t.stateNode,lh(xt,$t),Bt=$t.memoizedProps,zt=$t.type===$t.elementType?Bt:Ci($t.type,Bt),jt.props=zt,Gt=$t.pendingProps,qt=jt.context,Vt=Ct.contextType,typeof Vt=="object"&&Vt!==null?Vt=eh(Vt):(Vt=Zf(Ct)?Xf:H$2.current,Vt=Yf($t,Vt));var Wt=Ct.getDerivedStateFromProps;(Ht=typeof Wt=="function"||typeof jt.getSnapshotBeforeUpdate=="function")||typeof jt.UNSAFE_componentWillReceiveProps!="function"&&typeof jt.componentWillReceiveProps!="function"||(Bt!==Gt||qt!==Vt)&&Hi($t,jt,kt,Vt),jh=!1,qt=$t.memoizedState,jt.state=qt,qh($t,kt,jt,Mt);var Yt=$t.memoizedState;Bt!==Gt||qt!==Yt||Wf.current||jh?(typeof Wt=="function"&&(Di($t,Ct,Wt,kt),Yt=$t.memoizedState),(zt=jh||Fi($t,Ct,zt,kt,qt,Yt,Vt)||!1)?(Ht||typeof jt.UNSAFE_componentWillUpdate!="function"&&typeof jt.componentWillUpdate!="function"||(typeof jt.componentWillUpdate=="function"&&jt.componentWillUpdate(kt,Yt,Vt),typeof jt.UNSAFE_componentWillUpdate=="function"&&jt.UNSAFE_componentWillUpdate(kt,Yt,Vt)),typeof jt.componentDidUpdate=="function"&&($t.flags|=4),typeof jt.getSnapshotBeforeUpdate=="function"&&($t.flags|=1024)):(typeof jt.componentDidUpdate!="function"||Bt===xt.memoizedProps&&qt===xt.memoizedState||($t.flags|=4),typeof jt.getSnapshotBeforeUpdate!="function"||Bt===xt.memoizedProps&&qt===xt.memoizedState||($t.flags|=1024),$t.memoizedProps=kt,$t.memoizedState=Yt),jt.props=kt,jt.state=Yt,jt.context=Vt,kt=zt):(typeof jt.componentDidUpdate!="function"||Bt===xt.memoizedProps&&qt===xt.memoizedState||($t.flags|=4),typeof jt.getSnapshotBeforeUpdate!="function"||Bt===xt.memoizedProps&&qt===xt.memoizedState||($t.flags|=1024),kt=!1)}return jj(xt,$t,Ct,kt,Ft,Mt)}function jj(xt,$t,Ct,kt,Mt,Ft){gj(xt,$t);var jt=($t.flags&128)!==0;if(!kt&&!jt)return Mt&&dg($t,Ct,!1),Zi(xt,$t,Ft);kt=$t.stateNode,Wi.current=$t;var Bt=jt&&typeof Ct.getDerivedStateFromError!="function"?null:kt.render();return $t.flags|=1,xt!==null&&jt?($t.child=Ug($t,xt.child,null,Ft),$t.child=Ug($t,null,Bt,Ft)):Xi(xt,$t,Bt,Ft),$t.memoizedState=kt.state,Mt&&dg($t,Ct,!0),$t.child}function kj(xt){var $t=xt.stateNode;$t.pendingContext?ag(xt,$t.pendingContext,$t.pendingContext!==$t.context):$t.context&&ag(xt,$t.context,!1),yh$1(xt,$t.containerInfo)}function lj(xt,$t,Ct,kt,Mt){return Ig(),Jg(Mt),$t.flags|=256,Xi(xt,$t,Ct,kt),$t.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(xt){return{baseLanes:xt,cachePool:null,transitions:null}}function oj(xt,$t,Ct){var kt=$t.pendingProps,Mt=L$2.current,Ft=!1,jt=($t.flags&128)!==0,Bt;if((Bt=jt)||(Bt=xt!==null&&xt.memoizedState===null?!1:(Mt&2)!==0),Bt?(Ft=!0,$t.flags&=-129):(xt===null||xt.memoizedState!==null)&&(Mt|=1),G$2(L$2,Mt&1),xt===null)return Eg($t),xt=$t.memoizedState,xt!==null&&(xt=xt.dehydrated,xt!==null)?($t.mode&1?xt.data==="$!"?$t.lanes=8:$t.lanes=1073741824:$t.lanes=1,null):(jt=kt.children,xt=kt.fallback,Ft?(kt=$t.mode,Ft=$t.child,jt={mode:"hidden",children:jt},!(kt&1)&&Ft!==null?(Ft.childLanes=0,Ft.pendingProps=jt):Ft=pj(jt,kt,0,null),xt=Tg(xt,kt,Ct,null),Ft.return=$t,xt.return=$t,Ft.sibling=xt,$t.child=Ft,$t.child.memoizedState=nj(Ct),$t.memoizedState=mj,xt):qj($t,jt));if(Mt=xt.memoizedState,Mt!==null&&(Bt=Mt.dehydrated,Bt!==null))return rj(xt,$t,jt,kt,Bt,Mt,Ct);if(Ft){Ft=kt.fallback,jt=$t.mode,Mt=xt.child,Bt=Mt.sibling;var Vt={mode:"hidden",children:kt.children};return!(jt&1)&&$t.child!==Mt?(kt=$t.child,kt.childLanes=0,kt.pendingProps=Vt,$t.deletions=null):(kt=Pg(Mt,Vt),kt.subtreeFlags=Mt.subtreeFlags&14680064),Bt!==null?Ft=Pg(Bt,Ft):(Ft=Tg(Ft,jt,Ct,null),Ft.flags|=2),Ft.return=$t,kt.return=$t,kt.sibling=Ft,$t.child=kt,kt=Ft,Ft=$t.child,jt=xt.child.memoizedState,jt=jt===null?nj(Ct):{baseLanes:jt.baseLanes|Ct,cachePool:null,transitions:jt.transitions},Ft.memoizedState=jt,Ft.childLanes=xt.childLanes&~Ct,$t.memoizedState=mj,kt}return Ft=xt.child,xt=Ft.sibling,kt=Pg(Ft,{mode:"visible",children:kt.children}),!($t.mode&1)&&(kt.lanes=Ct),kt.return=$t,kt.sibling=null,xt!==null&&(Ct=$t.deletions,Ct===null?($t.deletions=[xt],$t.flags|=16):Ct.push(xt)),$t.child=kt,$t.memoizedState=null,kt}function qj(xt,$t){return $t=pj({mode:"visible",children:$t},xt.mode,0,null),$t.return=xt,xt.child=$t}function sj(xt,$t,Ct,kt){return kt!==null&&Jg(kt),Ug($t,xt.child,null,Ct),xt=qj($t,$t.pendingProps.children),xt.flags|=2,$t.memoizedState=null,xt}function rj(xt,$t,Ct,kt,Mt,Ft,jt){if(Ct)return $t.flags&256?($t.flags&=-257,kt=Ki(Error(p$2(422))),sj(xt,$t,jt,kt)):$t.memoizedState!==null?($t.child=xt.child,$t.flags|=128,null):(Ft=kt.fallback,Mt=$t.mode,kt=pj({mode:"visible",children:kt.children},Mt,0,null),Ft=Tg(Ft,Mt,jt,null),Ft.flags|=2,kt.return=$t,Ft.return=$t,kt.sibling=Ft,$t.child=kt,$t.mode&1&&Ug($t,xt.child,null,jt),$t.child.memoizedState=nj(jt),$t.memoizedState=mj,Ft);if(!($t.mode&1))return sj(xt,$t,jt,null);if(Mt.data==="$!"){if(kt=Mt.nextSibling&&Mt.nextSibling.dataset,kt)var Bt=kt.dgst;return kt=Bt,Ft=Error(p$2(419)),kt=Ki(Ft,kt,void 0),sj(xt,$t,jt,kt)}if(Bt=(jt&xt.childLanes)!==0,dh||Bt){if(kt=Q$2,kt!==null){switch(jt&-jt){case 4:Mt=2;break;case 16:Mt=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Mt=32;break;case 536870912:Mt=268435456;break;default:Mt=0}Mt=Mt&(kt.suspendedLanes|jt)?0:Mt,Mt!==0&&Mt!==Ft.retryLane&&(Ft.retryLane=Mt,ih(xt,Mt),gi(kt,xt,Mt,-1))}return tj(),kt=Ki(Error(p$2(421))),sj(xt,$t,jt,kt)}return Mt.data==="$?"?($t.flags|=128,$t.child=xt.child,$t=uj.bind(null,xt),Mt._reactRetry=$t,null):(xt=Ft.treeContext,yg=Lf(Mt.nextSibling),xg=$t,I$2=!0,zg=null,xt!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=xt.id,sg=xt.overflow,qg=$t),$t=qj($t,kt.children),$t.flags|=4096,$t)}function vj(xt,$t,Ct){xt.lanes|=$t;var kt=xt.alternate;kt!==null&&(kt.lanes|=$t),bh(xt.return,$t,Ct)}function wj(xt,$t,Ct,kt,Mt){var Ft=xt.memoizedState;Ft===null?xt.memoizedState={isBackwards:$t,rendering:null,renderingStartTime:0,last:kt,tail:Ct,tailMode:Mt}:(Ft.isBackwards=$t,Ft.rendering=null,Ft.renderingStartTime=0,Ft.last=kt,Ft.tail=Ct,Ft.tailMode=Mt)}function xj(xt,$t,Ct){var kt=$t.pendingProps,Mt=kt.revealOrder,Ft=kt.tail;if(Xi(xt,$t,kt.children,Ct),kt=L$2.current,kt&2)kt=kt&1|2,$t.flags|=128;else{if(xt!==null&&xt.flags&128)e:for(xt=$t.child;xt!==null;){if(xt.tag===13)xt.memoizedState!==null&&vj(xt,Ct,$t);else if(xt.tag===19)vj(xt,Ct,$t);else if(xt.child!==null){xt.child.return=xt,xt=xt.child;continue}if(xt===$t)break e;for(;xt.sibling===null;){if(xt.return===null||xt.return===$t)break e;xt=xt.return}xt.sibling.return=xt.return,xt=xt.sibling}kt&=1}if(G$2(L$2,kt),!($t.mode&1))$t.memoizedState=null;else switch(Mt){case"forwards":for(Ct=$t.child,Mt=null;Ct!==null;)xt=Ct.alternate,xt!==null&&Ch(xt)===null&&(Mt=Ct),Ct=Ct.sibling;Ct=Mt,Ct===null?(Mt=$t.child,$t.child=null):(Mt=Ct.sibling,Ct.sibling=null),wj($t,!1,Mt,Ct,Ft);break;case"backwards":for(Ct=null,Mt=$t.child,$t.child=null;Mt!==null;){if(xt=Mt.alternate,xt!==null&&Ch(xt)===null){$t.child=Mt;break}xt=Mt.sibling,Mt.sibling=Ct,Ct=Mt,Mt=xt}wj($t,!0,Ct,null,Ft);break;case"together":wj($t,!1,null,null,void 0);break;default:$t.memoizedState=null}return $t.child}function ij(xt,$t){!($t.mode&1)&&xt!==null&&(xt.alternate=null,$t.alternate=null,$t.flags|=2)}function Zi(xt,$t,Ct){if(xt!==null&&($t.dependencies=xt.dependencies),rh|=$t.lanes,!(Ct&$t.childLanes))return null;if(xt!==null&&$t.child!==xt.child)throw Error(p$2(153));if($t.child!==null){for(xt=$t.child,Ct=Pg(xt,xt.pendingProps),$t.child=Ct,Ct.return=$t;xt.sibling!==null;)xt=xt.sibling,Ct=Ct.sibling=Pg(xt,xt.pendingProps),Ct.return=$t;Ct.sibling=null}return $t.child}function yj(xt,$t,Ct){switch($t.tag){case 3:kj($t),Ig();break;case 5:Ah($t);break;case 1:Zf($t.type)&&cg($t);break;case 4:yh$1($t,$t.stateNode.containerInfo);break;case 10:var kt=$t.type._context,Mt=$t.memoizedProps.value;G$2(Wg,kt._currentValue),kt._currentValue=Mt;break;case 13:if(kt=$t.memoizedState,kt!==null)return kt.dehydrated!==null?(G$2(L$2,L$2.current&1),$t.flags|=128,null):Ct&$t.child.childLanes?oj(xt,$t,Ct):(G$2(L$2,L$2.current&1),xt=Zi(xt,$t,Ct),xt!==null?xt.sibling:null);G$2(L$2,L$2.current&1);break;case 19:if(kt=(Ct&$t.childLanes)!==0,xt.flags&128){if(kt)return xj(xt,$t,Ct);$t.flags|=128}if(Mt=$t.memoizedState,Mt!==null&&(Mt.rendering=null,Mt.tail=null,Mt.lastEffect=null),G$2(L$2,L$2.current),kt)break;return null;case 22:case 23:return $t.lanes=0,dj(xt,$t,Ct)}return Zi(xt,$t,Ct)}var zj,Aj,Bj,Cj;zj=function(xt,$t){for(var Ct=$t.child;Ct!==null;){if(Ct.tag===5||Ct.tag===6)xt.appendChild(Ct.stateNode);else if(Ct.tag!==4&&Ct.child!==null){Ct.child.return=Ct,Ct=Ct.child;continue}if(Ct===$t)break;for(;Ct.sibling===null;){if(Ct.return===null||Ct.return===$t)return;Ct=Ct.return}Ct.sibling.return=Ct.return,Ct=Ct.sibling}};Aj=function(){};Bj=function(xt,$t,Ct,kt){var Mt=xt.memoizedProps;if(Mt!==kt){xt=$t.stateNode,xh(uh.current);var Ft=null;switch(Ct){case"input":Mt=Ya(xt,Mt),kt=Ya(xt,kt),Ft=[];break;case"select":Mt=A$2({},Mt,{value:void 0}),kt=A$2({},kt,{value:void 0}),Ft=[];break;case"textarea":Mt=gb(xt,Mt),kt=gb(xt,kt),Ft=[];break;default:typeof Mt.onClick!="function"&&typeof kt.onClick=="function"&&(xt.onclick=Bf)}ub(Ct,kt);var jt;Ct=null;for(zt in Mt)if(!kt.hasOwnProperty(zt)&&Mt.hasOwnProperty(zt)&&Mt[zt]!=null)if(zt==="style"){var Bt=Mt[zt];for(jt in Bt)Bt.hasOwnProperty(jt)&&(Ct||(Ct={}),Ct[jt]="")}else zt!=="dangerouslySetInnerHTML"&&zt!=="children"&&zt!=="suppressContentEditableWarning"&&zt!=="suppressHydrationWarning"&&zt!=="autoFocus"&&(ea$1.hasOwnProperty(zt)?Ft||(Ft=[]):(Ft=Ft||[]).push(zt,null));for(zt in kt){var Vt=kt[zt];if(Bt=Mt!=null?Mt[zt]:void 0,kt.hasOwnProperty(zt)&&Vt!==Bt&&(Vt!=null||Bt!=null))if(zt==="style")if(Bt){for(jt in Bt)!Bt.hasOwnProperty(jt)||Vt&&Vt.hasOwnProperty(jt)||(Ct||(Ct={}),Ct[jt]="");for(jt in Vt)Vt.hasOwnProperty(jt)&&Bt[jt]!==Vt[jt]&&(Ct||(Ct={}),Ct[jt]=Vt[jt])}else Ct||(Ft||(Ft=[]),Ft.push(zt,Ct)),Ct=Vt;else zt==="dangerouslySetInnerHTML"?(Vt=Vt?Vt.__html:void 0,Bt=Bt?Bt.__html:void 0,Vt!=null&&Bt!==Vt&&(Ft=Ft||[]).push(zt,Vt)):zt==="children"?typeof Vt!="string"&&typeof Vt!="number"||(Ft=Ft||[]).push(zt,""+Vt):zt!=="suppressContentEditableWarning"&&zt!=="suppressHydrationWarning"&&(ea$1.hasOwnProperty(zt)?(Vt!=null&&zt==="onScroll"&&D$5("scroll",xt),Ft||Bt===Vt||(Ft=[])):(Ft=Ft||[]).push(zt,Vt))}Ct&&(Ft=Ft||[]).push("style",Ct);var zt=Ft;($t.updateQueue=zt)&&($t.flags|=4)}};Cj=function(xt,$t,Ct,kt){Ct!==kt&&($t.flags|=4)};function Dj(xt,$t){if(!I$2)switch(xt.tailMode){case"hidden":$t=xt.tail;for(var Ct=null;$t!==null;)$t.alternate!==null&&(Ct=$t),$t=$t.sibling;Ct===null?xt.tail=null:Ct.sibling=null;break;case"collapsed":Ct=xt.tail;for(var kt=null;Ct!==null;)Ct.alternate!==null&&(kt=Ct),Ct=Ct.sibling;kt===null?$t||xt.tail===null?xt.tail=null:xt.tail.sibling=null:kt.sibling=null}}function S$3(xt){var $t=xt.alternate!==null&&xt.alternate.child===xt.child,Ct=0,kt=0;if($t)for(var Mt=xt.child;Mt!==null;)Ct|=Mt.lanes|Mt.childLanes,kt|=Mt.subtreeFlags&14680064,kt|=Mt.flags&14680064,Mt.return=xt,Mt=Mt.sibling;else for(Mt=xt.child;Mt!==null;)Ct|=Mt.lanes|Mt.childLanes,kt|=Mt.subtreeFlags,kt|=Mt.flags,Mt.return=xt,Mt=Mt.sibling;return xt.subtreeFlags|=kt,xt.childLanes=Ct,$t}function Ej(xt,$t,Ct){var kt=$t.pendingProps;switch(wg($t),$t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$3($t),null;case 1:return Zf($t.type)&&$f(),S$3($t),null;case 3:return kt=$t.stateNode,zh(),E$3(Wf),E$3(H$2),Eh(),kt.pendingContext&&(kt.context=kt.pendingContext,kt.pendingContext=null),(xt===null||xt.child===null)&&(Gg($t)?$t.flags|=4:xt===null||xt.memoizedState.isDehydrated&&!($t.flags&256)||($t.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(xt,$t),S$3($t),null;case 5:Bh($t);var Mt=xh(wh.current);if(Ct=$t.type,xt!==null&&$t.stateNode!=null)Bj(xt,$t,Ct,kt,Mt),xt.ref!==$t.ref&&($t.flags|=512,$t.flags|=2097152);else{if(!kt){if($t.stateNode===null)throw Error(p$2(166));return S$3($t),null}if(xt=xh(uh.current),Gg($t)){kt=$t.stateNode,Ct=$t.type;var Ft=$t.memoizedProps;switch(kt[Of]=$t,kt[Pf]=Ft,xt=($t.mode&1)!==0,Ct){case"dialog":D$5("cancel",kt),D$5("close",kt);break;case"iframe":case"object":case"embed":D$5("load",kt);break;case"video":case"audio":for(Mt=0;Mt<lf.length;Mt++)D$5(lf[Mt],kt);break;case"source":D$5("error",kt);break;case"img":case"image":case"link":D$5("error",kt),D$5("load",kt);break;case"details":D$5("toggle",kt);break;case"input":Za(kt,Ft),D$5("invalid",kt);break;case"select":kt._wrapperState={wasMultiple:!!Ft.multiple},D$5("invalid",kt);break;case"textarea":hb(kt,Ft),D$5("invalid",kt)}ub(Ct,Ft),Mt=null;for(var jt in Ft)if(Ft.hasOwnProperty(jt)){var Bt=Ft[jt];jt==="children"?typeof Bt=="string"?kt.textContent!==Bt&&(Ft.suppressHydrationWarning!==!0&&Af(kt.textContent,Bt,xt),Mt=["children",Bt]):typeof Bt=="number"&&kt.textContent!==""+Bt&&(Ft.suppressHydrationWarning!==!0&&Af(kt.textContent,Bt,xt),Mt=["children",""+Bt]):ea$1.hasOwnProperty(jt)&&Bt!=null&&jt==="onScroll"&&D$5("scroll",kt)}switch(Ct){case"input":Va(kt),db(kt,Ft,!0);break;case"textarea":Va(kt),jb(kt);break;case"select":case"option":break;default:typeof Ft.onClick=="function"&&(kt.onclick=Bf)}kt=Mt,$t.updateQueue=kt,kt!==null&&($t.flags|=4)}else{jt=Mt.nodeType===9?Mt:Mt.ownerDocument,xt==="http://www.w3.org/1999/xhtml"&&(xt=kb(Ct)),xt==="http://www.w3.org/1999/xhtml"?Ct==="script"?(xt=jt.createElement("div"),xt.innerHTML="<script><\/script>",xt=xt.removeChild(xt.firstChild)):typeof kt.is=="string"?xt=jt.createElement(Ct,{is:kt.is}):(xt=jt.createElement(Ct),Ct==="select"&&(jt=xt,kt.multiple?jt.multiple=!0:kt.size&&(jt.size=kt.size))):xt=jt.createElementNS(xt,Ct),xt[Of]=$t,xt[Pf]=kt,zj(xt,$t,!1,!1),$t.stateNode=xt;e:{switch(jt=vb(Ct,kt),Ct){case"dialog":D$5("cancel",xt),D$5("close",xt),Mt=kt;break;case"iframe":case"object":case"embed":D$5("load",xt),Mt=kt;break;case"video":case"audio":for(Mt=0;Mt<lf.length;Mt++)D$5(lf[Mt],xt);Mt=kt;break;case"source":D$5("error",xt),Mt=kt;break;case"img":case"image":case"link":D$5("error",xt),D$5("load",xt),Mt=kt;break;case"details":D$5("toggle",xt),Mt=kt;break;case"input":Za(xt,kt),Mt=Ya(xt,kt),D$5("invalid",xt);break;case"option":Mt=kt;break;case"select":xt._wrapperState={wasMultiple:!!kt.multiple},Mt=A$2({},kt,{value:void 0}),D$5("invalid",xt);break;case"textarea":hb(xt,kt),Mt=gb(xt,kt),D$5("invalid",xt);break;default:Mt=kt}ub(Ct,Mt),Bt=Mt;for(Ft in Bt)if(Bt.hasOwnProperty(Ft)){var Vt=Bt[Ft];Ft==="style"?sb(xt,Vt):Ft==="dangerouslySetInnerHTML"?(Vt=Vt?Vt.__html:void 0,Vt!=null&&nb(xt,Vt)):Ft==="children"?typeof Vt=="string"?(Ct!=="textarea"||Vt!=="")&&ob(xt,Vt):typeof Vt=="number"&&ob(xt,""+Vt):Ft!=="suppressContentEditableWarning"&&Ft!=="suppressHydrationWarning"&&Ft!=="autoFocus"&&(ea$1.hasOwnProperty(Ft)?Vt!=null&&Ft==="onScroll"&&D$5("scroll",xt):Vt!=null&&ta(xt,Ft,Vt,jt))}switch(Ct){case"input":Va(xt),db(xt,kt,!1);break;case"textarea":Va(xt),jb(xt);break;case"option":kt.value!=null&&xt.setAttribute("value",""+Sa(kt.value));break;case"select":xt.multiple=!!kt.multiple,Ft=kt.value,Ft!=null?fb(xt,!!kt.multiple,Ft,!1):kt.defaultValue!=null&&fb(xt,!!kt.multiple,kt.defaultValue,!0);break;default:typeof Mt.onClick=="function"&&(xt.onclick=Bf)}switch(Ct){case"button":case"input":case"select":case"textarea":kt=!!kt.autoFocus;break e;case"img":kt=!0;break e;default:kt=!1}}kt&&($t.flags|=4)}$t.ref!==null&&($t.flags|=512,$t.flags|=2097152)}return S$3($t),null;case 6:if(xt&&$t.stateNode!=null)Cj(xt,$t,xt.memoizedProps,kt);else{if(typeof kt!="string"&&$t.stateNode===null)throw Error(p$2(166));if(Ct=xh(wh.current),xh(uh.current),Gg($t)){if(kt=$t.stateNode,Ct=$t.memoizedProps,kt[Of]=$t,(Ft=kt.nodeValue!==Ct)&&(xt=xg,xt!==null))switch(xt.tag){case 3:Af(kt.nodeValue,Ct,(xt.mode&1)!==0);break;case 5:xt.memoizedProps.suppressHydrationWarning!==!0&&Af(kt.nodeValue,Ct,(xt.mode&1)!==0)}Ft&&($t.flags|=4)}else kt=(Ct.nodeType===9?Ct:Ct.ownerDocument).createTextNode(kt),kt[Of]=$t,$t.stateNode=kt}return S$3($t),null;case 13:if(E$3(L$2),kt=$t.memoizedState,xt===null||xt.memoizedState!==null&&xt.memoizedState.dehydrated!==null){if(I$2&&yg!==null&&$t.mode&1&&!($t.flags&128))Hg(),Ig(),$t.flags|=98560,Ft=!1;else if(Ft=Gg($t),kt!==null&&kt.dehydrated!==null){if(xt===null){if(!Ft)throw Error(p$2(318));if(Ft=$t.memoizedState,Ft=Ft!==null?Ft.dehydrated:null,!Ft)throw Error(p$2(317));Ft[Of]=$t}else Ig(),!($t.flags&128)&&($t.memoizedState=null),$t.flags|=4;S$3($t),Ft=!1}else zg!==null&&(Fj(zg),zg=null),Ft=!0;if(!Ft)return $t.flags&65536?$t:null}return $t.flags&128?($t.lanes=Ct,$t):(kt=kt!==null,kt!==(xt!==null&&xt.memoizedState!==null)&&kt&&($t.child.flags|=8192,$t.mode&1&&(xt===null||L$2.current&1?T$1===0&&(T$1=3):tj())),$t.updateQueue!==null&&($t.flags|=4),S$3($t),null);case 4:return zh(),Aj(xt,$t),xt===null&&sf($t.stateNode.containerInfo),S$3($t),null;case 10:return ah($t.type._context),S$3($t),null;case 17:return Zf($t.type)&&$f(),S$3($t),null;case 19:if(E$3(L$2),Ft=$t.memoizedState,Ft===null)return S$3($t),null;if(kt=($t.flags&128)!==0,jt=Ft.rendering,jt===null)if(kt)Dj(Ft,!1);else{if(T$1!==0||xt!==null&&xt.flags&128)for(xt=$t.child;xt!==null;){if(jt=Ch(xt),jt!==null){for($t.flags|=128,Dj(Ft,!1),kt=jt.updateQueue,kt!==null&&($t.updateQueue=kt,$t.flags|=4),$t.subtreeFlags=0,kt=Ct,Ct=$t.child;Ct!==null;)Ft=Ct,xt=kt,Ft.flags&=14680066,jt=Ft.alternate,jt===null?(Ft.childLanes=0,Ft.lanes=xt,Ft.child=null,Ft.subtreeFlags=0,Ft.memoizedProps=null,Ft.memoizedState=null,Ft.updateQueue=null,Ft.dependencies=null,Ft.stateNode=null):(Ft.childLanes=jt.childLanes,Ft.lanes=jt.lanes,Ft.child=jt.child,Ft.subtreeFlags=0,Ft.deletions=null,Ft.memoizedProps=jt.memoizedProps,Ft.memoizedState=jt.memoizedState,Ft.updateQueue=jt.updateQueue,Ft.type=jt.type,xt=jt.dependencies,Ft.dependencies=xt===null?null:{lanes:xt.lanes,firstContext:xt.firstContext}),Ct=Ct.sibling;return G$2(L$2,L$2.current&1|2),$t.child}xt=xt.sibling}Ft.tail!==null&&B$4()>Gj&&($t.flags|=128,kt=!0,Dj(Ft,!1),$t.lanes=4194304)}else{if(!kt)if(xt=Ch(jt),xt!==null){if($t.flags|=128,kt=!0,Ct=xt.updateQueue,Ct!==null&&($t.updateQueue=Ct,$t.flags|=4),Dj(Ft,!0),Ft.tail===null&&Ft.tailMode==="hidden"&&!jt.alternate&&!I$2)return S$3($t),null}else 2*B$4()-Ft.renderingStartTime>Gj&&Ct!==1073741824&&($t.flags|=128,kt=!0,Dj(Ft,!1),$t.lanes=4194304);Ft.isBackwards?(jt.sibling=$t.child,$t.child=jt):(Ct=Ft.last,Ct!==null?Ct.sibling=jt:$t.child=jt,Ft.last=jt)}return Ft.tail!==null?($t=Ft.tail,Ft.rendering=$t,Ft.tail=$t.sibling,Ft.renderingStartTime=B$4(),$t.sibling=null,Ct=L$2.current,G$2(L$2,kt?Ct&1|2:Ct&1),$t):(S$3($t),null);case 22:case 23:return Hj(),kt=$t.memoizedState!==null,xt!==null&&xt.memoizedState!==null!==kt&&($t.flags|=8192),kt&&$t.mode&1?fj&1073741824&&(S$3($t),$t.subtreeFlags&6&&($t.flags|=8192)):S$3($t),null;case 24:return null;case 25:return null}throw Error(p$2(156,$t.tag))}function Ij(xt,$t){switch(wg($t),$t.tag){case 1:return Zf($t.type)&&$f(),xt=$t.flags,xt&65536?($t.flags=xt&-65537|128,$t):null;case 3:return zh(),E$3(Wf),E$3(H$2),Eh(),xt=$t.flags,xt&65536&&!(xt&128)?($t.flags=xt&-65537|128,$t):null;case 5:return Bh($t),null;case 13:if(E$3(L$2),xt=$t.memoizedState,xt!==null&&xt.dehydrated!==null){if($t.alternate===null)throw Error(p$2(340));Ig()}return xt=$t.flags,xt&65536?($t.flags=xt&-65537|128,$t):null;case 19:return E$3(L$2),null;case 4:return zh(),null;case 10:return ah($t.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U$2=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V$1=null;function Lj(xt,$t){var Ct=xt.ref;if(Ct!==null)if(typeof Ct=="function")try{Ct(null)}catch(kt){W$2(xt,$t,kt)}else Ct.current=null}function Mj(xt,$t,Ct){try{Ct()}catch(kt){W$2(xt,$t,kt)}}var Nj=!1;function Oj(xt,$t){if(Cf=dd,xt=Me$1(),Ne$1(xt)){if("selectionStart"in xt)var Ct={start:xt.selectionStart,end:xt.selectionEnd};else e:{Ct=(Ct=xt.ownerDocument)&&Ct.defaultView||window;var kt=Ct.getSelection&&Ct.getSelection();if(kt&&kt.rangeCount!==0){Ct=kt.anchorNode;var Mt=kt.anchorOffset,Ft=kt.focusNode;kt=kt.focusOffset;try{Ct.nodeType,Ft.nodeType}catch{Ct=null;break e}var jt=0,Bt=-1,Vt=-1,zt=0,Ht=0,Gt=xt,qt=null;t:for(;;){for(var Wt;Gt!==Ct||Mt!==0&&Gt.nodeType!==3||(Bt=jt+Mt),Gt!==Ft||kt!==0&&Gt.nodeType!==3||(Vt=jt+kt),Gt.nodeType===3&&(jt+=Gt.nodeValue.length),(Wt=Gt.firstChild)!==null;)qt=Gt,Gt=Wt;for(;;){if(Gt===xt)break t;if(qt===Ct&&++zt===Mt&&(Bt=jt),qt===Ft&&++Ht===kt&&(Vt=jt),(Wt=Gt.nextSibling)!==null)break;Gt=qt,qt=Gt.parentNode}Gt=Wt}Ct=Bt===-1||Vt===-1?null:{start:Bt,end:Vt}}else Ct=null}Ct=Ct||{start:0,end:0}}else Ct=null;for(Df={focusedElem:xt,selectionRange:Ct},dd=!1,V$1=$t;V$1!==null;)if($t=V$1,xt=$t.child,($t.subtreeFlags&1028)!==0&&xt!==null)xt.return=$t,V$1=xt;else for(;V$1!==null;){$t=V$1;try{var Yt=$t.alternate;if($t.flags&1024)switch($t.tag){case 0:case 11:case 15:break;case 1:if(Yt!==null){var Kt=Yt.memoizedProps,Xt=Yt.memoizedState,Qt=$t.stateNode,Jt=Qt.getSnapshotBeforeUpdate($t.elementType===$t.type?Kt:Ci($t.type,Kt),Xt);Qt.__reactInternalSnapshotBeforeUpdate=Jt}break;case 3:var Zt=$t.stateNode.containerInfo;Zt.nodeType===1?Zt.textContent="":Zt.nodeType===9&&Zt.documentElement&&Zt.removeChild(Zt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$2(163))}}catch(sn){W$2($t,$t.return,sn)}if(xt=$t.sibling,xt!==null){xt.return=$t.return,V$1=xt;break}V$1=$t.return}return Yt=Nj,Nj=!1,Yt}function Pj(xt,$t,Ct){var kt=$t.updateQueue;if(kt=kt!==null?kt.lastEffect:null,kt!==null){var Mt=kt=kt.next;do{if((Mt.tag&xt)===xt){var Ft=Mt.destroy;Mt.destroy=void 0,Ft!==void 0&&Mj($t,Ct,Ft)}Mt=Mt.next}while(Mt!==kt)}}function Qj(xt,$t){if($t=$t.updateQueue,$t=$t!==null?$t.lastEffect:null,$t!==null){var Ct=$t=$t.next;do{if((Ct.tag&xt)===xt){var kt=Ct.create;Ct.destroy=kt()}Ct=Ct.next}while(Ct!==$t)}}function Rj(xt){var $t=xt.ref;if($t!==null){var Ct=xt.stateNode;switch(xt.tag){case 5:xt=Ct;break;default:xt=Ct}typeof $t=="function"?$t(xt):$t.current=xt}}function Sj(xt){var $t=xt.alternate;$t!==null&&(xt.alternate=null,Sj($t)),xt.child=null,xt.deletions=null,xt.sibling=null,xt.tag===5&&($t=xt.stateNode,$t!==null&&(delete $t[Of],delete $t[Pf],delete $t[of],delete $t[Qf],delete $t[Rf])),xt.stateNode=null,xt.return=null,xt.dependencies=null,xt.memoizedProps=null,xt.memoizedState=null,xt.pendingProps=null,xt.stateNode=null,xt.updateQueue=null}function Tj(xt){return xt.tag===5||xt.tag===3||xt.tag===4}function Uj(xt){e:for(;;){for(;xt.sibling===null;){if(xt.return===null||Tj(xt.return))return null;xt=xt.return}for(xt.sibling.return=xt.return,xt=xt.sibling;xt.tag!==5&&xt.tag!==6&&xt.tag!==18;){if(xt.flags&2||xt.child===null||xt.tag===4)continue e;xt.child.return=xt,xt=xt.child}if(!(xt.flags&2))return xt.stateNode}}function Vj(xt,$t,Ct){var kt=xt.tag;if(kt===5||kt===6)xt=xt.stateNode,$t?Ct.nodeType===8?Ct.parentNode.insertBefore(xt,$t):Ct.insertBefore(xt,$t):(Ct.nodeType===8?($t=Ct.parentNode,$t.insertBefore(xt,Ct)):($t=Ct,$t.appendChild(xt)),Ct=Ct._reactRootContainer,Ct!=null||$t.onclick!==null||($t.onclick=Bf));else if(kt!==4&&(xt=xt.child,xt!==null))for(Vj(xt,$t,Ct),xt=xt.sibling;xt!==null;)Vj(xt,$t,Ct),xt=xt.sibling}function Wj(xt,$t,Ct){var kt=xt.tag;if(kt===5||kt===6)xt=xt.stateNode,$t?Ct.insertBefore(xt,$t):Ct.appendChild(xt);else if(kt!==4&&(xt=xt.child,xt!==null))for(Wj(xt,$t,Ct),xt=xt.sibling;xt!==null;)Wj(xt,$t,Ct),xt=xt.sibling}var X$5=null,Xj=!1;function Yj(xt,$t,Ct){for(Ct=Ct.child;Ct!==null;)Zj(xt,$t,Ct),Ct=Ct.sibling}function Zj(xt,$t,Ct){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,Ct)}catch{}switch(Ct.tag){case 5:U$2||Lj(Ct,$t);case 6:var kt=X$5,Mt=Xj;X$5=null,Yj(xt,$t,Ct),X$5=kt,Xj=Mt,X$5!==null&&(Xj?(xt=X$5,Ct=Ct.stateNode,xt.nodeType===8?xt.parentNode.removeChild(Ct):xt.removeChild(Ct)):X$5.removeChild(Ct.stateNode));break;case 18:X$5!==null&&(Xj?(xt=X$5,Ct=Ct.stateNode,xt.nodeType===8?Kf(xt.parentNode,Ct):xt.nodeType===1&&Kf(xt,Ct),bd(xt)):Kf(X$5,Ct.stateNode));break;case 4:kt=X$5,Mt=Xj,X$5=Ct.stateNode.containerInfo,Xj=!0,Yj(xt,$t,Ct),X$5=kt,Xj=Mt;break;case 0:case 11:case 14:case 15:if(!U$2&&(kt=Ct.updateQueue,kt!==null&&(kt=kt.lastEffect,kt!==null))){Mt=kt=kt.next;do{var Ft=Mt,jt=Ft.destroy;Ft=Ft.tag,jt!==void 0&&(Ft&2||Ft&4)&&Mj(Ct,$t,jt),Mt=Mt.next}while(Mt!==kt)}Yj(xt,$t,Ct);break;case 1:if(!U$2&&(Lj(Ct,$t),kt=Ct.stateNode,typeof kt.componentWillUnmount=="function"))try{kt.props=Ct.memoizedProps,kt.state=Ct.memoizedState,kt.componentWillUnmount()}catch(Bt){W$2(Ct,$t,Bt)}Yj(xt,$t,Ct);break;case 21:Yj(xt,$t,Ct);break;case 22:Ct.mode&1?(U$2=(kt=U$2)||Ct.memoizedState!==null,Yj(xt,$t,Ct),U$2=kt):Yj(xt,$t,Ct);break;default:Yj(xt,$t,Ct)}}function ak(xt){var $t=xt.updateQueue;if($t!==null){xt.updateQueue=null;var Ct=xt.stateNode;Ct===null&&(Ct=xt.stateNode=new Kj),$t.forEach(function(kt){var Mt=bk.bind(null,xt,kt);Ct.has(kt)||(Ct.add(kt),kt.then(Mt,Mt))})}}function ck(xt,$t){var Ct=$t.deletions;if(Ct!==null)for(var kt=0;kt<Ct.length;kt++){var Mt=Ct[kt];try{var Ft=xt,jt=$t,Bt=jt;e:for(;Bt!==null;){switch(Bt.tag){case 5:X$5=Bt.stateNode,Xj=!1;break e;case 3:X$5=Bt.stateNode.containerInfo,Xj=!0;break e;case 4:X$5=Bt.stateNode.containerInfo,Xj=!0;break e}Bt=Bt.return}if(X$5===null)throw Error(p$2(160));Zj(Ft,jt,Mt),X$5=null,Xj=!1;var Vt=Mt.alternate;Vt!==null&&(Vt.return=null),Mt.return=null}catch(zt){W$2(Mt,$t,zt)}}if($t.subtreeFlags&12854)for($t=$t.child;$t!==null;)dk($t,xt),$t=$t.sibling}function dk(xt,$t){var Ct=xt.alternate,kt=xt.flags;switch(xt.tag){case 0:case 11:case 14:case 15:if(ck($t,xt),ek(xt),kt&4){try{Pj(3,xt,xt.return),Qj(3,xt)}catch(Kt){W$2(xt,xt.return,Kt)}try{Pj(5,xt,xt.return)}catch(Kt){W$2(xt,xt.return,Kt)}}break;case 1:ck($t,xt),ek(xt),kt&512&&Ct!==null&&Lj(Ct,Ct.return);break;case 5:if(ck($t,xt),ek(xt),kt&512&&Ct!==null&&Lj(Ct,Ct.return),xt.flags&32){var Mt=xt.stateNode;try{ob(Mt,"")}catch(Kt){W$2(xt,xt.return,Kt)}}if(kt&4&&(Mt=xt.stateNode,Mt!=null)){var Ft=xt.memoizedProps,jt=Ct!==null?Ct.memoizedProps:Ft,Bt=xt.type,Vt=xt.updateQueue;if(xt.updateQueue=null,Vt!==null)try{Bt==="input"&&Ft.type==="radio"&&Ft.name!=null&&ab(Mt,Ft),vb(Bt,jt);var zt=vb(Bt,Ft);for(jt=0;jt<Vt.length;jt+=2){var Ht=Vt[jt],Gt=Vt[jt+1];Ht==="style"?sb(Mt,Gt):Ht==="dangerouslySetInnerHTML"?nb(Mt,Gt):Ht==="children"?ob(Mt,Gt):ta(Mt,Ht,Gt,zt)}switch(Bt){case"input":bb(Mt,Ft);break;case"textarea":ib(Mt,Ft);break;case"select":var qt=Mt._wrapperState.wasMultiple;Mt._wrapperState.wasMultiple=!!Ft.multiple;var Wt=Ft.value;Wt!=null?fb(Mt,!!Ft.multiple,Wt,!1):qt!==!!Ft.multiple&&(Ft.defaultValue!=null?fb(Mt,!!Ft.multiple,Ft.defaultValue,!0):fb(Mt,!!Ft.multiple,Ft.multiple?[]:"",!1))}Mt[Pf]=Ft}catch(Kt){W$2(xt,xt.return,Kt)}}break;case 6:if(ck($t,xt),ek(xt),kt&4){if(xt.stateNode===null)throw Error(p$2(162));Mt=xt.stateNode,Ft=xt.memoizedProps;try{Mt.nodeValue=Ft}catch(Kt){W$2(xt,xt.return,Kt)}}break;case 3:if(ck($t,xt),ek(xt),kt&4&&Ct!==null&&Ct.memoizedState.isDehydrated)try{bd($t.containerInfo)}catch(Kt){W$2(xt,xt.return,Kt)}break;case 4:ck($t,xt),ek(xt);break;case 13:ck($t,xt),ek(xt),Mt=xt.child,Mt.flags&8192&&(Ft=Mt.memoizedState!==null,Mt.stateNode.isHidden=Ft,!Ft||Mt.alternate!==null&&Mt.alternate.memoizedState!==null||(fk=B$4())),kt&4&&ak(xt);break;case 22:if(Ht=Ct!==null&&Ct.memoizedState!==null,xt.mode&1?(U$2=(zt=U$2)||Ht,ck($t,xt),U$2=zt):ck($t,xt),ek(xt),kt&8192){if(zt=xt.memoizedState!==null,(xt.stateNode.isHidden=zt)&&!Ht&&xt.mode&1)for(V$1=xt,Ht=xt.child;Ht!==null;){for(Gt=V$1=Ht;V$1!==null;){switch(qt=V$1,Wt=qt.child,qt.tag){case 0:case 11:case 14:case 15:Pj(4,qt,qt.return);break;case 1:Lj(qt,qt.return);var Yt=qt.stateNode;if(typeof Yt.componentWillUnmount=="function"){kt=qt,Ct=qt.return;try{$t=kt,Yt.props=$t.memoizedProps,Yt.state=$t.memoizedState,Yt.componentWillUnmount()}catch(Kt){W$2(kt,Ct,Kt)}}break;case 5:Lj(qt,qt.return);break;case 22:if(qt.memoizedState!==null){gk(Gt);continue}}Wt!==null?(Wt.return=qt,V$1=Wt):gk(Gt)}Ht=Ht.sibling}e:for(Ht=null,Gt=xt;;){if(Gt.tag===5){if(Ht===null){Ht=Gt;try{Mt=Gt.stateNode,zt?(Ft=Mt.style,typeof Ft.setProperty=="function"?Ft.setProperty("display","none","important"):Ft.display="none"):(Bt=Gt.stateNode,Vt=Gt.memoizedProps.style,jt=Vt!=null&&Vt.hasOwnProperty("display")?Vt.display:null,Bt.style.display=rb("display",jt))}catch(Kt){W$2(xt,xt.return,Kt)}}}else if(Gt.tag===6){if(Ht===null)try{Gt.stateNode.nodeValue=zt?"":Gt.memoizedProps}catch(Kt){W$2(xt,xt.return,Kt)}}else if((Gt.tag!==22&&Gt.tag!==23||Gt.memoizedState===null||Gt===xt)&&Gt.child!==null){Gt.child.return=Gt,Gt=Gt.child;continue}if(Gt===xt)break e;for(;Gt.sibling===null;){if(Gt.return===null||Gt.return===xt)break e;Ht===Gt&&(Ht=null),Gt=Gt.return}Ht===Gt&&(Ht=null),Gt.sibling.return=Gt.return,Gt=Gt.sibling}}break;case 19:ck($t,xt),ek(xt),kt&4&&ak(xt);break;case 21:break;default:ck($t,xt),ek(xt)}}function ek(xt){var $t=xt.flags;if($t&2){try{e:{for(var Ct=xt.return;Ct!==null;){if(Tj(Ct)){var kt=Ct;break e}Ct=Ct.return}throw Error(p$2(160))}switch(kt.tag){case 5:var Mt=kt.stateNode;kt.flags&32&&(ob(Mt,""),kt.flags&=-33);var Ft=Uj(xt);Wj(xt,Ft,Mt);break;case 3:case 4:var jt=kt.stateNode.containerInfo,Bt=Uj(xt);Vj(xt,Bt,jt);break;default:throw Error(p$2(161))}}catch(Vt){W$2(xt,xt.return,Vt)}xt.flags&=-3}$t&4096&&(xt.flags&=-4097)}function hk(xt,$t,Ct){V$1=xt,ik(xt)}function ik(xt,$t,Ct){for(var kt=(xt.mode&1)!==0;V$1!==null;){var Mt=V$1,Ft=Mt.child;if(Mt.tag===22&&kt){var jt=Mt.memoizedState!==null||Jj;if(!jt){var Bt=Mt.alternate,Vt=Bt!==null&&Bt.memoizedState!==null||U$2;Bt=Jj;var zt=U$2;if(Jj=jt,(U$2=Vt)&&!zt)for(V$1=Mt;V$1!==null;)jt=V$1,Vt=jt.child,jt.tag===22&&jt.memoizedState!==null?jk(Mt):Vt!==null?(Vt.return=jt,V$1=Vt):jk(Mt);for(;Ft!==null;)V$1=Ft,ik(Ft),Ft=Ft.sibling;V$1=Mt,Jj=Bt,U$2=zt}kk(xt)}else Mt.subtreeFlags&8772&&Ft!==null?(Ft.return=Mt,V$1=Ft):kk(xt)}}function kk(xt){for(;V$1!==null;){var $t=V$1;if($t.flags&8772){var Ct=$t.alternate;try{if($t.flags&8772)switch($t.tag){case 0:case 11:case 15:U$2||Qj(5,$t);break;case 1:var kt=$t.stateNode;if($t.flags&4&&!U$2)if(Ct===null)kt.componentDidMount();else{var Mt=$t.elementType===$t.type?Ct.memoizedProps:Ci($t.type,Ct.memoizedProps);kt.componentDidUpdate(Mt,Ct.memoizedState,kt.__reactInternalSnapshotBeforeUpdate)}var Ft=$t.updateQueue;Ft!==null&&sh($t,Ft,kt);break;case 3:var jt=$t.updateQueue;if(jt!==null){if(Ct=null,$t.child!==null)switch($t.child.tag){case 5:Ct=$t.child.stateNode;break;case 1:Ct=$t.child.stateNode}sh($t,jt,Ct)}break;case 5:var Bt=$t.stateNode;if(Ct===null&&$t.flags&4){Ct=Bt;var Vt=$t.memoizedProps;switch($t.type){case"button":case"input":case"select":case"textarea":Vt.autoFocus&&Ct.focus();break;case"img":Vt.src&&(Ct.src=Vt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if($t.memoizedState===null){var zt=$t.alternate;if(zt!==null){var Ht=zt.memoizedState;if(Ht!==null){var Gt=Ht.dehydrated;Gt!==null&&bd(Gt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$2(163))}U$2||$t.flags&512&&Rj($t)}catch(qt){W$2($t,$t.return,qt)}}if($t===xt){V$1=null;break}if(Ct=$t.sibling,Ct!==null){Ct.return=$t.return,V$1=Ct;break}V$1=$t.return}}function gk(xt){for(;V$1!==null;){var $t=V$1;if($t===xt){V$1=null;break}var Ct=$t.sibling;if(Ct!==null){Ct.return=$t.return,V$1=Ct;break}V$1=$t.return}}function jk(xt){for(;V$1!==null;){var $t=V$1;try{switch($t.tag){case 0:case 11:case 15:var Ct=$t.return;try{Qj(4,$t)}catch(Vt){W$2($t,Ct,Vt)}break;case 1:var kt=$t.stateNode;if(typeof kt.componentDidMount=="function"){var Mt=$t.return;try{kt.componentDidMount()}catch(Vt){W$2($t,Mt,Vt)}}var Ft=$t.return;try{Rj($t)}catch(Vt){W$2($t,Ft,Vt)}break;case 5:var jt=$t.return;try{Rj($t)}catch(Vt){W$2($t,jt,Vt)}}}catch(Vt){W$2($t,$t.return,Vt)}if($t===xt){V$1=null;break}var Bt=$t.sibling;if(Bt!==null){Bt.return=$t.return,V$1=Bt;break}V$1=$t.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok$2=ua.ReactCurrentBatchConfig,K$2=0,Q$2=null,Y$4=null,Z$2=0,fj=0,ej=Uf(0),T$1=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R$1(){return K$2&6?B$4():Ak!==-1?Ak:Ak=B$4()}function yi(xt){return xt.mode&1?K$2&2&&Z$2!==0?Z$2&-Z$2:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(xt=C$4,xt!==0||(xt=window.event,xt=xt===void 0?16:jd(xt.type)),xt):1}function gi(xt,$t,Ct,kt){if(50<yk)throw yk=0,zk=null,Error(p$2(185));Ac(xt,Ct,kt),(!(K$2&2)||xt!==Q$2)&&(xt===Q$2&&(!(K$2&2)&&(qk|=Ct),T$1===4&&Ck(xt,Z$2)),Dk(xt,kt),Ct===1&&K$2===0&&!($t.mode&1)&&(Gj=B$4()+500,fg&&jg()))}function Dk(xt,$t){var Ct=xt.callbackNode;wc(xt,$t);var kt=uc(xt,xt===Q$2?Z$2:0);if(kt===0)Ct!==null&&bc(Ct),xt.callbackNode=null,xt.callbackPriority=0;else if($t=kt&-kt,xt.callbackPriority!==$t){if(Ct!=null&&bc(Ct),$t===1)xt.tag===0?ig(Ek.bind(null,xt)):hg(Ek.bind(null,xt)),Jf(function(){!(K$2&6)&&jg()}),Ct=null;else{switch(Dc(kt)){case 1:Ct=fc;break;case 4:Ct=gc;break;case 16:Ct=hc;break;case 536870912:Ct=jc;break;default:Ct=hc}Ct=Fk(Ct,Gk.bind(null,xt))}xt.callbackPriority=$t,xt.callbackNode=Ct}}function Gk(xt,$t){if(Ak=-1,Bk=0,K$2&6)throw Error(p$2(327));var Ct=xt.callbackNode;if(Hk()&&xt.callbackNode!==Ct)return null;var kt=uc(xt,xt===Q$2?Z$2:0);if(kt===0)return null;if(kt&30||kt&xt.expiredLanes||$t)$t=Ik(xt,kt);else{$t=kt;var Mt=K$2;K$2|=2;var Ft=Jk();(Q$2!==xt||Z$2!==$t)&&(uk=null,Gj=B$4()+500,Kk(xt,$t));do try{Lk();break}catch(Bt){Mk(xt,Bt)}while(!0);$g(),mk.current=Ft,K$2=Mt,Y$4!==null?$t=0:(Q$2=null,Z$2=0,$t=T$1)}if($t!==0){if($t===2&&(Mt=xc(xt),Mt!==0&&(kt=Mt,$t=Nk(xt,Mt))),$t===1)throw Ct=pk,Kk(xt,0),Ck(xt,kt),Dk(xt,B$4()),Ct;if($t===6)Ck(xt,kt);else{if(Mt=xt.current.alternate,!(kt&30)&&!Ok(Mt)&&($t=Ik(xt,kt),$t===2&&(Ft=xc(xt),Ft!==0&&(kt=Ft,$t=Nk(xt,Ft))),$t===1))throw Ct=pk,Kk(xt,0),Ck(xt,kt),Dk(xt,B$4()),Ct;switch(xt.finishedWork=Mt,xt.finishedLanes=kt,$t){case 0:case 1:throw Error(p$2(345));case 2:Pk(xt,tk,uk);break;case 3:if(Ck(xt,kt),(kt&130023424)===kt&&($t=fk+500-B$4(),10<$t)){if(uc(xt,0)!==0)break;if(Mt=xt.suspendedLanes,(Mt&kt)!==kt){R$1(),xt.pingedLanes|=xt.suspendedLanes&Mt;break}xt.timeoutHandle=Ff(Pk.bind(null,xt,tk,uk),$t);break}Pk(xt,tk,uk);break;case 4:if(Ck(xt,kt),(kt&4194240)===kt)break;for($t=xt.eventTimes,Mt=-1;0<kt;){var jt=31-oc(kt);Ft=1<<jt,jt=$t[jt],jt>Mt&&(Mt=jt),kt&=~Ft}if(kt=Mt,kt=B$4()-kt,kt=(120>kt?120:480>kt?480:1080>kt?1080:1920>kt?1920:3e3>kt?3e3:4320>kt?4320:1960*lk(kt/1960))-kt,10<kt){xt.timeoutHandle=Ff(Pk.bind(null,xt,tk,uk),kt);break}Pk(xt,tk,uk);break;case 5:Pk(xt,tk,uk);break;default:throw Error(p$2(329))}}}return Dk(xt,B$4()),xt.callbackNode===Ct?Gk.bind(null,xt):null}function Nk(xt,$t){var Ct=sk;return xt.current.memoizedState.isDehydrated&&(Kk(xt,$t).flags|=256),xt=Ik(xt,$t),xt!==2&&($t=tk,tk=Ct,$t!==null&&Fj($t)),xt}function Fj(xt){tk===null?tk=xt:tk.push.apply(tk,xt)}function Ok(xt){for(var $t=xt;;){if($t.flags&16384){var Ct=$t.updateQueue;if(Ct!==null&&(Ct=Ct.stores,Ct!==null))for(var kt=0;kt<Ct.length;kt++){var Mt=Ct[kt],Ft=Mt.getSnapshot;Mt=Mt.value;try{if(!He(Ft(),Mt))return!1}catch{return!1}}}if(Ct=$t.child,$t.subtreeFlags&16384&&Ct!==null)Ct.return=$t,$t=Ct;else{if($t===xt)break;for(;$t.sibling===null;){if($t.return===null||$t.return===xt)return!0;$t=$t.return}$t.sibling.return=$t.return,$t=$t.sibling}}return!0}function Ck(xt,$t){for($t&=~rk,$t&=~qk,xt.suspendedLanes|=$t,xt.pingedLanes&=~$t,xt=xt.expirationTimes;0<$t;){var Ct=31-oc($t),kt=1<<Ct;xt[Ct]=-1,$t&=~kt}}function Ek(xt){if(K$2&6)throw Error(p$2(327));Hk();var $t=uc(xt,0);if(!($t&1))return Dk(xt,B$4()),null;var Ct=Ik(xt,$t);if(xt.tag!==0&&Ct===2){var kt=xc(xt);kt!==0&&($t=kt,Ct=Nk(xt,kt))}if(Ct===1)throw Ct=pk,Kk(xt,0),Ck(xt,$t),Dk(xt,B$4()),Ct;if(Ct===6)throw Error(p$2(345));return xt.finishedWork=xt.current.alternate,xt.finishedLanes=$t,Pk(xt,tk,uk),Dk(xt,B$4()),null}function Qk(xt,$t){var Ct=K$2;K$2|=1;try{return xt($t)}finally{K$2=Ct,K$2===0&&(Gj=B$4()+500,fg&&jg())}}function Rk(xt){wk!==null&&wk.tag===0&&!(K$2&6)&&Hk();var $t=K$2;K$2|=1;var Ct=ok$2.transition,kt=C$4;try{if(ok$2.transition=null,C$4=1,xt)return xt()}finally{C$4=kt,ok$2.transition=Ct,K$2=$t,!(K$2&6)&&jg()}}function Hj(){fj=ej.current,E$3(ej)}function Kk(xt,$t){xt.finishedWork=null,xt.finishedLanes=0;var Ct=xt.timeoutHandle;if(Ct!==-1&&(xt.timeoutHandle=-1,Gf(Ct)),Y$4!==null)for(Ct=Y$4.return;Ct!==null;){var kt=Ct;switch(wg(kt),kt.tag){case 1:kt=kt.type.childContextTypes,kt!=null&&$f();break;case 3:zh(),E$3(Wf),E$3(H$2),Eh();break;case 5:Bh(kt);break;case 4:zh();break;case 13:E$3(L$2);break;case 19:E$3(L$2);break;case 10:ah(kt.type._context);break;case 22:case 23:Hj()}Ct=Ct.return}if(Q$2=xt,Y$4=xt=Pg(xt.current,null),Z$2=fj=$t,T$1=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for($t=0;$t<fh.length;$t++)if(Ct=fh[$t],kt=Ct.interleaved,kt!==null){Ct.interleaved=null;var Mt=kt.next,Ft=Ct.pending;if(Ft!==null){var jt=Ft.next;Ft.next=Mt,kt.next=jt}Ct.pending=kt}fh=null}return xt}function Mk(xt,$t){do{var Ct=Y$4;try{if($g(),Fh.current=Rh,Ih){for(var kt=M$3.memoizedState;kt!==null;){var Mt=kt.queue;Mt!==null&&(Mt.pending=null),kt=kt.next}Ih=!1}if(Hh=0,O$1=N$2=M$3=null,Jh=!1,Kh=0,nk.current=null,Ct===null||Ct.return===null){T$1=1,pk=$t,Y$4=null;break}e:{var Ft=xt,jt=Ct.return,Bt=Ct,Vt=$t;if($t=Z$2,Bt.flags|=32768,Vt!==null&&typeof Vt=="object"&&typeof Vt.then=="function"){var zt=Vt,Ht=Bt,Gt=Ht.tag;if(!(Ht.mode&1)&&(Gt===0||Gt===11||Gt===15)){var qt=Ht.alternate;qt?(Ht.updateQueue=qt.updateQueue,Ht.memoizedState=qt.memoizedState,Ht.lanes=qt.lanes):(Ht.updateQueue=null,Ht.memoizedState=null)}var Wt=Ui(jt);if(Wt!==null){Wt.flags&=-257,Vi(Wt,jt,Bt,Ft,$t),Wt.mode&1&&Si(Ft,zt,$t),$t=Wt,Vt=zt;var Yt=$t.updateQueue;if(Yt===null){var Kt=new Set;Kt.add(Vt),$t.updateQueue=Kt}else Yt.add(Vt);break e}else{if(!($t&1)){Si(Ft,zt,$t),tj();break e}Vt=Error(p$2(426))}}else if(I$2&&Bt.mode&1){var Xt=Ui(jt);if(Xt!==null){!(Xt.flags&65536)&&(Xt.flags|=256),Vi(Xt,jt,Bt,Ft,$t),Jg(Ji(Vt,Bt));break e}}Ft=Vt=Ji(Vt,Bt),T$1!==4&&(T$1=2),sk===null?sk=[Ft]:sk.push(Ft),Ft=jt;do{switch(Ft.tag){case 3:Ft.flags|=65536,$t&=-$t,Ft.lanes|=$t;var Qt=Ni(Ft,Vt,$t);ph(Ft,Qt);break e;case 1:Bt=Vt;var Jt=Ft.type,Zt=Ft.stateNode;if(!(Ft.flags&128)&&(typeof Jt.getDerivedStateFromError=="function"||Zt!==null&&typeof Zt.componentDidCatch=="function"&&(Ri===null||!Ri.has(Zt)))){Ft.flags|=65536,$t&=-$t,Ft.lanes|=$t;var sn=Qi(Ft,Bt,$t);ph(Ft,sn);break e}}Ft=Ft.return}while(Ft!==null)}Sk(Ct)}catch(ln){$t=ln,Y$4===Ct&&Ct!==null&&(Y$4=Ct=Ct.return);continue}break}while(!0)}function Jk(){var xt=mk.current;return mk.current=Rh,xt===null?Rh:xt}function tj(){(T$1===0||T$1===3||T$1===2)&&(T$1=4),Q$2===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q$2,Z$2)}function Ik(xt,$t){var Ct=K$2;K$2|=2;var kt=Jk();(Q$2!==xt||Z$2!==$t)&&(uk=null,Kk(xt,$t));do try{Tk();break}catch(Mt){Mk(xt,Mt)}while(!0);if($g(),K$2=Ct,mk.current=kt,Y$4!==null)throw Error(p$2(261));return Q$2=null,Z$2=0,T$1}function Tk(){for(;Y$4!==null;)Uk(Y$4)}function Lk(){for(;Y$4!==null&&!cc();)Uk(Y$4)}function Uk(xt){var $t=Vk(xt.alternate,xt,fj);xt.memoizedProps=xt.pendingProps,$t===null?Sk(xt):Y$4=$t,nk.current=null}function Sk(xt){var $t=xt;do{var Ct=$t.alternate;if(xt=$t.return,$t.flags&32768){if(Ct=Ij(Ct,$t),Ct!==null){Ct.flags&=32767,Y$4=Ct;return}if(xt!==null)xt.flags|=32768,xt.subtreeFlags=0,xt.deletions=null;else{T$1=6,Y$4=null;return}}else if(Ct=Ej(Ct,$t,fj),Ct!==null){Y$4=Ct;return}if($t=$t.sibling,$t!==null){Y$4=$t;return}Y$4=$t=xt}while($t!==null);T$1===0&&(T$1=5)}function Pk(xt,$t,Ct){var kt=C$4,Mt=ok$2.transition;try{ok$2.transition=null,C$4=1,Wk(xt,$t,Ct,kt)}finally{ok$2.transition=Mt,C$4=kt}return null}function Wk(xt,$t,Ct,kt){do Hk();while(wk!==null);if(K$2&6)throw Error(p$2(327));Ct=xt.finishedWork;var Mt=xt.finishedLanes;if(Ct===null)return null;if(xt.finishedWork=null,xt.finishedLanes=0,Ct===xt.current)throw Error(p$2(177));xt.callbackNode=null,xt.callbackPriority=0;var Ft=Ct.lanes|Ct.childLanes;if(Bc(xt,Ft),xt===Q$2&&(Y$4=Q$2=null,Z$2=0),!(Ct.subtreeFlags&2064)&&!(Ct.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),Ft=(Ct.flags&15990)!==0,Ct.subtreeFlags&15990||Ft){Ft=ok$2.transition,ok$2.transition=null;var jt=C$4;C$4=1;var Bt=K$2;K$2|=4,nk.current=null,Oj(xt,Ct),dk(Ct,xt),Oe$1(Df),dd=!!Cf,Df=Cf=null,xt.current=Ct,hk(Ct),dc(),K$2=Bt,C$4=jt,ok$2.transition=Ft}else xt.current=Ct;if(vk&&(vk=!1,wk=xt,xk=Mt),Ft=xt.pendingLanes,Ft===0&&(Ri=null),mc$1(Ct.stateNode),Dk(xt,B$4()),$t!==null)for(kt=xt.onRecoverableError,Ct=0;Ct<$t.length;Ct++)Mt=$t[Ct],kt(Mt.value,{componentStack:Mt.stack,digest:Mt.digest});if(Oi)throw Oi=!1,xt=Pi,Pi=null,xt;return xk&1&&xt.tag!==0&&Hk(),Ft=xt.pendingLanes,Ft&1?xt===zk?yk++:(yk=0,zk=xt):yk=0,jg(),null}function Hk(){if(wk!==null){var xt=Dc(xk),$t=ok$2.transition,Ct=C$4;try{if(ok$2.transition=null,C$4=16>xt?16:xt,wk===null)var kt=!1;else{if(xt=wk,wk=null,xk=0,K$2&6)throw Error(p$2(331));var Mt=K$2;for(K$2|=4,V$1=xt.current;V$1!==null;){var Ft=V$1,jt=Ft.child;if(V$1.flags&16){var Bt=Ft.deletions;if(Bt!==null){for(var Vt=0;Vt<Bt.length;Vt++){var zt=Bt[Vt];for(V$1=zt;V$1!==null;){var Ht=V$1;switch(Ht.tag){case 0:case 11:case 15:Pj(8,Ht,Ft)}var Gt=Ht.child;if(Gt!==null)Gt.return=Ht,V$1=Gt;else for(;V$1!==null;){Ht=V$1;var qt=Ht.sibling,Wt=Ht.return;if(Sj(Ht),Ht===zt){V$1=null;break}if(qt!==null){qt.return=Wt,V$1=qt;break}V$1=Wt}}}var Yt=Ft.alternate;if(Yt!==null){var Kt=Yt.child;if(Kt!==null){Yt.child=null;do{var Xt=Kt.sibling;Kt.sibling=null,Kt=Xt}while(Kt!==null)}}V$1=Ft}}if(Ft.subtreeFlags&2064&&jt!==null)jt.return=Ft,V$1=jt;else e:for(;V$1!==null;){if(Ft=V$1,Ft.flags&2048)switch(Ft.tag){case 0:case 11:case 15:Pj(9,Ft,Ft.return)}var Qt=Ft.sibling;if(Qt!==null){Qt.return=Ft.return,V$1=Qt;break e}V$1=Ft.return}}var Jt=xt.current;for(V$1=Jt;V$1!==null;){jt=V$1;var Zt=jt.child;if(jt.subtreeFlags&2064&&Zt!==null)Zt.return=jt,V$1=Zt;else e:for(jt=Jt;V$1!==null;){if(Bt=V$1,Bt.flags&2048)try{switch(Bt.tag){case 0:case 11:case 15:Qj(9,Bt)}}catch(ln){W$2(Bt,Bt.return,ln)}if(Bt===jt){V$1=null;break e}var sn=Bt.sibling;if(sn!==null){sn.return=Bt.return,V$1=sn;break e}V$1=Bt.return}}if(K$2=Mt,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,xt)}catch{}kt=!0}return kt}finally{C$4=Ct,ok$2.transition=$t}}return!1}function Xk(xt,$t,Ct){$t=Ji(Ct,$t),$t=Ni(xt,$t,1),xt=nh(xt,$t,1),$t=R$1(),xt!==null&&(Ac(xt,1,$t),Dk(xt,$t))}function W$2(xt,$t,Ct){if(xt.tag===3)Xk(xt,xt,Ct);else for(;$t!==null;){if($t.tag===3){Xk($t,xt,Ct);break}else if($t.tag===1){var kt=$t.stateNode;if(typeof $t.type.getDerivedStateFromError=="function"||typeof kt.componentDidCatch=="function"&&(Ri===null||!Ri.has(kt))){xt=Ji(Ct,xt),xt=Qi($t,xt,1),$t=nh($t,xt,1),xt=R$1(),$t!==null&&(Ac($t,1,xt),Dk($t,xt));break}}$t=$t.return}}function Ti(xt,$t,Ct){var kt=xt.pingCache;kt!==null&&kt.delete($t),$t=R$1(),xt.pingedLanes|=xt.suspendedLanes&Ct,Q$2===xt&&(Z$2&Ct)===Ct&&(T$1===4||T$1===3&&(Z$2&130023424)===Z$2&&500>B$4()-fk?Kk(xt,0):rk|=Ct),Dk(xt,$t)}function Yk(xt,$t){$t===0&&(xt.mode&1?($t=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):$t=1);var Ct=R$1();xt=ih(xt,$t),xt!==null&&(Ac(xt,$t,Ct),Dk(xt,Ct))}function uj(xt){var $t=xt.memoizedState,Ct=0;$t!==null&&(Ct=$t.retryLane),Yk(xt,Ct)}function bk(xt,$t){var Ct=0;switch(xt.tag){case 13:var kt=xt.stateNode,Mt=xt.memoizedState;Mt!==null&&(Ct=Mt.retryLane);break;case 19:kt=xt.stateNode;break;default:throw Error(p$2(314))}kt!==null&&kt.delete($t),Yk(xt,Ct)}var Vk;Vk=function(xt,$t,Ct){if(xt!==null)if(xt.memoizedProps!==$t.pendingProps||Wf.current)dh=!0;else{if(!(xt.lanes&Ct)&&!($t.flags&128))return dh=!1,yj(xt,$t,Ct);dh=!!(xt.flags&131072)}else dh=!1,I$2&&$t.flags&1048576&&ug($t,ng,$t.index);switch($t.lanes=0,$t.tag){case 2:var kt=$t.type;ij(xt,$t),xt=$t.pendingProps;var Mt=Yf($t,H$2.current);ch$1($t,Ct),Mt=Nh(null,$t,kt,xt,Mt,Ct);var Ft=Sh();return $t.flags|=1,typeof Mt=="object"&&Mt!==null&&typeof Mt.render=="function"&&Mt.$$typeof===void 0?($t.tag=1,$t.memoizedState=null,$t.updateQueue=null,Zf(kt)?(Ft=!0,cg($t)):Ft=!1,$t.memoizedState=Mt.state!==null&&Mt.state!==void 0?Mt.state:null,kh($t),Mt.updater=Ei,$t.stateNode=Mt,Mt._reactInternals=$t,Ii($t,kt,xt,Ct),$t=jj(null,$t,kt,!0,Ft,Ct)):($t.tag=0,I$2&&Ft&&vg($t),Xi(null,$t,Mt,Ct),$t=$t.child),$t;case 16:kt=$t.elementType;e:{switch(ij(xt,$t),xt=$t.pendingProps,Mt=kt._init,kt=Mt(kt._payload),$t.type=kt,Mt=$t.tag=Zk(kt),xt=Ci(kt,xt),Mt){case 0:$t=cj(null,$t,kt,xt,Ct);break e;case 1:$t=hj(null,$t,kt,xt,Ct);break e;case 11:$t=Yi(null,$t,kt,xt,Ct);break e;case 14:$t=$i(null,$t,kt,Ci(kt.type,xt),Ct);break e}throw Error(p$2(306,kt,""))}return $t;case 0:return kt=$t.type,Mt=$t.pendingProps,Mt=$t.elementType===kt?Mt:Ci(kt,Mt),cj(xt,$t,kt,Mt,Ct);case 1:return kt=$t.type,Mt=$t.pendingProps,Mt=$t.elementType===kt?Mt:Ci(kt,Mt),hj(xt,$t,kt,Mt,Ct);case 3:e:{if(kj($t),xt===null)throw Error(p$2(387));kt=$t.pendingProps,Ft=$t.memoizedState,Mt=Ft.element,lh(xt,$t),qh($t,kt,null,Ct);var jt=$t.memoizedState;if(kt=jt.element,Ft.isDehydrated)if(Ft={element:kt,isDehydrated:!1,cache:jt.cache,pendingSuspenseBoundaries:jt.pendingSuspenseBoundaries,transitions:jt.transitions},$t.updateQueue.baseState=Ft,$t.memoizedState=Ft,$t.flags&256){Mt=Ji(Error(p$2(423)),$t),$t=lj(xt,$t,kt,Ct,Mt);break e}else if(kt!==Mt){Mt=Ji(Error(p$2(424)),$t),$t=lj(xt,$t,kt,Ct,Mt);break e}else for(yg=Lf($t.stateNode.containerInfo.firstChild),xg=$t,I$2=!0,zg=null,Ct=Vg($t,null,kt,Ct),$t.child=Ct;Ct;)Ct.flags=Ct.flags&-3|4096,Ct=Ct.sibling;else{if(Ig(),kt===Mt){$t=Zi(xt,$t,Ct);break e}Xi(xt,$t,kt,Ct)}$t=$t.child}return $t;case 5:return Ah($t),xt===null&&Eg($t),kt=$t.type,Mt=$t.pendingProps,Ft=xt!==null?xt.memoizedProps:null,jt=Mt.children,Ef(kt,Mt)?jt=null:Ft!==null&&Ef(kt,Ft)&&($t.flags|=32),gj(xt,$t),Xi(xt,$t,jt,Ct),$t.child;case 6:return xt===null&&Eg($t),null;case 13:return oj(xt,$t,Ct);case 4:return yh$1($t,$t.stateNode.containerInfo),kt=$t.pendingProps,xt===null?$t.child=Ug($t,null,kt,Ct):Xi(xt,$t,kt,Ct),$t.child;case 11:return kt=$t.type,Mt=$t.pendingProps,Mt=$t.elementType===kt?Mt:Ci(kt,Mt),Yi(xt,$t,kt,Mt,Ct);case 7:return Xi(xt,$t,$t.pendingProps,Ct),$t.child;case 8:return Xi(xt,$t,$t.pendingProps.children,Ct),$t.child;case 12:return Xi(xt,$t,$t.pendingProps.children,Ct),$t.child;case 10:e:{if(kt=$t.type._context,Mt=$t.pendingProps,Ft=$t.memoizedProps,jt=Mt.value,G$2(Wg,kt._currentValue),kt._currentValue=jt,Ft!==null)if(He(Ft.value,jt)){if(Ft.children===Mt.children&&!Wf.current){$t=Zi(xt,$t,Ct);break e}}else for(Ft=$t.child,Ft!==null&&(Ft.return=$t);Ft!==null;){var Bt=Ft.dependencies;if(Bt!==null){jt=Ft.child;for(var Vt=Bt.firstContext;Vt!==null;){if(Vt.context===kt){if(Ft.tag===1){Vt=mh(-1,Ct&-Ct),Vt.tag=2;var zt=Ft.updateQueue;if(zt!==null){zt=zt.shared;var Ht=zt.pending;Ht===null?Vt.next=Vt:(Vt.next=Ht.next,Ht.next=Vt),zt.pending=Vt}}Ft.lanes|=Ct,Vt=Ft.alternate,Vt!==null&&(Vt.lanes|=Ct),bh(Ft.return,Ct,$t),Bt.lanes|=Ct;break}Vt=Vt.next}}else if(Ft.tag===10)jt=Ft.type===$t.type?null:Ft.child;else if(Ft.tag===18){if(jt=Ft.return,jt===null)throw Error(p$2(341));jt.lanes|=Ct,Bt=jt.alternate,Bt!==null&&(Bt.lanes|=Ct),bh(jt,Ct,$t),jt=Ft.sibling}else jt=Ft.child;if(jt!==null)jt.return=Ft;else for(jt=Ft;jt!==null;){if(jt===$t){jt=null;break}if(Ft=jt.sibling,Ft!==null){Ft.return=jt.return,jt=Ft;break}jt=jt.return}Ft=jt}Xi(xt,$t,Mt.children,Ct),$t=$t.child}return $t;case 9:return Mt=$t.type,kt=$t.pendingProps.children,ch$1($t,Ct),Mt=eh(Mt),kt=kt(Mt),$t.flags|=1,Xi(xt,$t,kt,Ct),$t.child;case 14:return kt=$t.type,Mt=Ci(kt,$t.pendingProps),Mt=Ci(kt.type,Mt),$i(xt,$t,kt,Mt,Ct);case 15:return bj(xt,$t,$t.type,$t.pendingProps,Ct);case 17:return kt=$t.type,Mt=$t.pendingProps,Mt=$t.elementType===kt?Mt:Ci(kt,Mt),ij(xt,$t),$t.tag=1,Zf(kt)?(xt=!0,cg($t)):xt=!1,ch$1($t,Ct),Gi($t,kt,Mt),Ii($t,kt,Mt,Ct),jj(null,$t,kt,!0,xt,Ct);case 19:return xj(xt,$t,Ct);case 22:return dj(xt,$t,Ct)}throw Error(p$2(156,$t.tag))};function Fk(xt,$t){return ac(xt,$t)}function $k(xt,$t,Ct,kt){this.tag=xt,this.key=Ct,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=$t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=kt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(xt,$t,Ct,kt){return new $k(xt,$t,Ct,kt)}function aj(xt){return xt=xt.prototype,!(!xt||!xt.isReactComponent)}function Zk(xt){if(typeof xt=="function")return aj(xt)?1:0;if(xt!=null){if(xt=xt.$$typeof,xt===Da)return 11;if(xt===Ga)return 14}return 2}function Pg(xt,$t){var Ct=xt.alternate;return Ct===null?(Ct=Bg(xt.tag,$t,xt.key,xt.mode),Ct.elementType=xt.elementType,Ct.type=xt.type,Ct.stateNode=xt.stateNode,Ct.alternate=xt,xt.alternate=Ct):(Ct.pendingProps=$t,Ct.type=xt.type,Ct.flags=0,Ct.subtreeFlags=0,Ct.deletions=null),Ct.flags=xt.flags&14680064,Ct.childLanes=xt.childLanes,Ct.lanes=xt.lanes,Ct.child=xt.child,Ct.memoizedProps=xt.memoizedProps,Ct.memoizedState=xt.memoizedState,Ct.updateQueue=xt.updateQueue,$t=xt.dependencies,Ct.dependencies=$t===null?null:{lanes:$t.lanes,firstContext:$t.firstContext},Ct.sibling=xt.sibling,Ct.index=xt.index,Ct.ref=xt.ref,Ct}function Rg(xt,$t,Ct,kt,Mt,Ft){var jt=2;if(kt=xt,typeof xt=="function")aj(xt)&&(jt=1);else if(typeof xt=="string")jt=5;else e:switch(xt){case ya:return Tg(Ct.children,Mt,Ft,$t);case za:jt=8,Mt|=8;break;case Aa:return xt=Bg(12,Ct,$t,Mt|2),xt.elementType=Aa,xt.lanes=Ft,xt;case Ea:return xt=Bg(13,Ct,$t,Mt),xt.elementType=Ea,xt.lanes=Ft,xt;case Fa:return xt=Bg(19,Ct,$t,Mt),xt.elementType=Fa,xt.lanes=Ft,xt;case Ia:return pj(Ct,Mt,Ft,$t);default:if(typeof xt=="object"&&xt!==null)switch(xt.$$typeof){case Ba:jt=10;break e;case Ca:jt=9;break e;case Da:jt=11;break e;case Ga:jt=14;break e;case Ha:jt=16,kt=null;break e}throw Error(p$2(130,xt==null?xt:typeof xt,""))}return $t=Bg(jt,Ct,$t,Mt),$t.elementType=xt,$t.type=kt,$t.lanes=Ft,$t}function Tg(xt,$t,Ct,kt){return xt=Bg(7,xt,kt,$t),xt.lanes=Ct,xt}function pj(xt,$t,Ct,kt){return xt=Bg(22,xt,kt,$t),xt.elementType=Ia,xt.lanes=Ct,xt.stateNode={isHidden:!1},xt}function Qg(xt,$t,Ct){return xt=Bg(6,xt,null,$t),xt.lanes=Ct,xt}function Sg(xt,$t,Ct){return $t=Bg(4,xt.children!==null?xt.children:[],xt.key,$t),$t.lanes=Ct,$t.stateNode={containerInfo:xt.containerInfo,pendingChildren:null,implementation:xt.implementation},$t}function al(xt,$t,Ct,kt,Mt){this.tag=$t,this.containerInfo=xt,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=kt,this.onRecoverableError=Mt,this.mutableSourceEagerHydrationData=null}function bl$1(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt){return xt=new al(xt,$t,Ct,Bt,Vt),$t===1?($t=1,Ft===!0&&($t|=8)):$t=0,Ft=Bg(3,null,null,$t),xt.current=Ft,Ft.stateNode=xt,Ft.memoizedState={element:kt,isDehydrated:Ct,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(Ft),xt}function cl(xt,$t,Ct){var kt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:kt==null?null:""+kt,children:xt,containerInfo:$t,implementation:Ct}}function dl(xt){if(!xt)return Vf;xt=xt._reactInternals;e:{if(Vb(xt)!==xt||xt.tag!==1)throw Error(p$2(170));var $t=xt;do{switch($t.tag){case 3:$t=$t.stateNode.context;break e;case 1:if(Zf($t.type)){$t=$t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}$t=$t.return}while($t!==null);throw Error(p$2(171))}if(xt.tag===1){var Ct=xt.type;if(Zf(Ct))return bg(xt,Ct,$t)}return $t}function el(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt){return xt=bl$1(Ct,kt,!0,xt,Mt,Ft,jt,Bt,Vt),xt.context=dl(null),Ct=xt.current,kt=R$1(),Mt=yi(Ct),Ft=mh(kt,Mt),Ft.callback=$t??null,nh(Ct,Ft,Mt),xt.current.lanes=Mt,Ac(xt,Mt,kt),Dk(xt,kt),xt}function fl(xt,$t,Ct,kt){var Mt=$t.current,Ft=R$1(),jt=yi(Mt);return Ct=dl(Ct),$t.context===null?$t.context=Ct:$t.pendingContext=Ct,$t=mh(Ft,jt),$t.payload={element:xt},kt=kt===void 0?null:kt,kt!==null&&($t.callback=kt),xt=nh(Mt,$t,jt),xt!==null&&(gi(xt,Mt,jt,Ft),oh(xt,Mt,jt)),jt}function gl(xt){if(xt=xt.current,!xt.child)return null;switch(xt.child.tag){case 5:return xt.child.stateNode;default:return xt.child.stateNode}}function hl(xt,$t){if(xt=xt.memoizedState,xt!==null&&xt.dehydrated!==null){var Ct=xt.retryLane;xt.retryLane=Ct!==0&&Ct<$t?Ct:$t}}function il(xt,$t){hl(xt,$t),(xt=xt.alternate)&&hl(xt,$t)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(xt){console.error(xt)};function ll(xt){this._internalRoot=xt}ml.prototype.render=ll.prototype.render=function(xt){var $t=this._internalRoot;if($t===null)throw Error(p$2(409));fl(xt,$t,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var xt=this._internalRoot;if(xt!==null){this._internalRoot=null;var $t=xt.containerInfo;Rk(function(){fl(null,xt,null,null)}),$t[uf]=null}};function ml(xt){this._internalRoot=xt}ml.prototype.unstable_scheduleHydration=function(xt){if(xt){var $t=Hc();xt={blockedOn:null,target:xt,priority:$t};for(var Ct=0;Ct<Qc.length&&$t!==0&&$t<Qc[Ct].priority;Ct++);Qc.splice(Ct,0,xt),Ct===0&&Vc(xt)}};function nl(xt){return!(!xt||xt.nodeType!==1&&xt.nodeType!==9&&xt.nodeType!==11)}function ol(xt){return!(!xt||xt.nodeType!==1&&xt.nodeType!==9&&xt.nodeType!==11&&(xt.nodeType!==8||xt.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(xt,$t,Ct,kt,Mt){if(Mt){if(typeof kt=="function"){var Ft=kt;kt=function(){var zt=gl(jt);Ft.call(zt)}}var jt=el($t,kt,xt,0,null,!1,!1,"",pl);return xt._reactRootContainer=jt,xt[uf]=jt.current,sf(xt.nodeType===8?xt.parentNode:xt),Rk(),jt}for(;Mt=xt.lastChild;)xt.removeChild(Mt);if(typeof kt=="function"){var Bt=kt;kt=function(){var zt=gl(Vt);Bt.call(zt)}}var Vt=bl$1(xt,0,!1,null,null,!1,!1,"",pl);return xt._reactRootContainer=Vt,xt[uf]=Vt.current,sf(xt.nodeType===8?xt.parentNode:xt),Rk(function(){fl($t,Vt,Ct,kt)}),Vt}function rl(xt,$t,Ct,kt,Mt){var Ft=Ct._reactRootContainer;if(Ft){var jt=Ft;if(typeof Mt=="function"){var Bt=Mt;Mt=function(){var Vt=gl(jt);Bt.call(Vt)}}fl($t,jt,xt,Mt)}else jt=ql(Ct,$t,xt,Mt,kt);return gl(jt)}Ec=function(xt){switch(xt.tag){case 3:var $t=xt.stateNode;if($t.current.memoizedState.isDehydrated){var Ct=tc($t.pendingLanes);Ct!==0&&(Cc($t,Ct|1),Dk($t,B$4()),!(K$2&6)&&(Gj=B$4()+500,jg()))}break;case 13:Rk(function(){var kt=ih(xt,1);if(kt!==null){var Mt=R$1();gi(kt,xt,1,Mt)}}),il(xt,1)}};Fc=function(xt){if(xt.tag===13){var $t=ih(xt,134217728);if($t!==null){var Ct=R$1();gi($t,xt,134217728,Ct)}il(xt,134217728)}};Gc=function(xt){if(xt.tag===13){var $t=yi(xt),Ct=ih(xt,$t);if(Ct!==null){var kt=R$1();gi(Ct,xt,$t,kt)}il(xt,$t)}};Hc=function(){return C$4};Ic=function(xt,$t){var Ct=C$4;try{return C$4=xt,$t()}finally{C$4=Ct}};yb=function(xt,$t,Ct){switch($t){case"input":if(bb(xt,Ct),$t=Ct.name,Ct.type==="radio"&&$t!=null){for(Ct=xt;Ct.parentNode;)Ct=Ct.parentNode;for(Ct=Ct.querySelectorAll("input[name="+JSON.stringify(""+$t)+'][type="radio"]'),$t=0;$t<Ct.length;$t++){var kt=Ct[$t];if(kt!==xt&&kt.form===xt.form){var Mt=Db(kt);if(!Mt)throw Error(p$2(90));Wa(kt),bb(kt,Mt)}}}break;case"textarea":ib(xt,Ct);break;case"select":$t=Ct.value,$t!=null&&fb(xt,!!Ct.multiple,$t,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue$2,Db,Eb,Fb,Qk]},tl$1={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl$1.bundleType,version:tl$1.version,rendererPackageName:tl$1.rendererPackageName,rendererConfig:tl$1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(xt){return xt=Zb(xt),xt===null?null:xt.stateNode},findFiberByHostInstance:tl$1.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(xt,$t){var Ct=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl($t))throw Error(p$2(200));return cl(xt,$t,null,Ct)};reactDom_production_min.createRoot=function(xt,$t){if(!nl(xt))throw Error(p$2(299));var Ct=!1,kt="",Mt=kl;return $t!=null&&($t.unstable_strictMode===!0&&(Ct=!0),$t.identifierPrefix!==void 0&&(kt=$t.identifierPrefix),$t.onRecoverableError!==void 0&&(Mt=$t.onRecoverableError)),$t=bl$1(xt,1,!1,null,null,Ct,!1,kt,Mt),xt[uf]=$t.current,sf(xt.nodeType===8?xt.parentNode:xt),new ll($t)};reactDom_production_min.findDOMNode=function(xt){if(xt==null)return null;if(xt.nodeType===1)return xt;var $t=xt._reactInternals;if($t===void 0)throw typeof xt.render=="function"?Error(p$2(188)):(xt=Object.keys(xt).join(","),Error(p$2(268,xt)));return xt=Zb($t),xt=xt===null?null:xt.stateNode,xt};reactDom_production_min.flushSync=function(xt){return Rk(xt)};reactDom_production_min.hydrate=function(xt,$t,Ct){if(!ol($t))throw Error(p$2(200));return rl(null,xt,$t,!0,Ct)};reactDom_production_min.hydrateRoot=function(xt,$t,Ct){if(!nl(xt))throw Error(p$2(405));var kt=Ct!=null&&Ct.hydratedSources||null,Mt=!1,Ft="",jt=kl;if(Ct!=null&&(Ct.unstable_strictMode===!0&&(Mt=!0),Ct.identifierPrefix!==void 0&&(Ft=Ct.identifierPrefix),Ct.onRecoverableError!==void 0&&(jt=Ct.onRecoverableError)),$t=el($t,null,xt,1,Ct??null,Mt,!1,Ft,jt),xt[uf]=$t.current,sf(xt),kt)for(xt=0;xt<kt.length;xt++)Ct=kt[xt],Mt=Ct._getVersion,Mt=Mt(Ct._source),$t.mutableSourceEagerHydrationData==null?$t.mutableSourceEagerHydrationData=[Ct,Mt]:$t.mutableSourceEagerHydrationData.push(Ct,Mt);return new ml($t)};reactDom_production_min.render=function(xt,$t,Ct){if(!ol($t))throw Error(p$2(200));return rl(null,xt,$t,!1,Ct)};reactDom_production_min.unmountComponentAtNode=function(xt){if(!ol(xt))throw Error(p$2(40));return xt._reactRootContainer?(Rk(function(){rl(null,null,xt,!1,function(){xt._reactRootContainer=null,xt[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(xt,$t,Ct,kt){if(!ol(Ct))throw Error(p$2(200));if(xt==null||xt._reactInternals===void 0)throw Error(p$2(38));return rl(xt,$t,Ct,!1,kt)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(xt){console.error(xt)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const ReactDOM=getDefaultExportFromCjs$1(reactDomExports);var m$4=reactDomExports;client.createRoot=m$4.createRoot,client.hydrateRoot=m$4.hydrateRoot;var __assign=function(){return __assign=Object.assign||function($t){for(var Ct,kt=1,Mt=arguments.length;kt<Mt;kt++){Ct=arguments[kt];for(var Ft in Ct)Object.prototype.hasOwnProperty.call(Ct,Ft)&&($t[Ft]=Ct[Ft])}return $t},__assign.apply(this,arguments)};function __rest$1(xt,$t){var Ct={};for(var kt in xt)Object.prototype.hasOwnProperty.call(xt,kt)&&$t.indexOf(kt)<0&&(Ct[kt]=xt[kt]);if(xt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Mt=0,kt=Object.getOwnPropertySymbols(xt);Mt<kt.length;Mt++)$t.indexOf(kt[Mt])<0&&Object.prototype.propertyIsEnumerable.call(xt,kt[Mt])&&(Ct[kt[Mt]]=xt[kt[Mt]]);return Ct}function __awaiter(xt,$t,Ct,kt){function Mt(Ft){return Ft instanceof Ct?Ft:new Ct(function(jt){jt(Ft)})}return new(Ct||(Ct=Promise))(function(Ft,jt){function Bt(Ht){try{zt(kt.next(Ht))}catch(Gt){jt(Gt)}}function Vt(Ht){try{zt(kt.throw(Ht))}catch(Gt){jt(Gt)}}function zt(Ht){Ht.done?Ft(Ht.value):Mt(Ht.value).then(Bt,Vt)}zt((kt=kt.apply(xt,$t||[])).next())})}function __values(xt){var $t=typeof Symbol=="function"&&Symbol.iterator,Ct=$t&&xt[$t],kt=0;if(Ct)return Ct.call(xt);if(xt&&typeof xt.length=="number")return{next:function(){return xt&&kt>=xt.length&&(xt=void 0),{value:xt&&xt[kt++],done:!xt}}};throw new TypeError($t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __spreadArray$1(xt,$t,Ct){if(Ct||arguments.length===2)for(var kt=0,Mt=$t.length,Ft;kt<Mt;kt++)(Ft||!(kt in $t))&&(Ft||(Ft=Array.prototype.slice.call($t,0,kt)),Ft[kt]=$t[kt]);return xt.concat(Ft||Array.prototype.slice.call($t))}function __await(xt){return this instanceof __await?(this.v=xt,this):new __await(xt)}function __asyncGenerator(xt,$t,Ct){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var kt=Ct.apply(xt,$t||[]),Mt,Ft=[];return Mt={},Bt("next"),Bt("throw"),Bt("return",jt),Mt[Symbol.asyncIterator]=function(){return this},Mt;function jt(Wt){return function(Yt){return Promise.resolve(Yt).then(Wt,Gt)}}function Bt(Wt,Yt){kt[Wt]&&(Mt[Wt]=function(Kt){return new Promise(function(Xt,Qt){Ft.push([Wt,Kt,Xt,Qt])>1||Vt(Wt,Kt)})},Yt&&(Mt[Wt]=Yt(Mt[Wt])))}function Vt(Wt,Yt){try{zt(kt[Wt](Yt))}catch(Kt){qt(Ft[0][3],Kt)}}function zt(Wt){Wt.value instanceof __await?Promise.resolve(Wt.value.v).then(Ht,Gt):qt(Ft[0][2],Wt)}function Ht(Wt){Vt("next",Wt)}function Gt(Wt){Vt("throw",Wt)}function qt(Wt,Yt){Wt(Yt),Ft.shift(),Ft.length&&Vt(Ft[0][0],Ft[0][1])}}function __asyncDelegator(xt){var $t,Ct;return $t={},kt("next"),kt("throw",function(Mt){throw Mt}),kt("return"),$t[Symbol.iterator]=function(){return this},$t;function kt(Mt,Ft){$t[Mt]=xt[Mt]?function(jt){return(Ct=!Ct)?{value:__await(xt[Mt](jt)),done:!1}:Ft?Ft(jt):jt}:Ft}}function __asyncValues(xt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var $t=xt[Symbol.asyncIterator],Ct;return $t?$t.call(xt):(xt=typeof __values=="function"?__values(xt):xt[Symbol.iterator](),Ct={},kt("next"),kt("throw"),kt("return"),Ct[Symbol.asyncIterator]=function(){return this},Ct);function kt(Ft){Ct[Ft]=xt[Ft]&&function(jt){return new Promise(function(Bt,Vt){jt=xt[Ft](jt),Mt(Bt,Vt,jt.done,jt.value)})}}function Mt(Ft,jt,Bt,Vt){Promise.resolve(Vt).then(function(zt){Ft({value:zt,done:Bt})},jt)}}typeof SuppressedError=="function"&&SuppressedError;var zeroRightClassName="right-scroll-bar-position",fullWidthClassName="width-before-scroll-bar",noScrollbarsClassName="with-scroll-bars-hidden",removedBarSizeVariable="--removed-body-scroll-bar-size";function assignRef$1(xt,$t){return typeof xt=="function"?xt($t):xt&&(xt.current=$t),xt}function useCallbackRef$1(xt,$t){var Ct=reactExports.useState(function(){return{value:xt,callback:$t,facade:{get current(){return Ct.value},set current(kt){var Mt=Ct.value;Mt!==kt&&(Ct.value=kt,Ct.callback(kt,Mt))}}}})[0];return Ct.callback=$t,Ct.facade}var useIsomorphicLayoutEffect$2=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,currentValues=new WeakMap;function useMergeRefs(xt,$t){var Ct=useCallbackRef$1(null,function(kt){return xt.forEach(function(Mt){return assignRef$1(Mt,kt)})});return useIsomorphicLayoutEffect$2(function(){var kt=currentValues.get(Ct);if(kt){var Mt=new Set(kt),Ft=new Set(xt),jt=Ct.current;Mt.forEach(function(Bt){Ft.has(Bt)||assignRef$1(Bt,null)}),Ft.forEach(function(Bt){Mt.has(Bt)||assignRef$1(Bt,jt)})}currentValues.set(Ct,xt)},[xt]),Ct}function ItoI(xt){return xt}function innerCreateMedium(xt,$t){$t===void 0&&($t=ItoI);var Ct=[],kt=!1,Mt={read:function(){if(kt)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return Ct.length?Ct[Ct.length-1]:xt},useMedium:function(Ft){var jt=$t(Ft,kt);return Ct.push(jt),function(){Ct=Ct.filter(function(Bt){return Bt!==jt})}},assignSyncMedium:function(Ft){for(kt=!0;Ct.length;){var jt=Ct;Ct=[],jt.forEach(Ft)}Ct={push:function(Bt){return Ft(Bt)},filter:function(){return Ct}}},assignMedium:function(Ft){kt=!0;var jt=[];if(Ct.length){var Bt=Ct;Ct=[],Bt.forEach(Ft),jt=Ct}var Vt=function(){var Ht=jt;jt=[],Ht.forEach(Ft)},zt=function(){return Promise.resolve().then(Vt)};zt(),Ct={push:function(Ht){jt.push(Ht),zt()},filter:function(Ht){return jt=jt.filter(Ht),Ct}}}};return Mt}function createSidecarMedium(xt){xt===void 0&&(xt={});var $t=innerCreateMedium(null);return $t.options=__assign({async:!0,ssr:!1},xt),$t}var SideCar$1=function(xt){var $t=xt.sideCar,Ct=__rest$1(xt,["sideCar"]);if(!$t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var kt=$t.read();if(!kt)throw new Error("Sidecar medium not found");return reactExports.createElement(kt,__assign({},Ct))};SideCar$1.isSideCarExport=!0;function exportSidecar(xt,$t){return xt.useMedium($t),SideCar$1}var effectCar=createSidecarMedium(),nothing=function(){},RemoveScroll=reactExports.forwardRef(function(xt,$t){var Ct=reactExports.useRef(null),kt=reactExports.useState({onScrollCapture:nothing,onWheelCapture:nothing,onTouchMoveCapture:nothing}),Mt=kt[0],Ft=kt[1],jt=xt.forwardProps,Bt=xt.children,Vt=xt.className,zt=xt.removeScrollBar,Ht=xt.enabled,Gt=xt.shards,qt=xt.sideCar,Wt=xt.noIsolation,Yt=xt.inert,Kt=xt.allowPinchZoom,Xt=xt.as,Qt=Xt===void 0?"div":Xt,Jt=xt.gapMode,Zt=__rest$1(xt,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),sn=qt,ln=useMergeRefs([Ct,$t]),dn=__assign(__assign({},Zt),Mt);return reactExports.createElement(reactExports.Fragment,null,Ht&&reactExports.createElement(sn,{sideCar:effectCar,removeScrollBar:zt,shards:Gt,noIsolation:Wt,inert:Yt,setCallbacks:Ft,allowPinchZoom:!!Kt,lockRef:Ct,gapMode:Jt}),jt?reactExports.cloneElement(reactExports.Children.only(Bt),__assign(__assign({},dn),{ref:ln})):reactExports.createElement(Qt,__assign({},dn,{className:Vt,ref:ln}),Bt))});RemoveScroll.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};RemoveScroll.classNames={fullWidth:fullWidthClassName,zeroRight:zeroRightClassName};var getNonce=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function makeStyleTag(){if(!document)return null;var xt=document.createElement("style");xt.type="text/css";var $t=getNonce();return $t&&xt.setAttribute("nonce",$t),xt}function injectStyles(xt,$t){xt.styleSheet?xt.styleSheet.cssText=$t:xt.appendChild(document.createTextNode($t))}function insertStyleTag(xt){var $t=document.head||document.getElementsByTagName("head")[0];$t.appendChild(xt)}var stylesheetSingleton=function(){var xt=0,$t=null;return{add:function(Ct){xt==0&&($t=makeStyleTag())&&(injectStyles($t,Ct),insertStyleTag($t)),xt++},remove:function(){xt--,!xt&&$t&&($t.parentNode&&$t.parentNode.removeChild($t),$t=null)}}},styleHookSingleton=function(){var xt=stylesheetSingleton();return function($t,Ct){reactExports.useEffect(function(){return xt.add($t),function(){xt.remove()}},[$t&&Ct])}},styleSingleton=function(){var xt=styleHookSingleton(),$t=function(Ct){var kt=Ct.styles,Mt=Ct.dynamic;return xt(kt,Mt),null};return $t},zeroGap={left:0,top:0,right:0,gap:0},parse$f=function(xt){return parseInt(xt||"",10)||0},getOffset=function(xt){var $t=window.getComputedStyle(document.body),Ct=$t[xt==="padding"?"paddingLeft":"marginLeft"],kt=$t[xt==="padding"?"paddingTop":"marginTop"],Mt=$t[xt==="padding"?"paddingRight":"marginRight"];return[parse$f(Ct),parse$f(kt),parse$f(Mt)]},getGapWidth=function(xt){if(xt===void 0&&(xt="margin"),typeof window>"u")return zeroGap;var $t=getOffset(xt),Ct=document.documentElement.clientWidth,kt=window.innerWidth;return{left:$t[0],top:$t[1],right:$t[2],gap:Math.max(0,kt-Ct+$t[2]-$t[0])}},Style=styleSingleton(),lockAttribute="data-scroll-locked",getStyles$1=function(xt,$t,Ct,kt){var Mt=xt.left,Ft=xt.top,jt=xt.right,Bt=xt.gap;return Ct===void 0&&(Ct="margin"),`
  .`.concat(noScrollbarsClassName,` {
   overflow: hidden `).concat(kt,`;
   padding-right: `).concat(Bt,"px ").concat(kt,`;
  }
  body[`).concat(lockAttribute,`] {
    overflow: hidden `).concat(kt,`;
    overscroll-behavior: contain;
    `).concat([$t&&"position: relative ".concat(kt,";"),Ct==="margin"&&`
    padding-left: `.concat(Mt,`px;
    padding-top: `).concat(Ft,`px;
    padding-right: `).concat(jt,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(Bt,"px ").concat(kt,`;
    `),Ct==="padding"&&"padding-right: ".concat(Bt,"px ").concat(kt,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zeroRightClassName,` {
    right: `).concat(Bt,"px ").concat(kt,`;
  }
  
  .`).concat(fullWidthClassName,` {
    margin-right: `).concat(Bt,"px ").concat(kt,`;
  }
  
  .`).concat(zeroRightClassName," .").concat(zeroRightClassName,` {
    right: 0 `).concat(kt,`;
  }
  
  .`).concat(fullWidthClassName," .").concat(fullWidthClassName,` {
    margin-right: 0 `).concat(kt,`;
  }
  
  body[`).concat(lockAttribute,`] {
    `).concat(removedBarSizeVariable,": ").concat(Bt,`px;
  }
`)},getCurrentUseCounter=function(){var xt=parseInt(document.body.getAttribute(lockAttribute)||"0",10);return isFinite(xt)?xt:0},useLockAttribute=function(){reactExports.useEffect(function(){return document.body.setAttribute(lockAttribute,(getCurrentUseCounter()+1).toString()),function(){var xt=getCurrentUseCounter()-1;xt<=0?document.body.removeAttribute(lockAttribute):document.body.setAttribute(lockAttribute,xt.toString())}},[])},RemoveScrollBar=function(xt){var $t=xt.noRelative,Ct=xt.noImportant,kt=xt.gapMode,Mt=kt===void 0?"margin":kt;useLockAttribute();var Ft=reactExports.useMemo(function(){return getGapWidth(Mt)},[Mt]);return reactExports.createElement(Style,{styles:getStyles$1(Ft,!$t,Mt,Ct?"":"!important")})},passiveSupported=!1;if(typeof window<"u")try{var options=Object.defineProperty({},"passive",{get:function(){return passiveSupported=!0,!0}});window.addEventListener("test",options,options),window.removeEventListener("test",options,options)}catch{passiveSupported=!1}var nonPassive=passiveSupported?{passive:!1}:!1,alwaysContainsScroll=function(xt){return xt.tagName==="TEXTAREA"},elementCanBeScrolled=function(xt,$t){if(!(xt instanceof Element))return!1;var Ct=window.getComputedStyle(xt);return Ct[$t]!=="hidden"&&!(Ct.overflowY===Ct.overflowX&&!alwaysContainsScroll(xt)&&Ct[$t]==="visible")},elementCouldBeVScrolled=function(xt){return elementCanBeScrolled(xt,"overflowY")},elementCouldBeHScrolled=function(xt){return elementCanBeScrolled(xt,"overflowX")},locationCouldBeScrolled=function(xt,$t){var Ct=$t.ownerDocument,kt=$t;do{typeof ShadowRoot<"u"&&kt instanceof ShadowRoot&&(kt=kt.host);var Mt=elementCouldBeScrolled(xt,kt);if(Mt){var Ft=getScrollVariables(xt,kt),jt=Ft[1],Bt=Ft[2];if(jt>Bt)return!0}kt=kt.parentNode}while(kt&&kt!==Ct.body);return!1},getVScrollVariables=function(xt){var $t=xt.scrollTop,Ct=xt.scrollHeight,kt=xt.clientHeight;return[$t,Ct,kt]},getHScrollVariables=function(xt){var $t=xt.scrollLeft,Ct=xt.scrollWidth,kt=xt.clientWidth;return[$t,Ct,kt]},elementCouldBeScrolled=function(xt,$t){return xt==="v"?elementCouldBeVScrolled($t):elementCouldBeHScrolled($t)},getScrollVariables=function(xt,$t){return xt==="v"?getVScrollVariables($t):getHScrollVariables($t)},getDirectionFactor=function(xt,$t){return xt==="h"&&$t==="rtl"?-1:1},handleScroll=function(xt,$t,Ct,kt,Mt){var Ft=getDirectionFactor(xt,window.getComputedStyle($t).direction),jt=Ft*kt,Bt=Ct.target,Vt=$t.contains(Bt),zt=!1,Ht=jt>0,Gt=0,qt=0;do{var Wt=getScrollVariables(xt,Bt),Yt=Wt[0],Kt=Wt[1],Xt=Wt[2],Qt=Kt-Xt-Ft*Yt;(Yt||Qt)&&elementCouldBeScrolled(xt,Bt)&&(Gt+=Qt,qt+=Yt),Bt instanceof ShadowRoot?Bt=Bt.host:Bt=Bt.parentNode}while(!Vt&&Bt!==document.body||Vt&&($t.contains(Bt)||$t===Bt));return(Ht&&(Math.abs(Gt)<1||!Mt)||!Ht&&(Math.abs(qt)<1||!Mt))&&(zt=!0),zt},getTouchXY=function(xt){return"changedTouches"in xt?[xt.changedTouches[0].clientX,xt.changedTouches[0].clientY]:[0,0]},getDeltaXY=function(xt){return[xt.deltaX,xt.deltaY]},extractRef=function(xt){return xt&&"current"in xt?xt.current:xt},deltaCompare=function(xt,$t){return xt[0]===$t[0]&&xt[1]===$t[1]},generateStyle=function(xt){return`
  .block-interactivity-`.concat(xt,` {pointer-events: none;}
  .allow-interactivity-`).concat(xt,` {pointer-events: all;}
`)},idCounter$1=0,lockStack=[];function RemoveScrollSideCar(xt){var $t=reactExports.useRef([]),Ct=reactExports.useRef([0,0]),kt=reactExports.useRef(),Mt=reactExports.useState(idCounter$1++)[0],Ft=reactExports.useState(styleSingleton)[0],jt=reactExports.useRef(xt);reactExports.useEffect(function(){jt.current=xt},[xt]),reactExports.useEffect(function(){if(xt.inert){document.body.classList.add("block-interactivity-".concat(Mt));var Kt=__spreadArray$1([xt.lockRef.current],(xt.shards||[]).map(extractRef),!0).filter(Boolean);return Kt.forEach(function(Xt){return Xt.classList.add("allow-interactivity-".concat(Mt))}),function(){document.body.classList.remove("block-interactivity-".concat(Mt)),Kt.forEach(function(Xt){return Xt.classList.remove("allow-interactivity-".concat(Mt))})}}},[xt.inert,xt.lockRef.current,xt.shards]);var Bt=reactExports.useCallback(function(Kt,Xt){if("touches"in Kt&&Kt.touches.length===2)return!jt.current.allowPinchZoom;var Qt=getTouchXY(Kt),Jt=Ct.current,Zt="deltaX"in Kt?Kt.deltaX:Jt[0]-Qt[0],sn="deltaY"in Kt?Kt.deltaY:Jt[1]-Qt[1],ln,dn=Kt.target,hn=Math.abs(Zt)>Math.abs(sn)?"h":"v";if("touches"in Kt&&hn==="h"&&dn.type==="range")return!1;var cn=locationCouldBeScrolled(hn,dn);if(!cn)return!0;if(cn?ln=hn:(ln=hn==="v"?"h":"v",cn=locationCouldBeScrolled(hn,dn)),!cn)return!1;if(!kt.current&&"changedTouches"in Kt&&(Zt||sn)&&(kt.current=ln),!ln)return!0;var pn=kt.current||ln;return handleScroll(pn,Xt,Kt,pn==="h"?Zt:sn,!0)},[]),Vt=reactExports.useCallback(function(Kt){var Xt=Kt;if(!(!lockStack.length||lockStack[lockStack.length-1]!==Ft)){var Qt="deltaY"in Xt?getDeltaXY(Xt):getTouchXY(Xt),Jt=$t.current.filter(function(ln){return ln.name===Xt.type&&(ln.target===Xt.target||Xt.target===ln.shadowParent)&&deltaCompare(ln.delta,Qt)})[0];if(Jt&&Jt.should){Xt.cancelable&&Xt.preventDefault();return}if(!Jt){var Zt=(jt.current.shards||[]).map(extractRef).filter(Boolean).filter(function(ln){return ln.contains(Xt.target)}),sn=Zt.length>0?Bt(Xt,Zt[0]):!jt.current.noIsolation;sn&&Xt.cancelable&&Xt.preventDefault()}}},[]),zt=reactExports.useCallback(function(Kt,Xt,Qt,Jt){var Zt={name:Kt,delta:Xt,target:Qt,should:Jt,shadowParent:getOutermostShadowParent(Qt)};$t.current.push(Zt),setTimeout(function(){$t.current=$t.current.filter(function(sn){return sn!==Zt})},1)},[]),Ht=reactExports.useCallback(function(Kt){Ct.current=getTouchXY(Kt),kt.current=void 0},[]),Gt=reactExports.useCallback(function(Kt){zt(Kt.type,getDeltaXY(Kt),Kt.target,Bt(Kt,xt.lockRef.current))},[]),qt=reactExports.useCallback(function(Kt){zt(Kt.type,getTouchXY(Kt),Kt.target,Bt(Kt,xt.lockRef.current))},[]);reactExports.useEffect(function(){return lockStack.push(Ft),xt.setCallbacks({onScrollCapture:Gt,onWheelCapture:Gt,onTouchMoveCapture:qt}),document.addEventListener("wheel",Vt,nonPassive),document.addEventListener("touchmove",Vt,nonPassive),document.addEventListener("touchstart",Ht,nonPassive),function(){lockStack=lockStack.filter(function(Kt){return Kt!==Ft}),document.removeEventListener("wheel",Vt,nonPassive),document.removeEventListener("touchmove",Vt,nonPassive),document.removeEventListener("touchstart",Ht,nonPassive)}},[]);var Wt=xt.removeScrollBar,Yt=xt.inert;return reactExports.createElement(reactExports.Fragment,null,Yt?reactExports.createElement(Ft,{styles:generateStyle(Mt)}):null,Wt?reactExports.createElement(RemoveScrollBar,{gapMode:xt.gapMode}):null)}function getOutermostShadowParent(xt){for(var $t=null;xt!==null;)xt instanceof ShadowRoot&&($t=xt.host,xt=xt.host),xt=xt.parentNode;return $t}const SideCar=exportSidecar(effectCar,RemoveScrollSideCar);var ReactRemoveScroll=reactExports.forwardRef(function(xt,$t){return reactExports.createElement(RemoveScroll,__assign({},xt,{ref:$t,sideCar:SideCar}))});ReactRemoveScroll.classNames=RemoveScroll.classNames;function keys$4(xt){return Object.keys(xt)}function isObject$5(xt){return xt&&typeof xt=="object"&&!Array.isArray(xt)}function deepMerge(xt,$t){const Ct={...xt},kt=$t;return isObject$5(xt)&&isObject$5($t)&&Object.keys($t).forEach(Mt=>{isObject$5(kt[Mt])&&Mt in xt?Ct[Mt]=deepMerge(Ct[Mt],kt[Mt]):Ct[Mt]=kt[Mt]}),Ct}function camelToKebabCase(xt){return xt.replace(/[A-Z]/g,$t=>`-${$t.toLowerCase()}`)}function getTransformedScaledValue(xt){var $t;return typeof xt!="string"||!xt.includes("var(--mantine-scale)")?xt:($t=xt.match(/^calc\((.*?)\)$/))==null?void 0:$t[1].split("*")[0].trim()}function px$1(xt){const $t=getTransformedScaledValue(xt);return typeof $t=="number"?$t:typeof $t=="string"?$t.includes("calc")||$t.includes("var")?$t:$t.includes("px")?Number($t.replace("px","")):$t.includes("rem")?Number($t.replace("rem",""))*16:$t.includes("em")?Number($t.replace("em",""))*16:Number($t):NaN}function scaleRem(xt){return xt==="0rem"?"0rem":`calc(${xt} * var(--mantine-scale))`}function createConverter(xt,{shouldScale:$t=!1}={}){function Ct(kt){if(kt===0||kt==="0")return`0${xt}`;if(typeof kt=="number"){const Mt=`${kt/16}${xt}`;return $t?scaleRem(Mt):Mt}if(typeof kt=="string"){if(kt===""||kt.startsWith("calc(")||kt.startsWith("clamp(")||kt.includes("rgba("))return kt;if(kt.includes(","))return kt.split(",").map(Ft=>Ct(Ft)).join(",");if(kt.includes(" "))return kt.split(" ").map(Ft=>Ct(Ft)).join(" ");if(kt.includes(xt))return $t?scaleRem(kt):kt;const Mt=kt.replace("px","");if(!Number.isNaN(Number(Mt))){const Ft=`${Number(Mt)/16}${xt}`;return $t?scaleRem(Ft):Ft}}return kt}return Ct}const rem$1=createConverter("rem",{shouldScale:!0}),em=createConverter("em");function filterProps(xt){return Object.keys(xt).reduce(($t,Ct)=>(xt[Ct]!==void 0&&($t[Ct]=xt[Ct]),$t),{})}function isNumberLike(xt){return typeof xt=="number"?!0:typeof xt=="string"?xt.startsWith("calc(")||xt.startsWith("var(")||xt.includes(" ")&&xt.trim()!==""?!0:/[0-9]/.test(xt.trim().replace("-","")[0]):!1}function isElement$1(xt){return Array.isArray(xt)||xt===null?!1:typeof xt=="object"?xt.type!==reactExports.Fragment:!1}function createSafeContext(xt){const $t=reactExports.createContext(null);return[({children:Mt,value:Ft})=>jsxRuntimeExports.jsx($t.Provider,{value:Ft,children:Mt}),()=>{const Mt=reactExports.useContext($t);if(Mt===null)throw new Error(xt);return Mt}]}function createOptionalContext(xt=null){const $t=reactExports.createContext(xt);return[({children:Mt,value:Ft})=>jsxRuntimeExports.jsx($t.Provider,{value:Ft,children:Mt}),()=>reactExports.useContext($t)]}function getSafeId(xt,$t){return Ct=>{if(typeof Ct!="string"||Ct.trim().length===0)throw new Error($t);return`${xt}-${Ct}`}}function findElementAncestor(xt,$t){let Ct=xt;for(;(Ct=Ct.parentElement)&&!Ct.matches($t););return Ct}function getPreviousIndex$1(xt,$t,Ct){for(let kt=xt-1;kt>=0;kt-=1)if(!$t[kt].disabled)return kt;if(Ct){for(let kt=$t.length-1;kt>-1;kt-=1)if(!$t[kt].disabled)return kt}return xt}function getNextIndex$2(xt,$t,Ct){for(let kt=xt+1;kt<$t.length;kt+=1)if(!$t[kt].disabled)return kt;if(Ct){for(let kt=0;kt<$t.length;kt+=1)if(!$t[kt].disabled)return kt}return xt}function onSameLevel(xt,$t,Ct){return findElementAncestor(xt,Ct)===findElementAncestor($t,Ct)}function createScopedKeydownHandler({parentSelector:xt,siblingSelector:$t,onKeyDown:Ct,loop:kt=!0,activateOnFocus:Mt=!1,dir:Ft="rtl",orientation:jt}){return Bt=>{var Yt;Ct==null||Ct(Bt);const Vt=Array.from(((Yt=findElementAncestor(Bt.currentTarget,xt))==null?void 0:Yt.querySelectorAll($t))||[]).filter(Kt=>onSameLevel(Bt.currentTarget,Kt,xt)),zt=Vt.findIndex(Kt=>Bt.currentTarget===Kt),Ht=getNextIndex$2(zt,Vt,kt),Gt=getPreviousIndex$1(zt,Vt,kt),qt=Ft==="rtl"?Gt:Ht,Wt=Ft==="rtl"?Ht:Gt;switch(Bt.key){case"ArrowRight":{jt==="horizontal"&&(Bt.stopPropagation(),Bt.preventDefault(),Vt[qt].focus(),Mt&&Vt[qt].click());break}case"ArrowLeft":{jt==="horizontal"&&(Bt.stopPropagation(),Bt.preventDefault(),Vt[Wt].focus(),Mt&&Vt[Wt].click());break}case"ArrowUp":{jt==="vertical"&&(Bt.stopPropagation(),Bt.preventDefault(),Vt[Gt].focus(),Mt&&Vt[Gt].click());break}case"ArrowDown":{jt==="vertical"&&(Bt.stopPropagation(),Bt.preventDefault(),Vt[Ht].focus(),Mt&&Vt[Ht].click());break}case"Home":{Bt.stopPropagation(),Bt.preventDefault(),!Vt[0].disabled&&Vt[0].focus();break}case"End":{Bt.stopPropagation(),Bt.preventDefault();const Kt=Vt.length-1;!Vt[Kt].disabled&&Vt[Kt].focus();break}}}}const elevations={app:100,modal:200,popover:300,overlay:400,max:9999};function getDefaultZIndex(xt){return elevations[xt]}const noop$b=()=>{};function closeOnEscape(xt,$t={active:!0}){return typeof xt!="function"||!$t.active?$t.onKeyDown||noop$b:Ct=>{var kt;Ct.key==="Escape"&&(xt(Ct),(kt=$t.onTrigger)==null||kt.call($t))}}function getSize(xt,$t="size",Ct=!0){if(xt!==void 0)return isNumberLike(xt)?Ct?rem$1(xt):xt:`var(--${$t}-${xt})`}function getSpacing(xt){return getSize(xt,"mantine-spacing")}function getRadius(xt){return xt===void 0?"var(--mantine-radius-default)":getSize(xt,"mantine-radius")}function getFontSize$1(xt){return getSize(xt,"mantine-font-size")}function getLineHeight(xt){return getSize(xt,"mantine-line-height",!1)}function getShadow(xt){if(xt)return getSize(xt,"mantine-shadow",!1)}function createEventHandler(xt,$t){return Ct=>{xt==null||xt(Ct),$t==null||$t(Ct)}}function getBreakpointValue$1(xt,$t){return xt in $t.breakpoints?px$1($t.breakpoints[xt]):px$1(xt)}function getSortedBreakpoints(xt,$t){const Ct=xt.map(kt=>({value:kt,px:getBreakpointValue$1(kt,$t)}));return Ct.sort((kt,Mt)=>kt.px-Mt.px),Ct}function getBaseValue$1(xt){return typeof xt=="object"&&xt!==null?"base"in xt?xt.base:void 0:xt}function getContextItemIndex(xt,$t,Ct){var kt;return Ct?Array.from(((kt=findElementAncestor(Ct,$t))==null?void 0:kt.querySelectorAll(xt))||[]).findIndex(Mt=>Mt===Ct):null}function useHovered(){const[xt,$t]=reactExports.useState(-1);return[xt,{setHovered:$t,resetHovered:()=>$t(-1)}]}function clamp$4(xt,$t,Ct){return $t===void 0&&Ct===void 0?xt:$t!==void 0&&Ct===void 0?Math.max(xt,$t):Math.min($t===void 0&&Ct!==void 0?xt:Math.max(xt,$t),Ct)}function randomId(){return`mantine-${Math.random().toString(36).slice(2,11)}`}function useCallbackRef(xt){const $t=reactExports.useRef(xt);return reactExports.useEffect(()=>{$t.current=xt}),reactExports.useMemo(()=>(...Ct)=>{var kt;return(kt=$t.current)==null?void 0:kt.call($t,...Ct)},[])}function useDebouncedCallback(xt,$t){const Ct=useCallbackRef(xt),kt=reactExports.useRef(0);return reactExports.useEffect(()=>()=>window.clearTimeout(kt.current),[]),reactExports.useCallback((...Mt)=>{window.clearTimeout(kt.current),kt.current=window.setTimeout(()=>Ct(...Mt),$t)},[Ct,$t])}const DEFAULT_EVENTS=["mousedown","touchstart"];function useClickOutside(xt,$t,Ct){const kt=reactExports.useRef();return reactExports.useEffect(()=>{const Mt=Ft=>{const{target:jt}=Ft??{};if(Array.isArray(Ct)){const Bt=(jt==null?void 0:jt.hasAttribute("data-ignore-outside-clicks"))||!document.body.contains(jt)&&jt.tagName!=="HTML";Ct.every(zt=>!!zt&&!Ft.composedPath().includes(zt))&&!Bt&&xt()}else kt.current&&!kt.current.contains(jt)&&xt()};return($t||DEFAULT_EVENTS).forEach(Ft=>document.addEventListener(Ft,Mt)),()=>{($t||DEFAULT_EVENTS).forEach(Ft=>document.removeEventListener(Ft,Mt))}},[kt,xt,Ct]),kt}function attachMediaListener(xt,$t){try{return xt.addEventListener("change",$t),()=>xt.removeEventListener("change",$t)}catch{return xt.addListener($t),()=>xt.removeListener($t)}}function getInitialValue(xt,$t){return typeof window<"u"&&"matchMedia"in window?window.matchMedia(xt).matches:!1}function useMediaQuery(xt,$t,{getInitialValueInEffect:Ct}={getInitialValueInEffect:!0}){const[kt,Mt]=reactExports.useState(Ct?$t:getInitialValue(xt)),Ft=reactExports.useRef();return reactExports.useEffect(()=>{if("matchMedia"in window)return Ft.current=window.matchMedia(xt),Mt(Ft.current.matches),attachMediaListener(Ft.current,jt=>Mt(jt.matches))},[xt]),kt}const useIsomorphicEffect$1=typeof document<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function useDidUpdate(xt,$t){const Ct=reactExports.useRef(!1);reactExports.useEffect(()=>()=>{Ct.current=!1},[]),reactExports.useEffect(()=>{if(Ct.current)return xt();Ct.current=!0},$t)}function useFocusReturn({opened:xt,shouldReturnFocus:$t=!0}){const Ct=reactExports.useRef(),kt=()=>{var Mt;Ct.current&&"focus"in Ct.current&&typeof Ct.current.focus=="function"&&((Mt=Ct.current)==null||Mt.focus({preventScroll:!0}))};return useDidUpdate(()=>{let Mt=-1;const Ft=jt=>{jt.key==="Tab"&&window.clearTimeout(Mt)};return document.addEventListener("keydown",Ft),xt?Ct.current=document.activeElement:$t&&(Mt=window.setTimeout(kt,10)),()=>{window.clearTimeout(Mt),document.removeEventListener("keydown",Ft)}},[xt,$t]),kt}function createAriaHider(xt,$t="body > :not(script)"){const Ct=randomId(),kt=Array.from(document.querySelectorAll($t)).map(Mt=>{var Vt;if((Vt=Mt==null?void 0:Mt.shadowRoot)!=null&&Vt.contains(xt)||Mt.contains(xt))return;const Ft=Mt.getAttribute("aria-hidden"),jt=Mt.getAttribute("data-hidden"),Bt=Mt.getAttribute("data-focus-id");return Mt.setAttribute("data-focus-id",Ct),Ft===null||Ft==="false"?Mt.setAttribute("aria-hidden","true"):!jt&&!Bt&&Mt.setAttribute("data-hidden",Ft),{node:Mt,ariaHidden:jt||null}});return()=>{kt.forEach(Mt=>{!Mt||Ct!==Mt.node.getAttribute("data-focus-id")||(Mt.ariaHidden===null?Mt.node.removeAttribute("aria-hidden"):Mt.node.setAttribute("aria-hidden",Mt.ariaHidden),Mt.node.removeAttribute("data-focus-id"),Mt.node.removeAttribute("data-hidden"))})}}const TABBABLE_NODES=/input|select|textarea|button|object/,FOCUS_SELECTOR="a, input, select, textarea, button, object, [tabindex]";function hidden(xt){return xt.style.display==="none"}function visible(xt){if(xt.getAttribute("aria-hidden")||xt.getAttribute("hidden")||xt.getAttribute("type")==="hidden")return!1;let Ct=xt;for(;Ct&&!(Ct===document.body||Ct.nodeType===11);){if(hidden(Ct))return!1;Ct=Ct.parentNode}return!0}function getElementTabIndex(xt){let $t=xt.getAttribute("tabindex");return $t===null&&($t=void 0),parseInt($t,10)}function focusable(xt){const $t=xt.nodeName.toLowerCase(),Ct=!Number.isNaN(getElementTabIndex(xt));return(TABBABLE_NODES.test($t)&&!xt.disabled||xt instanceof HTMLAnchorElement&&xt.href||Ct)&&visible(xt)}function tabbable(xt){const $t=getElementTabIndex(xt);return(Number.isNaN($t)||$t>=0)&&focusable(xt)}function findTabbableDescendants(xt){return Array.from(xt.querySelectorAll(FOCUS_SELECTOR)).filter(tabbable)}function scopeTab(xt,$t){const Ct=findTabbableDescendants(xt);if(!Ct.length){$t.preventDefault();return}const kt=Ct[$t.shiftKey?0:Ct.length-1],Mt=xt.getRootNode();let Ft=kt===Mt.activeElement||xt===Mt.activeElement;const jt=Mt.activeElement;if(jt.tagName==="INPUT"&&jt.getAttribute("type")==="radio"&&(Ft=Ct.filter(Ht=>Ht.getAttribute("type")==="radio"&&Ht.getAttribute("name")===jt.getAttribute("name")).includes(kt)),!Ft)return;$t.preventDefault();const Vt=Ct[$t.shiftKey?Ct.length-1:0];Vt&&Vt.focus()}function useFocusTrap(xt=!0){const $t=reactExports.useRef(),Ct=reactExports.useRef(null),kt=Ft=>{let jt=Ft.querySelector("[data-autofocus]");if(!jt){const Bt=Array.from(Ft.querySelectorAll(FOCUS_SELECTOR));jt=Bt.find(tabbable)||Bt.find(focusable)||null,!jt&&focusable(Ft)&&(jt=Ft)}jt&&jt.focus({preventScroll:!0})},Mt=reactExports.useCallback(Ft=>{if(xt){if(Ft===null){Ct.current&&(Ct.current(),Ct.current=null);return}Ct.current=createAriaHider(Ft),$t.current!==Ft&&(Ft?(setTimeout(()=>{Ft.getRootNode()&&kt(Ft)}),$t.current=Ft):$t.current=null)}},[xt]);return reactExports.useEffect(()=>{if(!xt)return;$t.current&&setTimeout(()=>kt($t.current));const Ft=jt=>{jt.key==="Tab"&&$t.current&&scopeTab($t.current,jt)};return document.addEventListener("keydown",Ft),()=>{document.removeEventListener("keydown",Ft),Ct.current&&Ct.current()}},[xt]),Mt}const __useId=React$1.useId||(()=>{});function useReactId$1(){const xt=__useId();return xt?`mantine-${xt.replace(/:/g,"")}`:""}function useId$1(xt){const $t=useReactId$1(),[Ct,kt]=reactExports.useState($t);return useIsomorphicEffect$1(()=>{kt(randomId())},[]),typeof xt=="string"?xt:typeof window>"u"?$t:Ct}function useWindowEvent(xt,$t,Ct){reactExports.useEffect(()=>(window.addEventListener(xt,$t,Ct),()=>window.removeEventListener(xt,$t,Ct)),[xt,$t])}function assignRef(xt,$t){typeof xt=="function"?xt($t):typeof xt=="object"&&xt!==null&&"current"in xt&&(xt.current=$t)}function mergeRefs(...xt){return $t=>{xt.forEach(Ct=>assignRef(Ct,$t))}}function useMergedRef(...xt){return reactExports.useCallback(mergeRefs(...xt),xt)}function useMove(xt,$t,Ct="ltr"){const kt=reactExports.useRef(null),Mt=reactExports.useRef(!1),Ft=reactExports.useRef(!1),jt=reactExports.useRef(0),[Bt,Vt]=reactExports.useState(!1);return reactExports.useEffect(()=>{Mt.current=!0},[]),reactExports.useEffect(()=>{var Jt,Zt;const zt=({x:sn,y:ln})=>{cancelAnimationFrame(jt.current),jt.current=requestAnimationFrame(()=>{if(Mt.current&&kt.current){kt.current.style.userSelect="none";const dn=kt.current.getBoundingClientRect();if(dn.width&&dn.height){const hn=clamp$4((sn-dn.left)/dn.width,0,1);xt({x:Ct==="ltr"?hn:1-hn,y:clamp$4((ln-dn.top)/dn.height,0,1)})}}})},Ht=()=>{document.addEventListener("mousemove",Kt),document.addEventListener("mouseup",Wt),document.addEventListener("touchmove",Qt),document.addEventListener("touchend",Wt)},Gt=()=>{document.removeEventListener("mousemove",Kt),document.removeEventListener("mouseup",Wt),document.removeEventListener("touchmove",Qt),document.removeEventListener("touchend",Wt)},qt=()=>{!Ft.current&&Mt.current&&(Ft.current=!0,typeof($t==null?void 0:$t.onScrubStart)=="function"&&$t.onScrubStart(),Vt(!0),Ht())},Wt=()=>{Ft.current&&Mt.current&&(Ft.current=!1,Vt(!1),Gt(),setTimeout(()=>{typeof($t==null?void 0:$t.onScrubEnd)=="function"&&$t.onScrubEnd()},0))},Yt=sn=>{qt(),sn.preventDefault(),Kt(sn)},Kt=sn=>zt({x:sn.clientX,y:sn.clientY}),Xt=sn=>{sn.cancelable&&sn.preventDefault(),qt(),Qt(sn)},Qt=sn=>{sn.cancelable&&sn.preventDefault(),zt({x:sn.changedTouches[0].clientX,y:sn.changedTouches[0].clientY})};return(Jt=kt.current)==null||Jt.addEventListener("mousedown",Yt),(Zt=kt.current)==null||Zt.addEventListener("touchstart",Xt,{passive:!1}),()=>{kt.current&&(kt.current.removeEventListener("mousedown",Yt),kt.current.removeEventListener("touchstart",Xt))}},[Ct,xt]),{ref:kt,active:Bt}}function useUncontrolled({value:xt,defaultValue:$t,finalValue:Ct,onChange:kt=()=>{}}){const[Mt,Ft]=reactExports.useState($t!==void 0?$t:Ct),jt=(Bt,...Vt)=>{Ft(Bt),kt==null||kt(Bt,...Vt)};return xt!==void 0?[xt,kt,!0]:[Mt,jt,!1]}function useReducedMotion(xt,$t){return useMediaQuery("(prefers-reduced-motion: reduce)",xt,$t)}const defaultState={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};function useResizeObserver$1(xt){const $t=reactExports.useRef(0),Ct=reactExports.useRef(null),[kt,Mt]=reactExports.useState(defaultState),Ft=reactExports.useMemo(()=>typeof window<"u"?new ResizeObserver(jt=>{const Bt=jt[0];Bt&&(cancelAnimationFrame($t.current),$t.current=requestAnimationFrame(()=>{Ct.current&&Mt(Bt.contentRect)}))}):null,[]);return reactExports.useEffect(()=>(Ct.current&&(Ft==null||Ft.observe(Ct.current,xt)),()=>{Ft==null||Ft.disconnect(),$t.current&&cancelAnimationFrame($t.current)}),[Ct.current]),[Ct,kt]}function useElementSize(xt){const[$t,{width:Ct,height:kt}]=useResizeObserver$1(xt);return{ref:$t,width:Ct,height:kt}}function parseHotkey(xt){const $t=xt.toLowerCase().split("+").map(Ft=>Ft.trim()),Ct={alt:$t.includes("alt"),ctrl:$t.includes("ctrl"),meta:$t.includes("meta"),mod:$t.includes("mod"),shift:$t.includes("shift")},kt=["alt","ctrl","meta","shift","mod"],Mt=$t.find(Ft=>!kt.includes(Ft));return{...Ct,key:Mt}}function isExactHotkey(xt,$t){const{alt:Ct,ctrl:kt,meta:Mt,mod:Ft,shift:jt,key:Bt}=xt,{altKey:Vt,ctrlKey:zt,metaKey:Ht,shiftKey:Gt,key:qt}=$t;if(Ct!==Vt)return!1;if(Ft){if(!zt&&!Ht)return!1}else if(kt!==zt||Mt!==Ht)return!1;return jt!==Gt?!1:!!(Bt&&(qt.toLowerCase()===Bt.toLowerCase()||$t.code.replace("Key","").toLowerCase()===Bt.toLowerCase()))}function getHotkeyMatcher(xt){return $t=>isExactHotkey(parseHotkey(xt),$t)}function getHotkeyHandler(xt){return $t=>{const Ct="nativeEvent"in $t?$t.nativeEvent:$t;xt.forEach(([kt,Mt,Ft={preventDefault:!0}])=>{getHotkeyMatcher(kt)(Ct)&&(Ft.preventDefault&&$t.preventDefault(),Mt(Ct))})}}function useDisclosure(xt=!1,$t){const{onOpen:Ct,onClose:kt}={},[Mt,Ft]=reactExports.useState(xt),jt=reactExports.useCallback(()=>{Ft(zt=>zt||(Ct==null||Ct(),!0))},[Ct]),Bt=reactExports.useCallback(()=>{Ft(zt=>zt&&(kt==null||kt(),!1))},[kt]),Vt=reactExports.useCallback(()=>{Mt?Bt():jt()},[Bt,jt,Mt]);return[Mt,{open:jt,close:Bt,toggle:Vt}]}function useTimeout(xt,$t,Ct={autoInvoke:!1}){const kt=reactExports.useRef(null),Mt=reactExports.useCallback((...jt)=>{kt.current||(kt.current=window.setTimeout(()=>{xt(jt),kt.current=null},$t))},[$t]),Ft=reactExports.useCallback(()=>{kt.current&&(window.clearTimeout(kt.current),kt.current=null)},[]);return reactExports.useEffect(()=>(Ct.autoInvoke&&Mt(),Ft),[Ft,Mt]),{start:Mt,clear:Ft}}function useMutationObserver(xt,$t,Ct){const kt=reactExports.useRef(),Mt=reactExports.useRef(null);return reactExports.useEffect(()=>{const Ft=typeof Ct=="function"?Ct():Ct;return(Ft||Mt.current)&&(kt.current=new MutationObserver(xt),kt.current.observe(Ft||Mt.current,$t)),()=>{var jt;(jt=kt.current)==null||jt.disconnect()}},[xt,$t]),Mt}function useMounted(){const[xt,$t]=reactExports.useState(!1);return reactExports.useEffect(()=>$t(!0),[]),xt}function dispatchEvent$1(xt,$t){window.dispatchEvent(new CustomEvent(xt,{detail:$t}))}function createUseExternalEvents(xt){function $t(kt){const Mt=Object.keys(kt).reduce((Ft,jt)=>(Ft[`${xt}:${jt}`]=Bt=>kt[jt](Bt.detail),Ft),{});useIsomorphicEffect$1(()=>(Object.keys(Mt).forEach(Ft=>{window.removeEventListener(Ft,Mt[Ft]),window.addEventListener(Ft,Mt[Ft])}),()=>Object.keys(Mt).forEach(Ft=>{window.removeEventListener(Ft,Mt[Ft])})),[Mt])}function Ct(kt){return(...Mt)=>dispatchEvent$1(`${xt}:${String(kt)}`,Mt[0])}return[$t,Ct]}var define_process_env_default$2={};function getEnv(){return typeof process<"u"&&define_process_env_default$2?"production":"development"}function createVarsResolver(xt){return xt}function r$2(xt){var $t,Ct,kt="";if(typeof xt=="string"||typeof xt=="number")kt+=xt;else if(typeof xt=="object")if(Array.isArray(xt)){var Mt=xt.length;for($t=0;$t<Mt;$t++)xt[$t]&&(Ct=r$2(xt[$t]))&&(kt&&(kt+=" "),kt+=Ct)}else for(Ct in xt)xt[Ct]&&(kt&&(kt+=" "),kt+=Ct);return kt}function clsx(){for(var xt,$t,Ct=0,kt="",Mt=arguments.length;Ct<Mt;Ct++)(xt=arguments[Ct])&&($t=r$2(xt))&&(kt&&(kt+=" "),kt+=$t);return kt}const EMPTY_CLASS_NAMES={};function mergeClassNames(xt){const $t={};return xt.forEach(Ct=>{Object.entries(Ct).forEach(([kt,Mt])=>{$t[kt]?$t[kt]=clsx($t[kt],Mt):$t[kt]=Mt})}),$t}function resolveClassNames({theme:xt,classNames:$t,props:Ct,stylesCtx:kt}){const Ft=(Array.isArray($t)?$t:[$t]).map(jt=>typeof jt=="function"?jt(xt,Ct,kt):jt||EMPTY_CLASS_NAMES);return mergeClassNames(Ft)}function resolveStyles({theme:xt,styles:$t,props:Ct,stylesCtx:kt}){return(Array.isArray($t)?$t:[$t]).reduce((Ft,jt)=>typeof jt=="function"?{...Ft,...jt(xt,Ct,kt)}:{...Ft,...jt},{})}const MantineContext=reactExports.createContext(null);function useMantineContext(){const xt=reactExports.useContext(MantineContext);if(!xt)throw new Error("[@mantine/core] MantineProvider was not found in tree");return xt}function useMantineCssVariablesResolver(){return useMantineContext().cssVariablesResolver}function useMantineClassNamesPrefix(){return useMantineContext().classNamesPrefix}function useMantineStyleNonce(){return useMantineContext().getStyleNonce}function useMantineWithStaticClasses(){return useMantineContext().withStaticClasses}function useMantineIsHeadless(){return useMantineContext().headless}function useMantineSxTransform(){var xt;return(xt=useMantineContext().stylesTransform)==null?void 0:xt.sx}function useMantineStylesTransform(){var xt;return(xt=useMantineContext().stylesTransform)==null?void 0:xt.styles}function isHexColor(xt){return/^#?([0-9A-F]{3}){1,2}([0-9A-F]{2})?$/i.test(xt)}function hexToRgba(xt){let $t=xt.replace("#","");if($t.length===3){const jt=$t.split("");$t=[jt[0],jt[0],jt[1],jt[1],jt[2],jt[2]].join("")}if($t.length===8){const jt=parseInt($t.slice(6,8),16)/255;return{r:parseInt($t.slice(0,2),16),g:parseInt($t.slice(2,4),16),b:parseInt($t.slice(4,6),16),a:jt}}const Ct=parseInt($t,16),kt=Ct>>16&255,Mt=Ct>>8&255,Ft=Ct&255;return{r:kt,g:Mt,b:Ft,a:1}}function rgbStringToRgba(xt){const[$t,Ct,kt,Mt]=xt.replace(/[^0-9,./]/g,"").split(/[/,]/).map(Number);return{r:$t,g:Ct,b:kt,a:Mt||1}}function hslStringToRgba(xt){const $t=/^hsla?\(\s*(\d+)\s*,\s*(\d+%)\s*,\s*(\d+%)\s*(,\s*(0?\.\d+|\d+(\.\d+)?))?\s*\)$/i,Ct=xt.match($t);if(!Ct)return{r:0,g:0,b:0,a:1};const kt=parseInt(Ct[1],10),Mt=parseInt(Ct[2],10)/100,Ft=parseInt(Ct[3],10)/100,jt=Ct[5]?parseFloat(Ct[5]):void 0,Bt=(1-Math.abs(2*Ft-1))*Mt,Vt=kt/60,zt=Bt*(1-Math.abs(Vt%2-1)),Ht=Ft-Bt/2;let Gt,qt,Wt;return Vt>=0&&Vt<1?(Gt=Bt,qt=zt,Wt=0):Vt>=1&&Vt<2?(Gt=zt,qt=Bt,Wt=0):Vt>=2&&Vt<3?(Gt=0,qt=Bt,Wt=zt):Vt>=3&&Vt<4?(Gt=0,qt=zt,Wt=Bt):Vt>=4&&Vt<5?(Gt=zt,qt=0,Wt=Bt):(Gt=Bt,qt=0,Wt=zt),{r:Math.round((Gt+Ht)*255),g:Math.round((qt+Ht)*255),b:Math.round((Wt+Ht)*255),a:jt||1}}function toRgba(xt){return isHexColor(xt)?hexToRgba(xt):xt.startsWith("rgb")?rgbStringToRgba(xt):xt.startsWith("hsl")?hslStringToRgba(xt):{r:0,g:0,b:0,a:1}}function darken(xt,$t){if(xt.startsWith("var("))return`color-mix(in srgb, ${xt}, black ${$t*100}%)`;const{r:Ct,g:kt,b:Mt,a:Ft}=toRgba(xt),jt=1-$t,Bt=Vt=>Math.round(Vt*jt);return`rgba(${Bt(Ct)}, ${Bt(kt)}, ${Bt(Mt)}, ${Ft})`}function getPrimaryShade(xt,$t){return typeof xt.primaryShade=="number"?xt.primaryShade:$t==="dark"?xt.primaryShade.dark:xt.primaryShade.light}function gammaCorrect(xt){return xt<=.03928?xt/12.92:((xt+.055)/1.055)**2.4}function getLightnessFromOklch(xt){const $t=xt.match(/oklch\((.*?)%\s/);return $t?parseFloat($t[1]):null}function luminance$1(xt){if(xt.startsWith("oklch("))return(getLightnessFromOklch(xt)||0)/100;const{r:$t,g:Ct,b:kt}=toRgba(xt),Mt=$t/255,Ft=Ct/255,jt=kt/255,Bt=gammaCorrect(Mt),Vt=gammaCorrect(Ft),zt=gammaCorrect(jt);return .2126*Bt+.7152*Vt+.0722*zt}function isLightColor(xt,$t=.179){return xt.startsWith("var(")?!1:luminance$1(xt)>$t}function parseThemeColor({color:xt,theme:$t,colorScheme:Ct}){if(typeof xt!="string")throw new Error(`[@mantine/core] Failed to parse color. Expected color to be a string, instead got ${typeof xt}`);if(xt==="bright")return{color:xt,value:Ct==="dark"?$t.white:$t.black,shade:void 0,isThemeColor:!1,isLight:isLightColor(Ct==="dark"?$t.white:$t.black,$t.luminanceThreshold),variable:"--mantine-color-bright"};if(xt==="dimmed")return{color:xt,value:Ct==="dark"?$t.colors.dark[2]:$t.colors.gray[7],shade:void 0,isThemeColor:!1,isLight:isLightColor(Ct==="dark"?$t.colors.dark[2]:$t.colors.gray[6],$t.luminanceThreshold),variable:"--mantine-color-dimmed"};if(xt==="white"||xt==="black")return{color:xt,value:xt==="white"?$t.white:$t.black,shade:void 0,isThemeColor:!1,isLight:isLightColor(xt==="white"?$t.white:$t.black,$t.luminanceThreshold),variable:`--mantine-color-${xt}`};const[kt,Mt]=xt.split("."),Ft=Mt?Number(Mt):void 0,jt=kt in $t.colors;if(jt){const Bt=Ft!==void 0?$t.colors[kt][Ft]:$t.colors[kt][getPrimaryShade($t,Ct||"light")];return{color:kt,value:Bt,shade:Ft,isThemeColor:jt,isLight:isLightColor(Bt,$t.luminanceThreshold),variable:Mt?`--mantine-color-${kt}-${Ft}`:`--mantine-color-${kt}-filled`}}return{color:xt,value:xt,isThemeColor:jt,isLight:isLightColor(xt,$t.luminanceThreshold),shade:Ft,variable:void 0}}function getThemeColor(xt,$t){const Ct=parseThemeColor({color:xt||$t.primaryColor,theme:$t});return Ct.variable?`var(${Ct.variable})`:xt}function getGradient(xt,$t){const Ct={from:(xt==null?void 0:xt.from)||$t.defaultGradient.from,to:(xt==null?void 0:xt.to)||$t.defaultGradient.to,deg:(xt==null?void 0:xt.deg)||$t.defaultGradient.deg||0},kt=getThemeColor(Ct.from,$t),Mt=getThemeColor(Ct.to,$t);return`linear-gradient(${Ct.deg}deg, ${kt} 0%, ${Mt} 100%)`}function rgba$1(xt,$t){if(typeof xt!="string"||$t>1||$t<0)return"rgba(0, 0, 0, 1)";if(xt.startsWith("var(")){const Ft=(1-$t)*100;return`color-mix(in srgb, ${xt}, transparent ${Ft}%)`}if(xt.startsWith("oklch"))return xt.includes("/")?xt.replace(/\/\s*[\d.]+\s*\)/,`/ ${$t})`):xt.replace(")",` / ${$t})`);const{r:Ct,g:kt,b:Mt}=toRgba(xt);return`rgba(${Ct}, ${kt}, ${Mt}, ${$t})`}const alpha=rgba$1,defaultVariantColorsResolver=({color:xt,theme:$t,variant:Ct,gradient:kt,autoContrast:Mt})=>{const Ft=parseThemeColor({color:xt,theme:$t}),jt=typeof Mt=="boolean"?Mt:$t.autoContrast;if(Ct==="filled"){const Bt=jt&&Ft.isLight?"var(--mantine-color-black)":"var(--mantine-color-white)";return Ft.isThemeColor?Ft.shade===void 0?{background:`var(--mantine-color-${xt}-filled)`,hover:`var(--mantine-color-${xt}-filled-hover)`,color:Bt,border:`${rem$1(1)} solid transparent`}:{background:`var(--mantine-color-${Ft.color}-${Ft.shade})`,hover:`var(--mantine-color-${Ft.color}-${Ft.shade===9?8:Ft.shade+1})`,color:Bt,border:`${rem$1(1)} solid transparent`}:{background:xt,hover:darken(xt,.1),color:Bt,border:`${rem$1(1)} solid transparent`}}if(Ct==="light"){if(Ft.isThemeColor){if(Ft.shade===void 0)return{background:`var(--mantine-color-${xt}-light)`,hover:`var(--mantine-color-${xt}-light-hover)`,color:`var(--mantine-color-${xt}-light-color)`,border:`${rem$1(1)} solid transparent`};const Bt=$t.colors[Ft.color][Ft.shade];return{background:rgba$1(Bt,.1),hover:rgba$1(Bt,.12),color:`var(--mantine-color-${Ft.color}-${Math.min(Ft.shade,6)})`,border:`${rem$1(1)} solid transparent`}}return{background:rgba$1(xt,.1),hover:rgba$1(xt,.12),color:xt,border:`${rem$1(1)} solid transparent`}}if(Ct==="outline")return Ft.isThemeColor?Ft.shade===void 0?{background:"transparent",hover:`var(--mantine-color-${xt}-outline-hover)`,color:`var(--mantine-color-${xt}-outline)`,border:`${rem$1(1)} solid var(--mantine-color-${xt}-outline)`}:{background:"transparent",hover:rgba$1($t.colors[Ft.color][Ft.shade],.05),color:`var(--mantine-color-${Ft.color}-${Ft.shade})`,border:`${rem$1(1)} solid var(--mantine-color-${Ft.color}-${Ft.shade})`}:{background:"transparent",hover:rgba$1(xt,.05),color:xt,border:`${rem$1(1)} solid ${xt}`};if(Ct==="subtle"){if(Ft.isThemeColor){if(Ft.shade===void 0)return{background:"transparent",hover:`var(--mantine-color-${xt}-light-hover)`,color:`var(--mantine-color-${xt}-light-color)`,border:`${rem$1(1)} solid transparent`};const Bt=$t.colors[Ft.color][Ft.shade];return{background:"transparent",hover:rgba$1(Bt,.12),color:`var(--mantine-color-${Ft.color}-${Math.min(Ft.shade,6)})`,border:`${rem$1(1)} solid transparent`}}return{background:"transparent",hover:rgba$1(xt,.12),color:xt,border:`${rem$1(1)} solid transparent`}}return Ct==="transparent"?Ft.isThemeColor?Ft.shade===void 0?{background:"transparent",hover:"transparent",color:`var(--mantine-color-${xt}-light-color)`,border:`${rem$1(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:`var(--mantine-color-${Ft.color}-${Math.min(Ft.shade,6)})`,border:`${rem$1(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:xt,border:`${rem$1(1)} solid transparent`}:Ct==="white"?Ft.isThemeColor?Ft.shade===void 0?{background:"var(--mantine-color-white)",hover:darken($t.white,.01),color:`var(--mantine-color-${xt}-filled)`,border:`${rem$1(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:darken($t.white,.01),color:`var(--mantine-color-${Ft.color}-${Ft.shade})`,border:`${rem$1(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:darken($t.white,.01),color:xt,border:`${rem$1(1)} solid transparent`}:Ct==="gradient"?{background:getGradient(kt,$t),hover:getGradient(kt,$t),color:"var(--mantine-color-white)",border:"none"}:Ct==="default"?{background:"var(--mantine-color-default)",hover:"var(--mantine-color-default-hover)",color:"var(--mantine-color-default-color)",border:`${rem$1(1)} solid var(--mantine-color-default-border)`}:{}},DEFAULT_COLORS={dark:["#C9C9C9","#b8b8b8","#828282","#696969","#424242","#3b3b3b","#2e2e2e","#242424","#1f1f1f","#141414"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]},DEFAULT_FONT_FAMILY="-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",DEFAULT_THEME={scale:1,fontSmoothing:!0,focusRing:"auto",white:"#fff",black:"#000",colors:DEFAULT_COLORS,primaryShade:{light:6,dark:8},primaryColor:"blue",variantColorResolver:defaultVariantColorsResolver,autoContrast:!1,luminanceThreshold:.3,fontFamily:DEFAULT_FONT_FAMILY,fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",respectReducedMotion:!1,cursorType:"default",defaultGradient:{from:"blue",to:"cyan",deg:45},defaultRadius:"sm",activeClassName:"mantine-active",focusClassName:"",headings:{fontFamily:DEFAULT_FONT_FAMILY,fontWeight:"700",textWrap:"wrap",sizes:{h1:{fontSize:rem$1(34),lineHeight:"1.3"},h2:{fontSize:rem$1(26),lineHeight:"1.35"},h3:{fontSize:rem$1(22),lineHeight:"1.4"},h4:{fontSize:rem$1(18),lineHeight:"1.45"},h5:{fontSize:rem$1(16),lineHeight:"1.5"},h6:{fontSize:rem$1(14),lineHeight:"1.5"}}},fontSizes:{xs:rem$1(12),sm:rem$1(14),md:rem$1(16),lg:rem$1(18),xl:rem$1(20)},lineHeights:{xs:"1.4",sm:"1.45",md:"1.55",lg:"1.6",xl:"1.65"},radius:{xs:rem$1(2),sm:rem$1(4),md:rem$1(8),lg:rem$1(16),xl:rem$1(32)},spacing:{xs:rem$1(10),sm:rem$1(12),md:rem$1(16),lg:rem$1(20),xl:rem$1(32)},breakpoints:{xs:"36em",sm:"48em",md:"62em",lg:"75em",xl:"88em"},shadows:{xs:`0 ${rem$1(1)} ${rem$1(3)} rgba(0, 0, 0, 0.05), 0 ${rem$1(1)} ${rem$1(2)} rgba(0, 0, 0, 0.1)`,sm:`0 ${rem$1(1)} ${rem$1(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${rem$1(10)} ${rem$1(15)} ${rem$1(-5)}, rgba(0, 0, 0, 0.04) 0 ${rem$1(7)} ${rem$1(7)} ${rem$1(-5)}`,md:`0 ${rem$1(1)} ${rem$1(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${rem$1(20)} ${rem$1(25)} ${rem$1(-5)}, rgba(0, 0, 0, 0.04) 0 ${rem$1(10)} ${rem$1(10)} ${rem$1(-5)}`,lg:`0 ${rem$1(1)} ${rem$1(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${rem$1(28)} ${rem$1(23)} ${rem$1(-7)}, rgba(0, 0, 0, 0.04) 0 ${rem$1(12)} ${rem$1(12)} ${rem$1(-7)}`,xl:`0 ${rem$1(1)} ${rem$1(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${rem$1(36)} ${rem$1(28)} ${rem$1(-7)}, rgba(0, 0, 0, 0.04) 0 ${rem$1(17)} ${rem$1(17)} ${rem$1(-7)}`},other:{},components:{}};function isMantineColorScheme(xt){return xt==="auto"||xt==="dark"||xt==="light"}function localStorageColorSchemeManager({key:xt="mantine-color-scheme-value"}={}){let $t;return{get:Ct=>{if(typeof window>"u")return Ct;try{const kt=window.localStorage.getItem(xt);return isMantineColorScheme(kt)?kt:Ct}catch{return Ct}},set:Ct=>{try{window.localStorage.setItem(xt,Ct)}catch(kt){console.warn("[@mantine/core] Local storage color scheme manager was unable to save color scheme.",kt)}},subscribe:Ct=>{$t=kt=>{kt.storageArea===window.localStorage&&kt.key===xt&&isMantineColorScheme(kt.newValue)&&Ct(kt.newValue)},window.addEventListener("storage",$t)},unsubscribe:()=>{window.removeEventListener("storage",$t)},clear:()=>{window.localStorage.removeItem(xt)}}}const INVALID_PRIMARY_COLOR_ERROR="[@mantine/core] MantineProvider: Invalid theme.primaryColor, it accepts only key of theme.colors, learn more  https://mantine.dev/theming/colors/#primary-color",INVALID_PRIMARY_SHADE_ERROR="[@mantine/core] MantineProvider: Invalid theme.primaryShade, it accepts only 0-9 integers or an object { light: 0-9, dark: 0-9 }";function isValidPrimaryShade(xt){return xt<0||xt>9?!1:parseInt(xt.toString(),10)===xt}function validateMantineTheme(xt){if(!(xt.primaryColor in xt.colors))throw new Error(INVALID_PRIMARY_COLOR_ERROR);if(typeof xt.primaryShade=="object"&&(!isValidPrimaryShade(xt.primaryShade.dark)||!isValidPrimaryShade(xt.primaryShade.light)))throw new Error(INVALID_PRIMARY_SHADE_ERROR);if(typeof xt.primaryShade=="number"&&!isValidPrimaryShade(xt.primaryShade))throw new Error(INVALID_PRIMARY_SHADE_ERROR)}function mergeMantineTheme(xt,$t){var kt;if(!$t)return validateMantineTheme(xt),xt;const Ct=deepMerge(xt,$t);return $t.fontFamily&&!((kt=$t.headings)!=null&&kt.fontFamily)&&(Ct.headings.fontFamily=$t.fontFamily),validateMantineTheme(Ct),Ct}const MantineThemeContext=reactExports.createContext(null),useSafeMantineTheme=()=>reactExports.useContext(MantineThemeContext)||DEFAULT_THEME;function useMantineTheme(){const xt=reactExports.useContext(MantineThemeContext);if(!xt)throw new Error("@mantine/core: MantineProvider was not found in component tree, make sure you have it in your app");return xt}function MantineThemeProvider({theme:xt,children:$t,inherit:Ct=!0}){const kt=useSafeMantineTheme(),Mt=reactExports.useMemo(()=>mergeMantineTheme(Ct?kt:DEFAULT_THEME,xt),[xt,kt,Ct]);return jsxRuntimeExports.jsx(MantineThemeContext.Provider,{value:Mt,children:$t})}MantineThemeProvider.displayName="@mantine/core/MantineThemeProvider";function MantineClasses(){const xt=useMantineTheme(),$t=useMantineStyleNonce(),Ct=keys$4(xt.breakpoints).reduce((kt,Mt)=>{const Ft=xt.breakpoints[Mt].includes("px"),jt=px$1(xt.breakpoints[Mt]),Bt=Ft?`${jt-.1}px`:em(jt-.1),Vt=Ft?`${jt}px`:em(jt);return`${kt}@media (max-width: ${Bt}) {.mantine-visible-from-${Mt} {display: none !important;}}@media (min-width: ${Vt}) {.mantine-hidden-from-${Mt} {display: none !important;}}`},"");return jsxRuntimeExports.jsx("style",{"data-mantine-styles":"classes",nonce:$t==null?void 0:$t(),dangerouslySetInnerHTML:{__html:Ct}})}function cssVariablesObjectToString(xt){return Object.entries(xt).map(([$t,Ct])=>`${$t}: ${Ct};`).join("")}function wrapWithSelector(xt,$t){return(Array.isArray(xt)?xt:[xt]).reduce((kt,Mt)=>`${Mt}{${kt}}`,$t)}function convertCssVariables(xt,$t){const Ct=cssVariablesObjectToString(xt.variables),kt=Ct?wrapWithSelector($t,Ct):"",Mt=cssVariablesObjectToString(xt.dark),Ft=Mt?wrapWithSelector(`${$t}[data-mantine-color-scheme="dark"]`,Mt):"",jt=cssVariablesObjectToString(xt.light),Bt=jt?wrapWithSelector(`${$t}[data-mantine-color-scheme="light"]`,jt):"";return`${kt}${Ft}${Bt}`}function getContrastColor({color:xt,theme:$t,autoContrast:Ct}){return(typeof Ct=="boolean"?Ct:$t.autoContrast)&&parseThemeColor({color:xt||$t.primaryColor,theme:$t}).isLight?"var(--mantine-color-black)":"var(--mantine-color-white)"}function getPrimaryContrastColor(xt,$t){return getContrastColor({color:xt.colors[xt.primaryColor][getPrimaryShade(xt,$t)],theme:xt,autoContrast:null})}function getCSSColorVariables({theme:xt,color:$t,colorScheme:Ct,name:kt=$t,withColorValues:Mt=!0}){if(!xt.colors[$t])return{};if(Ct==="light"){const Bt=getPrimaryShade(xt,"light"),Vt={[`--mantine-color-${kt}-text`]:`var(--mantine-color-${kt}-filled)`,[`--mantine-color-${kt}-filled`]:`var(--mantine-color-${kt}-${Bt})`,[`--mantine-color-${kt}-filled-hover`]:`var(--mantine-color-${kt}-${Bt===9?8:Bt+1})`,[`--mantine-color-${kt}-light`]:alpha(xt.colors[$t][Bt],.1),[`--mantine-color-${kt}-light-hover`]:alpha(xt.colors[$t][Bt],.12),[`--mantine-color-${kt}-light-color`]:`var(--mantine-color-${kt}-${Bt})`,[`--mantine-color-${kt}-outline`]:`var(--mantine-color-${kt}-${Bt})`,[`--mantine-color-${kt}-outline-hover`]:alpha(xt.colors[$t][Bt],.05)};return Mt?{[`--mantine-color-${kt}-0`]:xt.colors[$t][0],[`--mantine-color-${kt}-1`]:xt.colors[$t][1],[`--mantine-color-${kt}-2`]:xt.colors[$t][2],[`--mantine-color-${kt}-3`]:xt.colors[$t][3],[`--mantine-color-${kt}-4`]:xt.colors[$t][4],[`--mantine-color-${kt}-5`]:xt.colors[$t][5],[`--mantine-color-${kt}-6`]:xt.colors[$t][6],[`--mantine-color-${kt}-7`]:xt.colors[$t][7],[`--mantine-color-${kt}-8`]:xt.colors[$t][8],[`--mantine-color-${kt}-9`]:xt.colors[$t][9],...Vt}:Vt}const Ft=getPrimaryShade(xt,"dark"),jt={[`--mantine-color-${kt}-text`]:`var(--mantine-color-${kt}-4)`,[`--mantine-color-${kt}-filled`]:`var(--mantine-color-${kt}-${Ft})`,[`--mantine-color-${kt}-filled-hover`]:`var(--mantine-color-${kt}-${Ft===9?8:Ft+1})`,[`--mantine-color-${kt}-light`]:alpha(xt.colors[$t][Math.max(0,Ft-2)],.15),[`--mantine-color-${kt}-light-hover`]:alpha(xt.colors[$t][Math.max(0,Ft-2)],.2),[`--mantine-color-${kt}-light-color`]:`var(--mantine-color-${kt}-${Math.max(Ft-5,0)})`,[`--mantine-color-${kt}-outline`]:`var(--mantine-color-${kt}-${Math.max(Ft-4,0)})`,[`--mantine-color-${kt}-outline-hover`]:alpha(xt.colors[$t][Math.max(Ft-4,0)],.05)};return Mt?{[`--mantine-color-${kt}-0`]:xt.colors[$t][0],[`--mantine-color-${kt}-1`]:xt.colors[$t][1],[`--mantine-color-${kt}-2`]:xt.colors[$t][2],[`--mantine-color-${kt}-3`]:xt.colors[$t][3],[`--mantine-color-${kt}-4`]:xt.colors[$t][4],[`--mantine-color-${kt}-5`]:xt.colors[$t][5],[`--mantine-color-${kt}-6`]:xt.colors[$t][6],[`--mantine-color-${kt}-7`]:xt.colors[$t][7],[`--mantine-color-${kt}-8`]:xt.colors[$t][8],[`--mantine-color-${kt}-9`]:xt.colors[$t][9],...jt}:jt}function colorsTuple(xt){return Array.isArray(xt)?xt:Array(10).fill(xt)}function isVirtualColor(xt){return!!xt&&typeof xt=="object"&&"mantine-virtual-color"in xt}function assignSizeVariables(xt,$t,Ct){keys$4($t).forEach(kt=>Object.assign(xt,{[`--mantine-${Ct}-${kt}`]:$t[kt]}))}const defaultCssVariablesResolver=xt=>{const $t=getPrimaryShade(xt,"light"),Ct=xt.defaultRadius in xt.radius?xt.radius[xt.defaultRadius]:rem$1(xt.defaultRadius),kt={variables:{"--mantine-scale":xt.scale.toString(),"--mantine-cursor-type":xt.cursorType,"--mantine-color-scheme":"light dark","--mantine-webkit-font-smoothing":xt.fontSmoothing?"antialiased":"unset","--mantine-moz-font-smoothing":xt.fontSmoothing?"grayscale":"unset","--mantine-color-white":xt.white,"--mantine-color-black":xt.black,"--mantine-line-height":xt.lineHeights.md,"--mantine-font-family":xt.fontFamily,"--mantine-font-family-monospace":xt.fontFamilyMonospace,"--mantine-font-family-headings":xt.headings.fontFamily,"--mantine-heading-font-weight":xt.headings.fontWeight,"--mantine-heading-text-wrap":xt.headings.textWrap,"--mantine-radius-default":Ct,"--mantine-primary-color-filled":`var(--mantine-color-${xt.primaryColor}-filled)`,"--mantine-primary-color-filled-hover":`var(--mantine-color-${xt.primaryColor}-filled-hover)`,"--mantine-primary-color-light":`var(--mantine-color-${xt.primaryColor}-light)`,"--mantine-primary-color-light-hover":`var(--mantine-color-${xt.primaryColor}-light-hover)`,"--mantine-primary-color-light-color":`var(--mantine-color-${xt.primaryColor}-light-color)`},light:{"--mantine-primary-color-contrast":getPrimaryContrastColor(xt,"light"),"--mantine-color-bright":"var(--mantine-color-black)","--mantine-color-text":xt.black,"--mantine-color-body":xt.white,"--mantine-color-error":"var(--mantine-color-red-6)","--mantine-color-placeholder":"var(--mantine-color-gray-5)","--mantine-color-anchor":`var(--mantine-color-${xt.primaryColor}-${$t})`,"--mantine-color-default":"var(--mantine-color-white)","--mantine-color-default-hover":"var(--mantine-color-gray-0)","--mantine-color-default-color":"var(--mantine-color-black)","--mantine-color-default-border":"var(--mantine-color-gray-4)","--mantine-color-dimmed":"var(--mantine-color-gray-6)"},dark:{"--mantine-primary-color-contrast":getPrimaryContrastColor(xt,"dark"),"--mantine-color-bright":"var(--mantine-color-white)","--mantine-color-text":"var(--mantine-color-dark-0)","--mantine-color-body":"var(--mantine-color-dark-7)","--mantine-color-error":"var(--mantine-color-red-8)","--mantine-color-placeholder":"var(--mantine-color-dark-3)","--mantine-color-anchor":`var(--mantine-color-${xt.primaryColor}-4)`,"--mantine-color-default":"var(--mantine-color-dark-6)","--mantine-color-default-hover":"var(--mantine-color-dark-5)","--mantine-color-default-color":"var(--mantine-color-white)","--mantine-color-default-border":"var(--mantine-color-dark-4)","--mantine-color-dimmed":"var(--mantine-color-dark-2)"}};assignSizeVariables(kt.variables,xt.breakpoints,"breakpoint"),assignSizeVariables(kt.variables,xt.spacing,"spacing"),assignSizeVariables(kt.variables,xt.fontSizes,"font-size"),assignSizeVariables(kt.variables,xt.lineHeights,"line-height"),assignSizeVariables(kt.variables,xt.shadows,"shadow"),assignSizeVariables(kt.variables,xt.radius,"radius"),xt.colors[xt.primaryColor].forEach((Ft,jt)=>{kt.variables[`--mantine-primary-color-${jt}`]=`var(--mantine-color-${xt.primaryColor}-${jt})`}),keys$4(xt.colors).forEach(Ft=>{const jt=xt.colors[Ft];if(isVirtualColor(jt)){Object.assign(kt.light,getCSSColorVariables({theme:xt,name:jt.name,color:jt.light,colorScheme:"light",withColorValues:!0})),Object.assign(kt.dark,getCSSColorVariables({theme:xt,name:jt.name,color:jt.dark,colorScheme:"dark",withColorValues:!0}));return}jt.forEach((Bt,Vt)=>{kt.variables[`--mantine-color-${Ft}-${Vt}`]=Bt}),Object.assign(kt.light,getCSSColorVariables({theme:xt,color:Ft,colorScheme:"light",withColorValues:!1})),Object.assign(kt.dark,getCSSColorVariables({theme:xt,color:Ft,colorScheme:"dark",withColorValues:!1}))});const Mt=xt.headings.sizes;return keys$4(Mt).forEach(Ft=>{kt.variables[`--mantine-${Ft}-font-size`]=Mt[Ft].fontSize,kt.variables[`--mantine-${Ft}-line-height`]=Mt[Ft].lineHeight,kt.variables[`--mantine-${Ft}-font-weight`]=Mt[Ft].fontWeight||xt.headings.fontWeight}),kt};function getMergedVariables({theme:xt,generator:$t}){const Ct=defaultCssVariablesResolver(xt),kt=$t==null?void 0:$t(xt);return kt?deepMerge(Ct,kt):Ct}const defaultCssVariables=defaultCssVariablesResolver(DEFAULT_THEME);function removeDefaultVariables(xt){const $t={variables:{},light:{},dark:{}};return keys$4(xt.variables).forEach(Ct=>{defaultCssVariables.variables[Ct]!==xt.variables[Ct]&&($t.variables[Ct]=xt.variables[Ct])}),keys$4(xt.light).forEach(Ct=>{defaultCssVariables.light[Ct]!==xt.light[Ct]&&($t.light[Ct]=xt.light[Ct])}),keys$4(xt.dark).forEach(Ct=>{defaultCssVariables.dark[Ct]!==xt.dark[Ct]&&($t.dark[Ct]=xt.dark[Ct])}),$t}function getColorSchemeCssVariables(xt){return`
  ${xt}[data-mantine-color-scheme="dark"] { --mantine-color-scheme: dark; }
  ${xt}[data-mantine-color-scheme="light"] { --mantine-color-scheme: light; }
`}function MantineCssVariables({cssVariablesSelector:xt,deduplicateCssVariables:$t}){const Ct=useMantineTheme(),kt=useMantineStyleNonce(),Mt=useMantineCssVariablesResolver(),Ft=getMergedVariables({theme:Ct,generator:Mt}),jt=xt===":root"&&$t,Bt=jt?removeDefaultVariables(Ft):Ft,Vt=convertCssVariables(Bt,xt);return Vt?jsxRuntimeExports.jsx("style",{"data-mantine-styles":!0,nonce:kt==null?void 0:kt(),dangerouslySetInnerHTML:{__html:`${Vt}${jt?"":getColorSchemeCssVariables(xt)}`}}):null}MantineCssVariables.displayName="@mantine/CssVariables";function suppressNextjsWarning(){const xt=console.error;console.error=(...$t)=>{$t.length>1&&typeof $t[0]=="string"&&$t[0].toLowerCase().includes("extra attributes from the server")&&typeof $t[1]=="string"&&$t[1].toLowerCase().includes("data-mantine-color-scheme")||xt(...$t)}}function setColorSchemeAttribute(xt,$t){var kt;const Ct=xt!=="auto"?xt:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";(kt=$t())==null||kt.setAttribute("data-mantine-color-scheme",Ct)}function useProviderColorScheme({manager:xt,defaultColorScheme:$t,getRootElement:Ct,forceColorScheme:kt}){const Mt=reactExports.useRef(),[Ft,jt]=reactExports.useState(()=>xt.get($t)),Bt=kt||Ft,Vt=reactExports.useCallback(Ht=>{kt||(setColorSchemeAttribute(Ht,Ct),jt(Ht),xt.set(Ht))},[xt.set,Bt,kt]),zt=reactExports.useCallback(()=>{jt($t),setColorSchemeAttribute($t,Ct),xt.clear()},[xt.clear,$t]);return reactExports.useEffect(()=>(xt.subscribe(Vt),xt.unsubscribe),[xt.subscribe,xt.unsubscribe]),useIsomorphicEffect$1(()=>{setColorSchemeAttribute(xt.get($t),Ct)},[]),reactExports.useEffect(()=>{var Gt;if(kt)return setColorSchemeAttribute(kt,Ct),()=>{};kt===void 0&&setColorSchemeAttribute(Ft,Ct),Mt.current=window.matchMedia("(prefers-color-scheme: dark)");const Ht=qt=>{Ft==="auto"&&setColorSchemeAttribute(qt.matches?"dark":"light",Ct)};return(Gt=Mt.current)==null||Gt.addEventListener("change",Ht),()=>{var qt;return(qt=Mt.current)==null?void 0:qt.removeEventListener("change",Ht)}},[Ft,kt]),{colorScheme:Bt,setColorScheme:Vt,clearColorScheme:zt}}function useRespectReduceMotion({respectReducedMotion:xt,getRootElement:$t}){useIsomorphicEffect$1(()=>{var Ct;xt&&((Ct=$t())==null||Ct.setAttribute("data-respect-reduced-motion","true"))},[xt])}suppressNextjsWarning();function MantineProvider({theme:xt,children:$t,getStyleNonce:Ct,withStaticClasses:kt=!0,withGlobalClasses:Mt=!0,deduplicateCssVariables:Ft=!0,withCssVariables:jt=!0,cssVariablesSelector:Bt=":root",classNamesPrefix:Vt="mantine",colorSchemeManager:zt=localStorageColorSchemeManager(),defaultColorScheme:Ht="light",getRootElement:Gt=()=>document.documentElement,cssVariablesResolver:qt,forceColorScheme:Wt,stylesTransform:Yt}){const{colorScheme:Kt,setColorScheme:Xt,clearColorScheme:Qt}=useProviderColorScheme({defaultColorScheme:Ht,forceColorScheme:Wt,manager:zt,getRootElement:Gt});return useRespectReduceMotion({respectReducedMotion:(xt==null?void 0:xt.respectReducedMotion)||!1,getRootElement:Gt}),jsxRuntimeExports.jsx(MantineContext.Provider,{value:{colorScheme:Kt,setColorScheme:Xt,clearColorScheme:Qt,getRootElement:Gt,classNamesPrefix:Vt,getStyleNonce:Ct,cssVariablesResolver:qt,cssVariablesSelector:Bt,withStaticClasses:kt,stylesTransform:Yt},children:jsxRuntimeExports.jsxs(MantineThemeProvider,{theme:xt,children:[jt&&jsxRuntimeExports.jsx(MantineCssVariables,{cssVariablesSelector:Bt,deduplicateCssVariables:Ft}),Mt&&jsxRuntimeExports.jsx(MantineClasses,{}),$t]})})}MantineProvider.displayName="@mantine/core/MantineProvider";function useResolvedStylesApi({classNames:xt,styles:$t,props:Ct,stylesCtx:kt}){const Mt=useMantineTheme();return{resolvedClassNames:resolveClassNames({theme:Mt,classNames:xt,props:Ct,stylesCtx:kt||void 0}),resolvedStyles:resolveStyles({theme:Mt,styles:$t,props:Ct,stylesCtx:kt||void 0})}}const FOCUS_CLASS_NAMES={always:"mantine-focus-always",auto:"mantine-focus-auto",never:"mantine-focus-never"};function getGlobalClassNames({theme:xt,options:$t,unstyled:Ct}){return clsx(($t==null?void 0:$t.focusable)&&!Ct&&(xt.focusClassName||FOCUS_CLASS_NAMES[xt.focusRing]),($t==null?void 0:$t.active)&&!Ct&&xt.activeClassName)}function getOptionsClassNames({selector:xt,stylesCtx:$t,options:Ct,props:kt,theme:Mt}){return resolveClassNames({theme:Mt,classNames:Ct==null?void 0:Ct.classNames,props:(Ct==null?void 0:Ct.props)||kt,stylesCtx:$t})[xt]}function getResolvedClassNames({selector:xt,stylesCtx:$t,theme:Ct,classNames:kt,props:Mt}){return resolveClassNames({theme:Ct,classNames:kt,props:Mt,stylesCtx:$t})[xt]}function getRootClassName({rootSelector:xt,selector:$t,className:Ct}){return xt===$t?Ct:void 0}function getSelectorClassName({selector:xt,classes:$t,unstyled:Ct}){return Ct?void 0:$t[xt]}function getStaticClassNames({themeName:xt,classNamesPrefix:$t,selector:Ct,withStaticClass:kt}){return kt===!1?[]:xt.map(Mt=>`${$t}-${Mt}-${Ct}`)}function getThemeClassNames({themeName:xt,theme:$t,selector:Ct,props:kt,stylesCtx:Mt}){return xt.map(Ft=>{var jt,Bt;return(Bt=resolveClassNames({theme:$t,classNames:(jt=$t.components[Ft])==null?void 0:jt.classNames,props:kt,stylesCtx:Mt}))==null?void 0:Bt[Ct]})}function getVariantClassName({options:xt,classes:$t,selector:Ct,unstyled:kt}){return xt!=null&&xt.variant&&!kt?$t[`${Ct}--${xt.variant}`]:void 0}function getClassName({theme:xt,options:$t,themeName:Ct,selector:kt,classNamesPrefix:Mt,classNames:Ft,classes:jt,unstyled:Bt,className:Vt,rootSelector:zt,props:Ht,stylesCtx:Gt,withStaticClasses:qt,headless:Wt,transformedStyles:Yt}){return clsx(getGlobalClassNames({theme:xt,options:$t,unstyled:Bt||Wt}),getThemeClassNames({theme:xt,themeName:Ct,selector:kt,props:Ht,stylesCtx:Gt}),getVariantClassName({options:$t,classes:jt,selector:kt,unstyled:Bt}),getResolvedClassNames({selector:kt,stylesCtx:Gt,theme:xt,classNames:Ft,props:Ht}),getResolvedClassNames({selector:kt,stylesCtx:Gt,theme:xt,classNames:Yt,props:Ht}),getOptionsClassNames({selector:kt,stylesCtx:Gt,options:$t,props:Ht,theme:xt}),getRootClassName({rootSelector:zt,selector:kt,className:Vt}),getSelectorClassName({selector:kt,classes:jt,unstyled:Bt||Wt}),qt&&!Wt&&getStaticClassNames({themeName:Ct,classNamesPrefix:Mt,selector:kt,withStaticClass:$t==null?void 0:$t.withStaticClass}),$t==null?void 0:$t.className)}function getThemeStyles({theme:xt,themeName:$t,props:Ct,stylesCtx:kt,selector:Mt}){return $t.map(Ft=>{var jt;return resolveStyles({theme:xt,styles:(jt=xt.components[Ft])==null?void 0:jt.styles,props:Ct,stylesCtx:kt})[Mt]}).reduce((Ft,jt)=>({...Ft,...jt}),{})}function resolveStyle({style:xt,theme:$t}){return Array.isArray(xt)?[...xt].reduce((Ct,kt)=>({...Ct,...resolveStyle({style:kt,theme:$t})}),{}):typeof xt=="function"?xt($t):xt??{}}function mergeVars(xt){return xt.reduce(($t,Ct)=>(Ct&&Object.keys(Ct).forEach(kt=>{$t[kt]={...$t[kt],...filterProps(Ct[kt])}}),$t),{})}function resolveVars({vars:xt,varsResolver:$t,theme:Ct,props:kt,stylesCtx:Mt,selector:Ft,themeName:jt,headless:Bt}){var Vt;return(Vt=mergeVars([Bt?{}:$t==null?void 0:$t(Ct,kt,Mt),...jt.map(zt=>{var Ht,Gt,qt;return(qt=(Gt=(Ht=Ct.components)==null?void 0:Ht[zt])==null?void 0:Gt.vars)==null?void 0:qt.call(Gt,Ct,kt,Mt)}),xt==null?void 0:xt(Ct,kt,Mt)]))==null?void 0:Vt[Ft]}function getStyle$1({theme:xt,themeName:$t,selector:Ct,options:kt,props:Mt,stylesCtx:Ft,rootSelector:jt,styles:Bt,style:Vt,vars:zt,varsResolver:Ht,headless:Gt,withStylesTransform:qt}){return{...!qt&&getThemeStyles({theme:xt,themeName:$t,props:Mt,stylesCtx:Ft,selector:Ct}),...!qt&&resolveStyles({theme:xt,styles:Bt,props:Mt,stylesCtx:Ft})[Ct],...!qt&&resolveStyles({theme:xt,styles:kt==null?void 0:kt.styles,props:(kt==null?void 0:kt.props)||Mt,stylesCtx:Ft})[Ct],...resolveVars({theme:xt,props:Mt,stylesCtx:Ft,vars:zt,varsResolver:Ht,selector:Ct,themeName:$t,headless:Gt}),...jt===Ct?resolveStyle({style:Vt,theme:xt}):null,...resolveStyle({style:kt==null?void 0:kt.style,theme:xt})}}function useStylesTransform({props:xt,stylesCtx:$t,themeName:Ct}){var jt;const kt=useMantineTheme(),Mt=(jt=useMantineStylesTransform())==null?void 0:jt();return{getTransformedStyles:Bt=>Mt?[...Bt.map(zt=>Mt(zt,{props:xt,theme:kt,ctx:$t})),...Ct.map(zt=>{var Ht;return Mt((Ht=kt.components[zt])==null?void 0:Ht.styles,{props:xt,theme:kt,ctx:$t})})].filter(Boolean):[],withStylesTransform:!!Mt}}function useStyles({name:xt,classes:$t,props:Ct,stylesCtx:kt,className:Mt,style:Ft,rootSelector:jt="root",unstyled:Bt,classNames:Vt,styles:zt,vars:Ht,varsResolver:Gt}){const qt=useMantineTheme(),Wt=useMantineClassNamesPrefix(),Yt=useMantineWithStaticClasses(),Kt=useMantineIsHeadless(),Xt=(Array.isArray(xt)?xt:[xt]).filter(Zt=>Zt),{withStylesTransform:Qt,getTransformedStyles:Jt}=useStylesTransform({props:Ct,stylesCtx:kt,themeName:Xt});return(Zt,sn)=>({className:getClassName({theme:qt,options:sn,themeName:Xt,selector:Zt,classNamesPrefix:Wt,classNames:Vt,classes:$t,unstyled:Bt,className:Mt,rootSelector:jt,props:Ct,stylesCtx:kt,withStaticClasses:Yt,headless:Kt,transformedStyles:Jt([sn==null?void 0:sn.styles,zt])}),style:getStyle$1({theme:qt,themeName:Xt,selector:Zt,options:sn,props:Ct,stylesCtx:kt,rootSelector:jt,styles:zt,style:Ft,vars:Ht,varsResolver:Gt,headless:Kt,withStylesTransform:Qt})})}function getAutoContrastValue(xt,$t){return typeof xt=="boolean"?xt:$t.autoContrast}function useProps(xt,$t,Ct){var jt;const kt=useMantineTheme(),Mt=(jt=kt.components[xt])==null?void 0:jt.defaultProps,Ft=typeof Mt=="function"?Mt(kt):Mt;return{...$t,...Ft,...filterProps(Ct)}}function cssObjectToString(xt){return keys$4(xt).reduce(($t,Ct)=>xt[Ct]!==void 0?`${$t}${camelToKebabCase(Ct)}:${xt[Ct]};`:$t,"").trim()}function stylesToString({selector:xt,styles:$t,media:Ct,container:kt}){const Mt=$t?cssObjectToString($t):"",Ft=Array.isArray(Ct)?Ct.map(Bt=>`@media${Bt.query}{${xt}{${cssObjectToString(Bt.styles)}}}`):[],jt=Array.isArray(kt)?kt.map(Bt=>`@container ${Bt.query}{${xt}{${cssObjectToString(Bt.styles)}}}`):[];return`${Mt?`${xt}{${Mt}}`:""}${Ft.join("")}${jt.join("")}`.trim()}function InlineStyles(xt){const $t=useMantineStyleNonce();return jsxRuntimeExports.jsx("style",{"data-mantine-styles":"inline",nonce:$t==null?void 0:$t(),dangerouslySetInnerHTML:{__html:stylesToString(xt)}})}function extractStyleProps(xt){const{m:$t,mx:Ct,my:kt,mt:Mt,mb:Ft,ml:jt,mr:Bt,me:Vt,ms:zt,p:Ht,px:Gt,py:qt,pt:Wt,pb:Yt,pl:Kt,pr:Xt,pe:Qt,ps:Jt,bd:Zt,bg:sn,c:ln,opacity:dn,ff:hn,fz:cn,fw:pn,lts:yn,ta:gn,lh:En,fs:bn,tt:xn,td:Cn,w:$n,miw:wn,maw:Rn,h:Dn,mih:An,mah:Sn,bgsz:vn,bgp:_n,bgr:Tn,bga:Pn,pos:Ln,top:Vn,left:Un,bottom:Wn,right:rr,inset:ar,display:nr,flex:mr,hiddenFrom:kn,visibleFrom:Fn,lightHidden:Hn,darkHidden:Bn,sx:jn,...sr}=xt;return{styleProps:filterProps({m:$t,mx:Ct,my:kt,mt:Mt,mb:Ft,ml:jt,mr:Bt,me:Vt,ms:zt,p:Ht,px:Gt,py:qt,pt:Wt,pb:Yt,pl:Kt,pr:Xt,pe:Qt,ps:Jt,bd:Zt,bg:sn,c:ln,opacity:dn,ff:hn,fz:cn,fw:pn,lts:yn,ta:gn,lh:En,fs:bn,tt:xn,td:Cn,w:$n,miw:wn,maw:Rn,h:Dn,mih:An,mah:Sn,bgsz:vn,bgp:_n,bgr:Tn,bga:Pn,pos:Ln,top:Vn,left:Un,bottom:Wn,right:rr,inset:ar,display:nr,flex:mr,hiddenFrom:kn,visibleFrom:Fn,lightHidden:Hn,darkHidden:Bn,sx:jn}),rest:sr}}const STYlE_PROPS_DATA={m:{type:"spacing",property:"margin"},mt:{type:"spacing",property:"marginTop"},mb:{type:"spacing",property:"marginBottom"},ml:{type:"spacing",property:"marginLeft"},mr:{type:"spacing",property:"marginRight"},ms:{type:"spacing",property:"marginInlineStart"},me:{type:"spacing",property:"marginInlineEnd"},mx:{type:"spacing",property:"marginInline"},my:{type:"spacing",property:"marginBlock"},p:{type:"spacing",property:"padding"},pt:{type:"spacing",property:"paddingTop"},pb:{type:"spacing",property:"paddingBottom"},pl:{type:"spacing",property:"paddingLeft"},pr:{type:"spacing",property:"paddingRight"},ps:{type:"spacing",property:"paddingInlineStart"},pe:{type:"spacing",property:"paddingInlineEnd"},px:{type:"spacing",property:"paddingInline"},py:{type:"spacing",property:"paddingBlock"},bd:{type:"border",property:"border"},bg:{type:"color",property:"background"},c:{type:"textColor",property:"color"},opacity:{type:"identity",property:"opacity"},ff:{type:"fontFamily",property:"fontFamily"},fz:{type:"fontSize",property:"fontSize"},fw:{type:"identity",property:"fontWeight"},lts:{type:"size",property:"letterSpacing"},ta:{type:"identity",property:"textAlign"},lh:{type:"lineHeight",property:"lineHeight"},fs:{type:"identity",property:"fontStyle"},tt:{type:"identity",property:"textTransform"},td:{type:"identity",property:"textDecoration"},w:{type:"spacing",property:"width"},miw:{type:"spacing",property:"minWidth"},maw:{type:"spacing",property:"maxWidth"},h:{type:"spacing",property:"height"},mih:{type:"spacing",property:"minHeight"},mah:{type:"spacing",property:"maxHeight"},bgsz:{type:"size",property:"backgroundSize"},bgp:{type:"identity",property:"backgroundPosition"},bgr:{type:"identity",property:"backgroundRepeat"},bga:{type:"identity",property:"backgroundAttachment"},pos:{type:"identity",property:"position"},top:{type:"identity",property:"top"},left:{type:"size",property:"left"},bottom:{type:"size",property:"bottom"},right:{type:"size",property:"right"},inset:{type:"size",property:"inset"},display:{type:"identity",property:"display"},flex:{type:"identity",property:"flex"}};function colorResolver(xt,$t){const Ct=parseThemeColor({color:xt,theme:$t});return Ct.color==="dimmed"?"var(--mantine-color-dimmed)":Ct.color==="bright"?"var(--mantine-color-bright)":Ct.variable?`var(${Ct.variable})`:Ct.color}function textColorResolver(xt,$t){const Ct=parseThemeColor({color:xt,theme:$t});return Ct.isThemeColor&&Ct.shade===void 0?`var(--mantine-color-${Ct.color}-text)`:colorResolver(xt,$t)}function borderResolver(xt,$t){if(typeof xt=="number")return rem$1(xt);if(typeof xt=="string"){const[Ct,kt,...Mt]=xt.split(" ").filter(jt=>jt.trim()!=="");let Ft=`${rem$1(Ct)}`;return kt&&(Ft+=` ${kt}`),colorsTuple.length>0&&(Ft+=` ${colorResolver(Mt.join(" "),$t)}`),Ft.trim()}return xt}const values$4={text:"var(--mantine-font-family)",mono:"var(--mantine-font-family-monospace)",monospace:"var(--mantine-font-family-monospace)",heading:"var(--mantine-font-family-headings)",headings:"var(--mantine-font-family-headings)"};function fontFamilyResolver(xt){return typeof xt=="string"&&xt in values$4?values$4[xt]:xt}const headings$2=["h1","h2","h3","h4","h5","h6"];function fontSizeResolver(xt,$t){return typeof xt=="string"&&xt in $t.fontSizes?`var(--mantine-font-size-${xt})`:typeof xt=="string"&&headings$2.includes(xt)?`var(--mantine-${xt}-font-size)`:typeof xt=="number"||typeof xt=="string"?rem$1(xt):xt}function identityResolver(xt){return xt}const headings$1=["h1","h2","h3","h4","h5","h6"];function lineHeightResolver(xt,$t){return typeof xt=="string"&&xt in $t.lineHeights?`var(--mantine-line-height-${xt})`:typeof xt=="string"&&headings$1.includes(xt)?`var(--mantine-${xt}-line-height)`:xt}function sizeResolver(xt){return typeof xt=="number"?rem$1(xt):xt}function spacingResolver(xt,$t){if(typeof xt=="number")return rem$1(xt);if(typeof xt=="string"){const Ct=xt.replace("-","");if(!(Ct in $t.spacing))return rem$1(xt);const kt=`--mantine-spacing-${Ct}`;return xt.startsWith("-")?`calc(var(${kt}) * -1)`:`var(${kt})`}return xt}const resolvers={color:colorResolver,textColor:textColorResolver,fontSize:fontSizeResolver,spacing:spacingResolver,identity:identityResolver,size:sizeResolver,lineHeight:lineHeightResolver,fontFamily:fontFamilyResolver,border:borderResolver};function replaceMediaQuery(xt){return xt.replace("(min-width: ","").replace("em)","")}function sortMediaQueries({media:xt,...$t}){const kt=Object.keys(xt).sort((Mt,Ft)=>Number(replaceMediaQuery(Mt))-Number(replaceMediaQuery(Ft))).map(Mt=>({query:Mt,styles:xt[Mt]}));return{...$t,media:kt}}function hasResponsiveStyles(xt){if(typeof xt!="object"||xt===null)return!1;const $t=Object.keys(xt);return!($t.length===1&&$t[0]==="base")}function getBaseValue(xt){return typeof xt=="object"&&xt!==null?"base"in xt?xt.base:void 0:xt}function getBreakpointKeys(xt){return typeof xt=="object"&&xt!==null?keys$4(xt).filter($t=>$t!=="base"):[]}function getBreakpointValue(xt,$t){return typeof xt=="object"&&xt!==null&&$t in xt?xt[$t]:xt}function parseStyleProps({styleProps:xt,data:$t,theme:Ct}){return sortMediaQueries(keys$4(xt).reduce((kt,Mt)=>{if(Mt==="hiddenFrom"||Mt==="visibleFrom"||Mt==="sx")return kt;const Ft=$t[Mt],jt=Array.isArray(Ft.property)?Ft.property:[Ft.property],Bt=getBaseValue(xt[Mt]);if(!hasResponsiveStyles(xt[Mt]))return jt.forEach(zt=>{kt.inlineStyles[zt]=resolvers[Ft.type](Bt,Ct)}),kt;kt.hasResponsiveStyles=!0;const Vt=getBreakpointKeys(xt[Mt]);return jt.forEach(zt=>{Bt&&(kt.styles[zt]=resolvers[Ft.type](Bt,Ct)),Vt.forEach(Ht=>{const Gt=`(min-width: ${Ct.breakpoints[Ht]})`;kt.media[Gt]={...kt.media[Gt],[zt]:resolvers[Ft.type](getBreakpointValue(xt[Mt],Ht),Ct)}})}),kt},{hasResponsiveStyles:!1,styles:{},inlineStyles:{},media:{}}))}function useRandomClassName(){return`__m__-${reactExports.useId().replace(/:/g,"")}`}function getStyleObject(xt,$t){return Array.isArray(xt)?[...xt].reduce((Ct,kt)=>({...Ct,...getStyleObject(kt,$t)}),{}):typeof xt=="function"?xt($t):xt??{}}function createPolymorphicComponent(xt){return xt}function transformModKey(xt){return xt.startsWith("data-")?xt:`data-${xt}`}function getMod(xt){return Object.keys(xt).reduce(($t,Ct)=>{const kt=xt[Ct];return kt===void 0||kt===""||kt===!1||kt===null||($t[transformModKey(Ct)]=xt[Ct]),$t},{})}function getBoxMod(xt){return xt?typeof xt=="string"?{[transformModKey(xt)]:!0}:Array.isArray(xt)?[...xt].reduce(($t,Ct)=>({...$t,...getBoxMod(Ct)}),{}):getMod(xt):null}function mergeStyles(xt,$t){return Array.isArray(xt)?[...xt].reduce((Ct,kt)=>({...Ct,...mergeStyles(kt,$t)}),{}):typeof xt=="function"?xt($t):xt??{}}function getBoxStyle({theme:xt,style:$t,vars:Ct,styleProps:kt}){const Mt=mergeStyles($t,xt),Ft=mergeStyles(Ct,xt);return{...Mt,...Ft,...kt}}const _Box=reactExports.forwardRef(({component:xt,style:$t,__vars:Ct,className:kt,variant:Mt,mod:Ft,size:jt,hiddenFrom:Bt,visibleFrom:Vt,lightHidden:zt,darkHidden:Ht,renderRoot:Gt,__size:qt,...Wt},Yt)=>{var cn;const Kt=useMantineTheme(),Xt=xt||"div",{styleProps:Qt,rest:Jt}=extractStyleProps(Wt),Zt=useMantineSxTransform(),sn=(cn=Zt==null?void 0:Zt())==null?void 0:cn(Qt.sx),ln=useRandomClassName(),dn=parseStyleProps({styleProps:Qt,theme:Kt,data:STYlE_PROPS_DATA}),hn={ref:Yt,style:getBoxStyle({theme:Kt,style:$t,vars:Ct,styleProps:dn.inlineStyles}),className:clsx(kt,sn,{[ln]:dn.hasResponsiveStyles,"mantine-light-hidden":zt,"mantine-dark-hidden":Ht,[`mantine-hidden-from-${Bt}`]:Bt,[`mantine-visible-from-${Vt}`]:Vt}),"data-variant":Mt,"data-size":isNumberLike(jt)?void 0:jt||void 0,size:qt,...getBoxMod(Ft),...Jt};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[dn.hasResponsiveStyles&&jsxRuntimeExports.jsx(InlineStyles,{selector:`.${ln}`,styles:dn.styles,media:dn.media}),typeof Gt=="function"?Gt(hn):jsxRuntimeExports.jsx(Xt,{...hn})]})});_Box.displayName="@mantine/core/Box";const Box=_Box;function identity$8(xt){return xt}function factory$2(xt){const $t=reactExports.forwardRef(xt);return $t.extend=identity$8,$t}function polymorphicFactory(xt){const $t=reactExports.forwardRef(xt);return $t.extend=identity$8,$t}const DirectionContext=reactExports.createContext({dir:"ltr",toggleDirection:()=>{},setDirection:()=>{}});function useDirection(){return reactExports.useContext(DirectionContext)}function getAutoHeightDuration(xt){if(!xt||typeof xt=="string")return 0;const $t=xt/36;return Math.round((4+15*$t**.25+$t/5)*10)}function getElementHeight(xt){return xt!=null&&xt.current?xt.current.scrollHeight:"auto"}const raf=typeof window<"u"&&window.requestAnimationFrame;function useCollapse({transitionDuration:xt,transitionTimingFunction:$t="ease",onTransitionEnd:Ct=()=>{},opened:kt}){const Mt=reactExports.useRef(null),Ft=0,jt={display:"none",height:0,overflow:"hidden"},[Bt,Vt]=reactExports.useState(kt?{}:jt),zt=Yt=>{reactDomExports.flushSync(()=>Vt(Yt))},Ht=Yt=>{zt(Kt=>({...Kt,...Yt}))};function Gt(Yt){const Kt=xt||getAutoHeightDuration(Yt);return{transition:`height ${Kt}ms ${$t}, opacity ${Kt}ms ${$t}`}}useDidUpdate(()=>{typeof raf=="function"&&raf(kt?()=>{Ht({willChange:"height",display:"block",overflow:"hidden"}),raf(()=>{const Yt=getElementHeight(Mt);Ht({...Gt(Yt),height:Yt})})}:()=>{const Yt=getElementHeight(Mt);Ht({...Gt(Yt),willChange:"height",height:Yt}),raf(()=>Ht({height:Ft,overflow:"hidden"}))})},[kt]);const qt=Yt=>{if(!(Yt.target!==Mt.current||Yt.propertyName!=="height"))if(kt){const Kt=getElementHeight(Mt);Kt===Bt.height?zt({}):Ht({height:Kt}),Ct()}else Bt.height===Ft&&(zt(jt),Ct())};function Wt({style:Yt={},refKey:Kt="ref",...Xt}={}){const Qt=Xt[Kt];return{"aria-hidden":!kt,...Xt,[Kt]:mergeRefs(Mt,Qt),onTransitionEnd:qt,style:{boxSizing:"border-box",...Yt,...Bt}}}return Wt}const defaultProps$2i={transitionDuration:200,transitionTimingFunction:"ease",animateOpacity:!0},Collapse=factory$2((xt,$t)=>{const{children:Ct,in:kt,transitionDuration:Mt,transitionTimingFunction:Ft,style:jt,onTransitionEnd:Bt,animateOpacity:Vt,...zt}=useProps("Collapse",defaultProps$2i,xt),Ht=useMantineTheme(),Gt=useReducedMotion(),Wt=(Ht.respectReducedMotion?Gt:!1)?0:Mt,Yt=useCollapse({opened:kt,transitionDuration:Wt,transitionTimingFunction:Ft,onTransitionEnd:Bt});return Wt===0?kt?jsxRuntimeExports.jsx(Box,{...zt,children:Ct}):null:jsxRuntimeExports.jsx(Box,{...Yt({style:{opacity:kt||!Vt?1:0,transition:Vt?`opacity ${Wt}ms ${Ft}`:"none",...getStyleObject(jt,Ht)},ref:$t,...zt}),children:Ct})});Collapse.displayName="@mantine/core/Collapse";const[ScrollAreaProvider,useScrollAreaContext]=createSafeContext("ScrollArea.Root component was not found in tree");function useResizeObserver(xt,$t){const Ct=useCallbackRef($t);useIsomorphicEffect$1(()=>{let kt=0;if(xt){const Mt=new ResizeObserver(()=>{cancelAnimationFrame(kt),kt=window.requestAnimationFrame(Ct)});return Mt.observe(xt),()=>{window.cancelAnimationFrame(kt),Mt.unobserve(xt)}}},[xt,Ct])}const Corner=reactExports.forwardRef((xt,$t)=>{const{style:Ct,...kt}=xt,Mt=useScrollAreaContext(),[Ft,jt]=reactExports.useState(0),[Bt,Vt]=reactExports.useState(0),zt=!!(Ft&&Bt);return useResizeObserver(Mt.scrollbarX,()=>{var Gt;const Ht=((Gt=Mt.scrollbarX)==null?void 0:Gt.offsetHeight)||0;Mt.onCornerHeightChange(Ht),Vt(Ht)}),useResizeObserver(Mt.scrollbarY,()=>{var Gt;const Ht=((Gt=Mt.scrollbarY)==null?void 0:Gt.offsetWidth)||0;Mt.onCornerWidthChange(Ht),jt(Ht)}),zt?jsxRuntimeExports.jsx("div",{...kt,ref:$t,style:{...Ct,width:Ft,height:Bt}}):null}),ScrollAreaCorner=reactExports.forwardRef((xt,$t)=>{const Ct=useScrollAreaContext(),kt=!!(Ct.scrollbarX&&Ct.scrollbarY);return Ct.type!=="scroll"&&kt?jsxRuntimeExports.jsx(Corner,{...xt,ref:$t}):null}),defaultProps$2h={scrollHideDelay:1e3,type:"hover"},ScrollAreaRoot=reactExports.forwardRef((xt,$t)=>{const Ct=useProps("ScrollAreaRoot",defaultProps$2h,xt),{type:kt,scrollHideDelay:Mt,scrollbars:Ft,...jt}=Ct,[Bt,Vt]=reactExports.useState(null),[zt,Ht]=reactExports.useState(null),[Gt,qt]=reactExports.useState(null),[Wt,Yt]=reactExports.useState(null),[Kt,Xt]=reactExports.useState(null),[Qt,Jt]=reactExports.useState(0),[Zt,sn]=reactExports.useState(0),[ln,dn]=reactExports.useState(!1),[hn,cn]=reactExports.useState(!1),pn=useMergedRef($t,yn=>Vt(yn));return jsxRuntimeExports.jsx(ScrollAreaProvider,{value:{type:kt,scrollHideDelay:Mt,scrollArea:Bt,viewport:zt,onViewportChange:Ht,content:Gt,onContentChange:qt,scrollbarX:Wt,onScrollbarXChange:Yt,scrollbarXEnabled:ln,onScrollbarXEnabledChange:dn,scrollbarY:Kt,onScrollbarYChange:Xt,scrollbarYEnabled:hn,onScrollbarYEnabledChange:cn,onCornerWidthChange:Jt,onCornerHeightChange:sn},children:jsxRuntimeExports.jsx(Box,{...jt,ref:pn,__vars:{"--sa-corner-width":Ft!=="xy"?"0px":`${Qt}px`,"--sa-corner-height":Ft!=="xy"?"0px":`${Zt}px`}})})});ScrollAreaRoot.displayName="@mantine/core/ScrollAreaRoot";function getThumbRatio(xt,$t){const Ct=xt/$t;return Number.isNaN(Ct)?0:Ct}function getThumbSize(xt){const $t=getThumbRatio(xt.viewport,xt.content),Ct=xt.scrollbar.paddingStart+xt.scrollbar.paddingEnd,kt=(xt.scrollbar.size-Ct)*$t;return Math.max(kt,18)}function linearScale(xt,$t){return Ct=>{if(xt[0]===xt[1]||$t[0]===$t[1])return $t[0];const kt=($t[1]-$t[0])/(xt[1]-xt[0]);return $t[0]+kt*(Ct-xt[0])}}function clamp$3(xt,[$t,Ct]){return Math.min(Ct,Math.max($t,xt))}function getThumbOffsetFromScroll(xt,$t,Ct="ltr"){const kt=getThumbSize($t),Mt=$t.scrollbar.paddingStart+$t.scrollbar.paddingEnd,Ft=$t.scrollbar.size-Mt,jt=$t.content-$t.viewport,Bt=Ft-kt,Vt=Ct==="ltr"?[0,jt]:[jt*-1,0],zt=clamp$3(xt,Vt);return linearScale([0,jt],[0,Bt])(zt)}function getScrollPositionFromPointer(xt,$t,Ct,kt="ltr"){const Mt=getThumbSize(Ct),Ft=Mt/2,jt=$t||Ft,Bt=Mt-jt,Vt=Ct.scrollbar.paddingStart+jt,zt=Ct.scrollbar.size-Ct.scrollbar.paddingEnd-Bt,Ht=Ct.content-Ct.viewport,Gt=kt==="ltr"?[0,Ht]:[Ht*-1,0];return linearScale([Vt,zt],Gt)(xt)}function isScrollingWithinScrollbarBounds(xt,$t){return xt>0&&xt<$t}function toInt(xt){return xt?parseInt(xt,10):0}function composeEventHandlers(xt,$t,{checkForDefaultPrevented:Ct=!0}={}){return kt=>{xt==null||xt(kt),(Ct===!1||!kt.defaultPrevented)&&($t==null||$t(kt))}}const[ScrollbarProvider,useScrollbarContext]=createSafeContext("ScrollAreaScrollbar was not found in tree"),Scrollbar=reactExports.forwardRef((xt,$t)=>{const{sizes:Ct,hasThumb:kt,onThumbChange:Mt,onThumbPointerUp:Ft,onThumbPointerDown:jt,onThumbPositionChange:Bt,onDragScroll:Vt,onWheelScroll:zt,onResize:Ht,...Gt}=xt,qt=useScrollAreaContext(),[Wt,Yt]=reactExports.useState(null),Kt=useMergedRef($t,cn=>Yt(cn)),Xt=reactExports.useRef(null),Qt=reactExports.useRef(""),{viewport:Jt}=qt,Zt=Ct.content-Ct.viewport,sn=useCallbackRef(zt),ln=useCallbackRef(Bt),dn=useDebouncedCallback(Ht,10),hn=cn=>{if(Xt.current){const pn=cn.clientX-Xt.current.left,yn=cn.clientY-Xt.current.top;Vt({x:pn,y:yn})}};return reactExports.useEffect(()=>{const cn=pn=>{const yn=pn.target;(Wt==null?void 0:Wt.contains(yn))&&sn(pn,Zt)};return document.addEventListener("wheel",cn,{passive:!1}),()=>document.removeEventListener("wheel",cn,{passive:!1})},[Jt,Wt,Zt,sn]),reactExports.useEffect(ln,[Ct,ln]),useResizeObserver(Wt,dn),useResizeObserver(qt.content,dn),jsxRuntimeExports.jsx(ScrollbarProvider,{value:{scrollbar:Wt,hasThumb:kt,onThumbChange:useCallbackRef(Mt),onThumbPointerUp:useCallbackRef(Ft),onThumbPositionChange:ln,onThumbPointerDown:useCallbackRef(jt)},children:jsxRuntimeExports.jsx("div",{...Gt,ref:Kt,style:{position:"absolute",...Gt.style},onPointerDown:composeEventHandlers(xt.onPointerDown,cn=>{cn.button===0&&(cn.target.setPointerCapture(cn.pointerId),Xt.current=Wt.getBoundingClientRect(),Qt.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",hn(cn))}),onPointerMove:composeEventHandlers(xt.onPointerMove,hn),onPointerUp:composeEventHandlers(xt.onPointerUp,cn=>{const pn=cn.target;pn.hasPointerCapture(cn.pointerId)&&pn.releasePointerCapture(cn.pointerId),document.body.style.webkitUserSelect=Qt.current,Xt.current=null})})})}),ScrollAreaScrollbarX=reactExports.forwardRef((xt,$t)=>{const{sizes:Ct,onSizesChange:kt,style:Mt,...Ft}=xt,jt=useScrollAreaContext(),[Bt,Vt]=reactExports.useState(),zt=reactExports.useRef(null),Ht=useMergedRef($t,zt,jt.onScrollbarXChange);return reactExports.useEffect(()=>{zt.current&&Vt(getComputedStyle(zt.current))},[zt]),jsxRuntimeExports.jsx(Scrollbar,{"data-orientation":"horizontal",...Ft,ref:Ht,sizes:Ct,style:{...Mt,"--sa-thumb-width":`${getThumbSize(Ct)}px`},onThumbPointerDown:Gt=>xt.onThumbPointerDown(Gt.x),onDragScroll:Gt=>xt.onDragScroll(Gt.x),onWheelScroll:(Gt,qt)=>{if(jt.viewport){const Wt=jt.viewport.scrollLeft+Gt.deltaX;xt.onWheelScroll(Wt),isScrollingWithinScrollbarBounds(Wt,qt)&&Gt.preventDefault()}},onResize:()=>{zt.current&&jt.viewport&&Bt&&kt({content:jt.viewport.scrollWidth,viewport:jt.viewport.offsetWidth,scrollbar:{size:zt.current.clientWidth,paddingStart:toInt(Bt.paddingLeft),paddingEnd:toInt(Bt.paddingRight)}})}})}),ScrollAreaScrollbarY=reactExports.forwardRef((xt,$t)=>{const{sizes:Ct,onSizesChange:kt,style:Mt,...Ft}=xt,jt=useScrollAreaContext(),[Bt,Vt]=reactExports.useState(),zt=reactExports.useRef(null),Ht=useMergedRef($t,zt,jt.onScrollbarYChange);return reactExports.useEffect(()=>{zt.current&&Vt(window.getComputedStyle(zt.current))},[]),jsxRuntimeExports.jsx(Scrollbar,{...Ft,"data-orientation":"vertical",ref:Ht,sizes:Ct,style:{"--sa-thumb-height":`${getThumbSize(Ct)}px`,...Mt},onThumbPointerDown:Gt=>xt.onThumbPointerDown(Gt.y),onDragScroll:Gt=>xt.onDragScroll(Gt.y),onWheelScroll:(Gt,qt)=>{if(jt.viewport){const Wt=jt.viewport.scrollTop+Gt.deltaY;xt.onWheelScroll(Wt),isScrollingWithinScrollbarBounds(Wt,qt)&&Gt.preventDefault()}},onResize:()=>{zt.current&&jt.viewport&&Bt&&kt({content:jt.viewport.scrollHeight,viewport:jt.viewport.offsetHeight,scrollbar:{size:zt.current.clientHeight,paddingStart:toInt(Bt.paddingTop),paddingEnd:toInt(Bt.paddingBottom)}})}})}),ScrollAreaScrollbarVisible=reactExports.forwardRef((xt,$t)=>{const{orientation:Ct="vertical",...kt}=xt,{dir:Mt}=useDirection(),Ft=useScrollAreaContext(),jt=reactExports.useRef(null),Bt=reactExports.useRef(0),[Vt,zt]=reactExports.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),Ht=getThumbRatio(Vt.viewport,Vt.content),Gt={...kt,sizes:Vt,onSizesChange:zt,hasThumb:Ht>0&&Ht<1,onThumbChange:Wt=>{jt.current=Wt},onThumbPointerUp:()=>{Bt.current=0},onThumbPointerDown:Wt=>{Bt.current=Wt}},qt=(Wt,Yt)=>getScrollPositionFromPointer(Wt,Bt.current,Vt,Yt);return Ct==="horizontal"?jsxRuntimeExports.jsx(ScrollAreaScrollbarX,{...Gt,ref:$t,onThumbPositionChange:()=>{if(Ft.viewport&&jt.current){const Wt=Ft.viewport.scrollLeft,Yt=getThumbOffsetFromScroll(Wt,Vt,Mt);jt.current.style.transform=`translate3d(${Yt}px, 0, 0)`}},onWheelScroll:Wt=>{Ft.viewport&&(Ft.viewport.scrollLeft=Wt)},onDragScroll:Wt=>{Ft.viewport&&(Ft.viewport.scrollLeft=qt(Wt,Mt))}}):Ct==="vertical"?jsxRuntimeExports.jsx(ScrollAreaScrollbarY,{...Gt,ref:$t,onThumbPositionChange:()=>{if(Ft.viewport&&jt.current){const Wt=Ft.viewport.scrollTop,Yt=getThumbOffsetFromScroll(Wt,Vt);Vt.scrollbar.size===0?jt.current.style.opacity="0":jt.current.style.opacity="1",jt.current.style.transform=`translate3d(0, ${Yt}px, 0)`}},onWheelScroll:Wt=>{Ft.viewport&&(Ft.viewport.scrollTop=Wt)},onDragScroll:Wt=>{Ft.viewport&&(Ft.viewport.scrollTop=qt(Wt))}}):null}),ScrollAreaScrollbarAuto=reactExports.forwardRef((xt,$t)=>{const Ct=useScrollAreaContext(),{forceMount:kt,...Mt}=xt,[Ft,jt]=reactExports.useState(!1),Bt=xt.orientation==="horizontal",Vt=useDebouncedCallback(()=>{if(Ct.viewport){const zt=Ct.viewport.offsetWidth<Ct.viewport.scrollWidth,Ht=Ct.viewport.offsetHeight<Ct.viewport.scrollHeight;jt(Bt?zt:Ht)}},10);return useResizeObserver(Ct.viewport,Vt),useResizeObserver(Ct.content,Vt),kt||Ft?jsxRuntimeExports.jsx(ScrollAreaScrollbarVisible,{"data-state":Ft?"visible":"hidden",...Mt,ref:$t}):null}),ScrollAreaScrollbarHover=reactExports.forwardRef((xt,$t)=>{const{forceMount:Ct,...kt}=xt,Mt=useScrollAreaContext(),[Ft,jt]=reactExports.useState(!1);return reactExports.useEffect(()=>{const{scrollArea:Bt}=Mt;let Vt=0;if(Bt){const zt=()=>{window.clearTimeout(Vt),jt(!0)},Ht=()=>{Vt=window.setTimeout(()=>jt(!1),Mt.scrollHideDelay)};return Bt.addEventListener("pointerenter",zt),Bt.addEventListener("pointerleave",Ht),()=>{window.clearTimeout(Vt),Bt.removeEventListener("pointerenter",zt),Bt.removeEventListener("pointerleave",Ht)}}},[Mt.scrollArea,Mt.scrollHideDelay]),Ct||Ft?jsxRuntimeExports.jsx(ScrollAreaScrollbarAuto,{"data-state":Ft?"visible":"hidden",...kt,ref:$t}):null}),ScrollAreaScrollbarScroll=reactExports.forwardRef((xt,$t)=>{const{forceMount:Ct,...kt}=xt,Mt=useScrollAreaContext(),Ft=xt.orientation==="horizontal",[jt,Bt]=reactExports.useState("hidden"),Vt=useDebouncedCallback(()=>Bt("idle"),100);return reactExports.useEffect(()=>{if(jt==="idle"){const zt=window.setTimeout(()=>Bt("hidden"),Mt.scrollHideDelay);return()=>window.clearTimeout(zt)}},[jt,Mt.scrollHideDelay]),reactExports.useEffect(()=>{const{viewport:zt}=Mt,Ht=Ft?"scrollLeft":"scrollTop";if(zt){let Gt=zt[Ht];const qt=()=>{const Wt=zt[Ht];Gt!==Wt&&(Bt("scrolling"),Vt()),Gt=Wt};return zt.addEventListener("scroll",qt),()=>zt.removeEventListener("scroll",qt)}},[Mt.viewport,Ft,Vt]),Ct||jt!=="hidden"?jsxRuntimeExports.jsx(ScrollAreaScrollbarVisible,{"data-state":jt==="hidden"?"hidden":"visible",...kt,ref:$t,onPointerEnter:composeEventHandlers(xt.onPointerEnter,()=>Bt("interacting")),onPointerLeave:composeEventHandlers(xt.onPointerLeave,()=>Bt("idle"))}):null}),ScrollAreaScrollbar=reactExports.forwardRef((xt,$t)=>{const{forceMount:Ct,...kt}=xt,Mt=useScrollAreaContext(),{onScrollbarXEnabledChange:Ft,onScrollbarYEnabledChange:jt}=Mt,Bt=xt.orientation==="horizontal";return reactExports.useEffect(()=>(Bt?Ft(!0):jt(!0),()=>{Bt?Ft(!1):jt(!1)}),[Bt,Ft,jt]),Mt.type==="hover"?jsxRuntimeExports.jsx(ScrollAreaScrollbarHover,{...kt,ref:$t,forceMount:Ct}):Mt.type==="scroll"?jsxRuntimeExports.jsx(ScrollAreaScrollbarScroll,{...kt,ref:$t,forceMount:Ct}):Mt.type==="auto"?jsxRuntimeExports.jsx(ScrollAreaScrollbarAuto,{...kt,ref:$t,forceMount:Ct}):Mt.type==="always"?jsxRuntimeExports.jsx(ScrollAreaScrollbarVisible,{...kt,ref:$t}):null});function addUnlinkedScrollListener(xt,$t=()=>{}){let Ct={left:xt.scrollLeft,top:xt.scrollTop},kt=0;return function Mt(){const Ft={left:xt.scrollLeft,top:xt.scrollTop},jt=Ct.left!==Ft.left,Bt=Ct.top!==Ft.top;(jt||Bt)&&$t(),Ct=Ft,kt=window.requestAnimationFrame(Mt)}(),()=>window.cancelAnimationFrame(kt)}const Thumb$1=reactExports.forwardRef((xt,$t)=>{const{style:Ct,...kt}=xt,Mt=useScrollAreaContext(),Ft=useScrollbarContext(),{onThumbPositionChange:jt}=Ft,Bt=useMergedRef($t,Ht=>Ft.onThumbChange(Ht)),Vt=reactExports.useRef(),zt=useDebouncedCallback(()=>{Vt.current&&(Vt.current(),Vt.current=void 0)},100);return reactExports.useEffect(()=>{const{viewport:Ht}=Mt;if(Ht){const Gt=()=>{if(zt(),!Vt.current){const qt=addUnlinkedScrollListener(Ht,jt);Vt.current=qt,jt()}};return jt(),Ht.addEventListener("scroll",Gt),()=>Ht.removeEventListener("scroll",Gt)}},[Mt.viewport,zt,jt]),jsxRuntimeExports.jsx("div",{"data-state":Ft.hasThumb?"visible":"hidden",...kt,ref:Bt,style:{width:"var(--sa-thumb-width)",height:"var(--sa-thumb-height)",...Ct},onPointerDownCapture:composeEventHandlers(xt.onPointerDownCapture,Ht=>{const qt=Ht.target.getBoundingClientRect(),Wt=Ht.clientX-qt.left,Yt=Ht.clientY-qt.top;Ft.onThumbPointerDown({x:Wt,y:Yt})}),onPointerUp:composeEventHandlers(xt.onPointerUp,Ft.onThumbPointerUp)})}),ScrollAreaThumb=reactExports.forwardRef((xt,$t)=>{const{forceMount:Ct,...kt}=xt,Mt=useScrollbarContext();return Ct||Mt.hasThumb?jsxRuntimeExports.jsx(Thumb$1,{ref:$t,...kt}):null}),ScrollAreaViewport=reactExports.forwardRef(({children:xt,style:$t,...Ct},kt)=>{const Mt=useScrollAreaContext(),Ft=useMergedRef(kt,Mt.onViewportChange);return jsxRuntimeExports.jsx(Box,{...Ct,ref:Ft,style:{overflowX:Mt.scrollbarXEnabled?"scroll":"hidden",overflowY:Mt.scrollbarYEnabled?"scroll":"hidden",...$t},children:jsxRuntimeExports.jsx("div",{style:{minWidth:"100%",display:"table"},ref:Mt.onContentChange,children:xt})})});ScrollAreaViewport.displayName="@mantine/core/ScrollAreaViewport";var classes$$={root:"m_d57069b5",viewport:"m_c0783ff9",viewportInner:"m_f8f631dd",scrollbar:"m_c44ba933",thumb:"m_d8b5e363",corner:"m_21657268"};const defaultProps$2g={scrollHideDelay:1e3,type:"hover",scrollbars:"xy"},varsResolver$Y=(xt,{scrollbarSize:$t})=>({root:{"--scrollarea-scrollbar-size":rem$1($t)}}),ScrollArea=factory$2((xt,$t)=>{const Ct=useProps("ScrollArea",defaultProps$2g,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,scrollbarSize:Vt,vars:zt,type:Ht,scrollHideDelay:Gt,viewportProps:qt,viewportRef:Wt,onScrollPositionChange:Yt,children:Kt,offsetScrollbars:Xt,scrollbars:Qt,...Jt}=Ct,[Zt,sn]=reactExports.useState(!1),ln=useStyles({name:"ScrollArea",props:Ct,classes:classes$$,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:zt,varsResolver:varsResolver$Y});return jsxRuntimeExports.jsxs(ScrollAreaRoot,{type:Ht==="never"?"always":Ht,scrollHideDelay:Gt,ref:$t,scrollbars:Qt,...ln("root"),...Jt,children:[jsxRuntimeExports.jsx(ScrollAreaViewport,{...qt,...ln("viewport",{style:qt==null?void 0:qt.style}),ref:Wt,"data-offset-scrollbars":Xt===!0?"xy":Xt||void 0,"data-scrollbars":Qt||void 0,onScroll:dn=>{var hn;(hn=qt==null?void 0:qt.onScroll)==null||hn.call(qt,dn),Yt==null||Yt({x:dn.currentTarget.scrollLeft,y:dn.currentTarget.scrollTop})},children:Kt}),(Qt==="xy"||Qt==="x")&&jsxRuntimeExports.jsx(ScrollAreaScrollbar,{...ln("scrollbar"),orientation:"horizontal","data-hidden":Ht==="never"||void 0,forceMount:!0,onMouseEnter:()=>sn(!0),onMouseLeave:()=>sn(!1),children:jsxRuntimeExports.jsx(ScrollAreaThumb,{...ln("thumb")})}),(Qt==="xy"||Qt==="y")&&jsxRuntimeExports.jsx(ScrollAreaScrollbar,{...ln("scrollbar"),orientation:"vertical","data-hidden":Ht==="never"||void 0,forceMount:!0,onMouseEnter:()=>sn(!0),onMouseLeave:()=>sn(!1),children:jsxRuntimeExports.jsx(ScrollAreaThumb,{...ln("thumb")})}),jsxRuntimeExports.jsx(ScrollAreaCorner,{...ln("corner"),"data-hovered":Zt||void 0,"data-hidden":Ht==="never"||void 0})]})});ScrollArea.displayName="@mantine/core/ScrollArea";const ScrollAreaAutosize=factory$2((xt,$t)=>{const{children:Ct,classNames:kt,styles:Mt,scrollbarSize:Ft,scrollHideDelay:jt,type:Bt,dir:Vt,offsetScrollbars:zt,viewportRef:Ht,onScrollPositionChange:Gt,unstyled:qt,variant:Wt,viewportProps:Yt,scrollbars:Kt,style:Xt,vars:Qt,...Jt}=useProps("ScrollAreaAutosize",defaultProps$2g,xt);return jsxRuntimeExports.jsx(Box,{...Jt,ref:$t,style:[{display:"flex",overflow:"auto"},Xt],children:jsxRuntimeExports.jsx(Box,{style:{display:"flex",flexDirection:"column",flex:1},children:jsxRuntimeExports.jsx(ScrollArea,{classNames:kt,styles:Mt,scrollHideDelay:jt,scrollbarSize:Ft,type:Bt,dir:Vt,offsetScrollbars:zt,viewportRef:Ht,onScrollPositionChange:Gt,unstyled:qt,variant:Wt,viewportProps:Yt,vars:Qt,scrollbars:Kt,children:Ct})})})});ScrollArea.classes=classes$$;ScrollAreaAutosize.displayName="@mantine/core/ScrollAreaAutosize";ScrollAreaAutosize.classes=classes$$;ScrollArea.Autosize=ScrollAreaAutosize;var classes$_={root:"m_87cf2631"};const defaultProps$2f={__staticSelector:"UnstyledButton"},UnstyledButton=polymorphicFactory((xt,$t)=>{const Ct=useProps("UnstyledButton",defaultProps$2f,xt),{className:kt,component:Mt="button",__staticSelector:Ft,unstyled:jt,classNames:Bt,styles:Vt,style:zt,...Ht}=Ct,Gt=useStyles({name:Ft,props:Ct,classes:classes$_,className:kt,style:zt,classNames:Bt,styles:Vt,unstyled:jt});return jsxRuntimeExports.jsx(Box,{...Gt("root",{focusable:!0}),component:Mt,ref:$t,type:Mt==="button"?"button":void 0,...Ht})});UnstyledButton.classes=classes$_;UnstyledButton.displayName="@mantine/core/UnstyledButton";var classes$Z={root:"m_515a97f8"};const defaultProps$2e={},VisuallyHidden=factory$2((xt,$t)=>{const Ct=useProps("VisuallyHidden",defaultProps$2e,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,...zt}=Ct,Ht=useStyles({name:"VisuallyHidden",classes:classes$Z,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt});return jsxRuntimeExports.jsx(Box,{component:"span",ref:$t,...Ht("root"),...zt})});VisuallyHidden.classes=classes$Z;VisuallyHidden.displayName="@mantine/core/VisuallyHidden";var classes$Y={root:"m_1b7284a3"};const defaultProps$2d={},varsResolver$X=(xt,{radius:$t,shadow:Ct})=>({root:{"--paper-radius":$t===void 0?void 0:getRadius($t),"--paper-shadow":getShadow(Ct)}}),Paper=polymorphicFactory((xt,$t)=>{const Ct=useProps("Paper",defaultProps$2d,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,withBorder:Vt,vars:zt,radius:Ht,shadow:Gt,variant:qt,mod:Wt,...Yt}=Ct,Kt=useStyles({name:"Paper",props:Ct,classes:classes$Y,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:zt,varsResolver:varsResolver$X});return jsxRuntimeExports.jsx(Box,{ref:$t,mod:[{"data-with-border":Vt},Wt],...Kt("root"),variant:qt,...Yt})});Paper.classes=classes$Y;Paper.displayName="@mantine/core/Paper";function getNodeName(xt){return isNode$1(xt)?(xt.nodeName||"").toLowerCase():"#document"}function getWindow$1(xt){var $t;return(xt==null||($t=xt.ownerDocument)==null?void 0:$t.defaultView)||window}function getDocumentElement(xt){var $t;return($t=(isNode$1(xt)?xt.ownerDocument:xt.document)||window.document)==null?void 0:$t.documentElement}function isNode$1(xt){return xt instanceof Node||xt instanceof getWindow$1(xt).Node}function isElement(xt){return xt instanceof Element||xt instanceof getWindow$1(xt).Element}function isHTMLElement(xt){return xt instanceof HTMLElement||xt instanceof getWindow$1(xt).HTMLElement}function isShadowRoot(xt){return typeof ShadowRoot>"u"?!1:xt instanceof ShadowRoot||xt instanceof getWindow$1(xt).ShadowRoot}function isOverflowElement(xt){const{overflow:$t,overflowX:Ct,overflowY:kt,display:Mt}=getComputedStyle$1(xt);return/auto|scroll|overlay|hidden|clip/.test($t+kt+Ct)&&!["inline","contents"].includes(Mt)}function isTableElement(xt){return["table","td","th"].includes(getNodeName(xt))}function isContainingBlock(xt){const $t=isWebKit(),Ct=getComputedStyle$1(xt);return Ct.transform!=="none"||Ct.perspective!=="none"||(Ct.containerType?Ct.containerType!=="normal":!1)||!$t&&(Ct.backdropFilter?Ct.backdropFilter!=="none":!1)||!$t&&(Ct.filter?Ct.filter!=="none":!1)||["transform","perspective","filter"].some(kt=>(Ct.willChange||"").includes(kt))||["paint","layout","strict","content"].some(kt=>(Ct.contain||"").includes(kt))}function getContainingBlock(xt){let $t=getParentNode(xt);for(;isHTMLElement($t)&&!isLastTraversableNode($t);){if(isContainingBlock($t))return $t;$t=getParentNode($t)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(xt){return["html","body","#document"].includes(getNodeName(xt))}function getComputedStyle$1(xt){return getWindow$1(xt).getComputedStyle(xt)}function getNodeScroll(xt){return isElement(xt)?{scrollLeft:xt.scrollLeft,scrollTop:xt.scrollTop}:{scrollLeft:xt.pageXOffset,scrollTop:xt.pageYOffset}}function getParentNode(xt){if(getNodeName(xt)==="html")return xt;const $t=xt.assignedSlot||xt.parentNode||isShadowRoot(xt)&&xt.host||getDocumentElement(xt);return isShadowRoot($t)?$t.host:$t}function getNearestOverflowAncestor(xt){const $t=getParentNode(xt);return isLastTraversableNode($t)?xt.ownerDocument?xt.ownerDocument.body:xt.body:isHTMLElement($t)&&isOverflowElement($t)?$t:getNearestOverflowAncestor($t)}function getOverflowAncestors(xt,$t,Ct){var kt;$t===void 0&&($t=[]),Ct===void 0&&(Ct=!0);const Mt=getNearestOverflowAncestor(xt),Ft=Mt===((kt=xt.ownerDocument)==null?void 0:kt.body),jt=getWindow$1(Mt);return Ft?$t.concat(jt,jt.visualViewport||[],isOverflowElement(Mt)?Mt:[],jt.frameElement&&Ct?getOverflowAncestors(jt.frameElement):[]):$t.concat(Mt,getOverflowAncestors(Mt,[],Ct))}function activeElement(xt){let $t=xt.activeElement;for(;((Ct=$t)==null||(Ct=Ct.shadowRoot)==null?void 0:Ct.activeElement)!=null;){var Ct;$t=$t.shadowRoot.activeElement}return $t}function contains$3(xt,$t){if(!xt||!$t)return!1;const Ct=$t.getRootNode==null?void 0:$t.getRootNode();if(xt.contains($t))return!0;if(Ct&&isShadowRoot(Ct)){let kt=$t;for(;kt;){if(xt===kt)return!0;kt=kt.parentNode||kt.host}}return!1}function getPlatform(){const xt=navigator.userAgentData;return xt!=null&&xt.platform?xt.platform:navigator.platform}function getUserAgent(){const xt=navigator.userAgentData;return xt&&Array.isArray(xt.brands)?xt.brands.map($t=>{let{brand:Ct,version:kt}=$t;return Ct+"/"+kt}).join(" "):navigator.userAgent}function isVirtualPointerEvent(xt){return isJSDOM()?!1:!isAndroid()&&xt.width===0&&xt.height===0||isAndroid()&&xt.width===1&&xt.height===1&&xt.pressure===0&&xt.detail===0&&xt.pointerType==="mouse"||xt.width<1&&xt.height<1&&xt.pressure===0&&xt.detail===0&&xt.pointerType==="touch"}function isSafari$1(){return/apple/i.test(navigator.vendor)}function isAndroid(){const xt=/android/i;return xt.test(getPlatform())||xt.test(getUserAgent())}function isMac(){return getPlatform().toLowerCase().startsWith("mac")&&!navigator.maxTouchPoints}function isJSDOM(){return getUserAgent().includes("jsdom/")}function isMouseLikePointerType(xt,$t){const Ct=["mouse","pen"];return Ct.push("",void 0),Ct.includes(xt)}function isReactEvent(xt){return"nativeEvent"in xt}function isRootElement(xt){return xt.matches("html,body")}function getDocument$1(xt){return(xt==null?void 0:xt.ownerDocument)||document}function isEventTargetWithin(xt,$t){if($t==null)return!1;if("composedPath"in xt)return xt.composedPath().includes($t);const Ct=xt;return Ct.target!=null&&$t.contains(Ct.target)}function getTarget(xt){return"composedPath"in xt?xt.composedPath()[0]:xt.target}const TYPEABLE_SELECTOR="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function isTypeableElement(xt){return isHTMLElement(xt)&&xt.matches(TYPEABLE_SELECTOR)}const min$5=Math.min,max$5=Math.max,round=Math.round,floor$1=Math.floor,createCoords=xt=>({x:xt,y:xt}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp$2(xt,$t,Ct){return max$5(xt,min$5($t,Ct))}function evaluate$1(xt,$t){return typeof xt=="function"?xt($t):xt}function getSide(xt){return xt.split("-")[0]}function getAlignment(xt){return xt.split("-")[1]}function getOppositeAxis(xt){return xt==="x"?"y":"x"}function getAxisLength(xt){return xt==="y"?"height":"width"}function getSideAxis(xt){return["top","bottom"].includes(getSide(xt))?"y":"x"}function getAlignmentAxis(xt){return getOppositeAxis(getSideAxis(xt))}function getAlignmentSides(xt,$t,Ct){Ct===void 0&&(Ct=!1);const kt=getAlignment(xt),Mt=getAlignmentAxis(xt),Ft=getAxisLength(Mt);let jt=Mt==="x"?kt===(Ct?"end":"start")?"right":"left":kt==="start"?"bottom":"top";return $t.reference[Ft]>$t.floating[Ft]&&(jt=getOppositePlacement(jt)),[jt,getOppositePlacement(jt)]}function getExpandedPlacements(xt){const $t=getOppositePlacement(xt);return[getOppositeAlignmentPlacement(xt),$t,getOppositeAlignmentPlacement($t)]}function getOppositeAlignmentPlacement(xt){return xt.replace(/start|end/g,$t=>oppositeAlignmentMap[$t])}function getSideList(xt,$t,Ct){const kt=["left","right"],Mt=["right","left"],Ft=["top","bottom"],jt=["bottom","top"];switch(xt){case"top":case"bottom":return Ct?$t?Mt:kt:$t?kt:Mt;case"left":case"right":return $t?Ft:jt;default:return[]}}function getOppositeAxisPlacements(xt,$t,Ct,kt){const Mt=getAlignment(xt);let Ft=getSideList(getSide(xt),Ct==="start",kt);return Mt&&(Ft=Ft.map(jt=>jt+"-"+Mt),$t&&(Ft=Ft.concat(Ft.map(getOppositeAlignmentPlacement)))),Ft}function getOppositePlacement(xt){return xt.replace(/left|right|bottom|top/g,$t=>oppositeSideMap[$t])}function expandPaddingObject(xt){return{top:0,right:0,bottom:0,left:0,...xt}}function getPaddingObject(xt){return typeof xt!="number"?expandPaddingObject(xt):{top:xt,right:xt,bottom:xt,left:xt}}function rectToClientRect(xt){const{x:$t,y:Ct,width:kt,height:Mt}=xt;return{width:kt,height:Mt,top:Ct,left:$t,right:$t+kt,bottom:Ct+Mt,x:$t,y:Ct}}function computeCoordsFromPlacement(xt,$t,Ct){let{reference:kt,floating:Mt}=xt;const Ft=getSideAxis($t),jt=getAlignmentAxis($t),Bt=getAxisLength(jt),Vt=getSide($t),zt=Ft==="y",Ht=kt.x+kt.width/2-Mt.width/2,Gt=kt.y+kt.height/2-Mt.height/2,qt=kt[Bt]/2-Mt[Bt]/2;let Wt;switch(Vt){case"top":Wt={x:Ht,y:kt.y-Mt.height};break;case"bottom":Wt={x:Ht,y:kt.y+kt.height};break;case"right":Wt={x:kt.x+kt.width,y:Gt};break;case"left":Wt={x:kt.x-Mt.width,y:Gt};break;default:Wt={x:kt.x,y:kt.y}}switch(getAlignment($t)){case"start":Wt[jt]-=qt*(Ct&&zt?-1:1);break;case"end":Wt[jt]+=qt*(Ct&&zt?-1:1);break}return Wt}const computePosition$1=async(xt,$t,Ct)=>{const{placement:kt="bottom",strategy:Mt="absolute",middleware:Ft=[],platform:jt}=Ct,Bt=Ft.filter(Boolean),Vt=await(jt.isRTL==null?void 0:jt.isRTL($t));let zt=await jt.getElementRects({reference:xt,floating:$t,strategy:Mt}),{x:Ht,y:Gt}=computeCoordsFromPlacement(zt,kt,Vt),qt=kt,Wt={},Yt=0;for(let Kt=0;Kt<Bt.length;Kt++){const{name:Xt,fn:Qt}=Bt[Kt],{x:Jt,y:Zt,data:sn,reset:ln}=await Qt({x:Ht,y:Gt,initialPlacement:kt,placement:qt,strategy:Mt,middlewareData:Wt,rects:zt,platform:jt,elements:{reference:xt,floating:$t}});Ht=Jt??Ht,Gt=Zt??Gt,Wt={...Wt,[Xt]:{...Wt[Xt],...sn}},ln&&Yt<=50&&(Yt++,typeof ln=="object"&&(ln.placement&&(qt=ln.placement),ln.rects&&(zt=ln.rects===!0?await jt.getElementRects({reference:xt,floating:$t,strategy:Mt}):ln.rects),{x:Ht,y:Gt}=computeCoordsFromPlacement(zt,qt,Vt)),Kt=-1)}return{x:Ht,y:Gt,placement:qt,strategy:Mt,middlewareData:Wt}};async function detectOverflow(xt,$t){var Ct;$t===void 0&&($t={});const{x:kt,y:Mt,platform:Ft,rects:jt,elements:Bt,strategy:Vt}=xt,{boundary:zt="clippingAncestors",rootBoundary:Ht="viewport",elementContext:Gt="floating",altBoundary:qt=!1,padding:Wt=0}=evaluate$1($t,xt),Yt=getPaddingObject(Wt),Xt=Bt[qt?Gt==="floating"?"reference":"floating":Gt],Qt=rectToClientRect(await Ft.getClippingRect({element:(Ct=await(Ft.isElement==null?void 0:Ft.isElement(Xt)))==null||Ct?Xt:Xt.contextElement||await(Ft.getDocumentElement==null?void 0:Ft.getDocumentElement(Bt.floating)),boundary:zt,rootBoundary:Ht,strategy:Vt})),Jt=Gt==="floating"?{x:kt,y:Mt,width:jt.floating.width,height:jt.floating.height}:jt.reference,Zt=await(Ft.getOffsetParent==null?void 0:Ft.getOffsetParent(Bt.floating)),sn=await(Ft.isElement==null?void 0:Ft.isElement(Zt))?await(Ft.getScale==null?void 0:Ft.getScale(Zt))||{x:1,y:1}:{x:1,y:1},ln=rectToClientRect(Ft.convertOffsetParentRelativeRectToViewportRelativeRect?await Ft.convertOffsetParentRelativeRectToViewportRelativeRect({elements:Bt,rect:Jt,offsetParent:Zt,strategy:Vt}):Jt);return{top:(Qt.top-ln.top+Yt.top)/sn.y,bottom:(ln.bottom-Qt.bottom+Yt.bottom)/sn.y,left:(Qt.left-ln.left+Yt.left)/sn.x,right:(ln.right-Qt.right+Yt.right)/sn.x}}const arrow$3=xt=>({name:"arrow",options:xt,async fn($t){const{x:Ct,y:kt,placement:Mt,rects:Ft,platform:jt,elements:Bt,middlewareData:Vt}=$t,{element:zt,padding:Ht=0}=evaluate$1(xt,$t)||{};if(zt==null)return{};const Gt=getPaddingObject(Ht),qt={x:Ct,y:kt},Wt=getAlignmentAxis(Mt),Yt=getAxisLength(Wt),Kt=await jt.getDimensions(zt),Xt=Wt==="y",Qt=Xt?"top":"left",Jt=Xt?"bottom":"right",Zt=Xt?"clientHeight":"clientWidth",sn=Ft.reference[Yt]+Ft.reference[Wt]-qt[Wt]-Ft.floating[Yt],ln=qt[Wt]-Ft.reference[Wt],dn=await(jt.getOffsetParent==null?void 0:jt.getOffsetParent(zt));let hn=dn?dn[Zt]:0;(!hn||!await(jt.isElement==null?void 0:jt.isElement(dn)))&&(hn=Bt.floating[Zt]||Ft.floating[Yt]);const cn=sn/2-ln/2,pn=hn/2-Kt[Yt]/2-1,yn=min$5(Gt[Qt],pn),gn=min$5(Gt[Jt],pn),En=yn,bn=hn-Kt[Yt]-gn,xn=hn/2-Kt[Yt]/2+cn,Cn=clamp$2(En,xn,bn),$n=!Vt.arrow&&getAlignment(Mt)!=null&&xn!==Cn&&Ft.reference[Yt]/2-(xn<En?yn:gn)-Kt[Yt]/2<0,wn=$n?xn<En?xn-En:xn-bn:0;return{[Wt]:qt[Wt]+wn,data:{[Wt]:Cn,centerOffset:xn-Cn-wn,...$n&&{alignmentOffset:wn}},reset:$n}}}),flip$3=function(xt){return xt===void 0&&(xt={}),{name:"flip",options:xt,async fn($t){var Ct,kt;const{placement:Mt,middlewareData:Ft,rects:jt,initialPlacement:Bt,platform:Vt,elements:zt}=$t,{mainAxis:Ht=!0,crossAxis:Gt=!0,fallbackPlacements:qt,fallbackStrategy:Wt="bestFit",fallbackAxisSideDirection:Yt="none",flipAlignment:Kt=!0,...Xt}=evaluate$1(xt,$t);if((Ct=Ft.arrow)!=null&&Ct.alignmentOffset)return{};const Qt=getSide(Mt),Jt=getSide(Bt)===Bt,Zt=await(Vt.isRTL==null?void 0:Vt.isRTL(zt.floating)),sn=qt||(Jt||!Kt?[getOppositePlacement(Bt)]:getExpandedPlacements(Bt));!qt&&Yt!=="none"&&sn.push(...getOppositeAxisPlacements(Bt,Kt,Yt,Zt));const ln=[Bt,...sn],dn=await detectOverflow($t,Xt),hn=[];let cn=((kt=Ft.flip)==null?void 0:kt.overflows)||[];if(Ht&&hn.push(dn[Qt]),Gt){const En=getAlignmentSides(Mt,jt,Zt);hn.push(dn[En[0]],dn[En[1]])}if(cn=[...cn,{placement:Mt,overflows:hn}],!hn.every(En=>En<=0)){var pn,yn;const En=(((pn=Ft.flip)==null?void 0:pn.index)||0)+1,bn=ln[En];if(bn)return{data:{index:En,overflows:cn},reset:{placement:bn}};let xn=(yn=cn.filter(Cn=>Cn.overflows[0]<=0).sort((Cn,$n)=>Cn.overflows[1]-$n.overflows[1])[0])==null?void 0:yn.placement;if(!xn)switch(Wt){case"bestFit":{var gn;const Cn=(gn=cn.map($n=>[$n.placement,$n.overflows.filter(wn=>wn>0).reduce((wn,Rn)=>wn+Rn,0)]).sort(($n,wn)=>$n[1]-wn[1])[0])==null?void 0:gn[0];Cn&&(xn=Cn);break}case"initialPlacement":xn=Bt;break}if(Mt!==xn)return{reset:{placement:xn}}}return{}}}};function getBoundingRect(xt){const $t=min$5(...xt.map(Ft=>Ft.left)),Ct=min$5(...xt.map(Ft=>Ft.top)),kt=max$5(...xt.map(Ft=>Ft.right)),Mt=max$5(...xt.map(Ft=>Ft.bottom));return{x:$t,y:Ct,width:kt-$t,height:Mt-Ct}}function getRectsByLine(xt){const $t=xt.slice().sort((Mt,Ft)=>Mt.y-Ft.y),Ct=[];let kt=null;for(let Mt=0;Mt<$t.length;Mt++){const Ft=$t[Mt];!kt||Ft.y-kt.y>kt.height/2?Ct.push([Ft]):Ct[Ct.length-1].push(Ft),kt=Ft}return Ct.map(Mt=>rectToClientRect(getBoundingRect(Mt)))}const inline$2=function(xt){return xt===void 0&&(xt={}),{name:"inline",options:xt,async fn($t){const{placement:Ct,elements:kt,rects:Mt,platform:Ft,strategy:jt}=$t,{padding:Bt=2,x:Vt,y:zt}=evaluate$1(xt,$t),Ht=Array.from(await(Ft.getClientRects==null?void 0:Ft.getClientRects(kt.reference))||[]),Gt=getRectsByLine(Ht),qt=rectToClientRect(getBoundingRect(Ht)),Wt=getPaddingObject(Bt);function Yt(){if(Gt.length===2&&Gt[0].left>Gt[1].right&&Vt!=null&&zt!=null)return Gt.find(Xt=>Vt>Xt.left-Wt.left&&Vt<Xt.right+Wt.right&&zt>Xt.top-Wt.top&&zt<Xt.bottom+Wt.bottom)||qt;if(Gt.length>=2){if(getSideAxis(Ct)==="y"){const yn=Gt[0],gn=Gt[Gt.length-1],En=getSide(Ct)==="top",bn=yn.top,xn=gn.bottom,Cn=En?yn.left:gn.left,$n=En?yn.right:gn.right,wn=$n-Cn,Rn=xn-bn;return{top:bn,bottom:xn,left:Cn,right:$n,width:wn,height:Rn,x:Cn,y:bn}}const Xt=getSide(Ct)==="left",Qt=max$5(...Gt.map(yn=>yn.right)),Jt=min$5(...Gt.map(yn=>yn.left)),Zt=Gt.filter(yn=>Xt?yn.left===Jt:yn.right===Qt),sn=Zt[0].top,ln=Zt[Zt.length-1].bottom,dn=Jt,hn=Qt,cn=hn-dn,pn=ln-sn;return{top:sn,bottom:ln,left:dn,right:hn,width:cn,height:pn,x:dn,y:sn}}return qt}const Kt=await Ft.getElementRects({reference:{getBoundingClientRect:Yt},floating:kt.floating,strategy:jt});return Mt.reference.x!==Kt.reference.x||Mt.reference.y!==Kt.reference.y||Mt.reference.width!==Kt.reference.width||Mt.reference.height!==Kt.reference.height?{reset:{rects:Kt}}:{}}}};async function convertValueToCoords(xt,$t){const{placement:Ct,platform:kt,elements:Mt}=xt,Ft=await(kt.isRTL==null?void 0:kt.isRTL(Mt.floating)),jt=getSide(Ct),Bt=getAlignment(Ct),Vt=getSideAxis(Ct)==="y",zt=["left","top"].includes(jt)?-1:1,Ht=Ft&&Vt?-1:1,Gt=evaluate$1($t,xt);let{mainAxis:qt,crossAxis:Wt,alignmentAxis:Yt}=typeof Gt=="number"?{mainAxis:Gt,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...Gt};return Bt&&typeof Yt=="number"&&(Wt=Bt==="end"?Yt*-1:Yt),Vt?{x:Wt*Ht,y:qt*zt}:{x:qt*zt,y:Wt*Ht}}const offset$6=function(xt){return xt===void 0&&(xt=0),{name:"offset",options:xt,async fn($t){var Ct,kt;const{x:Mt,y:Ft,placement:jt,middlewareData:Bt}=$t,Vt=await convertValueToCoords($t,xt);return jt===((Ct=Bt.offset)==null?void 0:Ct.placement)&&(kt=Bt.arrow)!=null&&kt.alignmentOffset?{}:{x:Mt+Vt.x,y:Ft+Vt.y,data:{...Vt,placement:jt}}}}},shift$2=function(xt){return xt===void 0&&(xt={}),{name:"shift",options:xt,async fn($t){const{x:Ct,y:kt,placement:Mt}=$t,{mainAxis:Ft=!0,crossAxis:jt=!1,limiter:Bt={fn:Xt=>{let{x:Qt,y:Jt}=Xt;return{x:Qt,y:Jt}}},...Vt}=evaluate$1(xt,$t),zt={x:Ct,y:kt},Ht=await detectOverflow($t,Vt),Gt=getSideAxis(getSide(Mt)),qt=getOppositeAxis(Gt);let Wt=zt[qt],Yt=zt[Gt];if(Ft){const Xt=qt==="y"?"top":"left",Qt=qt==="y"?"bottom":"right",Jt=Wt+Ht[Xt],Zt=Wt-Ht[Qt];Wt=clamp$2(Jt,Wt,Zt)}if(jt){const Xt=Gt==="y"?"top":"left",Qt=Gt==="y"?"bottom":"right",Jt=Yt+Ht[Xt],Zt=Yt-Ht[Qt];Yt=clamp$2(Jt,Yt,Zt)}const Kt=Bt.fn({...$t,[qt]:Wt,[Gt]:Yt});return{...Kt,data:{x:Kt.x-Ct,y:Kt.y-kt}}}}},limitShift$2=function(xt){return xt===void 0&&(xt={}),{options:xt,fn($t){const{x:Ct,y:kt,placement:Mt,rects:Ft,middlewareData:jt}=$t,{offset:Bt=0,mainAxis:Vt=!0,crossAxis:zt=!0}=evaluate$1(xt,$t),Ht={x:Ct,y:kt},Gt=getSideAxis(Mt),qt=getOppositeAxis(Gt);let Wt=Ht[qt],Yt=Ht[Gt];const Kt=evaluate$1(Bt,$t),Xt=typeof Kt=="number"?{mainAxis:Kt,crossAxis:0}:{mainAxis:0,crossAxis:0,...Kt};if(Vt){const Zt=qt==="y"?"height":"width",sn=Ft.reference[qt]-Ft.floating[Zt]+Xt.mainAxis,ln=Ft.reference[qt]+Ft.reference[Zt]-Xt.mainAxis;Wt<sn?Wt=sn:Wt>ln&&(Wt=ln)}if(zt){var Qt,Jt;const Zt=qt==="y"?"width":"height",sn=["top","left"].includes(getSide(Mt)),ln=Ft.reference[Gt]-Ft.floating[Zt]+(sn&&((Qt=jt.offset)==null?void 0:Qt[Gt])||0)+(sn?0:Xt.crossAxis),dn=Ft.reference[Gt]+Ft.reference[Zt]+(sn?0:((Jt=jt.offset)==null?void 0:Jt[Gt])||0)-(sn?Xt.crossAxis:0);Yt<ln?Yt=ln:Yt>dn&&(Yt=dn)}return{[qt]:Wt,[Gt]:Yt}}}},size$2=function(xt){return xt===void 0&&(xt={}),{name:"size",options:xt,async fn($t){const{placement:Ct,rects:kt,platform:Mt,elements:Ft}=$t,{apply:jt=()=>{},...Bt}=evaluate$1(xt,$t),Vt=await detectOverflow($t,Bt),zt=getSide(Ct),Ht=getAlignment(Ct),Gt=getSideAxis(Ct)==="y",{width:qt,height:Wt}=kt.floating;let Yt,Kt;zt==="top"||zt==="bottom"?(Yt=zt,Kt=Ht===(await(Mt.isRTL==null?void 0:Mt.isRTL(Ft.floating))?"start":"end")?"left":"right"):(Kt=zt,Yt=Ht==="end"?"top":"bottom");const Xt=Wt-Vt.top-Vt.bottom,Qt=qt-Vt.left-Vt.right,Jt=min$5(Wt-Vt[Yt],Xt),Zt=min$5(qt-Vt[Kt],Qt),sn=!$t.middlewareData.shift;let ln=Jt,dn=Zt;if(Gt?dn=Ht||sn?min$5(Zt,Qt):Qt:ln=Ht||sn?min$5(Jt,Xt):Xt,sn&&!Ht){const cn=max$5(Vt.left,0),pn=max$5(Vt.right,0),yn=max$5(Vt.top,0),gn=max$5(Vt.bottom,0);Gt?dn=qt-2*(cn!==0||pn!==0?cn+pn:max$5(Vt.left,Vt.right)):ln=Wt-2*(yn!==0||gn!==0?yn+gn:max$5(Vt.top,Vt.bottom))}await jt({...$t,availableWidth:dn,availableHeight:ln});const hn=await Mt.getDimensions(Ft.floating);return qt!==hn.width||Wt!==hn.height?{reset:{rects:!0}}:{}}}};function getCssDimensions(xt){const $t=getComputedStyle$1(xt);let Ct=parseFloat($t.width)||0,kt=parseFloat($t.height)||0;const Mt=isHTMLElement(xt),Ft=Mt?xt.offsetWidth:Ct,jt=Mt?xt.offsetHeight:kt,Bt=round(Ct)!==Ft||round(kt)!==jt;return Bt&&(Ct=Ft,kt=jt),{width:Ct,height:kt,$:Bt}}function unwrapElement(xt){return isElement(xt)?xt:xt.contextElement}function getScale$1(xt){const $t=unwrapElement(xt);if(!isHTMLElement($t))return createCoords(1);const Ct=$t.getBoundingClientRect(),{width:kt,height:Mt,$:Ft}=getCssDimensions($t);let jt=(Ft?round(Ct.width):Ct.width)/kt,Bt=(Ft?round(Ct.height):Ct.height)/Mt;return(!jt||!Number.isFinite(jt))&&(jt=1),(!Bt||!Number.isFinite(Bt))&&(Bt=1),{x:jt,y:Bt}}const noOffsets=createCoords(0);function getVisualOffsets(xt){const $t=getWindow$1(xt);return!isWebKit()||!$t.visualViewport?noOffsets:{x:$t.visualViewport.offsetLeft,y:$t.visualViewport.offsetTop}}function shouldAddVisualOffsets(xt,$t,Ct){return $t===void 0&&($t=!1),!Ct||$t&&Ct!==getWindow$1(xt)?!1:$t}function getBoundingClientRect(xt,$t,Ct,kt){$t===void 0&&($t=!1),Ct===void 0&&(Ct=!1);const Mt=xt.getBoundingClientRect(),Ft=unwrapElement(xt);let jt=createCoords(1);$t&&(kt?isElement(kt)&&(jt=getScale$1(kt)):jt=getScale$1(xt));const Bt=shouldAddVisualOffsets(Ft,Ct,kt)?getVisualOffsets(Ft):createCoords(0);let Vt=(Mt.left+Bt.x)/jt.x,zt=(Mt.top+Bt.y)/jt.y,Ht=Mt.width/jt.x,Gt=Mt.height/jt.y;if(Ft){const qt=getWindow$1(Ft),Wt=kt&&isElement(kt)?getWindow$1(kt):kt;let Yt=qt,Kt=Yt.frameElement;for(;Kt&&kt&&Wt!==Yt;){const Xt=getScale$1(Kt),Qt=Kt.getBoundingClientRect(),Jt=getComputedStyle$1(Kt),Zt=Qt.left+(Kt.clientLeft+parseFloat(Jt.paddingLeft))*Xt.x,sn=Qt.top+(Kt.clientTop+parseFloat(Jt.paddingTop))*Xt.y;Vt*=Xt.x,zt*=Xt.y,Ht*=Xt.x,Gt*=Xt.y,Vt+=Zt,zt+=sn,Yt=getWindow$1(Kt),Kt=Yt.frameElement}}return rectToClientRect({width:Ht,height:Gt,x:Vt,y:zt})}const topLayerSelectors=[":popover-open",":modal"];function isTopLayer(xt){return topLayerSelectors.some($t=>{try{return xt.matches($t)}catch{return!1}})}function convertOffsetParentRelativeRectToViewportRelativeRect(xt){let{elements:$t,rect:Ct,offsetParent:kt,strategy:Mt}=xt;const Ft=Mt==="fixed",jt=getDocumentElement(kt),Bt=$t?isTopLayer($t.floating):!1;if(kt===jt||Bt&&Ft)return Ct;let Vt={scrollLeft:0,scrollTop:0},zt=createCoords(1);const Ht=createCoords(0),Gt=isHTMLElement(kt);if((Gt||!Gt&&!Ft)&&((getNodeName(kt)!=="body"||isOverflowElement(jt))&&(Vt=getNodeScroll(kt)),isHTMLElement(kt))){const qt=getBoundingClientRect(kt);zt=getScale$1(kt),Ht.x=qt.x+kt.clientLeft,Ht.y=qt.y+kt.clientTop}return{width:Ct.width*zt.x,height:Ct.height*zt.y,x:Ct.x*zt.x-Vt.scrollLeft*zt.x+Ht.x,y:Ct.y*zt.y-Vt.scrollTop*zt.y+Ht.y}}function getClientRects(xt){return Array.from(xt.getClientRects())}function getWindowScrollBarX(xt){return getBoundingClientRect(getDocumentElement(xt)).left+getNodeScroll(xt).scrollLeft}function getDocumentRect(xt){const $t=getDocumentElement(xt),Ct=getNodeScroll(xt),kt=xt.ownerDocument.body,Mt=max$5($t.scrollWidth,$t.clientWidth,kt.scrollWidth,kt.clientWidth),Ft=max$5($t.scrollHeight,$t.clientHeight,kt.scrollHeight,kt.clientHeight);let jt=-Ct.scrollLeft+getWindowScrollBarX(xt);const Bt=-Ct.scrollTop;return getComputedStyle$1(kt).direction==="rtl"&&(jt+=max$5($t.clientWidth,kt.clientWidth)-Mt),{width:Mt,height:Ft,x:jt,y:Bt}}function getViewportRect(xt,$t){const Ct=getWindow$1(xt),kt=getDocumentElement(xt),Mt=Ct.visualViewport;let Ft=kt.clientWidth,jt=kt.clientHeight,Bt=0,Vt=0;if(Mt){Ft=Mt.width,jt=Mt.height;const zt=isWebKit();(!zt||zt&&$t==="fixed")&&(Bt=Mt.offsetLeft,Vt=Mt.offsetTop)}return{width:Ft,height:jt,x:Bt,y:Vt}}function getInnerBoundingClientRect(xt,$t){const Ct=getBoundingClientRect(xt,!0,$t==="fixed"),kt=Ct.top+xt.clientTop,Mt=Ct.left+xt.clientLeft,Ft=isHTMLElement(xt)?getScale$1(xt):createCoords(1),jt=xt.clientWidth*Ft.x,Bt=xt.clientHeight*Ft.y,Vt=Mt*Ft.x,zt=kt*Ft.y;return{width:jt,height:Bt,x:Vt,y:zt}}function getClientRectFromClippingAncestor(xt,$t,Ct){let kt;if($t==="viewport")kt=getViewportRect(xt,Ct);else if($t==="document")kt=getDocumentRect(getDocumentElement(xt));else if(isElement($t))kt=getInnerBoundingClientRect($t,Ct);else{const Mt=getVisualOffsets(xt);kt={...$t,x:$t.x-Mt.x,y:$t.y-Mt.y}}return rectToClientRect(kt)}function hasFixedPositionAncestor(xt,$t){const Ct=getParentNode(xt);return Ct===$t||!isElement(Ct)||isLastTraversableNode(Ct)?!1:getComputedStyle$1(Ct).position==="fixed"||hasFixedPositionAncestor(Ct,$t)}function getClippingElementAncestors(xt,$t){const Ct=$t.get(xt);if(Ct)return Ct;let kt=getOverflowAncestors(xt,[],!1).filter(Bt=>isElement(Bt)&&getNodeName(Bt)!=="body"),Mt=null;const Ft=getComputedStyle$1(xt).position==="fixed";let jt=Ft?getParentNode(xt):xt;for(;isElement(jt)&&!isLastTraversableNode(jt);){const Bt=getComputedStyle$1(jt),Vt=isContainingBlock(jt);!Vt&&Bt.position==="fixed"&&(Mt=null),(Ft?!Vt&&!Mt:!Vt&&Bt.position==="static"&&!!Mt&&["absolute","fixed"].includes(Mt.position)||isOverflowElement(jt)&&!Vt&&hasFixedPositionAncestor(xt,jt))?kt=kt.filter(Ht=>Ht!==jt):Mt=Bt,jt=getParentNode(jt)}return $t.set(xt,kt),kt}function getClippingRect(xt){let{element:$t,boundary:Ct,rootBoundary:kt,strategy:Mt}=xt;const jt=[...Ct==="clippingAncestors"?isTopLayer($t)?[]:getClippingElementAncestors($t,this._c):[].concat(Ct),kt],Bt=jt[0],Vt=jt.reduce((zt,Ht)=>{const Gt=getClientRectFromClippingAncestor($t,Ht,Mt);return zt.top=max$5(Gt.top,zt.top),zt.right=min$5(Gt.right,zt.right),zt.bottom=min$5(Gt.bottom,zt.bottom),zt.left=max$5(Gt.left,zt.left),zt},getClientRectFromClippingAncestor($t,Bt,Mt));return{width:Vt.right-Vt.left,height:Vt.bottom-Vt.top,x:Vt.left,y:Vt.top}}function getDimensions(xt){const{width:$t,height:Ct}=getCssDimensions(xt);return{width:$t,height:Ct}}function getRectRelativeToOffsetParent(xt,$t,Ct){const kt=isHTMLElement($t),Mt=getDocumentElement($t),Ft=Ct==="fixed",jt=getBoundingClientRect(xt,!0,Ft,$t);let Bt={scrollLeft:0,scrollTop:0};const Vt=createCoords(0);if(kt||!kt&&!Ft)if((getNodeName($t)!=="body"||isOverflowElement(Mt))&&(Bt=getNodeScroll($t)),kt){const Gt=getBoundingClientRect($t,!0,Ft,$t);Vt.x=Gt.x+$t.clientLeft,Vt.y=Gt.y+$t.clientTop}else Mt&&(Vt.x=getWindowScrollBarX(Mt));const zt=jt.left+Bt.scrollLeft-Vt.x,Ht=jt.top+Bt.scrollTop-Vt.y;return{x:zt,y:Ht,width:jt.width,height:jt.height}}function isStaticPositioned(xt){return getComputedStyle$1(xt).position==="static"}function getTrueOffsetParent(xt,$t){return!isHTMLElement(xt)||getComputedStyle$1(xt).position==="fixed"?null:$t?$t(xt):xt.offsetParent}function getOffsetParent(xt,$t){const Ct=getWindow$1(xt);if(isTopLayer(xt))return Ct;if(!isHTMLElement(xt)){let Mt=getParentNode(xt);for(;Mt&&!isLastTraversableNode(Mt);){if(isElement(Mt)&&!isStaticPositioned(Mt))return Mt;Mt=getParentNode(Mt)}return Ct}let kt=getTrueOffsetParent(xt,$t);for(;kt&&isTableElement(kt)&&isStaticPositioned(kt);)kt=getTrueOffsetParent(kt,$t);return kt&&isLastTraversableNode(kt)&&isStaticPositioned(kt)&&!isContainingBlock(kt)?Ct:kt||getContainingBlock(xt)||Ct}const getElementRects=async function(xt){const $t=this.getOffsetParent||getOffsetParent,Ct=this.getDimensions,kt=await Ct(xt.floating);return{reference:getRectRelativeToOffsetParent(xt.reference,await $t(xt.floating),xt.strategy),floating:{x:0,y:0,width:kt.width,height:kt.height}}};function isRTL(xt){return getComputedStyle$1(xt).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale:getScale$1,isElement,isRTL};function observeMove(xt,$t){let Ct=null,kt;const Mt=getDocumentElement(xt);function Ft(){var Bt;clearTimeout(kt),(Bt=Ct)==null||Bt.disconnect(),Ct=null}function jt(Bt,Vt){Bt===void 0&&(Bt=!1),Vt===void 0&&(Vt=1),Ft();const{left:zt,top:Ht,width:Gt,height:qt}=xt.getBoundingClientRect();if(Bt||$t(),!Gt||!qt)return;const Wt=floor$1(Ht),Yt=floor$1(Mt.clientWidth-(zt+Gt)),Kt=floor$1(Mt.clientHeight-(Ht+qt)),Xt=floor$1(zt),Jt={rootMargin:-Wt+"px "+-Yt+"px "+-Kt+"px "+-Xt+"px",threshold:max$5(0,min$5(1,Vt))||1};let Zt=!0;function sn(ln){const dn=ln[0].intersectionRatio;if(dn!==Vt){if(!Zt)return jt();dn?jt(!1,dn):kt=setTimeout(()=>{jt(!1,1e-7)},1e3)}Zt=!1}try{Ct=new IntersectionObserver(sn,{...Jt,root:Mt.ownerDocument})}catch{Ct=new IntersectionObserver(sn,Jt)}Ct.observe(xt)}return jt(!0),Ft}function autoUpdate(xt,$t,Ct,kt){kt===void 0&&(kt={});const{ancestorScroll:Mt=!0,ancestorResize:Ft=!0,elementResize:jt=typeof ResizeObserver=="function",layoutShift:Bt=typeof IntersectionObserver=="function",animationFrame:Vt=!1}=kt,zt=unwrapElement(xt),Ht=Mt||Ft?[...zt?getOverflowAncestors(zt):[],...getOverflowAncestors($t)]:[];Ht.forEach(Qt=>{Mt&&Qt.addEventListener("scroll",Ct,{passive:!0}),Ft&&Qt.addEventListener("resize",Ct)});const Gt=zt&&Bt?observeMove(zt,Ct):null;let qt=-1,Wt=null;jt&&(Wt=new ResizeObserver(Qt=>{let[Jt]=Qt;Jt&&Jt.target===zt&&Wt&&(Wt.unobserve($t),cancelAnimationFrame(qt),qt=requestAnimationFrame(()=>{var Zt;(Zt=Wt)==null||Zt.observe($t)})),Ct()}),zt&&!Vt&&Wt.observe(zt),Wt.observe($t));let Yt,Kt=Vt?getBoundingClientRect(xt):null;Vt&&Xt();function Xt(){const Qt=getBoundingClientRect(xt);Kt&&(Qt.x!==Kt.x||Qt.y!==Kt.y||Qt.width!==Kt.width||Qt.height!==Kt.height)&&Ct(),Kt=Qt,Yt=requestAnimationFrame(Xt)}return Ct(),()=>{var Qt;Ht.forEach(Jt=>{Mt&&Jt.removeEventListener("scroll",Ct),Ft&&Jt.removeEventListener("resize",Ct)}),Gt==null||Gt(),(Qt=Wt)==null||Qt.disconnect(),Wt=null,Vt&&cancelAnimationFrame(Yt)}}const offset$5=offset$6,shift$1=shift$2,flip$2=flip$3,size$1=size$2,arrow$2=arrow$3,inline$1=inline$2,limitShift$1=limitShift$2,computePosition=(xt,$t,Ct)=>{const kt=new Map,Mt={platform,...Ct},Ft={...Mt.platform,_c:kt};return computePosition$1(xt,$t,{...Mt,platform:Ft})};var index$6=typeof document<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function deepEqual$3(xt,$t){if(xt===$t)return!0;if(typeof xt!=typeof $t)return!1;if(typeof xt=="function"&&xt.toString()===$t.toString())return!0;let Ct,kt,Mt;if(xt&&$t&&typeof xt=="object"){if(Array.isArray(xt)){if(Ct=xt.length,Ct!==$t.length)return!1;for(kt=Ct;kt--!==0;)if(!deepEqual$3(xt[kt],$t[kt]))return!1;return!0}if(Mt=Object.keys(xt),Ct=Mt.length,Ct!==Object.keys($t).length)return!1;for(kt=Ct;kt--!==0;)if(!{}.hasOwnProperty.call($t,Mt[kt]))return!1;for(kt=Ct;kt--!==0;){const Ft=Mt[kt];if(!(Ft==="_owner"&&xt.$$typeof)&&!deepEqual$3(xt[Ft],$t[Ft]))return!1}return!0}return xt!==xt&&$t!==$t}function getDPR(xt){return typeof window>"u"?1:(xt.ownerDocument.defaultView||window).devicePixelRatio||1}function roundByDPR(xt,$t){const Ct=getDPR(xt);return Math.round($t*Ct)/Ct}function useLatestRef$1(xt){const $t=reactExports.useRef(xt);return index$6(()=>{$t.current=xt}),$t}function useFloating$1(xt){xt===void 0&&(xt={});const{placement:$t="bottom",strategy:Ct="absolute",middleware:kt=[],platform:Mt,elements:{reference:Ft,floating:jt}={},transform:Bt=!0,whileElementsMounted:Vt,open:zt}=xt,[Ht,Gt]=reactExports.useState({x:0,y:0,strategy:Ct,placement:$t,middlewareData:{},isPositioned:!1}),[qt,Wt]=reactExports.useState(kt);deepEqual$3(qt,kt)||Wt(kt);const[Yt,Kt]=reactExports.useState(null),[Xt,Qt]=reactExports.useState(null),Jt=reactExports.useCallback(wn=>{wn!==dn.current&&(dn.current=wn,Kt(wn))},[]),Zt=reactExports.useCallback(wn=>{wn!==hn.current&&(hn.current=wn,Qt(wn))},[]),sn=Ft||Yt,ln=jt||Xt,dn=reactExports.useRef(null),hn=reactExports.useRef(null),cn=reactExports.useRef(Ht),pn=Vt!=null,yn=useLatestRef$1(Vt),gn=useLatestRef$1(Mt),En=reactExports.useCallback(()=>{if(!dn.current||!hn.current)return;const wn={placement:$t,strategy:Ct,middleware:qt};gn.current&&(wn.platform=gn.current),computePosition(dn.current,hn.current,wn).then(Rn=>{const Dn={...Rn,isPositioned:!0};bn.current&&!deepEqual$3(cn.current,Dn)&&(cn.current=Dn,reactDomExports.flushSync(()=>{Gt(Dn)}))})},[qt,$t,Ct,gn]);index$6(()=>{zt===!1&&cn.current.isPositioned&&(cn.current.isPositioned=!1,Gt(wn=>({...wn,isPositioned:!1})))},[zt]);const bn=reactExports.useRef(!1);index$6(()=>(bn.current=!0,()=>{bn.current=!1}),[]),index$6(()=>{if(sn&&(dn.current=sn),ln&&(hn.current=ln),sn&&ln){if(yn.current)return yn.current(sn,ln,En);En()}},[sn,ln,En,yn,pn]);const xn=reactExports.useMemo(()=>({reference:dn,floating:hn,setReference:Jt,setFloating:Zt}),[Jt,Zt]),Cn=reactExports.useMemo(()=>({reference:sn,floating:ln}),[sn,ln]),$n=reactExports.useMemo(()=>{const wn={position:Ct,left:0,top:0};if(!Cn.floating)return wn;const Rn=roundByDPR(Cn.floating,Ht.x),Dn=roundByDPR(Cn.floating,Ht.y);return Bt?{...wn,transform:"translate("+Rn+"px, "+Dn+"px)",...getDPR(Cn.floating)>=1.5&&{willChange:"transform"}}:{position:Ct,left:Rn,top:Dn}},[Ct,Bt,Cn.floating,Ht.x,Ht.y]);return reactExports.useMemo(()=>({...Ht,update:En,refs:xn,elements:Cn,floatingStyles:$n}),[Ht,En,xn,Cn,$n])}const arrow$1=xt=>{function $t(Ct){return{}.hasOwnProperty.call(Ct,"current")}return{name:"arrow",options:xt,fn(Ct){const{element:kt,padding:Mt}=typeof xt=="function"?xt(Ct):xt;return kt&&$t(kt)?kt.current!=null?arrow$2({element:kt.current,padding:Mt}).fn(Ct):{}:kt?arrow$2({element:kt,padding:Mt}).fn(Ct):{}}}},offset$4=(xt,$t)=>({...offset$5(xt),options:[xt,$t]}),shift=(xt,$t)=>({...shift$1(xt),options:[xt,$t]}),limitShift=(xt,$t)=>({...limitShift$1(xt),options:[xt,$t]}),flip$1=(xt,$t)=>({...flip$2(xt),options:[xt,$t]}),size=(xt,$t)=>({...size$1(xt),options:[xt,$t]}),inline=(xt,$t)=>({...inline$1(xt),options:[xt,$t]}),arrow=(xt,$t)=>({...arrow$1(xt),options:[xt,$t]}),SafeReact={...ReactOriginal},useInsertionEffect=SafeReact.useInsertionEffect,useSafeInsertionEffect=useInsertionEffect||(xt=>xt());function useEffectEvent(xt){const $t=reactExports.useRef(()=>{});return useSafeInsertionEffect(()=>{$t.current=xt}),reactExports.useCallback(function(){for(var Ct=arguments.length,kt=new Array(Ct),Mt=0;Mt<Ct;Mt++)kt[Mt]=arguments[Mt];return $t.current==null?void 0:$t.current(...kt)},[])}var index$5=typeof document<"u"?reactExports.useLayoutEffect:reactExports.useEffect;let serverHandoffComplete=!1,count$2=0;const genId=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+count$2++;function useFloatingId(){const[xt,$t]=reactExports.useState(()=>serverHandoffComplete?genId():void 0);return index$5(()=>{xt==null&&$t(genId())},[]),reactExports.useEffect(()=>{serverHandoffComplete=!0},[]),xt}const useReactId=SafeReact.useId,useId=useReactId||useFloatingId;function createPubSub(){const xt=new Map;return{emit($t,Ct){var kt;(kt=xt.get($t))==null||kt.forEach(Mt=>Mt(Ct))},on($t,Ct){xt.set($t,[...xt.get($t)||[],Ct])},off($t,Ct){var kt;xt.set($t,((kt=xt.get($t))==null?void 0:kt.filter(Mt=>Mt!==Ct))||[])}}}const FloatingNodeContext=reactExports.createContext(null),FloatingTreeContext=reactExports.createContext(null),useFloatingParentNodeId=()=>{var xt;return((xt=reactExports.useContext(FloatingNodeContext))==null?void 0:xt.id)||null},useFloatingTree=()=>reactExports.useContext(FloatingTreeContext);function createAttribute(xt){return"data-floating-ui-"+xt}function useLatestRef(xt){const $t=reactExports.useRef(xt);return index$5(()=>{$t.current=xt}),$t}const safePolygonIdentifier=createAttribute("safe-polygon");function getDelay(xt,$t,Ct){return Ct&&!isMouseLikePointerType(Ct)?0:typeof xt=="number"?xt:xt==null?void 0:xt[$t]}function useHover(xt,$t){$t===void 0&&($t={});const{open:Ct,onOpenChange:kt,dataRef:Mt,events:Ft,elements:{domReference:jt,floating:Bt}}=xt,{enabled:Vt=!0,delay:zt=0,handleClose:Ht=null,mouseOnly:Gt=!1,restMs:qt=0,move:Wt=!0}=$t,Yt=useFloatingTree(),Kt=useFloatingParentNodeId(),Xt=useLatestRef(Ht),Qt=useLatestRef(zt),Jt=reactExports.useRef(),Zt=reactExports.useRef(-1),sn=reactExports.useRef(),ln=reactExports.useRef(-1),dn=reactExports.useRef(!0),hn=reactExports.useRef(!1),cn=reactExports.useRef(()=>{}),pn=reactExports.useCallback(()=>{var bn;const xn=(bn=Mt.current.openEvent)==null?void 0:bn.type;return(xn==null?void 0:xn.includes("mouse"))&&xn!=="mousedown"},[Mt]);reactExports.useEffect(()=>{if(!Vt)return;function bn(xn){let{open:Cn}=xn;Cn||(clearTimeout(Zt.current),clearTimeout(ln.current),dn.current=!0)}return Ft.on("openchange",bn),()=>{Ft.off("openchange",bn)}},[Vt,Ft]),reactExports.useEffect(()=>{if(!Vt||!Xt.current||!Ct)return;function bn(Cn){pn()&&kt(!1,Cn,"hover")}const xn=getDocument$1(Bt).documentElement;return xn.addEventListener("mouseleave",bn),()=>{xn.removeEventListener("mouseleave",bn)}},[Bt,Ct,kt,Vt,Xt,pn]);const yn=reactExports.useCallback(function(bn,xn,Cn){xn===void 0&&(xn=!0),Cn===void 0&&(Cn="hover");const $n=getDelay(Qt.current,"close",Jt.current);$n&&!sn.current?(clearTimeout(Zt.current),Zt.current=window.setTimeout(()=>kt(!1,bn,Cn),$n)):xn&&(clearTimeout(Zt.current),kt(!1,bn,Cn))},[Qt,kt]),gn=useEffectEvent(()=>{cn.current(),sn.current=void 0}),En=useEffectEvent(()=>{if(hn.current){const bn=getDocument$1(Bt).body;bn.style.pointerEvents="",bn.removeAttribute(safePolygonIdentifier),hn.current=!1}});return reactExports.useEffect(()=>{if(!Vt)return;function bn(){return Mt.current.openEvent?["click","mousedown"].includes(Mt.current.openEvent.type):!1}function xn(wn){if(clearTimeout(Zt.current),dn.current=!1,Gt&&!isMouseLikePointerType(Jt.current)||qt>0&&!getDelay(Qt.current,"open"))return;const Rn=getDelay(Qt.current,"open",Jt.current);Rn?Zt.current=window.setTimeout(()=>{kt(!0,wn,"hover")},Rn):kt(!0,wn,"hover")}function Cn(wn){if(bn())return;cn.current();const Rn=getDocument$1(Bt);if(clearTimeout(ln.current),Xt.current&&Mt.current.floatingContext){Ct||clearTimeout(Zt.current),sn.current=Xt.current({...Mt.current.floatingContext,tree:Yt,x:wn.clientX,y:wn.clientY,onClose(){En(),gn(),yn(wn,!0,"safe-polygon")}});const An=sn.current;Rn.addEventListener("mousemove",An),cn.current=()=>{Rn.removeEventListener("mousemove",An)};return}(Jt.current==="touch"?!contains$3(Bt,wn.relatedTarget):!0)&&yn(wn)}function $n(wn){bn()||Mt.current.floatingContext&&(Xt.current==null||Xt.current({...Mt.current.floatingContext,tree:Yt,x:wn.clientX,y:wn.clientY,onClose(){En(),gn(),yn(wn)}})(wn))}if(isElement(jt)){const wn=jt;return Ct&&wn.addEventListener("mouseleave",$n),Bt==null||Bt.addEventListener("mouseleave",$n),Wt&&wn.addEventListener("mousemove",xn,{once:!0}),wn.addEventListener("mouseenter",xn),wn.addEventListener("mouseleave",Cn),()=>{Ct&&wn.removeEventListener("mouseleave",$n),Bt==null||Bt.removeEventListener("mouseleave",$n),Wt&&wn.removeEventListener("mousemove",xn),wn.removeEventListener("mouseenter",xn),wn.removeEventListener("mouseleave",Cn)}}},[jt,Bt,Vt,xt,Gt,qt,Wt,yn,gn,En,kt,Ct,Yt,Qt,Xt,Mt]),index$5(()=>{var bn;if(Vt&&Ct&&(bn=Xt.current)!=null&&bn.__options.blockPointerEvents&&pn()){const Cn=getDocument$1(Bt).body;if(Cn.setAttribute(safePolygonIdentifier,""),Cn.style.pointerEvents="none",hn.current=!0,isElement(jt)&&Bt){var xn;const $n=jt,wn=Yt==null||(xn=Yt.nodesRef.current.find(Rn=>Rn.id===Kt))==null||(xn=xn.context)==null?void 0:xn.elements.floating;return wn&&(wn.style.pointerEvents=""),$n.style.pointerEvents="auto",Bt.style.pointerEvents="auto",()=>{$n.style.pointerEvents="",Bt.style.pointerEvents=""}}}},[Vt,Ct,Kt,Bt,jt,Yt,Xt,pn]),index$5(()=>{Ct||(Jt.current=void 0,gn(),En())},[Ct,gn,En]),reactExports.useEffect(()=>()=>{gn(),clearTimeout(Zt.current),clearTimeout(ln.current),En()},[Vt,jt,gn,En]),reactExports.useMemo(()=>{if(!Vt)return{};function bn(xn){Jt.current=xn.pointerType}return{reference:{onPointerDown:bn,onPointerEnter:bn,onMouseMove(xn){function Cn(){dn.current||kt(!0,xn.nativeEvent,"hover")}Gt&&!isMouseLikePointerType(Jt.current)||Ct||qt===0||(clearTimeout(ln.current),Jt.current==="touch"?Cn():ln.current=window.setTimeout(Cn,qt))}},floating:{onMouseEnter(){clearTimeout(Zt.current)},onMouseLeave(xn){yn(xn.nativeEvent,!1)}}}},[Vt,Gt,Ct,qt,kt,yn])}const NOOP$1=()=>{},FloatingDelayGroupContext=reactExports.createContext({delay:0,initialDelay:0,timeoutMs:0,currentId:null,setCurrentId:NOOP$1,setState:NOOP$1,isInstantPhase:!1}),useDelayGroupContext=()=>reactExports.useContext(FloatingDelayGroupContext);function FloatingDelayGroup(xt){const{children:$t,delay:Ct,timeoutMs:kt=0}=xt,[Mt,Ft]=reactExports.useReducer((Vt,zt)=>({...Vt,...zt}),{delay:Ct,timeoutMs:kt,initialDelay:Ct,currentId:null,isInstantPhase:!1}),jt=reactExports.useRef(null),Bt=reactExports.useCallback(Vt=>{Ft({currentId:Vt})},[]);return index$5(()=>{Mt.currentId?jt.current===null?jt.current=Mt.currentId:Mt.isInstantPhase||Ft({isInstantPhase:!0}):(Mt.isInstantPhase&&Ft({isInstantPhase:!1}),jt.current=null)},[Mt.currentId,Mt.isInstantPhase]),reactExports.createElement(FloatingDelayGroupContext.Provider,{value:reactExports.useMemo(()=>({...Mt,setState:Ft,setCurrentId:Bt}),[Mt,Bt])},$t)}function useDelayGroup(xt,$t){$t===void 0&&($t={});const{open:Ct,onOpenChange:kt,floatingId:Mt}=xt,{id:Ft}=$t,jt=Ft??Mt,Bt=useDelayGroupContext(),{currentId:Vt,setCurrentId:zt,initialDelay:Ht,setState:Gt,timeoutMs:qt}=Bt;return index$5(()=>{Vt&&(Gt({delay:{open:1,close:getDelay(Ht,"close")}}),Vt!==jt&&kt(!1))},[jt,kt,Gt,Vt,Ht]),index$5(()=>{function Wt(){kt(!1),Gt({delay:Ht,currentId:null})}if(Vt&&!Ct&&Vt===jt){if(qt){const Yt=window.setTimeout(Wt,qt);return()=>{clearTimeout(Yt)}}Wt()}},[Ct,Gt,Vt,jt,kt,Ht,qt]),index$5(()=>{zt===NOOP$1||!Ct||zt(jt)},[Ct,zt,jt]),Bt}function getChildren(xt,$t){let Ct=xt.filter(Mt=>{var Ft;return Mt.parentId===$t&&((Ft=Mt.context)==null?void 0:Ft.open)}),kt=Ct;for(;kt.length;)kt=xt.filter(Mt=>{var Ft;return(Ft=kt)==null?void 0:Ft.some(jt=>{var Bt;return Mt.parentId===jt.id&&((Bt=Mt.context)==null?void 0:Bt.open)})}),Ct=Ct.concat(kt);return Ct}const bubbleHandlerKeys={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},captureHandlerKeys={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},normalizeProp=xt=>{var $t,Ct;return{escapeKey:typeof xt=="boolean"?xt:($t=xt==null?void 0:xt.escapeKey)!=null?$t:!1,outsidePress:typeof xt=="boolean"?xt:(Ct=xt==null?void 0:xt.outsidePress)!=null?Ct:!0}};function useDismiss(xt,$t){$t===void 0&&($t={});const{open:Ct,onOpenChange:kt,elements:{reference:Mt,domReference:Ft,floating:jt},dataRef:Bt}=xt,{enabled:Vt=!0,escapeKey:zt=!0,outsidePress:Ht=!0,outsidePressEvent:Gt="pointerdown",referencePress:qt=!1,referencePressEvent:Wt="pointerdown",ancestorScroll:Yt=!1,bubbles:Kt,capture:Xt}=$t,Qt=useFloatingTree(),Jt=useEffectEvent(typeof Ht=="function"?Ht:()=>!1),Zt=typeof Ht=="function"?Jt:Ht,sn=reactExports.useRef(!1),ln=reactExports.useRef(!1),{escapeKey:dn,outsidePress:hn}=normalizeProp(Kt),{escapeKey:cn,outsidePress:pn}=normalizeProp(Xt),yn=useEffectEvent(xn=>{var Cn;if(!Ct||!Vt||!zt||xn.key!=="Escape")return;const $n=(Cn=Bt.current.floatingContext)==null?void 0:Cn.nodeId,wn=Qt?getChildren(Qt.nodesRef.current,$n):[];if(!dn&&(xn.stopPropagation(),wn.length>0)){let Rn=!0;if(wn.forEach(Dn=>{var An;if((An=Dn.context)!=null&&An.open&&!Dn.context.dataRef.current.__escapeKeyBubbles){Rn=!1;return}}),!Rn)return}kt(!1,isReactEvent(xn)?xn.nativeEvent:xn,"escape-key")}),gn=useEffectEvent(xn=>{var Cn;const $n=()=>{var wn;yn(xn),(wn=getTarget(xn))==null||wn.removeEventListener("keydown",$n)};(Cn=getTarget(xn))==null||Cn.addEventListener("keydown",$n)}),En=useEffectEvent(xn=>{var Cn;const $n=sn.current;sn.current=!1;const wn=ln.current;if(ln.current=!1,Gt==="click"&&wn||$n||typeof Zt=="function"&&!Zt(xn))return;const Rn=getTarget(xn),Dn="["+createAttribute("inert")+"]",An=getDocument$1(jt).querySelectorAll(Dn);let Sn=isElement(Rn)?Rn:null;for(;Sn&&!isLastTraversableNode(Sn);){const Pn=getParentNode(Sn);if(isLastTraversableNode(Pn)||!isElement(Pn))break;Sn=Pn}if(An.length&&isElement(Rn)&&!isRootElement(Rn)&&!contains$3(Rn,jt)&&Array.from(An).every(Pn=>!contains$3(Sn,Pn)))return;if(isHTMLElement(Rn)&&jt){const Pn=Rn.clientWidth>0&&Rn.scrollWidth>Rn.clientWidth,Ln=Rn.clientHeight>0&&Rn.scrollHeight>Rn.clientHeight;let Vn=Ln&&xn.offsetX>Rn.clientWidth;if(Ln&&getComputedStyle$1(Rn).direction==="rtl"&&(Vn=xn.offsetX<=Rn.offsetWidth-Rn.clientWidth),Vn||Pn&&xn.offsetY>Rn.clientHeight)return}const vn=(Cn=Bt.current.floatingContext)==null?void 0:Cn.nodeId,_n=Qt&&getChildren(Qt.nodesRef.current,vn).some(Pn=>{var Ln;return isEventTargetWithin(xn,(Ln=Pn.context)==null?void 0:Ln.elements.floating)});if(isEventTargetWithin(xn,jt)||isEventTargetWithin(xn,Ft)||_n)return;const Tn=Qt?getChildren(Qt.nodesRef.current,vn):[];if(Tn.length>0){let Pn=!0;if(Tn.forEach(Ln=>{var Vn;if((Vn=Ln.context)!=null&&Vn.open&&!Ln.context.dataRef.current.__outsidePressBubbles){Pn=!1;return}}),!Pn)return}kt(!1,xn,"outside-press")}),bn=useEffectEvent(xn=>{var Cn;const $n=()=>{var wn;En(xn),(wn=getTarget(xn))==null||wn.removeEventListener(Gt,$n)};(Cn=getTarget(xn))==null||Cn.addEventListener(Gt,$n)});return reactExports.useEffect(()=>{if(!Ct||!Vt)return;Bt.current.__escapeKeyBubbles=dn,Bt.current.__outsidePressBubbles=hn;function xn(wn){kt(!1,wn,"ancestor-scroll")}const Cn=getDocument$1(jt);zt&&Cn.addEventListener("keydown",cn?gn:yn,cn),Zt&&Cn.addEventListener(Gt,pn?bn:En,pn);let $n=[];return Yt&&(isElement(Ft)&&($n=getOverflowAncestors(Ft)),isElement(jt)&&($n=$n.concat(getOverflowAncestors(jt))),!isElement(Mt)&&Mt&&Mt.contextElement&&($n=$n.concat(getOverflowAncestors(Mt.contextElement)))),$n=$n.filter(wn=>{var Rn;return wn!==((Rn=Cn.defaultView)==null?void 0:Rn.visualViewport)}),$n.forEach(wn=>{wn.addEventListener("scroll",xn,{passive:!0})}),()=>{zt&&Cn.removeEventListener("keydown",cn?gn:yn,cn),Zt&&Cn.removeEventListener(Gt,pn?bn:En,pn),$n.forEach(wn=>{wn.removeEventListener("scroll",xn)})}},[Bt,jt,Ft,Mt,zt,Zt,Gt,Ct,kt,Yt,Vt,dn,hn,yn,cn,gn,En,pn,bn]),reactExports.useEffect(()=>{sn.current=!1},[Zt,Gt]),reactExports.useMemo(()=>Vt?{reference:{onKeyDown:yn,[bubbleHandlerKeys[Wt]]:xn=>{qt&&kt(!1,xn.nativeEvent,"reference-press")}},floating:{onKeyDown:yn,onMouseDown(){ln.current=!0},onMouseUp(){ln.current=!0},[captureHandlerKeys[Gt]]:()=>{sn.current=!0}}}:{},[Vt,qt,Gt,Wt,kt,yn])}function useFloatingRootContext(xt){const{open:$t=!1,onOpenChange:Ct,elements:kt}=xt,Mt=useId(),Ft=reactExports.useRef({}),[jt]=reactExports.useState(()=>createPubSub()),Bt=useFloatingParentNodeId()!=null,[Vt,zt]=reactExports.useState(kt.reference),Ht=useEffectEvent((Wt,Yt,Kt)=>{Ft.current.openEvent=Wt?Yt:void 0,jt.emit("openchange",{open:Wt,event:Yt,reason:Kt,nested:Bt}),Ct==null||Ct(Wt,Yt,Kt)}),Gt=reactExports.useMemo(()=>({setPositionReference:zt}),[]),qt=reactExports.useMemo(()=>({reference:Vt||kt.reference||null,floating:kt.floating||null,domReference:kt.reference}),[Vt,kt.reference,kt.floating]);return reactExports.useMemo(()=>({dataRef:Ft,open:$t,onOpenChange:Ht,elements:qt,events:jt,floatingId:Mt,refs:Gt}),[$t,Ht,qt,jt,Mt,Gt])}function useFloating(xt){xt===void 0&&(xt={});const{nodeId:$t}=xt,Ct=useFloatingRootContext({...xt,elements:{reference:null,floating:null,...xt.elements}}),kt=xt.rootContext||Ct,Mt=kt.elements,[Ft,jt]=reactExports.useState(null),[Bt,Vt]=reactExports.useState(null),Ht=(Mt==null?void 0:Mt.reference)||Ft,Gt=reactExports.useRef(null),qt=useFloatingTree();index$5(()=>{Ht&&(Gt.current=Ht)},[Ht]);const Wt=useFloating$1({...xt,elements:{...Mt,...Bt&&{reference:Bt}}}),Yt=reactExports.useCallback(Zt=>{const sn=isElement(Zt)?{getBoundingClientRect:()=>Zt.getBoundingClientRect(),contextElement:Zt}:Zt;Vt(sn),Wt.refs.setReference(sn)},[Wt.refs]),Kt=reactExports.useCallback(Zt=>{(isElement(Zt)||Zt===null)&&(Gt.current=Zt,jt(Zt)),(isElement(Wt.refs.reference.current)||Wt.refs.reference.current===null||Zt!==null&&!isElement(Zt))&&Wt.refs.setReference(Zt)},[Wt.refs]),Xt=reactExports.useMemo(()=>({...Wt.refs,setReference:Kt,setPositionReference:Yt,domReference:Gt}),[Wt.refs,Kt,Yt]),Qt=reactExports.useMemo(()=>({...Wt.elements,domReference:Ht}),[Wt.elements,Ht]),Jt=reactExports.useMemo(()=>({...Wt,...kt,refs:Xt,elements:Qt,nodeId:$t}),[Wt,Xt,Qt,$t,kt]);return index$5(()=>{kt.dataRef.current.floatingContext=Jt;const Zt=qt==null?void 0:qt.nodesRef.current.find(sn=>sn.id===$t);Zt&&(Zt.context=Jt)}),reactExports.useMemo(()=>({...Wt,context:Jt,refs:Xt,elements:Qt}),[Wt,Xt,Qt,Jt])}function useFocus(xt,$t){$t===void 0&&($t={});const{open:Ct,onOpenChange:kt,events:Mt,dataRef:Ft,elements:{domReference:jt}}=xt,{enabled:Bt=!0,visibleOnly:Vt=!0}=$t,zt=reactExports.useRef(!1),Ht=reactExports.useRef(),Gt=reactExports.useRef(!0);return reactExports.useEffect(()=>{if(!Bt)return;const qt=getWindow$1(jt);function Wt(){!Ct&&isHTMLElement(jt)&&jt===activeElement(getDocument$1(jt))&&(zt.current=!0)}function Yt(){Gt.current=!0}return qt.addEventListener("blur",Wt),qt.addEventListener("keydown",Yt,!0),()=>{qt.removeEventListener("blur",Wt),qt.removeEventListener("keydown",Yt,!0)}},[jt,Ct,Bt]),reactExports.useEffect(()=>{if(!Bt)return;function qt(Wt){let{reason:Yt}=Wt;(Yt==="reference-press"||Yt==="escape-key")&&(zt.current=!0)}return Mt.on("openchange",qt),()=>{Mt.off("openchange",qt)}},[Mt,Bt]),reactExports.useEffect(()=>()=>{clearTimeout(Ht.current)},[]),reactExports.useMemo(()=>Bt?{reference:{onPointerDown(qt){isVirtualPointerEvent(qt.nativeEvent)||(Gt.current=!1)},onMouseLeave(){zt.current=!1},onFocus(qt){if(zt.current)return;const Wt=getTarget(qt.nativeEvent);if(Vt&&isElement(Wt))try{if(isSafari$1()&&isMac())throw Error();if(!Wt.matches(":focus-visible"))return}catch{if(!Gt.current&&!isTypeableElement(Wt))return}kt(!0,qt.nativeEvent,"focus")},onBlur(qt){zt.current=!1;const Wt=qt.relatedTarget,Yt=isElement(Wt)&&Wt.hasAttribute(createAttribute("focus-guard"))&&Wt.getAttribute("data-type")==="outside";Ht.current=window.setTimeout(()=>{var Kt;const Xt=activeElement(jt?jt.ownerDocument:document);!Wt&&Xt===jt||contains$3((Kt=Ft.current.floatingContext)==null?void 0:Kt.refs.floating.current,Xt)||contains$3(jt,Xt)||Yt||kt(!1,qt.nativeEvent,"focus")})}}}:{},[Bt,Vt,Ft,jt,kt])}const ACTIVE_KEY="active",SELECTED_KEY="selected";function mergeProps(xt,$t,Ct){const kt=new Map,Mt=Ct==="item";let Ft=xt;if(Mt&&xt){const{[ACTIVE_KEY]:jt,[SELECTED_KEY]:Bt,...Vt}=xt;Ft=Vt}return{...Ct==="floating"&&{tabIndex:-1},...Ft,...$t.map(jt=>{const Bt=jt?jt[Ct]:null;return typeof Bt=="function"?xt?Bt(xt):null:Bt}).concat(xt).reduce((jt,Bt)=>(Bt&&Object.entries(Bt).forEach(Vt=>{let[zt,Ht]=Vt;if(!(Mt&&[ACTIVE_KEY,SELECTED_KEY].includes(zt)))if(zt.indexOf("on")===0){if(kt.has(zt)||kt.set(zt,[]),typeof Ht=="function"){var Gt;(Gt=kt.get(zt))==null||Gt.push(Ht),jt[zt]=function(){for(var qt,Wt=arguments.length,Yt=new Array(Wt),Kt=0;Kt<Wt;Kt++)Yt[Kt]=arguments[Kt];return(qt=kt.get(zt))==null?void 0:qt.map(Xt=>Xt(...Yt)).find(Xt=>Xt!==void 0)}}}else jt[zt]=Ht}),jt),{})}}function useInteractions(xt){xt===void 0&&(xt=[]);const $t=xt,Ct=reactExports.useCallback(Ft=>mergeProps(Ft,xt,"reference"),$t),kt=reactExports.useCallback(Ft=>mergeProps(Ft,xt,"floating"),$t),Mt=reactExports.useCallback(Ft=>mergeProps(Ft,xt,"item"),xt.map(Ft=>Ft==null?void 0:Ft.item));return reactExports.useMemo(()=>({getReferenceProps:Ct,getFloatingProps:kt,getItemProps:Mt}),[Ct,kt,Mt])}const componentRoleToAriaRoleMap=new Map([["select","listbox"],["combobox","listbox"],["label",!1]]);function useRole(xt,$t){var Ct;$t===void 0&&($t={});const{open:kt,floatingId:Mt}=xt,{enabled:Ft=!0,role:jt="dialog"}=$t,Bt=(Ct=componentRoleToAriaRoleMap.get(jt))!=null?Ct:jt,Vt=useId(),Ht=useFloatingParentNodeId()!=null;return reactExports.useMemo(()=>{if(!Ft)return{};const Gt={id:Mt,...Bt&&{role:Bt}};return Bt==="tooltip"||jt==="label"?{reference:{["aria-"+(jt==="label"?"labelledby":"describedby")]:kt?Mt:void 0},floating:Gt}:{reference:{"aria-expanded":kt?"true":"false","aria-haspopup":Bt==="alertdialog"?"dialog":Bt,"aria-controls":kt?Mt:void 0,...Bt==="listbox"&&{role:"combobox"},...Bt==="menu"&&{id:Vt},...Bt==="menu"&&Ht&&{role:"menuitem"},...jt==="select"&&{"aria-autocomplete":"none"},...jt==="combobox"&&{"aria-autocomplete":"list"}},floating:{...Gt,...Bt==="menu"&&{"aria-labelledby":Vt}},item(qt){let{active:Wt,selected:Yt}=qt;const Kt={role:"option",...Wt&&{id:Mt+"-option"}};switch(jt){case"select":return{...Kt,"aria-selected":Wt&&Yt};case"combobox":return{...Kt,...Wt&&{"aria-selected":!0}}}return{}}}},[Ft,jt,Bt,kt,Mt,Vt,Ht])}function getFloatingPosition(xt,$t){if(xt==="rtl"&&($t.includes("right")||$t.includes("left"))){const[Ct,kt]=$t.split("-"),Mt=Ct==="right"?"left":"right";return kt===void 0?Mt:`${Mt}-${kt}`}return $t}function horizontalSide(xt,$t,Ct,kt){return xt==="center"||kt==="center"?{top:$t}:xt==="end"?{bottom:Ct}:xt==="start"?{top:Ct}:{}}function verticalSide(xt,$t,Ct,kt,Mt){return xt==="center"||kt==="center"?{left:$t}:xt==="end"?{[Mt==="ltr"?"right":"left"]:Ct}:xt==="start"?{[Mt==="ltr"?"left":"right"]:Ct}:{}}const radiusByFloatingSide={bottom:"borderTopLeftRadius",left:"borderTopRightRadius",right:"borderBottomLeftRadius",top:"borderBottomRightRadius"};function getArrowPositionStyles({position:xt,arrowSize:$t,arrowOffset:Ct,arrowRadius:kt,arrowPosition:Mt,arrowX:Ft,arrowY:jt,dir:Bt}){const[Vt,zt="center"]=xt.split("-"),Ht={width:rem$1($t),height:rem$1($t),transform:"rotate(45deg)",position:"absolute",[radiusByFloatingSide[Vt]]:rem$1(kt)},Gt=rem$1(-$t/2);return Vt==="left"?{...Ht,...horizontalSide(zt,jt,Ct,Mt),right:Gt,borderLeftColor:"transparent",borderBottomColor:"transparent"}:Vt==="right"?{...Ht,...horizontalSide(zt,jt,Ct,Mt),left:Gt,borderRightColor:"transparent",borderTopColor:"transparent"}:Vt==="top"?{...Ht,...verticalSide(zt,Ft,Ct,Mt,Bt),bottom:Gt,borderTopColor:"transparent",borderLeftColor:"transparent"}:Vt==="bottom"?{...Ht,...verticalSide(zt,Ft,Ct,Mt,Bt),top:Gt,borderBottomColor:"transparent",borderRightColor:"transparent"}:{}}const FloatingArrow=reactExports.forwardRef(({position:xt,arrowSize:$t,arrowOffset:Ct,arrowRadius:kt,arrowPosition:Mt,visible:Ft,arrowX:jt,arrowY:Bt,style:Vt,...zt},Ht)=>{const{dir:Gt}=useDirection();return Ft?jsxRuntimeExports.jsx("div",{...zt,ref:Ht,style:{...Vt,...getArrowPositionStyles({position:xt,arrowSize:$t,arrowOffset:Ct,arrowRadius:kt,arrowPosition:Mt,dir:Gt,arrowX:jt,arrowY:Bt})}}):null});FloatingArrow.displayName="@mantine/core/FloatingArrow";const[PopoverContextProvider,usePopoverContext]=createSafeContext("Popover component was not found in the tree");function FocusTrap({children:xt,active:$t=!0,refProp:Ct="ref"}){const kt=useFocusTrap($t),Mt=useMergedRef(kt,xt==null?void 0:xt.ref);return isElement$1(xt)?reactExports.cloneElement(xt,{[Ct]:Mt}):xt}function FocusTrapInitialFocus(xt){return jsxRuntimeExports.jsx(VisuallyHidden,{tabIndex:-1,"data-autofocus":!0,...xt})}FocusTrap.displayName="@mantine/core/FocusTrap";FocusTrapInitialFocus.displayName="@mantine/core/FocusTrapInitialFocus";FocusTrap.InitialFocus=FocusTrapInitialFocus;function createPortalNode(xt){const $t=document.createElement("div");return $t.setAttribute("data-portal","true"),typeof xt.className=="string"&&$t.classList.add(...xt.className.split(" ").filter(Boolean)),typeof xt.style=="object"&&Object.assign($t.style,xt.style),typeof xt.id=="string"&&$t.setAttribute("id",xt.id),$t}const defaultProps$2c={},Portal=reactExports.forwardRef((xt,$t)=>{const{children:Ct,target:kt,...Mt}=useProps("Portal",defaultProps$2c,xt),[Ft,jt]=reactExports.useState(!1),Bt=reactExports.useRef(null);return useIsomorphicEffect$1(()=>(jt(!0),Bt.current=kt?typeof kt=="string"?document.querySelector(kt):kt:createPortalNode(Mt),assignRef($t,Bt.current),!kt&&Bt.current&&document.body.appendChild(Bt.current),()=>{!kt&&Bt.current&&document.body.removeChild(Bt.current)}),[kt]),!Ft||!Bt.current?null:reactDomExports.createPortal(jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:Ct}),Bt.current)});Portal.displayName="@mantine/core/Portal";function OptionalPortal({withinPortal:xt=!0,children:$t,...Ct}){return xt?jsxRuntimeExports.jsx(Portal,{...Ct,children:$t}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:$t})}OptionalPortal.displayName="@mantine/core/OptionalPortal";const popIn=xt=>({in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:`scale(.9) translateY(${rem$1(xt==="bottom"?10:-10)})`},transitionProperty:"transform, opacity"}),transitions$1={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},"fade-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:`translateY(${rem$1(30)}`},transitionProperty:"opacity, transform"},"fade-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:`translateY(${rem$1(-30)}`},transitionProperty:"opacity, transform"},"fade-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:`translateX(${rem$1(30)}`},transitionProperty:"opacity, transform"},"fade-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:`translateX(${rem$1(-30)}`},transitionProperty:"opacity, transform"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:`translateY(${rem$1(-20)}) skew(-10deg, -5deg)`},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:`translateY(${rem$1(20)}) skew(-10deg, -5deg)`},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:`translateY(${rem$1(20)}) rotate(-5deg)`},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:`translateY(${rem$1(20)}) rotate(5deg)`},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:{...popIn("bottom"),common:{transformOrigin:"center center"}},"pop-bottom-left":{...popIn("bottom"),common:{transformOrigin:"bottom left"}},"pop-bottom-right":{...popIn("bottom"),common:{transformOrigin:"bottom right"}},"pop-top-left":{...popIn("top"),common:{transformOrigin:"top left"}},"pop-top-right":{...popIn("top"),common:{transformOrigin:"top right"}}},transitionStatuses={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function getTransitionStyles({transition:xt,state:$t,duration:Ct,timingFunction:kt}){const Mt={transitionDuration:`${Ct}ms`,transitionTimingFunction:kt};return typeof xt=="string"?xt in transitions$1?{transitionProperty:transitions$1[xt].transitionProperty,...Mt,...transitions$1[xt].common,...transitions$1[xt][transitionStatuses[$t]]}:{}:{transitionProperty:xt.transitionProperty,...Mt,...xt.common,...xt[transitionStatuses[$t]]}}function useTransition({duration:xt,exitDuration:$t,timingFunction:Ct,mounted:kt,onEnter:Mt,onExit:Ft,onEntered:jt,onExited:Bt}){const Vt=useMantineTheme(),zt=useReducedMotion(),Ht=Vt.respectReducedMotion?zt:!1,[Gt,qt]=reactExports.useState(Ht?0:xt),[Wt,Yt]=reactExports.useState(kt?"entered":"exited"),Kt=reactExports.useRef(-1),Xt=reactExports.useRef(-1),Qt=Jt=>{const Zt=Jt?Mt:Ft,sn=Jt?jt:Bt;window.clearTimeout(Kt.current);const ln=Ht?0:Jt?xt:$t;qt(ln),ln===0?(typeof Zt=="function"&&Zt(),typeof sn=="function"&&sn(),Yt(Jt?"entered":"exited")):Xt.current=requestAnimationFrame(()=>{ReactDOM.flushSync(()=>{Yt(Jt?"pre-entering":"pre-exiting")}),Xt.current=requestAnimationFrame(()=>{typeof Zt=="function"&&Zt(),Yt(Jt?"entering":"exiting"),Kt.current=window.setTimeout(()=>{typeof sn=="function"&&sn(),Yt(Jt?"entered":"exited")},ln)})})};return useDidUpdate(()=>{Qt(kt)},[kt]),reactExports.useEffect(()=>()=>{window.clearTimeout(Kt.current),cancelAnimationFrame(Xt.current)},[]),{transitionDuration:Gt,transitionStatus:Wt,transitionTimingFunction:Ct||"ease"}}function Transition$1({keepMounted:xt,transition:$t="fade",duration:Ct=250,exitDuration:kt=Ct,mounted:Mt,children:Ft,timingFunction:jt="ease",onExit:Bt,onEntered:Vt,onEnter:zt,onExited:Ht}){const{transitionDuration:Gt,transitionStatus:qt,transitionTimingFunction:Wt}=useTransition({mounted:Mt,exitDuration:kt,duration:Ct,timingFunction:jt,onExit:Bt,onEntered:Vt,onEnter:zt,onExited:Ht});return Gt===0?Mt?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:Ft({})}):xt?Ft({display:"none"}):null:qt==="exited"?xt?Ft({display:"none"}):null:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:Ft(getTransitionStyles({transition:$t,duration:Gt,state:qt,timingFunction:Wt}))})}Transition$1.displayName="@mantine/core/Transition";var classes$X={dropdown:"m_38a85659",arrow:"m_a31dc6c1"};const defaultProps$2b={},PopoverDropdown=factory$2((xt,$t)=>{var Xt,Qt,Jt,Zt;const Ct=useProps("PopoverDropdown",defaultProps$2b,xt),{className:kt,style:Mt,vars:Ft,children:jt,onKeyDownCapture:Bt,variant:Vt,classNames:zt,styles:Ht,...Gt}=Ct,qt=usePopoverContext(),Wt=useFocusReturn({opened:qt.opened,shouldReturnFocus:qt.returnFocus}),Yt=qt.withRoles?{"aria-labelledby":qt.getTargetId(),id:qt.getDropdownId(),role:"dialog",tabIndex:-1}:{},Kt=useMergedRef($t,qt.floating);return qt.disabled?null:jsxRuntimeExports.jsx(OptionalPortal,{...qt.portalProps,withinPortal:qt.withinPortal,children:jsxRuntimeExports.jsx(Transition$1,{mounted:qt.opened,...qt.transitionProps,transition:((Xt=qt.transitionProps)==null?void 0:Xt.transition)||"fade",duration:((Qt=qt.transitionProps)==null?void 0:Qt.duration)??150,keepMounted:qt.keepMounted,exitDuration:typeof((Jt=qt.transitionProps)==null?void 0:Jt.exitDuration)=="number"?qt.transitionProps.exitDuration:(Zt=qt.transitionProps)==null?void 0:Zt.duration,children:sn=>jsxRuntimeExports.jsx(FocusTrap,{active:qt.trapFocus,children:jsxRuntimeExports.jsxs(Box,{...Yt,...Gt,variant:Vt,ref:Kt,onKeyDownCapture:closeOnEscape(qt.onClose,{active:qt.closeOnEscape,onTrigger:Wt,onKeyDown:Bt}),"data-position":qt.placement,...qt.getStyles("dropdown",{className:kt,props:Ct,classNames:zt,styles:Ht,style:[{...sn,zIndex:qt.zIndex,top:qt.y??0,left:qt.x??0,width:qt.width==="target"?void 0:rem$1(qt.width)},Mt]}),children:[jt,jsxRuntimeExports.jsx(FloatingArrow,{ref:qt.arrowRef,arrowX:qt.arrowX,arrowY:qt.arrowY,visible:qt.withArrow,position:qt.placement,arrowSize:qt.arrowSize,arrowRadius:qt.arrowRadius,arrowOffset:qt.arrowOffset,arrowPosition:qt.arrowPosition,...qt.getStyles("arrow",{props:Ct,classNames:zt,styles:Ht})})]})})})})});PopoverDropdown.classes=classes$X;PopoverDropdown.displayName="@mantine/core/PopoverDropdown";const defaultProps$2a={refProp:"ref",popupType:"dialog"},PopoverTarget=factory$2((xt,$t)=>{const{children:Ct,refProp:kt,popupType:Mt,...Ft}=useProps("PopoverTarget",defaultProps$2a,xt);if(!isElement$1(Ct))throw new Error("Popover.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const jt=Ft,Bt=usePopoverContext(),Vt=useMergedRef(Bt.reference,Ct.ref,$t),zt=Bt.withRoles?{"aria-haspopup":Mt,"aria-expanded":Bt.opened,"aria-controls":Bt.getDropdownId(),id:Bt.getTargetId()}:{};return reactExports.cloneElement(Ct,{...jt,...zt,...Bt.targetProps,className:clsx(Bt.targetProps.className,jt.className,Ct.props.className),[kt]:Vt,...Bt.controlled?null:{onClick:Bt.onToggle}})});PopoverTarget.displayName="@mantine/core/PopoverTarget";function useFloatingAutoUpdate({opened:xt,floating:$t,position:Ct,positionDependencies:kt}){const[Mt,Ft]=reactExports.useState(0);reactExports.useEffect(()=>{if($t.refs.reference.current&&$t.refs.floating.current)return autoUpdate($t.refs.reference.current,$t.refs.floating.current,$t.update)},[$t.refs.reference.current,$t.refs.floating.current,xt,Mt,Ct]),useDidUpdate(()=>{$t.update()},kt),useDidUpdate(()=>{Ft(jt=>jt+1)},[xt])}function getDefaultMiddlewares(xt){if(xt===void 0)return{shift:!0,flip:!0};const $t={...xt};return xt.shift===void 0&&($t.shift=!0),xt.flip===void 0&&($t.flip=!0),$t}function getPopoverMiddlewares(xt,$t){const Ct=getDefaultMiddlewares(xt.middlewares),kt=[offset$4(xt.offset)];return Ct.shift&&kt.push(shift(typeof Ct.shift=="boolean"?{limiter:limitShift(),padding:5}:{limiter:limitShift(),padding:5,...Ct.shift})),Ct.flip&&kt.push(typeof Ct.flip=="boolean"?flip$1():flip$1(Ct.flip)),Ct.inline&&kt.push(typeof Ct.inline=="boolean"?inline():inline(Ct.inline)),kt.push(arrow({element:xt.arrowRef,padding:xt.arrowOffset})),(Ct.size||xt.width==="target")&&kt.push(size({...typeof Ct.size=="boolean"?{}:Ct.size,apply({rects:Mt,availableWidth:Ft,availableHeight:jt}){var zt;const Vt=((zt=$t().refs.floating.current)==null?void 0:zt.style)??{};Ct.size&&Object.assign(Vt,{maxWidth:`${Ft}px`,maxHeight:`${jt}px`}),xt.width==="target"&&Object.assign(Vt,{width:`${Mt.reference.width}px`})}})),kt}function usePopover(xt){const[$t,Ct]=useUncontrolled({value:xt.opened,defaultValue:xt.defaultOpened,finalValue:!1,onChange:xt.onChange}),kt=()=>{var jt;$t&&((jt=xt.onClose)==null||jt.call(xt),Ct(!1))},Mt=()=>{var jt,Bt;$t?((jt=xt.onClose)==null||jt.call(xt),Ct(!1)):((Bt=xt.onOpen)==null||Bt.call(xt),Ct(!0))},Ft=useFloating({strategy:xt.strategy,placement:xt.position,middleware:getPopoverMiddlewares(xt,()=>Ft)});return useFloatingAutoUpdate({opened:xt.opened,position:xt.position,positionDependencies:xt.positionDependencies||[],floating:Ft}),useDidUpdate(()=>{var jt;(jt=xt.onPositionChange)==null||jt.call(xt,Ft.placement)},[Ft.placement]),useDidUpdate(()=>{var jt,Bt;xt.opened?(Bt=xt.onOpen)==null||Bt.call(xt):(jt=xt.onClose)==null||jt.call(xt)},[xt.opened]),{floating:Ft,controlled:typeof xt.opened=="boolean",opened:$t,onClose:kt,onToggle:Mt}}const defaultProps$29={position:"bottom",offset:8,positionDependencies:[],transitionProps:{transition:"fade",duration:150},middlewares:{flip:!0,shift:!0,inline:!1},arrowSize:7,arrowOffset:5,arrowRadius:0,arrowPosition:"side",closeOnClickOutside:!0,withinPortal:!0,closeOnEscape:!0,trapFocus:!1,withRoles:!0,returnFocus:!1,clickOutsideEvents:["mousedown","touchstart"],zIndex:getDefaultZIndex("popover"),__staticSelector:"Popover",width:"max-content"},varsResolver$W=(xt,{radius:$t,shadow:Ct})=>({dropdown:{"--popover-radius":$t===void 0?void 0:getRadius($t),"--popover-shadow":getShadow(Ct)}});function Popover(xt){var Bn,jn,sr,Ar,Fr,Rr;const $t=useProps("Popover",defaultProps$29,xt),{children:Ct,position:kt,offset:Mt,onPositionChange:Ft,positionDependencies:jt,opened:Bt,transitionProps:Vt,width:zt,middlewares:Ht,withArrow:Gt,arrowSize:qt,arrowOffset:Wt,arrowRadius:Yt,arrowPosition:Kt,unstyled:Xt,classNames:Qt,styles:Jt,closeOnClickOutside:Zt,withinPortal:sn,portalProps:ln,closeOnEscape:dn,clickOutsideEvents:hn,trapFocus:cn,onClose:pn,onOpen:yn,onChange:gn,zIndex:En,radius:bn,shadow:xn,id:Cn,defaultOpened:$n,__staticSelector:wn,withRoles:Rn,disabled:Dn,returnFocus:An,variant:Sn,keepMounted:vn,vars:_n,floatingStrategy:Tn,...Pn}=$t,Ln=useStyles({name:wn,props:$t,classes:classes$X,classNames:Qt,styles:Jt,unstyled:Xt,rootSelector:"dropdown",vars:_n,varsResolver:varsResolver$W}),Vn=reactExports.useRef(null),[Un,Wn]=reactExports.useState(null),[rr,ar]=reactExports.useState(null),{dir:nr}=useDirection(),mr=useId$1(Cn),kn=usePopover({middlewares:Ht,width:zt,position:getFloatingPosition(nr,kt),offset:typeof Mt=="number"?Mt+(Gt?qt/2:0):Mt,arrowRef:Vn,arrowOffset:Wt,onPositionChange:Ft,positionDependencies:jt,opened:Bt,defaultOpened:$n,onChange:gn,onOpen:yn,onClose:pn,strategy:Tn});useClickOutside(()=>Zt&&kn.onClose(),hn,[Un,rr]);const Fn=reactExports.useCallback(Qn=>{Wn(Qn),kn.floating.refs.setReference(Qn)},[kn.floating.refs.setReference]),Hn=reactExports.useCallback(Qn=>{ar(Qn),kn.floating.refs.setFloating(Qn)},[kn.floating.refs.setFloating]);return jsxRuntimeExports.jsx(PopoverContextProvider,{value:{returnFocus:An,disabled:Dn,controlled:kn.controlled,reference:Fn,floating:Hn,x:kn.floating.x,y:kn.floating.y,arrowX:(sr=(jn=(Bn=kn.floating)==null?void 0:Bn.middlewareData)==null?void 0:jn.arrow)==null?void 0:sr.x,arrowY:(Rr=(Fr=(Ar=kn.floating)==null?void 0:Ar.middlewareData)==null?void 0:Fr.arrow)==null?void 0:Rr.y,opened:kn.opened,arrowRef:Vn,transitionProps:Vt,width:zt,withArrow:Gt,arrowSize:qt,arrowOffset:Wt,arrowRadius:Yt,arrowPosition:Kt,placement:kn.floating.placement,trapFocus:cn,withinPortal:sn,portalProps:ln,zIndex:En,radius:bn,shadow:xn,closeOnEscape:dn,onClose:kn.onClose,onToggle:kn.onToggle,getTargetId:()=>`${mr}-target`,getDropdownId:()=>`${mr}-dropdown`,withRoles:Rn,targetProps:Pn,__staticSelector:wn,classNames:Qt,styles:Jt,unstyled:Xt,variant:Sn,keepMounted:vn,getStyles:Ln},children:Ct})}Popover.Target=PopoverTarget;Popover.Dropdown=PopoverDropdown;Popover.displayName="@mantine/core/Popover";Popover.extend=xt=>xt;var classes$W={root:"m_5ae2e3c",barsLoader:"m_7a2bd4cd",bar:"m_870bb79","bars-loader-animation":"m_5d2b3b9d",dotsLoader:"m_4e3f22d7",dot:"m_870c4af","loader-dots-animation":"m_aac34a1",ovalLoader:"m_b34414df","oval-loader-animation":"m_f8e89c4b"};const Bars$1=reactExports.forwardRef(({className:xt,...$t},Ct)=>jsxRuntimeExports.jsxs(Box,{component:"span",className:clsx(classes$W.barsLoader,xt),...$t,ref:Ct,children:[jsxRuntimeExports.jsx("span",{className:classes$W.bar}),jsxRuntimeExports.jsx("span",{className:classes$W.bar}),jsxRuntimeExports.jsx("span",{className:classes$W.bar})]})),Dots=reactExports.forwardRef(({className:xt,...$t},Ct)=>jsxRuntimeExports.jsxs(Box,{component:"span",className:clsx(classes$W.dotsLoader,xt),...$t,ref:Ct,children:[jsxRuntimeExports.jsx("span",{className:classes$W.dot}),jsxRuntimeExports.jsx("span",{className:classes$W.dot}),jsxRuntimeExports.jsx("span",{className:classes$W.dot})]})),Oval=reactExports.forwardRef(({className:xt,...$t},Ct)=>jsxRuntimeExports.jsx(Box,{component:"span",className:clsx(classes$W.ovalLoader,xt),...$t,ref:Ct})),defaultLoaders={bars:Bars$1,oval:Oval,dots:Dots},defaultProps$28={loaders:defaultLoaders,type:"oval"},varsResolver$V=(xt,{size:$t,color:Ct})=>({root:{"--loader-size":getSize($t,"loader-size"),"--loader-color":Ct?getThemeColor(Ct,xt):void 0}}),Loader=factory$2((xt,$t)=>{const Ct=useProps("Loader",defaultProps$28,xt),{size:kt,color:Mt,type:Ft,vars:jt,className:Bt,style:Vt,classNames:zt,styles:Ht,unstyled:Gt,loaders:qt,variant:Wt,children:Yt,...Kt}=Ct,Xt=useStyles({name:"Loader",props:Ct,classes:classes$W,className:Bt,style:Vt,classNames:zt,styles:Ht,unstyled:Gt,vars:jt,varsResolver:varsResolver$V});return Yt?jsxRuntimeExports.jsx(Box,{...Xt("root"),ref:$t,...Kt,children:Yt}):jsxRuntimeExports.jsx(Box,{...Xt("root"),ref:$t,component:qt[Ft],variant:Wt,size:kt,...Kt})});Loader.defaultLoaders=defaultLoaders;Loader.classes=classes$W;Loader.displayName="@mantine/core/Loader";var classes$V={root:"m_8d3f4000",icon:"m_8d3afb97",loader:"m_302b9fb1",group:"m_1a0f1b21"};const defaultProps$27={orientation:"horizontal"},varsResolver$U=(xt,{borderWidth:$t})=>({group:{"--ai-border-width":rem$1($t)}}),ActionIconGroup=factory$2((xt,$t)=>{const Ct=useProps("ActionIconGroup",defaultProps$27,xt),{className:kt,style:Mt,classNames:Ft,styles:jt,unstyled:Bt,orientation:Vt,vars:zt,borderWidth:Ht,variant:Gt,mod:qt,...Wt}=useProps("ActionIconGroup",defaultProps$27,xt),Yt=useStyles({name:"ActionIconGroup",props:Ct,classes:classes$V,className:kt,style:Mt,classNames:Ft,styles:jt,unstyled:Bt,vars:zt,varsResolver:varsResolver$U,rootSelector:"group"});return jsxRuntimeExports.jsx(Box,{...Yt("group"),ref:$t,variant:Gt,mod:[{"data-orientation":Vt},qt],role:"group",...Wt})});ActionIconGroup.classes=classes$V;ActionIconGroup.displayName="@mantine/core/ActionIconGroup";const defaultProps$26={},varsResolver$T=(xt,{size:$t,radius:Ct,variant:kt,gradient:Mt,color:Ft,autoContrast:jt})=>{const Bt=xt.variantColorResolver({color:Ft||xt.primaryColor,theme:xt,gradient:Mt,variant:kt||"filled",autoContrast:jt});return{root:{"--ai-size":getSize($t,"ai-size"),"--ai-radius":Ct===void 0?void 0:getRadius(Ct),"--ai-bg":Ft||kt?Bt.background:void 0,"--ai-hover":Ft||kt?Bt.hover:void 0,"--ai-hover-color":Ft||kt?Bt.hoverColor:void 0,"--ai-color":Bt.color,"--ai-bd":Ft||kt?Bt.border:void 0}}},ActionIcon=polymorphicFactory((xt,$t)=>{const Ct=useProps("ActionIcon",defaultProps$26,xt),{className:kt,unstyled:Mt,variant:Ft,classNames:jt,styles:Bt,style:Vt,loading:zt,loaderProps:Ht,size:Gt,color:qt,radius:Wt,__staticSelector:Yt,gradient:Kt,vars:Xt,children:Qt,disabled:Jt,"data-disabled":Zt,autoContrast:sn,mod:ln,...dn}=Ct,hn=useStyles({name:["ActionIcon",Yt],props:Ct,className:kt,style:Vt,classes:classes$V,classNames:jt,styles:Bt,unstyled:Mt,vars:Xt,varsResolver:varsResolver$T});return jsxRuntimeExports.jsxs(UnstyledButton,{...hn("root",{active:!Jt&&!zt&&!Zt}),...dn,unstyled:Mt,variant:Ft,size:Gt,disabled:Jt||zt,ref:$t,mod:[{loading:zt,disabled:Jt||Zt},ln],children:[jsxRuntimeExports.jsx(Transition$1,{mounted:!!zt,transition:"slide-down",duration:150,children:cn=>jsxRuntimeExports.jsx(Box,{component:"span",...hn("loader",{style:cn}),"aria-hidden":!0,children:jsxRuntimeExports.jsx(Loader,{color:"var(--ai-color)",size:"calc(var(--ai-size) * 0.55)",...Ht})})}),jsxRuntimeExports.jsx(Box,{component:"span",mod:{loading:zt},...hn("icon"),children:Qt})]})});ActionIcon.classes=classes$V;ActionIcon.displayName="@mantine/core/ActionIcon";ActionIcon.Group=ActionIconGroup;const CloseIcon=reactExports.forwardRef(({size:xt="var(--cb-icon-size, 70%)",style:$t,...Ct},kt)=>jsxRuntimeExports.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...$t,width:xt,height:xt},ref:kt,...Ct,children:jsxRuntimeExports.jsx("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}));CloseIcon.displayName="@mantine/core/CloseIcon";var classes$U={root:"m_86a44da5","root--subtle":"m_220c80f2"};const defaultProps$25={variant:"subtle"},varsResolver$S=(xt,{size:$t,radius:Ct,iconSize:kt})=>({root:{"--cb-size":getSize($t,"cb-size"),"--cb-radius":Ct===void 0?void 0:getRadius(Ct),"--cb-icon-size":rem$1(kt)}}),CloseButton=polymorphicFactory((xt,$t)=>{const Ct=useProps("CloseButton",defaultProps$25,xt),{iconSize:kt,children:Mt,vars:Ft,radius:jt,className:Bt,classNames:Vt,style:zt,styles:Ht,unstyled:Gt,"data-disabled":qt,disabled:Wt,variant:Yt,icon:Kt,mod:Xt,...Qt}=Ct,Jt=useStyles({name:"CloseButton",props:Ct,className:Bt,style:zt,classes:classes$U,classNames:Vt,styles:Ht,unstyled:Gt,vars:Ft,varsResolver:varsResolver$S});return jsxRuntimeExports.jsxs(UnstyledButton,{ref:$t,...Qt,unstyled:Gt,variant:Yt,disabled:Wt,mod:[{disabled:Wt||qt},Xt],...Jt("root",{variant:Yt,active:!Wt&&!qt}),children:[Kt||jsxRuntimeExports.jsx(CloseIcon,{}),Mt]})});CloseButton.classes=classes$U;CloseButton.displayName="@mantine/core/CloseButton";function filterFalsyChildren(xt){return reactExports.Children.toArray(xt).filter(Boolean)}var classes$T={root:"m_4081bf90"};const defaultProps$24={preventGrowOverflow:!0,gap:"md",align:"center",justify:"flex-start",wrap:"wrap"},varsResolver$R=(xt,{grow:$t,preventGrowOverflow:Ct,gap:kt,align:Mt,justify:Ft,wrap:jt},{childWidth:Bt})=>({root:{"--group-child-width":$t&&Ct?Bt:void 0,"--group-gap":getSpacing(kt),"--group-align":Mt,"--group-justify":Ft,"--group-wrap":jt}}),Group$1=factory$2((xt,$t)=>{const Ct=useProps("Group",defaultProps$24,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,children:Vt,gap:zt,align:Ht,justify:Gt,wrap:qt,grow:Wt,preventGrowOverflow:Yt,vars:Kt,variant:Xt,__size:Qt,mod:Jt,...Zt}=Ct,sn=filterFalsyChildren(Vt),ln=sn.length,dn=getSpacing(zt??"md"),cn={childWidth:`calc(${100/ln}% - (${dn} - ${dn} / ${ln}))`},pn=useStyles({name:"Group",props:Ct,stylesCtx:cn,className:Mt,style:Ft,classes:classes$T,classNames:kt,styles:jt,unstyled:Bt,vars:Kt,varsResolver:varsResolver$R});return jsxRuntimeExports.jsx(Box,{...pn("root"),ref:$t,variant:Xt,mod:[{grow:Wt},Jt],size:Qt,...Zt,children:sn})});Group$1.classes=classes$T;Group$1.displayName="@mantine/core/Group";var classes$S={root:"m_9814e45f"};const defaultProps$23={zIndex:getDefaultZIndex("modal")},varsResolver$Q=(xt,{gradient:$t,color:Ct,backgroundOpacity:kt,blur:Mt,radius:Ft,zIndex:jt})=>({root:{"--overlay-bg":$t||(Ct!==void 0||kt!==void 0)&&rgba$1(Ct||"#000",kt??.6)||void 0,"--overlay-filter":Mt?`blur(${rem$1(Mt)})`:void 0,"--overlay-radius":Ft===void 0?void 0:getRadius(Ft),"--overlay-z-index":jt==null?void 0:jt.toString()}}),Overlay$1=polymorphicFactory((xt,$t)=>{const Ct=useProps("Overlay",defaultProps$23,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,fixed:zt,center:Ht,children:Gt,radius:qt,zIndex:Wt,gradient:Yt,blur:Kt,color:Xt,backgroundOpacity:Qt,mod:Jt,...Zt}=Ct,sn=useStyles({name:"Overlay",props:Ct,classes:classes$S,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$Q});return jsxRuntimeExports.jsx(Box,{ref:$t,...sn("root"),mod:[{center:Ht,fixed:zt},Jt],...Zt,children:Gt})});Overlay$1.classes=classes$S;Overlay$1.displayName="@mantine/core/Overlay";const[ModalBaseProvider,useModalBaseContext]=createSafeContext("ModalBase component was not found in tree");function useLockScroll({opened:xt,transitionDuration:$t}){const[Ct,kt]=reactExports.useState(xt),Mt=reactExports.useRef(),jt=useReducedMotion()?0:$t;return reactExports.useEffect(()=>(xt?(kt(!0),window.clearTimeout(Mt.current)):jt===0?kt(!1):Mt.current=window.setTimeout(()=>kt(!1),jt),()=>window.clearTimeout(Mt.current)),[xt,jt]),Ct}function useModal({id:xt,transitionProps:$t,opened:Ct,trapFocus:kt,closeOnEscape:Mt,onClose:Ft,returnFocus:jt}){const Bt=useId$1(xt),[Vt,zt]=reactExports.useState(!1),[Ht,Gt]=reactExports.useState(!1),qt=typeof($t==null?void 0:$t.duration)=="number"?$t==null?void 0:$t.duration:200,Wt=useLockScroll({opened:Ct,transitionDuration:qt});return useWindowEvent("keydown",Yt=>{var Kt;Yt.key==="Escape"&&Mt&&Ct&&((Kt=Yt.target)==null?void 0:Kt.getAttribute("data-mantine-stop-propagation"))!=="true"&&Ft()},{capture:!0}),useFocusReturn({opened:Ct,shouldReturnFocus:kt&&jt}),{_id:Bt,titleMounted:Vt,bodyMounted:Ht,shouldLockScroll:Wt,setTitleMounted:zt,setBodyMounted:Gt}}const ModalBase=reactExports.forwardRef(({keepMounted:xt,opened:$t,onClose:Ct,id:kt,transitionProps:Mt,trapFocus:Ft,closeOnEscape:jt,returnFocus:Bt,closeOnClickOutside:Vt,withinPortal:zt,portalProps:Ht,lockScroll:Gt,children:qt,zIndex:Wt,shadow:Yt,padding:Kt,__vars:Xt,unstyled:Qt,removeScrollProps:Jt,...Zt},sn)=>{const{_id:ln,titleMounted:dn,bodyMounted:hn,shouldLockScroll:cn,setTitleMounted:pn,setBodyMounted:yn}=useModal({id:kt,transitionProps:Mt,opened:$t,trapFocus:Ft,closeOnEscape:jt,onClose:Ct,returnFocus:Bt});return jsxRuntimeExports.jsx(OptionalPortal,{...Ht,withinPortal:zt,children:jsxRuntimeExports.jsx(ModalBaseProvider,{value:{opened:$t,onClose:Ct,closeOnClickOutside:Vt,transitionProps:{...Mt,keepMounted:xt},getTitleId:()=>`${ln}-title`,getBodyId:()=>`${ln}-body`,titleMounted:dn,bodyMounted:hn,setTitleMounted:pn,setBodyMounted:yn,trapFocus:Ft,closeOnEscape:jt,zIndex:Wt,unstyled:Qt},children:jsxRuntimeExports.jsx(ReactRemoveScroll,{enabled:cn&&Gt,...Jt,children:jsxRuntimeExports.jsx(Box,{ref:sn,...Zt,__vars:{...Xt,"--mb-z-index":(Wt||getDefaultZIndex("modal")).toString(),"--mb-shadow":getShadow(Yt),"--mb-padding":getSpacing(Kt)},children:qt})})})})});function useModalBodyId(){const xt=useModalBaseContext();return reactExports.useEffect(()=>(xt.setBodyMounted(!0),()=>xt.setBodyMounted(!1)),[]),xt.getBodyId()}var classes$R={title:"m_615af6c9",header:"m_b5489c3c",inner:"m_60c222c7",content:"m_fd1ab0aa",close:"m_606cb269",body:"m_5df29311"};const ModalBaseBody=reactExports.forwardRef(({className:xt,...$t},Ct)=>{const kt=useModalBodyId(),Mt=useModalBaseContext();return jsxRuntimeExports.jsx(Box,{ref:Ct,...$t,id:kt,className:clsx({[classes$R.body]:!Mt.unstyled},xt)})});ModalBaseBody.displayName="@mantine/core/ModalBaseBody";const ModalBaseCloseButton=reactExports.forwardRef(({className:xt,onClick:$t,...Ct},kt)=>{const Mt=useModalBaseContext();return jsxRuntimeExports.jsx(CloseButton,{ref:kt,...Ct,onClick:Ft=>{Mt.onClose(),$t==null||$t(Ft)},className:clsx({[classes$R.close]:!Mt.unstyled},xt),unstyled:Mt.unstyled})});ModalBaseCloseButton.displayName="@mantine/core/ModalBaseCloseButton";const ModalBaseContent=reactExports.forwardRef(({transitionProps:xt,className:$t,innerProps:Ct,onKeyDown:kt,style:Mt,...Ft},jt)=>{const Bt=useModalBaseContext();return jsxRuntimeExports.jsx(Transition$1,{mounted:Bt.opened,transition:"pop",...Bt.transitionProps,...xt,children:Vt=>jsxRuntimeExports.jsx("div",{...Ct,className:clsx({[classes$R.inner]:!Bt.unstyled},Ct.className),children:jsxRuntimeExports.jsx(FocusTrap,{active:Bt.opened&&Bt.trapFocus,children:jsxRuntimeExports.jsx(Paper,{...Ft,component:"section",role:"dialog",tabIndex:-1,"aria-modal":!0,"aria-describedby":Bt.bodyMounted?Bt.getBodyId():void 0,"aria-labelledby":Bt.titleMounted?Bt.getTitleId():void 0,ref:jt,style:[Mt,Vt],className:clsx({[classes$R.content]:!Bt.unstyled},$t),unstyled:Bt.unstyled,children:Ft.children})})})})}),ModalBaseHeader=reactExports.forwardRef(({className:xt,...$t},Ct)=>{const kt=useModalBaseContext();return jsxRuntimeExports.jsx(Box,{component:"header",ref:Ct,className:clsx({[classes$R.header]:!kt.unstyled},xt),...$t})});ModalBaseHeader.displayName="@mantine/core/ModalBaseHeader";const DEFAULT_TRANSITION={duration:200,timingFunction:"ease",transition:"fade"};function useModalTransition(xt){const $t=useModalBaseContext();return{...DEFAULT_TRANSITION,...$t.transitionProps,...xt}}const ModalBaseOverlay=reactExports.forwardRef(({onClick:xt,transitionProps:$t,style:Ct,...kt},Mt)=>{const Ft=useModalBaseContext(),jt=useModalTransition($t);return jsxRuntimeExports.jsx(Transition$1,{mounted:Ft.opened,...jt,transition:"fade",children:Bt=>jsxRuntimeExports.jsx(Overlay$1,{ref:Mt,fixed:!0,style:[Ct,Bt],zIndex:Ft.zIndex,unstyled:Ft.unstyled,onClick:Vt=>{xt==null||xt(Vt),Ft.closeOnClickOutside&&Ft.onClose()},...kt})})});ModalBaseOverlay.displayName="@mantine/core/ModalBaseOverlay";function useModalTitle(){const xt=useModalBaseContext();return reactExports.useEffect(()=>(xt.setTitleMounted(!0),()=>xt.setTitleMounted(!1)),[]),xt.getTitleId()}const ModalBaseTitle=reactExports.forwardRef(({className:xt,...$t},Ct)=>{const kt=useModalTitle(),Mt=useModalBaseContext();return jsxRuntimeExports.jsx(Box,{component:"h2",ref:Ct,className:clsx({[classes$R.title]:!Mt.unstyled},xt),...$t,id:kt})});ModalBaseTitle.displayName="@mantine/core/ModalBaseTitle";function NativeScrollArea({children:xt}){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:xt})}const[InputWrapperProvider,useInputWrapperContext]=createOptionalContext({offsetBottom:!1,offsetTop:!1,describedBy:void 0,getStyles:null,inputId:void 0,labelId:void 0});var classes$Q={wrapper:"m_6c018570",input:"m_8fb7ebe7",section:"m_82577fc2",placeholder:"m_88bacfd0",root:"m_46b77525",label:"m_8fdc1311",required:"m_78a94662",error:"m_8f816625",description:"m_fe47ce59"};const defaultProps$22={},varsResolver$P=(xt,{size:$t})=>({description:{"--input-description-size":$t===void 0?void 0:`calc(${getFontSize$1($t)} - ${rem$1(2)})`}}),InputDescription=factory$2((xt,$t)=>{const Ct=useProps("InputDescription",defaultProps$22,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,size:zt,__staticSelector:Ht,__inheritStyles:Gt=!0,variant:qt,...Wt}=useProps("InputDescription",defaultProps$22,Ct),Yt=useInputWrapperContext(),Kt=useStyles({name:["InputWrapper",Ht],props:Ct,classes:classes$Q,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,rootSelector:"description",vars:Vt,varsResolver:varsResolver$P}),Xt=Gt&&(Yt==null?void 0:Yt.getStyles)||Kt;return jsxRuntimeExports.jsx(Box,{component:"p",ref:$t,variant:qt,size:zt,...Xt("description",Yt!=null&&Yt.getStyles?{className:Mt,style:Ft}:void 0),...Wt})});InputDescription.classes=classes$Q;InputDescription.displayName="@mantine/core/InputDescription";const defaultProps$21={},varsResolver$O=(xt,{size:$t})=>({error:{"--input-error-size":$t===void 0?void 0:`calc(${getFontSize$1($t)} - ${rem$1(2)})`}}),InputError=factory$2((xt,$t)=>{const Ct=useProps("InputError",defaultProps$21,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,size:zt,__staticSelector:Ht,__inheritStyles:Gt=!0,variant:qt,...Wt}=Ct,Yt=useStyles({name:["InputWrapper",Ht],props:Ct,classes:classes$Q,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,rootSelector:"error",vars:Vt,varsResolver:varsResolver$O}),Kt=useInputWrapperContext(),Xt=Gt&&(Kt==null?void 0:Kt.getStyles)||Yt;return jsxRuntimeExports.jsx(Box,{component:"p",ref:$t,variant:qt,size:zt,...Xt("error",Kt!=null&&Kt.getStyles?{className:Mt,style:Ft}:void 0),...Wt})});InputError.classes=classes$Q;InputError.displayName="@mantine/core/InputError";const defaultProps$20={labelElement:"label"},varsResolver$N=(xt,{size:$t})=>({label:{"--input-label-size":getFontSize$1($t),"--input-asterisk-color":void 0}}),InputLabel=factory$2((xt,$t)=>{const Ct=useProps("InputLabel",defaultProps$20,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,labelElement:zt,size:Ht,required:Gt,htmlFor:qt,onMouseDown:Wt,children:Yt,__staticSelector:Kt,variant:Xt,mod:Qt,...Jt}=useProps("InputLabel",defaultProps$20,Ct),Zt=useStyles({name:["InputWrapper",Kt],props:Ct,classes:classes$Q,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,rootSelector:"label",vars:Vt,varsResolver:varsResolver$N}),sn=useInputWrapperContext(),ln=(sn==null?void 0:sn.getStyles)||Zt;return jsxRuntimeExports.jsxs(Box,{...ln("label",sn!=null&&sn.getStyles?{className:Mt,style:Ft}:void 0),component:zt,variant:Xt,size:Ht,ref:$t,htmlFor:zt==="label"?qt:void 0,mod:[{required:Gt},Qt],onMouseDown:dn=>{Wt==null||Wt(dn),!dn.defaultPrevented&&dn.detail>1&&dn.preventDefault()},...Jt,children:[Yt,Gt&&jsxRuntimeExports.jsx("span",{...ln("required"),"aria-hidden":!0,children:" *"})]})});InputLabel.classes=classes$Q;InputLabel.displayName="@mantine/core/InputLabel";const defaultProps$1$={},InputPlaceholder=factory$2((xt,$t)=>{const Ct=useProps("InputPlaceholder",defaultProps$1$,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,__staticSelector:zt,variant:Ht,error:Gt,mod:qt,...Wt}=useProps("InputPlaceholder",defaultProps$1$,Ct),Yt=useStyles({name:["InputPlaceholder",zt],props:Ct,classes:classes$Q,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,rootSelector:"placeholder"});return jsxRuntimeExports.jsx(Box,{...Yt("placeholder"),mod:[{error:!!Gt},qt],component:"span",variant:Ht,ref:$t,...Wt})});InputPlaceholder.classes=classes$Q;InputPlaceholder.displayName="@mantine/core/InputPlaceholder";function getInputOffsets(xt,{hasDescription:$t,hasError:Ct}){const kt=xt.findIndex(Vt=>Vt==="input"),Mt=xt.slice(0,kt),Ft=xt.slice(kt+1),jt=$t&&Mt.includes("description")||Ct&&Mt.includes("error");return{offsetBottom:$t&&Ft.includes("description")||Ct&&Ft.includes("error"),offsetTop:jt}}const defaultProps$1_={labelElement:"label",inputContainer:xt=>xt,inputWrapperOrder:["label","description","input","error"]},varsResolver$M=(xt,{size:$t})=>({label:{"--input-label-size":getFontSize$1($t),"--input-asterisk-color":void 0},error:{"--input-error-size":$t===void 0?void 0:`calc(${getFontSize$1($t)} - ${rem$1(2)})`},description:{"--input-description-size":$t===void 0?void 0:`calc(${getFontSize$1($t)} - ${rem$1(2)})`}}),InputWrapper=factory$2((xt,$t)=>{const Ct=useProps("InputWrapper",defaultProps$1_,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,size:zt,variant:Ht,__staticSelector:Gt,inputContainer:qt,inputWrapperOrder:Wt,label:Yt,error:Kt,description:Xt,labelProps:Qt,descriptionProps:Jt,errorProps:Zt,labelElement:sn,children:ln,withAsterisk:dn,id:hn,required:cn,__stylesApiProps:pn,mod:yn,...gn}=Ct,En=useStyles({name:["InputWrapper",Gt],props:pn||Ct,classes:classes$Q,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$M}),bn={size:zt,variant:Ht,__staticSelector:Gt},xn=useId$1(hn),Cn=typeof dn=="boolean"?dn:cn,$n=(Zt==null?void 0:Zt.id)||`${xn}-error`,wn=(Jt==null?void 0:Jt.id)||`${xn}-description`,Rn=xn,Dn=!!Kt&&typeof Kt!="boolean",An=!!Xt,Sn=`${Dn?$n:""} ${An?wn:""}`,vn=Sn.trim().length>0?Sn.trim():void 0,_n=(Qt==null?void 0:Qt.id)||`${xn}-label`,Tn=Yt&&jsxRuntimeExports.jsx(InputLabel,{labelElement:sn,id:_n,htmlFor:Rn,required:Cn,...bn,...Qt,children:Yt},"label"),Pn=An&&jsxRuntimeExports.jsx(InputDescription,{...Jt,...bn,size:(Jt==null?void 0:Jt.size)||bn.size,id:(Jt==null?void 0:Jt.id)||wn,children:Xt},"description"),Ln=jsxRuntimeExports.jsx(reactExports.Fragment,{children:qt(ln)},"input"),Vn=Dn&&reactExports.createElement(InputError,{...Zt,...bn,size:(Zt==null?void 0:Zt.size)||bn.size,key:"error",id:(Zt==null?void 0:Zt.id)||$n},Kt),Un=Wt.map(Wn=>{switch(Wn){case"label":return Tn;case"input":return Ln;case"description":return Pn;case"error":return Vn;default:return null}});return jsxRuntimeExports.jsx(InputWrapperProvider,{value:{getStyles:En,describedBy:vn,inputId:Rn,labelId:_n,...getInputOffsets(Wt,{hasDescription:An,hasError:Dn})},children:jsxRuntimeExports.jsx(Box,{ref:$t,variant:Ht,size:zt,mod:[{error:!!Kt},yn],...En("root"),...gn,children:Un})})});InputWrapper.classes=classes$Q;InputWrapper.displayName="@mantine/core/InputWrapper";const defaultProps$1Z={variant:"default",leftSectionPointerEvents:"none",rightSectionPointerEvents:"none",withAria:!0,withErrorStyles:!0},varsResolver$L=(xt,$t,Ct)=>({wrapper:{"--input-margin-top":Ct.offsetTop?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-margin-bottom":Ct.offsetBottom?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-height":getSize($t.size,"input-height"),"--input-fz":getFontSize$1($t.size),"--input-radius":$t.radius===void 0?void 0:getRadius($t.radius),"--input-left-section-width":$t.leftSectionWidth!==void 0?rem$1($t.leftSectionWidth):void 0,"--input-right-section-width":$t.rightSectionWidth!==void 0?rem$1($t.rightSectionWidth):void 0,"--input-padding-y":$t.multiline?getSize($t.size,"input-padding-y"):void 0,"--input-left-section-pointer-events":$t.leftSectionPointerEvents,"--input-right-section-pointer-events":$t.rightSectionPointerEvents}}),Input=polymorphicFactory((xt,$t)=>{const Ct=useProps("Input",defaultProps$1Z,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,required:Vt,__staticSelector:zt,__stylesApiProps:Ht,size:Gt,wrapperProps:qt,error:Wt,disabled:Yt,leftSection:Kt,leftSectionProps:Xt,leftSectionWidth:Qt,rightSection:Jt,rightSectionProps:Zt,rightSectionWidth:sn,rightSectionPointerEvents:ln,leftSectionPointerEvents:dn,variant:hn,vars:cn,pointer:pn,multiline:yn,radius:gn,id:En,withAria:bn,withErrorStyles:xn,mod:Cn,inputSize:$n,...wn}=Ct,{styleProps:Rn,rest:Dn}=extractStyleProps(wn),An=useInputWrapperContext(),Sn={offsetBottom:An==null?void 0:An.offsetBottom,offsetTop:An==null?void 0:An.offsetTop},vn=useStyles({name:["Input",zt],props:Ht||Ct,classes:classes$Q,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,stylesCtx:Sn,rootSelector:"wrapper",vars:cn,varsResolver:varsResolver$L}),_n=bn?{required:Vt,disabled:Yt,"aria-invalid":!!Wt,"aria-describedby":An==null?void 0:An.describedBy,id:(An==null?void 0:An.inputId)||En}:{};return jsxRuntimeExports.jsxs(Box,{...vn("wrapper"),...Rn,...qt,mod:[{error:!!Wt&&xn,pointer:pn,disabled:Yt,multiline:yn,"data-with-right-section":!!Jt,"data-with-left-section":!!Kt},Cn],variant:hn,size:Gt,children:[Kt&&jsxRuntimeExports.jsx("div",{...Xt,"data-position":"left",...vn("section",{className:Xt==null?void 0:Xt.className,style:Xt==null?void 0:Xt.style}),children:Kt}),jsxRuntimeExports.jsx(Box,{component:"input",...Dn,..._n,ref:$t,required:Vt,mod:{disabled:Yt,error:!!Wt&&xn},variant:hn,__size:$n,...vn("input")}),Jt&&jsxRuntimeExports.jsx("div",{...Zt,"data-position":"right",...vn("section",{className:Zt==null?void 0:Zt.className,style:Zt==null?void 0:Zt.style}),children:Jt})]})});Input.classes=classes$Q;Input.Wrapper=InputWrapper;Input.Label=InputLabel;Input.Error=InputError;Input.Description=InputDescription;Input.Placeholder=InputPlaceholder;Input.displayName="@mantine/core/Input";function useInputProps(xt,$t,Ct){const kt=useProps(xt,$t,Ct),{label:Mt,description:Ft,error:jt,required:Bt,classNames:Vt,styles:zt,className:Ht,unstyled:Gt,__staticSelector:qt,__stylesApiProps:Wt,errorProps:Yt,labelProps:Kt,descriptionProps:Xt,wrapperProps:Qt,id:Jt,size:Zt,style:sn,inputContainer:ln,inputWrapperOrder:dn,withAsterisk:hn,variant:cn,vars:pn,mod:yn,...gn}=kt,{styleProps:En,rest:bn}=extractStyleProps(gn),xn={label:Mt,description:Ft,error:jt,required:Bt,classNames:Vt,className:Ht,__staticSelector:qt,__stylesApiProps:Wt||kt,errorProps:Yt,labelProps:Kt,descriptionProps:Xt,unstyled:Gt,styles:zt,size:Zt,style:sn,inputContainer:ln,inputWrapperOrder:dn,withAsterisk:hn,variant:cn,id:Jt,mod:yn,...Qt};return{...bn,classNames:Vt,styles:zt,unstyled:Gt,wrapperProps:{...xn,...En},inputProps:{required:Bt,classNames:Vt,styles:zt,unstyled:Gt,size:Zt,__staticSelector:qt,__stylesApiProps:Wt||kt,error:jt,variant:cn,id:Jt}}}const defaultProps$1Y={__staticSelector:"InputBase",withAria:!0},InputBase=polymorphicFactory((xt,$t)=>{const{inputProps:Ct,wrapperProps:kt,...Mt}=useInputProps("InputBase",defaultProps$1Y,xt);return jsxRuntimeExports.jsx(Input.Wrapper,{...kt,children:jsxRuntimeExports.jsx(Input,{...Ct,...Mt,ref:$t})})});InputBase.classes={...Input.classes,...Input.Wrapper.classes};InputBase.displayName="@mantine/core/InputBase";const FLEX_STYLE_PROPS_DATA={gap:{type:"spacing",property:"gap"},rowGap:{type:"spacing",property:"rowGap"},columnGap:{type:"spacing",property:"columnGap"},align:{type:"identity",property:"alignItems"},justify:{type:"identity",property:"justifyContent"},wrap:{type:"identity",property:"flexWrap"},direction:{type:"identity",property:"flexDirection"}};var classes$P={root:"m_8bffd616"};const defaultProps$1X={},Flex=polymorphicFactory((xt,$t)=>{const Ct=useProps("Flex",defaultProps$1X,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,gap:zt,rowGap:Ht,columnGap:Gt,align:qt,justify:Wt,wrap:Yt,direction:Kt,...Xt}=Ct,Qt=useStyles({name:"Flex",classes:classes$P,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt}),Jt=useMantineTheme(),Zt=useRandomClassName(),sn=parseStyleProps({styleProps:{gap:zt,rowGap:Ht,columnGap:Gt,align:qt,justify:Wt,wrap:Yt,direction:Kt},theme:Jt,data:FLEX_STYLE_PROPS_DATA});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[sn.hasResponsiveStyles&&jsxRuntimeExports.jsx(InlineStyles,{selector:`.${Zt}`,styles:sn.styles,media:sn.media}),jsxRuntimeExports.jsx(Box,{ref:$t,...Qt("root",{className:Zt,style:filterProps(sn.inlineStyles)}),...Xt})]})});Flex.classes=classes$P;Flex.displayName="@mantine/core/Flex";function isParent(xt,$t){if(!$t||!xt)return!1;let Ct=$t.parentNode;for(;Ct!=null;){if(Ct===xt)return!0;Ct=Ct.parentNode}return!1}function useFloatingIndicator({target:xt,parent:$t,ref:Ct,displayAfterTransitionEnd:kt}){const Mt=reactExports.useRef(),[Ft,jt]=reactExports.useState(!1),[Bt,Vt]=reactExports.useState(typeof kt=="boolean"?kt:!1),zt=()=>{if(!xt||!$t)return;const Wt=xt.getBoundingClientRect(),Yt=$t.getBoundingClientRect(),Kt={top:Wt.top-Yt.top,left:Wt.left-Yt.left,width:Wt.width,height:Wt.height};Ct.current&&(Ct.current.style.transform=`translateY(${Kt.top}px) translateX(${Kt.left}px)`,Ct.current.style.width=`${Kt.width}px`,Ct.current.style.height=`${Kt.height}px`)},Ht=()=>{window.clearTimeout(Mt.current),Ct.current&&(Ct.current.style.transitionDuration="0ms"),zt(),Mt.current=window.setTimeout(()=>{Ct.current&&(Ct.current.style.transitionDuration="")},30)},Gt=reactExports.useRef(),qt=reactExports.useRef();return reactExports.useEffect(()=>{if(zt(),xt)return Gt.current=new ResizeObserver(Ht),Gt.current.observe(xt),$t&&(qt.current=new ResizeObserver(Ht),qt.current.observe($t)),()=>{var Wt,Yt;(Wt=Gt.current)==null||Wt.disconnect(),(Yt=qt.current)==null||Yt.disconnect()}},[$t,xt]),reactExports.useEffect(()=>{if($t){const Wt=Yt=>{isParent(Yt.target,$t)&&(Ht(),Vt(!1))};return document.addEventListener("transitionend",Wt),()=>{document.removeEventListener("transitionend",Wt)}}},[$t]),useTimeout(()=>{getEnv()!=="test"&&jt(!0)},20,{autoInvoke:!0}),useMutationObserver(Wt=>{Wt.forEach(Yt=>{Yt.type==="attributes"&&Yt.attributeName==="dir"&&Ht()})},{attributes:!0,attributeFilter:["dir"]},()=>document.documentElement),{initialized:Ft,hidden:Bt}}var classes$O={root:"m_96b553a6"};const defaultProps$1W={},varsResolver$K=(xt,{transitionDuration:$t})=>({root:{"--transition-duration":typeof $t=="number"?`${$t}ms`:$t}}),FloatingIndicator=factory$2((xt,$t)=>{const Ct=useProps("FloatingIndicator",defaultProps$1W,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,target:zt,parent:Ht,transitionDuration:Gt,mod:qt,displayAfterTransitionEnd:Wt,...Yt}=Ct,Kt=useStyles({name:"FloatingIndicator",classes:classes$O,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$K}),Xt=reactExports.useRef(null),{initialized:Qt,hidden:Jt}=useFloatingIndicator({target:zt,parent:Ht,ref:Xt,displayAfterTransitionEnd:Wt}),Zt=useMergedRef($t,Xt);return!zt||!Ht?null:jsxRuntimeExports.jsx(Box,{ref:Zt,mod:[{initialized:Qt,hidden:Jt},qt],...Kt("root"),...Yt})});FloatingIndicator.displayName="@mantine/core/FloatingIndicator";FloatingIndicator.classes=classes$O;const[AccordionProvider,useAccordionContext]=createSafeContext("Accordion component was not found in the tree");function AccordionChevron({style:xt,size:$t=16,...Ct}){return jsxRuntimeExports.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...xt,width:rem$1($t),height:rem$1($t),display:"block"},...Ct,children:jsxRuntimeExports.jsx("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}AccordionChevron.displayName="@mantine/core/AccordionChevron";const[AccordionItemProvider,useAccordionItemContext]=createSafeContext("Accordion.Item component was not found in the tree");var classes$N={root:"m_9bdbb667",panel:"m_df78851f",content:"m_4ba554d4",itemTitle:"m_8fa820a0",control:"m_4ba585b8","control--default":"m_6939a5e9","control--contained":"m_4271d21b",label:"m_df3ffa0f",chevron:"m_3f35ae96",icon:"m_9bd771fe",item:"m_9bd7b098","item--default":"m_fe19b709","item--contained":"m_1f921b3b","item--filled":"m_2cdf939a","item--separated":"m_9f59b069"};const defaultProps$1V={},AccordionControl=factory$2((xt,$t)=>{const{classNames:Ct,className:kt,style:Mt,styles:Ft,vars:jt,chevron:Bt,icon:Vt,onClick:zt,onKeyDown:Ht,children:Gt,disabled:qt,mod:Wt,...Yt}=useProps("AccordionControl",defaultProps$1V,xt),{value:Kt}=useAccordionItemContext(),Xt=useAccordionContext(),Qt=Xt.isItemActive(Kt),Jt=typeof Xt.order=="number",Zt=`h${Xt.order}`,sn=jsxRuntimeExports.jsxs(UnstyledButton,{...Yt,...Xt.getStyles("control",{className:kt,classNames:Ct,style:Mt,styles:Ft,variant:Xt.variant}),unstyled:Xt.unstyled,mod:["accordion-control",{active:Qt,"chevron-position":Xt.chevronPosition,disabled:qt},Wt],ref:$t,onClick:ln=>{zt==null||zt(ln),Xt.onChange(Kt)},type:"button",disabled:qt,"aria-expanded":Qt,"aria-controls":Xt.getRegionId(Kt),id:Xt.getControlId(Kt),onKeyDown:createScopedKeydownHandler({siblingSelector:"[data-accordion-control]",parentSelector:"[data-accordion]",activateOnFocus:!1,loop:Xt.loop,orientation:"vertical",onKeyDown:Ht}),children:[jsxRuntimeExports.jsx(Box,{component:"span",mod:{rotate:!Xt.disableChevronRotation&&Qt,position:Xt.chevronPosition},...Xt.getStyles("chevron",{classNames:Ct,styles:Ft}),children:Bt||Xt.chevron}),jsxRuntimeExports.jsx("span",{...Xt.getStyles("label",{classNames:Ct,styles:Ft}),children:Gt}),Vt&&jsxRuntimeExports.jsx(Box,{component:"span",mod:{"chevron-position":Xt.chevronPosition},...Xt.getStyles("icon",{classNames:Ct,styles:Ft}),children:Vt})]});return Jt?jsxRuntimeExports.jsx(Zt,{...Xt.getStyles("itemTitle",{classNames:Ct,styles:Ft}),children:sn}):sn});AccordionControl.displayName="@mantine/core/AccordionControl";AccordionControl.classes=classes$N;const defaultProps$1U={},AccordionItem=factory$2((xt,$t)=>{const{classNames:Ct,className:kt,style:Mt,styles:Ft,vars:jt,value:Bt,mod:Vt,...zt}=useProps("AccordionItem",defaultProps$1U,xt),Ht=useAccordionContext();return jsxRuntimeExports.jsx(AccordionItemProvider,{value:{value:Bt},children:jsxRuntimeExports.jsx(Box,{ref:$t,mod:[{active:Ht.isItemActive(Bt)},Vt],...Ht.getStyles("item",{className:kt,classNames:Ct,styles:Ft,style:Mt,variant:Ht.variant}),...zt})})});AccordionItem.displayName="@mantine/core/AccordionItem";AccordionItem.classes=classes$N;const defaultProps$1T={},AccordionPanel=factory$2((xt,$t)=>{const{classNames:Ct,className:kt,style:Mt,styles:Ft,vars:jt,children:Bt,...Vt}=useProps("AccordionPanel",defaultProps$1T,xt),{value:zt}=useAccordionItemContext(),Ht=useAccordionContext();return jsxRuntimeExports.jsx(Collapse,{ref:$t,...Ht.getStyles("panel",{className:kt,classNames:Ct,style:Mt,styles:Ft}),...Vt,in:Ht.isItemActive(zt),transitionDuration:Ht.transitionDuration??200,role:"region",id:Ht.getRegionId(zt),"aria-labelledby":Ht.getControlId(zt),children:jsxRuntimeExports.jsx("div",{...Ht.getStyles("content",{classNames:Ct,styles:Ft}),children:Bt})})});AccordionPanel.displayName="@mantine/core/AccordionPanel";AccordionPanel.classes=classes$N;const defaultProps$1S={multiple:!1,disableChevronRotation:!1,chevronPosition:"right",variant:"default",chevron:jsxRuntimeExports.jsx(AccordionChevron,{})},varsResolver$J=(xt,{transitionDuration:$t,chevronSize:Ct,radius:kt})=>({root:{"--accordion-transition-duration":$t===void 0?void 0:`${$t}ms`,"--accordion-chevron-size":Ct===void 0?void 0:rem$1(Ct),"--accordion-radius":kt===void 0?void 0:getRadius(kt)}});function Accordion(xt){const $t=useProps("Accordion",defaultProps$1S,xt),{classNames:Ct,className:kt,style:Mt,styles:Ft,unstyled:jt,vars:Bt,children:Vt,multiple:zt,value:Ht,defaultValue:Gt,onChange:qt,id:Wt,loop:Yt,transitionDuration:Kt,disableChevronRotation:Xt,chevronPosition:Qt,chevronSize:Jt,order:Zt,chevron:sn,variant:ln,radius:dn,...hn}=$t,cn=useId$1(Wt),[pn,yn]=useUncontrolled({value:Ht,defaultValue:Gt,finalValue:zt?[]:null,onChange:qt}),gn=xn=>Array.isArray(pn)?pn.includes(xn):xn===pn,En=xn=>{const Cn=Array.isArray(pn)?pn.includes(xn)?pn.filter($n=>$n!==xn):[...pn,xn]:xn===pn?null:xn;yn(Cn)},bn=useStyles({name:"Accordion",classes:classes$N,props:$t,className:kt,style:Mt,classNames:Ct,styles:Ft,unstyled:jt,vars:Bt,varsResolver:varsResolver$J});return jsxRuntimeExports.jsx(AccordionProvider,{value:{isItemActive:gn,onChange:En,getControlId:getSafeId(`${cn}-control`,"Accordion.Item component was rendered with invalid value or without value"),getRegionId:getSafeId(`${cn}-panel`,"Accordion.Item component was rendered with invalid value or without value"),transitionDuration:Kt,disableChevronRotation:Xt,chevronPosition:Qt,order:Zt,chevron:sn,loop:Yt,getStyles:bn,variant:ln,unstyled:jt},children:jsxRuntimeExports.jsx(Box,{...bn("root"),id:cn,...hn,variant:ln,"data-accordion":!0,children:Vt})})}const extendAccordion=xt=>xt;Accordion.extend=extendAccordion;Accordion.classes=classes$N;Accordion.displayName="@mantine/core/Accordion";Accordion.Item=AccordionItem;Accordion.Panel=AccordionPanel;Accordion.Control=AccordionControl;Accordion.Chevron=AccordionChevron;var classes$M={root:"m_66836ed3",wrapper:"m_a5d60502",body:"m_667c2793",title:"m_6a03f287",label:"m_698f4f23",icon:"m_667f2a6a",message:"m_7fa78076",closeButton:"m_87f54839"};const defaultProps$1R={},varsResolver$I=(xt,{radius:$t,color:Ct,variant:kt,autoContrast:Mt})=>{const Ft=xt.variantColorResolver({color:Ct||xt.primaryColor,theme:xt,variant:kt||"light",autoContrast:Mt});return{root:{"--alert-radius":$t===void 0?void 0:getRadius($t),"--alert-bg":Ct||kt?Ft.background:void 0,"--alert-color":Ft.color,"--alert-bd":Ct||kt?Ft.border:void 0}}},Alert=factory$2((xt,$t)=>{const Ct=useProps("Alert",defaultProps$1R,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,radius:zt,color:Ht,title:Gt,children:qt,id:Wt,icon:Yt,withCloseButton:Kt,onClose:Xt,closeButtonLabel:Qt,variant:Jt,autoContrast:Zt,...sn}=Ct,ln=useStyles({name:"Alert",classes:classes$M,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$I}),dn=useId$1(Wt),hn=Gt&&`${dn}-title`||void 0,cn=`${dn}-body`;return jsxRuntimeExports.jsx(Box,{id:dn,...ln("root",{variant:Jt}),variant:Jt,ref:$t,...sn,role:"alert","aria-describedby":cn,"aria-labelledby":hn,children:jsxRuntimeExports.jsxs("div",{...ln("wrapper"),children:[Yt&&jsxRuntimeExports.jsx("div",{...ln("icon"),children:Yt}),jsxRuntimeExports.jsxs("div",{...ln("body"),children:[Gt&&jsxRuntimeExports.jsx("div",{...ln("title"),"data-with-close-button":Kt||void 0,children:jsxRuntimeExports.jsx("span",{id:hn,...ln("label"),children:Gt})}),qt&&jsxRuntimeExports.jsx("div",{id:cn,...ln("message"),"data-variant":Jt,children:qt})]}),Kt&&jsxRuntimeExports.jsx(CloseButton,{...ln("closeButton"),onClick:Xt,variant:"transparent",size:16,iconSize:16,"aria-label":Qt,unstyled:Bt})]})})});Alert.classes=classes$M;Alert.displayName="@mantine/core/Alert";var classes$L={root:"m_b6d8b162"};function getTextTruncate(xt){if(xt==="start")return"start";if(xt==="end"||xt)return"end"}const defaultProps$1Q={inherit:!1},varsResolver$H=(xt,{variant:$t,lineClamp:Ct,gradient:kt,size:Mt,color:Ft})=>({root:{"--text-fz":getFontSize$1(Mt),"--text-lh":getLineHeight(Mt),"--text-gradient":$t==="gradient"?getGradient(kt,xt):void 0,"--text-line-clamp":typeof Ct=="number"?Ct.toString():void 0,"--text-color":Ft?getThemeColor(Ft,xt):void 0}}),Text=polymorphicFactory((xt,$t)=>{const Ct=useProps("Text",defaultProps$1Q,xt),{lineClamp:kt,truncate:Mt,inline:Ft,inherit:jt,gradient:Bt,span:Vt,__staticSelector:zt,vars:Ht,className:Gt,style:qt,classNames:Wt,styles:Yt,unstyled:Kt,variant:Xt,mod:Qt,size:Jt,...Zt}=Ct,sn=useStyles({name:["Text",zt],props:Ct,classes:classes$L,className:Gt,style:qt,classNames:Wt,styles:Yt,unstyled:Kt,vars:Ht,varsResolver:varsResolver$H});return jsxRuntimeExports.jsx(Box,{...sn("root",{focusable:!0}),ref:$t,component:Vt?"span":"p",variant:Xt,mod:[{"data-truncate":getTextTruncate(Mt),"data-line-clamp":typeof kt=="number","data-inline":Ft,"data-inherit":jt},Qt],size:Jt,...Zt})});Text.classes=classes$L;Text.displayName="@mantine/core/Text";var classes$K={root:"m_849cf0da"};const defaultProps$1P={underline:"hover"},Anchor=polymorphicFactory((xt,$t)=>{const{underline:Ct,className:kt,unstyled:Mt,mod:Ft,...jt}=useProps("Anchor",defaultProps$1P,xt);return jsxRuntimeExports.jsx(Text,{component:"a",ref:$t,className:clsx({[classes$K.root]:!Mt},kt),...jt,mod:[{underline:Ct},Ft],__staticSelector:"Anchor",unstyled:Mt})});Anchor.classes=classes$K;Anchor.displayName="@mantine/core/Anchor";const[AppShellProvider,useAppShellContext]=createSafeContext("AppShell was not found in tree");var classes$J={root:"m_89ab340",navbar:"m_45252eee",aside:"m_9cdde9a",header:"m_3b16f56b",main:"m_8983817",footer:"m_3840c879",section:"m_6dcfc7c7"};const defaultProps$1O={},AppShellAside=factory$2((xt,$t)=>{const Ct=useProps("AppShellAside",defaultProps$1O,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,withBorder:zt,zIndex:Ht,mod:Gt,...qt}=Ct,Wt=useAppShellContext();return Wt.disabled?null:jsxRuntimeExports.jsx(Box,{component:"aside",ref:$t,mod:[{"with-border":zt??Wt.withBorder},Gt],...Wt.getStyles("aside",{className:Mt,classNames:kt,styles:jt,style:Ft}),...qt,__vars:{"--app-shell-aside-z-index":`calc(${Ht??Wt.zIndex} + 1)`}})});AppShellAside.classes=classes$J;AppShellAside.displayName="@mantine/core/AppShellAside";const defaultProps$1N={},AppShellFooter=factory$2((xt,$t)=>{var Yt;const Ct=useProps("AppShellFooter",defaultProps$1N,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,withBorder:zt,zIndex:Ht,mod:Gt,...qt}=Ct,Wt=useAppShellContext();return Wt.disabled?null:jsxRuntimeExports.jsx(Box,{component:"footer",ref:$t,mod:[{"with-border":zt??Wt.withBorder},Gt],...Wt.getStyles("footer",{className:clsx({[ReactRemoveScroll.classNames.zeroRight]:Wt.offsetScrollbars},Mt),classNames:kt,styles:jt,style:Ft}),...qt,__vars:{"--app-shell-footer-z-index":(Yt=Ht??Wt.zIndex)==null?void 0:Yt.toString()}})});AppShellFooter.classes=classes$J;AppShellFooter.displayName="@mantine/core/AppShellFooter";const defaultProps$1M={},AppShellHeader=factory$2((xt,$t)=>{var Yt;const Ct=useProps("AppShellHeader",defaultProps$1M,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,withBorder:zt,zIndex:Ht,mod:Gt,...qt}=Ct,Wt=useAppShellContext();return Wt.disabled?null:jsxRuntimeExports.jsx(Box,{component:"header",ref:$t,mod:[{"with-border":zt??Wt.withBorder},Gt],...Wt.getStyles("header",{className:clsx({[ReactRemoveScroll.classNames.zeroRight]:Wt.offsetScrollbars},Mt),classNames:kt,styles:jt,style:Ft}),...qt,__vars:{"--app-shell-header-z-index":(Yt=Ht??Wt.zIndex)==null?void 0:Yt.toString()}})});AppShellHeader.classes=classes$J;AppShellHeader.displayName="@mantine/core/AppShellHeader";const defaultProps$1L={},AppShellMain=factory$2((xt,$t)=>{const Ct=useProps("AppShellMain",defaultProps$1L,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,...Vt}=Ct,zt=useAppShellContext();return jsxRuntimeExports.jsx(Box,{component:"main",ref:$t,...zt.getStyles("main",{className:Mt,style:Ft,classNames:kt,styles:jt}),...Vt})});AppShellMain.classes=classes$J;AppShellMain.displayName="@mantine/core/AppShellMain";function getBaseSize(xt){return typeof xt=="object"?xt.base:xt}function isPrimitiveSize(xt){const $t=typeof xt=="object"&&xt!==null&&typeof xt.base<"u"&&Object.keys(xt).length===1;return typeof xt=="number"||typeof xt=="string"||$t}function isResponsiveSize(xt){return!(typeof xt!="object"||xt===null||Object.keys(xt).length===1&&"base"in xt)}function assignAsideVariables({baseStyles:xt,minMediaStyles:$t,maxMediaStyles:Ct,aside:kt,theme:Mt}){var Vt,zt,Ht;const Ft=kt==null?void 0:kt.width,jt="translateX(var(--app-shell-aside-width))",Bt="translateX(calc(var(--app-shell-aside-width) * -1))";if(kt!=null&&kt.breakpoint&&!((Vt=kt==null?void 0:kt.collapsed)!=null&&Vt.mobile)&&(Ct[kt==null?void 0:kt.breakpoint]=Ct[kt==null?void 0:kt.breakpoint]||{},Ct[kt==null?void 0:kt.breakpoint]["--app-shell-aside-width"]="100%",Ct[kt==null?void 0:kt.breakpoint]["--app-shell-aside-offset"]="0px"),isPrimitiveSize(Ft)){const Gt=rem$1(getBaseSize(Ft));xt["--app-shell-aside-width"]=Gt,xt["--app-shell-aside-offset"]=Gt}if(isResponsiveSize(Ft)&&(typeof Ft.base<"u"&&(xt["--app-shell-aside-width"]=rem$1(Ft.base),xt["--app-shell-aside-offset"]=rem$1(Ft.base)),keys$4(Ft).forEach(Gt=>{Gt!=="base"&&($t[Gt]=$t[Gt]||{},$t[Gt]["--app-shell-aside-width"]=rem$1(Ft[Gt]),$t[Gt]["--app-shell-aside-offset"]=rem$1(Ft[Gt]))})),(zt=kt==null?void 0:kt.collapsed)!=null&&zt.desktop){const Gt=kt.breakpoint;$t[Gt]=$t[Gt]||{},$t[Gt]["--app-shell-aside-transform"]=jt,$t[Gt]["--app-shell-aside-transform-rtl"]=Bt,$t[Gt]["--app-shell-aside-offset"]="0px !important"}if((Ht=kt==null?void 0:kt.collapsed)!=null&&Ht.mobile){const Gt=getBreakpointValue$1(kt.breakpoint,Mt)-.1;Ct[Gt]=Ct[Gt]||{},Ct[Gt]["--app-shell-aside-width"]="100%",Ct[Gt]["--app-shell-aside-offset"]="0px",Ct[Gt]["--app-shell-aside-transform"]=jt,Ct[Gt]["--app-shell-aside-transform-rtl"]=Bt}}function assignFooterVariables({baseStyles:xt,minMediaStyles:$t,footer:Ct}){const kt=Ct==null?void 0:Ct.height,Mt="translateY(var(--app-shell-footer-height))",Ft=(Ct==null?void 0:Ct.offset)??!0;if(isPrimitiveSize(kt)){const jt=rem$1(getBaseSize(kt));xt["--app-shell-footer-height"]=jt,Ft&&(xt["--app-shell-footer-offset"]=jt)}isResponsiveSize(kt)&&(typeof kt.base<"u"&&(xt["--app-shell-footer-height"]=rem$1(kt.base),Ft&&(xt["--app-shell-footer-offset"]=rem$1(kt.base))),keys$4(kt).forEach(jt=>{jt!=="base"&&($t[jt]=$t[jt]||{},$t[jt]["--app-shell-footer-height"]=rem$1(kt[jt]),Ft&&($t[jt]["--app-shell-footer-offset"]=rem$1(kt[jt])))})),Ct!=null&&Ct.collapsed&&(xt["--app-shell-footer-transform"]=Mt,xt["--app-shell-footer-offset"]="0px !important")}function assignHeaderVariables({baseStyles:xt,minMediaStyles:$t,header:Ct}){const kt=Ct==null?void 0:Ct.height,Mt="translateY(calc(var(--app-shell-header-height) * -1))",Ft=(Ct==null?void 0:Ct.offset)??!0;if(isPrimitiveSize(kt)){const jt=rem$1(getBaseSize(kt));xt["--app-shell-header-height"]=jt,Ft&&(xt["--app-shell-header-offset"]=jt)}isResponsiveSize(kt)&&(typeof kt.base<"u"&&(xt["--app-shell-header-height"]=rem$1(kt.base),Ft&&(xt["--app-shell-header-offset"]=rem$1(kt.base))),keys$4(kt).forEach(jt=>{jt!=="base"&&($t[jt]=$t[jt]||{},$t[jt]["--app-shell-header-height"]=rem$1(kt[jt]),Ft&&($t[jt]["--app-shell-header-offset"]=rem$1(kt[jt])))})),Ct!=null&&Ct.collapsed&&(xt["--app-shell-header-transform"]=Mt,xt["--app-shell-header-offset"]="0px !important")}function assignNavbarVariables({baseStyles:xt,minMediaStyles:$t,maxMediaStyles:Ct,navbar:kt,theme:Mt}){var Vt,zt,Ht;const Ft=kt==null?void 0:kt.width,jt="translateX(calc(var(--app-shell-navbar-width) * -1))",Bt="translateX(var(--app-shell-navbar-width))";if(kt!=null&&kt.breakpoint&&!((Vt=kt==null?void 0:kt.collapsed)!=null&&Vt.mobile)&&(Ct[kt==null?void 0:kt.breakpoint]=Ct[kt==null?void 0:kt.breakpoint]||{},Ct[kt==null?void 0:kt.breakpoint]["--app-shell-navbar-width"]="100%",Ct[kt==null?void 0:kt.breakpoint]["--app-shell-navbar-offset"]="0px"),isPrimitiveSize(Ft)){const Gt=rem$1(getBaseSize(Ft));xt["--app-shell-navbar-width"]=Gt,xt["--app-shell-navbar-offset"]=Gt}if(isResponsiveSize(Ft)&&(typeof Ft.base<"u"&&(xt["--app-shell-navbar-width"]=rem$1(Ft.base),xt["--app-shell-navbar-offset"]=rem$1(Ft.base)),keys$4(Ft).forEach(Gt=>{Gt!=="base"&&($t[Gt]=$t[Gt]||{},$t[Gt]["--app-shell-navbar-width"]=rem$1(Ft[Gt]),$t[Gt]["--app-shell-navbar-offset"]=rem$1(Ft[Gt]))})),(zt=kt==null?void 0:kt.collapsed)!=null&&zt.desktop){const Gt=kt.breakpoint;$t[Gt]=$t[Gt]||{},$t[Gt]["--app-shell-navbar-transform"]=jt,$t[Gt]["--app-shell-navbar-transform-rtl"]=Bt,$t[Gt]["--app-shell-navbar-offset"]="0px !important"}if((Ht=kt==null?void 0:kt.collapsed)!=null&&Ht.mobile){const Gt=getBreakpointValue$1(kt.breakpoint,Mt)-.1;Ct[Gt]=Ct[Gt]||{},Ct[Gt]["--app-shell-navbar-width"]="100%",Ct[Gt]["--app-shell-navbar-offset"]="0px",Ct[Gt]["--app-shell-navbar-transform"]=jt,Ct[Gt]["--app-shell-navbar-transform-rtl"]=Bt}}function getPaddingValue(xt){return Number(xt)===0?"0px":getSpacing(xt)}function assignPaddingVariables({padding:xt,baseStyles:$t,minMediaStyles:Ct}){isPrimitiveSize(xt)&&($t["--app-shell-padding"]=getPaddingValue(getBaseSize(xt))),isResponsiveSize(xt)&&(xt.base&&($t["--app-shell-padding"]=getPaddingValue(xt.base)),keys$4(xt).forEach(kt=>{kt!=="base"&&(Ct[kt]=Ct[kt]||{},Ct[kt]["--app-shell-padding"]=getPaddingValue(xt[kt]))}))}function getVariables({navbar:xt,header:$t,footer:Ct,aside:kt,padding:Mt,theme:Ft}){const jt={},Bt={},Vt={};assignNavbarVariables({baseStyles:Vt,minMediaStyles:jt,maxMediaStyles:Bt,navbar:xt,theme:Ft}),assignAsideVariables({baseStyles:Vt,minMediaStyles:jt,maxMediaStyles:Bt,aside:kt,theme:Ft}),assignHeaderVariables({baseStyles:Vt,minMediaStyles:jt,header:$t}),assignFooterVariables({baseStyles:Vt,minMediaStyles:jt,footer:Ct}),assignPaddingVariables({baseStyles:Vt,minMediaStyles:jt,padding:Mt});const zt=getSortedBreakpoints(keys$4(jt),Ft).map(qt=>({query:`(min-width: ${em(qt.px)})`,styles:jt[qt.value]})),Ht=getSortedBreakpoints(keys$4(Bt),Ft).map(qt=>({query:`(max-width: ${em(qt.px)})`,styles:Bt[qt.value]})),Gt=[...zt,...Ht];return{baseStyles:Vt,media:Gt}}function AppShellMediaStyles({navbar:xt,header:$t,aside:Ct,footer:kt,padding:Mt}){const Ft=useMantineTheme(),jt=useMantineContext(),{media:Bt,baseStyles:Vt}=getVariables({navbar:xt,header:$t,footer:kt,aside:Ct,padding:Mt,theme:Ft});return jsxRuntimeExports.jsx(InlineStyles,{media:Bt,styles:Vt,selector:jt.cssVariablesSelector})}const defaultProps$1K={},AppShellNavbar=factory$2((xt,$t)=>{const Ct=useProps("AppShellNavbar",defaultProps$1K,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,withBorder:zt,zIndex:Ht,mod:Gt,...qt}=Ct,Wt=useAppShellContext();return Wt.disabled?null:jsxRuntimeExports.jsx(Box,{component:"nav",ref:$t,mod:[{"with-border":zt??Wt.withBorder},Gt],...Wt.getStyles("navbar",{className:Mt,classNames:kt,styles:jt,style:Ft}),...qt,__vars:{"--app-shell-navbar-z-index":`calc(${Ht??Wt.zIndex} + 1)`}})});AppShellNavbar.classes=classes$J;AppShellNavbar.displayName="@mantine/core/AppShellNavbar";const defaultProps$1J={},AppShellSection=polymorphicFactory((xt,$t)=>{const Ct=useProps("AppShellSection",defaultProps$1J,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,grow:Vt,mod:zt,...Ht}=Ct,Gt=useAppShellContext();return jsxRuntimeExports.jsx(Box,{ref:$t,mod:[{grow:Vt},zt],...Gt.getStyles("section",{className:Mt,style:Ft,classNames:kt,styles:jt}),...Ht})});AppShellSection.classes=classes$J;AppShellSection.displayName="@mantine/core/AppShellSection";function useResizing({transitionDuration:xt,disabled:$t}){const[Ct,kt]=reactExports.useState(!0),Mt=reactExports.useRef(),Ft=reactExports.useRef();return useWindowEvent("resize",()=>{kt(!0),clearTimeout(Mt.current),Mt.current=window.setTimeout(()=>kt(!1),200)}),useIsomorphicEffect$1(()=>{reactExports.startTransition(()=>{kt(!0),clearTimeout(Ft.current),Ft.current=window.setTimeout(()=>kt(!1),xt||0)})},[$t,xt]),Ct}const defaultProps$1I={withBorder:!0,offsetScrollbars:!0,padding:0,transitionDuration:200,transitionTimingFunction:"ease",zIndex:getDefaultZIndex("app")},varsResolver$G=(xt,{transitionDuration:$t,transitionTimingFunction:Ct})=>({root:{"--app-shell-transition-duration":`${$t}ms`,"--app-shell-transition-timing-function":Ct}}),AppShell=factory$2((xt,$t)=>{const Ct=useProps("AppShell",defaultProps$1I,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,navbar:zt,withBorder:Ht,padding:Gt,transitionDuration:qt,transitionTimingFunction:Wt,header:Yt,zIndex:Kt,layout:Xt,disabled:Qt,aside:Jt,footer:Zt,offsetScrollbars:sn,mod:ln,...dn}=Ct,hn=useStyles({name:"AppShell",classes:classes$J,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$G}),cn=useResizing({disabled:Qt,transitionDuration:qt});return jsxRuntimeExports.jsxs(AppShellProvider,{value:{getStyles:hn,withBorder:Ht,zIndex:Kt,disabled:Qt,offsetScrollbars:sn},children:[jsxRuntimeExports.jsx(AppShellMediaStyles,{navbar:zt,header:Yt,aside:Jt,footer:Zt,padding:Gt}),jsxRuntimeExports.jsx(Box,{ref:$t,...hn("root"),mod:[{resizing:cn,layout:Xt,disabled:Qt},ln],...dn})]})});AppShell.classes=classes$J;AppShell.displayName="@mantine/core/AppShell";AppShell.Navbar=AppShellNavbar;AppShell.Header=AppShellHeader;AppShell.Main=AppShellMain;AppShell.Aside=AppShellAside;AppShell.Footer=AppShellFooter;AppShell.Section=AppShellSection;function parseItem(xt){return typeof xt=="string"?{value:xt,label:xt}:"value"in xt&&!("label"in xt)?{value:xt.value,label:xt.value,disabled:xt.disabled}:typeof xt=="number"?{value:xt.toString(),label:xt.toString()}:"group"in xt?{group:xt.group,items:xt.items.map($t=>parseItem($t))}:xt}function getParsedComboboxData(xt){return xt?xt.map($t=>parseItem($t)):[]}function getOptionsLockup(xt){return xt.reduce(($t,Ct)=>"group"in Ct?{...$t,...getOptionsLockup(Ct.items)}:($t[Ct.value]=Ct,$t),{})}var classes$I={dropdown:"m_88b62a41",options:"m_b2821a6e",option:"m_92253aa5",search:"m_985517d8",empty:"m_2530cd1d",header:"m_858f94bd",footer:"m_82b967cb",group:"m_254f3e4f",groupLabel:"m_2bb2e9e5",chevron:"m_2943220b",optionsDropdownOption:"m_390b5f4",optionsDropdownCheckIcon:"m_8ee53fc2"};const defaultProps$1H={error:null},varsResolver$F=(xt,{size:$t})=>({chevron:{"--combobox-chevron-size":getSize($t,"combobox-chevron-size")}}),ComboboxChevron=factory$2((xt,$t)=>{const Ct=useProps("ComboboxChevron",defaultProps$1H,xt),{size:kt,error:Mt,style:Ft,className:jt,classNames:Bt,styles:Vt,unstyled:zt,vars:Ht,mod:Gt,...qt}=Ct,Wt=useStyles({name:"ComboboxChevron",classes:classes$I,props:Ct,style:Ft,className:jt,classNames:Bt,styles:Vt,unstyled:zt,vars:Ht,varsResolver:varsResolver$F,rootSelector:"chevron"});return jsxRuntimeExports.jsx(Box,{component:"svg",...qt,...Wt("chevron"),size:kt,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",mod:["combobox-chevron",{error:Mt},Gt],ref:$t,children:jsxRuntimeExports.jsx("path",{d:"M4.93179 5.43179C4.75605 5.60753 4.75605 5.89245 4.93179 6.06819C5.10753 6.24392 5.39245 6.24392 5.56819 6.06819L7.49999 4.13638L9.43179 6.06819C9.60753 6.24392 9.89245 6.24392 10.0682 6.06819C10.2439 5.89245 10.2439 5.60753 10.0682 5.43179L7.81819 3.18179C7.73379 3.0974 7.61933 3.04999 7.49999 3.04999C7.38064 3.04999 7.26618 3.0974 7.18179 3.18179L4.93179 5.43179ZM10.0682 9.56819C10.2439 9.39245 10.2439 9.10753 10.0682 8.93179C9.89245 8.75606 9.60753 8.75606 9.43179 8.93179L7.49999 10.8636L5.56819 8.93179C5.39245 8.75606 5.10753 8.75606 4.93179 8.93179C4.75605 9.10753 4.75605 9.39245 4.93179 9.56819L7.18179 11.8182C7.35753 11.9939 7.64245 11.9939 7.81819 11.8182L10.0682 9.56819Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})});ComboboxChevron.classes=classes$I;ComboboxChevron.displayName="@mantine/core/ComboboxChevron";const[ComboboxProvider,useComboboxContext]=createSafeContext("Combobox component was not found in tree"),ComboboxClearButton=reactExports.forwardRef(({size:xt,onMouseDown:$t,onClick:Ct,onClear:kt,...Mt},Ft)=>jsxRuntimeExports.jsx(CloseButton,{ref:Ft,size:xt||"sm",variant:"transparent",tabIndex:-1,"aria-hidden":!0,...Mt,onMouseDown:jt=>{jt.preventDefault(),$t==null||$t(jt)},onClick:jt=>{kt(),Ct==null||Ct(jt)}}));ComboboxClearButton.displayName="@mantine/core/ComboboxClearButton";const defaultProps$1G={},ComboboxDropdown=factory$2((xt,$t)=>{const{classNames:Ct,styles:kt,className:Mt,style:Ft,hidden:jt,...Bt}=useProps("ComboboxDropdown",defaultProps$1G,xt),Vt=useComboboxContext();return jsxRuntimeExports.jsx(Popover.Dropdown,{...Bt,ref:$t,role:"presentation","data-hidden":jt||void 0,...Vt.getStyles("dropdown",{className:Mt,style:Ft,classNames:Ct,styles:kt})})});ComboboxDropdown.classes=classes$I;ComboboxDropdown.displayName="@mantine/core/ComboboxDropdown";const defaultProps$1F={refProp:"ref"},ComboboxDropdownTarget=factory$2((xt,$t)=>{const{children:Ct,refProp:kt}=useProps("ComboboxDropdownTarget",defaultProps$1F,xt);if(useComboboxContext(),!isElement$1(Ct))throw new Error("Combobox.DropdownTarget component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");return jsxRuntimeExports.jsx(Popover.Target,{ref:$t,refProp:kt,children:Ct})});ComboboxDropdownTarget.displayName="@mantine/core/ComboboxDropdownTarget";const defaultProps$1E={},ComboboxEmpty=factory$2((xt,$t)=>{const{classNames:Ct,className:kt,style:Mt,styles:Ft,vars:jt,...Bt}=useProps("ComboboxEmpty",defaultProps$1E,xt),Vt=useComboboxContext();return jsxRuntimeExports.jsx(Box,{ref:$t,...Vt.getStyles("empty",{className:kt,classNames:Ct,styles:Ft,style:Mt}),...Bt})});ComboboxEmpty.classes=classes$I;ComboboxEmpty.displayName="@mantine/core/ComboboxEmpty";function useComboboxTargetProps({onKeyDown:xt,withKeyboardNavigation:$t,withAriaAttributes:Ct,withExpandedAttribute:kt,targetType:Mt,autoComplete:Ft}){const jt=useComboboxContext(),[Bt,Vt]=reactExports.useState(null),zt=Gt=>{if(xt==null||xt(Gt),!jt.readOnly&&$t){if(Gt.nativeEvent.isComposing)return;if(Gt.nativeEvent.code==="ArrowDown"&&(Gt.preventDefault(),jt.store.dropdownOpened?Vt(jt.store.selectNextOption()):(jt.store.openDropdown("keyboard"),Vt(jt.store.selectActiveOption()))),Gt.nativeEvent.code==="ArrowUp"&&(Gt.preventDefault(),jt.store.dropdownOpened?Vt(jt.store.selectPreviousOption()):(jt.store.openDropdown("keyboard"),Vt(jt.store.selectActiveOption()))),Gt.nativeEvent.code==="Enter"||Gt.nativeEvent.code==="NumpadEnter"){if(Gt.nativeEvent.keyCode===229)return;const qt=jt.store.getSelectedOptionIndex();jt.store.dropdownOpened&&qt!==-1?(Gt.preventDefault(),jt.store.clickSelectedOption()):Mt==="button"&&(Gt.preventDefault(),jt.store.openDropdown("keyboard"))}Gt.nativeEvent.code==="Escape"&&jt.store.closeDropdown("keyboard"),Gt.nativeEvent.code==="Space"&&Mt==="button"&&(Gt.preventDefault(),jt.store.toggleDropdown("keyboard"))}};return{...Ct?{"aria-haspopup":"listbox","aria-expanded":kt&&!!(jt.store.listId&&jt.store.dropdownOpened)||void 0,"aria-controls":jt.store.listId,"aria-activedescendant":jt.store.dropdownOpened&&Bt||void 0,autoComplete:Ft,"data-expanded":jt.store.dropdownOpened||void 0,"data-mantine-stop-propagation":jt.store.dropdownOpened||void 0}:{},onKeyDown:zt}}const defaultProps$1D={refProp:"ref",targetType:"input",withKeyboardNavigation:!0,withAriaAttributes:!0,withExpandedAttribute:!1,autoComplete:"off"},ComboboxEventsTarget=factory$2((xt,$t)=>{const{children:Ct,refProp:kt,withKeyboardNavigation:Mt,withAriaAttributes:Ft,withExpandedAttribute:jt,targetType:Bt,autoComplete:Vt,...zt}=useProps("ComboboxEventsTarget",defaultProps$1D,xt);if(!isElement$1(Ct))throw new Error("Combobox.EventsTarget component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const Ht=useComboboxContext(),Gt=useComboboxTargetProps({targetType:Bt,withAriaAttributes:Ft,withKeyboardNavigation:Mt,withExpandedAttribute:jt,onKeyDown:Ct.props.onKeyDown,autoComplete:Vt});return reactExports.cloneElement(Ct,{...Gt,...zt,[kt]:useMergedRef($t,Ht.store.targetRef,Ct==null?void 0:Ct.ref)})});ComboboxEventsTarget.displayName="@mantine/core/ComboboxEventsTarget";const defaultProps$1C={},ComboboxFooter=factory$2((xt,$t)=>{const{classNames:Ct,className:kt,style:Mt,styles:Ft,vars:jt,...Bt}=useProps("ComboboxFooter",defaultProps$1C,xt),Vt=useComboboxContext();return jsxRuntimeExports.jsx(Box,{ref:$t,...Vt.getStyles("footer",{className:kt,classNames:Ct,style:Mt,styles:Ft}),...Bt})});ComboboxFooter.classes=classes$I;ComboboxFooter.displayName="@mantine/core/ComboboxFooter";const defaultProps$1B={},ComboboxGroup=factory$2((xt,$t)=>{const{classNames:Ct,className:kt,style:Mt,styles:Ft,vars:jt,children:Bt,label:Vt,...zt}=useProps("ComboboxGroup",defaultProps$1B,xt),Ht=useComboboxContext();return jsxRuntimeExports.jsxs(Box,{ref:$t,...Ht.getStyles("group",{className:kt,classNames:Ct,style:Mt,styles:Ft}),...zt,children:[Vt&&jsxRuntimeExports.jsx("div",{...Ht.getStyles("groupLabel",{classNames:Ct,styles:Ft}),children:Vt}),Bt]})});ComboboxGroup.classes=classes$I;ComboboxGroup.displayName="@mantine/core/ComboboxGroup";const defaultProps$1A={},ComboboxHeader=factory$2((xt,$t)=>{const{classNames:Ct,className:kt,style:Mt,styles:Ft,vars:jt,...Bt}=useProps("ComboboxHeader",defaultProps$1A,xt),Vt=useComboboxContext();return jsxRuntimeExports.jsx(Box,{ref:$t,...Vt.getStyles("header",{className:kt,classNames:Ct,style:Mt,styles:Ft}),...Bt})});ComboboxHeader.classes=classes$I;ComboboxHeader.displayName="@mantine/core/ComboboxHeader";function ComboboxHiddenInput({value:xt,valuesDivider:$t=",",...Ct}){return jsxRuntimeExports.jsx("input",{type:"hidden",value:Array.isArray(xt)?xt.join($t):xt||"",...Ct})}ComboboxHiddenInput.displayName="@mantine/core/ComboboxHiddenInput";const defaultProps$1z={},ComboboxOption=factory$2((xt,$t)=>{const Ct=useProps("ComboboxOption",defaultProps$1z,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,onClick:Vt,id:zt,active:Ht,onMouseDown:Gt,onMouseOver:qt,disabled:Wt,selected:Yt,mod:Kt,...Xt}=Ct,Qt=useComboboxContext(),Jt=reactExports.useId(),Zt=zt||Jt;return jsxRuntimeExports.jsx(Box,{...Qt.getStyles("option",{className:Mt,classNames:kt,styles:jt,style:Ft}),...Xt,ref:$t,id:Zt,mod:["combobox-option",{"combobox-active":Ht,"combobox-disabled":Wt,"combobox-selected":Yt},Kt],role:"option",onClick:sn=>{var ln;Wt?sn.preventDefault():((ln=Qt.onOptionSubmit)==null||ln.call(Qt,Ct.value,Ct),Vt==null||Vt(sn))},onMouseDown:sn=>{sn.preventDefault(),Gt==null||Gt(sn)},onMouseOver:sn=>{Qt.resetSelectionOnOptionHover&&Qt.store.resetSelectedOption(),qt==null||qt(sn)}})});ComboboxOption.classes=classes$I;ComboboxOption.displayName="@mantine/core/ComboboxOption";const defaultProps$1y={},ComboboxOptions=factory$2((xt,$t)=>{const Ct=useProps("ComboboxOptions",defaultProps$1y,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,id:Bt,onMouseDown:Vt,labelledBy:zt,...Ht}=Ct,Gt=useComboboxContext(),qt=useId$1(Bt);return reactExports.useEffect(()=>{Gt.store.setListId(qt)},[qt]),jsxRuntimeExports.jsx(Box,{ref:$t,...Gt.getStyles("options",{className:Mt,style:Ft,classNames:kt,styles:jt}),...Ht,id:qt,role:"listbox","aria-labelledby":zt,onMouseDown:Wt=>{Wt.preventDefault(),Vt==null||Vt(Wt)}})});ComboboxOptions.classes=classes$I;ComboboxOptions.displayName="@mantine/core/ComboboxOptions";const defaultProps$1x={withAriaAttributes:!0,withKeyboardNavigation:!0},ComboboxSearch=factory$2((xt,$t)=>{const Ct=useProps("ComboboxSearch",defaultProps$1x,xt),{classNames:kt,styles:Mt,unstyled:Ft,vars:jt,withAriaAttributes:Bt,onKeyDown:Vt,withKeyboardNavigation:zt,size:Ht,...Gt}=Ct,qt=useComboboxContext(),Wt=qt.getStyles("search"),Yt=useComboboxTargetProps({targetType:"input",withAriaAttributes:Bt,withKeyboardNavigation:zt,withExpandedAttribute:!1,onKeyDown:Vt,autoComplete:"off"});return jsxRuntimeExports.jsx(Input,{ref:useMergedRef($t,qt.store.searchRef),classNames:[{input:Wt.className},kt],styles:[{input:Wt.style},Mt],size:Ht||qt.size,...Yt,...Gt,__staticSelector:"Combobox"})});ComboboxSearch.classes=classes$I;ComboboxSearch.displayName="@mantine/core/ComboboxSearch";const defaultProps$1w={refProp:"ref",targetType:"input",withKeyboardNavigation:!0,withAriaAttributes:!0,withExpandedAttribute:!1,autoComplete:"off"},ComboboxTarget=factory$2((xt,$t)=>{const{children:Ct,refProp:kt,withKeyboardNavigation:Mt,withAriaAttributes:Ft,withExpandedAttribute:jt,targetType:Bt,autoComplete:Vt,...zt}=useProps("ComboboxTarget",defaultProps$1w,xt);if(!isElement$1(Ct))throw new Error("Combobox.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const Ht=useComboboxContext(),Gt=useComboboxTargetProps({targetType:Bt,withAriaAttributes:Ft,withKeyboardNavigation:Mt,withExpandedAttribute:jt,onKeyDown:Ct.props.onKeyDown,autoComplete:Vt}),qt=reactExports.cloneElement(Ct,{...Gt,...zt});return jsxRuntimeExports.jsx(Popover.Target,{ref:useMergedRef($t,Ht.store.targetRef),children:qt})});ComboboxTarget.displayName="@mantine/core/ComboboxTarget";function getPreviousIndex(xt,$t,Ct){for(let kt=xt-1;kt>=0;kt-=1)if(!$t[kt].hasAttribute("data-combobox-disabled"))return kt;if(Ct){for(let kt=$t.length-1;kt>-1;kt-=1)if(!$t[kt].hasAttribute("data-combobox-disabled"))return kt}return xt}function getNextIndex$1(xt,$t,Ct){for(let kt=xt+1;kt<$t.length;kt+=1)if(!$t[kt].hasAttribute("data-combobox-disabled"))return kt;if(Ct){for(let kt=0;kt<$t.length;kt+=1)if(!$t[kt].hasAttribute("data-combobox-disabled"))return kt}return xt}function getFirstIndex(xt){for(let $t=0;$t<xt.length;$t+=1)if(!xt[$t].hasAttribute("data-combobox-disabled"))return $t;return-1}function useCombobox({defaultOpened:xt,opened:$t,onOpenedChange:Ct,onDropdownClose:kt,onDropdownOpen:Mt,loop:Ft=!0,scrollBehavior:jt="instant"}={}){const[Bt,Vt]=useUncontrolled({value:$t,defaultValue:xt,finalValue:!1,onChange:Ct}),zt=reactExports.useRef(null),Ht=reactExports.useRef(-1),Gt=reactExports.useRef(null),qt=reactExports.useRef(null),Wt=reactExports.useRef(-1),Yt=reactExports.useRef(-1),Kt=reactExports.useRef(-1),Xt=reactExports.useCallback(($n="unknown")=>{Bt||(Vt(!0),Mt==null||Mt($n))},[Vt,Mt,Bt]),Qt=reactExports.useCallback(($n="unknown")=>{Bt&&(Vt(!1),kt==null||kt($n))},[Vt,kt,Bt]),Jt=reactExports.useCallback(($n="unknown")=>{Bt?Qt($n):Xt($n)},[Qt,Xt,Bt]),Zt=reactExports.useCallback(()=>{const $n=document.querySelector(`#${zt.current} [data-combobox-selected]`);$n==null||$n.removeAttribute("data-combobox-selected"),$n==null||$n.removeAttribute("aria-selected")},[]),sn=reactExports.useCallback($n=>{const wn=document.getElementById(zt.current),Rn=wn==null?void 0:wn.querySelectorAll("[data-combobox-option]");if(!Rn)return null;const Dn=$n>=Rn.length?0:$n<0?Rn.length-1:$n;return Ht.current=Dn,Rn!=null&&Rn[Dn]&&!Rn[Dn].hasAttribute("data-combobox-disabled")?(Zt(),Rn[Dn].setAttribute("data-combobox-selected","true"),Rn[Dn].setAttribute("aria-selected","true"),Rn[Dn].scrollIntoView({block:"nearest",behavior:jt}),Rn[Dn].id):null},[jt,Zt]),ln=reactExports.useCallback(()=>{const $n=document.querySelector(`#${zt.current} [data-combobox-active]`);if($n){const wn=document.querySelectorAll(`#${zt.current} [data-combobox-option]`),Rn=Array.from(wn).findIndex(Dn=>Dn===$n);return sn(Rn)}return sn(0)},[sn]),dn=reactExports.useCallback(()=>sn(getNextIndex$1(Ht.current,document.querySelectorAll(`#${zt.current} [data-combobox-option]`),Ft)),[sn,Ft]),hn=reactExports.useCallback(()=>sn(getPreviousIndex(Ht.current,document.querySelectorAll(`#${zt.current} [data-combobox-option]`),Ft)),[sn,Ft]),cn=reactExports.useCallback(()=>sn(getFirstIndex(document.querySelectorAll(`#${zt.current} [data-combobox-option]`))),[sn]),pn=reactExports.useCallback(($n="selected",wn)=>{Kt.current=window.setTimeout(()=>{var An;const Rn=document.querySelectorAll(`#${zt.current} [data-combobox-option]`),Dn=Array.from(Rn).findIndex(Sn=>Sn.hasAttribute(`data-combobox-${$n}`));Ht.current=Dn,wn!=null&&wn.scrollIntoView&&((An=Rn[Dn])==null||An.scrollIntoView({block:"nearest",behavior:jt}))},0)},[]),yn=reactExports.useCallback(()=>{Ht.current=-1,Zt()},[Zt]),gn=reactExports.useCallback(()=>{const $n=document.querySelectorAll(`#${zt.current} [data-combobox-option]`),wn=$n==null?void 0:$n[Ht.current];wn==null||wn.click()},[]),En=reactExports.useCallback($n=>{zt.current=$n},[]),bn=reactExports.useCallback(()=>{Wt.current=window.setTimeout(()=>Gt.current.focus(),0)},[]),xn=reactExports.useCallback(()=>{Yt.current=window.setTimeout(()=>qt.current.focus(),0)},[]),Cn=reactExports.useCallback(()=>Ht.current,[]);return reactExports.useEffect(()=>()=>{window.clearTimeout(Wt.current),window.clearTimeout(Yt.current),window.clearTimeout(Kt.current)},[]),{dropdownOpened:Bt,openDropdown:Xt,closeDropdown:Qt,toggleDropdown:Jt,selectedOptionIndex:Ht.current,getSelectedOptionIndex:Cn,selectOption:sn,selectFirstOption:cn,selectActiveOption:ln,selectNextOption:dn,selectPreviousOption:hn,resetSelectedOption:yn,updateSelectedOptionIndex:pn,listId:zt.current,setListId:En,clickSelectedOption:gn,searchRef:Gt,focusSearchInput:bn,targetRef:qt,focusTarget:xn}}const defaultProps$1v={keepMounted:!0,withinPortal:!0,resetSelectionOnOptionHover:!1,width:"target",transitionProps:{transition:"fade",duration:0}},varsResolver$E=(xt,{size:$t,dropdownPadding:Ct})=>({options:{"--combobox-option-fz":getFontSize$1($t),"--combobox-option-padding":getSize($t,"combobox-option-padding")},dropdown:{"--combobox-padding":Ct===void 0?void 0:rem$1(Ct),"--combobox-option-fz":getFontSize$1($t),"--combobox-option-padding":getSize($t,"combobox-option-padding")}});function Combobox(xt){const $t=useProps("Combobox",defaultProps$1v,xt),{classNames:Ct,styles:kt,unstyled:Mt,children:Ft,store:jt,vars:Bt,onOptionSubmit:Vt,onClose:zt,size:Ht,dropdownPadding:Gt,resetSelectionOnOptionHover:qt,__staticSelector:Wt,readOnly:Yt,...Kt}=$t,Xt=useCombobox(),Qt=jt||Xt,Jt=useStyles({name:Wt||"Combobox",classes:classes$I,props:$t,classNames:Ct,styles:kt,unstyled:Mt,vars:Bt,varsResolver:varsResolver$E}),Zt=()=>{zt==null||zt(),Qt.closeDropdown()};return jsxRuntimeExports.jsx(ComboboxProvider,{value:{getStyles:Jt,store:Qt,onOptionSubmit:Vt,size:Ht,resetSelectionOnOptionHover:qt,readOnly:Yt},children:jsxRuntimeExports.jsx(Popover,{opened:Qt.dropdownOpened,...Kt,onClose:Zt,withRoles:!1,unstyled:Mt,children:Ft})})}const extendCombobox=xt=>xt;Combobox.extend=extendCombobox;Combobox.classes=classes$I;Combobox.displayName="@mantine/core/Combobox";Combobox.Target=ComboboxTarget;Combobox.Dropdown=ComboboxDropdown;Combobox.Options=ComboboxOptions;Combobox.Option=ComboboxOption;Combobox.Search=ComboboxSearch;Combobox.Empty=ComboboxEmpty;Combobox.Chevron=ComboboxChevron;Combobox.Footer=ComboboxFooter;Combobox.Header=ComboboxHeader;Combobox.EventsTarget=ComboboxEventsTarget;Combobox.DropdownTarget=ComboboxDropdownTarget;Combobox.Group=ComboboxGroup;Combobox.ClearButton=ComboboxClearButton;Combobox.HiddenInput=ComboboxHiddenInput;var classes$H={root:"m_5f75b09e",body:"m_5f6e695e",labelWrapper:"m_d3ea56bb",label:"m_8ee546b8",description:"m_328f68c0",error:"m_8e8a99cc"};const InlineInputClasses=classes$H,InlineInput=reactExports.forwardRef(({__staticSelector:xt,__stylesApiProps:$t,className:Ct,classNames:kt,styles:Mt,unstyled:Ft,children:jt,label:Bt,description:Vt,id:zt,disabled:Ht,error:Gt,size:qt,labelPosition:Wt="left",bodyElement:Yt="div",labelElement:Kt="label",variant:Xt,style:Qt,vars:Jt,mod:Zt,...sn},ln)=>{const dn=useStyles({name:xt,props:$t,className:Ct,style:Qt,classes:classes$H,classNames:kt,styles:Mt,unstyled:Ft});return jsxRuntimeExports.jsx(Box,{...dn("root"),ref:ln,__vars:{"--label-fz":getFontSize$1(qt),"--label-lh":getSize(qt,"label-lh")},mod:[{"label-position":Wt},Zt],variant:Xt,size:qt,...sn,children:jsxRuntimeExports.jsxs(Box,{component:Yt,htmlFor:Yt==="label"?zt:void 0,...dn("body"),children:[jt,jsxRuntimeExports.jsxs("div",{...dn("labelWrapper"),"data-disabled":Ht||void 0,children:[Bt&&jsxRuntimeExports.jsx(Box,{component:Kt,htmlFor:Kt==="label"?zt:void 0,...dn("label"),"data-disabled":Ht||void 0,children:Bt}),Vt&&jsxRuntimeExports.jsx(Input.Description,{size:qt,__inheritStyles:!1,...dn("description"),children:Vt}),Gt&&typeof Gt!="boolean"&&jsxRuntimeExports.jsx(Input.Error,{size:qt,__inheritStyles:!1,...dn("error"),children:Gt})]})]})})});InlineInput.displayName="@mantine/core/InlineInput";const CheckboxGroupContext=reactExports.createContext(null),CheckboxGroupProvider=CheckboxGroupContext.Provider,useCheckboxGroupContext=()=>reactExports.useContext(CheckboxGroupContext),[CheckboxCardProvider,useCheckboxCardContext]=createOptionalContext();var classes$G={card:"m_26775b0a"};const defaultProps$1u={withBorder:!0},varsResolver$D=(xt,{radius:$t})=>({card:{"--card-radius":getRadius($t)}}),CheckboxCard=factory$2((xt,$t)=>{const Ct=useProps("CheckboxCard",defaultProps$1u,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,checked:zt,mod:Ht,withBorder:Gt,value:qt,onClick:Wt,...Yt}=Ct,Kt=useStyles({name:"CheckboxCard",classes:classes$G,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$D,rootSelector:"card"}),Xt=useCheckboxGroupContext(),Qt=typeof zt=="boolean"?zt:(Xt==null?void 0:Xt.value.includes(qt||""))||!1;return jsxRuntimeExports.jsx(CheckboxCardProvider,{value:{checked:Qt},children:jsxRuntimeExports.jsx(UnstyledButton,{ref:$t,mod:[{"with-border":Gt,checked:Qt},Ht],...Kt("card"),...Yt,role:"checkbox","aria-checked":Qt,onClick:Jt=>{Wt==null||Wt(Jt),Xt==null||Xt.onChange(qt||"")}})})});CheckboxCard.displayName="@mantine/core/CheckboxCard";CheckboxCard.classes=classes$G;function InputsGroupFieldset({children:xt,role:$t}){const Ct=useInputWrapperContext();return Ct?jsxRuntimeExports.jsx("div",{role:$t,"aria-labelledby":Ct.labelId,"aria-describedby":Ct.describedBy,children:xt}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:xt})}const defaultProps$1t={},CheckboxGroup=factory$2((xt,$t)=>{const{value:Ct,defaultValue:kt,onChange:Mt,size:Ft,wrapperProps:jt,children:Bt,readOnly:Vt,...zt}=useProps("CheckboxGroup",defaultProps$1t,xt),[Ht,Gt]=useUncontrolled({value:Ct,defaultValue:kt,finalValue:[],onChange:Mt}),qt=Wt=>{const Yt=typeof Wt=="string"?Wt:Wt.currentTarget.value;!Vt&&Gt(Ht.includes(Yt)?Ht.filter(Kt=>Kt!==Yt):[...Ht,Yt])};return jsxRuntimeExports.jsx(CheckboxGroupProvider,{value:{value:Ht,onChange:qt,size:Ft},children:jsxRuntimeExports.jsx(Input.Wrapper,{size:Ft,ref:$t,...jt,...zt,labelElement:"div",__staticSelector:"CheckboxGroup",children:jsxRuntimeExports.jsx(InputsGroupFieldset,{role:"group",children:Bt})})})});CheckboxGroup.classes=Input.Wrapper.classes;CheckboxGroup.displayName="@mantine/core/CheckboxGroup";function CheckIcon({size:xt,style:$t,...Ct}){const kt=xt!==void 0?{width:rem$1(xt),height:rem$1(xt),...$t}:$t;return jsxRuntimeExports.jsx("svg",{viewBox:"0 0 10 7",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:kt,"aria-hidden":!0,...Ct,children:jsxRuntimeExports.jsx("path",{d:"M4 4.586L1.707 2.293A1 1 0 1 0 .293 3.707l3 3a.997.997 0 0 0 1.414 0l5-5A1 1 0 1 0 8.293.293L4 4.586z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function CheckboxIcon({indeterminate:xt,...$t}){return xt?jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 32 6","aria-hidden":!0,...$t,children:jsxRuntimeExports.jsx("rect",{width:"32",height:"6",fill:"currentColor",rx:"3"})}):jsxRuntimeExports.jsx(CheckIcon,{...$t})}var classes$F={indicator:"m_5e5256ee",icon:"m_1b1c543a","indicator--outline":"m_76e20374"};const defaultProps$1s={icon:CheckboxIcon},varsResolver$C=(xt,{radius:$t,color:Ct,size:kt,iconColor:Mt,variant:Ft,autoContrast:jt})=>{const Bt=parseThemeColor({color:Ct||xt.primaryColor,theme:xt}),Vt=Bt.isThemeColor&&Bt.shade===void 0?`var(--mantine-color-${Bt.color}-outline)`:Bt.color;return{indicator:{"--checkbox-size":getSize(kt,"checkbox-size"),"--checkbox-radius":$t===void 0?void 0:getRadius($t),"--checkbox-color":Ft==="outline"?Vt:getThemeColor(Ct,xt),"--checkbox-icon-color":Mt?getThemeColor(Mt,xt):getAutoContrastValue(jt,xt)?getContrastColor({color:Ct,theme:xt,autoContrast:jt}):void 0}}},CheckboxIndicator=factory$2((xt,$t)=>{const Ct=useProps("CheckboxIndicator",defaultProps$1s,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,icon:zt,indeterminate:Ht,radius:Gt,color:qt,iconColor:Wt,autoContrast:Yt,checked:Kt,mod:Xt,variant:Qt,disabled:Jt,...Zt}=Ct,sn=zt,ln=useStyles({name:"CheckboxIndicator",classes:classes$F,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$C,rootSelector:"indicator"}),dn=useCheckboxCardContext(),hn=typeof Kt=="boolean"||typeof Ht=="boolean"?Kt||Ht:(dn==null?void 0:dn.checked)||!1;return jsxRuntimeExports.jsx(Box,{ref:$t,...ln("indicator",{variant:Qt}),variant:Qt,mod:[{checked:hn,disabled:Jt},Xt],...Zt,children:jsxRuntimeExports.jsx(sn,{indeterminate:Ht,...ln("icon")})})});CheckboxIndicator.displayName="@mantine/core/CheckboxIndicator";CheckboxIndicator.classes=classes$F;var classes$E={root:"m_bf2d988c",inner:"m_26062bec",input:"m_26063560",icon:"m_bf295423","input--outline":"m_215c4542"};const defaultProps$1r={labelPosition:"right",icon:CheckboxIcon},varsResolver$B=(xt,{radius:$t,color:Ct,size:kt,iconColor:Mt,variant:Ft,autoContrast:jt})=>{const Bt=parseThemeColor({color:Ct||xt.primaryColor,theme:xt}),Vt=Bt.isThemeColor&&Bt.shade===void 0?`var(--mantine-color-${Bt.color}-outline)`:Bt.color;return{root:{"--checkbox-size":getSize(kt,"checkbox-size"),"--checkbox-radius":$t===void 0?void 0:getRadius($t),"--checkbox-color":Ft==="outline"?Vt:getThemeColor(Ct,xt),"--checkbox-icon-color":Mt?getThemeColor(Mt,xt):getAutoContrastValue(jt,xt)?getContrastColor({color:Ct,theme:xt,autoContrast:jt}):void 0}}},Checkbox=factory$2((xt,$t)=>{const Ct=useProps("Checkbox",defaultProps$1r,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,color:zt,label:Ht,id:Gt,size:qt,radius:Wt,wrapperProps:Yt,children:Kt,checked:Xt,labelPosition:Qt,description:Jt,error:Zt,disabled:sn,variant:ln,indeterminate:dn,icon:hn,rootRef:cn,iconColor:pn,onChange:yn,autoContrast:gn,mod:En,...bn}=Ct,xn=useCheckboxGroupContext(),Cn=qt||(xn==null?void 0:xn.size),$n=hn,wn=useStyles({name:"Checkbox",props:Ct,classes:classes$E,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$B}),{styleProps:Rn,rest:Dn}=extractStyleProps(bn),An=useId$1(Gt),Sn=xn?{checked:xn.value.includes(Dn.value),onChange:vn=>{xn.onChange(vn),yn==null||yn(vn)}}:{};return jsxRuntimeExports.jsx(InlineInput,{...wn("root"),__staticSelector:"Checkbox",__stylesApiProps:Ct,id:An,size:Cn,labelPosition:Qt,label:Ht,description:Jt,error:Zt,disabled:sn,classNames:kt,styles:jt,unstyled:Bt,"data-checked":Sn.checked||Xt||void 0,variant:ln,ref:cn,mod:En,...Rn,...Yt,children:jsxRuntimeExports.jsxs(Box,{...wn("inner"),mod:{"data-label-position":Qt},children:[jsxRuntimeExports.jsx(Box,{component:"input",id:An,ref:$t,checked:Xt,disabled:sn,mod:{error:!!Zt,indeterminate:dn},...wn("input",{focusable:!0,variant:ln}),onChange:yn,...Dn,...Sn,type:"checkbox"}),jsxRuntimeExports.jsx($n,{indeterminate:dn,...wn("icon")})]})})});Checkbox.classes={...classes$E,...InlineInputClasses};Checkbox.displayName="@mantine/core/Checkbox";Checkbox.Group=CheckboxGroup;Checkbox.Indicator=CheckboxIndicator;Checkbox.Card=CheckboxCard;function isOptionsGroup(xt){return"group"in xt}function defaultOptionsFilter({options:xt,search:$t,limit:Ct}){const kt=$t.trim().toLowerCase(),Mt=[];for(let Ft=0;Ft<xt.length;Ft+=1){const jt=xt[Ft];if(Mt.length===Ct)return Mt;isOptionsGroup(jt)&&Mt.push({group:jt.group,items:defaultOptionsFilter({options:jt.items,search:$t,limit:Ct-Mt.length})}),isOptionsGroup(jt)||jt.label.toLowerCase().includes(kt)&&Mt.push(jt)}return Mt}function isEmptyComboboxData(xt){if(xt.length===0)return!0;for(const $t of xt)if(!("group"in $t)||$t.items.length>0)return!1;return!0}function validateOptions(xt,$t=new Set){if(Array.isArray(xt))for(const Ct of xt)if(isOptionsGroup(Ct))validateOptions(Ct.items,$t);else{if(typeof Ct.value>"u")throw new Error("[@mantine/core] Each option must have value property");if(typeof Ct.value!="string")throw new Error(`[@mantine/core] Option value must be a string, other data formats are not supported, got ${typeof Ct.value}`);if($t.has(Ct.value))throw new Error(`[@mantine/core] Duplicate options are not supported. Option with value "${Ct.value}" was provided more than once`);$t.add(Ct.value)}}function isValueChecked(xt,$t){return Array.isArray(xt)?xt.includes($t):xt===$t}function Option({data:xt,withCheckIcon:$t,value:Ct,checkIconPosition:kt,unstyled:Mt,renderOption:Ft}){if(!isOptionsGroup(xt)){const Bt=isValueChecked(Ct,xt.value),Vt=$t&&Bt&&jsxRuntimeExports.jsx(CheckIcon,{className:classes$I.optionsDropdownCheckIcon}),zt=jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[kt==="left"&&Vt,jsxRuntimeExports.jsx("span",{children:xt.label}),kt==="right"&&Vt]});return jsxRuntimeExports.jsx(Combobox.Option,{value:xt.value,disabled:xt.disabled,className:clsx({[classes$I.optionsDropdownOption]:!Mt}),"data-reverse":kt==="right"||void 0,"data-checked":Bt||void 0,"aria-selected":Bt,active:Bt,children:typeof Ft=="function"?Ft({option:xt,checked:Bt}):zt})}const jt=xt.items.map(Bt=>jsxRuntimeExports.jsx(Option,{data:Bt,value:Ct,unstyled:Mt,withCheckIcon:$t,checkIconPosition:kt,renderOption:Ft},Bt.value));return jsxRuntimeExports.jsx(Combobox.Group,{label:xt.group,children:jt})}function OptionsDropdown({data:xt,hidden:$t,hiddenWhenEmpty:Ct,filter:kt,search:Mt,limit:Ft,maxDropdownHeight:jt,withScrollArea:Bt=!0,filterOptions:Vt=!0,withCheckIcon:zt=!1,value:Ht,checkIconPosition:Gt,nothingFoundMessage:qt,unstyled:Wt,labelId:Yt,renderOption:Kt,scrollAreaProps:Xt,"aria-label":Qt}){validateOptions(xt);const Zt=typeof Mt=="string"?(kt||defaultOptionsFilter)({options:xt,search:Vt?Mt:"",limit:Ft??1/0}):xt,sn=isEmptyComboboxData(Zt),ln=Zt.map(dn=>jsxRuntimeExports.jsx(Option,{data:dn,withCheckIcon:zt,value:Ht,checkIconPosition:Gt,unstyled:Wt,renderOption:Kt},isOptionsGroup(dn)?dn.group:dn.value));return jsxRuntimeExports.jsx(Combobox.Dropdown,{hidden:$t||Ct&&sn,children:jsxRuntimeExports.jsxs(Combobox.Options,{labelledBy:Yt,"aria-label":Qt,children:[Bt?jsxRuntimeExports.jsx(ScrollArea.Autosize,{mah:jt??220,type:"scroll",scrollbarSize:"var(--combobox-padding)",offsetScrollbars:"y",...Xt,children:ln}):ln,sn&&qt&&jsxRuntimeExports.jsx(Combobox.Empty,{children:qt})]})})}var classes$D={root:"m_347db0ec","root--dot":"m_fbd81e3d",label:"m_5add502a",section:"m_91fdda9b"};const defaultProps$1q={},varsResolver$A=(xt,{radius:$t,color:Ct,gradient:kt,variant:Mt,size:Ft,autoContrast:jt})=>{const Bt=xt.variantColorResolver({color:Ct||xt.primaryColor,theme:xt,gradient:kt,variant:Mt||"filled",autoContrast:jt});return{root:{"--badge-height":getSize(Ft,"badge-height"),"--badge-padding-x":getSize(Ft,"badge-padding-x"),"--badge-fz":getSize(Ft,"badge-fz"),"--badge-radius":$t===void 0?void 0:getRadius($t),"--badge-bg":Ct||Mt?Bt.background:void 0,"--badge-color":Ct||Mt?Bt.color:void 0,"--badge-bd":Ct||Mt?Bt.border:void 0,"--badge-dot-color":Mt==="dot"?getThemeColor(Ct,xt):void 0}}},Badge=polymorphicFactory((xt,$t)=>{const Ct=useProps("Badge",defaultProps$1q,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,radius:zt,color:Ht,gradient:Gt,leftSection:qt,rightSection:Wt,children:Yt,variant:Kt,fullWidth:Xt,autoContrast:Qt,circle:Jt,mod:Zt,...sn}=Ct,ln=useStyles({name:"Badge",props:Ct,classes:classes$D,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$A});return jsxRuntimeExports.jsxs(Box,{variant:Kt,mod:[{block:Xt,circle:Jt},Zt],...ln("root",{variant:Kt}),ref:$t,...sn,children:[qt&&jsxRuntimeExports.jsx("span",{...ln("section"),"data-position":"left",children:qt}),jsxRuntimeExports.jsx("span",{...ln("label"),children:Yt}),Wt&&jsxRuntimeExports.jsx("span",{...ln("section"),"data-position":"right",children:Wt})]})});Badge.classes=classes$D;Badge.displayName="@mantine/core/Badge";var classes$C={root:"m_fea6bf1a",burger:"m_d4fb9cad"};const defaultProps$1p={},varsResolver$z=(xt,{color:$t,size:Ct,transitionDuration:kt,transitionTimingFunction:Mt})=>({root:{"--burger-color":$t?getThemeColor($t,xt):void 0,"--burger-size":getSize(Ct,"burger-size"),"--burger-transition-duration":kt===void 0?void 0:`${kt}ms`,"--burger-transition-timing-function":Mt}}),Burger=factory$2((xt,$t)=>{const Ct=useProps("Burger",defaultProps$1p,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,opened:zt,children:Ht,transitionDuration:Gt,transitionTimingFunction:qt,...Wt}=Ct,Yt=useStyles({name:"Burger",classes:classes$C,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$z});return jsxRuntimeExports.jsxs(UnstyledButton,{...Yt("root"),ref:$t,...Wt,children:[jsxRuntimeExports.jsx(Box,{mod:["reduce-motion",{opened:zt}],...Yt("burger")}),Ht]})});Burger.classes=classes$C;Burger.displayName="@mantine/core/Burger";var classes$B={root:"m_77c9d27d",inner:"m_80f1301b",label:"m_811560b9",section:"m_a74036a",loader:"m_a25b86ee",group:"m_80d6d844"};const defaultProps$1o={orientation:"horizontal"},varsResolver$y=(xt,{borderWidth:$t})=>({group:{"--button-border-width":rem$1($t)}}),ButtonGroup=factory$2((xt,$t)=>{const Ct=useProps("ButtonGroup",defaultProps$1o,xt),{className:kt,style:Mt,classNames:Ft,styles:jt,unstyled:Bt,orientation:Vt,vars:zt,borderWidth:Ht,variant:Gt,mod:qt,...Wt}=useProps("ButtonGroup",defaultProps$1o,xt),Yt=useStyles({name:"ButtonGroup",props:Ct,classes:classes$B,className:kt,style:Mt,classNames:Ft,styles:jt,unstyled:Bt,vars:zt,varsResolver:varsResolver$y,rootSelector:"group"});return jsxRuntimeExports.jsx(Box,{...Yt("group"),ref:$t,variant:Gt,mod:[{"data-orientation":Vt},qt],role:"group",...Wt})});ButtonGroup.classes=classes$B;ButtonGroup.displayName="@mantine/core/ButtonGroup";const loaderTransition={in:{opacity:1,transform:`translate(-50%, calc(-50% + ${rem$1(1)}))`},out:{opacity:0,transform:"translate(-50%, -200%)"},common:{transformOrigin:"center"},transitionProperty:"transform, opacity"},defaultProps$1n={},varsResolver$x=(xt,{radius:$t,color:Ct,gradient:kt,variant:Mt,size:Ft,justify:jt,autoContrast:Bt})=>{const Vt=xt.variantColorResolver({color:Ct||xt.primaryColor,theme:xt,gradient:kt,variant:Mt||"filled",autoContrast:Bt});return{root:{"--button-justify":jt,"--button-height":getSize(Ft,"button-height"),"--button-padding-x":getSize(Ft,"button-padding-x"),"--button-fz":Ft!=null&&Ft.includes("compact")?getFontSize$1(Ft.replace("compact-","")):getFontSize$1(Ft),"--button-radius":$t===void 0?void 0:getRadius($t),"--button-bg":Ct||Mt?Vt.background:void 0,"--button-hover":Ct||Mt?Vt.hover:void 0,"--button-color":Vt.color,"--button-bd":Ct||Mt?Vt.border:void 0,"--button-hover-color":Ct||Mt?Vt.hoverColor:void 0}}},Button=polymorphicFactory((xt,$t)=>{const Ct=useProps("Button",defaultProps$1n,xt),{style:kt,vars:Mt,className:Ft,color:jt,disabled:Bt,children:Vt,leftSection:zt,rightSection:Ht,fullWidth:Gt,variant:qt,radius:Wt,loading:Yt,loaderProps:Kt,gradient:Xt,classNames:Qt,styles:Jt,unstyled:Zt,"data-disabled":sn,autoContrast:ln,mod:dn,...hn}=Ct,cn=useStyles({name:"Button",props:Ct,classes:classes$B,className:Ft,style:kt,classNames:Qt,styles:Jt,unstyled:Zt,vars:Mt,varsResolver:varsResolver$x}),pn=!!zt,yn=!!Ht;return jsxRuntimeExports.jsxs(UnstyledButton,{ref:$t,...cn("root",{active:!Bt&&!Yt&&!sn}),unstyled:Zt,variant:qt,disabled:Bt||Yt,mod:[{disabled:Bt||sn,loading:Yt,block:Gt,"with-left-section":pn,"with-right-section":yn},dn],...hn,children:[jsxRuntimeExports.jsx(Transition$1,{mounted:!!Yt,transition:loaderTransition,duration:150,children:gn=>jsxRuntimeExports.jsx(Box,{component:"span",...cn("loader",{style:gn}),"aria-hidden":!0,children:jsxRuntimeExports.jsx(Loader,{color:"var(--button-color)",size:"calc(var(--button-height) / 1.8)",...Kt})})}),jsxRuntimeExports.jsxs("span",{...cn("inner"),children:[zt&&jsxRuntimeExports.jsx(Box,{component:"span",...cn("section"),mod:{position:"left"},children:zt}),jsxRuntimeExports.jsx(Box,{component:"span",mod:{loading:Yt},...cn("label"),children:Vt}),Ht&&jsxRuntimeExports.jsx(Box,{component:"span",...cn("section"),mod:{position:"right"},children:Ht})]})]})});Button.classes=classes$B;Button.displayName="@mantine/core/Button";Button.Group=ButtonGroup;const[CardProvider,useCardContext]=createSafeContext("Card component was not found in tree");var classes$A={root:"m_e615b15f",section:"m_599a2148"};const defaultProps$1m={},CardSection=polymorphicFactory((xt,$t)=>{const Ct=useProps("CardSection",defaultProps$1m,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,withBorder:Vt,inheritPadding:zt,mod:Ht,...Gt}=Ct,qt=useCardContext();return jsxRuntimeExports.jsx(Box,{ref:$t,mod:[{"with-border":Vt,"inherit-padding":zt},Ht],...qt.getStyles("section",{className:Mt,style:Ft,styles:jt,classNames:kt}),...Gt})});CardSection.classes=classes$A;CardSection.displayName="@mantine/core/CardSection";const defaultProps$1l={},varsResolver$w=(xt,{padding:$t})=>({root:{"--card-padding":getSpacing($t)}}),Card=polymorphicFactory((xt,$t)=>{const Ct=useProps("Card",defaultProps$1l,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,children:zt,padding:Ht,...Gt}=Ct,qt=useStyles({name:"Card",props:Ct,classes:classes$A,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$w}),Wt=reactExports.Children.toArray(zt),Yt=Wt.map((Kt,Xt)=>typeof Kt=="object"&&Kt&&"type"in Kt&&Kt.type===CardSection?reactExports.cloneElement(Kt,{"data-first-section":Xt===0||void 0,"data-last-section":Xt===Wt.length-1||void 0}):Kt);return jsxRuntimeExports.jsx(CardProvider,{value:{getStyles:qt},children:jsxRuntimeExports.jsx(Paper,{ref:$t,unstyled:Bt,...qt("root"),...Gt,children:Yt})})});Card.classes=classes$A;Card.displayName="@mantine/core/Card";Card.Section=CardSection;var classes$z={root:"m_4451eb3a"};const defaultProps$1k={},Center$2=polymorphicFactory((xt,$t)=>{const Ct=useProps("Center",defaultProps$1k,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,inline:zt,mod:Ht,...Gt}=Ct,qt=useStyles({name:"Center",props:Ct,classes:classes$z,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt});return jsxRuntimeExports.jsx(Box,{ref:$t,mod:[{inline:zt},Ht],...qt("root"),...Gt})});Center$2.classes=classes$z;Center$2.displayName="@mantine/core/Center";var classes$y={root:"m_7485cace"};const defaultProps$1j={},varsResolver$v=(xt,{size:$t,fluid:Ct})=>({root:{"--container-size":Ct?void 0:getSize($t,"container-size")}}),Container=factory$2((xt,$t)=>{const Ct=useProps("Container",defaultProps$1j,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,fluid:zt,mod:Ht,...Gt}=Ct,qt=useStyles({name:"Container",classes:classes$y,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$v});return jsxRuntimeExports.jsx(Box,{ref:$t,mod:[{fluid:zt},Ht],...qt("root"),...Gt})});Container.classes=classes$y;Container.displayName="@mantine/core/Container";var classes$x={root:"m_3eebeb36",label:"m_9e365f20"};const defaultProps$1i={orientation:"horizontal"},varsResolver$u=(xt,{color:$t,variant:Ct,size:kt})=>({root:{"--divider-color":$t?getThemeColor($t,xt):void 0,"--divider-border-style":Ct,"--divider-size":getSize(kt,"divider-size")}}),Divider=factory$2((xt,$t)=>{const Ct=useProps("Divider",defaultProps$1i,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,color:zt,orientation:Ht,label:Gt,labelPosition:qt,mod:Wt,...Yt}=Ct,Kt=useStyles({name:"Divider",classes:classes$x,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$u});return jsxRuntimeExports.jsx(Box,{ref:$t,mod:[{orientation:Ht,"with-label":!!Gt},Wt],...Kt("root"),...Yt,role:"separator",children:Gt&&jsxRuntimeExports.jsx(Box,{component:"span",mod:{position:qt},...Kt("label"),children:Gt})})});Divider.classes=classes$x;Divider.displayName="@mantine/core/Divider";const[DrawerProvider,useDrawerContext]=createSafeContext("Drawer component was not found in tree");var classes$w={root:"m_f11b401e",header:"m_5a7c2c9",content:"m_b8a05bbd",inner:"m_31cd769a"};const defaultProps$1h={},DrawerBody=factory$2((xt,$t)=>{const Ct=useProps("DrawerBody",defaultProps$1h,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,...Vt}=Ct,zt=useDrawerContext();return jsxRuntimeExports.jsx(ModalBaseBody,{ref:$t,...zt.getStyles("body",{classNames:kt,style:Ft,styles:jt,className:Mt}),...Vt})});DrawerBody.classes=classes$w;DrawerBody.displayName="@mantine/core/DrawerBody";const defaultProps$1g={},DrawerCloseButton=factory$2((xt,$t)=>{const Ct=useProps("DrawerCloseButton",defaultProps$1g,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,...Vt}=Ct,zt=useDrawerContext();return jsxRuntimeExports.jsx(ModalBaseCloseButton,{ref:$t,...zt.getStyles("close",{classNames:kt,style:Ft,styles:jt,className:Mt}),...Vt})});DrawerCloseButton.classes=classes$w;DrawerCloseButton.displayName="@mantine/core/DrawerCloseButton";const defaultProps$1f={},DrawerContent=factory$2((xt,$t)=>{const Ct=useProps("DrawerContent",defaultProps$1f,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,children:Vt,radius:zt,...Ht}=Ct,Gt=useDrawerContext(),qt=Gt.scrollAreaComponent||NativeScrollArea;return jsxRuntimeExports.jsx(ModalBaseContent,{...Gt.getStyles("content",{className:Mt,style:Ft,styles:jt,classNames:kt}),innerProps:Gt.getStyles("inner",{className:Mt,style:Ft,styles:jt,classNames:kt}),ref:$t,...Ht,radius:zt||Gt.radius||0,children:jsxRuntimeExports.jsx(qt,{style:{height:"100vh"},children:Vt})})});DrawerContent.classes=classes$w;DrawerContent.displayName="@mantine/core/DrawerContent";const defaultProps$1e={},DrawerHeader=factory$2((xt,$t)=>{const Ct=useProps("DrawerHeader",defaultProps$1e,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,...Vt}=Ct,zt=useDrawerContext();return jsxRuntimeExports.jsx(ModalBaseHeader,{ref:$t,...zt.getStyles("header",{classNames:kt,style:Ft,styles:jt,className:Mt}),...Vt})});DrawerHeader.classes=classes$w;DrawerHeader.displayName="@mantine/core/DrawerHeader";const defaultProps$1d={},DrawerOverlay=factory$2((xt,$t)=>{const Ct=useProps("DrawerOverlay",defaultProps$1d,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,...Vt}=Ct,zt=useDrawerContext();return jsxRuntimeExports.jsx(ModalBaseOverlay,{ref:$t,...zt.getStyles("overlay",{classNames:kt,style:Ft,styles:jt,className:Mt}),...Vt})});DrawerOverlay.classes=classes$w;DrawerOverlay.displayName="@mantine/core/DrawerOverlay";function getDrawerAlign(xt){switch(xt){case"top":return"flex-start";case"bottom":return"flex-end";default:return}}function getDrawerFlex(xt){if(xt==="top"||xt==="bottom")return"0 0 calc(100% - var(--drawer-offset, 0rem) * 2)"}const transitions={top:"slide-down",bottom:"slide-up",left:"slide-right",right:"slide-left"},rtlTransitions={top:"slide-down",bottom:"slide-up",right:"slide-right",left:"slide-left"},defaultProps$1c={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:getDefaultZIndex("modal"),position:"left"},varsResolver$t=(xt,{position:$t,size:Ct,offset:kt})=>({root:{"--drawer-size":getSize(Ct,"drawer-size"),"--drawer-flex":getDrawerFlex($t),"--drawer-height":$t==="left"||$t==="right"?void 0:"var(--drawer-size)","--drawer-align":getDrawerAlign($t),"--drawer-justify":$t==="right"?"flex-end":void 0,"--drawer-offset":rem$1(kt)}}),DrawerRoot=factory$2((xt,$t)=>{const Ct=useProps("DrawerRoot",defaultProps$1c,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,scrollAreaComponent:zt,position:Ht,transitionProps:Gt,radius:qt,...Wt}=Ct,{dir:Yt}=useDirection(),Kt=useStyles({name:"Drawer",classes:classes$w,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$t}),Xt=(Yt==="rtl"?rtlTransitions:transitions)[Ht];return jsxRuntimeExports.jsx(DrawerProvider,{value:{scrollAreaComponent:zt,getStyles:Kt,radius:qt},children:jsxRuntimeExports.jsx(ModalBase,{ref:$t,...Kt("root"),transitionProps:{transition:Xt,...Gt},unstyled:Bt,...Wt})})});DrawerRoot.classes=classes$w;DrawerRoot.displayName="@mantine/core/DrawerRoot";const defaultProps$1b={},DrawerTitle=factory$2((xt,$t)=>{const Ct=useProps("DrawerTitle",defaultProps$1b,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,...Vt}=Ct,zt=useDrawerContext();return jsxRuntimeExports.jsx(ModalBaseTitle,{ref:$t,...zt.getStyles("title",{classNames:kt,style:Ft,styles:jt,className:Mt}),...Vt})});DrawerTitle.classes=classes$w;DrawerTitle.displayName="@mantine/core/DrawerTitle";const defaultProps$1a={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:getDefaultZIndex("modal"),withOverlay:!0,withCloseButton:!0},Drawer=factory$2((xt,$t)=>{const{title:Ct,withOverlay:kt,overlayProps:Mt,withCloseButton:Ft,closeButtonProps:jt,children:Bt,...Vt}=useProps("Drawer",defaultProps$1a,xt),zt=!!Ct||Ft;return jsxRuntimeExports.jsxs(DrawerRoot,{ref:$t,...Vt,children:[kt&&jsxRuntimeExports.jsx(DrawerOverlay,{...Mt}),jsxRuntimeExports.jsxs(DrawerContent,{children:[zt&&jsxRuntimeExports.jsxs(DrawerHeader,{children:[Ct&&jsxRuntimeExports.jsx(DrawerTitle,{children:Ct}),Ft&&jsxRuntimeExports.jsx(DrawerCloseButton,{...jt})]}),jsxRuntimeExports.jsx(DrawerBody,{children:Bt})]})]})});Drawer.classes=classes$w;Drawer.displayName="@mantine/core/Drawer";Drawer.Root=DrawerRoot;Drawer.Overlay=DrawerOverlay;Drawer.Content=DrawerContent;Drawer.Body=DrawerBody;Drawer.Header=DrawerHeader;Drawer.Title=DrawerTitle;Drawer.CloseButton=DrawerCloseButton;function useDelayedHover({open:xt,close:$t,openDelay:Ct,closeDelay:kt}){const Mt=reactExports.useRef(-1),Ft=reactExports.useRef(-1),jt=()=>{window.clearTimeout(Mt.current),window.clearTimeout(Ft.current)},Bt=()=>{jt(),Ct===0||Ct===void 0?xt():Mt.current=window.setTimeout(xt,Ct)},Vt=()=>{jt(),kt===0||kt===void 0?$t():Ft.current=window.setTimeout($t,kt)};return reactExports.useEffect(()=>jt,[]),{openDropdown:Bt,closeDropdown:Vt}}const[GridProvider,useGridContext]=createSafeContext("Grid component was not found in tree"),getColumnFlexBasis=(xt,$t)=>xt==="content"?"auto":xt==="auto"?"0rem":xt?`${100/($t/xt)}%`:void 0,getColumnMaxWidth=(xt,$t,Ct)=>Ct||xt==="auto"?"100%":xt==="content"?"unset":getColumnFlexBasis(xt,$t),getColumnFlexGrow=(xt,$t)=>{if(xt)return xt==="auto"||$t?"1":"auto"},getColumnOffset=(xt,$t)=>xt===0?"0":xt?`${100/($t/xt)}%`:void 0;function GridColVariables({span:xt,order:$t,offset:Ct,selector:kt}){var qt;const Mt=useMantineTheme(),Ft=useGridContext(),Bt=getBaseValue$1(xt)===void 0?12:getBaseValue$1(xt),Vt=filterProps({"--col-order":(qt=getBaseValue$1($t))==null?void 0:qt.toString(),"--col-flex-grow":getColumnFlexGrow(Bt,Ft.grow),"--col-flex-basis":getColumnFlexBasis(Bt,Ft.columns),"--col-width":Bt==="content"?"auto":void 0,"--col-max-width":getColumnMaxWidth(Bt,Ft.columns,Ft.grow),"--col-offset":getColumnOffset(getBaseValue$1(Ct),Ft.columns)}),zt=keys$4(Mt.breakpoints).reduce((Wt,Yt)=>{var Kt;return Wt[Yt]||(Wt[Yt]={}),typeof $t=="object"&&$t[Yt]!==void 0&&(Wt[Yt]["--col-order"]=(Kt=$t[Yt])==null?void 0:Kt.toString()),typeof xt=="object"&&xt[Yt]!==void 0&&(Wt[Yt]["--col-flex-grow"]=getColumnFlexGrow(xt[Yt],Ft.grow),Wt[Yt]["--col-flex-basis"]=getColumnFlexBasis(xt[Yt],Ft.columns),Wt[Yt]["--col-width"]=xt[Yt]==="content"?"auto":void 0,Wt[Yt]["--col-max-width"]=getColumnMaxWidth(xt[Yt],Ft.columns,Ft.grow)),typeof Ct=="object"&&Ct[Yt]!==void 0&&(Wt[Yt]["--col-offset"]=getColumnOffset(Ct[Yt],Ft.columns)),Wt},{}),Gt=getSortedBreakpoints(keys$4(zt),Mt).filter(Wt=>keys$4(zt[Wt.value]).length>0).map(Wt=>({query:`(min-width: ${Mt.breakpoints[Wt.value]})`,styles:zt[Wt.value]}));return jsxRuntimeExports.jsx(InlineStyles,{styles:Vt,media:Gt,selector:kt})}var classes$v={root:"m_410352e9",inner:"m_dee7bd2f",col:"m_96bdd299"};const defaultProps$19={span:12},GridCol=factory$2((xt,$t)=>{const Ct=useProps("GridCol",defaultProps$19,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,span:Vt,order:zt,offset:Ht,...Gt}=Ct,qt=useGridContext(),Wt=useRandomClassName();return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(GridColVariables,{selector:`.${Wt}`,span:Vt,order:zt,offset:Ht}),jsxRuntimeExports.jsx(Box,{ref:$t,...qt.getStyles("col",{className:clsx(Mt,Wt),style:Ft,classNames:kt,styles:jt}),...Gt})]})});GridCol.classes=classes$v;GridCol.displayName="@mantine/core/GridCol";function GridVariables({gutter:xt,selector:$t}){const Ct=useMantineTheme(),kt=filterProps({"--grid-gutter":getSpacing(getBaseValue$1(xt))}),Mt=keys$4(Ct.breakpoints).reduce((Bt,Vt)=>(Bt[Vt]||(Bt[Vt]={}),typeof xt=="object"&&xt[Vt]!==void 0&&(Bt[Vt]["--grid-gutter"]=getSpacing(xt[Vt])),Bt),{}),jt=getSortedBreakpoints(keys$4(Mt),Ct).filter(Bt=>keys$4(Mt[Bt.value]).length>0).map(Bt=>({query:`(min-width: ${Ct.breakpoints[Bt.value]})`,styles:Mt[Bt.value]}));return jsxRuntimeExports.jsx(InlineStyles,{styles:kt,media:jt,selector:$t})}const defaultProps$18={gutter:"md",grow:!1,columns:12},varsResolver$s=(xt,{justify:$t,align:Ct,overflow:kt})=>({root:{"--grid-justify":$t,"--grid-align":Ct,"--grid-overflow":kt}}),Grid=factory$2((xt,$t)=>{const Ct=useProps("Grid",defaultProps$18,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,grow:zt,gutter:Ht,columns:Gt,align:qt,justify:Wt,children:Yt,...Kt}=Ct,Xt=useStyles({name:"Grid",classes:classes$v,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$s}),Qt=useRandomClassName();return jsxRuntimeExports.jsxs(GridProvider,{value:{getStyles:Xt,grow:zt,columns:Gt},children:[jsxRuntimeExports.jsx(GridVariables,{selector:`.${Qt}`,...Ct}),jsxRuntimeExports.jsx(Box,{ref:$t,...Xt("root",{className:Qt}),...Kt,children:jsxRuntimeExports.jsx("div",{...Xt("inner"),children:Yt})})]})});Grid.classes=classes$v;Grid.displayName="@mantine/core/Grid";Grid.Col=GridCol;var classes$u={root:"m_9e117634"};const defaultProps$17={},varsResolver$r=(xt,{radius:$t,fit:Ct})=>({root:{"--image-radius":$t===void 0?void 0:getRadius($t),"--image-object-fit":Ct}}),Image$1=polymorphicFactory((xt,$t)=>{const Ct=useProps("Image",defaultProps$17,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,onError:zt,src:Ht,radius:Gt,fit:qt,fallbackSrc:Wt,mod:Yt,...Kt}=Ct,[Xt,Qt]=reactExports.useState(!Ht);reactExports.useEffect(()=>Qt(!Ht),[Ht]);const Jt=useStyles({name:"Image",classes:classes$u,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$r});return Xt&&Wt?jsxRuntimeExports.jsx(Box,{component:"img",ref:$t,src:Wt,...Jt("root"),onError:zt,mod:["fallback",Yt],...Kt}):jsxRuntimeExports.jsx(Box,{component:"img",ref:$t,...Jt("root"),src:Ht,onError:Zt=>{zt==null||zt(Zt),Qt(!0)},mod:Yt,...Kt})});Image$1.classes=classes$u;Image$1.displayName="@mantine/core/Image";function _extends$4(){return _extends$4=Object.assign?Object.assign.bind():function(xt){for(var $t=1;$t<arguments.length;$t++){var Ct=arguments[$t];for(var kt in Ct)({}).hasOwnProperty.call(Ct,kt)&&(xt[kt]=Ct[kt])}return xt},_extends$4.apply(null,arguments)}function _objectWithoutPropertiesLoose(xt,$t){if(xt==null)return{};var Ct={};for(var kt in xt)if({}.hasOwnProperty.call(xt,kt)){if($t.indexOf(kt)>=0)continue;Ct[kt]=xt[kt]}return Ct}var index$4=reactExports.useLayoutEffect,useLatest=function($t){var Ct=reactExports.useRef($t);return index$4(function(){Ct.current=$t}),Ct},updateRef=function($t,Ct){if(typeof $t=="function"){$t(Ct);return}$t.current=Ct},useComposedRef=function($t,Ct){var kt=reactExports.useRef();return reactExports.useCallback(function(Mt){$t.current=Mt,kt.current&&updateRef(kt.current,null),kt.current=Ct,Ct&&updateRef(Ct,Mt)},[Ct])},HIDDEN_TEXTAREA_STYLE={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},forceHiddenStyles=function($t){Object.keys(HIDDEN_TEXTAREA_STYLE).forEach(function(Ct){$t.style.setProperty(Ct,HIDDEN_TEXTAREA_STYLE[Ct],"important")})},forceHiddenStyles$1=forceHiddenStyles,hiddenTextarea=null,getHeight=function($t,Ct){var kt=$t.scrollHeight;return Ct.sizingStyle.boxSizing==="border-box"?kt+Ct.borderSize:kt-Ct.paddingSize};function calculateNodeHeight(xt,$t,Ct,kt){Ct===void 0&&(Ct=1),kt===void 0&&(kt=1/0),hiddenTextarea||(hiddenTextarea=document.createElement("textarea"),hiddenTextarea.setAttribute("tabindex","-1"),hiddenTextarea.setAttribute("aria-hidden","true"),forceHiddenStyles$1(hiddenTextarea)),hiddenTextarea.parentNode===null&&document.body.appendChild(hiddenTextarea);var Mt=xt.paddingSize,Ft=xt.borderSize,jt=xt.sizingStyle,Bt=jt.boxSizing;Object.keys(jt).forEach(function(qt){var Wt=qt;hiddenTextarea.style[Wt]=jt[Wt]}),forceHiddenStyles$1(hiddenTextarea),hiddenTextarea.value=$t;var Vt=getHeight(hiddenTextarea,xt);hiddenTextarea.value=$t,Vt=getHeight(hiddenTextarea,xt),hiddenTextarea.value="x";var zt=hiddenTextarea.scrollHeight-Mt,Ht=zt*Ct;Bt==="border-box"&&(Ht=Ht+Mt+Ft),Vt=Math.max(Ht,Vt);var Gt=zt*kt;return Bt==="border-box"&&(Gt=Gt+Mt+Ft),Vt=Math.min(Gt,Vt),[Vt,zt]}var noop$a=function(){},pick$3=function($t,Ct){return $t.reduce(function(kt,Mt){return kt[Mt]=Ct[Mt],kt},{})},SIZING_STYLE=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],isIE$1=!!document.documentElement.currentStyle,getSizingData=function($t){var Ct=window.getComputedStyle($t);if(Ct===null)return null;var kt=pick$3(SIZING_STYLE,Ct),Mt=kt.boxSizing;if(Mt==="")return null;isIE$1&&Mt==="border-box"&&(kt.width=parseFloat(kt.width)+parseFloat(kt.borderRightWidth)+parseFloat(kt.borderLeftWidth)+parseFloat(kt.paddingRight)+parseFloat(kt.paddingLeft)+"px");var Ft=parseFloat(kt.paddingBottom)+parseFloat(kt.paddingTop),jt=parseFloat(kt.borderBottomWidth)+parseFloat(kt.borderTopWidth);return{sizingStyle:kt,paddingSize:Ft,borderSize:jt}},getSizingData$1=getSizingData;function useListener(xt,$t,Ct){var kt=useLatest(Ct);reactExports.useLayoutEffect(function(){var Mt=function(jt){return kt.current(jt)};if(xt)return xt.addEventListener($t,Mt),function(){return xt.removeEventListener($t,Mt)}},[])}var useWindowResizeListener=function($t){useListener(window,"resize",$t)},useFontsLoadedListener=function($t){useListener(document.fonts,"loadingdone",$t)},_excluded=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],TextareaAutosize=function($t,Ct){var kt=$t.cacheMeasurements,Mt=$t.maxRows,Ft=$t.minRows,jt=$t.onChange,Bt=jt===void 0?noop$a:jt,Vt=$t.onHeightChange,zt=Vt===void 0?noop$a:Vt,Ht=_objectWithoutPropertiesLoose($t,_excluded),Gt=Ht.value!==void 0,qt=reactExports.useRef(null),Wt=useComposedRef(qt,Ct),Yt=reactExports.useRef(0),Kt=reactExports.useRef(),Xt=function(){var Zt=qt.current,sn=kt&&Kt.current?Kt.current:getSizingData$1(Zt);if(sn){Kt.current=sn;var ln=calculateNodeHeight(sn,Zt.value||Zt.placeholder||"x",Ft,Mt),dn=ln[0],hn=ln[1];Yt.current!==dn&&(Yt.current=dn,Zt.style.setProperty("height",dn+"px","important"),zt(dn,{rowHeight:hn}))}},Qt=function(Zt){Gt||Xt(),Bt(Zt)};return reactExports.useLayoutEffect(Xt),useWindowResizeListener(Xt),useFontsLoadedListener(Xt),reactExports.createElement("textarea",_extends$4({},Ht,{onChange:Qt,ref:Wt}))},index$3=reactExports.forwardRef(TextareaAutosize);const defaultProps$16={},Textarea=factory$2((xt,$t)=>{const{autosize:Ct,maxRows:kt,minRows:Mt,__staticSelector:Ft,resize:jt,...Bt}=useProps("Textarea",defaultProps$16,xt),Vt=Ct&&getEnv()!=="test",zt=Vt?{maxRows:kt,minRows:Mt}:{};return jsxRuntimeExports.jsx(InputBase,{component:Vt?index$3:"textarea",ref:$t,...Bt,__staticSelector:Ft||"Textarea",multiline:!0,"data-no-overflow":Ct&&kt===void 0||void 0,__vars:{"--input-resize":jt},...zt})});Textarea.classes=InputBase.classes;Textarea.displayName="@mantine/core/Textarea";const[ListProvider,useListContext]=createSafeContext("List component was not found in tree");var classes$t={root:"m_abbac491",item:"m_abb6bec2",itemWrapper:"m_75cd9f71",itemIcon:"m_60f83e5b"};const defaultProps$15={},ListItem=factory$2((xt,$t)=>{const Ct=useProps("ListItem",defaultProps$15,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,icon:Vt,children:zt,mod:Ht,...Gt}=Ct,qt=useListContext(),Wt=Vt||qt.icon,Yt={classNames:kt,styles:jt};return jsxRuntimeExports.jsx(Box,{...qt.getStyles("item",{...Yt,className:Mt,style:Ft}),component:"li",mod:[{"with-icon":!!Wt,centered:qt.center},Ht],ref:$t,...Gt,children:jsxRuntimeExports.jsxs("div",{...qt.getStyles("itemWrapper",Yt),children:[Wt&&jsxRuntimeExports.jsx("span",{...qt.getStyles("itemIcon",Yt),children:Wt}),jsxRuntimeExports.jsx("span",{...qt.getStyles("itemLabel",Yt),children:zt})]})})});ListItem.classes=classes$t;ListItem.displayName="@mantine/core/ListItem";const defaultProps$14={type:"unordered"},varsResolver$q=(xt,{size:$t,spacing:Ct})=>({root:{"--list-fz":getFontSize$1($t),"--list-lh":getLineHeight($t),"--list-spacing":getSpacing(Ct)}}),List$2=factory$2((xt,$t)=>{const Ct=useProps("List",defaultProps$14,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,children:zt,type:Ht,withPadding:Gt,icon:qt,spacing:Wt,center:Yt,listStyleType:Kt,mod:Xt,...Qt}=Ct,Jt=useStyles({name:"List",classes:classes$t,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$q});return jsxRuntimeExports.jsx(ListProvider,{value:{center:Yt,icon:qt,getStyles:Jt},children:jsxRuntimeExports.jsx(Box,{...Jt("root",{style:{listStyleType:Kt}}),component:Ht==="unordered"?"ul":"ol",mod:[{"with-padding":Gt},Xt],ref:$t,...Qt,children:zt})})});List$2.classes=classes$t;List$2.displayName="@mantine/core/List";List$2.Item=ListItem;var classes$s={root:"m_6e45937b",loader:"m_e8eb006c",overlay:"m_df587f17"};const defaultProps$13={transitionProps:{transition:"fade",duration:0},overlayProps:{backgroundOpacity:.75},zIndex:getDefaultZIndex("overlay")},varsResolver$p=(xt,{zIndex:$t})=>({root:{"--lo-z-index":$t==null?void 0:$t.toString()}}),LoadingOverlay=factory$2((xt,$t)=>{const Ct=useProps("LoadingOverlay",defaultProps$13,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,transitionProps:zt,loaderProps:Ht,overlayProps:Gt,visible:qt,zIndex:Wt,...Yt}=Ct,Kt=useMantineTheme(),Xt=useStyles({name:"LoadingOverlay",classes:classes$s,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$p}),Qt={...defaultProps$13.overlayProps,...Gt};return jsxRuntimeExports.jsx(Transition$1,{transition:"fade",...zt,mounted:!!qt,children:Jt=>jsxRuntimeExports.jsxs(Box,{...Xt("root",{style:Jt}),ref:$t,...Yt,children:[jsxRuntimeExports.jsx(Loader,{...Xt("loader"),unstyled:Bt,...Ht}),jsxRuntimeExports.jsx(Overlay$1,{...Qt,...Xt("overlay"),darkHidden:!0,unstyled:Bt,color:(Gt==null?void 0:Gt.color)||Kt.white}),jsxRuntimeExports.jsx(Overlay$1,{...Qt,...Xt("overlay"),lightHidden:!0,unstyled:Bt,color:(Gt==null?void 0:Gt.color)||Kt.colors.dark[5]})]})})});LoadingOverlay.classes=classes$s;LoadingOverlay.displayName="@mantine/core/LoadingOverlay";const[MenuContextProvider,useMenuContext]=createSafeContext("Menu component was not found in the tree");var classes$r={dropdown:"m_dc9b7c9f",label:"m_9bfac126",divider:"m_efdf90cb",item:"m_99ac2aa1",itemLabel:"m_5476e0d3",itemSection:"m_8b75e504"};const defaultProps$12={},MenuDivider=factory$2((xt,$t)=>{const{classNames:Ct,className:kt,style:Mt,styles:Ft,vars:jt,...Bt}=useProps("MenuDivider",defaultProps$12,xt),Vt=useMenuContext();return jsxRuntimeExports.jsx(Box,{ref:$t,...Vt.getStyles("divider",{className:kt,style:Mt,styles:Ft,classNames:Ct}),...Bt})});MenuDivider.classes=classes$r;MenuDivider.displayName="@mantine/core/MenuDivider";const defaultProps$11={},MenuDropdown=factory$2((xt,$t)=>{const{classNames:Ct,className:kt,style:Mt,styles:Ft,vars:jt,onMouseEnter:Bt,onMouseLeave:Vt,children:zt,...Ht}=useProps("MenuDropdown",defaultProps$11,xt),Gt=reactExports.useRef(null),qt=useMenuContext(),Wt=Xt=>{var Qt,Jt;(Xt.key==="ArrowUp"||Xt.key==="ArrowDown")&&(Xt.preventDefault(),(Jt=(Qt=Gt.current)==null?void 0:Qt.querySelectorAll("[data-menu-item]:not(:disabled)")[0])==null||Jt.focus())},Yt=createEventHandler(Bt,()=>(qt.trigger==="hover"||qt.trigger==="click-hover")&&qt.openDropdown()),Kt=createEventHandler(Vt,()=>(qt.trigger==="hover"||qt.trigger==="click-hover")&&qt.closeDropdown());return jsxRuntimeExports.jsxs(Popover.Dropdown,{...Ht,onMouseEnter:Yt,onMouseLeave:Kt,role:"menu","aria-orientation":"vertical",ref:useMergedRef($t,Gt),...qt.getStyles("dropdown",{className:kt,style:Mt,styles:Ft,classNames:Ct,withStaticClass:!1}),tabIndex:-1,"data-menu-dropdown":!0,onKeyDown:Wt,children:[jsxRuntimeExports.jsx("div",{tabIndex:-1,"data-autofocus":!0,"aria-hidden":!0,style:{outline:0}}),zt]})});MenuDropdown.classes=classes$r;MenuDropdown.displayName="@mantine/core/MenuDropdown";const defaultProps$10={},MenuItem=polymorphicFactory((xt,$t)=>{const{classNames:Ct,className:kt,style:Mt,styles:Ft,vars:jt,color:Bt,closeMenuOnClick:Vt,leftSection:zt,rightSection:Ht,children:Gt,disabled:qt,...Wt}=useProps("MenuItem",defaultProps$10,xt),Yt=useMenuContext(),Kt=useMantineTheme(),{dir:Xt}=useDirection(),Qt=reactExports.useRef(),Jt=Yt.getItemIndex(Qt.current),Zt=Wt,sn=createEventHandler(Zt.onMouseLeave,()=>Yt.setHovered(-1)),ln=createEventHandler(Zt.onMouseEnter,()=>Yt.setHovered(Yt.getItemIndex(Qt.current))),dn=createEventHandler(Zt.onClick,()=>{typeof Vt=="boolean"?Vt&&Yt.closeDropdownImmediately():Yt.closeOnItemClick&&Yt.closeDropdownImmediately()}),hn=createEventHandler(Zt.onFocus,()=>Yt.setHovered(Yt.getItemIndex(Qt.current))),cn=Bt?Kt.variantColorResolver({color:Bt,theme:Kt,variant:"light"}):void 0,pn=Bt?parseThemeColor({color:Bt,theme:Kt}):null;return jsxRuntimeExports.jsxs(UnstyledButton,{...Wt,unstyled:Yt.unstyled,tabIndex:Yt.menuItemTabIndex,onFocus:hn,...Yt.getStyles("item",{className:kt,style:Mt,styles:Ft,classNames:Ct}),ref:useMergedRef(Qt,$t),role:"menuitem",disabled:qt,"data-menu-item":!0,"data-disabled":qt||void 0,"data-hovered":Yt.hovered===Jt?!0:void 0,onMouseEnter:ln,onMouseLeave:sn,onClick:dn,onKeyDown:createScopedKeydownHandler({siblingSelector:"[data-menu-item]",parentSelector:"[data-menu-dropdown]",activateOnFocus:!1,loop:Yt.loop,dir:Xt,orientation:"vertical",onKeyDown:Zt.onKeydown}),__vars:{"--menu-item-color":pn!=null&&pn.isThemeColor&&(pn==null?void 0:pn.shade)===void 0?`var(--mantine-color-${pn.color}-6)`:cn==null?void 0:cn.color,"--menu-item-hover":cn==null?void 0:cn.hover},children:[zt&&jsxRuntimeExports.jsx("div",{...Yt.getStyles("itemSection",{styles:Ft,classNames:Ct}),"data-position":"left",children:zt}),Gt&&jsxRuntimeExports.jsx("div",{...Yt.getStyles("itemLabel",{styles:Ft,classNames:Ct}),children:Gt}),Ht&&jsxRuntimeExports.jsx("div",{...Yt.getStyles("itemSection",{styles:Ft,classNames:Ct}),"data-position":"right",children:Ht})]})});MenuItem.classes=classes$r;MenuItem.displayName="@mantine/core/MenuItem";const defaultProps$$={},MenuLabel=factory$2((xt,$t)=>{const{classNames:Ct,className:kt,style:Mt,styles:Ft,vars:jt,...Bt}=useProps("MenuLabel",defaultProps$$,xt),Vt=useMenuContext();return jsxRuntimeExports.jsx(Box,{ref:$t,...Vt.getStyles("label",{className:kt,style:Mt,styles:Ft,classNames:Ct}),...Bt})});MenuLabel.classes=classes$r;MenuLabel.displayName="@mantine/core/MenuLabel";const defaultProps$_={refProp:"ref"},MenuTarget=reactExports.forwardRef((xt,$t)=>{const{children:Ct,refProp:kt,...Mt}=useProps("MenuTarget",defaultProps$_,xt);if(!isElement$1(Ct))throw new Error("Menu.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const Ft=useMenuContext(),jt=createEventHandler(Ct.props.onClick,()=>{Ft.trigger==="click"?Ft.toggleDropdown():Ft.trigger==="click-hover"&&(Ft.setOpenedViaClick(!0),Ft.opened||Ft.openDropdown())}),Bt=createEventHandler(Ct.props.onMouseEnter,()=>(Ft.trigger==="hover"||Ft.trigger==="click-hover")&&Ft.openDropdown()),Vt=createEventHandler(Ct.props.onMouseLeave,()=>{(Ft.trigger==="hover"||Ft.trigger==="click-hover"&&!Ft.openedViaClick)&&Ft.closeDropdown()});return jsxRuntimeExports.jsx(Popover.Target,{refProp:kt,popupType:"menu",ref:$t,...Mt,children:reactExports.cloneElement(Ct,{onClick:jt,onMouseEnter:Bt,onMouseLeave:Vt,"data-expanded":Ft.opened?!0:void 0})})});MenuTarget.displayName="@mantine/core/MenuTarget";const defaultProps$Z={trapFocus:!0,closeOnItemClick:!0,clickOutsideEvents:["mousedown","touchstart","keydown"],loop:!0,trigger:"click",openDelay:0,closeDelay:100,menuItemTabIndex:-1};function Menu(xt){const $t=useProps("Menu",defaultProps$Z,xt),{children:Ct,onOpen:kt,onClose:Mt,opened:Ft,defaultOpened:jt,trapFocus:Bt,onChange:Vt,closeOnItemClick:zt,loop:Ht,closeOnEscape:Gt,trigger:qt,openDelay:Wt,closeDelay:Yt,classNames:Kt,styles:Xt,unstyled:Qt,variant:Jt,vars:Zt,menuItemTabIndex:sn,keepMounted:ln,...dn}=$t,hn=useStyles({name:"Menu",classes:classes$r,props:$t,classNames:Kt,styles:Xt,unstyled:Qt}),[cn,{setHovered:pn,resetHovered:yn}]=useHovered(),[gn,En]=useUncontrolled({value:Ft,defaultValue:jt,finalValue:!1,onChange:Vt}),[bn,xn]=reactExports.useState(!1),Cn=()=>{En(!1),xn(!1),gn&&(Mt==null||Mt())},$n=()=>{En(!0),!gn&&(kt==null||kt())},wn=()=>{gn?Cn():$n()},{openDropdown:Rn,closeDropdown:Dn}=useDelayedHover({open:$n,close:Cn,closeDelay:Yt,openDelay:Wt}),An=_n=>getContextItemIndex("[data-menu-item]","[data-menu-dropdown]",_n),{resolvedClassNames:Sn,resolvedStyles:vn}=useResolvedStylesApi({classNames:Kt,styles:Xt,props:$t});return useDidUpdate(()=>{yn()},[gn]),jsxRuntimeExports.jsx(MenuContextProvider,{value:{getStyles:hn,opened:gn,toggleDropdown:wn,getItemIndex:An,hovered:cn,setHovered:pn,openedViaClick:bn,setOpenedViaClick:xn,closeOnItemClick:zt,closeDropdown:qt==="click"?Cn:Dn,openDropdown:qt==="click"?$n:Rn,closeDropdownImmediately:Cn,loop:Ht,trigger:qt,unstyled:Qt,menuItemTabIndex:sn},children:jsxRuntimeExports.jsx(Popover,{...dn,opened:gn,onChange:wn,defaultOpened:jt,trapFocus:ln?!1:Bt,closeOnEscape:Gt,__staticSelector:"Menu",classNames:Sn,styles:vn,unstyled:Qt,variant:Jt,keepMounted:ln,children:Ct})})}Menu.extend=xt=>xt;Menu.classes=classes$r;Menu.displayName="@mantine/core/Menu";Menu.Item=MenuItem;Menu.Label=MenuLabel;Menu.Dropdown=MenuDropdown;Menu.Target=MenuTarget;Menu.Divider=MenuDivider;const[ModalProvider,useModalContext]=createSafeContext("Modal component was not found in tree");var classes$q={root:"m_9df02822",content:"m_54c44539",inner:"m_1f958f16",header:"m_d0e2b9cd"};const defaultProps$Y={},ModalBody=factory$2((xt,$t)=>{const Ct=useProps("ModalBody",defaultProps$Y,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,...Vt}=Ct,zt=useModalContext();return jsxRuntimeExports.jsx(ModalBaseBody,{ref:$t,...zt.getStyles("body",{classNames:kt,style:Ft,styles:jt,className:Mt}),...Vt})});ModalBody.classes=classes$q;ModalBody.displayName="@mantine/core/ModalBody";const defaultProps$X={},ModalCloseButton=factory$2((xt,$t)=>{const Ct=useProps("ModalCloseButton",defaultProps$X,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,...Vt}=Ct,zt=useModalContext();return jsxRuntimeExports.jsx(ModalBaseCloseButton,{ref:$t,...zt.getStyles("close",{classNames:kt,style:Ft,styles:jt,className:Mt}),...Vt})});ModalCloseButton.classes=classes$q;ModalCloseButton.displayName="@mantine/core/ModalCloseButton";const defaultProps$W={},ModalContent=factory$2((xt,$t)=>{const Ct=useProps("ModalContent",defaultProps$W,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,children:Vt,...zt}=Ct,Ht=useModalContext(),Gt=Ht.scrollAreaComponent||NativeScrollArea;return jsxRuntimeExports.jsx(ModalBaseContent,{...Ht.getStyles("content",{className:Mt,style:Ft,styles:jt,classNames:kt}),innerProps:Ht.getStyles("inner",{className:Mt,style:Ft,styles:jt,classNames:kt}),"data-full-screen":Ht.fullScreen||void 0,"data-modal-content":!0,ref:$t,...zt,children:jsxRuntimeExports.jsx(Gt,{style:{maxHeight:Ht.fullScreen?"100dvh":`calc(100dvh - (${rem$1(Ht.yOffset)} * 2))`},children:Vt})})});ModalContent.classes=classes$q;ModalContent.displayName="@mantine/core/ModalContent";const defaultProps$V={},ModalHeader=factory$2((xt,$t)=>{const Ct=useProps("ModalHeader",defaultProps$V,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,...Vt}=Ct,zt=useModalContext();return jsxRuntimeExports.jsx(ModalBaseHeader,{ref:$t,...zt.getStyles("header",{classNames:kt,style:Ft,styles:jt,className:Mt}),...Vt})});ModalHeader.classes=classes$q;ModalHeader.displayName="@mantine/core/ModalHeader";const defaultProps$U={},ModalOverlay=factory$2((xt,$t)=>{const Ct=useProps("ModalOverlay",defaultProps$U,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,...Vt}=Ct,zt=useModalContext();return jsxRuntimeExports.jsx(ModalBaseOverlay,{ref:$t,...zt.getStyles("overlay",{classNames:kt,style:Ft,styles:jt,className:Mt}),...Vt})});ModalOverlay.classes=classes$q;ModalOverlay.displayName="@mantine/core/ModalOverlay";const defaultProps$T={__staticSelector:"Modal",closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:getDefaultZIndex("modal"),transitionProps:{duration:200,transition:"pop"},yOffset:"5dvh"},varsResolver$o=(xt,{radius:$t,size:Ct,yOffset:kt,xOffset:Mt})=>({root:{"--modal-radius":$t===void 0?void 0:getRadius($t),"--modal-size":getSize(Ct,"modal-size"),"--modal-y-offset":rem$1(kt),"--modal-x-offset":rem$1(Mt)}}),ModalRoot=factory$2((xt,$t)=>{const Ct=useProps("ModalRoot",defaultProps$T,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,yOffset:zt,scrollAreaComponent:Ht,radius:Gt,fullScreen:qt,centered:Wt,xOffset:Yt,__staticSelector:Kt,...Xt}=Ct,Qt=useStyles({name:Kt,classes:classes$q,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$o});return jsxRuntimeExports.jsx(ModalProvider,{value:{yOffset:zt,scrollAreaComponent:Ht,getStyles:Qt,fullScreen:qt},children:jsxRuntimeExports.jsx(ModalBase,{ref:$t,...Qt("root"),"data-full-screen":qt||void 0,"data-centered":Wt||void 0,unstyled:Bt,...Xt})})});ModalRoot.classes=classes$q;ModalRoot.displayName="@mantine/core/ModalRoot";const defaultProps$S={},ModalTitle=factory$2((xt,$t)=>{const Ct=useProps("ModalTitle",defaultProps$S,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,vars:Bt,...Vt}=Ct,zt=useModalContext();return jsxRuntimeExports.jsx(ModalBaseTitle,{ref:$t,...zt.getStyles("title",{classNames:kt,style:Ft,styles:jt,className:Mt}),...Vt})});ModalTitle.classes=classes$q;ModalTitle.displayName="@mantine/core/ModalTitle";const defaultProps$R={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:getDefaultZIndex("modal"),transitionProps:{duration:200,transition:"fade-down"},withOverlay:!0,withCloseButton:!0},Modal=factory$2((xt,$t)=>{const{title:Ct,withOverlay:kt,overlayProps:Mt,withCloseButton:Ft,closeButtonProps:jt,children:Bt,radius:Vt,...zt}=useProps("Modal",defaultProps$R,xt),Ht=!!Ct||Ft;return jsxRuntimeExports.jsxs(ModalRoot,{ref:$t,radius:Vt,...zt,children:[kt&&jsxRuntimeExports.jsx(ModalOverlay,{...Mt}),jsxRuntimeExports.jsxs(ModalContent,{radius:Vt,children:[Ht&&jsxRuntimeExports.jsxs(ModalHeader,{children:[Ct&&jsxRuntimeExports.jsx(ModalTitle,{children:Ct}),Ft&&jsxRuntimeExports.jsx(ModalCloseButton,{...jt})]}),jsxRuntimeExports.jsx(ModalBody,{children:Bt})]})]})});Modal.classes=classes$q;Modal.displayName="@mantine/core/Modal";Modal.Root=ModalRoot;Modal.Overlay=ModalOverlay;Modal.Content=ModalContent;Modal.Body=ModalBody;Modal.Header=ModalHeader;Modal.Title=ModalTitle;Modal.CloseButton=ModalCloseButton;const[PillsInputProvider,usePillsInputContext]=createOptionalContext(),[PillGroupProvider,usePillGroupContext]=createOptionalContext();var classes$p={root:"m_7cda1cd6","root--default":"m_44da308b","root--contrast":"m_e3a01f8",label:"m_1e0e6180",remove:"m_ae386778",group:"m_1dcfd90b"};const defaultProps$Q={},varsResolver$n=(xt,{gap:$t},{size:Ct})=>({group:{"--pg-gap":$t!==void 0?getSize($t):getSize(Ct,"pg-gap")}}),PillGroup=factory$2((xt,$t)=>{const Ct=useProps("PillGroup",defaultProps$Q,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,size:zt,disabled:Ht,...Gt}=Ct,qt=usePillsInputContext(),Wt=(qt==null?void 0:qt.size)||zt||void 0,Yt=useStyles({name:"PillGroup",classes:classes$p,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$n,stylesCtx:{size:Wt},rootSelector:"group"});return jsxRuntimeExports.jsx(PillGroupProvider,{value:{size:Wt,disabled:Ht},children:jsxRuntimeExports.jsx(Box,{ref:$t,size:Wt,...Yt("group"),...Gt})})});PillGroup.classes=classes$p;PillGroup.displayName="@mantine/core/PillGroup";const defaultProps$P={variant:"default"},varsResolver$m=(xt,{radius:$t},{size:Ct})=>({root:{"--pill-fz":getSize(Ct,"pill-fz"),"--pill-height":getSize(Ct,"pill-height"),"--pill-radius":$t===void 0?void 0:getRadius($t)}}),Pill=factory$2((xt,$t)=>{const Ct=useProps("Pill",defaultProps$P,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,variant:zt,children:Ht,withRemoveButton:Gt,onRemove:qt,removeButtonProps:Wt,radius:Yt,size:Kt,disabled:Xt,mod:Qt,...Jt}=Ct,Zt=usePillGroupContext(),sn=usePillsInputContext(),ln=Kt||(Zt==null?void 0:Zt.size)||void 0,dn=(sn==null?void 0:sn.variant)==="filled"?"contrast":zt||"default",hn=useStyles({name:"Pill",classes:classes$p,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$m,stylesCtx:{size:ln}});return jsxRuntimeExports.jsxs(Box,{component:"span",ref:$t,variant:dn,size:ln,...hn("root",{variant:dn}),mod:[{"with-remove":Gt&&!Xt,disabled:Xt||(Zt==null?void 0:Zt.disabled)},Qt],...Jt,children:[jsxRuntimeExports.jsx("span",{...hn("label"),children:Ht}),Gt&&jsxRuntimeExports.jsx(CloseButton,{variant:"transparent",radius:Yt,tabIndex:-1,"aria-hidden":!0,unstyled:Bt,...Wt,...hn("remove",{className:Wt==null?void 0:Wt.className,style:Wt==null?void 0:Wt.style}),onMouseDown:cn=>{var pn;cn.preventDefault(),cn.stopPropagation(),(pn=Wt==null?void 0:Wt.onMouseDown)==null||pn.call(Wt,cn)},onClick:cn=>{var pn;cn.stopPropagation(),qt==null||qt(),(pn=Wt==null?void 0:Wt.onClick)==null||pn.call(Wt,cn)}})]})});Pill.classes=classes$p;Pill.displayName="@mantine/core/Pill";Pill.Group=PillGroup;var classes$o={field:"m_45c4369d"};const defaultProps$O={type:"visible"},PillsInputField=factory$2((xt,$t)=>{const Ct=useProps("PillsInputField",defaultProps$O,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,type:zt,disabled:Ht,id:Gt,pointer:qt,mod:Wt,...Yt}=Ct,Kt=usePillsInputContext(),Xt=useInputWrapperContext(),Qt=useStyles({name:"PillsInputField",classes:classes$o,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,rootSelector:"field"}),Jt=Ht||(Kt==null?void 0:Kt.disabled);return jsxRuntimeExports.jsx(Box,{component:"input",ref:useMergedRef($t,Kt==null?void 0:Kt.fieldRef),"data-type":zt,disabled:Jt,mod:[{disabled:Jt,pointer:qt},Wt],...Qt("field"),...Yt,id:(Xt==null?void 0:Xt.inputId)||Gt,"aria-invalid":Kt==null?void 0:Kt.hasError,"aria-describedby":Xt==null?void 0:Xt.describedBy,type:"text",onMouseDown:Zt=>!qt&&Zt.stopPropagation()})});PillsInputField.classes=classes$o;PillsInputField.displayName="@mantine/core/PillsInputField";const defaultProps$N={},PillsInput=factory$2((xt,$t)=>{const Ct=useProps("PillsInput",defaultProps$N,xt),{children:kt,onMouseDown:Mt,onClick:Ft,size:jt,disabled:Bt,__staticSelector:Vt,error:zt,variant:Ht,...Gt}=Ct,qt=reactExports.useRef();return jsxRuntimeExports.jsx(PillsInputProvider,{value:{fieldRef:qt,size:jt,disabled:Bt,hasError:!!zt,variant:Ht},children:jsxRuntimeExports.jsx(InputBase,{size:jt,error:zt,variant:Ht,component:"div",ref:$t,onMouseDown:Wt=>{var Yt;Wt.preventDefault(),Mt==null||Mt(Wt),(Yt=qt.current)==null||Yt.focus()},onClick:Wt=>{var Yt;Wt.preventDefault(),Ft==null||Ft(Wt),(Yt=qt.current)==null||Yt.focus()},...Gt,multiline:!0,disabled:Bt,__staticSelector:Vt||"PillsInput",withAria:!1,children:kt})})});PillsInput.displayName="@mantine/core/PillsInput";PillsInput.Field=PillsInputField;function filterPickedValues({data:xt,value:$t}){const Ct=$t.map(Mt=>Mt.trim().toLowerCase());return xt.reduce((Mt,Ft)=>(isOptionsGroup(Ft)?Mt.push({group:Ft.group,items:Ft.items.filter(jt=>Ct.indexOf(jt.value.toLowerCase().trim())===-1)}):Ct.indexOf(Ft.value.toLowerCase().trim())===-1&&Mt.push(Ft),Mt),[])}const defaultProps$M={maxValues:1/0,withCheckIcon:!0,checkIconPosition:"left",hiddenInputValuesDivider:","},MultiSelect=factory$2((xt,$t)=>{const Ct=useProps("MultiSelect",defaultProps$M,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,size:zt,value:Ht,defaultValue:Gt,onChange:qt,onKeyDown:Wt,variant:Yt,data:Kt,dropdownOpened:Xt,defaultDropdownOpened:Qt,onDropdownOpen:Jt,onDropdownClose:Zt,selectFirstOptionOnChange:sn,onOptionSubmit:ln,comboboxProps:dn,filter:hn,limit:cn,withScrollArea:pn,maxDropdownHeight:yn,searchValue:gn,defaultSearchValue:En,onSearchChange:bn,readOnly:xn,disabled:Cn,onFocus:$n,onBlur:wn,onPaste:Rn,radius:Dn,rightSection:An,rightSectionWidth:Sn,rightSectionPointerEvents:vn,rightSectionProps:_n,leftSection:Tn,leftSectionWidth:Pn,leftSectionPointerEvents:Ln,leftSectionProps:Vn,inputContainer:Un,inputWrapperOrder:Wn,withAsterisk:rr,labelProps:ar,descriptionProps:nr,errorProps:mr,wrapperProps:kn,description:Fn,label:Hn,error:Bn,maxValues:jn,searchable:sr,nothingFoundMessage:Ar,withCheckIcon:Fr,checkIconPosition:Rr,hidePickedOptions:Qn,withErrorStyles:jr,name:Mr,form:pr,id:Tr,clearable:Hr,clearButtonProps:Xr,hiddenInputProps:Zr,placeholder:ur,hiddenInputValuesDivider:hr,required:gr,mod:qr,renderOption:ds,onRemove:ms,onClear:wr,scrollAreaProps:Wr,...ns}=Ct,us=useId$1(Tr),ps=getParsedComboboxData(Kt),Ls=getOptionsLockup(ps),vs=useCombobox({opened:Xt,defaultOpened:Qt,onDropdownOpen:Jt,onDropdownClose:()=>{Zt==null||Zt(),vs.resetSelectedOption()}}),{styleProps:Ps,rest:{type:Fs,autoComplete:zs,...Eo}}=extractStyleProps(ns),[js,Hs]=useUncontrolled({value:Ht,defaultValue:Gt,finalValue:[],onChange:qt}),[Us,Ks]=useUncontrolled({value:gn,defaultValue:En,finalValue:"",onChange:bn}),go=useStyles({name:"MultiSelect",classes:{},props:Ct,classNames:kt,styles:jt,unstyled:Bt}),{resolvedClassNames:vo,resolvedStyles:vr}=useResolvedStylesApi({props:Ct,styles:jt,classNames:kt}),lr=fs=>{Wt==null||Wt(fs),fs.key===" "&&!sr&&(fs.preventDefault(),vs.toggleDropdown()),fs.key==="Backspace"&&Us.length===0&&js.length>0&&(ms==null||ms(js[js.length-1]),Hs(js.slice(0,js.length-1)))},$r=js.map((fs,Ts)=>{var Bs,Xs;return jsxRuntimeExports.jsx(Pill,{withRemoveButton:!xn&&!((Bs=Ls[fs])!=null&&Bs.disabled),onRemove:()=>{Hs(js.filter(ro=>fs!==ro)),ms==null||ms(fs)},unstyled:Bt,disabled:Cn,...go("pill"),children:((Xs=Ls[fs])==null?void 0:Xs.label)||fs},`${fs}-${Ts}`)});reactExports.useEffect(()=>{sn&&vs.selectFirstOption()},[sn,js]);const Gr=Hr&&js.length>0&&!Cn&&!xn&&jsxRuntimeExports.jsx(Combobox.ClearButton,{size:zt,...Xr,onClear:()=>{wr==null||wr(),Hs([]),Ks("")}}),zr=filterPickedValues({data:ps,value:js});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Combobox,{store:vs,classNames:vo,styles:vr,unstyled:Bt,size:zt,readOnly:xn,__staticSelector:"MultiSelect",onOptionSubmit:fs=>{ln==null||ln(fs),Ks(""),vs.updateSelectedOptionIndex("selected"),js.includes(Ls[fs].value)?(Hs(js.filter(Ts=>Ts!==Ls[fs].value)),ms==null||ms(Ls[fs].value)):js.length<jn&&Hs([...js,Ls[fs].value])},...dn,children:[jsxRuntimeExports.jsx(Combobox.DropdownTarget,{children:jsxRuntimeExports.jsx(PillsInput,{...Ps,__staticSelector:"MultiSelect",classNames:vo,styles:vr,unstyled:Bt,size:zt,className:Mt,style:Ft,variant:Yt,disabled:Cn,radius:Dn,rightSection:An||Gr||jsxRuntimeExports.jsx(Combobox.Chevron,{size:zt,error:Bn,unstyled:Bt}),rightSectionPointerEvents:vn||(Gr?"all":"none"),rightSectionWidth:Sn,rightSectionProps:_n,leftSection:Tn,leftSectionWidth:Pn,leftSectionPointerEvents:Ln,leftSectionProps:Vn,inputContainer:Un,inputWrapperOrder:Wn,withAsterisk:rr,labelProps:ar,descriptionProps:nr,errorProps:mr,wrapperProps:kn,description:Fn,label:Hn,error:Bn,multiline:!0,withErrorStyles:jr,__stylesApiProps:{...Ct,rightSectionPointerEvents:vn||(Gr?"all":"none"),multiline:!0},pointer:!sr,onClick:()=>sr?vs.openDropdown():vs.toggleDropdown(),"data-expanded":vs.dropdownOpened||void 0,id:us,required:gr,mod:qr,children:jsxRuntimeExports.jsxs(Pill.Group,{disabled:Cn,unstyled:Bt,...go("pillsList"),children:[$r,jsxRuntimeExports.jsx(Combobox.EventsTarget,{autoComplete:zs,children:jsxRuntimeExports.jsx(PillsInput.Field,{...Eo,ref:$t,id:us,placeholder:ur,type:!sr&&!ur?"hidden":"visible",...go("inputField"),unstyled:Bt,onFocus:fs=>{$n==null||$n(fs),sr&&vs.openDropdown()},onBlur:fs=>{wn==null||wn(fs),vs.closeDropdown(),Ks("")},onKeyDown:lr,value:Us,onChange:fs=>{Ks(fs.currentTarget.value),sr&&vs.openDropdown(),sn&&vs.selectFirstOption()},disabled:Cn,readOnly:xn||!sr,pointer:!sr})})]})})}),jsxRuntimeExports.jsx(OptionsDropdown,{data:Qn?zr:ps,hidden:xn||Cn,filter:hn,search:Us,limit:cn,hiddenWhenEmpty:!sr||!Ar||Qn&&zr.length===0&&Us.trim().length===0,withScrollArea:pn,maxDropdownHeight:yn,filterOptions:sr,value:js,checkIconPosition:Rr,withCheckIcon:Fr,nothingFoundMessage:Ar,unstyled:Bt,labelId:Hn?`${us}-label`:void 0,"aria-label":Hn?void 0:ns["aria-label"],renderOption:ds,scrollAreaProps:Wr})]}),jsxRuntimeExports.jsx(Combobox.HiddenInput,{name:Mr,valuesDivider:hr,value:js,form:pr,disabled:Cn,...Zr})]})});MultiSelect.classes={...InputBase.classes,...Combobox.classes};MultiSelect.displayName="@mantine/core/MultiSelect";var classes$n={root:"m_f0824112",description:"m_57492dcc",section:"m_690090b5",label:"m_1f6ac4c4",body:"m_f07af9d2",children:"m_e17b862f",chevron:"m_1fd8a00b"};const defaultProps$L={},varsResolver$l=(xt,{variant:$t,color:Ct,childrenOffset:kt,autoContrast:Mt})=>{const Ft=xt.variantColorResolver({color:Ct||xt.primaryColor,theme:xt,variant:$t||"light",autoContrast:Mt});return{root:{"--nl-bg":Ct||$t?Ft.background:void 0,"--nl-hover":Ct||$t?Ft.hover:void 0,"--nl-color":Ct||$t?Ft.color:void 0},children:{"--nl-offset":getSpacing(kt)}}},NavLink=polymorphicFactory((xt,$t)=>{const Ct=useProps("NavLink",defaultProps$L,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,opened:zt,defaultOpened:Ht,onChange:Gt,children:qt,onClick:Wt,active:Yt,disabled:Kt,leftSection:Xt,rightSection:Qt,label:Jt,description:Zt,disableRightSectionRotation:sn,noWrap:ln,childrenOffset:dn,onKeyDown:hn,autoContrast:cn,mod:pn,...yn}=Ct,gn=useStyles({name:"NavLink",props:Ct,classes:classes$n,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$l}),[En,bn]=useUncontrolled({value:zt,defaultValue:Ht,finalValue:!1,onChange:Gt}),xn=!!qt,Cn=$n=>{Wt==null||Wt($n),xn&&($n.preventDefault(),bn(!En))};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(UnstyledButton,{...gn("root"),component:"a",ref:$t,onClick:Cn,onKeyDown:$n=>{hn==null||hn($n),$n.nativeEvent.code==="Space"&&xn&&($n.preventDefault(),bn(!En))},unstyled:Bt,mod:[{disabled:Kt,active:Yt,expanded:En},pn],...yn,children:[Xt&&jsxRuntimeExports.jsx(Box,{component:"span",...gn("section"),mod:{position:"left"},children:Xt}),jsxRuntimeExports.jsxs(Box,{...gn("body"),mod:{"no-wrap":ln},children:[jsxRuntimeExports.jsx(Box,{component:"span",...gn("label"),children:Jt}),jsxRuntimeExports.jsx(Box,{component:"span",mod:{active:Yt},...gn("description"),children:Zt})]}),(xn||Qt)&&jsxRuntimeExports.jsx(Box,{...gn("section"),component:"span",mod:{rotate:En&&!sn,position:"right"},children:xn?Qt||jsxRuntimeExports.jsx(AccordionChevron,{...gn("chevron")}):Qt})]}),jsxRuntimeExports.jsx(Collapse,{in:En,...gn("collapse"),children:jsxRuntimeExports.jsx("div",{...gn("children"),children:qt})})]})});NavLink.classes=classes$n;NavLink.displayName="@mantine/core/NavLink";function __rest(xt,$t){var Ct={};for(var kt in xt)Object.prototype.hasOwnProperty.call(xt,kt)&&$t.indexOf(kt)<0&&(Ct[kt]=xt[kt]);if(xt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Mt=0,kt=Object.getOwnPropertySymbols(xt);Mt<kt.length;Mt++)$t.indexOf(kt[Mt])<0&&Object.prototype.propertyIsEnumerable.call(xt,kt[Mt])&&(Ct[kt[Mt]]=xt[kt[Mt]]);return Ct}var SourceType;(function(xt){xt.event="event",xt.props="prop"})(SourceType||(SourceType={}));function noop$9(){}function memoizeOnce(xt){var $t,Ct=void 0;return function(){for(var kt=[],Mt=arguments.length;Mt--;)kt[Mt]=arguments[Mt];return $t&&kt.length===$t.length&&kt.every(function(Ft,jt){return Ft===$t[jt]})||($t=kt,Ct=xt.apply(void 0,kt)),Ct}}function charIsNumber(xt){return!!(xt||"").match(/\d/)}function isNil(xt){return xt==null}function isNanValue(xt){return typeof xt=="number"&&isNaN(xt)}function isNotValidValue(xt){return isNil(xt)||isNanValue(xt)||typeof xt=="number"&&!isFinite(xt)}function escapeRegExp$1(xt){return xt.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function getThousandsGroupRegex(xt){switch(xt){case"lakh":return/(\d+?)(?=(\d\d)+(\d)(?!\d))(\.\d+)?/g;case"wan":return/(\d)(?=(\d{4})+(?!\d))/g;case"thousand":default:return/(\d)(?=(\d{3})+(?!\d))/g}}function applyThousandSeparator(xt,$t,Ct){var kt=getThousandsGroupRegex(Ct),Mt=xt.search(/[1-9]/);return Mt=Mt===-1?xt.length:Mt,xt.substring(0,Mt)+xt.substring(Mt,xt.length).replace(kt,"$1"+$t)}function usePersistentCallback(xt){var $t=reactExports.useRef(xt);$t.current=xt;var Ct=reactExports.useRef(function(){for(var kt=[],Mt=arguments.length;Mt--;)kt[Mt]=arguments[Mt];return $t.current.apply($t,kt)});return Ct.current}function splitDecimal(xt,$t){$t===void 0&&($t=!0);var Ct=xt[0]==="-",kt=Ct&&$t;xt=xt.replace("-","");var Mt=xt.split("."),Ft=Mt[0],jt=Mt[1]||"";return{beforeDecimal:Ft,afterDecimal:jt,hasNegation:Ct,addNegation:kt}}function fixLeadingZero(xt){if(!xt)return xt;var $t=xt[0]==="-";$t&&(xt=xt.substring(1,xt.length));var Ct=xt.split("."),kt=Ct[0].replace(/^0+/,"")||"0",Mt=Ct[1]||"";return($t?"-":"")+kt+(Mt?"."+Mt:"")}function limitToScale(xt,$t,Ct){for(var kt="",Mt=Ct?"0":"",Ft=0;Ft<=$t-1;Ft++)kt+=xt[Ft]||Mt;return kt}function repeat$2(xt,$t){return Array($t+1).join(xt)}function toNumericString(xt){var $t=xt+"",Ct=$t[0]==="-"?"-":"";Ct&&($t=$t.substring(1));var kt=$t.split(/[eE]/g),Mt=kt[0],Ft=kt[1];if(Ft=Number(Ft),!Ft)return Ct+Mt;Mt=Mt.replace(".","");var jt=1+Ft,Bt=Mt.length;return jt<0?Mt="0."+repeat$2("0",Math.abs(jt))+Mt:jt>=Bt?Mt=Mt+repeat$2("0",jt-Bt):Mt=(Mt.substring(0,jt)||"0")+"."+Mt.substring(jt),Ct+Mt}function roundToPrecision(xt,$t,Ct){if(["","-"].indexOf(xt)!==-1)return xt;var kt=(xt.indexOf(".")!==-1||Ct)&&$t,Mt=splitDecimal(xt),Ft=Mt.beforeDecimal,jt=Mt.afterDecimal,Bt=Mt.hasNegation,Vt=parseFloat("0."+(jt||"0")),zt=jt.length<=$t?"0."+jt:Vt.toFixed($t),Ht=zt.split("."),Gt=Ft;Ft&&Number(Ht[0])&&(Gt=Ft.split("").reverse().reduce(function(Kt,Xt,Qt){return Kt.length>Qt?(Number(Kt[0])+Number(Xt)).toString()+Kt.substring(1,Kt.length):Xt+Kt},Ht[0]));var qt=limitToScale(Ht[1]||"",$t,Ct),Wt=Bt?"-":"",Yt=kt?".":"";return""+Wt+Gt+Yt+qt}function setCaretPosition(xt,$t){if(xt.value=xt.value,xt!==null){if(xt.createTextRange){var Ct=xt.createTextRange();return Ct.move("character",$t),Ct.select(),!0}return xt.selectionStart||xt.selectionStart===0?(xt.focus(),xt.setSelectionRange($t,$t),!0):(xt.focus(),!1)}}var findChangeRange=memoizeOnce(function(xt,$t){for(var Ct=0,kt=0,Mt=xt.length,Ft=$t.length;xt[Ct]===$t[Ct]&&Ct<Mt;)Ct++;for(;xt[Mt-1-kt]===$t[Ft-1-kt]&&Ft-kt>Ct&&Mt-kt>Ct;)kt++;return{from:{start:Ct,end:Mt-kt},to:{start:Ct,end:Ft-kt}}}),findChangedRangeFromCaretPositions=function(xt,$t){var Ct=Math.min(xt.selectionStart,$t);return{from:{start:Ct,end:xt.selectionEnd},to:{start:Ct,end:$t}}};function clamp$1(xt,$t,Ct){return Math.min(Math.max(xt,$t),Ct)}function geInputCaretPosition(xt){return Math.max(xt.selectionStart,xt.selectionEnd)}function addInputMode(){return typeof navigator<"u"&&!(navigator.platform&&/iPhone|iPod/.test(navigator.platform))}function getDefaultChangeMeta(xt){return{from:{start:0,end:0},to:{start:0,end:xt.length},lastValue:""}}function defaultIsCharacterSame(xt){var $t=xt.currentValue,Ct=xt.formattedValue,kt=xt.currentValueIndex,Mt=xt.formattedValueIndex;return $t[kt]===Ct[Mt]}function getCaretPosition(xt,$t,Ct,kt,Mt,Ft,jt){jt===void 0&&(jt=defaultIsCharacterSame);var Bt=Mt.findIndex(function(sn){return sn}),Vt=xt.slice(0,Bt);!$t&&!Ct.startsWith(Vt)&&($t=Vt,Ct=Vt+Ct,kt=kt+Vt.length);for(var zt=Ct.length,Ht=xt.length,Gt={},qt=new Array(zt),Wt=0;Wt<zt;Wt++){qt[Wt]=-1;for(var Yt=0,Kt=Ht;Yt<Kt;Yt++){var Xt=jt({currentValue:Ct,lastValue:$t,formattedValue:xt,currentValueIndex:Wt,formattedValueIndex:Yt});if(Xt&&Gt[Yt]!==!0){qt[Wt]=Yt,Gt[Yt]=!0;break}}}for(var Qt=kt;Qt<zt&&(qt[Qt]===-1||!Ft(Ct[Qt]));)Qt++;var Jt=Qt===zt||qt[Qt]===-1?Ht:qt[Qt];for(Qt=kt-1;Qt>0&&qt[Qt]===-1;)Qt--;var Zt=Qt===-1||qt[Qt]===-1?0:qt[Qt]+1;return Zt>Jt?Jt:kt-Zt<Jt-kt?Zt:Jt}function getCaretPosInBoundary(xt,$t,Ct,kt){var Mt=xt.length;if($t=clamp$1($t,0,Mt),kt==="left"){for(;$t>=0&&!Ct[$t];)$t--;$t===-1&&($t=Ct.indexOf(!0))}else{for(;$t<=Mt&&!Ct[$t];)$t++;$t>Mt&&($t=Ct.lastIndexOf(!0))}return $t===-1&&($t=Mt),$t}function caretUnknownFormatBoundary(xt){for(var $t=Array.from({length:xt.length+1}).map(function(){return!0}),Ct=0,kt=$t.length;Ct<kt;Ct++)$t[Ct]=!!(charIsNumber(xt[Ct])||charIsNumber(xt[Ct-1]));return $t}function useInternalValues(xt,$t,Ct,kt,Mt,Ft){Ft===void 0&&(Ft=noop$9);var jt=usePersistentCallback(function(Yt,Kt){var Xt,Qt;return isNotValidValue(Yt)?(Qt="",Xt=""):typeof Yt=="number"||Kt?(Qt=typeof Yt=="number"?toNumericString(Yt):Yt,Xt=kt(Qt)):(Qt=Mt(Yt,void 0),Xt=kt(Qt)),{formattedValue:Xt,numAsString:Qt}}),Bt=reactExports.useState(function(){return jt(isNil(xt)?$t:xt,Ct)}),Vt=Bt[0],zt=Bt[1],Ht=function(Yt,Kt){Yt.formattedValue!==Vt.formattedValue&&zt({formattedValue:Yt.formattedValue,numAsString:Yt.value}),Ft(Yt,Kt)},Gt=xt,qt=Ct;isNil(xt)&&(Gt=Vt.numAsString,qt=!0);var Wt=jt(Gt,qt);return reactExports.useMemo(function(){zt(Wt)},[Wt.formattedValue]),[Vt,Ht]}function defaultRemoveFormatting(xt){return xt.replace(/[^0-9]/g,"")}function defaultFormat(xt){return xt}function NumberFormatBase(xt){var $t=xt.type;$t===void 0&&($t="text");var Ct=xt.displayType;Ct===void 0&&(Ct="input");var kt=xt.customInput,Mt=xt.renderText,Ft=xt.getInputRef,jt=xt.format;jt===void 0&&(jt=defaultFormat);var Bt=xt.removeFormatting;Bt===void 0&&(Bt=defaultRemoveFormatting);var Vt=xt.defaultValue,zt=xt.valueIsNumericString,Ht=xt.onValueChange,Gt=xt.isAllowed,qt=xt.onChange;qt===void 0&&(qt=noop$9);var Wt=xt.onKeyDown;Wt===void 0&&(Wt=noop$9);var Yt=xt.onMouseUp;Yt===void 0&&(Yt=noop$9);var Kt=xt.onFocus;Kt===void 0&&(Kt=noop$9);var Xt=xt.onBlur;Xt===void 0&&(Xt=noop$9);var Qt=xt.value,Jt=xt.getCaretBoundary;Jt===void 0&&(Jt=caretUnknownFormatBoundary);var Zt=xt.isValidInputCharacter;Zt===void 0&&(Zt=charIsNumber);var sn=xt.isCharacterSame,ln=__rest(xt,["type","displayType","customInput","renderText","getInputRef","format","removeFormatting","defaultValue","valueIsNumericString","onValueChange","isAllowed","onChange","onKeyDown","onMouseUp","onFocus","onBlur","value","getCaretBoundary","isValidInputCharacter","isCharacterSame"]),dn=useInternalValues(Qt,Vt,!!zt,jt,Bt,Ht),hn=dn[0],cn=hn.formattedValue,pn=hn.numAsString,yn=dn[1],gn=reactExports.useRef(),En=reactExports.useRef({formattedValue:cn,numAsString:pn}),bn=function(Bn,jn){En.current={formattedValue:Bn.formattedValue,numAsString:Bn.value},yn(Bn,jn)},xn=reactExports.useState(!1),Cn=xn[0],$n=xn[1],wn=reactExports.useRef(null),Rn=reactExports.useRef({setCaretTimeout:null,focusTimeout:null});reactExports.useEffect(function(){return $n(!0),function(){clearTimeout(Rn.current.setCaretTimeout),clearTimeout(Rn.current.focusTimeout)}},[]);var Dn=jt,An=function(Bn,jn){var sr=parseFloat(jn);return{formattedValue:Bn,value:jn,floatValue:isNaN(sr)?void 0:sr}},Sn=function(Bn,jn,sr){Bn.selectionStart===0&&Bn.selectionEnd===Bn.value.length||(setCaretPosition(Bn,jn),Rn.current.setCaretTimeout=setTimeout(function(){Bn.value===sr&&Bn.selectionStart!==jn&&setCaretPosition(Bn,jn)},0))},vn=function(Bn,jn,sr){return getCaretPosInBoundary(Bn,jn,Jt(Bn),sr)},_n=function(Bn,jn,sr){var Ar=Jt(jn),Fr=getCaretPosition(jn,cn,Bn,sr,Ar,Zt,sn);return Fr=getCaretPosInBoundary(jn,Fr,Ar),Fr},Tn=function(Bn){var jn=Bn.formattedValue;jn===void 0&&(jn="");var sr=Bn.input,Ar=Bn.source,Fr=Bn.event,Rr=Bn.numAsString,Qn;if(sr){var jr=Bn.inputValue||sr.value,Mr=geInputCaretPosition(sr);sr.value=jn,Qn=_n(jr,jn,Mr),Qn!==void 0&&Sn(sr,Qn,jn)}jn!==cn&&bn(An(jn,Rr),{event:Fr,source:Ar})};reactExports.useEffect(function(){var Bn=En.current,jn=Bn.formattedValue,sr=Bn.numAsString;(cn!==jn||pn!==sr)&&bn(An(cn,pn),{event:void 0,source:SourceType.props})},[cn,pn]);var Pn=wn.current?geInputCaretPosition(wn.current):void 0,Ln=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect;Ln(function(){var Bn=wn.current;if(cn!==En.current.formattedValue&&Bn){var jn=_n(En.current.formattedValue,cn,Pn);Bn.value=cn,Sn(Bn,jn,cn)}},[cn]);var Vn=function(Bn,jn,sr){var Ar=jn.target,Fr=gn.current?findChangedRangeFromCaretPositions(gn.current,Ar.selectionEnd):findChangeRange(cn,Bn),Rr=Object.assign(Object.assign({},Fr),{lastValue:cn}),Qn=Bt(Bn,Rr),jr=Dn(Qn);if(Qn=Bt(jr,void 0),Gt&&!Gt(An(jr,Qn))){var Mr=jn.target,pr=geInputCaretPosition(Mr),Tr=_n(Bn,cn,pr);return Mr.value=cn,Sn(Mr,Tr,cn),!1}return Tn({formattedValue:jr,numAsString:Qn,inputValue:Bn,event:jn,source:sr,input:jn.target}),!0},Un=function(Bn,jn){jn===void 0&&(jn=0);var sr=Bn.selectionStart,Ar=Bn.selectionEnd;gn.current={selectionStart:sr,selectionEnd:Ar+jn}},Wn=function(Bn){var jn=Bn.target,sr=jn.value,Ar=Vn(sr,Bn,SourceType.event);Ar&&qt(Bn),gn.current=void 0},rr=function(Bn){var jn=Bn.target,sr=Bn.key,Ar=jn.selectionStart,Fr=jn.selectionEnd,Rr=jn.value;Rr===void 0&&(Rr="");var Qn;sr==="ArrowLeft"||sr==="Backspace"?Qn=Math.max(Ar-1,0):sr==="ArrowRight"?Qn=Math.min(Ar+1,Rr.length):sr==="Delete"&&(Qn=Ar);var jr=0;sr==="Delete"&&Ar===Fr&&(jr=1);var Mr=sr==="ArrowLeft"||sr==="ArrowRight";if(Qn===void 0||Ar!==Fr&&!Mr){Wt(Bn),Un(jn,jr);return}var pr=Qn;if(Mr){var Tr=sr==="ArrowLeft"?"left":"right";pr=vn(Rr,Qn,Tr),pr!==Qn&&Bn.preventDefault()}else sr==="Delete"&&!Zt(Rr[Qn])?pr=vn(Rr,Qn,"right"):sr==="Backspace"&&!Zt(Rr[Qn])&&(pr=vn(Rr,Qn,"left"));pr!==Qn&&Sn(jn,pr,Rr),Wt(Bn),Un(jn,jr)},ar=function(Bn){var jn=Bn.target,sr=function(){var Ar=jn.selectionStart,Fr=jn.selectionEnd,Rr=jn.value;if(Rr===void 0&&(Rr=""),Ar===Fr){var Qn=vn(Rr,Ar);Qn!==Ar&&Sn(jn,Qn,Rr)}};sr(),requestAnimationFrame(function(){sr()}),Yt(Bn),Un(jn)},nr=function(Bn){Bn.persist&&Bn.persist();var jn=Bn.target,sr=Bn.currentTarget;wn.current=jn,Rn.current.focusTimeout=setTimeout(function(){var Ar=jn.selectionStart,Fr=jn.selectionEnd,Rr=jn.value;Rr===void 0&&(Rr="");var Qn=vn(Rr,Ar);Qn!==Ar&&!(Ar===0&&Fr===Rr.length)&&Sn(jn,Qn,Rr),Kt(Object.assign(Object.assign({},Bn),{currentTarget:sr}))},0)},mr=function(Bn){wn.current=null,clearTimeout(Rn.current.focusTimeout),clearTimeout(Rn.current.setCaretTimeout),Xt(Bn)},kn=Cn&&addInputMode()?"numeric":void 0,Fn=Object.assign({inputMode:kn},ln,{type:$t,value:cn,onChange:Wn,onKeyDown:rr,onMouseUp:ar,onFocus:nr,onBlur:mr});if(Ct==="text")return Mt?React$1.createElement(React$1.Fragment,null,Mt(cn,ln)||null):React$1.createElement("span",Object.assign({},ln,{ref:Ft}),cn);if(kt){var Hn=kt;return React$1.createElement(Hn,Object.assign({},Fn,{ref:Ft}))}return React$1.createElement("input",Object.assign({},Fn,{ref:Ft}))}function format$7(xt,$t){var Ct=$t.decimalScale,kt=$t.fixedDecimalScale,Mt=$t.prefix;Mt===void 0&&(Mt="");var Ft=$t.suffix;Ft===void 0&&(Ft="");var jt=$t.allowNegative,Bt=$t.thousandsGroupStyle;if(Bt===void 0&&(Bt="thousand"),xt===""||xt==="-")return xt;var Vt=getSeparators($t),zt=Vt.thousandSeparator,Ht=Vt.decimalSeparator,Gt=Ct!==0&&xt.indexOf(".")!==-1||Ct&&kt,qt=splitDecimal(xt,jt),Wt=qt.beforeDecimal,Yt=qt.afterDecimal,Kt=qt.addNegation;return Ct!==void 0&&(Yt=limitToScale(Yt,Ct,!!kt)),zt&&(Wt=applyThousandSeparator(Wt,zt,Bt)),Mt&&(Wt=Mt+Wt),Ft&&(Yt=Yt+Ft),Kt&&(Wt="-"+Wt),xt=Wt+(Gt&&Ht||"")+Yt,xt}function getSeparators(xt){var $t=xt.decimalSeparator;$t===void 0&&($t=".");var Ct=xt.thousandSeparator,kt=xt.allowedDecimalSeparators;return Ct===!0&&(Ct=","),kt||(kt=[$t,"."]),{decimalSeparator:$t,thousandSeparator:Ct,allowedDecimalSeparators:kt}}function handleNegation(xt,$t){xt===void 0&&(xt="");var Ct=new RegExp("(-)"),kt=new RegExp("(-)(.)*(-)"),Mt=Ct.test(xt),Ft=kt.test(xt);return xt=xt.replace(/-/g,""),Mt&&!Ft&&$t&&(xt="-"+xt),xt}function getNumberRegex(xt,$t){return new RegExp("(^-)|[0-9]|"+escapeRegExp$1(xt),"g")}function isNumericString(xt,$t,Ct){return xt===""?!0:!($t!=null&&$t.match(/\d/))&&!(Ct!=null&&Ct.match(/\d/))&&typeof xt=="string"&&!isNaN(Number(xt))}function removeFormatting(xt,$t,Ct){var kt;$t===void 0&&($t=getDefaultChangeMeta(xt));var Mt=Ct.allowNegative,Ft=Ct.prefix;Ft===void 0&&(Ft="");var jt=Ct.suffix;jt===void 0&&(jt="");var Bt=Ct.decimalScale,Vt=$t.from,zt=$t.to,Ht=zt.start,Gt=zt.end,qt=getSeparators(Ct),Wt=qt.allowedDecimalSeparators,Yt=qt.decimalSeparator,Kt=xt[Gt]===Yt;if(charIsNumber(xt)&&(xt===Ft||xt===jt)&&$t.lastValue==="")return xt;if(Gt-Ht===1&&Wt.indexOf(xt[Ht])!==-1){var Xt=Bt===0?"":Yt;xt=xt.substring(0,Ht)+Xt+xt.substring(Ht+1,xt.length)}var Qt=function(wn,Rn,Dn){var An=!1,Sn=!1;Ft.startsWith("-")?An=!1:wn.startsWith("--")?(An=!1,Sn=!0):jt.startsWith("-")&&wn.length===jt.length?An=!1:wn[0]==="-"&&(An=!0);var vn=An?1:0;return Sn&&(vn=2),vn&&(wn=wn.substring(vn),Rn-=vn,Dn-=vn),{value:wn,start:Rn,end:Dn,hasNegation:An}},Jt=Qt(xt,Ht,Gt),Zt=Jt.hasNegation;kt=Jt,xt=kt.value,Ht=kt.start,Gt=kt.end;var sn=Qt($t.lastValue,Vt.start,Vt.end),ln=sn.start,dn=sn.end,hn=sn.value,cn=xt.substring(Ht,Gt);xt.length&&hn.length&&(ln>hn.length-jt.length||dn<Ft.length)&&!(cn&&jt.startsWith(cn))&&(xt=hn);var pn=0;xt.startsWith(Ft)?pn+=Ft.length:Ht<Ft.length&&(pn=Ht),xt=xt.substring(pn),Gt-=pn;var yn=xt.length,gn=xt.length-jt.length;xt.endsWith(jt)?yn=gn:(Gt>gn||Gt>xt.length-jt.length)&&(yn=Gt),xt=xt.substring(0,yn),xt=handleNegation(Zt?"-"+xt:xt,Mt),xt=(xt.match(getNumberRegex(Yt))||[]).join("");var En=xt.indexOf(Yt);xt=xt.replace(new RegExp(escapeRegExp$1(Yt),"g"),function(wn,Rn){return Rn===En?".":""});var bn=splitDecimal(xt,Mt),xn=bn.beforeDecimal,Cn=bn.afterDecimal,$n=bn.addNegation;return zt.end-zt.start<Vt.end-Vt.start&&xn===""&&Kt&&!parseFloat(Cn)&&(xt=$n?"-":""),xt}function getCaretBoundary(xt,$t){var Ct=$t.prefix;Ct===void 0&&(Ct="");var kt=$t.suffix;kt===void 0&&(kt="");var Mt=Array.from({length:xt.length+1}).map(function(){return!0}),Ft=xt[0]==="-";Mt.fill(!1,0,Ct.length+(Ft?1:0));var jt=xt.length;return Mt.fill(!1,jt-kt.length+1,jt+1),Mt}function validateAndUpdateProps(xt){var $t=getSeparators(xt),Ct=$t.thousandSeparator,kt=$t.decimalSeparator,Mt=xt.prefix;Mt===void 0&&(Mt="");var Ft=xt.allowNegative;if(Ft===void 0&&(Ft=!0),Ct===kt)throw new Error(`
        Decimal separator can't be same as thousand separator.
        thousandSeparator: `+Ct+` (thousandSeparator = {true} is same as thousandSeparator = ",")
        decimalSeparator: `+kt+` (default value for decimalSeparator is .)
     `);return Mt.startsWith("-")&&Ft&&(console.error(`
      Prefix can't start with '-' when allowNegative is true.
      prefix: `+Mt+`
      allowNegative: `+Ft+`
    `),Ft=!1),Object.assign(Object.assign({},xt),{allowNegative:Ft})}function useNumericFormat(xt){xt=validateAndUpdateProps(xt),xt.decimalSeparator,xt.allowedDecimalSeparators,xt.thousandsGroupStyle;var $t=xt.suffix,Ct=xt.allowNegative,kt=xt.allowLeadingZeros,Mt=xt.onKeyDown;Mt===void 0&&(Mt=noop$9);var Ft=xt.onBlur;Ft===void 0&&(Ft=noop$9);var jt=xt.thousandSeparator,Bt=xt.decimalScale,Vt=xt.fixedDecimalScale,zt=xt.prefix;zt===void 0&&(zt="");var Ht=xt.defaultValue,Gt=xt.value,qt=xt.valueIsNumericString,Wt=xt.onValueChange,Yt=__rest(xt,["decimalSeparator","allowedDecimalSeparators","thousandsGroupStyle","suffix","allowNegative","allowLeadingZeros","onKeyDown","onBlur","thousandSeparator","decimalScale","fixedDecimalScale","prefix","defaultValue","value","valueIsNumericString","onValueChange"]),Kt=getSeparators(xt),Xt=Kt.decimalSeparator,Qt=Kt.allowedDecimalSeparators,Jt=function($n){return format$7($n,xt)},Zt=function($n,wn){return removeFormatting($n,wn,xt)},sn=isNil(Gt)?Ht:Gt,ln=qt??isNumericString(sn,zt,$t);isNil(Gt)?isNil(Ht)||(ln=ln||typeof Ht=="number"):ln=ln||typeof Gt=="number";var dn=function($n){return isNotValidValue($n)?$n:(typeof $n=="number"&&($n=toNumericString($n)),ln&&typeof Bt=="number"?roundToPrecision($n,Bt,!!Vt):$n)},hn=useInternalValues(dn(Gt),dn(Ht),!!ln,Jt,Zt,Wt),cn=hn[0],pn=cn.numAsString,yn=cn.formattedValue,gn=hn[1],En=function($n){var wn=$n.target,Rn=$n.key,Dn=wn.selectionStart,An=wn.selectionEnd,Sn=wn.value;if(Sn===void 0&&(Sn=""),(Rn==="Backspace"||Rn==="Delete")&&An<zt.length){$n.preventDefault();return}if(Dn!==An){Mt($n);return}Rn==="Backspace"&&Sn[0]==="-"&&Dn===zt.length+1&&Ct&&setCaretPosition(wn,1),Bt&&Vt&&(Rn==="Backspace"&&Sn[Dn-1]===Xt?(setCaretPosition(wn,Dn-1),$n.preventDefault()):Rn==="Delete"&&Sn[Dn]===Xt&&$n.preventDefault()),Qt!=null&&Qt.includes(Rn)&&Sn[Dn]===Xt&&setCaretPosition(wn,Dn+1);var vn=jt===!0?",":jt;Rn==="Backspace"&&Sn[Dn-1]===vn&&setCaretPosition(wn,Dn-1),Rn==="Delete"&&Sn[Dn]===vn&&setCaretPosition(wn,Dn+1),Mt($n)},bn=function($n){var wn=pn;if(wn.match(/\d/g)||(wn=""),kt||(wn=fixLeadingZero(wn)),Vt&&Bt&&(wn=roundToPrecision(wn,Bt,Vt)),wn!==pn){var Rn=format$7(wn,xt);gn({formattedValue:Rn,value:wn,floatValue:parseFloat(wn)},{event:$n,source:SourceType.event})}Ft($n)},xn=function($n){return $n===Xt?!0:charIsNumber($n)},Cn=function($n){var wn=$n.currentValue,Rn=$n.lastValue,Dn=$n.formattedValue,An=$n.currentValueIndex,Sn=$n.formattedValueIndex,vn=wn[An],_n=Dn[Sn],Tn=findChangeRange(Rn,wn),Pn=Tn.to;return An>=Pn.start&&An<Pn.end&&Qt&&Qt.includes(vn)&&_n===Xt?!0:vn===_n};return Object.assign(Object.assign({},Yt),{value:yn,valueIsNumericString:!1,isValidInputCharacter:xn,isCharacterSame:Cn,onValueChange:gn,format:Jt,removeFormatting:Zt,getCaretBoundary:function($n){return getCaretBoundary($n,xt)},onKeyDown:En,onBlur:bn})}function NumericFormat(xt){var $t=useNumericFormat(xt);return React$1.createElement(NumberFormatBase,Object.assign({},$t))}function NumberInputChevron({direction:xt,style:$t,...Ct}){return jsxRuntimeExports.jsx("svg",{style:{width:"var(--ni-chevron-size)",height:"var(--ni-chevron-size)",transform:xt==="up"?"rotate(180deg)":void 0,...$t},viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",...Ct,children:jsxRuntimeExports.jsx("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}var classes$m={root:"m_e2f5cd4e",controls:"m_95e17d22",control:"m_80b4b171"};const leadingDecimalZeroPattern=/^(0\.0*|-0(\.0*)?)$/,leadingZerosPattern=/^-?0\d+(\.\d+)?\.?$/;function isValidNumber(xt){return(typeof xt=="number"?xt<Number.MAX_SAFE_INTEGER:!Number.isNaN(Number(xt)))&&!Number.isNaN(xt)}function isInRange$1(xt,$t,Ct){if(xt===void 0)return!0;const kt=$t===void 0||xt>=$t,Mt=Ct===void 0||xt<=Ct;return kt&&Mt}const defaultProps$K={step:1,clampBehavior:"blur",allowDecimal:!0,allowNegative:!0,withKeyboardEvents:!0,allowLeadingZeros:!0,trimLeadingZeroesOnBlur:!0,startValue:0},varsResolver$k=(xt,{size:$t})=>({controls:{"--ni-chevron-size":getSize($t,"ni-chevron-size")}}),NumberInput=factory$2((xt,$t)=>{const Ct=useProps("NumberInput",defaultProps$K,xt),{className:kt,classNames:Mt,styles:Ft,unstyled:jt,vars:Bt,onChange:Vt,onValueChange:zt,value:Ht,defaultValue:Gt,max:qt,min:Wt,step:Yt,hideControls:Kt,rightSection:Xt,isAllowed:Qt,clampBehavior:Jt,onBlur:Zt,allowDecimal:sn,decimalScale:ln,onKeyDown:dn,onKeyDownCapture:hn,handlersRef:cn,startValue:pn,disabled:yn,rightSectionPointerEvents:gn,allowNegative:En,readOnly:bn,size:xn,rightSectionWidth:Cn,stepHoldInterval:$n,stepHoldDelay:wn,allowLeadingZeros:Rn,withKeyboardEvents:Dn,trimLeadingZeroesOnBlur:An,...Sn}=Ct,vn=useStyles({name:"NumberInput",classes:classes$m,props:Ct,classNames:Mt,styles:Ft,unstyled:jt,vars:Bt,varsResolver:varsResolver$k}),{resolvedClassNames:_n,resolvedStyles:Tn}=useResolvedStylesApi({classNames:Mt,styles:Ft,props:Ct}),[Pn,Ln]=useUncontrolled({value:Ht,defaultValue:Gt,onChange:Vt}),Vn=wn!==void 0&&$n!==void 0,Un=reactExports.useRef(null),Wn=reactExports.useRef(null),rr=reactExports.useRef(0),ar=(Qn,jr)=>{jr.source==="event"&&Ln(isValidNumber(Qn.floatValue)&&!leadingDecimalZeroPattern.test(Qn.value)&&!(Rn&&leadingZerosPattern.test(Qn.value))?Qn.floatValue:Qn.value),zt==null||zt(Qn,jr)},nr=Qn=>{const jr=String(Qn).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return jr?Math.max(0,(jr[1]?jr[1].length:0)-(jr[2]?+jr[2]:0)):0},mr=Qn=>{Un.current&&typeof Qn<"u"&&Un.current.setSelectionRange(Qn,Qn)},kn=reactExports.useRef();kn.current=()=>{let Qn;const jr=nr(Pn),Mr=nr(Yt),pr=Math.max(jr,Mr),Tr=10**pr;if(typeof Pn!="number"||Number.isNaN(Pn))Qn=clamp$4(pn,Wt,qt);else if(qt!==void 0){const Xr=(Math.round(Pn*Tr)+Math.round(Yt*Tr))/Tr;Qn=Xr<=qt?Xr:qt}else Qn=(Math.round(Pn*Tr)+Math.round(Yt*Tr))/Tr;const Hr=Qn.toFixed(pr);Ln(parseFloat(Hr)),zt==null||zt({floatValue:parseFloat(Hr),formattedValue:Hr,value:Hr},{source:"increment"}),setTimeout(()=>{var Xr;return mr((Xr=Un.current)==null?void 0:Xr.value.length)},0)};const Fn=reactExports.useRef();Fn.current=()=>{let Qn;const jr=Wt!==void 0?Wt:En?Number.MIN_SAFE_INTEGER:0,Mr=nr(Pn),pr=nr(Yt),Tr=Math.max(Mr,pr),Hr=10**Tr;if(typeof Pn!="number"||Number.isNaN(Pn))Qn=clamp$4(pn,jr,qt);else{const Zr=(Math.round(Pn*Hr)-Math.round(Yt*Hr))/Hr;Qn=jr!==void 0&&Zr<jr?jr:Zr}const Xr=Qn.toFixed(Tr);Ln(parseFloat(Xr)),zt==null||zt({floatValue:parseFloat(Xr),formattedValue:Xr,value:Xr},{source:"decrement"}),setTimeout(()=>{var Zr;return mr((Zr=Un.current)==null?void 0:Zr.value.length)},0)};const Hn=Qn=>{dn==null||dn(Qn),!(bn||!Dn)&&(Qn.key==="ArrowUp"&&(Qn.preventDefault(),kn.current()),Qn.key==="ArrowDown"&&(Qn.preventDefault(),Fn.current()))},Bn=Qn=>{if(hn==null||hn(Qn),Qn.key==="Backspace"){const jr=Un.current;jr.selectionStart===0&&jr.selectionStart===jr.selectionEnd&&(Qn.preventDefault(),window.setTimeout(()=>mr(0),0))}};assignRef(cn,{increment:kn.current,decrement:Fn.current});const jn=Qn=>{Qn?kn.current():Fn.current(),rr.current+=1},sr=Qn=>{if(jn(Qn),Vn){const jr=typeof $n=="number"?$n:$n(rr.current);Wn.current=window.setTimeout(()=>sr(Qn),jr)}},Ar=(Qn,jr)=>{var Mr;Qn.preventDefault(),(Mr=Un.current)==null||Mr.focus(),jn(jr),Vn&&(Wn.current=window.setTimeout(()=>sr(jr),wn))},Fr=()=>{Wn.current&&window.clearTimeout(Wn.current),Wn.current=null,rr.current=0},Rr=jsxRuntimeExports.jsxs("div",{...vn("controls"),children:[jsxRuntimeExports.jsx(UnstyledButton,{...vn("control"),tabIndex:-1,"aria-hidden":!0,disabled:yn||typeof Pn=="number"&&qt!==void 0&&Pn>=qt,mod:{direction:"up"},onMouseDown:Qn=>Qn.preventDefault(),onPointerDown:Qn=>{Ar(Qn,!0)},onPointerUp:Fr,onPointerLeave:Fr,children:jsxRuntimeExports.jsx(NumberInputChevron,{direction:"up"})}),jsxRuntimeExports.jsx(UnstyledButton,{...vn("control"),tabIndex:-1,"aria-hidden":!0,disabled:yn||typeof Pn=="number"&&Wt!==void 0&&Pn<=Wt,mod:{direction:"down"},onMouseDown:Qn=>Qn.preventDefault(),onPointerDown:Qn=>{Ar(Qn,!1)},onPointerUp:Fr,onPointerLeave:Fr,children:jsxRuntimeExports.jsx(NumberInputChevron,{direction:"down"})})]});return jsxRuntimeExports.jsx(InputBase,{component:NumericFormat,allowNegative:En,className:clsx(classes$m.root,kt),size:xn,...Sn,readOnly:bn,disabled:yn,value:Pn,getInputRef:useMergedRef($t,Un),onValueChange:ar,rightSection:Kt||bn?Xt:Xt||Rr,classNames:_n,styles:Tn,unstyled:jt,__staticSelector:"NumberInput",decimalScale:sn?ln:0,onKeyDown:Hn,onKeyDownCapture:Bn,rightSectionPointerEvents:gn??(yn?"none":void 0),rightSectionWidth:Cn??`var(--ni-right-section-width-${xn||"sm"})`,allowLeadingZeros:Rn,onBlur:Qn=>{if(Zt==null||Zt(Qn),Jt==="blur"&&typeof Pn=="number"&&clamp$4(Pn,Wt,qt)!==Pn&&Ln(clamp$4(Pn,Wt,qt)),An&&typeof Pn=="string"){const jr=Pn.replace(/^0+/,""),Mr=parseFloat(jr);Ln(Number.isNaN(Mr)?jr:Mr)}},isAllowed:Qn=>Jt==="strict"?Qt?Qt(Qn)&&isInRange$1(Qn.floatValue,Wt,qt):isInRange$1(Qn.floatValue,Wt,qt):Qt?Qt(Qn):!0})});NumberInput.classes={...InputBase.classes,...classes$m};NumberInput.displayName="@mantine/core/NumberInput";const[ProgressProvider,useProgressContext]=createSafeContext("Progress.Root component was not found in tree");var classes$l={root:"m_db6d6462",section:"m_2242eb65","stripes-animation":"m_81a374bd",label:"m_91e40b74"};const defaultProps$J={},ProgressLabel=factory$2((xt,$t)=>{const{classNames:Ct,className:kt,style:Mt,styles:Ft,vars:jt,...Bt}=useProps("ProgressLabel",defaultProps$J,xt),Vt=useProgressContext();return jsxRuntimeExports.jsx(Box,{ref:$t,...Vt.getStyles("label",{className:kt,style:Mt,classNames:Ct,styles:Ft}),...Bt})});ProgressLabel.classes=classes$l;ProgressLabel.displayName="@mantine/core/ProgressLabel";const defaultProps$I={},varsResolver$j=(xt,{size:$t,radius:Ct,transitionDuration:kt})=>({root:{"--progress-size":getSize($t,"progress-size"),"--progress-radius":Ct===void 0?void 0:getRadius(Ct),"--progress-transition-duration":typeof kt=="number"?`${kt}ms`:void 0}}),ProgressRoot=factory$2((xt,$t)=>{const Ct=useProps("ProgressRoot",defaultProps$I,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,autoContrast:zt,transitionDuration:Ht,...Gt}=Ct,qt=useStyles({name:"Progress",classes:classes$l,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$j});return jsxRuntimeExports.jsx(ProgressProvider,{value:{getStyles:qt,autoContrast:zt},children:jsxRuntimeExports.jsx(Box,{ref:$t,...qt("root"),...Gt})})});ProgressRoot.classes=classes$l;ProgressRoot.displayName="@mantine/core/ProgressRoot";const defaultProps$H={withAria:!0},ProgressSection=factory$2((xt,$t)=>{const{classNames:Ct,className:kt,style:Mt,styles:Ft,vars:jt,value:Bt,withAria:Vt,color:zt,striped:Ht,animated:Gt,mod:qt,...Wt}=useProps("ProgressSection",defaultProps$H,xt),Yt=useProgressContext(),Kt=useMantineTheme(),Xt=Vt?{role:"progressbar","aria-valuemax":100,"aria-valuemin":0,"aria-valuenow":Bt,"aria-valuetext":`${Bt}%`}:{};return jsxRuntimeExports.jsx(Box,{ref:$t,...Yt.getStyles("section",{className:kt,classNames:Ct,styles:Ft,style:Mt}),...Wt,...Xt,mod:[{striped:Ht||Gt,animated:Gt},qt],__vars:{"--progress-section-width":`${Bt}%`,"--progress-section-color":getThemeColor(zt,Kt),"--progress-label-color":getAutoContrastValue(Yt.autoContrast,Kt)?getContrastColor({color:zt,theme:Kt,autoContrast:Yt.autoContrast}):void 0}})});ProgressSection.classes=classes$l;ProgressSection.displayName="@mantine/core/ProgressSection";const defaultProps$G={},Progress=factory$2((xt,$t)=>{const Ct=useProps("Progress",defaultProps$G,xt),{value:kt,classNames:Mt,styles:Ft,vars:jt,color:Bt,striped:Vt,animated:zt,"aria-label":Ht,...Gt}=Ct,{resolvedClassNames:qt,resolvedStyles:Wt}=useResolvedStylesApi({classNames:Mt,styles:Ft,props:Ct});return jsxRuntimeExports.jsx(ProgressRoot,{ref:$t,classNames:qt,styles:Wt,vars:jt,...Gt,children:jsxRuntimeExports.jsx(ProgressSection,{value:kt,color:Bt,striped:Vt,animated:zt,"aria-label":Ht})})});Progress.classes=classes$l;Progress.displayName="@mantine/core/Progress";Progress.Section=ProgressSection;Progress.Root=ProgressRoot;Progress.Label=ProgressLabel;const[RadioGroupProvider,useRadioGroupContext]=createOptionalContext(),[RadioCardProvider,useRadioCardContext]=createOptionalContext();var classes$k={card:"m_9dc8ae12"};const defaultProps$F={withBorder:!0},varsResolver$i=(xt,{radius:$t})=>({card:{"--card-radius":getRadius($t)}}),RadioCard=factory$2((xt,$t)=>{const Ct=useProps("RadioCard",defaultProps$F,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,checked:zt,mod:Ht,withBorder:Gt,value:qt,onClick:Wt,name:Yt,onKeyDown:Kt,...Xt}=Ct,Qt=useStyles({name:"RadioCard",classes:classes$k,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$i,rootSelector:"card"}),{dir:Jt}=useDirection(),Zt=useRadioGroupContext(),sn=typeof zt=="boolean"?zt:(Zt==null?void 0:Zt.value)===qt||!1,ln=Yt||(Zt==null?void 0:Zt.name),dn=hn=>{if(Kt==null||Kt(hn),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(hn.nativeEvent.code)){hn.preventDefault();const cn=Array.from(document.querySelectorAll(`[role="radio"][name="${ln||"__mantine"}"]`)),pn=cn.findIndex(En=>En===hn.target),yn=pn+1>=cn.length?0:pn+1,gn=pn-1<0?cn.length-1:pn-1;hn.nativeEvent.code==="ArrowDown"&&(cn[yn].focus(),cn[yn].click()),hn.nativeEvent.code==="ArrowUp"&&(cn[gn].focus(),cn[gn].click()),hn.nativeEvent.code==="ArrowLeft"&&(cn[Jt==="ltr"?gn:yn].focus(),cn[Jt==="ltr"?gn:yn].click()),hn.nativeEvent.code==="ArrowRight"&&(cn[Jt==="ltr"?yn:gn].focus(),cn[Jt==="ltr"?yn:gn].click())}};return jsxRuntimeExports.jsx(RadioCardProvider,{value:{checked:sn},children:jsxRuntimeExports.jsx(UnstyledButton,{ref:$t,mod:[{"with-border":Gt,checked:sn},Ht],...Qt("card"),...Xt,role:"radio","aria-checked":sn,name:ln,onClick:hn=>{Wt==null||Wt(hn),Zt==null||Zt.onChange(qt||"")},onKeyDown:dn})})});RadioCard.displayName="@mantine/core/RadioCard";RadioCard.classes=classes$k;const defaultProps$E={},RadioGroup=factory$2((xt,$t)=>{const{value:Ct,defaultValue:kt,onChange:Mt,size:Ft,wrapperProps:jt,children:Bt,name:Vt,readOnly:zt,...Ht}=useProps("RadioGroup",defaultProps$E,xt),Gt=useId$1(Vt),[qt,Wt]=useUncontrolled({value:Ct,defaultValue:kt,finalValue:"",onChange:Mt}),Yt=Kt=>!zt&&Wt(typeof Kt=="string"?Kt:Kt.currentTarget.value);return jsxRuntimeExports.jsx(RadioGroupProvider,{value:{value:qt,onChange:Yt,size:Ft,name:Gt},children:jsxRuntimeExports.jsx(Input.Wrapper,{size:Ft,ref:$t,...jt,...Ht,labelElement:"div",__staticSelector:"RadioGroup",children:jsxRuntimeExports.jsx(InputsGroupFieldset,{role:"radiogroup",children:Bt})})})});RadioGroup.classes=Input.Wrapper.classes;RadioGroup.displayName="@mantine/core/RadioGroup";function RadioIcon({size:xt,style:$t,...Ct}){return jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 5 5",style:{width:rem$1(xt),height:rem$1(xt),...$t},"aria-hidden":!0,...Ct,children:jsxRuntimeExports.jsx("circle",{cx:"2.5",cy:"2.5",r:"2.5",fill:"currentColor"})})}var classes$j={indicator:"m_717d7ff6",icon:"m_3e4da632","indicator--outline":"m_2980836c"};const defaultProps$D={icon:RadioIcon},varsResolver$h=(xt,{radius:$t,color:Ct,size:kt,iconColor:Mt,variant:Ft,autoContrast:jt})=>{const Bt=parseThemeColor({color:Ct||xt.primaryColor,theme:xt}),Vt=Bt.isThemeColor&&Bt.shade===void 0?`var(--mantine-color-${Bt.color}-outline)`:Bt.color;return{indicator:{"--radio-size":getSize(kt,"radio-size"),"--radio-radius":$t===void 0?void 0:getRadius($t),"--radio-color":Ft==="outline"?Vt:getThemeColor(Ct,xt),"--radio-icon-size":getSize(kt,"radio-icon-size"),"--radio-icon-color":Mt?getThemeColor(Mt,xt):getAutoContrastValue(jt,xt)?getContrastColor({color:Ct,theme:xt,autoContrast:jt}):void 0}}},RadioIndicator=factory$2((xt,$t)=>{const Ct=useProps("RadioIndicator",defaultProps$D,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,icon:zt,radius:Ht,color:Gt,iconColor:qt,autoContrast:Wt,checked:Yt,mod:Kt,variant:Xt,disabled:Qt,...Jt}=Ct,Zt=zt,sn=useStyles({name:"RadioIndicator",classes:classes$j,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$h,rootSelector:"indicator"}),ln=useRadioCardContext(),dn=typeof Yt=="boolean"?Yt:(ln==null?void 0:ln.checked)||!1;return jsxRuntimeExports.jsx(Box,{ref:$t,...sn("indicator",{variant:Xt}),variant:Xt,mod:[{checked:dn,disabled:Qt},Kt],...Jt,children:jsxRuntimeExports.jsx(Zt,{...sn("icon")})})});RadioIndicator.displayName="@mantine/core/RadioIndicator";RadioIndicator.classes=classes$j;var classes$i={root:"m_f3f1af94",inner:"m_89c4f5e4",icon:"m_f3ed6b2b",radio:"m_8a3dbb89","radio--outline":"m_1bfe9d39"};const defaultProps$C={labelPosition:"right"},varsResolver$g=(xt,{size:$t,radius:Ct,color:kt,iconColor:Mt,variant:Ft,autoContrast:jt})=>{const Bt=parseThemeColor({color:kt||xt.primaryColor,theme:xt}),Vt=Bt.isThemeColor&&Bt.shade===void 0?`var(--mantine-color-${Bt.color}-outline)`:Bt.color;return{root:{"--radio-size":getSize($t,"radio-size"),"--radio-radius":Ct===void 0?void 0:getRadius(Ct),"--radio-color":Ft==="outline"?Vt:getThemeColor(kt,xt),"--radio-icon-color":Mt?getThemeColor(Mt,xt):getAutoContrastValue(jt,xt)?getContrastColor({color:kt,theme:xt,autoContrast:jt}):void 0,"--radio-icon-size":getSize($t,"radio-icon-size")}}},Radio=factory$2((xt,$t)=>{const Ct=useProps("Radio",defaultProps$C,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,id:zt,size:Ht,label:Gt,labelPosition:qt,description:Wt,error:Yt,radius:Kt,color:Xt,variant:Qt,disabled:Jt,wrapperProps:Zt,icon:sn=RadioIcon,rootRef:ln,iconColor:dn,onChange:hn,mod:cn,...pn}=Ct,yn=useStyles({name:"Radio",classes:classes$i,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$g}),gn=useRadioGroupContext(),En=(gn==null?void 0:gn.size)??Ht,bn=Ct.size?Ht:En,{styleProps:xn,rest:Cn}=extractStyleProps(pn),$n=useId$1(zt),wn=gn?{checked:gn.value===Cn.value,name:Cn.name??gn.name,onChange:Rn=>{gn.onChange(Rn),hn==null||hn(Rn)}}:{};return jsxRuntimeExports.jsx(InlineInput,{...yn("root"),__staticSelector:"Radio",__stylesApiProps:Ct,id:$n,size:bn,labelPosition:qt,label:Gt,description:Wt,error:Yt,disabled:Jt,classNames:kt,styles:jt,unstyled:Bt,"data-checked":wn.checked||void 0,variant:Qt,ref:ln,mod:cn,...xn,...Zt,children:jsxRuntimeExports.jsxs(Box,{...yn("inner"),mod:{"label-position":qt},children:[jsxRuntimeExports.jsx(Box,{...yn("radio",{focusable:!0,variant:Qt}),onChange:hn,...Cn,...wn,component:"input",mod:{error:!!Yt},ref:$t,id:$n,disabled:Jt,type:"radio"}),jsxRuntimeExports.jsx(sn,{...yn("icon"),"aria-hidden":!0})]})})});Radio.classes=classes$i;Radio.displayName="@mantine/core/Radio";Radio.Group=RadioGroup;Radio.Card=RadioCard;Radio.Indicator=RadioIndicator;const defaultTransition={duration:100,transition:"fade"};function getTransitionProps(xt,$t){return{...defaultTransition,...$t,...xt}}function useFloatingTooltip({offset:xt,position:$t}){const[Ct,kt]=reactExports.useState(!1),Mt=reactExports.useRef(),{x:Ft,y:jt,elements:Bt,refs:Vt,update:zt,placement:Ht}=useFloating({placement:$t,middleware:[shift({crossAxis:!0,padding:5,rootBoundary:"document"})]}),Gt=Ht.includes("right")?xt:$t.includes("left")?xt*-1:0,qt=Ht.includes("bottom")?xt:$t.includes("top")?xt*-1:0,Wt=reactExports.useCallback(({clientX:Yt,clientY:Kt})=>{Vt.setPositionReference({getBoundingClientRect(){return{width:0,height:0,x:Yt,y:Kt,left:Yt+Gt,top:Kt+qt,right:Yt,bottom:Kt}}})},[Bt.reference]);return reactExports.useEffect(()=>{if(Vt.floating.current){const Yt=Mt.current;Yt.addEventListener("mousemove",Wt);const Kt=getOverflowAncestors(Vt.floating.current);return Kt.forEach(Xt=>{Xt.addEventListener("scroll",zt)}),()=>{Yt.removeEventListener("mousemove",Wt),Kt.forEach(Xt=>{Xt.removeEventListener("scroll",zt)})}}},[Bt.reference,Vt.floating.current,zt,Wt,Ct]),{handleMouseMove:Wt,x:Ft,y:jt,opened:Ct,setOpened:kt,boundaryRef:Mt,floating:Vt.setFloating}}var classes$h={tooltip:"m_1b3c8819",arrow:"m_f898399f"};const defaultProps$B={refProp:"ref",withinPortal:!0,offset:10,position:"right",zIndex:getDefaultZIndex("popover")},varsResolver$f=(xt,{radius:$t,color:Ct})=>({tooltip:{"--tooltip-radius":$t===void 0?void 0:getRadius($t),"--tooltip-bg":Ct?getThemeColor(Ct,xt):void 0,"--tooltip-color":Ct?"var(--mantine-color-white)":void 0}}),TooltipFloating=factory$2((xt,$t)=>{const Ct=useProps("TooltipFloating",defaultProps$B,xt),{children:kt,refProp:Mt,withinPortal:Ft,style:jt,className:Bt,classNames:Vt,styles:zt,unstyled:Ht,radius:Gt,color:qt,label:Wt,offset:Yt,position:Kt,multiline:Xt,zIndex:Qt,disabled:Jt,variant:Zt,vars:sn,portalProps:ln,...dn}=Ct,hn=useMantineTheme(),cn=useStyles({name:"TooltipFloating",props:Ct,classes:classes$h,className:Bt,style:jt,classNames:Vt,styles:zt,unstyled:Ht,rootSelector:"tooltip",vars:sn,varsResolver:varsResolver$f}),{handleMouseMove:pn,x:yn,y:gn,opened:En,boundaryRef:bn,floating:xn,setOpened:Cn}=useFloatingTooltip({offset:Yt,position:Kt});if(!isElement$1(kt))throw new Error("[@mantine/core] Tooltip.Floating component children should be an element or a component that accepts ref, fragments, strings, numbers and other primitive values are not supported");const $n=useMergedRef(bn,kt.ref,$t),wn=Dn=>{var An,Sn;(Sn=(An=kt.props).onMouseEnter)==null||Sn.call(An,Dn),pn(Dn),Cn(!0)},Rn=Dn=>{var An,Sn;(Sn=(An=kt.props).onMouseLeave)==null||Sn.call(An,Dn),Cn(!1)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(OptionalPortal,{...ln,withinPortal:Ft,children:jsxRuntimeExports.jsx(Box,{...dn,...cn("tooltip",{style:{...getStyleObject(jt,hn),zIndex:Qt,display:!Jt&&En?"block":"none",top:(gn&&Math.round(gn))??"",left:(yn&&Math.round(yn))??""}}),variant:Zt,ref:xn,mod:{multiline:Xt},children:Wt})}),reactExports.cloneElement(kt,{...kt.props,[Mt]:$n,onMouseEnter:wn,onMouseLeave:Rn})]})});TooltipFloating.classes=classes$h;TooltipFloating.displayName="@mantine/core/TooltipFloating";const TooltipGroupContext=reactExports.createContext(!1),TooltipGroupProvider=TooltipGroupContext.Provider,useTooltipGroupContext=()=>reactExports.useContext(TooltipGroupContext),defaultProps$A={openDelay:0,closeDelay:0};function TooltipGroup(xt){const{openDelay:$t,closeDelay:Ct,children:kt}=useProps("TooltipGroup",defaultProps$A,xt);return jsxRuntimeExports.jsx(TooltipGroupProvider,{value:!0,children:jsxRuntimeExports.jsx(FloatingDelayGroup,{delay:{open:$t,close:Ct},children:kt})})}TooltipGroup.displayName="@mantine/core/TooltipGroup";function useTooltip(xt){var dn,hn,cn;const[$t,Ct]=reactExports.useState(!1),Mt=typeof xt.opened=="boolean"?xt.opened:$t,Ft=useTooltipGroupContext(),jt=useId$1(),{delay:Bt,currentId:Vt,setCurrentId:zt}=useDelayGroupContext(),Ht=reactExports.useCallback(pn=>{Ct(pn),pn&&zt(jt)},[zt,jt]),{x:Gt,y:qt,context:Wt,refs:Yt,update:Kt,placement:Xt,middlewareData:{arrow:{x:Qt,y:Jt}={}}}=useFloating({strategy:xt.strategy,placement:xt.position,open:Mt,onOpenChange:Ht,middleware:[offset$4(xt.offset),shift({padding:8}),flip$1(),arrow({element:xt.arrowRef,padding:xt.arrowOffset}),...xt.inline?[inline()]:[]]}),{getReferenceProps:Zt,getFloatingProps:sn}=useInteractions([useHover(Wt,{enabled:(dn=xt.events)==null?void 0:dn.hover,delay:Ft?Bt:{open:xt.openDelay,close:xt.closeDelay},mouseOnly:!((hn=xt.events)!=null&&hn.touch)}),useFocus(Wt,{enabled:(cn=xt.events)==null?void 0:cn.focus,visibleOnly:!0}),useRole(Wt,{role:"tooltip"}),useDismiss(Wt,{enabled:typeof xt.opened>"u"}),useDelayGroup(Wt,{id:jt})]);useFloatingAutoUpdate({opened:Mt,position:xt.position,positionDependencies:xt.positionDependencies,floating:{refs:Yt,update:Kt}}),useDidUpdate(()=>{var pn;(pn=xt.onPositionChange)==null||pn.call(xt,Xt)},[Xt]);const ln=Mt&&Vt&&Vt!==jt;return{x:Gt,y:qt,arrowX:Qt,arrowY:Jt,reference:Yt.setReference,floating:Yt.setFloating,getFloatingProps:sn,getReferenceProps:Zt,isGroupPhase:ln,opened:Mt,placement:Xt}}const defaultProps$z={position:"top",refProp:"ref",withinPortal:!0,inline:!1,arrowSize:4,arrowOffset:5,arrowRadius:0,arrowPosition:"side",offset:5,transitionProps:{duration:100,transition:"fade"},events:{hover:!0,focus:!1,touch:!1},zIndex:getDefaultZIndex("popover"),positionDependencies:[]},varsResolver$e=(xt,{radius:$t,color:Ct})=>({tooltip:{"--tooltip-radius":$t===void 0?void 0:getRadius($t),"--tooltip-bg":Ct?getThemeColor(Ct,xt):void 0,"--tooltip-color":Ct?"var(--mantine-color-white)":void 0}}),Tooltip=factory$2((xt,$t)=>{const Ct=useProps("Tooltip",defaultProps$z,xt),{children:kt,position:Mt,refProp:Ft,label:jt,openDelay:Bt,closeDelay:Vt,onPositionChange:zt,opened:Ht,withinPortal:Gt,radius:qt,color:Wt,classNames:Yt,styles:Kt,unstyled:Xt,style:Qt,className:Jt,withArrow:Zt,arrowSize:sn,arrowOffset:ln,arrowRadius:dn,arrowPosition:hn,offset:cn,transitionProps:pn,multiline:yn,events:gn,zIndex:En,disabled:bn,positionDependencies:xn,onClick:Cn,onMouseEnter:$n,onMouseLeave:wn,inline:Rn,variant:Dn,keepMounted:An,vars:Sn,portalProps:vn,mod:_n,floatingStrategy:Tn,...Pn}=useProps("Tooltip",defaultProps$z,Ct),{dir:Ln}=useDirection(),Vn=reactExports.useRef(null),Un=useTooltip({position:getFloatingPosition(Ln,Mt),closeDelay:Vt,openDelay:Bt,onPositionChange:zt,opened:Ht,events:gn,arrowRef:Vn,arrowOffset:ln,offset:typeof cn=="number"?cn+(Zt?sn/2:0):cn,positionDependencies:[...xn,kt],inline:Rn,strategy:Tn}),Wn=useStyles({name:"Tooltip",props:Ct,classes:classes$h,className:Jt,style:Qt,classNames:Yt,styles:Kt,unstyled:Xt,rootSelector:"tooltip",vars:Sn,varsResolver:varsResolver$e});if(!isElement$1(kt))throw new Error("[@mantine/core] Tooltip component children should be an element or a component that accepts ref, fragments, strings, numbers and other primitive values are not supported");const rr=useMergedRef(Un.reference,kt.ref,$t),ar=getTransitionProps(pn,{duration:100,transition:"fade"});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(OptionalPortal,{...vn,withinPortal:Gt,children:jsxRuntimeExports.jsx(Transition$1,{...ar,keepMounted:An,mounted:!bn&&!!Un.opened,duration:Un.isGroupPhase?10:ar.duration,children:nr=>jsxRuntimeExports.jsxs(Box,{...Pn,variant:Dn,mod:[{multiline:yn},_n],...Un.getFloatingProps({ref:Un.floating,className:Wn("tooltip").className,style:{...Wn("tooltip").style,...nr,zIndex:En,top:Un.y??0,left:Un.x??0}}),children:[jt,jsxRuntimeExports.jsx(FloatingArrow,{ref:Vn,arrowX:Un.arrowX,arrowY:Un.arrowY,visible:Zt,position:Un.placement,arrowSize:sn,arrowOffset:ln,arrowRadius:dn,arrowPosition:hn,...Wn("arrow")})]})})}),reactExports.cloneElement(kt,Un.getReferenceProps({onClick:Cn,onMouseEnter:$n,onMouseLeave:wn,onMouseMove:Ct.onMouseMove,onPointerDown:Ct.onPointerDown,onPointerEnter:Ct.onPointerEnter,[Ft]:rr,className:clsx(Jt,kt.props.className),...kt.props}))]})});Tooltip.classes=classes$h;Tooltip.displayName="@mantine/core/Tooltip";Tooltip.Floating=TooltipFloating;Tooltip.Group=TooltipGroup;var classes$g={root:"m_cf365364",indicator:"m_9e182ccd",label:"m_1738fcb2",input:"m_1714d588",control:"m_69686b9b",innerLabel:"m_78882f40"};const defaultProps$y={withItemsBorders:!0},varsResolver$d=(xt,{radius:$t,color:Ct,transitionDuration:kt,size:Mt,transitionTimingFunction:Ft})=>({root:{"--sc-radius":$t===void 0?void 0:getRadius($t),"--sc-color":Ct?getThemeColor(Ct,xt):void 0,"--sc-shadow":Ct?void 0:"var(--mantine-shadow-xs)","--sc-transition-duration":kt===void 0?void 0:`${kt}ms`,"--sc-transition-timing-function":Ft,"--sc-padding":getSize(Mt,"sc-padding"),"--sc-font-size":getFontSize$1(Mt)}}),SegmentedControl=factory$2((xt,$t)=>{var Ln,Vn;const Ct=useProps("SegmentedControl",defaultProps$y,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,data:zt,value:Ht,defaultValue:Gt,onChange:qt,size:Wt,name:Yt,disabled:Kt,readOnly:Xt,fullWidth:Qt,orientation:Jt,radius:Zt,color:sn,transitionDuration:ln,transitionTimingFunction:dn,variant:hn,autoContrast:cn,withItemsBorders:pn,mod:yn,...gn}=Ct,En=useStyles({name:"SegmentedControl",props:Ct,classes:classes$g,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$d}),bn=useMantineTheme(),xn=zt.map(Un=>typeof Un=="string"?{label:Un,value:Un}:Un),Cn=useMounted(),[$n,wn]=reactExports.useState(null),[Rn,Dn]=reactExports.useState({}),An=(Un,Wn)=>{Rn[Wn]=Un,Dn(Rn)},[Sn,vn]=useUncontrolled({value:Ht,defaultValue:Gt,finalValue:Array.isArray(zt)?((Ln=xn.find(Un=>!Un.disabled))==null?void 0:Ln.value)??((Vn=zt[0])==null?void 0:Vn.value)??null:null,onChange:qt}),_n=useId$1(Yt),Tn=xn.map(Un=>reactExports.createElement(Box,{...En("control"),mod:{active:Sn===Un.value,orientation:Jt},key:Un.value},reactExports.createElement("input",{...En("input"),disabled:Kt||Un.disabled,type:"radio",name:_n,value:Un.value,id:`${_n}-${Un.value}`,checked:Sn===Un.value,onChange:()=>!Xt&&vn(Un.value),"data-focus-ring":bn.focusRing,key:`${Un.value}-input`}),reactExports.createElement(Box,{component:"label",...En("label"),mod:{active:Sn===Un.value&&!(Kt||Un.disabled),disabled:Kt||Un.disabled,"read-only":Xt},htmlFor:`${_n}-${Un.value}`,ref:Wn=>An(Wn,Un.value),__vars:{"--sc-label-color":sn!==void 0?getContrastColor({color:sn,theme:bn,autoContrast:cn}):void 0},key:`${Un.value}-label`},jsxRuntimeExports.jsx("span",{...En("innerLabel"),children:Un.label})))),Pn=useMergedRef($t,Un=>wn(Un));return zt.length===0?null:jsxRuntimeExports.jsxs(Box,{...En("root"),variant:hn,size:Wt,ref:Pn,mod:[{"full-width":Qt,orientation:Jt,initialized:Cn,"with-items-borders":pn},yn],...gn,role:"radiogroup",children:[typeof Sn=="string"&&jsxRuntimeExports.jsx(FloatingIndicator,{target:Rn[Sn],parent:$n,component:"span",transitionDuration:"var(--sc-transition-duration)",...En("indicator")}),Tn]})});SegmentedControl.classes=classes$g;SegmentedControl.displayName="@mantine/core/SegmentedControl";const defaultProps$x={searchable:!1,withCheckIcon:!0,allowDeselect:!0,checkIconPosition:"left"},Select=factory$2((xt,$t)=>{const Ct=useProps("Select",defaultProps$x,xt),{classNames:kt,styles:Mt,unstyled:Ft,vars:jt,dropdownOpened:Bt,defaultDropdownOpened:Vt,onDropdownClose:zt,onDropdownOpen:Ht,onFocus:Gt,onBlur:qt,onClick:Wt,onChange:Yt,data:Kt,value:Xt,defaultValue:Qt,selectFirstOptionOnChange:Jt,onOptionSubmit:Zt,comboboxProps:sn,readOnly:ln,disabled:dn,filter:hn,limit:cn,withScrollArea:pn,maxDropdownHeight:yn,size:gn,searchable:En,rightSection:bn,checkIconPosition:xn,withCheckIcon:Cn,nothingFoundMessage:$n,name:wn,form:Rn,searchValue:Dn,defaultSearchValue:An,onSearchChange:Sn,allowDeselect:vn,error:_n,rightSectionPointerEvents:Tn,id:Pn,clearable:Ln,clearButtonProps:Vn,hiddenInputProps:Un,renderOption:Wn,onClear:rr,autoComplete:ar,scrollAreaProps:nr,...mr}=Ct,kn=reactExports.useMemo(()=>getParsedComboboxData(Kt),[Kt]),Fn=reactExports.useMemo(()=>getOptionsLockup(kn),[kn]),Hn=useId$1(Pn),[Bn,jn,sr]=useUncontrolled({value:Xt,defaultValue:Qt,finalValue:null,onChange:Yt}),Ar=typeof Bn=="string"?Fn[Bn]:void 0,[Fr,Rr]=useUncontrolled({value:Dn,defaultValue:An,finalValue:Ar?Ar.label:"",onChange:Sn}),Qn=useCombobox({opened:Bt,defaultOpened:Vt,onDropdownOpen:()=>{Ht==null||Ht(),Qn.updateSelectedOptionIndex("active",{scrollIntoView:!0})},onDropdownClose:()=>{zt==null||zt(),Qn.resetSelectedOption()}}),{resolvedClassNames:jr,resolvedStyles:Mr}=useResolvedStylesApi({props:Ct,styles:Mt,classNames:kt});reactExports.useEffect(()=>{Jt&&Qn.selectFirstOption()},[Jt,Bn]),reactExports.useEffect(()=>{Xt===null&&Rr(""),typeof Xt=="string"&&Ar&&Rr(Ar.label)},[Xt,Ar]);const pr=Ln&&!!Bn&&!dn&&!ln&&jsxRuntimeExports.jsx(Combobox.ClearButton,{size:gn,...Vn,onClear:()=>{jn(null,null),Rr(""),rr==null||rr()}});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Combobox,{store:Qn,__staticSelector:"Select",classNames:jr,styles:Mr,unstyled:Ft,readOnly:ln,onOptionSubmit:Tr=>{Zt==null||Zt(Tr);const Hr=vn&&Fn[Tr].value===Bn?null:Fn[Tr],Xr=Hr?Hr.value:null;jn(Xr,Hr),!sr&&Rr(typeof Xr=="string"&&(Hr==null?void 0:Hr.label)||""),Qn.closeDropdown()},size:gn,...sn,children:[jsxRuntimeExports.jsx(Combobox.Target,{targetType:En?"input":"button",autoComplete:ar,children:jsxRuntimeExports.jsx(InputBase,{id:Hn,ref:$t,rightSection:bn||pr||jsxRuntimeExports.jsx(Combobox.Chevron,{size:gn,error:_n,unstyled:Ft}),rightSectionPointerEvents:Tn||(pr?"all":"none"),...mr,size:gn,__staticSelector:"Select",disabled:dn,readOnly:ln||!En,value:Fr,onChange:Tr=>{Rr(Tr.currentTarget.value),Qn.openDropdown(),Jt&&Qn.selectFirstOption()},onFocus:Tr=>{En&&Qn.openDropdown(),Gt==null||Gt(Tr)},onBlur:Tr=>{var Hr;En&&Qn.closeDropdown(),Rr(Bn!=null&&((Hr=Fn[Bn])==null?void 0:Hr.label)||""),qt==null||qt(Tr)},onClick:Tr=>{En?Qn.openDropdown():Qn.toggleDropdown(),Wt==null||Wt(Tr)},classNames:jr,styles:Mr,unstyled:Ft,pointer:!En,error:_n})}),jsxRuntimeExports.jsx(OptionsDropdown,{data:kn,hidden:ln||dn,filter:hn,search:Fr,limit:cn,hiddenWhenEmpty:!En||!$n,withScrollArea:pn,maxDropdownHeight:yn,filterOptions:En&&(Ar==null?void 0:Ar.label)!==Fr,value:Bn,checkIconPosition:xn,withCheckIcon:Cn,nothingFoundMessage:$n,unstyled:Ft,labelId:mr.label?`${Hn}-label`:void 0,"aria-label":mr.label?void 0:mr["aria-label"],renderOption:Wn,scrollAreaProps:nr})]}),jsxRuntimeExports.jsx(Combobox.HiddenInput,{value:Bn,name:wn,form:Rn,disabled:dn,...Un})]})});Select.classes={...InputBase.classes,...Combobox.classes};Select.displayName="@mantine/core/Select";const[SliderProvider,useSliderContext]=createSafeContext("SliderProvider was not found in tree"),SliderRoot=reactExports.forwardRef(({size:xt,disabled:$t,variant:Ct,color:kt,thumbSize:Mt,radius:Ft,...jt},Bt)=>{const{getStyles:Vt}=useSliderContext();return jsxRuntimeExports.jsx(Box,{tabIndex:-1,variant:Ct,size:xt,ref:Bt,...Vt("root"),...jt})});SliderRoot.displayName="@mantine/core/SliderRoot";const Thumb=reactExports.forwardRef(({max:xt,min:$t,value:Ct,position:kt,label:Mt,dragging:Ft,onMouseDown:jt,onKeyDownCapture:Bt,labelTransitionProps:Vt,labelAlwaysOn:zt,thumbLabel:Ht,onFocus:Gt,onBlur:qt,showLabelOnHover:Wt,isHovered:Yt,children:Kt=null,disabled:Xt},Qt)=>{const{getStyles:Jt}=useSliderContext(),[Zt,sn]=reactExports.useState(!1),ln=zt||Ft||Zt||Wt&&Yt;return jsxRuntimeExports.jsxs(Box,{tabIndex:0,role:"slider","aria-label":Ht,"aria-valuemax":xt,"aria-valuemin":$t,"aria-valuenow":Ct,ref:Qt,__vars:{"--slider-thumb-offset":`${kt}%`},...Jt("thumb",{focusable:!0}),mod:{dragging:Ft,disabled:Xt},onFocus:()=>{sn(!0),typeof Gt=="function"&&Gt()},onBlur:()=>{sn(!1),typeof qt=="function"&&qt()},onTouchStart:jt,onMouseDown:jt,onKeyDownCapture:Bt,onClick:dn=>dn.stopPropagation(),children:[Kt,jsxRuntimeExports.jsx(Transition$1,{mounted:Mt!=null&&!!ln,transition:"fade",duration:0,...Vt,children:dn=>jsxRuntimeExports.jsx("div",{...Jt("label",{style:dn}),children:Mt})})]})});Thumb.displayName="@mantine/core/SliderThumb";function getPosition({value:xt,min:$t,max:Ct}){const kt=(xt-$t)/(Ct-$t)*100;return Math.min(Math.max(kt,0),100)}function isMarkFilled({mark:xt,offset:$t,value:Ct,inverted:kt=!1}){return kt?typeof $t=="number"&&xt.value<=$t||xt.value>=Ct:typeof $t=="number"?xt.value>=$t&&xt.value<=Ct:xt.value<=Ct}function Marks$1({marks:xt,min:$t,max:Ct,disabled:kt,value:Mt,offset:Ft,inverted:jt}){const{getStyles:Bt}=useSliderContext();if(!xt)return null;const Vt=xt.map((zt,Ht)=>reactExports.createElement(Box,{...Bt("markWrapper"),__vars:{"--mark-offset":`${getPosition({value:zt.value,min:$t,max:Ct})}%`},key:Ht},jsxRuntimeExports.jsx(Box,{...Bt("mark"),mod:{filled:isMarkFilled({mark:zt,value:Mt,offset:Ft,inverted:jt}),disabled:kt}}),zt.label&&jsxRuntimeExports.jsx("div",{...Bt("markLabel"),children:zt.label})));return jsxRuntimeExports.jsx("div",{children:Vt})}Marks$1.displayName="@mantine/core/SliderMarks";function Track({filled:xt,children:$t,offset:Ct,disabled:kt,marksOffset:Mt,inverted:Ft,containerProps:jt,...Bt}){const{getStyles:Vt}=useSliderContext();return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Box,{...Vt("trackContainer"),mod:{disabled:kt},...jt,children:jsxRuntimeExports.jsxs(Box,{...Vt("track"),mod:{inverted:Ft,disabled:kt},children:[jsxRuntimeExports.jsx(Box,{mod:{inverted:Ft,disabled:kt},__vars:{"--slider-bar-width":`calc(${xt}% + var(--slider-size))`,"--slider-bar-offset":`calc(${Ct}% - var(--slider-size))`},...Vt("bar")}),$t,jsxRuntimeExports.jsx(Marks$1,{...Bt,offset:Mt,disabled:kt,inverted:Ft})]})})})}Track.displayName="@mantine/core/SliderTrack";function getChangeValue({value:xt,containerWidth:$t,min:Ct,max:kt,step:Mt,precision:Ft}){const Bt=($t?Math.min(Math.max(xt,0),$t)/$t:xt)*(kt-Ct),Vt=(Bt!==0?Math.round(Bt/Mt)*Mt:0)+Ct,zt=Math.max(Vt,Ct);return Ft!==void 0?Number(zt.toFixed(Ft)):zt}function getFloatingValue(xt,$t){return parseFloat(xt.toFixed($t))}function getPrecision(xt){if(!xt)return 0;const $t=xt.toString().split(".");return $t.length>1?$t[1].length:0}var classes$f={root:"m_dd36362e",label:"m_c9357328",thumb:"m_c9a9a60a",trackContainer:"m_a8645c2",track:"m_c9ade57f",bar:"m_38aeed47",markWrapper:"m_b7b0423a",mark:"m_dd33bc19",markLabel:"m_68c77a5b"};const defaultProps$w={radius:"xl",min:0,max:100,step:1,marks:[],label:xt=>xt,labelTransitionProps:{transition:"fade",duration:0},labelAlwaysOn:!1,thumbLabel:"",showLabelOnHover:!0,disabled:!1,scale:xt=>xt},varsResolver$c=(xt,{size:$t,color:Ct,thumbSize:kt,radius:Mt})=>({root:{"--slider-size":getSize($t,"slider-size"),"--slider-color":Ct?getThemeColor(Ct,xt):void 0,"--slider-radius":Mt===void 0?void 0:getRadius(Mt),"--slider-thumb-size":kt!==void 0?rem$1(kt):"calc(var(--slider-size) * 2)"}}),Slider=factory$2((xt,$t)=>{const Ct=useProps("Slider",defaultProps$w,xt),{classNames:kt,styles:Mt,value:Ft,onChange:jt,onChangeEnd:Bt,size:Vt,min:zt,max:Ht,step:Gt,precision:qt,defaultValue:Wt,name:Yt,marks:Kt,label:Xt,labelTransitionProps:Qt,labelAlwaysOn:Jt,thumbLabel:Zt,showLabelOnHover:sn,thumbChildren:ln,disabled:dn,unstyled:hn,scale:cn,inverted:pn,className:yn,style:gn,vars:En,hiddenInputProps:bn,...xn}=Ct,Cn=useStyles({name:"Slider",props:Ct,classes:classes$f,classNames:kt,className:yn,styles:Mt,style:gn,vars:En,varsResolver:varsResolver$c,unstyled:hn}),{dir:$n}=useDirection(),[wn,Rn]=reactExports.useState(!1),[Dn,An]=useUncontrolled({value:typeof Ft=="number"?clamp$4(Ft,zt,Ht):Ft,defaultValue:typeof Wt=="number"?clamp$4(Wt,zt,Ht):Wt,finalValue:clamp$4(0,zt,Ht),onChange:jt}),Sn=reactExports.useRef(Dn),vn=reactExports.useRef(),_n=reactExports.useRef(),Tn=getPosition({value:Dn,min:zt,max:Ht}),Pn=cn(Dn),Ln=typeof Xt=="function"?Xt(Pn):Xt,Vn=qt??getPrecision(Gt),Un=reactExports.useCallback(({x:nr})=>{if(!dn){const mr=getChangeValue({value:nr,min:zt,max:Ht,step:Gt,precision:Vn});An(mr),Sn.current=mr}},[dn,zt,Ht,Gt,Vn,An]),{ref:Wn,active:rr}=useMove(Un,{onScrubEnd:()=>Bt==null?void 0:Bt(Sn.current)},$n),ar=nr=>{var mr,kn,Fn,Hn,Bn,jn;if(!dn)switch(nr.key){case"ArrowUp":{nr.preventDefault(),(mr=_n.current)==null||mr.focus();const sr=getFloatingValue(Math.min(Math.max(Dn+Gt,zt),Ht),Vn);An(sr),Bt==null||Bt(sr);break}case"ArrowRight":{nr.preventDefault(),(kn=_n.current)==null||kn.focus();const sr=getFloatingValue(Math.min(Math.max($n==="rtl"?Dn-Gt:Dn+Gt,zt),Ht),Vn);An(sr),Bt==null||Bt(sr);break}case"ArrowDown":{nr.preventDefault(),(Fn=_n.current)==null||Fn.focus();const sr=getFloatingValue(Math.min(Math.max(Dn-Gt,zt),Ht),Vn);An(sr),Bt==null||Bt(sr);break}case"ArrowLeft":{nr.preventDefault(),(Hn=_n.current)==null||Hn.focus();const sr=getFloatingValue(Math.min(Math.max($n==="rtl"?Dn+Gt:Dn-Gt,zt),Ht),Vn);An(sr),Bt==null||Bt(sr);break}case"Home":{nr.preventDefault(),(Bn=_n.current)==null||Bn.focus(),An(zt),Bt==null||Bt(zt);break}case"End":{nr.preventDefault(),(jn=_n.current)==null||jn.focus(),An(Ht),Bt==null||Bt(Ht);break}}};return jsxRuntimeExports.jsx(SliderProvider,{value:{getStyles:Cn},children:jsxRuntimeExports.jsxs(SliderRoot,{...xn,ref:useMergedRef($t,vn),onKeyDownCapture:ar,onMouseDownCapture:()=>{var nr;return(nr=vn.current)==null?void 0:nr.focus()},size:Vt,disabled:dn,children:[jsxRuntimeExports.jsx(Track,{inverted:pn,offset:0,filled:Tn,marks:Kt,min:zt,max:Ht,value:Pn,disabled:dn,containerProps:{ref:Wn,onMouseEnter:sn?()=>Rn(!0):void 0,onMouseLeave:sn?()=>Rn(!1):void 0},children:jsxRuntimeExports.jsx(Thumb,{max:Ht,min:zt,value:Pn,position:Tn,dragging:rr,label:Ln,ref:_n,labelTransitionProps:Qt,labelAlwaysOn:Jt,thumbLabel:Zt,showLabelOnHover:sn,isHovered:wn,disabled:dn,children:ln})}),jsxRuntimeExports.jsx("input",{type:"hidden",name:Yt,value:Pn,...bn})]})})});Slider.classes=classes$f;Slider.displayName="@mantine/core/Slider";function getClientPosition(xt){return"TouchEvent"in window&&xt instanceof window.TouchEvent?xt.touches[0].clientX:xt.clientX}const varsResolver$b=(xt,{size:$t,color:Ct,thumbSize:kt,radius:Mt})=>({root:{"--slider-size":getSize($t,"slider-size"),"--slider-color":Ct?getThemeColor(Ct,xt):void 0,"--slider-radius":Mt===void 0?void 0:getRadius(Mt),"--slider-thumb-size":kt!==void 0?rem$1(kt):"calc(var(--slider-size) * 2)"}}),defaultProps$v={min:0,max:100,minRange:10,step:1,marks:[],label:xt=>xt,labelTransitionProps:{transition:"fade",duration:0},labelAlwaysOn:!1,showLabelOnHover:!0,disabled:!1,scale:xt=>xt},RangeSlider=factory$2((xt,$t)=>{const Ct=useProps("RangeSlider",defaultProps$v,xt),{classNames:kt,styles:Mt,value:Ft,onChange:jt,onChangeEnd:Bt,size:Vt,min:zt,max:Ht,minRange:Gt,maxRange:qt,step:Wt,precision:Yt,defaultValue:Kt,name:Xt,marks:Qt,label:Jt,labelTransitionProps:Zt,labelAlwaysOn:sn,thumbFromLabel:ln,thumbToLabel:dn,showLabelOnHover:hn,thumbChildren:cn,disabled:pn,unstyled:yn,scale:gn,inverted:En,className:bn,style:xn,vars:Cn,hiddenInputProps:$n,...wn}=Ct,Rn=useStyles({name:"Slider",props:Ct,classes:classes$f,classNames:kt,className:bn,styles:Mt,style:xn,vars:Cn,varsResolver:varsResolver$b,unstyled:yn}),{dir:Dn}=useDirection(),[An,Sn]=reactExports.useState(-1),[vn,_n]=reactExports.useState(!1),[Tn,Pn]=useUncontrolled({value:Ft,defaultValue:Kt,finalValue:[zt,Ht],onChange:jt}),Ln=reactExports.useRef(Tn),Vn=reactExports.useRef([]),Un=reactExports.useRef(void 0),Wn=[getPosition({value:Tn[0],min:zt,max:Ht}),getPosition({value:Tn[1],min:zt,max:Ht})],rr=Yt??getPrecision(Wt),ar=Rr=>{Pn(Rr),Ln.current=Rr};reactExports.useEffect(()=>{Array.isArray(Ft)&&(Ln.current=Ft)},Array.isArray(Ft)?[Ft[0],Ft[1]]:[null,null]);const nr=(Rr,Qn,jr)=>{const Mr=[...Ln.current];Mr[Qn]=Rr,Qn===0&&(Rr>Mr[1]-(Gt-1e-9)&&(Mr[1]=Math.min(Rr+Gt,Ht)),Rr>(Ht-(Gt-1e-9)||zt)&&(Mr[Qn]=Ln.current[Qn]),Mr[1]-Rr>qt&&(Mr[1]=Rr+qt)),Qn===1&&(Rr<Mr[0]+Gt&&(Mr[0]=Math.max(Rr-Gt,zt)),Rr<Mr[0]+Gt&&(Mr[Qn]=Ln.current[Qn]),Rr-Mr[0]>qt&&(Mr[0]=Rr-qt)),Mr[0]=getFloatingValue(Mr[0],rr),Mr[1]=getFloatingValue(Mr[1],rr),ar(Mr),jr&&(Bt==null||Bt(Ln.current))},mr=Rr=>{if(!pn){const Qn=getChangeValue({value:Rr,min:zt,max:Ht,step:Wt,precision:rr});nr(Qn,Un.current,!1)}},{ref:kn,active:Fn}=useMove(({x:Rr})=>mr(Rr),{onScrubEnd:()=>Bt==null?void 0:Bt(Ln.current)},Dn);function Hn(Rr){Un.current=Rr}const Bn=Rr=>{kn.current.focus();const Qn=kn.current.getBoundingClientRect(),jr=getClientPosition(Rr.nativeEvent),Mr=getChangeValue({value:jr-Qn.left,max:Ht,min:zt,step:Wt,containerWidth:Qn.width}),pr=Math.abs(Tn[0]-Mr)>Math.abs(Tn[1]-Mr)?1:0,Tr=Dn==="ltr"?pr:pr===1?0:1;Un.current=Tr},jn=()=>An!==1&&An!==0?(Sn(0),0):An,sr=Rr=>{if(!pn)switch(Rr.key){case"ArrowUp":{Rr.preventDefault();const Qn=jn();Vn.current[Qn].focus(),nr(getFloatingValue(Math.min(Math.max(Ln.current[Qn]+Wt,zt),Ht),rr),Qn,!0);break}case"ArrowRight":{Rr.preventDefault();const Qn=jn();Vn.current[Qn].focus(),nr(getFloatingValue(Math.min(Math.max(Dn==="rtl"?Ln.current[Qn]-Wt:Ln.current[Qn]+Wt,zt),Ht),rr),Qn,!0);break}case"ArrowDown":{Rr.preventDefault();const Qn=jn();Vn.current[Qn].focus(),nr(getFloatingValue(Math.min(Math.max(Ln.current[Qn]-Wt,zt),Ht),rr),Qn,!0);break}case"ArrowLeft":{Rr.preventDefault();const Qn=jn();Vn.current[Qn].focus(),nr(getFloatingValue(Math.min(Math.max(Dn==="rtl"?Ln.current[Qn]+Wt:Ln.current[Qn]-Wt,zt),Ht),rr),Qn,!0);break}}},Ar={max:Ht,min:zt,size:Vt,labelTransitionProps:Zt,labelAlwaysOn:sn,onBlur:()=>Sn(-1)},Fr=Array.isArray(cn);return jsxRuntimeExports.jsx(SliderProvider,{value:{getStyles:Rn},children:jsxRuntimeExports.jsxs(SliderRoot,{...wn,size:Vt,ref:$t,disabled:pn,children:[jsxRuntimeExports.jsxs(Track,{offset:Wn[0],marksOffset:Tn[0],filled:Wn[1]-Wn[0],marks:Qt,inverted:En,min:zt,max:Ht,value:Tn[1],disabled:pn,containerProps:{ref:kn,onMouseEnter:hn?()=>_n(!0):void 0,onMouseLeave:hn?()=>_n(!1):void 0,onTouchStartCapture:Bn,onTouchEndCapture:()=>{Un.current=-1},onMouseDownCapture:Bn,onMouseUpCapture:()=>{Un.current=-1},onKeyDownCapture:sr},children:[jsxRuntimeExports.jsx(Thumb,{...Ar,value:gn(Tn[0]),position:Wn[0],dragging:Fn,label:typeof Jt=="function"?Jt(getFloatingValue(gn(Tn[0]),rr)):Jt,ref:Rr=>{Vn.current[0]=Rr},thumbLabel:ln,onMouseDown:()=>Hn(0),onFocus:()=>Sn(0),showLabelOnHover:hn,isHovered:vn,disabled:pn,children:Fr?cn[0]:cn}),jsxRuntimeExports.jsx(Thumb,{...Ar,thumbLabel:dn,value:gn(Tn[1]),position:Wn[1],dragging:Fn,label:typeof Jt=="function"?Jt(getFloatingValue(gn(Tn[1]),rr)):Jt,ref:Rr=>{Vn.current[1]=Rr},onMouseDown:()=>Hn(1),onFocus:()=>Sn(1),showLabelOnHover:hn,isHovered:vn,disabled:pn,children:Fr?cn[1]:cn})]}),jsxRuntimeExports.jsx("input",{type:"hidden",name:`${Xt}_from`,value:Tn[0],...$n}),jsxRuntimeExports.jsx("input",{type:"hidden",name:`${Xt}_to`,value:Tn[1],...$n})]})})});RangeSlider.classes=classes$f;RangeSlider.displayName="@mantine/core/RangeSlider";const defaultProps$u={},Space=factory$2((xt,$t)=>{const{w:Ct,h:kt,miw:Mt,mih:Ft,...jt}=useProps("Space",defaultProps$u,xt);return jsxRuntimeExports.jsx(Box,{ref:$t,...jt,w:Ct,miw:Mt??Ct,h:kt,mih:Ft??kt})});Space.displayName="@mantine/core/Space";var classes$e={root:"m_559cce2d",content:"m_b912df4e",control:"m_b9131032"};const defaultProps$t={maxHeight:100,initialState:!1},varsResolver$a=(xt,{transitionDuration:$t})=>({root:{"--spoiler-transition-duration":$t!==void 0?`${$t}ms`:void 0}}),Spoiler=factory$2((xt,$t)=>{const Ct=useProps("Spoiler",defaultProps$t,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,initialState:zt,maxHeight:Ht,hideLabel:Gt,showLabel:qt,children:Wt,controlRef:Yt,transitionDuration:Kt,id:Xt,...Qt}=Ct,Jt=useStyles({name:"Spoiler",classes:classes$e,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$a}),Zt=useId$1(Xt),sn=`${Zt}-region`,[ln,dn]=reactExports.useState(zt),{ref:hn,height:cn}=useElementSize(),pn=ln?Gt:qt,yn=pn!==null&&Ht<cn;return jsxRuntimeExports.jsxs(Box,{...Jt("root"),id:Zt,ref:$t,"data-has-spoiler":yn||void 0,...Qt,children:[yn&&jsxRuntimeExports.jsx(Anchor,{component:"button",type:"button",ref:Yt,onClick:()=>dn(gn=>!gn),"aria-expanded":ln,"aria-controls":sn,...Jt("control"),children:pn}),jsxRuntimeExports.jsx("div",{...Jt("content",{style:{maxHeight:ln?cn?rem$1(cn):void 0:rem$1(Ht)}}),"data-reduce-motion":!0,role:"region",id:sn,children:jsxRuntimeExports.jsx("div",{ref:hn,children:Wt})})]})});Spoiler.classes=classes$e;Spoiler.displayName="@mantine/core/Spoiler";var classes$d={root:"m_6d731127"};const defaultProps$s={gap:"md",align:"stretch",justify:"flex-start"},varsResolver$9=(xt,{gap:$t,align:Ct,justify:kt})=>({root:{"--stack-gap":getSpacing($t),"--stack-align":Ct,"--stack-justify":kt}}),Stack$1=factory$2((xt,$t)=>{const Ct=useProps("Stack",defaultProps$s,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,align:zt,justify:Ht,gap:Gt,variant:qt,...Wt}=Ct,Yt=useStyles({name:"Stack",props:Ct,classes:classes$d,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$9});return jsxRuntimeExports.jsx(Box,{ref:$t,...Yt("root"),variant:qt,...Wt})});Stack$1.classes=classes$d;Stack$1.displayName="@mantine/core/Stack";const SwitchGroupContext=reactExports.createContext(null),SwitchGroupProvider=SwitchGroupContext.Provider,useSwitchGroupContext=()=>reactExports.useContext(SwitchGroupContext),defaultProps$r={},SwitchGroup=factory$2((xt,$t)=>{const{value:Ct,defaultValue:kt,onChange:Mt,size:Ft,wrapperProps:jt,children:Bt,readOnly:Vt,...zt}=useProps("SwitchGroup",defaultProps$r,xt),[Ht,Gt]=useUncontrolled({value:Ct,defaultValue:kt,finalValue:[],onChange:Mt}),qt=Wt=>{const Yt=Wt.currentTarget.value;!Vt&&Gt(Ht.includes(Yt)?Ht.filter(Kt=>Kt!==Yt):[...Ht,Yt])};return jsxRuntimeExports.jsx(SwitchGroupProvider,{value:{value:Ht,onChange:qt,size:Ft},children:jsxRuntimeExports.jsx(Input.Wrapper,{size:Ft,ref:$t,...jt,...zt,labelElement:"div",__staticSelector:"SwitchGroup",children:jsxRuntimeExports.jsx(InputsGroupFieldset,{role:"group",children:Bt})})})});SwitchGroup.classes=Input.Wrapper.classes;SwitchGroup.displayName="@mantine/core/SwitchGroup";var classes$c={root:"m_5f93f3bb",input:"m_926b4011",track:"m_9307d992",thumb:"m_93039a1d",trackLabel:"m_8277e082"};const defaultProps$q={labelPosition:"right"},varsResolver$8=(xt,{radius:$t,color:Ct,size:kt})=>({root:{"--switch-radius":$t===void 0?void 0:getRadius($t),"--switch-height":getSize(kt,"switch-height"),"--switch-width":getSize(kt,"switch-width"),"--switch-thumb-size":getSize(kt,"switch-thumb-size"),"--switch-label-font-size":getSize(kt,"switch-label-font-size"),"--switch-track-label-padding":getSize(kt,"switch-track-label-padding"),"--switch-color":Ct?getThemeColor(Ct,xt):void 0}}),Switch=factory$2((xt,$t)=>{const Ct=useProps("Switch",defaultProps$q,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,color:zt,label:Ht,offLabel:Gt,onLabel:qt,id:Wt,size:Yt,radius:Kt,wrapperProps:Xt,children:Qt,thumbIcon:Jt,checked:Zt,defaultChecked:sn,onChange:ln,labelPosition:dn,description:hn,error:cn,disabled:pn,variant:yn,rootRef:gn,mod:En,...bn}=Ct,xn=useSwitchGroupContext(),Cn=Yt||(xn==null?void 0:xn.size),$n=useStyles({name:"Switch",props:Ct,classes:classes$c,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$8}),{styleProps:wn,rest:Rn}=extractStyleProps(bn),Dn=useId$1(Wt),An=xn?{checked:xn.value.includes(Rn.value),onChange:xn.onChange}:{},[Sn,vn]=useUncontrolled({value:An.checked??Zt,defaultValue:sn,finalValue:!1});return jsxRuntimeExports.jsxs(InlineInput,{...$n("root"),__staticSelector:"Switch",__stylesApiProps:Ct,id:Dn,size:Cn,labelPosition:dn,label:Ht,description:hn,error:cn,disabled:pn,bodyElement:"label",labelElement:"span",classNames:kt,styles:jt,unstyled:Bt,"data-checked":An.checked||void 0,variant:yn,ref:gn,mod:En,...wn,...Xt,children:[jsxRuntimeExports.jsx("input",{...Rn,disabled:pn,checked:Sn,onChange:_n=>{var Tn;xn?(Tn=An.onChange)==null||Tn.call(An,_n):ln==null||ln(_n),vn(_n.currentTarget.checked)},id:Dn,ref:$t,type:"checkbox",role:"switch",...$n("input")}),jsxRuntimeExports.jsxs(Box,{"aria-hidden":"true",mod:{error:cn,"label-position":dn},...$n("track"),children:[jsxRuntimeExports.jsx(Box,{component:"span",mod:"reduce-motion",...$n("thumb"),children:Jt}),jsxRuntimeExports.jsx("span",{...$n("trackLabel"),children:Sn?qt:Gt})]})]})});Switch.classes={...classes$c,...InlineInputClasses};Switch.displayName="@mantine/core/Switch";Switch.Group=SwitchGroup;const[TableProvider,useTableContext]=createSafeContext("Table component was not found in the tree");var classes$b={table:"m_b23fa0ef",th:"m_4e7aa4f3",tr:"m_4e7aa4fd",td:"m_4e7aa4ef",tbody:"m_b2404537",thead:"m_b242d975",caption:"m_9e5a3ac7",scrollContainer:"m_a100c15",scrollContainerInner:"m_62259741"};function getDataAttributes(xt,$t){if(!$t)return;const Ct={};return $t.columnBorder&&xt.withColumnBorders&&(Ct["data-with-column-border"]=!0),$t.rowBorder&&xt.withRowBorders&&(Ct["data-with-row-border"]=!0),$t.striped&&xt.striped&&(Ct["data-striped"]=xt.striped),$t.highlightOnHover&&xt.highlightOnHover&&(Ct["data-hover"]=!0),$t.captionSide&&xt.captionSide&&(Ct["data-side"]=xt.captionSide),$t.stickyHeader&&xt.stickyHeader&&(Ct["data-sticky"]=!0),Ct}function tableElement(xt,$t){const Ct=`Table${xt.charAt(0).toUpperCase()}${xt.slice(1)}`,kt=factory$2((Mt,Ft)=>{const jt=useProps(Ct,{},Mt),{classNames:Bt,className:Vt,style:zt,styles:Ht,...Gt}=jt,qt=useTableContext();return jsxRuntimeExports.jsx(Box,{component:xt,ref:Ft,...getDataAttributes(qt,$t),...qt.getStyles(xt,{className:Vt,classNames:Bt,style:zt,styles:Ht,props:jt}),...Gt})});return kt.displayName=`@mantine/core/${Ct}`,kt.classes=classes$b,kt}const TableTh=tableElement("th",{columnBorder:!0}),TableTd=tableElement("td",{columnBorder:!0}),TableTr=tableElement("tr",{rowBorder:!0,striped:!0,highlightOnHover:!0}),TableThead=tableElement("thead",{stickyHeader:!0}),TableTbody=tableElement("tbody"),TableTfoot=tableElement("tfoot"),TableCaption=tableElement("caption",{captionSide:!0});function TableDataRenderer({data:xt}){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[xt.caption&&jsxRuntimeExports.jsx(TableCaption,{children:xt.caption}),xt.head&&jsxRuntimeExports.jsx(TableThead,{children:jsxRuntimeExports.jsx(TableTr,{children:xt.head.map(($t,Ct)=>jsxRuntimeExports.jsx(TableTh,{children:$t},Ct))})}),xt.body&&jsxRuntimeExports.jsx(TableTbody,{children:xt.body.map(($t,Ct)=>jsxRuntimeExports.jsx(TableTr,{children:$t.map((kt,Mt)=>jsxRuntimeExports.jsx(TableTd,{children:kt},Mt))},Ct))}),xt.foot&&jsxRuntimeExports.jsx(TableTfoot,{children:jsxRuntimeExports.jsx(TableTr,{children:xt.foot.map(($t,Ct)=>jsxRuntimeExports.jsx(TableTh,{children:$t},Ct))})})]})}TableDataRenderer.displayName="@mantine/core/TableDataRenderer";const defaultProps$p={type:"scrollarea"},varsResolver$7=(xt,{minWidth:$t,type:Ct})=>({scrollContainer:{"--table-min-width":rem$1($t),"--table-overflow":Ct==="native"?"auto":void 0}}),TableScrollContainer=factory$2((xt,$t)=>{const Ct=useProps("TableScrollContainer",defaultProps$p,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,children:zt,minWidth:Ht,type:Gt,...qt}=Ct,Wt=useStyles({name:"TableScrollContainer",classes:classes$b,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$7,rootSelector:"scrollContainer"});return jsxRuntimeExports.jsx(Box,{component:Gt==="scrollarea"?ScrollArea:"div",...Gt==="scrollarea"?{offsetScrollbars:"x"}:{},ref:$t,...Wt("scrollContainer"),...qt,children:jsxRuntimeExports.jsx("div",{...Wt("scrollContainerInner"),children:zt})})});TableScrollContainer.classes=classes$b;TableScrollContainer.displayName="@mantine/core/TableScrollContainer";const defaultProps$o={withRowBorders:!0,verticalSpacing:7},varsResolver$6=(xt,{layout:$t,captionSide:Ct,horizontalSpacing:kt,verticalSpacing:Mt,borderColor:Ft,stripedColor:jt,highlightOnHoverColor:Bt,striped:Vt,highlightOnHover:zt,stickyHeaderOffset:Ht,stickyHeader:Gt})=>({table:{"--table-layout":$t,"--table-caption-side":Ct,"--table-horizontal-spacing":getSpacing(kt),"--table-vertical-spacing":getSpacing(Mt),"--table-border-color":Ft?getThemeColor(Ft,xt):void 0,"--table-striped-color":Vt&&jt?getThemeColor(jt,xt):void 0,"--table-highlight-on-hover-color":zt&&Bt?getThemeColor(Bt,xt):void 0,"--table-sticky-header-offset":Gt?rem$1(Ht):void 0}}),Table$2=factory$2((xt,$t)=>{const Ct=useProps("Table",defaultProps$o,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,horizontalSpacing:zt,verticalSpacing:Ht,captionSide:Gt,stripedColor:qt,highlightOnHoverColor:Wt,striped:Yt,highlightOnHover:Kt,withColumnBorders:Xt,withRowBorders:Qt,withTableBorder:Jt,borderColor:Zt,layout:sn,variant:ln,data:dn,children:hn,stickyHeader:cn,stickyHeaderOffset:pn,mod:yn,...gn}=Ct,En=useStyles({name:"Table",props:Ct,className:Mt,style:Ft,classes:classes$b,classNames:kt,styles:jt,unstyled:Bt,rootSelector:"table",vars:Vt,varsResolver:varsResolver$6});return jsxRuntimeExports.jsx(TableProvider,{value:{getStyles:En,stickyHeader:cn,striped:Yt===!0?"odd":Yt||void 0,highlightOnHover:Kt,withColumnBorders:Xt,withRowBorders:Qt,captionSide:Gt||"bottom"},children:jsxRuntimeExports.jsx(Box,{component:"table",variant:ln,ref:$t,mod:[{"data-with-table-border":Jt},yn],...En("table"),...gn,children:hn||!!dn&&jsxRuntimeExports.jsx(TableDataRenderer,{data:dn})})})});Table$2.classes=classes$b;Table$2.displayName="@mantine/core/Table";Table$2.Td=TableTd;Table$2.Th=TableTh;Table$2.Tr=TableTr;Table$2.Thead=TableThead;Table$2.Tbody=TableTbody;Table$2.Tfoot=TableTfoot;Table$2.Caption=TableCaption;Table$2.ScrollContainer=TableScrollContainer;Table$2.DataRenderer=TableDataRenderer;const[TabsProvider,useTabsContext]=createSafeContext("Tabs component was not found in the tree");var classes$a={root:"m_89d60db1","list--default":"m_576c9d4",list:"m_89d33d6d",panel:"m_b0c91715",tab:"m_4ec4dce6",tabSection:"m_fc420b1f","tab--default":"m_539e827b","list--outline":"m_6772fbd5","tab--outline":"m_b59ab47c","tab--pills":"m_c3381914"};const defaultProps$n={},TabsList=factory$2((xt,$t)=>{const Ct=useProps("TabsList",defaultProps$n,xt),{children:kt,className:Mt,grow:Ft,justify:jt,classNames:Bt,styles:Vt,style:zt,mod:Ht,...Gt}=Ct,qt=useTabsContext();return jsxRuntimeExports.jsx(Box,{...Gt,...qt.getStyles("list",{className:Mt,style:zt,classNames:Bt,styles:Vt,props:Ct,variant:qt.variant}),ref:$t,role:"tablist",variant:qt.variant,mod:[{grow:Ft,orientation:qt.orientation,placement:qt.orientation==="vertical"&&qt.placement,inverted:qt.inverted},Ht],"aria-orientation":qt.orientation,__vars:{"--tabs-justify":jt},children:kt})});TabsList.classes=classes$a;TabsList.displayName="@mantine/core/TabsList";const defaultProps$m={},TabsPanel=factory$2((xt,$t)=>{const Ct=useProps("TabsPanel",defaultProps$m,xt),{children:kt,className:Mt,value:Ft,classNames:jt,styles:Bt,style:Vt,mod:zt,...Ht}=Ct,Gt=useTabsContext(),qt=Gt.value===Ft,Wt=Gt.keepMounted||Ct.keepMounted||qt?kt:null;return jsxRuntimeExports.jsx(Box,{...Ht,...Gt.getStyles("panel",{className:Mt,classNames:jt,styles:Bt,style:[Vt,qt?void 0:{display:"none"}],props:Ct}),ref:$t,mod:[{orientation:Gt.orientation},zt],role:"tabpanel",id:Gt.getPanelId(Ft),"aria-labelledby":Gt.getTabId(Ft),children:Wt})});TabsPanel.classes=classes$a;TabsPanel.displayName="@mantine/core/TabsPanel";const defaultProps$l={},TabsTab=factory$2((xt,$t)=>{const Ct=useProps("TabsTab",defaultProps$l,xt),{className:kt,children:Mt,rightSection:Ft,leftSection:jt,value:Bt,onClick:Vt,onKeyDown:zt,disabled:Ht,color:Gt,style:qt,classNames:Wt,styles:Yt,vars:Kt,mod:Xt,...Qt}=Ct,Jt=useMantineTheme(),{dir:Zt}=useDirection(),sn=useTabsContext(),ln=Bt===sn.value,dn=cn=>{sn.onChange(sn.allowTabDeactivation&&Bt===sn.value?null:Bt),Vt==null||Vt(cn)},hn={classNames:Wt,styles:Yt,props:Ct};return jsxRuntimeExports.jsxs(UnstyledButton,{...Qt,...sn.getStyles("tab",{className:kt,style:qt,variant:sn.variant,...hn}),disabled:Ht,unstyled:sn.unstyled,variant:sn.variant,mod:[{active:ln,disabled:Ht,orientation:sn.orientation,inverted:sn.inverted,placement:sn.orientation==="vertical"&&sn.placement},Xt],ref:$t,role:"tab",id:sn.getTabId(Bt),"aria-selected":ln,tabIndex:ln||sn.value===null?0:-1,"aria-controls":sn.getPanelId(Bt),onClick:dn,__vars:{"--tabs-color":Gt?getThemeColor(Gt,Jt):void 0},onKeyDown:createScopedKeydownHandler({siblingSelector:'[role="tab"]',parentSelector:'[role="tablist"]',activateOnFocus:sn.activateTabWithKeyboard,loop:sn.loop,orientation:sn.orientation||"horizontal",dir:Zt,onKeyDown:zt}),children:[jt&&jsxRuntimeExports.jsx("span",{...sn.getStyles("tabSection",hn),"data-position":"left",children:jt}),Mt&&jsxRuntimeExports.jsx("span",{...sn.getStyles("tabLabel",hn),children:Mt}),Ft&&jsxRuntimeExports.jsx("span",{...sn.getStyles("tabSection",hn),"data-position":"right",children:Ft})]})});TabsTab.classes=classes$a;TabsTab.displayName="@mantine/core/TabsTab";const VALUE_ERROR="Tabs.Tab or Tabs.Panel component was rendered with invalid value or without value",defaultProps$k={keepMounted:!0,orientation:"horizontal",loop:!0,activateTabWithKeyboard:!0,allowTabDeactivation:!1,unstyled:!1,inverted:!1,variant:"default",placement:"left"},varsResolver$5=(xt,{radius:$t,color:Ct,autoContrast:kt})=>({root:{"--tabs-radius":getRadius($t),"--tabs-color":getThemeColor(Ct,xt),"--tabs-text-color":getAutoContrastValue(kt,xt)?getContrastColor({color:Ct,theme:xt,autoContrast:kt}):void 0}}),Tabs=factory$2((xt,$t)=>{const Ct=useProps("Tabs",defaultProps$k,xt),{defaultValue:kt,value:Mt,onChange:Ft,orientation:jt,children:Bt,loop:Vt,id:zt,activateTabWithKeyboard:Ht,allowTabDeactivation:Gt,variant:qt,color:Wt,radius:Yt,inverted:Kt,placement:Xt,keepMounted:Qt,classNames:Jt,styles:Zt,unstyled:sn,className:ln,style:dn,vars:hn,autoContrast:cn,mod:pn,...yn}=Ct,gn=useId$1(zt),[En,bn]=useUncontrolled({value:Mt,defaultValue:kt,finalValue:null,onChange:Ft}),xn=useStyles({name:"Tabs",props:Ct,classes:classes$a,className:ln,style:dn,classNames:Jt,styles:Zt,unstyled:sn,vars:hn,varsResolver:varsResolver$5});return jsxRuntimeExports.jsx(TabsProvider,{value:{placement:Xt,value:En,orientation:jt,id:gn,loop:Vt,activateTabWithKeyboard:Ht,getTabId:getSafeId(`${gn}-tab`,VALUE_ERROR),getPanelId:getSafeId(`${gn}-panel`,VALUE_ERROR),onChange:bn,allowTabDeactivation:Gt,variant:qt,color:Wt,radius:Yt,inverted:Kt,keepMounted:Qt,unstyled:sn,getStyles:xn},children:jsxRuntimeExports.jsx(Box,{ref:$t,id:gn,variant:qt,mod:[{orientation:jt,inverted:jt==="horizontal"&&Kt,placement:jt==="vertical"&&Xt},pn],...xn("root"),...yn,children:Bt})})});Tabs.classes=classes$a;Tabs.displayName="@mantine/core/Tabs";Tabs.Tab=TabsTab;Tabs.Panel=TabsPanel;Tabs.List=TabsList;const defaultProps$j={},TextInput=factory$2((xt,$t)=>{const Ct=useProps("TextInput",defaultProps$j,xt);return jsxRuntimeExports.jsx(InputBase,{component:"input",ref:$t,...Ct,__staticSelector:"TextInput"})});TextInput.classes=InputBase.classes;TextInput.displayName="@mantine/core/TextInput";const headings=["h1","h2","h3","h4","h5","h6"];function getTitleSize(xt,$t){const Ct=$t!==void 0?$t:`h${xt}`;return headings.includes(Ct)?{fontSize:`var(--mantine-${Ct}-font-size)`,fontWeight:`var(--mantine-${Ct}-font-weight)`,lineHeight:`var(--mantine-${Ct}-line-height)`}:{fontSize:rem$1(Ct),fontWeight:`var(--mantine-h${xt}-font-weight)`,lineHeight:`var(--mantine-h${xt}-line-height)`}}var classes$9={root:"m_8a5d1357"};const defaultProps$i={order:1},varsResolver$4=(xt,{order:$t,size:Ct,lineClamp:kt,textWrap:Mt})=>{const Ft=getTitleSize($t,Ct);return{root:{"--title-fw":Ft.fontWeight,"--title-lh":Ft.lineHeight,"--title-fz":Ft.fontSize,"--title-line-clamp":typeof kt=="number"?kt.toString():void 0,"--title-text-wrap":Mt}}},Title=factory$2((xt,$t)=>{const Ct=useProps("Title",defaultProps$i,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,order:Vt,vars:zt,size:Ht,variant:Gt,lineClamp:qt,textWrap:Wt,mod:Yt,...Kt}=Ct,Xt=useStyles({name:"Title",props:Ct,classes:classes$9,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:zt,varsResolver:varsResolver$4});return[1,2,3,4,5,6].includes(Vt)?jsxRuntimeExports.jsx(Box,{...Xt("root"),component:`h${Vt}`,variant:Gt,ref:$t,mod:[{order:Vt,"data-line-clamp":typeof qt=="number"},Yt],size:Ht,...Kt}):null});Title.classes=classes$9;Title.displayName="@mantine/core/Title";const StorageEngineContext=reactExports.createContext({storageEngine:void 0,setStorageEngine:()=>{}}),useStorageEngine=()=>reactExports.useContext(StorageEngineContext);function StorageEngineProvider({children:xt}){const[$t,Ct]=React$1.useState(void 0),kt=React$1.useMemo(()=>({storageEngine:$t,setStorageEngine:Ct}),[$t]);return jsxRuntimeExports.jsx(StorageEngineContext.Provider,{value:kt,children:xt})}/**
 * @remix-run/router v1.16.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(xt){for(var $t=1;$t<arguments.length;$t++){var Ct=arguments[$t];for(var kt in Ct)Object.prototype.hasOwnProperty.call(Ct,kt)&&(xt[kt]=Ct[kt])}return xt},_extends$3.apply(this,arguments)}var Action;(function(xt){xt.Pop="POP",xt.Push="PUSH",xt.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(xt){xt===void 0&&(xt={});function $t(kt,Mt){let{pathname:Ft,search:jt,hash:Bt}=kt.location;return createLocation$1("",{pathname:Ft,search:jt,hash:Bt},Mt.state&&Mt.state.usr||null,Mt.state&&Mt.state.key||"default")}function Ct(kt,Mt){return typeof Mt=="string"?Mt:createPath(Mt)}return getUrlBasedHistory($t,Ct,null,xt)}function invariant(xt,$t){if(xt===!1||xt===null||typeof xt>"u")throw new Error($t)}function warning(xt,$t){if(!xt){typeof console<"u"&&console.warn($t);try{throw new Error($t)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(xt,$t){return{usr:xt.state,key:xt.key,idx:$t}}function createLocation$1(xt,$t,Ct,kt){return Ct===void 0&&(Ct=null),_extends$3({pathname:typeof xt=="string"?xt:xt.pathname,search:"",hash:""},typeof $t=="string"?parsePath($t):$t,{state:Ct,key:$t&&$t.key||kt||createKey()})}function createPath(xt){let{pathname:$t="/",search:Ct="",hash:kt=""}=xt;return Ct&&Ct!=="?"&&($t+=Ct.charAt(0)==="?"?Ct:"?"+Ct),kt&&kt!=="#"&&($t+=kt.charAt(0)==="#"?kt:"#"+kt),$t}function parsePath(xt){let $t={};if(xt){let Ct=xt.indexOf("#");Ct>=0&&($t.hash=xt.substr(Ct),xt=xt.substr(0,Ct));let kt=xt.indexOf("?");kt>=0&&($t.search=xt.substr(kt),xt=xt.substr(0,kt)),xt&&($t.pathname=xt)}return $t}function getUrlBasedHistory(xt,$t,Ct,kt){kt===void 0&&(kt={});let{window:Mt=document.defaultView,v5Compat:Ft=!1}=kt,jt=Mt.history,Bt=Action.Pop,Vt=null,zt=Ht();zt==null&&(zt=0,jt.replaceState(_extends$3({},jt.state,{idx:zt}),""));function Ht(){return(jt.state||{idx:null}).idx}function Gt(){Bt=Action.Pop;let Xt=Ht(),Qt=Xt==null?null:Xt-zt;zt=Xt,Vt&&Vt({action:Bt,location:Kt.location,delta:Qt})}function qt(Xt,Qt){Bt=Action.Push;let Jt=createLocation$1(Kt.location,Xt,Qt);zt=Ht()+1;let Zt=getHistoryState(Jt,zt),sn=Kt.createHref(Jt);try{jt.pushState(Zt,"",sn)}catch(ln){if(ln instanceof DOMException&&ln.name==="DataCloneError")throw ln;Mt.location.assign(sn)}Ft&&Vt&&Vt({action:Bt,location:Kt.location,delta:1})}function Wt(Xt,Qt){Bt=Action.Replace;let Jt=createLocation$1(Kt.location,Xt,Qt);zt=Ht();let Zt=getHistoryState(Jt,zt),sn=Kt.createHref(Jt);jt.replaceState(Zt,"",sn),Ft&&Vt&&Vt({action:Bt,location:Kt.location,delta:0})}function Yt(Xt){let Qt=Mt.location.origin!=="null"?Mt.location.origin:Mt.location.href,Jt=typeof Xt=="string"?Xt:createPath(Xt);return Jt=Jt.replace(/ $/,"%20"),invariant(Qt,"No window.location.(origin|href) available to create URL for href: "+Jt),new URL(Jt,Qt)}let Kt={get action(){return Bt},get location(){return xt(Mt,jt)},listen(Xt){if(Vt)throw new Error("A history only accepts one active listener");return Mt.addEventListener(PopStateEventType,Gt),Vt=Xt,()=>{Mt.removeEventListener(PopStateEventType,Gt),Vt=null}},createHref(Xt){return $t(Mt,Xt)},createURL:Yt,encodeLocation(Xt){let Qt=Yt(Xt);return{pathname:Qt.pathname,search:Qt.search,hash:Qt.hash}},push:qt,replace:Wt,go(Xt){return jt.go(Xt)}};return Kt}var ResultType;(function(xt){xt.data="data",xt.deferred="deferred",xt.redirect="redirect",xt.error="error"})(ResultType||(ResultType={}));function matchRoutes(xt,$t,Ct){Ct===void 0&&(Ct="/");let kt=typeof $t=="string"?parsePath($t):$t,Mt=stripBasename(kt.pathname||"/",Ct);if(Mt==null)return null;let Ft=flattenRoutes(xt);rankRouteBranches(Ft);let jt=null;for(let Bt=0;jt==null&&Bt<Ft.length;++Bt){let Vt=decodePath(Mt);jt=matchRouteBranch(Ft[Bt],Vt)}return jt}function flattenRoutes(xt,$t,Ct,kt){$t===void 0&&($t=[]),Ct===void 0&&(Ct=[]),kt===void 0&&(kt="");let Mt=(Ft,jt,Bt)=>{let Vt={relativePath:Bt===void 0?Ft.path||"":Bt,caseSensitive:Ft.caseSensitive===!0,childrenIndex:jt,route:Ft};Vt.relativePath.startsWith("/")&&(invariant(Vt.relativePath.startsWith(kt),'Absolute route path "'+Vt.relativePath+'" nested under path '+('"'+kt+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),Vt.relativePath=Vt.relativePath.slice(kt.length));let zt=joinPaths([kt,Vt.relativePath]),Ht=Ct.concat(Vt);Ft.children&&Ft.children.length>0&&(invariant(Ft.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+zt+'".')),flattenRoutes(Ft.children,$t,Ht,zt)),!(Ft.path==null&&!Ft.index)&&$t.push({path:zt,score:computeScore(zt,Ft.index),routesMeta:Ht})};return xt.forEach((Ft,jt)=>{var Bt;if(Ft.path===""||!((Bt=Ft.path)!=null&&Bt.includes("?")))Mt(Ft,jt);else for(let Vt of explodeOptionalSegments(Ft.path))Mt(Ft,jt,Vt)}),$t}function explodeOptionalSegments(xt){let $t=xt.split("/");if($t.length===0)return[];let[Ct,...kt]=$t,Mt=Ct.endsWith("?"),Ft=Ct.replace(/\?$/,"");if(kt.length===0)return Mt?[Ft,""]:[Ft];let jt=explodeOptionalSegments(kt.join("/")),Bt=[];return Bt.push(...jt.map(Vt=>Vt===""?Ft:[Ft,Vt].join("/"))),Mt&&Bt.push(...jt),Bt.map(Vt=>xt.startsWith("/")&&Vt===""?"/":Vt)}function rankRouteBranches(xt){xt.sort(($t,Ct)=>$t.score!==Ct.score?Ct.score-$t.score:compareIndexes($t.routesMeta.map(kt=>kt.childrenIndex),Ct.routesMeta.map(kt=>kt.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=xt=>xt==="*";function computeScore(xt,$t){let Ct=xt.split("/"),kt=Ct.length;return Ct.some(isSplat)&&(kt+=splatPenalty),$t&&(kt+=indexRouteValue),Ct.filter(Mt=>!isSplat(Mt)).reduce((Mt,Ft)=>Mt+(paramRe.test(Ft)?dynamicSegmentValue:Ft===""?emptySegmentValue:staticSegmentValue),kt)}function compareIndexes(xt,$t){return xt.length===$t.length&&xt.slice(0,-1).every((kt,Mt)=>kt===$t[Mt])?xt[xt.length-1]-$t[$t.length-1]:0}function matchRouteBranch(xt,$t){let{routesMeta:Ct}=xt,kt={},Mt="/",Ft=[];for(let jt=0;jt<Ct.length;++jt){let Bt=Ct[jt],Vt=jt===Ct.length-1,zt=Mt==="/"?$t:$t.slice(Mt.length)||"/",Ht=matchPath({path:Bt.relativePath,caseSensitive:Bt.caseSensitive,end:Vt},zt);if(!Ht)return null;Object.assign(kt,Ht.params);let Gt=Bt.route;Ft.push({params:kt,pathname:joinPaths([Mt,Ht.pathname]),pathnameBase:normalizePathname(joinPaths([Mt,Ht.pathnameBase])),route:Gt}),Ht.pathnameBase!=="/"&&(Mt=joinPaths([Mt,Ht.pathnameBase]))}return Ft}function matchPath(xt,$t){typeof xt=="string"&&(xt={path:xt,caseSensitive:!1,end:!0});let[Ct,kt]=compilePath(xt.path,xt.caseSensitive,xt.end),Mt=$t.match(Ct);if(!Mt)return null;let Ft=Mt[0],jt=Ft.replace(/(.)\/+$/,"$1"),Bt=Mt.slice(1);return{params:kt.reduce((zt,Ht,Gt)=>{let{paramName:qt,isOptional:Wt}=Ht;if(qt==="*"){let Kt=Bt[Gt]||"";jt=Ft.slice(0,Ft.length-Kt.length).replace(/(.)\/+$/,"$1")}const Yt=Bt[Gt];return Wt&&!Yt?zt[qt]=void 0:zt[qt]=(Yt||"").replace(/%2F/g,"/"),zt},{}),pathname:Ft,pathnameBase:jt,pattern:xt}}function compilePath(xt,$t,Ct){$t===void 0&&($t=!1),Ct===void 0&&(Ct=!0),warning(xt==="*"||!xt.endsWith("*")||xt.endsWith("/*"),'Route path "'+xt+'" will be treated as if it were '+('"'+xt.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+xt.replace(/\*$/,"/*")+'".'));let kt=[],Mt="^"+xt.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(jt,Bt,Vt)=>(kt.push({paramName:Bt,isOptional:Vt!=null}),Vt?"/?([^\\/]+)?":"/([^\\/]+)"));return xt.endsWith("*")?(kt.push({paramName:"*"}),Mt+=xt==="*"||xt==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):Ct?Mt+="\\/*$":xt!==""&&xt!=="/"&&(Mt+="(?:(?=\\/|$))"),[new RegExp(Mt,$t?void 0:"i"),kt]}function decodePath(xt){try{return xt.split("/").map($t=>decodeURIComponent($t).replace(/\//g,"%2F")).join("/")}catch($t){return warning(!1,'The URL path "'+xt+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+$t+").")),xt}}function stripBasename(xt,$t){if($t==="/")return xt;if(!xt.toLowerCase().startsWith($t.toLowerCase()))return null;let Ct=$t.endsWith("/")?$t.length-1:$t.length,kt=xt.charAt(Ct);return kt&&kt!=="/"?null:xt.slice(Ct)||"/"}function resolvePath(xt,$t){$t===void 0&&($t="/");let{pathname:Ct,search:kt="",hash:Mt=""}=typeof xt=="string"?parsePath(xt):xt;return{pathname:Ct?Ct.startsWith("/")?Ct:resolvePathname(Ct,$t):$t,search:normalizeSearch(kt),hash:normalizeHash(Mt)}}function resolvePathname(xt,$t){let Ct=$t.replace(/\/+$/,"").split("/");return xt.split("/").forEach(Mt=>{Mt===".."?Ct.length>1&&Ct.pop():Mt!=="."&&Ct.push(Mt)}),Ct.length>1?Ct.join("/"):"/"}function getInvalidPathError(xt,$t,Ct,kt){return"Cannot include a '"+xt+"' character in a manually specified "+("`to."+$t+"` field ["+JSON.stringify(kt)+"].  Please separate it out to the ")+("`to."+Ct+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(xt){return xt.filter(($t,Ct)=>Ct===0||$t.route.path&&$t.route.path.length>0)}function getResolveToMatches(xt,$t){let Ct=getPathContributingMatches(xt);return $t?Ct.map((kt,Mt)=>Mt===xt.length-1?kt.pathname:kt.pathnameBase):Ct.map(kt=>kt.pathnameBase)}function resolveTo(xt,$t,Ct,kt){kt===void 0&&(kt=!1);let Mt;typeof xt=="string"?Mt=parsePath(xt):(Mt=_extends$3({},xt),invariant(!Mt.pathname||!Mt.pathname.includes("?"),getInvalidPathError("?","pathname","search",Mt)),invariant(!Mt.pathname||!Mt.pathname.includes("#"),getInvalidPathError("#","pathname","hash",Mt)),invariant(!Mt.search||!Mt.search.includes("#"),getInvalidPathError("#","search","hash",Mt)));let Ft=xt===""||Mt.pathname==="",jt=Ft?"/":Mt.pathname,Bt;if(jt==null)Bt=Ct;else{let Gt=$t.length-1;if(!kt&&jt.startsWith("..")){let qt=jt.split("/");for(;qt[0]==="..";)qt.shift(),Gt-=1;Mt.pathname=qt.join("/")}Bt=Gt>=0?$t[Gt]:"/"}let Vt=resolvePath(Mt,Bt),zt=jt&&jt!=="/"&&jt.endsWith("/"),Ht=(Ft||jt===".")&&Ct.endsWith("/");return!Vt.pathname.endsWith("/")&&(zt||Ht)&&(Vt.pathname+="/"),Vt}const joinPaths=xt=>xt.join("/").replace(/\/\/+/g,"/"),normalizePathname=xt=>xt.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=xt=>!xt||xt==="?"?"":xt.startsWith("?")?xt:"?"+xt,normalizeHash=xt=>!xt||xt==="#"?"":xt.startsWith("#")?xt:"#"+xt;function isRouteErrorResponse(xt){return xt!=null&&typeof xt.status=="number"&&typeof xt.statusText=="string"&&typeof xt.internal=="boolean"&&"data"in xt}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(xt){for(var $t=1;$t<arguments.length;$t++){var Ct=arguments[$t];for(var kt in Ct)Object.prototype.hasOwnProperty.call(Ct,kt)&&(xt[kt]=Ct[kt])}return xt},_extends$2.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(xt,$t){let{relative:Ct}={};useInRouterContext()||invariant(!1);let{basename:kt,navigator:Mt}=reactExports.useContext(NavigationContext),{hash:Ft,pathname:jt,search:Bt}=useResolvedPath(xt,{relative:Ct}),Vt=jt;return kt!=="/"&&(Vt=jt==="/"?kt:joinPaths([kt,jt])),Mt.createHref({pathname:Vt,search:Bt,hash:Ft})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect$1(xt){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(xt)}function useNavigate(){let{isDataRoute:xt}=reactExports.useContext(RouteContext);return xt?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let xt=reactExports.useContext(DataRouterContext),{basename:$t,future:Ct,navigator:kt}=reactExports.useContext(NavigationContext),{matches:Mt}=reactExports.useContext(RouteContext),{pathname:Ft}=useLocation(),jt=JSON.stringify(getResolveToMatches(Mt,Ct.v7_relativeSplatPath)),Bt=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{Bt.current=!0}),reactExports.useCallback(function(zt,Ht){if(Ht===void 0&&(Ht={}),!Bt.current)return;if(typeof zt=="number"){kt.go(zt);return}let Gt=resolveTo(zt,JSON.parse(jt),Ft,Ht.relative==="path");xt==null&&$t!=="/"&&(Gt.pathname=Gt.pathname==="/"?$t:joinPaths([$t,Gt.pathname])),(Ht.replace?kt.replace:kt.push)(Gt,Ht.state,Ht)},[$t,kt,jt,Ft,xt])}const OutletContext=reactExports.createContext(null);function useOutlet(xt){let $t=reactExports.useContext(RouteContext).outlet;return $t&&reactExports.createElement(OutletContext.Provider,{value:xt},$t)}function useParams(){let{matches:xt}=reactExports.useContext(RouteContext),$t=xt[xt.length-1];return $t?$t.params:{}}function useResolvedPath(xt,$t){let{relative:Ct}=$t===void 0?{}:$t,{future:kt}=reactExports.useContext(NavigationContext),{matches:Mt}=reactExports.useContext(RouteContext),{pathname:Ft}=useLocation(),jt=JSON.stringify(getResolveToMatches(Mt,kt.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(xt,JSON.parse(jt),Ft,Ct==="path"),[xt,jt,Ft,Ct])}function useRoutes(xt,$t){return useRoutesImpl(xt,$t)}function useRoutesImpl(xt,$t,Ct,kt){useInRouterContext()||invariant(!1);let{navigator:Mt}=reactExports.useContext(NavigationContext),{matches:Ft}=reactExports.useContext(RouteContext),jt=Ft[Ft.length-1],Bt=jt?jt.params:{};jt&&jt.pathname;let Vt=jt?jt.pathnameBase:"/";jt&&jt.route;let zt=useLocation(),Ht;if($t){var Gt;let Xt=typeof $t=="string"?parsePath($t):$t;Vt==="/"||(Gt=Xt.pathname)!=null&&Gt.startsWith(Vt)||invariant(!1),Ht=Xt}else Ht=zt;let qt=Ht.pathname||"/",Wt=qt;if(Vt!=="/"){let Xt=Vt.replace(/^\//,"").split("/");Wt="/"+qt.replace(/^\//,"").split("/").slice(Xt.length).join("/")}let Yt=matchRoutes(xt,{pathname:Wt}),Kt=_renderMatches(Yt&&Yt.map(Xt=>Object.assign({},Xt,{params:Object.assign({},Bt,Xt.params),pathname:joinPaths([Vt,Mt.encodeLocation?Mt.encodeLocation(Xt.pathname).pathname:Xt.pathname]),pathnameBase:Xt.pathnameBase==="/"?Vt:joinPaths([Vt,Mt.encodeLocation?Mt.encodeLocation(Xt.pathnameBase).pathname:Xt.pathnameBase])})),Ft,Ct,kt);return $t&&Kt?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$2({pathname:"/",search:"",hash:"",state:null,key:"default"},Ht),navigationType:Action.Pop}},Kt):Kt}function DefaultErrorComponent(){let xt=useRouteError(),$t=isRouteErrorResponse(xt)?xt.status+" "+xt.statusText:xt instanceof Error?xt.message:JSON.stringify(xt),Ct=xt instanceof Error?xt.stack:null,Mt={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},$t),Ct?reactExports.createElement("pre",{style:Mt},Ct):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor($t){super($t),this.state={location:$t.location,revalidation:$t.revalidation,error:$t.error}}static getDerivedStateFromError($t){return{error:$t}}static getDerivedStateFromProps($t,Ct){return Ct.location!==$t.location||Ct.revalidation!=="idle"&&$t.revalidation==="idle"?{error:$t.error,location:$t.location,revalidation:$t.revalidation}:{error:$t.error!==void 0?$t.error:Ct.error,location:Ct.location,revalidation:$t.revalidation||Ct.revalidation}}componentDidCatch($t,Ct){console.error("React Router caught the following error during render",$t,Ct)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(xt){let{routeContext:$t,match:Ct,children:kt}=xt,Mt=reactExports.useContext(DataRouterContext);return Mt&&Mt.static&&Mt.staticContext&&(Ct.route.errorElement||Ct.route.ErrorBoundary)&&(Mt.staticContext._deepestRenderedBoundaryId=Ct.route.id),reactExports.createElement(RouteContext.Provider,{value:$t},kt)}function _renderMatches(xt,$t,Ct,kt){var Mt;if($t===void 0&&($t=[]),Ct===void 0&&(Ct=null),kt===void 0&&(kt=null),xt==null){var Ft;if((Ft=Ct)!=null&&Ft.errors)xt=Ct.matches;else return null}let jt=xt,Bt=(Mt=Ct)==null?void 0:Mt.errors;if(Bt!=null){let Ht=jt.findIndex(Gt=>Gt.route.id&&(Bt==null?void 0:Bt[Gt.route.id])!==void 0);Ht>=0||invariant(!1),jt=jt.slice(0,Math.min(jt.length,Ht+1))}let Vt=!1,zt=-1;if(Ct&&kt&&kt.v7_partialHydration)for(let Ht=0;Ht<jt.length;Ht++){let Gt=jt[Ht];if((Gt.route.HydrateFallback||Gt.route.hydrateFallbackElement)&&(zt=Ht),Gt.route.id){let{loaderData:qt,errors:Wt}=Ct,Yt=Gt.route.loader&&qt[Gt.route.id]===void 0&&(!Wt||Wt[Gt.route.id]===void 0);if(Gt.route.lazy||Yt){Vt=!0,zt>=0?jt=jt.slice(0,zt+1):jt=[jt[0]];break}}}return jt.reduceRight((Ht,Gt,qt)=>{let Wt,Yt=!1,Kt=null,Xt=null;Ct&&(Wt=Bt&&Gt.route.id?Bt[Gt.route.id]:void 0,Kt=Gt.route.errorElement||defaultErrorElement,Vt&&(zt<0&&qt===0?(Yt=!0,Xt=null):zt===qt&&(Yt=!0,Xt=Gt.route.hydrateFallbackElement||null)));let Qt=$t.concat(jt.slice(0,qt+1)),Jt=()=>{let Zt;return Wt?Zt=Kt:Yt?Zt=Xt:Gt.route.Component?Zt=reactExports.createElement(Gt.route.Component,null):Gt.route.element?Zt=Gt.route.element:Zt=Ht,reactExports.createElement(RenderedRoute,{match:Gt,routeContext:{outlet:Ht,matches:Qt,isDataRoute:Ct!=null},children:Zt})};return Ct&&(Gt.route.ErrorBoundary||Gt.route.errorElement||qt===0)?reactExports.createElement(RenderErrorBoundary,{location:Ct.location,revalidation:Ct.revalidation,component:Kt,error:Wt,children:Jt(),routeContext:{outlet:null,matches:Qt,isDataRoute:!0}}):Jt()},null)}var DataRouterHook$1=function(xt){return xt.UseBlocker="useBlocker",xt.UseRevalidator="useRevalidator",xt.UseNavigateStable="useNavigate",xt}(DataRouterHook$1||{}),DataRouterStateHook$1=function(xt){return xt.UseBlocker="useBlocker",xt.UseLoaderData="useLoaderData",xt.UseActionData="useActionData",xt.UseRouteError="useRouteError",xt.UseNavigation="useNavigation",xt.UseRouteLoaderData="useRouteLoaderData",xt.UseMatches="useMatches",xt.UseRevalidator="useRevalidator",xt.UseNavigateStable="useNavigate",xt.UseRouteId="useRouteId",xt}(DataRouterStateHook$1||{});function useDataRouterContext(xt){let $t=reactExports.useContext(DataRouterContext);return $t||invariant(!1),$t}function useDataRouterState(xt){let $t=reactExports.useContext(DataRouterStateContext);return $t||invariant(!1),$t}function useRouteContext(xt){let $t=reactExports.useContext(RouteContext);return $t||invariant(!1),$t}function useCurrentRouteId(xt){let $t=useRouteContext(),Ct=$t.matches[$t.matches.length-1];return Ct.route.id||invariant(!1),Ct.route.id}function useRouteError(){var xt;let $t=reactExports.useContext(RouteErrorContext),Ct=useDataRouterState(DataRouterStateHook$1.UseRouteError),kt=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return $t!==void 0?$t:(xt=Ct.errors)==null?void 0:xt[kt]}function useNavigateStable(){let{router:xt}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),$t=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),Ct=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{Ct.current=!0}),reactExports.useCallback(function(Mt,Ft){Ft===void 0&&(Ft={}),Ct.current&&(typeof Mt=="number"?xt.navigate(Mt):xt.navigate(Mt,_extends$2({fromRouteId:$t},Ft)))},[xt,$t])}function Navigate(xt){let{to:$t,replace:Ct,state:kt,relative:Mt}=xt;useInRouterContext()||invariant(!1);let{future:Ft,static:jt}=reactExports.useContext(NavigationContext),{matches:Bt}=reactExports.useContext(RouteContext),{pathname:Vt}=useLocation(),zt=useNavigate(),Ht=resolveTo($t,getResolveToMatches(Bt,Ft.v7_relativeSplatPath),Vt,Mt==="path"),Gt=JSON.stringify(Ht);return reactExports.useEffect(()=>zt(JSON.parse(Gt),{replace:Ct,state:kt,relative:Mt}),[zt,Gt,Mt,Ct,kt]),null}function Outlet(xt){return useOutlet(xt.context)}function Route(xt){invariant(!1)}function Router(xt){let{basename:$t="/",children:Ct=null,location:kt,navigationType:Mt=Action.Pop,navigator:Ft,static:jt=!1,future:Bt}=xt;useInRouterContext()&&invariant(!1);let Vt=$t.replace(/^\/*/,"/"),zt=reactExports.useMemo(()=>({basename:Vt,navigator:Ft,static:jt,future:_extends$2({v7_relativeSplatPath:!1},Bt)}),[Vt,Bt,Ft,jt]);typeof kt=="string"&&(kt=parsePath(kt));let{pathname:Ht="/",search:Gt="",hash:qt="",state:Wt=null,key:Yt="default"}=kt,Kt=reactExports.useMemo(()=>{let Xt=stripBasename(Ht,Vt);return Xt==null?null:{location:{pathname:Xt,search:Gt,hash:qt,state:Wt,key:Yt},navigationType:Mt}},[Vt,Ht,Gt,qt,Wt,Yt,Mt]);return Kt==null?null:reactExports.createElement(NavigationContext.Provider,{value:zt},reactExports.createElement(LocationContext.Provider,{children:Ct,value:Kt}))}function Routes(xt){let{children:$t,location:Ct}=xt;return useRoutes(createRoutesFromChildren($t),Ct)}new Promise(()=>{});function createRoutesFromChildren(xt,$t){$t===void 0&&($t=[]);let Ct=[];return reactExports.Children.forEach(xt,(kt,Mt)=>{if(!reactExports.isValidElement(kt))return;let Ft=[...$t,Mt];if(kt.type===reactExports.Fragment){Ct.push.apply(Ct,createRoutesFromChildren(kt.props.children,Ft));return}kt.type!==Route&&invariant(!1),!kt.props.index||!kt.props.children||invariant(!1);let jt={id:kt.props.id||Ft.join("-"),caseSensitive:kt.props.caseSensitive,element:kt.props.element,Component:kt.props.Component,index:kt.props.index,path:kt.props.path,loader:kt.props.loader,action:kt.props.action,errorElement:kt.props.errorElement,ErrorBoundary:kt.props.ErrorBoundary,hasErrorBoundary:kt.props.ErrorBoundary!=null||kt.props.errorElement!=null,shouldRevalidate:kt.props.shouldRevalidate,handle:kt.props.handle,lazy:kt.props.lazy};kt.props.children&&(jt.children=createRoutesFromChildren(kt.props.children,Ft)),Ct.push(jt)}),Ct}/**
 * React Router DOM v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function createSearchParams(xt){return xt===void 0&&(xt=""),new URLSearchParams(typeof xt=="string"||Array.isArray(xt)||xt instanceof URLSearchParams?xt:Object.keys(xt).reduce(($t,Ct)=>{let kt=xt[Ct];return $t.concat(Array.isArray(kt)?kt.map(Mt=>[Ct,Mt]):[[Ct,kt]])},[]))}function getSearchParamsForLocation(xt,$t){let Ct=createSearchParams(xt);return $t&&$t.forEach((kt,Mt)=>{Ct.has(Mt)||$t.getAll(Mt).forEach(Ft=>{Ct.append(Mt,Ft)})}),Ct}const REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const START_TRANSITION="startTransition",startTransitionImpl=ReactOriginal[START_TRANSITION];function BrowserRouter(xt){let{basename:$t,children:Ct,future:kt,window:Mt}=xt,Ft=reactExports.useRef();Ft.current==null&&(Ft.current=createBrowserHistory({window:Mt,v5Compat:!0}));let jt=Ft.current,[Bt,Vt]=reactExports.useState({action:jt.action,location:jt.location}),{v7_startTransition:zt}=kt||{},Ht=reactExports.useCallback(Gt=>{zt&&startTransitionImpl?startTransitionImpl(()=>Vt(Gt)):Vt(Gt)},[Vt,zt]);return reactExports.useLayoutEffect(()=>jt.listen(Ht),[jt,Ht]),reactExports.createElement(Router,{basename:$t,children:Ct,location:Bt.location,navigationType:Bt.action,navigator:jt,future:kt})}var DataRouterHook;(function(xt){xt.UseScrollRestoration="useScrollRestoration",xt.UseSubmit="useSubmit",xt.UseSubmitFetcher="useSubmitFetcher",xt.UseFetcher="useFetcher",xt.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(xt){xt.UseFetcher="useFetcher",xt.UseFetchers="useFetchers",xt.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useSearchParams(xt){let $t=reactExports.useRef(createSearchParams(xt)),Ct=reactExports.useRef(!1),kt=useLocation(),Mt=reactExports.useMemo(()=>getSearchParamsForLocation(kt.search,Ct.current?null:$t.current),[kt.search]),Ft=useNavigate(),jt=reactExports.useCallback((Bt,Vt)=>{const zt=createSearchParams(typeof Bt=="function"?Bt(Mt):Bt);Ct.current=!0,Ft("?"+zt,Vt)},[Ft,Mt]);return[Mt,jt]}const ModalsContext=reactExports.createContext(null);ModalsContext.displayName="@mantine/modals/ModalsContext";function useModals(){const xt=reactExports.useContext(ModalsContext);if(!xt)throw new Error("[@mantine/modals] useModals hook was called outside of context, wrap your app with ModalsProvider component");return xt}function ConfirmModal({id:xt,cancelProps:$t,confirmProps:Ct,labels:kt={cancel:"",confirm:""},closeOnConfirm:Mt=!0,closeOnCancel:Ft=!0,groupProps:jt,onCancel:Bt,onConfirm:Vt,children:zt}){const{cancel:Ht,confirm:Gt}=kt,qt=useModals(),Wt=Kt=>{typeof($t==null?void 0:$t.onClick)=="function"&&($t==null||$t.onClick(Kt)),typeof Bt=="function"&&Bt(),Ft&&qt.closeModal(xt)},Yt=Kt=>{typeof(Ct==null?void 0:Ct.onClick)=="function"&&(Ct==null||Ct.onClick(Kt)),typeof Vt=="function"&&Vt(),Mt&&qt.closeModal(xt)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[zt&&jsxRuntimeExports.jsx(Box,{mb:"md",children:zt}),jsxRuntimeExports.jsxs(Group$1,{justify:"flex-end",...jt,children:[jsxRuntimeExports.jsx(Button,{variant:"default",...$t,onClick:Wt,children:($t==null?void 0:$t.children)||Ht}),jsxRuntimeExports.jsx(Button,{...Ct,onClick:Yt,children:(Ct==null?void 0:Ct.children)||Gt})]})]})}const[useModalsEvents,createEvent]=createUseExternalEvents("mantine-modals");createEvent("openModal");createEvent("closeModal");createEvent("closeAllModals");const openConfirmModal=createEvent("openConfirmModal");function handleCloseModal(xt,$t){var Ct,kt,Mt,Ft;$t&&xt.type==="confirm"&&((kt=(Ct=xt.props).onCancel)==null||kt.call(Ct)),(Ft=(Mt=xt.props).onClose)==null||Ft.call(Mt)}function modalsReducer(xt,$t){switch($t.type){case"OPEN":return{current:$t.modal,modals:[...xt.modals,$t.modal]};case"CLOSE":{const Ct=xt.modals.find(Mt=>Mt.id===$t.modalId);if(!Ct)return xt;handleCloseModal(Ct,$t.canceled);const kt=xt.modals.filter(Mt=>Mt.id!==$t.modalId);return{current:kt[kt.length-1]||xt.current,modals:kt}}case"CLOSE_ALL":return xt.modals.length?(xt.modals.concat().reverse().forEach(Ct=>{handleCloseModal(Ct,$t.canceled)}),{current:xt.current,modals:[]}):xt;default:return xt}}function separateConfirmModalProps(xt){if(!xt)return{confirmProps:{},modalProps:{}};const{id:$t,children:Ct,onCancel:kt,onConfirm:Mt,closeOnConfirm:Ft,closeOnCancel:jt,cancelProps:Bt,confirmProps:Vt,groupProps:zt,labels:Ht,...Gt}=xt;return{confirmProps:{id:$t,children:Ct,onCancel:kt,onConfirm:Mt,closeOnConfirm:Ft,closeOnCancel:jt,cancelProps:Bt,confirmProps:Vt,groupProps:zt,labels:Ht},modalProps:{id:$t,...Gt}}}function ModalsProvider({children:xt,modalProps:$t,labels:Ct,modals:kt}){const[Mt,Ft]=reactExports.useReducer(modalsReducer,{modals:[],current:null}),jt=reactExports.useRef(Mt);jt.current=Mt;const Bt=reactExports.useCallback(Xt=>{Ft({type:"CLOSE_ALL",canceled:Xt})},[jt,Ft]),Vt=reactExports.useCallback(({modalId:Xt,...Qt})=>{const Jt=Xt||randomId();return Ft({type:"OPEN",modal:{id:Jt,type:"content",props:Qt}}),Jt},[Ft]),zt=reactExports.useCallback(({modalId:Xt,...Qt})=>{const Jt=Xt||randomId();return Ft({type:"OPEN",modal:{id:Jt,type:"confirm",props:Qt}}),Jt},[Ft]),Ht=reactExports.useCallback((Xt,{modalId:Qt,...Jt})=>{const Zt=Qt||randomId();return Ft({type:"OPEN",modal:{id:Zt,type:"context",props:Jt,ctx:Xt}}),Zt},[Ft]),Gt=reactExports.useCallback((Xt,Qt)=>{Ft({type:"CLOSE",modalId:Xt,canceled:Qt})},[jt,Ft]);useModalsEvents({openModal:Vt,openConfirmModal:zt,openContextModal:({modal:Xt,...Qt})=>Ht(Xt,Qt),closeModal:Gt,closeContextModal:Gt,closeAllModals:Bt});const qt={modals:Mt.modals,openModal:Vt,openConfirmModal:zt,openContextModal:Ht,closeModal:Gt,closeContextModal:Gt,closeAll:Bt},Wt=()=>{const Xt=jt.current.current;switch(Xt==null?void 0:Xt.type){case"context":{const{innerProps:Qt,...Jt}=Xt.props,Zt=kt[Xt.ctx];return{modalProps:Jt,content:jsxRuntimeExports.jsx(Zt,{innerProps:Qt,context:qt,id:Xt.id})}}case"confirm":{const{modalProps:Qt,confirmProps:Jt}=separateConfirmModalProps(Xt.props);return{modalProps:Qt,content:jsxRuntimeExports.jsx(ConfirmModal,{...Jt,id:Xt.id,labels:Xt.props.labels||Ct})}}case"content":{const{children:Qt,...Jt}=Xt.props;return{modalProps:Jt,content:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:Qt})}}default:return{modalProps:{},content:null}}},{modalProps:Yt,content:Kt}=Wt();return jsxRuntimeExports.jsxs(ModalsContext.Provider,{value:qt,children:[jsxRuntimeExports.jsx(Modal,{zIndex:getDefaultZIndex("modal")+1,...$t,...Yt,opened:Mt.modals.length>0,onClose:()=>{var Xt;return Gt((Xt=Mt.current)==null?void 0:Xt.id)},children:Kt}),xt]})}/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const createReactComponent=(xt,$t,Ct,kt)=>{const Mt=reactExports.forwardRef(({color:Ft="currentColor",size:jt=24,stroke:Bt=2,className:Vt,children:zt,...Ht},Gt)=>reactExports.createElement("svg",{ref:Gt,...defaultAttributes[xt],width:jt,height:jt,className:["tabler-icon",`tabler-icon-${$t}`,Vt].join(" "),...xt==="filled"?{fill:Ft}:{strokeWidth:Bt,stroke:Ft},...Ht},[...kt.map(([qt,Wt])=>reactExports.createElement(qt,Wt)),...Array.isArray(zt)?zt:[zt]]));return Mt.displayName=`${Ct}`,Mt};/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconAlertCircle=createReactComponent("outline","alert-circle","IconAlertCircle",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 8v4",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconAlertTriangle=createReactComponent("outline","alert-triangle","IconAlertTriangle",[["path",{d:"M12 9v4",key:"svg-0"}],["path",{d:"M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconArrowsShuffle=createReactComponent("outline","arrows-shuffle","IconArrowsShuffle",[["path",{d:"M18 4l3 3l-3 3",key:"svg-0"}],["path",{d:"M18 20l3 -3l-3 -3",key:"svg-1"}],["path",{d:"M3 7h3a5 5 0 0 1 5 5a5 5 0 0 0 5 5h5",key:"svg-2"}],["path",{d:"M21 7h-5a4.978 4.978 0 0 0 -3 1m-4 8a4.984 4.984 0 0 1 -3 1h-3",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconAt=createReactComponent("outline","at","IconAt",[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M16 12v1.5a2.5 2.5 0 0 0 5 0v-1.5a9 9 0 1 0 -5.5 8.28",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconBrain=createReactComponent("outline","brain","IconBrain",[["path",{d:"M15.5 13a3.5 3.5 0 0 0 -3.5 3.5v1a3.5 3.5 0 0 0 7 0v-1.8",key:"svg-0"}],["path",{d:"M8.5 13a3.5 3.5 0 0 1 3.5 3.5v1a3.5 3.5 0 0 1 -7 0v-1.8",key:"svg-1"}],["path",{d:"M17.5 16a3.5 3.5 0 0 0 0 -7h-.5",key:"svg-2"}],["path",{d:"M19 9.3v-2.8a3.5 3.5 0 0 0 -7 0",key:"svg-3"}],["path",{d:"M6.5 16a3.5 3.5 0 0 1 0 -7h.5",key:"svg-4"}],["path",{d:"M5 9.3v-2.8a3.5 3.5 0 0 1 7 0v10",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconChartBar=createReactComponent("outline","chart-bar","IconChartBar",[["path",{d:"M3 13a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M15 9a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M9 5a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v14a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M4 20h14",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconChartDonut2=createReactComponent("outline","chart-donut-2","IconChartDonut2",[["path",{d:"M12 3v5m4 4h5",key:"svg-0"}],["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-1"}],["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconChartHistogram=createReactComponent("outline","chart-histogram","IconChartHistogram",[["path",{d:"M3 3v18h18",key:"svg-0"}],["path",{d:"M20 18v3",key:"svg-1"}],["path",{d:"M16 16v5",key:"svg-2"}],["path",{d:"M12 13v8",key:"svg-3"}],["path",{d:"M8 16v5",key:"svg-4"}],["path",{d:"M3 11c6 0 5 -5 9 -5s3 5 9 5",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconCheck=createReactComponent("outline","check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconCircleCheck=createReactComponent("outline","circle-check","IconCircleCheck",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M9 12l2 2l4 -4",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconDatabaseExport=createReactComponent("outline","database-export","IconDatabaseExport",[["path",{d:"M4 6c0 1.657 3.582 3 8 3s8 -1.343 8 -3s-3.582 -3 -8 -3s-8 1.343 -8 3",key:"svg-0"}],["path",{d:"M4 6v6c0 1.657 3.582 3 8 3c1.118 0 2.183 -.086 3.15 -.241",key:"svg-1"}],["path",{d:"M20 12v-6",key:"svg-2"}],["path",{d:"M4 12v6c0 1.657 3.582 3 8 3c.157 0 .312 -.002 .466 -.005",key:"svg-3"}],["path",{d:"M16 19h6",key:"svg-4"}],["path",{d:"M19 16l3 3l-3 3",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconDotsVertical=createReactComponent("outline","dots-vertical","IconDotsVertical",[["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M12 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconFileLambda=createReactComponent("outline","file-lambda","IconFileLambda",[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M10 17l2 -3",key:"svg-2"}],["path",{d:"M15 17c-2.5 0 -2.5 -6 -5 -6",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconInfoCircle=createReactComponent("outline","info-circle","IconInfoCircle",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 9h.01",key:"svg-1"}],["path",{d:"M11 12h1v4h1",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconLayoutColumns=createReactComponent("outline","layout-columns","IconLayoutColumns",[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M12 4l0 16",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconMail=createReactComponent("outline","mail","IconMail",[["path",{d:"M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z",key:"svg-0"}],["path",{d:"M3 7l9 6l9 -6",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconPlayerPlay=createReactComponent("outline","player-play","IconPlayerPlay",[["path",{d:"M7 4v16l13 -8z",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconProgress=createReactComponent("outline","progress","IconProgress",[["path",{d:"M10 20.777a8.942 8.942 0 0 1 -2.48 -.969",key:"svg-0"}],["path",{d:"M14 3.223a9.003 9.003 0 0 1 0 17.554",key:"svg-1"}],["path",{d:"M4.579 17.093a8.961 8.961 0 0 1 -1.227 -2.592",key:"svg-2"}],["path",{d:"M3.124 10.5c.16 -.95 .468 -1.85 .9 -2.675l.169 -.305",key:"svg-3"}],["path",{d:"M6.907 4.579a8.954 8.954 0 0 1 3.093 -1.356",key:"svg-4"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconRefresh=createReactComponent("outline","refresh","IconRefresh",[["path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4",key:"svg-0"}],["path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconSchema=createReactComponent("outline","schema","IconSchema",[["path",{d:"M5 2h5v4h-5z",key:"svg-0"}],["path",{d:"M15 10h5v4h-5z",key:"svg-1"}],["path",{d:"M5 18h5v4h-5z",key:"svg-2"}],["path",{d:"M5 10h5v4h-5z",key:"svg-3"}],["path",{d:"M10 12h5",key:"svg-4"}],["path",{d:"M7.5 6v4",key:"svg-5"}],["path",{d:"M7.5 14v4",key:"svg-6"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconSearch=createReactComponent("outline","search","IconSearch",[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconSettings=createReactComponent("outline","settings","IconSettings",[["path",{d:"M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z",key:"svg-0"}],["path",{d:"M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconTableExport=createReactComponent("outline","table-export","IconTableExport",[["path",{d:"M12.5 21h-7.5a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v7.5",key:"svg-0"}],["path",{d:"M3 10h18",key:"svg-1"}],["path",{d:"M10 3v18",key:"svg-2"}],["path",{d:"M16 19h6",key:"svg-3"}],["path",{d:"M19 16l3 3l-3 3",key:"svg-4"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconTable=createReactComponent("outline","table","IconTable",[["path",{d:"M3 5a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-14z",key:"svg-0"}],["path",{d:"M3 10h18",key:"svg-1"}],["path",{d:"M10 3v18",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconTrashX=createReactComponent("outline","trash-x","IconTrashX",[["path",{d:"M4 7h16",key:"svg-0"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-1"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-2"}],["path",{d:"M10 12l4 4m0 -4l-4 4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconUserPlus=createReactComponent("outline","user-plus","IconUserPlus",[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M16 19h6",key:"svg-1"}],["path",{d:"M19 16v6",key:"svg-2"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconX=createReactComponent("outline","x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.5.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconBrandGoogleFilled=createReactComponent("filled","brand-google-filled","IconBrandGoogleFilled",[["path",{d:"M12 2a9.96 9.96 0 0 1 6.29 2.226a1 1 0 0 1 .04 1.52l-1.51 1.362a1 1 0 0 1 -1.265 .06a6 6 0 1 0 2.103 6.836l.001 -.004h-3.66a1 1 0 0 1 -.992 -.883l-.007 -.117v-2a1 1 0 0 1 1 -1h6.945a1 1 0 0 1 .994 .89c.04 .367 .061 .737 .061 1.11c0 5.523 -4.477 10 -10 10s-10 -4.477 -10 -10s4.477 -10 10 -10z",key:"svg-0"}]]);function sanitizeStringForUrl(xt){const $t=xt.split("/")||[];return $t[$t.length-1].replace(/\.[^\.]+$/,"").replace(".","_").replace(" ","_").replace("/","_")}const PREFIX$1="/SumSifter/";function ok$1(){}function unreachable(){}function parse$e(xt){const $t=[],Ct=String(xt||"");let kt=Ct.indexOf(","),Mt=0,Ft=!1;for(;!Ft;){kt===-1&&(kt=Ct.length,Ft=!0);const jt=Ct.slice(Mt,kt).trim();(jt||!Ft)&&$t.push(jt),Mt=kt+1,kt=Ct.indexOf(",",Mt)}return $t}function stringify$5(xt,$t){const Ct={};return(xt[xt.length-1]===""?[...xt,""]:xt).join((Ct.padRight?" ":"")+","+(Ct.padLeft===!1?"":" ")).trim()}const nameRe=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,nameReJsx=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,emptyOptions$3={};function name$s(xt,$t){return(emptyOptions$3.jsx?nameReJsx:nameRe).test(xt)}const re$5=/[ \t\n\f\r]/g;function whitespace(xt){return typeof xt=="object"?xt.type==="text"?empty$5(xt.value):!1:empty$5(xt)}function empty$5(xt){return xt.replace(re$5,"")===""}let Schema$2=class{constructor($t,Ct,kt){this.property=$t,this.normal=Ct,kt&&(this.space=kt)}};Schema$2.prototype.property={};Schema$2.prototype.normal={};Schema$2.prototype.space=null;function merge$6(xt,$t){const Ct={},kt={};let Mt=-1;for(;++Mt<xt.length;)Object.assign(Ct,xt[Mt].property),Object.assign(kt,xt[Mt].normal);return new Schema$2(Ct,kt,$t)}function normalize$4(xt){return xt.toLowerCase()}let Info$1=class{constructor($t,Ct){this.property=$t,this.attribute=Ct}};Info$1.prototype.space=null;Info$1.prototype.boolean=!1;Info$1.prototype.booleanish=!1;Info$1.prototype.overloadedBoolean=!1;Info$1.prototype.number=!1;Info$1.prototype.commaSeparated=!1;Info$1.prototype.spaceSeparated=!1;Info$1.prototype.commaOrSpaceSeparated=!1;Info$1.prototype.mustUseProperty=!1;Info$1.prototype.defined=!1;let powers=0;const boolean=increment$1(),booleanish=increment$1(),overloadedBoolean=increment$1(),number$7=increment$1(),spaceSeparated=increment$1(),commaSeparated=increment$1(),commaOrSpaceSeparated=increment$1();function increment$1(){return 2**++powers}const types$4=Object.freeze(Object.defineProperty({__proto__:null,boolean,booleanish,commaOrSpaceSeparated,commaSeparated,number:number$7,overloadedBoolean,spaceSeparated},Symbol.toStringTag,{value:"Module"})),checks=Object.keys(types$4);class DefinedInfo extends Info$1{constructor($t,Ct,kt,Mt){let Ft=-1;if(super($t,Ct),mark(this,"space",Mt),typeof kt=="number")for(;++Ft<checks.length;){const jt=checks[Ft];mark(this,checks[Ft],(kt&types$4[jt])===types$4[jt])}}}DefinedInfo.prototype.defined=!0;function mark(xt,$t,Ct){Ct&&(xt[$t]=Ct)}const own$8={}.hasOwnProperty;function create$4(xt){const $t={},Ct={};let kt;for(kt in xt.properties)if(own$8.call(xt.properties,kt)){const Mt=xt.properties[kt],Ft=new DefinedInfo(kt,xt.transform(xt.attributes||{},kt),Mt,xt.space);xt.mustUseProperty&&xt.mustUseProperty.includes(kt)&&(Ft.mustUseProperty=!0),$t[kt]=Ft,Ct[normalize$4(kt)]=kt,Ct[normalize$4(Ft.attribute)]=kt}return new Schema$2($t,Ct,xt.space)}const xlink=create$4({space:"xlink",transform(xt,$t){return"xlink:"+$t.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),xml=create$4({space:"xml",transform(xt,$t){return"xml:"+$t.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function caseSensitiveTransform(xt,$t){return $t in xt?xt[$t]:$t}function caseInsensitiveTransform(xt,$t){return caseSensitiveTransform(xt,$t.toLowerCase())}const xmlns$1=create$4({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:caseInsensitiveTransform,properties:{xmlns:null,xmlnsXLink:null}}),aria$1=create$4({transform(xt,$t){return $t==="role"?$t:"aria-"+$t.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:booleanish,ariaAutoComplete:null,ariaBusy:booleanish,ariaChecked:booleanish,ariaColCount:number$7,ariaColIndex:number$7,ariaColSpan:number$7,ariaControls:spaceSeparated,ariaCurrent:null,ariaDescribedBy:spaceSeparated,ariaDetails:null,ariaDisabled:booleanish,ariaDropEffect:spaceSeparated,ariaErrorMessage:null,ariaExpanded:booleanish,ariaFlowTo:spaceSeparated,ariaGrabbed:booleanish,ariaHasPopup:null,ariaHidden:booleanish,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:spaceSeparated,ariaLevel:number$7,ariaLive:null,ariaModal:booleanish,ariaMultiLine:booleanish,ariaMultiSelectable:booleanish,ariaOrientation:null,ariaOwns:spaceSeparated,ariaPlaceholder:null,ariaPosInSet:number$7,ariaPressed:booleanish,ariaReadOnly:booleanish,ariaRelevant:null,ariaRequired:booleanish,ariaRoleDescription:spaceSeparated,ariaRowCount:number$7,ariaRowIndex:number$7,ariaRowSpan:number$7,ariaSelected:booleanish,ariaSetSize:number$7,ariaSort:null,ariaValueMax:number$7,ariaValueMin:number$7,ariaValueNow:number$7,ariaValueText:null,role:null}}),html$2=create$4({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:caseInsensitiveTransform,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:commaSeparated,acceptCharset:spaceSeparated,accessKey:spaceSeparated,action:null,allow:null,allowFullScreen:boolean,allowPaymentRequest:boolean,allowUserMedia:boolean,alt:null,as:null,async:boolean,autoCapitalize:null,autoComplete:spaceSeparated,autoFocus:boolean,autoPlay:boolean,blocking:spaceSeparated,capture:null,charSet:null,checked:boolean,cite:null,className:spaceSeparated,cols:number$7,colSpan:null,content:null,contentEditable:booleanish,controls:boolean,controlsList:spaceSeparated,coords:number$7|commaSeparated,crossOrigin:null,data:null,dateTime:null,decoding:null,default:boolean,defer:boolean,dir:null,dirName:null,disabled:boolean,download:overloadedBoolean,draggable:booleanish,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:boolean,formTarget:null,headers:spaceSeparated,height:number$7,hidden:boolean,high:number$7,href:null,hrefLang:null,htmlFor:spaceSeparated,httpEquiv:spaceSeparated,id:null,imageSizes:null,imageSrcSet:null,inert:boolean,inputMode:null,integrity:null,is:null,isMap:boolean,itemId:null,itemProp:spaceSeparated,itemRef:spaceSeparated,itemScope:boolean,itemType:spaceSeparated,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:boolean,low:number$7,manifest:null,max:null,maxLength:number$7,media:null,method:null,min:null,minLength:number$7,multiple:boolean,muted:boolean,name:null,nonce:null,noModule:boolean,noValidate:boolean,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:boolean,optimum:number$7,pattern:null,ping:spaceSeparated,placeholder:null,playsInline:boolean,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:boolean,referrerPolicy:null,rel:spaceSeparated,required:boolean,reversed:boolean,rows:number$7,rowSpan:number$7,sandbox:spaceSeparated,scope:null,scoped:boolean,seamless:boolean,selected:boolean,shadowRootClonable:boolean,shadowRootDelegatesFocus:boolean,shadowRootMode:null,shape:null,size:number$7,sizes:null,slot:null,span:number$7,spellCheck:booleanish,src:null,srcDoc:null,srcLang:null,srcSet:null,start:number$7,step:null,style:null,tabIndex:number$7,target:null,title:null,translate:null,type:null,typeMustMatch:boolean,useMap:null,value:booleanish,width:number$7,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:spaceSeparated,axis:null,background:null,bgColor:null,border:number$7,borderColor:null,bottomMargin:number$7,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:boolean,declare:boolean,event:null,face:null,frame:null,frameBorder:null,hSpace:number$7,leftMargin:number$7,link:null,longDesc:null,lowSrc:null,marginHeight:number$7,marginWidth:number$7,noResize:boolean,noHref:boolean,noShade:boolean,noWrap:boolean,object:null,profile:null,prompt:null,rev:null,rightMargin:number$7,rules:null,scheme:null,scrolling:booleanish,standby:null,summary:null,text:null,topMargin:number$7,valueType:null,version:null,vAlign:null,vLink:null,vSpace:number$7,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:boolean,disableRemotePlayback:boolean,prefix:null,property:null,results:number$7,security:null,unselectable:null}}),svg$1=create$4({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:caseSensitiveTransform,properties:{about:commaOrSpaceSeparated,accentHeight:number$7,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:number$7,amplitude:number$7,arabicForm:null,ascent:number$7,attributeName:null,attributeType:null,azimuth:number$7,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:number$7,by:null,calcMode:null,capHeight:number$7,className:spaceSeparated,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:number$7,diffuseConstant:number$7,direction:null,display:null,dur:null,divisor:number$7,dominantBaseline:null,download:boolean,dx:null,dy:null,edgeMode:null,editable:null,elevation:number$7,enableBackground:null,end:null,event:null,exponent:number$7,externalResourcesRequired:null,fill:null,fillOpacity:number$7,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:commaSeparated,g2:commaSeparated,glyphName:commaSeparated,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:number$7,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:number$7,horizOriginX:number$7,horizOriginY:number$7,id:null,ideographic:number$7,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:number$7,k:number$7,k1:number$7,k2:number$7,k3:number$7,k4:number$7,kernelMatrix:commaOrSpaceSeparated,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:number$7,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:number$7,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:number$7,overlineThickness:number$7,paintOrder:null,panose1:null,path:null,pathLength:number$7,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:spaceSeparated,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:number$7,pointsAtY:number$7,pointsAtZ:number$7,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:commaOrSpaceSeparated,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:commaOrSpaceSeparated,rev:commaOrSpaceSeparated,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:commaOrSpaceSeparated,requiredFeatures:commaOrSpaceSeparated,requiredFonts:commaOrSpaceSeparated,requiredFormats:commaOrSpaceSeparated,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:number$7,specularExponent:number$7,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:number$7,strikethroughThickness:number$7,string:null,stroke:null,strokeDashArray:commaOrSpaceSeparated,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:number$7,strokeOpacity:number$7,strokeWidth:null,style:null,surfaceScale:number$7,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:commaOrSpaceSeparated,tabIndex:number$7,tableValues:null,target:null,targetX:number$7,targetY:number$7,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:commaOrSpaceSeparated,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:number$7,underlineThickness:number$7,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:number$7,values:null,vAlphabetic:number$7,vMathematical:number$7,vectorEffect:null,vHanging:number$7,vIdeographic:number$7,version:null,vertAdvY:number$7,vertOriginX:number$7,vertOriginY:number$7,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:number$7,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),valid=/^data[-\w.:]+$/i,dash=/-[a-z]/g,cap$1=/[A-Z]/g;function find$6(xt,$t){const Ct=normalize$4($t);let kt=$t,Mt=Info$1;if(Ct in xt.normal)return xt.property[xt.normal[Ct]];if(Ct.length>4&&Ct.slice(0,4)==="data"&&valid.test($t)){if($t.charAt(4)==="-"){const Ft=$t.slice(5).replace(dash,camelcase);kt="data"+Ft.charAt(0).toUpperCase()+Ft.slice(1)}else{const Ft=$t.slice(4);if(!dash.test(Ft)){let jt=Ft.replace(cap$1,kebab);jt.charAt(0)!=="-"&&(jt="-"+jt),$t="data"+jt}}Mt=DefinedInfo}return new Mt(kt,$t)}function kebab(xt){return"-"+xt.toLowerCase()}function camelcase(xt){return xt.charAt(1).toUpperCase()}const hastToReact={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},html$1=merge$6([xml,xlink,xmlns$1,aria$1,html$2],"html"),svg=merge$6([xml,xlink,xmlns$1,aria$1,svg$1],"svg");function parse$d(xt){const $t=String(xt||"").trim();return $t?$t.split(/[ \t\n\r\f]+/g):[]}function stringify$4(xt){return xt.join(" ").trim()}var cjs={},COMMENT_REGEX=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,NEWLINE_REGEX=/\n/g,WHITESPACE_REGEX=/^\s*/,PROPERTY_REGEX=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,COLON_REGEX=/^:\s*/,VALUE_REGEX=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,SEMICOLON_REGEX=/^[;\s]*/,TRIM_REGEX=/^\s+|\s+$/g,NEWLINE$1=`
`,FORWARD_SLASH="/",ASTERISK="*",EMPTY_STRING="",TYPE_COMMENT="comment",TYPE_DECLARATION="declaration",inlineStyleParser=function(xt,$t){if(typeof xt!="string")throw new TypeError("First argument must be a string");if(!xt)return[];$t=$t||{};var Ct=1,kt=1;function Mt(Yt){var Kt=Yt.match(NEWLINE_REGEX);Kt&&(Ct+=Kt.length);var Xt=Yt.lastIndexOf(NEWLINE$1);kt=~Xt?Yt.length-Xt:kt+Yt.length}function Ft(){var Yt={line:Ct,column:kt};return function(Kt){return Kt.position=new jt(Yt),zt(),Kt}}function jt(Yt){this.start=Yt,this.end={line:Ct,column:kt},this.source=$t.source}jt.prototype.content=xt;function Bt(Yt){var Kt=new Error($t.source+":"+Ct+":"+kt+": "+Yt);if(Kt.reason=Yt,Kt.filename=$t.source,Kt.line=Ct,Kt.column=kt,Kt.source=xt,!$t.silent)throw Kt}function Vt(Yt){var Kt=Yt.exec(xt);if(Kt){var Xt=Kt[0];return Mt(Xt),xt=xt.slice(Xt.length),Kt}}function zt(){Vt(WHITESPACE_REGEX)}function Ht(Yt){var Kt;for(Yt=Yt||[];Kt=Gt();)Kt!==!1&&Yt.push(Kt);return Yt}function Gt(){var Yt=Ft();if(!(FORWARD_SLASH!=xt.charAt(0)||ASTERISK!=xt.charAt(1))){for(var Kt=2;EMPTY_STRING!=xt.charAt(Kt)&&(ASTERISK!=xt.charAt(Kt)||FORWARD_SLASH!=xt.charAt(Kt+1));)++Kt;if(Kt+=2,EMPTY_STRING===xt.charAt(Kt-1))return Bt("End of comment missing");var Xt=xt.slice(2,Kt-2);return kt+=2,Mt(Xt),xt=xt.slice(Kt),kt+=2,Yt({type:TYPE_COMMENT,comment:Xt})}}function qt(){var Yt=Ft(),Kt=Vt(PROPERTY_REGEX);if(Kt){if(Gt(),!Vt(COLON_REGEX))return Bt("property missing ':'");var Xt=Vt(VALUE_REGEX),Qt=Yt({type:TYPE_DECLARATION,property:trim$1(Kt[0].replace(COMMENT_REGEX,EMPTY_STRING)),value:Xt?trim$1(Xt[0].replace(COMMENT_REGEX,EMPTY_STRING)):EMPTY_STRING});return Vt(SEMICOLON_REGEX),Qt}}function Wt(){var Yt=[];Ht(Yt);for(var Kt;Kt=qt();)Kt!==!1&&(Yt.push(Kt),Ht(Yt));return Yt}return zt(),Wt()};function trim$1(xt){return xt?xt.replace(TRIM_REGEX,EMPTY_STRING):EMPTY_STRING}var __importDefault=commonjsGlobal$2&&commonjsGlobal$2.__importDefault||function(xt){return xt&&xt.__esModule?xt:{default:xt}};Object.defineProperty(cjs,"__esModule",{value:!0});var inline_style_parser_1=__importDefault(inlineStyleParser);function StyleToObject(xt,$t){var Ct=null;if(!xt||typeof xt!="string")return Ct;var kt=(0,inline_style_parser_1.default)(xt),Mt=typeof $t=="function";return kt.forEach(function(Ft){if(Ft.type==="declaration"){var jt=Ft.property,Bt=Ft.value;Mt?$t(jt,Bt,Ft):Bt&&(Ct=Ct||{},Ct[jt]=Bt)}}),Ct}var _default=cjs.default=StyleToObject;const styleToObject=_default.default||_default,pointEnd=point$b("end"),pointStart=point$b("start");function point$b(xt){return $t;function $t(Ct){const kt=Ct&&Ct.position&&Ct.position[xt]||{};if(typeof kt.line=="number"&&kt.line>0&&typeof kt.column=="number"&&kt.column>0)return{line:kt.line,column:kt.column,offset:typeof kt.offset=="number"&&kt.offset>-1?kt.offset:void 0}}}function position$3(xt){const $t=pointStart(xt),Ct=pointEnd(xt);if($t&&Ct)return{start:$t,end:Ct}}function stringifyPosition(xt){return!xt||typeof xt!="object"?"":"position"in xt||"type"in xt?position$2(xt.position):"start"in xt||"end"in xt?position$2(xt):"line"in xt||"column"in xt?point$a(xt):""}function point$a(xt){return index$2(xt&&xt.line)+":"+index$2(xt&&xt.column)}function position$2(xt){return point$a(xt&&xt.start)+"-"+point$a(xt&&xt.end)}function index$2(xt){return xt&&typeof xt=="number"?xt:1}class VFileMessage extends Error{constructor($t,Ct,kt){super(),typeof Ct=="string"&&(kt=Ct,Ct=void 0);let Mt="",Ft={},jt=!1;if(Ct&&("line"in Ct&&"column"in Ct?Ft={place:Ct}:"start"in Ct&&"end"in Ct?Ft={place:Ct}:"type"in Ct?Ft={ancestors:[Ct],place:Ct.position}:Ft={...Ct}),typeof $t=="string"?Mt=$t:!Ft.cause&&$t&&(jt=!0,Mt=$t.message,Ft.cause=$t),!Ft.ruleId&&!Ft.source&&typeof kt=="string"){const Vt=kt.indexOf(":");Vt===-1?Ft.ruleId=kt:(Ft.source=kt.slice(0,Vt),Ft.ruleId=kt.slice(Vt+1))}if(!Ft.place&&Ft.ancestors&&Ft.ancestors){const Vt=Ft.ancestors[Ft.ancestors.length-1];Vt&&(Ft.place=Vt.position)}const Bt=Ft.place&&"start"in Ft.place?Ft.place.start:Ft.place;this.ancestors=Ft.ancestors||void 0,this.cause=Ft.cause||void 0,this.column=Bt?Bt.column:void 0,this.fatal=void 0,this.file,this.message=Mt,this.line=Bt?Bt.line:void 0,this.name=stringifyPosition(Ft.place)||"1:1",this.place=Ft.place||void 0,this.reason=this.message,this.ruleId=Ft.ruleId||void 0,this.source=Ft.source||void 0,this.stack=jt&&Ft.cause&&typeof Ft.cause.stack=="string"?Ft.cause.stack:"",this.actual,this.expected,this.note,this.url}}VFileMessage.prototype.file="";VFileMessage.prototype.name="";VFileMessage.prototype.reason="";VFileMessage.prototype.message="";VFileMessage.prototype.stack="";VFileMessage.prototype.column=void 0;VFileMessage.prototype.line=void 0;VFileMessage.prototype.ancestors=void 0;VFileMessage.prototype.cause=void 0;VFileMessage.prototype.fatal=void 0;VFileMessage.prototype.place=void 0;VFileMessage.prototype.ruleId=void 0;VFileMessage.prototype.source=void 0;const own$7={}.hasOwnProperty,emptyMap=new Map,cap=/[A-Z]/g,dashSomething=/-([a-z])/g,tableElements=new Set(["table","tbody","thead","tfoot","tr"]),tableCellElement=new Set(["td","th"]),docs="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function toJsxRuntime(xt,$t){if(!$t||$t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const Ct=$t.filePath||void 0;let kt;if($t.development){if(typeof $t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");kt=developmentCreate(Ct,$t.jsxDEV)}else{if(typeof $t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof $t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");kt=productionCreate(Ct,$t.jsx,$t.jsxs)}const Mt={Fragment:$t.Fragment,ancestors:[],components:$t.components||{},create:kt,elementAttributeNameCase:$t.elementAttributeNameCase||"react",evaluater:$t.createEvaluater?$t.createEvaluater():void 0,filePath:Ct,ignoreInvalidStyle:$t.ignoreInvalidStyle||!1,passKeys:$t.passKeys!==!1,passNode:$t.passNode||!1,schema:$t.space==="svg"?svg:html$1,stylePropertyNameCase:$t.stylePropertyNameCase||"dom",tableCellAlignToStyle:$t.tableCellAlignToStyle!==!1},Ft=one$6(Mt,xt,void 0);return Ft&&typeof Ft!="string"?Ft:Mt.create(xt,Mt.Fragment,{children:Ft||void 0},void 0)}function one$6(xt,$t,Ct){if($t.type==="element")return element$6(xt,$t,Ct);if($t.type==="mdxFlowExpression"||$t.type==="mdxTextExpression")return mdxExpression(xt,$t);if($t.type==="mdxJsxFlowElement"||$t.type==="mdxJsxTextElement")return mdxJsxElement(xt,$t,Ct);if($t.type==="mdxjsEsm")return mdxEsm(xt,$t);if($t.type==="root")return root$5(xt,$t,Ct);if($t.type==="text")return text$9(xt,$t)}function element$6(xt,$t,Ct){const kt=xt.schema;let Mt=kt;$t.tagName.toLowerCase()==="svg"&&kt.space==="html"&&(Mt=svg,xt.schema=Mt),xt.ancestors.push($t);const Ft=findComponentFromName(xt,$t.tagName,!1),jt=createElementProps(xt,$t);let Bt=createChildren(xt,$t);return tableElements.has($t.tagName)&&(Bt=Bt.filter(function(Vt){return typeof Vt=="string"?!whitespace(Vt):!0})),addNode(xt,jt,Ft,$t),addChildren(jt,Bt),xt.ancestors.pop(),xt.schema=kt,xt.create($t,Ft,jt,Ct)}function mdxExpression(xt,$t){if($t.data&&$t.data.estree&&xt.evaluater){const kt=$t.data.estree.body[0];return kt.type,xt.evaluater.evaluateExpression(kt.expression)}crashEstree(xt,$t.position)}function mdxEsm(xt,$t){if($t.data&&$t.data.estree&&xt.evaluater)return xt.evaluater.evaluateProgram($t.data.estree);crashEstree(xt,$t.position)}function mdxJsxElement(xt,$t,Ct){const kt=xt.schema;let Mt=kt;$t.name==="svg"&&kt.space==="html"&&(Mt=svg,xt.schema=Mt),xt.ancestors.push($t);const Ft=$t.name===null?xt.Fragment:findComponentFromName(xt,$t.name,!0),jt=createJsxElementProps(xt,$t),Bt=createChildren(xt,$t);return addNode(xt,jt,Ft,$t),addChildren(jt,Bt),xt.ancestors.pop(),xt.schema=kt,xt.create($t,Ft,jt,Ct)}function root$5(xt,$t,Ct){const kt={};return addChildren(kt,createChildren(xt,$t)),xt.create($t,xt.Fragment,kt,Ct)}function text$9(xt,$t){return $t.value}function addNode(xt,$t,Ct,kt){typeof Ct!="string"&&Ct!==xt.Fragment&&xt.passNode&&($t.node=kt)}function addChildren(xt,$t){if($t.length>0){const Ct=$t.length>1?$t:$t[0];Ct&&(xt.children=Ct)}}function productionCreate(xt,$t,Ct){return kt;function kt(Mt,Ft,jt,Bt){const zt=Array.isArray(jt.children)?Ct:$t;return Bt?zt(Ft,jt,Bt):zt(Ft,jt)}}function developmentCreate(xt,$t){return Ct;function Ct(kt,Mt,Ft,jt){const Bt=Array.isArray(Ft.children),Vt=pointStart(kt);return $t(Mt,Ft,jt,Bt,{columnNumber:Vt?Vt.column-1:void 0,fileName:xt,lineNumber:Vt?Vt.line:void 0},void 0)}}function createElementProps(xt,$t){const Ct={};let kt,Mt;for(Mt in $t.properties)if(Mt!=="children"&&own$7.call($t.properties,Mt)){const Ft=createProperty$1(xt,Mt,$t.properties[Mt]);if(Ft){const[jt,Bt]=Ft;xt.tableCellAlignToStyle&&jt==="align"&&typeof Bt=="string"&&tableCellElement.has($t.tagName)?kt=Bt:Ct[jt]=Bt}}if(kt){const Ft=Ct.style||(Ct.style={});Ft[xt.stylePropertyNameCase==="css"?"text-align":"textAlign"]=kt}return Ct}function createJsxElementProps(xt,$t){const Ct={};for(const kt of $t.attributes)if(kt.type==="mdxJsxExpressionAttribute")if(kt.data&&kt.data.estree&&xt.evaluater){const Ft=kt.data.estree.body[0];Ft.type;const jt=Ft.expression;jt.type;const Bt=jt.properties[0];Bt.type,Object.assign(Ct,xt.evaluater.evaluateExpression(Bt.argument))}else crashEstree(xt,$t.position);else{const Mt=kt.name;let Ft;if(kt.value&&typeof kt.value=="object")if(kt.value.data&&kt.value.data.estree&&xt.evaluater){const Bt=kt.value.data.estree.body[0];Bt.type,Ft=xt.evaluater.evaluateExpression(Bt.expression)}else crashEstree(xt,$t.position);else Ft=kt.value===null?!0:kt.value;Ct[Mt]=Ft}return Ct}function createChildren(xt,$t){const Ct=[];let kt=-1;const Mt=xt.passKeys?new Map:emptyMap;for(;++kt<$t.children.length;){const Ft=$t.children[kt];let jt;if(xt.passKeys){const Vt=Ft.type==="element"?Ft.tagName:Ft.type==="mdxJsxFlowElement"||Ft.type==="mdxJsxTextElement"?Ft.name:void 0;if(Vt){const zt=Mt.get(Vt)||0;jt=Vt+"-"+zt,Mt.set(Vt,zt+1)}}const Bt=one$6(xt,Ft,jt);Bt!==void 0&&Ct.push(Bt)}return Ct}function createProperty$1(xt,$t,Ct){const kt=find$6(xt.schema,$t);if(!(Ct==null||typeof Ct=="number"&&Number.isNaN(Ct))){if(Array.isArray(Ct)&&(Ct=kt.commaSeparated?stringify$5(Ct):stringify$4(Ct)),kt.property==="style"){let Mt=typeof Ct=="object"?Ct:parseStyle(xt,String(Ct));return xt.stylePropertyNameCase==="css"&&(Mt=transformStylesToCssCasing(Mt)),["style",Mt]}return[xt.elementAttributeNameCase==="react"&&kt.space?hastToReact[kt.property]||kt.property:kt.attribute,Ct]}}function parseStyle(xt,$t){const Ct={};try{styleToObject($t,kt)}catch(Mt){if(!xt.ignoreInvalidStyle){const Ft=Mt,jt=new VFileMessage("Cannot parse `style` attribute",{ancestors:xt.ancestors,cause:Ft,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw jt.file=xt.filePath||void 0,jt.url=docs+"#cannot-parse-style-attribute",jt}}return Ct;function kt(Mt,Ft){let jt=Mt;jt.slice(0,2)!=="--"&&(jt.slice(0,4)==="-ms-"&&(jt="ms-"+jt.slice(4)),jt=jt.replace(dashSomething,toCamel)),Ct[jt]=Ft}}function findComponentFromName(xt,$t,Ct){let kt;if(!Ct)kt={type:"Literal",value:$t};else if($t.includes(".")){const Mt=$t.split(".");let Ft=-1,jt;for(;++Ft<Mt.length;){const Bt=name$s(Mt[Ft])?{type:"Identifier",name:Mt[Ft]}:{type:"Literal",value:Mt[Ft]};jt=jt?{type:"MemberExpression",object:jt,property:Bt,computed:!!(Ft&&Bt.type==="Literal"),optional:!1}:Bt}kt=jt}else kt=name$s($t)&&!/^[a-z]/.test($t)?{type:"Identifier",name:$t}:{type:"Literal",value:$t};if(kt.type==="Literal"){const Mt=kt.value;return own$7.call(xt.components,Mt)?xt.components[Mt]:Mt}if(xt.evaluater)return xt.evaluater.evaluateExpression(kt);crashEstree(xt)}function crashEstree(xt,$t){const Ct=new VFileMessage("Cannot handle MDX estrees without `createEvaluater`",{ancestors:xt.ancestors,place:$t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw Ct.file=xt.filePath||void 0,Ct.url=docs+"#cannot-handle-mdx-estrees-without-createevaluater",Ct}function transformStylesToCssCasing(xt){const $t={};let Ct;for(Ct in xt)own$7.call(xt,Ct)&&($t[transformStyleToCssCasing(Ct)]=xt[Ct]);return $t}function transformStyleToCssCasing(xt){let $t=xt.replace(cap,toDash);return $t.slice(0,3)==="ms-"&&($t="-"+$t),$t}function toCamel(xt,$t){return $t.toUpperCase()}function toDash(xt){return"-"+xt.toLowerCase()}const urlAttributes={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},emptyOptions$2={};function toString$4(xt,$t){const Ct=emptyOptions$2,kt=typeof Ct.includeImageAlt=="boolean"?Ct.includeImageAlt:!0,Mt=typeof Ct.includeHtml=="boolean"?Ct.includeHtml:!0;return one$5(xt,kt,Mt)}function one$5(xt,$t,Ct){if(node(xt)){if("value"in xt)return xt.type==="html"&&!Ct?"":xt.value;if($t&&"alt"in xt&&xt.alt)return xt.alt;if("children"in xt)return all$4(xt.children,$t,Ct)}return Array.isArray(xt)?all$4(xt,$t,Ct):""}function all$4(xt,$t,Ct){const kt=[];let Mt=-1;for(;++Mt<xt.length;)kt[Mt]=one$5(xt[Mt],$t,Ct);return kt.join("")}function node(xt){return!!(xt&&typeof xt=="object")}const element$5=document.createElement("i");function decodeNamedCharacterReference(xt){const $t="&"+xt+";";element$5.innerHTML=$t;const Ct=element$5.textContent;return Ct.charCodeAt(Ct.length-1)===59&&xt!=="semi"||Ct===$t?!1:Ct}function splice(xt,$t,Ct,kt){const Mt=xt.length;let Ft=0,jt;if($t<0?$t=-$t>Mt?0:Mt+$t:$t=$t>Mt?Mt:$t,Ct=Ct>0?Ct:0,kt.length<1e4)jt=Array.from(kt),jt.unshift($t,Ct),xt.splice(...jt);else for(Ct&&xt.splice($t,Ct);Ft<kt.length;)jt=kt.slice(Ft,Ft+1e4),jt.unshift($t,0),xt.splice(...jt),Ft+=1e4,$t+=1e4}function push$1(xt,$t){return xt.length>0?(splice(xt,xt.length,0,$t),xt):$t}const hasOwnProperty$3={}.hasOwnProperty;function combineExtensions(xt){const $t={};let Ct=-1;for(;++Ct<xt.length;)syntaxExtension($t,xt[Ct]);return $t}function syntaxExtension(xt,$t){let Ct;for(Ct in $t){const Mt=(hasOwnProperty$3.call(xt,Ct)?xt[Ct]:void 0)||(xt[Ct]={}),Ft=$t[Ct];let jt;if(Ft)for(jt in Ft){hasOwnProperty$3.call(Mt,jt)||(Mt[jt]=[]);const Bt=Ft[jt];constructs(Mt[jt],Array.isArray(Bt)?Bt:Bt?[Bt]:[])}}}function constructs(xt,$t){let Ct=-1;const kt=[];for(;++Ct<$t.length;)($t[Ct].add==="after"?xt:kt).push($t[Ct]);splice(xt,0,0,kt)}function decodeNumericCharacterReference(xt,$t){const Ct=Number.parseInt(xt,$t);return Ct<9||Ct===11||Ct>13&&Ct<32||Ct>126&&Ct<160||Ct>55295&&Ct<57344||Ct>64975&&Ct<65008||(Ct&65535)===65535||(Ct&65535)===65534||Ct>1114111?"":String.fromCodePoint(Ct)}function normalizeIdentifier(xt){return xt.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const asciiAlpha=regexCheck(/[A-Za-z]/),asciiAlphanumeric=regexCheck(/[\dA-Za-z]/),asciiAtext=regexCheck(/[#-'*+\--9=?A-Z^-~]/);function asciiControl(xt){return xt!==null&&(xt<32||xt===127)}const asciiDigit=regexCheck(/\d/),asciiHexDigit=regexCheck(/[\dA-Fa-f]/),asciiPunctuation=regexCheck(/[!-/:-@[-`{-~]/);function markdownLineEnding(xt){return xt!==null&&xt<-2}function markdownLineEndingOrSpace(xt){return xt!==null&&(xt<0||xt===32)}function markdownSpace(xt){return xt===-2||xt===-1||xt===32}const unicodePunctuation=regexCheck(new RegExp("\\p{P}|\\p{S}","u")),unicodeWhitespace=regexCheck(/\s/);function regexCheck(xt){return $t;function $t(Ct){return Ct!==null&&Ct>-1&&xt.test(String.fromCharCode(Ct))}}function normalizeUri(xt){const $t=[];let Ct=-1,kt=0,Mt=0;for(;++Ct<xt.length;){const Ft=xt.charCodeAt(Ct);let jt="";if(Ft===37&&asciiAlphanumeric(xt.charCodeAt(Ct+1))&&asciiAlphanumeric(xt.charCodeAt(Ct+2)))Mt=2;else if(Ft<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(Ft))||(jt=String.fromCharCode(Ft));else if(Ft>55295&&Ft<57344){const Bt=xt.charCodeAt(Ct+1);Ft<56320&&Bt>56319&&Bt<57344?(jt=String.fromCharCode(Ft,Bt),Mt=1):jt=""}else jt=String.fromCharCode(Ft);jt&&($t.push(xt.slice(kt,Ct),encodeURIComponent(jt)),kt=Ct+Mt+1,jt=""),Mt&&(Ct+=Mt,Mt=0)}return $t.join("")+xt.slice(kt)}function factorySpace(xt,$t,Ct,kt){const Mt=kt?kt-1:Number.POSITIVE_INFINITY;let Ft=0;return jt;function jt(Vt){return markdownSpace(Vt)?(xt.enter(Ct),Bt(Vt)):$t(Vt)}function Bt(Vt){return markdownSpace(Vt)&&Ft++<Mt?(xt.consume(Vt),Bt):(xt.exit(Ct),$t(Vt))}}const content$2={tokenize:initializeContent};function initializeContent(xt){const $t=xt.attempt(this.parser.constructs.contentInitial,kt,Mt);let Ct;return $t;function kt(Bt){if(Bt===null){xt.consume(Bt);return}return xt.enter("lineEnding"),xt.consume(Bt),xt.exit("lineEnding"),factorySpace(xt,$t,"linePrefix")}function Mt(Bt){return xt.enter("paragraph"),Ft(Bt)}function Ft(Bt){const Vt=xt.enter("chunkText",{contentType:"text",previous:Ct});return Ct&&(Ct.next=Vt),Ct=Vt,jt(Bt)}function jt(Bt){if(Bt===null){xt.exit("chunkText"),xt.exit("paragraph"),xt.consume(Bt);return}return markdownLineEnding(Bt)?(xt.consume(Bt),xt.exit("chunkText"),Ft):(xt.consume(Bt),jt)}}const document$2={tokenize:initializeDocument},containerConstruct={tokenize:tokenizeContainer};function initializeDocument(xt){const $t=this,Ct=[];let kt=0,Mt,Ft,jt;return Bt;function Bt(Zt){if(kt<Ct.length){const sn=Ct[kt];return $t.containerState=sn[1],xt.attempt(sn[0].continuation,Vt,zt)(Zt)}return zt(Zt)}function Vt(Zt){if(kt++,$t.containerState._closeFlow){$t.containerState._closeFlow=void 0,Mt&&Jt();const sn=$t.events.length;let ln=sn,dn;for(;ln--;)if($t.events[ln][0]==="exit"&&$t.events[ln][1].type==="chunkFlow"){dn=$t.events[ln][1].end;break}Qt(kt);let hn=sn;for(;hn<$t.events.length;)$t.events[hn][1].end=Object.assign({},dn),hn++;return splice($t.events,ln+1,0,$t.events.slice(sn)),$t.events.length=hn,zt(Zt)}return Bt(Zt)}function zt(Zt){if(kt===Ct.length){if(!Mt)return qt(Zt);if(Mt.currentConstruct&&Mt.currentConstruct.concrete)return Yt(Zt);$t.interrupt=!!(Mt.currentConstruct&&!Mt._gfmTableDynamicInterruptHack)}return $t.containerState={},xt.check(containerConstruct,Ht,Gt)(Zt)}function Ht(Zt){return Mt&&Jt(),Qt(kt),qt(Zt)}function Gt(Zt){return $t.parser.lazy[$t.now().line]=kt!==Ct.length,jt=$t.now().offset,Yt(Zt)}function qt(Zt){return $t.containerState={},xt.attempt(containerConstruct,Wt,Yt)(Zt)}function Wt(Zt){return kt++,Ct.push([$t.currentConstruct,$t.containerState]),qt(Zt)}function Yt(Zt){if(Zt===null){Mt&&Jt(),Qt(0),xt.consume(Zt);return}return Mt=Mt||$t.parser.flow($t.now()),xt.enter("chunkFlow",{contentType:"flow",previous:Ft,_tokenizer:Mt}),Kt(Zt)}function Kt(Zt){if(Zt===null){Xt(xt.exit("chunkFlow"),!0),Qt(0),xt.consume(Zt);return}return markdownLineEnding(Zt)?(xt.consume(Zt),Xt(xt.exit("chunkFlow")),kt=0,$t.interrupt=void 0,Bt):(xt.consume(Zt),Kt)}function Xt(Zt,sn){const ln=$t.sliceStream(Zt);if(sn&&ln.push(null),Zt.previous=Ft,Ft&&(Ft.next=Zt),Ft=Zt,Mt.defineSkip(Zt.start),Mt.write(ln),$t.parser.lazy[Zt.start.line]){let dn=Mt.events.length;for(;dn--;)if(Mt.events[dn][1].start.offset<jt&&(!Mt.events[dn][1].end||Mt.events[dn][1].end.offset>jt))return;const hn=$t.events.length;let cn=hn,pn,yn;for(;cn--;)if($t.events[cn][0]==="exit"&&$t.events[cn][1].type==="chunkFlow"){if(pn){yn=$t.events[cn][1].end;break}pn=!0}for(Qt(kt),dn=hn;dn<$t.events.length;)$t.events[dn][1].end=Object.assign({},yn),dn++;splice($t.events,cn+1,0,$t.events.slice(hn)),$t.events.length=dn}}function Qt(Zt){let sn=Ct.length;for(;sn-- >Zt;){const ln=Ct[sn];$t.containerState=ln[1],ln[0].exit.call($t,xt)}Ct.length=Zt}function Jt(){Mt.write([null]),Ft=void 0,Mt=void 0,$t.containerState._closeFlow=void 0}}function tokenizeContainer(xt,$t,Ct){return factorySpace(xt,xt.attempt(this.parser.constructs.document,$t,Ct),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function classifyCharacter(xt){if(xt===null||markdownLineEndingOrSpace(xt)||unicodeWhitespace(xt))return 1;if(unicodePunctuation(xt))return 2}function resolveAll(xt,$t,Ct){const kt=[];let Mt=-1;for(;++Mt<xt.length;){const Ft=xt[Mt].resolveAll;Ft&&!kt.includes(Ft)&&($t=Ft($t,Ct),kt.push(Ft))}return $t}const attention={name:"attention",tokenize:tokenizeAttention,resolveAll:resolveAllAttention};function resolveAllAttention(xt,$t){let Ct=-1,kt,Mt,Ft,jt,Bt,Vt,zt,Ht;for(;++Ct<xt.length;)if(xt[Ct][0]==="enter"&&xt[Ct][1].type==="attentionSequence"&&xt[Ct][1]._close){for(kt=Ct;kt--;)if(xt[kt][0]==="exit"&&xt[kt][1].type==="attentionSequence"&&xt[kt][1]._open&&$t.sliceSerialize(xt[kt][1]).charCodeAt(0)===$t.sliceSerialize(xt[Ct][1]).charCodeAt(0)){if((xt[kt][1]._close||xt[Ct][1]._open)&&(xt[Ct][1].end.offset-xt[Ct][1].start.offset)%3&&!((xt[kt][1].end.offset-xt[kt][1].start.offset+xt[Ct][1].end.offset-xt[Ct][1].start.offset)%3))continue;Vt=xt[kt][1].end.offset-xt[kt][1].start.offset>1&&xt[Ct][1].end.offset-xt[Ct][1].start.offset>1?2:1;const Gt=Object.assign({},xt[kt][1].end),qt=Object.assign({},xt[Ct][1].start);movePoint(Gt,-Vt),movePoint(qt,Vt),jt={type:Vt>1?"strongSequence":"emphasisSequence",start:Gt,end:Object.assign({},xt[kt][1].end)},Bt={type:Vt>1?"strongSequence":"emphasisSequence",start:Object.assign({},xt[Ct][1].start),end:qt},Ft={type:Vt>1?"strongText":"emphasisText",start:Object.assign({},xt[kt][1].end),end:Object.assign({},xt[Ct][1].start)},Mt={type:Vt>1?"strong":"emphasis",start:Object.assign({},jt.start),end:Object.assign({},Bt.end)},xt[kt][1].end=Object.assign({},jt.start),xt[Ct][1].start=Object.assign({},Bt.end),zt=[],xt[kt][1].end.offset-xt[kt][1].start.offset&&(zt=push$1(zt,[["enter",xt[kt][1],$t],["exit",xt[kt][1],$t]])),zt=push$1(zt,[["enter",Mt,$t],["enter",jt,$t],["exit",jt,$t],["enter",Ft,$t]]),zt=push$1(zt,resolveAll($t.parser.constructs.insideSpan.null,xt.slice(kt+1,Ct),$t)),zt=push$1(zt,[["exit",Ft,$t],["enter",Bt,$t],["exit",Bt,$t],["exit",Mt,$t]]),xt[Ct][1].end.offset-xt[Ct][1].start.offset?(Ht=2,zt=push$1(zt,[["enter",xt[Ct][1],$t],["exit",xt[Ct][1],$t]])):Ht=0,splice(xt,kt-1,Ct-kt+3,zt),Ct=kt+zt.length-Ht-2;break}}for(Ct=-1;++Ct<xt.length;)xt[Ct][1].type==="attentionSequence"&&(xt[Ct][1].type="data");return xt}function tokenizeAttention(xt,$t){const Ct=this.parser.constructs.attentionMarkers.null,kt=this.previous,Mt=classifyCharacter(kt);let Ft;return jt;function jt(Vt){return Ft=Vt,xt.enter("attentionSequence"),Bt(Vt)}function Bt(Vt){if(Vt===Ft)return xt.consume(Vt),Bt;const zt=xt.exit("attentionSequence"),Ht=classifyCharacter(Vt),Gt=!Ht||Ht===2&&Mt||Ct.includes(Vt),qt=!Mt||Mt===2&&Ht||Ct.includes(kt);return zt._open=!!(Ft===42?Gt:Gt&&(Mt||!qt)),zt._close=!!(Ft===42?qt:qt&&(Ht||!Gt)),$t(Vt)}}function movePoint(xt,$t){xt.column+=$t,xt.offset+=$t,xt._bufferIndex+=$t}const autolink={name:"autolink",tokenize:tokenizeAutolink};function tokenizeAutolink(xt,$t,Ct){let kt=0;return Mt;function Mt(Wt){return xt.enter("autolink"),xt.enter("autolinkMarker"),xt.consume(Wt),xt.exit("autolinkMarker"),xt.enter("autolinkProtocol"),Ft}function Ft(Wt){return asciiAlpha(Wt)?(xt.consume(Wt),jt):Wt===64?Ct(Wt):zt(Wt)}function jt(Wt){return Wt===43||Wt===45||Wt===46||asciiAlphanumeric(Wt)?(kt=1,Bt(Wt)):zt(Wt)}function Bt(Wt){return Wt===58?(xt.consume(Wt),kt=0,Vt):(Wt===43||Wt===45||Wt===46||asciiAlphanumeric(Wt))&&kt++<32?(xt.consume(Wt),Bt):(kt=0,zt(Wt))}function Vt(Wt){return Wt===62?(xt.exit("autolinkProtocol"),xt.enter("autolinkMarker"),xt.consume(Wt),xt.exit("autolinkMarker"),xt.exit("autolink"),$t):Wt===null||Wt===32||Wt===60||asciiControl(Wt)?Ct(Wt):(xt.consume(Wt),Vt)}function zt(Wt){return Wt===64?(xt.consume(Wt),Ht):asciiAtext(Wt)?(xt.consume(Wt),zt):Ct(Wt)}function Ht(Wt){return asciiAlphanumeric(Wt)?Gt(Wt):Ct(Wt)}function Gt(Wt){return Wt===46?(xt.consume(Wt),kt=0,Ht):Wt===62?(xt.exit("autolinkProtocol").type="autolinkEmail",xt.enter("autolinkMarker"),xt.consume(Wt),xt.exit("autolinkMarker"),xt.exit("autolink"),$t):qt(Wt)}function qt(Wt){if((Wt===45||asciiAlphanumeric(Wt))&&kt++<63){const Yt=Wt===45?qt:Gt;return xt.consume(Wt),Yt}return Ct(Wt)}}const blankLine={tokenize:tokenizeBlankLine,partial:!0};function tokenizeBlankLine(xt,$t,Ct){return kt;function kt(Ft){return markdownSpace(Ft)?factorySpace(xt,Mt,"linePrefix")(Ft):Mt(Ft)}function Mt(Ft){return Ft===null||markdownLineEnding(Ft)?$t(Ft):Ct(Ft)}}const blockQuote={name:"blockQuote",tokenize:tokenizeBlockQuoteStart,continuation:{tokenize:tokenizeBlockQuoteContinuation},exit};function tokenizeBlockQuoteStart(xt,$t,Ct){const kt=this;return Mt;function Mt(jt){if(jt===62){const Bt=kt.containerState;return Bt.open||(xt.enter("blockQuote",{_container:!0}),Bt.open=!0),xt.enter("blockQuotePrefix"),xt.enter("blockQuoteMarker"),xt.consume(jt),xt.exit("blockQuoteMarker"),Ft}return Ct(jt)}function Ft(jt){return markdownSpace(jt)?(xt.enter("blockQuotePrefixWhitespace"),xt.consume(jt),xt.exit("blockQuotePrefixWhitespace"),xt.exit("blockQuotePrefix"),$t):(xt.exit("blockQuotePrefix"),$t(jt))}}function tokenizeBlockQuoteContinuation(xt,$t,Ct){const kt=this;return Mt;function Mt(jt){return markdownSpace(jt)?factorySpace(xt,Ft,"linePrefix",kt.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(jt):Ft(jt)}function Ft(jt){return xt.attempt(blockQuote,$t,Ct)(jt)}}function exit(xt){xt.exit("blockQuote")}const characterEscape={name:"characterEscape",tokenize:tokenizeCharacterEscape};function tokenizeCharacterEscape(xt,$t,Ct){return kt;function kt(Ft){return xt.enter("characterEscape"),xt.enter("escapeMarker"),xt.consume(Ft),xt.exit("escapeMarker"),Mt}function Mt(Ft){return asciiPunctuation(Ft)?(xt.enter("characterEscapeValue"),xt.consume(Ft),xt.exit("characterEscapeValue"),xt.exit("characterEscape"),$t):Ct(Ft)}}const characterReference={name:"characterReference",tokenize:tokenizeCharacterReference};function tokenizeCharacterReference(xt,$t,Ct){const kt=this;let Mt=0,Ft,jt;return Bt;function Bt(Gt){return xt.enter("characterReference"),xt.enter("characterReferenceMarker"),xt.consume(Gt),xt.exit("characterReferenceMarker"),Vt}function Vt(Gt){return Gt===35?(xt.enter("characterReferenceMarkerNumeric"),xt.consume(Gt),xt.exit("characterReferenceMarkerNumeric"),zt):(xt.enter("characterReferenceValue"),Ft=31,jt=asciiAlphanumeric,Ht(Gt))}function zt(Gt){return Gt===88||Gt===120?(xt.enter("characterReferenceMarkerHexadecimal"),xt.consume(Gt),xt.exit("characterReferenceMarkerHexadecimal"),xt.enter("characterReferenceValue"),Ft=6,jt=asciiHexDigit,Ht):(xt.enter("characterReferenceValue"),Ft=7,jt=asciiDigit,Ht(Gt))}function Ht(Gt){if(Gt===59&&Mt){const qt=xt.exit("characterReferenceValue");return jt===asciiAlphanumeric&&!decodeNamedCharacterReference(kt.sliceSerialize(qt))?Ct(Gt):(xt.enter("characterReferenceMarker"),xt.consume(Gt),xt.exit("characterReferenceMarker"),xt.exit("characterReference"),$t)}return jt(Gt)&&Mt++<Ft?(xt.consume(Gt),Ht):Ct(Gt)}}const nonLazyContinuation={tokenize:tokenizeNonLazyContinuation,partial:!0},codeFenced={name:"codeFenced",tokenize:tokenizeCodeFenced,concrete:!0};function tokenizeCodeFenced(xt,$t,Ct){const kt=this,Mt={tokenize:ln,partial:!0};let Ft=0,jt=0,Bt;return Vt;function Vt(dn){return zt(dn)}function zt(dn){const hn=kt.events[kt.events.length-1];return Ft=hn&&hn[1].type==="linePrefix"?hn[2].sliceSerialize(hn[1],!0).length:0,Bt=dn,xt.enter("codeFenced"),xt.enter("codeFencedFence"),xt.enter("codeFencedFenceSequence"),Ht(dn)}function Ht(dn){return dn===Bt?(jt++,xt.consume(dn),Ht):jt<3?Ct(dn):(xt.exit("codeFencedFenceSequence"),markdownSpace(dn)?factorySpace(xt,Gt,"whitespace")(dn):Gt(dn))}function Gt(dn){return dn===null||markdownLineEnding(dn)?(xt.exit("codeFencedFence"),kt.interrupt?$t(dn):xt.check(nonLazyContinuation,Kt,sn)(dn)):(xt.enter("codeFencedFenceInfo"),xt.enter("chunkString",{contentType:"string"}),qt(dn))}function qt(dn){return dn===null||markdownLineEnding(dn)?(xt.exit("chunkString"),xt.exit("codeFencedFenceInfo"),Gt(dn)):markdownSpace(dn)?(xt.exit("chunkString"),xt.exit("codeFencedFenceInfo"),factorySpace(xt,Wt,"whitespace")(dn)):dn===96&&dn===Bt?Ct(dn):(xt.consume(dn),qt)}function Wt(dn){return dn===null||markdownLineEnding(dn)?Gt(dn):(xt.enter("codeFencedFenceMeta"),xt.enter("chunkString",{contentType:"string"}),Yt(dn))}function Yt(dn){return dn===null||markdownLineEnding(dn)?(xt.exit("chunkString"),xt.exit("codeFencedFenceMeta"),Gt(dn)):dn===96&&dn===Bt?Ct(dn):(xt.consume(dn),Yt)}function Kt(dn){return xt.attempt(Mt,sn,Xt)(dn)}function Xt(dn){return xt.enter("lineEnding"),xt.consume(dn),xt.exit("lineEnding"),Qt}function Qt(dn){return Ft>0&&markdownSpace(dn)?factorySpace(xt,Jt,"linePrefix",Ft+1)(dn):Jt(dn)}function Jt(dn){return dn===null||markdownLineEnding(dn)?xt.check(nonLazyContinuation,Kt,sn)(dn):(xt.enter("codeFlowValue"),Zt(dn))}function Zt(dn){return dn===null||markdownLineEnding(dn)?(xt.exit("codeFlowValue"),Jt(dn)):(xt.consume(dn),Zt)}function sn(dn){return xt.exit("codeFenced"),$t(dn)}function ln(dn,hn,cn){let pn=0;return yn;function yn(Cn){return dn.enter("lineEnding"),dn.consume(Cn),dn.exit("lineEnding"),gn}function gn(Cn){return dn.enter("codeFencedFence"),markdownSpace(Cn)?factorySpace(dn,En,"linePrefix",kt.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(Cn):En(Cn)}function En(Cn){return Cn===Bt?(dn.enter("codeFencedFenceSequence"),bn(Cn)):cn(Cn)}function bn(Cn){return Cn===Bt?(pn++,dn.consume(Cn),bn):pn>=jt?(dn.exit("codeFencedFenceSequence"),markdownSpace(Cn)?factorySpace(dn,xn,"whitespace")(Cn):xn(Cn)):cn(Cn)}function xn(Cn){return Cn===null||markdownLineEnding(Cn)?(dn.exit("codeFencedFence"),hn(Cn)):cn(Cn)}}}function tokenizeNonLazyContinuation(xt,$t,Ct){const kt=this;return Mt;function Mt(jt){return jt===null?Ct(jt):(xt.enter("lineEnding"),xt.consume(jt),xt.exit("lineEnding"),Ft)}function Ft(jt){return kt.parser.lazy[kt.now().line]?Ct(jt):$t(jt)}}const codeIndented={name:"codeIndented",tokenize:tokenizeCodeIndented},furtherStart={tokenize:tokenizeFurtherStart,partial:!0};function tokenizeCodeIndented(xt,$t,Ct){const kt=this;return Mt;function Mt(zt){return xt.enter("codeIndented"),factorySpace(xt,Ft,"linePrefix",5)(zt)}function Ft(zt){const Ht=kt.events[kt.events.length-1];return Ht&&Ht[1].type==="linePrefix"&&Ht[2].sliceSerialize(Ht[1],!0).length>=4?jt(zt):Ct(zt)}function jt(zt){return zt===null?Vt(zt):markdownLineEnding(zt)?xt.attempt(furtherStart,jt,Vt)(zt):(xt.enter("codeFlowValue"),Bt(zt))}function Bt(zt){return zt===null||markdownLineEnding(zt)?(xt.exit("codeFlowValue"),jt(zt)):(xt.consume(zt),Bt)}function Vt(zt){return xt.exit("codeIndented"),$t(zt)}}function tokenizeFurtherStart(xt,$t,Ct){const kt=this;return Mt;function Mt(jt){return kt.parser.lazy[kt.now().line]?Ct(jt):markdownLineEnding(jt)?(xt.enter("lineEnding"),xt.consume(jt),xt.exit("lineEnding"),Mt):factorySpace(xt,Ft,"linePrefix",5)(jt)}function Ft(jt){const Bt=kt.events[kt.events.length-1];return Bt&&Bt[1].type==="linePrefix"&&Bt[2].sliceSerialize(Bt[1],!0).length>=4?$t(jt):markdownLineEnding(jt)?Mt(jt):Ct(jt)}}const codeText={name:"codeText",tokenize:tokenizeCodeText,resolve:resolveCodeText,previous};function resolveCodeText(xt){let $t=xt.length-4,Ct=3,kt,Mt;if((xt[Ct][1].type==="lineEnding"||xt[Ct][1].type==="space")&&(xt[$t][1].type==="lineEnding"||xt[$t][1].type==="space")){for(kt=Ct;++kt<$t;)if(xt[kt][1].type==="codeTextData"){xt[Ct][1].type="codeTextPadding",xt[$t][1].type="codeTextPadding",Ct+=2,$t-=2;break}}for(kt=Ct-1,$t++;++kt<=$t;)Mt===void 0?kt!==$t&&xt[kt][1].type!=="lineEnding"&&(Mt=kt):(kt===$t||xt[kt][1].type==="lineEnding")&&(xt[Mt][1].type="codeTextData",kt!==Mt+2&&(xt[Mt][1].end=xt[kt-1][1].end,xt.splice(Mt+2,kt-Mt-2),$t-=kt-Mt-2,kt=Mt+2),Mt=void 0);return xt}function previous(xt){return xt!==96||this.events[this.events.length-1][1].type==="characterEscape"}function tokenizeCodeText(xt,$t,Ct){let kt=0,Mt,Ft;return jt;function jt(Gt){return xt.enter("codeText"),xt.enter("codeTextSequence"),Bt(Gt)}function Bt(Gt){return Gt===96?(xt.consume(Gt),kt++,Bt):(xt.exit("codeTextSequence"),Vt(Gt))}function Vt(Gt){return Gt===null?Ct(Gt):Gt===32?(xt.enter("space"),xt.consume(Gt),xt.exit("space"),Vt):Gt===96?(Ft=xt.enter("codeTextSequence"),Mt=0,Ht(Gt)):markdownLineEnding(Gt)?(xt.enter("lineEnding"),xt.consume(Gt),xt.exit("lineEnding"),Vt):(xt.enter("codeTextData"),zt(Gt))}function zt(Gt){return Gt===null||Gt===32||Gt===96||markdownLineEnding(Gt)?(xt.exit("codeTextData"),Vt(Gt)):(xt.consume(Gt),zt)}function Ht(Gt){return Gt===96?(xt.consume(Gt),Mt++,Ht):Mt===kt?(xt.exit("codeTextSequence"),xt.exit("codeText"),$t(Gt)):(Ft.type="codeTextData",zt(Gt))}}class SpliceBuffer{constructor($t){this.left=$t?[...$t]:[],this.right=[]}get($t){if($t<0||$t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+$t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return $t<this.left.length?this.left[$t]:this.right[this.right.length-$t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice($t,Ct){const kt=Ct??Number.POSITIVE_INFINITY;return kt<this.left.length?this.left.slice($t,kt):$t>this.left.length?this.right.slice(this.right.length-kt+this.left.length,this.right.length-$t+this.left.length).reverse():this.left.slice($t).concat(this.right.slice(this.right.length-kt+this.left.length).reverse())}splice($t,Ct,kt){const Mt=Ct||0;this.setCursor(Math.trunc($t));const Ft=this.right.splice(this.right.length-Mt,Number.POSITIVE_INFINITY);return kt&&chunkedPush(this.left,kt),Ft.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push($t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push($t)}pushMany($t){this.setCursor(Number.POSITIVE_INFINITY),chunkedPush(this.left,$t)}unshift($t){this.setCursor(0),this.right.push($t)}unshiftMany($t){this.setCursor(0),chunkedPush(this.right,$t.reverse())}setCursor($t){if(!($t===this.left.length||$t>this.left.length&&this.right.length===0||$t<0&&this.left.length===0))if($t<this.left.length){const Ct=this.left.splice($t,Number.POSITIVE_INFINITY);chunkedPush(this.right,Ct.reverse())}else{const Ct=this.right.splice(this.left.length+this.right.length-$t,Number.POSITIVE_INFINITY);chunkedPush(this.left,Ct.reverse())}}}function chunkedPush(xt,$t){let Ct=0;if($t.length<1e4)xt.push(...$t);else for(;Ct<$t.length;)xt.push(...$t.slice(Ct,Ct+1e4)),Ct+=1e4}function subtokenize(xt){const $t={};let Ct=-1,kt,Mt,Ft,jt,Bt,Vt,zt;const Ht=new SpliceBuffer(xt);for(;++Ct<Ht.length;){for(;Ct in $t;)Ct=$t[Ct];if(kt=Ht.get(Ct),Ct&&kt[1].type==="chunkFlow"&&Ht.get(Ct-1)[1].type==="listItemPrefix"&&(Vt=kt[1]._tokenizer.events,Ft=0,Ft<Vt.length&&Vt[Ft][1].type==="lineEndingBlank"&&(Ft+=2),Ft<Vt.length&&Vt[Ft][1].type==="content"))for(;++Ft<Vt.length&&Vt[Ft][1].type!=="content";)Vt[Ft][1].type==="chunkText"&&(Vt[Ft][1]._isInFirstContentOfListItem=!0,Ft++);if(kt[0]==="enter")kt[1].contentType&&(Object.assign($t,subcontent(Ht,Ct)),Ct=$t[Ct],zt=!0);else if(kt[1]._container){for(Ft=Ct,Mt=void 0;Ft--&&(jt=Ht.get(Ft),jt[1].type==="lineEnding"||jt[1].type==="lineEndingBlank");)jt[0]==="enter"&&(Mt&&(Ht.get(Mt)[1].type="lineEndingBlank"),jt[1].type="lineEnding",Mt=Ft);Mt&&(kt[1].end=Object.assign({},Ht.get(Mt)[1].start),Bt=Ht.slice(Mt,Ct),Bt.unshift(kt),Ht.splice(Mt,Ct-Mt+1,Bt))}}return splice(xt,0,Number.POSITIVE_INFINITY,Ht.slice(0)),!zt}function subcontent(xt,$t){const Ct=xt.get($t)[1],kt=xt.get($t)[2];let Mt=$t-1;const Ft=[],jt=Ct._tokenizer||kt.parser[Ct.contentType](Ct.start),Bt=jt.events,Vt=[],zt={};let Ht,Gt,qt=-1,Wt=Ct,Yt=0,Kt=0;const Xt=[Kt];for(;Wt;){for(;xt.get(++Mt)[1]!==Wt;);Ft.push(Mt),Wt._tokenizer||(Ht=kt.sliceStream(Wt),Wt.next||Ht.push(null),Gt&&jt.defineSkip(Wt.start),Wt._isInFirstContentOfListItem&&(jt._gfmTasklistFirstContentOfListItem=!0),jt.write(Ht),Wt._isInFirstContentOfListItem&&(jt._gfmTasklistFirstContentOfListItem=void 0)),Gt=Wt,Wt=Wt.next}for(Wt=Ct;++qt<Bt.length;)Bt[qt][0]==="exit"&&Bt[qt-1][0]==="enter"&&Bt[qt][1].type===Bt[qt-1][1].type&&Bt[qt][1].start.line!==Bt[qt][1].end.line&&(Kt=qt+1,Xt.push(Kt),Wt._tokenizer=void 0,Wt.previous=void 0,Wt=Wt.next);for(jt.events=[],Wt?(Wt._tokenizer=void 0,Wt.previous=void 0):Xt.pop(),qt=Xt.length;qt--;){const Qt=Bt.slice(Xt[qt],Xt[qt+1]),Jt=Ft.pop();Vt.push([Jt,Jt+Qt.length-1]),xt.splice(Jt,2,Qt)}for(Vt.reverse(),qt=-1;++qt<Vt.length;)zt[Yt+Vt[qt][0]]=Yt+Vt[qt][1],Yt+=Vt[qt][1]-Vt[qt][0]-1;return zt}const content$1={tokenize:tokenizeContent,resolve:resolveContent},continuationConstruct={tokenize:tokenizeContinuation,partial:!0};function resolveContent(xt){return subtokenize(xt),xt}function tokenizeContent(xt,$t){let Ct;return kt;function kt(Bt){return xt.enter("content"),Ct=xt.enter("chunkContent",{contentType:"content"}),Mt(Bt)}function Mt(Bt){return Bt===null?Ft(Bt):markdownLineEnding(Bt)?xt.check(continuationConstruct,jt,Ft)(Bt):(xt.consume(Bt),Mt)}function Ft(Bt){return xt.exit("chunkContent"),xt.exit("content"),$t(Bt)}function jt(Bt){return xt.consume(Bt),xt.exit("chunkContent"),Ct.next=xt.enter("chunkContent",{contentType:"content",previous:Ct}),Ct=Ct.next,Mt}}function tokenizeContinuation(xt,$t,Ct){const kt=this;return Mt;function Mt(jt){return xt.exit("chunkContent"),xt.enter("lineEnding"),xt.consume(jt),xt.exit("lineEnding"),factorySpace(xt,Ft,"linePrefix")}function Ft(jt){if(jt===null||markdownLineEnding(jt))return Ct(jt);const Bt=kt.events[kt.events.length-1];return!kt.parser.constructs.disable.null.includes("codeIndented")&&Bt&&Bt[1].type==="linePrefix"&&Bt[2].sliceSerialize(Bt[1],!0).length>=4?$t(jt):xt.interrupt(kt.parser.constructs.flow,Ct,$t)(jt)}}function factoryDestination(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt){const zt=Vt||Number.POSITIVE_INFINITY;let Ht=0;return Gt;function Gt(Qt){return Qt===60?(xt.enter(kt),xt.enter(Mt),xt.enter(Ft),xt.consume(Qt),xt.exit(Ft),qt):Qt===null||Qt===32||Qt===41||asciiControl(Qt)?Ct(Qt):(xt.enter(kt),xt.enter(jt),xt.enter(Bt),xt.enter("chunkString",{contentType:"string"}),Kt(Qt))}function qt(Qt){return Qt===62?(xt.enter(Ft),xt.consume(Qt),xt.exit(Ft),xt.exit(Mt),xt.exit(kt),$t):(xt.enter(Bt),xt.enter("chunkString",{contentType:"string"}),Wt(Qt))}function Wt(Qt){return Qt===62?(xt.exit("chunkString"),xt.exit(Bt),qt(Qt)):Qt===null||Qt===60||markdownLineEnding(Qt)?Ct(Qt):(xt.consume(Qt),Qt===92?Yt:Wt)}function Yt(Qt){return Qt===60||Qt===62||Qt===92?(xt.consume(Qt),Wt):Wt(Qt)}function Kt(Qt){return!Ht&&(Qt===null||Qt===41||markdownLineEndingOrSpace(Qt))?(xt.exit("chunkString"),xt.exit(Bt),xt.exit(jt),xt.exit(kt),$t(Qt)):Ht<zt&&Qt===40?(xt.consume(Qt),Ht++,Kt):Qt===41?(xt.consume(Qt),Ht--,Kt):Qt===null||Qt===32||Qt===40||asciiControl(Qt)?Ct(Qt):(xt.consume(Qt),Qt===92?Xt:Kt)}function Xt(Qt){return Qt===40||Qt===41||Qt===92?(xt.consume(Qt),Kt):Kt(Qt)}}function factoryLabel(xt,$t,Ct,kt,Mt,Ft){const jt=this;let Bt=0,Vt;return zt;function zt(Wt){return xt.enter(kt),xt.enter(Mt),xt.consume(Wt),xt.exit(Mt),xt.enter(Ft),Ht}function Ht(Wt){return Bt>999||Wt===null||Wt===91||Wt===93&&!Vt||Wt===94&&!Bt&&"_hiddenFootnoteSupport"in jt.parser.constructs?Ct(Wt):Wt===93?(xt.exit(Ft),xt.enter(Mt),xt.consume(Wt),xt.exit(Mt),xt.exit(kt),$t):markdownLineEnding(Wt)?(xt.enter("lineEnding"),xt.consume(Wt),xt.exit("lineEnding"),Ht):(xt.enter("chunkString",{contentType:"string"}),Gt(Wt))}function Gt(Wt){return Wt===null||Wt===91||Wt===93||markdownLineEnding(Wt)||Bt++>999?(xt.exit("chunkString"),Ht(Wt)):(xt.consume(Wt),Vt||(Vt=!markdownSpace(Wt)),Wt===92?qt:Gt)}function qt(Wt){return Wt===91||Wt===92||Wt===93?(xt.consume(Wt),Bt++,Gt):Gt(Wt)}}function factoryTitle(xt,$t,Ct,kt,Mt,Ft){let jt;return Bt;function Bt(qt){return qt===34||qt===39||qt===40?(xt.enter(kt),xt.enter(Mt),xt.consume(qt),xt.exit(Mt),jt=qt===40?41:qt,Vt):Ct(qt)}function Vt(qt){return qt===jt?(xt.enter(Mt),xt.consume(qt),xt.exit(Mt),xt.exit(kt),$t):(xt.enter(Ft),zt(qt))}function zt(qt){return qt===jt?(xt.exit(Ft),Vt(jt)):qt===null?Ct(qt):markdownLineEnding(qt)?(xt.enter("lineEnding"),xt.consume(qt),xt.exit("lineEnding"),factorySpace(xt,zt,"linePrefix")):(xt.enter("chunkString",{contentType:"string"}),Ht(qt))}function Ht(qt){return qt===jt||qt===null||markdownLineEnding(qt)?(xt.exit("chunkString"),zt(qt)):(xt.consume(qt),qt===92?Gt:Ht)}function Gt(qt){return qt===jt||qt===92?(xt.consume(qt),Ht):Ht(qt)}}function factoryWhitespace(xt,$t){let Ct;return kt;function kt(Mt){return markdownLineEnding(Mt)?(xt.enter("lineEnding"),xt.consume(Mt),xt.exit("lineEnding"),Ct=!0,kt):markdownSpace(Mt)?factorySpace(xt,kt,Ct?"linePrefix":"lineSuffix")(Mt):$t(Mt)}}const definition$2={name:"definition",tokenize:tokenizeDefinition},titleBefore={tokenize:tokenizeTitleBefore,partial:!0};function tokenizeDefinition(xt,$t,Ct){const kt=this;let Mt;return Ft;function Ft(Wt){return xt.enter("definition"),jt(Wt)}function jt(Wt){return factoryLabel.call(kt,xt,Bt,Ct,"definitionLabel","definitionLabelMarker","definitionLabelString")(Wt)}function Bt(Wt){return Mt=normalizeIdentifier(kt.sliceSerialize(kt.events[kt.events.length-1][1]).slice(1,-1)),Wt===58?(xt.enter("definitionMarker"),xt.consume(Wt),xt.exit("definitionMarker"),Vt):Ct(Wt)}function Vt(Wt){return markdownLineEndingOrSpace(Wt)?factoryWhitespace(xt,zt)(Wt):zt(Wt)}function zt(Wt){return factoryDestination(xt,Ht,Ct,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(Wt)}function Ht(Wt){return xt.attempt(titleBefore,Gt,Gt)(Wt)}function Gt(Wt){return markdownSpace(Wt)?factorySpace(xt,qt,"whitespace")(Wt):qt(Wt)}function qt(Wt){return Wt===null||markdownLineEnding(Wt)?(xt.exit("definition"),kt.parser.defined.push(Mt),$t(Wt)):Ct(Wt)}}function tokenizeTitleBefore(xt,$t,Ct){return kt;function kt(Bt){return markdownLineEndingOrSpace(Bt)?factoryWhitespace(xt,Mt)(Bt):Ct(Bt)}function Mt(Bt){return factoryTitle(xt,Ft,Ct,"definitionTitle","definitionTitleMarker","definitionTitleString")(Bt)}function Ft(Bt){return markdownSpace(Bt)?factorySpace(xt,jt,"whitespace")(Bt):jt(Bt)}function jt(Bt){return Bt===null||markdownLineEnding(Bt)?$t(Bt):Ct(Bt)}}const hardBreakEscape={name:"hardBreakEscape",tokenize:tokenizeHardBreakEscape};function tokenizeHardBreakEscape(xt,$t,Ct){return kt;function kt(Ft){return xt.enter("hardBreakEscape"),xt.consume(Ft),Mt}function Mt(Ft){return markdownLineEnding(Ft)?(xt.exit("hardBreakEscape"),$t(Ft)):Ct(Ft)}}const headingAtx={name:"headingAtx",tokenize:tokenizeHeadingAtx,resolve:resolveHeadingAtx};function resolveHeadingAtx(xt,$t){let Ct=xt.length-2,kt=3,Mt,Ft;return xt[kt][1].type==="whitespace"&&(kt+=2),Ct-2>kt&&xt[Ct][1].type==="whitespace"&&(Ct-=2),xt[Ct][1].type==="atxHeadingSequence"&&(kt===Ct-1||Ct-4>kt&&xt[Ct-2][1].type==="whitespace")&&(Ct-=kt+1===Ct?2:4),Ct>kt&&(Mt={type:"atxHeadingText",start:xt[kt][1].start,end:xt[Ct][1].end},Ft={type:"chunkText",start:xt[kt][1].start,end:xt[Ct][1].end,contentType:"text"},splice(xt,kt,Ct-kt+1,[["enter",Mt,$t],["enter",Ft,$t],["exit",Ft,$t],["exit",Mt,$t]])),xt}function tokenizeHeadingAtx(xt,$t,Ct){let kt=0;return Mt;function Mt(Ht){return xt.enter("atxHeading"),Ft(Ht)}function Ft(Ht){return xt.enter("atxHeadingSequence"),jt(Ht)}function jt(Ht){return Ht===35&&kt++<6?(xt.consume(Ht),jt):Ht===null||markdownLineEndingOrSpace(Ht)?(xt.exit("atxHeadingSequence"),Bt(Ht)):Ct(Ht)}function Bt(Ht){return Ht===35?(xt.enter("atxHeadingSequence"),Vt(Ht)):Ht===null||markdownLineEnding(Ht)?(xt.exit("atxHeading"),$t(Ht)):markdownSpace(Ht)?factorySpace(xt,Bt,"whitespace")(Ht):(xt.enter("atxHeadingText"),zt(Ht))}function Vt(Ht){return Ht===35?(xt.consume(Ht),Vt):(xt.exit("atxHeadingSequence"),Bt(Ht))}function zt(Ht){return Ht===null||Ht===35||markdownLineEndingOrSpace(Ht)?(xt.exit("atxHeadingText"),Bt(Ht)):(xt.consume(Ht),zt)}}const htmlBlockNames=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],htmlRawNames=["pre","script","style","textarea"],htmlFlow={name:"htmlFlow",tokenize:tokenizeHtmlFlow,resolveTo:resolveToHtmlFlow,concrete:!0},blankLineBefore={tokenize:tokenizeBlankLineBefore,partial:!0},nonLazyContinuationStart={tokenize:tokenizeNonLazyContinuationStart,partial:!0};function resolveToHtmlFlow(xt){let $t=xt.length;for(;$t--&&!(xt[$t][0]==="enter"&&xt[$t][1].type==="htmlFlow"););return $t>1&&xt[$t-2][1].type==="linePrefix"&&(xt[$t][1].start=xt[$t-2][1].start,xt[$t+1][1].start=xt[$t-2][1].start,xt.splice($t-2,2)),xt}function tokenizeHtmlFlow(xt,$t,Ct){const kt=this;let Mt,Ft,jt,Bt,Vt;return zt;function zt(_n){return Ht(_n)}function Ht(_n){return xt.enter("htmlFlow"),xt.enter("htmlFlowData"),xt.consume(_n),Gt}function Gt(_n){return _n===33?(xt.consume(_n),qt):_n===47?(xt.consume(_n),Ft=!0,Kt):_n===63?(xt.consume(_n),Mt=3,kt.interrupt?$t:An):asciiAlpha(_n)?(xt.consume(_n),jt=String.fromCharCode(_n),Xt):Ct(_n)}function qt(_n){return _n===45?(xt.consume(_n),Mt=2,Wt):_n===91?(xt.consume(_n),Mt=5,Bt=0,Yt):asciiAlpha(_n)?(xt.consume(_n),Mt=4,kt.interrupt?$t:An):Ct(_n)}function Wt(_n){return _n===45?(xt.consume(_n),kt.interrupt?$t:An):Ct(_n)}function Yt(_n){const Tn="CDATA[";return _n===Tn.charCodeAt(Bt++)?(xt.consume(_n),Bt===Tn.length?kt.interrupt?$t:En:Yt):Ct(_n)}function Kt(_n){return asciiAlpha(_n)?(xt.consume(_n),jt=String.fromCharCode(_n),Xt):Ct(_n)}function Xt(_n){if(_n===null||_n===47||_n===62||markdownLineEndingOrSpace(_n)){const Tn=_n===47,Pn=jt.toLowerCase();return!Tn&&!Ft&&htmlRawNames.includes(Pn)?(Mt=1,kt.interrupt?$t(_n):En(_n)):htmlBlockNames.includes(jt.toLowerCase())?(Mt=6,Tn?(xt.consume(_n),Qt):kt.interrupt?$t(_n):En(_n)):(Mt=7,kt.interrupt&&!kt.parser.lazy[kt.now().line]?Ct(_n):Ft?Jt(_n):Zt(_n))}return _n===45||asciiAlphanumeric(_n)?(xt.consume(_n),jt+=String.fromCharCode(_n),Xt):Ct(_n)}function Qt(_n){return _n===62?(xt.consume(_n),kt.interrupt?$t:En):Ct(_n)}function Jt(_n){return markdownSpace(_n)?(xt.consume(_n),Jt):yn(_n)}function Zt(_n){return _n===47?(xt.consume(_n),yn):_n===58||_n===95||asciiAlpha(_n)?(xt.consume(_n),sn):markdownSpace(_n)?(xt.consume(_n),Zt):yn(_n)}function sn(_n){return _n===45||_n===46||_n===58||_n===95||asciiAlphanumeric(_n)?(xt.consume(_n),sn):ln(_n)}function ln(_n){return _n===61?(xt.consume(_n),dn):markdownSpace(_n)?(xt.consume(_n),ln):Zt(_n)}function dn(_n){return _n===null||_n===60||_n===61||_n===62||_n===96?Ct(_n):_n===34||_n===39?(xt.consume(_n),Vt=_n,hn):markdownSpace(_n)?(xt.consume(_n),dn):cn(_n)}function hn(_n){return _n===Vt?(xt.consume(_n),Vt=null,pn):_n===null||markdownLineEnding(_n)?Ct(_n):(xt.consume(_n),hn)}function cn(_n){return _n===null||_n===34||_n===39||_n===47||_n===60||_n===61||_n===62||_n===96||markdownLineEndingOrSpace(_n)?ln(_n):(xt.consume(_n),cn)}function pn(_n){return _n===47||_n===62||markdownSpace(_n)?Zt(_n):Ct(_n)}function yn(_n){return _n===62?(xt.consume(_n),gn):Ct(_n)}function gn(_n){return _n===null||markdownLineEnding(_n)?En(_n):markdownSpace(_n)?(xt.consume(_n),gn):Ct(_n)}function En(_n){return _n===45&&Mt===2?(xt.consume(_n),$n):_n===60&&Mt===1?(xt.consume(_n),wn):_n===62&&Mt===4?(xt.consume(_n),Sn):_n===63&&Mt===3?(xt.consume(_n),An):_n===93&&Mt===5?(xt.consume(_n),Dn):markdownLineEnding(_n)&&(Mt===6||Mt===7)?(xt.exit("htmlFlowData"),xt.check(blankLineBefore,vn,bn)(_n)):_n===null||markdownLineEnding(_n)?(xt.exit("htmlFlowData"),bn(_n)):(xt.consume(_n),En)}function bn(_n){return xt.check(nonLazyContinuationStart,xn,vn)(_n)}function xn(_n){return xt.enter("lineEnding"),xt.consume(_n),xt.exit("lineEnding"),Cn}function Cn(_n){return _n===null||markdownLineEnding(_n)?bn(_n):(xt.enter("htmlFlowData"),En(_n))}function $n(_n){return _n===45?(xt.consume(_n),An):En(_n)}function wn(_n){return _n===47?(xt.consume(_n),jt="",Rn):En(_n)}function Rn(_n){if(_n===62){const Tn=jt.toLowerCase();return htmlRawNames.includes(Tn)?(xt.consume(_n),Sn):En(_n)}return asciiAlpha(_n)&&jt.length<8?(xt.consume(_n),jt+=String.fromCharCode(_n),Rn):En(_n)}function Dn(_n){return _n===93?(xt.consume(_n),An):En(_n)}function An(_n){return _n===62?(xt.consume(_n),Sn):_n===45&&Mt===2?(xt.consume(_n),An):En(_n)}function Sn(_n){return _n===null||markdownLineEnding(_n)?(xt.exit("htmlFlowData"),vn(_n)):(xt.consume(_n),Sn)}function vn(_n){return xt.exit("htmlFlow"),$t(_n)}}function tokenizeNonLazyContinuationStart(xt,$t,Ct){const kt=this;return Mt;function Mt(jt){return markdownLineEnding(jt)?(xt.enter("lineEnding"),xt.consume(jt),xt.exit("lineEnding"),Ft):Ct(jt)}function Ft(jt){return kt.parser.lazy[kt.now().line]?Ct(jt):$t(jt)}}function tokenizeBlankLineBefore(xt,$t,Ct){return kt;function kt(Mt){return xt.enter("lineEnding"),xt.consume(Mt),xt.exit("lineEnding"),xt.attempt(blankLine,$t,Ct)}}const htmlText={name:"htmlText",tokenize:tokenizeHtmlText};function tokenizeHtmlText(xt,$t,Ct){const kt=this;let Mt,Ft,jt;return Bt;function Bt(An){return xt.enter("htmlText"),xt.enter("htmlTextData"),xt.consume(An),Vt}function Vt(An){return An===33?(xt.consume(An),zt):An===47?(xt.consume(An),ln):An===63?(xt.consume(An),Zt):asciiAlpha(An)?(xt.consume(An),cn):Ct(An)}function zt(An){return An===45?(xt.consume(An),Ht):An===91?(xt.consume(An),Ft=0,Yt):asciiAlpha(An)?(xt.consume(An),Jt):Ct(An)}function Ht(An){return An===45?(xt.consume(An),Wt):Ct(An)}function Gt(An){return An===null?Ct(An):An===45?(xt.consume(An),qt):markdownLineEnding(An)?(jt=Gt,wn(An)):(xt.consume(An),Gt)}function qt(An){return An===45?(xt.consume(An),Wt):Gt(An)}function Wt(An){return An===62?$n(An):An===45?qt(An):Gt(An)}function Yt(An){const Sn="CDATA[";return An===Sn.charCodeAt(Ft++)?(xt.consume(An),Ft===Sn.length?Kt:Yt):Ct(An)}function Kt(An){return An===null?Ct(An):An===93?(xt.consume(An),Xt):markdownLineEnding(An)?(jt=Kt,wn(An)):(xt.consume(An),Kt)}function Xt(An){return An===93?(xt.consume(An),Qt):Kt(An)}function Qt(An){return An===62?$n(An):An===93?(xt.consume(An),Qt):Kt(An)}function Jt(An){return An===null||An===62?$n(An):markdownLineEnding(An)?(jt=Jt,wn(An)):(xt.consume(An),Jt)}function Zt(An){return An===null?Ct(An):An===63?(xt.consume(An),sn):markdownLineEnding(An)?(jt=Zt,wn(An)):(xt.consume(An),Zt)}function sn(An){return An===62?$n(An):Zt(An)}function ln(An){return asciiAlpha(An)?(xt.consume(An),dn):Ct(An)}function dn(An){return An===45||asciiAlphanumeric(An)?(xt.consume(An),dn):hn(An)}function hn(An){return markdownLineEnding(An)?(jt=hn,wn(An)):markdownSpace(An)?(xt.consume(An),hn):$n(An)}function cn(An){return An===45||asciiAlphanumeric(An)?(xt.consume(An),cn):An===47||An===62||markdownLineEndingOrSpace(An)?pn(An):Ct(An)}function pn(An){return An===47?(xt.consume(An),$n):An===58||An===95||asciiAlpha(An)?(xt.consume(An),yn):markdownLineEnding(An)?(jt=pn,wn(An)):markdownSpace(An)?(xt.consume(An),pn):$n(An)}function yn(An){return An===45||An===46||An===58||An===95||asciiAlphanumeric(An)?(xt.consume(An),yn):gn(An)}function gn(An){return An===61?(xt.consume(An),En):markdownLineEnding(An)?(jt=gn,wn(An)):markdownSpace(An)?(xt.consume(An),gn):pn(An)}function En(An){return An===null||An===60||An===61||An===62||An===96?Ct(An):An===34||An===39?(xt.consume(An),Mt=An,bn):markdownLineEnding(An)?(jt=En,wn(An)):markdownSpace(An)?(xt.consume(An),En):(xt.consume(An),xn)}function bn(An){return An===Mt?(xt.consume(An),Mt=void 0,Cn):An===null?Ct(An):markdownLineEnding(An)?(jt=bn,wn(An)):(xt.consume(An),bn)}function xn(An){return An===null||An===34||An===39||An===60||An===61||An===96?Ct(An):An===47||An===62||markdownLineEndingOrSpace(An)?pn(An):(xt.consume(An),xn)}function Cn(An){return An===47||An===62||markdownLineEndingOrSpace(An)?pn(An):Ct(An)}function $n(An){return An===62?(xt.consume(An),xt.exit("htmlTextData"),xt.exit("htmlText"),$t):Ct(An)}function wn(An){return xt.exit("htmlTextData"),xt.enter("lineEnding"),xt.consume(An),xt.exit("lineEnding"),Rn}function Rn(An){return markdownSpace(An)?factorySpace(xt,Dn,"linePrefix",kt.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(An):Dn(An)}function Dn(An){return xt.enter("htmlTextData"),jt(An)}}const labelEnd={name:"labelEnd",tokenize:tokenizeLabelEnd,resolveTo:resolveToLabelEnd,resolveAll:resolveAllLabelEnd},resourceConstruct={tokenize:tokenizeResource},referenceFullConstruct={tokenize:tokenizeReferenceFull},referenceCollapsedConstruct={tokenize:tokenizeReferenceCollapsed};function resolveAllLabelEnd(xt){let $t=-1;for(;++$t<xt.length;){const Ct=xt[$t][1];(Ct.type==="labelImage"||Ct.type==="labelLink"||Ct.type==="labelEnd")&&(xt.splice($t+1,Ct.type==="labelImage"?4:2),Ct.type="data",$t++)}return xt}function resolveToLabelEnd(xt,$t){let Ct=xt.length,kt=0,Mt,Ft,jt,Bt;for(;Ct--;)if(Mt=xt[Ct][1],Ft){if(Mt.type==="link"||Mt.type==="labelLink"&&Mt._inactive)break;xt[Ct][0]==="enter"&&Mt.type==="labelLink"&&(Mt._inactive=!0)}else if(jt){if(xt[Ct][0]==="enter"&&(Mt.type==="labelImage"||Mt.type==="labelLink")&&!Mt._balanced&&(Ft=Ct,Mt.type!=="labelLink")){kt=2;break}}else Mt.type==="labelEnd"&&(jt=Ct);const Vt={type:xt[Ft][1].type==="labelLink"?"link":"image",start:Object.assign({},xt[Ft][1].start),end:Object.assign({},xt[xt.length-1][1].end)},zt={type:"label",start:Object.assign({},xt[Ft][1].start),end:Object.assign({},xt[jt][1].end)},Ht={type:"labelText",start:Object.assign({},xt[Ft+kt+2][1].end),end:Object.assign({},xt[jt-2][1].start)};return Bt=[["enter",Vt,$t],["enter",zt,$t]],Bt=push$1(Bt,xt.slice(Ft+1,Ft+kt+3)),Bt=push$1(Bt,[["enter",Ht,$t]]),Bt=push$1(Bt,resolveAll($t.parser.constructs.insideSpan.null,xt.slice(Ft+kt+4,jt-3),$t)),Bt=push$1(Bt,[["exit",Ht,$t],xt[jt-2],xt[jt-1],["exit",zt,$t]]),Bt=push$1(Bt,xt.slice(jt+1)),Bt=push$1(Bt,[["exit",Vt,$t]]),splice(xt,Ft,xt.length,Bt),xt}function tokenizeLabelEnd(xt,$t,Ct){const kt=this;let Mt=kt.events.length,Ft,jt;for(;Mt--;)if((kt.events[Mt][1].type==="labelImage"||kt.events[Mt][1].type==="labelLink")&&!kt.events[Mt][1]._balanced){Ft=kt.events[Mt][1];break}return Bt;function Bt(qt){return Ft?Ft._inactive?Gt(qt):(jt=kt.parser.defined.includes(normalizeIdentifier(kt.sliceSerialize({start:Ft.end,end:kt.now()}))),xt.enter("labelEnd"),xt.enter("labelMarker"),xt.consume(qt),xt.exit("labelMarker"),xt.exit("labelEnd"),Vt):Ct(qt)}function Vt(qt){return qt===40?xt.attempt(resourceConstruct,Ht,jt?Ht:Gt)(qt):qt===91?xt.attempt(referenceFullConstruct,Ht,jt?zt:Gt)(qt):jt?Ht(qt):Gt(qt)}function zt(qt){return xt.attempt(referenceCollapsedConstruct,Ht,Gt)(qt)}function Ht(qt){return $t(qt)}function Gt(qt){return Ft._balanced=!0,Ct(qt)}}function tokenizeResource(xt,$t,Ct){return kt;function kt(Gt){return xt.enter("resource"),xt.enter("resourceMarker"),xt.consume(Gt),xt.exit("resourceMarker"),Mt}function Mt(Gt){return markdownLineEndingOrSpace(Gt)?factoryWhitespace(xt,Ft)(Gt):Ft(Gt)}function Ft(Gt){return Gt===41?Ht(Gt):factoryDestination(xt,jt,Bt,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(Gt)}function jt(Gt){return markdownLineEndingOrSpace(Gt)?factoryWhitespace(xt,Vt)(Gt):Ht(Gt)}function Bt(Gt){return Ct(Gt)}function Vt(Gt){return Gt===34||Gt===39||Gt===40?factoryTitle(xt,zt,Ct,"resourceTitle","resourceTitleMarker","resourceTitleString")(Gt):Ht(Gt)}function zt(Gt){return markdownLineEndingOrSpace(Gt)?factoryWhitespace(xt,Ht)(Gt):Ht(Gt)}function Ht(Gt){return Gt===41?(xt.enter("resourceMarker"),xt.consume(Gt),xt.exit("resourceMarker"),xt.exit("resource"),$t):Ct(Gt)}}function tokenizeReferenceFull(xt,$t,Ct){const kt=this;return Mt;function Mt(Bt){return factoryLabel.call(kt,xt,Ft,jt,"reference","referenceMarker","referenceString")(Bt)}function Ft(Bt){return kt.parser.defined.includes(normalizeIdentifier(kt.sliceSerialize(kt.events[kt.events.length-1][1]).slice(1,-1)))?$t(Bt):Ct(Bt)}function jt(Bt){return Ct(Bt)}}function tokenizeReferenceCollapsed(xt,$t,Ct){return kt;function kt(Ft){return xt.enter("reference"),xt.enter("referenceMarker"),xt.consume(Ft),xt.exit("referenceMarker"),Mt}function Mt(Ft){return Ft===93?(xt.enter("referenceMarker"),xt.consume(Ft),xt.exit("referenceMarker"),xt.exit("reference"),$t):Ct(Ft)}}const labelStartImage={name:"labelStartImage",tokenize:tokenizeLabelStartImage,resolveAll:labelEnd.resolveAll};function tokenizeLabelStartImage(xt,$t,Ct){const kt=this;return Mt;function Mt(Bt){return xt.enter("labelImage"),xt.enter("labelImageMarker"),xt.consume(Bt),xt.exit("labelImageMarker"),Ft}function Ft(Bt){return Bt===91?(xt.enter("labelMarker"),xt.consume(Bt),xt.exit("labelMarker"),xt.exit("labelImage"),jt):Ct(Bt)}function jt(Bt){return Bt===94&&"_hiddenFootnoteSupport"in kt.parser.constructs?Ct(Bt):$t(Bt)}}const labelStartLink={name:"labelStartLink",tokenize:tokenizeLabelStartLink,resolveAll:labelEnd.resolveAll};function tokenizeLabelStartLink(xt,$t,Ct){const kt=this;return Mt;function Mt(jt){return xt.enter("labelLink"),xt.enter("labelMarker"),xt.consume(jt),xt.exit("labelMarker"),xt.exit("labelLink"),Ft}function Ft(jt){return jt===94&&"_hiddenFootnoteSupport"in kt.parser.constructs?Ct(jt):$t(jt)}}const lineEnding={name:"lineEnding",tokenize:tokenizeLineEnding};function tokenizeLineEnding(xt,$t){return Ct;function Ct(kt){return xt.enter("lineEnding"),xt.consume(kt),xt.exit("lineEnding"),factorySpace(xt,$t,"linePrefix")}}const thematicBreak$1={name:"thematicBreak",tokenize:tokenizeThematicBreak};function tokenizeThematicBreak(xt,$t,Ct){let kt=0,Mt;return Ft;function Ft(zt){return xt.enter("thematicBreak"),jt(zt)}function jt(zt){return Mt=zt,Bt(zt)}function Bt(zt){return zt===Mt?(xt.enter("thematicBreakSequence"),Vt(zt)):kt>=3&&(zt===null||markdownLineEnding(zt))?(xt.exit("thematicBreak"),$t(zt)):Ct(zt)}function Vt(zt){return zt===Mt?(xt.consume(zt),kt++,Vt):(xt.exit("thematicBreakSequence"),markdownSpace(zt)?factorySpace(xt,Bt,"whitespace")(zt):Bt(zt))}}const list$6={name:"list",tokenize:tokenizeListStart,continuation:{tokenize:tokenizeListContinuation},exit:tokenizeListEnd},listItemPrefixWhitespaceConstruct={tokenize:tokenizeListItemPrefixWhitespace,partial:!0},indentConstruct={tokenize:tokenizeIndent,partial:!0};function tokenizeListStart(xt,$t,Ct){const kt=this,Mt=kt.events[kt.events.length-1];let Ft=Mt&&Mt[1].type==="linePrefix"?Mt[2].sliceSerialize(Mt[1],!0).length:0,jt=0;return Bt;function Bt(Wt){const Yt=kt.containerState.type||(Wt===42||Wt===43||Wt===45?"listUnordered":"listOrdered");if(Yt==="listUnordered"?!kt.containerState.marker||Wt===kt.containerState.marker:asciiDigit(Wt)){if(kt.containerState.type||(kt.containerState.type=Yt,xt.enter(Yt,{_container:!0})),Yt==="listUnordered")return xt.enter("listItemPrefix"),Wt===42||Wt===45?xt.check(thematicBreak$1,Ct,zt)(Wt):zt(Wt);if(!kt.interrupt||Wt===49)return xt.enter("listItemPrefix"),xt.enter("listItemValue"),Vt(Wt)}return Ct(Wt)}function Vt(Wt){return asciiDigit(Wt)&&++jt<10?(xt.consume(Wt),Vt):(!kt.interrupt||jt<2)&&(kt.containerState.marker?Wt===kt.containerState.marker:Wt===41||Wt===46)?(xt.exit("listItemValue"),zt(Wt)):Ct(Wt)}function zt(Wt){return xt.enter("listItemMarker"),xt.consume(Wt),xt.exit("listItemMarker"),kt.containerState.marker=kt.containerState.marker||Wt,xt.check(blankLine,kt.interrupt?Ct:Ht,xt.attempt(listItemPrefixWhitespaceConstruct,qt,Gt))}function Ht(Wt){return kt.containerState.initialBlankLine=!0,Ft++,qt(Wt)}function Gt(Wt){return markdownSpace(Wt)?(xt.enter("listItemPrefixWhitespace"),xt.consume(Wt),xt.exit("listItemPrefixWhitespace"),qt):Ct(Wt)}function qt(Wt){return kt.containerState.size=Ft+kt.sliceSerialize(xt.exit("listItemPrefix"),!0).length,$t(Wt)}}function tokenizeListContinuation(xt,$t,Ct){const kt=this;return kt.containerState._closeFlow=void 0,xt.check(blankLine,Mt,Ft);function Mt(Bt){return kt.containerState.furtherBlankLines=kt.containerState.furtherBlankLines||kt.containerState.initialBlankLine,factorySpace(xt,$t,"listItemIndent",kt.containerState.size+1)(Bt)}function Ft(Bt){return kt.containerState.furtherBlankLines||!markdownSpace(Bt)?(kt.containerState.furtherBlankLines=void 0,kt.containerState.initialBlankLine=void 0,jt(Bt)):(kt.containerState.furtherBlankLines=void 0,kt.containerState.initialBlankLine=void 0,xt.attempt(indentConstruct,$t,jt)(Bt))}function jt(Bt){return kt.containerState._closeFlow=!0,kt.interrupt=void 0,factorySpace(xt,xt.attempt(list$6,$t,Ct),"linePrefix",kt.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(Bt)}}function tokenizeIndent(xt,$t,Ct){const kt=this;return factorySpace(xt,Mt,"listItemIndent",kt.containerState.size+1);function Mt(Ft){const jt=kt.events[kt.events.length-1];return jt&&jt[1].type==="listItemIndent"&&jt[2].sliceSerialize(jt[1],!0).length===kt.containerState.size?$t(Ft):Ct(Ft)}}function tokenizeListEnd(xt){xt.exit(this.containerState.type)}function tokenizeListItemPrefixWhitespace(xt,$t,Ct){const kt=this;return factorySpace(xt,Mt,"listItemPrefixWhitespace",kt.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function Mt(Ft){const jt=kt.events[kt.events.length-1];return!markdownSpace(Ft)&&jt&&jt[1].type==="listItemPrefixWhitespace"?$t(Ft):Ct(Ft)}}const setextUnderline={name:"setextUnderline",tokenize:tokenizeSetextUnderline,resolveTo:resolveToSetextUnderline};function resolveToSetextUnderline(xt,$t){let Ct=xt.length,kt,Mt,Ft;for(;Ct--;)if(xt[Ct][0]==="enter"){if(xt[Ct][1].type==="content"){kt=Ct;break}xt[Ct][1].type==="paragraph"&&(Mt=Ct)}else xt[Ct][1].type==="content"&&xt.splice(Ct,1),!Ft&&xt[Ct][1].type==="definition"&&(Ft=Ct);const jt={type:"setextHeading",start:Object.assign({},xt[Mt][1].start),end:Object.assign({},xt[xt.length-1][1].end)};return xt[Mt][1].type="setextHeadingText",Ft?(xt.splice(Mt,0,["enter",jt,$t]),xt.splice(Ft+1,0,["exit",xt[kt][1],$t]),xt[kt][1].end=Object.assign({},xt[Ft][1].end)):xt[kt][1]=jt,xt.push(["exit",jt,$t]),xt}function tokenizeSetextUnderline(xt,$t,Ct){const kt=this;let Mt;return Ft;function Ft(zt){let Ht=kt.events.length,Gt;for(;Ht--;)if(kt.events[Ht][1].type!=="lineEnding"&&kt.events[Ht][1].type!=="linePrefix"&&kt.events[Ht][1].type!=="content"){Gt=kt.events[Ht][1].type==="paragraph";break}return!kt.parser.lazy[kt.now().line]&&(kt.interrupt||Gt)?(xt.enter("setextHeadingLine"),Mt=zt,jt(zt)):Ct(zt)}function jt(zt){return xt.enter("setextHeadingLineSequence"),Bt(zt)}function Bt(zt){return zt===Mt?(xt.consume(zt),Bt):(xt.exit("setextHeadingLineSequence"),markdownSpace(zt)?factorySpace(xt,Vt,"lineSuffix")(zt):Vt(zt))}function Vt(zt){return zt===null||markdownLineEnding(zt)?(xt.exit("setextHeadingLine"),$t(zt)):Ct(zt)}}const flow$1={tokenize:initializeFlow};function initializeFlow(xt){const $t=this,Ct=xt.attempt(blankLine,kt,xt.attempt(this.parser.constructs.flowInitial,Mt,factorySpace(xt,xt.attempt(this.parser.constructs.flow,Mt,xt.attempt(content$1,Mt)),"linePrefix")));return Ct;function kt(Ft){if(Ft===null){xt.consume(Ft);return}return xt.enter("lineEndingBlank"),xt.consume(Ft),xt.exit("lineEndingBlank"),$t.currentConstruct=void 0,Ct}function Mt(Ft){if(Ft===null){xt.consume(Ft);return}return xt.enter("lineEnding"),xt.consume(Ft),xt.exit("lineEnding"),$t.currentConstruct=void 0,Ct}}const resolver={resolveAll:createResolver()},string$2=initializeFactory("string"),text$8=initializeFactory("text");function initializeFactory(xt){return{tokenize:$t,resolveAll:createResolver(xt==="text"?resolveAllLineSuffixes:void 0)};function $t(Ct){const kt=this,Mt=this.parser.constructs[xt],Ft=Ct.attempt(Mt,jt,Bt);return jt;function jt(Ht){return zt(Ht)?Ft(Ht):Bt(Ht)}function Bt(Ht){if(Ht===null){Ct.consume(Ht);return}return Ct.enter("data"),Ct.consume(Ht),Vt}function Vt(Ht){return zt(Ht)?(Ct.exit("data"),Ft(Ht)):(Ct.consume(Ht),Vt)}function zt(Ht){if(Ht===null)return!0;const Gt=Mt[Ht];let qt=-1;if(Gt)for(;++qt<Gt.length;){const Wt=Gt[qt];if(!Wt.previous||Wt.previous.call(kt,kt.previous))return!0}return!1}}}function createResolver(xt){return $t;function $t(Ct,kt){let Mt=-1,Ft;for(;++Mt<=Ct.length;)Ft===void 0?Ct[Mt]&&Ct[Mt][1].type==="data"&&(Ft=Mt,Mt++):(!Ct[Mt]||Ct[Mt][1].type!=="data")&&(Mt!==Ft+2&&(Ct[Ft][1].end=Ct[Mt-1][1].end,Ct.splice(Ft+2,Mt-Ft-2),Mt=Ft+2),Ft=void 0);return xt?xt(Ct,kt):Ct}}function resolveAllLineSuffixes(xt,$t){let Ct=0;for(;++Ct<=xt.length;)if((Ct===xt.length||xt[Ct][1].type==="lineEnding")&&xt[Ct-1][1].type==="data"){const kt=xt[Ct-1][1],Mt=$t.sliceStream(kt);let Ft=Mt.length,jt=-1,Bt=0,Vt;for(;Ft--;){const zt=Mt[Ft];if(typeof zt=="string"){for(jt=zt.length;zt.charCodeAt(jt-1)===32;)Bt++,jt--;if(jt)break;jt=-1}else if(zt===-2)Vt=!0,Bt++;else if(zt!==-1){Ft++;break}}if(Bt){const zt={type:Ct===xt.length||Vt||Bt<2?"lineSuffix":"hardBreakTrailing",start:{line:kt.end.line,column:kt.end.column-Bt,offset:kt.end.offset-Bt,_index:kt.start._index+Ft,_bufferIndex:Ft?jt:kt.start._bufferIndex+jt},end:Object.assign({},kt.end)};kt.end=Object.assign({},zt.start),kt.start.offset===kt.end.offset?Object.assign(kt,zt):(xt.splice(Ct,0,["enter",zt,$t],["exit",zt,$t]),Ct+=2)}Ct++}return xt}function createTokenizer(xt,$t,Ct){let kt=Object.assign(Ct?Object.assign({},Ct):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const Mt={},Ft=[];let jt=[],Bt=[];const Vt={consume:Jt,enter:Zt,exit:sn,attempt:hn(ln),check:hn(dn),interrupt:hn(dn,{interrupt:!0})},zt={previous:null,code:null,containerState:{},events:[],parser:xt,sliceStream:Wt,sliceSerialize:qt,now:Yt,defineSkip:Kt,write:Gt};let Ht=$t.tokenize.call(zt,Vt);return $t.resolveAll&&Ft.push($t),zt;function Gt(gn){return jt=push$1(jt,gn),Xt(),jt[jt.length-1]!==null?[]:(cn($t,0),zt.events=resolveAll(Ft,zt.events,zt),zt.events)}function qt(gn,En){return serializeChunks(Wt(gn),En)}function Wt(gn){return sliceChunks$1(jt,gn)}function Yt(){const{line:gn,column:En,offset:bn,_index:xn,_bufferIndex:Cn}=kt;return{line:gn,column:En,offset:bn,_index:xn,_bufferIndex:Cn}}function Kt(gn){Mt[gn.line]=gn.column,yn()}function Xt(){let gn;for(;kt._index<jt.length;){const En=jt[kt._index];if(typeof En=="string")for(gn=kt._index,kt._bufferIndex<0&&(kt._bufferIndex=0);kt._index===gn&&kt._bufferIndex<En.length;)Qt(En.charCodeAt(kt._bufferIndex));else Qt(En)}}function Qt(gn){Ht=Ht(gn)}function Jt(gn){markdownLineEnding(gn)?(kt.line++,kt.column=1,kt.offset+=gn===-3?2:1,yn()):gn!==-1&&(kt.column++,kt.offset++),kt._bufferIndex<0?kt._index++:(kt._bufferIndex++,kt._bufferIndex===jt[kt._index].length&&(kt._bufferIndex=-1,kt._index++)),zt.previous=gn}function Zt(gn,En){const bn=En||{};return bn.type=gn,bn.start=Yt(),zt.events.push(["enter",bn,zt]),Bt.push(bn),bn}function sn(gn){const En=Bt.pop();return En.end=Yt(),zt.events.push(["exit",En,zt]),En}function ln(gn,En){cn(gn,En.from)}function dn(gn,En){En.restore()}function hn(gn,En){return bn;function bn(xn,Cn,$n){let wn,Rn,Dn,An;return Array.isArray(xn)?vn(xn):"tokenize"in xn?vn([xn]):Sn(xn);function Sn(Ln){return Vn;function Vn(Un){const Wn=Un!==null&&Ln[Un],rr=Un!==null&&Ln.null,ar=[...Array.isArray(Wn)?Wn:Wn?[Wn]:[],...Array.isArray(rr)?rr:rr?[rr]:[]];return vn(ar)(Un)}}function vn(Ln){return wn=Ln,Rn=0,Ln.length===0?$n:_n(Ln[Rn])}function _n(Ln){return Vn;function Vn(Un){return An=pn(),Dn=Ln,Ln.partial||(zt.currentConstruct=Ln),Ln.name&&zt.parser.constructs.disable.null.includes(Ln.name)?Pn():Ln.tokenize.call(En?Object.assign(Object.create(zt),En):zt,Vt,Tn,Pn)(Un)}}function Tn(Ln){return gn(Dn,An),Cn}function Pn(Ln){return An.restore(),++Rn<wn.length?_n(wn[Rn]):$n}}}function cn(gn,En){gn.resolveAll&&!Ft.includes(gn)&&Ft.push(gn),gn.resolve&&splice(zt.events,En,zt.events.length-En,gn.resolve(zt.events.slice(En),zt)),gn.resolveTo&&(zt.events=gn.resolveTo(zt.events,zt))}function pn(){const gn=Yt(),En=zt.previous,bn=zt.currentConstruct,xn=zt.events.length,Cn=Array.from(Bt);return{restore:$n,from:xn};function $n(){kt=gn,zt.previous=En,zt.currentConstruct=bn,zt.events.length=xn,Bt=Cn,yn()}}function yn(){kt.line in Mt&&kt.column<2&&(kt.column=Mt[kt.line],kt.offset+=Mt[kt.line]-1)}}function sliceChunks$1(xt,$t){const Ct=$t.start._index,kt=$t.start._bufferIndex,Mt=$t.end._index,Ft=$t.end._bufferIndex;let jt;if(Ct===Mt)jt=[xt[Ct].slice(kt,Ft)];else{if(jt=xt.slice(Ct,Mt),kt>-1){const Bt=jt[0];typeof Bt=="string"?jt[0]=Bt.slice(kt):jt.shift()}Ft>0&&jt.push(xt[Mt].slice(0,Ft))}return jt}function serializeChunks(xt,$t){let Ct=-1;const kt=[];let Mt;for(;++Ct<xt.length;){const Ft=xt[Ct];let jt;if(typeof Ft=="string")jt=Ft;else switch(Ft){case-5:{jt="\r";break}case-4:{jt=`
`;break}case-3:{jt=`\r
`;break}case-2:{jt=$t?" ":"	";break}case-1:{if(!$t&&Mt)continue;jt=" ";break}default:jt=String.fromCharCode(Ft)}Mt=Ft===-2,kt.push(jt)}return kt.join("")}const document$1={42:list$6,43:list$6,45:list$6,48:list$6,49:list$6,50:list$6,51:list$6,52:list$6,53:list$6,54:list$6,55:list$6,56:list$6,57:list$6,62:blockQuote},contentInitial={91:definition$2},flowInitial={[-2]:codeIndented,[-1]:codeIndented,32:codeIndented},flow={35:headingAtx,42:thematicBreak$1,45:[setextUnderline,thematicBreak$1],60:htmlFlow,61:setextUnderline,95:thematicBreak$1,96:codeFenced,126:codeFenced},string$1={38:characterReference,92:characterEscape},text$7={[-5]:lineEnding,[-4]:lineEnding,[-3]:lineEnding,33:labelStartImage,38:characterReference,42:attention,60:[autolink,htmlText],91:labelStartLink,92:[hardBreakEscape,characterEscape],93:labelEnd,95:attention,96:codeText},insideSpan={null:[attention,resolver]},attentionMarkers={null:[42,95]},disable={null:[]},defaultConstructs=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers,contentInitial,disable,document:document$1,flow,flowInitial,insideSpan,string:string$1,text:text$7},Symbol.toStringTag,{value:"Module"}));function parse$c(xt){const Ct=combineExtensions([defaultConstructs,...(xt||{}).extensions||[]]),kt={defined:[],lazy:{},constructs:Ct,content:Mt(content$2),document:Mt(document$2),flow:Mt(flow$1),string:Mt(string$2),text:Mt(text$8)};return kt;function Mt(Ft){return jt;function jt(Bt){return createTokenizer(kt,Ft,Bt)}}}function postprocess(xt){for(;!subtokenize(xt););return xt}const search$2=/[\0\t\n\r]/g;function preprocess(){let xt=1,$t="",Ct=!0,kt;return Mt;function Mt(Ft,jt,Bt){const Vt=[];let zt,Ht,Gt,qt,Wt;for(Ft=$t+(typeof Ft=="string"?Ft.toString():new TextDecoder(jt||void 0).decode(Ft)),Gt=0,$t="",Ct&&(Ft.charCodeAt(0)===65279&&Gt++,Ct=void 0);Gt<Ft.length;){if(search$2.lastIndex=Gt,zt=search$2.exec(Ft),qt=zt&&zt.index!==void 0?zt.index:Ft.length,Wt=Ft.charCodeAt(qt),!zt){$t=Ft.slice(Gt);break}if(Wt===10&&Gt===qt&&kt)Vt.push(-3),kt=void 0;else switch(kt&&(Vt.push(-5),kt=void 0),Gt<qt&&(Vt.push(Ft.slice(Gt,qt)),xt+=qt-Gt),Wt){case 0:{Vt.push(65533),xt++;break}case 9:{for(Ht=Math.ceil(xt/4)*4,Vt.push(-2);xt++<Ht;)Vt.push(-1);break}case 10:{Vt.push(-4),xt=1;break}default:kt=!0,xt=1}Gt=qt+1}return Bt&&(kt&&Vt.push(-5),$t&&Vt.push($t),Vt.push(null)),Vt}}const characterEscapeOrReference=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function decodeString(xt){return xt.replace(characterEscapeOrReference,decode)}function decode(xt,$t,Ct){if($t)return $t;if(Ct.charCodeAt(0)===35){const Mt=Ct.charCodeAt(1),Ft=Mt===120||Mt===88;return decodeNumericCharacterReference(Ct.slice(Ft?2:1),Ft?16:10)}return decodeNamedCharacterReference(Ct)||xt}const own$6={}.hasOwnProperty;function fromMarkdown(xt,$t,Ct){return typeof $t!="string"&&(Ct=$t,$t=void 0),compiler(Ct)(postprocess(parse$c(Ct).document().write(preprocess()(xt,$t,!0))))}function compiler(xt){const $t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:Ft(sr),autolinkProtocol:pn,autolinkEmail:pn,atxHeading:Ft(Fn),blockQuote:Ft(rr),characterEscape:pn,characterReference:pn,codeFenced:Ft(ar),codeFencedFenceInfo:jt,codeFencedFenceMeta:jt,codeIndented:Ft(ar,jt),codeText:Ft(nr,jt),codeTextData:pn,data:pn,codeFlowValue:pn,definition:Ft(mr),definitionDestinationString:jt,definitionLabelString:jt,definitionTitleString:jt,emphasis:Ft(kn),hardBreakEscape:Ft(Hn),hardBreakTrailing:Ft(Hn),htmlFlow:Ft(Bn,jt),htmlFlowData:pn,htmlText:Ft(Bn,jt),htmlTextData:pn,image:Ft(jn),label:jt,link:Ft(sr),listItem:Ft(Fr),listItemValue:qt,listOrdered:Ft(Ar,Gt),listUnordered:Ft(Ar),paragraph:Ft(Rr),reference:_n,referenceString:jt,resourceDestinationString:jt,resourceTitleString:jt,setextHeading:Ft(Fn),strong:Ft(Qn),thematicBreak:Ft(Mr)},exit:{atxHeading:Vt(),atxHeadingSequence:ln,autolink:Vt(),autolinkEmail:Wn,autolinkProtocol:Un,blockQuote:Vt(),characterEscapeValue:yn,characterReferenceMarkerHexadecimal:Pn,characterReferenceMarkerNumeric:Pn,characterReferenceValue:Ln,characterReference:Vn,codeFenced:Vt(Xt),codeFencedFence:Kt,codeFencedFenceInfo:Wt,codeFencedFenceMeta:Yt,codeFlowValue:yn,codeIndented:Vt(Qt),codeText:Vt(Cn),codeTextData:yn,data:yn,definition:Vt(),definitionDestinationString:sn,definitionLabelString:Jt,definitionTitleString:Zt,emphasis:Vt(),hardBreakEscape:Vt(En),hardBreakTrailing:Vt(En),htmlFlow:Vt(bn),htmlFlowData:yn,htmlText:Vt(xn),htmlTextData:yn,image:Vt(wn),label:Dn,labelText:Rn,lineEnding:gn,link:Vt($n),listItem:Vt(),listOrdered:Vt(),listUnordered:Vt(),paragraph:Vt(),referenceString:Tn,resourceDestinationString:An,resourceTitleString:Sn,resource:vn,setextHeading:Vt(cn),setextHeadingLineSequence:hn,setextHeadingText:dn,strong:Vt(),thematicBreak:Vt()}};configure($t,(xt||{}).mdastExtensions||[]);const Ct={};return kt;function kt(pr){let Tr={type:"root",children:[]};const Hr={stack:[Tr],tokenStack:[],config:$t,enter:Bt,exit:zt,buffer:jt,resume:Ht,data:Ct},Xr=[];let Zr=-1;for(;++Zr<pr.length;)if(pr[Zr][1].type==="listOrdered"||pr[Zr][1].type==="listUnordered")if(pr[Zr][0]==="enter")Xr.push(Zr);else{const ur=Xr.pop();Zr=Mt(pr,ur,Zr)}for(Zr=-1;++Zr<pr.length;){const ur=$t[pr[Zr][0]];own$6.call(ur,pr[Zr][1].type)&&ur[pr[Zr][1].type].call(Object.assign({sliceSerialize:pr[Zr][2].sliceSerialize},Hr),pr[Zr][1])}if(Hr.tokenStack.length>0){const ur=Hr.tokenStack[Hr.tokenStack.length-1];(ur[1]||defaultOnError).call(Hr,void 0,ur[0])}for(Tr.position={start:point$9(pr.length>0?pr[0][1].start:{line:1,column:1,offset:0}),end:point$9(pr.length>0?pr[pr.length-2][1].end:{line:1,column:1,offset:0})},Zr=-1;++Zr<$t.transforms.length;)Tr=$t.transforms[Zr](Tr)||Tr;return Tr}function Mt(pr,Tr,Hr){let Xr=Tr-1,Zr=-1,ur=!1,hr,gr,qr,ds;for(;++Xr<=Hr;){const ms=pr[Xr];switch(ms[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{ms[0]==="enter"?Zr++:Zr--,ds=void 0;break}case"lineEndingBlank":{ms[0]==="enter"&&(hr&&!ds&&!Zr&&!qr&&(qr=Xr),ds=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:ds=void 0}if(!Zr&&ms[0]==="enter"&&ms[1].type==="listItemPrefix"||Zr===-1&&ms[0]==="exit"&&(ms[1].type==="listUnordered"||ms[1].type==="listOrdered")){if(hr){let wr=Xr;for(gr=void 0;wr--;){const Wr=pr[wr];if(Wr[1].type==="lineEnding"||Wr[1].type==="lineEndingBlank"){if(Wr[0]==="exit")continue;gr&&(pr[gr][1].type="lineEndingBlank",ur=!0),Wr[1].type="lineEnding",gr=wr}else if(!(Wr[1].type==="linePrefix"||Wr[1].type==="blockQuotePrefix"||Wr[1].type==="blockQuotePrefixWhitespace"||Wr[1].type==="blockQuoteMarker"||Wr[1].type==="listItemIndent"))break}qr&&(!gr||qr<gr)&&(hr._spread=!0),hr.end=Object.assign({},gr?pr[gr][1].start:ms[1].end),pr.splice(gr||Xr,0,["exit",hr,ms[2]]),Xr++,Hr++}if(ms[1].type==="listItemPrefix"){const wr={type:"listItem",_spread:!1,start:Object.assign({},ms[1].start),end:void 0};hr=wr,pr.splice(Xr,0,["enter",wr,ms[2]]),Xr++,Hr++,qr=void 0,ds=!0}}}return pr[Tr][1]._spread=ur,Hr}function Ft(pr,Tr){return Hr;function Hr(Xr){Bt.call(this,pr(Xr),Xr),Tr&&Tr.call(this,Xr)}}function jt(){this.stack.push({type:"fragment",children:[]})}function Bt(pr,Tr,Hr){this.stack[this.stack.length-1].children.push(pr),this.stack.push(pr),this.tokenStack.push([Tr,Hr]),pr.position={start:point$9(Tr.start),end:void 0}}function Vt(pr){return Tr;function Tr(Hr){pr&&pr.call(this,Hr),zt.call(this,Hr)}}function zt(pr,Tr){const Hr=this.stack.pop(),Xr=this.tokenStack.pop();if(Xr)Xr[0].type!==pr.type&&(Tr?Tr.call(this,pr,Xr[0]):(Xr[1]||defaultOnError).call(this,pr,Xr[0]));else throw new Error("Cannot close `"+pr.type+"` ("+stringifyPosition({start:pr.start,end:pr.end})+"): its not open");Hr.position.end=point$9(pr.end)}function Ht(){return toString$4(this.stack.pop())}function Gt(){this.data.expectingFirstListItemValue=!0}function qt(pr){if(this.data.expectingFirstListItemValue){const Tr=this.stack[this.stack.length-2];Tr.start=Number.parseInt(this.sliceSerialize(pr),10),this.data.expectingFirstListItemValue=void 0}}function Wt(){const pr=this.resume(),Tr=this.stack[this.stack.length-1];Tr.lang=pr}function Yt(){const pr=this.resume(),Tr=this.stack[this.stack.length-1];Tr.meta=pr}function Kt(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function Xt(){const pr=this.resume(),Tr=this.stack[this.stack.length-1];Tr.value=pr.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function Qt(){const pr=this.resume(),Tr=this.stack[this.stack.length-1];Tr.value=pr.replace(/(\r?\n|\r)$/g,"")}function Jt(pr){const Tr=this.resume(),Hr=this.stack[this.stack.length-1];Hr.label=Tr,Hr.identifier=normalizeIdentifier(this.sliceSerialize(pr)).toLowerCase()}function Zt(){const pr=this.resume(),Tr=this.stack[this.stack.length-1];Tr.title=pr}function sn(){const pr=this.resume(),Tr=this.stack[this.stack.length-1];Tr.url=pr}function ln(pr){const Tr=this.stack[this.stack.length-1];if(!Tr.depth){const Hr=this.sliceSerialize(pr).length;Tr.depth=Hr}}function dn(){this.data.setextHeadingSlurpLineEnding=!0}function hn(pr){const Tr=this.stack[this.stack.length-1];Tr.depth=this.sliceSerialize(pr).codePointAt(0)===61?1:2}function cn(){this.data.setextHeadingSlurpLineEnding=void 0}function pn(pr){const Hr=this.stack[this.stack.length-1].children;let Xr=Hr[Hr.length-1];(!Xr||Xr.type!=="text")&&(Xr=jr(),Xr.position={start:point$9(pr.start),end:void 0},Hr.push(Xr)),this.stack.push(Xr)}function yn(pr){const Tr=this.stack.pop();Tr.value+=this.sliceSerialize(pr),Tr.position.end=point$9(pr.end)}function gn(pr){const Tr=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Hr=Tr.children[Tr.children.length-1];Hr.position.end=point$9(pr.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&$t.canContainEols.includes(Tr.type)&&(pn.call(this,pr),yn.call(this,pr))}function En(){this.data.atHardBreak=!0}function bn(){const pr=this.resume(),Tr=this.stack[this.stack.length-1];Tr.value=pr}function xn(){const pr=this.resume(),Tr=this.stack[this.stack.length-1];Tr.value=pr}function Cn(){const pr=this.resume(),Tr=this.stack[this.stack.length-1];Tr.value=pr}function $n(){const pr=this.stack[this.stack.length-1];if(this.data.inReference){const Tr=this.data.referenceType||"shortcut";pr.type+="Reference",pr.referenceType=Tr,delete pr.url,delete pr.title}else delete pr.identifier,delete pr.label;this.data.referenceType=void 0}function wn(){const pr=this.stack[this.stack.length-1];if(this.data.inReference){const Tr=this.data.referenceType||"shortcut";pr.type+="Reference",pr.referenceType=Tr,delete pr.url,delete pr.title}else delete pr.identifier,delete pr.label;this.data.referenceType=void 0}function Rn(pr){const Tr=this.sliceSerialize(pr),Hr=this.stack[this.stack.length-2];Hr.label=decodeString(Tr),Hr.identifier=normalizeIdentifier(Tr).toLowerCase()}function Dn(){const pr=this.stack[this.stack.length-1],Tr=this.resume(),Hr=this.stack[this.stack.length-1];if(this.data.inReference=!0,Hr.type==="link"){const Xr=pr.children;Hr.children=Xr}else Hr.alt=Tr}function An(){const pr=this.resume(),Tr=this.stack[this.stack.length-1];Tr.url=pr}function Sn(){const pr=this.resume(),Tr=this.stack[this.stack.length-1];Tr.title=pr}function vn(){this.data.inReference=void 0}function _n(){this.data.referenceType="collapsed"}function Tn(pr){const Tr=this.resume(),Hr=this.stack[this.stack.length-1];Hr.label=Tr,Hr.identifier=normalizeIdentifier(this.sliceSerialize(pr)).toLowerCase(),this.data.referenceType="full"}function Pn(pr){this.data.characterReferenceType=pr.type}function Ln(pr){const Tr=this.sliceSerialize(pr),Hr=this.data.characterReferenceType;let Xr;Hr?(Xr=decodeNumericCharacterReference(Tr,Hr==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Xr=decodeNamedCharacterReference(Tr);const Zr=this.stack[this.stack.length-1];Zr.value+=Xr}function Vn(pr){const Tr=this.stack.pop();Tr.position.end=point$9(pr.end)}function Un(pr){yn.call(this,pr);const Tr=this.stack[this.stack.length-1];Tr.url=this.sliceSerialize(pr)}function Wn(pr){yn.call(this,pr);const Tr=this.stack[this.stack.length-1];Tr.url="mailto:"+this.sliceSerialize(pr)}function rr(){return{type:"blockquote",children:[]}}function ar(){return{type:"code",lang:null,meta:null,value:""}}function nr(){return{type:"inlineCode",value:""}}function mr(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function kn(){return{type:"emphasis",children:[]}}function Fn(){return{type:"heading",depth:0,children:[]}}function Hn(){return{type:"break"}}function Bn(){return{type:"html",value:""}}function jn(){return{type:"image",title:null,url:"",alt:null}}function sr(){return{type:"link",title:null,url:"",children:[]}}function Ar(pr){return{type:"list",ordered:pr.type==="listOrdered",start:null,spread:pr._spread,children:[]}}function Fr(pr){return{type:"listItem",spread:pr._spread,checked:null,children:[]}}function Rr(){return{type:"paragraph",children:[]}}function Qn(){return{type:"strong",children:[]}}function jr(){return{type:"text",value:""}}function Mr(){return{type:"thematicBreak"}}}function point$9(xt){return{line:xt.line,column:xt.column,offset:xt.offset}}function configure(xt,$t){let Ct=-1;for(;++Ct<$t.length;){const kt=$t[Ct];Array.isArray(kt)?configure(xt,kt):extension$1(xt,kt)}}function extension$1(xt,$t){let Ct;for(Ct in $t)if(own$6.call($t,Ct))switch(Ct){case"canContainEols":{const kt=$t[Ct];kt&&xt[Ct].push(...kt);break}case"transforms":{const kt=$t[Ct];kt&&xt[Ct].push(...kt);break}case"enter":case"exit":{const kt=$t[Ct];kt&&Object.assign(xt[Ct],kt);break}}}function defaultOnError(xt,$t){throw xt?new Error("Cannot close `"+xt.type+"` ("+stringifyPosition({start:xt.start,end:xt.end})+"): a different token (`"+$t.type+"`, "+stringifyPosition({start:$t.start,end:$t.end})+") is open"):new Error("Cannot close document, a token (`"+$t.type+"`, "+stringifyPosition({start:$t.start,end:$t.end})+") is still open")}function remarkParse(xt){const $t=this;$t.parser=Ct;function Ct(kt){return fromMarkdown(kt,{...$t.data("settings"),...xt,extensions:$t.data("micromarkExtensions")||[],mdastExtensions:$t.data("fromMarkdownExtensions")||[]})}}function blockquote(xt,$t){const Ct={type:"element",tagName:"blockquote",properties:{},children:xt.wrap(xt.all($t),!0)};return xt.patch($t,Ct),xt.applyData($t,Ct)}function hardBreak(xt,$t){const Ct={type:"element",tagName:"br",properties:{},children:[]};return xt.patch($t,Ct),[xt.applyData($t,Ct),{type:"text",value:`
`}]}function code$2(xt,$t){const Ct=$t.value?$t.value+`
`:"",kt={};$t.lang&&(kt.className=["language-"+$t.lang]);let Mt={type:"element",tagName:"code",properties:kt,children:[{type:"text",value:Ct}]};return $t.meta&&(Mt.data={meta:$t.meta}),xt.patch($t,Mt),Mt=xt.applyData($t,Mt),Mt={type:"element",tagName:"pre",properties:{},children:[Mt]},xt.patch($t,Mt),Mt}function strikethrough(xt,$t){const Ct={type:"element",tagName:"del",properties:{},children:xt.all($t)};return xt.patch($t,Ct),xt.applyData($t,Ct)}function emphasis(xt,$t){const Ct={type:"element",tagName:"em",properties:{},children:xt.all($t)};return xt.patch($t,Ct),xt.applyData($t,Ct)}function footnoteReference(xt,$t){const Ct=typeof xt.options.clobberPrefix=="string"?xt.options.clobberPrefix:"user-content-",kt=String($t.identifier).toUpperCase(),Mt=normalizeUri(kt.toLowerCase()),Ft=xt.footnoteOrder.indexOf(kt);let jt,Bt=xt.footnoteCounts.get(kt);Bt===void 0?(Bt=0,xt.footnoteOrder.push(kt),jt=xt.footnoteOrder.length):jt=Ft+1,Bt+=1,xt.footnoteCounts.set(kt,Bt);const Vt={type:"element",tagName:"a",properties:{href:"#"+Ct+"fn-"+Mt,id:Ct+"fnref-"+Mt+(Bt>1?"-"+Bt:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(jt)}]};xt.patch($t,Vt);const zt={type:"element",tagName:"sup",properties:{},children:[Vt]};return xt.patch($t,zt),xt.applyData($t,zt)}function heading(xt,$t){const Ct={type:"element",tagName:"h"+$t.depth,properties:{},children:xt.all($t)};return xt.patch($t,Ct),xt.applyData($t,Ct)}function html(xt,$t){if(xt.options.allowDangerousHtml){const Ct={type:"raw",value:$t.value};return xt.patch($t,Ct),xt.applyData($t,Ct)}}function revert(xt,$t){const Ct=$t.referenceType;let kt="]";if(Ct==="collapsed"?kt+="[]":Ct==="full"&&(kt+="["+($t.label||$t.identifier)+"]"),$t.type==="imageReference")return[{type:"text",value:"!["+$t.alt+kt}];const Mt=xt.all($t),Ft=Mt[0];Ft&&Ft.type==="text"?Ft.value="["+Ft.value:Mt.unshift({type:"text",value:"["});const jt=Mt[Mt.length-1];return jt&&jt.type==="text"?jt.value+=kt:Mt.push({type:"text",value:kt}),Mt}function imageReference(xt,$t){const Ct=String($t.identifier).toUpperCase(),kt=xt.definitionById.get(Ct);if(!kt)return revert(xt,$t);const Mt={src:normalizeUri(kt.url||""),alt:$t.alt};kt.title!==null&&kt.title!==void 0&&(Mt.title=kt.title);const Ft={type:"element",tagName:"img",properties:Mt,children:[]};return xt.patch($t,Ft),xt.applyData($t,Ft)}function image$2(xt,$t){const Ct={src:normalizeUri($t.url)};$t.alt!==null&&$t.alt!==void 0&&(Ct.alt=$t.alt),$t.title!==null&&$t.title!==void 0&&(Ct.title=$t.title);const kt={type:"element",tagName:"img",properties:Ct,children:[]};return xt.patch($t,kt),xt.applyData($t,kt)}function inlineCode(xt,$t){const Ct={type:"text",value:$t.value.replace(/\r?\n|\r/g," ")};xt.patch($t,Ct);const kt={type:"element",tagName:"code",properties:{},children:[Ct]};return xt.patch($t,kt),xt.applyData($t,kt)}function linkReference(xt,$t){const Ct=String($t.identifier).toUpperCase(),kt=xt.definitionById.get(Ct);if(!kt)return revert(xt,$t);const Mt={href:normalizeUri(kt.url||"")};kt.title!==null&&kt.title!==void 0&&(Mt.title=kt.title);const Ft={type:"element",tagName:"a",properties:Mt,children:xt.all($t)};return xt.patch($t,Ft),xt.applyData($t,Ft)}function link$1(xt,$t){const Ct={href:normalizeUri($t.url)};$t.title!==null&&$t.title!==void 0&&(Ct.title=$t.title);const kt={type:"element",tagName:"a",properties:Ct,children:xt.all($t)};return xt.patch($t,kt),xt.applyData($t,kt)}function listItem(xt,$t,Ct){const kt=xt.all($t),Mt=Ct?listLoose(Ct):listItemLoose($t),Ft={},jt=[];if(typeof $t.checked=="boolean"){const Ht=kt[0];let Gt;Ht&&Ht.type==="element"&&Ht.tagName==="p"?Gt=Ht:(Gt={type:"element",tagName:"p",properties:{},children:[]},kt.unshift(Gt)),Gt.children.length>0&&Gt.children.unshift({type:"text",value:" "}),Gt.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:$t.checked,disabled:!0},children:[]}),Ft.className=["task-list-item"]}let Bt=-1;for(;++Bt<kt.length;){const Ht=kt[Bt];(Mt||Bt!==0||Ht.type!=="element"||Ht.tagName!=="p")&&jt.push({type:"text",value:`
`}),Ht.type==="element"&&Ht.tagName==="p"&&!Mt?jt.push(...Ht.children):jt.push(Ht)}const Vt=kt[kt.length-1];Vt&&(Mt||Vt.type!=="element"||Vt.tagName!=="p")&&jt.push({type:"text",value:`
`});const zt={type:"element",tagName:"li",properties:Ft,children:jt};return xt.patch($t,zt),xt.applyData($t,zt)}function listLoose(xt){let $t=!1;if(xt.type==="list"){$t=xt.spread||!1;const Ct=xt.children;let kt=-1;for(;!$t&&++kt<Ct.length;)$t=listItemLoose(Ct[kt])}return $t}function listItemLoose(xt){const $t=xt.spread;return $t??xt.children.length>1}function list$5(xt,$t){const Ct={},kt=xt.all($t);let Mt=-1;for(typeof $t.start=="number"&&$t.start!==1&&(Ct.start=$t.start);++Mt<kt.length;){const jt=kt[Mt];if(jt.type==="element"&&jt.tagName==="li"&&jt.properties&&Array.isArray(jt.properties.className)&&jt.properties.className.includes("task-list-item")){Ct.className=["contains-task-list"];break}}const Ft={type:"element",tagName:$t.ordered?"ol":"ul",properties:Ct,children:xt.wrap(kt,!0)};return xt.patch($t,Ft),xt.applyData($t,Ft)}function paragraph(xt,$t){const Ct={type:"element",tagName:"p",properties:{},children:xt.all($t)};return xt.patch($t,Ct),xt.applyData($t,Ct)}function root$4(xt,$t){const Ct={type:"root",children:xt.wrap(xt.all($t))};return xt.patch($t,Ct),xt.applyData($t,Ct)}function strong(xt,$t){const Ct={type:"element",tagName:"strong",properties:{},children:xt.all($t)};return xt.patch($t,Ct),xt.applyData($t,Ct)}function table$1(xt,$t){const Ct=xt.all($t),kt=Ct.shift(),Mt=[];if(kt){const jt={type:"element",tagName:"thead",properties:{},children:xt.wrap([kt],!0)};xt.patch($t.children[0],jt),Mt.push(jt)}if(Ct.length>0){const jt={type:"element",tagName:"tbody",properties:{},children:xt.wrap(Ct,!0)},Bt=pointStart($t.children[1]),Vt=pointEnd($t.children[$t.children.length-1]);Bt&&Vt&&(jt.position={start:Bt,end:Vt}),Mt.push(jt)}const Ft={type:"element",tagName:"table",properties:{},children:xt.wrap(Mt,!0)};return xt.patch($t,Ft),xt.applyData($t,Ft)}function tableRow(xt,$t,Ct){const kt=Ct?Ct.children:void 0,Ft=(kt?kt.indexOf($t):1)===0?"th":"td",jt=Ct&&Ct.type==="table"?Ct.align:void 0,Bt=jt?jt.length:$t.children.length;let Vt=-1;const zt=[];for(;++Vt<Bt;){const Gt=$t.children[Vt],qt={},Wt=jt?jt[Vt]:void 0;Wt&&(qt.align=Wt);let Yt={type:"element",tagName:Ft,properties:qt,children:[]};Gt&&(Yt.children=xt.all(Gt),xt.patch(Gt,Yt),Yt=xt.applyData(Gt,Yt)),zt.push(Yt)}const Ht={type:"element",tagName:"tr",properties:{},children:xt.wrap(zt,!0)};return xt.patch($t,Ht),xt.applyData($t,Ht)}function tableCell(xt,$t){const Ct={type:"element",tagName:"td",properties:{},children:xt.all($t)};return xt.patch($t,Ct),xt.applyData($t,Ct)}const tab=9,space=32;function trimLines(xt){const $t=String(xt),Ct=/\r?\n|\r/g;let kt=Ct.exec($t),Mt=0;const Ft=[];for(;kt;)Ft.push(trimLine($t.slice(Mt,kt.index),Mt>0,!0),kt[0]),Mt=kt.index+kt[0].length,kt=Ct.exec($t);return Ft.push(trimLine($t.slice(Mt),Mt>0,!1)),Ft.join("")}function trimLine(xt,$t,Ct){let kt=0,Mt=xt.length;if($t){let Ft=xt.codePointAt(kt);for(;Ft===tab||Ft===space;)kt++,Ft=xt.codePointAt(kt)}if(Ct){let Ft=xt.codePointAt(Mt-1);for(;Ft===tab||Ft===space;)Mt--,Ft=xt.codePointAt(Mt-1)}return Mt>kt?xt.slice(kt,Mt):""}function text$6(xt,$t){const Ct={type:"text",value:trimLines(String($t.value))};return xt.patch($t,Ct),xt.applyData($t,Ct)}function thematicBreak(xt,$t){const Ct={type:"element",tagName:"hr",properties:{},children:[]};return xt.patch($t,Ct),xt.applyData($t,Ct)}const handlers={blockquote,break:hardBreak,code:code$2,delete:strikethrough,emphasis,footnoteReference,heading,html,imageReference,image:image$2,inlineCode,linkReference,link:link$1,listItem,list:list$5,paragraph,root:root$4,strong,table:table$1,tableCell,tableRow,text:text$6,thematicBreak,toml:ignore,yaml:ignore,definition:ignore,footnoteDefinition:ignore};function ignore(){}const VOID=-1,PRIMITIVE=0,ARRAY=1,OBJECT=2,DATE$1=3,REGEXP=4,MAP=5,SET=6,ERROR=7,BIGINT=8,env=typeof self=="object"?self:globalThis,deserializer=(xt,$t)=>{const Ct=(Mt,Ft)=>(xt.set(Ft,Mt),Mt),kt=Mt=>{if(xt.has(Mt))return xt.get(Mt);const[Ft,jt]=$t[Mt];switch(Ft){case PRIMITIVE:case VOID:return Ct(jt,Mt);case ARRAY:{const Bt=Ct([],Mt);for(const Vt of jt)Bt.push(kt(Vt));return Bt}case OBJECT:{const Bt=Ct({},Mt);for(const[Vt,zt]of jt)Bt[kt(Vt)]=kt(zt);return Bt}case DATE$1:return Ct(new Date(jt),Mt);case REGEXP:{const{source:Bt,flags:Vt}=jt;return Ct(new RegExp(Bt,Vt),Mt)}case MAP:{const Bt=Ct(new Map,Mt);for(const[Vt,zt]of jt)Bt.set(kt(Vt),kt(zt));return Bt}case SET:{const Bt=Ct(new Set,Mt);for(const Vt of jt)Bt.add(kt(Vt));return Bt}case ERROR:{const{name:Bt,message:Vt}=jt;return Ct(new env[Bt](Vt),Mt)}case BIGINT:return Ct(BigInt(jt),Mt);case"BigInt":return Ct(Object(BigInt(jt)),Mt)}return Ct(new env[Ft](jt),Mt)};return kt},deserialize=xt=>deserializer(new Map,xt)(0),EMPTY$2="",{toString:toString$3}={},{keys:keys$3}=Object,typeOf=xt=>{const $t=typeof xt;if($t!=="object"||!xt)return[PRIMITIVE,$t];const Ct=toString$3.call(xt).slice(8,-1);switch(Ct){case"Array":return[ARRAY,EMPTY$2];case"Object":return[OBJECT,EMPTY$2];case"Date":return[DATE$1,EMPTY$2];case"RegExp":return[REGEXP,EMPTY$2];case"Map":return[MAP,EMPTY$2];case"Set":return[SET,EMPTY$2]}return Ct.includes("Array")?[ARRAY,Ct]:Ct.includes("Error")?[ERROR,Ct]:[OBJECT,Ct]},shouldSkip=([xt,$t])=>xt===PRIMITIVE&&($t==="function"||$t==="symbol"),serializer=(xt,$t,Ct,kt)=>{const Mt=(jt,Bt)=>{const Vt=kt.push(jt)-1;return Ct.set(Bt,Vt),Vt},Ft=jt=>{if(Ct.has(jt))return Ct.get(jt);let[Bt,Vt]=typeOf(jt);switch(Bt){case PRIMITIVE:{let Ht=jt;switch(Vt){case"bigint":Bt=BIGINT,Ht=jt.toString();break;case"function":case"symbol":if(xt)throw new TypeError("unable to serialize "+Vt);Ht=null;break;case"undefined":return Mt([VOID],jt)}return Mt([Bt,Ht],jt)}case ARRAY:{if(Vt)return Mt([Vt,[...jt]],jt);const Ht=[],Gt=Mt([Bt,Ht],jt);for(const qt of jt)Ht.push(Ft(qt));return Gt}case OBJECT:{if(Vt)switch(Vt){case"BigInt":return Mt([Vt,jt.toString()],jt);case"Boolean":case"Number":case"String":return Mt([Vt,jt.valueOf()],jt)}if($t&&"toJSON"in jt)return Ft(jt.toJSON());const Ht=[],Gt=Mt([Bt,Ht],jt);for(const qt of keys$3(jt))(xt||!shouldSkip(typeOf(jt[qt])))&&Ht.push([Ft(qt),Ft(jt[qt])]);return Gt}case DATE$1:return Mt([Bt,jt.toISOString()],jt);case REGEXP:{const{source:Ht,flags:Gt}=jt;return Mt([Bt,{source:Ht,flags:Gt}],jt)}case MAP:{const Ht=[],Gt=Mt([Bt,Ht],jt);for(const[qt,Wt]of jt)(xt||!(shouldSkip(typeOf(qt))||shouldSkip(typeOf(Wt))))&&Ht.push([Ft(qt),Ft(Wt)]);return Gt}case SET:{const Ht=[],Gt=Mt([Bt,Ht],jt);for(const qt of jt)(xt||!shouldSkip(typeOf(qt)))&&Ht.push(Ft(qt));return Gt}}const{message:zt}=jt;return Mt([Bt,{name:Vt,message:zt}],jt)};return Ft},serialize$1=(xt,{json:$t,lossy:Ct}={})=>{const kt=[];return serializer(!($t||Ct),!!$t,new Map,kt)(xt),kt},structuredClone$1=typeof structuredClone=="function"?(xt,$t)=>$t&&("json"in $t||"lossy"in $t)?deserialize(serialize$1(xt,$t)):structuredClone(xt):(xt,$t)=>deserialize(serialize$1(xt,$t));function defaultFootnoteBackContent(xt,$t){const Ct=[{type:"text",value:""}];return $t>1&&Ct.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String($t)}]}),Ct}function defaultFootnoteBackLabel(xt,$t){return"Back to reference "+(xt+1)+($t>1?"-"+$t:"")}function footer(xt){const $t=typeof xt.options.clobberPrefix=="string"?xt.options.clobberPrefix:"user-content-",Ct=xt.options.footnoteBackContent||defaultFootnoteBackContent,kt=xt.options.footnoteBackLabel||defaultFootnoteBackLabel,Mt=xt.options.footnoteLabel||"Footnotes",Ft=xt.options.footnoteLabelTagName||"h2",jt=xt.options.footnoteLabelProperties||{className:["sr-only"]},Bt=[];let Vt=-1;for(;++Vt<xt.footnoteOrder.length;){const zt=xt.footnoteById.get(xt.footnoteOrder[Vt]);if(!zt)continue;const Ht=xt.all(zt),Gt=String(zt.identifier).toUpperCase(),qt=normalizeUri(Gt.toLowerCase());let Wt=0;const Yt=[],Kt=xt.footnoteCounts.get(Gt);for(;Kt!==void 0&&++Wt<=Kt;){Yt.length>0&&Yt.push({type:"text",value:" "});let Jt=typeof Ct=="string"?Ct:Ct(Vt,Wt);typeof Jt=="string"&&(Jt={type:"text",value:Jt}),Yt.push({type:"element",tagName:"a",properties:{href:"#"+$t+"fnref-"+qt+(Wt>1?"-"+Wt:""),dataFootnoteBackref:"",ariaLabel:typeof kt=="string"?kt:kt(Vt,Wt),className:["data-footnote-backref"]},children:Array.isArray(Jt)?Jt:[Jt]})}const Xt=Ht[Ht.length-1];if(Xt&&Xt.type==="element"&&Xt.tagName==="p"){const Jt=Xt.children[Xt.children.length-1];Jt&&Jt.type==="text"?Jt.value+=" ":Xt.children.push({type:"text",value:" "}),Xt.children.push(...Yt)}else Ht.push(...Yt);const Qt={type:"element",tagName:"li",properties:{id:$t+"fn-"+qt},children:xt.wrap(Ht,!0)};xt.patch(zt,Qt),Bt.push(Qt)}if(Bt.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:Ft,properties:{...structuredClone$1(jt),id:"footnote-label"},children:[{type:"text",value:Mt}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:xt.wrap(Bt,!0)},{type:"text",value:`
`}]}}const convert=function(xt){if(xt==null)return ok;if(typeof xt=="function")return castFactory(xt);if(typeof xt=="object")return Array.isArray(xt)?anyFactory(xt):propsFactory(xt);if(typeof xt=="string")return typeFactory(xt);throw new Error("Expected function, string, or object as test")};function anyFactory(xt){const $t=[];let Ct=-1;for(;++Ct<xt.length;)$t[Ct]=convert(xt[Ct]);return castFactory(kt);function kt(...Mt){let Ft=-1;for(;++Ft<$t.length;)if($t[Ft].apply(this,Mt))return!0;return!1}}function propsFactory(xt){const $t=xt;return castFactory(Ct);function Ct(kt){const Mt=kt;let Ft;for(Ft in xt)if(Mt[Ft]!==$t[Ft])return!1;return!0}}function typeFactory(xt){return castFactory($t);function $t(Ct){return Ct&&Ct.type===xt}}function castFactory(xt){return $t;function $t(Ct,kt,Mt){return!!(looksLikeANode(Ct)&&xt.call(this,Ct,typeof kt=="number"?kt:void 0,Mt||void 0))}}function ok(){return!0}function looksLikeANode(xt){return xt!==null&&typeof xt=="object"&&"type"in xt}function color$4(xt){return xt}const empty$4=[],CONTINUE=!0,EXIT=!1,SKIP$3="skip";function visitParents(xt,$t,Ct,kt){let Mt;typeof $t=="function"&&typeof Ct!="function"?(kt=Ct,Ct=$t):Mt=$t;const Ft=convert(Mt),jt=kt?-1:1;Bt(xt,void 0,[])();function Bt(Vt,zt,Ht){const Gt=Vt&&typeof Vt=="object"?Vt:{};if(typeof Gt.type=="string"){const Wt=typeof Gt.tagName=="string"?Gt.tagName:typeof Gt.name=="string"?Gt.name:void 0;Object.defineProperty(qt,"name",{value:"node ("+(Vt.type+(Wt?"<"+Wt+">":""))+")"})}return qt;function qt(){let Wt=empty$4,Yt,Kt,Xt;if((!$t||Ft(Vt,zt,Ht[Ht.length-1]||void 0))&&(Wt=toResult(Ct(Vt,Ht)),Wt[0]===EXIT))return Wt;if("children"in Vt&&Vt.children){const Qt=Vt;if(Qt.children&&Wt[0]!==SKIP$3)for(Kt=(kt?Qt.children.length:-1)+jt,Xt=Ht.concat(Qt);Kt>-1&&Kt<Qt.children.length;){const Jt=Qt.children[Kt];if(Yt=Bt(Jt,Kt,Xt)(),Yt[0]===EXIT)return Yt;Kt=typeof Yt[1]=="number"?Yt[1]:Kt+jt}}return Wt}}}function toResult(xt){return Array.isArray(xt)?xt:typeof xt=="number"?[CONTINUE,xt]:xt==null?empty$4:[xt]}function visit$2(xt,$t,Ct,kt){let Mt,Ft,jt;typeof $t=="function"&&typeof Ct!="function"?(Ft=void 0,jt=$t,Mt=Ct):(Ft=$t,jt=Ct,Mt=kt),visitParents(xt,Ft,Bt,Mt);function Bt(Vt,zt){const Ht=zt[zt.length-1],Gt=Ht?Ht.children.indexOf(Vt):void 0;return jt(Vt,Gt,Ht)}}const own$5={}.hasOwnProperty,emptyOptions$1={};function createState(xt,$t){const Ct=$t||emptyOptions$1,kt=new Map,Mt=new Map,Ft=new Map,jt={...handlers,...Ct.handlers},Bt={all:zt,applyData,definitionById:kt,footnoteById:Mt,footnoteCounts:Ft,footnoteOrder:[],handlers:jt,one:Vt,options:Ct,patch:patch$3,wrap:wrap$4};return visit$2(xt,function(Ht){if(Ht.type==="definition"||Ht.type==="footnoteDefinition"){const Gt=Ht.type==="definition"?kt:Mt,qt=String(Ht.identifier).toUpperCase();Gt.has(qt)||Gt.set(qt,Ht)}}),Bt;function Vt(Ht,Gt){const qt=Ht.type,Wt=Bt.handlers[qt];if(own$5.call(Bt.handlers,qt)&&Wt)return Wt(Bt,Ht,Gt);if(Bt.options.passThrough&&Bt.options.passThrough.includes(qt)){if("children"in Ht){const{children:Kt,...Xt}=Ht,Qt=structuredClone$1(Xt);return Qt.children=Bt.all(Ht),Qt}return structuredClone$1(Ht)}return(Bt.options.unknownHandler||defaultUnknownHandler)(Bt,Ht,Gt)}function zt(Ht){const Gt=[];if("children"in Ht){const qt=Ht.children;let Wt=-1;for(;++Wt<qt.length;){const Yt=Bt.one(qt[Wt],Ht);if(Yt){if(Wt&&qt[Wt-1].type==="break"&&(!Array.isArray(Yt)&&Yt.type==="text"&&(Yt.value=trimMarkdownSpaceStart(Yt.value)),!Array.isArray(Yt)&&Yt.type==="element")){const Kt=Yt.children[0];Kt&&Kt.type==="text"&&(Kt.value=trimMarkdownSpaceStart(Kt.value))}Array.isArray(Yt)?Gt.push(...Yt):Gt.push(Yt)}}}return Gt}}function patch$3(xt,$t){xt.position&&($t.position=position$3(xt))}function applyData(xt,$t){let Ct=$t;if(xt&&xt.data){const kt=xt.data.hName,Mt=xt.data.hChildren,Ft=xt.data.hProperties;if(typeof kt=="string")if(Ct.type==="element")Ct.tagName=kt;else{const jt="children"in Ct?Ct.children:[Ct];Ct={type:"element",tagName:kt,properties:{},children:jt}}Ct.type==="element"&&Ft&&Object.assign(Ct.properties,structuredClone$1(Ft)),"children"in Ct&&Ct.children&&Mt!==null&&Mt!==void 0&&(Ct.children=Mt)}return Ct}function defaultUnknownHandler(xt,$t){const Ct=$t.data||{},kt="value"in $t&&!(own$5.call(Ct,"hProperties")||own$5.call(Ct,"hChildren"))?{type:"text",value:$t.value}:{type:"element",tagName:"div",properties:{},children:xt.all($t)};return xt.patch($t,kt),xt.applyData($t,kt)}function wrap$4(xt,$t){const Ct=[];let kt=-1;for($t&&Ct.push({type:"text",value:`
`});++kt<xt.length;)kt&&Ct.push({type:"text",value:`
`}),Ct.push(xt[kt]);return $t&&xt.length>0&&Ct.push({type:"text",value:`
`}),Ct}function trimMarkdownSpaceStart(xt){let $t=0,Ct=xt.charCodeAt($t);for(;Ct===9||Ct===32;)$t++,Ct=xt.charCodeAt($t);return xt.slice($t)}function toHast(xt,$t){const Ct=createState(xt,$t),kt=Ct.one(xt,void 0),Mt=footer(Ct),Ft=Array.isArray(kt)?{type:"root",children:kt}:kt||{type:"root",children:[]};return Mt&&Ft.children.push({type:"text",value:`
`},Mt),Ft}function remarkRehype(xt,$t){return xt&&"run"in xt?async function(Ct,kt){const Mt=toHast(Ct,{file:kt,...$t});await xt.run(Mt,kt)}:function(Ct,kt){return toHast(Ct,{file:kt,...$t||xt})}}function bail(xt){if(xt)throw xt}var hasOwn$1=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,defineProperty=Object.defineProperty,gOPD=Object.getOwnPropertyDescriptor,isArray$4=function($t){return typeof Array.isArray=="function"?Array.isArray($t):toStr.call($t)==="[object Array]"},isPlainObject$5=function($t){if(!$t||toStr.call($t)!=="[object Object]")return!1;var Ct=hasOwn$1.call($t,"constructor"),kt=$t.constructor&&$t.constructor.prototype&&hasOwn$1.call($t.constructor.prototype,"isPrototypeOf");if($t.constructor&&!Ct&&!kt)return!1;var Mt;for(Mt in $t);return typeof Mt>"u"||hasOwn$1.call($t,Mt)},setProperty=function($t,Ct){defineProperty&&Ct.name==="__proto__"?defineProperty($t,Ct.name,{enumerable:!0,configurable:!0,value:Ct.newValue,writable:!0}):$t[Ct.name]=Ct.newValue},getProperty=function($t,Ct){if(Ct==="__proto__")if(hasOwn$1.call($t,Ct)){if(gOPD)return gOPD($t,Ct).value}else return;return $t[Ct]},extend$2=function xt(){var $t,Ct,kt,Mt,Ft,jt,Bt=arguments[0],Vt=1,zt=arguments.length,Ht=!1;for(typeof Bt=="boolean"&&(Ht=Bt,Bt=arguments[1]||{},Vt=2),(Bt==null||typeof Bt!="object"&&typeof Bt!="function")&&(Bt={});Vt<zt;++Vt)if($t=arguments[Vt],$t!=null)for(Ct in $t)kt=getProperty(Bt,Ct),Mt=getProperty($t,Ct),Bt!==Mt&&(Ht&&Mt&&(isPlainObject$5(Mt)||(Ft=isArray$4(Mt)))?(Ft?(Ft=!1,jt=kt&&isArray$4(kt)?kt:[]):jt=kt&&isPlainObject$5(kt)?kt:{},setProperty(Bt,{name:Ct,newValue:xt(Ht,jt,Mt)})):typeof Mt<"u"&&setProperty(Bt,{name:Ct,newValue:Mt}));return Bt};const extend$3=getDefaultExportFromCjs$1(extend$2);function isPlainObject$4(xt){if(typeof xt!="object"||xt===null)return!1;const $t=Object.getPrototypeOf(xt);return($t===null||$t===Object.prototype||Object.getPrototypeOf($t)===null)&&!(Symbol.toStringTag in xt)&&!(Symbol.iterator in xt)}function trough(){const xt=[],$t={run:Ct,use:kt};return $t;function Ct(...Mt){let Ft=-1;const jt=Mt.pop();if(typeof jt!="function")throw new TypeError("Expected function as last argument, not "+jt);Bt(null,...Mt);function Bt(Vt,...zt){const Ht=xt[++Ft];let Gt=-1;if(Vt){jt(Vt);return}for(;++Gt<Mt.length;)(zt[Gt]===null||zt[Gt]===void 0)&&(zt[Gt]=Mt[Gt]);Mt=zt,Ht?wrap$3(Ht,Bt)(...zt):jt(null,...zt)}}function kt(Mt){if(typeof Mt!="function")throw new TypeError("Expected `middelware` to be a function, not "+Mt);return xt.push(Mt),$t}}function wrap$3(xt,$t){let Ct;return kt;function kt(...jt){const Bt=xt.length>jt.length;let Vt;Bt&&jt.push(Mt);try{Vt=xt.apply(this,jt)}catch(zt){const Ht=zt;if(Bt&&Ct)throw Ht;return Mt(Ht)}Bt||(Vt&&Vt.then&&typeof Vt.then=="function"?Vt.then(Ft,Mt):Vt instanceof Error?Mt(Vt):Ft(Vt))}function Mt(jt,...Bt){Ct||(Ct=!0,$t(jt,...Bt))}function Ft(jt){Mt(null,jt)}}const path$4={basename,dirname,extname,join:join$2,sep:"/"};function basename(xt,$t){if($t!==void 0&&typeof $t!="string")throw new TypeError('"ext" argument must be a string');assertPath$1(xt);let Ct=0,kt=-1,Mt=xt.length,Ft;if($t===void 0||$t.length===0||$t.length>xt.length){for(;Mt--;)if(xt.codePointAt(Mt)===47){if(Ft){Ct=Mt+1;break}}else kt<0&&(Ft=!0,kt=Mt+1);return kt<0?"":xt.slice(Ct,kt)}if($t===xt)return"";let jt=-1,Bt=$t.length-1;for(;Mt--;)if(xt.codePointAt(Mt)===47){if(Ft){Ct=Mt+1;break}}else jt<0&&(Ft=!0,jt=Mt+1),Bt>-1&&(xt.codePointAt(Mt)===$t.codePointAt(Bt--)?Bt<0&&(kt=Mt):(Bt=-1,kt=jt));return Ct===kt?kt=jt:kt<0&&(kt=xt.length),xt.slice(Ct,kt)}function dirname(xt){if(assertPath$1(xt),xt.length===0)return".";let $t=-1,Ct=xt.length,kt;for(;--Ct;)if(xt.codePointAt(Ct)===47){if(kt){$t=Ct;break}}else kt||(kt=!0);return $t<0?xt.codePointAt(0)===47?"/":".":$t===1&&xt.codePointAt(0)===47?"//":xt.slice(0,$t)}function extname(xt){assertPath$1(xt);let $t=xt.length,Ct=-1,kt=0,Mt=-1,Ft=0,jt;for(;$t--;){const Bt=xt.codePointAt($t);if(Bt===47){if(jt){kt=$t+1;break}continue}Ct<0&&(jt=!0,Ct=$t+1),Bt===46?Mt<0?Mt=$t:Ft!==1&&(Ft=1):Mt>-1&&(Ft=-1)}return Mt<0||Ct<0||Ft===0||Ft===1&&Mt===Ct-1&&Mt===kt+1?"":xt.slice(Mt,Ct)}function join$2(...xt){let $t=-1,Ct;for(;++$t<xt.length;)assertPath$1(xt[$t]),xt[$t]&&(Ct=Ct===void 0?xt[$t]:Ct+"/"+xt[$t]);return Ct===void 0?".":normalize$3(Ct)}function normalize$3(xt){assertPath$1(xt);const $t=xt.codePointAt(0)===47;let Ct=normalizeString(xt,!$t);return Ct.length===0&&!$t&&(Ct="."),Ct.length>0&&xt.codePointAt(xt.length-1)===47&&(Ct+="/"),$t?"/"+Ct:Ct}function normalizeString(xt,$t){let Ct="",kt=0,Mt=-1,Ft=0,jt=-1,Bt,Vt;for(;++jt<=xt.length;){if(jt<xt.length)Bt=xt.codePointAt(jt);else{if(Bt===47)break;Bt=47}if(Bt===47){if(!(Mt===jt-1||Ft===1))if(Mt!==jt-1&&Ft===2){if(Ct.length<2||kt!==2||Ct.codePointAt(Ct.length-1)!==46||Ct.codePointAt(Ct.length-2)!==46){if(Ct.length>2){if(Vt=Ct.lastIndexOf("/"),Vt!==Ct.length-1){Vt<0?(Ct="",kt=0):(Ct=Ct.slice(0,Vt),kt=Ct.length-1-Ct.lastIndexOf("/")),Mt=jt,Ft=0;continue}}else if(Ct.length>0){Ct="",kt=0,Mt=jt,Ft=0;continue}}$t&&(Ct=Ct.length>0?Ct+"/..":"..",kt=2)}else Ct.length>0?Ct+="/"+xt.slice(Mt+1,jt):Ct=xt.slice(Mt+1,jt),kt=jt-Mt-1;Mt=jt,Ft=0}else Bt===46&&Ft>-1?Ft++:Ft=-1}return Ct}function assertPath$1(xt){if(typeof xt!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(xt))}const proc={cwd};function cwd(){return"/"}function isUrl$1(xt){return!!(xt!==null&&typeof xt=="object"&&"href"in xt&&xt.href&&"protocol"in xt&&xt.protocol&&xt.auth===void 0)}function urlToPath(xt){if(typeof xt=="string")xt=new URL(xt);else if(!isUrl$1(xt)){const $t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+xt+"`");throw $t.code="ERR_INVALID_ARG_TYPE",$t}if(xt.protocol!=="file:"){const $t=new TypeError("The URL must be of scheme file");throw $t.code="ERR_INVALID_URL_SCHEME",$t}return getPathFromURLPosix(xt)}function getPathFromURLPosix(xt){if(xt.hostname!==""){const kt=new TypeError('File URL host must be "localhost" or empty on darwin');throw kt.code="ERR_INVALID_FILE_URL_HOST",kt}const $t=xt.pathname;let Ct=-1;for(;++Ct<$t.length;)if($t.codePointAt(Ct)===37&&$t.codePointAt(Ct+1)===50){const kt=$t.codePointAt(Ct+2);if(kt===70||kt===102){const Mt=new TypeError("File URL path must not include encoded / characters");throw Mt.code="ERR_INVALID_FILE_URL_PATH",Mt}}return decodeURIComponent($t)}const order=["history","path","basename","stem","extname","dirname"];class VFile{constructor($t){let Ct;$t?isUrl$1($t)?Ct={path:$t}:typeof $t=="string"||isUint8Array$1($t)?Ct={value:$t}:Ct=$t:Ct={},this.cwd=proc.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let kt=-1;for(;++kt<order.length;){const Ft=order[kt];Ft in Ct&&Ct[Ft]!==void 0&&Ct[Ft]!==null&&(this[Ft]=Ft==="history"?[...Ct[Ft]]:Ct[Ft])}let Mt;for(Mt in Ct)order.includes(Mt)||(this[Mt]=Ct[Mt])}get basename(){return typeof this.path=="string"?path$4.basename(this.path):void 0}set basename($t){assertNonEmpty($t,"basename"),assertPart($t,"basename"),this.path=path$4.join(this.dirname||"",$t)}get dirname(){return typeof this.path=="string"?path$4.dirname(this.path):void 0}set dirname($t){assertPath(this.basename,"dirname"),this.path=path$4.join($t||"",this.basename)}get extname(){return typeof this.path=="string"?path$4.extname(this.path):void 0}set extname($t){if(assertPart($t,"extname"),assertPath(this.dirname,"extname"),$t){if($t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if($t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=path$4.join(this.dirname,this.stem+($t||""))}get path(){return this.history[this.history.length-1]}set path($t){isUrl$1($t)&&($t=urlToPath($t)),assertNonEmpty($t,"path"),this.path!==$t&&this.history.push($t)}get stem(){return typeof this.path=="string"?path$4.basename(this.path,this.extname):void 0}set stem($t){assertNonEmpty($t,"stem"),assertPart($t,"stem"),this.path=path$4.join(this.dirname||"",$t+(this.extname||""))}fail($t,Ct,kt){const Mt=this.message($t,Ct,kt);throw Mt.fatal=!0,Mt}info($t,Ct,kt){const Mt=this.message($t,Ct,kt);return Mt.fatal=void 0,Mt}message($t,Ct,kt){const Mt=new VFileMessage($t,Ct,kt);return this.path&&(Mt.name=this.path+":"+Mt.name,Mt.file=this.path),Mt.fatal=!1,this.messages.push(Mt),Mt}toString($t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder($t||void 0).decode(this.value)}}function assertPart(xt,$t){if(xt&&xt.includes(path$4.sep))throw new Error("`"+$t+"` cannot be a path: did not expect `"+path$4.sep+"`")}function assertNonEmpty(xt,$t){if(!xt)throw new Error("`"+$t+"` cannot be empty")}function assertPath(xt,$t){if(!xt)throw new Error("Setting `"+$t+"` requires `path` to be set too")}function isUint8Array$1(xt){return!!(xt&&typeof xt=="object"&&"byteLength"in xt&&"byteOffset"in xt)}const CallableInstance=function(xt){const kt=this.constructor.prototype,Mt=kt[xt],Ft=function(){return Mt.apply(Ft,arguments)};Object.setPrototypeOf(Ft,kt);const jt=Object.getOwnPropertyNames(Mt);for(const Bt of jt){const Vt=Object.getOwnPropertyDescriptor(Mt,Bt);Vt&&Object.defineProperty(Ft,Bt,Vt)}return Ft},own$4={}.hasOwnProperty;class Processor extends CallableInstance{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=trough()}copy(){const $t=new Processor;let Ct=-1;for(;++Ct<this.attachers.length;){const kt=this.attachers[Ct];$t.use(...kt)}return $t.data(extend$3(!0,{},this.namespace)),$t}data($t,Ct){return typeof $t=="string"?arguments.length===2?(assertUnfrozen("data",this.frozen),this.namespace[$t]=Ct,this):own$4.call(this.namespace,$t)&&this.namespace[$t]||void 0:$t?(assertUnfrozen("data",this.frozen),this.namespace=$t,this):this.namespace}freeze(){if(this.frozen)return this;const $t=this;for(;++this.freezeIndex<this.attachers.length;){const[Ct,...kt]=this.attachers[this.freezeIndex];if(kt[0]===!1)continue;kt[0]===!0&&(kt[0]=void 0);const Mt=Ct.call($t,...kt);typeof Mt=="function"&&this.transformers.use(Mt)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse($t){this.freeze();const Ct=vfile($t),kt=this.parser||this.Parser;return assertParser("parse",kt),kt(String(Ct),Ct)}process($t,Ct){const kt=this;return this.freeze(),assertParser("process",this.parser||this.Parser),assertCompiler("process",this.compiler||this.Compiler),Ct?Mt(void 0,Ct):new Promise(Mt);function Mt(Ft,jt){const Bt=vfile($t),Vt=kt.parse(Bt);kt.run(Vt,Bt,function(Ht,Gt,qt){if(Ht||!Gt||!qt)return zt(Ht);const Wt=Gt,Yt=kt.stringify(Wt,qt);looksLikeAValue(Yt)?qt.value=Yt:qt.result=Yt,zt(Ht,qt)});function zt(Ht,Gt){Ht||!Gt?jt(Ht):Ft?Ft(Gt):Ct(void 0,Gt)}}}processSync($t){let Ct=!1,kt;return this.freeze(),assertParser("processSync",this.parser||this.Parser),assertCompiler("processSync",this.compiler||this.Compiler),this.process($t,Mt),assertDone("processSync","process",Ct),kt;function Mt(Ft,jt){Ct=!0,bail(Ft),kt=jt}}run($t,Ct,kt){assertNode($t),this.freeze();const Mt=this.transformers;return!kt&&typeof Ct=="function"&&(kt=Ct,Ct=void 0),kt?Ft(void 0,kt):new Promise(Ft);function Ft(jt,Bt){const Vt=vfile(Ct);Mt.run($t,Vt,zt);function zt(Ht,Gt,qt){const Wt=Gt||$t;Ht?Bt(Ht):jt?jt(Wt):kt(void 0,Wt,qt)}}}runSync($t,Ct){let kt=!1,Mt;return this.run($t,Ct,Ft),assertDone("runSync","run",kt),Mt;function Ft(jt,Bt){bail(jt),Mt=Bt,kt=!0}}stringify($t,Ct){this.freeze();const kt=vfile(Ct),Mt=this.compiler||this.Compiler;return assertCompiler("stringify",Mt),assertNode($t),Mt($t,kt)}use($t,...Ct){const kt=this.attachers,Mt=this.namespace;if(assertUnfrozen("use",this.frozen),$t!=null)if(typeof $t=="function")Vt($t,Ct);else if(typeof $t=="object")Array.isArray($t)?Bt($t):jt($t);else throw new TypeError("Expected usable value, not `"+$t+"`");return this;function Ft(zt){if(typeof zt=="function")Vt(zt,[]);else if(typeof zt=="object")if(Array.isArray(zt)){const[Ht,...Gt]=zt;Vt(Ht,Gt)}else jt(zt);else throw new TypeError("Expected usable value, not `"+zt+"`")}function jt(zt){if(!("plugins"in zt)&&!("settings"in zt))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");Bt(zt.plugins),zt.settings&&(Mt.settings=extend$3(!0,Mt.settings,zt.settings))}function Bt(zt){let Ht=-1;if(zt!=null)if(Array.isArray(zt))for(;++Ht<zt.length;){const Gt=zt[Ht];Ft(Gt)}else throw new TypeError("Expected a list of plugins, not `"+zt+"`")}function Vt(zt,Ht){let Gt=-1,qt=-1;for(;++Gt<kt.length;)if(kt[Gt][0]===zt){qt=Gt;break}if(qt===-1)kt.push([zt,...Ht]);else if(Ht.length>0){let[Wt,...Yt]=Ht;const Kt=kt[qt][1];isPlainObject$4(Kt)&&isPlainObject$4(Wt)&&(Wt=extend$3(!0,Kt,Wt)),kt[qt]=[zt,Wt,...Yt]}}}}const unified=new Processor().freeze();function assertParser(xt,$t){if(typeof $t!="function")throw new TypeError("Cannot `"+xt+"` without `parser`")}function assertCompiler(xt,$t){if(typeof $t!="function")throw new TypeError("Cannot `"+xt+"` without `compiler`")}function assertUnfrozen(xt,$t){if($t)throw new Error("Cannot call `"+xt+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function assertNode(xt){if(!isPlainObject$4(xt)||typeof xt.type!="string")throw new TypeError("Expected node, got `"+xt+"`")}function assertDone(xt,$t,Ct){if(!Ct)throw new Error("`"+xt+"` finished async. Use `"+$t+"` instead")}function vfile(xt){return looksLikeAVFile(xt)?xt:new VFile(xt)}function looksLikeAVFile(xt){return!!(xt&&typeof xt=="object"&&"message"in xt&&"messages"in xt)}function looksLikeAValue(xt){return typeof xt=="string"||isUint8Array(xt)}function isUint8Array(xt){return!!(xt&&typeof xt=="object"&&"byteLength"in xt&&"byteOffset"in xt)}const changelog="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",emptyPlugins=[],emptyRemarkRehypeOptions={allowDangerousHtml:!0},safeProtocol=/^(https?|ircs?|mailto|xmpp)$/i,deprecations=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Markdown(xt){const $t=xt.allowedElements,Ct=xt.allowElement,kt=xt.children||"",Mt=xt.className,Ft=xt.components,jt=xt.disallowedElements,Bt=xt.rehypePlugins||emptyPlugins,Vt=xt.remarkPlugins||emptyPlugins,zt=xt.remarkRehypeOptions?{...xt.remarkRehypeOptions,...emptyRemarkRehypeOptions}:emptyRemarkRehypeOptions,Ht=xt.skipHtml,Gt=xt.unwrapDisallowed,qt=xt.urlTransform||defaultUrlTransform,Wt=unified().use(remarkParse).use(Vt).use(remarkRehype,zt).use(Bt),Yt=new VFile;typeof kt=="string"&&(Yt.value=kt);for(const Jt of deprecations)Object.hasOwn(xt,Jt.from)&&(""+Jt.from+(Jt.to?"use `"+Jt.to+"` instead":"remove it")+changelog+Jt.id,void 0);const Kt=Wt.parse(Yt);let Xt=Wt.runSync(Kt,Yt);return Mt&&(Xt={type:"element",tagName:"div",properties:{className:Mt},children:Xt.type==="root"?Xt.children:[Xt]}),visit$2(Xt,Qt),toJsxRuntime(Xt,{Fragment:jsxRuntimeExports.Fragment,components:Ft,ignoreInvalidStyle:!0,jsx:jsxRuntimeExports.jsx,jsxs:jsxRuntimeExports.jsxs,passKeys:!0,passNode:!0});function Qt(Jt,Zt,sn){if(Jt.type==="raw"&&sn&&typeof Zt=="number")return Ht?sn.children.splice(Zt,1):sn.children[Zt]={type:"text",value:Jt.value},Zt;if(Jt.type==="element"){let ln;for(ln in urlAttributes)if(Object.hasOwn(urlAttributes,ln)&&Object.hasOwn(Jt.properties,ln)){const dn=Jt.properties[ln],hn=urlAttributes[ln];(hn===null||hn.includes(Jt.tagName))&&(Jt.properties[ln]=qt(String(dn||""),ln,Jt))}}if(Jt.type==="element"){let ln=$t?!$t.includes(Jt.tagName):jt?jt.includes(Jt.tagName):!1;if(!ln&&Ct&&typeof Zt=="number"&&(ln=!Ct(Jt,Zt,sn)),ln&&sn&&typeof Zt=="number")return Gt&&Jt.children?sn.children.splice(Zt,1,...Jt.children):sn.children.splice(Zt,1),Zt}}}function defaultUrlTransform(xt){const $t=xt.indexOf(":"),Ct=xt.indexOf("?"),kt=xt.indexOf("#"),Mt=xt.indexOf("/");return $t<0||Mt>-1&&$t>Mt||Ct>-1&&$t>Ct||kt>-1&&$t>kt||safeProtocol.test(xt.slice(0,$t))?xt:""}const search$1=/[#.]/g;function parseSelector$1(xt,$t){const Ct=xt||"",kt={};let Mt=0,Ft,jt;for(;Mt<Ct.length;){search$1.lastIndex=Mt;const Bt=search$1.exec(Ct),Vt=Ct.slice(Mt,Bt?Bt.index:Ct.length);Vt&&(Ft?Ft==="#"?kt.id=Vt:Array.isArray(kt.className)?kt.className.push(Vt):kt.className=[Vt]:jt=Vt,Mt+=Vt.length),Bt&&(Ft=Bt[0],Mt++)}return{type:"element",tagName:jt||$t||"div",properties:kt,children:[]}}const buttonTypes=new Set(["button","menu","reset","submit"]),own$3={}.hasOwnProperty;function createH(xt,$t,Ct){const kt=Ct&&createAdjustMap(Ct);function Mt(Ft,jt,...Bt){let Vt=-1,zt;if(Ft==null){zt={type:"root",children:[]};const Ht=jt;Bt.unshift(Ht)}else if(zt=parseSelector$1(Ft,$t),zt.tagName=zt.tagName.toLowerCase(),kt&&own$3.call(kt,zt.tagName)&&(zt.tagName=kt[zt.tagName]),isProperties(jt,zt.tagName)){let Ht;for(Ht in jt)own$3.call(jt,Ht)&&addProperty(xt,zt.properties,Ht,jt[Ht])}else Bt.unshift(jt);for(;++Vt<Bt.length;)addChild(zt.children,Bt[Vt]);return zt.type==="element"&&zt.tagName==="template"&&(zt.content={type:"root",children:zt.children},zt.children=[]),zt}return Mt}function isProperties(xt,$t){return xt==null||typeof xt!="object"||Array.isArray(xt)?!1:$t==="input"||!xt.type||typeof xt.type!="string"?!0:"children"in xt&&Array.isArray(xt.children)?!1:$t==="button"?buttonTypes.has(xt.type.toLowerCase()):!("value"in xt)}function addProperty(xt,$t,Ct,kt){const Mt=find$6(xt,Ct);let Ft=-1,jt;if(kt!=null){if(typeof kt=="number"){if(Number.isNaN(kt))return;jt=kt}else typeof kt=="boolean"?jt=kt:typeof kt=="string"?Mt.spaceSeparated?jt=parse$d(kt):Mt.commaSeparated?jt=parse$e(kt):Mt.commaOrSpaceSeparated?jt=parse$d(parse$e(kt).join(" ")):jt=parsePrimitive(Mt,Mt.property,kt):Array.isArray(kt)?jt=kt.concat():jt=Mt.property==="style"?style$5(kt):String(kt);if(Array.isArray(jt)){const Bt=[];for(;++Ft<jt.length;){const Vt=parsePrimitive(Mt,Mt.property,jt[Ft]);Bt[Ft]=Vt}jt=Bt}if(Mt.property==="className"&&Array.isArray($t.className)){const Bt=jt;jt=$t.className.concat(Bt)}$t[Mt.property]=jt}}function addChild(xt,$t){let Ct=-1;if($t!=null)if(typeof $t=="string"||typeof $t=="number")xt.push({type:"text",value:String($t)});else if(Array.isArray($t))for(;++Ct<$t.length;)addChild(xt,$t[Ct]);else if(typeof $t=="object"&&"type"in $t)$t.type==="root"?addChild(xt,$t.children):xt.push($t);else throw new Error("Expected node, nodes, or string, got `"+$t+"`")}function parsePrimitive(xt,$t,Ct){if(typeof Ct=="string"){if(xt.number&&Ct&&!Number.isNaN(Number(Ct)))return Number(Ct);if((xt.boolean||xt.overloadedBoolean)&&(Ct===""||normalize$4(Ct)===normalize$4($t)))return!0}return Ct}function style$5(xt){const $t=[];let Ct;for(Ct in xt)own$3.call(xt,Ct)&&$t.push([Ct,xt[Ct]].join(": "));return $t.join("; ")}function createAdjustMap(xt){const $t={};let Ct=-1;for(;++Ct<xt.length;)$t[xt[Ct].toLowerCase()]=xt[Ct];return $t}const svgCaseSensitiveTagNames=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],h$2=createH(html$1,"div"),s$1=createH(svg,"g",svgCaseSensitiveTagNames),search=/\r?\n|\r/g;function location$1(xt){const $t=String(xt),Ct=[];for(search.lastIndex=0;search.test($t);)Ct.push(search.lastIndex);return Ct.push($t.length+1),{toPoint:kt,toOffset:Mt};function kt(Ft){let jt=-1;if(typeof Ft=="number"&&Ft>-1&&Ft<Ct[Ct.length-1]){for(;++jt<Ct.length;)if(Ct[jt]>Ft)return{line:jt+1,column:Ft-(jt>0?Ct[jt-1]:0)+1,offset:Ft}}}function Mt(Ft){const jt=Ft&&Ft.line,Bt=Ft&&Ft.column;if(typeof jt=="number"&&typeof Bt=="number"&&!Number.isNaN(jt)&&!Number.isNaN(Bt)&&jt-1 in Ct){const Vt=(Ct[jt-2]||0)+Bt-1||0;if(Vt>-1&&Vt<Ct[Ct.length-1])return Vt}}}const webNamespaces={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},own$2={}.hasOwnProperty,proto=Object.prototype;function fromParse5(xt,$t){const Ct=$t||{};return one$4({file:Ct.file||void 0,location:!1,schema:Ct.space==="svg"?svg:html$1,verbose:Ct.verbose||!1},xt)}function one$4(xt,$t){let Ct;switch($t.nodeName){case"#comment":{const kt=$t;return Ct={type:"comment",value:kt.data},patch$2(xt,kt,Ct),Ct}case"#document":case"#document-fragment":{const kt=$t,Mt="mode"in kt?kt.mode==="quirks"||kt.mode==="limited-quirks":!1;if(Ct={type:"root",children:all$3(xt,$t.childNodes),data:{quirksMode:Mt}},xt.file&&xt.location){const Ft=String(xt.file),jt=location$1(Ft),Bt=jt.toPoint(0),Vt=jt.toPoint(Ft.length);Ct.position={start:Bt,end:Vt}}return Ct}case"#documentType":{const kt=$t;return Ct={type:"doctype"},patch$2(xt,kt,Ct),Ct}case"#text":{const kt=$t;return Ct={type:"text",value:kt.value},patch$2(xt,kt,Ct),Ct}default:return Ct=element$4(xt,$t),Ct}}function all$3(xt,$t){let Ct=-1;const kt=[];for(;++Ct<$t.length;){const Mt=one$4(xt,$t[Ct]);kt.push(Mt)}return kt}function element$4(xt,$t){const Ct=xt.schema;xt.schema=$t.namespaceURI===webNamespaces.svg?svg:html$1;let kt=-1;const Mt={};for(;++kt<$t.attrs.length;){const Bt=$t.attrs[kt],Vt=(Bt.prefix?Bt.prefix+":":"")+Bt.name;own$2.call(proto,Vt)||(Mt[Vt]=Bt.value)}const jt=(xt.schema.space==="svg"?s$1:h$2)($t.tagName,Mt,all$3(xt,$t.childNodes));if(patch$2(xt,$t,jt),jt.tagName==="template"){const Bt=$t,Vt=Bt.sourceCodeLocation,zt=Vt&&Vt.startTag&&position$1(Vt.startTag),Ht=Vt&&Vt.endTag&&position$1(Vt.endTag),Gt=one$4(xt,Bt.content);zt&&Ht&&xt.file&&(Gt.position={start:zt.end,end:Ht.start}),jt.content=Gt}return xt.schema=Ct,jt}function patch$2(xt,$t,Ct){if("sourceCodeLocation"in $t&&$t.sourceCodeLocation&&xt.file){const kt=createLocation(xt,Ct,$t.sourceCodeLocation);kt&&(xt.location=!0,Ct.position=kt)}}function createLocation(xt,$t,Ct){const kt=position$1(Ct);if($t.type==="element"){const Mt=$t.children[$t.children.length-1];if(kt&&!Ct.endTag&&Mt&&Mt.position&&Mt.position.end&&(kt.end=Object.assign({},Mt.position.end)),xt.verbose){const Ft={};let jt;if(Ct.attrs)for(jt in Ct.attrs)own$2.call(Ct.attrs,jt)&&(Ft[find$6(xt.schema,jt).property]=position$1(Ct.attrs[jt]));Ct.startTag;const Bt=position$1(Ct.startTag),Vt=Ct.endTag?position$1(Ct.endTag):void 0,zt={opening:Bt};Vt&&(zt.closing=Vt),zt.properties=Ft,$t.data={position:zt}}}return kt}function position$1(xt){const $t=point$8({line:xt.startLine,column:xt.startCol,offset:xt.startOffset}),Ct=point$8({line:xt.endLine,column:xt.endCol,offset:xt.endOffset});return $t||Ct?{start:$t,end:Ct}:void 0}function point$8(xt){return xt.line&&xt.column?xt:void 0}const own$1={}.hasOwnProperty;function zwitch(xt,$t){const Ct=$t||{};function kt(Mt,...Ft){let jt=kt.invalid;const Bt=kt.handlers;if(Mt&&own$1.call(Mt,xt)){const Vt=String(Mt[xt]);jt=own$1.call(Bt,Vt)?Bt[Vt]:kt.unknown}if(jt)return jt.call(this,Mt,...Ft)}return kt.handlers=Ct.handlers||{},kt.invalid=Ct.invalid,kt.unknown=Ct.unknown,kt}const emptyOptions={},own={}.hasOwnProperty,one$3=zwitch("type",{handlers:{root:root$3,element:element$3,text:text$5,comment:comment$1,doctype:doctype$1}});function toParse5(xt,$t){const kt=($t||emptyOptions).space;return one$3(xt,kt==="svg"?svg:html$1)}function root$3(xt,$t){const Ct={nodeName:"#document",mode:(xt.data||{}).quirksMode?"quirks":"no-quirks",childNodes:[]};return Ct.childNodes=all$2(xt.children,Ct,$t),patch$1(xt,Ct),Ct}function fragment(xt,$t){const Ct={nodeName:"#document-fragment",childNodes:[]};return Ct.childNodes=all$2(xt.children,Ct,$t),patch$1(xt,Ct),Ct}function doctype$1(xt){const $t={nodeName:"#documentType",name:"html",publicId:"",systemId:"",parentNode:null};return patch$1(xt,$t),$t}function text$5(xt){const $t={nodeName:"#text",value:xt.value,parentNode:null};return patch$1(xt,$t),$t}function comment$1(xt){const $t={nodeName:"#comment",data:xt.value,parentNode:null};return patch$1(xt,$t),$t}function element$3(xt,$t){const Ct=$t;let kt=Ct;xt.type==="element"&&xt.tagName.toLowerCase()==="svg"&&Ct.space==="html"&&(kt=svg);const Mt=[];let Ft;if(xt.properties){for(Ft in xt.properties)if(Ft!=="children"&&own.call(xt.properties,Ft)){const Vt=createProperty(kt,Ft,xt.properties[Ft]);Vt&&Mt.push(Vt)}}const jt=kt.space,Bt={nodeName:xt.tagName,tagName:xt.tagName,attrs:Mt,namespaceURI:webNamespaces[jt],childNodes:[],parentNode:null};return Bt.childNodes=all$2(xt.children,Bt,kt),patch$1(xt,Bt),xt.tagName==="template"&&xt.content&&(Bt.content=fragment(xt.content,kt)),Bt}function createProperty(xt,$t,Ct){const kt=find$6(xt,$t);if(Ct===!1||Ct===null||Ct===void 0||typeof Ct=="number"&&Number.isNaN(Ct)||!Ct&&kt.boolean)return;Array.isArray(Ct)&&(Ct=kt.commaSeparated?stringify$5(Ct):stringify$4(Ct));const Mt={name:kt.attribute,value:Ct===!0?"":String(Ct)};if(kt.space&&kt.space!=="html"&&kt.space!=="svg"){const Ft=Mt.name.indexOf(":");Ft<0?Mt.prefix="":(Mt.name=Mt.name.slice(Ft+1),Mt.prefix=kt.attribute.slice(0,Ft)),Mt.namespace=webNamespaces[kt.space]}return Mt}function all$2(xt,$t,Ct){let kt=-1;const Mt=[];if(xt)for(;++kt<xt.length;){const Ft=one$3(xt[kt],Ct);Ft.parentNode=$t,Mt.push(Ft)}return Mt}function patch$1(xt,$t){const Ct=xt.position;Ct&&Ct.start&&Ct.end&&(Ct.start.offset,Ct.end.offset,$t.sourceCodeLocation={startLine:Ct.start.line,startCol:Ct.start.column,startOffset:Ct.start.offset,endLine:Ct.end.line,endCol:Ct.end.column,endOffset:Ct.end.offset})}const htmlVoidElements=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],UNDEFINED_CODE_POINTS=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),REPLACEMENT_CHARACTER="";var CODE_POINTS;(function(xt){xt[xt.EOF=-1]="EOF",xt[xt.NULL=0]="NULL",xt[xt.TABULATION=9]="TABULATION",xt[xt.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",xt[xt.LINE_FEED=10]="LINE_FEED",xt[xt.FORM_FEED=12]="FORM_FEED",xt[xt.SPACE=32]="SPACE",xt[xt.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",xt[xt.QUOTATION_MARK=34]="QUOTATION_MARK",xt[xt.NUMBER_SIGN=35]="NUMBER_SIGN",xt[xt.AMPERSAND=38]="AMPERSAND",xt[xt.APOSTROPHE=39]="APOSTROPHE",xt[xt.HYPHEN_MINUS=45]="HYPHEN_MINUS",xt[xt.SOLIDUS=47]="SOLIDUS",xt[xt.DIGIT_0=48]="DIGIT_0",xt[xt.DIGIT_9=57]="DIGIT_9",xt[xt.SEMICOLON=59]="SEMICOLON",xt[xt.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",xt[xt.EQUALS_SIGN=61]="EQUALS_SIGN",xt[xt.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",xt[xt.QUESTION_MARK=63]="QUESTION_MARK",xt[xt.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",xt[xt.LATIN_CAPITAL_F=70]="LATIN_CAPITAL_F",xt[xt.LATIN_CAPITAL_X=88]="LATIN_CAPITAL_X",xt[xt.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",xt[xt.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",xt[xt.GRAVE_ACCENT=96]="GRAVE_ACCENT",xt[xt.LATIN_SMALL_A=97]="LATIN_SMALL_A",xt[xt.LATIN_SMALL_F=102]="LATIN_SMALL_F",xt[xt.LATIN_SMALL_X=120]="LATIN_SMALL_X",xt[xt.LATIN_SMALL_Z=122]="LATIN_SMALL_Z",xt[xt.REPLACEMENT_CHARACTER=65533]="REPLACEMENT_CHARACTER"})(CODE_POINTS=CODE_POINTS||(CODE_POINTS={}));const SEQUENCES={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function isSurrogate(xt){return xt>=55296&&xt<=57343}function isSurrogatePair(xt){return xt>=56320&&xt<=57343}function getSurrogatePairCodePoint(xt,$t){return(xt-55296)*1024+9216+$t}function isControlCodePoint(xt){return xt!==32&&xt!==10&&xt!==13&&xt!==9&&xt!==12&&xt>=1&&xt<=31||xt>=127&&xt<=159}function isUndefinedCodePoint(xt){return xt>=64976&&xt<=65007||UNDEFINED_CODE_POINTS.has(xt)}var ERR;(function(xt){xt.controlCharacterInInputStream="control-character-in-input-stream",xt.noncharacterInInputStream="noncharacter-in-input-stream",xt.surrogateInInputStream="surrogate-in-input-stream",xt.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",xt.endTagWithAttributes="end-tag-with-attributes",xt.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",xt.unexpectedSolidusInTag="unexpected-solidus-in-tag",xt.unexpectedNullCharacter="unexpected-null-character",xt.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",xt.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",xt.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",xt.missingEndTagName="missing-end-tag-name",xt.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",xt.unknownNamedCharacterReference="unknown-named-character-reference",xt.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",xt.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",xt.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",xt.eofBeforeTagName="eof-before-tag-name",xt.eofInTag="eof-in-tag",xt.missingAttributeValue="missing-attribute-value",xt.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",xt.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",xt.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",xt.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",xt.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",xt.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",xt.missingDoctypePublicIdentifier="missing-doctype-public-identifier",xt.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",xt.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",xt.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",xt.cdataInHtmlContent="cdata-in-html-content",xt.incorrectlyOpenedComment="incorrectly-opened-comment",xt.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",xt.eofInDoctype="eof-in-doctype",xt.nestedComment="nested-comment",xt.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",xt.eofInComment="eof-in-comment",xt.incorrectlyClosedComment="incorrectly-closed-comment",xt.eofInCdata="eof-in-cdata",xt.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",xt.nullCharacterReference="null-character-reference",xt.surrogateCharacterReference="surrogate-character-reference",xt.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",xt.controlCharacterReference="control-character-reference",xt.noncharacterCharacterReference="noncharacter-character-reference",xt.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",xt.missingDoctypeName="missing-doctype-name",xt.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",xt.duplicateAttribute="duplicate-attribute",xt.nonConformingDoctype="non-conforming-doctype",xt.missingDoctype="missing-doctype",xt.misplacedDoctype="misplaced-doctype",xt.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",xt.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",xt.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",xt.openElementsLeftAfterEof="open-elements-left-after-eof",xt.abandonedHeadElementChild="abandoned-head-element-child",xt.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",xt.nestedNoscriptInHead="nested-noscript-in-head",xt.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(ERR=ERR||(ERR={}));const DEFAULT_BUFFER_WATERLINE=65536;class Preprocessor{constructor($t){this.handler=$t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=DEFAULT_BUFFER_WATERLINE,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError($t){const{line:Ct,col:kt,offset:Mt}=this;return{code:$t,startLine:Ct,endLine:Ct,startCol:kt,endCol:kt,startOffset:Mt,endOffset:Mt}}_err($t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError($t)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate($t){if(this.pos!==this.html.length-1){const Ct=this.html.charCodeAt(this.pos+1);if(isSurrogatePair(Ct))return this.pos++,this._addGap(),getSurrogatePairCodePoint($t,Ct)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,CODE_POINTS.EOF;return this._err(ERR.surrogateInInputStream),$t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write($t,Ct){this.html.length>0?this.html+=$t:this.html=$t,this.endOfChunkHit=!1,this.lastChunkWritten=Ct}insertHtmlAtCurrentPos($t){this.html=this.html.substring(0,this.pos+1)+$t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith($t,Ct){if(this.pos+$t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(Ct)return this.html.startsWith($t,this.pos);for(let kt=0;kt<$t.length;kt++)if((this.html.charCodeAt(this.pos+kt)|32)!==$t.charCodeAt(kt))return!1;return!0}peek($t){const Ct=this.pos+$t;if(Ct>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,CODE_POINTS.EOF;const kt=this.html.charCodeAt(Ct);return kt===CODE_POINTS.CARRIAGE_RETURN?CODE_POINTS.LINE_FEED:kt}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,CODE_POINTS.EOF;let $t=this.html.charCodeAt(this.pos);return $t===CODE_POINTS.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,CODE_POINTS.LINE_FEED):$t===CODE_POINTS.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,isSurrogate($t)&&($t=this._processSurrogate($t)),this.handler.onParseError===null||$t>31&&$t<127||$t===CODE_POINTS.LINE_FEED||$t===CODE_POINTS.CARRIAGE_RETURN||$t>159&&$t<64976||this._checkForProblematicCharacters($t),$t)}_checkForProblematicCharacters($t){isControlCodePoint($t)?this._err(ERR.controlCharacterInInputStream):isUndefinedCodePoint($t)&&this._err(ERR.noncharacterInInputStream)}retreat($t){for(this.pos-=$t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var TokenType$1;(function(xt){xt[xt.CHARACTER=0]="CHARACTER",xt[xt.NULL_CHARACTER=1]="NULL_CHARACTER",xt[xt.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",xt[xt.START_TAG=3]="START_TAG",xt[xt.END_TAG=4]="END_TAG",xt[xt.COMMENT=5]="COMMENT",xt[xt.DOCTYPE=6]="DOCTYPE",xt[xt.EOF=7]="EOF",xt[xt.HIBERNATION=8]="HIBERNATION"})(TokenType$1=TokenType$1||(TokenType$1={}));function getTokenAttr(xt,$t){for(let Ct=xt.attrs.length-1;Ct>=0;Ct--)if(xt.attrs[Ct].name===$t)return xt.attrs[Ct].value;return null}const htmlDecodeTree=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(xt=>xt.charCodeAt(0))),xmlDecodeTree=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(xt=>xt.charCodeAt(0)));var _a$4;const decodeMap=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),fromCodePoint=(_a$4=String.fromCodePoint)!==null&&_a$4!==void 0?_a$4:function(xt){let $t="";return xt>65535&&(xt-=65536,$t+=String.fromCharCode(xt>>>10&1023|55296),xt=56320|xt&1023),$t+=String.fromCharCode(xt),$t};function replaceCodePoint(xt){var $t;return xt>=55296&&xt<=57343||xt>1114111?65533:($t=decodeMap.get(xt))!==null&&$t!==void 0?$t:xt}var CharCodes;(function(xt){xt[xt.NUM=35]="NUM",xt[xt.SEMI=59]="SEMI",xt[xt.EQUALS=61]="EQUALS",xt[xt.ZERO=48]="ZERO",xt[xt.NINE=57]="NINE",xt[xt.LOWER_A=97]="LOWER_A",xt[xt.LOWER_F=102]="LOWER_F",xt[xt.LOWER_X=120]="LOWER_X",xt[xt.LOWER_Z=122]="LOWER_Z",xt[xt.UPPER_A=65]="UPPER_A",xt[xt.UPPER_F=70]="UPPER_F",xt[xt.UPPER_Z=90]="UPPER_Z"})(CharCodes||(CharCodes={}));const TO_LOWER_BIT=32;var BinTrieFlags;(function(xt){xt[xt.VALUE_LENGTH=49152]="VALUE_LENGTH",xt[xt.BRANCH_LENGTH=16256]="BRANCH_LENGTH",xt[xt.JUMP_TABLE=127]="JUMP_TABLE"})(BinTrieFlags||(BinTrieFlags={}));function isNumber$3(xt){return xt>=CharCodes.ZERO&&xt<=CharCodes.NINE}function isHexadecimalCharacter(xt){return xt>=CharCodes.UPPER_A&&xt<=CharCodes.UPPER_F||xt>=CharCodes.LOWER_A&&xt<=CharCodes.LOWER_F}function isAsciiAlphaNumeric$1(xt){return xt>=CharCodes.UPPER_A&&xt<=CharCodes.UPPER_Z||xt>=CharCodes.LOWER_A&&xt<=CharCodes.LOWER_Z||isNumber$3(xt)}function isEntityInAttributeInvalidEnd$1(xt){return xt===CharCodes.EQUALS||isAsciiAlphaNumeric$1(xt)}var EntityDecoderState;(function(xt){xt[xt.EntityStart=0]="EntityStart",xt[xt.NumericStart=1]="NumericStart",xt[xt.NumericDecimal=2]="NumericDecimal",xt[xt.NumericHex=3]="NumericHex",xt[xt.NamedEntity=4]="NamedEntity"})(EntityDecoderState||(EntityDecoderState={}));var DecodingMode;(function(xt){xt[xt.Legacy=0]="Legacy",xt[xt.Strict=1]="Strict",xt[xt.Attribute=2]="Attribute"})(DecodingMode||(DecodingMode={}));class EntityDecoder{constructor($t,Ct,kt){this.decodeTree=$t,this.emitCodePoint=Ct,this.errors=kt,this.state=EntityDecoderState.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=DecodingMode.Strict}startEntity($t){this.decodeMode=$t,this.state=EntityDecoderState.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write($t,Ct){switch(this.state){case EntityDecoderState.EntityStart:return $t.charCodeAt(Ct)===CharCodes.NUM?(this.state=EntityDecoderState.NumericStart,this.consumed+=1,this.stateNumericStart($t,Ct+1)):(this.state=EntityDecoderState.NamedEntity,this.stateNamedEntity($t,Ct));case EntityDecoderState.NumericStart:return this.stateNumericStart($t,Ct);case EntityDecoderState.NumericDecimal:return this.stateNumericDecimal($t,Ct);case EntityDecoderState.NumericHex:return this.stateNumericHex($t,Ct);case EntityDecoderState.NamedEntity:return this.stateNamedEntity($t,Ct)}}stateNumericStart($t,Ct){return Ct>=$t.length?-1:($t.charCodeAt(Ct)|TO_LOWER_BIT)===CharCodes.LOWER_X?(this.state=EntityDecoderState.NumericHex,this.consumed+=1,this.stateNumericHex($t,Ct+1)):(this.state=EntityDecoderState.NumericDecimal,this.stateNumericDecimal($t,Ct))}addToNumericResult($t,Ct,kt,Mt){if(Ct!==kt){const Ft=kt-Ct;this.result=this.result*Math.pow(Mt,Ft)+parseInt($t.substr(Ct,Ft),Mt),this.consumed+=Ft}}stateNumericHex($t,Ct){const kt=Ct;for(;Ct<$t.length;){const Mt=$t.charCodeAt(Ct);if(isNumber$3(Mt)||isHexadecimalCharacter(Mt))Ct+=1;else return this.addToNumericResult($t,kt,Ct,16),this.emitNumericEntity(Mt,3)}return this.addToNumericResult($t,kt,Ct,16),-1}stateNumericDecimal($t,Ct){const kt=Ct;for(;Ct<$t.length;){const Mt=$t.charCodeAt(Ct);if(isNumber$3(Mt))Ct+=1;else return this.addToNumericResult($t,kt,Ct,10),this.emitNumericEntity(Mt,2)}return this.addToNumericResult($t,kt,Ct,10),-1}emitNumericEntity($t,Ct){var kt;if(this.consumed<=Ct)return(kt=this.errors)===null||kt===void 0||kt.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if($t===CharCodes.SEMI)this.consumed+=1;else if(this.decodeMode===DecodingMode.Strict)return 0;return this.emitCodePoint(replaceCodePoint(this.result),this.consumed),this.errors&&($t!==CharCodes.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity($t,Ct){const{decodeTree:kt}=this;let Mt=kt[this.treeIndex],Ft=(Mt&BinTrieFlags.VALUE_LENGTH)>>14;for(;Ct<$t.length;Ct++,this.excess++){const jt=$t.charCodeAt(Ct);if(this.treeIndex=determineBranch(kt,Mt,this.treeIndex+Math.max(1,Ft),jt),this.treeIndex<0)return this.result===0||this.decodeMode===DecodingMode.Attribute&&(Ft===0||isEntityInAttributeInvalidEnd$1(jt))?0:this.emitNotTerminatedNamedEntity();if(Mt=kt[this.treeIndex],Ft=(Mt&BinTrieFlags.VALUE_LENGTH)>>14,Ft!==0){if(jt===CharCodes.SEMI)return this.emitNamedEntityData(this.treeIndex,Ft,this.consumed+this.excess);this.decodeMode!==DecodingMode.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var $t;const{result:Ct,decodeTree:kt}=this,Mt=(kt[Ct]&BinTrieFlags.VALUE_LENGTH)>>14;return this.emitNamedEntityData(Ct,Mt,this.consumed),($t=this.errors)===null||$t===void 0||$t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData($t,Ct,kt){const{decodeTree:Mt}=this;return this.emitCodePoint(Ct===1?Mt[$t]&~BinTrieFlags.VALUE_LENGTH:Mt[$t+1],kt),Ct===3&&this.emitCodePoint(Mt[$t+2],kt),kt}end(){var $t;switch(this.state){case EntityDecoderState.NamedEntity:return this.result!==0&&(this.decodeMode!==DecodingMode.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case EntityDecoderState.NumericDecimal:return this.emitNumericEntity(0,2);case EntityDecoderState.NumericHex:return this.emitNumericEntity(0,3);case EntityDecoderState.NumericStart:return($t=this.errors)===null||$t===void 0||$t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case EntityDecoderState.EntityStart:return 0}}}function getDecoder(xt){let $t="";const Ct=new EntityDecoder(xt,kt=>$t+=fromCodePoint(kt));return function(Mt,Ft){let jt=0,Bt=0;for(;(Bt=Mt.indexOf("&",Bt))>=0;){$t+=Mt.slice(jt,Bt),Ct.startEntity(Ft);const zt=Ct.write(Mt,Bt+1);if(zt<0){jt=Bt+Ct.end();break}jt=Bt+zt,Bt=zt===0?jt+1:jt}const Vt=$t+Mt.slice(jt);return $t="",Vt}}function determineBranch(xt,$t,Ct,kt){const Mt=($t&BinTrieFlags.BRANCH_LENGTH)>>7,Ft=$t&BinTrieFlags.JUMP_TABLE;if(Mt===0)return Ft!==0&&kt===Ft?Ct:-1;if(Ft){const Vt=kt-Ft;return Vt<0||Vt>=Mt?-1:xt[Ct+Vt]-1}let jt=Ct,Bt=jt+Mt-1;for(;jt<=Bt;){const Vt=jt+Bt>>>1,zt=xt[Vt];if(zt<kt)jt=Vt+1;else if(zt>kt)Bt=Vt-1;else return xt[Vt+Mt]}return-1}getDecoder(htmlDecodeTree);getDecoder(xmlDecodeTree);var NS;(function(xt){xt.HTML="http://www.w3.org/1999/xhtml",xt.MATHML="http://www.w3.org/1998/Math/MathML",xt.SVG="http://www.w3.org/2000/svg",xt.XLINK="http://www.w3.org/1999/xlink",xt.XML="http://www.w3.org/XML/1998/namespace",xt.XMLNS="http://www.w3.org/2000/xmlns/"})(NS=NS||(NS={}));var ATTRS;(function(xt){xt.TYPE="type",xt.ACTION="action",xt.ENCODING="encoding",xt.PROMPT="prompt",xt.NAME="name",xt.COLOR="color",xt.FACE="face",xt.SIZE="size"})(ATTRS=ATTRS||(ATTRS={}));var DOCUMENT_MODE;(function(xt){xt.NO_QUIRKS="no-quirks",xt.QUIRKS="quirks",xt.LIMITED_QUIRKS="limited-quirks"})(DOCUMENT_MODE=DOCUMENT_MODE||(DOCUMENT_MODE={}));var TAG_NAMES;(function(xt){xt.A="a",xt.ADDRESS="address",xt.ANNOTATION_XML="annotation-xml",xt.APPLET="applet",xt.AREA="area",xt.ARTICLE="article",xt.ASIDE="aside",xt.B="b",xt.BASE="base",xt.BASEFONT="basefont",xt.BGSOUND="bgsound",xt.BIG="big",xt.BLOCKQUOTE="blockquote",xt.BODY="body",xt.BR="br",xt.BUTTON="button",xt.CAPTION="caption",xt.CENTER="center",xt.CODE="code",xt.COL="col",xt.COLGROUP="colgroup",xt.DD="dd",xt.DESC="desc",xt.DETAILS="details",xt.DIALOG="dialog",xt.DIR="dir",xt.DIV="div",xt.DL="dl",xt.DT="dt",xt.EM="em",xt.EMBED="embed",xt.FIELDSET="fieldset",xt.FIGCAPTION="figcaption",xt.FIGURE="figure",xt.FONT="font",xt.FOOTER="footer",xt.FOREIGN_OBJECT="foreignObject",xt.FORM="form",xt.FRAME="frame",xt.FRAMESET="frameset",xt.H1="h1",xt.H2="h2",xt.H3="h3",xt.H4="h4",xt.H5="h5",xt.H6="h6",xt.HEAD="head",xt.HEADER="header",xt.HGROUP="hgroup",xt.HR="hr",xt.HTML="html",xt.I="i",xt.IMG="img",xt.IMAGE="image",xt.INPUT="input",xt.IFRAME="iframe",xt.KEYGEN="keygen",xt.LABEL="label",xt.LI="li",xt.LINK="link",xt.LISTING="listing",xt.MAIN="main",xt.MALIGNMARK="malignmark",xt.MARQUEE="marquee",xt.MATH="math",xt.MENU="menu",xt.META="meta",xt.MGLYPH="mglyph",xt.MI="mi",xt.MO="mo",xt.MN="mn",xt.MS="ms",xt.MTEXT="mtext",xt.NAV="nav",xt.NOBR="nobr",xt.NOFRAMES="noframes",xt.NOEMBED="noembed",xt.NOSCRIPT="noscript",xt.OBJECT="object",xt.OL="ol",xt.OPTGROUP="optgroup",xt.OPTION="option",xt.P="p",xt.PARAM="param",xt.PLAINTEXT="plaintext",xt.PRE="pre",xt.RB="rb",xt.RP="rp",xt.RT="rt",xt.RTC="rtc",xt.RUBY="ruby",xt.S="s",xt.SCRIPT="script",xt.SECTION="section",xt.SELECT="select",xt.SOURCE="source",xt.SMALL="small",xt.SPAN="span",xt.STRIKE="strike",xt.STRONG="strong",xt.STYLE="style",xt.SUB="sub",xt.SUMMARY="summary",xt.SUP="sup",xt.TABLE="table",xt.TBODY="tbody",xt.TEMPLATE="template",xt.TEXTAREA="textarea",xt.TFOOT="tfoot",xt.TD="td",xt.TH="th",xt.THEAD="thead",xt.TITLE="title",xt.TR="tr",xt.TRACK="track",xt.TT="tt",xt.U="u",xt.UL="ul",xt.SVG="svg",xt.VAR="var",xt.WBR="wbr",xt.XMP="xmp"})(TAG_NAMES=TAG_NAMES||(TAG_NAMES={}));var TAG_ID;(function(xt){xt[xt.UNKNOWN=0]="UNKNOWN",xt[xt.A=1]="A",xt[xt.ADDRESS=2]="ADDRESS",xt[xt.ANNOTATION_XML=3]="ANNOTATION_XML",xt[xt.APPLET=4]="APPLET",xt[xt.AREA=5]="AREA",xt[xt.ARTICLE=6]="ARTICLE",xt[xt.ASIDE=7]="ASIDE",xt[xt.B=8]="B",xt[xt.BASE=9]="BASE",xt[xt.BASEFONT=10]="BASEFONT",xt[xt.BGSOUND=11]="BGSOUND",xt[xt.BIG=12]="BIG",xt[xt.BLOCKQUOTE=13]="BLOCKQUOTE",xt[xt.BODY=14]="BODY",xt[xt.BR=15]="BR",xt[xt.BUTTON=16]="BUTTON",xt[xt.CAPTION=17]="CAPTION",xt[xt.CENTER=18]="CENTER",xt[xt.CODE=19]="CODE",xt[xt.COL=20]="COL",xt[xt.COLGROUP=21]="COLGROUP",xt[xt.DD=22]="DD",xt[xt.DESC=23]="DESC",xt[xt.DETAILS=24]="DETAILS",xt[xt.DIALOG=25]="DIALOG",xt[xt.DIR=26]="DIR",xt[xt.DIV=27]="DIV",xt[xt.DL=28]="DL",xt[xt.DT=29]="DT",xt[xt.EM=30]="EM",xt[xt.EMBED=31]="EMBED",xt[xt.FIELDSET=32]="FIELDSET",xt[xt.FIGCAPTION=33]="FIGCAPTION",xt[xt.FIGURE=34]="FIGURE",xt[xt.FONT=35]="FONT",xt[xt.FOOTER=36]="FOOTER",xt[xt.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",xt[xt.FORM=38]="FORM",xt[xt.FRAME=39]="FRAME",xt[xt.FRAMESET=40]="FRAMESET",xt[xt.H1=41]="H1",xt[xt.H2=42]="H2",xt[xt.H3=43]="H3",xt[xt.H4=44]="H4",xt[xt.H5=45]="H5",xt[xt.H6=46]="H6",xt[xt.HEAD=47]="HEAD",xt[xt.HEADER=48]="HEADER",xt[xt.HGROUP=49]="HGROUP",xt[xt.HR=50]="HR",xt[xt.HTML=51]="HTML",xt[xt.I=52]="I",xt[xt.IMG=53]="IMG",xt[xt.IMAGE=54]="IMAGE",xt[xt.INPUT=55]="INPUT",xt[xt.IFRAME=56]="IFRAME",xt[xt.KEYGEN=57]="KEYGEN",xt[xt.LABEL=58]="LABEL",xt[xt.LI=59]="LI",xt[xt.LINK=60]="LINK",xt[xt.LISTING=61]="LISTING",xt[xt.MAIN=62]="MAIN",xt[xt.MALIGNMARK=63]="MALIGNMARK",xt[xt.MARQUEE=64]="MARQUEE",xt[xt.MATH=65]="MATH",xt[xt.MENU=66]="MENU",xt[xt.META=67]="META",xt[xt.MGLYPH=68]="MGLYPH",xt[xt.MI=69]="MI",xt[xt.MO=70]="MO",xt[xt.MN=71]="MN",xt[xt.MS=72]="MS",xt[xt.MTEXT=73]="MTEXT",xt[xt.NAV=74]="NAV",xt[xt.NOBR=75]="NOBR",xt[xt.NOFRAMES=76]="NOFRAMES",xt[xt.NOEMBED=77]="NOEMBED",xt[xt.NOSCRIPT=78]="NOSCRIPT",xt[xt.OBJECT=79]="OBJECT",xt[xt.OL=80]="OL",xt[xt.OPTGROUP=81]="OPTGROUP",xt[xt.OPTION=82]="OPTION",xt[xt.P=83]="P",xt[xt.PARAM=84]="PARAM",xt[xt.PLAINTEXT=85]="PLAINTEXT",xt[xt.PRE=86]="PRE",xt[xt.RB=87]="RB",xt[xt.RP=88]="RP",xt[xt.RT=89]="RT",xt[xt.RTC=90]="RTC",xt[xt.RUBY=91]="RUBY",xt[xt.S=92]="S",xt[xt.SCRIPT=93]="SCRIPT",xt[xt.SECTION=94]="SECTION",xt[xt.SELECT=95]="SELECT",xt[xt.SOURCE=96]="SOURCE",xt[xt.SMALL=97]="SMALL",xt[xt.SPAN=98]="SPAN",xt[xt.STRIKE=99]="STRIKE",xt[xt.STRONG=100]="STRONG",xt[xt.STYLE=101]="STYLE",xt[xt.SUB=102]="SUB",xt[xt.SUMMARY=103]="SUMMARY",xt[xt.SUP=104]="SUP",xt[xt.TABLE=105]="TABLE",xt[xt.TBODY=106]="TBODY",xt[xt.TEMPLATE=107]="TEMPLATE",xt[xt.TEXTAREA=108]="TEXTAREA",xt[xt.TFOOT=109]="TFOOT",xt[xt.TD=110]="TD",xt[xt.TH=111]="TH",xt[xt.THEAD=112]="THEAD",xt[xt.TITLE=113]="TITLE",xt[xt.TR=114]="TR",xt[xt.TRACK=115]="TRACK",xt[xt.TT=116]="TT",xt[xt.U=117]="U",xt[xt.UL=118]="UL",xt[xt.SVG=119]="SVG",xt[xt.VAR=120]="VAR",xt[xt.WBR=121]="WBR",xt[xt.XMP=122]="XMP"})(TAG_ID=TAG_ID||(TAG_ID={}));const TAG_NAME_TO_ID=new Map([[TAG_NAMES.A,TAG_ID.A],[TAG_NAMES.ADDRESS,TAG_ID.ADDRESS],[TAG_NAMES.ANNOTATION_XML,TAG_ID.ANNOTATION_XML],[TAG_NAMES.APPLET,TAG_ID.APPLET],[TAG_NAMES.AREA,TAG_ID.AREA],[TAG_NAMES.ARTICLE,TAG_ID.ARTICLE],[TAG_NAMES.ASIDE,TAG_ID.ASIDE],[TAG_NAMES.B,TAG_ID.B],[TAG_NAMES.BASE,TAG_ID.BASE],[TAG_NAMES.BASEFONT,TAG_ID.BASEFONT],[TAG_NAMES.BGSOUND,TAG_ID.BGSOUND],[TAG_NAMES.BIG,TAG_ID.BIG],[TAG_NAMES.BLOCKQUOTE,TAG_ID.BLOCKQUOTE],[TAG_NAMES.BODY,TAG_ID.BODY],[TAG_NAMES.BR,TAG_ID.BR],[TAG_NAMES.BUTTON,TAG_ID.BUTTON],[TAG_NAMES.CAPTION,TAG_ID.CAPTION],[TAG_NAMES.CENTER,TAG_ID.CENTER],[TAG_NAMES.CODE,TAG_ID.CODE],[TAG_NAMES.COL,TAG_ID.COL],[TAG_NAMES.COLGROUP,TAG_ID.COLGROUP],[TAG_NAMES.DD,TAG_ID.DD],[TAG_NAMES.DESC,TAG_ID.DESC],[TAG_NAMES.DETAILS,TAG_ID.DETAILS],[TAG_NAMES.DIALOG,TAG_ID.DIALOG],[TAG_NAMES.DIR,TAG_ID.DIR],[TAG_NAMES.DIV,TAG_ID.DIV],[TAG_NAMES.DL,TAG_ID.DL],[TAG_NAMES.DT,TAG_ID.DT],[TAG_NAMES.EM,TAG_ID.EM],[TAG_NAMES.EMBED,TAG_ID.EMBED],[TAG_NAMES.FIELDSET,TAG_ID.FIELDSET],[TAG_NAMES.FIGCAPTION,TAG_ID.FIGCAPTION],[TAG_NAMES.FIGURE,TAG_ID.FIGURE],[TAG_NAMES.FONT,TAG_ID.FONT],[TAG_NAMES.FOOTER,TAG_ID.FOOTER],[TAG_NAMES.FOREIGN_OBJECT,TAG_ID.FOREIGN_OBJECT],[TAG_NAMES.FORM,TAG_ID.FORM],[TAG_NAMES.FRAME,TAG_ID.FRAME],[TAG_NAMES.FRAMESET,TAG_ID.FRAMESET],[TAG_NAMES.H1,TAG_ID.H1],[TAG_NAMES.H2,TAG_ID.H2],[TAG_NAMES.H3,TAG_ID.H3],[TAG_NAMES.H4,TAG_ID.H4],[TAG_NAMES.H5,TAG_ID.H5],[TAG_NAMES.H6,TAG_ID.H6],[TAG_NAMES.HEAD,TAG_ID.HEAD],[TAG_NAMES.HEADER,TAG_ID.HEADER],[TAG_NAMES.HGROUP,TAG_ID.HGROUP],[TAG_NAMES.HR,TAG_ID.HR],[TAG_NAMES.HTML,TAG_ID.HTML],[TAG_NAMES.I,TAG_ID.I],[TAG_NAMES.IMG,TAG_ID.IMG],[TAG_NAMES.IMAGE,TAG_ID.IMAGE],[TAG_NAMES.INPUT,TAG_ID.INPUT],[TAG_NAMES.IFRAME,TAG_ID.IFRAME],[TAG_NAMES.KEYGEN,TAG_ID.KEYGEN],[TAG_NAMES.LABEL,TAG_ID.LABEL],[TAG_NAMES.LI,TAG_ID.LI],[TAG_NAMES.LINK,TAG_ID.LINK],[TAG_NAMES.LISTING,TAG_ID.LISTING],[TAG_NAMES.MAIN,TAG_ID.MAIN],[TAG_NAMES.MALIGNMARK,TAG_ID.MALIGNMARK],[TAG_NAMES.MARQUEE,TAG_ID.MARQUEE],[TAG_NAMES.MATH,TAG_ID.MATH],[TAG_NAMES.MENU,TAG_ID.MENU],[TAG_NAMES.META,TAG_ID.META],[TAG_NAMES.MGLYPH,TAG_ID.MGLYPH],[TAG_NAMES.MI,TAG_ID.MI],[TAG_NAMES.MO,TAG_ID.MO],[TAG_NAMES.MN,TAG_ID.MN],[TAG_NAMES.MS,TAG_ID.MS],[TAG_NAMES.MTEXT,TAG_ID.MTEXT],[TAG_NAMES.NAV,TAG_ID.NAV],[TAG_NAMES.NOBR,TAG_ID.NOBR],[TAG_NAMES.NOFRAMES,TAG_ID.NOFRAMES],[TAG_NAMES.NOEMBED,TAG_ID.NOEMBED],[TAG_NAMES.NOSCRIPT,TAG_ID.NOSCRIPT],[TAG_NAMES.OBJECT,TAG_ID.OBJECT],[TAG_NAMES.OL,TAG_ID.OL],[TAG_NAMES.OPTGROUP,TAG_ID.OPTGROUP],[TAG_NAMES.OPTION,TAG_ID.OPTION],[TAG_NAMES.P,TAG_ID.P],[TAG_NAMES.PARAM,TAG_ID.PARAM],[TAG_NAMES.PLAINTEXT,TAG_ID.PLAINTEXT],[TAG_NAMES.PRE,TAG_ID.PRE],[TAG_NAMES.RB,TAG_ID.RB],[TAG_NAMES.RP,TAG_ID.RP],[TAG_NAMES.RT,TAG_ID.RT],[TAG_NAMES.RTC,TAG_ID.RTC],[TAG_NAMES.RUBY,TAG_ID.RUBY],[TAG_NAMES.S,TAG_ID.S],[TAG_NAMES.SCRIPT,TAG_ID.SCRIPT],[TAG_NAMES.SECTION,TAG_ID.SECTION],[TAG_NAMES.SELECT,TAG_ID.SELECT],[TAG_NAMES.SOURCE,TAG_ID.SOURCE],[TAG_NAMES.SMALL,TAG_ID.SMALL],[TAG_NAMES.SPAN,TAG_ID.SPAN],[TAG_NAMES.STRIKE,TAG_ID.STRIKE],[TAG_NAMES.STRONG,TAG_ID.STRONG],[TAG_NAMES.STYLE,TAG_ID.STYLE],[TAG_NAMES.SUB,TAG_ID.SUB],[TAG_NAMES.SUMMARY,TAG_ID.SUMMARY],[TAG_NAMES.SUP,TAG_ID.SUP],[TAG_NAMES.TABLE,TAG_ID.TABLE],[TAG_NAMES.TBODY,TAG_ID.TBODY],[TAG_NAMES.TEMPLATE,TAG_ID.TEMPLATE],[TAG_NAMES.TEXTAREA,TAG_ID.TEXTAREA],[TAG_NAMES.TFOOT,TAG_ID.TFOOT],[TAG_NAMES.TD,TAG_ID.TD],[TAG_NAMES.TH,TAG_ID.TH],[TAG_NAMES.THEAD,TAG_ID.THEAD],[TAG_NAMES.TITLE,TAG_ID.TITLE],[TAG_NAMES.TR,TAG_ID.TR],[TAG_NAMES.TRACK,TAG_ID.TRACK],[TAG_NAMES.TT,TAG_ID.TT],[TAG_NAMES.U,TAG_ID.U],[TAG_NAMES.UL,TAG_ID.UL],[TAG_NAMES.SVG,TAG_ID.SVG],[TAG_NAMES.VAR,TAG_ID.VAR],[TAG_NAMES.WBR,TAG_ID.WBR],[TAG_NAMES.XMP,TAG_ID.XMP]]);function getTagID(xt){var $t;return($t=TAG_NAME_TO_ID.get(xt))!==null&&$t!==void 0?$t:TAG_ID.UNKNOWN}const $$2=TAG_ID,SPECIAL_ELEMENTS={[NS.HTML]:new Set([$$2.ADDRESS,$$2.APPLET,$$2.AREA,$$2.ARTICLE,$$2.ASIDE,$$2.BASE,$$2.BASEFONT,$$2.BGSOUND,$$2.BLOCKQUOTE,$$2.BODY,$$2.BR,$$2.BUTTON,$$2.CAPTION,$$2.CENTER,$$2.COL,$$2.COLGROUP,$$2.DD,$$2.DETAILS,$$2.DIR,$$2.DIV,$$2.DL,$$2.DT,$$2.EMBED,$$2.FIELDSET,$$2.FIGCAPTION,$$2.FIGURE,$$2.FOOTER,$$2.FORM,$$2.FRAME,$$2.FRAMESET,$$2.H1,$$2.H2,$$2.H3,$$2.H4,$$2.H5,$$2.H6,$$2.HEAD,$$2.HEADER,$$2.HGROUP,$$2.HR,$$2.HTML,$$2.IFRAME,$$2.IMG,$$2.INPUT,$$2.LI,$$2.LINK,$$2.LISTING,$$2.MAIN,$$2.MARQUEE,$$2.MENU,$$2.META,$$2.NAV,$$2.NOEMBED,$$2.NOFRAMES,$$2.NOSCRIPT,$$2.OBJECT,$$2.OL,$$2.P,$$2.PARAM,$$2.PLAINTEXT,$$2.PRE,$$2.SCRIPT,$$2.SECTION,$$2.SELECT,$$2.SOURCE,$$2.STYLE,$$2.SUMMARY,$$2.TABLE,$$2.TBODY,$$2.TD,$$2.TEMPLATE,$$2.TEXTAREA,$$2.TFOOT,$$2.TH,$$2.THEAD,$$2.TITLE,$$2.TR,$$2.TRACK,$$2.UL,$$2.WBR,$$2.XMP]),[NS.MATHML]:new Set([$$2.MI,$$2.MO,$$2.MN,$$2.MS,$$2.MTEXT,$$2.ANNOTATION_XML]),[NS.SVG]:new Set([$$2.TITLE,$$2.FOREIGN_OBJECT,$$2.DESC]),[NS.XLINK]:new Set,[NS.XML]:new Set,[NS.XMLNS]:new Set};function isNumberedHeader(xt){return xt===$$2.H1||xt===$$2.H2||xt===$$2.H3||xt===$$2.H4||xt===$$2.H5||xt===$$2.H6}TAG_NAMES.STYLE,TAG_NAMES.SCRIPT,TAG_NAMES.XMP,TAG_NAMES.IFRAME,TAG_NAMES.NOEMBED,TAG_NAMES.NOFRAMES,TAG_NAMES.PLAINTEXT;const C1_CONTROLS_REFERENCE_REPLACEMENTS=new Map([[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);var State;(function(xt){xt[xt.DATA=0]="DATA",xt[xt.RCDATA=1]="RCDATA",xt[xt.RAWTEXT=2]="RAWTEXT",xt[xt.SCRIPT_DATA=3]="SCRIPT_DATA",xt[xt.PLAINTEXT=4]="PLAINTEXT",xt[xt.TAG_OPEN=5]="TAG_OPEN",xt[xt.END_TAG_OPEN=6]="END_TAG_OPEN",xt[xt.TAG_NAME=7]="TAG_NAME",xt[xt.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",xt[xt.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",xt[xt.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",xt[xt.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",xt[xt.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",xt[xt.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",xt[xt.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",xt[xt.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",xt[xt.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",xt[xt.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",xt[xt.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",xt[xt.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",xt[xt.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",xt[xt.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",xt[xt.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",xt[xt.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",xt[xt.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",xt[xt.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",xt[xt.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",xt[xt.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",xt[xt.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",xt[xt.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",xt[xt.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",xt[xt.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",xt[xt.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",xt[xt.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",xt[xt.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",xt[xt.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",xt[xt.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",xt[xt.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",xt[xt.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",xt[xt.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",xt[xt.BOGUS_COMMENT=40]="BOGUS_COMMENT",xt[xt.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",xt[xt.COMMENT_START=42]="COMMENT_START",xt[xt.COMMENT_START_DASH=43]="COMMENT_START_DASH",xt[xt.COMMENT=44]="COMMENT",xt[xt.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",xt[xt.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",xt[xt.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",xt[xt.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",xt[xt.COMMENT_END_DASH=49]="COMMENT_END_DASH",xt[xt.COMMENT_END=50]="COMMENT_END",xt[xt.COMMENT_END_BANG=51]="COMMENT_END_BANG",xt[xt.DOCTYPE=52]="DOCTYPE",xt[xt.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",xt[xt.DOCTYPE_NAME=54]="DOCTYPE_NAME",xt[xt.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",xt[xt.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",xt[xt.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",xt[xt.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",xt[xt.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",xt[xt.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",xt[xt.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",xt[xt.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",xt[xt.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",xt[xt.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",xt[xt.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",xt[xt.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",xt[xt.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",xt[xt.CDATA_SECTION=68]="CDATA_SECTION",xt[xt.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",xt[xt.CDATA_SECTION_END=70]="CDATA_SECTION_END",xt[xt.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",xt[xt.NAMED_CHARACTER_REFERENCE=72]="NAMED_CHARACTER_REFERENCE",xt[xt.AMBIGUOUS_AMPERSAND=73]="AMBIGUOUS_AMPERSAND",xt[xt.NUMERIC_CHARACTER_REFERENCE=74]="NUMERIC_CHARACTER_REFERENCE",xt[xt.HEXADEMICAL_CHARACTER_REFERENCE_START=75]="HEXADEMICAL_CHARACTER_REFERENCE_START",xt[xt.HEXADEMICAL_CHARACTER_REFERENCE=76]="HEXADEMICAL_CHARACTER_REFERENCE",xt[xt.DECIMAL_CHARACTER_REFERENCE=77]="DECIMAL_CHARACTER_REFERENCE",xt[xt.NUMERIC_CHARACTER_REFERENCE_END=78]="NUMERIC_CHARACTER_REFERENCE_END"})(State||(State={}));const TokenizerMode={DATA:State.DATA,RCDATA:State.RCDATA,RAWTEXT:State.RAWTEXT,SCRIPT_DATA:State.SCRIPT_DATA,PLAINTEXT:State.PLAINTEXT,CDATA_SECTION:State.CDATA_SECTION};function isAsciiDigit(xt){return xt>=CODE_POINTS.DIGIT_0&&xt<=CODE_POINTS.DIGIT_9}function isAsciiUpper(xt){return xt>=CODE_POINTS.LATIN_CAPITAL_A&&xt<=CODE_POINTS.LATIN_CAPITAL_Z}function isAsciiLower(xt){return xt>=CODE_POINTS.LATIN_SMALL_A&&xt<=CODE_POINTS.LATIN_SMALL_Z}function isAsciiLetter(xt){return isAsciiLower(xt)||isAsciiUpper(xt)}function isAsciiAlphaNumeric(xt){return isAsciiLetter(xt)||isAsciiDigit(xt)}function isAsciiUpperHexDigit(xt){return xt>=CODE_POINTS.LATIN_CAPITAL_A&&xt<=CODE_POINTS.LATIN_CAPITAL_F}function isAsciiLowerHexDigit(xt){return xt>=CODE_POINTS.LATIN_SMALL_A&&xt<=CODE_POINTS.LATIN_SMALL_F}function isAsciiHexDigit(xt){return isAsciiDigit(xt)||isAsciiUpperHexDigit(xt)||isAsciiLowerHexDigit(xt)}function toAsciiLower(xt){return xt+32}function isWhitespace(xt){return xt===CODE_POINTS.SPACE||xt===CODE_POINTS.LINE_FEED||xt===CODE_POINTS.TABULATION||xt===CODE_POINTS.FORM_FEED}function isEntityInAttributeInvalidEnd(xt){return xt===CODE_POINTS.EQUALS_SIGN||isAsciiAlphaNumeric(xt)}function isScriptDataDoubleEscapeSequenceEnd(xt){return isWhitespace(xt)||xt===CODE_POINTS.SOLIDUS||xt===CODE_POINTS.GREATER_THAN_SIGN}class Tokenizer{constructor($t,Ct){this.options=$t,this.handler=Ct,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=State.DATA,this.returnState=State.DATA,this.charRefCode=-1,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new Preprocessor(Ct),this.currentLocation=this.getCurrentLocation(-1)}_err($t){var Ct,kt;(kt=(Ct=this.handler).onParseError)===null||kt===void 0||kt.call(Ct,this.preprocessor.getError($t))}getCurrentLocation($t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-$t,startOffset:this.preprocessor.offset-$t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const $t=this._consume();this._ensureHibernation()||this._callState($t)}this.inLoop=!1}}pause(){this.paused=!0}resume($t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||$t==null||$t())}write($t,Ct,kt){this.active=!0,this.preprocessor.write($t,Ct),this._runParsingLoop(),this.paused||kt==null||kt()}insertHtmlAtCurrentPos($t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos($t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this._unconsume(this.consumedAfterSnapshot),this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_unconsume($t){this.consumedAfterSnapshot-=$t,this.preprocessor.retreat($t)}_reconsumeInState($t,Ct){this.state=$t,this._callState(Ct)}_advanceBy($t){this.consumedAfterSnapshot+=$t;for(let Ct=0;Ct<$t;Ct++)this.preprocessor.advance()}_consumeSequenceIfMatch($t,Ct){return this.preprocessor.startsWith($t,Ct)?(this._advanceBy($t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:TokenType$1.START_TAG,tagName:"",tagID:TAG_ID.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:TokenType$1.END_TAG,tagName:"",tagID:TAG_ID.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken($t){this.currentToken={type:TokenType$1.COMMENT,data:"",location:this.getCurrentLocation($t)}}_createDoctypeToken($t){this.currentToken={type:TokenType$1.DOCTYPE,name:$t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken($t,Ct){this.currentCharacterToken={type:$t,chars:Ct,location:this.currentLocation}}_createAttr($t){this.currentAttr={name:$t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var $t,Ct;const kt=this.currentToken;if(getTokenAttr(kt,this.currentAttr.name)===null){if(kt.attrs.push(this.currentAttr),kt.location&&this.currentLocation){const Mt=($t=(Ct=kt.location).attrs)!==null&&$t!==void 0?$t:Ct.attrs=Object.create(null);Mt[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(ERR.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken($t){this._emitCurrentCharacterToken($t.location),this.currentToken=null,$t.location&&($t.location.endLine=this.preprocessor.line,$t.location.endCol=this.preprocessor.col+1,$t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const $t=this.currentToken;this.prepareToken($t),$t.tagID=getTagID($t.tagName),$t.type===TokenType$1.START_TAG?(this.lastStartTagName=$t.tagName,this.handler.onStartTag($t)):($t.attrs.length>0&&this._err(ERR.endTagWithAttributes),$t.selfClosing&&this._err(ERR.endTagWithTrailingSolidus),this.handler.onEndTag($t)),this.preprocessor.dropParsedChunk()}emitCurrentComment($t){this.prepareToken($t),this.handler.onComment($t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype($t){this.prepareToken($t),this.handler.onDoctype($t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken($t){if(this.currentCharacterToken){switch($t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=$t.startLine,this.currentCharacterToken.location.endCol=$t.startCol,this.currentCharacterToken.location.endOffset=$t.startOffset),this.currentCharacterToken.type){case TokenType$1.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case TokenType$1.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case TokenType$1.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const $t=this.getCurrentLocation(0);$t&&($t.endLine=$t.startLine,$t.endCol=$t.startCol,$t.endOffset=$t.startOffset),this._emitCurrentCharacterToken($t),this.handler.onEof({type:TokenType$1.EOF,location:$t}),this.active=!1}_appendCharToCurrentCharacterToken($t,Ct){if(this.currentCharacterToken)if(this.currentCharacterToken.type!==$t)this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();else{this.currentCharacterToken.chars+=Ct;return}this._createCharacterToken($t,Ct)}_emitCodePoint($t){const Ct=isWhitespace($t)?TokenType$1.WHITESPACE_CHARACTER:$t===CODE_POINTS.NULL?TokenType$1.NULL_CHARACTER:TokenType$1.CHARACTER;this._appendCharToCurrentCharacterToken(Ct,String.fromCodePoint($t))}_emitChars($t){this._appendCharToCurrentCharacterToken(TokenType$1.CHARACTER,$t)}_matchNamedCharacterReference($t){let Ct=null,kt=0,Mt=!1;for(let Ft=0,jt=htmlDecodeTree[0];Ft>=0&&(Ft=determineBranch(htmlDecodeTree,jt,Ft+1,$t),!(Ft<0));$t=this._consume()){kt+=1,jt=htmlDecodeTree[Ft];const Bt=jt&BinTrieFlags.VALUE_LENGTH;if(Bt){const Vt=(Bt>>14)-1;if($t!==CODE_POINTS.SEMICOLON&&this._isCharacterReferenceInAttribute()&&isEntityInAttributeInvalidEnd(this.preprocessor.peek(1))?(Ct=[CODE_POINTS.AMPERSAND],Ft+=Vt):(Ct=Vt===0?[htmlDecodeTree[Ft]&~BinTrieFlags.VALUE_LENGTH]:Vt===1?[htmlDecodeTree[++Ft]]:[htmlDecodeTree[++Ft],htmlDecodeTree[++Ft]],kt=0,Mt=$t!==CODE_POINTS.SEMICOLON),Vt===0){this._consume();break}}}return this._unconsume(kt),Mt&&!this.preprocessor.endOfChunkHit&&this._err(ERR.missingSemicolonAfterCharacterReference),this._unconsume(1),Ct}_isCharacterReferenceInAttribute(){return this.returnState===State.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===State.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===State.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference($t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint($t):this._emitCodePoint($t)}_callState($t){switch(this.state){case State.DATA:{this._stateData($t);break}case State.RCDATA:{this._stateRcdata($t);break}case State.RAWTEXT:{this._stateRawtext($t);break}case State.SCRIPT_DATA:{this._stateScriptData($t);break}case State.PLAINTEXT:{this._statePlaintext($t);break}case State.TAG_OPEN:{this._stateTagOpen($t);break}case State.END_TAG_OPEN:{this._stateEndTagOpen($t);break}case State.TAG_NAME:{this._stateTagName($t);break}case State.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign($t);break}case State.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen($t);break}case State.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName($t);break}case State.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign($t);break}case State.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen($t);break}case State.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName($t);break}case State.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign($t);break}case State.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen($t);break}case State.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName($t);break}case State.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart($t);break}case State.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash($t);break}case State.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped($t);break}case State.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash($t);break}case State.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash($t);break}case State.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign($t);break}case State.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen($t);break}case State.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName($t);break}case State.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart($t);break}case State.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped($t);break}case State.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash($t);break}case State.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash($t);break}case State.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign($t);break}case State.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd($t);break}case State.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName($t);break}case State.ATTRIBUTE_NAME:{this._stateAttributeName($t);break}case State.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName($t);break}case State.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue($t);break}case State.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted($t);break}case State.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted($t);break}case State.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted($t);break}case State.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted($t);break}case State.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag($t);break}case State.BOGUS_COMMENT:{this._stateBogusComment($t);break}case State.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen($t);break}case State.COMMENT_START:{this._stateCommentStart($t);break}case State.COMMENT_START_DASH:{this._stateCommentStartDash($t);break}case State.COMMENT:{this._stateComment($t);break}case State.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign($t);break}case State.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang($t);break}case State.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash($t);break}case State.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash($t);break}case State.COMMENT_END_DASH:{this._stateCommentEndDash($t);break}case State.COMMENT_END:{this._stateCommentEnd($t);break}case State.COMMENT_END_BANG:{this._stateCommentEndBang($t);break}case State.DOCTYPE:{this._stateDoctype($t);break}case State.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName($t);break}case State.DOCTYPE_NAME:{this._stateDoctypeName($t);break}case State.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName($t);break}case State.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword($t);break}case State.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier($t);break}case State.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted($t);break}case State.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted($t);break}case State.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier($t);break}case State.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers($t);break}case State.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword($t);break}case State.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier($t);break}case State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted($t);break}case State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted($t);break}case State.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier($t);break}case State.BOGUS_DOCTYPE:{this._stateBogusDoctype($t);break}case State.CDATA_SECTION:{this._stateCdataSection($t);break}case State.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket($t);break}case State.CDATA_SECTION_END:{this._stateCdataSectionEnd($t);break}case State.CHARACTER_REFERENCE:{this._stateCharacterReference($t);break}case State.NAMED_CHARACTER_REFERENCE:{this._stateNamedCharacterReference($t);break}case State.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand($t);break}case State.NUMERIC_CHARACTER_REFERENCE:{this._stateNumericCharacterReference($t);break}case State.HEXADEMICAL_CHARACTER_REFERENCE_START:{this._stateHexademicalCharacterReferenceStart($t);break}case State.HEXADEMICAL_CHARACTER_REFERENCE:{this._stateHexademicalCharacterReference($t);break}case State.DECIMAL_CHARACTER_REFERENCE:{this._stateDecimalCharacterReference($t);break}case State.NUMERIC_CHARACTER_REFERENCE_END:{this._stateNumericCharacterReferenceEnd($t);break}default:throw new Error("Unknown state")}}_stateData($t){switch($t){case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.TAG_OPEN;break}case CODE_POINTS.AMPERSAND:{this.returnState=State.DATA,this.state=State.CHARACTER_REFERENCE;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitCodePoint($t);break}case CODE_POINTS.EOF:{this._emitEOFToken();break}default:this._emitCodePoint($t)}}_stateRcdata($t){switch($t){case CODE_POINTS.AMPERSAND:{this.returnState=State.RCDATA,this.state=State.CHARACTER_REFERENCE;break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.RCDATA_LESS_THAN_SIGN;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._emitEOFToken();break}default:this._emitCodePoint($t)}}_stateRawtext($t){switch($t){case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.RAWTEXT_LESS_THAN_SIGN;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._emitEOFToken();break}default:this._emitCodePoint($t)}}_stateScriptData($t){switch($t){case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_LESS_THAN_SIGN;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._emitEOFToken();break}default:this._emitCodePoint($t)}}_statePlaintext($t){switch($t){case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._emitEOFToken();break}default:this._emitCodePoint($t)}}_stateTagOpen($t){if(isAsciiLetter($t))this._createStartTagToken(),this.state=State.TAG_NAME,this._stateTagName($t);else switch($t){case CODE_POINTS.EXCLAMATION_MARK:{this.state=State.MARKUP_DECLARATION_OPEN;break}case CODE_POINTS.SOLIDUS:{this.state=State.END_TAG_OPEN;break}case CODE_POINTS.QUESTION_MARK:{this._err(ERR.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=State.BOGUS_COMMENT,this._stateBogusComment($t);break}case CODE_POINTS.EOF:{this._err(ERR.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(ERR.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=State.DATA,this._stateData($t)}}_stateEndTagOpen($t){if(isAsciiLetter($t))this._createEndTagToken(),this.state=State.TAG_NAME,this._stateTagName($t);else switch($t){case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingEndTagName),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(ERR.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=State.BOGUS_COMMENT,this._stateBogusComment($t)}}_stateTagName($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this.state=State.BEFORE_ATTRIBUTE_NAME;break}case CODE_POINTS.SOLIDUS:{this.state=State.SELF_CLOSING_START_TAG;break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentTagToken();break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Ct.tagName+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:Ct.tagName+=String.fromCodePoint(isAsciiUpper($t)?toAsciiLower($t):$t)}}_stateRcdataLessThanSign($t){$t===CODE_POINTS.SOLIDUS?this.state=State.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=State.RCDATA,this._stateRcdata($t))}_stateRcdataEndTagOpen($t){isAsciiLetter($t)?(this.state=State.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName($t)):(this._emitChars("</"),this.state=State.RCDATA,this._stateRcdata($t))}handleSpecialEndTag($t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const Ct=this.currentToken;switch(Ct.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=State.BEFORE_ATTRIBUTE_NAME,!1;case CODE_POINTS.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=State.SELF_CLOSING_START_TAG,!1;case CODE_POINTS.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=State.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName($t){this.handleSpecialEndTag($t)&&(this._emitChars("</"),this.state=State.RCDATA,this._stateRcdata($t))}_stateRawtextLessThanSign($t){$t===CODE_POINTS.SOLIDUS?this.state=State.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=State.RAWTEXT,this._stateRawtext($t))}_stateRawtextEndTagOpen($t){isAsciiLetter($t)?(this.state=State.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName($t)):(this._emitChars("</"),this.state=State.RAWTEXT,this._stateRawtext($t))}_stateRawtextEndTagName($t){this.handleSpecialEndTag($t)&&(this._emitChars("</"),this.state=State.RAWTEXT,this._stateRawtext($t))}_stateScriptDataLessThanSign($t){switch($t){case CODE_POINTS.SOLIDUS:{this.state=State.SCRIPT_DATA_END_TAG_OPEN;break}case CODE_POINTS.EXCLAMATION_MARK:{this.state=State.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=State.SCRIPT_DATA,this._stateScriptData($t)}}_stateScriptDataEndTagOpen($t){isAsciiLetter($t)?(this.state=State.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName($t)):(this._emitChars("</"),this.state=State.SCRIPT_DATA,this._stateScriptData($t))}_stateScriptDataEndTagName($t){this.handleSpecialEndTag($t)&&(this._emitChars("</"),this.state=State.SCRIPT_DATA,this._stateScriptData($t))}_stateScriptDataEscapeStart($t){$t===CODE_POINTS.HYPHEN_MINUS?(this.state=State.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=State.SCRIPT_DATA,this._stateScriptData($t))}_stateScriptDataEscapeStartDash($t){$t===CODE_POINTS.HYPHEN_MINUS?(this.state=State.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=State.SCRIPT_DATA,this._stateScriptData($t))}_stateScriptDataEscaped($t){switch($t){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._err(ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint($t)}}_stateScriptDataEscapedDash($t){switch($t){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.state=State.SCRIPT_DATA_ESCAPED,this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._err(ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=State.SCRIPT_DATA_ESCAPED,this._emitCodePoint($t)}}_stateScriptDataEscapedDashDash($t){switch($t){case CODE_POINTS.HYPHEN_MINUS:{this._emitChars("-");break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.SCRIPT_DATA,this._emitChars(">");break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.state=State.SCRIPT_DATA_ESCAPED,this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._err(ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=State.SCRIPT_DATA_ESCAPED,this._emitCodePoint($t)}}_stateScriptDataEscapedLessThanSign($t){$t===CODE_POINTS.SOLIDUS?this.state=State.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:isAsciiLetter($t)?(this._emitChars("<"),this.state=State.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart($t)):(this._emitChars("<"),this.state=State.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped($t))}_stateScriptDataEscapedEndTagOpen($t){isAsciiLetter($t)?(this.state=State.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName($t)):(this._emitChars("</"),this.state=State.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped($t))}_stateScriptDataEscapedEndTagName($t){this.handleSpecialEndTag($t)&&(this._emitChars("</"),this.state=State.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped($t))}_stateScriptDataDoubleEscapeStart($t){if(this.preprocessor.startsWith(SEQUENCES.SCRIPT,!1)&&isScriptDataDoubleEscapeSequenceEnd(this.preprocessor.peek(SEQUENCES.SCRIPT.length))){this._emitCodePoint($t);for(let Ct=0;Ct<SEQUENCES.SCRIPT.length;Ct++)this._emitCodePoint(this._consume());this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=State.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped($t))}_stateScriptDataDoubleEscaped($t){switch($t){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._err(ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint($t)}}_stateScriptDataDoubleEscapedDash($t){switch($t){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._err(ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint($t)}}_stateScriptDataDoubleEscapedDashDash($t){switch($t){case CODE_POINTS.HYPHEN_MINUS:{this._emitChars("-");break}case CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.SCRIPT_DATA,this._emitChars(">");break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(REPLACEMENT_CHARACTER);break}case CODE_POINTS.EOF:{this._err(ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint($t)}}_stateScriptDataDoubleEscapedLessThanSign($t){$t===CODE_POINTS.SOLIDUS?(this.state=State.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped($t))}_stateScriptDataDoubleEscapeEnd($t){if(this.preprocessor.startsWith(SEQUENCES.SCRIPT,!1)&&isScriptDataDoubleEscapeSequenceEnd(this.preprocessor.peek(SEQUENCES.SCRIPT.length))){this._emitCodePoint($t);for(let Ct=0;Ct<SEQUENCES.SCRIPT.length;Ct++)this._emitCodePoint(this._consume());this.state=State.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped($t))}_stateBeforeAttributeName($t){switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.SOLIDUS:case CODE_POINTS.GREATER_THAN_SIGN:case CODE_POINTS.EOF:{this.state=State.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName($t);break}case CODE_POINTS.EQUALS_SIGN:{this._err(ERR.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=State.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=State.ATTRIBUTE_NAME,this._stateAttributeName($t)}}_stateAttributeName($t){switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:case CODE_POINTS.SOLIDUS:case CODE_POINTS.GREATER_THAN_SIGN:case CODE_POINTS.EOF:{this._leaveAttrName(),this.state=State.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName($t);break}case CODE_POINTS.EQUALS_SIGN:{this._leaveAttrName(),this.state=State.BEFORE_ATTRIBUTE_VALUE;break}case CODE_POINTS.QUOTATION_MARK:case CODE_POINTS.APOSTROPHE:case CODE_POINTS.LESS_THAN_SIGN:{this._err(ERR.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint($t);break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.currentAttr.name+=REPLACEMENT_CHARACTER;break}default:this.currentAttr.name+=String.fromCodePoint(isAsciiUpper($t)?toAsciiLower($t):$t)}}_stateAfterAttributeName($t){switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.SOLIDUS:{this.state=State.SELF_CLOSING_START_TAG;break}case CODE_POINTS.EQUALS_SIGN:{this.state=State.BEFORE_ATTRIBUTE_VALUE;break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentTagToken();break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=State.ATTRIBUTE_NAME,this._stateAttributeName($t)}}_stateBeforeAttributeValue($t){switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.QUOTATION_MARK:{this.state=State.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{this.state=State.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingAttributeValue),this.state=State.DATA,this.emitCurrentTagToken();break}default:this.state=State.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted($t)}}_stateAttributeValueDoubleQuoted($t){switch($t){case CODE_POINTS.QUOTATION_MARK:{this.state=State.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case CODE_POINTS.AMPERSAND:{this.returnState=State.ATTRIBUTE_VALUE_DOUBLE_QUOTED,this.state=State.CHARACTER_REFERENCE;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.currentAttr.value+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint($t)}}_stateAttributeValueSingleQuoted($t){switch($t){case CODE_POINTS.APOSTROPHE:{this.state=State.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case CODE_POINTS.AMPERSAND:{this.returnState=State.ATTRIBUTE_VALUE_SINGLE_QUOTED,this.state=State.CHARACTER_REFERENCE;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.currentAttr.value+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint($t)}}_stateAttributeValueUnquoted($t){switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this._leaveAttrValue(),this.state=State.BEFORE_ATTRIBUTE_NAME;break}case CODE_POINTS.AMPERSAND:{this.returnState=State.ATTRIBUTE_VALUE_UNQUOTED,this.state=State.CHARACTER_REFERENCE;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=State.DATA,this.emitCurrentTagToken();break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this.currentAttr.value+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.QUOTATION_MARK:case CODE_POINTS.APOSTROPHE:case CODE_POINTS.LESS_THAN_SIGN:case CODE_POINTS.EQUALS_SIGN:case CODE_POINTS.GRAVE_ACCENT:{this._err(ERR.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint($t);break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint($t)}}_stateAfterAttributeValueQuoted($t){switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this._leaveAttrValue(),this.state=State.BEFORE_ATTRIBUTE_NAME;break}case CODE_POINTS.SOLIDUS:{this._leaveAttrValue(),this.state=State.SELF_CLOSING_START_TAG;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=State.DATA,this.emitCurrentTagToken();break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:this._err(ERR.missingWhitespaceBetweenAttributes),this.state=State.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName($t)}}_stateSelfClosingStartTag($t){switch($t){case CODE_POINTS.GREATER_THAN_SIGN:{const Ct=this.currentToken;Ct.selfClosing=!0,this.state=State.DATA,this.emitCurrentTagToken();break}case CODE_POINTS.EOF:{this._err(ERR.eofInTag),this._emitEOFToken();break}default:this._err(ERR.unexpectedSolidusInTag),this.state=State.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName($t)}}_stateBogusComment($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentComment(Ct);break}case CODE_POINTS.EOF:{this.emitCurrentComment(Ct),this._emitEOFToken();break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Ct.data+=REPLACEMENT_CHARACTER;break}default:Ct.data+=String.fromCodePoint($t)}}_stateMarkupDeclarationOpen($t){this._consumeSequenceIfMatch(SEQUENCES.DASH_DASH,!0)?(this._createCommentToken(SEQUENCES.DASH_DASH.length+1),this.state=State.COMMENT_START):this._consumeSequenceIfMatch(SEQUENCES.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(SEQUENCES.DOCTYPE.length+1),this.state=State.DOCTYPE):this._consumeSequenceIfMatch(SEQUENCES.CDATA_START,!0)?this.inForeignNode?this.state=State.CDATA_SECTION:(this._err(ERR.cdataInHtmlContent),this._createCommentToken(SEQUENCES.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=State.BOGUS_COMMENT):this._ensureHibernation()||(this._err(ERR.incorrectlyOpenedComment),this._createCommentToken(2),this.state=State.BOGUS_COMMENT,this._stateBogusComment($t))}_stateCommentStart($t){switch($t){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.COMMENT_START_DASH;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.abruptClosingOfEmptyComment),this.state=State.DATA;const Ct=this.currentToken;this.emitCurrentComment(Ct);break}default:this.state=State.COMMENT,this._stateComment($t)}}_stateCommentStartDash($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.COMMENT_END;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.abruptClosingOfEmptyComment),this.state=State.DATA,this.emitCurrentComment(Ct);break}case CODE_POINTS.EOF:{this._err(ERR.eofInComment),this.emitCurrentComment(Ct),this._emitEOFToken();break}default:Ct.data+="-",this.state=State.COMMENT,this._stateComment($t)}}_stateComment($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.COMMENT_END_DASH;break}case CODE_POINTS.LESS_THAN_SIGN:{Ct.data+="<",this.state=State.COMMENT_LESS_THAN_SIGN;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Ct.data+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.EOF:{this._err(ERR.eofInComment),this.emitCurrentComment(Ct),this._emitEOFToken();break}default:Ct.data+=String.fromCodePoint($t)}}_stateCommentLessThanSign($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.EXCLAMATION_MARK:{Ct.data+="!",this.state=State.COMMENT_LESS_THAN_SIGN_BANG;break}case CODE_POINTS.LESS_THAN_SIGN:{Ct.data+="<";break}default:this.state=State.COMMENT,this._stateComment($t)}}_stateCommentLessThanSignBang($t){$t===CODE_POINTS.HYPHEN_MINUS?this.state=State.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=State.COMMENT,this._stateComment($t))}_stateCommentLessThanSignBangDash($t){$t===CODE_POINTS.HYPHEN_MINUS?this.state=State.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=State.COMMENT_END_DASH,this._stateCommentEndDash($t))}_stateCommentLessThanSignBangDashDash($t){$t!==CODE_POINTS.GREATER_THAN_SIGN&&$t!==CODE_POINTS.EOF&&this._err(ERR.nestedComment),this.state=State.COMMENT_END,this._stateCommentEnd($t)}_stateCommentEndDash($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.HYPHEN_MINUS:{this.state=State.COMMENT_END;break}case CODE_POINTS.EOF:{this._err(ERR.eofInComment),this.emitCurrentComment(Ct),this._emitEOFToken();break}default:Ct.data+="-",this.state=State.COMMENT,this._stateComment($t)}}_stateCommentEnd($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentComment(Ct);break}case CODE_POINTS.EXCLAMATION_MARK:{this.state=State.COMMENT_END_BANG;break}case CODE_POINTS.HYPHEN_MINUS:{Ct.data+="-";break}case CODE_POINTS.EOF:{this._err(ERR.eofInComment),this.emitCurrentComment(Ct),this._emitEOFToken();break}default:Ct.data+="--",this.state=State.COMMENT,this._stateComment($t)}}_stateCommentEndBang($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.HYPHEN_MINUS:{Ct.data+="--!",this.state=State.COMMENT_END_DASH;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.incorrectlyClosedComment),this.state=State.DATA,this.emitCurrentComment(Ct);break}case CODE_POINTS.EOF:{this._err(ERR.eofInComment),this.emitCurrentComment(Ct),this._emitEOFToken();break}default:Ct.data+="--!",this.state=State.COMMENT,this._stateComment($t)}}_stateDoctype($t){switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this.state=State.BEFORE_DOCTYPE_NAME;break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName($t);break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),this._createDoctypeToken(null);const Ct=this.currentToken;Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:this._err(ERR.missingWhitespaceBeforeDoctypeName),this.state=State.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName($t)}}_stateBeforeDoctypeName($t){if(isAsciiUpper($t))this._createDoctypeToken(String.fromCharCode(toAsciiLower($t))),this.state=State.DOCTYPE_NAME;else switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),this._createDoctypeToken(REPLACEMENT_CHARACTER),this.state=State.DOCTYPE_NAME;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingDoctypeName),this._createDoctypeToken(null);const Ct=this.currentToken;Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),this._createDoctypeToken(null);const Ct=this.currentToken;Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint($t)),this.state=State.DOCTYPE_NAME}}_stateDoctypeName($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this.state=State.AFTER_DOCTYPE_NAME;break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentDoctype(Ct);break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Ct.name+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:Ct.name+=String.fromCodePoint(isAsciiUpper($t)?toAsciiLower($t):$t)}}_stateAfterDoctypeName($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentDoctype(Ct);break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(SEQUENCES.PUBLIC,!1)?this.state=State.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(SEQUENCES.SYSTEM,!1)?this.state=State.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(ERR.invalidCharacterSequenceAfterDoctypeName),Ct.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype($t))}}_stateAfterDoctypePublicKeyword($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this.state=State.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case CODE_POINTS.QUOTATION_MARK:{this._err(ERR.missingWhitespaceAfterDoctypePublicKeyword),Ct.publicId="",this.state=State.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{this._err(ERR.missingWhitespaceAfterDoctypePublicKeyword),Ct.publicId="",this.state=State.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingDoctypePublicIdentifier),Ct.forceQuirks=!0,this.state=State.DATA,this.emitCurrentDoctype(Ct);break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:this._err(ERR.missingQuoteBeforeDoctypePublicIdentifier),Ct.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype($t)}}_stateBeforeDoctypePublicIdentifier($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.QUOTATION_MARK:{Ct.publicId="",this.state=State.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{Ct.publicId="",this.state=State.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingDoctypePublicIdentifier),Ct.forceQuirks=!0,this.state=State.DATA,this.emitCurrentDoctype(Ct);break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:this._err(ERR.missingQuoteBeforeDoctypePublicIdentifier),Ct.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype($t)}}_stateDoctypePublicIdentifierDoubleQuoted($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.QUOTATION_MARK:{this.state=State.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Ct.publicId+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.abruptDoctypePublicIdentifier),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:Ct.publicId+=String.fromCodePoint($t)}}_stateDoctypePublicIdentifierSingleQuoted($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.APOSTROPHE:{this.state=State.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Ct.publicId+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.abruptDoctypePublicIdentifier),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:Ct.publicId+=String.fromCodePoint($t)}}_stateAfterDoctypePublicIdentifier($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this.state=State.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA,this.emitCurrentDoctype(Ct);break}case CODE_POINTS.QUOTATION_MARK:{this._err(ERR.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),Ct.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{this._err(ERR.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),Ct.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:this._err(ERR.missingQuoteBeforeDoctypeSystemIdentifier),Ct.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype($t)}}_stateBetweenDoctypePublicAndSystemIdentifiers($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.GREATER_THAN_SIGN:{this.emitCurrentDoctype(Ct),this.state=State.DATA;break}case CODE_POINTS.QUOTATION_MARK:{Ct.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{Ct.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:this._err(ERR.missingQuoteBeforeDoctypeSystemIdentifier),Ct.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype($t)}}_stateAfterDoctypeSystemKeyword($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:{this.state=State.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case CODE_POINTS.QUOTATION_MARK:{this._err(ERR.missingWhitespaceAfterDoctypeSystemKeyword),Ct.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{this._err(ERR.missingWhitespaceAfterDoctypeSystemKeyword),Ct.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingDoctypeSystemIdentifier),Ct.forceQuirks=!0,this.state=State.DATA,this.emitCurrentDoctype(Ct);break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:this._err(ERR.missingQuoteBeforeDoctypeSystemIdentifier),Ct.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype($t)}}_stateBeforeDoctypeSystemIdentifier($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.QUOTATION_MARK:{Ct.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case CODE_POINTS.APOSTROPHE:{Ct.systemId="",this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.missingDoctypeSystemIdentifier),Ct.forceQuirks=!0,this.state=State.DATA,this.emitCurrentDoctype(Ct);break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:this._err(ERR.missingQuoteBeforeDoctypeSystemIdentifier),Ct.forceQuirks=!0,this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype($t)}}_stateDoctypeSystemIdentifierDoubleQuoted($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.QUOTATION_MARK:{this.state=State.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Ct.systemId+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.abruptDoctypeSystemIdentifier),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:Ct.systemId+=String.fromCodePoint($t)}}_stateDoctypeSystemIdentifierSingleQuoted($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.APOSTROPHE:{this.state=State.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter),Ct.systemId+=REPLACEMENT_CHARACTER;break}case CODE_POINTS.GREATER_THAN_SIGN:{this._err(ERR.abruptDoctypeSystemIdentifier),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:Ct.systemId+=String.fromCodePoint($t)}}_stateAfterDoctypeSystemIdentifier($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.SPACE:case CODE_POINTS.LINE_FEED:case CODE_POINTS.TABULATION:case CODE_POINTS.FORM_FEED:break;case CODE_POINTS.GREATER_THAN_SIGN:{this.emitCurrentDoctype(Ct),this.state=State.DATA;break}case CODE_POINTS.EOF:{this._err(ERR.eofInDoctype),Ct.forceQuirks=!0,this.emitCurrentDoctype(Ct),this._emitEOFToken();break}default:this._err(ERR.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=State.BOGUS_DOCTYPE,this._stateBogusDoctype($t)}}_stateBogusDoctype($t){const Ct=this.currentToken;switch($t){case CODE_POINTS.GREATER_THAN_SIGN:{this.emitCurrentDoctype(Ct),this.state=State.DATA;break}case CODE_POINTS.NULL:{this._err(ERR.unexpectedNullCharacter);break}case CODE_POINTS.EOF:{this.emitCurrentDoctype(Ct),this._emitEOFToken();break}}}_stateCdataSection($t){switch($t){case CODE_POINTS.RIGHT_SQUARE_BRACKET:{this.state=State.CDATA_SECTION_BRACKET;break}case CODE_POINTS.EOF:{this._err(ERR.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint($t)}}_stateCdataSectionBracket($t){$t===CODE_POINTS.RIGHT_SQUARE_BRACKET?this.state=State.CDATA_SECTION_END:(this._emitChars("]"),this.state=State.CDATA_SECTION,this._stateCdataSection($t))}_stateCdataSectionEnd($t){switch($t){case CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA;break}case CODE_POINTS.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=State.CDATA_SECTION,this._stateCdataSection($t)}}_stateCharacterReference($t){$t===CODE_POINTS.NUMBER_SIGN?this.state=State.NUMERIC_CHARACTER_REFERENCE:isAsciiAlphaNumeric($t)?(this.state=State.NAMED_CHARACTER_REFERENCE,this._stateNamedCharacterReference($t)):(this._flushCodePointConsumedAsCharacterReference(CODE_POINTS.AMPERSAND),this._reconsumeInState(this.returnState,$t))}_stateNamedCharacterReference($t){const Ct=this._matchNamedCharacterReference($t);if(!this._ensureHibernation())if(Ct){for(let kt=0;kt<Ct.length;kt++)this._flushCodePointConsumedAsCharacterReference(Ct[kt]);this.state=this.returnState}else this._flushCodePointConsumedAsCharacterReference(CODE_POINTS.AMPERSAND),this.state=State.AMBIGUOUS_AMPERSAND}_stateAmbiguousAmpersand($t){isAsciiAlphaNumeric($t)?this._flushCodePointConsumedAsCharacterReference($t):($t===CODE_POINTS.SEMICOLON&&this._err(ERR.unknownNamedCharacterReference),this._reconsumeInState(this.returnState,$t))}_stateNumericCharacterReference($t){this.charRefCode=0,$t===CODE_POINTS.LATIN_SMALL_X||$t===CODE_POINTS.LATIN_CAPITAL_X?this.state=State.HEXADEMICAL_CHARACTER_REFERENCE_START:isAsciiDigit($t)?(this.state=State.DECIMAL_CHARACTER_REFERENCE,this._stateDecimalCharacterReference($t)):(this._err(ERR.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(CODE_POINTS.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(CODE_POINTS.NUMBER_SIGN),this._reconsumeInState(this.returnState,$t))}_stateHexademicalCharacterReferenceStart($t){isAsciiHexDigit($t)?(this.state=State.HEXADEMICAL_CHARACTER_REFERENCE,this._stateHexademicalCharacterReference($t)):(this._err(ERR.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(CODE_POINTS.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(CODE_POINTS.NUMBER_SIGN),this._unconsume(2),this.state=this.returnState)}_stateHexademicalCharacterReference($t){isAsciiUpperHexDigit($t)?this.charRefCode=this.charRefCode*16+$t-55:isAsciiLowerHexDigit($t)?this.charRefCode=this.charRefCode*16+$t-87:isAsciiDigit($t)?this.charRefCode=this.charRefCode*16+$t-48:$t===CODE_POINTS.SEMICOLON?this.state=State.NUMERIC_CHARACTER_REFERENCE_END:(this._err(ERR.missingSemicolonAfterCharacterReference),this.state=State.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd($t))}_stateDecimalCharacterReference($t){isAsciiDigit($t)?this.charRefCode=this.charRefCode*10+$t-48:$t===CODE_POINTS.SEMICOLON?this.state=State.NUMERIC_CHARACTER_REFERENCE_END:(this._err(ERR.missingSemicolonAfterCharacterReference),this.state=State.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd($t))}_stateNumericCharacterReferenceEnd($t){if(this.charRefCode===CODE_POINTS.NULL)this._err(ERR.nullCharacterReference),this.charRefCode=CODE_POINTS.REPLACEMENT_CHARACTER;else if(this.charRefCode>1114111)this._err(ERR.characterReferenceOutsideUnicodeRange),this.charRefCode=CODE_POINTS.REPLACEMENT_CHARACTER;else if(isSurrogate(this.charRefCode))this._err(ERR.surrogateCharacterReference),this.charRefCode=CODE_POINTS.REPLACEMENT_CHARACTER;else if(isUndefinedCodePoint(this.charRefCode))this._err(ERR.noncharacterCharacterReference);else if(isControlCodePoint(this.charRefCode)||this.charRefCode===CODE_POINTS.CARRIAGE_RETURN){this._err(ERR.controlCharacterReference);const Ct=C1_CONTROLS_REFERENCE_REPLACEMENTS.get(this.charRefCode);Ct!==void 0&&(this.charRefCode=Ct)}this._flushCodePointConsumedAsCharacterReference(this.charRefCode),this._reconsumeInState(this.returnState,$t)}}const IMPLICIT_END_TAG_REQUIRED=new Set([TAG_ID.DD,TAG_ID.DT,TAG_ID.LI,TAG_ID.OPTGROUP,TAG_ID.OPTION,TAG_ID.P,TAG_ID.RB,TAG_ID.RP,TAG_ID.RT,TAG_ID.RTC]),IMPLICIT_END_TAG_REQUIRED_THOROUGHLY=new Set([...IMPLICIT_END_TAG_REQUIRED,TAG_ID.CAPTION,TAG_ID.COLGROUP,TAG_ID.TBODY,TAG_ID.TD,TAG_ID.TFOOT,TAG_ID.TH,TAG_ID.THEAD,TAG_ID.TR]),SCOPING_ELEMENT_NS=new Map([[TAG_ID.APPLET,NS.HTML],[TAG_ID.CAPTION,NS.HTML],[TAG_ID.HTML,NS.HTML],[TAG_ID.MARQUEE,NS.HTML],[TAG_ID.OBJECT,NS.HTML],[TAG_ID.TABLE,NS.HTML],[TAG_ID.TD,NS.HTML],[TAG_ID.TEMPLATE,NS.HTML],[TAG_ID.TH,NS.HTML],[TAG_ID.ANNOTATION_XML,NS.MATHML],[TAG_ID.MI,NS.MATHML],[TAG_ID.MN,NS.MATHML],[TAG_ID.MO,NS.MATHML],[TAG_ID.MS,NS.MATHML],[TAG_ID.MTEXT,NS.MATHML],[TAG_ID.DESC,NS.SVG],[TAG_ID.FOREIGN_OBJECT,NS.SVG],[TAG_ID.TITLE,NS.SVG]]),NAMED_HEADERS=[TAG_ID.H1,TAG_ID.H2,TAG_ID.H3,TAG_ID.H4,TAG_ID.H5,TAG_ID.H6],TABLE_ROW_CONTEXT=[TAG_ID.TR,TAG_ID.TEMPLATE,TAG_ID.HTML],TABLE_BODY_CONTEXT=[TAG_ID.TBODY,TAG_ID.TFOOT,TAG_ID.THEAD,TAG_ID.TEMPLATE,TAG_ID.HTML],TABLE_CONTEXT=[TAG_ID.TABLE,TAG_ID.TEMPLATE,TAG_ID.HTML],TABLE_CELLS=[TAG_ID.TD,TAG_ID.TH];class OpenElementStack{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor($t,Ct,kt){this.treeAdapter=Ct,this.handler=kt,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=TAG_ID.UNKNOWN,this.current=$t}_indexOf($t){return this.items.lastIndexOf($t,this.stackTop)}_isInTemplate(){return this.currentTagId===TAG_ID.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===NS.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push($t,Ct){this.stackTop++,this.items[this.stackTop]=$t,this.current=$t,this.tagIDs[this.stackTop]=Ct,this.currentTagId=Ct,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush($t,Ct,!0)}pop(){const $t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop($t,!0)}replace($t,Ct){const kt=this._indexOf($t);this.items[kt]=Ct,kt===this.stackTop&&(this.current=Ct)}insertAfter($t,Ct,kt){const Mt=this._indexOf($t)+1;this.items.splice(Mt,0,Ct),this.tagIDs.splice(Mt,0,kt),this.stackTop++,Mt===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,Mt===this.stackTop)}popUntilTagNamePopped($t){let Ct=this.stackTop+1;do Ct=this.tagIDs.lastIndexOf($t,Ct-1);while(Ct>0&&this.treeAdapter.getNamespaceURI(this.items[Ct])!==NS.HTML);this.shortenToLength(Ct<0?0:Ct)}shortenToLength($t){for(;this.stackTop>=$t;){const Ct=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(Ct,this.stackTop<$t)}}popUntilElementPopped($t){const Ct=this._indexOf($t);this.shortenToLength(Ct<0?0:Ct)}popUntilPopped($t,Ct){const kt=this._indexOfTagNames($t,Ct);this.shortenToLength(kt<0?0:kt)}popUntilNumberedHeaderPopped(){this.popUntilPopped(NAMED_HEADERS,NS.HTML)}popUntilTableCellPopped(){this.popUntilPopped(TABLE_CELLS,NS.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames($t,Ct){for(let kt=this.stackTop;kt>=0;kt--)if($t.includes(this.tagIDs[kt])&&this.treeAdapter.getNamespaceURI(this.items[kt])===Ct)return kt;return-1}clearBackTo($t,Ct){const kt=this._indexOfTagNames($t,Ct);this.shortenToLength(kt+1)}clearBackToTableContext(){this.clearBackTo(TABLE_CONTEXT,NS.HTML)}clearBackToTableBodyContext(){this.clearBackTo(TABLE_BODY_CONTEXT,NS.HTML)}clearBackToTableRowContext(){this.clearBackTo(TABLE_ROW_CONTEXT,NS.HTML)}remove($t){const Ct=this._indexOf($t);Ct>=0&&(Ct===this.stackTop?this.pop():(this.items.splice(Ct,1),this.tagIDs.splice(Ct,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop($t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===TAG_ID.BODY?this.items[1]:null}contains($t){return this._indexOf($t)>-1}getCommonAncestor($t){const Ct=this._indexOf($t)-1;return Ct>=0?this.items[Ct]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===TAG_ID.HTML}hasInScope($t){for(let Ct=this.stackTop;Ct>=0;Ct--){const kt=this.tagIDs[Ct],Mt=this.treeAdapter.getNamespaceURI(this.items[Ct]);if(kt===$t&&Mt===NS.HTML)return!0;if(SCOPING_ELEMENT_NS.get(kt)===Mt)return!1}return!0}hasNumberedHeaderInScope(){for(let $t=this.stackTop;$t>=0;$t--){const Ct=this.tagIDs[$t],kt=this.treeAdapter.getNamespaceURI(this.items[$t]);if(isNumberedHeader(Ct)&&kt===NS.HTML)return!0;if(SCOPING_ELEMENT_NS.get(Ct)===kt)return!1}return!0}hasInListItemScope($t){for(let Ct=this.stackTop;Ct>=0;Ct--){const kt=this.tagIDs[Ct],Mt=this.treeAdapter.getNamespaceURI(this.items[Ct]);if(kt===$t&&Mt===NS.HTML)return!0;if((kt===TAG_ID.UL||kt===TAG_ID.OL)&&Mt===NS.HTML||SCOPING_ELEMENT_NS.get(kt)===Mt)return!1}return!0}hasInButtonScope($t){for(let Ct=this.stackTop;Ct>=0;Ct--){const kt=this.tagIDs[Ct],Mt=this.treeAdapter.getNamespaceURI(this.items[Ct]);if(kt===$t&&Mt===NS.HTML)return!0;if(kt===TAG_ID.BUTTON&&Mt===NS.HTML||SCOPING_ELEMENT_NS.get(kt)===Mt)return!1}return!0}hasInTableScope($t){for(let Ct=this.stackTop;Ct>=0;Ct--){const kt=this.tagIDs[Ct];if(this.treeAdapter.getNamespaceURI(this.items[Ct])===NS.HTML){if(kt===$t)return!0;if(kt===TAG_ID.TABLE||kt===TAG_ID.TEMPLATE||kt===TAG_ID.HTML)return!1}}return!0}hasTableBodyContextInTableScope(){for(let $t=this.stackTop;$t>=0;$t--){const Ct=this.tagIDs[$t];if(this.treeAdapter.getNamespaceURI(this.items[$t])===NS.HTML){if(Ct===TAG_ID.TBODY||Ct===TAG_ID.THEAD||Ct===TAG_ID.TFOOT)return!0;if(Ct===TAG_ID.TABLE||Ct===TAG_ID.HTML)return!1}}return!0}hasInSelectScope($t){for(let Ct=this.stackTop;Ct>=0;Ct--){const kt=this.tagIDs[Ct];if(this.treeAdapter.getNamespaceURI(this.items[Ct])===NS.HTML){if(kt===$t)return!0;if(kt!==TAG_ID.OPTION&&kt!==TAG_ID.OPTGROUP)return!1}}return!0}generateImpliedEndTags(){for(;IMPLICIT_END_TAG_REQUIRED.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;IMPLICIT_END_TAG_REQUIRED_THOROUGHLY.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion($t){for(;this.currentTagId!==$t&&IMPLICIT_END_TAG_REQUIRED_THOROUGHLY.has(this.currentTagId);)this.pop()}}const NOAH_ARK_CAPACITY=3;var EntryType;(function(xt){xt[xt.Marker=0]="Marker",xt[xt.Element=1]="Element"})(EntryType=EntryType||(EntryType={}));const MARKER={type:EntryType.Marker};class FormattingElementList{constructor($t){this.treeAdapter=$t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates($t,Ct){const kt=[],Mt=Ct.length,Ft=this.treeAdapter.getTagName($t),jt=this.treeAdapter.getNamespaceURI($t);for(let Bt=0;Bt<this.entries.length;Bt++){const Vt=this.entries[Bt];if(Vt.type===EntryType.Marker)break;const{element:zt}=Vt;if(this.treeAdapter.getTagName(zt)===Ft&&this.treeAdapter.getNamespaceURI(zt)===jt){const Ht=this.treeAdapter.getAttrList(zt);Ht.length===Mt&&kt.push({idx:Bt,attrs:Ht})}}return kt}_ensureNoahArkCondition($t){if(this.entries.length<NOAH_ARK_CAPACITY)return;const Ct=this.treeAdapter.getAttrList($t),kt=this._getNoahArkConditionCandidates($t,Ct);if(kt.length<NOAH_ARK_CAPACITY)return;const Mt=new Map(Ct.map(jt=>[jt.name,jt.value]));let Ft=0;for(let jt=0;jt<kt.length;jt++){const Bt=kt[jt];Bt.attrs.every(Vt=>Mt.get(Vt.name)===Vt.value)&&(Ft+=1,Ft>=NOAH_ARK_CAPACITY&&this.entries.splice(Bt.idx,1))}}insertMarker(){this.entries.unshift(MARKER)}pushElement($t,Ct){this._ensureNoahArkCondition($t),this.entries.unshift({type:EntryType.Element,element:$t,token:Ct})}insertElementAfterBookmark($t,Ct){const kt=this.entries.indexOf(this.bookmark);this.entries.splice(kt,0,{type:EntryType.Element,element:$t,token:Ct})}removeEntry($t){const Ct=this.entries.indexOf($t);Ct>=0&&this.entries.splice(Ct,1)}clearToLastMarker(){const $t=this.entries.indexOf(MARKER);$t>=0?this.entries.splice(0,$t+1):this.entries.length=0}getElementEntryInScopeWithTagName($t){const Ct=this.entries.find(kt=>kt.type===EntryType.Marker||this.treeAdapter.getTagName(kt.element)===$t);return Ct&&Ct.type===EntryType.Element?Ct:null}getElementEntry($t){return this.entries.find(Ct=>Ct.type===EntryType.Element&&Ct.element===$t)}}function createTextNode(xt){return{nodeName:"#text",value:xt,parentNode:null}}const defaultTreeAdapter={createDocument(){return{nodeName:"#document",mode:DOCUMENT_MODE.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(xt,$t,Ct){return{nodeName:xt,tagName:xt,attrs:Ct,namespaceURI:$t,childNodes:[],parentNode:null}},createCommentNode(xt){return{nodeName:"#comment",data:xt,parentNode:null}},appendChild(xt,$t){xt.childNodes.push($t),$t.parentNode=xt},insertBefore(xt,$t,Ct){const kt=xt.childNodes.indexOf(Ct);xt.childNodes.splice(kt,0,$t),$t.parentNode=xt},setTemplateContent(xt,$t){xt.content=$t},getTemplateContent(xt){return xt.content},setDocumentType(xt,$t,Ct,kt){const Mt=xt.childNodes.find(Ft=>Ft.nodeName==="#documentType");if(Mt)Mt.name=$t,Mt.publicId=Ct,Mt.systemId=kt;else{const Ft={nodeName:"#documentType",name:$t,publicId:Ct,systemId:kt,parentNode:null};defaultTreeAdapter.appendChild(xt,Ft)}},setDocumentMode(xt,$t){xt.mode=$t},getDocumentMode(xt){return xt.mode},detachNode(xt){if(xt.parentNode){const $t=xt.parentNode.childNodes.indexOf(xt);xt.parentNode.childNodes.splice($t,1),xt.parentNode=null}},insertText(xt,$t){if(xt.childNodes.length>0){const Ct=xt.childNodes[xt.childNodes.length-1];if(defaultTreeAdapter.isTextNode(Ct)){Ct.value+=$t;return}}defaultTreeAdapter.appendChild(xt,createTextNode($t))},insertTextBefore(xt,$t,Ct){const kt=xt.childNodes[xt.childNodes.indexOf(Ct)-1];kt&&defaultTreeAdapter.isTextNode(kt)?kt.value+=$t:defaultTreeAdapter.insertBefore(xt,createTextNode($t),Ct)},adoptAttributes(xt,$t){const Ct=new Set(xt.attrs.map(kt=>kt.name));for(let kt=0;kt<$t.length;kt++)Ct.has($t[kt].name)||xt.attrs.push($t[kt])},getFirstChild(xt){return xt.childNodes[0]},getChildNodes(xt){return xt.childNodes},getParentNode(xt){return xt.parentNode},getAttrList(xt){return xt.attrs},getTagName(xt){return xt.tagName},getNamespaceURI(xt){return xt.namespaceURI},getTextNodeContent(xt){return xt.value},getCommentNodeContent(xt){return xt.data},getDocumentTypeNodeName(xt){return xt.name},getDocumentTypeNodePublicId(xt){return xt.publicId},getDocumentTypeNodeSystemId(xt){return xt.systemId},isTextNode(xt){return xt.nodeName==="#text"},isCommentNode(xt){return xt.nodeName==="#comment"},isDocumentTypeNode(xt){return xt.nodeName==="#documentType"},isElementNode(xt){return Object.prototype.hasOwnProperty.call(xt,"tagName")},setNodeSourceCodeLocation(xt,$t){xt.sourceCodeLocation=$t},getNodeSourceCodeLocation(xt){return xt.sourceCodeLocation},updateNodeSourceCodeLocation(xt,$t){xt.sourceCodeLocation={...xt.sourceCodeLocation,...$t}}},VALID_DOCTYPE_NAME="html",VALID_SYSTEM_ID="about:legacy-compat",QUIRKS_MODE_SYSTEM_ID="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",QUIRKS_MODE_PUBLIC_ID_PREFIXES=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],QUIRKS_MODE_NO_SYSTEM_ID_PUBLIC_ID_PREFIXES=[...QUIRKS_MODE_PUBLIC_ID_PREFIXES,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],QUIRKS_MODE_PUBLIC_IDS=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),LIMITED_QUIRKS_PUBLIC_ID_PREFIXES=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],LIMITED_QUIRKS_WITH_SYSTEM_ID_PUBLIC_ID_PREFIXES=[...LIMITED_QUIRKS_PUBLIC_ID_PREFIXES,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function hasPrefix(xt,$t){return $t.some(Ct=>xt.startsWith(Ct))}function isConforming(xt){return xt.name===VALID_DOCTYPE_NAME&&xt.publicId===null&&(xt.systemId===null||xt.systemId===VALID_SYSTEM_ID)}function getDocumentMode(xt){if(xt.name!==VALID_DOCTYPE_NAME)return DOCUMENT_MODE.QUIRKS;const{systemId:$t}=xt;if($t&&$t.toLowerCase()===QUIRKS_MODE_SYSTEM_ID)return DOCUMENT_MODE.QUIRKS;let{publicId:Ct}=xt;if(Ct!==null){if(Ct=Ct.toLowerCase(),QUIRKS_MODE_PUBLIC_IDS.has(Ct))return DOCUMENT_MODE.QUIRKS;let kt=$t===null?QUIRKS_MODE_NO_SYSTEM_ID_PUBLIC_ID_PREFIXES:QUIRKS_MODE_PUBLIC_ID_PREFIXES;if(hasPrefix(Ct,kt))return DOCUMENT_MODE.QUIRKS;if(kt=$t===null?LIMITED_QUIRKS_PUBLIC_ID_PREFIXES:LIMITED_QUIRKS_WITH_SYSTEM_ID_PUBLIC_ID_PREFIXES,hasPrefix(Ct,kt))return DOCUMENT_MODE.LIMITED_QUIRKS}return DOCUMENT_MODE.NO_QUIRKS}const MIME_TYPES={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},DEFINITION_URL_ATTR="definitionurl",ADJUSTED_DEFINITION_URL_ATTR="definitionURL",SVG_ATTRS_ADJUSTMENT_MAP=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(xt=>[xt.toLowerCase(),xt])),XML_ATTRS_ADJUSTMENT_MAP=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:NS.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:NS.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:NS.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:NS.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:NS.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:NS.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:NS.XLINK}],["xml:base",{prefix:"xml",name:"base",namespace:NS.XML}],["xml:lang",{prefix:"xml",name:"lang",namespace:NS.XML}],["xml:space",{prefix:"xml",name:"space",namespace:NS.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:NS.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:NS.XMLNS}]]),SVG_TAG_NAMES_ADJUSTMENT_MAP=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(xt=>[xt.toLowerCase(),xt])),EXITS_FOREIGN_CONTENT=new Set([TAG_ID.B,TAG_ID.BIG,TAG_ID.BLOCKQUOTE,TAG_ID.BODY,TAG_ID.BR,TAG_ID.CENTER,TAG_ID.CODE,TAG_ID.DD,TAG_ID.DIV,TAG_ID.DL,TAG_ID.DT,TAG_ID.EM,TAG_ID.EMBED,TAG_ID.H1,TAG_ID.H2,TAG_ID.H3,TAG_ID.H4,TAG_ID.H5,TAG_ID.H6,TAG_ID.HEAD,TAG_ID.HR,TAG_ID.I,TAG_ID.IMG,TAG_ID.LI,TAG_ID.LISTING,TAG_ID.MENU,TAG_ID.META,TAG_ID.NOBR,TAG_ID.OL,TAG_ID.P,TAG_ID.PRE,TAG_ID.RUBY,TAG_ID.S,TAG_ID.SMALL,TAG_ID.SPAN,TAG_ID.STRONG,TAG_ID.STRIKE,TAG_ID.SUB,TAG_ID.SUP,TAG_ID.TABLE,TAG_ID.TT,TAG_ID.U,TAG_ID.UL,TAG_ID.VAR]);function causesExit(xt){const $t=xt.tagID;return $t===TAG_ID.FONT&&xt.attrs.some(({name:kt})=>kt===ATTRS.COLOR||kt===ATTRS.SIZE||kt===ATTRS.FACE)||EXITS_FOREIGN_CONTENT.has($t)}function adjustTokenMathMLAttrs(xt){for(let $t=0;$t<xt.attrs.length;$t++)if(xt.attrs[$t].name===DEFINITION_URL_ATTR){xt.attrs[$t].name=ADJUSTED_DEFINITION_URL_ATTR;break}}function adjustTokenSVGAttrs(xt){for(let $t=0;$t<xt.attrs.length;$t++){const Ct=SVG_ATTRS_ADJUSTMENT_MAP.get(xt.attrs[$t].name);Ct!=null&&(xt.attrs[$t].name=Ct)}}function adjustTokenXMLAttrs(xt){for(let $t=0;$t<xt.attrs.length;$t++){const Ct=XML_ATTRS_ADJUSTMENT_MAP.get(xt.attrs[$t].name);Ct&&(xt.attrs[$t].prefix=Ct.prefix,xt.attrs[$t].name=Ct.name,xt.attrs[$t].namespace=Ct.namespace)}}function adjustTokenSVGTagName(xt){const $t=SVG_TAG_NAMES_ADJUSTMENT_MAP.get(xt.tagName);$t!=null&&(xt.tagName=$t,xt.tagID=getTagID(xt.tagName))}function isMathMLTextIntegrationPoint(xt,$t){return $t===NS.MATHML&&(xt===TAG_ID.MI||xt===TAG_ID.MO||xt===TAG_ID.MN||xt===TAG_ID.MS||xt===TAG_ID.MTEXT)}function isHtmlIntegrationPoint(xt,$t,Ct){if($t===NS.MATHML&&xt===TAG_ID.ANNOTATION_XML){for(let kt=0;kt<Ct.length;kt++)if(Ct[kt].name===ATTRS.ENCODING){const Mt=Ct[kt].value.toLowerCase();return Mt===MIME_TYPES.TEXT_HTML||Mt===MIME_TYPES.APPLICATION_XML}}return $t===NS.SVG&&(xt===TAG_ID.FOREIGN_OBJECT||xt===TAG_ID.DESC||xt===TAG_ID.TITLE)}function isIntegrationPoint(xt,$t,Ct,kt){return(!kt||kt===NS.HTML)&&isHtmlIntegrationPoint(xt,$t,Ct)||(!kt||kt===NS.MATHML)&&isMathMLTextIntegrationPoint(xt,$t)}const HIDDEN_INPUT_TYPE="hidden",AA_OUTER_LOOP_ITER=8,AA_INNER_LOOP_ITER=3;var InsertionMode;(function(xt){xt[xt.INITIAL=0]="INITIAL",xt[xt.BEFORE_HTML=1]="BEFORE_HTML",xt[xt.BEFORE_HEAD=2]="BEFORE_HEAD",xt[xt.IN_HEAD=3]="IN_HEAD",xt[xt.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",xt[xt.AFTER_HEAD=5]="AFTER_HEAD",xt[xt.IN_BODY=6]="IN_BODY",xt[xt.TEXT=7]="TEXT",xt[xt.IN_TABLE=8]="IN_TABLE",xt[xt.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",xt[xt.IN_CAPTION=10]="IN_CAPTION",xt[xt.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",xt[xt.IN_TABLE_BODY=12]="IN_TABLE_BODY",xt[xt.IN_ROW=13]="IN_ROW",xt[xt.IN_CELL=14]="IN_CELL",xt[xt.IN_SELECT=15]="IN_SELECT",xt[xt.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",xt[xt.IN_TEMPLATE=17]="IN_TEMPLATE",xt[xt.AFTER_BODY=18]="AFTER_BODY",xt[xt.IN_FRAMESET=19]="IN_FRAMESET",xt[xt.AFTER_FRAMESET=20]="AFTER_FRAMESET",xt[xt.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",xt[xt.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(InsertionMode||(InsertionMode={}));const BASE_LOC={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},TABLE_STRUCTURE_TAGS=new Set([TAG_ID.TABLE,TAG_ID.TBODY,TAG_ID.TFOOT,TAG_ID.THEAD,TAG_ID.TR]),defaultParserOptions={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:defaultTreeAdapter,onParseError:null};let Parser$1=class{constructor($t,Ct,kt=null,Mt=null){this.fragmentContext=kt,this.scriptHandler=Mt,this.currentToken=null,this.stopped=!1,this.insertionMode=InsertionMode.INITIAL,this.originalInsertionMode=InsertionMode.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...defaultParserOptions,...$t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=Ct??this.treeAdapter.createDocument(),this.tokenizer=new Tokenizer(this.options,this),this.activeFormattingElements=new FormattingElementList(this.treeAdapter),this.fragmentContextID=kt?getTagID(this.treeAdapter.getTagName(kt)):TAG_ID.UNKNOWN,this._setContextModes(kt??this.document,this.fragmentContextID),this.openElements=new OpenElementStack(this.document,this.treeAdapter,this)}static parse($t,Ct){const kt=new this(Ct);return kt.tokenizer.write($t,!0),kt.document}static getFragmentParser($t,Ct){const kt={...defaultParserOptions,...Ct};$t??($t=kt.treeAdapter.createElement(TAG_NAMES.TEMPLATE,NS.HTML,[]));const Mt=kt.treeAdapter.createElement("documentmock",NS.HTML,[]),Ft=new this(kt,Mt,$t);return Ft.fragmentContextID===TAG_ID.TEMPLATE&&Ft.tmplInsertionModeStack.unshift(InsertionMode.IN_TEMPLATE),Ft._initTokenizerForFragmentParsing(),Ft._insertFakeRootElement(),Ft._resetInsertionMode(),Ft._findFormInFragmentContext(),Ft}getFragment(){const $t=this.treeAdapter.getFirstChild(this.document),Ct=this.treeAdapter.createDocumentFragment();return this._adoptNodes($t,Ct),Ct}_err($t,Ct,kt){var Mt;if(!this.onParseError)return;const Ft=(Mt=$t.location)!==null&&Mt!==void 0?Mt:BASE_LOC,jt={code:Ct,startLine:Ft.startLine,startCol:Ft.startCol,startOffset:Ft.startOffset,endLine:kt?Ft.startLine:Ft.endLine,endCol:kt?Ft.startCol:Ft.endCol,endOffset:kt?Ft.startOffset:Ft.endOffset};this.onParseError(jt)}onItemPush($t,Ct,kt){var Mt,Ft;(Ft=(Mt=this.treeAdapter).onItemPush)===null||Ft===void 0||Ft.call(Mt,$t),kt&&this.openElements.stackTop>0&&this._setContextModes($t,Ct)}onItemPop($t,Ct){var kt,Mt;if(this.options.sourceCodeLocationInfo&&this._setEndLocation($t,this.currentToken),(Mt=(kt=this.treeAdapter).onItemPop)===null||Mt===void 0||Mt.call(kt,$t,this.openElements.current),Ct){let Ft,jt;this.openElements.stackTop===0&&this.fragmentContext?(Ft=this.fragmentContext,jt=this.fragmentContextID):{current:Ft,currentTagId:jt}=this.openElements,this._setContextModes(Ft,jt)}}_setContextModes($t,Ct){const kt=$t===this.document||this.treeAdapter.getNamespaceURI($t)===NS.HTML;this.currentNotInHTML=!kt,this.tokenizer.inForeignNode=!kt&&!this._isIntegrationPoint(Ct,$t)}_switchToTextParsing($t,Ct){this._insertElement($t,NS.HTML),this.tokenizer.state=Ct,this.originalInsertionMode=this.insertionMode,this.insertionMode=InsertionMode.TEXT}switchToPlaintextParsing(){this.insertionMode=InsertionMode.TEXT,this.originalInsertionMode=InsertionMode.IN_BODY,this.tokenizer.state=TokenizerMode.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let $t=this.fragmentContext;for(;$t;){if(this.treeAdapter.getTagName($t)===TAG_NAMES.FORM){this.formElement=$t;break}$t=this.treeAdapter.getParentNode($t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==NS.HTML))switch(this.fragmentContextID){case TAG_ID.TITLE:case TAG_ID.TEXTAREA:{this.tokenizer.state=TokenizerMode.RCDATA;break}case TAG_ID.STYLE:case TAG_ID.XMP:case TAG_ID.IFRAME:case TAG_ID.NOEMBED:case TAG_ID.NOFRAMES:case TAG_ID.NOSCRIPT:{this.tokenizer.state=TokenizerMode.RAWTEXT;break}case TAG_ID.SCRIPT:{this.tokenizer.state=TokenizerMode.SCRIPT_DATA;break}case TAG_ID.PLAINTEXT:{this.tokenizer.state=TokenizerMode.PLAINTEXT;break}}}_setDocumentType($t){const Ct=$t.name||"",kt=$t.publicId||"",Mt=$t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,Ct,kt,Mt),$t.location){const jt=this.treeAdapter.getChildNodes(this.document).find(Bt=>this.treeAdapter.isDocumentTypeNode(Bt));jt&&this.treeAdapter.setNodeSourceCodeLocation(jt,$t.location)}}_attachElementToTree($t,Ct){if(this.options.sourceCodeLocationInfo){const kt=Ct&&{...Ct,startTag:Ct};this.treeAdapter.setNodeSourceCodeLocation($t,kt)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement($t);else{const kt=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(kt,$t)}}_appendElement($t,Ct){const kt=this.treeAdapter.createElement($t.tagName,Ct,$t.attrs);this._attachElementToTree(kt,$t.location)}_insertElement($t,Ct){const kt=this.treeAdapter.createElement($t.tagName,Ct,$t.attrs);this._attachElementToTree(kt,$t.location),this.openElements.push(kt,$t.tagID)}_insertFakeElement($t,Ct){const kt=this.treeAdapter.createElement($t,NS.HTML,[]);this._attachElementToTree(kt,null),this.openElements.push(kt,Ct)}_insertTemplate($t){const Ct=this.treeAdapter.createElement($t.tagName,NS.HTML,$t.attrs),kt=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(Ct,kt),this._attachElementToTree(Ct,$t.location),this.openElements.push(Ct,$t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(kt,null)}_insertFakeRootElement(){const $t=this.treeAdapter.createElement(TAG_NAMES.HTML,NS.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation($t,null),this.treeAdapter.appendChild(this.openElements.current,$t),this.openElements.push($t,TAG_ID.HTML)}_appendCommentNode($t,Ct){const kt=this.treeAdapter.createCommentNode($t.data);this.treeAdapter.appendChild(Ct,kt),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(kt,$t.location)}_insertCharacters($t){let Ct,kt;if(this._shouldFosterParentOnInsertion()?({parent:Ct,beforeElement:kt}=this._findFosterParentingLocation(),kt?this.treeAdapter.insertTextBefore(Ct,$t.chars,kt):this.treeAdapter.insertText(Ct,$t.chars)):(Ct=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(Ct,$t.chars)),!$t.location)return;const Mt=this.treeAdapter.getChildNodes(Ct),Ft=kt?Mt.lastIndexOf(kt):Mt.length,jt=Mt[Ft-1];if(this.treeAdapter.getNodeSourceCodeLocation(jt)){const{endLine:Vt,endCol:zt,endOffset:Ht}=$t.location;this.treeAdapter.updateNodeSourceCodeLocation(jt,{endLine:Vt,endCol:zt,endOffset:Ht})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(jt,$t.location)}_adoptNodes($t,Ct){for(let kt=this.treeAdapter.getFirstChild($t);kt;kt=this.treeAdapter.getFirstChild($t))this.treeAdapter.detachNode(kt),this.treeAdapter.appendChild(Ct,kt)}_setEndLocation($t,Ct){if(this.treeAdapter.getNodeSourceCodeLocation($t)&&Ct.location){const kt=Ct.location,Mt=this.treeAdapter.getTagName($t),Ft=Ct.type===TokenType$1.END_TAG&&Mt===Ct.tagName?{endTag:{...kt},endLine:kt.endLine,endCol:kt.endCol,endOffset:kt.endOffset}:{endLine:kt.startLine,endCol:kt.startCol,endOffset:kt.startOffset};this.treeAdapter.updateNodeSourceCodeLocation($t,Ft)}}shouldProcessStartTagTokenInForeignContent($t){if(!this.currentNotInHTML)return!1;let Ct,kt;return this.openElements.stackTop===0&&this.fragmentContext?(Ct=this.fragmentContext,kt=this.fragmentContextID):{current:Ct,currentTagId:kt}=this.openElements,$t.tagID===TAG_ID.SVG&&this.treeAdapter.getTagName(Ct)===TAG_NAMES.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(Ct)===NS.MATHML?!1:this.tokenizer.inForeignNode||($t.tagID===TAG_ID.MGLYPH||$t.tagID===TAG_ID.MALIGNMARK)&&!this._isIntegrationPoint(kt,Ct,NS.HTML)}_processToken($t){switch($t.type){case TokenType$1.CHARACTER:{this.onCharacter($t);break}case TokenType$1.NULL_CHARACTER:{this.onNullCharacter($t);break}case TokenType$1.COMMENT:{this.onComment($t);break}case TokenType$1.DOCTYPE:{this.onDoctype($t);break}case TokenType$1.START_TAG:{this._processStartTag($t);break}case TokenType$1.END_TAG:{this.onEndTag($t);break}case TokenType$1.EOF:{this.onEof($t);break}case TokenType$1.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter($t);break}}}_isIntegrationPoint($t,Ct,kt){const Mt=this.treeAdapter.getNamespaceURI(Ct),Ft=this.treeAdapter.getAttrList(Ct);return isIntegrationPoint($t,Mt,Ft,kt)}_reconstructActiveFormattingElements(){const $t=this.activeFormattingElements.entries.length;if($t){const Ct=this.activeFormattingElements.entries.findIndex(Mt=>Mt.type===EntryType.Marker||this.openElements.contains(Mt.element)),kt=Ct<0?$t-1:Ct-1;for(let Mt=kt;Mt>=0;Mt--){const Ft=this.activeFormattingElements.entries[Mt];this._insertElement(Ft.token,this.treeAdapter.getNamespaceURI(Ft.element)),Ft.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=InsertionMode.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(TAG_ID.P),this.openElements.popUntilTagNamePopped(TAG_ID.P)}_resetInsertionMode(){for(let $t=this.openElements.stackTop;$t>=0;$t--)switch($t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[$t]){case TAG_ID.TR:{this.insertionMode=InsertionMode.IN_ROW;return}case TAG_ID.TBODY:case TAG_ID.THEAD:case TAG_ID.TFOOT:{this.insertionMode=InsertionMode.IN_TABLE_BODY;return}case TAG_ID.CAPTION:{this.insertionMode=InsertionMode.IN_CAPTION;return}case TAG_ID.COLGROUP:{this.insertionMode=InsertionMode.IN_COLUMN_GROUP;return}case TAG_ID.TABLE:{this.insertionMode=InsertionMode.IN_TABLE;return}case TAG_ID.BODY:{this.insertionMode=InsertionMode.IN_BODY;return}case TAG_ID.FRAMESET:{this.insertionMode=InsertionMode.IN_FRAMESET;return}case TAG_ID.SELECT:{this._resetInsertionModeForSelect($t);return}case TAG_ID.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case TAG_ID.HTML:{this.insertionMode=this.headElement?InsertionMode.AFTER_HEAD:InsertionMode.BEFORE_HEAD;return}case TAG_ID.TD:case TAG_ID.TH:{if($t>0){this.insertionMode=InsertionMode.IN_CELL;return}break}case TAG_ID.HEAD:{if($t>0){this.insertionMode=InsertionMode.IN_HEAD;return}break}}this.insertionMode=InsertionMode.IN_BODY}_resetInsertionModeForSelect($t){if($t>0)for(let Ct=$t-1;Ct>0;Ct--){const kt=this.openElements.tagIDs[Ct];if(kt===TAG_ID.TEMPLATE)break;if(kt===TAG_ID.TABLE){this.insertionMode=InsertionMode.IN_SELECT_IN_TABLE;return}}this.insertionMode=InsertionMode.IN_SELECT}_isElementCausesFosterParenting($t){return TABLE_STRUCTURE_TAGS.has($t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let $t=this.openElements.stackTop;$t>=0;$t--){const Ct=this.openElements.items[$t];switch(this.openElements.tagIDs[$t]){case TAG_ID.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(Ct)===NS.HTML)return{parent:this.treeAdapter.getTemplateContent(Ct),beforeElement:null};break}case TAG_ID.TABLE:{const kt=this.treeAdapter.getParentNode(Ct);return kt?{parent:kt,beforeElement:Ct}:{parent:this.openElements.items[$t-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement($t){const Ct=this._findFosterParentingLocation();Ct.beforeElement?this.treeAdapter.insertBefore(Ct.parent,$t,Ct.beforeElement):this.treeAdapter.appendChild(Ct.parent,$t)}_isSpecialElement($t,Ct){const kt=this.treeAdapter.getNamespaceURI($t);return SPECIAL_ELEMENTS[kt].has(Ct)}onCharacter($t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){characterInForeignContent(this,$t);return}switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,$t);break}case InsertionMode.BEFORE_HTML:{tokenBeforeHtml(this,$t);break}case InsertionMode.BEFORE_HEAD:{tokenBeforeHead(this,$t);break}case InsertionMode.IN_HEAD:{tokenInHead(this,$t);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{tokenInHeadNoScript(this,$t);break}case InsertionMode.AFTER_HEAD:{tokenAfterHead(this,$t);break}case InsertionMode.IN_BODY:case InsertionMode.IN_CAPTION:case InsertionMode.IN_CELL:case InsertionMode.IN_TEMPLATE:{characterInBody(this,$t);break}case InsertionMode.TEXT:case InsertionMode.IN_SELECT:case InsertionMode.IN_SELECT_IN_TABLE:{this._insertCharacters($t);break}case InsertionMode.IN_TABLE:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:{characterInTable(this,$t);break}case InsertionMode.IN_TABLE_TEXT:{characterInTableText(this,$t);break}case InsertionMode.IN_COLUMN_GROUP:{tokenInColumnGroup(this,$t);break}case InsertionMode.AFTER_BODY:{tokenAfterBody(this,$t);break}case InsertionMode.AFTER_AFTER_BODY:{tokenAfterAfterBody(this,$t);break}}}onNullCharacter($t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){nullCharacterInForeignContent(this,$t);return}switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,$t);break}case InsertionMode.BEFORE_HTML:{tokenBeforeHtml(this,$t);break}case InsertionMode.BEFORE_HEAD:{tokenBeforeHead(this,$t);break}case InsertionMode.IN_HEAD:{tokenInHead(this,$t);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{tokenInHeadNoScript(this,$t);break}case InsertionMode.AFTER_HEAD:{tokenAfterHead(this,$t);break}case InsertionMode.TEXT:{this._insertCharacters($t);break}case InsertionMode.IN_TABLE:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:{characterInTable(this,$t);break}case InsertionMode.IN_COLUMN_GROUP:{tokenInColumnGroup(this,$t);break}case InsertionMode.AFTER_BODY:{tokenAfterBody(this,$t);break}case InsertionMode.AFTER_AFTER_BODY:{tokenAfterAfterBody(this,$t);break}}}onComment($t){if(this.skipNextNewLine=!1,this.currentNotInHTML){appendComment(this,$t);return}switch(this.insertionMode){case InsertionMode.INITIAL:case InsertionMode.BEFORE_HTML:case InsertionMode.BEFORE_HEAD:case InsertionMode.IN_HEAD:case InsertionMode.IN_HEAD_NO_SCRIPT:case InsertionMode.AFTER_HEAD:case InsertionMode.IN_BODY:case InsertionMode.IN_TABLE:case InsertionMode.IN_CAPTION:case InsertionMode.IN_COLUMN_GROUP:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:case InsertionMode.IN_CELL:case InsertionMode.IN_SELECT:case InsertionMode.IN_SELECT_IN_TABLE:case InsertionMode.IN_TEMPLATE:case InsertionMode.IN_FRAMESET:case InsertionMode.AFTER_FRAMESET:{appendComment(this,$t);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,$t);break}case InsertionMode.AFTER_BODY:{appendCommentToRootHtmlElement(this,$t);break}case InsertionMode.AFTER_AFTER_BODY:case InsertionMode.AFTER_AFTER_FRAMESET:{appendCommentToDocument(this,$t);break}}}onDoctype($t){switch(this.skipNextNewLine=!1,this.insertionMode){case InsertionMode.INITIAL:{doctypeInInitialMode(this,$t);break}case InsertionMode.BEFORE_HEAD:case InsertionMode.IN_HEAD:case InsertionMode.IN_HEAD_NO_SCRIPT:case InsertionMode.AFTER_HEAD:{this._err($t,ERR.misplacedDoctype);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,$t);break}}}onStartTag($t){this.skipNextNewLine=!1,this.currentToken=$t,this._processStartTag($t),$t.selfClosing&&!$t.ackSelfClosing&&this._err($t,ERR.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag($t){this.shouldProcessStartTagTokenInForeignContent($t)?startTagInForeignContent(this,$t):this._startTagOutsideForeignContent($t)}_startTagOutsideForeignContent($t){switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,$t);break}case InsertionMode.BEFORE_HTML:{startTagBeforeHtml(this,$t);break}case InsertionMode.BEFORE_HEAD:{startTagBeforeHead(this,$t);break}case InsertionMode.IN_HEAD:{startTagInHead(this,$t);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{startTagInHeadNoScript(this,$t);break}case InsertionMode.AFTER_HEAD:{startTagAfterHead(this,$t);break}case InsertionMode.IN_BODY:{startTagInBody(this,$t);break}case InsertionMode.IN_TABLE:{startTagInTable(this,$t);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,$t);break}case InsertionMode.IN_CAPTION:{startTagInCaption(this,$t);break}case InsertionMode.IN_COLUMN_GROUP:{startTagInColumnGroup(this,$t);break}case InsertionMode.IN_TABLE_BODY:{startTagInTableBody(this,$t);break}case InsertionMode.IN_ROW:{startTagInRow(this,$t);break}case InsertionMode.IN_CELL:{startTagInCell(this,$t);break}case InsertionMode.IN_SELECT:{startTagInSelect(this,$t);break}case InsertionMode.IN_SELECT_IN_TABLE:{startTagInSelectInTable(this,$t);break}case InsertionMode.IN_TEMPLATE:{startTagInTemplate(this,$t);break}case InsertionMode.AFTER_BODY:{startTagAfterBody(this,$t);break}case InsertionMode.IN_FRAMESET:{startTagInFrameset(this,$t);break}case InsertionMode.AFTER_FRAMESET:{startTagAfterFrameset(this,$t);break}case InsertionMode.AFTER_AFTER_BODY:{startTagAfterAfterBody(this,$t);break}case InsertionMode.AFTER_AFTER_FRAMESET:{startTagAfterAfterFrameset(this,$t);break}}}onEndTag($t){this.skipNextNewLine=!1,this.currentToken=$t,this.currentNotInHTML?endTagInForeignContent(this,$t):this._endTagOutsideForeignContent($t)}_endTagOutsideForeignContent($t){switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,$t);break}case InsertionMode.BEFORE_HTML:{endTagBeforeHtml(this,$t);break}case InsertionMode.BEFORE_HEAD:{endTagBeforeHead(this,$t);break}case InsertionMode.IN_HEAD:{endTagInHead(this,$t);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{endTagInHeadNoScript(this,$t);break}case InsertionMode.AFTER_HEAD:{endTagAfterHead(this,$t);break}case InsertionMode.IN_BODY:{endTagInBody(this,$t);break}case InsertionMode.TEXT:{endTagInText(this,$t);break}case InsertionMode.IN_TABLE:{endTagInTable(this,$t);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,$t);break}case InsertionMode.IN_CAPTION:{endTagInCaption(this,$t);break}case InsertionMode.IN_COLUMN_GROUP:{endTagInColumnGroup(this,$t);break}case InsertionMode.IN_TABLE_BODY:{endTagInTableBody(this,$t);break}case InsertionMode.IN_ROW:{endTagInRow(this,$t);break}case InsertionMode.IN_CELL:{endTagInCell(this,$t);break}case InsertionMode.IN_SELECT:{endTagInSelect(this,$t);break}case InsertionMode.IN_SELECT_IN_TABLE:{endTagInSelectInTable(this,$t);break}case InsertionMode.IN_TEMPLATE:{endTagInTemplate(this,$t);break}case InsertionMode.AFTER_BODY:{endTagAfterBody(this,$t);break}case InsertionMode.IN_FRAMESET:{endTagInFrameset(this,$t);break}case InsertionMode.AFTER_FRAMESET:{endTagAfterFrameset(this,$t);break}case InsertionMode.AFTER_AFTER_BODY:{tokenAfterAfterBody(this,$t);break}}}onEof($t){switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,$t);break}case InsertionMode.BEFORE_HTML:{tokenBeforeHtml(this,$t);break}case InsertionMode.BEFORE_HEAD:{tokenBeforeHead(this,$t);break}case InsertionMode.IN_HEAD:{tokenInHead(this,$t);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{tokenInHeadNoScript(this,$t);break}case InsertionMode.AFTER_HEAD:{tokenAfterHead(this,$t);break}case InsertionMode.IN_BODY:case InsertionMode.IN_TABLE:case InsertionMode.IN_CAPTION:case InsertionMode.IN_COLUMN_GROUP:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:case InsertionMode.IN_CELL:case InsertionMode.IN_SELECT:case InsertionMode.IN_SELECT_IN_TABLE:{eofInBody(this,$t);break}case InsertionMode.TEXT:{eofInText(this,$t);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,$t);break}case InsertionMode.IN_TEMPLATE:{eofInTemplate(this,$t);break}case InsertionMode.AFTER_BODY:case InsertionMode.IN_FRAMESET:case InsertionMode.AFTER_FRAMESET:case InsertionMode.AFTER_AFTER_BODY:case InsertionMode.AFTER_AFTER_FRAMESET:{stopParsing(this,$t);break}}}onWhitespaceCharacter($t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,$t.chars.charCodeAt(0)===CODE_POINTS.LINE_FEED)){if($t.chars.length===1)return;$t.chars=$t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters($t);return}switch(this.insertionMode){case InsertionMode.IN_HEAD:case InsertionMode.IN_HEAD_NO_SCRIPT:case InsertionMode.AFTER_HEAD:case InsertionMode.TEXT:case InsertionMode.IN_COLUMN_GROUP:case InsertionMode.IN_SELECT:case InsertionMode.IN_SELECT_IN_TABLE:case InsertionMode.IN_FRAMESET:case InsertionMode.AFTER_FRAMESET:{this._insertCharacters($t);break}case InsertionMode.IN_BODY:case InsertionMode.IN_CAPTION:case InsertionMode.IN_CELL:case InsertionMode.IN_TEMPLATE:case InsertionMode.AFTER_BODY:case InsertionMode.AFTER_AFTER_BODY:case InsertionMode.AFTER_AFTER_FRAMESET:{whitespaceCharacterInBody(this,$t);break}case InsertionMode.IN_TABLE:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:{characterInTable(this,$t);break}case InsertionMode.IN_TABLE_TEXT:{whitespaceCharacterInTableText(this,$t);break}}}};function aaObtainFormattingElementEntry(xt,$t){let Ct=xt.activeFormattingElements.getElementEntryInScopeWithTagName($t.tagName);return Ct?xt.openElements.contains(Ct.element)?xt.openElements.hasInScope($t.tagID)||(Ct=null):(xt.activeFormattingElements.removeEntry(Ct),Ct=null):genericEndTagInBody(xt,$t),Ct}function aaObtainFurthestBlock(xt,$t){let Ct=null,kt=xt.openElements.stackTop;for(;kt>=0;kt--){const Mt=xt.openElements.items[kt];if(Mt===$t.element)break;xt._isSpecialElement(Mt,xt.openElements.tagIDs[kt])&&(Ct=Mt)}return Ct||(xt.openElements.shortenToLength(kt<0?0:kt),xt.activeFormattingElements.removeEntry($t)),Ct}function aaInnerLoop(xt,$t,Ct){let kt=$t,Mt=xt.openElements.getCommonAncestor($t);for(let Ft=0,jt=Mt;jt!==Ct;Ft++,jt=Mt){Mt=xt.openElements.getCommonAncestor(jt);const Bt=xt.activeFormattingElements.getElementEntry(jt),Vt=Bt&&Ft>=AA_INNER_LOOP_ITER;!Bt||Vt?(Vt&&xt.activeFormattingElements.removeEntry(Bt),xt.openElements.remove(jt)):(jt=aaRecreateElementFromEntry(xt,Bt),kt===$t&&(xt.activeFormattingElements.bookmark=Bt),xt.treeAdapter.detachNode(kt),xt.treeAdapter.appendChild(jt,kt),kt=jt)}return kt}function aaRecreateElementFromEntry(xt,$t){const Ct=xt.treeAdapter.getNamespaceURI($t.element),kt=xt.treeAdapter.createElement($t.token.tagName,Ct,$t.token.attrs);return xt.openElements.replace($t.element,kt),$t.element=kt,kt}function aaInsertLastNodeInCommonAncestor(xt,$t,Ct){const kt=xt.treeAdapter.getTagName($t),Mt=getTagID(kt);if(xt._isElementCausesFosterParenting(Mt))xt._fosterParentElement(Ct);else{const Ft=xt.treeAdapter.getNamespaceURI($t);Mt===TAG_ID.TEMPLATE&&Ft===NS.HTML&&($t=xt.treeAdapter.getTemplateContent($t)),xt.treeAdapter.appendChild($t,Ct)}}function aaReplaceFormattingElement(xt,$t,Ct){const kt=xt.treeAdapter.getNamespaceURI(Ct.element),{token:Mt}=Ct,Ft=xt.treeAdapter.createElement(Mt.tagName,kt,Mt.attrs);xt._adoptNodes($t,Ft),xt.treeAdapter.appendChild($t,Ft),xt.activeFormattingElements.insertElementAfterBookmark(Ft,Mt),xt.activeFormattingElements.removeEntry(Ct),xt.openElements.remove(Ct.element),xt.openElements.insertAfter($t,Ft,Mt.tagID)}function callAdoptionAgency(xt,$t){for(let Ct=0;Ct<AA_OUTER_LOOP_ITER;Ct++){const kt=aaObtainFormattingElementEntry(xt,$t);if(!kt)break;const Mt=aaObtainFurthestBlock(xt,kt);if(!Mt)break;xt.activeFormattingElements.bookmark=kt;const Ft=aaInnerLoop(xt,Mt,kt.element),jt=xt.openElements.getCommonAncestor(kt.element);xt.treeAdapter.detachNode(Ft),jt&&aaInsertLastNodeInCommonAncestor(xt,jt,Ft),aaReplaceFormattingElement(xt,Mt,kt)}}function appendComment(xt,$t){xt._appendCommentNode($t,xt.openElements.currentTmplContentOrNode)}function appendCommentToRootHtmlElement(xt,$t){xt._appendCommentNode($t,xt.openElements.items[0])}function appendCommentToDocument(xt,$t){xt._appendCommentNode($t,xt.document)}function stopParsing(xt,$t){if(xt.stopped=!0,$t.location){const Ct=xt.fragmentContext?0:2;for(let kt=xt.openElements.stackTop;kt>=Ct;kt--)xt._setEndLocation(xt.openElements.items[kt],$t);if(!xt.fragmentContext&&xt.openElements.stackTop>=0){const kt=xt.openElements.items[0],Mt=xt.treeAdapter.getNodeSourceCodeLocation(kt);if(Mt&&!Mt.endTag&&(xt._setEndLocation(kt,$t),xt.openElements.stackTop>=1)){const Ft=xt.openElements.items[1],jt=xt.treeAdapter.getNodeSourceCodeLocation(Ft);jt&&!jt.endTag&&xt._setEndLocation(Ft,$t)}}}}function doctypeInInitialMode(xt,$t){xt._setDocumentType($t);const Ct=$t.forceQuirks?DOCUMENT_MODE.QUIRKS:getDocumentMode($t);isConforming($t)||xt._err($t,ERR.nonConformingDoctype),xt.treeAdapter.setDocumentMode(xt.document,Ct),xt.insertionMode=InsertionMode.BEFORE_HTML}function tokenInInitialMode(xt,$t){xt._err($t,ERR.missingDoctype,!0),xt.treeAdapter.setDocumentMode(xt.document,DOCUMENT_MODE.QUIRKS),xt.insertionMode=InsertionMode.BEFORE_HTML,xt._processToken($t)}function startTagBeforeHtml(xt,$t){$t.tagID===TAG_ID.HTML?(xt._insertElement($t,NS.HTML),xt.insertionMode=InsertionMode.BEFORE_HEAD):tokenBeforeHtml(xt,$t)}function endTagBeforeHtml(xt,$t){const Ct=$t.tagID;(Ct===TAG_ID.HTML||Ct===TAG_ID.HEAD||Ct===TAG_ID.BODY||Ct===TAG_ID.BR)&&tokenBeforeHtml(xt,$t)}function tokenBeforeHtml(xt,$t){xt._insertFakeRootElement(),xt.insertionMode=InsertionMode.BEFORE_HEAD,xt._processToken($t)}function startTagBeforeHead(xt,$t){switch($t.tagID){case TAG_ID.HTML:{startTagInBody(xt,$t);break}case TAG_ID.HEAD:{xt._insertElement($t,NS.HTML),xt.headElement=xt.openElements.current,xt.insertionMode=InsertionMode.IN_HEAD;break}default:tokenBeforeHead(xt,$t)}}function endTagBeforeHead(xt,$t){const Ct=$t.tagID;Ct===TAG_ID.HEAD||Ct===TAG_ID.BODY||Ct===TAG_ID.HTML||Ct===TAG_ID.BR?tokenBeforeHead(xt,$t):xt._err($t,ERR.endTagWithoutMatchingOpenElement)}function tokenBeforeHead(xt,$t){xt._insertFakeElement(TAG_NAMES.HEAD,TAG_ID.HEAD),xt.headElement=xt.openElements.current,xt.insertionMode=InsertionMode.IN_HEAD,xt._processToken($t)}function startTagInHead(xt,$t){switch($t.tagID){case TAG_ID.HTML:{startTagInBody(xt,$t);break}case TAG_ID.BASE:case TAG_ID.BASEFONT:case TAG_ID.BGSOUND:case TAG_ID.LINK:case TAG_ID.META:{xt._appendElement($t,NS.HTML),$t.ackSelfClosing=!0;break}case TAG_ID.TITLE:{xt._switchToTextParsing($t,TokenizerMode.RCDATA);break}case TAG_ID.NOSCRIPT:{xt.options.scriptingEnabled?xt._switchToTextParsing($t,TokenizerMode.RAWTEXT):(xt._insertElement($t,NS.HTML),xt.insertionMode=InsertionMode.IN_HEAD_NO_SCRIPT);break}case TAG_ID.NOFRAMES:case TAG_ID.STYLE:{xt._switchToTextParsing($t,TokenizerMode.RAWTEXT);break}case TAG_ID.SCRIPT:{xt._switchToTextParsing($t,TokenizerMode.SCRIPT_DATA);break}case TAG_ID.TEMPLATE:{xt._insertTemplate($t),xt.activeFormattingElements.insertMarker(),xt.framesetOk=!1,xt.insertionMode=InsertionMode.IN_TEMPLATE,xt.tmplInsertionModeStack.unshift(InsertionMode.IN_TEMPLATE);break}case TAG_ID.HEAD:{xt._err($t,ERR.misplacedStartTagForHeadElement);break}default:tokenInHead(xt,$t)}}function endTagInHead(xt,$t){switch($t.tagID){case TAG_ID.HEAD:{xt.openElements.pop(),xt.insertionMode=InsertionMode.AFTER_HEAD;break}case TAG_ID.BODY:case TAG_ID.BR:case TAG_ID.HTML:{tokenInHead(xt,$t);break}case TAG_ID.TEMPLATE:{templateEndTagInHead(xt,$t);break}default:xt._err($t,ERR.endTagWithoutMatchingOpenElement)}}function templateEndTagInHead(xt,$t){xt.openElements.tmplCount>0?(xt.openElements.generateImpliedEndTagsThoroughly(),xt.openElements.currentTagId!==TAG_ID.TEMPLATE&&xt._err($t,ERR.closingOfElementWithOpenChildElements),xt.openElements.popUntilTagNamePopped(TAG_ID.TEMPLATE),xt.activeFormattingElements.clearToLastMarker(),xt.tmplInsertionModeStack.shift(),xt._resetInsertionMode()):xt._err($t,ERR.endTagWithoutMatchingOpenElement)}function tokenInHead(xt,$t){xt.openElements.pop(),xt.insertionMode=InsertionMode.AFTER_HEAD,xt._processToken($t)}function startTagInHeadNoScript(xt,$t){switch($t.tagID){case TAG_ID.HTML:{startTagInBody(xt,$t);break}case TAG_ID.BASEFONT:case TAG_ID.BGSOUND:case TAG_ID.HEAD:case TAG_ID.LINK:case TAG_ID.META:case TAG_ID.NOFRAMES:case TAG_ID.STYLE:{startTagInHead(xt,$t);break}case TAG_ID.NOSCRIPT:{xt._err($t,ERR.nestedNoscriptInHead);break}default:tokenInHeadNoScript(xt,$t)}}function endTagInHeadNoScript(xt,$t){switch($t.tagID){case TAG_ID.NOSCRIPT:{xt.openElements.pop(),xt.insertionMode=InsertionMode.IN_HEAD;break}case TAG_ID.BR:{tokenInHeadNoScript(xt,$t);break}default:xt._err($t,ERR.endTagWithoutMatchingOpenElement)}}function tokenInHeadNoScript(xt,$t){const Ct=$t.type===TokenType$1.EOF?ERR.openElementsLeftAfterEof:ERR.disallowedContentInNoscriptInHead;xt._err($t,Ct),xt.openElements.pop(),xt.insertionMode=InsertionMode.IN_HEAD,xt._processToken($t)}function startTagAfterHead(xt,$t){switch($t.tagID){case TAG_ID.HTML:{startTagInBody(xt,$t);break}case TAG_ID.BODY:{xt._insertElement($t,NS.HTML),xt.framesetOk=!1,xt.insertionMode=InsertionMode.IN_BODY;break}case TAG_ID.FRAMESET:{xt._insertElement($t,NS.HTML),xt.insertionMode=InsertionMode.IN_FRAMESET;break}case TAG_ID.BASE:case TAG_ID.BASEFONT:case TAG_ID.BGSOUND:case TAG_ID.LINK:case TAG_ID.META:case TAG_ID.NOFRAMES:case TAG_ID.SCRIPT:case TAG_ID.STYLE:case TAG_ID.TEMPLATE:case TAG_ID.TITLE:{xt._err($t,ERR.abandonedHeadElementChild),xt.openElements.push(xt.headElement,TAG_ID.HEAD),startTagInHead(xt,$t),xt.openElements.remove(xt.headElement);break}case TAG_ID.HEAD:{xt._err($t,ERR.misplacedStartTagForHeadElement);break}default:tokenAfterHead(xt,$t)}}function endTagAfterHead(xt,$t){switch($t.tagID){case TAG_ID.BODY:case TAG_ID.HTML:case TAG_ID.BR:{tokenAfterHead(xt,$t);break}case TAG_ID.TEMPLATE:{templateEndTagInHead(xt,$t);break}default:xt._err($t,ERR.endTagWithoutMatchingOpenElement)}}function tokenAfterHead(xt,$t){xt._insertFakeElement(TAG_NAMES.BODY,TAG_ID.BODY),xt.insertionMode=InsertionMode.IN_BODY,modeInBody(xt,$t)}function modeInBody(xt,$t){switch($t.type){case TokenType$1.CHARACTER:{characterInBody(xt,$t);break}case TokenType$1.WHITESPACE_CHARACTER:{whitespaceCharacterInBody(xt,$t);break}case TokenType$1.COMMENT:{appendComment(xt,$t);break}case TokenType$1.START_TAG:{startTagInBody(xt,$t);break}case TokenType$1.END_TAG:{endTagInBody(xt,$t);break}case TokenType$1.EOF:{eofInBody(xt,$t);break}}}function whitespaceCharacterInBody(xt,$t){xt._reconstructActiveFormattingElements(),xt._insertCharacters($t)}function characterInBody(xt,$t){xt._reconstructActiveFormattingElements(),xt._insertCharacters($t),xt.framesetOk=!1}function htmlStartTagInBody(xt,$t){xt.openElements.tmplCount===0&&xt.treeAdapter.adoptAttributes(xt.openElements.items[0],$t.attrs)}function bodyStartTagInBody(xt,$t){const Ct=xt.openElements.tryPeekProperlyNestedBodyElement();Ct&&xt.openElements.tmplCount===0&&(xt.framesetOk=!1,xt.treeAdapter.adoptAttributes(Ct,$t.attrs))}function framesetStartTagInBody(xt,$t){const Ct=xt.openElements.tryPeekProperlyNestedBodyElement();xt.framesetOk&&Ct&&(xt.treeAdapter.detachNode(Ct),xt.openElements.popAllUpToHtmlElement(),xt._insertElement($t,NS.HTML),xt.insertionMode=InsertionMode.IN_FRAMESET)}function addressStartTagInBody(xt,$t){xt.openElements.hasInButtonScope(TAG_ID.P)&&xt._closePElement(),xt._insertElement($t,NS.HTML)}function numberedHeaderStartTagInBody(xt,$t){xt.openElements.hasInButtonScope(TAG_ID.P)&&xt._closePElement(),isNumberedHeader(xt.openElements.currentTagId)&&xt.openElements.pop(),xt._insertElement($t,NS.HTML)}function preStartTagInBody(xt,$t){xt.openElements.hasInButtonScope(TAG_ID.P)&&xt._closePElement(),xt._insertElement($t,NS.HTML),xt.skipNextNewLine=!0,xt.framesetOk=!1}function formStartTagInBody(xt,$t){const Ct=xt.openElements.tmplCount>0;(!xt.formElement||Ct)&&(xt.openElements.hasInButtonScope(TAG_ID.P)&&xt._closePElement(),xt._insertElement($t,NS.HTML),Ct||(xt.formElement=xt.openElements.current))}function listItemStartTagInBody(xt,$t){xt.framesetOk=!1;const Ct=$t.tagID;for(let kt=xt.openElements.stackTop;kt>=0;kt--){const Mt=xt.openElements.tagIDs[kt];if(Ct===TAG_ID.LI&&Mt===TAG_ID.LI||(Ct===TAG_ID.DD||Ct===TAG_ID.DT)&&(Mt===TAG_ID.DD||Mt===TAG_ID.DT)){xt.openElements.generateImpliedEndTagsWithExclusion(Mt),xt.openElements.popUntilTagNamePopped(Mt);break}if(Mt!==TAG_ID.ADDRESS&&Mt!==TAG_ID.DIV&&Mt!==TAG_ID.P&&xt._isSpecialElement(xt.openElements.items[kt],Mt))break}xt.openElements.hasInButtonScope(TAG_ID.P)&&xt._closePElement(),xt._insertElement($t,NS.HTML)}function plaintextStartTagInBody(xt,$t){xt.openElements.hasInButtonScope(TAG_ID.P)&&xt._closePElement(),xt._insertElement($t,NS.HTML),xt.tokenizer.state=TokenizerMode.PLAINTEXT}function buttonStartTagInBody(xt,$t){xt.openElements.hasInScope(TAG_ID.BUTTON)&&(xt.openElements.generateImpliedEndTags(),xt.openElements.popUntilTagNamePopped(TAG_ID.BUTTON)),xt._reconstructActiveFormattingElements(),xt._insertElement($t,NS.HTML),xt.framesetOk=!1}function aStartTagInBody(xt,$t){const Ct=xt.activeFormattingElements.getElementEntryInScopeWithTagName(TAG_NAMES.A);Ct&&(callAdoptionAgency(xt,$t),xt.openElements.remove(Ct.element),xt.activeFormattingElements.removeEntry(Ct)),xt._reconstructActiveFormattingElements(),xt._insertElement($t,NS.HTML),xt.activeFormattingElements.pushElement(xt.openElements.current,$t)}function bStartTagInBody(xt,$t){xt._reconstructActiveFormattingElements(),xt._insertElement($t,NS.HTML),xt.activeFormattingElements.pushElement(xt.openElements.current,$t)}function nobrStartTagInBody(xt,$t){xt._reconstructActiveFormattingElements(),xt.openElements.hasInScope(TAG_ID.NOBR)&&(callAdoptionAgency(xt,$t),xt._reconstructActiveFormattingElements()),xt._insertElement($t,NS.HTML),xt.activeFormattingElements.pushElement(xt.openElements.current,$t)}function appletStartTagInBody(xt,$t){xt._reconstructActiveFormattingElements(),xt._insertElement($t,NS.HTML),xt.activeFormattingElements.insertMarker(),xt.framesetOk=!1}function tableStartTagInBody(xt,$t){xt.treeAdapter.getDocumentMode(xt.document)!==DOCUMENT_MODE.QUIRKS&&xt.openElements.hasInButtonScope(TAG_ID.P)&&xt._closePElement(),xt._insertElement($t,NS.HTML),xt.framesetOk=!1,xt.insertionMode=InsertionMode.IN_TABLE}function areaStartTagInBody(xt,$t){xt._reconstructActiveFormattingElements(),xt._appendElement($t,NS.HTML),xt.framesetOk=!1,$t.ackSelfClosing=!0}function isHiddenInput(xt){const $t=getTokenAttr(xt,ATTRS.TYPE);return $t!=null&&$t.toLowerCase()===HIDDEN_INPUT_TYPE}function inputStartTagInBody(xt,$t){xt._reconstructActiveFormattingElements(),xt._appendElement($t,NS.HTML),isHiddenInput($t)||(xt.framesetOk=!1),$t.ackSelfClosing=!0}function paramStartTagInBody(xt,$t){xt._appendElement($t,NS.HTML),$t.ackSelfClosing=!0}function hrStartTagInBody(xt,$t){xt.openElements.hasInButtonScope(TAG_ID.P)&&xt._closePElement(),xt._appendElement($t,NS.HTML),xt.framesetOk=!1,$t.ackSelfClosing=!0}function imageStartTagInBody(xt,$t){$t.tagName=TAG_NAMES.IMG,$t.tagID=TAG_ID.IMG,areaStartTagInBody(xt,$t)}function textareaStartTagInBody(xt,$t){xt._insertElement($t,NS.HTML),xt.skipNextNewLine=!0,xt.tokenizer.state=TokenizerMode.RCDATA,xt.originalInsertionMode=xt.insertionMode,xt.framesetOk=!1,xt.insertionMode=InsertionMode.TEXT}function xmpStartTagInBody(xt,$t){xt.openElements.hasInButtonScope(TAG_ID.P)&&xt._closePElement(),xt._reconstructActiveFormattingElements(),xt.framesetOk=!1,xt._switchToTextParsing($t,TokenizerMode.RAWTEXT)}function iframeStartTagInBody(xt,$t){xt.framesetOk=!1,xt._switchToTextParsing($t,TokenizerMode.RAWTEXT)}function noembedStartTagInBody(xt,$t){xt._switchToTextParsing($t,TokenizerMode.RAWTEXT)}function selectStartTagInBody(xt,$t){xt._reconstructActiveFormattingElements(),xt._insertElement($t,NS.HTML),xt.framesetOk=!1,xt.insertionMode=xt.insertionMode===InsertionMode.IN_TABLE||xt.insertionMode===InsertionMode.IN_CAPTION||xt.insertionMode===InsertionMode.IN_TABLE_BODY||xt.insertionMode===InsertionMode.IN_ROW||xt.insertionMode===InsertionMode.IN_CELL?InsertionMode.IN_SELECT_IN_TABLE:InsertionMode.IN_SELECT}function optgroupStartTagInBody(xt,$t){xt.openElements.currentTagId===TAG_ID.OPTION&&xt.openElements.pop(),xt._reconstructActiveFormattingElements(),xt._insertElement($t,NS.HTML)}function rbStartTagInBody(xt,$t){xt.openElements.hasInScope(TAG_ID.RUBY)&&xt.openElements.generateImpliedEndTags(),xt._insertElement($t,NS.HTML)}function rtStartTagInBody(xt,$t){xt.openElements.hasInScope(TAG_ID.RUBY)&&xt.openElements.generateImpliedEndTagsWithExclusion(TAG_ID.RTC),xt._insertElement($t,NS.HTML)}function mathStartTagInBody(xt,$t){xt._reconstructActiveFormattingElements(),adjustTokenMathMLAttrs($t),adjustTokenXMLAttrs($t),$t.selfClosing?xt._appendElement($t,NS.MATHML):xt._insertElement($t,NS.MATHML),$t.ackSelfClosing=!0}function svgStartTagInBody(xt,$t){xt._reconstructActiveFormattingElements(),adjustTokenSVGAttrs($t),adjustTokenXMLAttrs($t),$t.selfClosing?xt._appendElement($t,NS.SVG):xt._insertElement($t,NS.SVG),$t.ackSelfClosing=!0}function genericStartTagInBody(xt,$t){xt._reconstructActiveFormattingElements(),xt._insertElement($t,NS.HTML)}function startTagInBody(xt,$t){switch($t.tagID){case TAG_ID.I:case TAG_ID.S:case TAG_ID.B:case TAG_ID.U:case TAG_ID.EM:case TAG_ID.TT:case TAG_ID.BIG:case TAG_ID.CODE:case TAG_ID.FONT:case TAG_ID.SMALL:case TAG_ID.STRIKE:case TAG_ID.STRONG:{bStartTagInBody(xt,$t);break}case TAG_ID.A:{aStartTagInBody(xt,$t);break}case TAG_ID.H1:case TAG_ID.H2:case TAG_ID.H3:case TAG_ID.H4:case TAG_ID.H5:case TAG_ID.H6:{numberedHeaderStartTagInBody(xt,$t);break}case TAG_ID.P:case TAG_ID.DL:case TAG_ID.OL:case TAG_ID.UL:case TAG_ID.DIV:case TAG_ID.DIR:case TAG_ID.NAV:case TAG_ID.MAIN:case TAG_ID.MENU:case TAG_ID.ASIDE:case TAG_ID.CENTER:case TAG_ID.FIGURE:case TAG_ID.FOOTER:case TAG_ID.HEADER:case TAG_ID.HGROUP:case TAG_ID.DIALOG:case TAG_ID.DETAILS:case TAG_ID.ADDRESS:case TAG_ID.ARTICLE:case TAG_ID.SECTION:case TAG_ID.SUMMARY:case TAG_ID.FIELDSET:case TAG_ID.BLOCKQUOTE:case TAG_ID.FIGCAPTION:{addressStartTagInBody(xt,$t);break}case TAG_ID.LI:case TAG_ID.DD:case TAG_ID.DT:{listItemStartTagInBody(xt,$t);break}case TAG_ID.BR:case TAG_ID.IMG:case TAG_ID.WBR:case TAG_ID.AREA:case TAG_ID.EMBED:case TAG_ID.KEYGEN:{areaStartTagInBody(xt,$t);break}case TAG_ID.HR:{hrStartTagInBody(xt,$t);break}case TAG_ID.RB:case TAG_ID.RTC:{rbStartTagInBody(xt,$t);break}case TAG_ID.RT:case TAG_ID.RP:{rtStartTagInBody(xt,$t);break}case TAG_ID.PRE:case TAG_ID.LISTING:{preStartTagInBody(xt,$t);break}case TAG_ID.XMP:{xmpStartTagInBody(xt,$t);break}case TAG_ID.SVG:{svgStartTagInBody(xt,$t);break}case TAG_ID.HTML:{htmlStartTagInBody(xt,$t);break}case TAG_ID.BASE:case TAG_ID.LINK:case TAG_ID.META:case TAG_ID.STYLE:case TAG_ID.TITLE:case TAG_ID.SCRIPT:case TAG_ID.BGSOUND:case TAG_ID.BASEFONT:case TAG_ID.TEMPLATE:{startTagInHead(xt,$t);break}case TAG_ID.BODY:{bodyStartTagInBody(xt,$t);break}case TAG_ID.FORM:{formStartTagInBody(xt,$t);break}case TAG_ID.NOBR:{nobrStartTagInBody(xt,$t);break}case TAG_ID.MATH:{mathStartTagInBody(xt,$t);break}case TAG_ID.TABLE:{tableStartTagInBody(xt,$t);break}case TAG_ID.INPUT:{inputStartTagInBody(xt,$t);break}case TAG_ID.PARAM:case TAG_ID.TRACK:case TAG_ID.SOURCE:{paramStartTagInBody(xt,$t);break}case TAG_ID.IMAGE:{imageStartTagInBody(xt,$t);break}case TAG_ID.BUTTON:{buttonStartTagInBody(xt,$t);break}case TAG_ID.APPLET:case TAG_ID.OBJECT:case TAG_ID.MARQUEE:{appletStartTagInBody(xt,$t);break}case TAG_ID.IFRAME:{iframeStartTagInBody(xt,$t);break}case TAG_ID.SELECT:{selectStartTagInBody(xt,$t);break}case TAG_ID.OPTION:case TAG_ID.OPTGROUP:{optgroupStartTagInBody(xt,$t);break}case TAG_ID.NOEMBED:{noembedStartTagInBody(xt,$t);break}case TAG_ID.FRAMESET:{framesetStartTagInBody(xt,$t);break}case TAG_ID.TEXTAREA:{textareaStartTagInBody(xt,$t);break}case TAG_ID.NOSCRIPT:{xt.options.scriptingEnabled?noembedStartTagInBody(xt,$t):genericStartTagInBody(xt,$t);break}case TAG_ID.PLAINTEXT:{plaintextStartTagInBody(xt,$t);break}case TAG_ID.COL:case TAG_ID.TH:case TAG_ID.TD:case TAG_ID.TR:case TAG_ID.HEAD:case TAG_ID.FRAME:case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:case TAG_ID.CAPTION:case TAG_ID.COLGROUP:break;default:genericStartTagInBody(xt,$t)}}function bodyEndTagInBody(xt,$t){if(xt.openElements.hasInScope(TAG_ID.BODY)&&(xt.insertionMode=InsertionMode.AFTER_BODY,xt.options.sourceCodeLocationInfo)){const Ct=xt.openElements.tryPeekProperlyNestedBodyElement();Ct&&xt._setEndLocation(Ct,$t)}}function htmlEndTagInBody(xt,$t){xt.openElements.hasInScope(TAG_ID.BODY)&&(xt.insertionMode=InsertionMode.AFTER_BODY,endTagAfterBody(xt,$t))}function addressEndTagInBody(xt,$t){const Ct=$t.tagID;xt.openElements.hasInScope(Ct)&&(xt.openElements.generateImpliedEndTags(),xt.openElements.popUntilTagNamePopped(Ct))}function formEndTagInBody(xt){const $t=xt.openElements.tmplCount>0,{formElement:Ct}=xt;$t||(xt.formElement=null),(Ct||$t)&&xt.openElements.hasInScope(TAG_ID.FORM)&&(xt.openElements.generateImpliedEndTags(),$t?xt.openElements.popUntilTagNamePopped(TAG_ID.FORM):Ct&&xt.openElements.remove(Ct))}function pEndTagInBody(xt){xt.openElements.hasInButtonScope(TAG_ID.P)||xt._insertFakeElement(TAG_NAMES.P,TAG_ID.P),xt._closePElement()}function liEndTagInBody(xt){xt.openElements.hasInListItemScope(TAG_ID.LI)&&(xt.openElements.generateImpliedEndTagsWithExclusion(TAG_ID.LI),xt.openElements.popUntilTagNamePopped(TAG_ID.LI))}function ddEndTagInBody(xt,$t){const Ct=$t.tagID;xt.openElements.hasInScope(Ct)&&(xt.openElements.generateImpliedEndTagsWithExclusion(Ct),xt.openElements.popUntilTagNamePopped(Ct))}function numberedHeaderEndTagInBody(xt){xt.openElements.hasNumberedHeaderInScope()&&(xt.openElements.generateImpliedEndTags(),xt.openElements.popUntilNumberedHeaderPopped())}function appletEndTagInBody(xt,$t){const Ct=$t.tagID;xt.openElements.hasInScope(Ct)&&(xt.openElements.generateImpliedEndTags(),xt.openElements.popUntilTagNamePopped(Ct),xt.activeFormattingElements.clearToLastMarker())}function brEndTagInBody(xt){xt._reconstructActiveFormattingElements(),xt._insertFakeElement(TAG_NAMES.BR,TAG_ID.BR),xt.openElements.pop(),xt.framesetOk=!1}function genericEndTagInBody(xt,$t){const Ct=$t.tagName,kt=$t.tagID;for(let Mt=xt.openElements.stackTop;Mt>0;Mt--){const Ft=xt.openElements.items[Mt],jt=xt.openElements.tagIDs[Mt];if(kt===jt&&(kt!==TAG_ID.UNKNOWN||xt.treeAdapter.getTagName(Ft)===Ct)){xt.openElements.generateImpliedEndTagsWithExclusion(kt),xt.openElements.stackTop>=Mt&&xt.openElements.shortenToLength(Mt);break}if(xt._isSpecialElement(Ft,jt))break}}function endTagInBody(xt,$t){switch($t.tagID){case TAG_ID.A:case TAG_ID.B:case TAG_ID.I:case TAG_ID.S:case TAG_ID.U:case TAG_ID.EM:case TAG_ID.TT:case TAG_ID.BIG:case TAG_ID.CODE:case TAG_ID.FONT:case TAG_ID.NOBR:case TAG_ID.SMALL:case TAG_ID.STRIKE:case TAG_ID.STRONG:{callAdoptionAgency(xt,$t);break}case TAG_ID.P:{pEndTagInBody(xt);break}case TAG_ID.DL:case TAG_ID.UL:case TAG_ID.OL:case TAG_ID.DIR:case TAG_ID.DIV:case TAG_ID.NAV:case TAG_ID.PRE:case TAG_ID.MAIN:case TAG_ID.MENU:case TAG_ID.ASIDE:case TAG_ID.BUTTON:case TAG_ID.CENTER:case TAG_ID.FIGURE:case TAG_ID.FOOTER:case TAG_ID.HEADER:case TAG_ID.HGROUP:case TAG_ID.DIALOG:case TAG_ID.ADDRESS:case TAG_ID.ARTICLE:case TAG_ID.DETAILS:case TAG_ID.SECTION:case TAG_ID.SUMMARY:case TAG_ID.LISTING:case TAG_ID.FIELDSET:case TAG_ID.BLOCKQUOTE:case TAG_ID.FIGCAPTION:{addressEndTagInBody(xt,$t);break}case TAG_ID.LI:{liEndTagInBody(xt);break}case TAG_ID.DD:case TAG_ID.DT:{ddEndTagInBody(xt,$t);break}case TAG_ID.H1:case TAG_ID.H2:case TAG_ID.H3:case TAG_ID.H4:case TAG_ID.H5:case TAG_ID.H6:{numberedHeaderEndTagInBody(xt);break}case TAG_ID.BR:{brEndTagInBody(xt);break}case TAG_ID.BODY:{bodyEndTagInBody(xt,$t);break}case TAG_ID.HTML:{htmlEndTagInBody(xt,$t);break}case TAG_ID.FORM:{formEndTagInBody(xt);break}case TAG_ID.APPLET:case TAG_ID.OBJECT:case TAG_ID.MARQUEE:{appletEndTagInBody(xt,$t);break}case TAG_ID.TEMPLATE:{templateEndTagInHead(xt,$t);break}default:genericEndTagInBody(xt,$t)}}function eofInBody(xt,$t){xt.tmplInsertionModeStack.length>0?eofInTemplate(xt,$t):stopParsing(xt,$t)}function endTagInText(xt,$t){var Ct;$t.tagID===TAG_ID.SCRIPT&&((Ct=xt.scriptHandler)===null||Ct===void 0||Ct.call(xt,xt.openElements.current)),xt.openElements.pop(),xt.insertionMode=xt.originalInsertionMode}function eofInText(xt,$t){xt._err($t,ERR.eofInElementThatCanContainOnlyText),xt.openElements.pop(),xt.insertionMode=xt.originalInsertionMode,xt.onEof($t)}function characterInTable(xt,$t){if(TABLE_STRUCTURE_TAGS.has(xt.openElements.currentTagId))switch(xt.pendingCharacterTokens.length=0,xt.hasNonWhitespacePendingCharacterToken=!1,xt.originalInsertionMode=xt.insertionMode,xt.insertionMode=InsertionMode.IN_TABLE_TEXT,$t.type){case TokenType$1.CHARACTER:{characterInTableText(xt,$t);break}case TokenType$1.WHITESPACE_CHARACTER:{whitespaceCharacterInTableText(xt,$t);break}}else tokenInTable(xt,$t)}function captionStartTagInTable(xt,$t){xt.openElements.clearBackToTableContext(),xt.activeFormattingElements.insertMarker(),xt._insertElement($t,NS.HTML),xt.insertionMode=InsertionMode.IN_CAPTION}function colgroupStartTagInTable(xt,$t){xt.openElements.clearBackToTableContext(),xt._insertElement($t,NS.HTML),xt.insertionMode=InsertionMode.IN_COLUMN_GROUP}function colStartTagInTable(xt,$t){xt.openElements.clearBackToTableContext(),xt._insertFakeElement(TAG_NAMES.COLGROUP,TAG_ID.COLGROUP),xt.insertionMode=InsertionMode.IN_COLUMN_GROUP,startTagInColumnGroup(xt,$t)}function tbodyStartTagInTable(xt,$t){xt.openElements.clearBackToTableContext(),xt._insertElement($t,NS.HTML),xt.insertionMode=InsertionMode.IN_TABLE_BODY}function tdStartTagInTable(xt,$t){xt.openElements.clearBackToTableContext(),xt._insertFakeElement(TAG_NAMES.TBODY,TAG_ID.TBODY),xt.insertionMode=InsertionMode.IN_TABLE_BODY,startTagInTableBody(xt,$t)}function tableStartTagInTable(xt,$t){xt.openElements.hasInTableScope(TAG_ID.TABLE)&&(xt.openElements.popUntilTagNamePopped(TAG_ID.TABLE),xt._resetInsertionMode(),xt._processStartTag($t))}function inputStartTagInTable(xt,$t){isHiddenInput($t)?xt._appendElement($t,NS.HTML):tokenInTable(xt,$t),$t.ackSelfClosing=!0}function formStartTagInTable(xt,$t){!xt.formElement&&xt.openElements.tmplCount===0&&(xt._insertElement($t,NS.HTML),xt.formElement=xt.openElements.current,xt.openElements.pop())}function startTagInTable(xt,$t){switch($t.tagID){case TAG_ID.TD:case TAG_ID.TH:case TAG_ID.TR:{tdStartTagInTable(xt,$t);break}case TAG_ID.STYLE:case TAG_ID.SCRIPT:case TAG_ID.TEMPLATE:{startTagInHead(xt,$t);break}case TAG_ID.COL:{colStartTagInTable(xt,$t);break}case TAG_ID.FORM:{formStartTagInTable(xt,$t);break}case TAG_ID.TABLE:{tableStartTagInTable(xt,$t);break}case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:{tbodyStartTagInTable(xt,$t);break}case TAG_ID.INPUT:{inputStartTagInTable(xt,$t);break}case TAG_ID.CAPTION:{captionStartTagInTable(xt,$t);break}case TAG_ID.COLGROUP:{colgroupStartTagInTable(xt,$t);break}default:tokenInTable(xt,$t)}}function endTagInTable(xt,$t){switch($t.tagID){case TAG_ID.TABLE:{xt.openElements.hasInTableScope(TAG_ID.TABLE)&&(xt.openElements.popUntilTagNamePopped(TAG_ID.TABLE),xt._resetInsertionMode());break}case TAG_ID.TEMPLATE:{templateEndTagInHead(xt,$t);break}case TAG_ID.BODY:case TAG_ID.CAPTION:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.HTML:case TAG_ID.TBODY:case TAG_ID.TD:case TAG_ID.TFOOT:case TAG_ID.TH:case TAG_ID.THEAD:case TAG_ID.TR:break;default:tokenInTable(xt,$t)}}function tokenInTable(xt,$t){const Ct=xt.fosterParentingEnabled;xt.fosterParentingEnabled=!0,modeInBody(xt,$t),xt.fosterParentingEnabled=Ct}function whitespaceCharacterInTableText(xt,$t){xt.pendingCharacterTokens.push($t)}function characterInTableText(xt,$t){xt.pendingCharacterTokens.push($t),xt.hasNonWhitespacePendingCharacterToken=!0}function tokenInTableText(xt,$t){let Ct=0;if(xt.hasNonWhitespacePendingCharacterToken)for(;Ct<xt.pendingCharacterTokens.length;Ct++)tokenInTable(xt,xt.pendingCharacterTokens[Ct]);else for(;Ct<xt.pendingCharacterTokens.length;Ct++)xt._insertCharacters(xt.pendingCharacterTokens[Ct]);xt.insertionMode=xt.originalInsertionMode,xt._processToken($t)}const TABLE_VOID_ELEMENTS=new Set([TAG_ID.CAPTION,TAG_ID.COL,TAG_ID.COLGROUP,TAG_ID.TBODY,TAG_ID.TD,TAG_ID.TFOOT,TAG_ID.TH,TAG_ID.THEAD,TAG_ID.TR]);function startTagInCaption(xt,$t){const Ct=$t.tagID;TABLE_VOID_ELEMENTS.has(Ct)?xt.openElements.hasInTableScope(TAG_ID.CAPTION)&&(xt.openElements.generateImpliedEndTags(),xt.openElements.popUntilTagNamePopped(TAG_ID.CAPTION),xt.activeFormattingElements.clearToLastMarker(),xt.insertionMode=InsertionMode.IN_TABLE,startTagInTable(xt,$t)):startTagInBody(xt,$t)}function endTagInCaption(xt,$t){const Ct=$t.tagID;switch(Ct){case TAG_ID.CAPTION:case TAG_ID.TABLE:{xt.openElements.hasInTableScope(TAG_ID.CAPTION)&&(xt.openElements.generateImpliedEndTags(),xt.openElements.popUntilTagNamePopped(TAG_ID.CAPTION),xt.activeFormattingElements.clearToLastMarker(),xt.insertionMode=InsertionMode.IN_TABLE,Ct===TAG_ID.TABLE&&endTagInTable(xt,$t));break}case TAG_ID.BODY:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.HTML:case TAG_ID.TBODY:case TAG_ID.TD:case TAG_ID.TFOOT:case TAG_ID.TH:case TAG_ID.THEAD:case TAG_ID.TR:break;default:endTagInBody(xt,$t)}}function startTagInColumnGroup(xt,$t){switch($t.tagID){case TAG_ID.HTML:{startTagInBody(xt,$t);break}case TAG_ID.COL:{xt._appendElement($t,NS.HTML),$t.ackSelfClosing=!0;break}case TAG_ID.TEMPLATE:{startTagInHead(xt,$t);break}default:tokenInColumnGroup(xt,$t)}}function endTagInColumnGroup(xt,$t){switch($t.tagID){case TAG_ID.COLGROUP:{xt.openElements.currentTagId===TAG_ID.COLGROUP&&(xt.openElements.pop(),xt.insertionMode=InsertionMode.IN_TABLE);break}case TAG_ID.TEMPLATE:{templateEndTagInHead(xt,$t);break}case TAG_ID.COL:break;default:tokenInColumnGroup(xt,$t)}}function tokenInColumnGroup(xt,$t){xt.openElements.currentTagId===TAG_ID.COLGROUP&&(xt.openElements.pop(),xt.insertionMode=InsertionMode.IN_TABLE,xt._processToken($t))}function startTagInTableBody(xt,$t){switch($t.tagID){case TAG_ID.TR:{xt.openElements.clearBackToTableBodyContext(),xt._insertElement($t,NS.HTML),xt.insertionMode=InsertionMode.IN_ROW;break}case TAG_ID.TH:case TAG_ID.TD:{xt.openElements.clearBackToTableBodyContext(),xt._insertFakeElement(TAG_NAMES.TR,TAG_ID.TR),xt.insertionMode=InsertionMode.IN_ROW,startTagInRow(xt,$t);break}case TAG_ID.CAPTION:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:{xt.openElements.hasTableBodyContextInTableScope()&&(xt.openElements.clearBackToTableBodyContext(),xt.openElements.pop(),xt.insertionMode=InsertionMode.IN_TABLE,startTagInTable(xt,$t));break}default:startTagInTable(xt,$t)}}function endTagInTableBody(xt,$t){const Ct=$t.tagID;switch($t.tagID){case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:{xt.openElements.hasInTableScope(Ct)&&(xt.openElements.clearBackToTableBodyContext(),xt.openElements.pop(),xt.insertionMode=InsertionMode.IN_TABLE);break}case TAG_ID.TABLE:{xt.openElements.hasTableBodyContextInTableScope()&&(xt.openElements.clearBackToTableBodyContext(),xt.openElements.pop(),xt.insertionMode=InsertionMode.IN_TABLE,endTagInTable(xt,$t));break}case TAG_ID.BODY:case TAG_ID.CAPTION:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.HTML:case TAG_ID.TD:case TAG_ID.TH:case TAG_ID.TR:break;default:endTagInTable(xt,$t)}}function startTagInRow(xt,$t){switch($t.tagID){case TAG_ID.TH:case TAG_ID.TD:{xt.openElements.clearBackToTableRowContext(),xt._insertElement($t,NS.HTML),xt.insertionMode=InsertionMode.IN_CELL,xt.activeFormattingElements.insertMarker();break}case TAG_ID.CAPTION:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:case TAG_ID.TR:{xt.openElements.hasInTableScope(TAG_ID.TR)&&(xt.openElements.clearBackToTableRowContext(),xt.openElements.pop(),xt.insertionMode=InsertionMode.IN_TABLE_BODY,startTagInTableBody(xt,$t));break}default:startTagInTable(xt,$t)}}function endTagInRow(xt,$t){switch($t.tagID){case TAG_ID.TR:{xt.openElements.hasInTableScope(TAG_ID.TR)&&(xt.openElements.clearBackToTableRowContext(),xt.openElements.pop(),xt.insertionMode=InsertionMode.IN_TABLE_BODY);break}case TAG_ID.TABLE:{xt.openElements.hasInTableScope(TAG_ID.TR)&&(xt.openElements.clearBackToTableRowContext(),xt.openElements.pop(),xt.insertionMode=InsertionMode.IN_TABLE_BODY,endTagInTableBody(xt,$t));break}case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:{(xt.openElements.hasInTableScope($t.tagID)||xt.openElements.hasInTableScope(TAG_ID.TR))&&(xt.openElements.clearBackToTableRowContext(),xt.openElements.pop(),xt.insertionMode=InsertionMode.IN_TABLE_BODY,endTagInTableBody(xt,$t));break}case TAG_ID.BODY:case TAG_ID.CAPTION:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.HTML:case TAG_ID.TD:case TAG_ID.TH:break;default:endTagInTable(xt,$t)}}function startTagInCell(xt,$t){const Ct=$t.tagID;TABLE_VOID_ELEMENTS.has(Ct)?(xt.openElements.hasInTableScope(TAG_ID.TD)||xt.openElements.hasInTableScope(TAG_ID.TH))&&(xt._closeTableCell(),startTagInRow(xt,$t)):startTagInBody(xt,$t)}function endTagInCell(xt,$t){const Ct=$t.tagID;switch(Ct){case TAG_ID.TD:case TAG_ID.TH:{xt.openElements.hasInTableScope(Ct)&&(xt.openElements.generateImpliedEndTags(),xt.openElements.popUntilTagNamePopped(Ct),xt.activeFormattingElements.clearToLastMarker(),xt.insertionMode=InsertionMode.IN_ROW);break}case TAG_ID.TABLE:case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:case TAG_ID.TR:{xt.openElements.hasInTableScope(Ct)&&(xt._closeTableCell(),endTagInRow(xt,$t));break}case TAG_ID.BODY:case TAG_ID.CAPTION:case TAG_ID.COL:case TAG_ID.COLGROUP:case TAG_ID.HTML:break;default:endTagInBody(xt,$t)}}function startTagInSelect(xt,$t){switch($t.tagID){case TAG_ID.HTML:{startTagInBody(xt,$t);break}case TAG_ID.OPTION:{xt.openElements.currentTagId===TAG_ID.OPTION&&xt.openElements.pop(),xt._insertElement($t,NS.HTML);break}case TAG_ID.OPTGROUP:{xt.openElements.currentTagId===TAG_ID.OPTION&&xt.openElements.pop(),xt.openElements.currentTagId===TAG_ID.OPTGROUP&&xt.openElements.pop(),xt._insertElement($t,NS.HTML);break}case TAG_ID.INPUT:case TAG_ID.KEYGEN:case TAG_ID.TEXTAREA:case TAG_ID.SELECT:{xt.openElements.hasInSelectScope(TAG_ID.SELECT)&&(xt.openElements.popUntilTagNamePopped(TAG_ID.SELECT),xt._resetInsertionMode(),$t.tagID!==TAG_ID.SELECT&&xt._processStartTag($t));break}case TAG_ID.SCRIPT:case TAG_ID.TEMPLATE:{startTagInHead(xt,$t);break}}}function endTagInSelect(xt,$t){switch($t.tagID){case TAG_ID.OPTGROUP:{xt.openElements.stackTop>0&&xt.openElements.currentTagId===TAG_ID.OPTION&&xt.openElements.tagIDs[xt.openElements.stackTop-1]===TAG_ID.OPTGROUP&&xt.openElements.pop(),xt.openElements.currentTagId===TAG_ID.OPTGROUP&&xt.openElements.pop();break}case TAG_ID.OPTION:{xt.openElements.currentTagId===TAG_ID.OPTION&&xt.openElements.pop();break}case TAG_ID.SELECT:{xt.openElements.hasInSelectScope(TAG_ID.SELECT)&&(xt.openElements.popUntilTagNamePopped(TAG_ID.SELECT),xt._resetInsertionMode());break}case TAG_ID.TEMPLATE:{templateEndTagInHead(xt,$t);break}}}function startTagInSelectInTable(xt,$t){const Ct=$t.tagID;Ct===TAG_ID.CAPTION||Ct===TAG_ID.TABLE||Ct===TAG_ID.TBODY||Ct===TAG_ID.TFOOT||Ct===TAG_ID.THEAD||Ct===TAG_ID.TR||Ct===TAG_ID.TD||Ct===TAG_ID.TH?(xt.openElements.popUntilTagNamePopped(TAG_ID.SELECT),xt._resetInsertionMode(),xt._processStartTag($t)):startTagInSelect(xt,$t)}function endTagInSelectInTable(xt,$t){const Ct=$t.tagID;Ct===TAG_ID.CAPTION||Ct===TAG_ID.TABLE||Ct===TAG_ID.TBODY||Ct===TAG_ID.TFOOT||Ct===TAG_ID.THEAD||Ct===TAG_ID.TR||Ct===TAG_ID.TD||Ct===TAG_ID.TH?xt.openElements.hasInTableScope(Ct)&&(xt.openElements.popUntilTagNamePopped(TAG_ID.SELECT),xt._resetInsertionMode(),xt.onEndTag($t)):endTagInSelect(xt,$t)}function startTagInTemplate(xt,$t){switch($t.tagID){case TAG_ID.BASE:case TAG_ID.BASEFONT:case TAG_ID.BGSOUND:case TAG_ID.LINK:case TAG_ID.META:case TAG_ID.NOFRAMES:case TAG_ID.SCRIPT:case TAG_ID.STYLE:case TAG_ID.TEMPLATE:case TAG_ID.TITLE:{startTagInHead(xt,$t);break}case TAG_ID.CAPTION:case TAG_ID.COLGROUP:case TAG_ID.TBODY:case TAG_ID.TFOOT:case TAG_ID.THEAD:{xt.tmplInsertionModeStack[0]=InsertionMode.IN_TABLE,xt.insertionMode=InsertionMode.IN_TABLE,startTagInTable(xt,$t);break}case TAG_ID.COL:{xt.tmplInsertionModeStack[0]=InsertionMode.IN_COLUMN_GROUP,xt.insertionMode=InsertionMode.IN_COLUMN_GROUP,startTagInColumnGroup(xt,$t);break}case TAG_ID.TR:{xt.tmplInsertionModeStack[0]=InsertionMode.IN_TABLE_BODY,xt.insertionMode=InsertionMode.IN_TABLE_BODY,startTagInTableBody(xt,$t);break}case TAG_ID.TD:case TAG_ID.TH:{xt.tmplInsertionModeStack[0]=InsertionMode.IN_ROW,xt.insertionMode=InsertionMode.IN_ROW,startTagInRow(xt,$t);break}default:xt.tmplInsertionModeStack[0]=InsertionMode.IN_BODY,xt.insertionMode=InsertionMode.IN_BODY,startTagInBody(xt,$t)}}function endTagInTemplate(xt,$t){$t.tagID===TAG_ID.TEMPLATE&&templateEndTagInHead(xt,$t)}function eofInTemplate(xt,$t){xt.openElements.tmplCount>0?(xt.openElements.popUntilTagNamePopped(TAG_ID.TEMPLATE),xt.activeFormattingElements.clearToLastMarker(),xt.tmplInsertionModeStack.shift(),xt._resetInsertionMode(),xt.onEof($t)):stopParsing(xt,$t)}function startTagAfterBody(xt,$t){$t.tagID===TAG_ID.HTML?startTagInBody(xt,$t):tokenAfterBody(xt,$t)}function endTagAfterBody(xt,$t){var Ct;if($t.tagID===TAG_ID.HTML){if(xt.fragmentContext||(xt.insertionMode=InsertionMode.AFTER_AFTER_BODY),xt.options.sourceCodeLocationInfo&&xt.openElements.tagIDs[0]===TAG_ID.HTML){xt._setEndLocation(xt.openElements.items[0],$t);const kt=xt.openElements.items[1];kt&&!(!((Ct=xt.treeAdapter.getNodeSourceCodeLocation(kt))===null||Ct===void 0)&&Ct.endTag)&&xt._setEndLocation(kt,$t)}}else tokenAfterBody(xt,$t)}function tokenAfterBody(xt,$t){xt.insertionMode=InsertionMode.IN_BODY,modeInBody(xt,$t)}function startTagInFrameset(xt,$t){switch($t.tagID){case TAG_ID.HTML:{startTagInBody(xt,$t);break}case TAG_ID.FRAMESET:{xt._insertElement($t,NS.HTML);break}case TAG_ID.FRAME:{xt._appendElement($t,NS.HTML),$t.ackSelfClosing=!0;break}case TAG_ID.NOFRAMES:{startTagInHead(xt,$t);break}}}function endTagInFrameset(xt,$t){$t.tagID===TAG_ID.FRAMESET&&!xt.openElements.isRootHtmlElementCurrent()&&(xt.openElements.pop(),!xt.fragmentContext&&xt.openElements.currentTagId!==TAG_ID.FRAMESET&&(xt.insertionMode=InsertionMode.AFTER_FRAMESET))}function startTagAfterFrameset(xt,$t){switch($t.tagID){case TAG_ID.HTML:{startTagInBody(xt,$t);break}case TAG_ID.NOFRAMES:{startTagInHead(xt,$t);break}}}function endTagAfterFrameset(xt,$t){$t.tagID===TAG_ID.HTML&&(xt.insertionMode=InsertionMode.AFTER_AFTER_FRAMESET)}function startTagAfterAfterBody(xt,$t){$t.tagID===TAG_ID.HTML?startTagInBody(xt,$t):tokenAfterAfterBody(xt,$t)}function tokenAfterAfterBody(xt,$t){xt.insertionMode=InsertionMode.IN_BODY,modeInBody(xt,$t)}function startTagAfterAfterFrameset(xt,$t){switch($t.tagID){case TAG_ID.HTML:{startTagInBody(xt,$t);break}case TAG_ID.NOFRAMES:{startTagInHead(xt,$t);break}}}function nullCharacterInForeignContent(xt,$t){$t.chars=REPLACEMENT_CHARACTER,xt._insertCharacters($t)}function characterInForeignContent(xt,$t){xt._insertCharacters($t),xt.framesetOk=!1}function popUntilHtmlOrIntegrationPoint(xt){for(;xt.treeAdapter.getNamespaceURI(xt.openElements.current)!==NS.HTML&&!xt._isIntegrationPoint(xt.openElements.currentTagId,xt.openElements.current);)xt.openElements.pop()}function startTagInForeignContent(xt,$t){if(causesExit($t))popUntilHtmlOrIntegrationPoint(xt),xt._startTagOutsideForeignContent($t);else{const Ct=xt._getAdjustedCurrentElement(),kt=xt.treeAdapter.getNamespaceURI(Ct);kt===NS.MATHML?adjustTokenMathMLAttrs($t):kt===NS.SVG&&(adjustTokenSVGTagName($t),adjustTokenSVGAttrs($t)),adjustTokenXMLAttrs($t),$t.selfClosing?xt._appendElement($t,kt):xt._insertElement($t,kt),$t.ackSelfClosing=!0}}function endTagInForeignContent(xt,$t){if($t.tagID===TAG_ID.P||$t.tagID===TAG_ID.BR){popUntilHtmlOrIntegrationPoint(xt),xt._endTagOutsideForeignContent($t);return}for(let Ct=xt.openElements.stackTop;Ct>0;Ct--){const kt=xt.openElements.items[Ct];if(xt.treeAdapter.getNamespaceURI(kt)===NS.HTML){xt._endTagOutsideForeignContent($t);break}const Mt=xt.treeAdapter.getTagName(kt);if(Mt.toLowerCase()===$t.tagName){$t.tagName=Mt,xt.openElements.shortenToLength(Ct);break}}}TAG_NAMES.AREA,TAG_NAMES.BASE,TAG_NAMES.BASEFONT,TAG_NAMES.BGSOUND,TAG_NAMES.BR,TAG_NAMES.COL,TAG_NAMES.EMBED,TAG_NAMES.FRAME,TAG_NAMES.HR,TAG_NAMES.IMG,TAG_NAMES.INPUT,TAG_NAMES.KEYGEN,TAG_NAMES.LINK,TAG_NAMES.META,TAG_NAMES.PARAM,TAG_NAMES.SOURCE,TAG_NAMES.TRACK,TAG_NAMES.WBR;const knownMdxNames=new Set(["mdxFlowExpression","mdxJsxFlowElement","mdxJsxTextElement","mdxTextExpression","mdxjsEsm"]),parseOptions$2={sourceCodeLocationInfo:!0,scriptingEnabled:!1};function raw(xt,$t){const Ct=documentMode(xt),kt=zwitch("type",{handlers:{root:root$2,element:element$2,text:text$4,comment,doctype,raw:handleRaw},unknown:unknown$1}),Mt={parser:Ct?new Parser$1(parseOptions$2):Parser$1.getFragmentParser(void 0,parseOptions$2),handle(Bt){kt(Bt,Mt)},stitches:!1,options:$t||{}};kt(xt,Mt),resetTokenizer(Mt,pointStart());const Ft=Ct?Mt.parser.document:Mt.parser.getFragment(),jt=fromParse5(Ft,{file:Mt.options.file});return Mt.stitches&&visit$2(jt,"comment",function(Bt,Vt,zt){const Ht=Bt;if(Ht.value.stitch&&zt&&Vt!==void 0){const Gt=zt.children;return Gt[Vt]=Ht.value.stitch,Vt}}),jt.type==="root"&&jt.children.length===1&&jt.children[0].type===xt.type?jt.children[0]:jt}function all$1(xt,$t){let Ct=-1;if(xt)for(;++Ct<xt.length;)$t.handle(xt[Ct])}function root$2(xt,$t){all$1(xt.children,$t)}function element$2(xt,$t){startTag(xt,$t),all$1(xt.children,$t),endTag(xt,$t)}function text$4(xt,$t){const Ct={type:TokenType$1.CHARACTER,chars:xt.value,location:createParse5Location(xt)};resetTokenizer($t,pointStart(xt)),$t.parser.currentToken=Ct,$t.parser._processToken($t.parser.currentToken)}function doctype(xt,$t){const Ct={type:TokenType$1.DOCTYPE,name:"html",forceQuirks:!1,publicId:"",systemId:"",location:createParse5Location(xt)};resetTokenizer($t,pointStart(xt)),$t.parser.currentToken=Ct,$t.parser._processToken($t.parser.currentToken)}function stitch$1(xt,$t){$t.stitches=!0;const Ct=cloneWithoutChildren(xt);if("children"in xt&&"children"in Ct){const kt=raw({type:"root",children:xt.children},$t.options);Ct.children=kt.children}comment({type:"comment",value:{stitch:Ct}},$t)}function comment(xt,$t){const Ct=xt.value,kt={type:TokenType$1.COMMENT,data:Ct,location:createParse5Location(xt)};resetTokenizer($t,pointStart(xt)),$t.parser.currentToken=kt,$t.parser._processToken($t.parser.currentToken)}function handleRaw(xt,$t){if($t.parser.tokenizer.preprocessor.html="",$t.parser.tokenizer.preprocessor.pos=-1,$t.parser.tokenizer.preprocessor.lastGapPos=-2,$t.parser.tokenizer.preprocessor.gapStack=[],$t.parser.tokenizer.preprocessor.skipNextNewLine=!1,$t.parser.tokenizer.preprocessor.lastChunkWritten=!1,$t.parser.tokenizer.preprocessor.endOfChunkHit=!1,$t.parser.tokenizer.preprocessor.isEol=!1,setPoint($t,pointStart(xt)),$t.parser.tokenizer.write(xt.value,!1),$t.parser.tokenizer._runParsingLoop(),$t.parser.tokenizer.state===72||$t.parser.tokenizer.state===78){$t.parser.tokenizer.preprocessor.lastChunkWritten=!0;const Ct=$t.parser.tokenizer._consume();$t.parser.tokenizer._callState(Ct)}}function unknown$1(xt,$t){const Ct=xt;if($t.options.passThrough&&$t.options.passThrough.includes(Ct.type))stitch$1(Ct,$t);else{let kt="";throw knownMdxNames.has(Ct.type)&&(kt=". It looks like you are using MDX nodes with `hast-util-raw` (or `rehype-raw`). If you use this because you are using remark or rehype plugins that inject `'html'` nodes, then please raise an issue with that plugin, as its a bad and slow idea. If you use this because you are using markdown syntax, then you have to configure this utility (or plugin) to pass through these nodes (see `passThrough` in docs), but you can also migrate to use the MDX syntax"),new Error("Cannot compile `"+Ct.type+"` node"+kt)}}function resetTokenizer(xt,$t){setPoint(xt,$t);const Ct=xt.parser.tokenizer.currentCharacterToken;Ct&&Ct.location&&(Ct.location.endLine=xt.parser.tokenizer.preprocessor.line,Ct.location.endCol=xt.parser.tokenizer.preprocessor.col+1,Ct.location.endOffset=xt.parser.tokenizer.preprocessor.offset+1,xt.parser.currentToken=Ct,xt.parser._processToken(xt.parser.currentToken)),xt.parser.tokenizer.paused=!1,xt.parser.tokenizer.inLoop=!1,xt.parser.tokenizer.active=!1,xt.parser.tokenizer.returnState=TokenizerMode.DATA,xt.parser.tokenizer.charRefCode=-1,xt.parser.tokenizer.consumedAfterSnapshot=-1,xt.parser.tokenizer.currentLocation=null,xt.parser.tokenizer.currentCharacterToken=null,xt.parser.tokenizer.currentToken=null,xt.parser.tokenizer.currentAttr={name:"",value:""}}function setPoint(xt,$t){if($t&&$t.offset!==void 0){const Ct={startLine:$t.line,startCol:$t.column,startOffset:$t.offset,endLine:-1,endCol:-1,endOffset:-1};xt.parser.tokenizer.preprocessor.lineStartPos=-$t.column+1,xt.parser.tokenizer.preprocessor.droppedBufferSize=$t.offset,xt.parser.tokenizer.preprocessor.line=$t.line,xt.parser.tokenizer.currentLocation=Ct}}function startTag(xt,$t){const Ct=xt.tagName.toLowerCase();if($t.parser.tokenizer.state===TokenizerMode.PLAINTEXT)return;resetTokenizer($t,pointStart(xt));const kt=$t.parser.openElements.current;let Mt="namespaceURI"in kt?kt.namespaceURI:webNamespaces.html;Mt===webNamespaces.html&&Ct==="svg"&&(Mt=webNamespaces.svg);const Ft=toParse5({...xt,children:[]},{space:Mt===webNamespaces.svg?"svg":"html"}),jt={type:TokenType$1.START_TAG,tagName:Ct,tagID:getTagID(Ct),selfClosing:!1,ackSelfClosing:!1,attrs:"attrs"in Ft?Ft.attrs:[],location:createParse5Location(xt)};$t.parser.currentToken=jt,$t.parser._processToken($t.parser.currentToken),$t.parser.tokenizer.lastStartTagName=Ct}function endTag(xt,$t){const Ct=xt.tagName.toLowerCase();if(!$t.parser.tokenizer.inForeignNode&&htmlVoidElements.includes(Ct)||$t.parser.tokenizer.state===TokenizerMode.PLAINTEXT)return;resetTokenizer($t,pointEnd(xt));const kt={type:TokenType$1.END_TAG,tagName:Ct,tagID:getTagID(Ct),selfClosing:!1,ackSelfClosing:!1,attrs:[],location:createParse5Location(xt)};$t.parser.currentToken=kt,$t.parser._processToken($t.parser.currentToken),Ct===$t.parser.tokenizer.lastStartTagName&&($t.parser.tokenizer.state===TokenizerMode.RCDATA||$t.parser.tokenizer.state===TokenizerMode.RAWTEXT||$t.parser.tokenizer.state===TokenizerMode.SCRIPT_DATA)&&($t.parser.tokenizer.state=TokenizerMode.DATA)}function documentMode(xt){const $t=xt.type==="root"?xt.children[0]:xt;return!!($t&&($t.type==="doctype"||$t.type==="element"&&$t.tagName.toLowerCase()==="html"))}function createParse5Location(xt){const $t=pointStart(xt)||{line:void 0,column:void 0,offset:void 0},Ct=pointEnd(xt)||{line:void 0,column:void 0,offset:void 0};return{startLine:$t.line,startCol:$t.column,startOffset:$t.offset,endLine:Ct.line,endCol:Ct.column,endOffset:Ct.offset}}function cloneWithoutChildren(xt){return"children"in xt?structuredClone$1({...xt,children:[]}):structuredClone$1(xt)}function rehypeRaw(xt){return function($t,Ct){return raw($t,{...xt,file:Ct})}}function ReactMarkdownWrapper({text:xt,required:$t}){const Ct={img({node:Mt,width:Ft,height:jt,...Bt}){return jsxRuntimeExports.jsx(Image$1,{...Bt,h:jt,w:Ft,ref:void 0})},p({node:Mt,...Ft}){return jsxRuntimeExports.jsx(Text,{...Ft,pb:8,fw:"inherit",ref:void 0})},h1({node:Mt,...Ft}){return jsxRuntimeExports.jsx(Title,{...Ft,order:1,...Ft,pb:12})},h2({node:Mt,...Ft}){return jsxRuntimeExports.jsx(Title,{...Ft,order:2,...Ft,pb:12})},h3({node:Mt,...Ft}){return jsxRuntimeExports.jsx(Title,{...Ft,order:3,...Ft,pb:12})},h4({node:Mt,...Ft}){return jsxRuntimeExports.jsx(Title,{...Ft,order:4,...Ft,pb:12})},h5({node:Mt,...Ft}){return jsxRuntimeExports.jsx(Title,{...Ft,order:5,...Ft,pb:12})},h6({node:Mt,...Ft}){return jsxRuntimeExports.jsx(Title,{...Ft,order:6,...Ft,pb:12})},a({node:Mt,...Ft}){return jsxRuntimeExports.jsx(Anchor,{...Ft,ref:void 0})},ul({node:Mt,...Ft}){return jsxRuntimeExports.jsx(List$2,{withPadding:!0,...Ft,pb:8})},ol({node:Mt,type:Ft,...jt}){return jsxRuntimeExports.jsx(List$2,{type:"ordered",withPadding:!0,...jt,pb:8})}};return jsxRuntimeExports.jsx(Markdown,{components:Ct,rehypePlugins:[rehypeRaw],children:xt+($t?'<span style="color: #fa5252; margin-left: 4px">*</span>':"")})}function ErrorLoadingConfig({issues:xt,type:$t}){const Ct=`
    ${$t==="error"?"There was an issue loading the study config. Please check the following issues:":"There were some warnings while loading the study config. Please check the following warnings:"}

    ${xt.map(kt=>`- You have an error at ${kt.instancePath||"root"}: ${kt.message} - ${JSON.stringify(kt.params)}  `).join(`
`)}
  `.replace(/\n\s+/g,`
`);return jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:Ct})}const REVISIT_GITHUB_PUBLIC="https://github.com/revisit-studies/study/tree/main/public/";function ConfigSwitcher({globalConfig:xt,studyConfigs:$t}){const{configsList:Ct}=xt,kt=useNavigate();return jsxRuntimeExports.jsx(AppShell.Main,{children:jsxRuntimeExports.jsxs(Container,{size:"xs",px:"xs",children:[jsxRuntimeExports.jsx(Image$1,{maw:150,mx:"auto",mb:"xl",radius:"md",src:`${PREFIX$1}revisitAssets/revisitLogoSquare.svg`,alt:"reVISit"}),jsxRuntimeExports.jsx(Text,{children:"Select an experiment to launch:"}),Ct.map(Mt=>{const Ft=$t[Mt];if(!Ft)return null;const jt=sanitizeStringForUrl(Mt);return jsxRuntimeExports.jsx(UnstyledButton,{onClick:()=>{kt(`/${jt}`)},my:"sm",style:{width:"100%"},children:jsxRuntimeExports.jsxs(Card,{shadow:"sm",radius:"md",withBorder:!0,children:[Ft.errors.length>0?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Text,{fw:"bold",children:Mt}),jsxRuntimeExports.jsxs(Flex,{align:"center",direction:"row",children:[jsxRuntimeExports.jsx(IconAlertTriangle,{color:"red"}),jsxRuntimeExports.jsx(Text,{fw:"bold",ml:8,color:"red",children:"Errors"})]}),jsxRuntimeExports.jsx(ErrorLoadingConfig,{issues:Ft.errors,type:"error"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Text,{fw:"bold",children:Ft.studyMetadata.title}),jsxRuntimeExports.jsxs(Text,{c:"dimmed",children:[jsxRuntimeExports.jsx(Text,{span:!0,fw:500,children:"Authors: "}),Ft.studyMetadata.authors]}),jsxRuntimeExports.jsx(Text,{c:"dimmed",children:Ft.studyMetadata.description}),jsxRuntimeExports.jsx(Text,{c:"dimmed",ta:"right",style:{paddingRight:5},children:jsxRuntimeExports.jsxs(Anchor,{target:"_blank",onClick:Bt=>Bt.stopPropagation(),href:`${REVISIT_GITHUB_PUBLIC}${jt}`,children:["View source:"," ",jt]})})]}),Ft.warnings.length>0&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Flex,{align:"center",direction:"row",children:[jsxRuntimeExports.jsx(IconAlertTriangle,{color:"orange"}),jsxRuntimeExports.jsx(Text,{fw:"bold",ml:8,color:"orange",children:"Warnings"})]}),jsxRuntimeExports.jsx(ErrorLoadingConfig,{issues:Ft.warnings,type:"warning"})]})]})},Mt)})]})})}var withSelector={exports:{}},useSyncExternalStoreWithSelector_production_min={};/**
 * @license React
 * use-sync-external-store-with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g$2=reactExports;function n$1(xt,$t){return xt===$t&&(xt!==0||1/xt===1/$t)||xt!==xt&&$t!==$t}var p$1=typeof Object.is=="function"?Object.is:n$1,q$2=g$2.useSyncExternalStore,r$1=g$2.useRef,t$3=g$2.useEffect,u$2=g$2.useMemo,v$2=g$2.useDebugValue;useSyncExternalStoreWithSelector_production_min.useSyncExternalStoreWithSelector=function(xt,$t,Ct,kt,Mt){var Ft=r$1(null);if(Ft.current===null){var jt={hasValue:!1,value:null};Ft.current=jt}else jt=Ft.current;Ft=u$2(function(){function Vt(Wt){if(!zt){if(zt=!0,Ht=Wt,Wt=kt(Wt),Mt!==void 0&&jt.hasValue){var Yt=jt.value;if(Mt(Yt,Wt))return Gt=Yt}return Gt=Wt}if(Yt=Gt,p$1(Ht,Wt))return Yt;var Kt=kt(Wt);return Mt!==void 0&&Mt(Yt,Kt)?Yt:(Ht=Wt,Gt=Kt)}var zt=!1,Ht,Gt,qt=Ct===void 0?null:Ct;return[function(){return Vt($t())},qt===null?void 0:function(){return Vt(qt())}]},[$t,Ct,kt,Mt]);var Bt=q$2(xt,Ft[0],Ft[1]);return t$3(function(){jt.hasValue=!0,jt.value=Bt},[Bt]),v$2(Bt),Bt};withSelector.exports=useSyncExternalStoreWithSelector_production_min;var withSelectorExports=withSelector.exports,React="default"in ReactOriginal?React$1:ReactOriginal,ContextKey=Symbol.for("react-redux-context"),gT=typeof globalThis<"u"?globalThis:{};function getContext$1(){if(!React.createContext)return{};const xt=gT[ContextKey]??(gT[ContextKey]=new Map);let $t=xt.get(React.createContext);return $t||($t=React.createContext(null),xt.set(React.createContext,$t)),$t}var ReactReduxContext=getContext$1(),notInitialized=()=>{throw new Error("uSES not initialized!")};function createReduxContextHook(xt=ReactReduxContext){return function(){return React.useContext(xt)}}var useReduxContext=createReduxContextHook(),useSyncExternalStoreWithSelector=notInitialized,initializeUseSelector=xt=>{useSyncExternalStoreWithSelector=xt},refEquality=(xt,$t)=>xt===$t;function createSelectorHook(xt=ReactReduxContext){const $t=xt===ReactReduxContext?useReduxContext:createReduxContextHook(xt),Ct=(kt,Mt={})=>{const{equalityFn:Ft=refEquality,devModeChecks:jt={}}=typeof Mt=="function"?{equalityFn:Mt}:Mt,{store:Bt,subscription:Vt,getServerState:zt,stabilityCheck:Ht,identityFunctionCheck:Gt}=$t();React.useRef(!0);const qt=React.useCallback({[kt.name](Yt){return kt(Yt)}}[kt.name],[kt,Ht,jt.stabilityCheck]),Wt=useSyncExternalStoreWithSelector(Vt.addNestedSub,Bt.getState,zt||Bt.getState,qt,Ft);return React.useDebugValue(Wt),Wt};return Object.assign(Ct,{withTypes:()=>Ct}),Ct}var useSelector=createSelectorHook();function defaultNoopBatch(xt){xt()}function createListenerCollection(){let xt=null,$t=null;return{clear(){xt=null,$t=null},notify(){defaultNoopBatch(()=>{let Ct=xt;for(;Ct;)Ct.callback(),Ct=Ct.next})},get(){const Ct=[];let kt=xt;for(;kt;)Ct.push(kt),kt=kt.next;return Ct},subscribe(Ct){let kt=!0;const Mt=$t={callback:Ct,next:null,prev:$t};return Mt.prev?Mt.prev.next=Mt:xt=Mt,function(){!kt||xt===null||(kt=!1,Mt.next?Mt.next.prev=Mt.prev:$t=Mt.prev,Mt.prev?Mt.prev.next=Mt.next:xt=Mt.next)}}}}var nullListeners={notify(){},get:()=>[]};function createSubscription(xt,$t){let Ct,kt=nullListeners,Mt=0,Ft=!1;function jt(Kt){Ht();const Xt=kt.subscribe(Kt);let Qt=!1;return()=>{Qt||(Qt=!0,Xt(),Gt())}}function Bt(){kt.notify()}function Vt(){Yt.onStateChange&&Yt.onStateChange()}function zt(){return Ft}function Ht(){Mt++,Ct||(Ct=xt.subscribe(Vt),kt=createListenerCollection())}function Gt(){Mt--,Ct&&Mt===0&&(Ct(),Ct=void 0,kt.clear(),kt=nullListeners)}function qt(){Ft||(Ft=!0,Ht())}function Wt(){Ft&&(Ft=!1,Gt())}const Yt={addNestedSub:jt,notifyNestedSubs:Bt,handleChangeWrapper:Vt,isSubscribed:zt,trySubscribe:qt,tryUnsubscribe:Wt,getListeners:()=>kt};return Yt}var canUseDOM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",isReactNative$1=typeof navigator<"u"&&navigator.product==="ReactNative",useIsomorphicLayoutEffect=canUseDOM||isReactNative$1?React.useLayoutEffect:React.useEffect;function Provider$1({store:xt,context:$t,children:Ct,serverState:kt,stabilityCheck:Mt="once",identityFunctionCheck:Ft="once"}){const jt=React.useMemo(()=>{const zt=createSubscription(xt);return{store:xt,subscription:zt,getServerState:kt?()=>kt:void 0,stabilityCheck:Mt,identityFunctionCheck:Ft}},[xt,kt,Mt,Ft]),Bt=React.useMemo(()=>xt.getState(),[xt]);useIsomorphicLayoutEffect(()=>{const{subscription:zt}=jt;return zt.onStateChange=zt.notifyNestedSubs,zt.trySubscribe(),Bt!==xt.getState()&&zt.notifyNestedSubs(),()=>{zt.tryUnsubscribe(),zt.onStateChange=void 0}},[jt,Bt]);const Vt=$t||ReactReduxContext;return React.createElement(Vt.Provider,{value:jt},Ct)}var Provider_default=Provider$1;function createStoreHook(xt=ReactReduxContext){const $t=xt===ReactReduxContext?useReduxContext:createReduxContextHook(xt),Ct=()=>{const{store:kt}=$t();return kt};return Object.assign(Ct,{withTypes:()=>Ct}),Ct}var useStore=createStoreHook();function createDispatchHook(xt=ReactReduxContext){const $t=xt===ReactReduxContext?useStore:createStoreHook(xt),Ct=()=>$t().dispatch;return Object.assign(Ct,{withTypes:()=>Ct}),Ct}var useDispatch=createDispatchHook();initializeUseSelector(withSelectorExports.useSyncExternalStoreWithSelector);function formatProdErrorMessage$2(xt){return`Minified Redux error #${xt}; visit https://redux.js.org/Errors?code=${xt} for the full message or use the non-minified dev environment for full errors. `}var $$observable$1=typeof Symbol=="function"&&Symbol.observable||"@@observable",symbol_observable_default=$$observable$1,randomString$1=()=>Math.random().toString(36).substring(7).split("").join("."),ActionTypes$1={INIT:`@@redux/INIT${randomString$1()}`,REPLACE:`@@redux/REPLACE${randomString$1()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${randomString$1()}`},actionTypes_default=ActionTypes$1;function isPlainObject$3(xt){if(typeof xt!="object"||xt===null)return!1;let $t=xt;for(;Object.getPrototypeOf($t)!==null;)$t=Object.getPrototypeOf($t);return Object.getPrototypeOf(xt)===$t||Object.getPrototypeOf(xt)===null}function createStore$1(xt,$t,Ct){if(typeof xt!="function")throw new Error(formatProdErrorMessage$2(2));if(typeof $t=="function"&&typeof Ct=="function"||typeof Ct=="function"&&typeof arguments[3]=="function")throw new Error(formatProdErrorMessage$2(0));if(typeof $t=="function"&&typeof Ct>"u"&&(Ct=$t,$t=void 0),typeof Ct<"u"){if(typeof Ct!="function")throw new Error(formatProdErrorMessage$2(1));return Ct(createStore$1)(xt,$t)}let kt=xt,Mt=$t,Ft=new Map,jt=Ft,Bt=0,Vt=!1;function zt(){jt===Ft&&(jt=new Map,Ft.forEach((Xt,Qt)=>{jt.set(Qt,Xt)}))}function Ht(){if(Vt)throw new Error(formatProdErrorMessage$2(3));return Mt}function Gt(Xt){if(typeof Xt!="function")throw new Error(formatProdErrorMessage$2(4));if(Vt)throw new Error(formatProdErrorMessage$2(5));let Qt=!0;zt();const Jt=Bt++;return jt.set(Jt,Xt),function(){if(Qt){if(Vt)throw new Error(formatProdErrorMessage$2(6));Qt=!1,zt(),jt.delete(Jt),Ft=null}}}function qt(Xt){if(!isPlainObject$3(Xt))throw new Error(formatProdErrorMessage$2(7));if(typeof Xt.type>"u")throw new Error(formatProdErrorMessage$2(8));if(typeof Xt.type!="string")throw new Error(formatProdErrorMessage$2(17));if(Vt)throw new Error(formatProdErrorMessage$2(9));try{Vt=!0,Mt=kt(Mt,Xt)}finally{Vt=!1}return(Ft=jt).forEach(Jt=>{Jt()}),Xt}function Wt(Xt){if(typeof Xt!="function")throw new Error(formatProdErrorMessage$2(10));kt=Xt,qt({type:actionTypes_default.REPLACE})}function Yt(){const Xt=Gt;return{subscribe(Qt){if(typeof Qt!="object"||Qt===null)throw new Error(formatProdErrorMessage$2(11));function Jt(){const sn=Qt;sn.next&&sn.next(Ht())}return Jt(),{unsubscribe:Xt(Jt)}},[symbol_observable_default](){return this}}}return qt({type:actionTypes_default.INIT}),{dispatch:qt,subscribe:Gt,getState:Ht,replaceReducer:Wt,[symbol_observable_default]:Yt}}function assertReducerShape$1(xt){Object.keys(xt).forEach($t=>{const Ct=xt[$t];if(typeof Ct(void 0,{type:actionTypes_default.INIT})>"u")throw new Error(formatProdErrorMessage$2(12));if(typeof Ct(void 0,{type:actionTypes_default.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(formatProdErrorMessage$2(13))})}function combineReducers$1(xt){const $t=Object.keys(xt),Ct={};for(let Ft=0;Ft<$t.length;Ft++){const jt=$t[Ft];typeof xt[jt]=="function"&&(Ct[jt]=xt[jt])}const kt=Object.keys(Ct);let Mt;try{assertReducerShape$1(Ct)}catch(Ft){Mt=Ft}return function(jt={},Bt){if(Mt)throw Mt;let Vt=!1;const zt={};for(let Ht=0;Ht<kt.length;Ht++){const Gt=kt[Ht],qt=Ct[Gt],Wt=jt[Gt],Yt=qt(Wt,Bt);if(typeof Yt>"u")throw Bt&&Bt.type,new Error(formatProdErrorMessage$2(14));zt[Gt]=Yt,Vt=Vt||Yt!==Wt}return Vt=Vt||kt.length!==Object.keys(jt).length,Vt?zt:jt}}function compose$2(...xt){return xt.length===0?$t=>$t:xt.length===1?xt[0]:xt.reduce(($t,Ct)=>(...kt)=>$t(Ct(...kt)))}function applyMiddleware$1(...xt){return $t=>(Ct,kt)=>{const Mt=$t(Ct,kt);let Ft=()=>{throw new Error(formatProdErrorMessage$2(15))};const jt={getState:Mt.getState,dispatch:(Vt,...zt)=>Ft(Vt,...zt)},Bt=xt.map(Vt=>Vt(jt));return Ft=compose$2(...Bt)(Mt.dispatch),{...Mt,dispatch:Ft}}}function isAction$1(xt){return isPlainObject$3(xt)&&"type"in xt&&typeof xt.type=="string"}var NOTHING=Symbol.for("immer-nothing"),DRAFTABLE=Symbol.for("immer-draftable"),DRAFT_STATE=Symbol.for("immer-state");function die(xt,...$t){throw new Error(`[Immer] minified error nr: ${xt}. Full error at: https://bit.ly/3cXEKWf`)}var getPrototypeOf=Object.getPrototypeOf;function isDraft(xt){return!!xt&&!!xt[DRAFT_STATE]}function isDraftable(xt){var $t;return xt?isPlainObject$2(xt)||Array.isArray(xt)||!!xt[DRAFTABLE]||!!(($t=xt.constructor)!=null&&$t[DRAFTABLE])||isMap$1(xt)||isSet$1(xt):!1}var objectCtorString=Object.prototype.constructor.toString();function isPlainObject$2(xt){if(!xt||typeof xt!="object")return!1;const $t=getPrototypeOf(xt);if($t===null)return!0;const Ct=Object.hasOwnProperty.call($t,"constructor")&&$t.constructor;return Ct===Object?!0:typeof Ct=="function"&&Function.toString.call(Ct)===objectCtorString}function each(xt,$t){getArchtype(xt)===0?Reflect.ownKeys(xt).forEach(Ct=>{$t(Ct,xt[Ct],xt)}):xt.forEach((Ct,kt)=>$t(kt,Ct,xt))}function getArchtype(xt){const $t=xt[DRAFT_STATE];return $t?$t.type_:Array.isArray(xt)?1:isMap$1(xt)?2:isSet$1(xt)?3:0}function has$4(xt,$t){return getArchtype(xt)===2?xt.has($t):Object.prototype.hasOwnProperty.call(xt,$t)}function set$8(xt,$t,Ct){const kt=getArchtype(xt);kt===2?xt.set($t,Ct):kt===3?xt.add(Ct):xt[$t]=Ct}function is$1(xt,$t){return xt===$t?xt!==0||1/xt===1/$t:xt!==xt&&$t!==$t}function isMap$1(xt){return xt instanceof Map}function isSet$1(xt){return xt instanceof Set}function latest(xt){return xt.copy_||xt.base_}function shallowCopy(xt,$t){if(isMap$1(xt))return new Map(xt);if(isSet$1(xt))return new Set(xt);if(Array.isArray(xt))return Array.prototype.slice.call(xt);const Ct=isPlainObject$2(xt);if($t===!0||$t==="class_only"&&!Ct){const kt=Object.getOwnPropertyDescriptors(xt);delete kt[DRAFT_STATE];let Mt=Reflect.ownKeys(kt);for(let Ft=0;Ft<Mt.length;Ft++){const jt=Mt[Ft],Bt=kt[jt];Bt.writable===!1&&(Bt.writable=!0,Bt.configurable=!0),(Bt.get||Bt.set)&&(kt[jt]={configurable:!0,writable:!0,enumerable:Bt.enumerable,value:xt[jt]})}return Object.create(getPrototypeOf(xt),kt)}else{const kt=getPrototypeOf(xt);if(kt!==null&&Ct)return{...xt};const Mt=Object.create(kt);return Object.assign(Mt,xt)}}function freeze(xt,$t=!1){return isFrozen(xt)||isDraft(xt)||!isDraftable(xt)||(getArchtype(xt)>1&&(xt.set=xt.add=xt.clear=xt.delete=dontMutateFrozenCollections),Object.freeze(xt),$t&&Object.entries(xt).forEach(([Ct,kt])=>freeze(kt,!0))),xt}function dontMutateFrozenCollections(){die(2)}function isFrozen(xt){return Object.isFrozen(xt)}var plugins={};function getPlugin(xt){const $t=plugins[xt];return $t||die(0,xt),$t}var currentScope;function getCurrentScope(){return currentScope}function createScope(xt,$t){return{drafts_:[],parent_:xt,immer_:$t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function usePatchesInScope(xt,$t){$t&&(getPlugin("Patches"),xt.patches_=[],xt.inversePatches_=[],xt.patchListener_=$t)}function revokeScope(xt){leaveScope(xt),xt.drafts_.forEach(revokeDraft),xt.drafts_=null}function leaveScope(xt){xt===currentScope&&(currentScope=xt.parent_)}function enterScope(xt){return currentScope=createScope(currentScope,xt)}function revokeDraft(xt){const $t=xt[DRAFT_STATE];$t.type_===0||$t.type_===1?$t.revoke_():$t.revoked_=!0}function processResult(xt,$t){$t.unfinalizedDrafts_=$t.drafts_.length;const Ct=$t.drafts_[0];return xt!==void 0&&xt!==Ct?(Ct[DRAFT_STATE].modified_&&(revokeScope($t),die(4)),isDraftable(xt)&&(xt=finalize$1($t,xt),$t.parent_||maybeFreeze($t,xt)),$t.patches_&&getPlugin("Patches").generateReplacementPatches_(Ct[DRAFT_STATE].base_,xt,$t.patches_,$t.inversePatches_)):xt=finalize$1($t,Ct,[]),revokeScope($t),$t.patches_&&$t.patchListener_($t.patches_,$t.inversePatches_),xt!==NOTHING?xt:void 0}function finalize$1(xt,$t,Ct){if(isFrozen($t))return $t;const kt=$t[DRAFT_STATE];if(!kt)return each($t,(Mt,Ft)=>finalizeProperty(xt,kt,$t,Mt,Ft,Ct)),$t;if(kt.scope_!==xt)return $t;if(!kt.modified_)return maybeFreeze(xt,kt.base_,!0),kt.base_;if(!kt.finalized_){kt.finalized_=!0,kt.scope_.unfinalizedDrafts_--;const Mt=kt.copy_;let Ft=Mt,jt=!1;kt.type_===3&&(Ft=new Set(Mt),Mt.clear(),jt=!0),each(Ft,(Bt,Vt)=>finalizeProperty(xt,kt,Mt,Bt,Vt,Ct,jt)),maybeFreeze(xt,Mt,!1),Ct&&xt.patches_&&getPlugin("Patches").generatePatches_(kt,Ct,xt.patches_,xt.inversePatches_)}return kt.copy_}function finalizeProperty(xt,$t,Ct,kt,Mt,Ft,jt){if(isDraft(Mt)){const Bt=Ft&&$t&&$t.type_!==3&&!has$4($t.assigned_,kt)?Ft.concat(kt):void 0,Vt=finalize$1(xt,Mt,Bt);if(set$8(Ct,kt,Vt),isDraft(Vt))xt.canAutoFreeze_=!1;else return}else jt&&Ct.add(Mt);if(isDraftable(Mt)&&!isFrozen(Mt)){if(!xt.immer_.autoFreeze_&&xt.unfinalizedDrafts_<1)return;finalize$1(xt,Mt),(!$t||!$t.scope_.parent_)&&typeof kt!="symbol"&&Object.prototype.propertyIsEnumerable.call(Ct,kt)&&maybeFreeze(xt,Mt)}}function maybeFreeze(xt,$t,Ct=!1){!xt.parent_&&xt.immer_.autoFreeze_&&xt.canAutoFreeze_&&freeze($t,Ct)}function createProxyProxy(xt,$t){const Ct=Array.isArray(xt),kt={type_:Ct?1:0,scope_:$t?$t.scope_:getCurrentScope(),modified_:!1,finalized_:!1,assigned_:{},parent_:$t,base_:xt,draft_:null,copy_:null,revoke_:null,isManual_:!1};let Mt=kt,Ft=objectTraps;Ct&&(Mt=[kt],Ft=arrayTraps);const{revoke:jt,proxy:Bt}=Proxy.revocable(Mt,Ft);return kt.draft_=Bt,kt.revoke_=jt,Bt}var objectTraps={get(xt,$t){if($t===DRAFT_STATE)return xt;const Ct=latest(xt);if(!has$4(Ct,$t))return readPropFromProto(xt,Ct,$t);const kt=Ct[$t];return xt.finalized_||!isDraftable(kt)?kt:kt===peek$2(xt.base_,$t)?(prepareCopy(xt),xt.copy_[$t]=createProxy(kt,xt)):kt},has(xt,$t){return $t in latest(xt)},ownKeys(xt){return Reflect.ownKeys(latest(xt))},set(xt,$t,Ct){const kt=getDescriptorFromProto(latest(xt),$t);if(kt!=null&&kt.set)return kt.set.call(xt.draft_,Ct),!0;if(!xt.modified_){const Mt=peek$2(latest(xt),$t),Ft=Mt==null?void 0:Mt[DRAFT_STATE];if(Ft&&Ft.base_===Ct)return xt.copy_[$t]=Ct,xt.assigned_[$t]=!1,!0;if(is$1(Ct,Mt)&&(Ct!==void 0||has$4(xt.base_,$t)))return!0;prepareCopy(xt),markChanged(xt)}return xt.copy_[$t]===Ct&&(Ct!==void 0||$t in xt.copy_)||Number.isNaN(Ct)&&Number.isNaN(xt.copy_[$t])||(xt.copy_[$t]=Ct,xt.assigned_[$t]=!0),!0},deleteProperty(xt,$t){return peek$2(xt.base_,$t)!==void 0||$t in xt.base_?(xt.assigned_[$t]=!1,prepareCopy(xt),markChanged(xt)):delete xt.assigned_[$t],xt.copy_&&delete xt.copy_[$t],!0},getOwnPropertyDescriptor(xt,$t){const Ct=latest(xt),kt=Reflect.getOwnPropertyDescriptor(Ct,$t);return kt&&{writable:!0,configurable:xt.type_!==1||$t!=="length",enumerable:kt.enumerable,value:Ct[$t]}},defineProperty(){die(11)},getPrototypeOf(xt){return getPrototypeOf(xt.base_)},setPrototypeOf(){die(12)}},arrayTraps={};each(objectTraps,(xt,$t)=>{arrayTraps[xt]=function(){return arguments[0]=arguments[0][0],$t.apply(this,arguments)}});arrayTraps.deleteProperty=function(xt,$t){return arrayTraps.set.call(this,xt,$t,void 0)};arrayTraps.set=function(xt,$t,Ct){return objectTraps.set.call(this,xt[0],$t,Ct,xt[0])};function peek$2(xt,$t){const Ct=xt[DRAFT_STATE];return(Ct?latest(Ct):xt)[$t]}function readPropFromProto(xt,$t,Ct){var Mt;const kt=getDescriptorFromProto($t,Ct);return kt?"value"in kt?kt.value:(Mt=kt.get)==null?void 0:Mt.call(xt.draft_):void 0}function getDescriptorFromProto(xt,$t){if(!($t in xt))return;let Ct=getPrototypeOf(xt);for(;Ct;){const kt=Object.getOwnPropertyDescriptor(Ct,$t);if(kt)return kt;Ct=getPrototypeOf(Ct)}}function markChanged(xt){xt.modified_||(xt.modified_=!0,xt.parent_&&markChanged(xt.parent_))}function prepareCopy(xt){xt.copy_||(xt.copy_=shallowCopy(xt.base_,xt.scope_.immer_.useStrictShallowCopy_))}var Immer2=class{constructor(xt){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=($t,Ct,kt)=>{if(typeof $t=="function"&&typeof Ct!="function"){const Ft=Ct;Ct=$t;const jt=this;return function(Vt=Ft,...zt){return jt.produce(Vt,Ht=>Ct.call(this,Ht,...zt))}}typeof Ct!="function"&&die(6),kt!==void 0&&typeof kt!="function"&&die(7);let Mt;if(isDraftable($t)){const Ft=enterScope(this),jt=createProxy($t,void 0);let Bt=!0;try{Mt=Ct(jt),Bt=!1}finally{Bt?revokeScope(Ft):leaveScope(Ft)}return usePatchesInScope(Ft,kt),processResult(Mt,Ft)}else if(!$t||typeof $t!="object"){if(Mt=Ct($t),Mt===void 0&&(Mt=$t),Mt===NOTHING&&(Mt=void 0),this.autoFreeze_&&freeze(Mt,!0),kt){const Ft=[],jt=[];getPlugin("Patches").generateReplacementPatches_($t,Mt,Ft,jt),kt(Ft,jt)}return Mt}else die(1,$t)},this.produceWithPatches=($t,Ct)=>{if(typeof $t=="function")return(jt,...Bt)=>this.produceWithPatches(jt,Vt=>$t(Vt,...Bt));let kt,Mt;return[this.produce($t,Ct,(jt,Bt)=>{kt=jt,Mt=Bt}),kt,Mt]},typeof(xt==null?void 0:xt.autoFreeze)=="boolean"&&this.setAutoFreeze(xt.autoFreeze),typeof(xt==null?void 0:xt.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(xt.useStrictShallowCopy)}createDraft(xt){isDraftable(xt)||die(8),isDraft(xt)&&(xt=current$1(xt));const $t=enterScope(this),Ct=createProxy(xt,void 0);return Ct[DRAFT_STATE].isManual_=!0,leaveScope($t),Ct}finishDraft(xt,$t){const Ct=xt&&xt[DRAFT_STATE];(!Ct||!Ct.isManual_)&&die(9);const{scope_:kt}=Ct;return usePatchesInScope(kt,$t),processResult(void 0,kt)}setAutoFreeze(xt){this.autoFreeze_=xt}setUseStrictShallowCopy(xt){this.useStrictShallowCopy_=xt}applyPatches(xt,$t){let Ct;for(Ct=$t.length-1;Ct>=0;Ct--){const Mt=$t[Ct];if(Mt.path.length===0&&Mt.op==="replace"){xt=Mt.value;break}}Ct>-1&&($t=$t.slice(Ct+1));const kt=getPlugin("Patches").applyPatches_;return isDraft(xt)?kt(xt,$t):this.produce(xt,Mt=>kt(Mt,$t))}};function createProxy(xt,$t){const Ct=isMap$1(xt)?getPlugin("MapSet").proxyMap_(xt,$t):isSet$1(xt)?getPlugin("MapSet").proxySet_(xt,$t):createProxyProxy(xt,$t);return($t?$t.scope_:getCurrentScope()).drafts_.push(Ct),Ct}function current$1(xt){return isDraft(xt)||die(10,xt),currentImpl(xt)}function currentImpl(xt){if(!isDraftable(xt)||isFrozen(xt))return xt;const $t=xt[DRAFT_STATE];let Ct;if($t){if(!$t.modified_)return $t.base_;$t.finalized_=!0,Ct=shallowCopy(xt,$t.scope_.immer_.useStrictShallowCopy_)}else Ct=shallowCopy(xt,!0);return each(Ct,(kt,Mt)=>{set$8(Ct,kt,currentImpl(Mt))}),$t&&($t.finalized_=!1),Ct}var immer=new Immer2,produce=immer.produce;immer.produceWithPatches.bind(immer);immer.setAutoFreeze.bind(immer);immer.setUseStrictShallowCopy.bind(immer);immer.applyPatches.bind(immer);immer.createDraft.bind(immer);immer.finishDraft.bind(immer);function assertIsFunction(xt,$t=`expected a function, instead received ${typeof xt}`){if(typeof xt!="function")throw new TypeError($t)}function assertIsObject(xt,$t=`expected an object, instead received ${typeof xt}`){if(typeof xt!="object")throw new TypeError($t)}function assertIsArrayOfFunctions(xt,$t="expected all items to be functions, instead received the following types: "){if(!xt.every(Ct=>typeof Ct=="function")){const Ct=xt.map(kt=>typeof kt=="function"?`function ${kt.name||"unnamed"}()`:typeof kt).join(", ");throw new TypeError(`${$t}[${Ct}]`)}}var ensureIsArray=xt=>Array.isArray(xt)?xt:[xt];function getDependencies(xt){const $t=Array.isArray(xt[0])?xt[0]:xt;return assertIsArrayOfFunctions($t,"createSelector expects all input-selectors to be functions, but received the following types: "),$t}function collectInputSelectorResults(xt,$t){const Ct=[],{length:kt}=xt;for(let Mt=0;Mt<kt;Mt++)Ct.push(xt[Mt].apply(null,$t));return Ct}var StrongRef=class{constructor(xt){this.value=xt}deref(){return this.value}},Ref=typeof WeakRef<"u"?WeakRef:StrongRef,UNTERMINATED=0,TERMINATED=1;function createCacheNode(){return{s:UNTERMINATED,v:void 0,o:null,p:null}}function weakMapMemoize(xt,$t={}){let Ct=createCacheNode();const{resultEqualityCheck:kt}=$t;let Mt,Ft=0;function jt(){var Gt;let Bt=Ct;const{length:Vt}=arguments;for(let qt=0,Wt=Vt;qt<Wt;qt++){const Yt=arguments[qt];if(typeof Yt=="function"||typeof Yt=="object"&&Yt!==null){let Kt=Bt.o;Kt===null&&(Bt.o=Kt=new WeakMap);const Xt=Kt.get(Yt);Xt===void 0?(Bt=createCacheNode(),Kt.set(Yt,Bt)):Bt=Xt}else{let Kt=Bt.p;Kt===null&&(Bt.p=Kt=new Map);const Xt=Kt.get(Yt);Xt===void 0?(Bt=createCacheNode(),Kt.set(Yt,Bt)):Bt=Xt}}const zt=Bt;let Ht;if(Bt.s===TERMINATED)Ht=Bt.v;else if(Ht=xt.apply(null,arguments),Ft++,kt){const qt=((Gt=Mt==null?void 0:Mt.deref)==null?void 0:Gt.call(Mt))??Mt;qt!=null&&kt(qt,Ht)&&(Ht=qt,Ft!==0&&Ft--),Mt=typeof Ht=="object"&&Ht!==null||typeof Ht=="function"?new Ref(Ht):Ht}return zt.s=TERMINATED,zt.v=Ht,Ht}return jt.clearCache=()=>{Ct=createCacheNode(),jt.resetResultsCount()},jt.resultsCount=()=>Ft,jt.resetResultsCount=()=>{Ft=0},jt}function createSelectorCreator(xt,...$t){const Ct=typeof xt=="function"?{memoize:xt,memoizeOptions:$t}:xt,kt=(...Mt)=>{let Ft=0,jt=0,Bt,Vt={},zt=Mt.pop();typeof zt=="object"&&(Vt=zt,zt=Mt.pop()),assertIsFunction(zt,`createSelector expects an output function after the inputs, but received: [${typeof zt}]`);const Ht={...Ct,...Vt},{memoize:Gt,memoizeOptions:qt=[],argsMemoize:Wt=weakMapMemoize,argsMemoizeOptions:Yt=[],devModeChecks:Kt={}}=Ht,Xt=ensureIsArray(qt),Qt=ensureIsArray(Yt),Jt=getDependencies(Mt),Zt=Gt(function(){return Ft++,zt.apply(null,arguments)},...Xt),sn=Wt(function(){jt++;const dn=collectInputSelectorResults(Jt,arguments);return Bt=Zt.apply(null,dn),Bt},...Qt);return Object.assign(sn,{resultFunc:zt,memoizedResultFunc:Zt,dependencies:Jt,dependencyRecomputations:()=>jt,resetDependencyRecomputations:()=>{jt=0},lastResult:()=>Bt,recomputations:()=>Ft,resetRecomputations:()=>{Ft=0},memoize:Gt,argsMemoize:Wt})};return Object.assign(kt,{withTypes:()=>kt}),kt}var createSelector=createSelectorCreator(weakMapMemoize),createStructuredSelector=Object.assign((xt,$t=createSelector)=>{assertIsObject(xt,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof xt}`);const Ct=Object.keys(xt),kt=Ct.map(Ft=>xt[Ft]);return $t(kt,(...Ft)=>Ft.reduce((jt,Bt,Vt)=>(jt[Ct[Vt]]=Bt,jt),{}))},{withTypes:()=>createStructuredSelector});function createThunkMiddleware$1(xt){return({dispatch:Ct,getState:kt})=>Mt=>Ft=>typeof Ft=="function"?Ft(Ct,kt,xt):Mt(Ft)}var thunk$1=createThunkMiddleware$1(),withExtraArgument=createThunkMiddleware$1,createDraftSafeSelectorCreator=(...xt)=>{const $t=createSelectorCreator(...xt),Ct=Object.assign((...kt)=>{const Mt=$t(...kt),Ft=(jt,...Bt)=>Mt(isDraft(jt)?current$1(jt):jt,...Bt);return Object.assign(Ft,Mt),Ft},{withTypes:()=>Ct});return Ct};createDraftSafeSelectorCreator(weakMapMemoize);var composeWithDevTools$1=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?compose$2:compose$2.apply(null,arguments)};function createAction$1(xt,$t){function Ct(...kt){if($t){let Mt=$t(...kt);if(!Mt)throw new Error(formatProdErrorMessage$1(0));return{type:xt,payload:Mt.payload,..."meta"in Mt&&{meta:Mt.meta},..."error"in Mt&&{error:Mt.error}}}return{type:xt,payload:kt[0]}}return Ct.toString=()=>`${xt}`,Ct.type=xt,Ct.match=kt=>isAction$1(kt)&&kt.type===xt,Ct}var Tuple=class ru extends Array{constructor(...$t){super(...$t),Object.setPrototypeOf(this,ru.prototype)}static get[Symbol.species](){return ru}concat(...$t){return super.concat.apply(this,$t)}prepend(...$t){return $t.length===1&&Array.isArray($t[0])?new ru(...$t[0].concat(this)):new ru(...$t.concat(this))}};function freezeDraftable$1(xt){return isDraftable(xt)?produce(xt,()=>{}):xt}function emplace(xt,$t,Ct){if(xt.has($t)){let Mt=xt.get($t);return Ct.update&&(Mt=Ct.update(Mt,$t,xt),xt.set($t,Mt)),Mt}if(!Ct.insert)throw new Error(formatProdErrorMessage$1(10));const kt=Ct.insert($t,xt);return xt.set($t,kt),kt}function isBoolean$5(xt){return typeof xt=="boolean"}var buildGetDefaultMiddleware=()=>function($t){const{thunk:Ct=!0,immutableCheck:kt=!0,serializableCheck:Mt=!0,actionCreatorCheck:Ft=!0}=$t??{};let jt=new Tuple;return Ct&&(isBoolean$5(Ct)?jt.push(thunk$1):jt.push(withExtraArgument(Ct.extraArgument))),jt},SHOULD_AUTOBATCH="RTK_autoBatch",createQueueWithTimer=xt=>$t=>{setTimeout($t,xt)},rAF=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:createQueueWithTimer(10),autoBatchEnhancer=(xt={type:"raf"})=>$t=>(...Ct)=>{const kt=$t(...Ct);let Mt=!0,Ft=!1,jt=!1;const Bt=new Set,Vt=xt.type==="tick"?queueMicrotask:xt.type==="raf"?rAF:xt.type==="callback"?xt.queueNotification:createQueueWithTimer(xt.timeout),zt=()=>{jt=!1,Ft&&(Ft=!1,Bt.forEach(Ht=>Ht()))};return Object.assign({},kt,{subscribe(Ht){const Gt=()=>Mt&&Ht(),qt=kt.subscribe(Gt);return Bt.add(Ht),()=>{qt(),Bt.delete(Ht)}},dispatch(Ht){var Gt;try{return Mt=!((Gt=Ht==null?void 0:Ht.meta)!=null&&Gt[SHOULD_AUTOBATCH]),Ft=!Mt,Ft&&(jt||(jt=!0,Vt(zt))),kt.dispatch(Ht)}finally{Mt=!0}}})},buildGetDefaultEnhancers=xt=>function(Ct){const{autoBatch:kt=!0}=Ct??{};let Mt=new Tuple(xt);return kt&&Mt.push(autoBatchEnhancer(typeof kt=="object"?kt:void 0)),Mt},IS_PRODUCTION$1=!0;function configureStore$1(xt){const $t=buildGetDefaultMiddleware(),{reducer:Ct=void 0,middleware:kt,devTools:Mt=!0,preloadedState:Ft=void 0,enhancers:jt=void 0}=xt||{};let Bt;if(typeof Ct=="function")Bt=Ct;else if(isPlainObject$3(Ct))Bt=combineReducers$1(Ct);else throw new Error(formatProdErrorMessage$1(1));let Vt;typeof kt=="function"?Vt=kt($t):Vt=$t();let zt=compose$2;Mt&&(zt=composeWithDevTools$1({trace:!IS_PRODUCTION$1,...typeof Mt=="object"&&Mt}));const Ht=applyMiddleware$1(...Vt),Gt=buildGetDefaultEnhancers(Ht);let qt=typeof jt=="function"?jt(Gt):Gt();const Wt=zt(...qt);return createStore$1(Bt,Ft,Wt)}function executeReducerBuilderCallback$1(xt){const $t={},Ct=[];let kt;const Mt={addCase(Ft,jt){const Bt=typeof Ft=="string"?Ft:Ft.type;if(!Bt)throw new Error(formatProdErrorMessage$1(28));if(Bt in $t)throw new Error(formatProdErrorMessage$1(29));return $t[Bt]=jt,Mt},addMatcher(Ft,jt){return Ct.push({matcher:Ft,reducer:jt}),Mt},addDefaultCase(Ft){return kt=Ft,Mt}};return xt(Mt),[$t,Ct,kt]}function isStateFunction$1(xt){return typeof xt=="function"}function createReducer$1(xt,$t){let[Ct,kt,Mt]=executeReducerBuilderCallback$1($t),Ft;if(isStateFunction$1(xt))Ft=()=>freezeDraftable$1(xt());else{const Bt=freezeDraftable$1(xt);Ft=()=>Bt}function jt(Bt=Ft(),Vt){let zt=[Ct[Vt.type],...kt.filter(({matcher:Ht})=>Ht(Vt)).map(({reducer:Ht})=>Ht)];return zt.filter(Ht=>!!Ht).length===0&&(zt=[Mt]),zt.reduce((Ht,Gt)=>{if(Gt)if(isDraft(Ht)){const Wt=Gt(Ht,Vt);return Wt===void 0?Ht:Wt}else{if(isDraftable(Ht))return produce(Ht,qt=>Gt(qt,Vt));{const qt=Gt(Ht,Vt);if(qt===void 0){if(Ht===null)return Ht;throw new Error(formatProdErrorMessage$1(9))}return qt}}return Ht},Bt)}return jt.getInitialState=Ft,jt}var urlAlphabet$1="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",nanoid$1=(xt=21)=>{let $t="",Ct=xt;for(;Ct--;)$t+=urlAlphabet$1[Math.random()*64|0];return $t},asyncThunkSymbol=Symbol.for("rtk-slice-createasyncthunk");function getType(xt,$t){return`${xt}/${$t}`}function buildCreateSlice({creators:xt}={}){var Ct;const $t=(Ct=xt==null?void 0:xt.asyncThunk)==null?void 0:Ct[asyncThunkSymbol];return function(Mt){const{name:Ft,reducerPath:jt=Ft}=Mt;if(!Ft)throw new Error(formatProdErrorMessage$1(11));typeof process<"u";const Bt=(typeof Mt.reducers=="function"?Mt.reducers(buildReducerCreators()):Mt.reducers)||{},Vt=Object.keys(Bt),zt={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},Ht={addCase(Zt,sn){const ln=typeof Zt=="string"?Zt:Zt.type;if(!ln)throw new Error(formatProdErrorMessage$1(12));if(ln in zt.sliceCaseReducersByType)throw new Error(formatProdErrorMessage$1(13));return zt.sliceCaseReducersByType[ln]=sn,Ht},addMatcher(Zt,sn){return zt.sliceMatchers.push({matcher:Zt,reducer:sn}),Ht},exposeAction(Zt,sn){return zt.actionCreators[Zt]=sn,Ht},exposeCaseReducer(Zt,sn){return zt.sliceCaseReducersByName[Zt]=sn,Ht}};Vt.forEach(Zt=>{const sn=Bt[Zt],ln={reducerName:Zt,type:getType(Ft,Zt),createNotation:typeof Mt.reducers=="function"};isAsyncThunkSliceReducerDefinition(sn)?handleThunkCaseReducerDefinition(ln,sn,Ht,$t):handleNormalReducerDefinition(ln,sn,Ht)});function Gt(){const[Zt={},sn=[],ln=void 0]=typeof Mt.extraReducers=="function"?executeReducerBuilderCallback$1(Mt.extraReducers):[Mt.extraReducers],dn={...Zt,...zt.sliceCaseReducersByType};return createReducer$1(Mt.initialState,hn=>{for(let cn in dn)hn.addCase(cn,dn[cn]);for(let cn of zt.sliceMatchers)hn.addMatcher(cn.matcher,cn.reducer);for(let cn of sn)hn.addMatcher(cn.matcher,cn.reducer);ln&&hn.addDefaultCase(ln)})}const qt=Zt=>Zt,Wt=new Map;let Yt;function Kt(Zt,sn){return Yt||(Yt=Gt()),Yt(Zt,sn)}function Xt(){return Yt||(Yt=Gt()),Yt.getInitialState()}function Qt(Zt,sn=!1){function ln(hn){let cn=hn[Zt];return typeof cn>"u"&&sn&&(cn=Xt()),cn}function dn(hn=qt){const cn=emplace(Wt,sn,{insert:()=>new WeakMap});return emplace(cn,hn,{insert:()=>{const pn={};for(const[yn,gn]of Object.entries(Mt.selectors??{}))pn[yn]=wrapSelector(gn,hn,Xt,sn);return pn}})}return{reducerPath:Zt,getSelectors:dn,get selectors(){return dn(ln)},selectSlice:ln}}const Jt={name:Ft,reducer:Kt,actions:zt.actionCreators,caseReducers:zt.sliceCaseReducersByName,getInitialState:Xt,...Qt(jt),injectInto(Zt,{reducerPath:sn,...ln}={}){const dn=sn??jt;return Zt.inject({reducerPath:dn,reducer:Kt},ln),{...Jt,...Qt(dn,!0)}}};return Jt}}function wrapSelector(xt,$t,Ct,kt){function Mt(Ft,...jt){let Bt=$t(Ft);return typeof Bt>"u"&&kt&&(Bt=Ct()),xt(Bt,...jt)}return Mt.unwrapped=xt,Mt}var createSlice$1=buildCreateSlice();function buildReducerCreators(){function xt($t,Ct){return{_reducerDefinitionType:"asyncThunk",payloadCreator:$t,...Ct}}return xt.withTypes=()=>xt,{reducer($t){return Object.assign({[$t.name](...Ct){return $t(...Ct)}}[$t.name],{_reducerDefinitionType:"reducer"})},preparedReducer($t,Ct){return{_reducerDefinitionType:"reducerWithPrepare",prepare:$t,reducer:Ct}},asyncThunk:xt}}function handleNormalReducerDefinition({type:xt,reducerName:$t,createNotation:Ct},kt,Mt){let Ft,jt;if("reducer"in kt){if(Ct&&!isCaseReducerWithPrepareDefinition(kt))throw new Error(formatProdErrorMessage$1(17));Ft=kt.reducer,jt=kt.prepare}else Ft=kt;Mt.addCase(xt,Ft).exposeCaseReducer($t,Ft).exposeAction($t,jt?createAction$1(xt,jt):createAction$1(xt))}function isAsyncThunkSliceReducerDefinition(xt){return xt._reducerDefinitionType==="asyncThunk"}function isCaseReducerWithPrepareDefinition(xt){return xt._reducerDefinitionType==="reducerWithPrepare"}function handleThunkCaseReducerDefinition({type:xt,reducerName:$t},Ct,kt,Mt){if(!Mt)throw new Error(formatProdErrorMessage$1(18));const{payloadCreator:Ft,fulfilled:jt,pending:Bt,rejected:Vt,settled:zt,options:Ht}=Ct,Gt=Mt(xt,Ft,Ht);kt.exposeAction($t,Gt),jt&&kt.addCase(Gt.fulfilled,jt),Bt&&kt.addCase(Gt.pending,Bt),Vt&&kt.addCase(Gt.rejected,Vt),zt&&kt.addMatcher(Gt.settled,zt),kt.exposeCaseReducer($t,{fulfilled:jt||noop$8,pending:Bt||noop$8,rejected:Vt||noop$8,settled:zt||noop$8})}function noop$8(){}var assertFunction$1=(xt,$t)=>{if(typeof xt!="function")throw new Error(formatProdErrorMessage$1(32))},alm$1="listenerMiddleware",getListenerEntryPropsFrom$1=xt=>{let{type:$t,actionCreator:Ct,matcher:kt,predicate:Mt,effect:Ft}=xt;if($t)Mt=createAction$1($t).match;else if(Ct)$t=Ct.type,Mt=Ct.match;else if(kt)Mt=kt;else if(!Mt)throw new Error(formatProdErrorMessage$1(21));return assertFunction$1(Ft),{predicate:Mt,type:$t,effect:Ft}},createListenerEntry$1=Object.assign(xt=>{const{type:$t,predicate:Ct,effect:kt}=getListenerEntryPropsFrom$1(xt);return{id:nanoid$1(),effect:kt,type:$t,predicate:Ct,pending:new Set,unsubscribe:()=>{throw new Error(formatProdErrorMessage$1(22))}}},{withTypes:()=>createListenerEntry$1}),addListener$1=Object.assign(createAction$1(`${alm$1}/add`),{withTypes:()=>addListener$1});createAction$1(`${alm$1}/removeAll`);var removeListener$1=Object.assign(createAction$1(`${alm$1}/remove`),{withTypes:()=>removeListener$1});function formatProdErrorMessage$1(xt){return`Minified Redux Toolkit error #${xt}; visit https://redux-toolkit.js.org/Errors?code=${xt} for the full message or use the non-minified dev environment for full errors. `}function getSequenceFlatMap(xt){return xt.components.flatMap($t=>typeof $t=="string"?$t:getSequenceFlatMap($t))}function getSequenceFlatMapWithInterruptions(xt){var $t;return[...xt.components.flatMap(Ct=>typeof Ct=="string"?Ct:getSequenceFlatMapWithInterruptions(Ct)),...(($t=xt.interruptions)==null?void 0:$t.flatMap(Ct=>Ct.components))||[]]}function _findBlockForStep(xt,$t,Ct){let kt=0;for(let Mt=0;Mt<xt.components.length;Mt+=1){const Ft=xt.components[Mt];if(typeof Ft=="string"){if(typeof $t=="number"&&$t===Ct+kt)return[{currentBlock:xt,firstIndex:Ct,lastIndex:Ct+getSequenceFlatMap(xt).length-1}];if(typeof $t=="string"&&xt.orderPath===$t)return[{currentBlock:xt,firstIndex:Ct,lastIndex:Ct+getSequenceFlatMap(xt).length-1}];kt+=1}else{const jt=_findBlockForStep(Ft,$t,Ct+kt);if(typeof jt=="number")kt+=jt;else{const Bt={currentBlock:xt,firstIndex:Ct,lastIndex:jt[0].lastIndex};return[...jt,Bt]}}}return kt}function findBlockForStep(xt,$t){const Ct=_findBlockForStep(xt,$t,0);return typeof Ct=="number"?null:Ct}function _findIndexOfBlock(xt,$t,Ct){if(xt.id===$t)return{found:!0,distance:Ct};let kt=0;for(let Mt=0;Mt<xt.components.length;Mt+=1){const Ft=xt.components[Mt];if(typeof Ft=="string")kt+=1;else{const jt=_findIndexOfBlock(Ft,$t,Ct+kt);if(jt.found)return jt;kt+=jt.distance}}return{found:!1,distance:kt}}function findIndexOfBlock(xt,$t){const Ct=_findIndexOfBlock(xt,$t,0);return Ct.found?Ct.distance:-1}function configSequenceToUniqueTrials(xt,$t="root"){const Ct=[],kt={};return xt.components.forEach((Mt,Ft)=>{typeof Mt=="string"?(Ct.push({componentName:Mt,orderPath:$t,timesSeenInBlock:kt[Mt]||0}),kt[Mt]=kt[Mt]?kt[Mt]+1:1):Ct.push(...configSequenceToUniqueTrials(Mt,`${$t}-${Ft}`))}),Ct}async function studyStoreCreator(xt,$t,Ct,kt,Mt){const Ft=getSequenceFlatMap(Ct),jt=Object.fromEntries(Ft.filter(qt=>qt!=="end").map((qt,Wt)=>[`${qt}_${Wt}`,{answer:{}}])),Bt=Object.assign({},...Ft.map((qt,Wt)=>({[`${qt}_${Wt}`]:{aboveStimulus:{valid:!1,values:{}},belowStimulus:{valid:!1,values:{}},sidebar:{valid:!1,values:{}}}}))),Vt=Object.assign({},...Ft.map((qt,Wt)=>({[`${qt}_${Wt}`]:{aboveStimulus:!0,belowStimulus:!0,sidebar:!0,values:{}}}))),zt={studyId:xt,answers:Object.keys(Mt).length>0?Mt:jt,sequence:Ct,config:$t,showStudyBrowser:!0,showHelpText:!1,alertModal:{show:!1,message:""},trialValidation:Mt?Vt:Bt,iframeAnswers:{},iframeProvenance:null,metadata:kt},Ht=createSlice$1({name:"storeSlice",initialState:zt,reducers:{setConfig(qt,Wt){qt.config=Wt.payload},toggleStudyBrowser:qt=>{qt.showStudyBrowser=!qt.showStudyBrowser},toggleShowHelpText:qt=>{qt.showHelpText=!qt.showHelpText},setAlertModal:(qt,Wt)=>{qt.alertModal=Wt.payload},setIframeAnswers:(qt,Wt)=>{qt.iframeAnswers=Wt.payload},setIframeProvenance:(qt,Wt)=>{qt.iframeProvenance=Wt.payload},updateResponseBlockValidation:(qt,{payload:Wt})=>{qt.trialValidation[Wt.identifier]||(qt.trialValidation[Wt.identifier]={aboveStimulus:{valid:!1,values:{}},belowStimulus:{valid:!1,values:{}},sidebar:{valid:!1,values:{}},provenanceGraph:void 0}),qt.trialValidation[Wt.identifier][Wt.location]={valid:Wt.status,values:Wt.values},Wt.provenanceGraph&&(qt.trialValidation[Wt.identifier].provenanceGraph=Wt.provenanceGraph)},saveTrialAnswer(qt,{payload:Wt}){const{identifier:Yt,answer:Kt,startTime:Xt,endTime:Qt,provenanceGraph:Jt,windowEvents:Zt}=Wt;qt.answers[Yt]={answer:Kt,startTime:Xt,endTime:Qt,provenanceGraph:Jt,windowEvents:Zt}}}});return{store:configureStore$1({reducer:Ht.reducer,preloadedState:zt}),actions:Ht.actions}}const StudyStoreContext=reactExports.createContext(null);function useStoreActions(){return reactExports.useContext(StudyStoreContext).actions}const useStoreDispatch=useDispatch,useStoreSelector=useSelector;function useAreResponsesValid(xt){return useStoreSelector($t=>{if(xt.includes("reviewer-"))return!0;const Ct=Object.values($t.trialValidation[xt]).every(kt=>typeof kt=="object"&&"valid"in kt?kt.valid:!0);return Ct?Object.values(Ct).every(kt=>kt):!1})}function useFlatSequence(){return useStoreSelector(xt=>getSequenceFlatMap(xt.sequence))}function useStudyId(){const{studyId:xt}=useParams();return`${xt}`}function useCurrentStep(){const{index:xt}=useParams(),$t=parseInt(xt||"0",10);return Number.isNaN($t)?xt:$t}function useCurrentComponent(){const xt=useCurrentStep(),$t=useFlatSequence();return typeof xt=="number"?$t[xt]:xt.replace("reviewer-","")}var lodash_merge={exports:{}};lodash_merge.exports;(function(xt,$t){var Ct=200,kt="__lodash_hash_undefined__",Mt=800,Ft=16,jt=9007199254740991,Bt="[object Arguments]",Vt="[object Array]",zt="[object AsyncFunction]",Ht="[object Boolean]",Gt="[object Date]",qt="[object Error]",Wt="[object Function]",Yt="[object GeneratorFunction]",Kt="[object Map]",Xt="[object Number]",Qt="[object Null]",Jt="[object Object]",Zt="[object Proxy]",sn="[object RegExp]",ln="[object Set]",dn="[object String]",hn="[object Undefined]",cn="[object WeakMap]",pn="[object ArrayBuffer]",yn="[object DataView]",gn="[object Float32Array]",En="[object Float64Array]",bn="[object Int8Array]",xn="[object Int16Array]",Cn="[object Int32Array]",$n="[object Uint8Array]",wn="[object Uint8ClampedArray]",Rn="[object Uint16Array]",Dn="[object Uint32Array]",An=/[\\^$.*+?()[\]{}|]/g,Sn=/^\[object .+?Constructor\]$/,vn=/^(?:0|[1-9]\d*)$/,_n={};_n[gn]=_n[En]=_n[bn]=_n[xn]=_n[Cn]=_n[$n]=_n[wn]=_n[Rn]=_n[Dn]=!0,_n[Bt]=_n[Vt]=_n[pn]=_n[Ht]=_n[yn]=_n[Gt]=_n[qt]=_n[Wt]=_n[Kt]=_n[Xt]=_n[Jt]=_n[sn]=_n[ln]=_n[dn]=_n[cn]=!1;var Tn=typeof commonjsGlobal$2=="object"&&commonjsGlobal$2&&commonjsGlobal$2.Object===Object&&commonjsGlobal$2,Pn=typeof self=="object"&&self&&self.Object===Object&&self,Ln=Tn||Pn||Function("return this")(),Vn=$t&&!$t.nodeType&&$t,Un=Vn&&!0&&xt&&!xt.nodeType&&xt,Wn=Un&&Un.exports===Vn,rr=Wn&&Tn.process,ar=function(){try{var Mn=Un&&Un.require&&Un.require("util").types;return Mn||rr&&rr.binding&&rr.binding("util")}catch{}}(),nr=ar&&ar.isTypedArray;function mr(Mn,zn,er){switch(er.length){case 0:return Mn.call(zn);case 1:return Mn.call(zn,er[0]);case 2:return Mn.call(zn,er[0],er[1]);case 3:return Mn.call(zn,er[0],er[1],er[2])}return Mn.apply(zn,er)}function kn(Mn,zn){for(var er=-1,Nr=Array(Mn);++er<Mn;)Nr[er]=zn(er);return Nr}function Fn(Mn){return function(zn){return Mn(zn)}}function Hn(Mn,zn){return Mn==null?void 0:Mn[zn]}function Bn(Mn,zn){return function(er){return Mn(zn(er))}}var jn=Array.prototype,sr=Function.prototype,Ar=Object.prototype,Fr=Ln["__core-js_shared__"],Rr=sr.toString,Qn=Ar.hasOwnProperty,jr=function(){var Mn=/[^.]+$/.exec(Fr&&Fr.keys&&Fr.keys.IE_PROTO||"");return Mn?"Symbol(src)_1."+Mn:""}(),Mr=Ar.toString,pr=Rr.call(Object),Tr=RegExp("^"+Rr.call(Qn).replace(An,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Hr=Wn?Ln.Buffer:void 0,Xr=Ln.Symbol,Zr=Ln.Uint8Array;Hr&&Hr.allocUnsafe;var ur=Bn(Object.getPrototypeOf,Object),hr=Object.create,gr=Ar.propertyIsEnumerable,qr=jn.splice,ds=Xr?Xr.toStringTag:void 0,ms=function(){try{var Mn=ls(Object,"defineProperty");return Mn({},"",{}),Mn}catch{}}(),wr=Hr?Hr.isBuffer:void 0,Wr=Math.max,ns=Date.now,us=ls(Ln,"Map"),ps=ls(Object,"create"),Ls=function(){function Mn(){}return function(zn){if(!Al(zn))return{};if(hr)return hr(zn);Mn.prototype=zn;var er=new Mn;return Mn.prototype=void 0,er}}();function vs(Mn){var zn=-1,er=Mn==null?0:Mn.length;for(this.clear();++zn<er;){var Nr=Mn[zn];this.set(Nr[0],Nr[1])}}function Ps(){this.__data__=ps?ps(null):{},this.size=0}function Fs(Mn){var zn=this.has(Mn)&&delete this.__data__[Mn];return this.size-=zn?1:0,zn}function zs(Mn){var zn=this.__data__;if(ps){var er=zn[Mn];return er===kt?void 0:er}return Qn.call(zn,Mn)?zn[Mn]:void 0}function Eo(Mn){var zn=this.__data__;return ps?zn[Mn]!==void 0:Qn.call(zn,Mn)}function js(Mn,zn){var er=this.__data__;return this.size+=this.has(Mn)?0:1,er[Mn]=ps&&zn===void 0?kt:zn,this}vs.prototype.clear=Ps,vs.prototype.delete=Fs,vs.prototype.get=zs,vs.prototype.has=Eo,vs.prototype.set=js;function Hs(Mn){var zn=-1,er=Mn==null?0:Mn.length;for(this.clear();++zn<er;){var Nr=Mn[zn];this.set(Nr[0],Nr[1])}}function Us(){this.__data__=[],this.size=0}function Ks(Mn){var zn=this.__data__,er=lo(zn,Mn);if(er<0)return!1;var Nr=zn.length-1;return er==Nr?zn.pop():qr.call(zn,er,1),--this.size,!0}function go(Mn){var zn=this.__data__,er=lo(zn,Mn);return er<0?void 0:zn[er][1]}function vo(Mn){return lo(this.__data__,Mn)>-1}function vr(Mn,zn){var er=this.__data__,Nr=lo(er,Mn);return Nr<0?(++this.size,er.push([Mn,zn])):er[Nr][1]=zn,this}Hs.prototype.clear=Us,Hs.prototype.delete=Ks,Hs.prototype.get=go,Hs.prototype.has=vo,Hs.prototype.set=vr;function lr(Mn){var zn=-1,er=Mn==null?0:Mn.length;for(this.clear();++zn<er;){var Nr=Mn[zn];this.set(Nr[0],Nr[1])}}function $r(){this.size=0,this.__data__={hash:new vs,map:new(us||Hs),string:new vs}}function Gr(Mn){var zn=ss(this,Mn).delete(Mn);return this.size-=zn?1:0,zn}function zr(Mn){return ss(this,Mn).get(Mn)}function fs(Mn){return ss(this,Mn).has(Mn)}function Ts(Mn,zn){var er=ss(this,Mn),Nr=er.size;return er.set(Mn,zn),this.size+=er.size==Nr?0:1,this}lr.prototype.clear=$r,lr.prototype.delete=Gr,lr.prototype.get=zr,lr.prototype.has=fs,lr.prototype.set=Ts;function Bs(Mn){var zn=this.__data__=new Hs(Mn);this.size=zn.size}function Xs(){this.__data__=new Hs,this.size=0}function ro(Mn){var zn=this.__data__,er=zn.delete(Mn);return this.size=zn.size,er}function Ys(Mn){return this.__data__.get(Mn)}function co(Mn){return this.__data__.has(Mn)}function To(Mn,zn){var er=this.__data__;if(er instanceof Hs){var Nr=er.__data__;if(!us||Nr.length<Ct-1)return Nr.push([Mn,zn]),this.size=++er.size,this;er=this.__data__=new lr(Nr)}return er.set(Mn,zn),this.size=er.size,this}Bs.prototype.clear=Xs,Bs.prototype.delete=ro,Bs.prototype.get=Ys,Bs.prototype.has=co,Bs.prototype.set=To;function Vs(Mn,zn){var er=ba(Mn),Nr=!er&&qo(Mn),Vr=!er&&!Nr&&El(Mn),Ur=!er&&!Nr&&!Vr&&qn(Mn),_i=er||Nr||Vr||Ur,Kr=_i?kn(Mn.length,String):[],Qr=Kr.length;for(var $s in Mn)_i&&($s=="length"||Vr&&($s=="offset"||$s=="parent")||Ur&&($s=="buffer"||$s=="byteLength"||$s=="byteOffset")||As($s,Qr))||Kr.push($s);return Kr}function fo(Mn,zn,er){(er!==void 0&&!Zo(Mn[zn],er)||er===void 0&&!(zn in Mn))&&ko(Mn,zn,er)}function $o(Mn,zn,er){var Nr=Mn[zn];(!(Qn.call(Mn,zn)&&Zo(Nr,er))||er===void 0&&!(zn in Mn))&&ko(Mn,zn,er)}function lo(Mn,zn){for(var er=Mn.length;er--;)if(Zo(Mn[er][0],zn))return er;return-1}function ko(Mn,zn,er){zn=="__proto__"&&ms?ms(Mn,zn,{configurable:!0,enumerable:!0,value:er,writable:!0}):Mn[zn]=er}var jo=Jr();function Co(Mn){return Mn==null?Mn===void 0?hn:Qt:ds&&ds in Object(Mn)?cs(Mn):Uo(Mn)}function Go(Mn){return Qo(Mn)&&Co(Mn)==Bt}function Lo(Mn){if(!Al(Mn)||eo(Mn))return!1;var zn=Il(Mn)?Tr:Sn;return zn.test(Bl(Mn))}function Fo(Mn){return Qo(Mn)&&Kl(Mn.length)&&!!_n[Co(Mn)]}function Wo(Mn){if(!Al(Mn))return So(Mn);var zn=xo(Mn),er=[];for(var Nr in Mn)Nr=="constructor"&&(zn||!Qn.call(Mn,Nr))||er.push(Nr);return er}function Ko(Mn,zn,er,Nr,Vr){Mn!==zn&&jo(zn,function(Ur,_i){if(Vr||(Vr=new Bs),Al(Ur))Bo(Mn,zn,_i,er,Ko,Nr,Vr);else{var Kr=Nr?Nr(Sl(Mn,_i),Ur,_i+"",Mn,zn,Vr):void 0;Kr===void 0&&(Kr=Ur),fo(Mn,_i,Kr)}},yr)}function Bo(Mn,zn,er,Nr,Vr,Ur,_i){var Kr=Sl(Mn,er),Qr=Sl(zn,er),$s=_i.get(Qr);if($s){fo(Mn,er,$s);return}var ys=Ur?Ur(Kr,Qr,er+"",Mn,zn,_i):void 0,ws=ys===void 0;if(ws){var Rs=ba(Qr),Es=!Rs&&El(Qr),Ns=!Rs&&!Es&&qn(Qr);ys=Qr,Rs||Es||Ns?ba(Kr)?ys=Kr:Vl(Kr)?ys=kr(Kr):Es?(ws=!1,ys=Jn(Qr)):Ns?(ws=!1,ys=dr(Qr)):ys=[]:Nn(Qr)||qo(Qr)?(ys=Kr,qo(Kr)?ys=fr(Kr):(!Al(Kr)||Il(Kr))&&(ys=hs(Qr))):ws=!1}ws&&(_i.set(Qr,ys),Vr(ys,Qr,Nr,Ur,_i),_i.delete(Qr)),fo(Mn,er,ys)}function Jo(Mn,zn){return yl($a(Mn,zn,Dr),Mn+"")}var ga=ms?function(Mn,zn){return ms(Mn,"toString",{configurable:!0,enumerable:!1,value:Sr(zn),writable:!0})}:Dr;function Jn(Mn,zn){return Mn.slice()}function xr(Mn){var zn=new Mn.constructor(Mn.byteLength);return new Zr(zn).set(new Zr(Mn)),zn}function dr(Mn,zn){var er=xr(Mn.buffer);return new Mn.constructor(er,Mn.byteOffset,Mn.length)}function kr(Mn,zn){var er=-1,Nr=Mn.length;for(zn||(zn=Array(Nr));++er<Nr;)zn[er]=Mn[er];return zn}function Lr(Mn,zn,er,Nr){var Vr=!er;er||(er={});for(var Ur=-1,_i=zn.length;++Ur<_i;){var Kr=zn[Ur],Qr=void 0;Qr===void 0&&(Qr=Mn[Kr]),Vr?ko(er,Kr,Qr):$o(er,Kr,Qr)}return er}function Pr(Mn){return Jo(function(zn,er){var Nr=-1,Vr=er.length,Ur=Vr>1?er[Vr-1]:void 0,_i=Vr>2?er[2]:void 0;for(Ur=Mn.length>3&&typeof Ur=="function"?(Vr--,Ur):void 0,_i&&qs(er[0],er[1],_i)&&(Ur=Vr<3?void 0:Ur,Vr=1),zn=Object(zn);++Nr<Vr;){var Kr=er[Nr];Kr&&Mn(zn,Kr,Nr,Ur)}return zn})}function Jr(Mn){return function(zn,er,Nr){for(var Vr=-1,Ur=Object(zn),_i=Nr(zn),Kr=_i.length;Kr--;){var Qr=_i[++Vr];if(er(Ur[Qr],Qr,Ur)===!1)break}return zn}}function ss(Mn,zn){var er=Mn.__data__;return Os(zn)?er[typeof zn=="string"?"string":"hash"]:er.map}function ls(Mn,zn){var er=Hn(Mn,zn);return Lo(er)?er:void 0}function cs(Mn){var zn=Qn.call(Mn,ds),er=Mn[ds];try{Mn[ds]=void 0;var Nr=!0}catch{}var Vr=Mr.call(Mn);return Nr&&(zn?Mn[ds]=er:delete Mn[ds]),Vr}function hs(Mn){return typeof Mn.constructor=="function"&&!xo(Mn)?Ls(ur(Mn)):{}}function As(Mn,zn){var er=typeof Mn;return zn=zn??jt,!!zn&&(er=="number"||er!="symbol"&&vn.test(Mn))&&Mn>-1&&Mn%1==0&&Mn<zn}function qs(Mn,zn,er){if(!Al(er))return!1;var Nr=typeof zn;return(Nr=="number"?Dl(er)&&As(zn,er.length):Nr=="string"&&zn in er)?Zo(er[zn],Mn):!1}function Os(Mn){var zn=typeof Mn;return zn=="string"||zn=="number"||zn=="symbol"||zn=="boolean"?Mn!=="__proto__":Mn===null}function eo(Mn){return!!jr&&jr in Mn}function xo(Mn){var zn=Mn&&Mn.constructor,er=typeof zn=="function"&&zn.prototype||Ar;return Mn===er}function So(Mn){var zn=[];if(Mn!=null)for(var er in Object(Mn))zn.push(er);return zn}function Uo(Mn){return Mr.call(Mn)}function $a(Mn,zn,er){return zn=Wr(zn===void 0?Mn.length-1:zn,0),function(){for(var Nr=arguments,Vr=-1,Ur=Wr(Nr.length-zn,0),_i=Array(Ur);++Vr<Ur;)_i[Vr]=Nr[zn+Vr];Vr=-1;for(var Kr=Array(zn+1);++Vr<zn;)Kr[Vr]=Nr[Vr];return Kr[zn]=er(_i),mr(Mn,this,Kr)}}function Sl(Mn,zn){if(!(zn==="constructor"&&typeof Mn[zn]=="function")&&zn!="__proto__")return Mn[zn]}var yl=Rl(ga);function Rl(Mn){var zn=0,er=0;return function(){var Nr=ns(),Vr=Ft-(Nr-er);if(er=Nr,Vr>0){if(++zn>=Mt)return arguments[0]}else zn=0;return Mn.apply(void 0,arguments)}}function Bl(Mn){if(Mn!=null){try{return Rr.call(Mn)}catch{}try{return Mn+""}catch{}}return""}function Zo(Mn,zn){return Mn===zn||Mn!==Mn&&zn!==zn}var qo=Go(function(){return arguments}())?Go:function(Mn){return Qo(Mn)&&Qn.call(Mn,"callee")&&!gr.call(Mn,"callee")},ba=Array.isArray;function Dl(Mn){return Mn!=null&&Kl(Mn.length)&&!Il(Mn)}function Vl(Mn){return Qo(Mn)&&Dl(Mn)}var El=wr||Ir;function Il(Mn){if(!Al(Mn))return!1;var zn=Co(Mn);return zn==Wt||zn==Yt||zn==zt||zn==Zt}function Kl(Mn){return typeof Mn=="number"&&Mn>-1&&Mn%1==0&&Mn<=jt}function Al(Mn){var zn=typeof Mn;return Mn!=null&&(zn=="object"||zn=="function")}function Qo(Mn){return Mn!=null&&typeof Mn=="object"}function Nn(Mn){if(!Qo(Mn)||Co(Mn)!=Jt)return!1;var zn=ur(Mn);if(zn===null)return!0;var er=Qn.call(zn,"constructor")&&zn.constructor;return typeof er=="function"&&er instanceof er&&Rr.call(er)==pr}var qn=nr?Fn(nr):Fo;function fr(Mn){return Lr(Mn,yr(Mn))}function yr(Mn){return Dl(Mn)?Vs(Mn):Wo(Mn)}var Er=Pr(function(Mn,zn,er){Ko(Mn,zn,er)});function Sr(Mn){return function(){return Mn}}function Dr(Mn){return Mn}function Ir(){return!1}xt.exports=Er})(lodash_merge,lodash_merge.exports);var lodash_mergeExports=lodash_merge.exports;const merge$5=getDefaultExportFromCjs$1(lodash_mergeExports);function deepCopy(xt){return structuredClone(xt)}function useStoredAnswer(){const{answers:xt}=useStoreSelector(Mt=>Mt),$t=useCurrentStep(),kt=`${useCurrentComponent()}_${$t}`;return xt[kt]}const WindowEventsContext=reactExports.createContext(null);function useWindowEvents(){const xt=reactExports.useContext(WindowEventsContext);if(!xt)throw new Error("useWindowEvents must be used within a WindowEventsProvider");return xt}function useStudyConfig(){return useStoreSelector(xt=>xt.config)}function checkAllAnswersCorrect(xt,$t,Ct,kt){const Mt=$t.slice(0,$t.lastIndexOf("_")),Ft=Object.entries(kt.components).find(([Bt])=>Bt===Mt),jt=Ft?Ft[1]:null;if(!jt)throw new Error(`Component ${Mt} could not be found in the study components.`);return jt.correctAnswer?jt.correctAnswer.every(Bt=>xt[Bt.id]===Bt.answer):!0}function useNextStep(){const xt=useCurrentStep(),$t=useFlatSequence(),kt=`${useCurrentComponent()}_${xt}`,{trialValidation:Mt,sequence:Ft,answers:jt}=useStoreSelector(dn=>dn),Bt=useStoreDispatch(),{saveTrialAnswer:Vt,setIframeAnswers:zt}=useStoreActions(),{storageEngine:Ht}=useStorageEngine(),Gt=useStudyId(),[qt,Wt]=reactExports.useState(!0);reactExports.useEffect(()=>{(async()=>{if(Ht){const hn=await Ht.getModes(Gt);Wt(hn.dataCollectionEnabled)}})()},[Ht,Gt]);const Yt=useAreResponsesValid(kt),Kt=typeof xt!="number"||!Yt,Xt=useStoredAnswer(),Qt=useNavigate(),Jt=useStudyConfig(),Zt=reactExports.useMemo(()=>Date.now(),[]),sn=useWindowEvents(),ln=reactExports.useCallback(()=>{if(typeof xt!="number")return;const dn=deepCopy(Mt[kt]),hn=Object.values(dn).reduce((Cn,$n)=>Object.hasOwn($n,"values")?{...Cn,...$n.values}:Cn,{}),{provenanceGraph:cn}=dn,pn=Date.now(),yn=sn&&"current"in sn&&sn.current?sn.current.splice(0,sn.current.length):[];qt&&!Xt.endTime&&(Bt(Vt({identifier:kt,answer:hn,startTime:Zt,endTime:pn,provenanceGraph:cn,windowEvents:yn})),Ht&&Ht.saveAnswers({...jt,[kt]:{answer:hn,startTime:Zt,endTime:pn,provenanceGraph:cn,windowEvents:yn}}),Bt(zt({})));let gn=xt+1;const En=findBlockForStep(Ft,xt),bn=En!==null&&En.some(Cn=>Object.hasOwn(Cn.currentBlock,"skip")&&Cn.currentBlock.skip!==void 0),xn={...jt,[kt]:{answer:hn,startTime:Zt,endTime:pn,provenanceGraph:cn,windowEvents:yn}};bn&&[...En.flatMap($n=>$n.currentBlock.skip?$n.currentBlock.skip.map(wn=>({...wn,firstIndex:$n.firstIndex,lastIndex:$n.lastIndex})):[])].some($n=>{let wn=!1;const Rn=Object.fromEntries(Object.entries(xn).filter(([An])=>{const Sn=parseInt(An.slice(An.lastIndexOf("_")+1),10);return Sn>=$n.firstIndex&&Sn<=xt})),Dn=$n.check!=="block"?Object.entries(Rn).filter(([An])=>An.slice(0,An.lastIndexOf("_"))===$n.name):Object.entries(Rn);if(Dn.length===0)return!1;if(Dn.some(([An,Sn])=>!Sn))throw new Error(`There are components with missing response objects for the skip condition: ${JSON.stringify($n,null,2)}`);if($n.check==="response"||$n.check==="responses"){const[An,Sn]=Dn[0];$n.check==="response"?wn=$n.value!==Sn.answer[$n.responseId]:wn=!checkAllAnswersCorrect(Sn.answer,An,Jt.components[An.slice(0,An.lastIndexOf("_"))],Jt)}else if($n.check==="block"||$n.check==="repeatedComponent"){if(Dn.length<$n.value)return!1;const An=Dn.map(([_n,Tn])=>checkAllAnswersCorrect(Tn.answer,_n,Jt.components[_n.slice(0,_n.lastIndexOf("_"))],Jt)),Sn=An.filter(_n=>_n).length,vn=An.length-Sn;wn=$n.condition==="numCorrect"&&Sn===$n.value||$n.condition==="numIncorrect"&&vn===$n.value}if(wn){const An=$t.indexOf($n.to),Sn=An===-1?findIndexOfBlock(Ft,$n.to):-1;return gn=An===-1?Sn:An,!0}return!1}),Qt(`/${Gt}/${gn}${window.location.search}`)},[Mt,kt,sn,Xt,xt,Ft,jt,Zt,Qt,Gt,Bt,Vt,Ht,zt,Jt,$t]);return{isNextDisabled:Kt,goToNextStep:ln}}function NextButton({label:xt="Next",disabled:$t=!1,setCheckClicked:Ct=()=>{},onClick:kt}){const{isNextDisabled:Mt,goToNextStep:Ft}=useNextStep(),jt=reactExports.useCallback(()=>{Ct(!1),kt&&kt(),Ft()},[Ft,kt,Ct]);return jsxRuntimeExports.jsx(Button,{type:"submit",disabled:$t||Mt,onClick:jt,children:xt})}function validateFormName(xt){if(!/^[0-9a-zA-Z-]+$/.test(xt))throw new Error(`[@mantine/use-form] Form name "${xt}" is invalid, it should contain only letters, numbers and dashes`)}const useIsomorphicEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function useFormEvent(xt,$t){useIsomorphicEffect(()=>{if(xt)return window.addEventListener(xt,$t),()=>window.removeEventListener(xt,$t)},[xt])}function useFormActions(xt,$t){xt&&validateFormName(xt),useFormEvent(`mantine-form:${xt}:set-field-value`,Ct=>$t.setFieldValue(Ct.detail.path,Ct.detail.value)),useFormEvent(`mantine-form:${xt}:set-values`,Ct=>$t.setValues(Ct.detail)),useFormEvent(`mantine-form:${xt}:set-initial-values`,Ct=>$t.setInitialValues(Ct.detail)),useFormEvent(`mantine-form:${xt}:set-errors`,Ct=>$t.setErrors(Ct.detail)),useFormEvent(`mantine-form:${xt}:set-field-error`,Ct=>$t.setFieldError(Ct.detail.path,Ct.detail.error)),useFormEvent(`mantine-form:${xt}:clear-field-error`,Ct=>$t.clearFieldError(Ct.detail)),useFormEvent(`mantine-form:${xt}:clear-errors`,$t.clearErrors),useFormEvent(`mantine-form:${xt}:reset`,$t.reset),useFormEvent(`mantine-form:${xt}:validate`,$t.validate),useFormEvent(`mantine-form:${xt}:validate-field`,Ct=>$t.validateField(Ct.detail)),useFormEvent(`mantine-form:${xt}:reorder-list-item`,Ct=>$t.reorderListItem(Ct.detail.path,Ct.detail.payload)),useFormEvent(`mantine-form:${xt}:remove-list-item`,Ct=>$t.removeListItem(Ct.detail.path,Ct.detail.index)),useFormEvent(`mantine-form:${xt}:insert-list-item`,Ct=>$t.insertListItem(Ct.detail.path,Ct.detail.item,Ct.detail.index)),useFormEvent(`mantine-form:${xt}:set-dirty`,Ct=>$t.setDirty(Ct.detail)),useFormEvent(`mantine-form:${xt}:set-touched`,Ct=>$t.setTouched(Ct.detail)),useFormEvent(`mantine-form:${xt}:reset-dirty`,Ct=>$t.resetDirty(Ct.detail)),useFormEvent(`mantine-form:${xt}:reset-touched`,$t.resetTouched)}function getInputOnChange(xt){return $t=>{if(!$t)xt($t);else if(typeof $t=="function")xt($t);else if(typeof $t=="object"&&"nativeEvent"in $t){const{currentTarget:Ct}=$t;Ct instanceof HTMLInputElement?Ct.type==="checkbox"?xt(Ct.checked):xt(Ct.value):(Ct instanceof HTMLTextAreaElement||Ct instanceof HTMLSelectElement)&&xt(Ct.value)}else xt($t)}}function filterErrors(xt){return xt===null||typeof xt!="object"?{}:Object.keys(xt).reduce(($t,Ct)=>{const kt=xt[Ct];return kt!=null&&kt!==!1&&($t[Ct]=kt),$t},{})}function useFormErrors(xt){const[$t,Ct]=reactExports.useState(filterErrors(xt)),kt=reactExports.useRef($t),Mt=reactExports.useCallback(Vt=>{Ct(zt=>{const Ht=filterErrors(typeof Vt=="function"?Vt(zt):Vt);return kt.current=Ht,Ht})},[]),Ft=reactExports.useCallback(()=>Mt({}),[]),jt=reactExports.useCallback(Vt=>{kt.current[Vt]!==void 0&&Mt(zt=>{const Ht={...zt};return delete Ht[Vt],Ht})},[$t]),Bt=reactExports.useCallback((Vt,zt)=>{zt==null||zt===!1?jt(Vt):kt.current[Vt]!==zt&&Mt(Ht=>({...Ht,[Vt]:zt}))},[$t]);return{errorsState:$t,setErrors:Mt,clearErrors:Ft,setFieldError:Bt,clearFieldError:jt}}function clearListState(xt,$t){if($t===null||typeof $t!="object")return{};const Ct={...$t};return Object.keys($t).forEach(kt=>{kt.includes(`${String(xt)}.`)&&delete Ct[kt]}),Ct}function getIndexFromKeyAfterPath(xt,$t){const Ct=xt.substring($t.length+1).split(".")[0];return parseInt(Ct,10)}function changeErrorIndices(xt,$t,Ct,kt){if($t===void 0)return Ct;const Mt=`${String(xt)}`;let Ft=Ct;kt===-1&&(Ft=clearListState(`${Mt}.${$t}`,Ft));const jt={...Ft},Bt=new Set;return Object.entries(Ft).filter(([Vt])=>{if(!Vt.startsWith(`${Mt}.`))return!1;const zt=getIndexFromKeyAfterPath(Vt,Mt);return Number.isNaN(zt)?!1:zt>=$t}).forEach(([Vt,zt])=>{const Ht=getIndexFromKeyAfterPath(Vt,Mt),Gt=Vt.replace(`${Mt}.${Ht}`,`${Mt}.${Ht+kt}`);jt[Gt]=zt,Bt.add(Gt),Bt.has(Vt)||delete jt[Vt]}),jt}function reorderErrors(xt,{from:$t,to:Ct},kt){const Mt=`${xt}.${$t}`,Ft=`${xt}.${Ct}`,jt={...kt};return Object.keys(kt).every(Bt=>{let Vt,zt;if(Bt.startsWith(Mt)&&(Vt=Bt,zt=Bt.replace(Mt,Ft)),Bt.startsWith(Ft)&&(Vt=Bt.replace(Ft,Mt),zt=Bt),Vt&&zt){const Ht=jt[Vt],Gt=jt[zt];return Gt===void 0?delete jt[Vt]:jt[Vt]=Gt,Ht===void 0?delete jt[zt]:jt[zt]=Ht,!1}return!0}),jt}function set$7(xt,$t,Ct){typeof Ct.value=="object"&&(Ct.value=klona(Ct.value)),!Ct.enumerable||Ct.get||Ct.set||!Ct.configurable||!Ct.writable||$t==="__proto__"?Object.defineProperty(xt,$t,Ct):xt[$t]=Ct.value}function klona(xt){if(typeof xt!="object")return xt;var $t=0,Ct,kt,Mt,Ft=Object.prototype.toString.call(xt);if(Ft==="[object Object]"?Mt=Object.create(xt.__proto__||null):Ft==="[object Array]"?Mt=Array(xt.length):Ft==="[object Set]"?(Mt=new Set,xt.forEach(function(jt){Mt.add(klona(jt))})):Ft==="[object Map]"?(Mt=new Map,xt.forEach(function(jt,Bt){Mt.set(klona(Bt),klona(jt))})):Ft==="[object Date]"?Mt=new Date(+xt):Ft==="[object RegExp]"?Mt=new RegExp(xt.source,xt.flags):Ft==="[object DataView]"?Mt=new xt.constructor(klona(xt.buffer)):Ft==="[object ArrayBuffer]"?Mt=xt.slice(0):Ft.slice(-6)==="Array]"&&(Mt=new xt.constructor(xt)),Mt){for(kt=Object.getOwnPropertySymbols(xt);$t<kt.length;$t++)set$7(Mt,kt[$t],Object.getOwnPropertyDescriptor(xt,kt[$t]));for($t=0,kt=Object.getOwnPropertyNames(xt);$t<kt.length;$t++)Object.hasOwnProperty.call(Mt,Ct=kt[$t])&&Mt[Ct]===xt[Ct]||set$7(Mt,Ct,Object.getOwnPropertyDescriptor(xt,Ct))}return Mt||xt}function getSplittedPath(xt){return typeof xt!="string"?[]:xt.split(".")}function getPath(xt,$t){const Ct=getSplittedPath(xt);if(Ct.length===0||typeof $t!="object"||$t===null)return;let kt=$t[Ct[0]];for(let Mt=1;Mt<Ct.length&&kt!==void 0;Mt+=1)kt=kt[Ct[Mt]];return kt}function setPath(xt,$t,Ct){const kt=getSplittedPath(xt);if(kt.length===0)return Ct;const Mt=klona(Ct);if(kt.length===1)return Mt[kt[0]]=$t,Mt;let Ft=Mt[kt[0]];for(let jt=1;jt<kt.length-1;jt+=1){if(Ft===void 0)return Mt;Ft=Ft[kt[jt]]}return Ft[kt[kt.length-1]]=$t,Mt}function reorderPath(xt,{from:$t,to:Ct},kt){const Mt=getPath(xt,kt);if(!Array.isArray(Mt))return kt;const Ft=[...Mt],jt=Mt[$t];return Ft.splice($t,1),Ft.splice(Ct,0,jt),setPath(xt,Ft,kt)}function insertPath(xt,$t,Ct,kt){const Mt=getPath(xt,kt);if(!Array.isArray(Mt))return kt;const Ft=[...Mt];return Ft.splice(typeof Ct=="number"?Ct:Ft.length,0,$t),setPath(xt,Ft,kt)}function removePath(xt,$t,Ct){const kt=getPath(xt,Ct);return Array.isArray(kt)?setPath(xt,kt.filter((Mt,Ft)=>Ft!==$t),Ct):Ct}function useFormList({$values:xt,$errors:$t,$status:Ct}){const kt=reactExports.useCallback((jt,Bt)=>{Ct.clearFieldDirty(jt),$t.setErrors(Vt=>reorderErrors(jt,Bt,Vt)),xt.setValues({values:reorderPath(jt,Bt,xt.refValues.current),updateState:!0})},[]),Mt=reactExports.useCallback((jt,Bt)=>{Ct.clearFieldDirty(jt),$t.setErrors(Vt=>changeErrorIndices(jt,Bt,Vt,-1)),xt.setValues({values:removePath(jt,Bt,xt.refValues.current),updateState:!0})},[]),Ft=reactExports.useCallback((jt,Bt,Vt)=>{Ct.clearFieldDirty(jt),$t.setErrors(zt=>changeErrorIndices(jt,Vt,zt,1)),xt.setValues({values:insertPath(jt,Bt,Vt,xt.refValues.current),updateState:!0})},[]);return{reorderListItem:kt,removeListItem:Mt,insertListItem:Ft}}var fastDeepEqual=function xt($t,Ct){if($t===Ct)return!0;if($t&&Ct&&typeof $t=="object"&&typeof Ct=="object"){if($t.constructor!==Ct.constructor)return!1;var kt,Mt,Ft;if(Array.isArray($t)){if(kt=$t.length,kt!=Ct.length)return!1;for(Mt=kt;Mt--!==0;)if(!xt($t[Mt],Ct[Mt]))return!1;return!0}if($t.constructor===RegExp)return $t.source===Ct.source&&$t.flags===Ct.flags;if($t.valueOf!==Object.prototype.valueOf)return $t.valueOf()===Ct.valueOf();if($t.toString!==Object.prototype.toString)return $t.toString()===Ct.toString();if(Ft=Object.keys($t),kt=Ft.length,kt!==Object.keys(Ct).length)return!1;for(Mt=kt;Mt--!==0;)if(!Object.prototype.hasOwnProperty.call(Ct,Ft[Mt]))return!1;for(Mt=kt;Mt--!==0;){var jt=Ft[Mt];if(!xt($t[jt],Ct[jt]))return!1}return!0}return $t!==$t&&Ct!==Ct};const equal$5=getDefaultExportFromCjs$1(fastDeepEqual);function getStatus(xt,$t){const Ct=Object.keys(xt);if(typeof $t=="string"){const kt=Ct.filter(Mt=>Mt.startsWith(`${$t}.`));return xt[$t]||kt.some(Mt=>xt[Mt])||!1}return Ct.some(kt=>xt[kt])}function useFormStatus({initialDirty:xt,initialTouched:$t,mode:Ct,$values:kt}){const[Mt,Ft]=reactExports.useState($t),[jt,Bt]=reactExports.useState(xt),Vt=reactExports.useRef($t),zt=reactExports.useRef(xt),Ht=reactExports.useCallback(ln=>{const dn=typeof ln=="function"?ln(Vt.current):ln;Vt.current=dn,Ct==="controlled"&&Ft(dn)},[]),Gt=reactExports.useCallback(ln=>{const dn=typeof ln=="function"?ln(zt.current):ln;zt.current=dn,Ct==="controlled"&&Bt(dn)},[]),qt=reactExports.useCallback(()=>Ht({}),[]),Wt=ln=>{const dn=ln?{...ln,...kt.refValues.current}:kt.refValues.current;kt.setValuesSnapshot(dn),Gt({})},Yt=reactExports.useCallback((ln,dn)=>{Ht(hn=>getStatus(hn,ln)===dn?hn:{...hn,[ln]:dn})},[]),Kt=reactExports.useCallback((ln,dn)=>{Gt(hn=>getStatus(hn,ln)===dn?hn:{...hn,[ln]:dn})},[]),Xt=reactExports.useCallback(ln=>getStatus(Vt.current,ln),[]),Qt=reactExports.useCallback(ln=>Gt(dn=>{if(typeof ln!="string")return dn;const hn=clearListState(ln,dn);return delete hn[ln],equal$5(hn,dn)?dn:hn}),[]),Jt=reactExports.useCallback(ln=>{if(ln){const hn=getPath(ln,zt.current);if(typeof hn=="boolean")return hn;const cn=getPath(ln,kt.refValues.current),pn=getPath(ln,kt.valuesSnapshot.current);return!equal$5(cn,pn)}return Object.keys(zt.current).length>0?getStatus(zt.current):!equal$5(kt.refValues.current,kt.valuesSnapshot.current)},[]),Zt=reactExports.useCallback(()=>zt.current,[]),sn=reactExports.useCallback(()=>Vt.current,[]);return{touchedState:Mt,dirtyState:jt,touchedRef:Vt,dirtyRef:zt,setTouched:Ht,setDirty:Gt,resetDirty:Wt,resetTouched:qt,isTouched:Xt,setFieldTouched:Yt,setFieldDirty:Kt,setTouchedState:Ft,setDirtyState:Bt,clearFieldDirty:Qt,isDirty:Jt,getDirty:Zt,getTouched:sn}}function useFormValues({initialValues:xt,onValuesChange:$t,mode:Ct}){const kt=reactExports.useRef(!1),[Mt,Ft]=reactExports.useState(xt||{}),jt=reactExports.useRef(Mt),Bt=reactExports.useRef(Mt),Vt=reactExports.useCallback(({values:Yt,subscribers:Kt,updateState:Xt=!0,mergeWithPreviousValues:Qt=!0})=>{const Jt=jt.current,Zt=Yt instanceof Function?Yt(jt.current):Yt,sn=Qt?{...Jt,...Zt}:Zt;jt.current=sn,Xt&&Ft(sn),$t==null||$t(sn,Jt),Kt==null||Kt.filter(Boolean).forEach(ln=>ln({updatedValues:sn,previousValues:Jt}))},[$t]),zt=reactExports.useCallback(Yt=>{var Qt;const Kt=getPath(Yt.path,jt.current),Xt=Yt.value instanceof Function?Yt.value(Kt):Yt.value;if(Kt!==Xt){const Jt=jt.current,Zt=setPath(Yt.path,Xt,jt.current);Vt({values:Zt,updateState:Yt.updateState}),(Qt=Yt.subscribers)==null||Qt.filter(Boolean).forEach(sn=>sn({path:Yt.path,updatedValues:Zt,previousValues:Jt}))}},[]),Ht=reactExports.useCallback(Yt=>{Bt.current=Yt},[]),Gt=reactExports.useCallback((Yt,Kt)=>{kt.current||(kt.current=!0,Vt({values:Yt,updateState:Ct==="controlled"}),Ht(Yt),Kt())},[]),qt=reactExports.useCallback(()=>{Vt({values:Bt.current,updateState:!0,mergeWithPreviousValues:!1})},[]),Wt=reactExports.useCallback(()=>jt.current,[]);return{initialized:kt,stateValues:Mt,refValues:jt,valuesSnapshot:Bt,setValues:Vt,setFieldValue:zt,resetValues:qt,setValuesSnapshot:Ht,initialize:Gt,getValues:Wt}}function useFormWatch({$status:xt}){const $t=reactExports.useRef({}),Ct=reactExports.useCallback((Mt,Ft)=>{reactExports.useEffect(()=>($t.current[Mt]=$t.current[Mt]||[],$t.current[Mt].push(Ft),()=>{$t.current[Mt]=$t.current[Mt].filter(jt=>jt!==Ft)}),[Ft])},[]),kt=reactExports.useCallback(Mt=>$t.current[Mt]?$t.current[Mt].map(Ft=>jt=>Ft({previousValue:getPath(Mt,jt.previousValues),value:getPath(Mt,jt.updatedValues),touched:xt.isTouched(Mt),dirty:xt.isDirty(Mt)})):[],[]);return{subscribers:$t,watch:Ct,getFieldSubscribers:kt}}function getDataPath(xt,$t){return xt?`${xt}-${$t.toString()}`:$t.toString()}function getValidationResults(xt){const $t=filterErrors(xt);return{hasErrors:Object.keys($t).length>0,errors:$t}}function validateRulesRecord(xt,$t,Ct="",kt={}){return typeof xt!="object"||xt===null?kt:Object.keys(xt).reduce((Mt,Ft)=>{const jt=xt[Ft],Bt=`${Ct===""?"":`${Ct}.`}${Ft}`,Vt=getPath(Bt,$t);let zt=!1;return typeof jt=="function"&&(Mt[Bt]=jt(Vt,$t,Bt)),typeof jt=="object"&&Array.isArray(Vt)&&(zt=!0,Vt.forEach((Ht,Gt)=>validateRulesRecord(jt,$t,`${Bt}.${Gt}`,Mt))),typeof jt=="object"&&typeof Vt=="object"&&Vt!==null&&(zt||validateRulesRecord(jt,$t,Bt,Mt)),Mt},kt)}function validateValues(xt,$t){return getValidationResults(typeof xt=="function"?xt($t):validateRulesRecord(xt,$t))}function validateFieldValue(xt,$t,Ct){if(typeof xt!="string")return{hasError:!1,error:null};const kt=validateValues($t,Ct),Mt=Object.keys(kt.errors).find(Ft=>xt.split(".").every((jt,Bt)=>jt===Ft.split(".")[Bt]));return{hasError:!!Mt,error:Mt?kt.errors[Mt]:null}}const FORM_INDEX="__MANTINE_FORM_INDEX__";function shouldValidateOnChange(xt,$t){return $t?typeof $t=="boolean"?$t:Array.isArray($t)?$t.includes(xt.replace(/[.][0-9]/g,`.${FORM_INDEX}`)):!1:!1}function useForm({name:xt,mode:$t="controlled",initialValues:Ct,initialErrors:kt={},initialDirty:Mt={},initialTouched:Ft={},clearInputErrorOnChange:jt=!0,validateInputOnChange:Bt=!1,validateInputOnBlur:Vt=!1,onValuesChange:zt,transformValues:Ht=Wt=>Wt,enhanceGetInputProps:Gt,validate:qt}={}){const Wt=useFormErrors(kt),Yt=useFormValues({initialValues:Ct,onValuesChange:zt,mode:$t}),Kt=useFormStatus({initialDirty:Mt,initialTouched:Ft,$values:Yt,mode:$t}),Xt=useFormList({$values:Yt,$errors:Wt,$status:Kt}),Qt=useFormWatch({$status:Kt}),[Jt,Zt]=reactExports.useState(0),[sn,ln]=reactExports.useState({}),dn=reactExports.useCallback(()=>{Yt.resetValues(),Wt.clearErrors(),Kt.resetDirty(),Kt.resetTouched(),$t==="uncontrolled"&&Zt(An=>An+1)},[]),hn=reactExports.useCallback(An=>{Yt.initialize(An,()=>$t==="uncontrolled"&&Zt(Sn=>Sn+1))},[]),cn=reactExports.useCallback((An,Sn,vn)=>{const _n=shouldValidateOnChange(An,Bt);Kt.clearFieldDirty(An),Kt.setFieldTouched(An,!0),!_n&&jt&&Wt.clearFieldError(An),Yt.setFieldValue({path:An,value:Sn,updateState:$t==="controlled",subscribers:[...Qt.getFieldSubscribers(An),_n?Tn=>{const Pn=validateFieldValue(An,qt,Tn.updatedValues);Pn.hasError?Wt.setFieldError(An,Pn.error):Wt.clearFieldError(An)}:null,(vn==null?void 0:vn.forceUpdate)!==!1&&$t!=="controlled"?()=>ln(Tn=>({...Tn,[An]:(Tn[An]||0)+1})):null]})},[zt,qt]),pn=reactExports.useCallback(An=>{const Sn=Yt.refValues.current;Yt.setValues({values:An,updateState:$t==="controlled"}),jt&&Wt.clearErrors(),$t==="uncontrolled"&&Zt(vn=>vn+1),Object.keys(Qt.subscribers.current).forEach(vn=>{const _n=getPath(vn,Yt.refValues.current),Tn=getPath(vn,Sn);_n!==Tn&&Qt.getFieldSubscribers(vn).forEach(Pn=>Pn({previousValues:Sn,updatedValues:Yt.refValues.current}))})},[zt,jt]),yn=reactExports.useCallback(()=>{const An=validateValues(qt,Yt.refValues.current);return Wt.setErrors(An.errors),An},[qt]),gn=reactExports.useCallback(An=>{const Sn=validateFieldValue(An,qt,Yt.refValues.current);return Sn.hasError?Wt.setFieldError(An,Sn.error):Wt.clearFieldError(An),Sn},[qt]),En=(An,{type:Sn="input",withError:vn=!0,withFocus:_n=!0,...Tn}={})=>{const Ln={onChange:getInputOnChange(Vn=>cn(An,Vn,{forceUpdate:!1})),"data-path":getDataPath(xt,An)};return vn&&(Ln.error=Wt.errorsState[An]),Sn==="checkbox"?Ln[$t==="controlled"?"checked":"defaultChecked"]=getPath(An,Yt.refValues.current):Ln[$t==="controlled"?"value":"defaultValue"]=getPath(An,Yt.refValues.current),_n&&(Ln.onFocus=()=>Kt.setFieldTouched(An,!0),Ln.onBlur=()=>{if(shouldValidateOnChange(An,Vt)){const Vn=validateFieldValue(An,qt,Yt.refValues.current);Vn.hasError?Wt.setFieldError(An,Vn.error):Wt.clearFieldError(An)}}),Object.assign(Ln,Gt==null?void 0:Gt({inputProps:Ln,field:An,options:{type:Sn,withError:vn,withFocus:_n,...Tn},form:Dn}))},bn=(An,Sn)=>vn=>{vn==null||vn.preventDefault();const _n=yn();_n.hasErrors?Sn==null||Sn(_n.errors,Yt.refValues.current,vn):An==null||An(Ht(Yt.refValues.current),vn)},xn=An=>Ht(An||Yt.refValues.current),Cn=reactExports.useCallback(An=>{An.preventDefault(),dn()},[]),$n=reactExports.useCallback(An=>An?!validateFieldValue(An,qt,Yt.refValues.current).hasError:!validateValues(qt,Yt.refValues.current).hasErrors,[qt]),wn=An=>`${Jt}-${An}-${sn[An]||0}`,Rn=reactExports.useCallback(An=>document.querySelector(`[data-path="${getDataPath(xt,An)}"]`),[]),Dn={watch:Qt.watch,initialized:Yt.initialized.current,values:Yt.stateValues,getValues:Yt.getValues,setInitialValues:Yt.setValuesSnapshot,initialize:hn,setValues:pn,setFieldValue:cn,errors:Wt.errorsState,setErrors:Wt.setErrors,setFieldError:Wt.setFieldError,clearFieldError:Wt.clearFieldError,clearErrors:Wt.clearErrors,resetDirty:Kt.resetDirty,setTouched:Kt.setTouched,setDirty:Kt.setDirty,isTouched:Kt.isTouched,resetTouched:Kt.resetTouched,isDirty:Kt.isDirty,getTouched:Kt.getTouched,getDirty:Kt.getDirty,reorderListItem:Xt.reorderListItem,insertListItem:Xt.insertListItem,removeListItem:Xt.removeListItem,reset:dn,validate:yn,validateField:gn,getInputProps:En,onSubmit:bn,onReset:Cn,isValid:$n,getTransformedValues:xn,key:wn,getInputNode:Rn};return useFormActions(xt,Dn),Dn}function matches$2(xt,$t){const Ct=$t||!0;return kt=>typeof kt!="string"?Ct:xt.test(kt)?null:Ct}function isEmail(xt){return matches$2(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,xt)}const queryParameters=new URLSearchParams(window.location.search),generateInitFields=(xt,$t)=>{let Ct={};return xt.forEach(kt=>{const Mt=$t?$t[kt.id]:{};if(Mt)Ct={...Ct,[kt.id]:Mt};else{const Ft=kt.paramCapture?queryParameters.get(kt.paramCapture):"";Ct={...Ct,[kt.id]:kt.type==="iframe"?[]:Ft}}}),{...Ct}},generateValidation=xt=>{let $t={};return xt.forEach(Ct=>{Ct.required&&($t={...$t,[Ct.id]:kt=>{if(Array.isArray(kt)){if(Ct.requiredValue!=null&&!Array.isArray(Ct.requiredValue))return"Incorrect required value";if(Ct.requiredValue!=null&&Array.isArray(Ct.requiredValue)){if(Ct.requiredValue.length!==kt.length)return"Incorrect input";const Mt=[...Ct.requiredValue].sort(),Ft=[...kt].sort();return Mt.every((jt,Bt)=>jt===Ft[Bt])?null:"Incorrect input"}return kt.length===0?"Empty input":null}return Ct.required&&Ct.requiredValue!=null&&kt!=null?kt.toString()!==Ct.requiredValue.toString()?"Incorrect input":null:Ct.required?kt==null||kt===""?"Empty input":null:kt===null?"Empty input":null}})}),$t};function useAnswerField(xt,$t,Ct){const[kt,Mt]=reactExports.useState(null),Ft=useForm({initialValues:generateInitFields(xt,Ct),validate:generateValidation(xt)});return reactExports.useEffect(()=>{kt!==$t&&(Mt($t),Ft.reset())},[kt,Ft,$t]),Ft}function generateErrorMessage(xt,$t,Ct){var jt;const{requiredValue:kt,requiredLabel:Mt}=xt;let Ft="";return $t.checked&&Array.isArray(kt)?Ft=kt&&[...kt].sort().toString()!==[...$t.checked].sort().toString()?`Please ${Ct?"select":"enter"} ${Mt||kt.toString()} to continue.`:null:Ft=$t.value&&kt&&kt.toString()!==$t.value.toString()?`Please ${Ct?"select":"enter"} ${Mt||(Ct?(jt=Ct.find(Bt=>Bt.value===kt))==null?void 0:jt.label:kt.toString())} to continue.`:null,Ft}function CheckBoxInput({response:xt,disabled:$t,answer:Ct,index:kt,enumerateQuestions:Mt}){const{prompt:Ft,required:jt,options:Bt,secondaryText:Vt}=xt;return jsxRuntimeExports.jsx(Checkbox.Group,{label:jsxRuntimeExports.jsxs(Flex,{direction:"row",wrap:"nowrap",gap:4,children:[Mt&&jsxRuntimeExports.jsx(Box,{style:{minWidth:"fit-content"},children:`${kt}. `}),jsxRuntimeExports.jsx(Box,{style:{display:"block"},className:"no-last-child-bottom-padding",children:jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:Ft,required:jt})})]}),description:Vt,...Ct,error:generateErrorMessage(xt,Ct,Bt),style:{"--input-description-size":"calc(var(--mantine-font-size-md) - calc(0.125rem * var(--mantine-scale)))"},children:jsxRuntimeExports.jsx(Group$1,{mt:"xs",children:Bt.map(zt=>jsxRuntimeExports.jsx(Checkbox,{disabled:$t,value:zt.value,label:zt.label},zt.value))})})}function DropdownInput({response:xt,disabled:$t,answer:Ct,index:kt,enumerateQuestions:Mt}){const{placeholder:Ft,prompt:jt,required:Bt,options:Vt,secondaryText:zt}=xt;return jsxRuntimeExports.jsx(Select,{disabled:$t,label:jsxRuntimeExports.jsxs(Flex,{direction:"row",wrap:"nowrap",gap:4,children:[Mt&&jsxRuntimeExports.jsx(Box,{style:{minWidth:"fit-content"},children:`${kt}. `}),jsxRuntimeExports.jsx(Box,{style:{display:"block"},className:"no-last-child-bottom-padding",children:jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:jt,required:Bt})})]}),description:zt,placeholder:Ft,data:Vt,radius:"md",size:"md",...Ct,error:generateErrorMessage(xt,Ct,Vt)})}function IframeInput({response:xt,answer:$t,index:Ct,enumerateQuestions:kt}){const{prompt:Mt,required:Ft,secondaryText:jt}=xt;return jsxRuntimeExports.jsx(Input.Wrapper,{label:jsxRuntimeExports.jsxs(Flex,{direction:"row",wrap:"nowrap",gap:4,children:[kt&&jsxRuntimeExports.jsx(Box,{style:{minWidth:"fit-content"},children:`${Ct}. `}),jsxRuntimeExports.jsx(Box,{style:{display:"block"},className:"no-last-child-bottom-padding",children:jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:Mt,required:Ft})})]}),description:jt,size:"md",children:jsxRuntimeExports.jsx(List$2,{children:Array.isArray($t.value)?$t.value.map(Bt=>jsxRuntimeExports.jsx(List$2.Item,{children:Bt},Bt)):jsxRuntimeExports.jsx(List$2.Item,{children:$t.value})})})}function RadioInput({response:xt,disabled:$t,answer:Ct,index:kt,enumerateQuestions:Mt}){const{prompt:Ft,required:jt,options:Bt,leftLabel:Vt,rightLabel:zt,secondaryText:Ht}=xt;return jsxRuntimeExports.jsx(Radio.Group,{name:`radioInput${xt.id}`,label:jsxRuntimeExports.jsxs(Flex,{direction:"row",wrap:"nowrap",gap:4,children:[Mt&&jsxRuntimeExports.jsx(Box,{style:{minWidth:"fit-content"},children:`${kt}. `}),jsxRuntimeExports.jsx(Box,{style:{display:"block"},className:"no-last-child-bottom-padding",children:jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:Ft,required:jt})})]}),description:Ht,...Ct,error:generateErrorMessage(xt,Ct,Bt),style:{"--input-description-size":"calc(var(--mantine-font-size-md) - calc(0.125rem * var(--mantine-scale)))"},children:jsxRuntimeExports.jsxs(Group$1,{mt:"xs",children:[Vt?jsxRuntimeExports.jsx(Text,{style:{textAlign:"center"},children:Vt}):null,Bt.map(Gt=>jsxRuntimeExports.jsx(Radio,{disabled:$t,value:Gt.value,label:Gt.label},Gt.label)),jsxRuntimeExports.jsx(Text,{children:zt})]})},xt.id)}function LikertInput({response:xt,disabled:$t,answer:Ct,index:kt,enumerateQuestions:Mt}){const{numItems:Ft}=xt,jt=[];for(let Vt=1;Vt<=+Ft;Vt+=1)jt.push({label:`${Vt}`,value:`${Vt}`});const Bt={...xt,type:"radio",options:jt};return jsxRuntimeExports.jsx(RadioInput,{disabled:$t,response:Bt,answer:Ct,index:kt,enumerateQuestions:Mt})}function NumericInput({response:xt,disabled:$t,answer:Ct,index:kt,enumerateQuestions:Mt}){const{prompt:Ft,required:jt,min:Bt,max:Vt,placeholder:zt,secondaryText:Ht}=xt;return jsxRuntimeExports.jsx(NumberInput,{disabled:$t,placeholder:zt,label:jsxRuntimeExports.jsxs(Flex,{direction:"row",wrap:"nowrap",gap:4,children:[Mt&&jsxRuntimeExports.jsx(Box,{style:{minWidth:"fit-content"},children:`${kt}. `}),jsxRuntimeExports.jsx(Box,{style:{display:"block"},className:"no-last-child-bottom-padding",children:jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:Ft,required:jt})})]}),description:Ht,radius:"md",size:"md",min:Bt,max:Vt,...Ct,error:generateErrorMessage(xt,Ct)})}function SliderInput({response:xt,disabled:$t,answer:Ct,index:kt,enumerateQuestions:Mt}){const{prompt:Ft,required:jt,options:Bt,secondaryText:Vt}=xt,zt=generateErrorMessage(xt,Ct);return jsxRuntimeExports.jsx(Input.Wrapper,{label:jsxRuntimeExports.jsxs(Flex,{direction:"row",wrap:"nowrap",gap:4,children:[Mt&&jsxRuntimeExports.jsx(Box,{style:{minWidth:"fit-content"},children:`${kt}. `}),jsxRuntimeExports.jsx(Box,{style:{display:"block"},className:"no-last-child-bottom-padding",children:jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:Ft,required:jt})})]}),description:Vt,error:zt,style:{"--input-description-size":"calc(var(--mantine-font-size-md) - calc(0.125rem * var(--mantine-scale)))"},children:jsxRuntimeExports.jsx(Slider,{disabled:$t,marks:Bt,...Ct,h:40})})}function StringInput({response:xt,disabled:$t,answer:Ct,index:kt,enumerateQuestions:Mt}){const{placeholder:Ft,prompt:jt,required:Bt,secondaryText:Vt}=xt;return jsxRuntimeExports.jsx(TextInput,{disabled:$t,placeholder:Ft,label:jsxRuntimeExports.jsxs(Flex,{direction:"row",wrap:"nowrap",gap:4,children:[Mt&&jsxRuntimeExports.jsx(Box,{style:{minWidth:"fit-content"},children:`${kt}. `}),jsxRuntimeExports.jsx(Box,{style:{display:"block"},className:"no-last-child-bottom-padding",children:jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:jt,required:Bt})})]}),description:Vt,radius:"md",size:"md",...Ct,value:Ct.value||"",error:generateErrorMessage(xt,Ct)})}function TextAreaInput({response:xt,disabled:$t,answer:Ct,index:kt,enumerateQuestions:Mt}){const{placeholder:Ft,prompt:jt,required:Bt,secondaryText:Vt}=xt;return jsxRuntimeExports.jsx(Textarea,{disabled:$t,placeholder:Ft,label:jsxRuntimeExports.jsxs(Flex,{direction:"row",wrap:"nowrap",gap:4,children:[Mt&&jsxRuntimeExports.jsx(Box,{style:{minWidth:"fit-content"},children:`${kt}. `}),jsxRuntimeExports.jsx(Box,{style:{display:"block"},className:"no-last-child-bottom-padding",children:jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:jt,required:Bt})})]}),description:Vt,radius:"md",size:"md",autosize:!0,minRows:3,...Ct,value:Ct.value||"",error:generateErrorMessage(xt,Ct)})}function ResponseSwitcher({response:xt,answer:$t,storedAnswer:Ct,index:kt}){const Mt=(Ct?{value:Ct}:$t)||{value:void 0},Ft=!!Ct,[jt]=useSearchParams(),Vt=useStudyConfig().uiConfig.enumerateQuestions??!1,zt=reactExports.useMemo(()=>{if(xt.paramCapture){const Ht=jt.get(xt.paramCapture);return Ft||!!Ht}return Ft},[Ft,xt.paramCapture,jt]);return jsxRuntimeExports.jsxs(Box,{mb:"md",children:[xt.type==="numerical"&&jsxRuntimeExports.jsx(NumericInput,{response:xt,disabled:zt,answer:Mt,index:kt,enumerateQuestions:Vt}),xt.type==="shortText"&&jsxRuntimeExports.jsx(StringInput,{response:xt,disabled:zt,answer:Mt,index:kt,enumerateQuestions:Vt}),xt.type==="longText"&&jsxRuntimeExports.jsx(TextAreaInput,{response:xt,disabled:zt,answer:Mt,index:kt,enumerateQuestions:Vt}),xt.type==="likert"&&jsxRuntimeExports.jsx(LikertInput,{response:xt,disabled:zt,answer:Mt,index:kt,enumerateQuestions:Vt}),xt.type==="dropdown"&&jsxRuntimeExports.jsx(DropdownInput,{response:xt,disabled:zt,answer:Mt,index:kt,enumerateQuestions:Vt}),xt.type==="slider"&&jsxRuntimeExports.jsx(SliderInput,{response:xt,disabled:zt,answer:Mt,index:kt,enumerateQuestions:Vt}),xt.type==="radio"&&jsxRuntimeExports.jsx(RadioInput,{response:xt,disabled:zt,answer:Mt,index:kt,enumerateQuestions:Vt}),xt.type==="checkbox"&&jsxRuntimeExports.jsx(CheckBoxInput,{response:xt,disabled:zt,answer:Mt,index:kt,enumerateQuestions:Vt}),xt.type==="iframe"&&jsxRuntimeExports.jsx(IframeInput,{response:xt,answer:Mt,index:kt,enumerateQuestions:Vt})]})}function ResponseBlock({config:xt,location:$t,status:Ct,style:kt}){var sn;const Mt=useCurrentStep(),Ft=useCurrentComponent(),jt=Ct==null?void 0:Ct.answer,Bt=xt,Vt=reactExports.useMemo(()=>{var ln;return((ln=Bt==null?void 0:Bt.response)==null?void 0:ln.filter(dn=>dn.location?dn.location===$t:$t==="belowStimulus"))||[]},[Bt==null?void 0:Bt.response,$t]),zt=useStoreDispatch(),{updateResponseBlockValidation:Ht}=useStoreActions(),Gt=useAnswerField(Vt,Mt,jt||{}),[qt,Wt]=reactExports.useState(void 0),[Yt,Kt]=reactExports.useState(!1),{iframeAnswers:Xt,iframeProvenance:Qt}=useStoreSelector(ln=>ln),Jt=(Bt==null?void 0:Bt.provideFeedback)&&(((sn=Bt==null?void 0:Bt.correctAnswer)==null?void 0:sn.length)||0)>0,Zt=$t===((Bt==null?void 0:Bt.nextButtonLocation)||"belowStimulus");return reactExports.useEffect(()=>{const ln=Vt.find(dn=>dn.type==="iframe");if(Xt&&ln){const dn=ln.id;Gt.setValues({...Gt.values,[dn]:Xt[dn]})}},[Xt]),reactExports.useEffect(()=>{Qt&&Wt(Qt)},[Qt]),reactExports.useEffect(()=>{zt(Ht({location:$t,identifier:`${Ft}_${Mt}`,status:Gt.isValid(),values:deepCopy(Gt.values),provenanceGraph:qt}))},[Gt.values,Ft,Mt,$t,zt,Ht,qt]),jsxRuntimeExports.jsxs("div",{style:kt,children:[Vt.map((ln,dn)=>{var hn,cn;return jsxRuntimeExports.jsx(React$1.Fragment,{children:ln.hidden?"":jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ResponseSwitcher,{storedAnswer:jt?jt[ln.id]:void 0,answer:{...Gt.getInputProps(ln.id,{type:ln.type==="checkbox"?"checkbox":"input"})},response:ln,index:dn+1}),Jt&&Yt&&jsxRuntimeExports.jsx(Text,{children:`The correct answer is: ${(cn=(hn=Bt.correctAnswer)==null?void 0:hn.find(pn=>pn.id===ln.id))==null?void 0:cn.answer}`})]})},`${ln.id}-${Mt}`)}),jsxRuntimeExports.jsxs(Group$1,{justify:"right",gap:"xs",children:[Jt&&Zt&&jsxRuntimeExports.jsx(Button,{onClick:()=>Kt(!0),disabled:!Gt.isValid(),children:"Check Answer"}),Zt&&jsxRuntimeExports.jsx(NextButton,{disabled:Jt&&!Yt,setCheckClicked:Kt,label:Bt.nextButtonText||"Next"})]})]})}const PREFIX="@REVISIT_COMMS",defaultStyle$2={minHeight:"500px",width:"100%",border:0};function IframeController({currentConfig:xt}){const{setIframeAnswers:$t,setIframeProvenance:Ct}=useStoreActions(),kt=useStoreDispatch(),Mt=useDispatch(),Ft=reactExports.useRef(null),jt=reactExports.useMemo(()=>crypto.randomUUID?crypto.randomUUID():`testID-${Date.now()}`,[]),Bt=useCurrentComponent(),Vt=useNavigate(),zt=reactExports.useCallback((Ht,Gt)=>{var qt,Wt;(Wt=(qt=Ft.current)==null?void 0:qt.contentWindow)==null||Wt.postMessage({error:!1,type:`${PREFIX}/${Ht}`,iframeId:jt,message:Gt},"*")},[Ft,jt]);return reactExports.useEffect(()=>{const Ht=Gt=>{const{data:qt}=Gt;if(typeof qt=="object"&&jt===qt.iframeId)switch(qt.type){case`${PREFIX}/WINDOW_READY`:xt.parameters&&zt("STUDY_DATA",xt.parameters);break;case`${PREFIX}/READY`:Ft.current&&(Ft.current.style.height=`${qt.message.documentHeight}px`);break;case`${PREFIX}/ANSWERS`:kt($t(qt.message));break;case`${PREFIX}/PROVENANCE`:kt(Ct(qt.message));break}};return window.addEventListener("message",Ht),()=>window.removeEventListener("message",Ht)},[kt,Mt,jt,Vt,xt,zt,$t,Ct]),jsxRuntimeExports.jsx("iframe",{ref:Ft,src:`${PREFIX$1}${xt.path}?trialid=${Bt}&id=${jt}`,style:defaultStyle$2})}async function getStaticAssetByPath(xt){const Ct=await(await fetch(`${PREFIX$1}${xt}`)).text();if(!Ct.includes("<title>reVISit</title>"))return Ct}function ResourceNotFound({email:xt,path:$t}){const Ct=useLocation();return jsxRuntimeExports.jsxs(Container,{fluid:!0,my:50,maw:800,mx:"auto",children:[jsxRuntimeExports.jsx(Title,{order:2,children:jsxRuntimeExports.jsx(Text,{span:!0,c:"orange",children:"404"})}),jsxRuntimeExports.jsxs(Text,{children:[jsxRuntimeExports.jsx(Text,{span:!0,fw:700,children:$t||Ct.pathname})," ","not Found."]}),jsxRuntimeExports.jsx(Space,{h:"lg"}),jsxRuntimeExports.jsxs(List$2,{children:[jsxRuntimeExports.jsx(List$2.Item,{children:jsxRuntimeExports.jsx(Text,{children:"If you're trying to access your study please check the URL and verify that the global config file is correctly configured. Then try again."})}),jsxRuntimeExports.jsx(List$2.Item,{children:jsxRuntimeExports.jsxs(Text,{children:["If you're a participant, please contact the study administrator"," ",xt&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["at"," ",jsxRuntimeExports.jsxs(Anchor,{c:"blue",href:`mailto:${xt}`,children:[xt," "]})]}),"."]})})]})]})}const defaultStyle$1={maxWidth:"100%"};function ImageController({currentConfig:xt}){const $t={...defaultStyle$1,...xt.style},[Ct,kt]=reactExports.useState(!0),[Mt,Ft]=reactExports.useState(!1);return reactExports.useEffect(()=>{async function jt(){const Bt=await getStaticAssetByPath(xt.path);Ft(!!Bt),kt(!1)}jt()},[xt]),Ct||Mt?jsxRuntimeExports.jsx(Image$1,{mx:"auto",src:`${PREFIX$1}${xt.path}`,style:$t}):jsxRuntimeExports.jsx(ResourceNotFound,{path:xt.path})}function ascending$4(xt,$t){return xt==null||$t==null?NaN:xt<$t?-1:xt>$t?1:xt>=$t?0:NaN}function descending$2(xt,$t){return xt==null||$t==null?NaN:$t<xt?-1:$t>xt?1:$t>=xt?0:NaN}function bisector$1(xt){let $t,Ct,kt;xt.length!==2?($t=ascending$4,Ct=(Bt,Vt)=>ascending$4(xt(Bt),Vt),kt=(Bt,Vt)=>xt(Bt)-Vt):($t=xt===ascending$4||xt===descending$2?xt:zero$4,Ct=xt,kt=xt);function Mt(Bt,Vt,zt=0,Ht=Bt.length){if(zt<Ht){if($t(Vt,Vt)!==0)return Ht;do{const Gt=zt+Ht>>>1;Ct(Bt[Gt],Vt)<0?zt=Gt+1:Ht=Gt}while(zt<Ht)}return zt}function Ft(Bt,Vt,zt=0,Ht=Bt.length){if(zt<Ht){if($t(Vt,Vt)!==0)return Ht;do{const Gt=zt+Ht>>>1;Ct(Bt[Gt],Vt)<=0?zt=Gt+1:Ht=Gt}while(zt<Ht)}return zt}function jt(Bt,Vt,zt=0,Ht=Bt.length){const Gt=Mt(Bt,Vt,zt,Ht-1);return Gt>zt&&kt(Bt[Gt-1],Vt)>-kt(Bt[Gt],Vt)?Gt-1:Gt}return{left:Mt,center:jt,right:Ft}}function zero$4(){return 0}function number$6(xt){return xt===null?NaN:+xt}function*numbers$2(xt,$t){if($t===void 0)for(let Ct of xt)Ct!=null&&(Ct=+Ct)>=Ct&&(yield Ct);else{let Ct=-1;for(let kt of xt)(kt=$t(kt,++Ct,xt))!=null&&(kt=+kt)>=kt&&(yield kt)}}const ascendingBisect=bisector$1(ascending$4),bisectRight$1=ascendingBisect.right,bisectLeft$1=ascendingBisect.left;bisector$1(number$6).center;function variance(xt,$t){let Ct=0,kt,Mt=0,Ft=0;if($t===void 0)for(let jt of xt)jt!=null&&(jt=+jt)>=jt&&(kt=jt-Mt,Mt+=kt/++Ct,Ft+=kt*(jt-Mt));else{let jt=-1;for(let Bt of xt)(Bt=$t(Bt,++jt,xt))!=null&&(Bt=+Bt)>=Bt&&(kt=Bt-Mt,Mt+=kt/++Ct,Ft+=kt*(Bt-Mt))}if(Ct>1)return Ft/(Ct-1)}function deviation(xt,$t){const Ct=variance(xt,$t);return Ct&&Math.sqrt(Ct)}function extent$1(xt,$t){let Ct,kt;for(const Mt of xt)Mt!=null&&(Ct===void 0?Mt>=Mt&&(Ct=kt=Mt):(Ct>Mt&&(Ct=Mt),kt<Mt&&(kt=Mt)));return[Ct,kt]}class Adder{constructor(){this._partials=new Float64Array(32),this._n=0}add($t){const Ct=this._partials;let kt=0;for(let Mt=0;Mt<this._n&&Mt<32;Mt++){const Ft=Ct[Mt],jt=$t+Ft,Bt=Math.abs($t)<Math.abs(Ft)?$t-(jt-Ft):Ft-(jt-$t);Bt&&(Ct[kt++]=Bt),$t=jt}return Ct[kt]=$t,this._n=kt+1,this}valueOf(){const $t=this._partials;let Ct=this._n,kt,Mt,Ft,jt=0;if(Ct>0){for(jt=$t[--Ct];Ct>0&&(kt=jt,Mt=$t[--Ct],jt=kt+Mt,Ft=Mt-(jt-kt),!Ft););Ct>0&&(Ft<0&&$t[Ct-1]<0||Ft>0&&$t[Ct-1]>0)&&(Mt=Ft*2,kt=jt+Mt,Mt==kt-jt&&(jt=kt))}return jt}}class InternMap extends Map{constructor($t,Ct=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:Ct}}),$t!=null)for(const[kt,Mt]of $t)this.set(kt,Mt)}get($t){return super.get(intern_get(this,$t))}has($t){return super.has(intern_get(this,$t))}set($t,Ct){return super.set(intern_set(this,$t),Ct)}delete($t){return super.delete(intern_delete(this,$t))}}class InternSet extends Set{constructor($t,Ct=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:Ct}}),$t!=null)for(const kt of $t)this.add(kt)}has($t){return super.has(intern_get(this,$t))}add($t){return super.add(intern_set(this,$t))}delete($t){return super.delete(intern_delete(this,$t))}}function intern_get({_intern:xt,_key:$t},Ct){const kt=$t(Ct);return xt.has(kt)?xt.get(kt):Ct}function intern_set({_intern:xt,_key:$t},Ct){const kt=$t(Ct);return xt.has(kt)?xt.get(kt):(xt.set(kt,Ct),Ct)}function intern_delete({_intern:xt,_key:$t},Ct){const kt=$t(Ct);return xt.has(kt)&&(Ct=xt.get(kt),xt.delete(kt)),Ct}function keyof(xt){return xt!==null&&typeof xt=="object"?xt.valueOf():xt}function permute(xt,$t){return Array.from($t,Ct=>xt[Ct])}function compareDefined(xt=ascending$4){if(xt===ascending$4)return ascendingDefined;if(typeof xt!="function")throw new TypeError("compare is not a function");return($t,Ct)=>{const kt=xt($t,Ct);return kt||kt===0?kt:(xt(Ct,Ct)===0)-(xt($t,$t)===0)}}function ascendingDefined(xt,$t){return(xt==null||!(xt>=xt))-($t==null||!($t>=$t))||(xt<$t?-1:xt>$t?1:0)}const e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(xt,$t,Ct){const kt=($t-xt)/Math.max(0,Ct),Mt=Math.floor(Math.log10(kt)),Ft=kt/Math.pow(10,Mt),jt=Ft>=e10?10:Ft>=e5?5:Ft>=e2?2:1;let Bt,Vt,zt;return Mt<0?(zt=Math.pow(10,-Mt)/jt,Bt=Math.round(xt*zt),Vt=Math.round($t*zt),Bt/zt<xt&&++Bt,Vt/zt>$t&&--Vt,zt=-zt):(zt=Math.pow(10,Mt)*jt,Bt=Math.round(xt/zt),Vt=Math.round($t/zt),Bt*zt<xt&&++Bt,Vt*zt>$t&&--Vt),Vt<Bt&&.5<=Ct&&Ct<2?tickSpec(xt,$t,Ct*2):[Bt,Vt,zt]}function ticks(xt,$t,Ct){if($t=+$t,xt=+xt,Ct=+Ct,!(Ct>0))return[];if(xt===$t)return[xt];const kt=$t<xt,[Mt,Ft,jt]=kt?tickSpec($t,xt,Ct):tickSpec(xt,$t,Ct);if(!(Ft>=Mt))return[];const Bt=Ft-Mt+1,Vt=new Array(Bt);if(kt)if(jt<0)for(let zt=0;zt<Bt;++zt)Vt[zt]=(Ft-zt)/-jt;else for(let zt=0;zt<Bt;++zt)Vt[zt]=(Ft-zt)*jt;else if(jt<0)for(let zt=0;zt<Bt;++zt)Vt[zt]=(Mt+zt)/-jt;else for(let zt=0;zt<Bt;++zt)Vt[zt]=(Mt+zt)*jt;return Vt}function tickIncrement(xt,$t,Ct){return $t=+$t,xt=+xt,Ct=+Ct,tickSpec(xt,$t,Ct)[2]}function tickStep(xt,$t,Ct){$t=+$t,xt=+xt,Ct=+Ct;const kt=$t<xt,Mt=kt?tickIncrement($t,xt,Ct):tickIncrement(xt,$t,Ct);return(kt?-1:1)*(Mt<0?1/-Mt:Mt)}function max$4(xt,$t){let Ct;if($t===void 0)for(const kt of xt)kt!=null&&(Ct<kt||Ct===void 0&&kt>=kt)&&(Ct=kt);else{let kt=-1;for(let Mt of xt)(Mt=$t(Mt,++kt,xt))!=null&&(Ct<Mt||Ct===void 0&&Mt>=Mt)&&(Ct=Mt)}return Ct}function min$4(xt,$t){let Ct;if($t===void 0)for(const kt of xt)kt!=null&&(Ct>kt||Ct===void 0&&kt>=kt)&&(Ct=kt);else{let kt=-1;for(let Mt of xt)(Mt=$t(Mt,++kt,xt))!=null&&(Ct>Mt||Ct===void 0&&Mt>=Mt)&&(Ct=Mt)}return Ct}function quickselect(xt,$t,Ct=0,kt=1/0,Mt){if($t=Math.floor($t),Ct=Math.floor(Math.max(0,Ct)),kt=Math.floor(Math.min(xt.length-1,kt)),!(Ct<=$t&&$t<=kt))return xt;for(Mt=Mt===void 0?ascendingDefined:compareDefined(Mt);kt>Ct;){if(kt-Ct>600){const Vt=kt-Ct+1,zt=$t-Ct+1,Ht=Math.log(Vt),Gt=.5*Math.exp(2*Ht/3),qt=.5*Math.sqrt(Ht*Gt*(Vt-Gt)/Vt)*(zt-Vt/2<0?-1:1),Wt=Math.max(Ct,Math.floor($t-zt*Gt/Vt+qt)),Yt=Math.min(kt,Math.floor($t+(Vt-zt)*Gt/Vt+qt));quickselect(xt,$t,Wt,Yt,Mt)}const Ft=xt[$t];let jt=Ct,Bt=kt;for(swap$1(xt,Ct,$t),Mt(xt[kt],Ft)>0&&swap$1(xt,Ct,kt);jt<Bt;){for(swap$1(xt,jt,Bt),++jt,--Bt;Mt(xt[jt],Ft)<0;)++jt;for(;Mt(xt[Bt],Ft)>0;)--Bt}Mt(xt[Ct],Ft)===0?swap$1(xt,Ct,Bt):(++Bt,swap$1(xt,Bt,kt)),Bt<=$t&&(Ct=Bt+1),$t<=Bt&&(kt=Bt-1)}return xt}function swap$1(xt,$t,Ct){const kt=xt[$t];xt[$t]=xt[Ct],xt[Ct]=kt}function quantile$2(xt,$t,Ct){if(xt=Float64Array.from(numbers$2(xt,Ct)),!(!(kt=xt.length)||isNaN($t=+$t))){if($t<=0||kt<2)return min$4(xt);if($t>=1)return max$4(xt);var kt,Mt=(kt-1)*$t,Ft=Math.floor(Mt),jt=max$4(quickselect(xt,Ft).subarray(0,Ft+1)),Bt=min$4(xt.subarray(Ft+1));return jt+(Bt-jt)*(Mt-Ft)}}function quantileSorted(xt,$t,Ct=number$6){if(!(!(kt=xt.length)||isNaN($t=+$t))){if($t<=0||kt<2)return+Ct(xt[0],0,xt);if($t>=1)return+Ct(xt[kt-1],kt-1,xt);var kt,Mt=(kt-1)*$t,Ft=Math.floor(Mt),jt=+Ct(xt[Ft],Ft,xt),Bt=+Ct(xt[Ft+1],Ft+1,xt);return jt+(Bt-jt)*(Mt-Ft)}}function mean(xt,$t){let Ct=0,kt=0;if($t===void 0)for(let Mt of xt)Mt!=null&&(Mt=+Mt)>=Mt&&(++Ct,kt+=Mt);else{let Mt=-1;for(let Ft of xt)(Ft=$t(Ft,++Mt,xt))!=null&&(Ft=+Ft)>=Ft&&(++Ct,kt+=Ft)}if(Ct)return kt/Ct}function median(xt,$t){return quantile$2(xt,.5,$t)}function*flatten(xt){for(const $t of xt)yield*$t}function merge$4(xt){return Array.from(flatten(xt))}function range$6(xt,$t,Ct){xt=+xt,$t=+$t,Ct=(Mt=arguments.length)<2?($t=xt,xt=0,1):Mt<3?1:+Ct;for(var kt=-1,Mt=Math.max(0,Math.ceil(($t-xt)/Ct))|0,Ft=new Array(Mt);++kt<Mt;)Ft[kt]=xt+kt*Ct;return Ft}function sum$2(xt,$t){let Ct=0;for(let kt of xt)(kt=+kt)&&(Ct+=kt);return Ct}function intersection(xt,...$t){xt=new InternSet(xt),$t=$t.map(set$6);e:for(const Ct of xt)for(const kt of $t)if(!kt.has(Ct)){xt.delete(Ct);continue e}return xt}function set$6(xt){return xt instanceof InternSet?xt:new InternSet(xt)}function union(...xt){const $t=new InternSet;for(const Ct of xt)for(const kt of Ct)$t.add(kt);return $t}var noop$7={value:()=>{}};function dispatch(){for(var xt=0,$t=arguments.length,Ct={},kt;xt<$t;++xt){if(!(kt=arguments[xt]+"")||kt in Ct||/[\s.]/.test(kt))throw new Error("illegal type: "+kt);Ct[kt]=[]}return new Dispatch(Ct)}function Dispatch(xt){this._=xt}function parseTypenames$1(xt,$t){return xt.trim().split(/^|\s+/).map(function(Ct){var kt="",Mt=Ct.indexOf(".");if(Mt>=0&&(kt=Ct.slice(Mt+1),Ct=Ct.slice(0,Mt)),Ct&&!$t.hasOwnProperty(Ct))throw new Error("unknown type: "+Ct);return{type:Ct,name:kt}})}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(xt,$t){var Ct=this._,kt=parseTypenames$1(xt+"",Ct),Mt,Ft=-1,jt=kt.length;if(arguments.length<2){for(;++Ft<jt;)if((Mt=(xt=kt[Ft]).type)&&(Mt=get$7(Ct[Mt],xt.name)))return Mt;return}if($t!=null&&typeof $t!="function")throw new Error("invalid callback: "+$t);for(;++Ft<jt;)if(Mt=(xt=kt[Ft]).type)Ct[Mt]=set$5(Ct[Mt],xt.name,$t);else if($t==null)for(Mt in Ct)Ct[Mt]=set$5(Ct[Mt],xt.name,null);return this},copy:function(){var xt={},$t=this._;for(var Ct in $t)xt[Ct]=$t[Ct].slice();return new Dispatch(xt)},call:function(xt,$t){if((Mt=arguments.length-2)>0)for(var Ct=new Array(Mt),kt=0,Mt,Ft;kt<Mt;++kt)Ct[kt]=arguments[kt+2];if(!this._.hasOwnProperty(xt))throw new Error("unknown type: "+xt);for(Ft=this._[xt],kt=0,Mt=Ft.length;kt<Mt;++kt)Ft[kt].value.apply($t,Ct)},apply:function(xt,$t,Ct){if(!this._.hasOwnProperty(xt))throw new Error("unknown type: "+xt);for(var kt=this._[xt],Mt=0,Ft=kt.length;Mt<Ft;++Mt)kt[Mt].value.apply($t,Ct)}};function get$7(xt,$t){for(var Ct=0,kt=xt.length,Mt;Ct<kt;++Ct)if((Mt=xt[Ct]).name===$t)return Mt.value}function set$5(xt,$t,Ct){for(var kt=0,Mt=xt.length;kt<Mt;++kt)if(xt[kt].name===$t){xt[kt]=noop$7,xt=xt.slice(0,kt).concat(xt.slice(kt+1));break}return Ct!=null&&xt.push({name:$t,value:Ct}),xt}var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(xt){var $t=xt+="",Ct=$t.indexOf(":");return Ct>=0&&($t=xt.slice(0,Ct))!=="xmlns"&&(xt=xt.slice(Ct+1)),namespaces.hasOwnProperty($t)?{space:namespaces[$t],local:xt}:xt}function creatorInherit(xt){return function(){var $t=this.ownerDocument,Ct=this.namespaceURI;return Ct===xhtml&&$t.documentElement.namespaceURI===xhtml?$t.createElement(xt):$t.createElementNS(Ct,xt)}}function creatorFixed(xt){return function(){return this.ownerDocument.createElementNS(xt.space,xt.local)}}function creator(xt){var $t=namespace(xt);return($t.local?creatorFixed:creatorInherit)($t)}function none$2(){}function selector(xt){return xt==null?none$2:function(){return this.querySelector(xt)}}function selection_select(xt){typeof xt!="function"&&(xt=selector(xt));for(var $t=this._groups,Ct=$t.length,kt=new Array(Ct),Mt=0;Mt<Ct;++Mt)for(var Ft=$t[Mt],jt=Ft.length,Bt=kt[Mt]=new Array(jt),Vt,zt,Ht=0;Ht<jt;++Ht)(Vt=Ft[Ht])&&(zt=xt.call(Vt,Vt.__data__,Ht,Ft))&&("__data__"in Vt&&(zt.__data__=Vt.__data__),Bt[Ht]=zt);return new Selection$2(kt,this._parents)}function array$9(xt){return xt==null?[]:Array.isArray(xt)?xt:Array.from(xt)}function empty$3(){return[]}function selectorAll(xt){return xt==null?empty$3:function(){return this.querySelectorAll(xt)}}function arrayAll(xt){return function(){return array$9(xt.apply(this,arguments))}}function selection_selectAll(xt){typeof xt=="function"?xt=arrayAll(xt):xt=selectorAll(xt);for(var $t=this._groups,Ct=$t.length,kt=[],Mt=[],Ft=0;Ft<Ct;++Ft)for(var jt=$t[Ft],Bt=jt.length,Vt,zt=0;zt<Bt;++zt)(Vt=jt[zt])&&(kt.push(xt.call(Vt,Vt.__data__,zt,jt)),Mt.push(Vt));return new Selection$2(kt,Mt)}function matcher(xt){return function(){return this.matches(xt)}}function childMatcher(xt){return function($t){return $t.matches(xt)}}var find$5=Array.prototype.find;function childFind(xt){return function(){return find$5.call(this.children,xt)}}function childFirst(){return this.firstElementChild}function selection_selectChild(xt){return this.select(xt==null?childFirst:childFind(typeof xt=="function"?xt:childMatcher(xt)))}var filter$2=Array.prototype.filter;function children$2(){return Array.from(this.children)}function childrenFilter(xt){return function(){return filter$2.call(this.children,xt)}}function selection_selectChildren(xt){return this.selectAll(xt==null?children$2:childrenFilter(typeof xt=="function"?xt:childMatcher(xt)))}function selection_filter(xt){typeof xt!="function"&&(xt=matcher(xt));for(var $t=this._groups,Ct=$t.length,kt=new Array(Ct),Mt=0;Mt<Ct;++Mt)for(var Ft=$t[Mt],jt=Ft.length,Bt=kt[Mt]=[],Vt,zt=0;zt<jt;++zt)(Vt=Ft[zt])&&xt.call(Vt,Vt.__data__,zt,Ft)&&Bt.push(Vt);return new Selection$2(kt,this._parents)}function sparse(xt){return new Array(xt.length)}function selection_enter(){return new Selection$2(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(xt,$t){this.ownerDocument=xt.ownerDocument,this.namespaceURI=xt.namespaceURI,this._next=null,this._parent=xt,this.__data__=$t}EnterNode.prototype={constructor:EnterNode,appendChild:function(xt){return this._parent.insertBefore(xt,this._next)},insertBefore:function(xt,$t){return this._parent.insertBefore(xt,$t)},querySelector:function(xt){return this._parent.querySelector(xt)},querySelectorAll:function(xt){return this._parent.querySelectorAll(xt)}};function constant$7(xt){return function(){return xt}}function bindIndex(xt,$t,Ct,kt,Mt,Ft){for(var jt=0,Bt,Vt=$t.length,zt=Ft.length;jt<zt;++jt)(Bt=$t[jt])?(Bt.__data__=Ft[jt],kt[jt]=Bt):Ct[jt]=new EnterNode(xt,Ft[jt]);for(;jt<Vt;++jt)(Bt=$t[jt])&&(Mt[jt]=Bt)}function bindKey(xt,$t,Ct,kt,Mt,Ft,jt){var Bt,Vt,zt=new Map,Ht=$t.length,Gt=Ft.length,qt=new Array(Ht),Wt;for(Bt=0;Bt<Ht;++Bt)(Vt=$t[Bt])&&(qt[Bt]=Wt=jt.call(Vt,Vt.__data__,Bt,$t)+"",zt.has(Wt)?Mt[Bt]=Vt:zt.set(Wt,Vt));for(Bt=0;Bt<Gt;++Bt)Wt=jt.call(xt,Ft[Bt],Bt,Ft)+"",(Vt=zt.get(Wt))?(kt[Bt]=Vt,Vt.__data__=Ft[Bt],zt.delete(Wt)):Ct[Bt]=new EnterNode(xt,Ft[Bt]);for(Bt=0;Bt<Ht;++Bt)(Vt=$t[Bt])&&zt.get(qt[Bt])===Vt&&(Mt[Bt]=Vt)}function datum$1(xt){return xt.__data__}function selection_data(xt,$t){if(!arguments.length)return Array.from(this,datum$1);var Ct=$t?bindKey:bindIndex,kt=this._parents,Mt=this._groups;typeof xt!="function"&&(xt=constant$7(xt));for(var Ft=Mt.length,jt=new Array(Ft),Bt=new Array(Ft),Vt=new Array(Ft),zt=0;zt<Ft;++zt){var Ht=kt[zt],Gt=Mt[zt],qt=Gt.length,Wt=arraylike(xt.call(Ht,Ht&&Ht.__data__,zt,kt)),Yt=Wt.length,Kt=Bt[zt]=new Array(Yt),Xt=jt[zt]=new Array(Yt),Qt=Vt[zt]=new Array(qt);Ct(Ht,Gt,Kt,Xt,Qt,Wt,$t);for(var Jt=0,Zt=0,sn,ln;Jt<Yt;++Jt)if(sn=Kt[Jt]){for(Jt>=Zt&&(Zt=Jt+1);!(ln=Xt[Zt])&&++Zt<Yt;);sn._next=ln||null}}return jt=new Selection$2(jt,kt),jt._enter=Bt,jt._exit=Vt,jt}function arraylike(xt){return typeof xt=="object"&&"length"in xt?xt:Array.from(xt)}function selection_exit(){return new Selection$2(this._exit||this._groups.map(sparse),this._parents)}function selection_join(xt,$t,Ct){var kt=this.enter(),Mt=this,Ft=this.exit();return typeof xt=="function"?(kt=xt(kt),kt&&(kt=kt.selection())):kt=kt.append(xt+""),$t!=null&&(Mt=$t(Mt),Mt&&(Mt=Mt.selection())),Ct==null?Ft.remove():Ct(Ft),kt&&Mt?kt.merge(Mt).order():Mt}function selection_merge(xt){for(var $t=xt.selection?xt.selection():xt,Ct=this._groups,kt=$t._groups,Mt=Ct.length,Ft=kt.length,jt=Math.min(Mt,Ft),Bt=new Array(Mt),Vt=0;Vt<jt;++Vt)for(var zt=Ct[Vt],Ht=kt[Vt],Gt=zt.length,qt=Bt[Vt]=new Array(Gt),Wt,Yt=0;Yt<Gt;++Yt)(Wt=zt[Yt]||Ht[Yt])&&(qt[Yt]=Wt);for(;Vt<Mt;++Vt)Bt[Vt]=Ct[Vt];return new Selection$2(Bt,this._parents)}function selection_order(){for(var xt=this._groups,$t=-1,Ct=xt.length;++$t<Ct;)for(var kt=xt[$t],Mt=kt.length-1,Ft=kt[Mt],jt;--Mt>=0;)(jt=kt[Mt])&&(Ft&&jt.compareDocumentPosition(Ft)^4&&Ft.parentNode.insertBefore(jt,Ft),Ft=jt);return this}function selection_sort(xt){xt||(xt=ascending$3);function $t(Gt,qt){return Gt&&qt?xt(Gt.__data__,qt.__data__):!Gt-!qt}for(var Ct=this._groups,kt=Ct.length,Mt=new Array(kt),Ft=0;Ft<kt;++Ft){for(var jt=Ct[Ft],Bt=jt.length,Vt=Mt[Ft]=new Array(Bt),zt,Ht=0;Ht<Bt;++Ht)(zt=jt[Ht])&&(Vt[Ht]=zt);Vt.sort($t)}return new Selection$2(Mt,this._parents).order()}function ascending$3(xt,$t){return xt<$t?-1:xt>$t?1:xt>=$t?0:NaN}function selection_call(){var xt=arguments[0];return arguments[0]=this,xt.apply(null,arguments),this}function selection_nodes(){return Array.from(this)}function selection_node(){for(var xt=this._groups,$t=0,Ct=xt.length;$t<Ct;++$t)for(var kt=xt[$t],Mt=0,Ft=kt.length;Mt<Ft;++Mt){var jt=kt[Mt];if(jt)return jt}return null}function selection_size(){let xt=0;for(const $t of this)++xt;return xt}function selection_empty(){return!this.node()}function selection_each(xt){for(var $t=this._groups,Ct=0,kt=$t.length;Ct<kt;++Ct)for(var Mt=$t[Ct],Ft=0,jt=Mt.length,Bt;Ft<jt;++Ft)(Bt=Mt[Ft])&&xt.call(Bt,Bt.__data__,Ft,Mt);return this}function attrRemove$1(xt){return function(){this.removeAttribute(xt)}}function attrRemoveNS$1(xt){return function(){this.removeAttributeNS(xt.space,xt.local)}}function attrConstant$1(xt,$t){return function(){this.setAttribute(xt,$t)}}function attrConstantNS$1(xt,$t){return function(){this.setAttributeNS(xt.space,xt.local,$t)}}function attrFunction$1(xt,$t){return function(){var Ct=$t.apply(this,arguments);Ct==null?this.removeAttribute(xt):this.setAttribute(xt,Ct)}}function attrFunctionNS$1(xt,$t){return function(){var Ct=$t.apply(this,arguments);Ct==null?this.removeAttributeNS(xt.space,xt.local):this.setAttributeNS(xt.space,xt.local,Ct)}}function selection_attr(xt,$t){var Ct=namespace(xt);if(arguments.length<2){var kt=this.node();return Ct.local?kt.getAttributeNS(Ct.space,Ct.local):kt.getAttribute(Ct)}return this.each(($t==null?Ct.local?attrRemoveNS$1:attrRemove$1:typeof $t=="function"?Ct.local?attrFunctionNS$1:attrFunction$1:Ct.local?attrConstantNS$1:attrConstant$1)(Ct,$t))}function defaultView(xt){return xt.ownerDocument&&xt.ownerDocument.defaultView||xt.document&&xt||xt.defaultView}function styleRemove$1(xt){return function(){this.style.removeProperty(xt)}}function styleConstant$1(xt,$t,Ct){return function(){this.style.setProperty(xt,$t,Ct)}}function styleFunction$1(xt,$t,Ct){return function(){var kt=$t.apply(this,arguments);kt==null?this.style.removeProperty(xt):this.style.setProperty(xt,kt,Ct)}}function selection_style(xt,$t,Ct){return arguments.length>1?this.each(($t==null?styleRemove$1:typeof $t=="function"?styleFunction$1:styleConstant$1)(xt,$t,Ct??"")):styleValue(this.node(),xt)}function styleValue(xt,$t){return xt.style.getPropertyValue($t)||defaultView(xt).getComputedStyle(xt,null).getPropertyValue($t)}function propertyRemove(xt){return function(){delete this[xt]}}function propertyConstant(xt,$t){return function(){this[xt]=$t}}function propertyFunction(xt,$t){return function(){var Ct=$t.apply(this,arguments);Ct==null?delete this[xt]:this[xt]=Ct}}function selection_property(xt,$t){return arguments.length>1?this.each(($t==null?propertyRemove:typeof $t=="function"?propertyFunction:propertyConstant)(xt,$t)):this.node()[xt]}function classArray(xt){return xt.trim().split(/^|\s+/)}function classList(xt){return xt.classList||new ClassList(xt)}function ClassList(xt){this._node=xt,this._names=classArray(xt.getAttribute("class")||"")}ClassList.prototype={add:function(xt){var $t=this._names.indexOf(xt);$t<0&&(this._names.push(xt),this._node.setAttribute("class",this._names.join(" ")))},remove:function(xt){var $t=this._names.indexOf(xt);$t>=0&&(this._names.splice($t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(xt){return this._names.indexOf(xt)>=0}};function classedAdd(xt,$t){for(var Ct=classList(xt),kt=-1,Mt=$t.length;++kt<Mt;)Ct.add($t[kt])}function classedRemove(xt,$t){for(var Ct=classList(xt),kt=-1,Mt=$t.length;++kt<Mt;)Ct.remove($t[kt])}function classedTrue(xt){return function(){classedAdd(this,xt)}}function classedFalse(xt){return function(){classedRemove(this,xt)}}function classedFunction(xt,$t){return function(){($t.apply(this,arguments)?classedAdd:classedRemove)(this,xt)}}function selection_classed(xt,$t){var Ct=classArray(xt+"");if(arguments.length<2){for(var kt=classList(this.node()),Mt=-1,Ft=Ct.length;++Mt<Ft;)if(!kt.contains(Ct[Mt]))return!1;return!0}return this.each((typeof $t=="function"?classedFunction:$t?classedTrue:classedFalse)(Ct,$t))}function textRemove(){this.textContent=""}function textConstant$1(xt){return function(){this.textContent=xt}}function textFunction$1(xt){return function(){var $t=xt.apply(this,arguments);this.textContent=$t??""}}function selection_text(xt){return arguments.length?this.each(xt==null?textRemove:(typeof xt=="function"?textFunction$1:textConstant$1)(xt)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(xt){return function(){this.innerHTML=xt}}function htmlFunction(xt){return function(){var $t=xt.apply(this,arguments);this.innerHTML=$t??""}}function selection_html(xt){return arguments.length?this.each(xt==null?htmlRemove:(typeof xt=="function"?htmlFunction:htmlConstant)(xt)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(xt){var $t=typeof xt=="function"?xt:creator(xt);return this.select(function(){return this.appendChild($t.apply(this,arguments))})}function constantNull(){return null}function selection_insert(xt,$t){var Ct=typeof xt=="function"?xt:creator(xt),kt=$t==null?constantNull:typeof $t=="function"?$t:selector($t);return this.select(function(){return this.insertBefore(Ct.apply(this,arguments),kt.apply(this,arguments)||null)})}function remove$1(){var xt=this.parentNode;xt&&xt.removeChild(this)}function selection_remove(){return this.each(remove$1)}function selection_cloneShallow(){var xt=this.cloneNode(!1),$t=this.parentNode;return $t?$t.insertBefore(xt,this.nextSibling):xt}function selection_cloneDeep(){var xt=this.cloneNode(!0),$t=this.parentNode;return $t?$t.insertBefore(xt,this.nextSibling):xt}function selection_clone(xt){return this.select(xt?selection_cloneDeep:selection_cloneShallow)}function selection_datum(xt){return arguments.length?this.property("__data__",xt):this.node().__data__}function contextListener(xt){return function($t){xt.call(this,$t,this.__data__)}}function parseTypenames(xt){return xt.trim().split(/^|\s+/).map(function($t){var Ct="",kt=$t.indexOf(".");return kt>=0&&(Ct=$t.slice(kt+1),$t=$t.slice(0,kt)),{type:$t,name:Ct}})}function onRemove(xt){return function(){var $t=this.__on;if($t){for(var Ct=0,kt=-1,Mt=$t.length,Ft;Ct<Mt;++Ct)Ft=$t[Ct],(!xt.type||Ft.type===xt.type)&&Ft.name===xt.name?this.removeEventListener(Ft.type,Ft.listener,Ft.options):$t[++kt]=Ft;++kt?$t.length=kt:delete this.__on}}}function onAdd(xt,$t,Ct){return function(){var kt=this.__on,Mt,Ft=contextListener($t);if(kt){for(var jt=0,Bt=kt.length;jt<Bt;++jt)if((Mt=kt[jt]).type===xt.type&&Mt.name===xt.name){this.removeEventListener(Mt.type,Mt.listener,Mt.options),this.addEventListener(Mt.type,Mt.listener=Ft,Mt.options=Ct),Mt.value=$t;return}}this.addEventListener(xt.type,Ft,Ct),Mt={type:xt.type,name:xt.name,value:$t,listener:Ft,options:Ct},kt?kt.push(Mt):this.__on=[Mt]}}function selection_on(xt,$t,Ct){var kt=parseTypenames(xt+""),Mt,Ft=kt.length,jt;if(arguments.length<2){var Bt=this.node().__on;if(Bt){for(var Vt=0,zt=Bt.length,Ht;Vt<zt;++Vt)for(Mt=0,Ht=Bt[Vt];Mt<Ft;++Mt)if((jt=kt[Mt]).type===Ht.type&&jt.name===Ht.name)return Ht.value}return}for(Bt=$t?onAdd:onRemove,Mt=0;Mt<Ft;++Mt)this.each(Bt(kt[Mt],$t,Ct));return this}function dispatchEvent(xt,$t,Ct){var kt=defaultView(xt),Mt=kt.CustomEvent;typeof Mt=="function"?Mt=new Mt($t,Ct):(Mt=kt.document.createEvent("Event"),Ct?(Mt.initEvent($t,Ct.bubbles,Ct.cancelable),Mt.detail=Ct.detail):Mt.initEvent($t,!1,!1)),xt.dispatchEvent(Mt)}function dispatchConstant(xt,$t){return function(){return dispatchEvent(this,xt,$t)}}function dispatchFunction(xt,$t){return function(){return dispatchEvent(this,xt,$t.apply(this,arguments))}}function selection_dispatch(xt,$t){return this.each((typeof $t=="function"?dispatchFunction:dispatchConstant)(xt,$t))}function*selection_iterator(){for(var xt=this._groups,$t=0,Ct=xt.length;$t<Ct;++$t)for(var kt=xt[$t],Mt=0,Ft=kt.length,jt;Mt<Ft;++Mt)(jt=kt[Mt])&&(yield jt)}var root$1=[null];function Selection$2(xt,$t){this._groups=xt,this._parents=$t}function selection(){return new Selection$2([[document.documentElement]],root$1)}function selection_selection(){return this}Selection$2.prototype=selection.prototype={constructor:Selection$2,select:selection_select,selectAll:selection_selectAll,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,selection:selection_selection,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch,[Symbol.iterator]:selection_iterator};function select$1(xt){return typeof xt=="string"?new Selection$2([[document.querySelector(xt)]],[document.documentElement]):new Selection$2([[xt]],root$1)}function sourceEvent(xt){let $t;for(;$t=xt.sourceEvent;)xt=$t;return xt}function pointer(xt,$t){if(xt=sourceEvent(xt),$t===void 0&&($t=xt.currentTarget),$t){var Ct=$t.ownerSVGElement||$t;if(Ct.createSVGPoint){var kt=Ct.createSVGPoint();return kt.x=xt.clientX,kt.y=xt.clientY,kt=kt.matrixTransform($t.getScreenCTM().inverse()),[kt.x,kt.y]}if($t.getBoundingClientRect){var Mt=$t.getBoundingClientRect();return[xt.clientX-Mt.left-$t.clientLeft,xt.clientY-Mt.top-$t.clientTop]}}return[xt.pageX,xt.pageY]}function selectAll(xt){return typeof xt=="string"?new Selection$2([document.querySelectorAll(xt)],[document.documentElement]):new Selection$2([array$9(xt)],root$1)}const nonpassivecapture={capture:!0,passive:!1};function noevent$1(xt){xt.preventDefault(),xt.stopImmediatePropagation()}function dragDisable(xt){var $t=xt.document.documentElement,Ct=select$1(xt).on("dragstart.drag",noevent$1,nonpassivecapture);"onselectstart"in $t?Ct.on("selectstart.drag",noevent$1,nonpassivecapture):($t.__noselect=$t.style.MozUserSelect,$t.style.MozUserSelect="none")}function yesdrag(xt,$t){var Ct=xt.document.documentElement,kt=select$1(xt).on("dragstart.drag",null);$t&&(kt.on("click.drag",noevent$1,nonpassivecapture),setTimeout(function(){kt.on("click.drag",null)},0)),"onselectstart"in Ct?kt.on("selectstart.drag",null):(Ct.style.MozUserSelect=Ct.__noselect,delete Ct.__noselect)}function define(xt,$t,Ct){xt.prototype=$t.prototype=Ct,Ct.constructor=xt}function extend$1(xt,$t){var Ct=Object.create(xt.prototype);for(var kt in $t)Ct[kt]=$t[kt];return Ct}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color$3,{copy(xt){return Object.assign(new this.constructor,this,xt)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color$3(xt){var $t,Ct;return xt=(xt+"").trim().toLowerCase(),($t=reHex.exec(xt))?(Ct=$t[1].length,$t=parseInt($t[1],16),Ct===6?rgbn($t):Ct===3?new Rgb($t>>8&15|$t>>4&240,$t>>4&15|$t&240,($t&15)<<4|$t&15,1):Ct===8?rgba($t>>24&255,$t>>16&255,$t>>8&255,($t&255)/255):Ct===4?rgba($t>>12&15|$t>>8&240,$t>>8&15|$t>>4&240,$t>>4&15|$t&240,(($t&15)<<4|$t&15)/255):null):($t=reRgbInteger.exec(xt))?new Rgb($t[1],$t[2],$t[3],1):($t=reRgbPercent.exec(xt))?new Rgb($t[1]*255/100,$t[2]*255/100,$t[3]*255/100,1):($t=reRgbaInteger.exec(xt))?rgba($t[1],$t[2],$t[3],$t[4]):($t=reRgbaPercent.exec(xt))?rgba($t[1]*255/100,$t[2]*255/100,$t[3]*255/100,$t[4]):($t=reHslPercent.exec(xt))?hsla($t[1],$t[2]/100,$t[3]/100,1):($t=reHslaPercent.exec(xt))?hsla($t[1],$t[2]/100,$t[3]/100,$t[4]):named.hasOwnProperty(xt)?rgbn(named[xt]):xt==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(xt){return new Rgb(xt>>16&255,xt>>8&255,xt&255,1)}function rgba(xt,$t,Ct,kt){return kt<=0&&(xt=$t=Ct=NaN),new Rgb(xt,$t,Ct,kt)}function rgbConvert(xt){return xt instanceof Color||(xt=color$3(xt)),xt?(xt=xt.rgb(),new Rgb(xt.r,xt.g,xt.b,xt.opacity)):new Rgb}function rgb(xt,$t,Ct,kt){return arguments.length===1?rgbConvert(xt):new Rgb(xt,$t,Ct,kt??1)}function Rgb(xt,$t,Ct,kt){this.r=+xt,this.g=+$t,this.b=+Ct,this.opacity=+kt}define(Rgb,rgb,extend$1(Color,{brighter(xt){return xt=xt==null?brighter:Math.pow(brighter,xt),new Rgb(this.r*xt,this.g*xt,this.b*xt,this.opacity)},darker(xt){return xt=xt==null?darker:Math.pow(darker,xt),new Rgb(this.r*xt,this.g*xt,this.b*xt,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex$1(this.r)}${hex$1(this.g)}${hex$1(this.b)}`}function rgb_formatHex8(){return`#${hex$1(this.r)}${hex$1(this.g)}${hex$1(this.b)}${hex$1((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const xt=clampa(this.opacity);return`${xt===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${xt===1?")":`, ${xt})`}`}function clampa(xt){return isNaN(xt)?1:Math.max(0,Math.min(1,xt))}function clampi(xt){return Math.max(0,Math.min(255,Math.round(xt)||0))}function hex$1(xt){return xt=clampi(xt),(xt<16?"0":"")+xt.toString(16)}function hsla(xt,$t,Ct,kt){return kt<=0?xt=$t=Ct=NaN:Ct<=0||Ct>=1?xt=$t=NaN:$t<=0&&(xt=NaN),new Hsl(xt,$t,Ct,kt)}function hslConvert(xt){if(xt instanceof Hsl)return new Hsl(xt.h,xt.s,xt.l,xt.opacity);if(xt instanceof Color||(xt=color$3(xt)),!xt)return new Hsl;if(xt instanceof Hsl)return xt;xt=xt.rgb();var $t=xt.r/255,Ct=xt.g/255,kt=xt.b/255,Mt=Math.min($t,Ct,kt),Ft=Math.max($t,Ct,kt),jt=NaN,Bt=Ft-Mt,Vt=(Ft+Mt)/2;return Bt?($t===Ft?jt=(Ct-kt)/Bt+(Ct<kt)*6:Ct===Ft?jt=(kt-$t)/Bt+2:jt=($t-Ct)/Bt+4,Bt/=Vt<.5?Ft+Mt:2-Ft-Mt,jt*=60):Bt=Vt>0&&Vt<1?0:jt,new Hsl(jt,Bt,Vt,xt.opacity)}function hsl$2(xt,$t,Ct,kt){return arguments.length===1?hslConvert(xt):new Hsl(xt,$t,Ct,kt??1)}function Hsl(xt,$t,Ct,kt){this.h=+xt,this.s=+$t,this.l=+Ct,this.opacity=+kt}define(Hsl,hsl$2,extend$1(Color,{brighter(xt){return xt=xt==null?brighter:Math.pow(brighter,xt),new Hsl(this.h,this.s,this.l*xt,this.opacity)},darker(xt){return xt=xt==null?darker:Math.pow(darker,xt),new Hsl(this.h,this.s,this.l*xt,this.opacity)},rgb(){var xt=this.h%360+(this.h<0)*360,$t=isNaN(xt)||isNaN(this.s)?0:this.s,Ct=this.l,kt=Ct+(Ct<.5?Ct:1-Ct)*$t,Mt=2*Ct-kt;return new Rgb(hsl2rgb(xt>=240?xt-240:xt+120,Mt,kt),hsl2rgb(xt,Mt,kt),hsl2rgb(xt<120?xt+240:xt-120,Mt,kt),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const xt=clampa(this.opacity);return`${xt===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${xt===1?")":`, ${xt})`}`}}));function clamph(xt){return xt=(xt||0)%360,xt<0?xt+360:xt}function clampt(xt){return Math.max(0,Math.min(1,xt||0))}function hsl2rgb(xt,$t,Ct){return(xt<60?$t+(Ct-$t)*xt/60:xt<180?Ct:xt<240?$t+(Ct-$t)*(240-xt)/60:$t)*255}const radians$1=Math.PI/180,degrees$2=180/Math.PI,K$1=18,Xn=.96422,Yn=1,Zn=.82521,t0$3=4/29,t1$2=6/29,t2=3*t1$2*t1$2,t3=t1$2*t1$2*t1$2;function labConvert(xt){if(xt instanceof Lab)return new Lab(xt.l,xt.a,xt.b,xt.opacity);if(xt instanceof Hcl)return hcl2lab(xt);xt instanceof Rgb||(xt=rgbConvert(xt));var $t=rgb2lrgb(xt.r),Ct=rgb2lrgb(xt.g),kt=rgb2lrgb(xt.b),Mt=xyz2lab((.2225045*$t+.7168786*Ct+.0606169*kt)/Yn),Ft,jt;return $t===Ct&&Ct===kt?Ft=jt=Mt:(Ft=xyz2lab((.4360747*$t+.3850649*Ct+.1430804*kt)/Xn),jt=xyz2lab((.0139322*$t+.0971045*Ct+.7141733*kt)/Zn)),new Lab(116*Mt-16,500*(Ft-Mt),200*(Mt-jt),xt.opacity)}function lab$1(xt,$t,Ct,kt){return arguments.length===1?labConvert(xt):new Lab(xt,$t,Ct,kt??1)}function Lab(xt,$t,Ct,kt){this.l=+xt,this.a=+$t,this.b=+Ct,this.opacity=+kt}define(Lab,lab$1,extend$1(Color,{brighter(xt){return new Lab(this.l+K$1*(xt??1),this.a,this.b,this.opacity)},darker(xt){return new Lab(this.l-K$1*(xt??1),this.a,this.b,this.opacity)},rgb(){var xt=(this.l+16)/116,$t=isNaN(this.a)?xt:xt+this.a/500,Ct=isNaN(this.b)?xt:xt-this.b/200;return $t=Xn*lab2xyz($t),xt=Yn*lab2xyz(xt),Ct=Zn*lab2xyz(Ct),new Rgb(lrgb2rgb(3.1338561*$t-1.6168667*xt-.4906146*Ct),lrgb2rgb(-.9787684*$t+1.9161415*xt+.033454*Ct),lrgb2rgb(.0719453*$t-.2289914*xt+1.4052427*Ct),this.opacity)}}));function xyz2lab(xt){return xt>t3?Math.pow(xt,1/3):xt/t2+t0$3}function lab2xyz(xt){return xt>t1$2?xt*xt*xt:t2*(xt-t0$3)}function lrgb2rgb(xt){return 255*(xt<=.0031308?12.92*xt:1.055*Math.pow(xt,1/2.4)-.055)}function rgb2lrgb(xt){return(xt/=255)<=.04045?xt/12.92:Math.pow((xt+.055)/1.055,2.4)}function hclConvert(xt){if(xt instanceof Hcl)return new Hcl(xt.h,xt.c,xt.l,xt.opacity);if(xt instanceof Lab||(xt=labConvert(xt)),xt.a===0&&xt.b===0)return new Hcl(NaN,0<xt.l&&xt.l<100?0:NaN,xt.l,xt.opacity);var $t=Math.atan2(xt.b,xt.a)*degrees$2;return new Hcl($t<0?$t+360:$t,Math.sqrt(xt.a*xt.a+xt.b*xt.b),xt.l,xt.opacity)}function hcl$2(xt,$t,Ct,kt){return arguments.length===1?hclConvert(xt):new Hcl(xt,$t,Ct,kt??1)}function Hcl(xt,$t,Ct,kt){this.h=+xt,this.c=+$t,this.l=+Ct,this.opacity=+kt}function hcl2lab(xt){if(isNaN(xt.h))return new Lab(xt.l,0,0,xt.opacity);var $t=xt.h*radians$1;return new Lab(xt.l,Math.cos($t)*xt.c,Math.sin($t)*xt.c,xt.opacity)}define(Hcl,hcl$2,extend$1(Color,{brighter(xt){return new Hcl(this.h,this.c,this.l+K$1*(xt??1),this.opacity)},darker(xt){return new Hcl(this.h,this.c,this.l-K$1*(xt??1),this.opacity)},rgb(){return hcl2lab(this).rgb()}}));var A$1=-.14861,B$3=1.78277,C$3=-.29227,D$4=-.90649,E$2=1.97294,ED=E$2*D$4,EB=E$2*B$3,BC_DA=B$3*C$3-D$4*A$1;function cubehelixConvert(xt){if(xt instanceof Cubehelix)return new Cubehelix(xt.h,xt.s,xt.l,xt.opacity);xt instanceof Rgb||(xt=rgbConvert(xt));var $t=xt.r/255,Ct=xt.g/255,kt=xt.b/255,Mt=(BC_DA*kt+ED*$t-EB*Ct)/(BC_DA+ED-EB),Ft=kt-Mt,jt=(E$2*(Ct-Mt)-C$3*Ft)/D$4,Bt=Math.sqrt(jt*jt+Ft*Ft)/(E$2*Mt*(1-Mt)),Vt=Bt?Math.atan2(jt,Ft)*degrees$2-120:NaN;return new Cubehelix(Vt<0?Vt+360:Vt,Bt,Mt,xt.opacity)}function cubehelix$2(xt,$t,Ct,kt){return arguments.length===1?cubehelixConvert(xt):new Cubehelix(xt,$t,Ct,kt??1)}function Cubehelix(xt,$t,Ct,kt){this.h=+xt,this.s=+$t,this.l=+Ct,this.opacity=+kt}define(Cubehelix,cubehelix$2,extend$1(Color,{brighter(xt){return xt=xt==null?brighter:Math.pow(brighter,xt),new Cubehelix(this.h,this.s,this.l*xt,this.opacity)},darker(xt){return xt=xt==null?darker:Math.pow(darker,xt),new Cubehelix(this.h,this.s,this.l*xt,this.opacity)},rgb(){var xt=isNaN(this.h)?0:(this.h+120)*radians$1,$t=+this.l,Ct=isNaN(this.s)?0:this.s*$t*(1-$t),kt=Math.cos(xt),Mt=Math.sin(xt);return new Rgb(255*($t+Ct*(A$1*kt+B$3*Mt)),255*($t+Ct*(C$3*kt+D$4*Mt)),255*($t+Ct*(E$2*kt)),this.opacity)}}));function basis(xt,$t,Ct,kt,Mt){var Ft=xt*xt,jt=Ft*xt;return((1-3*xt+3*Ft-jt)*$t+(4-6*Ft+3*jt)*Ct+(1+3*xt+3*Ft-3*jt)*kt+jt*Mt)/6}function basis$1(xt){var $t=xt.length-1;return function(Ct){var kt=Ct<=0?Ct=0:Ct>=1?(Ct=1,$t-1):Math.floor(Ct*$t),Mt=xt[kt],Ft=xt[kt+1],jt=kt>0?xt[kt-1]:2*Mt-Ft,Bt=kt<$t-1?xt[kt+2]:2*Ft-Mt;return basis((Ct-kt/$t)*$t,jt,Mt,Ft,Bt)}}function basisClosed(xt){var $t=xt.length;return function(Ct){var kt=Math.floor(((Ct%=1)<0?++Ct:Ct)*$t),Mt=xt[(kt+$t-1)%$t],Ft=xt[kt%$t],jt=xt[(kt+1)%$t],Bt=xt[(kt+2)%$t];return basis((Ct-kt/$t)*$t,Mt,Ft,jt,Bt)}}const constant$6=xt=>()=>xt;function linear$3(xt,$t){return function(Ct){return xt+Ct*$t}}function exponential(xt,$t,Ct){return xt=Math.pow(xt,Ct),$t=Math.pow($t,Ct)-xt,Ct=1/Ct,function(kt){return Math.pow(xt+kt*$t,Ct)}}function hue$1(xt,$t){var Ct=$t-xt;return Ct?linear$3(xt,Ct>180||Ct<-180?Ct-360*Math.round(Ct/360):Ct):constant$6(isNaN(xt)?$t:xt)}function gamma(xt){return(xt=+xt)==1?nogamma:function($t,Ct){return Ct-$t?exponential($t,Ct,xt):constant$6(isNaN($t)?Ct:$t)}}function nogamma(xt,$t){var Ct=$t-xt;return Ct?linear$3(xt,Ct):constant$6(isNaN(xt)?$t:xt)}const interpolateRgb=function xt($t){var Ct=gamma($t);function kt(Mt,Ft){var jt=Ct((Mt=rgb(Mt)).r,(Ft=rgb(Ft)).r),Bt=Ct(Mt.g,Ft.g),Vt=Ct(Mt.b,Ft.b),zt=nogamma(Mt.opacity,Ft.opacity);return function(Ht){return Mt.r=jt(Ht),Mt.g=Bt(Ht),Mt.b=Vt(Ht),Mt.opacity=zt(Ht),Mt+""}}return kt.gamma=xt,kt}(1);function rgbSpline(xt){return function($t){var Ct=$t.length,kt=new Array(Ct),Mt=new Array(Ct),Ft=new Array(Ct),jt,Bt;for(jt=0;jt<Ct;++jt)Bt=rgb($t[jt]),kt[jt]=Bt.r||0,Mt[jt]=Bt.g||0,Ft[jt]=Bt.b||0;return kt=xt(kt),Mt=xt(Mt),Ft=xt(Ft),Bt.opacity=1,function(Vt){return Bt.r=kt(Vt),Bt.g=Mt(Vt),Bt.b=Ft(Vt),Bt+""}}}var rgbBasis=rgbSpline(basis$1),rgbBasisClosed=rgbSpline(basisClosed);function numberArray(xt,$t){$t||($t=[]);var Ct=xt?Math.min($t.length,xt.length):0,kt=$t.slice(),Mt;return function(Ft){for(Mt=0;Mt<Ct;++Mt)kt[Mt]=xt[Mt]*(1-Ft)+$t[Mt]*Ft;return kt}}function isNumberArray(xt){return ArrayBuffer.isView(xt)&&!(xt instanceof DataView)}function array$8(xt,$t){return(isNumberArray($t)?numberArray:genericArray)(xt,$t)}function genericArray(xt,$t){var Ct=$t?$t.length:0,kt=xt?Math.min(Ct,xt.length):0,Mt=new Array(kt),Ft=new Array(Ct),jt;for(jt=0;jt<kt;++jt)Mt[jt]=interpolate$1$1(xt[jt],$t[jt]);for(;jt<Ct;++jt)Ft[jt]=$t[jt];return function(Bt){for(jt=0;jt<kt;++jt)Ft[jt]=Mt[jt](Bt);return Ft}}function date$3(xt,$t){var Ct=new Date;return xt=+xt,$t=+$t,function(kt){return Ct.setTime(xt*(1-kt)+$t*kt),Ct}}function interpolateNumber(xt,$t){return xt=+xt,$t=+$t,function(Ct){return xt*(1-Ct)+$t*Ct}}function object$2(xt,$t){var Ct={},kt={},Mt;(xt===null||typeof xt!="object")&&(xt={}),($t===null||typeof $t!="object")&&($t={});for(Mt in $t)Mt in xt?Ct[Mt]=interpolate$1$1(xt[Mt],$t[Mt]):kt[Mt]=$t[Mt];return function(Ft){for(Mt in Ct)kt[Mt]=Ct[Mt](Ft);return kt}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero$3(xt){return function(){return xt}}function one$2(xt){return function($t){return xt($t)+""}}function interpolateString(xt,$t){var Ct=reA.lastIndex=reB.lastIndex=0,kt,Mt,Ft,jt=-1,Bt=[],Vt=[];for(xt=xt+"",$t=$t+"";(kt=reA.exec(xt))&&(Mt=reB.exec($t));)(Ft=Mt.index)>Ct&&(Ft=$t.slice(Ct,Ft),Bt[jt]?Bt[jt]+=Ft:Bt[++jt]=Ft),(kt=kt[0])===(Mt=Mt[0])?Bt[jt]?Bt[jt]+=Mt:Bt[++jt]=Mt:(Bt[++jt]=null,Vt.push({i:jt,x:interpolateNumber(kt,Mt)})),Ct=reB.lastIndex;return Ct<$t.length&&(Ft=$t.slice(Ct),Bt[jt]?Bt[jt]+=Ft:Bt[++jt]=Ft),Bt.length<2?Vt[0]?one$2(Vt[0].x):zero$3($t):($t=Vt.length,function(zt){for(var Ht=0,Gt;Ht<$t;++Ht)Bt[(Gt=Vt[Ht]).i]=Gt.x(zt);return Bt.join("")})}function interpolate$1$1(xt,$t){var Ct=typeof $t,kt;return $t==null||Ct==="boolean"?constant$6($t):(Ct==="number"?interpolateNumber:Ct==="string"?(kt=color$3($t))?($t=kt,interpolateRgb):interpolateString:$t instanceof color$3?interpolateRgb:$t instanceof Date?date$3:isNumberArray($t)?numberArray:Array.isArray($t)?genericArray:typeof $t.valueOf!="function"&&typeof $t.toString!="function"||isNaN($t)?object$2:interpolateNumber)(xt,$t)}function discrete$1(xt){var $t=xt.length;return function(Ct){return xt[Math.max(0,Math.min($t-1,Math.floor(Ct*$t)))]}}function hue(xt,$t){var Ct=hue$1(+xt,+$t);return function(kt){var Mt=Ct(kt);return Mt-360*Math.floor(Mt/360)}}function interpolateRound(xt,$t){return xt=+xt,$t=+$t,function(Ct){return Math.round(xt*(1-Ct)+$t*Ct)}}var degrees$1=180/Math.PI,identity$7={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(xt,$t,Ct,kt,Mt,Ft){var jt,Bt,Vt;return(jt=Math.sqrt(xt*xt+$t*$t))&&(xt/=jt,$t/=jt),(Vt=xt*Ct+$t*kt)&&(Ct-=xt*Vt,kt-=$t*Vt),(Bt=Math.sqrt(Ct*Ct+kt*kt))&&(Ct/=Bt,kt/=Bt,Vt/=Bt),xt*kt<$t*Ct&&(xt=-xt,$t=-$t,Vt=-Vt,jt=-jt),{translateX:Mt,translateY:Ft,rotate:Math.atan2($t,xt)*degrees$1,skewX:Math.atan(Vt)*degrees$1,scaleX:jt,scaleY:Bt}}var svgNode;function parseCss(xt){const $t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(xt+"");return $t.isIdentity?identity$7:decompose($t.a,$t.b,$t.c,$t.d,$t.e,$t.f)}function parseSvg(xt){return xt==null||(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",xt),!(xt=svgNode.transform.baseVal.consolidate()))?identity$7:(xt=xt.matrix,decompose(xt.a,xt.b,xt.c,xt.d,xt.e,xt.f))}function interpolateTransform(xt,$t,Ct,kt){function Mt(zt){return zt.length?zt.pop()+" ":""}function Ft(zt,Ht,Gt,qt,Wt,Yt){if(zt!==Gt||Ht!==qt){var Kt=Wt.push("translate(",null,$t,null,Ct);Yt.push({i:Kt-4,x:interpolateNumber(zt,Gt)},{i:Kt-2,x:interpolateNumber(Ht,qt)})}else(Gt||qt)&&Wt.push("translate("+Gt+$t+qt+Ct)}function jt(zt,Ht,Gt,qt){zt!==Ht?(zt-Ht>180?Ht+=360:Ht-zt>180&&(zt+=360),qt.push({i:Gt.push(Mt(Gt)+"rotate(",null,kt)-2,x:interpolateNumber(zt,Ht)})):Ht&&Gt.push(Mt(Gt)+"rotate("+Ht+kt)}function Bt(zt,Ht,Gt,qt){zt!==Ht?qt.push({i:Gt.push(Mt(Gt)+"skewX(",null,kt)-2,x:interpolateNumber(zt,Ht)}):Ht&&Gt.push(Mt(Gt)+"skewX("+Ht+kt)}function Vt(zt,Ht,Gt,qt,Wt,Yt){if(zt!==Gt||Ht!==qt){var Kt=Wt.push(Mt(Wt)+"scale(",null,",",null,")");Yt.push({i:Kt-4,x:interpolateNumber(zt,Gt)},{i:Kt-2,x:interpolateNumber(Ht,qt)})}else(Gt!==1||qt!==1)&&Wt.push(Mt(Wt)+"scale("+Gt+","+qt+")")}return function(zt,Ht){var Gt=[],qt=[];return zt=xt(zt),Ht=xt(Ht),Ft(zt.translateX,zt.translateY,Ht.translateX,Ht.translateY,Gt,qt),jt(zt.rotate,Ht.rotate,Gt,qt),Bt(zt.skewX,Ht.skewX,Gt,qt),Vt(zt.scaleX,zt.scaleY,Ht.scaleX,Ht.scaleY,Gt,qt),zt=Ht=null,function(Wt){for(var Yt=-1,Kt=qt.length,Xt;++Yt<Kt;)Gt[(Xt=qt[Yt]).i]=Xt.x(Wt);return Gt.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),epsilon2$1=1e-12;function cosh(xt){return((xt=Math.exp(xt))+1/xt)/2}function sinh(xt){return((xt=Math.exp(xt))-1/xt)/2}function tanh(xt){return((xt=Math.exp(2*xt))-1)/(xt+1)}const interpolateZoom=function xt($t,Ct,kt){function Mt(Ft,jt){var Bt=Ft[0],Vt=Ft[1],zt=Ft[2],Ht=jt[0],Gt=jt[1],qt=jt[2],Wt=Ht-Bt,Yt=Gt-Vt,Kt=Wt*Wt+Yt*Yt,Xt,Qt;if(Kt<epsilon2$1)Qt=Math.log(qt/zt)/$t,Xt=function(hn){return[Bt+hn*Wt,Vt+hn*Yt,zt*Math.exp($t*hn*Qt)]};else{var Jt=Math.sqrt(Kt),Zt=(qt*qt-zt*zt+kt*Kt)/(2*zt*Ct*Jt),sn=(qt*qt-zt*zt-kt*Kt)/(2*qt*Ct*Jt),ln=Math.log(Math.sqrt(Zt*Zt+1)-Zt),dn=Math.log(Math.sqrt(sn*sn+1)-sn);Qt=(dn-ln)/$t,Xt=function(hn){var cn=hn*Qt,pn=cosh(ln),yn=zt/(Ct*Jt)*(pn*tanh($t*cn+ln)-sinh(ln));return[Bt+yn*Wt,Vt+yn*Yt,zt*pn/cosh($t*cn+ln)]}}return Xt.duration=Qt*1e3*$t/Math.SQRT2,Xt}return Mt.rho=function(Ft){var jt=Math.max(.001,+Ft),Bt=jt*jt,Vt=Bt*Bt;return xt(jt,Bt,Vt)},Mt}(Math.SQRT2,2,4);function hsl(xt){return function($t,Ct){var kt=xt(($t=hsl$2($t)).h,(Ct=hsl$2(Ct)).h),Mt=nogamma($t.s,Ct.s),Ft=nogamma($t.l,Ct.l),jt=nogamma($t.opacity,Ct.opacity);return function(Bt){return $t.h=kt(Bt),$t.s=Mt(Bt),$t.l=Ft(Bt),$t.opacity=jt(Bt),$t+""}}}const hsl$1=hsl(hue$1);var hslLong=hsl(nogamma);function lab(xt,$t){var Ct=nogamma((xt=lab$1(xt)).l,($t=lab$1($t)).l),kt=nogamma(xt.a,$t.a),Mt=nogamma(xt.b,$t.b),Ft=nogamma(xt.opacity,$t.opacity);return function(jt){return xt.l=Ct(jt),xt.a=kt(jt),xt.b=Mt(jt),xt.opacity=Ft(jt),xt+""}}function hcl(xt){return function($t,Ct){var kt=xt(($t=hcl$2($t)).h,(Ct=hcl$2(Ct)).h),Mt=nogamma($t.c,Ct.c),Ft=nogamma($t.l,Ct.l),jt=nogamma($t.opacity,Ct.opacity);return function(Bt){return $t.h=kt(Bt),$t.c=Mt(Bt),$t.l=Ft(Bt),$t.opacity=jt(Bt),$t+""}}}const hcl$1=hcl(hue$1);var hclLong=hcl(nogamma);function cubehelix(xt){return function $t(Ct){Ct=+Ct;function kt(Mt,Ft){var jt=xt((Mt=cubehelix$2(Mt)).h,(Ft=cubehelix$2(Ft)).h),Bt=nogamma(Mt.s,Ft.s),Vt=nogamma(Mt.l,Ft.l),zt=nogamma(Mt.opacity,Ft.opacity);return function(Ht){return Mt.h=jt(Ht),Mt.s=Bt(Ht),Mt.l=Vt(Math.pow(Ht,Ct)),Mt.opacity=zt(Ht),Mt+""}}return kt.gamma=$t,kt}(1)}const cubehelix$1=cubehelix(hue$1);var cubehelixLong=cubehelix(nogamma);function piecewise(xt,$t){$t===void 0&&($t=xt,xt=interpolate$1$1);for(var Ct=0,kt=$t.length-1,Mt=$t[0],Ft=new Array(kt<0?0:kt);Ct<kt;)Ft[Ct]=xt(Mt,Mt=$t[++Ct]);return function(jt){var Bt=Math.max(0,Math.min(kt-1,Math.floor(jt*=kt)));return Ft[Bt](jt-Bt)}}function quantize$2(xt,$t){for(var Ct=new Array($t),kt=0;kt<$t;++kt)Ct[kt]=xt(kt/($t-1));return Ct}const $$1$1=Object.freeze(Object.defineProperty({__proto__:null,interpolate:interpolate$1$1,interpolateArray:array$8,interpolateBasis:basis$1,interpolateBasisClosed:basisClosed,interpolateCubehelix:cubehelix$1,interpolateCubehelixLong:cubehelixLong,interpolateDate:date$3,interpolateDiscrete:discrete$1,interpolateHcl:hcl$1,interpolateHclLong:hclLong,interpolateHsl:hsl$1,interpolateHslLong:hslLong,interpolateHue:hue,interpolateLab:lab,interpolateNumber,interpolateNumberArray:numberArray,interpolateObject:object$2,interpolateRgb,interpolateRgbBasis:rgbBasis,interpolateRgbBasisClosed:rgbBasisClosed,interpolateRound,interpolateString,interpolateTransformCss,interpolateTransformSvg,interpolateZoom,piecewise,quantize:quantize$2},Symbol.toStringTag,{value:"Module"}));var frame=0,timeout$1=0,interval$2=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(xt){setTimeout(xt,17)};function now$1(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer$1(){this._call=this._time=this._next=null}Timer$1.prototype=timer$1.prototype={constructor:Timer$1,restart:function(xt,$t,Ct){if(typeof xt!="function")throw new TypeError("callback is not a function");Ct=(Ct==null?now$1():+Ct)+($t==null?0:+$t),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=xt,this._time=Ct,sleep$1()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep$1())}};function timer$1(xt,$t,Ct){var kt=new Timer$1;return kt.restart(xt,$t,Ct),kt}function timerFlush(){now$1(),++frame;for(var xt=taskHead,$t;xt;)($t=clockNow-xt._time)>=0&&xt._call.call(void 0,$t),xt=xt._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout$1=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var xt=clock.now(),$t=xt-clockLast;$t>pokeDelay&&(clockSkew-=$t,clockLast=xt)}function nap(){for(var xt,$t=taskHead,Ct,kt=1/0;$t;)$t._call?(kt>$t._time&&(kt=$t._time),xt=$t,$t=$t._next):(Ct=$t._next,$t._next=null,$t=xt?xt._next=Ct:taskHead=Ct);taskTail=xt,sleep$1(kt)}function sleep$1(xt){if(!frame){timeout$1&&(timeout$1=clearTimeout(timeout$1));var $t=xt-clockNow;$t>24?(xt<1/0&&(timeout$1=setTimeout(wake,xt-clock.now()-clockSkew)),interval$2&&(interval$2=clearInterval(interval$2))):(interval$2||(clockLast=clock.now(),interval$2=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function timeout(xt,$t,Ct){var kt=new Timer$1;return $t=$t==null?0:+$t,kt.restart(Mt=>{kt.stop(),xt(Mt+$t)},$t,Ct),kt}function interval$1(xt,$t,Ct){var kt=new Timer$1,Mt=$t;return $t==null?(kt.restart(xt,$t,Ct),kt):(kt._restart=kt.restart,kt.restart=function(Ft,jt,Bt){jt=+jt,Bt=Bt==null?now$1():+Bt,kt._restart(function Vt(zt){zt+=Mt,kt._restart(Vt,Mt+=jt,Bt),Ft(zt)},jt,Bt)},kt.restart(xt,$t,Ct),kt)}var emptyOn=dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(xt,$t,Ct,kt,Mt,Ft){var jt=xt.__transition;if(!jt)xt.__transition={};else if(Ct in jt)return;create$3(xt,Ct,{name:$t,index:kt,group:Mt,on:emptyOn,tween:emptyTween,time:Ft.time,delay:Ft.delay,duration:Ft.duration,ease:Ft.ease,timer:null,state:CREATED})}function init$2(xt,$t){var Ct=get$6(xt,$t);if(Ct.state>CREATED)throw new Error("too late; already scheduled");return Ct}function set$4(xt,$t){var Ct=get$6(xt,$t);if(Ct.state>STARTED)throw new Error("too late; already running");return Ct}function get$6(xt,$t){var Ct=xt.__transition;if(!Ct||!(Ct=Ct[$t]))throw new Error("transition not found");return Ct}function create$3(xt,$t,Ct){var kt=xt.__transition,Mt;kt[$t]=Ct,Ct.timer=timer$1(Ft,0,Ct.time);function Ft(zt){Ct.state=SCHEDULED,Ct.timer.restart(jt,Ct.delay,Ct.time),Ct.delay<=zt&&jt(zt-Ct.delay)}function jt(zt){var Ht,Gt,qt,Wt;if(Ct.state!==SCHEDULED)return Vt();for(Ht in kt)if(Wt=kt[Ht],Wt.name===Ct.name){if(Wt.state===STARTED)return timeout(jt);Wt.state===RUNNING?(Wt.state=ENDED,Wt.timer.stop(),Wt.on.call("interrupt",xt,xt.__data__,Wt.index,Wt.group),delete kt[Ht]):+Ht<$t&&(Wt.state=ENDED,Wt.timer.stop(),Wt.on.call("cancel",xt,xt.__data__,Wt.index,Wt.group),delete kt[Ht])}if(timeout(function(){Ct.state===STARTED&&(Ct.state=RUNNING,Ct.timer.restart(Bt,Ct.delay,Ct.time),Bt(zt))}),Ct.state=STARTING,Ct.on.call("start",xt,xt.__data__,Ct.index,Ct.group),Ct.state===STARTING){for(Ct.state=STARTED,Mt=new Array(qt=Ct.tween.length),Ht=0,Gt=-1;Ht<qt;++Ht)(Wt=Ct.tween[Ht].value.call(xt,xt.__data__,Ct.index,Ct.group))&&(Mt[++Gt]=Wt);Mt.length=Gt+1}}function Bt(zt){for(var Ht=zt<Ct.duration?Ct.ease.call(null,zt/Ct.duration):(Ct.timer.restart(Vt),Ct.state=ENDING,1),Gt=-1,qt=Mt.length;++Gt<qt;)Mt[Gt].call(xt,Ht);Ct.state===ENDING&&(Ct.on.call("end",xt,xt.__data__,Ct.index,Ct.group),Vt())}function Vt(){Ct.state=ENDED,Ct.timer.stop(),delete kt[$t];for(var zt in kt)return;delete xt.__transition}}function interrupt(xt,$t){var Ct=xt.__transition,kt,Mt,Ft=!0,jt;if(Ct){$t=$t==null?null:$t+"";for(jt in Ct){if((kt=Ct[jt]).name!==$t){Ft=!1;continue}Mt=kt.state>STARTING&&kt.state<ENDING,kt.state=ENDED,kt.timer.stop(),kt.on.call(Mt?"interrupt":"cancel",xt,xt.__data__,kt.index,kt.group),delete Ct[jt]}Ft&&delete xt.__transition}}function selection_interrupt(xt){return this.each(function(){interrupt(this,xt)})}function tweenRemove(xt,$t){var Ct,kt;return function(){var Mt=set$4(this,xt),Ft=Mt.tween;if(Ft!==Ct){kt=Ct=Ft;for(var jt=0,Bt=kt.length;jt<Bt;++jt)if(kt[jt].name===$t){kt=kt.slice(),kt.splice(jt,1);break}}Mt.tween=kt}}function tweenFunction(xt,$t,Ct){var kt,Mt;if(typeof Ct!="function")throw new Error;return function(){var Ft=set$4(this,xt),jt=Ft.tween;if(jt!==kt){Mt=(kt=jt).slice();for(var Bt={name:$t,value:Ct},Vt=0,zt=Mt.length;Vt<zt;++Vt)if(Mt[Vt].name===$t){Mt[Vt]=Bt;break}Vt===zt&&Mt.push(Bt)}Ft.tween=Mt}}function transition_tween(xt,$t){var Ct=this._id;if(xt+="",arguments.length<2){for(var kt=get$6(this.node(),Ct).tween,Mt=0,Ft=kt.length,jt;Mt<Ft;++Mt)if((jt=kt[Mt]).name===xt)return jt.value;return null}return this.each(($t==null?tweenRemove:tweenFunction)(Ct,xt,$t))}function tweenValue(xt,$t,Ct){var kt=xt._id;return xt.each(function(){var Mt=set$4(this,kt);(Mt.value||(Mt.value={}))[$t]=Ct.apply(this,arguments)}),function(Mt){return get$6(Mt,kt).value[$t]}}function interpolate$2(xt,$t){var Ct;return(typeof $t=="number"?interpolateNumber:$t instanceof color$3?interpolateRgb:(Ct=color$3($t))?($t=Ct,interpolateRgb):interpolateString)(xt,$t)}function attrRemove(xt){return function(){this.removeAttribute(xt)}}function attrRemoveNS(xt){return function(){this.removeAttributeNS(xt.space,xt.local)}}function attrConstant(xt,$t,Ct){var kt,Mt=Ct+"",Ft;return function(){var jt=this.getAttribute(xt);return jt===Mt?null:jt===kt?Ft:Ft=$t(kt=jt,Ct)}}function attrConstantNS(xt,$t,Ct){var kt,Mt=Ct+"",Ft;return function(){var jt=this.getAttributeNS(xt.space,xt.local);return jt===Mt?null:jt===kt?Ft:Ft=$t(kt=jt,Ct)}}function attrFunction(xt,$t,Ct){var kt,Mt,Ft;return function(){var jt,Bt=Ct(this),Vt;return Bt==null?void this.removeAttribute(xt):(jt=this.getAttribute(xt),Vt=Bt+"",jt===Vt?null:jt===kt&&Vt===Mt?Ft:(Mt=Vt,Ft=$t(kt=jt,Bt)))}}function attrFunctionNS(xt,$t,Ct){var kt,Mt,Ft;return function(){var jt,Bt=Ct(this),Vt;return Bt==null?void this.removeAttributeNS(xt.space,xt.local):(jt=this.getAttributeNS(xt.space,xt.local),Vt=Bt+"",jt===Vt?null:jt===kt&&Vt===Mt?Ft:(Mt=Vt,Ft=$t(kt=jt,Bt)))}}function transition_attr(xt,$t){var Ct=namespace(xt),kt=Ct==="transform"?interpolateTransformSvg:interpolate$2;return this.attrTween(xt,typeof $t=="function"?(Ct.local?attrFunctionNS:attrFunction)(Ct,kt,tweenValue(this,"attr."+xt,$t)):$t==null?(Ct.local?attrRemoveNS:attrRemove)(Ct):(Ct.local?attrConstantNS:attrConstant)(Ct,kt,$t))}function attrInterpolate(xt,$t){return function(Ct){this.setAttribute(xt,$t.call(this,Ct))}}function attrInterpolateNS(xt,$t){return function(Ct){this.setAttributeNS(xt.space,xt.local,$t.call(this,Ct))}}function attrTweenNS(xt,$t){var Ct,kt;function Mt(){var Ft=$t.apply(this,arguments);return Ft!==kt&&(Ct=(kt=Ft)&&attrInterpolateNS(xt,Ft)),Ct}return Mt._value=$t,Mt}function attrTween(xt,$t){var Ct,kt;function Mt(){var Ft=$t.apply(this,arguments);return Ft!==kt&&(Ct=(kt=Ft)&&attrInterpolate(xt,Ft)),Ct}return Mt._value=$t,Mt}function transition_attrTween(xt,$t){var Ct="attr."+xt;if(arguments.length<2)return(Ct=this.tween(Ct))&&Ct._value;if($t==null)return this.tween(Ct,null);if(typeof $t!="function")throw new Error;var kt=namespace(xt);return this.tween(Ct,(kt.local?attrTweenNS:attrTween)(kt,$t))}function delayFunction(xt,$t){return function(){init$2(this,xt).delay=+$t.apply(this,arguments)}}function delayConstant(xt,$t){return $t=+$t,function(){init$2(this,xt).delay=$t}}function transition_delay(xt){var $t=this._id;return arguments.length?this.each((typeof xt=="function"?delayFunction:delayConstant)($t,xt)):get$6(this.node(),$t).delay}function durationFunction(xt,$t){return function(){set$4(this,xt).duration=+$t.apply(this,arguments)}}function durationConstant(xt,$t){return $t=+$t,function(){set$4(this,xt).duration=$t}}function transition_duration(xt){var $t=this._id;return arguments.length?this.each((typeof xt=="function"?durationFunction:durationConstant)($t,xt)):get$6(this.node(),$t).duration}function easeConstant(xt,$t){if(typeof $t!="function")throw new Error;return function(){set$4(this,xt).ease=$t}}function transition_ease(xt){var $t=this._id;return arguments.length?this.each(easeConstant($t,xt)):get$6(this.node(),$t).ease}function easeVarying(xt,$t){return function(){var Ct=$t.apply(this,arguments);if(typeof Ct!="function")throw new Error;set$4(this,xt).ease=Ct}}function transition_easeVarying(xt){if(typeof xt!="function")throw new Error;return this.each(easeVarying(this._id,xt))}function transition_filter(xt){typeof xt!="function"&&(xt=matcher(xt));for(var $t=this._groups,Ct=$t.length,kt=new Array(Ct),Mt=0;Mt<Ct;++Mt)for(var Ft=$t[Mt],jt=Ft.length,Bt=kt[Mt]=[],Vt,zt=0;zt<jt;++zt)(Vt=Ft[zt])&&xt.call(Vt,Vt.__data__,zt,Ft)&&Bt.push(Vt);return new Transition(kt,this._parents,this._name,this._id)}function transition_merge(xt){if(xt._id!==this._id)throw new Error;for(var $t=this._groups,Ct=xt._groups,kt=$t.length,Mt=Ct.length,Ft=Math.min(kt,Mt),jt=new Array(kt),Bt=0;Bt<Ft;++Bt)for(var Vt=$t[Bt],zt=Ct[Bt],Ht=Vt.length,Gt=jt[Bt]=new Array(Ht),qt,Wt=0;Wt<Ht;++Wt)(qt=Vt[Wt]||zt[Wt])&&(Gt[Wt]=qt);for(;Bt<kt;++Bt)jt[Bt]=$t[Bt];return new Transition(jt,this._parents,this._name,this._id)}function start$1(xt){return(xt+"").trim().split(/^|\s+/).every(function($t){var Ct=$t.indexOf(".");return Ct>=0&&($t=$t.slice(0,Ct)),!$t||$t==="start"})}function onFunction(xt,$t,Ct){var kt,Mt,Ft=start$1($t)?init$2:set$4;return function(){var jt=Ft(this,xt),Bt=jt.on;Bt!==kt&&(Mt=(kt=Bt).copy()).on($t,Ct),jt.on=Mt}}function transition_on(xt,$t){var Ct=this._id;return arguments.length<2?get$6(this.node(),Ct).on.on(xt):this.each(onFunction(Ct,xt,$t))}function removeFunction(xt){return function(){var $t=this.parentNode;for(var Ct in this.__transition)if(+Ct!==xt)return;$t&&$t.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(xt){var $t=this._name,Ct=this._id;typeof xt!="function"&&(xt=selector(xt));for(var kt=this._groups,Mt=kt.length,Ft=new Array(Mt),jt=0;jt<Mt;++jt)for(var Bt=kt[jt],Vt=Bt.length,zt=Ft[jt]=new Array(Vt),Ht,Gt,qt=0;qt<Vt;++qt)(Ht=Bt[qt])&&(Gt=xt.call(Ht,Ht.__data__,qt,Bt))&&("__data__"in Ht&&(Gt.__data__=Ht.__data__),zt[qt]=Gt,schedule(zt[qt],$t,Ct,qt,zt,get$6(Ht,Ct)));return new Transition(Ft,this._parents,$t,Ct)}function transition_selectAll(xt){var $t=this._name,Ct=this._id;typeof xt!="function"&&(xt=selectorAll(xt));for(var kt=this._groups,Mt=kt.length,Ft=[],jt=[],Bt=0;Bt<Mt;++Bt)for(var Vt=kt[Bt],zt=Vt.length,Ht,Gt=0;Gt<zt;++Gt)if(Ht=Vt[Gt]){for(var qt=xt.call(Ht,Ht.__data__,Gt,Vt),Wt,Yt=get$6(Ht,Ct),Kt=0,Xt=qt.length;Kt<Xt;++Kt)(Wt=qt[Kt])&&schedule(Wt,$t,Ct,Kt,qt,Yt);Ft.push(qt),jt.push(Ht)}return new Transition(Ft,jt,$t,Ct)}var Selection$1=selection.prototype.constructor;function transition_selection(){return new Selection$1(this._groups,this._parents)}function styleNull(xt,$t){var Ct,kt,Mt;return function(){var Ft=styleValue(this,xt),jt=(this.style.removeProperty(xt),styleValue(this,xt));return Ft===jt?null:Ft===Ct&&jt===kt?Mt:Mt=$t(Ct=Ft,kt=jt)}}function styleRemove(xt){return function(){this.style.removeProperty(xt)}}function styleConstant(xt,$t,Ct){var kt,Mt=Ct+"",Ft;return function(){var jt=styleValue(this,xt);return jt===Mt?null:jt===kt?Ft:Ft=$t(kt=jt,Ct)}}function styleFunction(xt,$t,Ct){var kt,Mt,Ft;return function(){var jt=styleValue(this,xt),Bt=Ct(this),Vt=Bt+"";return Bt==null&&(Vt=Bt=(this.style.removeProperty(xt),styleValue(this,xt))),jt===Vt?null:jt===kt&&Vt===Mt?Ft:(Mt=Vt,Ft=$t(kt=jt,Bt))}}function styleMaybeRemove(xt,$t){var Ct,kt,Mt,Ft="style."+$t,jt="end."+Ft,Bt;return function(){var Vt=set$4(this,xt),zt=Vt.on,Ht=Vt.value[Ft]==null?Bt||(Bt=styleRemove($t)):void 0;(zt!==Ct||Mt!==Ht)&&(kt=(Ct=zt).copy()).on(jt,Mt=Ht),Vt.on=kt}}function transition_style(xt,$t,Ct){var kt=(xt+="")=="transform"?interpolateTransformCss:interpolate$2;return $t==null?this.styleTween(xt,styleNull(xt,kt)).on("end.style."+xt,styleRemove(xt)):typeof $t=="function"?this.styleTween(xt,styleFunction(xt,kt,tweenValue(this,"style."+xt,$t))).each(styleMaybeRemove(this._id,xt)):this.styleTween(xt,styleConstant(xt,kt,$t),Ct).on("end.style."+xt,null)}function styleInterpolate(xt,$t,Ct){return function(kt){this.style.setProperty(xt,$t.call(this,kt),Ct)}}function styleTween(xt,$t,Ct){var kt,Mt;function Ft(){var jt=$t.apply(this,arguments);return jt!==Mt&&(kt=(Mt=jt)&&styleInterpolate(xt,jt,Ct)),kt}return Ft._value=$t,Ft}function transition_styleTween(xt,$t,Ct){var kt="style."+(xt+="");if(arguments.length<2)return(kt=this.tween(kt))&&kt._value;if($t==null)return this.tween(kt,null);if(typeof $t!="function")throw new Error;return this.tween(kt,styleTween(xt,$t,Ct??""))}function textConstant(xt){return function(){this.textContent=xt}}function textFunction(xt){return function(){var $t=xt(this);this.textContent=$t??""}}function transition_text(xt){return this.tween("text",typeof xt=="function"?textFunction(tweenValue(this,"text",xt)):textConstant(xt==null?"":xt+""))}function textInterpolate(xt){return function($t){this.textContent=xt.call(this,$t)}}function textTween(xt){var $t,Ct;function kt(){var Mt=xt.apply(this,arguments);return Mt!==Ct&&($t=(Ct=Mt)&&textInterpolate(Mt)),$t}return kt._value=xt,kt}function transition_textTween(xt){var $t="text";if(arguments.length<1)return($t=this.tween($t))&&$t._value;if(xt==null)return this.tween($t,null);if(typeof xt!="function")throw new Error;return this.tween($t,textTween(xt))}function transition_transition(){for(var xt=this._name,$t=this._id,Ct=newId(),kt=this._groups,Mt=kt.length,Ft=0;Ft<Mt;++Ft)for(var jt=kt[Ft],Bt=jt.length,Vt,zt=0;zt<Bt;++zt)if(Vt=jt[zt]){var Ht=get$6(Vt,$t);schedule(Vt,xt,Ct,zt,jt,{time:Ht.time+Ht.delay+Ht.duration,delay:0,duration:Ht.duration,ease:Ht.ease})}return new Transition(kt,this._parents,xt,Ct)}function transition_end(){var xt,$t,Ct=this,kt=Ct._id,Mt=Ct.size();return new Promise(function(Ft,jt){var Bt={value:jt},Vt={value:function(){--Mt===0&&Ft()}};Ct.each(function(){var zt=set$4(this,kt),Ht=zt.on;Ht!==xt&&($t=(xt=Ht).copy(),$t._.cancel.push(Bt),$t._.interrupt.push(Bt),$t._.end.push(Vt)),zt.on=$t}),Mt===0&&Ft()})}var id$2=0;function Transition(xt,$t,Ct,kt){this._groups=xt,this._parents=$t,this._name=Ct,this._id=kt}function newId(){return++id$2}var selection_prototype=selection.prototype;Transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease,easeVarying:transition_easeVarying,end:transition_end,[Symbol.iterator]:selection_prototype[Symbol.iterator]};const linear$2=xt=>+xt;function cubicInOut(xt){return((xt*=2)<=1?xt*xt*xt:(xt-=2)*xt*xt+2)/2}var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(xt,$t){for(var Ct;!(Ct=xt.__transition)||!(Ct=Ct[$t]);)if(!(xt=xt.parentNode))throw new Error(`transition ${$t} not found`);return Ct}function selection_transition(xt){var $t,Ct;xt instanceof Transition?($t=xt._id,xt=xt._name):($t=newId(),(Ct=defaultTiming).time=now$1(),xt=xt==null?null:xt+"");for(var kt=this._groups,Mt=kt.length,Ft=0;Ft<Mt;++Ft)for(var jt=kt[Ft],Bt=jt.length,Vt,zt=0;zt<Bt;++zt)(Vt=jt[zt])&&schedule(Vt,xt,$t,zt,jt,Ct||inherit(Vt,$t));return new Transition(kt,this._parents,xt,$t)}selection.prototype.interrupt=selection_interrupt;selection.prototype.transition=selection_transition;const constant$5=xt=>()=>xt;function BrushEvent(xt,{sourceEvent:$t,target:Ct,selection:kt,mode:Mt,dispatch:Ft}){Object.defineProperties(this,{type:{value:xt,enumerable:!0,configurable:!0},sourceEvent:{value:$t,enumerable:!0,configurable:!0},target:{value:Ct,enumerable:!0,configurable:!0},selection:{value:kt,enumerable:!0,configurable:!0},mode:{value:Mt,enumerable:!0,configurable:!0},_:{value:Ft}})}function nopropagation(xt){xt.stopImmediatePropagation()}function noevent(xt){xt.preventDefault(),xt.stopImmediatePropagation()}var MODE_DRAG={name:"drag"},MODE_SPACE={name:"space"},MODE_HANDLE={name:"handle"},MODE_CENTER={name:"center"};const{abs:abs$3,max:max$3,min:min$3}=Math;function number1(xt){return[+xt[0],+xt[1]]}function number2(xt){return[number1(xt[0]),number1(xt[1])]}var X$4={name:"x",handles:["w","e"].map(type$4),input:function(xt,$t){return xt==null?null:[[+xt[0],$t[0][1]],[+xt[1],$t[1][1]]]},output:function(xt){return xt&&[xt[0][0],xt[1][0]]}},Y$3={name:"y",handles:["n","s"].map(type$4),input:function(xt,$t){return xt==null?null:[[$t[0][0],+xt[0]],[$t[1][0],+xt[1]]]},output:function(xt){return xt&&[xt[0][1],xt[1][1]]}},XY={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(type$4),input:function(xt){return xt==null?null:number2(xt)},output:function(xt){return xt}},cursors={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},flipX={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},flipY={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},signsX={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},signsY={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function type$4(xt){return{type:xt}}function defaultFilter(xt){return!xt.ctrlKey&&!xt.button}function defaultExtent$1(){var xt=this.ownerSVGElement||this;return xt.hasAttribute("viewBox")?(xt=xt.viewBox.baseVal,[[xt.x,xt.y],[xt.x+xt.width,xt.y+xt.height]]):[[0,0],[xt.width.baseVal.value,xt.height.baseVal.value]]}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function local(xt){for(;!xt.__brush;)if(!(xt=xt.parentNode))return;return xt.__brush}function empty$2(xt){return xt[0][0]===xt[1][0]||xt[0][1]===xt[1][1]}function brushX(){return brush$1(X$4)}function brushY(){return brush$1(Y$3)}function brush(){return brush$1(XY)}function brush$1(xt){var $t=defaultExtent$1,Ct=defaultFilter,kt=defaultTouchable,Mt=!0,Ft=dispatch("start","brush","end"),jt=6,Bt;function Vt(Xt){var Qt=Xt.property("__brush",Kt).selectAll(".overlay").data([type$4("overlay")]);Qt.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",cursors.overlay).merge(Qt).each(function(){var Zt=local(this).extent;select$1(this).attr("x",Zt[0][0]).attr("y",Zt[0][1]).attr("width",Zt[1][0]-Zt[0][0]).attr("height",Zt[1][1]-Zt[0][1])}),Xt.selectAll(".selection").data([type$4("selection")]).enter().append("rect").attr("class","selection").attr("cursor",cursors.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var Jt=Xt.selectAll(".handle").data(xt.handles,function(Zt){return Zt.type});Jt.exit().remove(),Jt.enter().append("rect").attr("class",function(Zt){return"handle handle--"+Zt.type}).attr("cursor",function(Zt){return cursors[Zt.type]}),Xt.each(zt).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",qt).filter(kt).on("touchstart.brush",qt).on("touchmove.brush",Wt).on("touchend.brush touchcancel.brush",Yt).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}Vt.move=function(Xt,Qt,Jt){Xt.tween?Xt.on("start.brush",function(Zt){Ht(this,arguments).beforestart().start(Zt)}).on("interrupt.brush end.brush",function(Zt){Ht(this,arguments).end(Zt)}).tween("brush",function(){var Zt=this,sn=Zt.__brush,ln=Ht(Zt,arguments),dn=sn.selection,hn=xt.input(typeof Qt=="function"?Qt.apply(this,arguments):Qt,sn.extent),cn=interpolate$1$1(dn,hn);function pn(yn){sn.selection=yn===1&&hn===null?null:cn(yn),zt.call(Zt),ln.brush()}return dn!==null&&hn!==null?pn:pn(1)}):Xt.each(function(){var Zt=this,sn=arguments,ln=Zt.__brush,dn=xt.input(typeof Qt=="function"?Qt.apply(Zt,sn):Qt,ln.extent),hn=Ht(Zt,sn).beforestart();interrupt(Zt),ln.selection=dn===null?null:dn,zt.call(Zt),hn.start(Jt).brush(Jt).end(Jt)})},Vt.clear=function(Xt,Qt){Vt.move(Xt,null,Qt)};function zt(){var Xt=select$1(this),Qt=local(this).selection;Qt?(Xt.selectAll(".selection").style("display",null).attr("x",Qt[0][0]).attr("y",Qt[0][1]).attr("width",Qt[1][0]-Qt[0][0]).attr("height",Qt[1][1]-Qt[0][1]),Xt.selectAll(".handle").style("display",null).attr("x",function(Jt){return Jt.type[Jt.type.length-1]==="e"?Qt[1][0]-jt/2:Qt[0][0]-jt/2}).attr("y",function(Jt){return Jt.type[0]==="s"?Qt[1][1]-jt/2:Qt[0][1]-jt/2}).attr("width",function(Jt){return Jt.type==="n"||Jt.type==="s"?Qt[1][0]-Qt[0][0]+jt:jt}).attr("height",function(Jt){return Jt.type==="e"||Jt.type==="w"?Qt[1][1]-Qt[0][1]+jt:jt})):Xt.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function Ht(Xt,Qt,Jt){var Zt=Xt.__brush.emitter;return Zt&&(!Jt||!Zt.clean)?Zt:new Gt(Xt,Qt,Jt)}function Gt(Xt,Qt,Jt){this.that=Xt,this.args=Qt,this.state=Xt.__brush,this.active=0,this.clean=Jt}Gt.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(Xt,Qt){return this.starting?(this.starting=!1,this.emit("start",Xt,Qt)):this.emit("brush",Xt),this},brush:function(Xt,Qt){return this.emit("brush",Xt,Qt),this},end:function(Xt,Qt){return--this.active===0&&(delete this.state.emitter,this.emit("end",Xt,Qt)),this},emit:function(Xt,Qt,Jt){var Zt=select$1(this.that).datum();Ft.call(Xt,this.that,new BrushEvent(Xt,{sourceEvent:Qt,target:Vt,selection:xt.output(this.state.selection),mode:Jt,dispatch:Ft}),Zt)}};function qt(Xt){if(Bt&&!Xt.touches||!Ct.apply(this,arguments))return;var Qt=this,Jt=Xt.target.__data__.type,Zt=(Mt&&Xt.metaKey?Jt="overlay":Jt)==="selection"?MODE_DRAG:Mt&&Xt.altKey?MODE_CENTER:MODE_HANDLE,sn=xt===Y$3?null:signsX[Jt],ln=xt===X$4?null:signsY[Jt],dn=local(Qt),hn=dn.extent,cn=dn.selection,pn=hn[0][0],yn,gn,En=hn[0][1],bn,xn,Cn=hn[1][0],$n,wn,Rn=hn[1][1],Dn,An,Sn=0,vn=0,_n,Tn=sn&&ln&&Mt&&Xt.shiftKey,Pn,Ln,Vn=Array.from(Xt.touches||[Xt],Bn=>{const jn=Bn.identifier;return Bn=pointer(Bn,Qt),Bn.point0=Bn.slice(),Bn.identifier=jn,Bn});interrupt(Qt);var Un=Ht(Qt,arguments,!0).beforestart();if(Jt==="overlay"){cn&&(_n=!0);const Bn=[Vn[0],Vn[1]||Vn[0]];dn.selection=cn=[[yn=xt===Y$3?pn:min$3(Bn[0][0],Bn[1][0]),bn=xt===X$4?En:min$3(Bn[0][1],Bn[1][1])],[$n=xt===Y$3?Cn:max$3(Bn[0][0],Bn[1][0]),Dn=xt===X$4?Rn:max$3(Bn[0][1],Bn[1][1])]],Vn.length>1&&mr(Xt)}else yn=cn[0][0],bn=cn[0][1],$n=cn[1][0],Dn=cn[1][1];gn=yn,xn=bn,wn=$n,An=Dn;var Wn=select$1(Qt).attr("pointer-events","none"),rr=Wn.selectAll(".overlay").attr("cursor",cursors[Jt]);if(Xt.touches)Un.moved=nr,Un.ended=kn;else{var ar=select$1(Xt.view).on("mousemove.brush",nr,!0).on("mouseup.brush",kn,!0);Mt&&ar.on("keydown.brush",Fn,!0).on("keyup.brush",Hn,!0),dragDisable(Xt.view)}zt.call(Qt),Un.start(Xt,Zt.name);function nr(Bn){for(const jn of Bn.changedTouches||[Bn])for(const sr of Vn)sr.identifier===jn.identifier&&(sr.cur=pointer(jn,Qt));if(Tn&&!Pn&&!Ln&&Vn.length===1){const jn=Vn[0];abs$3(jn.cur[0]-jn[0])>abs$3(jn.cur[1]-jn[1])?Ln=!0:Pn=!0}for(const jn of Vn)jn.cur&&(jn[0]=jn.cur[0],jn[1]=jn.cur[1]);_n=!0,noevent(Bn),mr(Bn)}function mr(Bn){const jn=Vn[0],sr=jn.point0;var Ar;switch(Sn=jn[0]-sr[0],vn=jn[1]-sr[1],Zt){case MODE_SPACE:case MODE_DRAG:{sn&&(Sn=max$3(pn-yn,min$3(Cn-$n,Sn)),gn=yn+Sn,wn=$n+Sn),ln&&(vn=max$3(En-bn,min$3(Rn-Dn,vn)),xn=bn+vn,An=Dn+vn);break}case MODE_HANDLE:{Vn[1]?(sn&&(gn=max$3(pn,min$3(Cn,Vn[0][0])),wn=max$3(pn,min$3(Cn,Vn[1][0])),sn=1),ln&&(xn=max$3(En,min$3(Rn,Vn[0][1])),An=max$3(En,min$3(Rn,Vn[1][1])),ln=1)):(sn<0?(Sn=max$3(pn-yn,min$3(Cn-yn,Sn)),gn=yn+Sn,wn=$n):sn>0&&(Sn=max$3(pn-$n,min$3(Cn-$n,Sn)),gn=yn,wn=$n+Sn),ln<0?(vn=max$3(En-bn,min$3(Rn-bn,vn)),xn=bn+vn,An=Dn):ln>0&&(vn=max$3(En-Dn,min$3(Rn-Dn,vn)),xn=bn,An=Dn+vn));break}case MODE_CENTER:{sn&&(gn=max$3(pn,min$3(Cn,yn-Sn*sn)),wn=max$3(pn,min$3(Cn,$n+Sn*sn))),ln&&(xn=max$3(En,min$3(Rn,bn-vn*ln)),An=max$3(En,min$3(Rn,Dn+vn*ln)));break}}wn<gn&&(sn*=-1,Ar=yn,yn=$n,$n=Ar,Ar=gn,gn=wn,wn=Ar,Jt in flipX&&rr.attr("cursor",cursors[Jt=flipX[Jt]])),An<xn&&(ln*=-1,Ar=bn,bn=Dn,Dn=Ar,Ar=xn,xn=An,An=Ar,Jt in flipY&&rr.attr("cursor",cursors[Jt=flipY[Jt]])),dn.selection&&(cn=dn.selection),Pn&&(gn=cn[0][0],wn=cn[1][0]),Ln&&(xn=cn[0][1],An=cn[1][1]),(cn[0][0]!==gn||cn[0][1]!==xn||cn[1][0]!==wn||cn[1][1]!==An)&&(dn.selection=[[gn,xn],[wn,An]],zt.call(Qt),Un.brush(Bn,Zt.name))}function kn(Bn){if(nopropagation(Bn),Bn.touches){if(Bn.touches.length)return;Bt&&clearTimeout(Bt),Bt=setTimeout(function(){Bt=null},500)}else yesdrag(Bn.view,_n),ar.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);Wn.attr("pointer-events","all"),rr.attr("cursor",cursors.overlay),dn.selection&&(cn=dn.selection),empty$2(cn)&&(dn.selection=null,zt.call(Qt)),Un.end(Bn,Zt.name)}function Fn(Bn){switch(Bn.keyCode){case 16:{Tn=sn&&ln;break}case 18:{Zt===MODE_HANDLE&&(sn&&($n=wn-Sn*sn,yn=gn+Sn*sn),ln&&(Dn=An-vn*ln,bn=xn+vn*ln),Zt=MODE_CENTER,mr(Bn));break}case 32:{(Zt===MODE_HANDLE||Zt===MODE_CENTER)&&(sn<0?$n=wn-Sn:sn>0&&(yn=gn-Sn),ln<0?Dn=An-vn:ln>0&&(bn=xn-vn),Zt=MODE_SPACE,rr.attr("cursor",cursors.selection),mr(Bn));break}default:return}noevent(Bn)}function Hn(Bn){switch(Bn.keyCode){case 16:{Tn&&(Pn=Ln=Tn=!1,mr(Bn));break}case 18:{Zt===MODE_CENTER&&(sn<0?$n=wn:sn>0&&(yn=gn),ln<0?Dn=An:ln>0&&(bn=xn),Zt=MODE_HANDLE,mr(Bn));break}case 32:{Zt===MODE_SPACE&&(Bn.altKey?(sn&&($n=wn-Sn*sn,yn=gn+Sn*sn),ln&&(Dn=An-vn*ln,bn=xn+vn*ln),Zt=MODE_CENTER):(sn<0?$n=wn:sn>0&&(yn=gn),ln<0?Dn=An:ln>0&&(bn=xn),Zt=MODE_HANDLE),rr.attr("cursor",cursors[Jt]),mr(Bn));break}default:return}noevent(Bn)}}function Wt(Xt){Ht(this,arguments).moved(Xt)}function Yt(Xt){Ht(this,arguments).ended(Xt)}function Kt(){var Xt=this.__brush||{selection:null};return Xt.extent=number2($t.apply(this,arguments)),Xt.dim=xt,Xt}return Vt.extent=function(Xt){return arguments.length?($t=typeof Xt=="function"?Xt:constant$5(number2(Xt)),Vt):$t},Vt.filter=function(Xt){return arguments.length?(Ct=typeof Xt=="function"?Xt:constant$5(!!Xt),Vt):Ct},Vt.touchable=function(Xt){return arguments.length?(kt=typeof Xt=="function"?Xt:constant$5(!!Xt),Vt):kt},Vt.handleSize=function(Xt){return arguments.length?(jt=+Xt,Vt):jt},Vt.keyModifiers=function(Xt){return arguments.length?(Mt=!!Xt,Vt):Mt},Vt.on=function(){var Xt=Ft.on.apply(Ft,arguments);return Xt===Ft?Vt:Xt},Vt}const pi$3=Math.PI,tau$3=2*pi$3,epsilon$6=1e-6,tauEpsilon=tau$3-epsilon$6;function append$2(xt){this._+=xt[0];for(let $t=1,Ct=xt.length;$t<Ct;++$t)this._+=arguments[$t]+xt[$t]}function appendRound$1(xt){let $t=Math.floor(xt);if(!($t>=0))throw new Error(`invalid digits: ${xt}`);if($t>15)return append$2;const Ct=10**$t;return function(kt){this._+=kt[0];for(let Mt=1,Ft=kt.length;Mt<Ft;++Mt)this._+=Math.round(arguments[Mt]*Ct)/Ct+kt[Mt]}}let Path$1=class{constructor($t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=$t==null?append$2:appendRound$1($t)}moveTo($t,Ct){this._append`M${this._x0=this._x1=+$t},${this._y0=this._y1=+Ct}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo($t,Ct){this._append`L${this._x1=+$t},${this._y1=+Ct}`}quadraticCurveTo($t,Ct,kt,Mt){this._append`Q${+$t},${+Ct},${this._x1=+kt},${this._y1=+Mt}`}bezierCurveTo($t,Ct,kt,Mt,Ft,jt){this._append`C${+$t},${+Ct},${+kt},${+Mt},${this._x1=+Ft},${this._y1=+jt}`}arcTo($t,Ct,kt,Mt,Ft){if($t=+$t,Ct=+Ct,kt=+kt,Mt=+Mt,Ft=+Ft,Ft<0)throw new Error(`negative radius: ${Ft}`);let jt=this._x1,Bt=this._y1,Vt=kt-$t,zt=Mt-Ct,Ht=jt-$t,Gt=Bt-Ct,qt=Ht*Ht+Gt*Gt;if(this._x1===null)this._append`M${this._x1=$t},${this._y1=Ct}`;else if(qt>epsilon$6)if(!(Math.abs(Gt*Vt-zt*Ht)>epsilon$6)||!Ft)this._append`L${this._x1=$t},${this._y1=Ct}`;else{let Wt=kt-jt,Yt=Mt-Bt,Kt=Vt*Vt+zt*zt,Xt=Wt*Wt+Yt*Yt,Qt=Math.sqrt(Kt),Jt=Math.sqrt(qt),Zt=Ft*Math.tan((pi$3-Math.acos((Kt+qt-Xt)/(2*Qt*Jt)))/2),sn=Zt/Jt,ln=Zt/Qt;Math.abs(sn-1)>epsilon$6&&this._append`L${$t+sn*Ht},${Ct+sn*Gt}`,this._append`A${Ft},${Ft},0,0,${+(Gt*Wt>Ht*Yt)},${this._x1=$t+ln*Vt},${this._y1=Ct+ln*zt}`}}arc($t,Ct,kt,Mt,Ft,jt){if($t=+$t,Ct=+Ct,kt=+kt,jt=!!jt,kt<0)throw new Error(`negative radius: ${kt}`);let Bt=kt*Math.cos(Mt),Vt=kt*Math.sin(Mt),zt=$t+Bt,Ht=Ct+Vt,Gt=1^jt,qt=jt?Mt-Ft:Ft-Mt;this._x1===null?this._append`M${zt},${Ht}`:(Math.abs(this._x1-zt)>epsilon$6||Math.abs(this._y1-Ht)>epsilon$6)&&this._append`L${zt},${Ht}`,kt&&(qt<0&&(qt=qt%tau$3+tau$3),qt>tauEpsilon?this._append`A${kt},${kt},0,1,${Gt},${$t-Bt},${Ct-Vt}A${kt},${kt},0,1,${Gt},${this._x1=zt},${this._y1=Ht}`:qt>epsilon$6&&this._append`A${kt},${kt},0,${+(qt>=pi$3)},${Gt},${this._x1=$t+kt*Math.cos(Ft)},${this._y1=Ct+kt*Math.sin(Ft)}`)}rect($t,Ct,kt,Mt){this._append`M${this._x0=this._x1=+$t},${this._y0=this._y1=+Ct}h${kt=+kt}v${+Mt}h${-kt}Z`}toString(){return this._}};function path$3(){return new Path$1}path$3.prototype=Path$1.prototype;const epsilon$5=11102230246251565e-32,splitter$1=134217729,resulterrbound=(3+8*epsilon$5)*epsilon$5;function sum$1(xt,$t,Ct,kt,Mt){let Ft,jt,Bt,Vt,zt=$t[0],Ht=kt[0],Gt=0,qt=0;Ht>zt==Ht>-zt?(Ft=zt,zt=$t[++Gt]):(Ft=Ht,Ht=kt[++qt]);let Wt=0;if(Gt<xt&&qt<Ct)for(Ht>zt==Ht>-zt?(jt=zt+Ft,Bt=Ft-(jt-zt),zt=$t[++Gt]):(jt=Ht+Ft,Bt=Ft-(jt-Ht),Ht=kt[++qt]),Ft=jt,Bt!==0&&(Mt[Wt++]=Bt);Gt<xt&&qt<Ct;)Ht>zt==Ht>-zt?(jt=Ft+zt,Vt=jt-Ft,Bt=Ft-(jt-Vt)+(zt-Vt),zt=$t[++Gt]):(jt=Ft+Ht,Vt=jt-Ft,Bt=Ft-(jt-Vt)+(Ht-Vt),Ht=kt[++qt]),Ft=jt,Bt!==0&&(Mt[Wt++]=Bt);for(;Gt<xt;)jt=Ft+zt,Vt=jt-Ft,Bt=Ft-(jt-Vt)+(zt-Vt),zt=$t[++Gt],Ft=jt,Bt!==0&&(Mt[Wt++]=Bt);for(;qt<Ct;)jt=Ft+Ht,Vt=jt-Ft,Bt=Ft-(jt-Vt)+(Ht-Vt),Ht=kt[++qt],Ft=jt,Bt!==0&&(Mt[Wt++]=Bt);return(Ft!==0||Wt===0)&&(Mt[Wt++]=Ft),Wt}function estimate(xt,$t){let Ct=$t[0];for(let kt=1;kt<xt;kt++)Ct+=$t[kt];return Ct}function vec(xt){return new Float64Array(xt)}const ccwerrboundA=(3+16*epsilon$5)*epsilon$5,ccwerrboundB=(2+12*epsilon$5)*epsilon$5,ccwerrboundC=(9+64*epsilon$5)*epsilon$5*epsilon$5,B$2=vec(4),C1=vec(8),C2=vec(12),D$3=vec(16),u$1=vec(4);function orient2dadapt(xt,$t,Ct,kt,Mt,Ft,jt){let Bt,Vt,zt,Ht,Gt,qt,Wt,Yt,Kt,Xt,Qt,Jt,Zt,sn,ln,dn,hn,cn;const pn=xt-Mt,yn=Ct-Mt,gn=$t-Ft,En=kt-Ft;sn=pn*En,qt=splitter$1*pn,Wt=qt-(qt-pn),Yt=pn-Wt,qt=splitter$1*En,Kt=qt-(qt-En),Xt=En-Kt,ln=Yt*Xt-(sn-Wt*Kt-Yt*Kt-Wt*Xt),dn=gn*yn,qt=splitter$1*gn,Wt=qt-(qt-gn),Yt=gn-Wt,qt=splitter$1*yn,Kt=qt-(qt-yn),Xt=yn-Kt,hn=Yt*Xt-(dn-Wt*Kt-Yt*Kt-Wt*Xt),Qt=ln-hn,Gt=ln-Qt,B$2[0]=ln-(Qt+Gt)+(Gt-hn),Jt=sn+Qt,Gt=Jt-sn,Zt=sn-(Jt-Gt)+(Qt-Gt),Qt=Zt-dn,Gt=Zt-Qt,B$2[1]=Zt-(Qt+Gt)+(Gt-dn),cn=Jt+Qt,Gt=cn-Jt,B$2[2]=Jt-(cn-Gt)+(Qt-Gt),B$2[3]=cn;let bn=estimate(4,B$2),xn=ccwerrboundB*jt;if(bn>=xn||-bn>=xn||(Gt=xt-pn,Bt=xt-(pn+Gt)+(Gt-Mt),Gt=Ct-yn,zt=Ct-(yn+Gt)+(Gt-Mt),Gt=$t-gn,Vt=$t-(gn+Gt)+(Gt-Ft),Gt=kt-En,Ht=kt-(En+Gt)+(Gt-Ft),Bt===0&&Vt===0&&zt===0&&Ht===0)||(xn=ccwerrboundC*jt+resulterrbound*Math.abs(bn),bn+=pn*Ht+En*Bt-(gn*zt+yn*Vt),bn>=xn||-bn>=xn))return bn;sn=Bt*En,qt=splitter$1*Bt,Wt=qt-(qt-Bt),Yt=Bt-Wt,qt=splitter$1*En,Kt=qt-(qt-En),Xt=En-Kt,ln=Yt*Xt-(sn-Wt*Kt-Yt*Kt-Wt*Xt),dn=Vt*yn,qt=splitter$1*Vt,Wt=qt-(qt-Vt),Yt=Vt-Wt,qt=splitter$1*yn,Kt=qt-(qt-yn),Xt=yn-Kt,hn=Yt*Xt-(dn-Wt*Kt-Yt*Kt-Wt*Xt),Qt=ln-hn,Gt=ln-Qt,u$1[0]=ln-(Qt+Gt)+(Gt-hn),Jt=sn+Qt,Gt=Jt-sn,Zt=sn-(Jt-Gt)+(Qt-Gt),Qt=Zt-dn,Gt=Zt-Qt,u$1[1]=Zt-(Qt+Gt)+(Gt-dn),cn=Jt+Qt,Gt=cn-Jt,u$1[2]=Jt-(cn-Gt)+(Qt-Gt),u$1[3]=cn;const Cn=sum$1(4,B$2,4,u$1,C1);sn=pn*Ht,qt=splitter$1*pn,Wt=qt-(qt-pn),Yt=pn-Wt,qt=splitter$1*Ht,Kt=qt-(qt-Ht),Xt=Ht-Kt,ln=Yt*Xt-(sn-Wt*Kt-Yt*Kt-Wt*Xt),dn=gn*zt,qt=splitter$1*gn,Wt=qt-(qt-gn),Yt=gn-Wt,qt=splitter$1*zt,Kt=qt-(qt-zt),Xt=zt-Kt,hn=Yt*Xt-(dn-Wt*Kt-Yt*Kt-Wt*Xt),Qt=ln-hn,Gt=ln-Qt,u$1[0]=ln-(Qt+Gt)+(Gt-hn),Jt=sn+Qt,Gt=Jt-sn,Zt=sn-(Jt-Gt)+(Qt-Gt),Qt=Zt-dn,Gt=Zt-Qt,u$1[1]=Zt-(Qt+Gt)+(Gt-dn),cn=Jt+Qt,Gt=cn-Jt,u$1[2]=Jt-(cn-Gt)+(Qt-Gt),u$1[3]=cn;const $n=sum$1(Cn,C1,4,u$1,C2);sn=Bt*Ht,qt=splitter$1*Bt,Wt=qt-(qt-Bt),Yt=Bt-Wt,qt=splitter$1*Ht,Kt=qt-(qt-Ht),Xt=Ht-Kt,ln=Yt*Xt-(sn-Wt*Kt-Yt*Kt-Wt*Xt),dn=Vt*zt,qt=splitter$1*Vt,Wt=qt-(qt-Vt),Yt=Vt-Wt,qt=splitter$1*zt,Kt=qt-(qt-zt),Xt=zt-Kt,hn=Yt*Xt-(dn-Wt*Kt-Yt*Kt-Wt*Xt),Qt=ln-hn,Gt=ln-Qt,u$1[0]=ln-(Qt+Gt)+(Gt-hn),Jt=sn+Qt,Gt=Jt-sn,Zt=sn-(Jt-Gt)+(Qt-Gt),Qt=Zt-dn,Gt=Zt-Qt,u$1[1]=Zt-(Qt+Gt)+(Gt-dn),cn=Jt+Qt,Gt=cn-Jt,u$1[2]=Jt-(cn-Gt)+(Qt-Gt),u$1[3]=cn;const wn=sum$1($n,C2,4,u$1,D$3);return D$3[wn-1]}function orient2d(xt,$t,Ct,kt,Mt,Ft){const jt=($t-Ft)*(Ct-Mt),Bt=(xt-Mt)*(kt-Ft),Vt=jt-Bt,zt=Math.abs(jt+Bt);return Math.abs(Vt)>=ccwerrboundA*zt?Vt:-orient2dadapt(xt,$t,Ct,kt,Mt,Ft,zt)}const EPSILON$2=Math.pow(2,-52),EDGE_STACK=new Uint32Array(512);class Delaunator{static from($t,Ct=defaultGetX,kt=defaultGetY){const Mt=$t.length,Ft=new Float64Array(Mt*2);for(let jt=0;jt<Mt;jt++){const Bt=$t[jt];Ft[2*jt]=Ct(Bt),Ft[2*jt+1]=kt(Bt)}return new Delaunator(Ft)}constructor($t){const Ct=$t.length>>1;if(Ct>0&&typeof $t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=$t;const kt=Math.max(2*Ct-5,0);this._triangles=new Uint32Array(kt*3),this._halfedges=new Int32Array(kt*3),this._hashSize=Math.ceil(Math.sqrt(Ct)),this._hullPrev=new Uint32Array(Ct),this._hullNext=new Uint32Array(Ct),this._hullTri=new Uint32Array(Ct),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(Ct),this._dists=new Float64Array(Ct),this.update()}update(){const{coords:$t,_hullPrev:Ct,_hullNext:kt,_hullTri:Mt,_hullHash:Ft}=this,jt=$t.length>>1;let Bt=1/0,Vt=1/0,zt=-1/0,Ht=-1/0;for(let pn=0;pn<jt;pn++){const yn=$t[2*pn],gn=$t[2*pn+1];yn<Bt&&(Bt=yn),gn<Vt&&(Vt=gn),yn>zt&&(zt=yn),gn>Ht&&(Ht=gn),this._ids[pn]=pn}const Gt=(Bt+zt)/2,qt=(Vt+Ht)/2;let Wt,Yt,Kt;for(let pn=0,yn=1/0;pn<jt;pn++){const gn=dist(Gt,qt,$t[2*pn],$t[2*pn+1]);gn<yn&&(Wt=pn,yn=gn)}const Xt=$t[2*Wt],Qt=$t[2*Wt+1];for(let pn=0,yn=1/0;pn<jt;pn++){if(pn===Wt)continue;const gn=dist(Xt,Qt,$t[2*pn],$t[2*pn+1]);gn<yn&&gn>0&&(Yt=pn,yn=gn)}let Jt=$t[2*Yt],Zt=$t[2*Yt+1],sn=1/0;for(let pn=0;pn<jt;pn++){if(pn===Wt||pn===Yt)continue;const yn=circumradius(Xt,Qt,Jt,Zt,$t[2*pn],$t[2*pn+1]);yn<sn&&(Kt=pn,sn=yn)}let ln=$t[2*Kt],dn=$t[2*Kt+1];if(sn===1/0){for(let gn=0;gn<jt;gn++)this._dists[gn]=$t[2*gn]-$t[0]||$t[2*gn+1]-$t[1];quicksort(this._ids,this._dists,0,jt-1);const pn=new Uint32Array(jt);let yn=0;for(let gn=0,En=-1/0;gn<jt;gn++){const bn=this._ids[gn],xn=this._dists[bn];xn>En&&(pn[yn++]=bn,En=xn)}this.hull=pn.subarray(0,yn),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(orient2d(Xt,Qt,Jt,Zt,ln,dn)<0){const pn=Yt,yn=Jt,gn=Zt;Yt=Kt,Jt=ln,Zt=dn,Kt=pn,ln=yn,dn=gn}const hn=circumcenter(Xt,Qt,Jt,Zt,ln,dn);this._cx=hn.x,this._cy=hn.y;for(let pn=0;pn<jt;pn++)this._dists[pn]=dist($t[2*pn],$t[2*pn+1],hn.x,hn.y);quicksort(this._ids,this._dists,0,jt-1),this._hullStart=Wt;let cn=3;kt[Wt]=Ct[Kt]=Yt,kt[Yt]=Ct[Wt]=Kt,kt[Kt]=Ct[Yt]=Wt,Mt[Wt]=0,Mt[Yt]=1,Mt[Kt]=2,Ft.fill(-1),Ft[this._hashKey(Xt,Qt)]=Wt,Ft[this._hashKey(Jt,Zt)]=Yt,Ft[this._hashKey(ln,dn)]=Kt,this.trianglesLen=0,this._addTriangle(Wt,Yt,Kt,-1,-1,-1);for(let pn=0,yn,gn;pn<this._ids.length;pn++){const En=this._ids[pn],bn=$t[2*En],xn=$t[2*En+1];if(pn>0&&Math.abs(bn-yn)<=EPSILON$2&&Math.abs(xn-gn)<=EPSILON$2||(yn=bn,gn=xn,En===Wt||En===Yt||En===Kt))continue;let Cn=0;for(let An=0,Sn=this._hashKey(bn,xn);An<this._hashSize&&(Cn=Ft[(Sn+An)%this._hashSize],!(Cn!==-1&&Cn!==kt[Cn]));An++);Cn=Ct[Cn];let $n=Cn,wn;for(;wn=kt[$n],orient2d(bn,xn,$t[2*$n],$t[2*$n+1],$t[2*wn],$t[2*wn+1])>=0;)if($n=wn,$n===Cn){$n=-1;break}if($n===-1)continue;let Rn=this._addTriangle($n,En,kt[$n],-1,-1,Mt[$n]);Mt[En]=this._legalize(Rn+2),Mt[$n]=Rn,cn++;let Dn=kt[$n];for(;wn=kt[Dn],orient2d(bn,xn,$t[2*Dn],$t[2*Dn+1],$t[2*wn],$t[2*wn+1])<0;)Rn=this._addTriangle(Dn,En,wn,Mt[En],-1,Mt[Dn]),Mt[En]=this._legalize(Rn+2),kt[Dn]=Dn,cn--,Dn=wn;if($n===Cn)for(;wn=Ct[$n],orient2d(bn,xn,$t[2*wn],$t[2*wn+1],$t[2*$n],$t[2*$n+1])<0;)Rn=this._addTriangle(wn,En,$n,-1,Mt[$n],Mt[wn]),this._legalize(Rn+2),Mt[wn]=Rn,kt[$n]=$n,cn--,$n=wn;this._hullStart=Ct[En]=$n,kt[$n]=Ct[Dn]=En,kt[En]=Dn,Ft[this._hashKey(bn,xn)]=En,Ft[this._hashKey($t[2*$n],$t[2*$n+1])]=$n}this.hull=new Uint32Array(cn);for(let pn=0,yn=this._hullStart;pn<cn;pn++)this.hull[pn]=yn,yn=kt[yn];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey($t,Ct){return Math.floor(pseudoAngle($t-this._cx,Ct-this._cy)*this._hashSize)%this._hashSize}_legalize($t){const{_triangles:Ct,_halfedges:kt,coords:Mt}=this;let Ft=0,jt=0;for(;;){const Bt=kt[$t],Vt=$t-$t%3;if(jt=Vt+($t+2)%3,Bt===-1){if(Ft===0)break;$t=EDGE_STACK[--Ft];continue}const zt=Bt-Bt%3,Ht=Vt+($t+1)%3,Gt=zt+(Bt+2)%3,qt=Ct[jt],Wt=Ct[$t],Yt=Ct[Ht],Kt=Ct[Gt];if(inCircle(Mt[2*qt],Mt[2*qt+1],Mt[2*Wt],Mt[2*Wt+1],Mt[2*Yt],Mt[2*Yt+1],Mt[2*Kt],Mt[2*Kt+1])){Ct[$t]=Kt,Ct[Bt]=qt;const Qt=kt[Gt];if(Qt===-1){let Zt=this._hullStart;do{if(this._hullTri[Zt]===Gt){this._hullTri[Zt]=$t;break}Zt=this._hullPrev[Zt]}while(Zt!==this._hullStart)}this._link($t,Qt),this._link(Bt,kt[jt]),this._link(jt,Gt);const Jt=zt+(Bt+1)%3;Ft<EDGE_STACK.length&&(EDGE_STACK[Ft++]=Jt)}else{if(Ft===0)break;$t=EDGE_STACK[--Ft]}}return jt}_link($t,Ct){this._halfedges[$t]=Ct,Ct!==-1&&(this._halfedges[Ct]=$t)}_addTriangle($t,Ct,kt,Mt,Ft,jt){const Bt=this.trianglesLen;return this._triangles[Bt]=$t,this._triangles[Bt+1]=Ct,this._triangles[Bt+2]=kt,this._link(Bt,Mt),this._link(Bt+1,Ft),this._link(Bt+2,jt),this.trianglesLen+=3,Bt}}function pseudoAngle(xt,$t){const Ct=xt/(Math.abs(xt)+Math.abs($t));return($t>0?3-Ct:1+Ct)/4}function dist(xt,$t,Ct,kt){const Mt=xt-Ct,Ft=$t-kt;return Mt*Mt+Ft*Ft}function inCircle(xt,$t,Ct,kt,Mt,Ft,jt,Bt){const Vt=xt-jt,zt=$t-Bt,Ht=Ct-jt,Gt=kt-Bt,qt=Mt-jt,Wt=Ft-Bt,Yt=Vt*Vt+zt*zt,Kt=Ht*Ht+Gt*Gt,Xt=qt*qt+Wt*Wt;return Vt*(Gt*Xt-Kt*Wt)-zt*(Ht*Xt-Kt*qt)+Yt*(Ht*Wt-Gt*qt)<0}function circumradius(xt,$t,Ct,kt,Mt,Ft){const jt=Ct-xt,Bt=kt-$t,Vt=Mt-xt,zt=Ft-$t,Ht=jt*jt+Bt*Bt,Gt=Vt*Vt+zt*zt,qt=.5/(jt*zt-Bt*Vt),Wt=(zt*Ht-Bt*Gt)*qt,Yt=(jt*Gt-Vt*Ht)*qt;return Wt*Wt+Yt*Yt}function circumcenter(xt,$t,Ct,kt,Mt,Ft){const jt=Ct-xt,Bt=kt-$t,Vt=Mt-xt,zt=Ft-$t,Ht=jt*jt+Bt*Bt,Gt=Vt*Vt+zt*zt,qt=.5/(jt*zt-Bt*Vt),Wt=xt+(zt*Ht-Bt*Gt)*qt,Yt=$t+(jt*Gt-Vt*Ht)*qt;return{x:Wt,y:Yt}}function quicksort(xt,$t,Ct,kt){if(kt-Ct<=20)for(let Mt=Ct+1;Mt<=kt;Mt++){const Ft=xt[Mt],jt=$t[Ft];let Bt=Mt-1;for(;Bt>=Ct&&$t[xt[Bt]]>jt;)xt[Bt+1]=xt[Bt--];xt[Bt+1]=Ft}else{const Mt=Ct+kt>>1;let Ft=Ct+1,jt=kt;swap(xt,Mt,Ft),$t[xt[Ct]]>$t[xt[kt]]&&swap(xt,Ct,kt),$t[xt[Ft]]>$t[xt[kt]]&&swap(xt,Ft,kt),$t[xt[Ct]]>$t[xt[Ft]]&&swap(xt,Ct,Ft);const Bt=xt[Ft],Vt=$t[Bt];for(;;){do Ft++;while($t[xt[Ft]]<Vt);do jt--;while($t[xt[jt]]>Vt);if(jt<Ft)break;swap(xt,Ft,jt)}xt[Ct+1]=xt[jt],xt[jt]=Bt,kt-Ft+1>=jt-Ct?(quicksort(xt,$t,Ft,kt),quicksort(xt,$t,Ct,jt-1)):(quicksort(xt,$t,Ct,jt-1),quicksort(xt,$t,Ft,kt))}}function swap(xt,$t,Ct){const kt=xt[$t];xt[$t]=xt[Ct],xt[Ct]=kt}function defaultGetX(xt){return xt[0]}function defaultGetY(xt){return xt[1]}const epsilon$4=1e-6;class Path{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo($t,Ct){this._+=`M${this._x0=this._x1=+$t},${this._y0=this._y1=+Ct}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo($t,Ct){this._+=`L${this._x1=+$t},${this._y1=+Ct}`}arc($t,Ct,kt){$t=+$t,Ct=+Ct,kt=+kt;const Mt=$t+kt,Ft=Ct;if(kt<0)throw new Error("negative radius");this._x1===null?this._+=`M${Mt},${Ft}`:(Math.abs(this._x1-Mt)>epsilon$4||Math.abs(this._y1-Ft)>epsilon$4)&&(this._+="L"+Mt+","+Ft),kt&&(this._+=`A${kt},${kt},0,1,1,${$t-kt},${Ct}A${kt},${kt},0,1,1,${this._x1=Mt},${this._y1=Ft}`)}rect($t,Ct,kt,Mt){this._+=`M${this._x0=this._x1=+$t},${this._y0=this._y1=+Ct}h${+kt}v${+Mt}h${-kt}Z`}value(){return this._||null}}class Polygon{constructor(){this._=[]}moveTo($t,Ct){this._.push([$t,Ct])}closePath(){this._.push(this._[0].slice())}lineTo($t,Ct){this._.push([$t,Ct])}value(){return this._.length?this._:null}}let Voronoi$1=class{constructor($t,[Ct,kt,Mt,Ft]=[0,0,960,500]){if(!((Mt=+Mt)>=(Ct=+Ct))||!((Ft=+Ft)>=(kt=+kt)))throw new Error("invalid bounds");this.delaunay=$t,this._circumcenters=new Float64Array($t.points.length*2),this.vectors=new Float64Array($t.points.length*2),this.xmax=Mt,this.xmin=Ct,this.ymax=Ft,this.ymin=kt,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:$t,hull:Ct,triangles:kt},vectors:Mt}=this;let Ft,jt;const Bt=this.circumcenters=this._circumcenters.subarray(0,kt.length/3*2);for(let Kt=0,Xt=0,Qt=kt.length,Jt,Zt;Kt<Qt;Kt+=3,Xt+=2){const sn=kt[Kt]*2,ln=kt[Kt+1]*2,dn=kt[Kt+2]*2,hn=$t[sn],cn=$t[sn+1],pn=$t[ln],yn=$t[ln+1],gn=$t[dn],En=$t[dn+1],bn=pn-hn,xn=yn-cn,Cn=gn-hn,$n=En-cn,wn=(bn*$n-xn*Cn)*2;if(Math.abs(wn)<1e-9){if(Ft===void 0){Ft=jt=0;for(const Dn of Ct)Ft+=$t[Dn*2],jt+=$t[Dn*2+1];Ft/=Ct.length,jt/=Ct.length}const Rn=1e9*Math.sign((Ft-hn)*$n-(jt-cn)*Cn);Jt=(hn+gn)/2-Rn*$n,Zt=(cn+En)/2+Rn*Cn}else{const Rn=1/wn,Dn=bn*bn+xn*xn,An=Cn*Cn+$n*$n;Jt=hn+($n*Dn-xn*An)*Rn,Zt=cn+(bn*An-Cn*Dn)*Rn}Bt[Xt]=Jt,Bt[Xt+1]=Zt}let Vt=Ct[Ct.length-1],zt,Ht=Vt*4,Gt,qt=$t[2*Vt],Wt,Yt=$t[2*Vt+1];Mt.fill(0);for(let Kt=0;Kt<Ct.length;++Kt)Vt=Ct[Kt],zt=Ht,Gt=qt,Wt=Yt,Ht=Vt*4,qt=$t[2*Vt],Yt=$t[2*Vt+1],Mt[zt+2]=Mt[Ht]=Wt-Yt,Mt[zt+3]=Mt[Ht+1]=qt-Gt}render($t){const Ct=$t==null?$t=new Path:void 0,{delaunay:{halfedges:kt,inedges:Mt,hull:Ft},circumcenters:jt,vectors:Bt}=this;if(Ft.length<=1)return null;for(let Ht=0,Gt=kt.length;Ht<Gt;++Ht){const qt=kt[Ht];if(qt<Ht)continue;const Wt=Math.floor(Ht/3)*2,Yt=Math.floor(qt/3)*2,Kt=jt[Wt],Xt=jt[Wt+1],Qt=jt[Yt],Jt=jt[Yt+1];this._renderSegment(Kt,Xt,Qt,Jt,$t)}let Vt,zt=Ft[Ft.length-1];for(let Ht=0;Ht<Ft.length;++Ht){Vt=zt,zt=Ft[Ht];const Gt=Math.floor(Mt[zt]/3)*2,qt=jt[Gt],Wt=jt[Gt+1],Yt=Vt*4,Kt=this._project(qt,Wt,Bt[Yt+2],Bt[Yt+3]);Kt&&this._renderSegment(qt,Wt,Kt[0],Kt[1],$t)}return Ct&&Ct.value()}renderBounds($t){const Ct=$t==null?$t=new Path:void 0;return $t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),Ct&&Ct.value()}renderCell($t,Ct){const kt=Ct==null?Ct=new Path:void 0,Mt=this._clip($t);if(Mt===null||!Mt.length)return;Ct.moveTo(Mt[0],Mt[1]);let Ft=Mt.length;for(;Mt[0]===Mt[Ft-2]&&Mt[1]===Mt[Ft-1]&&Ft>1;)Ft-=2;for(let jt=2;jt<Ft;jt+=2)(Mt[jt]!==Mt[jt-2]||Mt[jt+1]!==Mt[jt-1])&&Ct.lineTo(Mt[jt],Mt[jt+1]);return Ct.closePath(),kt&&kt.value()}*cellPolygons(){const{delaunay:{points:$t}}=this;for(let Ct=0,kt=$t.length/2;Ct<kt;++Ct){const Mt=this.cellPolygon(Ct);Mt&&(Mt.index=Ct,yield Mt)}}cellPolygon($t){const Ct=new Polygon;return this.renderCell($t,Ct),Ct.value()}_renderSegment($t,Ct,kt,Mt,Ft){let jt;const Bt=this._regioncode($t,Ct),Vt=this._regioncode(kt,Mt);Bt===0&&Vt===0?(Ft.moveTo($t,Ct),Ft.lineTo(kt,Mt)):(jt=this._clipSegment($t,Ct,kt,Mt,Bt,Vt))&&(Ft.moveTo(jt[0],jt[1]),Ft.lineTo(jt[2],jt[3]))}contains($t,Ct,kt){return Ct=+Ct,Ct!==Ct||(kt=+kt,kt!==kt)?!1:this.delaunay._step($t,Ct,kt)===$t}*neighbors($t){const Ct=this._clip($t);if(Ct)for(const kt of this.delaunay.neighbors($t)){const Mt=this._clip(kt);if(Mt){e:for(let Ft=0,jt=Ct.length;Ft<jt;Ft+=2)for(let Bt=0,Vt=Mt.length;Bt<Vt;Bt+=2)if(Ct[Ft]===Mt[Bt]&&Ct[Ft+1]===Mt[Bt+1]&&Ct[(Ft+2)%jt]===Mt[(Bt+Vt-2)%Vt]&&Ct[(Ft+3)%jt]===Mt[(Bt+Vt-1)%Vt]){yield kt;break e}}}}_cell($t){const{circumcenters:Ct,delaunay:{inedges:kt,halfedges:Mt,triangles:Ft}}=this,jt=kt[$t];if(jt===-1)return null;const Bt=[];let Vt=jt;do{const zt=Math.floor(Vt/3);if(Bt.push(Ct[zt*2],Ct[zt*2+1]),Vt=Vt%3===2?Vt-2:Vt+1,Ft[Vt]!==$t)break;Vt=Mt[Vt]}while(Vt!==jt&&Vt!==-1);return Bt}_clip($t){if($t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const Ct=this._cell($t);if(Ct===null)return null;const{vectors:kt}=this,Mt=$t*4;return this._simplify(kt[Mt]||kt[Mt+1]?this._clipInfinite($t,Ct,kt[Mt],kt[Mt+1],kt[Mt+2],kt[Mt+3]):this._clipFinite($t,Ct))}_clipFinite($t,Ct){const kt=Ct.length;let Mt=null,Ft,jt,Bt=Ct[kt-2],Vt=Ct[kt-1],zt,Ht=this._regioncode(Bt,Vt),Gt,qt=0;for(let Wt=0;Wt<kt;Wt+=2)if(Ft=Bt,jt=Vt,Bt=Ct[Wt],Vt=Ct[Wt+1],zt=Ht,Ht=this._regioncode(Bt,Vt),zt===0&&Ht===0)Gt=qt,qt=0,Mt?Mt.push(Bt,Vt):Mt=[Bt,Vt];else{let Yt,Kt,Xt,Qt,Jt;if(zt===0){if((Yt=this._clipSegment(Ft,jt,Bt,Vt,zt,Ht))===null)continue;[Kt,Xt,Qt,Jt]=Yt}else{if((Yt=this._clipSegment(Bt,Vt,Ft,jt,Ht,zt))===null)continue;[Qt,Jt,Kt,Xt]=Yt,Gt=qt,qt=this._edgecode(Kt,Xt),Gt&&qt&&this._edge($t,Gt,qt,Mt,Mt.length),Mt?Mt.push(Kt,Xt):Mt=[Kt,Xt]}Gt=qt,qt=this._edgecode(Qt,Jt),Gt&&qt&&this._edge($t,Gt,qt,Mt,Mt.length),Mt?Mt.push(Qt,Jt):Mt=[Qt,Jt]}if(Mt)Gt=qt,qt=this._edgecode(Mt[0],Mt[1]),Gt&&qt&&this._edge($t,Gt,qt,Mt,Mt.length);else if(this.contains($t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return Mt}_clipSegment($t,Ct,kt,Mt,Ft,jt){const Bt=Ft<jt;for(Bt&&([$t,Ct,kt,Mt,Ft,jt]=[kt,Mt,$t,Ct,jt,Ft]);;){if(Ft===0&&jt===0)return Bt?[kt,Mt,$t,Ct]:[$t,Ct,kt,Mt];if(Ft&jt)return null;let Vt,zt,Ht=Ft||jt;Ht&8?(Vt=$t+(kt-$t)*(this.ymax-Ct)/(Mt-Ct),zt=this.ymax):Ht&4?(Vt=$t+(kt-$t)*(this.ymin-Ct)/(Mt-Ct),zt=this.ymin):Ht&2?(zt=Ct+(Mt-Ct)*(this.xmax-$t)/(kt-$t),Vt=this.xmax):(zt=Ct+(Mt-Ct)*(this.xmin-$t)/(kt-$t),Vt=this.xmin),Ft?($t=Vt,Ct=zt,Ft=this._regioncode($t,Ct)):(kt=Vt,Mt=zt,jt=this._regioncode(kt,Mt))}}_clipInfinite($t,Ct,kt,Mt,Ft,jt){let Bt=Array.from(Ct),Vt;if((Vt=this._project(Bt[0],Bt[1],kt,Mt))&&Bt.unshift(Vt[0],Vt[1]),(Vt=this._project(Bt[Bt.length-2],Bt[Bt.length-1],Ft,jt))&&Bt.push(Vt[0],Vt[1]),Bt=this._clipFinite($t,Bt))for(let zt=0,Ht=Bt.length,Gt,qt=this._edgecode(Bt[Ht-2],Bt[Ht-1]);zt<Ht;zt+=2)Gt=qt,qt=this._edgecode(Bt[zt],Bt[zt+1]),Gt&&qt&&(zt=this._edge($t,Gt,qt,Bt,zt),Ht=Bt.length);else this.contains($t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(Bt=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return Bt}_edge($t,Ct,kt,Mt,Ft){for(;Ct!==kt;){let jt,Bt;switch(Ct){case 5:Ct=4;continue;case 4:Ct=6,jt=this.xmax,Bt=this.ymin;break;case 6:Ct=2;continue;case 2:Ct=10,jt=this.xmax,Bt=this.ymax;break;case 10:Ct=8;continue;case 8:Ct=9,jt=this.xmin,Bt=this.ymax;break;case 9:Ct=1;continue;case 1:Ct=5,jt=this.xmin,Bt=this.ymin;break}(Mt[Ft]!==jt||Mt[Ft+1]!==Bt)&&this.contains($t,jt,Bt)&&(Mt.splice(Ft,0,jt,Bt),Ft+=2)}return Ft}_project($t,Ct,kt,Mt){let Ft=1/0,jt,Bt,Vt;if(Mt<0){if(Ct<=this.ymin)return null;(jt=(this.ymin-Ct)/Mt)<Ft&&(Vt=this.ymin,Bt=$t+(Ft=jt)*kt)}else if(Mt>0){if(Ct>=this.ymax)return null;(jt=(this.ymax-Ct)/Mt)<Ft&&(Vt=this.ymax,Bt=$t+(Ft=jt)*kt)}if(kt>0){if($t>=this.xmax)return null;(jt=(this.xmax-$t)/kt)<Ft&&(Bt=this.xmax,Vt=Ct+(Ft=jt)*Mt)}else if(kt<0){if($t<=this.xmin)return null;(jt=(this.xmin-$t)/kt)<Ft&&(Bt=this.xmin,Vt=Ct+(Ft=jt)*Mt)}return[Bt,Vt]}_edgecode($t,Ct){return($t===this.xmin?1:$t===this.xmax?2:0)|(Ct===this.ymin?4:Ct===this.ymax?8:0)}_regioncode($t,Ct){return($t<this.xmin?1:$t>this.xmax?2:0)|(Ct<this.ymin?4:Ct>this.ymax?8:0)}_simplify($t){if($t&&$t.length>4){for(let Ct=0;Ct<$t.length;Ct+=2){const kt=(Ct+2)%$t.length,Mt=(Ct+4)%$t.length;($t[Ct]===$t[kt]&&$t[kt]===$t[Mt]||$t[Ct+1]===$t[kt+1]&&$t[kt+1]===$t[Mt+1])&&($t.splice(kt,2),Ct-=2)}$t.length||($t=null)}return $t}};const tau$2=2*Math.PI,pow$4=Math.pow;function pointX(xt){return xt[0]}function pointY(xt){return xt[1]}function collinear$1(xt){const{triangles:$t,coords:Ct}=xt;for(let kt=0;kt<$t.length;kt+=3){const Mt=2*$t[kt],Ft=2*$t[kt+1],jt=2*$t[kt+2];if((Ct[jt]-Ct[Mt])*(Ct[Ft+1]-Ct[Mt+1])-(Ct[Ft]-Ct[Mt])*(Ct[jt+1]-Ct[Mt+1])>1e-10)return!1}return!0}function jitter(xt,$t,Ct){return[xt+Math.sin(xt+$t)*Ct,$t+Math.cos(xt-$t)*Ct]}class Delaunay{static from($t,Ct=pointX,kt=pointY,Mt){return new Delaunay("length"in $t?flatArray($t,Ct,kt,Mt):Float64Array.from(flatIterable($t,Ct,kt,Mt)))}constructor($t){this._delaunator=new Delaunator($t),this.inedges=new Int32Array($t.length/2),this._hullIndex=new Int32Array($t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const $t=this._delaunator,Ct=this.points;if($t.hull&&$t.hull.length>2&&collinear$1($t)){this.collinear=Int32Array.from({length:Ct.length/2},(qt,Wt)=>Wt).sort((qt,Wt)=>Ct[2*qt]-Ct[2*Wt]||Ct[2*qt+1]-Ct[2*Wt+1]);const Vt=this.collinear[0],zt=this.collinear[this.collinear.length-1],Ht=[Ct[2*Vt],Ct[2*Vt+1],Ct[2*zt],Ct[2*zt+1]],Gt=1e-8*Math.hypot(Ht[3]-Ht[1],Ht[2]-Ht[0]);for(let qt=0,Wt=Ct.length/2;qt<Wt;++qt){const Yt=jitter(Ct[2*qt],Ct[2*qt+1],Gt);Ct[2*qt]=Yt[0],Ct[2*qt+1]=Yt[1]}this._delaunator=new Delaunator(Ct)}else delete this.collinear;const kt=this.halfedges=this._delaunator.halfedges,Mt=this.hull=this._delaunator.hull,Ft=this.triangles=this._delaunator.triangles,jt=this.inedges.fill(-1),Bt=this._hullIndex.fill(-1);for(let Vt=0,zt=kt.length;Vt<zt;++Vt){const Ht=Ft[Vt%3===2?Vt-2:Vt+1];(kt[Vt]===-1||jt[Ht]===-1)&&(jt[Ht]=Vt)}for(let Vt=0,zt=Mt.length;Vt<zt;++Vt)Bt[Mt[Vt]]=Vt;Mt.length<=2&&Mt.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=Mt[0],jt[Mt[0]]=1,Mt.length===2&&(jt[Mt[1]]=0,this.triangles[1]=Mt[1],this.triangles[2]=Mt[1]))}voronoi($t){return new Voronoi$1(this,$t)}*neighbors($t){const{inedges:Ct,hull:kt,_hullIndex:Mt,halfedges:Ft,triangles:jt,collinear:Bt}=this;if(Bt){const Gt=Bt.indexOf($t);Gt>0&&(yield Bt[Gt-1]),Gt<Bt.length-1&&(yield Bt[Gt+1]);return}const Vt=Ct[$t];if(Vt===-1)return;let zt=Vt,Ht=-1;do{if(yield Ht=jt[zt],zt=zt%3===2?zt-2:zt+1,jt[zt]!==$t)return;if(zt=Ft[zt],zt===-1){const Gt=kt[(Mt[$t]+1)%kt.length];Gt!==Ht&&(yield Gt);return}}while(zt!==Vt)}find($t,Ct,kt=0){if($t=+$t,$t!==$t||(Ct=+Ct,Ct!==Ct))return-1;const Mt=kt;let Ft;for(;(Ft=this._step(kt,$t,Ct))>=0&&Ft!==kt&&Ft!==Mt;)kt=Ft;return Ft}_step($t,Ct,kt){const{inedges:Mt,hull:Ft,_hullIndex:jt,halfedges:Bt,triangles:Vt,points:zt}=this;if(Mt[$t]===-1||!zt.length)return($t+1)%(zt.length>>1);let Ht=$t,Gt=pow$4(Ct-zt[$t*2],2)+pow$4(kt-zt[$t*2+1],2);const qt=Mt[$t];let Wt=qt;do{let Yt=Vt[Wt];const Kt=pow$4(Ct-zt[Yt*2],2)+pow$4(kt-zt[Yt*2+1],2);if(Kt<Gt&&(Gt=Kt,Ht=Yt),Wt=Wt%3===2?Wt-2:Wt+1,Vt[Wt]!==$t)break;if(Wt=Bt[Wt],Wt===-1){if(Wt=Ft[(jt[$t]+1)%Ft.length],Wt!==Yt&&pow$4(Ct-zt[Wt*2],2)+pow$4(kt-zt[Wt*2+1],2)<Gt)return Wt;break}}while(Wt!==qt);return Ht}render($t){const Ct=$t==null?$t=new Path:void 0,{points:kt,halfedges:Mt,triangles:Ft}=this;for(let jt=0,Bt=Mt.length;jt<Bt;++jt){const Vt=Mt[jt];if(Vt<jt)continue;const zt=Ft[jt]*2,Ht=Ft[Vt]*2;$t.moveTo(kt[zt],kt[zt+1]),$t.lineTo(kt[Ht],kt[Ht+1])}return this.renderHull($t),Ct&&Ct.value()}renderPoints($t,Ct){Ct===void 0&&(!$t||typeof $t.moveTo!="function")&&(Ct=$t,$t=null),Ct=Ct==null?2:+Ct;const kt=$t==null?$t=new Path:void 0,{points:Mt}=this;for(let Ft=0,jt=Mt.length;Ft<jt;Ft+=2){const Bt=Mt[Ft],Vt=Mt[Ft+1];$t.moveTo(Bt+Ct,Vt),$t.arc(Bt,Vt,Ct,0,tau$2)}return kt&&kt.value()}renderHull($t){const Ct=$t==null?$t=new Path:void 0,{hull:kt,points:Mt}=this,Ft=kt[0]*2,jt=kt.length;$t.moveTo(Mt[Ft],Mt[Ft+1]);for(let Bt=1;Bt<jt;++Bt){const Vt=2*kt[Bt];$t.lineTo(Mt[Vt],Mt[Vt+1])}return $t.closePath(),Ct&&Ct.value()}hullPolygon(){const $t=new Polygon;return this.renderHull($t),$t.value()}renderTriangle($t,Ct){const kt=Ct==null?Ct=new Path:void 0,{points:Mt,triangles:Ft}=this,jt=Ft[$t*=3]*2,Bt=Ft[$t+1]*2,Vt=Ft[$t+2]*2;return Ct.moveTo(Mt[jt],Mt[jt+1]),Ct.lineTo(Mt[Bt],Mt[Bt+1]),Ct.lineTo(Mt[Vt],Mt[Vt+1]),Ct.closePath(),kt&&kt.value()}*trianglePolygons(){const{triangles:$t}=this;for(let Ct=0,kt=$t.length/3;Ct<kt;++Ct)yield this.trianglePolygon(Ct)}trianglePolygon($t){const Ct=new Polygon;return this.renderTriangle($t,Ct),Ct.value()}}function flatArray(xt,$t,Ct,kt){const Mt=xt.length,Ft=new Float64Array(Mt*2);for(let jt=0;jt<Mt;++jt){const Bt=xt[jt];Ft[jt*2]=$t.call(kt,Bt,jt,xt),Ft[jt*2+1]=Ct.call(kt,Bt,jt,xt)}return Ft}function*flatIterable(xt,$t,Ct,kt){let Mt=0;for(const Ft of xt)yield $t.call(kt,Ft,Mt,xt),yield Ct.call(kt,Ft,Mt,xt),++Mt}var EOL={},EOF={},QUOTE=34,NEWLINE=10,RETURN=13;function objectConverter(xt){return new Function("d","return {"+xt.map(function($t,Ct){return JSON.stringify($t)+": d["+Ct+'] || ""'}).join(",")+"}")}function customConverter(xt,$t){var Ct=objectConverter(xt);return function(kt,Mt){return $t(Ct(kt),Mt,xt)}}function inferColumns(xt){var $t=Object.create(null),Ct=[];return xt.forEach(function(kt){for(var Mt in kt)Mt in $t||Ct.push($t[Mt]=Mt)}),Ct}function pad$4(xt,$t){var Ct=xt+"",kt=Ct.length;return kt<$t?new Array($t-kt+1).join(0)+Ct:Ct}function formatYear$2(xt){return xt<0?"-"+pad$4(-xt,6):xt>9999?"+"+pad$4(xt,6):pad$4(xt,4)}function formatDate$1(xt){var $t=xt.getUTCHours(),Ct=xt.getUTCMinutes(),kt=xt.getUTCSeconds(),Mt=xt.getUTCMilliseconds();return isNaN(xt)?"Invalid Date":formatYear$2(xt.getUTCFullYear())+"-"+pad$4(xt.getUTCMonth()+1,2)+"-"+pad$4(xt.getUTCDate(),2)+(Mt?"T"+pad$4($t,2)+":"+pad$4(Ct,2)+":"+pad$4(kt,2)+"."+pad$4(Mt,3)+"Z":kt?"T"+pad$4($t,2)+":"+pad$4(Ct,2)+":"+pad$4(kt,2)+"Z":Ct||$t?"T"+pad$4($t,2)+":"+pad$4(Ct,2)+"Z":"")}function dsvFormat(xt){var $t=new RegExp('["'+xt+`
\r]`),Ct=xt.charCodeAt(0);function kt(Gt,qt){var Wt,Yt,Kt=Mt(Gt,function(Xt,Qt){if(Wt)return Wt(Xt,Qt-1);Yt=Xt,Wt=qt?customConverter(Xt,qt):objectConverter(Xt)});return Kt.columns=Yt||[],Kt}function Mt(Gt,qt){var Wt=[],Yt=Gt.length,Kt=0,Xt=0,Qt,Jt=Yt<=0,Zt=!1;Gt.charCodeAt(Yt-1)===NEWLINE&&--Yt,Gt.charCodeAt(Yt-1)===RETURN&&--Yt;function sn(){if(Jt)return EOF;if(Zt)return Zt=!1,EOL;var dn,hn=Kt,cn;if(Gt.charCodeAt(hn)===QUOTE){for(;Kt++<Yt&&Gt.charCodeAt(Kt)!==QUOTE||Gt.charCodeAt(++Kt)===QUOTE;);return(dn=Kt)>=Yt?Jt=!0:(cn=Gt.charCodeAt(Kt++))===NEWLINE?Zt=!0:cn===RETURN&&(Zt=!0,Gt.charCodeAt(Kt)===NEWLINE&&++Kt),Gt.slice(hn+1,dn-1).replace(/""/g,'"')}for(;Kt<Yt;){if((cn=Gt.charCodeAt(dn=Kt++))===NEWLINE)Zt=!0;else if(cn===RETURN)Zt=!0,Gt.charCodeAt(Kt)===NEWLINE&&++Kt;else if(cn!==Ct)continue;return Gt.slice(hn,dn)}return Jt=!0,Gt.slice(hn,Yt)}for(;(Qt=sn())!==EOF;){for(var ln=[];Qt!==EOL&&Qt!==EOF;)ln.push(Qt),Qt=sn();qt&&(ln=qt(ln,Xt++))==null||Wt.push(ln)}return Wt}function Ft(Gt,qt){return Gt.map(function(Wt){return qt.map(function(Yt){return Ht(Wt[Yt])}).join(xt)})}function jt(Gt,qt){return qt==null&&(qt=inferColumns(Gt)),[qt.map(Ht).join(xt)].concat(Ft(Gt,qt)).join(`
`)}function Bt(Gt,qt){return qt==null&&(qt=inferColumns(Gt)),Ft(Gt,qt).join(`
`)}function Vt(Gt){return Gt.map(zt).join(`
`)}function zt(Gt){return Gt.map(Ht).join(xt)}function Ht(Gt){return Gt==null?"":Gt instanceof Date?formatDate$1(Gt):$t.test(Gt+="")?'"'+Gt.replace(/"/g,'""')+'"':Gt}return{parse:kt,parseRows:Mt,format:jt,formatBody:Bt,formatRows:Vt,formatRow:zt,formatValue:Ht}}var csv$1=dsvFormat(","),csvParse=csv$1.parse;function responseText(xt){if(!xt.ok)throw new Error(xt.status+" "+xt.statusText);return xt.text()}function text$3(xt,$t){return fetch(xt,$t).then(responseText)}function dsvParse(xt){return function($t,Ct,kt){return arguments.length===2&&typeof Ct=="function"&&(kt=Ct,Ct=void 0),text$3($t,Ct).then(function(Mt){return xt(Mt,kt)})}}var csv=dsvParse(csvParse);function forceCenter(xt,$t){var Ct,kt=1;xt==null&&(xt=0),$t==null&&($t=0);function Mt(){var Ft,jt=Ct.length,Bt,Vt=0,zt=0;for(Ft=0;Ft<jt;++Ft)Bt=Ct[Ft],Vt+=Bt.x,zt+=Bt.y;for(Vt=(Vt/jt-xt)*kt,zt=(zt/jt-$t)*kt,Ft=0;Ft<jt;++Ft)Bt=Ct[Ft],Bt.x-=Vt,Bt.y-=zt}return Mt.initialize=function(Ft){Ct=Ft},Mt.x=function(Ft){return arguments.length?(xt=+Ft,Mt):xt},Mt.y=function(Ft){return arguments.length?($t=+Ft,Mt):$t},Mt.strength=function(Ft){return arguments.length?(kt=+Ft,Mt):kt},Mt}function tree_add(xt){const $t=+this._x.call(null,xt),Ct=+this._y.call(null,xt);return add$4(this.cover($t,Ct),$t,Ct,xt)}function add$4(xt,$t,Ct,kt){if(isNaN($t)||isNaN(Ct))return xt;var Mt,Ft=xt._root,jt={data:kt},Bt=xt._x0,Vt=xt._y0,zt=xt._x1,Ht=xt._y1,Gt,qt,Wt,Yt,Kt,Xt,Qt,Jt;if(!Ft)return xt._root=jt,xt;for(;Ft.length;)if((Kt=$t>=(Gt=(Bt+zt)/2))?Bt=Gt:zt=Gt,(Xt=Ct>=(qt=(Vt+Ht)/2))?Vt=qt:Ht=qt,Mt=Ft,!(Ft=Ft[Qt=Xt<<1|Kt]))return Mt[Qt]=jt,xt;if(Wt=+xt._x.call(null,Ft.data),Yt=+xt._y.call(null,Ft.data),$t===Wt&&Ct===Yt)return jt.next=Ft,Mt?Mt[Qt]=jt:xt._root=jt,xt;do Mt=Mt?Mt[Qt]=new Array(4):xt._root=new Array(4),(Kt=$t>=(Gt=(Bt+zt)/2))?Bt=Gt:zt=Gt,(Xt=Ct>=(qt=(Vt+Ht)/2))?Vt=qt:Ht=qt;while((Qt=Xt<<1|Kt)===(Jt=(Yt>=qt)<<1|Wt>=Gt));return Mt[Jt]=Ft,Mt[Qt]=jt,xt}function addAll(xt){var $t,Ct,kt=xt.length,Mt,Ft,jt=new Array(kt),Bt=new Array(kt),Vt=1/0,zt=1/0,Ht=-1/0,Gt=-1/0;for(Ct=0;Ct<kt;++Ct)isNaN(Mt=+this._x.call(null,$t=xt[Ct]))||isNaN(Ft=+this._y.call(null,$t))||(jt[Ct]=Mt,Bt[Ct]=Ft,Mt<Vt&&(Vt=Mt),Mt>Ht&&(Ht=Mt),Ft<zt&&(zt=Ft),Ft>Gt&&(Gt=Ft));if(Vt>Ht||zt>Gt)return this;for(this.cover(Vt,zt).cover(Ht,Gt),Ct=0;Ct<kt;++Ct)add$4(this,jt[Ct],Bt[Ct],xt[Ct]);return this}function tree_cover(xt,$t){if(isNaN(xt=+xt)||isNaN($t=+$t))return this;var Ct=this._x0,kt=this._y0,Mt=this._x1,Ft=this._y1;if(isNaN(Ct))Mt=(Ct=Math.floor(xt))+1,Ft=(kt=Math.floor($t))+1;else{for(var jt=Mt-Ct||1,Bt=this._root,Vt,zt;Ct>xt||xt>=Mt||kt>$t||$t>=Ft;)switch(zt=($t<kt)<<1|xt<Ct,Vt=new Array(4),Vt[zt]=Bt,Bt=Vt,jt*=2,zt){case 0:Mt=Ct+jt,Ft=kt+jt;break;case 1:Ct=Mt-jt,Ft=kt+jt;break;case 2:Mt=Ct+jt,kt=Ft-jt;break;case 3:Ct=Mt-jt,kt=Ft-jt;break}this._root&&this._root.length&&(this._root=Bt)}return this._x0=Ct,this._y0=kt,this._x1=Mt,this._y1=Ft,this}function tree_data(){var xt=[];return this.visit(function($t){if(!$t.length)do xt.push($t.data);while($t=$t.next)}),xt}function tree_extent(xt){return arguments.length?this.cover(+xt[0][0],+xt[0][1]).cover(+xt[1][0],+xt[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Quad(xt,$t,Ct,kt,Mt){this.node=xt,this.x0=$t,this.y0=Ct,this.x1=kt,this.y1=Mt}function tree_find(xt,$t,Ct){var kt,Mt=this._x0,Ft=this._y0,jt,Bt,Vt,zt,Ht=this._x1,Gt=this._y1,qt=[],Wt=this._root,Yt,Kt;for(Wt&&qt.push(new Quad(Wt,Mt,Ft,Ht,Gt)),Ct==null?Ct=1/0:(Mt=xt-Ct,Ft=$t-Ct,Ht=xt+Ct,Gt=$t+Ct,Ct*=Ct);Yt=qt.pop();)if(!(!(Wt=Yt.node)||(jt=Yt.x0)>Ht||(Bt=Yt.y0)>Gt||(Vt=Yt.x1)<Mt||(zt=Yt.y1)<Ft))if(Wt.length){var Xt=(jt+Vt)/2,Qt=(Bt+zt)/2;qt.push(new Quad(Wt[3],Xt,Qt,Vt,zt),new Quad(Wt[2],jt,Qt,Xt,zt),new Quad(Wt[1],Xt,Bt,Vt,Qt),new Quad(Wt[0],jt,Bt,Xt,Qt)),(Kt=($t>=Qt)<<1|xt>=Xt)&&(Yt=qt[qt.length-1],qt[qt.length-1]=qt[qt.length-1-Kt],qt[qt.length-1-Kt]=Yt)}else{var Jt=xt-+this._x.call(null,Wt.data),Zt=$t-+this._y.call(null,Wt.data),sn=Jt*Jt+Zt*Zt;if(sn<Ct){var ln=Math.sqrt(Ct=sn);Mt=xt-ln,Ft=$t-ln,Ht=xt+ln,Gt=$t+ln,kt=Wt.data}}return kt}function tree_remove(xt){if(isNaN(Ht=+this._x.call(null,xt))||isNaN(Gt=+this._y.call(null,xt)))return this;var $t,Ct=this._root,kt,Mt,Ft,jt=this._x0,Bt=this._y0,Vt=this._x1,zt=this._y1,Ht,Gt,qt,Wt,Yt,Kt,Xt,Qt;if(!Ct)return this;if(Ct.length)for(;;){if((Yt=Ht>=(qt=(jt+Vt)/2))?jt=qt:Vt=qt,(Kt=Gt>=(Wt=(Bt+zt)/2))?Bt=Wt:zt=Wt,$t=Ct,!(Ct=Ct[Xt=Kt<<1|Yt]))return this;if(!Ct.length)break;($t[Xt+1&3]||$t[Xt+2&3]||$t[Xt+3&3])&&(kt=$t,Qt=Xt)}for(;Ct.data!==xt;)if(Mt=Ct,!(Ct=Ct.next))return this;return(Ft=Ct.next)&&delete Ct.next,Mt?(Ft?Mt.next=Ft:delete Mt.next,this):$t?(Ft?$t[Xt]=Ft:delete $t[Xt],(Ct=$t[0]||$t[1]||$t[2]||$t[3])&&Ct===($t[3]||$t[2]||$t[1]||$t[0])&&!Ct.length&&(kt?kt[Qt]=Ct:this._root=Ct),this):(this._root=Ft,this)}function removeAll(xt){for(var $t=0,Ct=xt.length;$t<Ct;++$t)this.remove(xt[$t]);return this}function tree_root(){return this._root}function tree_size(){var xt=0;return this.visit(function($t){if(!$t.length)do++xt;while($t=$t.next)}),xt}function tree_visit(xt){var $t=[],Ct,kt=this._root,Mt,Ft,jt,Bt,Vt;for(kt&&$t.push(new Quad(kt,this._x0,this._y0,this._x1,this._y1));Ct=$t.pop();)if(!xt(kt=Ct.node,Ft=Ct.x0,jt=Ct.y0,Bt=Ct.x1,Vt=Ct.y1)&&kt.length){var zt=(Ft+Bt)/2,Ht=(jt+Vt)/2;(Mt=kt[3])&&$t.push(new Quad(Mt,zt,Ht,Bt,Vt)),(Mt=kt[2])&&$t.push(new Quad(Mt,Ft,Ht,zt,Vt)),(Mt=kt[1])&&$t.push(new Quad(Mt,zt,jt,Bt,Ht)),(Mt=kt[0])&&$t.push(new Quad(Mt,Ft,jt,zt,Ht))}return this}function tree_visitAfter(xt){var $t=[],Ct=[],kt;for(this._root&&$t.push(new Quad(this._root,this._x0,this._y0,this._x1,this._y1));kt=$t.pop();){var Mt=kt.node;if(Mt.length){var Ft,jt=kt.x0,Bt=kt.y0,Vt=kt.x1,zt=kt.y1,Ht=(jt+Vt)/2,Gt=(Bt+zt)/2;(Ft=Mt[0])&&$t.push(new Quad(Ft,jt,Bt,Ht,Gt)),(Ft=Mt[1])&&$t.push(new Quad(Ft,Ht,Bt,Vt,Gt)),(Ft=Mt[2])&&$t.push(new Quad(Ft,jt,Gt,Ht,zt)),(Ft=Mt[3])&&$t.push(new Quad(Ft,Ht,Gt,Vt,zt))}Ct.push(kt)}for(;kt=Ct.pop();)xt(kt.node,kt.x0,kt.y0,kt.x1,kt.y1);return this}function defaultX(xt){return xt[0]}function tree_x(xt){return arguments.length?(this._x=xt,this):this._x}function defaultY(xt){return xt[1]}function tree_y(xt){return arguments.length?(this._y=xt,this):this._y}function quadtree(xt,$t,Ct){var kt=new Quadtree($t??defaultX,Ct??defaultY,NaN,NaN,NaN,NaN);return xt==null?kt:kt.addAll(xt)}function Quadtree(xt,$t,Ct,kt,Mt,Ft){this._x=xt,this._y=$t,this._x0=Ct,this._y0=kt,this._x1=Mt,this._y1=Ft,this._root=void 0}function leaf_copy(xt){for(var $t={data:xt.data},Ct=$t;xt=xt.next;)Ct=Ct.next={data:xt.data};return $t}var treeProto=quadtree.prototype=Quadtree.prototype;treeProto.copy=function(){var xt=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),$t=this._root,Ct,kt;if(!$t)return xt;if(!$t.length)return xt._root=leaf_copy($t),xt;for(Ct=[{source:$t,target:xt._root=new Array(4)}];$t=Ct.pop();)for(var Mt=0;Mt<4;++Mt)(kt=$t.source[Mt])&&(kt.length?Ct.push({source:kt,target:$t.target[Mt]=new Array(4)}):$t.target[Mt]=leaf_copy(kt));return xt};treeProto.add=tree_add;treeProto.addAll=addAll;treeProto.cover=tree_cover;treeProto.data=tree_data;treeProto.extent=tree_extent;treeProto.find=tree_find;treeProto.remove=tree_remove;treeProto.removeAll=removeAll;treeProto.root=tree_root;treeProto.size=tree_size;treeProto.visit=tree_visit;treeProto.visitAfter=tree_visitAfter;treeProto.x=tree_x;treeProto.y=tree_y;function constant$4(xt){return function(){return xt}}function jiggle(xt){return(xt()-.5)*1e-6}function x$5(xt){return xt.x+xt.vx}function y$5(xt){return xt.y+xt.vy}function forceCollide(xt){var $t,Ct,kt,Mt=1,Ft=1;typeof xt!="function"&&(xt=constant$4(xt==null?1:+xt));function jt(){for(var zt,Ht=$t.length,Gt,qt,Wt,Yt,Kt,Xt,Qt=0;Qt<Ft;++Qt)for(Gt=quadtree($t,x$5,y$5).visitAfter(Bt),zt=0;zt<Ht;++zt)qt=$t[zt],Kt=Ct[qt.index],Xt=Kt*Kt,Wt=qt.x+qt.vx,Yt=qt.y+qt.vy,Gt.visit(Jt);function Jt(Zt,sn,ln,dn,hn){var cn=Zt.data,pn=Zt.r,yn=Kt+pn;if(cn){if(cn.index>qt.index){var gn=Wt-cn.x-cn.vx,En=Yt-cn.y-cn.vy,bn=gn*gn+En*En;bn<yn*yn&&(gn===0&&(gn=jiggle(kt),bn+=gn*gn),En===0&&(En=jiggle(kt),bn+=En*En),bn=(yn-(bn=Math.sqrt(bn)))/bn*Mt,qt.vx+=(gn*=bn)*(yn=(pn*=pn)/(Xt+pn)),qt.vy+=(En*=bn)*yn,cn.vx-=gn*(yn=1-yn),cn.vy-=En*yn)}return}return sn>Wt+yn||dn<Wt-yn||ln>Yt+yn||hn<Yt-yn}}function Bt(zt){if(zt.data)return zt.r=Ct[zt.data.index];for(var Ht=zt.r=0;Ht<4;++Ht)zt[Ht]&&zt[Ht].r>zt.r&&(zt.r=zt[Ht].r)}function Vt(){if($t){var zt,Ht=$t.length,Gt;for(Ct=new Array(Ht),zt=0;zt<Ht;++zt)Gt=$t[zt],Ct[Gt.index]=+xt(Gt,zt,$t)}}return jt.initialize=function(zt,Ht){$t=zt,kt=Ht,Vt()},jt.iterations=function(zt){return arguments.length?(Ft=+zt,jt):Ft},jt.strength=function(zt){return arguments.length?(Mt=+zt,jt):Mt},jt.radius=function(zt){return arguments.length?(xt=typeof zt=="function"?zt:constant$4(+zt),Vt(),jt):xt},jt}function index$1(xt){return xt.index}function find$4(xt,$t){var Ct=xt.get($t);if(!Ct)throw new Error("node not found: "+$t);return Ct}function forceLink(xt){var $t=index$1,Ct=Gt,kt,Mt=constant$4(30),Ft,jt,Bt,Vt,zt,Ht=1;xt==null&&(xt=[]);function Gt(Xt){return 1/Math.min(Bt[Xt.source.index],Bt[Xt.target.index])}function qt(Xt){for(var Qt=0,Jt=xt.length;Qt<Ht;++Qt)for(var Zt=0,sn,ln,dn,hn,cn,pn,yn;Zt<Jt;++Zt)sn=xt[Zt],ln=sn.source,dn=sn.target,hn=dn.x+dn.vx-ln.x-ln.vx||jiggle(zt),cn=dn.y+dn.vy-ln.y-ln.vy||jiggle(zt),pn=Math.sqrt(hn*hn+cn*cn),pn=(pn-Ft[Zt])/pn*Xt*kt[Zt],hn*=pn,cn*=pn,dn.vx-=hn*(yn=Vt[Zt]),dn.vy-=cn*yn,ln.vx+=hn*(yn=1-yn),ln.vy+=cn*yn}function Wt(){if(jt){var Xt,Qt=jt.length,Jt=xt.length,Zt=new Map(jt.map((ln,dn)=>[$t(ln,dn,jt),ln])),sn;for(Xt=0,Bt=new Array(Qt);Xt<Jt;++Xt)sn=xt[Xt],sn.index=Xt,typeof sn.source!="object"&&(sn.source=find$4(Zt,sn.source)),typeof sn.target!="object"&&(sn.target=find$4(Zt,sn.target)),Bt[sn.source.index]=(Bt[sn.source.index]||0)+1,Bt[sn.target.index]=(Bt[sn.target.index]||0)+1;for(Xt=0,Vt=new Array(Jt);Xt<Jt;++Xt)sn=xt[Xt],Vt[Xt]=Bt[sn.source.index]/(Bt[sn.source.index]+Bt[sn.target.index]);kt=new Array(Jt),Yt(),Ft=new Array(Jt),Kt()}}function Yt(){if(jt)for(var Xt=0,Qt=xt.length;Xt<Qt;++Xt)kt[Xt]=+Ct(xt[Xt],Xt,xt)}function Kt(){if(jt)for(var Xt=0,Qt=xt.length;Xt<Qt;++Xt)Ft[Xt]=+Mt(xt[Xt],Xt,xt)}return qt.initialize=function(Xt,Qt){jt=Xt,zt=Qt,Wt()},qt.links=function(Xt){return arguments.length?(xt=Xt,Wt(),qt):xt},qt.id=function(Xt){return arguments.length?($t=Xt,qt):$t},qt.iterations=function(Xt){return arguments.length?(Ht=+Xt,qt):Ht},qt.strength=function(Xt){return arguments.length?(Ct=typeof Xt=="function"?Xt:constant$4(+Xt),Yt(),qt):Ct},qt.distance=function(Xt){return arguments.length?(Mt=typeof Xt=="function"?Xt:constant$4(+Xt),Kt(),qt):Mt},qt}const a$2=1664525,c$2=1013904223,m$3=4294967296;function lcg$2(){let xt=1;return()=>(xt=(a$2*xt+c$2)%m$3)/m$3}function x$4(xt){return xt.x}function y$4(xt){return xt.y}var initialRadius=10,initialAngle=Math.PI*(3-Math.sqrt(5));function forceSimulation(xt){var $t,Ct=1,kt=.001,Mt=1-Math.pow(kt,1/300),Ft=0,jt=.6,Bt=new Map,Vt=timer$1(Gt),zt=dispatch("tick","end"),Ht=lcg$2();xt==null&&(xt=[]);function Gt(){qt(),zt.call("tick",$t),Ct<kt&&(Vt.stop(),zt.call("end",$t))}function qt(Kt){var Xt,Qt=xt.length,Jt;Kt===void 0&&(Kt=1);for(var Zt=0;Zt<Kt;++Zt)for(Ct+=(Ft-Ct)*Mt,Bt.forEach(function(sn){sn(Ct)}),Xt=0;Xt<Qt;++Xt)Jt=xt[Xt],Jt.fx==null?Jt.x+=Jt.vx*=jt:(Jt.x=Jt.fx,Jt.vx=0),Jt.fy==null?Jt.y+=Jt.vy*=jt:(Jt.y=Jt.fy,Jt.vy=0);return $t}function Wt(){for(var Kt=0,Xt=xt.length,Qt;Kt<Xt;++Kt){if(Qt=xt[Kt],Qt.index=Kt,Qt.fx!=null&&(Qt.x=Qt.fx),Qt.fy!=null&&(Qt.y=Qt.fy),isNaN(Qt.x)||isNaN(Qt.y)){var Jt=initialRadius*Math.sqrt(.5+Kt),Zt=Kt*initialAngle;Qt.x=Jt*Math.cos(Zt),Qt.y=Jt*Math.sin(Zt)}(isNaN(Qt.vx)||isNaN(Qt.vy))&&(Qt.vx=Qt.vy=0)}}function Yt(Kt){return Kt.initialize&&Kt.initialize(xt,Ht),Kt}return Wt(),$t={tick:qt,restart:function(){return Vt.restart(Gt),$t},stop:function(){return Vt.stop(),$t},nodes:function(Kt){return arguments.length?(xt=Kt,Wt(),Bt.forEach(Yt),$t):xt},alpha:function(Kt){return arguments.length?(Ct=+Kt,$t):Ct},alphaMin:function(Kt){return arguments.length?(kt=+Kt,$t):kt},alphaDecay:function(Kt){return arguments.length?(Mt=+Kt,$t):+Mt},alphaTarget:function(Kt){return arguments.length?(Ft=+Kt,$t):Ft},velocityDecay:function(Kt){return arguments.length?(jt=1-Kt,$t):1-jt},randomSource:function(Kt){return arguments.length?(Ht=Kt,Bt.forEach(Yt),$t):Ht},force:function(Kt,Xt){return arguments.length>1?(Xt==null?Bt.delete(Kt):Bt.set(Kt,Yt(Xt)),$t):Bt.get(Kt)},find:function(Kt,Xt,Qt){var Jt=0,Zt=xt.length,sn,ln,dn,hn,cn;for(Qt==null?Qt=1/0:Qt*=Qt,Jt=0;Jt<Zt;++Jt)hn=xt[Jt],sn=Kt-hn.x,ln=Xt-hn.y,dn=sn*sn+ln*ln,dn<Qt&&(cn=hn,Qt=dn);return cn},on:function(Kt,Xt){return arguments.length>1?(zt.on(Kt,Xt),$t):zt.on(Kt)}}}function forceManyBody(){var xt,$t,Ct,kt,Mt=constant$4(-30),Ft,jt=1,Bt=1/0,Vt=.81;function zt(Wt){var Yt,Kt=xt.length,Xt=quadtree(xt,x$4,y$4).visitAfter(Gt);for(kt=Wt,Yt=0;Yt<Kt;++Yt)$t=xt[Yt],Xt.visit(qt)}function Ht(){if(xt){var Wt,Yt=xt.length,Kt;for(Ft=new Array(Yt),Wt=0;Wt<Yt;++Wt)Kt=xt[Wt],Ft[Kt.index]=+Mt(Kt,Wt,xt)}}function Gt(Wt){var Yt=0,Kt,Xt,Qt=0,Jt,Zt,sn;if(Wt.length){for(Jt=Zt=sn=0;sn<4;++sn)(Kt=Wt[sn])&&(Xt=Math.abs(Kt.value))&&(Yt+=Kt.value,Qt+=Xt,Jt+=Xt*Kt.x,Zt+=Xt*Kt.y);Wt.x=Jt/Qt,Wt.y=Zt/Qt}else{Kt=Wt,Kt.x=Kt.data.x,Kt.y=Kt.data.y;do Yt+=Ft[Kt.data.index];while(Kt=Kt.next)}Wt.value=Yt}function qt(Wt,Yt,Kt,Xt){if(!Wt.value)return!0;var Qt=Wt.x-$t.x,Jt=Wt.y-$t.y,Zt=Xt-Yt,sn=Qt*Qt+Jt*Jt;if(Zt*Zt/Vt<sn)return sn<Bt&&(Qt===0&&(Qt=jiggle(Ct),sn+=Qt*Qt),Jt===0&&(Jt=jiggle(Ct),sn+=Jt*Jt),sn<jt&&(sn=Math.sqrt(jt*sn)),$t.vx+=Qt*Wt.value*kt/sn,$t.vy+=Jt*Wt.value*kt/sn),!0;if(Wt.length||sn>=Bt)return;(Wt.data!==$t||Wt.next)&&(Qt===0&&(Qt=jiggle(Ct),sn+=Qt*Qt),Jt===0&&(Jt=jiggle(Ct),sn+=Jt*Jt),sn<jt&&(sn=Math.sqrt(jt*sn)));do Wt.data!==$t&&(Zt=Ft[Wt.data.index]*kt/sn,$t.vx+=Qt*Zt,$t.vy+=Jt*Zt);while(Wt=Wt.next)}return zt.initialize=function(Wt,Yt){xt=Wt,Ct=Yt,Ht()},zt.strength=function(Wt){return arguments.length?(Mt=typeof Wt=="function"?Wt:constant$4(+Wt),Ht(),zt):Mt},zt.distanceMin=function(Wt){return arguments.length?(jt=Wt*Wt,zt):Math.sqrt(jt)},zt.distanceMax=function(Wt){return arguments.length?(Bt=Wt*Wt,zt):Math.sqrt(Bt)},zt.theta=function(Wt){return arguments.length?(Vt=Wt*Wt,zt):Math.sqrt(Vt)},zt}function forceX(xt){var $t=constant$4(.1),Ct,kt,Mt;typeof xt!="function"&&(xt=constant$4(xt==null?0:+xt));function Ft(Bt){for(var Vt=0,zt=Ct.length,Ht;Vt<zt;++Vt)Ht=Ct[Vt],Ht.vx+=(Mt[Vt]-Ht.x)*kt[Vt]*Bt}function jt(){if(Ct){var Bt,Vt=Ct.length;for(kt=new Array(Vt),Mt=new Array(Vt),Bt=0;Bt<Vt;++Bt)kt[Bt]=isNaN(Mt[Bt]=+xt(Ct[Bt],Bt,Ct))?0:+$t(Ct[Bt],Bt,Ct)}}return Ft.initialize=function(Bt){Ct=Bt,jt()},Ft.strength=function(Bt){return arguments.length?($t=typeof Bt=="function"?Bt:constant$4(+Bt),jt(),Ft):$t},Ft.x=function(Bt){return arguments.length?(xt=typeof Bt=="function"?Bt:constant$4(+Bt),jt(),Ft):xt},Ft}function forceY(xt){var $t=constant$4(.1),Ct,kt,Mt;typeof xt!="function"&&(xt=constant$4(xt==null?0:+xt));function Ft(Bt){for(var Vt=0,zt=Ct.length,Ht;Vt<zt;++Vt)Ht=Ct[Vt],Ht.vy+=(Mt[Vt]-Ht.y)*kt[Vt]*Bt}function jt(){if(Ct){var Bt,Vt=Ct.length;for(kt=new Array(Vt),Mt=new Array(Vt),Bt=0;Bt<Vt;++Bt)kt[Bt]=isNaN(Mt[Bt]=+xt(Ct[Bt],Bt,Ct))?0:+$t(Ct[Bt],Bt,Ct)}}return Ft.initialize=function(Bt){Ct=Bt,jt()},Ft.strength=function(Bt){return arguments.length?($t=typeof Bt=="function"?Bt:constant$4(+Bt),jt(),Ft):$t},Ft.y=function(Bt){return arguments.length?(xt=typeof Bt=="function"?Bt:constant$4(+Bt),jt(),Ft):xt},Ft}function formatDecimal(xt){return Math.abs(xt=Math.round(xt))>=1e21?xt.toLocaleString("en").replace(/,/g,""):xt.toString(10)}function formatDecimalParts(xt,$t){if((Ct=(xt=$t?xt.toExponential($t-1):xt.toExponential()).indexOf("e"))<0)return null;var Ct,kt=xt.slice(0,Ct);return[kt.length>1?kt[0]+kt.slice(2):kt,+xt.slice(Ct+1)]}function exponent(xt){return xt=formatDecimalParts(Math.abs(xt)),xt?xt[1]:NaN}function formatGroup(xt,$t){return function(Ct,kt){for(var Mt=Ct.length,Ft=[],jt=0,Bt=xt[0],Vt=0;Mt>0&&Bt>0&&(Vt+Bt+1>kt&&(Bt=Math.max(1,kt-Vt)),Ft.push(Ct.substring(Mt-=Bt,Mt+Bt)),!((Vt+=Bt+1)>kt));)Bt=xt[jt=(jt+1)%xt.length];return Ft.reverse().join($t)}}function formatNumerals(xt){return function($t){return $t.replace(/[0-9]/g,function(Ct){return xt[+Ct]})}}var re$4=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(xt){if(!($t=re$4.exec(xt)))throw new Error("invalid format: "+xt);var $t;return new FormatSpecifier({fill:$t[1],align:$t[2],sign:$t[3],symbol:$t[4],zero:$t[5],width:$t[6],comma:$t[7],precision:$t[8]&&$t[8].slice(1),trim:$t[9],type:$t[10]})}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(xt){this.fill=xt.fill===void 0?" ":xt.fill+"",this.align=xt.align===void 0?">":xt.align+"",this.sign=xt.sign===void 0?"-":xt.sign+"",this.symbol=xt.symbol===void 0?"":xt.symbol+"",this.zero=!!xt.zero,this.width=xt.width===void 0?void 0:+xt.width,this.comma=!!xt.comma,this.precision=xt.precision===void 0?void 0:+xt.precision,this.trim=!!xt.trim,this.type=xt.type===void 0?"":xt.type+""}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function formatTrim(xt){e:for(var $t=xt.length,Ct=1,kt=-1,Mt;Ct<$t;++Ct)switch(xt[Ct]){case".":kt=Mt=Ct;break;case"0":kt===0&&(kt=Ct),Mt=Ct;break;default:if(!+xt[Ct])break e;kt>0&&(kt=0);break}return kt>0?xt.slice(0,kt)+xt.slice(Mt+1):xt}var prefixExponent;function formatPrefixAuto(xt,$t){var Ct=formatDecimalParts(xt,$t);if(!Ct)return xt+"";var kt=Ct[0],Mt=Ct[1],Ft=Mt-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(Mt/3)))*3)+1,jt=kt.length;return Ft===jt?kt:Ft>jt?kt+new Array(Ft-jt+1).join("0"):Ft>0?kt.slice(0,Ft)+"."+kt.slice(Ft):"0."+new Array(1-Ft).join("0")+formatDecimalParts(xt,Math.max(0,$t+Ft-1))[0]}function formatRounded(xt,$t){var Ct=formatDecimalParts(xt,$t);if(!Ct)return xt+"";var kt=Ct[0],Mt=Ct[1];return Mt<0?"0."+new Array(-Mt).join("0")+kt:kt.length>Mt+1?kt.slice(0,Mt+1)+"."+kt.slice(Mt+1):kt+new Array(Mt-kt.length+2).join("0")}const formatTypes={"%":(xt,$t)=>(xt*100).toFixed($t),b:xt=>Math.round(xt).toString(2),c:xt=>xt+"",d:formatDecimal,e:(xt,$t)=>xt.toExponential($t),f:(xt,$t)=>xt.toFixed($t),g:(xt,$t)=>xt.toPrecision($t),o:xt=>Math.round(xt).toString(8),p:(xt,$t)=>formatRounded(xt*100,$t),r:formatRounded,s:formatPrefixAuto,X:xt=>Math.round(xt).toString(16).toUpperCase(),x:xt=>Math.round(xt).toString(16)};function identity$6(xt){return xt}var map$2=Array.prototype.map,prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function formatLocale$1(xt){var $t=xt.grouping===void 0||xt.thousands===void 0?identity$6:formatGroup(map$2.call(xt.grouping,Number),xt.thousands+""),Ct=xt.currency===void 0?"":xt.currency[0]+"",kt=xt.currency===void 0?"":xt.currency[1]+"",Mt=xt.decimal===void 0?".":xt.decimal+"",Ft=xt.numerals===void 0?identity$6:formatNumerals(map$2.call(xt.numerals,String)),jt=xt.percent===void 0?"%":xt.percent+"",Bt=xt.minus===void 0?"":xt.minus+"",Vt=xt.nan===void 0?"NaN":xt.nan+"";function zt(Gt){Gt=formatSpecifier(Gt);var qt=Gt.fill,Wt=Gt.align,Yt=Gt.sign,Kt=Gt.symbol,Xt=Gt.zero,Qt=Gt.width,Jt=Gt.comma,Zt=Gt.precision,sn=Gt.trim,ln=Gt.type;ln==="n"?(Jt=!0,ln="g"):formatTypes[ln]||(Zt===void 0&&(Zt=12),sn=!0,ln="g"),(Xt||qt==="0"&&Wt==="=")&&(Xt=!0,qt="0",Wt="=");var dn=Kt==="$"?Ct:Kt==="#"&&/[boxX]/.test(ln)?"0"+ln.toLowerCase():"",hn=Kt==="$"?kt:/[%p]/.test(ln)?jt:"",cn=formatTypes[ln],pn=/[defgprs%]/.test(ln);Zt=Zt===void 0?6:/[gprs]/.test(ln)?Math.max(1,Math.min(21,Zt)):Math.max(0,Math.min(20,Zt));function yn(gn){var En=dn,bn=hn,xn,Cn,$n;if(ln==="c")bn=cn(gn)+bn,gn="";else{gn=+gn;var wn=gn<0||1/gn<0;if(gn=isNaN(gn)?Vt:cn(Math.abs(gn),Zt),sn&&(gn=formatTrim(gn)),wn&&+gn==0&&Yt!=="+"&&(wn=!1),En=(wn?Yt==="("?Yt:Bt:Yt==="-"||Yt==="("?"":Yt)+En,bn=(ln==="s"?prefixes[8+prefixExponent/3]:"")+bn+(wn&&Yt==="("?")":""),pn){for(xn=-1,Cn=gn.length;++xn<Cn;)if($n=gn.charCodeAt(xn),48>$n||$n>57){bn=($n===46?Mt+gn.slice(xn+1):gn.slice(xn))+bn,gn=gn.slice(0,xn);break}}}Jt&&!Xt&&(gn=$t(gn,1/0));var Rn=En.length+gn.length+bn.length,Dn=Rn<Qt?new Array(Qt-Rn+1).join(qt):"";switch(Jt&&Xt&&(gn=$t(Dn+gn,Dn.length?Qt-bn.length:1/0),Dn=""),Wt){case"<":gn=En+gn+bn+Dn;break;case"=":gn=En+Dn+gn+bn;break;case"^":gn=Dn.slice(0,Rn=Dn.length>>1)+En+gn+bn+Dn.slice(Rn);break;default:gn=Dn+En+gn+bn;break}return Ft(gn)}return yn.toString=function(){return Gt+""},yn}function Ht(Gt,qt){var Wt=zt((Gt=formatSpecifier(Gt),Gt.type="f",Gt)),Yt=Math.max(-8,Math.min(8,Math.floor(exponent(qt)/3)))*3,Kt=Math.pow(10,-Yt),Xt=prefixes[8+Yt/3];return function(Qt){return Wt(Kt*Qt)+Xt}}return{format:zt,formatPrefix:Ht}}var locale$2,format$6,formatPrefix;defaultLocale$2({thousands:",",grouping:[3],currency:["$",""]});function defaultLocale$2(xt){return locale$2=formatLocale$1(xt),format$6=locale$2.format,formatPrefix=locale$2.formatPrefix,locale$2}function precisionFixed(xt){return Math.max(0,-exponent(Math.abs(xt)))}function precisionPrefix(xt,$t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(exponent($t)/3)))*3-exponent(Math.abs(xt)))}function precisionRound(xt,$t){return xt=Math.abs(xt),$t=Math.abs($t)-xt,Math.max(0,exponent($t)-exponent(xt))+1}var epsilon$3=1e-6,epsilon2=1e-12,pi$2=Math.PI,halfPi$2=pi$2/2,quarterPi=pi$2/4,tau$1=pi$2*2,degrees=180/pi$2,radians=pi$2/180,abs$2=Math.abs,atan=Math.atan,atan2$1=Math.atan2,cos$2=Math.cos,ceil=Math.ceil,exp$2=Math.exp,hypot=Math.hypot,log$4=Math.log,pow$3=Math.pow,sin$2=Math.sin,sign$1=Math.sign||function(xt){return xt>0?1:xt<0?-1:0},sqrt$3=Math.sqrt,tan=Math.tan;function acos$1(xt){return xt>1?0:xt<-1?pi$2:Math.acos(xt)}function asin$2(xt){return xt>1?halfPi$2:xt<-1?-halfPi$2:Math.asin(xt)}function noop$6(){}function streamGeometry(xt,$t){xt&&streamGeometryType.hasOwnProperty(xt.type)&&streamGeometryType[xt.type](xt,$t)}var streamObjectType={Feature:function(xt,$t){streamGeometry(xt.geometry,$t)},FeatureCollection:function(xt,$t){for(var Ct=xt.features,kt=-1,Mt=Ct.length;++kt<Mt;)streamGeometry(Ct[kt].geometry,$t)}},streamGeometryType={Sphere:function(xt,$t){$t.sphere()},Point:function(xt,$t){xt=xt.coordinates,$t.point(xt[0],xt[1],xt[2])},MultiPoint:function(xt,$t){for(var Ct=xt.coordinates,kt=-1,Mt=Ct.length;++kt<Mt;)xt=Ct[kt],$t.point(xt[0],xt[1],xt[2])},LineString:function(xt,$t){streamLine(xt.coordinates,$t,0)},MultiLineString:function(xt,$t){for(var Ct=xt.coordinates,kt=-1,Mt=Ct.length;++kt<Mt;)streamLine(Ct[kt],$t,0)},Polygon:function(xt,$t){streamPolygon(xt.coordinates,$t)},MultiPolygon:function(xt,$t){for(var Ct=xt.coordinates,kt=-1,Mt=Ct.length;++kt<Mt;)streamPolygon(Ct[kt],$t)},GeometryCollection:function(xt,$t){for(var Ct=xt.geometries,kt=-1,Mt=Ct.length;++kt<Mt;)streamGeometry(Ct[kt],$t)}};function streamLine(xt,$t,Ct){var kt=-1,Mt=xt.length-Ct,Ft;for($t.lineStart();++kt<Mt;)Ft=xt[kt],$t.point(Ft[0],Ft[1],Ft[2]);$t.lineEnd()}function streamPolygon(xt,$t){var Ct=-1,kt=xt.length;for($t.polygonStart();++Ct<kt;)streamLine(xt[Ct],$t,1);$t.polygonEnd()}function geoStream(xt,$t){xt&&streamObjectType.hasOwnProperty(xt.type)?streamObjectType[xt.type](xt,$t):streamGeometry(xt,$t)}var areaRingSum$1=new Adder,areaSum$1=new Adder,lambda00$2,phi00$2,lambda0$1,cosPhi0,sinPhi0,areaStream$1={point:noop$6,lineStart:noop$6,lineEnd:noop$6,polygonStart:function(){areaRingSum$1=new Adder,areaStream$1.lineStart=areaRingStart$1,areaStream$1.lineEnd=areaRingEnd$1},polygonEnd:function(){var xt=+areaRingSum$1;areaSum$1.add(xt<0?tau$1+xt:xt),this.lineStart=this.lineEnd=this.point=noop$6},sphere:function(){areaSum$1.add(tau$1)}};function areaRingStart$1(){areaStream$1.point=areaPointFirst$1}function areaRingEnd$1(){areaPoint$1(lambda00$2,phi00$2)}function areaPointFirst$1(xt,$t){areaStream$1.point=areaPoint$1,lambda00$2=xt,phi00$2=$t,xt*=radians,$t*=radians,lambda0$1=xt,cosPhi0=cos$2($t=$t/2+quarterPi),sinPhi0=sin$2($t)}function areaPoint$1(xt,$t){xt*=radians,$t*=radians,$t=$t/2+quarterPi;var Ct=xt-lambda0$1,kt=Ct>=0?1:-1,Mt=kt*Ct,Ft=cos$2($t),jt=sin$2($t),Bt=sinPhi0*jt,Vt=cosPhi0*Ft+Bt*cos$2(Mt),zt=Bt*kt*sin$2(Mt);areaRingSum$1.add(atan2$1(zt,Vt)),lambda0$1=xt,cosPhi0=Ft,sinPhi0=jt}function geoArea$1(xt){return areaSum$1=new Adder,geoStream(xt,areaStream$1),areaSum$1*2}function spherical(xt){return[atan2$1(xt[1],xt[0]),asin$2(xt[2])]}function cartesian(xt){var $t=xt[0],Ct=xt[1],kt=cos$2(Ct);return[kt*cos$2($t),kt*sin$2($t),sin$2(Ct)]}function cartesianDot(xt,$t){return xt[0]*$t[0]+xt[1]*$t[1]+xt[2]*$t[2]}function cartesianCross(xt,$t){return[xt[1]*$t[2]-xt[2]*$t[1],xt[2]*$t[0]-xt[0]*$t[2],xt[0]*$t[1]-xt[1]*$t[0]]}function cartesianAddInPlace(xt,$t){xt[0]+=$t[0],xt[1]+=$t[1],xt[2]+=$t[2]}function cartesianScale(xt,$t){return[xt[0]*$t,xt[1]*$t,xt[2]*$t]}function cartesianNormalizeInPlace(xt){var $t=sqrt$3(xt[0]*xt[0]+xt[1]*xt[1]+xt[2]*xt[2]);xt[0]/=$t,xt[1]/=$t,xt[2]/=$t}var lambda0,phi0,lambda1,phi1,lambda2,lambda00$1,phi00$1,p0,deltaSum,ranges,range$5,boundsStream$1={point:boundsPoint$1,lineStart:boundsLineStart,lineEnd:boundsLineEnd,polygonStart:function(){boundsStream$1.point=boundsRingPoint,boundsStream$1.lineStart=boundsRingStart,boundsStream$1.lineEnd=boundsRingEnd,deltaSum=new Adder,areaStream$1.polygonStart()},polygonEnd:function(){areaStream$1.polygonEnd(),boundsStream$1.point=boundsPoint$1,boundsStream$1.lineStart=boundsLineStart,boundsStream$1.lineEnd=boundsLineEnd,areaRingSum$1<0?(lambda0=-(lambda1=180),phi0=-(phi1=90)):deltaSum>epsilon$3?phi1=90:deltaSum<-epsilon$3&&(phi0=-90),range$5[0]=lambda0,range$5[1]=lambda1},sphere:function(){lambda0=-(lambda1=180),phi0=-(phi1=90)}};function boundsPoint$1(xt,$t){ranges.push(range$5=[lambda0=xt,lambda1=xt]),$t<phi0&&(phi0=$t),$t>phi1&&(phi1=$t)}function linePoint(xt,$t){var Ct=cartesian([xt*radians,$t*radians]);if(p0){var kt=cartesianCross(p0,Ct),Mt=[kt[1],-kt[0],0],Ft=cartesianCross(Mt,kt);cartesianNormalizeInPlace(Ft),Ft=spherical(Ft);var jt=xt-lambda2,Bt=jt>0?1:-1,Vt=Ft[0]*degrees*Bt,zt,Ht=abs$2(jt)>180;Ht^(Bt*lambda2<Vt&&Vt<Bt*xt)?(zt=Ft[1]*degrees,zt>phi1&&(phi1=zt)):(Vt=(Vt+360)%360-180,Ht^(Bt*lambda2<Vt&&Vt<Bt*xt)?(zt=-Ft[1]*degrees,zt<phi0&&(phi0=zt)):($t<phi0&&(phi0=$t),$t>phi1&&(phi1=$t))),Ht?xt<lambda2?angle(lambda0,xt)>angle(lambda0,lambda1)&&(lambda1=xt):angle(xt,lambda1)>angle(lambda0,lambda1)&&(lambda0=xt):lambda1>=lambda0?(xt<lambda0&&(lambda0=xt),xt>lambda1&&(lambda1=xt)):xt>lambda2?angle(lambda0,xt)>angle(lambda0,lambda1)&&(lambda1=xt):angle(xt,lambda1)>angle(lambda0,lambda1)&&(lambda0=xt)}else ranges.push(range$5=[lambda0=xt,lambda1=xt]);$t<phi0&&(phi0=$t),$t>phi1&&(phi1=$t),p0=Ct,lambda2=xt}function boundsLineStart(){boundsStream$1.point=linePoint}function boundsLineEnd(){range$5[0]=lambda0,range$5[1]=lambda1,boundsStream$1.point=boundsPoint$1,p0=null}function boundsRingPoint(xt,$t){if(p0){var Ct=xt-lambda2;deltaSum.add(abs$2(Ct)>180?Ct+(Ct>0?360:-360):Ct)}else lambda00$1=xt,phi00$1=$t;areaStream$1.point(xt,$t),linePoint(xt,$t)}function boundsRingStart(){areaStream$1.lineStart()}function boundsRingEnd(){boundsRingPoint(lambda00$1,phi00$1),areaStream$1.lineEnd(),abs$2(deltaSum)>epsilon$3&&(lambda0=-(lambda1=180)),range$5[0]=lambda0,range$5[1]=lambda1,p0=null}function angle(xt,$t){return($t-=xt)<0?$t+360:$t}function rangeCompare(xt,$t){return xt[0]-$t[0]}function rangeContains(xt,$t){return xt[0]<=xt[1]?xt[0]<=$t&&$t<=xt[1]:$t<xt[0]||xt[1]<$t}function geoBounds$1(xt){var $t,Ct,kt,Mt,Ft,jt,Bt;if(phi1=lambda1=-(lambda0=phi0=1/0),ranges=[],geoStream(xt,boundsStream$1),Ct=ranges.length){for(ranges.sort(rangeCompare),$t=1,kt=ranges[0],Ft=[kt];$t<Ct;++$t)Mt=ranges[$t],rangeContains(kt,Mt[0])||rangeContains(kt,Mt[1])?(angle(kt[0],Mt[1])>angle(kt[0],kt[1])&&(kt[1]=Mt[1]),angle(Mt[0],kt[1])>angle(kt[0],kt[1])&&(kt[0]=Mt[0])):Ft.push(kt=Mt);for(jt=-1/0,Ct=Ft.length-1,$t=0,kt=Ft[Ct];$t<=Ct;kt=Mt,++$t)Mt=Ft[$t],(Bt=angle(kt[1],Mt[0]))>jt&&(jt=Bt,lambda0=Mt[0],lambda1=kt[1])}return ranges=range$5=null,lambda0===1/0||phi0===1/0?[[NaN,NaN],[NaN,NaN]]:[[lambda0,phi0],[lambda1,phi1]]}var W0,W1,X0$1,Y0$1,Z0$1,X1$1,Y1$1,Z1$1,X2$2,Y2$2,Z2$1,lambda00,phi00,x0$4,y0$4,z0,centroidStream$1={sphere:noop$6,point:centroidPoint$1,lineStart:centroidLineStart$1,lineEnd:centroidLineEnd$1,polygonStart:function(){centroidStream$1.lineStart=centroidRingStart$1,centroidStream$1.lineEnd=centroidRingEnd$1},polygonEnd:function(){centroidStream$1.lineStart=centroidLineStart$1,centroidStream$1.lineEnd=centroidLineEnd$1}};function centroidPoint$1(xt,$t){xt*=radians,$t*=radians;var Ct=cos$2($t);centroidPointCartesian(Ct*cos$2(xt),Ct*sin$2(xt),sin$2($t))}function centroidPointCartesian(xt,$t,Ct){++W0,X0$1+=(xt-X0$1)/W0,Y0$1+=($t-Y0$1)/W0,Z0$1+=(Ct-Z0$1)/W0}function centroidLineStart$1(){centroidStream$1.point=centroidLinePointFirst}function centroidLinePointFirst(xt,$t){xt*=radians,$t*=radians;var Ct=cos$2($t);x0$4=Ct*cos$2(xt),y0$4=Ct*sin$2(xt),z0=sin$2($t),centroidStream$1.point=centroidLinePoint,centroidPointCartesian(x0$4,y0$4,z0)}function centroidLinePoint(xt,$t){xt*=radians,$t*=radians;var Ct=cos$2($t),kt=Ct*cos$2(xt),Mt=Ct*sin$2(xt),Ft=sin$2($t),jt=atan2$1(sqrt$3((jt=y0$4*Ft-z0*Mt)*jt+(jt=z0*kt-x0$4*Ft)*jt+(jt=x0$4*Mt-y0$4*kt)*jt),x0$4*kt+y0$4*Mt+z0*Ft);W1+=jt,X1$1+=jt*(x0$4+(x0$4=kt)),Y1$1+=jt*(y0$4+(y0$4=Mt)),Z1$1+=jt*(z0+(z0=Ft)),centroidPointCartesian(x0$4,y0$4,z0)}function centroidLineEnd$1(){centroidStream$1.point=centroidPoint$1}function centroidRingStart$1(){centroidStream$1.point=centroidRingPointFirst}function centroidRingEnd$1(){centroidRingPoint(lambda00,phi00),centroidStream$1.point=centroidPoint$1}function centroidRingPointFirst(xt,$t){lambda00=xt,phi00=$t,xt*=radians,$t*=radians,centroidStream$1.point=centroidRingPoint;var Ct=cos$2($t);x0$4=Ct*cos$2(xt),y0$4=Ct*sin$2(xt),z0=sin$2($t),centroidPointCartesian(x0$4,y0$4,z0)}function centroidRingPoint(xt,$t){xt*=radians,$t*=radians;var Ct=cos$2($t),kt=Ct*cos$2(xt),Mt=Ct*sin$2(xt),Ft=sin$2($t),jt=y0$4*Ft-z0*Mt,Bt=z0*kt-x0$4*Ft,Vt=x0$4*Mt-y0$4*kt,zt=hypot(jt,Bt,Vt),Ht=asin$2(zt),Gt=zt&&-Ht/zt;X2$2.add(Gt*jt),Y2$2.add(Gt*Bt),Z2$1.add(Gt*Vt),W1+=Ht,X1$1+=Ht*(x0$4+(x0$4=kt)),Y1$1+=Ht*(y0$4+(y0$4=Mt)),Z1$1+=Ht*(z0+(z0=Ft)),centroidPointCartesian(x0$4,y0$4,z0)}function geoCentroid$1(xt){W0=W1=X0$1=Y0$1=Z0$1=X1$1=Y1$1=Z1$1=0,X2$2=new Adder,Y2$2=new Adder,Z2$1=new Adder,geoStream(xt,centroidStream$1);var $t=+X2$2,Ct=+Y2$2,kt=+Z2$1,Mt=hypot($t,Ct,kt);return Mt<epsilon2&&($t=X1$1,Ct=Y1$1,kt=Z1$1,W1<epsilon$3&&($t=X0$1,Ct=Y0$1,kt=Z0$1),Mt=hypot($t,Ct,kt),Mt<epsilon2)?[NaN,NaN]:[atan2$1(Ct,$t)*degrees,asin$2(kt/Mt)*degrees]}function compose$1(xt,$t){function Ct(kt,Mt){return kt=xt(kt,Mt),$t(kt[0],kt[1])}return xt.invert&&$t.invert&&(Ct.invert=function(kt,Mt){return kt=$t.invert(kt,Mt),kt&&xt.invert(kt[0],kt[1])}),Ct}function rotationIdentity(xt,$t){return abs$2(xt)>pi$2&&(xt-=Math.round(xt/tau$1)*tau$1),[xt,$t]}rotationIdentity.invert=rotationIdentity;function rotateRadians(xt,$t,Ct){return(xt%=tau$1)?$t||Ct?compose$1(rotationLambda(xt),rotationPhiGamma($t,Ct)):rotationLambda(xt):$t||Ct?rotationPhiGamma($t,Ct):rotationIdentity}function forwardRotationLambda(xt){return function($t,Ct){return $t+=xt,abs$2($t)>pi$2&&($t-=Math.round($t/tau$1)*tau$1),[$t,Ct]}}function rotationLambda(xt){var $t=forwardRotationLambda(xt);return $t.invert=forwardRotationLambda(-xt),$t}function rotationPhiGamma(xt,$t){var Ct=cos$2(xt),kt=sin$2(xt),Mt=cos$2($t),Ft=sin$2($t);function jt(Bt,Vt){var zt=cos$2(Vt),Ht=cos$2(Bt)*zt,Gt=sin$2(Bt)*zt,qt=sin$2(Vt),Wt=qt*Ct+Ht*kt;return[atan2$1(Gt*Mt-Wt*Ft,Ht*Ct-qt*kt),asin$2(Wt*Mt+Gt*Ft)]}return jt.invert=function(Bt,Vt){var zt=cos$2(Vt),Ht=cos$2(Bt)*zt,Gt=sin$2(Bt)*zt,qt=sin$2(Vt),Wt=qt*Mt-Gt*Ft;return[atan2$1(Gt*Mt+qt*Ft,Ht*Ct+Wt*kt),asin$2(Wt*Ct-Ht*kt)]},jt}function rotation(xt){xt=rotateRadians(xt[0]*radians,xt[1]*radians,xt.length>2?xt[2]*radians:0);function $t(Ct){return Ct=xt(Ct[0]*radians,Ct[1]*radians),Ct[0]*=degrees,Ct[1]*=degrees,Ct}return $t.invert=function(Ct){return Ct=xt.invert(Ct[0]*radians,Ct[1]*radians),Ct[0]*=degrees,Ct[1]*=degrees,Ct},$t}function circleStream(xt,$t,Ct,kt,Mt,Ft){if(Ct){var jt=cos$2($t),Bt=sin$2($t),Vt=kt*Ct;Mt==null?(Mt=$t+kt*tau$1,Ft=$t-Vt/2):(Mt=circleRadius(jt,Mt),Ft=circleRadius(jt,Ft),(kt>0?Mt<Ft:Mt>Ft)&&(Mt+=kt*tau$1));for(var zt,Ht=Mt;kt>0?Ht>Ft:Ht<Ft;Ht-=Vt)zt=spherical([jt,-Bt*cos$2(Ht),-Bt*sin$2(Ht)]),xt.point(zt[0],zt[1])}}function circleRadius(xt,$t){$t=cartesian($t),$t[0]-=xt,cartesianNormalizeInPlace($t);var Ct=acos$1(-$t[1]);return((-$t[2]<0?-Ct:Ct)+tau$1-epsilon$3)%tau$1}function clipBuffer(){var xt=[],$t;return{point:function(Ct,kt,Mt){$t.push([Ct,kt,Mt])},lineStart:function(){xt.push($t=[])},lineEnd:noop$6,rejoin:function(){xt.length>1&&xt.push(xt.pop().concat(xt.shift()))},result:function(){var Ct=xt;return xt=[],$t=null,Ct}}}function pointEqual(xt,$t){return abs$2(xt[0]-$t[0])<epsilon$3&&abs$2(xt[1]-$t[1])<epsilon$3}function Intersection(xt,$t,Ct,kt){this.x=xt,this.z=$t,this.o=Ct,this.e=kt,this.v=!1,this.n=this.p=null}function clipRejoin(xt,$t,Ct,kt,Mt){var Ft=[],jt=[],Bt,Vt;if(xt.forEach(function(Yt){if(!((Kt=Yt.length-1)<=0)){var Kt,Xt=Yt[0],Qt=Yt[Kt],Jt;if(pointEqual(Xt,Qt)){if(!Xt[2]&&!Qt[2]){for(Mt.lineStart(),Bt=0;Bt<Kt;++Bt)Mt.point((Xt=Yt[Bt])[0],Xt[1]);Mt.lineEnd();return}Qt[0]+=2*epsilon$3}Ft.push(Jt=new Intersection(Xt,Yt,null,!0)),jt.push(Jt.o=new Intersection(Xt,null,Jt,!1)),Ft.push(Jt=new Intersection(Qt,Yt,null,!1)),jt.push(Jt.o=new Intersection(Qt,null,Jt,!0))}}),!!Ft.length){for(jt.sort($t),link(Ft),link(jt),Bt=0,Vt=jt.length;Bt<Vt;++Bt)jt[Bt].e=Ct=!Ct;for(var zt=Ft[0],Ht,Gt;;){for(var qt=zt,Wt=!0;qt.v;)if((qt=qt.n)===zt)return;Ht=qt.z,Mt.lineStart();do{if(qt.v=qt.o.v=!0,qt.e){if(Wt)for(Bt=0,Vt=Ht.length;Bt<Vt;++Bt)Mt.point((Gt=Ht[Bt])[0],Gt[1]);else kt(qt.x,qt.n.x,1,Mt);qt=qt.n}else{if(Wt)for(Ht=qt.p.z,Bt=Ht.length-1;Bt>=0;--Bt)Mt.point((Gt=Ht[Bt])[0],Gt[1]);else kt(qt.x,qt.p.x,-1,Mt);qt=qt.p}qt=qt.o,Ht=qt.z,Wt=!Wt}while(!qt.v);Mt.lineEnd()}}}function link(xt){if($t=xt.length){for(var $t,Ct=0,kt=xt[0],Mt;++Ct<$t;)kt.n=Mt=xt[Ct],Mt.p=kt,kt=Mt;kt.n=Mt=xt[0],Mt.p=kt}}function longitude(xt){return abs$2(xt[0])<=pi$2?xt[0]:sign$1(xt[0])*((abs$2(xt[0])+pi$2)%tau$1-pi$2)}function polygonContains(xt,$t){var Ct=longitude($t),kt=$t[1],Mt=sin$2(kt),Ft=[sin$2(Ct),-cos$2(Ct),0],jt=0,Bt=0,Vt=new Adder;Mt===1?kt=halfPi$2+epsilon$3:Mt===-1&&(kt=-halfPi$2-epsilon$3);for(var zt=0,Ht=xt.length;zt<Ht;++zt)if(qt=(Gt=xt[zt]).length)for(var Gt,qt,Wt=Gt[qt-1],Yt=longitude(Wt),Kt=Wt[1]/2+quarterPi,Xt=sin$2(Kt),Qt=cos$2(Kt),Jt=0;Jt<qt;++Jt,Yt=sn,Xt=dn,Qt=hn,Wt=Zt){var Zt=Gt[Jt],sn=longitude(Zt),ln=Zt[1]/2+quarterPi,dn=sin$2(ln),hn=cos$2(ln),cn=sn-Yt,pn=cn>=0?1:-1,yn=pn*cn,gn=yn>pi$2,En=Xt*dn;if(Vt.add(atan2$1(En*pn*sin$2(yn),Qt*hn+En*cos$2(yn))),jt+=gn?cn+pn*tau$1:cn,gn^Yt>=Ct^sn>=Ct){var bn=cartesianCross(cartesian(Wt),cartesian(Zt));cartesianNormalizeInPlace(bn);var xn=cartesianCross(Ft,bn);cartesianNormalizeInPlace(xn);var Cn=(gn^cn>=0?-1:1)*asin$2(xn[2]);(kt>Cn||kt===Cn&&(bn[0]||bn[1]))&&(Bt+=gn^cn>=0?1:-1)}}return(jt<-epsilon$3||jt<epsilon$3&&Vt<-epsilon2)^Bt&1}function clip$3(xt,$t,Ct,kt){return function(Mt){var Ft=$t(Mt),jt=clipBuffer(),Bt=$t(jt),Vt=!1,zt,Ht,Gt,qt={point:Wt,lineStart:Kt,lineEnd:Xt,polygonStart:function(){qt.point=Qt,qt.lineStart=Jt,qt.lineEnd=Zt,Ht=[],zt=[]},polygonEnd:function(){qt.point=Wt,qt.lineStart=Kt,qt.lineEnd=Xt,Ht=merge$4(Ht);var sn=polygonContains(zt,kt);Ht.length?(Vt||(Mt.polygonStart(),Vt=!0),clipRejoin(Ht,compareIntersection,sn,Ct,Mt)):sn&&(Vt||(Mt.polygonStart(),Vt=!0),Mt.lineStart(),Ct(null,null,1,Mt),Mt.lineEnd()),Vt&&(Mt.polygonEnd(),Vt=!1),Ht=zt=null},sphere:function(){Mt.polygonStart(),Mt.lineStart(),Ct(null,null,1,Mt),Mt.lineEnd(),Mt.polygonEnd()}};function Wt(sn,ln){xt(sn,ln)&&Mt.point(sn,ln)}function Yt(sn,ln){Ft.point(sn,ln)}function Kt(){qt.point=Yt,Ft.lineStart()}function Xt(){qt.point=Wt,Ft.lineEnd()}function Qt(sn,ln){Gt.push([sn,ln]),Bt.point(sn,ln)}function Jt(){Bt.lineStart(),Gt=[]}function Zt(){Qt(Gt[0][0],Gt[0][1]),Bt.lineEnd();var sn=Bt.clean(),ln=jt.result(),dn,hn=ln.length,cn,pn,yn;if(Gt.pop(),zt.push(Gt),Gt=null,!!hn){if(sn&1){if(pn=ln[0],(cn=pn.length-1)>0){for(Vt||(Mt.polygonStart(),Vt=!0),Mt.lineStart(),dn=0;dn<cn;++dn)Mt.point((yn=pn[dn])[0],yn[1]);Mt.lineEnd()}return}hn>1&&sn&2&&ln.push(ln.pop().concat(ln.shift())),Ht.push(ln.filter(validSegment))}}return qt}}function validSegment(xt){return xt.length>1}function compareIntersection(xt,$t){return((xt=xt.x)[0]<0?xt[1]-halfPi$2-epsilon$3:halfPi$2-xt[1])-(($t=$t.x)[0]<0?$t[1]-halfPi$2-epsilon$3:halfPi$2-$t[1])}const clipAntimeridian=clip$3(function(){return!0},clipAntimeridianLine,clipAntimeridianInterpolate,[-pi$2,-halfPi$2]);function clipAntimeridianLine(xt){var $t=NaN,Ct=NaN,kt=NaN,Mt;return{lineStart:function(){xt.lineStart(),Mt=1},point:function(Ft,jt){var Bt=Ft>0?pi$2:-pi$2,Vt=abs$2(Ft-$t);abs$2(Vt-pi$2)<epsilon$3?(xt.point($t,Ct=(Ct+jt)/2>0?halfPi$2:-halfPi$2),xt.point(kt,Ct),xt.lineEnd(),xt.lineStart(),xt.point(Bt,Ct),xt.point(Ft,Ct),Mt=0):kt!==Bt&&Vt>=pi$2&&(abs$2($t-kt)<epsilon$3&&($t-=kt*epsilon$3),abs$2(Ft-Bt)<epsilon$3&&(Ft-=Bt*epsilon$3),Ct=clipAntimeridianIntersect($t,Ct,Ft,jt),xt.point(kt,Ct),xt.lineEnd(),xt.lineStart(),xt.point(Bt,Ct),Mt=0),xt.point($t=Ft,Ct=jt),kt=Bt},lineEnd:function(){xt.lineEnd(),$t=Ct=NaN},clean:function(){return 2-Mt}}}function clipAntimeridianIntersect(xt,$t,Ct,kt){var Mt,Ft,jt=sin$2(xt-Ct);return abs$2(jt)>epsilon$3?atan((sin$2($t)*(Ft=cos$2(kt))*sin$2(Ct)-sin$2(kt)*(Mt=cos$2($t))*sin$2(xt))/(Mt*Ft*jt)):($t+kt)/2}function clipAntimeridianInterpolate(xt,$t,Ct,kt){var Mt;if(xt==null)Mt=Ct*halfPi$2,kt.point(-pi$2,Mt),kt.point(0,Mt),kt.point(pi$2,Mt),kt.point(pi$2,0),kt.point(pi$2,-Mt),kt.point(0,-Mt),kt.point(-pi$2,-Mt),kt.point(-pi$2,0),kt.point(-pi$2,Mt);else if(abs$2(xt[0]-$t[0])>epsilon$3){var Ft=xt[0]<$t[0]?pi$2:-pi$2;Mt=Ct*Ft/2,kt.point(-Ft,Mt),kt.point(0,Mt),kt.point(Ft,Mt)}else kt.point($t[0],$t[1])}function clipCircle(xt){var $t=cos$2(xt),Ct=2*radians,kt=$t>0,Mt=abs$2($t)>epsilon$3;function Ft(Ht,Gt,qt,Wt){circleStream(Wt,xt,Ct,qt,Ht,Gt)}function jt(Ht,Gt){return cos$2(Ht)*cos$2(Gt)>$t}function Bt(Ht){var Gt,qt,Wt,Yt,Kt;return{lineStart:function(){Yt=Wt=!1,Kt=1},point:function(Xt,Qt){var Jt=[Xt,Qt],Zt,sn=jt(Xt,Qt),ln=kt?sn?0:zt(Xt,Qt):sn?zt(Xt+(Xt<0?pi$2:-pi$2),Qt):0;if(!Gt&&(Yt=Wt=sn)&&Ht.lineStart(),sn!==Wt&&(Zt=Vt(Gt,Jt),(!Zt||pointEqual(Gt,Zt)||pointEqual(Jt,Zt))&&(Jt[2]=1)),sn!==Wt)Kt=0,sn?(Ht.lineStart(),Zt=Vt(Jt,Gt),Ht.point(Zt[0],Zt[1])):(Zt=Vt(Gt,Jt),Ht.point(Zt[0],Zt[1],2),Ht.lineEnd()),Gt=Zt;else if(Mt&&Gt&&kt^sn){var dn;!(ln&qt)&&(dn=Vt(Jt,Gt,!0))&&(Kt=0,kt?(Ht.lineStart(),Ht.point(dn[0][0],dn[0][1]),Ht.point(dn[1][0],dn[1][1]),Ht.lineEnd()):(Ht.point(dn[1][0],dn[1][1]),Ht.lineEnd(),Ht.lineStart(),Ht.point(dn[0][0],dn[0][1],3)))}sn&&(!Gt||!pointEqual(Gt,Jt))&&Ht.point(Jt[0],Jt[1]),Gt=Jt,Wt=sn,qt=ln},lineEnd:function(){Wt&&Ht.lineEnd(),Gt=null},clean:function(){return Kt|(Yt&&Wt)<<1}}}function Vt(Ht,Gt,qt){var Wt=cartesian(Ht),Yt=cartesian(Gt),Kt=[1,0,0],Xt=cartesianCross(Wt,Yt),Qt=cartesianDot(Xt,Xt),Jt=Xt[0],Zt=Qt-Jt*Jt;if(!Zt)return!qt&&Ht;var sn=$t*Qt/Zt,ln=-$t*Jt/Zt,dn=cartesianCross(Kt,Xt),hn=cartesianScale(Kt,sn),cn=cartesianScale(Xt,ln);cartesianAddInPlace(hn,cn);var pn=dn,yn=cartesianDot(hn,pn),gn=cartesianDot(pn,pn),En=yn*yn-gn*(cartesianDot(hn,hn)-1);if(!(En<0)){var bn=sqrt$3(En),xn=cartesianScale(pn,(-yn-bn)/gn);if(cartesianAddInPlace(xn,hn),xn=spherical(xn),!qt)return xn;var Cn=Ht[0],$n=Gt[0],wn=Ht[1],Rn=Gt[1],Dn;$n<Cn&&(Dn=Cn,Cn=$n,$n=Dn);var An=$n-Cn,Sn=abs$2(An-pi$2)<epsilon$3,vn=Sn||An<epsilon$3;if(!Sn&&Rn<wn&&(Dn=wn,wn=Rn,Rn=Dn),vn?Sn?wn+Rn>0^xn[1]<(abs$2(xn[0]-Cn)<epsilon$3?wn:Rn):wn<=xn[1]&&xn[1]<=Rn:An>pi$2^(Cn<=xn[0]&&xn[0]<=$n)){var _n=cartesianScale(pn,(-yn+bn)/gn);return cartesianAddInPlace(_n,hn),[xn,spherical(_n)]}}}function zt(Ht,Gt){var qt=kt?xt:pi$2-xt,Wt=0;return Ht<-qt?Wt|=1:Ht>qt&&(Wt|=2),Gt<-qt?Wt|=4:Gt>qt&&(Wt|=8),Wt}return clip$3(jt,Bt,Ft,kt?[0,-xt]:[-pi$2,xt-pi$2])}function clipLine(xt,$t,Ct,kt,Mt,Ft){var jt=xt[0],Bt=xt[1],Vt=$t[0],zt=$t[1],Ht=0,Gt=1,qt=Vt-jt,Wt=zt-Bt,Yt;if(Yt=Ct-jt,!(!qt&&Yt>0)){if(Yt/=qt,qt<0){if(Yt<Ht)return;Yt<Gt&&(Gt=Yt)}else if(qt>0){if(Yt>Gt)return;Yt>Ht&&(Ht=Yt)}if(Yt=Mt-jt,!(!qt&&Yt<0)){if(Yt/=qt,qt<0){if(Yt>Gt)return;Yt>Ht&&(Ht=Yt)}else if(qt>0){if(Yt<Ht)return;Yt<Gt&&(Gt=Yt)}if(Yt=kt-Bt,!(!Wt&&Yt>0)){if(Yt/=Wt,Wt<0){if(Yt<Ht)return;Yt<Gt&&(Gt=Yt)}else if(Wt>0){if(Yt>Gt)return;Yt>Ht&&(Ht=Yt)}if(Yt=Ft-Bt,!(!Wt&&Yt<0)){if(Yt/=Wt,Wt<0){if(Yt>Gt)return;Yt>Ht&&(Ht=Yt)}else if(Wt>0){if(Yt<Ht)return;Yt<Gt&&(Gt=Yt)}return Ht>0&&(xt[0]=jt+Ht*qt,xt[1]=Bt+Ht*Wt),Gt<1&&($t[0]=jt+Gt*qt,$t[1]=Bt+Gt*Wt),!0}}}}}var clipMax=1e9,clipMin=-clipMax;function clipRectangle(xt,$t,Ct,kt){function Mt(zt,Ht){return xt<=zt&&zt<=Ct&&$t<=Ht&&Ht<=kt}function Ft(zt,Ht,Gt,qt){var Wt=0,Yt=0;if(zt==null||(Wt=jt(zt,Gt))!==(Yt=jt(Ht,Gt))||Vt(zt,Ht)<0^Gt>0)do qt.point(Wt===0||Wt===3?xt:Ct,Wt>1?kt:$t);while((Wt=(Wt+Gt+4)%4)!==Yt);else qt.point(Ht[0],Ht[1])}function jt(zt,Ht){return abs$2(zt[0]-xt)<epsilon$3?Ht>0?0:3:abs$2(zt[0]-Ct)<epsilon$3?Ht>0?2:1:abs$2(zt[1]-$t)<epsilon$3?Ht>0?1:0:Ht>0?3:2}function Bt(zt,Ht){return Vt(zt.x,Ht.x)}function Vt(zt,Ht){var Gt=jt(zt,1),qt=jt(Ht,1);return Gt!==qt?Gt-qt:Gt===0?Ht[1]-zt[1]:Gt===1?zt[0]-Ht[0]:Gt===2?zt[1]-Ht[1]:Ht[0]-zt[0]}return function(zt){var Ht=zt,Gt=clipBuffer(),qt,Wt,Yt,Kt,Xt,Qt,Jt,Zt,sn,ln,dn,hn={point:cn,lineStart:En,lineEnd:bn,polygonStart:yn,polygonEnd:gn};function cn(Cn,$n){Mt(Cn,$n)&&Ht.point(Cn,$n)}function pn(){for(var Cn=0,$n=0,wn=Wt.length;$n<wn;++$n)for(var Rn=Wt[$n],Dn=1,An=Rn.length,Sn=Rn[0],vn,_n,Tn=Sn[0],Pn=Sn[1];Dn<An;++Dn)vn=Tn,_n=Pn,Sn=Rn[Dn],Tn=Sn[0],Pn=Sn[1],_n<=kt?Pn>kt&&(Tn-vn)*(kt-_n)>(Pn-_n)*(xt-vn)&&++Cn:Pn<=kt&&(Tn-vn)*(kt-_n)<(Pn-_n)*(xt-vn)&&--Cn;return Cn}function yn(){Ht=Gt,qt=[],Wt=[],dn=!0}function gn(){var Cn=pn(),$n=dn&&Cn,wn=(qt=merge$4(qt)).length;($n||wn)&&(zt.polygonStart(),$n&&(zt.lineStart(),Ft(null,null,1,zt),zt.lineEnd()),wn&&clipRejoin(qt,Bt,Cn,Ft,zt),zt.polygonEnd()),Ht=zt,qt=Wt=Yt=null}function En(){hn.point=xn,Wt&&Wt.push(Yt=[]),ln=!0,sn=!1,Jt=Zt=NaN}function bn(){qt&&(xn(Kt,Xt),Qt&&sn&&Gt.rejoin(),qt.push(Gt.result())),hn.point=cn,sn&&Ht.lineEnd()}function xn(Cn,$n){var wn=Mt(Cn,$n);if(Wt&&Yt.push([Cn,$n]),ln)Kt=Cn,Xt=$n,Qt=wn,ln=!1,wn&&(Ht.lineStart(),Ht.point(Cn,$n));else if(wn&&sn)Ht.point(Cn,$n);else{var Rn=[Jt=Math.max(clipMin,Math.min(clipMax,Jt)),Zt=Math.max(clipMin,Math.min(clipMax,Zt))],Dn=[Cn=Math.max(clipMin,Math.min(clipMax,Cn)),$n=Math.max(clipMin,Math.min(clipMax,$n))];clipLine(Rn,Dn,xt,$t,Ct,kt)?(sn||(Ht.lineStart(),Ht.point(Rn[0],Rn[1])),Ht.point(Dn[0],Dn[1]),wn||Ht.lineEnd(),dn=!1):wn&&(Ht.lineStart(),Ht.point(Cn,$n),dn=!1)}Jt=Cn,Zt=$n,sn=wn}return hn}}function graticuleX(xt,$t,Ct){var kt=range$6(xt,$t-epsilon$3,Ct).concat($t);return function(Mt){return kt.map(function(Ft){return[Mt,Ft]})}}function graticuleY(xt,$t,Ct){var kt=range$6(xt,$t-epsilon$3,Ct).concat($t);return function(Mt){return kt.map(function(Ft){return[Ft,Mt]})}}function graticule(){var xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt=10,zt=Vt,Ht=90,Gt=360,qt,Wt,Yt,Kt,Xt=2.5;function Qt(){return{type:"MultiLineString",coordinates:Jt()}}function Jt(){return range$6(ceil(kt/Ht)*Ht,Ct,Ht).map(Yt).concat(range$6(ceil(Bt/Gt)*Gt,jt,Gt).map(Kt)).concat(range$6(ceil($t/Vt)*Vt,xt,Vt).filter(function(Zt){return abs$2(Zt%Ht)>epsilon$3}).map(qt)).concat(range$6(ceil(Ft/zt)*zt,Mt,zt).filter(function(Zt){return abs$2(Zt%Gt)>epsilon$3}).map(Wt))}return Qt.lines=function(){return Jt().map(function(Zt){return{type:"LineString",coordinates:Zt}})},Qt.outline=function(){return{type:"Polygon",coordinates:[Yt(kt).concat(Kt(jt).slice(1),Yt(Ct).reverse().slice(1),Kt(Bt).reverse().slice(1))]}},Qt.extent=function(Zt){return arguments.length?Qt.extentMajor(Zt).extentMinor(Zt):Qt.extentMinor()},Qt.extentMajor=function(Zt){return arguments.length?(kt=+Zt[0][0],Ct=+Zt[1][0],Bt=+Zt[0][1],jt=+Zt[1][1],kt>Ct&&(Zt=kt,kt=Ct,Ct=Zt),Bt>jt&&(Zt=Bt,Bt=jt,jt=Zt),Qt.precision(Xt)):[[kt,Bt],[Ct,jt]]},Qt.extentMinor=function(Zt){return arguments.length?($t=+Zt[0][0],xt=+Zt[1][0],Ft=+Zt[0][1],Mt=+Zt[1][1],$t>xt&&(Zt=$t,$t=xt,xt=Zt),Ft>Mt&&(Zt=Ft,Ft=Mt,Mt=Zt),Qt.precision(Xt)):[[$t,Ft],[xt,Mt]]},Qt.step=function(Zt){return arguments.length?Qt.stepMajor(Zt).stepMinor(Zt):Qt.stepMinor()},Qt.stepMajor=function(Zt){return arguments.length?(Ht=+Zt[0],Gt=+Zt[1],Qt):[Ht,Gt]},Qt.stepMinor=function(Zt){return arguments.length?(Vt=+Zt[0],zt=+Zt[1],Qt):[Vt,zt]},Qt.precision=function(Zt){return arguments.length?(Xt=+Zt,qt=graticuleX(Ft,Mt,90),Wt=graticuleY($t,xt,Xt),Yt=graticuleX(Bt,jt,90),Kt=graticuleY(kt,Ct,Xt),Qt):Xt},Qt.extentMajor([[-180,-90+epsilon$3],[180,90-epsilon$3]]).extentMinor([[-180,-80-epsilon$3],[180,80+epsilon$3]])}const identity$5=xt=>xt;var areaSum=new Adder,areaRingSum=new Adder,x00$2,y00$2,x0$3,y0$3,areaStream={point:noop$6,lineStart:noop$6,lineEnd:noop$6,polygonStart:function(){areaStream.lineStart=areaRingStart,areaStream.lineEnd=areaRingEnd},polygonEnd:function(){areaStream.lineStart=areaStream.lineEnd=areaStream.point=noop$6,areaSum.add(abs$2(areaRingSum)),areaRingSum=new Adder},result:function(){var xt=areaSum/2;return areaSum=new Adder,xt}};function areaRingStart(){areaStream.point=areaPointFirst}function areaPointFirst(xt,$t){areaStream.point=areaPoint,x00$2=x0$3=xt,y00$2=y0$3=$t}function areaPoint(xt,$t){areaRingSum.add(y0$3*xt-x0$3*$t),x0$3=xt,y0$3=$t}function areaRingEnd(){areaPoint(x00$2,y00$2)}var x0$2=1/0,y0$2=x0$2,x1=-x0$2,y1=x1,boundsStream={point:boundsPoint,lineStart:noop$6,lineEnd:noop$6,polygonStart:noop$6,polygonEnd:noop$6,result:function(){var xt=[[x0$2,y0$2],[x1,y1]];return x1=y1=-(y0$2=x0$2=1/0),xt}};function boundsPoint(xt,$t){xt<x0$2&&(x0$2=xt),xt>x1&&(x1=xt),$t<y0$2&&(y0$2=$t),$t>y1&&(y1=$t)}var X0=0,Y0=0,Z0=0,X1=0,Y1=0,Z1=0,X2$1=0,Y2$1=0,Z2=0,x00$1,y00$1,x0$1,y0$1,centroidStream={point:centroidPoint,lineStart:centroidLineStart,lineEnd:centroidLineEnd,polygonStart:function(){centroidStream.lineStart=centroidRingStart,centroidStream.lineEnd=centroidRingEnd},polygonEnd:function(){centroidStream.point=centroidPoint,centroidStream.lineStart=centroidLineStart,centroidStream.lineEnd=centroidLineEnd},result:function(){var xt=Z2?[X2$1/Z2,Y2$1/Z2]:Z1?[X1/Z1,Y1/Z1]:Z0?[X0/Z0,Y0/Z0]:[NaN,NaN];return X0=Y0=Z0=X1=Y1=Z1=X2$1=Y2$1=Z2=0,xt}};function centroidPoint(xt,$t){X0+=xt,Y0+=$t,++Z0}function centroidLineStart(){centroidStream.point=centroidPointFirstLine}function centroidPointFirstLine(xt,$t){centroidStream.point=centroidPointLine,centroidPoint(x0$1=xt,y0$1=$t)}function centroidPointLine(xt,$t){var Ct=xt-x0$1,kt=$t-y0$1,Mt=sqrt$3(Ct*Ct+kt*kt);X1+=Mt*(x0$1+xt)/2,Y1+=Mt*(y0$1+$t)/2,Z1+=Mt,centroidPoint(x0$1=xt,y0$1=$t)}function centroidLineEnd(){centroidStream.point=centroidPoint}function centroidRingStart(){centroidStream.point=centroidPointFirstRing}function centroidRingEnd(){centroidPointRing(x00$1,y00$1)}function centroidPointFirstRing(xt,$t){centroidStream.point=centroidPointRing,centroidPoint(x00$1=x0$1=xt,y00$1=y0$1=$t)}function centroidPointRing(xt,$t){var Ct=xt-x0$1,kt=$t-y0$1,Mt=sqrt$3(Ct*Ct+kt*kt);X1+=Mt*(x0$1+xt)/2,Y1+=Mt*(y0$1+$t)/2,Z1+=Mt,Mt=y0$1*xt-x0$1*$t,X2$1+=Mt*(x0$1+xt),Y2$1+=Mt*(y0$1+$t),Z2+=Mt*3,centroidPoint(x0$1=xt,y0$1=$t)}function PathContext(xt){this._context=xt}PathContext.prototype={_radius:4.5,pointRadius:function(xt){return this._radius=xt,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(xt,$t){switch(this._point){case 0:{this._context.moveTo(xt,$t),this._point=1;break}case 1:{this._context.lineTo(xt,$t);break}default:{this._context.moveTo(xt+this._radius,$t),this._context.arc(xt,$t,this._radius,0,tau$1);break}}},result:noop$6};var lengthSum=new Adder,lengthRing,x00,y00,x0,y0,lengthStream={point:noop$6,lineStart:function(){lengthStream.point=lengthPointFirst},lineEnd:function(){lengthRing&&lengthPoint(x00,y00),lengthStream.point=noop$6},polygonStart:function(){lengthRing=!0},polygonEnd:function(){lengthRing=null},result:function(){var xt=+lengthSum;return lengthSum=new Adder,xt}};function lengthPointFirst(xt,$t){lengthStream.point=lengthPoint,x00=x0=xt,y00=y0=$t}function lengthPoint(xt,$t){x0-=xt,y0-=$t,lengthSum.add(sqrt$3(x0*x0+y0*y0)),x0=xt,y0=$t}let cacheDigits,cacheAppend,cacheRadius,cacheCircle;class PathString{constructor($t){this._append=$t==null?append$1:appendRound($t),this._radius=4.5,this._=""}pointRadius($t){return this._radius=+$t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point($t,Ct){switch(this._point){case 0:{this._append`M${$t},${Ct}`,this._point=1;break}case 1:{this._append`L${$t},${Ct}`;break}default:{if(this._append`M${$t},${Ct}`,this._radius!==cacheRadius||this._append!==cacheAppend){const kt=this._radius,Mt=this._;this._="",this._append`m0,${kt}a${kt},${kt} 0 1,1 0,${-2*kt}a${kt},${kt} 0 1,1 0,${2*kt}z`,cacheRadius=kt,cacheAppend=this._append,cacheCircle=this._,this._=Mt}this._+=cacheCircle;break}}}result(){const $t=this._;return this._="",$t.length?$t:null}}function append$1(xt){let $t=1;this._+=xt[0];for(const Ct=xt.length;$t<Ct;++$t)this._+=arguments[$t]+xt[$t]}function appendRound(xt){const $t=Math.floor(xt);if(!($t>=0))throw new RangeError(`invalid digits: ${xt}`);if($t>15)return append$1;if($t!==cacheDigits){const Ct=10**$t;cacheDigits=$t,cacheAppend=function(Mt){let Ft=1;this._+=Mt[0];for(const jt=Mt.length;Ft<jt;++Ft)this._+=Math.round(arguments[Ft]*Ct)/Ct+Mt[Ft]}}return cacheAppend}function geoPath(xt,$t){let Ct=3,kt=4.5,Mt,Ft;function jt(Bt){return Bt&&(typeof kt=="function"&&Ft.pointRadius(+kt.apply(this,arguments)),geoStream(Bt,Mt(Ft))),Ft.result()}return jt.area=function(Bt){return geoStream(Bt,Mt(areaStream)),areaStream.result()},jt.measure=function(Bt){return geoStream(Bt,Mt(lengthStream)),lengthStream.result()},jt.bounds=function(Bt){return geoStream(Bt,Mt(boundsStream)),boundsStream.result()},jt.centroid=function(Bt){return geoStream(Bt,Mt(centroidStream)),centroidStream.result()},jt.projection=function(Bt){return arguments.length?(Mt=Bt==null?(xt=null,identity$5):(xt=Bt).stream,jt):xt},jt.context=function(Bt){return arguments.length?(Ft=Bt==null?($t=null,new PathString(Ct)):new PathContext($t=Bt),typeof kt!="function"&&Ft.pointRadius(kt),jt):$t},jt.pointRadius=function(Bt){return arguments.length?(kt=typeof Bt=="function"?Bt:(Ft.pointRadius(+Bt),+Bt),jt):kt},jt.digits=function(Bt){if(!arguments.length)return Ct;if(Bt==null)Ct=null;else{const Vt=Math.floor(Bt);if(!(Vt>=0))throw new RangeError(`invalid digits: ${Bt}`);Ct=Vt}return $t===null&&(Ft=new PathString(Ct)),jt},jt.projection(xt).digits(Ct).context($t)}function transformer$3(xt){return function($t){var Ct=new TransformStream;for(var kt in xt)Ct[kt]=xt[kt];return Ct.stream=$t,Ct}}function TransformStream(){}TransformStream.prototype={constructor:TransformStream,point:function(xt,$t){this.stream.point(xt,$t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function fit$1(xt,$t,Ct){var kt=xt.clipExtent&&xt.clipExtent();return xt.scale(150).translate([0,0]),kt!=null&&xt.clipExtent(null),geoStream(Ct,xt.stream(boundsStream)),$t(boundsStream.result()),kt!=null&&xt.clipExtent(kt),xt}function fitExtent(xt,$t,Ct){return fit$1(xt,function(kt){var Mt=$t[1][0]-$t[0][0],Ft=$t[1][1]-$t[0][1],jt=Math.min(Mt/(kt[1][0]-kt[0][0]),Ft/(kt[1][1]-kt[0][1])),Bt=+$t[0][0]+(Mt-jt*(kt[1][0]+kt[0][0]))/2,Vt=+$t[0][1]+(Ft-jt*(kt[1][1]+kt[0][1]))/2;xt.scale(150*jt).translate([Bt,Vt])},Ct)}function fitSize(xt,$t,Ct){return fitExtent(xt,[[0,0],$t],Ct)}function fitWidth(xt,$t,Ct){return fit$1(xt,function(kt){var Mt=+$t,Ft=Mt/(kt[1][0]-kt[0][0]),jt=(Mt-Ft*(kt[1][0]+kt[0][0]))/2,Bt=-Ft*kt[0][1];xt.scale(150*Ft).translate([jt,Bt])},Ct)}function fitHeight(xt,$t,Ct){return fit$1(xt,function(kt){var Mt=+$t,Ft=Mt/(kt[1][1]-kt[0][1]),jt=-Ft*kt[0][0],Bt=(Mt-Ft*(kt[1][1]+kt[0][1]))/2;xt.scale(150*Ft).translate([jt,Bt])},Ct)}var maxDepth=16,cosMinDistance=cos$2(30*radians);function resample(xt,$t){return+$t?resample$1(xt,$t):resampleNone(xt)}function resampleNone(xt){return transformer$3({point:function($t,Ct){$t=xt($t,Ct),this.stream.point($t[0],$t[1])}})}function resample$1(xt,$t){function Ct(kt,Mt,Ft,jt,Bt,Vt,zt,Ht,Gt,qt,Wt,Yt,Kt,Xt){var Qt=zt-kt,Jt=Ht-Mt,Zt=Qt*Qt+Jt*Jt;if(Zt>4*$t&&Kt--){var sn=jt+qt,ln=Bt+Wt,dn=Vt+Yt,hn=sqrt$3(sn*sn+ln*ln+dn*dn),cn=asin$2(dn/=hn),pn=abs$2(abs$2(dn)-1)<epsilon$3||abs$2(Ft-Gt)<epsilon$3?(Ft+Gt)/2:atan2$1(ln,sn),yn=xt(pn,cn),gn=yn[0],En=yn[1],bn=gn-kt,xn=En-Mt,Cn=Jt*bn-Qt*xn;(Cn*Cn/Zt>$t||abs$2((Qt*bn+Jt*xn)/Zt-.5)>.3||jt*qt+Bt*Wt+Vt*Yt<cosMinDistance)&&(Ct(kt,Mt,Ft,jt,Bt,Vt,gn,En,pn,sn/=hn,ln/=hn,dn,Kt,Xt),Xt.point(gn,En),Ct(gn,En,pn,sn,ln,dn,zt,Ht,Gt,qt,Wt,Yt,Kt,Xt))}}return function(kt){var Mt,Ft,jt,Bt,Vt,zt,Ht,Gt,qt,Wt,Yt,Kt,Xt={point:Qt,lineStart:Jt,lineEnd:sn,polygonStart:function(){kt.polygonStart(),Xt.lineStart=ln},polygonEnd:function(){kt.polygonEnd(),Xt.lineStart=Jt}};function Qt(cn,pn){cn=xt(cn,pn),kt.point(cn[0],cn[1])}function Jt(){Gt=NaN,Xt.point=Zt,kt.lineStart()}function Zt(cn,pn){var yn=cartesian([cn,pn]),gn=xt(cn,pn);Ct(Gt,qt,Ht,Wt,Yt,Kt,Gt=gn[0],qt=gn[1],Ht=cn,Wt=yn[0],Yt=yn[1],Kt=yn[2],maxDepth,kt),kt.point(Gt,qt)}function sn(){Xt.point=Qt,kt.lineEnd()}function ln(){Jt(),Xt.point=dn,Xt.lineEnd=hn}function dn(cn,pn){Zt(Mt=cn,pn),Ft=Gt,jt=qt,Bt=Wt,Vt=Yt,zt=Kt,Xt.point=Zt}function hn(){Ct(Gt,qt,Ht,Wt,Yt,Kt,Ft,jt,Mt,Bt,Vt,zt,maxDepth,kt),Xt.lineEnd=sn,sn()}return Xt}}var transformRadians=transformer$3({point:function(xt,$t){this.stream.point(xt*radians,$t*radians)}});function transformRotate(xt){return transformer$3({point:function($t,Ct){var kt=xt($t,Ct);return this.stream.point(kt[0],kt[1])}})}function scaleTranslate(xt,$t,Ct,kt,Mt){function Ft(jt,Bt){return jt*=kt,Bt*=Mt,[$t+xt*jt,Ct-xt*Bt]}return Ft.invert=function(jt,Bt){return[(jt-$t)/xt*kt,(Ct-Bt)/xt*Mt]},Ft}function scaleTranslateRotate(xt,$t,Ct,kt,Mt,Ft){if(!Ft)return scaleTranslate(xt,$t,Ct,kt,Mt);var jt=cos$2(Ft),Bt=sin$2(Ft),Vt=jt*xt,zt=Bt*xt,Ht=jt/xt,Gt=Bt/xt,qt=(Bt*Ct-jt*$t)/xt,Wt=(Bt*$t+jt*Ct)/xt;function Yt(Kt,Xt){return Kt*=kt,Xt*=Mt,[Vt*Kt-zt*Xt+$t,Ct-zt*Kt-Vt*Xt]}return Yt.invert=function(Kt,Xt){return[kt*(Ht*Kt-Gt*Xt+qt),Mt*(Wt-Gt*Kt-Ht*Xt)]},Yt}function projection$1(xt){return projectionMutator(function(){return xt})()}function projectionMutator(xt){var $t,Ct=150,kt=480,Mt=250,Ft=0,jt=0,Bt=0,Vt=0,zt=0,Ht,Gt=0,qt=1,Wt=1,Yt=null,Kt=clipAntimeridian,Xt=null,Qt,Jt,Zt,sn=identity$5,ln=.5,dn,hn,cn,pn,yn;function gn(Cn){return cn(Cn[0]*radians,Cn[1]*radians)}function En(Cn){return Cn=cn.invert(Cn[0],Cn[1]),Cn&&[Cn[0]*degrees,Cn[1]*degrees]}gn.stream=function(Cn){return pn&&yn===Cn?pn:pn=transformRadians(transformRotate(Ht)(Kt(dn(sn(yn=Cn)))))},gn.preclip=function(Cn){return arguments.length?(Kt=Cn,Yt=void 0,xn()):Kt},gn.postclip=function(Cn){return arguments.length?(sn=Cn,Xt=Qt=Jt=Zt=null,xn()):sn},gn.clipAngle=function(Cn){return arguments.length?(Kt=+Cn?clipCircle(Yt=Cn*radians):(Yt=null,clipAntimeridian),xn()):Yt*degrees},gn.clipExtent=function(Cn){return arguments.length?(sn=Cn==null?(Xt=Qt=Jt=Zt=null,identity$5):clipRectangle(Xt=+Cn[0][0],Qt=+Cn[0][1],Jt=+Cn[1][0],Zt=+Cn[1][1]),xn()):Xt==null?null:[[Xt,Qt],[Jt,Zt]]},gn.scale=function(Cn){return arguments.length?(Ct=+Cn,bn()):Ct},gn.translate=function(Cn){return arguments.length?(kt=+Cn[0],Mt=+Cn[1],bn()):[kt,Mt]},gn.center=function(Cn){return arguments.length?(Ft=Cn[0]%360*radians,jt=Cn[1]%360*radians,bn()):[Ft*degrees,jt*degrees]},gn.rotate=function(Cn){return arguments.length?(Bt=Cn[0]%360*radians,Vt=Cn[1]%360*radians,zt=Cn.length>2?Cn[2]%360*radians:0,bn()):[Bt*degrees,Vt*degrees,zt*degrees]},gn.angle=function(Cn){return arguments.length?(Gt=Cn%360*radians,bn()):Gt*degrees},gn.reflectX=function(Cn){return arguments.length?(qt=Cn?-1:1,bn()):qt<0},gn.reflectY=function(Cn){return arguments.length?(Wt=Cn?-1:1,bn()):Wt<0},gn.precision=function(Cn){return arguments.length?(dn=resample(hn,ln=Cn*Cn),xn()):sqrt$3(ln)},gn.fitExtent=function(Cn,$n){return fitExtent(gn,Cn,$n)},gn.fitSize=function(Cn,$n){return fitSize(gn,Cn,$n)},gn.fitWidth=function(Cn,$n){return fitWidth(gn,Cn,$n)},gn.fitHeight=function(Cn,$n){return fitHeight(gn,Cn,$n)};function bn(){var Cn=scaleTranslateRotate(Ct,0,0,qt,Wt,Gt).apply(null,$t(Ft,jt)),$n=scaleTranslateRotate(Ct,kt-Cn[0],Mt-Cn[1],qt,Wt,Gt);return Ht=rotateRadians(Bt,Vt,zt),hn=compose$1($t,$n),cn=compose$1(Ht,hn),dn=resample(hn,ln),xn()}function xn(){return pn=yn=null,gn}return function(){return $t=xt.apply(this,arguments),gn.invert=$t.invert&&En,bn()}}function conicProjection(xt){var $t=0,Ct=pi$2/3,kt=projectionMutator(xt),Mt=kt($t,Ct);return Mt.parallels=function(Ft){return arguments.length?kt($t=Ft[0]*radians,Ct=Ft[1]*radians):[$t*degrees,Ct*degrees]},Mt}function cylindricalEqualAreaRaw(xt){var $t=cos$2(xt);function Ct(kt,Mt){return[kt*$t,sin$2(Mt)/$t]}return Ct.invert=function(kt,Mt){return[kt/$t,asin$2(Mt*$t)]},Ct}function conicEqualAreaRaw(xt,$t){var Ct=sin$2(xt),kt=(Ct+sin$2($t))/2;if(abs$2(kt)<epsilon$3)return cylindricalEqualAreaRaw(xt);var Mt=1+Ct*(2*kt-Ct),Ft=sqrt$3(Mt)/kt;function jt(Bt,Vt){var zt=sqrt$3(Mt-2*kt*sin$2(Vt))/kt;return[zt*sin$2(Bt*=kt),Ft-zt*cos$2(Bt)]}return jt.invert=function(Bt,Vt){var zt=Ft-Vt,Ht=atan2$1(Bt,abs$2(zt))*sign$1(zt);return zt*kt<0&&(Ht-=pi$2*sign$1(Bt)*sign$1(zt)),[Ht/kt,asin$2((Mt-(Bt*Bt+zt*zt)*kt*kt)/(2*kt))]},jt}function geoConicEqualArea(){return conicProjection(conicEqualAreaRaw).scale(155.424).center([0,33.6442])}function geoAlbers(){return geoConicEqualArea().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function multiplex(xt){var $t=xt.length;return{point:function(Ct,kt){for(var Mt=-1;++Mt<$t;)xt[Mt].point(Ct,kt)},sphere:function(){for(var Ct=-1;++Ct<$t;)xt[Ct].sphere()},lineStart:function(){for(var Ct=-1;++Ct<$t;)xt[Ct].lineStart()},lineEnd:function(){for(var Ct=-1;++Ct<$t;)xt[Ct].lineEnd()},polygonStart:function(){for(var Ct=-1;++Ct<$t;)xt[Ct].polygonStart()},polygonEnd:function(){for(var Ct=-1;++Ct<$t;)xt[Ct].polygonEnd()}}}function geoAlbersUsa(){var xt,$t,Ct=geoAlbers(),kt,Mt=geoConicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),Ft,jt=geoConicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),Bt,Vt,zt={point:function(qt,Wt){Vt=[qt,Wt]}};function Ht(qt){var Wt=qt[0],Yt=qt[1];return Vt=null,kt.point(Wt,Yt),Vt||(Ft.point(Wt,Yt),Vt)||(Bt.point(Wt,Yt),Vt)}Ht.invert=function(qt){var Wt=Ct.scale(),Yt=Ct.translate(),Kt=(qt[0]-Yt[0])/Wt,Xt=(qt[1]-Yt[1])/Wt;return(Xt>=.12&&Xt<.234&&Kt>=-.425&&Kt<-.214?Mt:Xt>=.166&&Xt<.234&&Kt>=-.214&&Kt<-.115?jt:Ct).invert(qt)},Ht.stream=function(qt){return xt&&$t===qt?xt:xt=multiplex([Ct.stream($t=qt),Mt.stream(qt),jt.stream(qt)])},Ht.precision=function(qt){return arguments.length?(Ct.precision(qt),Mt.precision(qt),jt.precision(qt),Gt()):Ct.precision()},Ht.scale=function(qt){return arguments.length?(Ct.scale(qt),Mt.scale(qt*.35),jt.scale(qt),Ht.translate(Ct.translate())):Ct.scale()},Ht.translate=function(qt){if(!arguments.length)return Ct.translate();var Wt=Ct.scale(),Yt=+qt[0],Kt=+qt[1];return kt=Ct.translate(qt).clipExtent([[Yt-.455*Wt,Kt-.238*Wt],[Yt+.455*Wt,Kt+.238*Wt]]).stream(zt),Ft=Mt.translate([Yt-.307*Wt,Kt+.201*Wt]).clipExtent([[Yt-.425*Wt+epsilon$3,Kt+.12*Wt+epsilon$3],[Yt-.214*Wt-epsilon$3,Kt+.234*Wt-epsilon$3]]).stream(zt),Bt=jt.translate([Yt-.205*Wt,Kt+.212*Wt]).clipExtent([[Yt-.214*Wt+epsilon$3,Kt+.166*Wt+epsilon$3],[Yt-.115*Wt-epsilon$3,Kt+.234*Wt-epsilon$3]]).stream(zt),Gt()},Ht.fitExtent=function(qt,Wt){return fitExtent(Ht,qt,Wt)},Ht.fitSize=function(qt,Wt){return fitSize(Ht,qt,Wt)},Ht.fitWidth=function(qt,Wt){return fitWidth(Ht,qt,Wt)},Ht.fitHeight=function(qt,Wt){return fitHeight(Ht,qt,Wt)};function Gt(){return xt=$t=null,Ht}return Ht.scale(1070)}function azimuthalRaw(xt){return function($t,Ct){var kt=cos$2($t),Mt=cos$2(Ct),Ft=xt(kt*Mt);return Ft===1/0?[2,0]:[Ft*Mt*sin$2($t),Ft*sin$2(Ct)]}}function azimuthalInvert(xt){return function($t,Ct){var kt=sqrt$3($t*$t+Ct*Ct),Mt=xt(kt),Ft=sin$2(Mt),jt=cos$2(Mt);return[atan2$1($t*Ft,kt*jt),asin$2(kt&&Ct*Ft/kt)]}}var azimuthalEqualAreaRaw=azimuthalRaw(function(xt){return sqrt$3(2/(1+xt))});azimuthalEqualAreaRaw.invert=azimuthalInvert(function(xt){return 2*asin$2(xt/2)});function geoAzimuthalEqualArea(){return projection$1(azimuthalEqualAreaRaw).scale(124.75).clipAngle(180-.001)}var azimuthalEquidistantRaw=azimuthalRaw(function(xt){return(xt=acos$1(xt))&&xt/sin$2(xt)});azimuthalEquidistantRaw.invert=azimuthalInvert(function(xt){return xt});function geoAzimuthalEquidistant(){return projection$1(azimuthalEquidistantRaw).scale(79.4188).clipAngle(180-.001)}function mercatorRaw(xt,$t){return[xt,log$4(tan((halfPi$2+$t)/2))]}mercatorRaw.invert=function(xt,$t){return[xt,2*atan(exp$2($t))-halfPi$2]};function geoMercator(){return mercatorProjection(mercatorRaw).scale(961/tau$1)}function mercatorProjection(xt){var $t=projection$1(xt),Ct=$t.center,kt=$t.scale,Mt=$t.translate,Ft=$t.clipExtent,jt=null,Bt,Vt,zt;$t.scale=function(Gt){return arguments.length?(kt(Gt),Ht()):kt()},$t.translate=function(Gt){return arguments.length?(Mt(Gt),Ht()):Mt()},$t.center=function(Gt){return arguments.length?(Ct(Gt),Ht()):Ct()},$t.clipExtent=function(Gt){return arguments.length?(Gt==null?jt=Bt=Vt=zt=null:(jt=+Gt[0][0],Bt=+Gt[0][1],Vt=+Gt[1][0],zt=+Gt[1][1]),Ht()):jt==null?null:[[jt,Bt],[Vt,zt]]};function Ht(){var Gt=pi$2*kt(),qt=$t(rotation($t.rotate()).invert([0,0]));return Ft(jt==null?[[qt[0]-Gt,qt[1]-Gt],[qt[0]+Gt,qt[1]+Gt]]:xt===mercatorRaw?[[Math.max(qt[0]-Gt,jt),Bt],[Math.min(qt[0]+Gt,Vt),zt]]:[[jt,Math.max(qt[1]-Gt,Bt)],[Vt,Math.min(qt[1]+Gt,zt)]])}return Ht()}function tany(xt){return tan((halfPi$2+xt)/2)}function conicConformalRaw(xt,$t){var Ct=cos$2(xt),kt=xt===$t?sin$2(xt):log$4(Ct/cos$2($t))/log$4(tany($t)/tany(xt)),Mt=Ct*pow$3(tany(xt),kt)/kt;if(!kt)return mercatorRaw;function Ft(jt,Bt){Mt>0?Bt<-halfPi$2+epsilon$3&&(Bt=-halfPi$2+epsilon$3):Bt>halfPi$2-epsilon$3&&(Bt=halfPi$2-epsilon$3);var Vt=Mt/pow$3(tany(Bt),kt);return[Vt*sin$2(kt*jt),Mt-Vt*cos$2(kt*jt)]}return Ft.invert=function(jt,Bt){var Vt=Mt-Bt,zt=sign$1(kt)*sqrt$3(jt*jt+Vt*Vt),Ht=atan2$1(jt,abs$2(Vt))*sign$1(Vt);return Vt*kt<0&&(Ht-=pi$2*sign$1(jt)*sign$1(Vt)),[Ht/kt,2*atan(pow$3(Mt/zt,1/kt))-halfPi$2]},Ft}function geoConicConformal(){return conicProjection(conicConformalRaw).scale(109.5).parallels([30,30])}function equirectangularRaw(xt,$t){return[xt,$t]}equirectangularRaw.invert=equirectangularRaw;function geoEquirectangular(){return projection$1(equirectangularRaw).scale(152.63)}function conicEquidistantRaw(xt,$t){var Ct=cos$2(xt),kt=xt===$t?sin$2(xt):(Ct-cos$2($t))/($t-xt),Mt=Ct/kt+xt;if(abs$2(kt)<epsilon$3)return equirectangularRaw;function Ft(jt,Bt){var Vt=Mt-Bt,zt=kt*jt;return[Vt*sin$2(zt),Mt-Vt*cos$2(zt)]}return Ft.invert=function(jt,Bt){var Vt=Mt-Bt,zt=atan2$1(jt,abs$2(Vt))*sign$1(Vt);return Vt*kt<0&&(zt-=pi$2*sign$1(jt)*sign$1(Vt)),[zt/kt,Mt-sign$1(kt)*sqrt$3(jt*jt+Vt*Vt)]},Ft}function geoConicEquidistant(){return conicProjection(conicEquidistantRaw).scale(131.154).center([0,13.9389])}var A1=1.340264,A2=-.081106,A3=893e-6,A4=.003796,M$2=sqrt$3(3)/2,iterations=12;function equalEarthRaw(xt,$t){var Ct=asin$2(M$2*sin$2($t)),kt=Ct*Ct,Mt=kt*kt*kt;return[xt*cos$2(Ct)/(M$2*(A1+3*A2*kt+Mt*(7*A3+9*A4*kt))),Ct*(A1+A2*kt+Mt*(A3+A4*kt))]}equalEarthRaw.invert=function(xt,$t){for(var Ct=$t,kt=Ct*Ct,Mt=kt*kt*kt,Ft=0,jt,Bt,Vt;Ft<iterations&&(Bt=Ct*(A1+A2*kt+Mt*(A3+A4*kt))-$t,Vt=A1+3*A2*kt+Mt*(7*A3+9*A4*kt),Ct-=jt=Bt/Vt,kt=Ct*Ct,Mt=kt*kt*kt,!(abs$2(jt)<epsilon2));++Ft);return[M$2*xt*(A1+3*A2*kt+Mt*(7*A3+9*A4*kt))/cos$2(Ct),asin$2(sin$2(Ct)/M$2)]};function geoEqualEarth(){return projection$1(equalEarthRaw).scale(177.158)}function gnomonicRaw(xt,$t){var Ct=cos$2($t),kt=cos$2(xt)*Ct;return[Ct*sin$2(xt)/kt,sin$2($t)/kt]}gnomonicRaw.invert=azimuthalInvert(atan);function geoGnomonic(){return projection$1(gnomonicRaw).scale(144.049).clipAngle(60)}function geoIdentity(){var xt=1,$t=0,Ct=0,kt=1,Mt=1,Ft=0,jt,Bt,Vt=null,zt,Ht,Gt,qt=1,Wt=1,Yt=transformer$3({point:function(sn,ln){var dn=Zt([sn,ln]);this.stream.point(dn[0],dn[1])}}),Kt=identity$5,Xt,Qt;function Jt(){return qt=xt*kt,Wt=xt*Mt,Xt=Qt=null,Zt}function Zt(sn){var ln=sn[0]*qt,dn=sn[1]*Wt;if(Ft){var hn=dn*jt-ln*Bt;ln=ln*jt+dn*Bt,dn=hn}return[ln+$t,dn+Ct]}return Zt.invert=function(sn){var ln=sn[0]-$t,dn=sn[1]-Ct;if(Ft){var hn=dn*jt+ln*Bt;ln=ln*jt-dn*Bt,dn=hn}return[ln/qt,dn/Wt]},Zt.stream=function(sn){return Xt&&Qt===sn?Xt:Xt=Yt(Kt(Qt=sn))},Zt.postclip=function(sn){return arguments.length?(Kt=sn,Vt=zt=Ht=Gt=null,Jt()):Kt},Zt.clipExtent=function(sn){return arguments.length?(Kt=sn==null?(Vt=zt=Ht=Gt=null,identity$5):clipRectangle(Vt=+sn[0][0],zt=+sn[0][1],Ht=+sn[1][0],Gt=+sn[1][1]),Jt()):Vt==null?null:[[Vt,zt],[Ht,Gt]]},Zt.scale=function(sn){return arguments.length?(xt=+sn,Jt()):xt},Zt.translate=function(sn){return arguments.length?($t=+sn[0],Ct=+sn[1],Jt()):[$t,Ct]},Zt.angle=function(sn){return arguments.length?(Ft=sn%360*radians,Bt=sin$2(Ft),jt=cos$2(Ft),Jt()):Ft*degrees},Zt.reflectX=function(sn){return arguments.length?(kt=sn?-1:1,Jt()):kt<0},Zt.reflectY=function(sn){return arguments.length?(Mt=sn?-1:1,Jt()):Mt<0},Zt.fitExtent=function(sn,ln){return fitExtent(Zt,sn,ln)},Zt.fitSize=function(sn,ln){return fitSize(Zt,sn,ln)},Zt.fitWidth=function(sn,ln){return fitWidth(Zt,sn,ln)},Zt.fitHeight=function(sn,ln){return fitHeight(Zt,sn,ln)},Zt}function naturalEarth1Raw(xt,$t){var Ct=$t*$t,kt=Ct*Ct;return[xt*(.8707-.131979*Ct+kt*(-.013791+kt*(.003971*Ct-.001529*kt))),$t*(1.007226+Ct*(.015085+kt*(-.044475+.028874*Ct-.005916*kt)))]}naturalEarth1Raw.invert=function(xt,$t){var Ct=$t,kt=25,Mt;do{var Ft=Ct*Ct,jt=Ft*Ft;Ct-=Mt=(Ct*(1.007226+Ft*(.015085+jt*(-.044475+.028874*Ft-.005916*jt)))-$t)/(1.007226+Ft*(.015085*3+jt*(-.044475*7+.028874*9*Ft-.005916*11*jt)))}while(abs$2(Mt)>epsilon$3&&--kt>0);return[xt/(.8707+(Ft=Ct*Ct)*(-.131979+Ft*(-.013791+Ft*Ft*Ft*(.003971-.001529*Ft)))),Ct]};function geoNaturalEarth1(){return projection$1(naturalEarth1Raw).scale(175.295)}function orthographicRaw(xt,$t){return[cos$2($t)*sin$2(xt),sin$2($t)]}orthographicRaw.invert=azimuthalInvert(asin$2);function geoOrthographic(){return projection$1(orthographicRaw).scale(249.5).clipAngle(90+epsilon$3)}function stereographicRaw(xt,$t){var Ct=cos$2($t),kt=1+cos$2(xt)*Ct;return[Ct*sin$2(xt)/kt,sin$2($t)/kt]}stereographicRaw.invert=azimuthalInvert(function(xt){return 2*atan(xt)});function geoStereographic(){return projection$1(stereographicRaw).scale(250).clipAngle(142)}function transverseMercatorRaw(xt,$t){return[log$4(tan((halfPi$2+$t)/2)),-xt]}transverseMercatorRaw.invert=function(xt,$t){return[-$t,2*atan(exp$2(xt))-halfPi$2]};function geoTransverseMercator(){var xt=mercatorProjection(transverseMercatorRaw),$t=xt.center,Ct=xt.rotate;return xt.center=function(kt){return arguments.length?$t([-kt[1],kt[0]]):(kt=$t(),[kt[1],-kt[0]])},xt.rotate=function(kt){return arguments.length?Ct([kt[0],kt[1],kt.length>2?kt[2]+90:90]):(kt=Ct(),[kt[0],kt[1],kt[2]-90])},Ct([0,0,90]).scale(159.155)}function defaultSeparation$2(xt,$t){return xt.parent===$t.parent?1:2}function meanX(xt){return xt.reduce(meanXReduce,0)/xt.length}function meanXReduce(xt,$t){return xt+$t.x}function maxY(xt){return 1+xt.reduce(maxYReduce,0)}function maxYReduce(xt,$t){return Math.max(xt,$t.y)}function leafLeft(xt){for(var $t;$t=xt.children;)xt=$t[0];return xt}function leafRight(xt){for(var $t;$t=xt.children;)xt=$t[$t.length-1];return xt}function cluster(){var xt=defaultSeparation$2,$t=1,Ct=1,kt=!1;function Mt(Ft){var jt,Bt=0;Ft.eachAfter(function(qt){var Wt=qt.children;Wt?(qt.x=meanX(Wt),qt.y=maxY(Wt)):(qt.x=jt?Bt+=xt(qt,jt):0,qt.y=0,jt=qt)});var Vt=leafLeft(Ft),zt=leafRight(Ft),Ht=Vt.x-xt(Vt,zt)/2,Gt=zt.x+xt(zt,Vt)/2;return Ft.eachAfter(kt?function(qt){qt.x=(qt.x-Ft.x)*$t,qt.y=(Ft.y-qt.y)*Ct}:function(qt){qt.x=(qt.x-Ht)/(Gt-Ht)*$t,qt.y=(1-(Ft.y?qt.y/Ft.y:1))*Ct})}return Mt.separation=function(Ft){return arguments.length?(xt=Ft,Mt):xt},Mt.size=function(Ft){return arguments.length?(kt=!1,$t=+Ft[0],Ct=+Ft[1],Mt):kt?null:[$t,Ct]},Mt.nodeSize=function(Ft){return arguments.length?(kt=!0,$t=+Ft[0],Ct=+Ft[1],Mt):kt?[$t,Ct]:null},Mt}function count$1(xt){var $t=0,Ct=xt.children,kt=Ct&&Ct.length;if(!kt)$t=1;else for(;--kt>=0;)$t+=Ct[kt].value;xt.value=$t}function node_count(){return this.eachAfter(count$1)}function node_each(xt,$t){let Ct=-1;for(const kt of this)xt.call($t,kt,++Ct,this);return this}function node_eachBefore(xt,$t){for(var Ct=this,kt=[Ct],Mt,Ft,jt=-1;Ct=kt.pop();)if(xt.call($t,Ct,++jt,this),Mt=Ct.children)for(Ft=Mt.length-1;Ft>=0;--Ft)kt.push(Mt[Ft]);return this}function node_eachAfter(xt,$t){for(var Ct=this,kt=[Ct],Mt=[],Ft,jt,Bt,Vt=-1;Ct=kt.pop();)if(Mt.push(Ct),Ft=Ct.children)for(jt=0,Bt=Ft.length;jt<Bt;++jt)kt.push(Ft[jt]);for(;Ct=Mt.pop();)xt.call($t,Ct,++Vt,this);return this}function node_find(xt,$t){let Ct=-1;for(const kt of this)if(xt.call($t,kt,++Ct,this))return kt}function node_sum(xt){return this.eachAfter(function($t){for(var Ct=+xt($t.data)||0,kt=$t.children,Mt=kt&&kt.length;--Mt>=0;)Ct+=kt[Mt].value;$t.value=Ct})}function node_sort(xt){return this.eachBefore(function($t){$t.children&&$t.children.sort(xt)})}function node_path(xt){for(var $t=this,Ct=leastCommonAncestor($t,xt),kt=[$t];$t!==Ct;)$t=$t.parent,kt.push($t);for(var Mt=kt.length;xt!==Ct;)kt.splice(Mt,0,xt),xt=xt.parent;return kt}function leastCommonAncestor(xt,$t){if(xt===$t)return xt;var Ct=xt.ancestors(),kt=$t.ancestors(),Mt=null;for(xt=Ct.pop(),$t=kt.pop();xt===$t;)Mt=xt,xt=Ct.pop(),$t=kt.pop();return Mt}function node_ancestors(){for(var xt=this,$t=[xt];xt=xt.parent;)$t.push(xt);return $t}function node_descendants(){return Array.from(this)}function node_leaves(){var xt=[];return this.eachBefore(function($t){$t.children||xt.push($t)}),xt}function node_links(){var xt=this,$t=[];return xt.each(function(Ct){Ct!==xt&&$t.push({source:Ct.parent,target:Ct})}),$t}function*node_iterator(){var xt=this,$t,Ct=[xt],kt,Mt,Ft;do for($t=Ct.reverse(),Ct=[];xt=$t.pop();)if(yield xt,kt=xt.children)for(Mt=0,Ft=kt.length;Mt<Ft;++Mt)Ct.push(kt[Mt]);while(Ct.length)}function hierarchy(xt,$t){xt instanceof Map?(xt=[void 0,xt],$t===void 0&&($t=mapChildren)):$t===void 0&&($t=objectChildren);for(var Ct=new Node$4(xt),kt,Mt=[Ct],Ft,jt,Bt,Vt;kt=Mt.pop();)if((jt=$t(kt.data))&&(Vt=(jt=Array.from(jt)).length))for(kt.children=jt,Bt=Vt-1;Bt>=0;--Bt)Mt.push(Ft=jt[Bt]=new Node$4(jt[Bt])),Ft.parent=kt,Ft.depth=kt.depth+1;return Ct.eachBefore(computeHeight)}function node_copy(){return hierarchy(this).eachBefore(copyData)}function objectChildren(xt){return xt.children}function mapChildren(xt){return Array.isArray(xt)?xt[1]:null}function copyData(xt){xt.data.value!==void 0&&(xt.value=xt.data.value),xt.data=xt.data.data}function computeHeight(xt){var $t=0;do xt.height=$t;while((xt=xt.parent)&&xt.height<++$t)}function Node$4(xt){this.data=xt,this.depth=this.height=0,this.parent=null}Node$4.prototype=hierarchy.prototype={constructor:Node$4,count:node_count,each:node_each,eachAfter:node_eachAfter,eachBefore:node_eachBefore,find:node_find,sum:node_sum,sort:node_sort,path:node_path,ancestors:node_ancestors,descendants:node_descendants,leaves:node_leaves,links:node_links,copy:node_copy,[Symbol.iterator]:node_iterator};function optional(xt){return xt==null?null:required$2(xt)}function required$2(xt){if(typeof xt!="function")throw new Error;return xt}function constantZero(){return 0}function constant$3(xt){return function(){return xt}}const a$1=1664525,c$1=1013904223,m$2=4294967296;function lcg$1(){let xt=1;return()=>(xt=(a$1*xt+c$1)%m$2)/m$2}function array$7(xt){return typeof xt=="object"&&"length"in xt?xt:Array.from(xt)}function shuffle(xt,$t){let Ct=xt.length,kt,Mt;for(;Ct;)Mt=$t()*Ct--|0,kt=xt[Ct],xt[Ct]=xt[Mt],xt[Mt]=kt;return xt}function packEncloseRandom(xt,$t){for(var Ct=0,kt=(xt=shuffle(Array.from(xt),$t)).length,Mt=[],Ft,jt;Ct<kt;)Ft=xt[Ct],jt&&enclosesWeak(jt,Ft)?++Ct:(jt=encloseBasis(Mt=extendBasis(Mt,Ft)),Ct=0);return jt}function extendBasis(xt,$t){var Ct,kt;if(enclosesWeakAll($t,xt))return[$t];for(Ct=0;Ct<xt.length;++Ct)if(enclosesNot($t,xt[Ct])&&enclosesWeakAll(encloseBasis2(xt[Ct],$t),xt))return[xt[Ct],$t];for(Ct=0;Ct<xt.length-1;++Ct)for(kt=Ct+1;kt<xt.length;++kt)if(enclosesNot(encloseBasis2(xt[Ct],xt[kt]),$t)&&enclosesNot(encloseBasis2(xt[Ct],$t),xt[kt])&&enclosesNot(encloseBasis2(xt[kt],$t),xt[Ct])&&enclosesWeakAll(encloseBasis3(xt[Ct],xt[kt],$t),xt))return[xt[Ct],xt[kt],$t];throw new Error}function enclosesNot(xt,$t){var Ct=xt.r-$t.r,kt=$t.x-xt.x,Mt=$t.y-xt.y;return Ct<0||Ct*Ct<kt*kt+Mt*Mt}function enclosesWeak(xt,$t){var Ct=xt.r-$t.r+Math.max(xt.r,$t.r,1)*1e-9,kt=$t.x-xt.x,Mt=$t.y-xt.y;return Ct>0&&Ct*Ct>kt*kt+Mt*Mt}function enclosesWeakAll(xt,$t){for(var Ct=0;Ct<$t.length;++Ct)if(!enclosesWeak(xt,$t[Ct]))return!1;return!0}function encloseBasis(xt){switch(xt.length){case 1:return encloseBasis1(xt[0]);case 2:return encloseBasis2(xt[0],xt[1]);case 3:return encloseBasis3(xt[0],xt[1],xt[2])}}function encloseBasis1(xt){return{x:xt.x,y:xt.y,r:xt.r}}function encloseBasis2(xt,$t){var Ct=xt.x,kt=xt.y,Mt=xt.r,Ft=$t.x,jt=$t.y,Bt=$t.r,Vt=Ft-Ct,zt=jt-kt,Ht=Bt-Mt,Gt=Math.sqrt(Vt*Vt+zt*zt);return{x:(Ct+Ft+Vt/Gt*Ht)/2,y:(kt+jt+zt/Gt*Ht)/2,r:(Gt+Mt+Bt)/2}}function encloseBasis3(xt,$t,Ct){var kt=xt.x,Mt=xt.y,Ft=xt.r,jt=$t.x,Bt=$t.y,Vt=$t.r,zt=Ct.x,Ht=Ct.y,Gt=Ct.r,qt=kt-jt,Wt=kt-zt,Yt=Mt-Bt,Kt=Mt-Ht,Xt=Vt-Ft,Qt=Gt-Ft,Jt=kt*kt+Mt*Mt-Ft*Ft,Zt=Jt-jt*jt-Bt*Bt+Vt*Vt,sn=Jt-zt*zt-Ht*Ht+Gt*Gt,ln=Wt*Yt-qt*Kt,dn=(Yt*sn-Kt*Zt)/(ln*2)-kt,hn=(Kt*Xt-Yt*Qt)/ln,cn=(Wt*Zt-qt*sn)/(ln*2)-Mt,pn=(qt*Qt-Wt*Xt)/ln,yn=hn*hn+pn*pn-1,gn=2*(Ft+dn*hn+cn*pn),En=dn*dn+cn*cn-Ft*Ft,bn=-(Math.abs(yn)>1e-6?(gn+Math.sqrt(gn*gn-4*yn*En))/(2*yn):En/gn);return{x:kt+dn+hn*bn,y:Mt+cn+pn*bn,r:bn}}function place(xt,$t,Ct){var kt=xt.x-$t.x,Mt,Ft,jt=xt.y-$t.y,Bt,Vt,zt=kt*kt+jt*jt;zt?(Ft=$t.r+Ct.r,Ft*=Ft,Vt=xt.r+Ct.r,Vt*=Vt,Ft>Vt?(Mt=(zt+Vt-Ft)/(2*zt),Bt=Math.sqrt(Math.max(0,Vt/zt-Mt*Mt)),Ct.x=xt.x-Mt*kt-Bt*jt,Ct.y=xt.y-Mt*jt+Bt*kt):(Mt=(zt+Ft-Vt)/(2*zt),Bt=Math.sqrt(Math.max(0,Ft/zt-Mt*Mt)),Ct.x=$t.x+Mt*kt-Bt*jt,Ct.y=$t.y+Mt*jt+Bt*kt)):(Ct.x=$t.x+Ct.r,Ct.y=$t.y)}function intersects(xt,$t){var Ct=xt.r+$t.r-1e-6,kt=$t.x-xt.x,Mt=$t.y-xt.y;return Ct>0&&Ct*Ct>kt*kt+Mt*Mt}function score(xt){var $t=xt._,Ct=xt.next._,kt=$t.r+Ct.r,Mt=($t.x*Ct.r+Ct.x*$t.r)/kt,Ft=($t.y*Ct.r+Ct.y*$t.r)/kt;return Mt*Mt+Ft*Ft}function Node$3(xt){this._=xt,this.next=null,this.previous=null}function packSiblingsRandom(xt,$t){if(!(Ft=(xt=array$7(xt)).length))return 0;var Ct,kt,Mt,Ft,jt,Bt,Vt,zt,Ht,Gt,qt;if(Ct=xt[0],Ct.x=0,Ct.y=0,!(Ft>1))return Ct.r;if(kt=xt[1],Ct.x=-kt.r,kt.x=Ct.r,kt.y=0,!(Ft>2))return Ct.r+kt.r;place(kt,Ct,Mt=xt[2]),Ct=new Node$3(Ct),kt=new Node$3(kt),Mt=new Node$3(Mt),Ct.next=Mt.previous=kt,kt.next=Ct.previous=Mt,Mt.next=kt.previous=Ct;e:for(Vt=3;Vt<Ft;++Vt){place(Ct._,kt._,Mt=xt[Vt]),Mt=new Node$3(Mt),zt=kt.next,Ht=Ct.previous,Gt=kt._.r,qt=Ct._.r;do if(Gt<=qt){if(intersects(zt._,Mt._)){kt=zt,Ct.next=kt,kt.previous=Ct,--Vt;continue e}Gt+=zt._.r,zt=zt.next}else{if(intersects(Ht._,Mt._)){Ct=Ht,Ct.next=kt,kt.previous=Ct,--Vt;continue e}qt+=Ht._.r,Ht=Ht.previous}while(zt!==Ht.next);for(Mt.previous=Ct,Mt.next=kt,Ct.next=kt.previous=kt=Mt,jt=score(Ct);(Mt=Mt.next)!==kt;)(Bt=score(Mt))<jt&&(Ct=Mt,jt=Bt);kt=Ct.next}for(Ct=[kt._],Mt=kt;(Mt=Mt.next)!==kt;)Ct.push(Mt._);for(Mt=packEncloseRandom(Ct,$t),Vt=0;Vt<Ft;++Vt)Ct=xt[Vt],Ct.x-=Mt.x,Ct.y-=Mt.y;return Mt.r}function defaultRadius(xt){return Math.sqrt(xt.value)}function pack(){var xt=null,$t=1,Ct=1,kt=constantZero;function Mt(Ft){const jt=lcg$1();return Ft.x=$t/2,Ft.y=Ct/2,xt?Ft.eachBefore(radiusLeaf(xt)).eachAfter(packChildrenRandom(kt,.5,jt)).eachBefore(translateChild(1)):Ft.eachBefore(radiusLeaf(defaultRadius)).eachAfter(packChildrenRandom(constantZero,1,jt)).eachAfter(packChildrenRandom(kt,Ft.r/Math.min($t,Ct),jt)).eachBefore(translateChild(Math.min($t,Ct)/(2*Ft.r))),Ft}return Mt.radius=function(Ft){return arguments.length?(xt=optional(Ft),Mt):xt},Mt.size=function(Ft){return arguments.length?($t=+Ft[0],Ct=+Ft[1],Mt):[$t,Ct]},Mt.padding=function(Ft){return arguments.length?(kt=typeof Ft=="function"?Ft:constant$3(+Ft),Mt):kt},Mt}function radiusLeaf(xt){return function($t){$t.children||($t.r=Math.max(0,+xt($t)||0))}}function packChildrenRandom(xt,$t,Ct){return function(kt){if(Mt=kt.children){var Mt,Ft,jt=Mt.length,Bt=xt(kt)*$t||0,Vt;if(Bt)for(Ft=0;Ft<jt;++Ft)Mt[Ft].r+=Bt;if(Vt=packSiblingsRandom(Mt,Ct),Bt)for(Ft=0;Ft<jt;++Ft)Mt[Ft].r-=Bt;kt.r=Vt+Bt}}}function translateChild(xt){return function($t){var Ct=$t.parent;$t.r*=xt,Ct&&($t.x=Ct.x+xt*$t.x,$t.y=Ct.y+xt*$t.y)}}function roundNode(xt){xt.x0=Math.round(xt.x0),xt.y0=Math.round(xt.y0),xt.x1=Math.round(xt.x1),xt.y1=Math.round(xt.y1)}function treemapDice(xt,$t,Ct,kt,Mt){for(var Ft=xt.children,jt,Bt=-1,Vt=Ft.length,zt=xt.value&&(kt-$t)/xt.value;++Bt<Vt;)jt=Ft[Bt],jt.y0=Ct,jt.y1=Mt,jt.x0=$t,jt.x1=$t+=jt.value*zt}function partition$4(){var xt=1,$t=1,Ct=0,kt=!1;function Mt(jt){var Bt=jt.height+1;return jt.x0=jt.y0=Ct,jt.x1=xt,jt.y1=$t/Bt,jt.eachBefore(Ft($t,Bt)),kt&&jt.eachBefore(roundNode),jt}function Ft(jt,Bt){return function(Vt){Vt.children&&treemapDice(Vt,Vt.x0,jt*(Vt.depth+1)/Bt,Vt.x1,jt*(Vt.depth+2)/Bt);var zt=Vt.x0,Ht=Vt.y0,Gt=Vt.x1-Ct,qt=Vt.y1-Ct;Gt<zt&&(zt=Gt=(zt+Gt)/2),qt<Ht&&(Ht=qt=(Ht+qt)/2),Vt.x0=zt,Vt.y0=Ht,Vt.x1=Gt,Vt.y1=qt}}return Mt.round=function(jt){return arguments.length?(kt=!!jt,Mt):kt},Mt.size=function(jt){return arguments.length?(xt=+jt[0],$t=+jt[1],Mt):[xt,$t]},Mt.padding=function(jt){return arguments.length?(Ct=+jt,Mt):Ct},Mt}var preroot={depth:-1},ambiguous={},imputed={};function defaultId(xt){return xt.id}function defaultParentId(xt){return xt.parentId}function stratify(){var xt=defaultId,$t=defaultParentId,Ct;function kt(Mt){var Ft=Array.from(Mt),jt=xt,Bt=$t,Vt,zt,Ht,Gt,qt,Wt,Yt,Kt,Xt=new Map;if(Ct!=null){const Qt=Ft.map((sn,ln)=>normalize$2(Ct(sn,ln,Mt))),Jt=Qt.map(parentof),Zt=new Set(Qt).add("");for(const sn of Jt)Zt.has(sn)||(Zt.add(sn),Qt.push(sn),Jt.push(parentof(sn)),Ft.push(imputed));jt=(sn,ln)=>Qt[ln],Bt=(sn,ln)=>Jt[ln]}for(Ht=0,Vt=Ft.length;Ht<Vt;++Ht)zt=Ft[Ht],Wt=Ft[Ht]=new Node$4(zt),(Yt=jt(zt,Ht,Mt))!=null&&(Yt+="")&&(Kt=Wt.id=Yt,Xt.set(Kt,Xt.has(Kt)?ambiguous:Wt)),(Yt=Bt(zt,Ht,Mt))!=null&&(Yt+="")&&(Wt.parent=Yt);for(Ht=0;Ht<Vt;++Ht)if(Wt=Ft[Ht],Yt=Wt.parent){if(qt=Xt.get(Yt),!qt)throw new Error("missing: "+Yt);if(qt===ambiguous)throw new Error("ambiguous: "+Yt);qt.children?qt.children.push(Wt):qt.children=[Wt],Wt.parent=qt}else{if(Gt)throw new Error("multiple roots");Gt=Wt}if(!Gt)throw new Error("no root");if(Ct!=null){for(;Gt.data===imputed&&Gt.children.length===1;)Gt=Gt.children[0],--Vt;for(let Qt=Ft.length-1;Qt>=0&&(Wt=Ft[Qt],Wt.data===imputed);--Qt)Wt.data=null}if(Gt.parent=preroot,Gt.eachBefore(function(Qt){Qt.depth=Qt.parent.depth+1,--Vt}).eachBefore(computeHeight),Gt.parent=null,Vt>0)throw new Error("cycle");return Gt}return kt.id=function(Mt){return arguments.length?(xt=optional(Mt),kt):xt},kt.parentId=function(Mt){return arguments.length?($t=optional(Mt),kt):$t},kt.path=function(Mt){return arguments.length?(Ct=optional(Mt),kt):Ct},kt}function normalize$2(xt){xt=`${xt}`;let $t=xt.length;return slash(xt,$t-1)&&!slash(xt,$t-2)&&(xt=xt.slice(0,-1)),xt[0]==="/"?xt:`/${xt}`}function parentof(xt){let $t=xt.length;if($t<2)return"";for(;--$t>1&&!slash(xt,$t););return xt.slice(0,$t)}function slash(xt,$t){if(xt[$t]==="/"){let Ct=0;for(;$t>0&&xt[--$t]==="\\";)++Ct;if(!(Ct&1))return!0}return!1}function defaultSeparation$1(xt,$t){return xt.parent===$t.parent?1:2}function nextLeft(xt){var $t=xt.children;return $t?$t[0]:xt.t}function nextRight(xt){var $t=xt.children;return $t?$t[$t.length-1]:xt.t}function moveSubtree(xt,$t,Ct){var kt=Ct/($t.i-xt.i);$t.c-=kt,$t.s+=Ct,xt.c+=kt,$t.z+=Ct,$t.m+=Ct}function executeShifts(xt){for(var $t=0,Ct=0,kt=xt.children,Mt=kt.length,Ft;--Mt>=0;)Ft=kt[Mt],Ft.z+=$t,Ft.m+=$t,$t+=Ft.s+(Ct+=Ft.c)}function nextAncestor(xt,$t,Ct){return xt.a.parent===$t.parent?xt.a:Ct}function TreeNode(xt,$t){this._=xt,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=$t}TreeNode.prototype=Object.create(Node$4.prototype);function treeRoot(xt){for(var $t=new TreeNode(xt,0),Ct,kt=[$t],Mt,Ft,jt,Bt;Ct=kt.pop();)if(Ft=Ct._.children)for(Ct.children=new Array(Bt=Ft.length),jt=Bt-1;jt>=0;--jt)kt.push(Mt=Ct.children[jt]=new TreeNode(Ft[jt],jt)),Mt.parent=Ct;return($t.parent=new TreeNode(null,0)).children=[$t],$t}function tree$1(){var xt=defaultSeparation$1,$t=1,Ct=1,kt=null;function Mt(zt){var Ht=treeRoot(zt);if(Ht.eachAfter(Ft),Ht.parent.m=-Ht.z,Ht.eachBefore(jt),kt)zt.eachBefore(Vt);else{var Gt=zt,qt=zt,Wt=zt;zt.eachBefore(function(Jt){Jt.x<Gt.x&&(Gt=Jt),Jt.x>qt.x&&(qt=Jt),Jt.depth>Wt.depth&&(Wt=Jt)});var Yt=Gt===qt?1:xt(Gt,qt)/2,Kt=Yt-Gt.x,Xt=$t/(qt.x+Yt+Kt),Qt=Ct/(Wt.depth||1);zt.eachBefore(function(Jt){Jt.x=(Jt.x+Kt)*Xt,Jt.y=Jt.depth*Qt})}return zt}function Ft(zt){var Ht=zt.children,Gt=zt.parent.children,qt=zt.i?Gt[zt.i-1]:null;if(Ht){executeShifts(zt);var Wt=(Ht[0].z+Ht[Ht.length-1].z)/2;qt?(zt.z=qt.z+xt(zt._,qt._),zt.m=zt.z-Wt):zt.z=Wt}else qt&&(zt.z=qt.z+xt(zt._,qt._));zt.parent.A=Bt(zt,qt,zt.parent.A||Gt[0])}function jt(zt){zt._.x=zt.z+zt.parent.m,zt.m+=zt.parent.m}function Bt(zt,Ht,Gt){if(Ht){for(var qt=zt,Wt=zt,Yt=Ht,Kt=qt.parent.children[0],Xt=qt.m,Qt=Wt.m,Jt=Yt.m,Zt=Kt.m,sn;Yt=nextRight(Yt),qt=nextLeft(qt),Yt&&qt;)Kt=nextLeft(Kt),Wt=nextRight(Wt),Wt.a=zt,sn=Yt.z+Jt-qt.z-Xt+xt(Yt._,qt._),sn>0&&(moveSubtree(nextAncestor(Yt,zt,Gt),zt,sn),Xt+=sn,Qt+=sn),Jt+=Yt.m,Xt+=qt.m,Zt+=Kt.m,Qt+=Wt.m;Yt&&!nextRight(Wt)&&(Wt.t=Yt,Wt.m+=Jt-Qt),qt&&!nextLeft(Kt)&&(Kt.t=qt,Kt.m+=Xt-Zt,Gt=zt)}return Gt}function Vt(zt){zt.x*=$t,zt.y=zt.depth*Ct}return Mt.separation=function(zt){return arguments.length?(xt=zt,Mt):xt},Mt.size=function(zt){return arguments.length?(kt=!1,$t=+zt[0],Ct=+zt[1],Mt):kt?null:[$t,Ct]},Mt.nodeSize=function(zt){return arguments.length?(kt=!0,$t=+zt[0],Ct=+zt[1],Mt):kt?[$t,Ct]:null},Mt}function treemapSlice(xt,$t,Ct,kt,Mt){for(var Ft=xt.children,jt,Bt=-1,Vt=Ft.length,zt=xt.value&&(Mt-Ct)/xt.value;++Bt<Vt;)jt=Ft[Bt],jt.x0=$t,jt.x1=kt,jt.y0=Ct,jt.y1=Ct+=jt.value*zt}var phi=(1+Math.sqrt(5))/2;function squarifyRatio(xt,$t,Ct,kt,Mt,Ft){for(var jt=[],Bt=$t.children,Vt,zt,Ht=0,Gt=0,qt=Bt.length,Wt,Yt,Kt=$t.value,Xt,Qt,Jt,Zt,sn,ln,dn;Ht<qt;){Wt=Mt-Ct,Yt=Ft-kt;do Xt=Bt[Gt++].value;while(!Xt&&Gt<qt);for(Qt=Jt=Xt,ln=Math.max(Yt/Wt,Wt/Yt)/(Kt*xt),dn=Xt*Xt*ln,sn=Math.max(Jt/dn,dn/Qt);Gt<qt;++Gt){if(Xt+=zt=Bt[Gt].value,zt<Qt&&(Qt=zt),zt>Jt&&(Jt=zt),dn=Xt*Xt*ln,Zt=Math.max(Jt/dn,dn/Qt),Zt>sn){Xt-=zt;break}sn=Zt}jt.push(Vt={value:Xt,dice:Wt<Yt,children:Bt.slice(Ht,Gt)}),Vt.dice?treemapDice(Vt,Ct,kt,Mt,Kt?kt+=Yt*Xt/Kt:Ft):treemapSlice(Vt,Ct,kt,Kt?Ct+=Wt*Xt/Kt:Mt,Ft),Kt-=Xt,Ht=Gt}return jt}const treemapSquarify=function xt($t){function Ct(kt,Mt,Ft,jt,Bt){squarifyRatio($t,kt,Mt,Ft,jt,Bt)}return Ct.ratio=function(kt){return xt((kt=+kt)>1?kt:1)},Ct}(phi);function treemap(){var xt=treemapSquarify,$t=!1,Ct=1,kt=1,Mt=[0],Ft=constantZero,jt=constantZero,Bt=constantZero,Vt=constantZero,zt=constantZero;function Ht(qt){return qt.x0=qt.y0=0,qt.x1=Ct,qt.y1=kt,qt.eachBefore(Gt),Mt=[0],$t&&qt.eachBefore(roundNode),qt}function Gt(qt){var Wt=Mt[qt.depth],Yt=qt.x0+Wt,Kt=qt.y0+Wt,Xt=qt.x1-Wt,Qt=qt.y1-Wt;Xt<Yt&&(Yt=Xt=(Yt+Xt)/2),Qt<Kt&&(Kt=Qt=(Kt+Qt)/2),qt.x0=Yt,qt.y0=Kt,qt.x1=Xt,qt.y1=Qt,qt.children&&(Wt=Mt[qt.depth+1]=Ft(qt)/2,Yt+=zt(qt)-Wt,Kt+=jt(qt)-Wt,Xt-=Bt(qt)-Wt,Qt-=Vt(qt)-Wt,Xt<Yt&&(Yt=Xt=(Yt+Xt)/2),Qt<Kt&&(Kt=Qt=(Kt+Qt)/2),xt(qt,Yt,Kt,Xt,Qt))}return Ht.round=function(qt){return arguments.length?($t=!!qt,Ht):$t},Ht.size=function(qt){return arguments.length?(Ct=+qt[0],kt=+qt[1],Ht):[Ct,kt]},Ht.tile=function(qt){return arguments.length?(xt=required$2(qt),Ht):xt},Ht.padding=function(qt){return arguments.length?Ht.paddingInner(qt).paddingOuter(qt):Ht.paddingInner()},Ht.paddingInner=function(qt){return arguments.length?(Ft=typeof qt=="function"?qt:constant$3(+qt),Ht):Ft},Ht.paddingOuter=function(qt){return arguments.length?Ht.paddingTop(qt).paddingRight(qt).paddingBottom(qt).paddingLeft(qt):Ht.paddingTop()},Ht.paddingTop=function(qt){return arguments.length?(jt=typeof qt=="function"?qt:constant$3(+qt),Ht):jt},Ht.paddingRight=function(qt){return arguments.length?(Bt=typeof qt=="function"?qt:constant$3(+qt),Ht):Bt},Ht.paddingBottom=function(qt){return arguments.length?(Vt=typeof qt=="function"?qt:constant$3(+qt),Ht):Vt},Ht.paddingLeft=function(qt){return arguments.length?(zt=typeof qt=="function"?qt:constant$3(+qt),Ht):zt},Ht}function treemapBinary(xt,$t,Ct,kt,Mt){var Ft=xt.children,jt,Bt=Ft.length,Vt,zt=new Array(Bt+1);for(zt[0]=Vt=jt=0;jt<Bt;++jt)zt[jt+1]=Vt+=Ft[jt].value;Ht(0,Bt,xt.value,$t,Ct,kt,Mt);function Ht(Gt,qt,Wt,Yt,Kt,Xt,Qt){if(Gt>=qt-1){var Jt=Ft[Gt];Jt.x0=Yt,Jt.y0=Kt,Jt.x1=Xt,Jt.y1=Qt;return}for(var Zt=zt[Gt],sn=Wt/2+Zt,ln=Gt+1,dn=qt-1;ln<dn;){var hn=ln+dn>>>1;zt[hn]<sn?ln=hn+1:dn=hn}sn-zt[ln-1]<zt[ln]-sn&&Gt+1<ln&&--ln;var cn=zt[ln]-Zt,pn=Wt-cn;if(Xt-Yt>Qt-Kt){var yn=Wt?(Yt*pn+Xt*cn)/Wt:Xt;Ht(Gt,ln,cn,Yt,Kt,yn,Qt),Ht(ln,qt,pn,yn,Kt,Xt,Qt)}else{var gn=Wt?(Kt*pn+Qt*cn)/Wt:Qt;Ht(Gt,ln,cn,Yt,Kt,Xt,gn),Ht(ln,qt,pn,Yt,gn,Xt,Qt)}}}function treemapSliceDice(xt,$t,Ct,kt,Mt){(xt.depth&1?treemapSlice:treemapDice)(xt,$t,Ct,kt,Mt)}const treemapResquarify=function xt($t){function Ct(kt,Mt,Ft,jt,Bt){if((Vt=kt._squarify)&&Vt.ratio===$t)for(var Vt,zt,Ht,Gt,qt=-1,Wt,Yt=Vt.length,Kt=kt.value;++qt<Yt;){for(zt=Vt[qt],Ht=zt.children,Gt=zt.value=0,Wt=Ht.length;Gt<Wt;++Gt)zt.value+=Ht[Gt].value;zt.dice?treemapDice(zt,Mt,Ft,jt,Kt?Ft+=(Bt-Ft)*zt.value/Kt:Bt):treemapSlice(zt,Mt,Ft,Kt?Mt+=(jt-Mt)*zt.value/Kt:jt,Bt),Kt-=zt.value}else kt._squarify=Vt=squarifyRatio($t,kt,Mt,Ft,jt,Bt),Vt.ratio=$t}return Ct.ratio=function(kt){return xt((kt=+kt)>1?kt:1)},Ct}(phi);function initRange(xt,$t){switch(arguments.length){case 0:break;case 1:this.range(xt);break;default:this.range($t).domain(xt);break}return this}function initInterpolator(xt,$t){switch(arguments.length){case 0:break;case 1:{typeof xt=="function"?this.interpolator(xt):this.range(xt);break}default:{this.domain(xt),typeof $t=="function"?this.interpolator($t):this.range($t);break}}return this}const implicit=Symbol("implicit");function ordinal(){var xt=new InternMap,$t=[],Ct=[],kt=implicit;function Mt(Ft){let jt=xt.get(Ft);if(jt===void 0){if(kt!==implicit)return kt;xt.set(Ft,jt=$t.push(Ft)-1)}return Ct[jt%Ct.length]}return Mt.domain=function(Ft){if(!arguments.length)return $t.slice();$t=[],xt=new InternMap;for(const jt of Ft)xt.has(jt)||xt.set(jt,$t.push(jt)-1);return Mt},Mt.range=function(Ft){return arguments.length?(Ct=Array.from(Ft),Mt):Ct.slice()},Mt.unknown=function(Ft){return arguments.length?(kt=Ft,Mt):kt},Mt.copy=function(){return ordinal($t,Ct).unknown(kt)},initRange.apply(Mt,arguments),Mt}function band$1(){var xt=ordinal().unknown(void 0),$t=xt.domain,Ct=xt.range,kt=0,Mt=1,Ft,jt,Bt=!1,Vt=0,zt=0,Ht=.5;delete xt.unknown;function Gt(){var qt=$t().length,Wt=Mt<kt,Yt=Wt?Mt:kt,Kt=Wt?kt:Mt;Ft=(Kt-Yt)/Math.max(1,qt-Vt+zt*2),Bt&&(Ft=Math.floor(Ft)),Yt+=(Kt-Yt-Ft*(qt-Vt))*Ht,jt=Ft*(1-Vt),Bt&&(Yt=Math.round(Yt),jt=Math.round(jt));var Xt=range$6(qt).map(function(Qt){return Yt+Ft*Qt});return Ct(Wt?Xt.reverse():Xt)}return xt.domain=function(qt){return arguments.length?($t(qt),Gt()):$t()},xt.range=function(qt){return arguments.length?([kt,Mt]=qt,kt=+kt,Mt=+Mt,Gt()):[kt,Mt]},xt.rangeRound=function(qt){return[kt,Mt]=qt,kt=+kt,Mt=+Mt,Bt=!0,Gt()},xt.bandwidth=function(){return jt},xt.step=function(){return Ft},xt.round=function(qt){return arguments.length?(Bt=!!qt,Gt()):Bt},xt.padding=function(qt){return arguments.length?(Vt=Math.min(1,zt=+qt),Gt()):Vt},xt.paddingInner=function(qt){return arguments.length?(Vt=Math.min(1,qt),Gt()):Vt},xt.paddingOuter=function(qt){return arguments.length?(zt=+qt,Gt()):zt},xt.align=function(qt){return arguments.length?(Ht=Math.max(0,Math.min(1,qt)),Gt()):Ht},xt.copy=function(){return band$1($t(),[kt,Mt]).round(Bt).paddingInner(Vt).paddingOuter(zt).align(Ht)},initRange.apply(Gt(),arguments)}function constants$2(xt){return function(){return xt}}function number$5(xt){return+xt}var unit=[0,1];function identity$4(xt){return xt}function normalize$1(xt,$t){return($t-=xt=+xt)?function(Ct){return(Ct-xt)/$t}:constants$2(isNaN($t)?NaN:.5)}function clamper(xt,$t){var Ct;return xt>$t&&(Ct=xt,xt=$t,$t=Ct),function(kt){return Math.max(xt,Math.min($t,kt))}}function bimap(xt,$t,Ct){var kt=xt[0],Mt=xt[1],Ft=$t[0],jt=$t[1];return Mt<kt?(kt=normalize$1(Mt,kt),Ft=Ct(jt,Ft)):(kt=normalize$1(kt,Mt),Ft=Ct(Ft,jt)),function(Bt){return Ft(kt(Bt))}}function polymap(xt,$t,Ct){var kt=Math.min(xt.length,$t.length)-1,Mt=new Array(kt),Ft=new Array(kt),jt=-1;for(xt[kt]<xt[0]&&(xt=xt.slice().reverse(),$t=$t.slice().reverse());++jt<kt;)Mt[jt]=normalize$1(xt[jt],xt[jt+1]),Ft[jt]=Ct($t[jt],$t[jt+1]);return function(Bt){var Vt=bisectRight$1(xt,Bt,1,kt)-1;return Ft[Vt](Mt[Vt](Bt))}}function copy$2(xt,$t){return $t.domain(xt.domain()).range(xt.range()).interpolate(xt.interpolate()).clamp(xt.clamp()).unknown(xt.unknown())}function transformer$2(){var xt=unit,$t=unit,Ct=interpolate$1$1,kt,Mt,Ft,jt=identity$4,Bt,Vt,zt;function Ht(){var qt=Math.min(xt.length,$t.length);return jt!==identity$4&&(jt=clamper(xt[0],xt[qt-1])),Bt=qt>2?polymap:bimap,Vt=zt=null,Gt}function Gt(qt){return qt==null||isNaN(qt=+qt)?Ft:(Vt||(Vt=Bt(xt.map(kt),$t,Ct)))(kt(jt(qt)))}return Gt.invert=function(qt){return jt(Mt((zt||(zt=Bt($t,xt.map(kt),interpolateNumber)))(qt)))},Gt.domain=function(qt){return arguments.length?(xt=Array.from(qt,number$5),Ht()):xt.slice()},Gt.range=function(qt){return arguments.length?($t=Array.from(qt),Ht()):$t.slice()},Gt.rangeRound=function(qt){return $t=Array.from(qt),Ct=interpolateRound,Ht()},Gt.clamp=function(qt){return arguments.length?(jt=qt?!0:identity$4,Ht()):jt!==identity$4},Gt.interpolate=function(qt){return arguments.length?(Ct=qt,Ht()):Ct},Gt.unknown=function(qt){return arguments.length?(Ft=qt,Gt):Ft},function(qt,Wt){return kt=qt,Mt=Wt,Ht()}}function continuous$1(){return transformer$2()(identity$4,identity$4)}function tickFormat$1(xt,$t,Ct,kt){var Mt=tickStep(xt,$t,Ct),Ft;switch(kt=formatSpecifier(kt??",f"),kt.type){case"s":{var jt=Math.max(Math.abs(xt),Math.abs($t));return kt.precision==null&&!isNaN(Ft=precisionPrefix(Mt,jt))&&(kt.precision=Ft),formatPrefix(kt,jt)}case"":case"e":case"g":case"p":case"r":{kt.precision==null&&!isNaN(Ft=precisionRound(Mt,Math.max(Math.abs(xt),Math.abs($t))))&&(kt.precision=Ft-(kt.type==="e"));break}case"f":case"%":{kt.precision==null&&!isNaN(Ft=precisionFixed(Mt))&&(kt.precision=Ft-(kt.type==="%")*2);break}}return format$6(kt)}function linearish(xt){var $t=xt.domain;return xt.ticks=function(Ct){var kt=$t();return ticks(kt[0],kt[kt.length-1],Ct??10)},xt.tickFormat=function(Ct,kt){var Mt=$t();return tickFormat$1(Mt[0],Mt[Mt.length-1],Ct??10,kt)},xt.nice=function(Ct){Ct==null&&(Ct=10);var kt=$t(),Mt=0,Ft=kt.length-1,jt=kt[Mt],Bt=kt[Ft],Vt,zt,Ht=10;for(Bt<jt&&(zt=jt,jt=Bt,Bt=zt,zt=Mt,Mt=Ft,Ft=zt);Ht-- >0;){if(zt=tickIncrement(jt,Bt,Ct),zt===Vt)return kt[Mt]=jt,kt[Ft]=Bt,$t(kt);if(zt>0)jt=Math.floor(jt/zt)*zt,Bt=Math.ceil(Bt/zt)*zt;else if(zt<0)jt=Math.ceil(jt*zt)/zt,Bt=Math.floor(Bt*zt)/zt;else break;Vt=zt}return xt},xt}function linear$1(){var xt=continuous$1();return xt.copy=function(){return copy$2(xt,linear$1())},initRange.apply(xt,arguments),linearish(xt)}function identity$3(xt){var $t;function Ct(kt){return kt==null||isNaN(kt=+kt)?$t:kt}return Ct.invert=Ct,Ct.domain=Ct.range=function(kt){return arguments.length?(xt=Array.from(kt,number$5),Ct):xt.slice()},Ct.unknown=function(kt){return arguments.length?($t=kt,Ct):$t},Ct.copy=function(){return identity$3(xt).unknown($t)},xt=arguments.length?Array.from(xt,number$5):[0,1],linearish(Ct)}function nice$1(xt,$t){xt=xt.slice();var Ct=0,kt=xt.length-1,Mt=xt[Ct],Ft=xt[kt],jt;return Ft<Mt&&(jt=Ct,Ct=kt,kt=jt,jt=Mt,Mt=Ft,Ft=jt),xt[Ct]=$t.floor(Mt),xt[kt]=$t.ceil(Ft),xt}function transformLog(xt){return Math.log(xt)}function transformExp(xt){return Math.exp(xt)}function transformLogn(xt){return-Math.log(-xt)}function transformExpn(xt){return-Math.exp(-xt)}function pow10(xt){return isFinite(xt)?+("1e"+xt):xt<0?0:xt}function powp(xt){return xt===10?pow10:xt===Math.E?Math.exp:$t=>Math.pow(xt,$t)}function logp(xt){return xt===Math.E?Math.log:xt===10&&Math.log10||xt===2&&Math.log2||(xt=Math.log(xt),$t=>Math.log($t)/xt)}function reflect(xt){return($t,Ct)=>-xt(-$t,Ct)}function loggish(xt){const $t=xt(transformLog,transformExp),Ct=$t.domain;let kt=10,Mt,Ft;function jt(){return Mt=logp(kt),Ft=powp(kt),Ct()[0]<0?(Mt=reflect(Mt),Ft=reflect(Ft),xt(transformLogn,transformExpn)):xt(transformLog,transformExp),$t}return $t.base=function(Bt){return arguments.length?(kt=+Bt,jt()):kt},$t.domain=function(Bt){return arguments.length?(Ct(Bt),jt()):Ct()},$t.ticks=Bt=>{const Vt=Ct();let zt=Vt[0],Ht=Vt[Vt.length-1];const Gt=Ht<zt;Gt&&([zt,Ht]=[Ht,zt]);let qt=Mt(zt),Wt=Mt(Ht),Yt,Kt;const Xt=Bt==null?10:+Bt;let Qt=[];if(!(kt%1)&&Wt-qt<Xt){if(qt=Math.floor(qt),Wt=Math.ceil(Wt),zt>0){for(;qt<=Wt;++qt)for(Yt=1;Yt<kt;++Yt)if(Kt=qt<0?Yt/Ft(-qt):Yt*Ft(qt),!(Kt<zt)){if(Kt>Ht)break;Qt.push(Kt)}}else for(;qt<=Wt;++qt)for(Yt=kt-1;Yt>=1;--Yt)if(Kt=qt>0?Yt/Ft(-qt):Yt*Ft(qt),!(Kt<zt)){if(Kt>Ht)break;Qt.push(Kt)}Qt.length*2<Xt&&(Qt=ticks(zt,Ht,Xt))}else Qt=ticks(qt,Wt,Math.min(Wt-qt,Xt)).map(Ft);return Gt?Qt.reverse():Qt},$t.tickFormat=(Bt,Vt)=>{if(Bt==null&&(Bt=10),Vt==null&&(Vt=kt===10?"s":","),typeof Vt!="function"&&(!(kt%1)&&(Vt=formatSpecifier(Vt)).precision==null&&(Vt.trim=!0),Vt=format$6(Vt)),Bt===1/0)return Vt;const zt=Math.max(1,kt*Bt/$t.ticks().length);return Ht=>{let Gt=Ht/Ft(Math.round(Mt(Ht)));return Gt*kt<kt-.5&&(Gt*=kt),Gt<=zt?Vt(Ht):""}},$t.nice=()=>Ct(nice$1(Ct(),{floor:Bt=>Ft(Math.floor(Mt(Bt))),ceil:Bt=>Ft(Math.ceil(Mt(Bt)))})),$t}function log$3(){const xt=loggish(transformer$2()).domain([1,10]);return xt.copy=()=>copy$2(xt,log$3()).base(xt.base()),initRange.apply(xt,arguments),xt}function transformSymlog(xt){return function($t){return Math.sign($t)*Math.log1p(Math.abs($t/xt))}}function transformSymexp(xt){return function($t){return Math.sign($t)*Math.expm1(Math.abs($t))*xt}}function symlogish(xt){var $t=1,Ct=xt(transformSymlog($t),transformSymexp($t));return Ct.constant=function(kt){return arguments.length?xt(transformSymlog($t=+kt),transformSymexp($t)):$t},linearish(Ct)}function symlog$1(){var xt=symlogish(transformer$2());return xt.copy=function(){return copy$2(xt,symlog$1()).constant(xt.constant())},initRange.apply(xt,arguments)}function transformPow(xt){return function($t){return $t<0?-Math.pow(-$t,xt):Math.pow($t,xt)}}function transformSqrt(xt){return xt<0?-Math.sqrt(-xt):Math.sqrt(xt)}function transformSquare(xt){return xt<0?-xt*xt:xt*xt}function powish(xt){var $t=xt(identity$4,identity$4),Ct=1;function kt(){return Ct===1?xt(identity$4,identity$4):Ct===.5?xt(transformSqrt,transformSquare):xt(transformPow(Ct),transformPow(1/Ct))}return $t.exponent=function(Mt){return arguments.length?(Ct=+Mt,kt()):Ct},linearish($t)}function pow$2(){var xt=powish(transformer$2());return xt.copy=function(){return copy$2(xt,pow$2()).exponent(xt.exponent())},initRange.apply(xt,arguments),xt}function sqrt$2(){return pow$2.apply(null,arguments).exponent(.5)}function quantile$1(){var xt=[],$t=[],Ct=[],kt;function Mt(){var jt=0,Bt=Math.max(1,$t.length);for(Ct=new Array(Bt-1);++jt<Bt;)Ct[jt-1]=quantileSorted(xt,jt/Bt);return Ft}function Ft(jt){return jt==null||isNaN(jt=+jt)?kt:$t[bisectRight$1(Ct,jt)]}return Ft.invertExtent=function(jt){var Bt=$t.indexOf(jt);return Bt<0?[NaN,NaN]:[Bt>0?Ct[Bt-1]:xt[0],Bt<Ct.length?Ct[Bt]:xt[xt.length-1]]},Ft.domain=function(jt){if(!arguments.length)return xt.slice();xt=[];for(let Bt of jt)Bt!=null&&!isNaN(Bt=+Bt)&&xt.push(Bt);return xt.sort(ascending$4),Mt()},Ft.range=function(jt){return arguments.length?($t=Array.from(jt),Mt()):$t.slice()},Ft.unknown=function(jt){return arguments.length?(kt=jt,Ft):kt},Ft.quantiles=function(){return Ct.slice()},Ft.copy=function(){return quantile$1().domain(xt).range($t).unknown(kt)},initRange.apply(Ft,arguments)}function quantize$1(){var xt=0,$t=1,Ct=1,kt=[.5],Mt=[0,1],Ft;function jt(Vt){return Vt!=null&&Vt<=Vt?Mt[bisectRight$1(kt,Vt,0,Ct)]:Ft}function Bt(){var Vt=-1;for(kt=new Array(Ct);++Vt<Ct;)kt[Vt]=((Vt+1)*$t-(Vt-Ct)*xt)/(Ct+1);return jt}return jt.domain=function(Vt){return arguments.length?([xt,$t]=Vt,xt=+xt,$t=+$t,Bt()):[xt,$t]},jt.range=function(Vt){return arguments.length?(Ct=(Mt=Array.from(Vt)).length-1,Bt()):Mt.slice()},jt.invertExtent=function(Vt){var zt=Mt.indexOf(Vt);return zt<0?[NaN,NaN]:zt<1?[xt,kt[0]]:zt>=Ct?[kt[Ct-1],$t]:[kt[zt-1],kt[zt]]},jt.unknown=function(Vt){return arguments.length&&(Ft=Vt),jt},jt.thresholds=function(){return kt.slice()},jt.copy=function(){return quantize$1().domain([xt,$t]).range(Mt).unknown(Ft)},initRange.apply(linearish(jt),arguments)}function threshold(){var xt=[.5],$t=[0,1],Ct,kt=1;function Mt(Ft){return Ft!=null&&Ft<=Ft?$t[bisectRight$1(xt,Ft,0,kt)]:Ct}return Mt.domain=function(Ft){return arguments.length?(xt=Array.from(Ft),kt=Math.min(xt.length,$t.length-1),Mt):xt.slice()},Mt.range=function(Ft){return arguments.length?($t=Array.from(Ft),kt=Math.min(xt.length,$t.length-1),Mt):$t.slice()},Mt.invertExtent=function(Ft){var jt=$t.indexOf(Ft);return[xt[jt-1],xt[jt]]},Mt.unknown=function(Ft){return arguments.length?(Ct=Ft,Mt):Ct},Mt.copy=function(){return threshold().domain(xt).range($t).unknown(Ct)},initRange.apply(Mt,arguments)}const t0$2=new Date,t1$1=new Date;function timeInterval$1(xt,$t,Ct,kt){function Mt(Ft){return xt(Ft=arguments.length===0?new Date:new Date(+Ft)),Ft}return Mt.floor=Ft=>(xt(Ft=new Date(+Ft)),Ft),Mt.ceil=Ft=>(xt(Ft=new Date(Ft-1)),$t(Ft,1),xt(Ft),Ft),Mt.round=Ft=>{const jt=Mt(Ft),Bt=Mt.ceil(Ft);return Ft-jt<Bt-Ft?jt:Bt},Mt.offset=(Ft,jt)=>($t(Ft=new Date(+Ft),jt==null?1:Math.floor(jt)),Ft),Mt.range=(Ft,jt,Bt)=>{const Vt=[];if(Ft=Mt.ceil(Ft),Bt=Bt==null?1:Math.floor(Bt),!(Ft<jt)||!(Bt>0))return Vt;let zt;do Vt.push(zt=new Date(+Ft)),$t(Ft,Bt),xt(Ft);while(zt<Ft&&Ft<jt);return Vt},Mt.filter=Ft=>timeInterval$1(jt=>{if(jt>=jt)for(;xt(jt),!Ft(jt);)jt.setTime(jt-1)},(jt,Bt)=>{if(jt>=jt)if(Bt<0)for(;++Bt<=0;)for(;$t(jt,-1),!Ft(jt););else for(;--Bt>=0;)for(;$t(jt,1),!Ft(jt););}),Ct&&(Mt.count=(Ft,jt)=>(t0$2.setTime(+Ft),t1$1.setTime(+jt),xt(t0$2),xt(t1$1),Math.floor(Ct(t0$2,t1$1))),Mt.every=Ft=>(Ft=Math.floor(Ft),!isFinite(Ft)||!(Ft>0)?null:Ft>1?Mt.filter(kt?jt=>kt(jt)%Ft===0:jt=>Mt.count(0,jt)%Ft===0):Mt)),Mt}const millisecond=timeInterval$1(()=>{},(xt,$t)=>{xt.setTime(+xt+$t)},(xt,$t)=>$t-xt);millisecond.every=xt=>(xt=Math.floor(xt),!isFinite(xt)||!(xt>0)?null:xt>1?timeInterval$1($t=>{$t.setTime(Math.floor($t/xt)*xt)},($t,Ct)=>{$t.setTime(+$t+Ct*xt)},($t,Ct)=>(Ct-$t)/xt):millisecond);millisecond.range;const durationSecond$1=1e3,durationMinute$1=durationSecond$1*60,durationHour$1=durationMinute$1*60,durationDay$1=durationHour$1*24,durationWeek$1=durationDay$1*7,durationMonth$1=durationDay$1*30,durationYear$1=durationDay$1*365,second=timeInterval$1(xt=>{xt.setTime(xt-xt.getMilliseconds())},(xt,$t)=>{xt.setTime(+xt+$t*durationSecond$1)},(xt,$t)=>($t-xt)/durationSecond$1,xt=>xt.getUTCSeconds());second.range;const timeMinute=timeInterval$1(xt=>{xt.setTime(xt-xt.getMilliseconds()-xt.getSeconds()*durationSecond$1)},(xt,$t)=>{xt.setTime(+xt+$t*durationMinute$1)},(xt,$t)=>($t-xt)/durationMinute$1,xt=>xt.getMinutes());timeMinute.range;const utcMinute=timeInterval$1(xt=>{xt.setUTCSeconds(0,0)},(xt,$t)=>{xt.setTime(+xt+$t*durationMinute$1)},(xt,$t)=>($t-xt)/durationMinute$1,xt=>xt.getUTCMinutes());utcMinute.range;const timeHour=timeInterval$1(xt=>{xt.setTime(xt-xt.getMilliseconds()-xt.getSeconds()*durationSecond$1-xt.getMinutes()*durationMinute$1)},(xt,$t)=>{xt.setTime(+xt+$t*durationHour$1)},(xt,$t)=>($t-xt)/durationHour$1,xt=>xt.getHours());timeHour.range;const utcHour=timeInterval$1(xt=>{xt.setUTCMinutes(0,0,0)},(xt,$t)=>{xt.setTime(+xt+$t*durationHour$1)},(xt,$t)=>($t-xt)/durationHour$1,xt=>xt.getUTCHours());utcHour.range;const timeDay=timeInterval$1(xt=>xt.setHours(0,0,0,0),(xt,$t)=>xt.setDate(xt.getDate()+$t),(xt,$t)=>($t-xt-($t.getTimezoneOffset()-xt.getTimezoneOffset())*durationMinute$1)/durationDay$1,xt=>xt.getDate()-1);timeDay.range;const utcDay=timeInterval$1(xt=>{xt.setUTCHours(0,0,0,0)},(xt,$t)=>{xt.setUTCDate(xt.getUTCDate()+$t)},(xt,$t)=>($t-xt)/durationDay$1,xt=>xt.getUTCDate()-1);utcDay.range;const unixDay=timeInterval$1(xt=>{xt.setUTCHours(0,0,0,0)},(xt,$t)=>{xt.setUTCDate(xt.getUTCDate()+$t)},(xt,$t)=>($t-xt)/durationDay$1,xt=>Math.floor(xt/durationDay$1));unixDay.range;function timeWeekday(xt){return timeInterval$1($t=>{$t.setDate($t.getDate()-($t.getDay()+7-xt)%7),$t.setHours(0,0,0,0)},($t,Ct)=>{$t.setDate($t.getDate()+Ct*7)},($t,Ct)=>(Ct-$t-(Ct.getTimezoneOffset()-$t.getTimezoneOffset())*durationMinute$1)/durationWeek$1)}const timeSunday=timeWeekday(0),timeMonday=timeWeekday(1),timeTuesday=timeWeekday(2),timeWednesday=timeWeekday(3),timeThursday=timeWeekday(4),timeFriday=timeWeekday(5),timeSaturday=timeWeekday(6);timeSunday.range;timeMonday.range;timeTuesday.range;timeWednesday.range;timeThursday.range;timeFriday.range;timeSaturday.range;function utcWeekday(xt){return timeInterval$1($t=>{$t.setUTCDate($t.getUTCDate()-($t.getUTCDay()+7-xt)%7),$t.setUTCHours(0,0,0,0)},($t,Ct)=>{$t.setUTCDate($t.getUTCDate()+Ct*7)},($t,Ct)=>(Ct-$t)/durationWeek$1)}const utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6);utcSunday.range;utcMonday.range;utcTuesday.range;utcWednesday.range;utcThursday.range;utcFriday.range;utcSaturday.range;const timeMonth=timeInterval$1(xt=>{xt.setDate(1),xt.setHours(0,0,0,0)},(xt,$t)=>{xt.setMonth(xt.getMonth()+$t)},(xt,$t)=>$t.getMonth()-xt.getMonth()+($t.getFullYear()-xt.getFullYear())*12,xt=>xt.getMonth());timeMonth.range;const utcMonth=timeInterval$1(xt=>{xt.setUTCDate(1),xt.setUTCHours(0,0,0,0)},(xt,$t)=>{xt.setUTCMonth(xt.getUTCMonth()+$t)},(xt,$t)=>$t.getUTCMonth()-xt.getUTCMonth()+($t.getUTCFullYear()-xt.getUTCFullYear())*12,xt=>xt.getUTCMonth());utcMonth.range;const timeYear=timeInterval$1(xt=>{xt.setMonth(0,1),xt.setHours(0,0,0,0)},(xt,$t)=>{xt.setFullYear(xt.getFullYear()+$t)},(xt,$t)=>$t.getFullYear()-xt.getFullYear(),xt=>xt.getFullYear());timeYear.every=xt=>!isFinite(xt=Math.floor(xt))||!(xt>0)?null:timeInterval$1($t=>{$t.setFullYear(Math.floor($t.getFullYear()/xt)*xt),$t.setMonth(0,1),$t.setHours(0,0,0,0)},($t,Ct)=>{$t.setFullYear($t.getFullYear()+Ct*xt)});timeYear.range;const utcYear=timeInterval$1(xt=>{xt.setUTCMonth(0,1),xt.setUTCHours(0,0,0,0)},(xt,$t)=>{xt.setUTCFullYear(xt.getUTCFullYear()+$t)},(xt,$t)=>$t.getUTCFullYear()-xt.getUTCFullYear(),xt=>xt.getUTCFullYear());utcYear.every=xt=>!isFinite(xt=Math.floor(xt))||!(xt>0)?null:timeInterval$1($t=>{$t.setUTCFullYear(Math.floor($t.getUTCFullYear()/xt)*xt),$t.setUTCMonth(0,1),$t.setUTCHours(0,0,0,0)},($t,Ct)=>{$t.setUTCFullYear($t.getUTCFullYear()+Ct*xt)});utcYear.range;function ticker(xt,$t,Ct,kt,Mt,Ft){const jt=[[second,1,durationSecond$1],[second,5,5*durationSecond$1],[second,15,15*durationSecond$1],[second,30,30*durationSecond$1],[Ft,1,durationMinute$1],[Ft,5,5*durationMinute$1],[Ft,15,15*durationMinute$1],[Ft,30,30*durationMinute$1],[Mt,1,durationHour$1],[Mt,3,3*durationHour$1],[Mt,6,6*durationHour$1],[Mt,12,12*durationHour$1],[kt,1,durationDay$1],[kt,2,2*durationDay$1],[Ct,1,durationWeek$1],[$t,1,durationMonth$1],[$t,3,3*durationMonth$1],[xt,1,durationYear$1]];function Bt(zt,Ht,Gt){const qt=Ht<zt;qt&&([zt,Ht]=[Ht,zt]);const Wt=Gt&&typeof Gt.range=="function"?Gt:Vt(zt,Ht,Gt),Yt=Wt?Wt.range(zt,+Ht+1):[];return qt?Yt.reverse():Yt}function Vt(zt,Ht,Gt){const qt=Math.abs(Ht-zt)/Gt,Wt=bisector$1(([,,Xt])=>Xt).right(jt,qt);if(Wt===jt.length)return xt.every(tickStep(zt/durationYear$1,Ht/durationYear$1,Gt));if(Wt===0)return millisecond.every(Math.max(tickStep(zt,Ht,Gt),1));const[Yt,Kt]=jt[qt/jt[Wt-1][2]<jt[Wt][2]/qt?Wt-1:Wt];return Yt.every(Kt)}return[Bt,Vt]}const[utcTicks,utcTickInterval]=ticker(utcYear,utcMonth,utcSunday,unixDay,utcHour,utcMinute),[timeTicks,timeTickInterval]=ticker(timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute);function localDate$1(xt){if(0<=xt.y&&xt.y<100){var $t=new Date(-1,xt.m,xt.d,xt.H,xt.M,xt.S,xt.L);return $t.setFullYear(xt.y),$t}return new Date(xt.y,xt.m,xt.d,xt.H,xt.M,xt.S,xt.L)}function utcDate$1(xt){if(0<=xt.y&&xt.y<100){var $t=new Date(Date.UTC(-1,xt.m,xt.d,xt.H,xt.M,xt.S,xt.L));return $t.setUTCFullYear(xt.y),$t}return new Date(Date.UTC(xt.y,xt.m,xt.d,xt.H,xt.M,xt.S,xt.L))}function newDate(xt,$t,Ct){return{y:xt,m:$t,d:Ct,H:0,M:0,S:0,L:0}}function formatLocale(xt){var $t=xt.dateTime,Ct=xt.date,kt=xt.time,Mt=xt.periods,Ft=xt.days,jt=xt.shortDays,Bt=xt.months,Vt=xt.shortMonths,zt=formatRe(Mt),Ht=formatLookup(Mt),Gt=formatRe(Ft),qt=formatLookup(Ft),Wt=formatRe(jt),Yt=formatLookup(jt),Kt=formatRe(Bt),Xt=formatLookup(Bt),Qt=formatRe(Vt),Jt=formatLookup(Vt),Zt={a:wn,A:Rn,b:Dn,B:An,c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,g:formatYearISO,G:formatFullYearISO,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:Sn,q:vn,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear$1,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},sn={a:_n,A:Tn,b:Pn,B:Ln,c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,g:formatUTCYearISO,G:formatUTCFullYearISO,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:Vn,q:Un,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},ln={a:yn,A:gn,b:En,B:bn,c:xn,d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,g:parseYear,G:parseFullYear,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:pn,q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:Cn,X:$n,y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};Zt.x=dn(Ct,Zt),Zt.X=dn(kt,Zt),Zt.c=dn($t,Zt),sn.x=dn(Ct,sn),sn.X=dn(kt,sn),sn.c=dn($t,sn);function dn(Wn,rr){return function(ar){var nr=[],mr=-1,kn=0,Fn=Wn.length,Hn,Bn,jn;for(ar instanceof Date||(ar=new Date(+ar));++mr<Fn;)Wn.charCodeAt(mr)===37&&(nr.push(Wn.slice(kn,mr)),(Bn=pads[Hn=Wn.charAt(++mr)])!=null?Hn=Wn.charAt(++mr):Bn=Hn==="e"?" ":"0",(jn=rr[Hn])&&(Hn=jn(ar,Bn)),nr.push(Hn),kn=mr+1);return nr.push(Wn.slice(kn,mr)),nr.join("")}}function hn(Wn,rr){return function(ar){var nr=newDate(1900,void 0,1),mr=cn(nr,Wn,ar+="",0),kn,Fn;if(mr!=ar.length)return null;if("Q"in nr)return new Date(nr.Q);if("s"in nr)return new Date(nr.s*1e3+("L"in nr?nr.L:0));if(rr&&!("Z"in nr)&&(nr.Z=0),"p"in nr&&(nr.H=nr.H%12+nr.p*12),nr.m===void 0&&(nr.m="q"in nr?nr.q:0),"V"in nr){if(nr.V<1||nr.V>53)return null;"w"in nr||(nr.w=1),"Z"in nr?(kn=utcDate$1(newDate(nr.y,0,1)),Fn=kn.getUTCDay(),kn=Fn>4||Fn===0?utcMonday.ceil(kn):utcMonday(kn),kn=utcDay.offset(kn,(nr.V-1)*7),nr.y=kn.getUTCFullYear(),nr.m=kn.getUTCMonth(),nr.d=kn.getUTCDate()+(nr.w+6)%7):(kn=localDate$1(newDate(nr.y,0,1)),Fn=kn.getDay(),kn=Fn>4||Fn===0?timeMonday.ceil(kn):timeMonday(kn),kn=timeDay.offset(kn,(nr.V-1)*7),nr.y=kn.getFullYear(),nr.m=kn.getMonth(),nr.d=kn.getDate()+(nr.w+6)%7)}else("W"in nr||"U"in nr)&&("w"in nr||(nr.w="u"in nr?nr.u%7:"W"in nr?1:0),Fn="Z"in nr?utcDate$1(newDate(nr.y,0,1)).getUTCDay():localDate$1(newDate(nr.y,0,1)).getDay(),nr.m=0,nr.d="W"in nr?(nr.w+6)%7+nr.W*7-(Fn+5)%7:nr.w+nr.U*7-(Fn+6)%7);return"Z"in nr?(nr.H+=nr.Z/100|0,nr.M+=nr.Z%100,utcDate$1(nr)):localDate$1(nr)}}function cn(Wn,rr,ar,nr){for(var mr=0,kn=rr.length,Fn=ar.length,Hn,Bn;mr<kn;){if(nr>=Fn)return-1;if(Hn=rr.charCodeAt(mr++),Hn===37){if(Hn=rr.charAt(mr++),Bn=ln[Hn in pads?rr.charAt(mr++):Hn],!Bn||(nr=Bn(Wn,ar,nr))<0)return-1}else if(Hn!=ar.charCodeAt(nr++))return-1}return nr}function pn(Wn,rr,ar){var nr=zt.exec(rr.slice(ar));return nr?(Wn.p=Ht.get(nr[0].toLowerCase()),ar+nr[0].length):-1}function yn(Wn,rr,ar){var nr=Wt.exec(rr.slice(ar));return nr?(Wn.w=Yt.get(nr[0].toLowerCase()),ar+nr[0].length):-1}function gn(Wn,rr,ar){var nr=Gt.exec(rr.slice(ar));return nr?(Wn.w=qt.get(nr[0].toLowerCase()),ar+nr[0].length):-1}function En(Wn,rr,ar){var nr=Qt.exec(rr.slice(ar));return nr?(Wn.m=Jt.get(nr[0].toLowerCase()),ar+nr[0].length):-1}function bn(Wn,rr,ar){var nr=Kt.exec(rr.slice(ar));return nr?(Wn.m=Xt.get(nr[0].toLowerCase()),ar+nr[0].length):-1}function xn(Wn,rr,ar){return cn(Wn,$t,rr,ar)}function Cn(Wn,rr,ar){return cn(Wn,Ct,rr,ar)}function $n(Wn,rr,ar){return cn(Wn,kt,rr,ar)}function wn(Wn){return jt[Wn.getDay()]}function Rn(Wn){return Ft[Wn.getDay()]}function Dn(Wn){return Vt[Wn.getMonth()]}function An(Wn){return Bt[Wn.getMonth()]}function Sn(Wn){return Mt[+(Wn.getHours()>=12)]}function vn(Wn){return 1+~~(Wn.getMonth()/3)}function _n(Wn){return jt[Wn.getUTCDay()]}function Tn(Wn){return Ft[Wn.getUTCDay()]}function Pn(Wn){return Vt[Wn.getUTCMonth()]}function Ln(Wn){return Bt[Wn.getUTCMonth()]}function Vn(Wn){return Mt[+(Wn.getUTCHours()>=12)]}function Un(Wn){return 1+~~(Wn.getUTCMonth()/3)}return{format:function(Wn){var rr=dn(Wn+="",Zt);return rr.toString=function(){return Wn},rr},parse:function(Wn){var rr=hn(Wn+="",!1);return rr.toString=function(){return Wn},rr},utcFormat:function(Wn){var rr=dn(Wn+="",sn);return rr.toString=function(){return Wn},rr},utcParse:function(Wn){var rr=hn(Wn+="",!0);return rr.toString=function(){return Wn},rr}}}var pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g;function pad$3(xt,$t,Ct){var kt=xt<0?"-":"",Mt=(kt?-xt:xt)+"",Ft=Mt.length;return kt+(Ft<Ct?new Array(Ct-Ft+1).join($t)+Mt:Mt)}function requote(xt){return xt.replace(requoteRe,"\\$&")}function formatRe(xt){return new RegExp("^(?:"+xt.map(requote).join("|")+")","i")}function formatLookup(xt){return new Map(xt.map(($t,Ct)=>[$t.toLowerCase(),Ct]))}function parseWeekdayNumberSunday(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+1));return kt?(xt.w=+kt[0],Ct+kt[0].length):-1}function parseWeekdayNumberMonday(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+1));return kt?(xt.u=+kt[0],Ct+kt[0].length):-1}function parseWeekNumberSunday(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+2));return kt?(xt.U=+kt[0],Ct+kt[0].length):-1}function parseWeekNumberISO(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+2));return kt?(xt.V=+kt[0],Ct+kt[0].length):-1}function parseWeekNumberMonday(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+2));return kt?(xt.W=+kt[0],Ct+kt[0].length):-1}function parseFullYear(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+4));return kt?(xt.y=+kt[0],Ct+kt[0].length):-1}function parseYear(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+2));return kt?(xt.y=+kt[0]+(+kt[0]>68?1900:2e3),Ct+kt[0].length):-1}function parseZone(xt,$t,Ct){var kt=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec($t.slice(Ct,Ct+6));return kt?(xt.Z=kt[1]?0:-(kt[2]+(kt[3]||"00")),Ct+kt[0].length):-1}function parseQuarter(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+1));return kt?(xt.q=kt[0]*3-3,Ct+kt[0].length):-1}function parseMonthNumber(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+2));return kt?(xt.m=kt[0]-1,Ct+kt[0].length):-1}function parseDayOfMonth(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+2));return kt?(xt.d=+kt[0],Ct+kt[0].length):-1}function parseDayOfYear(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+3));return kt?(xt.m=0,xt.d=+kt[0],Ct+kt[0].length):-1}function parseHour24(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+2));return kt?(xt.H=+kt[0],Ct+kt[0].length):-1}function parseMinutes(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+2));return kt?(xt.M=+kt[0],Ct+kt[0].length):-1}function parseSeconds(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+2));return kt?(xt.S=+kt[0],Ct+kt[0].length):-1}function parseMilliseconds(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+3));return kt?(xt.L=+kt[0],Ct+kt[0].length):-1}function parseMicroseconds(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct,Ct+6));return kt?(xt.L=Math.floor(kt[0]/1e3),Ct+kt[0].length):-1}function parseLiteralPercent(xt,$t,Ct){var kt=percentRe.exec($t.slice(Ct,Ct+1));return kt?Ct+kt[0].length:-1}function parseUnixTimestamp(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct));return kt?(xt.Q=+kt[0],Ct+kt[0].length):-1}function parseUnixTimestampSeconds(xt,$t,Ct){var kt=numberRe.exec($t.slice(Ct));return kt?(xt.s=+kt[0],Ct+kt[0].length):-1}function formatDayOfMonth(xt,$t){return pad$3(xt.getDate(),$t,2)}function formatHour24(xt,$t){return pad$3(xt.getHours(),$t,2)}function formatHour12(xt,$t){return pad$3(xt.getHours()%12||12,$t,2)}function formatDayOfYear(xt,$t){return pad$3(1+timeDay.count(timeYear(xt),xt),$t,3)}function formatMilliseconds(xt,$t){return pad$3(xt.getMilliseconds(),$t,3)}function formatMicroseconds(xt,$t){return formatMilliseconds(xt,$t)+"000"}function formatMonthNumber(xt,$t){return pad$3(xt.getMonth()+1,$t,2)}function formatMinutes(xt,$t){return pad$3(xt.getMinutes(),$t,2)}function formatSeconds(xt,$t){return pad$3(xt.getSeconds(),$t,2)}function formatWeekdayNumberMonday(xt){var $t=xt.getDay();return $t===0?7:$t}function formatWeekNumberSunday(xt,$t){return pad$3(timeSunday.count(timeYear(xt)-1,xt),$t,2)}function dISO(xt){var $t=xt.getDay();return $t>=4||$t===0?timeThursday(xt):timeThursday.ceil(xt)}function formatWeekNumberISO(xt,$t){return xt=dISO(xt),pad$3(timeThursday.count(timeYear(xt),xt)+(timeYear(xt).getDay()===4),$t,2)}function formatWeekdayNumberSunday(xt){return xt.getDay()}function formatWeekNumberMonday(xt,$t){return pad$3(timeMonday.count(timeYear(xt)-1,xt),$t,2)}function formatYear$1(xt,$t){return pad$3(xt.getFullYear()%100,$t,2)}function formatYearISO(xt,$t){return xt=dISO(xt),pad$3(xt.getFullYear()%100,$t,2)}function formatFullYear(xt,$t){return pad$3(xt.getFullYear()%1e4,$t,4)}function formatFullYearISO(xt,$t){var Ct=xt.getDay();return xt=Ct>=4||Ct===0?timeThursday(xt):timeThursday.ceil(xt),pad$3(xt.getFullYear()%1e4,$t,4)}function formatZone(xt){var $t=xt.getTimezoneOffset();return($t>0?"-":($t*=-1,"+"))+pad$3($t/60|0,"0",2)+pad$3($t%60,"0",2)}function formatUTCDayOfMonth(xt,$t){return pad$3(xt.getUTCDate(),$t,2)}function formatUTCHour24(xt,$t){return pad$3(xt.getUTCHours(),$t,2)}function formatUTCHour12(xt,$t){return pad$3(xt.getUTCHours()%12||12,$t,2)}function formatUTCDayOfYear(xt,$t){return pad$3(1+utcDay.count(utcYear(xt),xt),$t,3)}function formatUTCMilliseconds(xt,$t){return pad$3(xt.getUTCMilliseconds(),$t,3)}function formatUTCMicroseconds(xt,$t){return formatUTCMilliseconds(xt,$t)+"000"}function formatUTCMonthNumber(xt,$t){return pad$3(xt.getUTCMonth()+1,$t,2)}function formatUTCMinutes(xt,$t){return pad$3(xt.getUTCMinutes(),$t,2)}function formatUTCSeconds(xt,$t){return pad$3(xt.getUTCSeconds(),$t,2)}function formatUTCWeekdayNumberMonday(xt){var $t=xt.getUTCDay();return $t===0?7:$t}function formatUTCWeekNumberSunday(xt,$t){return pad$3(utcSunday.count(utcYear(xt)-1,xt),$t,2)}function UTCdISO(xt){var $t=xt.getUTCDay();return $t>=4||$t===0?utcThursday(xt):utcThursday.ceil(xt)}function formatUTCWeekNumberISO(xt,$t){return xt=UTCdISO(xt),pad$3(utcThursday.count(utcYear(xt),xt)+(utcYear(xt).getUTCDay()===4),$t,2)}function formatUTCWeekdayNumberSunday(xt){return xt.getUTCDay()}function formatUTCWeekNumberMonday(xt,$t){return pad$3(utcMonday.count(utcYear(xt)-1,xt),$t,2)}function formatUTCYear(xt,$t){return pad$3(xt.getUTCFullYear()%100,$t,2)}function formatUTCYearISO(xt,$t){return xt=UTCdISO(xt),pad$3(xt.getUTCFullYear()%100,$t,2)}function formatUTCFullYear(xt,$t){return pad$3(xt.getUTCFullYear()%1e4,$t,4)}function formatUTCFullYearISO(xt,$t){var Ct=xt.getUTCDay();return xt=Ct>=4||Ct===0?utcThursday(xt):utcThursday.ceil(xt),pad$3(xt.getUTCFullYear()%1e4,$t,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(xt){return+xt}function formatUnixTimestampSeconds(xt){return Math.floor(+xt/1e3)}var locale$1,timeFormat$2,timeParse$1,utcFormat$1,utcParse$1;defaultLocale$1({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function defaultLocale$1(xt){return locale$1=formatLocale(xt),timeFormat$2=locale$1.format,timeParse$1=locale$1.parse,utcFormat$1=locale$1.utcFormat,utcParse$1=locale$1.utcParse,locale$1}function date$2(xt){return new Date(xt)}function number$4(xt){return xt instanceof Date?+xt:+new Date(+xt)}function calendar(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt,zt){var Ht=continuous$1(),Gt=Ht.invert,qt=Ht.domain,Wt=zt(".%L"),Yt=zt(":%S"),Kt=zt("%I:%M"),Xt=zt("%I %p"),Qt=zt("%a %d"),Jt=zt("%b %d"),Zt=zt("%B"),sn=zt("%Y");function ln(dn){return(Vt(dn)<dn?Wt:Bt(dn)<dn?Yt:jt(dn)<dn?Kt:Ft(dn)<dn?Xt:kt(dn)<dn?Mt(dn)<dn?Qt:Jt:Ct(dn)<dn?Zt:sn)(dn)}return Ht.invert=function(dn){return new Date(Gt(dn))},Ht.domain=function(dn){return arguments.length?qt(Array.from(dn,number$4)):qt().map(date$2)},Ht.ticks=function(dn){var hn=qt();return xt(hn[0],hn[hn.length-1],dn??10)},Ht.tickFormat=function(dn,hn){return hn==null?ln:zt(hn)},Ht.nice=function(dn){var hn=qt();return(!dn||typeof dn.range!="function")&&(dn=$t(hn[0],hn[hn.length-1],dn??10)),dn?qt(nice$1(hn,dn)):Ht},Ht.copy=function(){return copy$2(Ht,calendar(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt,zt))},Ht}function time$1(){return initRange.apply(calendar(timeTicks,timeTickInterval,timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute,second,timeFormat$2).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function utcTime(){return initRange.apply(calendar(utcTicks,utcTickInterval,utcYear,utcMonth,utcSunday,utcDay,utcHour,utcMinute,second,utcFormat$1).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function transformer$1(){var xt=0,$t=1,Ct,kt,Mt,Ft,jt=identity$4,Bt=!1,Vt;function zt(Gt){return Gt==null||isNaN(Gt=+Gt)?Vt:jt(Mt===0?.5:(Gt=(Ft(Gt)-Ct)*Mt,Bt?Math.max(0,Math.min(1,Gt)):Gt))}zt.domain=function(Gt){return arguments.length?([xt,$t]=Gt,Ct=Ft(xt=+xt),kt=Ft($t=+$t),Mt=Ct===kt?0:1/(kt-Ct),zt):[xt,$t]},zt.clamp=function(Gt){return arguments.length?(Bt=!!Gt,zt):Bt},zt.interpolator=function(Gt){return arguments.length?(jt=Gt,zt):jt};function Ht(Gt){return function(qt){var Wt,Yt;return arguments.length?([Wt,Yt]=qt,jt=Gt(Wt,Yt),zt):[jt(0),jt(1)]}}return zt.range=Ht(interpolate$1$1),zt.rangeRound=Ht(interpolateRound),zt.unknown=function(Gt){return arguments.length?(Vt=Gt,zt):Vt},function(Gt){return Ft=Gt,Ct=Gt(xt),kt=Gt($t),Mt=Ct===kt?0:1/(kt-Ct),zt}}function copy$1(xt,$t){return $t.domain(xt.domain()).interpolator(xt.interpolator()).clamp(xt.clamp()).unknown(xt.unknown())}function sequential(){var xt=linearish(transformer$1()(identity$4));return xt.copy=function(){return copy$1(xt,sequential())},initInterpolator.apply(xt,arguments)}function sequentialLog(){var xt=loggish(transformer$1()).domain([1,10]);return xt.copy=function(){return copy$1(xt,sequentialLog()).base(xt.base())},initInterpolator.apply(xt,arguments)}function sequentialSymlog(){var xt=symlogish(transformer$1());return xt.copy=function(){return copy$1(xt,sequentialSymlog()).constant(xt.constant())},initInterpolator.apply(xt,arguments)}function sequentialPow(){var xt=powish(transformer$1());return xt.copy=function(){return copy$1(xt,sequentialPow()).exponent(xt.exponent())},initInterpolator.apply(xt,arguments)}function sequentialSqrt(){return sequentialPow.apply(null,arguments).exponent(.5)}function transformer(){var xt=0,$t=.5,Ct=1,kt=1,Mt,Ft,jt,Bt,Vt,zt=identity$4,Ht,Gt=!1,qt;function Wt(Kt){return isNaN(Kt=+Kt)?qt:(Kt=.5+((Kt=+Ht(Kt))-Ft)*(kt*Kt<kt*Ft?Bt:Vt),zt(Gt?Math.max(0,Math.min(1,Kt)):Kt))}Wt.domain=function(Kt){return arguments.length?([xt,$t,Ct]=Kt,Mt=Ht(xt=+xt),Ft=Ht($t=+$t),jt=Ht(Ct=+Ct),Bt=Mt===Ft?0:.5/(Ft-Mt),Vt=Ft===jt?0:.5/(jt-Ft),kt=Ft<Mt?-1:1,Wt):[xt,$t,Ct]},Wt.clamp=function(Kt){return arguments.length?(Gt=!!Kt,Wt):Gt},Wt.interpolator=function(Kt){return arguments.length?(zt=Kt,Wt):zt};function Yt(Kt){return function(Xt){var Qt,Jt,Zt;return arguments.length?([Qt,Jt,Zt]=Xt,zt=piecewise(Kt,[Qt,Jt,Zt]),Wt):[zt(0),zt(.5),zt(1)]}}return Wt.range=Yt(interpolate$1$1),Wt.rangeRound=Yt(interpolateRound),Wt.unknown=function(Kt){return arguments.length?(qt=Kt,Wt):qt},function(Kt){return Ht=Kt,Mt=Kt(xt),Ft=Kt($t),jt=Kt(Ct),Bt=Mt===Ft?0:.5/(Ft-Mt),Vt=Ft===jt?0:.5/(jt-Ft),kt=Ft<Mt?-1:1,Wt}}function diverging(){var xt=linearish(transformer()(identity$4));return xt.copy=function(){return copy$1(xt,diverging())},initInterpolator.apply(xt,arguments)}function divergingLog(){var xt=loggish(transformer()).domain([.1,1,10]);return xt.copy=function(){return copy$1(xt,divergingLog()).base(xt.base())},initInterpolator.apply(xt,arguments)}function divergingSymlog(){var xt=symlogish(transformer());return xt.copy=function(){return copy$1(xt,divergingSymlog()).constant(xt.constant())},initInterpolator.apply(xt,arguments)}function divergingPow(){var xt=powish(transformer());return xt.copy=function(){return copy$1(xt,divergingPow()).exponent(xt.exponent())},initInterpolator.apply(xt,arguments)}function divergingSqrt(){return divergingPow.apply(null,arguments).exponent(.5)}function colors$1(xt){for(var $t=xt.length/6|0,Ct=new Array($t),kt=0;kt<$t;)Ct[kt]="#"+xt.slice(kt*6,++kt*6);return Ct}const schemeCategory10=colors$1("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),schemeAccent=colors$1("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),schemeDark2=colors$1("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),schemeObservable10=colors$1("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),schemePaired=colors$1("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),schemePastel1=colors$1("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),schemePastel2=colors$1("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),schemeSet1=colors$1("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),schemeSet2=colors$1("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),schemeSet3=colors$1("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),Tableau10=colors$1("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function constant$2(xt){return function(){return xt}}const abs$1=Math.abs,atan2=Math.atan2,cos$1=Math.cos,max$2=Math.max,min$2=Math.min,sin$1=Math.sin,sqrt$1=Math.sqrt,epsilon$2=1e-12,pi$1=Math.PI,halfPi$1=pi$1/2,tau=2*pi$1;function acos(xt){return xt>1?0:xt<-1?pi$1:Math.acos(xt)}function asin$1(xt){return xt>=1?halfPi$1:xt<=-1?-halfPi$1:Math.asin(xt)}function withPath(xt){let $t=3;return xt.digits=function(Ct){if(!arguments.length)return $t;if(Ct==null)$t=null;else{const kt=Math.floor(Ct);if(!(kt>=0))throw new RangeError(`invalid digits: ${Ct}`);$t=kt}return xt},()=>new Path$1($t)}function arcInnerRadius(xt){return xt.innerRadius}function arcOuterRadius(xt){return xt.outerRadius}function arcStartAngle(xt){return xt.startAngle}function arcEndAngle(xt){return xt.endAngle}function arcPadAngle(xt){return xt&&xt.padAngle}function intersect$4(xt,$t,Ct,kt,Mt,Ft,jt,Bt){var Vt=Ct-xt,zt=kt-$t,Ht=jt-Mt,Gt=Bt-Ft,qt=Gt*Vt-Ht*zt;if(!(qt*qt<epsilon$2))return qt=(Ht*($t-Ft)-Gt*(xt-Mt))/qt,[xt+qt*Vt,$t+qt*zt]}function cornerTangents(xt,$t,Ct,kt,Mt,Ft,jt){var Bt=xt-Ct,Vt=$t-kt,zt=(jt?Ft:-Ft)/sqrt$1(Bt*Bt+Vt*Vt),Ht=zt*Vt,Gt=-zt*Bt,qt=xt+Ht,Wt=$t+Gt,Yt=Ct+Ht,Kt=kt+Gt,Xt=(qt+Yt)/2,Qt=(Wt+Kt)/2,Jt=Yt-qt,Zt=Kt-Wt,sn=Jt*Jt+Zt*Zt,ln=Mt-Ft,dn=qt*Kt-Yt*Wt,hn=(Zt<0?-1:1)*sqrt$1(max$2(0,ln*ln*sn-dn*dn)),cn=(dn*Zt-Jt*hn)/sn,pn=(-dn*Jt-Zt*hn)/sn,yn=(dn*Zt+Jt*hn)/sn,gn=(-dn*Jt+Zt*hn)/sn,En=cn-Xt,bn=pn-Qt,xn=yn-Xt,Cn=gn-Qt;return En*En+bn*bn>xn*xn+Cn*Cn&&(cn=yn,pn=gn),{cx:cn,cy:pn,x01:-Ht,y01:-Gt,x11:cn*(Mt/ln-1),y11:pn*(Mt/ln-1)}}function arc$2$1(){var xt=arcInnerRadius,$t=arcOuterRadius,Ct=constant$2(0),kt=null,Mt=arcStartAngle,Ft=arcEndAngle,jt=arcPadAngle,Bt=null,Vt=withPath(zt);function zt(){var Ht,Gt,qt=+xt.apply(this,arguments),Wt=+$t.apply(this,arguments),Yt=Mt.apply(this,arguments)-halfPi$1,Kt=Ft.apply(this,arguments)-halfPi$1,Xt=abs$1(Kt-Yt),Qt=Kt>Yt;if(Bt||(Bt=Ht=Vt()),Wt<qt&&(Gt=Wt,Wt=qt,qt=Gt),!(Wt>epsilon$2))Bt.moveTo(0,0);else if(Xt>tau-epsilon$2)Bt.moveTo(Wt*cos$1(Yt),Wt*sin$1(Yt)),Bt.arc(0,0,Wt,Yt,Kt,!Qt),qt>epsilon$2&&(Bt.moveTo(qt*cos$1(Kt),qt*sin$1(Kt)),Bt.arc(0,0,qt,Kt,Yt,Qt));else{var Jt=Yt,Zt=Kt,sn=Yt,ln=Kt,dn=Xt,hn=Xt,cn=jt.apply(this,arguments)/2,pn=cn>epsilon$2&&(kt?+kt.apply(this,arguments):sqrt$1(qt*qt+Wt*Wt)),yn=min$2(abs$1(Wt-qt)/2,+Ct.apply(this,arguments)),gn=yn,En=yn,bn,xn;if(pn>epsilon$2){var Cn=asin$1(pn/qt*sin$1(cn)),$n=asin$1(pn/Wt*sin$1(cn));(dn-=Cn*2)>epsilon$2?(Cn*=Qt?1:-1,sn+=Cn,ln-=Cn):(dn=0,sn=ln=(Yt+Kt)/2),(hn-=$n*2)>epsilon$2?($n*=Qt?1:-1,Jt+=$n,Zt-=$n):(hn=0,Jt=Zt=(Yt+Kt)/2)}var wn=Wt*cos$1(Jt),Rn=Wt*sin$1(Jt),Dn=qt*cos$1(ln),An=qt*sin$1(ln);if(yn>epsilon$2){var Sn=Wt*cos$1(Zt),vn=Wt*sin$1(Zt),_n=qt*cos$1(sn),Tn=qt*sin$1(sn),Pn;if(Xt<pi$1)if(Pn=intersect$4(wn,Rn,_n,Tn,Sn,vn,Dn,An)){var Ln=wn-Pn[0],Vn=Rn-Pn[1],Un=Sn-Pn[0],Wn=vn-Pn[1],rr=1/sin$1(acos((Ln*Un+Vn*Wn)/(sqrt$1(Ln*Ln+Vn*Vn)*sqrt$1(Un*Un+Wn*Wn)))/2),ar=sqrt$1(Pn[0]*Pn[0]+Pn[1]*Pn[1]);gn=min$2(yn,(qt-ar)/(rr-1)),En=min$2(yn,(Wt-ar)/(rr+1))}else gn=En=0}hn>epsilon$2?En>epsilon$2?(bn=cornerTangents(_n,Tn,wn,Rn,Wt,En,Qt),xn=cornerTangents(Sn,vn,Dn,An,Wt,En,Qt),Bt.moveTo(bn.cx+bn.x01,bn.cy+bn.y01),En<yn?Bt.arc(bn.cx,bn.cy,En,atan2(bn.y01,bn.x01),atan2(xn.y01,xn.x01),!Qt):(Bt.arc(bn.cx,bn.cy,En,atan2(bn.y01,bn.x01),atan2(bn.y11,bn.x11),!Qt),Bt.arc(0,0,Wt,atan2(bn.cy+bn.y11,bn.cx+bn.x11),atan2(xn.cy+xn.y11,xn.cx+xn.x11),!Qt),Bt.arc(xn.cx,xn.cy,En,atan2(xn.y11,xn.x11),atan2(xn.y01,xn.x01),!Qt))):(Bt.moveTo(wn,Rn),Bt.arc(0,0,Wt,Jt,Zt,!Qt)):Bt.moveTo(wn,Rn),!(qt>epsilon$2)||!(dn>epsilon$2)?Bt.lineTo(Dn,An):gn>epsilon$2?(bn=cornerTangents(Dn,An,Sn,vn,qt,-gn,Qt),xn=cornerTangents(wn,Rn,_n,Tn,qt,-gn,Qt),Bt.lineTo(bn.cx+bn.x01,bn.cy+bn.y01),gn<yn?Bt.arc(bn.cx,bn.cy,gn,atan2(bn.y01,bn.x01),atan2(xn.y01,xn.x01),!Qt):(Bt.arc(bn.cx,bn.cy,gn,atan2(bn.y01,bn.x01),atan2(bn.y11,bn.x11),!Qt),Bt.arc(0,0,qt,atan2(bn.cy+bn.y11,bn.cx+bn.x11),atan2(xn.cy+xn.y11,xn.cx+xn.x11),Qt),Bt.arc(xn.cx,xn.cy,gn,atan2(xn.y11,xn.x11),atan2(xn.y01,xn.x01),!Qt))):Bt.arc(0,0,qt,ln,sn,Qt)}if(Bt.closePath(),Ht)return Bt=null,Ht+""||null}return zt.centroid=function(){var Ht=(+xt.apply(this,arguments)+ +$t.apply(this,arguments))/2,Gt=(+Mt.apply(this,arguments)+ +Ft.apply(this,arguments))/2-pi$1/2;return[cos$1(Gt)*Ht,sin$1(Gt)*Ht]},zt.innerRadius=function(Ht){return arguments.length?(xt=typeof Ht=="function"?Ht:constant$2(+Ht),zt):xt},zt.outerRadius=function(Ht){return arguments.length?($t=typeof Ht=="function"?Ht:constant$2(+Ht),zt):$t},zt.cornerRadius=function(Ht){return arguments.length?(Ct=typeof Ht=="function"?Ht:constant$2(+Ht),zt):Ct},zt.padRadius=function(Ht){return arguments.length?(kt=Ht==null?null:typeof Ht=="function"?Ht:constant$2(+Ht),zt):kt},zt.startAngle=function(Ht){return arguments.length?(Mt=typeof Ht=="function"?Ht:constant$2(+Ht),zt):Mt},zt.endAngle=function(Ht){return arguments.length?(Ft=typeof Ht=="function"?Ht:constant$2(+Ht),zt):Ft},zt.padAngle=function(Ht){return arguments.length?(jt=typeof Ht=="function"?Ht:constant$2(+Ht),zt):jt},zt.context=function(Ht){return arguments.length?(Bt=Ht??null,zt):Bt},zt}function array$6(xt){return typeof xt=="object"&&"length"in xt?xt:Array.from(xt)}function Linear$1(xt){this._context=xt}Linear$1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(xt,$t){switch(xt=+xt,$t=+$t,this._point){case 0:this._point=1,this._line?this._context.lineTo(xt,$t):this._context.moveTo(xt,$t);break;case 1:this._point=2;default:this._context.lineTo(xt,$t);break}}};function curveLinear(xt){return new Linear$1(xt)}function x$3(xt){return xt[0]}function y$3(xt){return xt[1]}function line$2$1(xt,$t){var Ct=constant$2(!0),kt=null,Mt=curveLinear,Ft=null,jt=withPath(Bt);xt=typeof xt=="function"?xt:xt===void 0?x$3:constant$2(xt),$t=typeof $t=="function"?$t:$t===void 0?y$3:constant$2($t);function Bt(Vt){var zt,Ht=(Vt=array$6(Vt)).length,Gt,qt=!1,Wt;for(kt==null&&(Ft=Mt(Wt=jt())),zt=0;zt<=Ht;++zt)!(zt<Ht&&Ct(Gt=Vt[zt],zt,Vt))===qt&&((qt=!qt)?Ft.lineStart():Ft.lineEnd()),qt&&Ft.point(+xt(Gt,zt,Vt),+$t(Gt,zt,Vt));if(Wt)return Ft=null,Wt+""||null}return Bt.x=function(Vt){return arguments.length?(xt=typeof Vt=="function"?Vt:constant$2(+Vt),Bt):xt},Bt.y=function(Vt){return arguments.length?($t=typeof Vt=="function"?Vt:constant$2(+Vt),Bt):$t},Bt.defined=function(Vt){return arguments.length?(Ct=typeof Vt=="function"?Vt:constant$2(!!Vt),Bt):Ct},Bt.curve=function(Vt){return arguments.length?(Mt=Vt,kt!=null&&(Ft=Mt(kt)),Bt):Mt},Bt.context=function(Vt){return arguments.length?(Vt==null?kt=Ft=null:Ft=Mt(kt=Vt),Bt):kt},Bt}function area$2$1(xt,$t,Ct){var kt=null,Mt=constant$2(!0),Ft=null,jt=curveLinear,Bt=null,Vt=withPath(zt);xt=typeof xt=="function"?xt:xt===void 0?x$3:constant$2(+xt),$t=typeof $t=="function"?$t:constant$2($t===void 0?0:+$t),Ct=typeof Ct=="function"?Ct:Ct===void 0?y$3:constant$2(+Ct);function zt(Gt){var qt,Wt,Yt,Kt=(Gt=array$6(Gt)).length,Xt,Qt=!1,Jt,Zt=new Array(Kt),sn=new Array(Kt);for(Ft==null&&(Bt=jt(Jt=Vt())),qt=0;qt<=Kt;++qt){if(!(qt<Kt&&Mt(Xt=Gt[qt],qt,Gt))===Qt)if(Qt=!Qt)Wt=qt,Bt.areaStart(),Bt.lineStart();else{for(Bt.lineEnd(),Bt.lineStart(),Yt=qt-1;Yt>=Wt;--Yt)Bt.point(Zt[Yt],sn[Yt]);Bt.lineEnd(),Bt.areaEnd()}Qt&&(Zt[qt]=+xt(Xt,qt,Gt),sn[qt]=+$t(Xt,qt,Gt),Bt.point(kt?+kt(Xt,qt,Gt):Zt[qt],Ct?+Ct(Xt,qt,Gt):sn[qt]))}if(Jt)return Bt=null,Jt+""||null}function Ht(){return line$2$1().defined(Mt).curve(jt).context(Ft)}return zt.x=function(Gt){return arguments.length?(xt=typeof Gt=="function"?Gt:constant$2(+Gt),kt=null,zt):xt},zt.x0=function(Gt){return arguments.length?(xt=typeof Gt=="function"?Gt:constant$2(+Gt),zt):xt},zt.x1=function(Gt){return arguments.length?(kt=Gt==null?null:typeof Gt=="function"?Gt:constant$2(+Gt),zt):kt},zt.y=function(Gt){return arguments.length?($t=typeof Gt=="function"?Gt:constant$2(+Gt),Ct=null,zt):$t},zt.y0=function(Gt){return arguments.length?($t=typeof Gt=="function"?Gt:constant$2(+Gt),zt):$t},zt.y1=function(Gt){return arguments.length?(Ct=Gt==null?null:typeof Gt=="function"?Gt:constant$2(+Gt),zt):Ct},zt.lineX0=zt.lineY0=function(){return Ht().x(xt).y($t)},zt.lineY1=function(){return Ht().x(xt).y(Ct)},zt.lineX1=function(){return Ht().x(kt).y($t)},zt.defined=function(Gt){return arguments.length?(Mt=typeof Gt=="function"?Gt:constant$2(!!Gt),zt):Mt},zt.curve=function(Gt){return arguments.length?(jt=Gt,Ft!=null&&(Bt=jt(Ft)),zt):jt},zt.context=function(Gt){return arguments.length?(Gt==null?Ft=Bt=null:Bt=jt(Ft=Gt),zt):Ft},zt}function descending$1(xt,$t){return $t<xt?-1:$t>xt?1:$t>=xt?0:NaN}function identity$2(xt){return xt}function pie(){var xt=identity$2,$t=descending$1,Ct=null,kt=constant$2(0),Mt=constant$2(tau),Ft=constant$2(0);function jt(Bt){var Vt,zt=(Bt=array$6(Bt)).length,Ht,Gt,qt=0,Wt=new Array(zt),Yt=new Array(zt),Kt=+kt.apply(this,arguments),Xt=Math.min(tau,Math.max(-tau,Mt.apply(this,arguments)-Kt)),Qt,Jt=Math.min(Math.abs(Xt)/zt,Ft.apply(this,arguments)),Zt=Jt*(Xt<0?-1:1),sn;for(Vt=0;Vt<zt;++Vt)(sn=Yt[Wt[Vt]=Vt]=+xt(Bt[Vt],Vt,Bt))>0&&(qt+=sn);for($t!=null?Wt.sort(function(ln,dn){return $t(Yt[ln],Yt[dn])}):Ct!=null&&Wt.sort(function(ln,dn){return Ct(Bt[ln],Bt[dn])}),Vt=0,Gt=qt?(Xt-zt*Zt)/qt:0;Vt<zt;++Vt,Kt=Qt)Ht=Wt[Vt],sn=Yt[Ht],Qt=Kt+(sn>0?sn*Gt:0)+Zt,Yt[Ht]={data:Bt[Ht],index:Vt,value:sn,startAngle:Kt,endAngle:Qt,padAngle:Jt};return Yt}return jt.value=function(Bt){return arguments.length?(xt=typeof Bt=="function"?Bt:constant$2(+Bt),jt):xt},jt.sortValues=function(Bt){return arguments.length?($t=Bt,Ct=null,jt):$t},jt.sort=function(Bt){return arguments.length?(Ct=Bt,$t=null,jt):Ct},jt.startAngle=function(Bt){return arguments.length?(kt=typeof Bt=="function"?Bt:constant$2(+Bt),jt):kt},jt.endAngle=function(Bt){return arguments.length?(Mt=typeof Bt=="function"?Bt:constant$2(+Bt),jt):Mt},jt.padAngle=function(Bt){return arguments.length?(Ft=typeof Bt=="function"?Bt:constant$2(+Bt),jt):Ft},jt}const circle$1={draw(xt,$t){const Ct=sqrt$1($t/pi$1);xt.moveTo(Ct,0),xt.arc(0,0,Ct,0,tau)}};function Symbol$1(xt,$t){let Ct=null,kt=withPath(Mt);xt=typeof xt=="function"?xt:constant$2(xt||circle$1),$t=typeof $t=="function"?$t:constant$2($t===void 0?64:+$t);function Mt(){let Ft;if(Ct||(Ct=Ft=kt()),xt.apply(this,arguments).draw(Ct,+$t.apply(this,arguments)),Ft)return Ct=null,Ft+""||null}return Mt.type=function(Ft){return arguments.length?(xt=typeof Ft=="function"?Ft:constant$2(Ft),Mt):xt},Mt.size=function(Ft){return arguments.length?($t=typeof Ft=="function"?Ft:constant$2(+Ft),Mt):$t},Mt.context=function(Ft){return arguments.length?(Ct=Ft??null,Mt):Ct},Mt}function noop$5(){}function point$7(xt,$t,Ct){xt._context.bezierCurveTo((2*xt._x0+xt._x1)/3,(2*xt._y0+xt._y1)/3,(xt._x0+2*xt._x1)/3,(xt._y0+2*xt._y1)/3,(xt._x0+4*xt._x1+$t)/6,(xt._y0+4*xt._y1+Ct)/6)}function Basis(xt){this._context=xt}Basis.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:point$7(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(xt,$t){switch(xt=+xt,$t=+$t,this._point){case 0:this._point=1,this._line?this._context.lineTo(xt,$t):this._context.moveTo(xt,$t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:point$7(this,xt,$t);break}this._x0=this._x1,this._x1=xt,this._y0=this._y1,this._y1=$t}};function curveBasis(xt){return new Basis(xt)}function BasisClosed(xt){this._context=xt}BasisClosed.prototype={areaStart:noop$5,areaEnd:noop$5,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(xt,$t){switch(xt=+xt,$t=+$t,this._point){case 0:this._point=1,this._x2=xt,this._y2=$t;break;case 1:this._point=2,this._x3=xt,this._y3=$t;break;case 2:this._point=3,this._x4=xt,this._y4=$t,this._context.moveTo((this._x0+4*this._x1+xt)/6,(this._y0+4*this._y1+$t)/6);break;default:point$7(this,xt,$t);break}this._x0=this._x1,this._x1=xt,this._y0=this._y1,this._y1=$t}};function curveBasisClosed(xt){return new BasisClosed(xt)}function BasisOpen(xt){this._context=xt}BasisOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(xt,$t){switch(xt=+xt,$t=+$t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var Ct=(this._x0+4*this._x1+xt)/6,kt=(this._y0+4*this._y1+$t)/6;this._line?this._context.lineTo(Ct,kt):this._context.moveTo(Ct,kt);break;case 3:this._point=4;default:point$7(this,xt,$t);break}this._x0=this._x1,this._x1=xt,this._y0=this._y1,this._y1=$t}};function curveBasisOpen(xt){return new BasisOpen(xt)}function Bundle(xt,$t){this._basis=new Basis(xt),this._beta=$t}Bundle.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var xt=this._x,$t=this._y,Ct=xt.length-1;if(Ct>0)for(var kt=xt[0],Mt=$t[0],Ft=xt[Ct]-kt,jt=$t[Ct]-Mt,Bt=-1,Vt;++Bt<=Ct;)Vt=Bt/Ct,this._basis.point(this._beta*xt[Bt]+(1-this._beta)*(kt+Vt*Ft),this._beta*$t[Bt]+(1-this._beta)*(Mt+Vt*jt));this._x=this._y=null,this._basis.lineEnd()},point:function(xt,$t){this._x.push(+xt),this._y.push(+$t)}};const curveBundle=function xt($t){function Ct(kt){return $t===1?new Basis(kt):new Bundle(kt,$t)}return Ct.beta=function(kt){return xt(+kt)},Ct}(.85);function point$6(xt,$t,Ct){xt._context.bezierCurveTo(xt._x1+xt._k*(xt._x2-xt._x0),xt._y1+xt._k*(xt._y2-xt._y0),xt._x2+xt._k*(xt._x1-$t),xt._y2+xt._k*(xt._y1-Ct),xt._x2,xt._y2)}function Cardinal(xt,$t){this._context=xt,this._k=(1-$t)/6}Cardinal.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:point$6(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(xt,$t){switch(xt=+xt,$t=+$t,this._point){case 0:this._point=1,this._line?this._context.lineTo(xt,$t):this._context.moveTo(xt,$t);break;case 1:this._point=2,this._x1=xt,this._y1=$t;break;case 2:this._point=3;default:point$6(this,xt,$t);break}this._x0=this._x1,this._x1=this._x2,this._x2=xt,this._y0=this._y1,this._y1=this._y2,this._y2=$t}};const curveCardinal=function xt($t){function Ct(kt){return new Cardinal(kt,$t)}return Ct.tension=function(kt){return xt(+kt)},Ct}(0);function CardinalClosed(xt,$t){this._context=xt,this._k=(1-$t)/6}CardinalClosed.prototype={areaStart:noop$5,areaEnd:noop$5,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(xt,$t){switch(xt=+xt,$t=+$t,this._point){case 0:this._point=1,this._x3=xt,this._y3=$t;break;case 1:this._point=2,this._context.moveTo(this._x4=xt,this._y4=$t);break;case 2:this._point=3,this._x5=xt,this._y5=$t;break;default:point$6(this,xt,$t);break}this._x0=this._x1,this._x1=this._x2,this._x2=xt,this._y0=this._y1,this._y1=this._y2,this._y2=$t}};const curveCardinalClosed=function xt($t){function Ct(kt){return new CardinalClosed(kt,$t)}return Ct.tension=function(kt){return xt(+kt)},Ct}(0);function CardinalOpen(xt,$t){this._context=xt,this._k=(1-$t)/6}CardinalOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(xt,$t){switch(xt=+xt,$t=+$t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point$6(this,xt,$t);break}this._x0=this._x1,this._x1=this._x2,this._x2=xt,this._y0=this._y1,this._y1=this._y2,this._y2=$t}};const curveCardinalOpen=function xt($t){function Ct(kt){return new CardinalOpen(kt,$t)}return Ct.tension=function(kt){return xt(+kt)},Ct}(0);function point$5(xt,$t,Ct){var kt=xt._x1,Mt=xt._y1,Ft=xt._x2,jt=xt._y2;if(xt._l01_a>epsilon$2){var Bt=2*xt._l01_2a+3*xt._l01_a*xt._l12_a+xt._l12_2a,Vt=3*xt._l01_a*(xt._l01_a+xt._l12_a);kt=(kt*Bt-xt._x0*xt._l12_2a+xt._x2*xt._l01_2a)/Vt,Mt=(Mt*Bt-xt._y0*xt._l12_2a+xt._y2*xt._l01_2a)/Vt}if(xt._l23_a>epsilon$2){var zt=2*xt._l23_2a+3*xt._l23_a*xt._l12_a+xt._l12_2a,Ht=3*xt._l23_a*(xt._l23_a+xt._l12_a);Ft=(Ft*zt+xt._x1*xt._l23_2a-$t*xt._l12_2a)/Ht,jt=(jt*zt+xt._y1*xt._l23_2a-Ct*xt._l12_2a)/Ht}xt._context.bezierCurveTo(kt,Mt,Ft,jt,xt._x2,xt._y2)}function CatmullRom(xt,$t){this._context=xt,this._alpha=$t}CatmullRom.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(xt,$t){if(xt=+xt,$t=+$t,this._point){var Ct=this._x2-xt,kt=this._y2-$t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Ct*Ct+kt*kt,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(xt,$t):this._context.moveTo(xt,$t);break;case 1:this._point=2;break;case 2:this._point=3;default:point$5(this,xt,$t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=xt,this._y0=this._y1,this._y1=this._y2,this._y2=$t}};const curveCatmullRom=function xt($t){function Ct(kt){return $t?new CatmullRom(kt,$t):new Cardinal(kt,0)}return Ct.alpha=function(kt){return xt(+kt)},Ct}(.5);function CatmullRomClosed(xt,$t){this._context=xt,this._alpha=$t}CatmullRomClosed.prototype={areaStart:noop$5,areaEnd:noop$5,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(xt,$t){if(xt=+xt,$t=+$t,this._point){var Ct=this._x2-xt,kt=this._y2-$t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Ct*Ct+kt*kt,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=xt,this._y3=$t;break;case 1:this._point=2,this._context.moveTo(this._x4=xt,this._y4=$t);break;case 2:this._point=3,this._x5=xt,this._y5=$t;break;default:point$5(this,xt,$t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=xt,this._y0=this._y1,this._y1=this._y2,this._y2=$t}};const curveCatmullRomClosed=function xt($t){function Ct(kt){return $t?new CatmullRomClosed(kt,$t):new CardinalClosed(kt,0)}return Ct.alpha=function(kt){return xt(+kt)},Ct}(.5);function CatmullRomOpen(xt,$t){this._context=xt,this._alpha=$t}CatmullRomOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(xt,$t){if(xt=+xt,$t=+$t,this._point){var Ct=this._x2-xt,kt=this._y2-$t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Ct*Ct+kt*kt,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point$5(this,xt,$t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=xt,this._y0=this._y1,this._y1=this._y2,this._y2=$t}};const curveCatmullRomOpen=function xt($t){function Ct(kt){return $t?new CatmullRomOpen(kt,$t):new CardinalOpen(kt,0)}return Ct.alpha=function(kt){return xt(+kt)},Ct}(.5);function LinearClosed(xt){this._context=xt}LinearClosed.prototype={areaStart:noop$5,areaEnd:noop$5,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(xt,$t){xt=+xt,$t=+$t,this._point?this._context.lineTo(xt,$t):(this._point=1,this._context.moveTo(xt,$t))}};function curveLinearClosed(xt){return new LinearClosed(xt)}function sign(xt){return xt<0?-1:1}function slope3(xt,$t,Ct){var kt=xt._x1-xt._x0,Mt=$t-xt._x1,Ft=(xt._y1-xt._y0)/(kt||Mt<0&&-0),jt=(Ct-xt._y1)/(Mt||kt<0&&-0),Bt=(Ft*Mt+jt*kt)/(kt+Mt);return(sign(Ft)+sign(jt))*Math.min(Math.abs(Ft),Math.abs(jt),.5*Math.abs(Bt))||0}function slope2(xt,$t){var Ct=xt._x1-xt._x0;return Ct?(3*(xt._y1-xt._y0)/Ct-$t)/2:$t}function point$4(xt,$t,Ct){var kt=xt._x0,Mt=xt._y0,Ft=xt._x1,jt=xt._y1,Bt=(Ft-kt)/3;xt._context.bezierCurveTo(kt+Bt,Mt+Bt*$t,Ft-Bt,jt-Bt*Ct,Ft,jt)}function MonotoneX(xt){this._context=xt}MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point$4(this,this._t0,slope2(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(xt,$t){var Ct=NaN;if(xt=+xt,$t=+$t,!(xt===this._x1&&$t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(xt,$t):this._context.moveTo(xt,$t);break;case 1:this._point=2;break;case 2:this._point=3,point$4(this,slope2(this,Ct=slope3(this,xt,$t)),Ct);break;default:point$4(this,this._t0,Ct=slope3(this,xt,$t));break}this._x0=this._x1,this._x1=xt,this._y0=this._y1,this._y1=$t,this._t0=Ct}}};function MonotoneY(xt){this._context=new ReflectContext(xt)}(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(xt,$t){MonotoneX.prototype.point.call(this,$t,xt)};function ReflectContext(xt){this._context=xt}ReflectContext.prototype={moveTo:function(xt,$t){this._context.moveTo($t,xt)},closePath:function(){this._context.closePath()},lineTo:function(xt,$t){this._context.lineTo($t,xt)},bezierCurveTo:function(xt,$t,Ct,kt,Mt,Ft){this._context.bezierCurveTo($t,xt,kt,Ct,Ft,Mt)}};function monotoneX(xt){return new MonotoneX(xt)}function monotoneY(xt){return new MonotoneY(xt)}function Natural(xt){this._context=xt}Natural.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var xt=this._x,$t=this._y,Ct=xt.length;if(Ct)if(this._line?this._context.lineTo(xt[0],$t[0]):this._context.moveTo(xt[0],$t[0]),Ct===2)this._context.lineTo(xt[1],$t[1]);else for(var kt=controlPoints(xt),Mt=controlPoints($t),Ft=0,jt=1;jt<Ct;++Ft,++jt)this._context.bezierCurveTo(kt[0][Ft],Mt[0][Ft],kt[1][Ft],Mt[1][Ft],xt[jt],$t[jt]);(this._line||this._line!==0&&Ct===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(xt,$t){this._x.push(+xt),this._y.push(+$t)}};function controlPoints(xt){var $t,Ct=xt.length-1,kt,Mt=new Array(Ct),Ft=new Array(Ct),jt=new Array(Ct);for(Mt[0]=0,Ft[0]=2,jt[0]=xt[0]+2*xt[1],$t=1;$t<Ct-1;++$t)Mt[$t]=1,Ft[$t]=4,jt[$t]=4*xt[$t]+2*xt[$t+1];for(Mt[Ct-1]=2,Ft[Ct-1]=7,jt[Ct-1]=8*xt[Ct-1]+xt[Ct],$t=1;$t<Ct;++$t)kt=Mt[$t]/Ft[$t-1],Ft[$t]-=kt,jt[$t]-=kt*jt[$t-1];for(Mt[Ct-1]=jt[Ct-1]/Ft[Ct-1],$t=Ct-2;$t>=0;--$t)Mt[$t]=(jt[$t]-Mt[$t+1])/Ft[$t];for(Ft[Ct-1]=(xt[Ct]+Mt[Ct-1])/2,$t=0;$t<Ct-1;++$t)Ft[$t]=2*xt[$t+1]-Mt[$t+1];return[Mt,Ft]}function curveNatural(xt){return new Natural(xt)}function Step(xt,$t){this._context=xt,this._t=$t}Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(xt,$t){switch(xt=+xt,$t=+$t,this._point){case 0:this._point=1,this._line?this._context.lineTo(xt,$t):this._context.moveTo(xt,$t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,$t),this._context.lineTo(xt,$t);else{var Ct=this._x*(1-this._t)+xt*this._t;this._context.lineTo(Ct,this._y),this._context.lineTo(Ct,$t)}break}}this._x=xt,this._y=$t}};function curveStep(xt){return new Step(xt,.5)}function stepBefore(xt){return new Step(xt,0)}function stepAfter(xt){return new Step(xt,1)}function none$1(xt,$t){if((jt=xt.length)>1)for(var Ct=1,kt,Mt,Ft=xt[$t[0]],jt,Bt=Ft.length;Ct<jt;++Ct)for(Mt=Ft,Ft=xt[$t[Ct]],kt=0;kt<Bt;++kt)Ft[kt][1]+=Ft[kt][0]=isNaN(Mt[kt][1])?Mt[kt][0]:Mt[kt][1]}function none(xt){for(var $t=xt.length,Ct=new Array($t);--$t>=0;)Ct[$t]=$t;return Ct}function stackValue(xt,$t){return xt[$t]}function stackSeries(xt){const $t=[];return $t.key=xt,$t}function stack$1(){var xt=constant$2([]),$t=none,Ct=none$1,kt=stackValue;function Mt(Ft){var jt=Array.from(xt.apply(this,arguments),stackSeries),Bt,Vt=jt.length,zt=-1,Ht;for(const Gt of Ft)for(Bt=0,++zt;Bt<Vt;++Bt)(jt[Bt][zt]=[0,+kt(Gt,jt[Bt].key,zt,Ft)]).data=Gt;for(Bt=0,Ht=array$6($t(jt));Bt<Vt;++Bt)jt[Ht[Bt]].index=Bt;return Ct(jt,Ht),jt}return Mt.keys=function(Ft){return arguments.length?(xt=typeof Ft=="function"?Ft:constant$2(Array.from(Ft)),Mt):xt},Mt.value=function(Ft){return arguments.length?(kt=typeof Ft=="function"?Ft:constant$2(+Ft),Mt):kt},Mt.order=function(Ft){return arguments.length?($t=Ft==null?none:typeof Ft=="function"?Ft:constant$2(Array.from(Ft)),Mt):$t},Mt.offset=function(Ft){return arguments.length?(Ct=Ft??none$1,Mt):Ct},Mt}function Transform$1(xt,$t,Ct){this.k=xt,this.x=$t,this.y=Ct}Transform$1.prototype={constructor:Transform$1,scale:function(xt){return xt===1?this:new Transform$1(this.k*xt,this.x,this.y)},translate:function(xt,$t){return xt===0&$t===0?this:new Transform$1(this.k,this.x+this.k*xt,this.y+this.k*$t)},apply:function(xt){return[xt[0]*this.k+this.x,xt[1]*this.k+this.y]},applyX:function(xt){return xt*this.k+this.x},applyY:function(xt){return xt*this.k+this.y},invert:function(xt){return[(xt[0]-this.x)/this.k,(xt[1]-this.y)/this.k]},invertX:function(xt){return(xt-this.x)/this.k},invertY:function(xt){return(xt-this.y)/this.k},rescaleX:function(xt){return xt.copy().domain(xt.range().map(this.invertX,this).map(xt.invert,xt))},rescaleY:function(xt){return xt.copy().domain(xt.range().map(this.invertY,this).map(xt.invert,xt))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Transform$1.prototype;function XAxisBar({xScale:xt,yRange:$t,vertPosition:Ct,label:kt,ticks:Mt,isDate:Ft=!1,showLines:jt=!0,compact:Bt=!1}){const Vt=reactExports.useMemo(()=>Mt.length>1?Math.abs(Mt[1].offset-Mt[0].offset):xt.range()[0]-xt.range()[1],[Mt,xt]),zt=reactExports.useCallback(Ht=>(Ft?utcFormat$1("%B"):format$6(".2s"))(Ht),[Ft]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("g",{transform:`translate(${xt.range()[0]}, ${Ct+25})`,children:jsxRuntimeExports.jsx("foreignObject",{width:Math.abs(xt.range()[0]-xt.range()[1]),height:20,children:jsxRuntimeExports.jsx(Center$2,{children:jsxRuntimeExports.jsx(Group$1,{gap:3,children:jsxRuntimeExports.jsx(Text,{size:Bt?"10px":"14px",style:{color:"#878E95"},children:kt})})})})}),jsxRuntimeExports.jsx("path",{transform:`translate(0, ${Ct})`,d:["M",xt.range()[0],0,"H",xt.range()[1]].join(" "),fill:"none",stroke:"lightgray"}),jt?jsxRuntimeExports.jsx("path",{transform:`translate(0, ${$t[1]})`,d:["M",xt.range()[0],0,"H",xt.range()[1]].join(" "),fill:"none",stroke:"lightgray"}):null,Mt.map(({value:Ht,offset:Gt})=>jsxRuntimeExports.jsxs("g",{transform:`translate(${Gt}, ${Ct})`,children:[jsxRuntimeExports.jsx("line",{y2:"6",stroke:"currentColor"}),jt?jsxRuntimeExports.jsx("line",{y2:`${-($t[0]-$t[1])}`,stroke:"lightgray"}):null,jsxRuntimeExports.jsx("foreignObject",{x:0-Vt/2,y:10,width:Vt,height:20,children:jsxRuntimeExports.jsx(Center$2,{children:jsxRuntimeExports.jsx(Tooltip,{withinPortal:!0,label:Ht,children:jsxRuntimeExports.jsx(Text,{px:2,size:"10px",style:{textAlign:"center",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:+Ht==0?0:zt(Ft?new Date(Ht):Ht)})})})})]},Ht))]})}const __vite_glob_0_4=Object.freeze(Object.defineProperty({__proto__:null,XAxisBar},Symbol.toStringTag,{value:"Module"}));function YAxisBar({yScale:xt,xRange:$t,horizontalPosition:Ct,label:kt,ticks:Mt,showLines:Ft,compact:jt=!1}){const Bt=reactExports.useMemo(()=>{const Vt=Mt.reduce((zt,{value:Ht})=>{const{length:Gt}=`${Ht}`;return Gt>zt?Gt:zt},0);return Vt>10?60:Vt*6},[Mt]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("g",{transform:`translate(${Ct-Bt-40}, ${xt.range()[1]}) rotate(-90)`,children:jsxRuntimeExports.jsx("foreignObject",{width:Math.abs(xt.range()[1]-xt.range()[0]),height:20,children:jsxRuntimeExports.jsx(Center$2,{children:jsxRuntimeExports.jsx(Group$1,{gap:3,children:jsxRuntimeExports.jsx(Text,{size:jt?"10px":"14px",style:{color:"#878E95"},children:kt})})})})}),jsxRuntimeExports.jsx("path",{transform:`translate(${Ct}, 0)`,d:["M",0,xt.range()[0],"V",xt.range()[1]].join(" "),fill:"none",stroke:"lightgray"}),Ft?jsxRuntimeExports.jsx("path",{transform:`translate(${$t[1]}, 0)`,d:["M",0,xt.range()[0],"V",xt.range()[1]].join(" "),fill:"none",stroke:"lightgray"}):null,Mt.map(({value:Vt,offset:zt})=>jsxRuntimeExports.jsxs("g",{transform:`translate(${Ct}, ${zt})`,children:[jsxRuntimeExports.jsx("line",{x2:"-6",stroke:"currentColor"}),Ft?jsxRuntimeExports.jsx("line",{x2:`${$t[1]-$t[0]}`,stroke:"lightgray"}):null,jsxRuntimeExports.jsx("g",{style:{transform:`translate(-${Bt+10}px, -9px)`},children:jsxRuntimeExports.jsx("foreignObject",{width:Bt,height:20,children:jsxRuntimeExports.jsx(Group$1,{style:{width:"100%",height:"100%"},justify:"right",children:jsxRuntimeExports.jsx(Text,{style:{textOverflow:"ellipsis",overflow:"hidden"},size:"10px",children:Vt})})})},Vt)]},Vt))]})}const __vite_glob_0_6=Object.freeze(Object.defineProperty({__proto__:null,YAxisBar},Symbol.toStringTag,{value:"Module"})),margin$1={top:15,left:100,right:50,bottom:50};function Bar({barsTable:xt,parameters:$t,data:Ct}){const[kt,{height:Mt,width:Ft}]=useResizeObserver$1(),jt=reactExports.useMemo(()=>Ft-margin$1.left-margin$1.right,[Ft]),Bt=reactExports.useMemo(()=>Mt-margin$1.top-margin$1.bottom,[Mt]),Vt=reactExports.useMemo(()=>{const qt=Array.from(new Set(Ct.map(Wt=>Wt[$t.category])));return ordinal(Tableau10).domain(qt)},[Ct,$t.category]),zt=reactExports.useMemo(()=>xt?linear$1([margin$1.left,jt+margin$1.left]).domain([0,max$4(xt.objects().map(qt=>qt.count))]).nice():null,[xt,jt]),Ht=reactExports.useMemo(()=>xt?band$1([margin$1.top,Bt+margin$1.top]).domain(xt.array($t.category).sort()).paddingInner(.1):null,[xt,Bt,$t.category]),Gt=reactExports.useMemo(()=>!zt||!Ht||!Vt||!xt?null:xt.objects().map((qt,Wt)=>qt[$t.category]===null||qt.count===null?null:jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx("rect",{x:margin$1.left,y:Ht(qt[$t.category]),fill:Vt(qt[$t.category]),height:Ht.bandwidth(),width:zt(qt.count)-margin$1.left},Wt),jsxRuntimeExports.jsx("text",{x:zt(qt.count)+5,y:Ht(qt[$t.category])+Ht.bandwidth()/2,style:{textAlign:"center",dominantBaseline:"middle",fontSize:14},children:qt.count})]},Wt)),[xt,Vt,$t.category,zt,Ht]);return Ht&&zt?jsxRuntimeExports.jsxs("svg",{ref:kt,style:{height:"200px",width:"550px",fontFamily:'BlinkMacSystemFont, -apple-system, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", "Helvetica", "Arial", sans-serif'},children:[jsxRuntimeExports.jsx(XAxisBar,{xScale:zt,yRange:Ht.range(),vertPosition:Bt+margin$1.top,showLines:!1,label:"Count",ticks:zt.ticks(5).map(qt=>({value:qt.toString(),offset:zt(qt)}))}),Ht?jsxRuntimeExports.jsx(YAxisBar,{yScale:Ht,horizontalPosition:margin$1.left,xRange:zt.range(),label:$t.category,ticks:Vt.domain().map(qt=>({value:qt,offset:Ht(qt)+Ht.bandwidth()/2}))}):null,Gt]}):jsxRuntimeExports.jsx(Loader,{})}const __vite_glob_0_0=Object.freeze(Object.defineProperty({__proto__:null,Bar,default:Bar},Symbol.toStringTag,{value:"Module"})),isArray$3=Array.isArray;function toArray(xt){return xt!=null?isArray$3(xt)?xt:[xt]:[]}function slice$3(xt=0,$t=1/0){return`${prep(xt)} < row_number() && row_number() <= ${prep($t)}`}function prep(xt){return xt<0?`count() + ${xt}`:xt}class Transformable{constructor($t){$t&&(this._params=$t)}params($t){return arguments.length?($t&&(this._params={...this._params,...$t}),this):this._params}reify($t){return this.__reify(this,$t)}count($t){return this.__count(this,$t)}derive($t,Ct){return this.__derive(this,$t,Ct)}filter($t){return this.__filter(this,$t)}slice($t,Ct){return this.filter(slice$3($t,Ct)).reify()}groupby(...$t){return this.__groupby(this,$t.flat())}orderby(...$t){return this.__orderby(this,$t.flat())}relocate($t,Ct){return this.__relocate(this,toArray($t),Ct)}rename(...$t){return this.__rename(this,$t.flat())}rollup($t){return this.__rollup(this,$t)}sample($t,Ct){return this.__sample(this,$t,Ct)}select(...$t){return this.__select(this,$t.flat())}ungroup(){return this.__ungroup(this)}unorder(){return this.__unorder(this)}dedupe(...$t){return this.__dedupe(this,$t.flat())}impute($t,Ct){return this.__impute(this,$t,Ct)}fold($t,Ct){return this.__fold(this,$t,Ct)}pivot($t,Ct,kt){return this.__pivot(this,$t,Ct,kt)}spread($t,Ct){return this.__spread(this,$t,Ct)}unroll($t,Ct){return this.__unroll(this,$t,Ct)}lookup($t,Ct,...kt){return this.__lookup(this,$t,Ct,kt.flat())}join($t,Ct,kt,Mt){return this.__join(this,$t,Ct,kt,Mt)}join_left($t,Ct,kt,Mt){const Ft={...Mt,left:!0,right:!1};return this.__join(this,$t,Ct,kt,Ft)}join_right($t,Ct,kt,Mt){const Ft={...Mt,left:!1,right:!0};return this.__join(this,$t,Ct,kt,Ft)}join_full($t,Ct,kt,Mt){const Ft={...Mt,left:!0,right:!0};return this.__join(this,$t,Ct,kt,Ft)}cross($t,Ct,kt){return this.__cross(this,$t,Ct,kt)}semijoin($t,Ct){return this.__semijoin(this,$t,Ct)}antijoin($t,Ct){return this.__antijoin(this,$t,Ct)}concat(...$t){return this.__concat(this,$t.flat())}union(...$t){return this.__union(this,$t.flat())}intersect(...$t){return this.__intersect(this,$t.flat())}except(...$t){return this.__except(this,$t.flat())}}function error$k(xt){throw Error(xt)}function isNumber$2(xt){return typeof xt=="number"}function isFunction$3(xt){return typeof xt=="function"}function repeat$1(xt,$t){const Ct=Array(xt);if(isFunction$3($t))for(let kt=0;kt<xt;++kt)Ct[kt]=$t(kt);else Ct.fill($t);return Ct}let Table$1=class extends Transformable{constructor($t,Ct,kt,Mt,Ft,jt,Bt){super(Bt),this._names=Object.freeze($t),this._data=kt,this._total=Ct,this._nrows=Mt?Mt.count():Ct,this._mask=Ct!==this._nrows&&Mt||null,this._group=Ft||null,this._order=jt||null}create($t){error$k("Not implemented")}get[Symbol.toStringTag](){if(!this._names)return"Object";const $t=this.numRows()+" row"+(this.numRows()!==1?"s":"");return`Table: ${this.numCols()+" col"+(this.numCols()!==1?"s":"")} x ${$t}`+(this.isFiltered()?` (${this.totalRows()} backing)`:"")+(this.isGrouped()?`, ${this._group.size} groups`:"")+(this.isOrdered()?", ordered":"")}isFiltered(){return!!this._mask}isGrouped(){return!!this._group}isOrdered(){return!!this._order}data(){return this._data}mask(){return this._mask}groups(){return this._group}comparator(){return this._order}totalRows(){return this._total}numRows(){return this._nrows}get size(){return this._nrows}numCols(){return this._names.length}columnNames($t){return $t?this._names.filter($t):this._names.slice()}columnName($t){return this._names[$t]}columnIndex($t){return this._names.indexOf($t)}columnArray($t,Ct){return this.array($t,Ct)}array($t,Ct){error$k("Not implemented")}*values($t){const Ct=this.getter($t),kt=this.numRows();for(let Mt=0;Mt<kt;++Mt)yield Ct(Mt)}get($t,Ct=0){error$k("Not implemented")}getter($t){error$k("Not implemented")}objects($t){error$k("Not implemented")}object($t){error$k("Not implemented")}[Symbol.iterator](){error$k("Not implemented")}print($t={}){isNumber$2($t)?$t={limit:$t}:$t.limit==null&&($t.limit=10);const Ct=this.objects({...$t,grouped:!1}),kt=`${this[Symbol.toStringTag]}. Showing ${Ct.length} rows.`;return console.log(kt),console.table(Ct),this}indices($t=!0){if(this._index)return this._index;const Ct=this.numRows(),kt=new Uint32Array(Ct),Mt=this.isOrdered(),Ft=this.mask();let jt=-1;if(Ft)for(let Bt=Ft.next(0);Bt>=0;Bt=Ft.next(Bt+1))kt[++jt]=Bt;else for(let Bt=0;Bt<Ct;++Bt)kt[++jt]=Bt;if($t&&Mt){const Bt=this._order,Vt=this._data;kt.sort((zt,Ht)=>Bt(zt,Ht,Vt))}return($t||!Mt)&&(this._index=kt),kt}partitions($t=!0){if(this._partitions)return this._partitions;if(!this.isGrouped())return[this.indices($t)];const{keys:Ct,size:kt}=this._group,Mt=repeat$1(kt,()=>[]),Ft=this._index,jt=this.mask(),Bt=this.numRows();if(Ft&&this.isOrdered())for(let Vt=0,zt;Vt<Bt;++Vt)zt=Ft[Vt],Mt[Ct[zt]].push(zt);else if(jt)for(let Vt=jt.next(0);Vt>=0;Vt=jt.next(Vt+1))Mt[Ct[Vt]].push(Vt);else for(let Vt=0;Vt<Bt;++Vt)Mt[Ct[Vt]].push(Vt);if($t&&!Ft&&this.isOrdered()){const Vt=this._order,zt=this._data;for(let Ht=0;Ht<kt;++Ht)Mt[Ht].sort((Gt,qt)=>Vt(Gt,qt,zt))}return($t||!this.isOrdered())&&(this._partitions=Mt),Mt}scan($t,Ct,kt=1/0,Mt=0){const Ft=this._mask,jt=this._nrows,Bt=this._data;let Vt=Mt||0;if(Vt>jt)return;const zt=Math.min(jt,Vt+kt),Ht=()=>Vt=this._total;if(Ct&&this.isOrdered()||Ft&&this._index){const Gt=this.indices(),qt=this._data;for(;Vt<zt;++Vt)$t(Gt[Vt],qt,Ht)}else if(Ft){let Gt=zt-Vt+1;for(Vt=Ft.nth(Vt);--Gt&&Vt>-1;Vt=Ft.next(Vt+1))$t(Vt,Bt,Ht)}else for(;Vt<zt;++Vt)$t(Vt,Bt,Ht)}slice($t=0,Ct=1/0){if(this.isGrouped())return super.slice($t,Ct);const kt=[],Mt=this.numRows();return $t=Math.max(0,$t+($t<0?Mt:0)),Ct=Math.min(Mt,Math.max(0,Ct+(Ct<0?Mt:0))),this.scan(Ft=>kt.push(Ft),!0,Ct-$t,$t),this.reify(kt)}reduce($t){return this.__reduce(this,$t)}},Column$2=class{constructor($t){this.data=$t}get length(){return this.data.length}get($t){return this.data[$t]}[Symbol.iterator](){return this.data[Symbol.iterator]()}},defaultColumnFactory=function(xt){return xt&&isFunction$3(xt.get)?xt:new Column$2(xt)};function isDate$2(xt){return xt instanceof Date}function isObject$4(xt){return xt===Object(xt)}function isRegExp$1(xt){return xt instanceof RegExp}function isString$2(xt){return typeof xt=="string"}function columnsFrom(xt,$t){const Ct=kt=>error$k(`Illegal argument type: ${kt||typeof xt}`);return xt instanceof Map?fromKeyValuePairs(xt.entries(),$t):isDate$2(xt)?Ct("Date"):isRegExp$1(xt)?Ct("RegExp"):isString$2(xt)?Ct():isArray$3(xt)?fromArray(xt,$t):isFunction$3(xt[Symbol.iterator])?fromIterable$1(xt,$t):isObject$4(xt)?fromKeyValuePairs(Object.entries(xt),$t):Ct()}function fromKeyValuePairs(xt,$t=["key","value"]){const Ct=[],kt=[];for(const[Ft,jt]of xt)Ct.push(Ft),kt.push(jt);const Mt={};return $t[0]&&(Mt[$t[0]]=Ct),$t[1]&&(Mt[$t[1]]=kt),Mt}function fromArray(xt,$t){const Ct=xt.length,kt={},Mt=Ft=>kt[Ft]=Array(Ct);if(Ct){$t=$t||Object.keys(xt[0]);const Ft=$t.map(Mt),jt=Ft.length;for(let Bt=0;Bt<Ct;++Bt){const Vt=xt[Bt];for(let zt=0;zt<jt;++zt)Ft[zt][Bt]=Vt[$t[zt]]}}else $t&&$t.forEach(Mt);return kt}function fromIterable$1(xt,$t){const Ct={},kt=jt=>Ct[jt]=[];let Mt,Ft;for(const jt of xt){Mt||($t=$t||Object.keys(jt),Mt=$t.map(kt),Ft=Mt.length);for(let Bt=0;Bt<Ft;++Bt)Mt[Bt].push(jt[$t[Bt]])}return!Mt&&$t&&$t.forEach(kt),Ct}const{hasOwnProperty:hasOwnProperty$2}=Object.prototype;function has$3(xt,$t){return hasOwnProperty$2.call(xt,$t)}function columnSet(xt){return xt?new ColumnSet({...xt.data()},xt.columnNames()):new ColumnSet}class ColumnSet{constructor($t,Ct){this.data=$t||{},this.names=Ct||[]}add($t,Ct){return this.has($t)||this.names.push($t+""),this.data[$t]=Ct}has($t){return has$3(this.data,$t)}new(){return this.filter=null,this.groups=this.groups||null,this.order=null,this}groupby($t){return this.groups=$t,this}}const NULL$1=void 0,TypedArray=Object.getPrototypeOf(Int8Array);function isTypedArray(xt){return xt instanceof TypedArray}function isArrayType(xt){return isArray$3(xt)||isTypedArray(xt)}function isValid$2(xt){return xt!=null&&xt===xt}const isSeq=xt=>isArrayType(xt)||isString$2(xt),array$5={compact:xt=>isArrayType(xt)?xt.filter($t=>isValid$2($t)):xt,concat:(...xt)=>[].concat(...xt),includes:(xt,$t,Ct)=>isSeq(xt)?xt.includes($t,Ct):!1,indexof:(xt,$t)=>isSeq(xt)?xt.indexOf($t):-1,join:(xt,$t)=>isArrayType(xt)?xt.join($t):NULL$1,lastindexof:(xt,$t)=>isSeq(xt)?xt.lastIndexOf($t):-1,length:xt=>isSeq(xt)?xt.length:0,pluck:(xt,$t)=>isArrayType(xt)?xt.map(Ct=>isValid$2(Ct)?Ct[$t]:NULL$1):NULL$1,reverse:xt=>isArrayType(xt)?xt.slice().reverse():isString$2(xt)?xt.split("").reverse().join(""):NULL$1,slice:(xt,$t,Ct)=>isSeq(xt)?xt.slice($t,Ct):NULL$1};function bin$3(xt,$t,Ct,kt,Mt){return xt==null?null:xt<$t?-1/0:xt>Ct?1/0:(xt=Math.max($t,Math.min(xt,Ct)),$t+kt*Math.floor(1e-14+(xt-$t)/kt+(Mt||0)))}function pad$2(xt,$t,Ct="0"){const kt=xt+"",Mt=kt.length;return Mt<$t?Array($t-Mt+1).join(Ct)+kt:kt}const pad2=xt=>(xt<10?"0":"")+xt,formatYear=xt=>xt<0?"-"+pad$2(-xt,6):xt>9999?"+"+pad$2(xt,6):pad$2(xt,4);function formatISO(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt){const zt=Bt?"Z":"";return formatYear(xt)+"-"+pad2($t+1)+"-"+pad2(Ct)+(!Vt||jt?"T"+pad2(kt)+":"+pad2(Mt)+":"+pad2(Ft)+"."+pad$2(jt,3)+zt:Ft?"T"+pad2(kt)+":"+pad2(Mt)+":"+pad2(Ft)+zt:Mt||kt||!Bt?"T"+pad2(kt)+":"+pad2(Mt)+zt:"")}function formatDate(xt,$t){return isNaN(xt)?"Invalid Date":formatISO(xt.getFullYear(),xt.getMonth(),xt.getDate(),xt.getHours(),xt.getMinutes(),xt.getSeconds(),xt.getMilliseconds(),!1,$t)}function formatUTCDate(xt,$t){return isNaN(xt)?"Invalid Date":formatISO(xt.getUTCFullYear(),xt.getUTCMonth(),xt.getUTCDate(),xt.getUTCHours(),xt.getUTCMinutes(),xt.getUTCSeconds(),xt.getUTCMilliseconds(),!0,$t)}const iso_re=/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function isISODateString(xt){return xt.match(iso_re)&&!isNaN(Date.parse(xt))}function parseIsoDate(xt,$t=Date.parse){return isISODateString(xt)?$t(xt):xt}const msMinute=6e4,msDay=864e5,msWeek=6048e5,t0$1=new Date,t1=new Date,t$2=xt=>(t0$1.setTime(typeof xt=="string"?parseIsoDate(xt):xt),t0$1);function datetime$1(xt,$t,Ct,kt,Mt,Ft,jt){return arguments.length?new Date(xt,$t||0,Ct??1,kt||0,Mt||0,Ft||0,jt||0):new Date(Date.now())}function utcdatetime(xt,$t,Ct,kt,Mt,Ft,jt){return arguments.length?new Date(Date.UTC(xt,$t||0,Ct??1,kt||0,Mt||0,Ft||0,jt||0)):new Date(Date.now())}function dayofyear$1(xt){t1.setTime(+xt),t1.setHours(0,0,0,0),t0$1.setTime(+t1),t0$1.setMonth(0),t0$1.setDate(1);const $t=(t1.getTimezoneOffset()-t0$1.getTimezoneOffset())*msMinute;return Math.floor(1+(t1-t0$1-$t)/msDay)}function utcdayofyear$1(xt){t1.setTime(+xt),t1.setUTCHours(0,0,0,0);const $t=Date.UTC(t1.getUTCFullYear(),0,1);return Math.floor(1+(t1-$t)/msDay)}function week$1(xt,$t){const Ct=$t||0;t1.setTime(+xt),t1.setDate(t1.getDate()-(t1.getDay()+7-Ct)%7),t1.setHours(0,0,0,0),t0$1.setTime(+xt),t0$1.setMonth(0),t0$1.setDate(1),t0$1.setDate(1-(t0$1.getDay()+7-Ct)%7),t0$1.setHours(0,0,0,0);const kt=(t1.getTimezoneOffset()-t0$1.getTimezoneOffset())*msMinute;return Math.floor((1+(t1-t0$1)-kt)/msWeek)}function utcweek$1(xt,$t){const Ct=$t||0;return t1.setTime(+xt),t1.setUTCDate(t1.getUTCDate()-(t1.getUTCDay()+7-Ct)%7),t1.setUTCHours(0,0,0,0),t0$1.setTime(+xt),t0$1.setUTCMonth(0),t0$1.setUTCDate(1),t0$1.setUTCDate(1-(t0$1.getUTCDay()+7-Ct)%7),t0$1.setUTCHours(0,0,0,0),Math.floor((1+(t1-t0$1))/msWeek)}const date$1={format_date:(xt,$t)=>formatDate(t$2(xt),!$t),format_utcdate:(xt,$t)=>formatUTCDate(t$2(xt),!$t),timestamp:xt=>+t$2(xt),year:xt=>t$2(xt).getFullYear(),quarter:xt=>Math.floor(t$2(xt).getMonth()/3),month:xt=>t$2(xt).getMonth(),date:xt=>t$2(xt).getDate(),dayofweek:xt=>t$2(xt).getDay(),hours:xt=>t$2(xt).getHours(),minutes:xt=>t$2(xt).getMinutes(),seconds:xt=>t$2(xt).getSeconds(),milliseconds:xt=>t$2(xt).getMilliseconds(),utcyear:xt=>t$2(xt).getUTCFullYear(),utcquarter:xt=>Math.floor(t$2(xt).getUTCMonth()/3),utcmonth:xt=>t$2(xt).getUTCMonth(),utcdate:xt=>t$2(xt).getUTCDate(),utcdayofweek:xt=>t$2(xt).getUTCDay(),utchours:xt=>t$2(xt).getUTCHours(),utcminutes:xt=>t$2(xt).getUTCMinutes(),utcseconds:xt=>t$2(xt).getUTCSeconds(),utcmilliseconds:xt=>t$2(xt).getUTCMilliseconds(),datetime:datetime$1,dayofyear:dayofyear$1,week:week$1,utcdatetime,utcdayofyear:utcdayofyear$1,utcweek:utcweek$1,now:Date.now};function equal$4(xt,$t){return xt==null||$t==null||xt!==xt||$t!==$t?!1:xt===$t?!0:isDate$2(xt)||isDate$2($t)?+xt==+$t:isRegExp$1(xt)&&isRegExp$1($t)?xt+""==$t+"":isObject$4(xt)&&isObject$4($t)?deepEqual$2(xt,$t):!1}function deepEqual$2(xt,$t){if(Object.getPrototypeOf(xt)!==Object.getPrototypeOf($t))return!1;if(xt.length||$t.length)return arrayEqual(xt,$t);const Ct=Object.keys(xt),kt=Object.keys($t);if(Ct.length!==kt.length||(Ct.sort(),kt.sort(),!arrayEqual(Ct,kt,(Ft,jt)=>Ft===jt)))return!1;const Mt=Ct.length;for(let Ft=0;Ft<Mt;++Ft){const jt=Ct[Ft];if(!equal$4(xt[jt],$t[jt]))return!1}return!0}function arrayEqual(xt,$t,Ct=equal$4){const kt=xt.length;if(kt!==$t.length)return!1;for(let Mt=0;Mt<kt;++Mt)if(!Ct(xt[Mt],$t[Mt]))return!1;return!0}const json$1={parse_json:xt=>JSON.parse(xt),to_json:xt=>JSON.stringify(xt)};let source$2=Math.random;function random$1(){return source$2()}const math$1={random:random$1,is_nan:Number.isNaN,is_finite:Number.isFinite,abs:Math.abs,cbrt:Math.cbrt,ceil:Math.ceil,clz32:Math.clz32,exp:Math.exp,expm1:Math.expm1,floor:Math.floor,fround:Math.fround,greatest:Math.max,least:Math.min,log:Math.log,log10:Math.log10,log1p:Math.log1p,log2:Math.log2,pow:Math.pow,round:Math.round,sign:Math.sign,sqrt:Math.sqrt,trunc:Math.trunc,degrees:xt=>180*xt/Math.PI,radians:xt=>Math.PI*xt/180,acos:Math.acos,acosh:Math.acosh,asin:Math.asin,asinh:Math.asinh,atan:Math.atan,atan2:Math.atan2,atanh:Math.atanh,cos:Math.cos,cosh:Math.cosh,sin:Math.sin,sinh:Math.sinh,tan:Math.tan,tanh:Math.tanh};function isMap(xt){return xt instanceof Map}function isSet(xt){return xt instanceof Set}function isMapOrSet(xt){return isMap(xt)||isSet(xt)}function array$4(xt){return Array.from(xt)}const object$1={has:(xt,$t)=>isMapOrSet(xt)?xt.has($t):xt!=null?has$3(xt,$t):!1,keys:xt=>isMap(xt)?array$4(xt.keys()):xt!=null?Object.keys(xt):[],values:xt=>isMapOrSet(xt)?array$4(xt.values()):xt!=null?Object.values(xt):[],entries:xt=>isMapOrSet(xt)?array$4(xt.entries()):xt!=null?Object.entries(xt):[],object:xt=>xt?Object.fromEntries(xt):NULL$1};function recode(xt,$t,Ct){if($t instanceof Map){if($t.has(xt))return $t.get(xt)}else if(has$3($t,xt))return $t[xt];return Ct!==void 0?Ct:xt}function sequence$2(xt,$t,Ct){let kt=arguments.length;xt=+xt,$t=+$t,Ct=kt<2?($t=xt,xt=0,1):kt<3?1:+Ct,kt=Math.max(0,Math.ceil(($t-xt)/Ct))|0;const Mt=new Array(kt);for(let Ft=0;Ft<kt;++Ft)Mt[Ft]=xt+Ft*Ct;return Mt}const string={parse_date:xt=>xt==null?xt:new Date(xt),parse_float:xt=>xt==null?xt:Number.parseFloat(xt),parse_int:(xt,$t)=>xt==null?xt:Number.parseInt(xt,$t),endswith:(xt,$t,Ct)=>xt==null?!1:String(xt).endsWith($t,Ct),match:(xt,$t,Ct)=>{const kt=xt==null?xt:String(xt).match($t);return Ct==null||kt==null?kt:typeof Ct=="number"?kt[Ct]:kt.groups?kt.groups[Ct]:null},normalize:(xt,$t)=>xt==null?xt:String(xt).normalize($t),padend:(xt,$t,Ct)=>xt==null?xt:String(xt).padEnd($t,Ct),padstart:(xt,$t,Ct)=>xt==null?xt:String(xt).padStart($t,Ct),upper:xt=>xt==null?xt:String(xt).toUpperCase(),lower:xt=>xt==null?xt:String(xt).toLowerCase(),repeat:(xt,$t)=>xt==null?xt:String(xt).repeat($t),replace:(xt,$t,Ct)=>xt==null?xt:String(xt).replace($t,String(Ct)),substring:(xt,$t,Ct)=>xt==null?xt:String(xt).substring($t,Ct),split:(xt,$t,Ct)=>xt==null?[]:String(xt).split($t,Ct),startswith:(xt,$t,Ct)=>xt==null?!1:String(xt).startsWith($t,Ct),trim:xt=>xt==null?xt:String(xt).trim()},functions={bin:bin$3,equal:equal$4,recode,sequence:sequence$2,...array$5,...date$1,...json$1,...math$1,...object$1,...string};function isBigInt(xt){return typeof xt=="bigint"}function toString$2(xt){return xt===void 0?xt+"":isBigInt(xt)?xt+"n":JSON.stringify(xt)}function op(xt,$t=[],Ct=[]){return new Op$1(xt,toArray($t),toArray(Ct))}let Op$1=class{constructor($t,Ct,kt){this.name=$t,this.fields=Ct,this.params=kt}toString(){const $t=[...this.fields.map(Ct=>`d[${toString$2(Ct)}]`),...this.params.map(toString$2)];return`d => op.${this.name}(${$t})`}toObject(){return{expr:this.toString(),func:!0}}};const any=xt=>op("any",xt),count=()=>op("count"),array_agg=xt=>op("array_agg",xt),array_agg_distinct=xt=>op("array_agg_distinct",xt),map_agg=(xt,$t)=>op("map_agg",[xt,$t]),object_agg=(xt,$t)=>op("object_agg",[xt,$t]),entries_agg=(xt,$t)=>op("entries_agg",[xt,$t]);({...functions});function uniqueName(xt,$t){xt=isMapOrSet(xt)?xt:new Set(xt);let Ct=$t,kt=0;for(;xt.has(Ct);)Ct=$t+ ++kt;return Ct}function regroup(xt,$t){if(!xt||!$t)return xt;const{keys:Ct,rows:kt,size:Mt}=xt,Ft=new Int32Array(Mt);$t.scan(Ht=>Ft[Ct[Ht]]=1);const jt=Ft.reduce((Ht,Gt)=>Ht+Gt,0);if(jt===Mt)return xt;const Bt=Array(jt);let Vt=0;for(let Ht=0;Ht<Mt;++Ht)Ft[Ht]&&(Bt[Ft[Ht]=Vt++]=kt[Ht]);const zt=new Uint32Array(Ct.length);return $t.scan(Ht=>zt[Ht]=Ft[Ct[Ht]]),{...xt,keys:zt,rows:Bt,size:Vt}}function reindex(xt,$t,Ct,kt){const{keys:Mt,rows:Ft,size:jt}=xt;let Bt=Ft,Vt=jt,zt=null;if(Ct){zt=new Int32Array(jt),$t(Yt=>zt[Mt[Yt]]=1);const Wt=zt.reduce((Yt,Kt)=>Yt+Kt,0);if(Wt!==jt){Bt=Array(Wt),Vt=0;for(let Yt=0;Yt<jt;++Yt)zt[Yt]&&(Bt[zt[Yt]=Vt++]=Ft[Yt])}}let Ht=-1;const Gt=new Uint32Array(kt);return $t(Vt!==jt?Wt=>Gt[++Ht]=zt[Mt[Wt]]:Wt=>Gt[++Ht]=Mt[Wt]),{...xt,keys:Gt,rows:Bt,size:Vt}}function nest$1(xt,$t,Ct,kt){const Mt=kt==="map"||kt===!0?map_agg:kt==="entries"?entries_agg:kt==="object"?object_agg:error$k('groups option must be "map", "entries", or "object".'),{names:Ft}=xt.groups(),jt=uniqueName(xt.columnNames(),"_");let Bt=xt.select().reify($t).create({data:{[jt]:Ct}}).rollup({[jt]:array_agg(jt)});for(let Vt=Ft.length;--Vt>=0;)Bt=Bt.groupby(Ft.slice(0,Vt)).rollup({[jt]:Mt(Ft[Vt],jt)});return Bt.get(jt)}const ArrayPattern="ArrayPattern",ArrowFunctionExpression="ArrowFunctionExpression",FunctionExpression="FunctionExpression",Identifier$2="Identifier",Literal$1="Literal",MemberExpression$1="MemberExpression",ObjectExpression$1="ObjectExpression",ObjectPattern="ObjectPattern",Property$1="Property",Column$1="Column",Constant="Constant",Dictionary$1="Dictionary",Function$1="Function",Parameter="Parameter",Op="Op",visit$1=(xt,$t)=>{const Ct=visitors$1[xt.type];return Ct?Ct(xt,$t):error$k(`Unsupported expression construct: ${xt.type}`)},binary$1=(xt,$t)=>"("+visit$1(xt.left,$t)+" "+xt.operator+" "+visit$1(xt.right,$t)+")",func$2=(xt,$t)=>"("+list$4(xt.params,$t)+")=>"+visit$1(xt.body,$t),call$1=(xt,$t)=>visit$1(xt.callee,$t)+"("+list$4(xt.arguments,$t)+")",list$4=(xt,$t,Ct=",")=>xt.map(kt=>visit$1(kt,$t)).join(Ct),name$r=xt=>xt.computed?`[${toString$2(xt.name)}]`:`.${xt.name}`,ref$5=(xt,$t,Ct)=>{const kt=xt.table||"";return`data${kt}${name$r(xt)}.${Ct}(${$t.index}${kt})`},visitors$1={Constant:xt=>xt.raw,Column:(xt,$t)=>ref$5(xt,$t,"get"),Dictionary:(xt,$t)=>ref$5(xt,$t,"key"),Function:xt=>`fn.${xt.name}`,Parameter:xt=>`$${name$r(xt)}`,Op:(xt,$t)=>`op(${toString$2(xt.name)},${$t.op||$t.index})`,Literal:xt=>xt.raw,Identifier:xt=>xt.name,TemplateLiteral:(xt,$t)=>{const{quasis:Ct,expressions:kt}=xt,Mt=kt.length;let Ft=Ct[0].value.raw;for(let jt=0;jt<Mt;)Ft+="${"+visit$1(kt[jt],$t)+"}"+Ct[++jt].value.raw;return"`"+Ft+"`"},MemberExpression:(xt,$t)=>{const Ct=!xt.computed,kt=visit$1(xt.object,$t),Mt=visit$1(xt.property,$t);return kt+(Ct?"."+Mt:"["+Mt+"]")},CallExpression:call$1,NewExpression:(xt,$t)=>"new "+call$1(xt,$t),ArrayExpression:(xt,$t)=>"["+list$4(xt.elements,$t)+"]",AssignmentExpression:binary$1,BinaryExpression:binary$1,LogicalExpression:binary$1,UnaryExpression:(xt,$t)=>"("+xt.operator+visit$1(xt.argument,$t)+")",ConditionalExpression:(xt,$t)=>"("+visit$1(xt.test,$t)+"?"+visit$1(xt.consequent,$t)+":"+visit$1(xt.alternate,$t)+")",ObjectExpression:(xt,$t)=>"({"+list$4(xt.properties,$t)+"})",Property:(xt,$t)=>{const Ct=visit$1(xt.key,$t);return(xt.computed?`[${Ct}]`:Ct)+":"+visit$1(xt.value,$t)},ArrowFunctionExpression:func$2,FunctionExpression:func$2,FunctionDeclaration:func$2,ArrayPattern:(xt,$t)=>"["+list$4(xt.elements,$t)+"]",ObjectPattern:(xt,$t)=>"{"+list$4(xt.properties,$t)+"}",VariableDeclaration:(xt,$t)=>xt.kind+" "+list$4(xt.declarations,$t,","),VariableDeclarator:(xt,$t)=>visit$1(xt.id,$t)+"="+visit$1(xt.init,$t),SpreadElement:(xt,$t)=>"..."+visit$1(xt.argument,$t),BlockStatement:(xt,$t)=>"{"+list$4(xt.body,$t,";")+";}",BreakStatement:()=>"break",ExpressionStatement:(xt,$t)=>visit$1(xt.expression,$t),IfStatement:(xt,$t)=>"if ("+visit$1(xt.test,$t)+")"+visit$1(xt.consequent,$t)+(xt.alternate?" else "+visit$1(xt.alternate,$t):""),SwitchStatement:(xt,$t)=>"switch ("+visit$1(xt.discriminant,$t)+") {"+list$4(xt.cases,$t,"")+"}",SwitchCase:(xt,$t)=>(xt.test?"case "+visit$1(xt.test,$t):"default")+": "+list$4(xt.consequent,$t,";")+";",ReturnStatement:(xt,$t)=>"return "+visit$1(xt.argument,$t),Program:(xt,$t)=>visit$1(xt.body[0],$t)};function codegen$2(xt,$t={index:"row"}){return visit$1(xt,$t)}function bins$1(xt,$t,Ct=15,kt=!0,Mt=0,Ft){const Bt=Math.LN10;if(Ft==null){const Vt=Math.ceil(Math.log(Ct)/Bt),zt=$t-xt||Math.abs(xt)||1,Ht=[5,2];for(Ft=Math.max(Mt,Math.pow(10,Math.round(Math.log(zt)/Bt)-Vt));Math.ceil(zt/Ft)>Ct;)Ft*=10;const Gt=Ht.length;for(let qt=0;qt<Gt;++qt){const Wt=Ft/Ht[qt];Wt>=Mt&&zt/Wt<=Ct&&(Ft=Wt)}}if(kt){let Vt=Math.log(Ft);const zt=Vt>=0?0:~~(-Vt/Bt)+1,Ht=Math.pow(10,-zt-1);Vt=Math.floor(xt/Ft+Ht)*Ft,xt=xt<Vt?Vt-Ft:Vt,$t=Math.ceil($t/Ft)*Ft}return[xt,$t===xt?xt+Ft:$t,Ft]}function key$1(xt){const $t=typeof xt;return $t==="string"?`"${xt}"`:$t!=="object"||!xt?xt:isDate$2(xt)?+xt:isArray$3(xt)||isTypedArray(xt)?`[${xt.map(key$1)}]`:isRegExp$1(xt)?xt+"":objectKey(xt)}function objectKey(xt){let $t="{",Ct=-1;for(const kt in xt)++Ct>0&&($t+=","),$t+=`"${kt}":${key$1(xt[kt])}`;return $t+="}",$t}function keyFunction(xt,$t){const Ct=xt.length;return Ct===1?(kt,Mt)=>key$1(xt[0](kt,Mt)):(kt,Mt)=>{let Ft="";for(let jt=0;jt<Ct;++jt){jt>0&&(Ft+="|");const Bt=xt[jt](kt,Mt);if($t&&(Bt==null||Bt!==Bt))return null;Ft+=key$1(Bt)}return Ft}}function distinctMap(){const xt=new Map;return{count(){return xt.size},values(){return Array.from(xt.values(),$t=>$t.v)},increment($t){const Ct=key$1($t),kt=xt.get(Ct);kt?++kt.n:xt.set(Ct,{v:$t,n:1})},decrement($t){const Ct=key$1($t),kt=xt.get(Ct);kt.n===1?xt.delete(Ct):--kt.n},forEach($t){xt.forEach(({v:Ct,n:kt})=>$t(Ct,kt))}}}function noop$4(){}function product(xt,$t=0,Ct=xt.length){let kt=xt[$t++];for(let Mt=$t;Mt<Ct;++Mt)kt*=xt[Mt];return kt}function initOp(xt){return xt.init=xt.init||noop$4,xt.add=xt.add||noop$4,xt.rem=xt.rem||noop$4,xt}function initProduct(xt,$t){return xt.product_v=!1,xt.product=$t}const aggregateFunctions={count:{create:()=>initOp({value:xt=>xt.count}),param:[]},array_agg:{create:()=>initOp({init:xt=>xt.values=!0,value:xt=>xt.list.values(xt.stream)}),param:[1]},object_agg:{create:()=>initOp({init:xt=>xt.values=!0,value:xt=>Object.fromEntries(xt.list.values())}),param:[2]},map_agg:{create:()=>initOp({init:xt=>xt.values=!0,value:xt=>new Map(xt.list.values())}),param:[2]},entries_agg:{create:()=>initOp({init:xt=>xt.values=!0,value:xt=>xt.list.values(xt.stream)}),param:[2]},any:{create:()=>initOp({add:(xt,$t)=>{xt.any==null&&(xt.any=$t)},value:xt=>xt.valid?xt.any:NULL$1}),param:[1]},valid:{create:()=>initOp({value:xt=>xt.valid}),param:[1]},invalid:{create:()=>initOp({value:xt=>xt.count-xt.valid}),param:[1]},distinct:{create:()=>({init:xt=>xt.distinct=distinctMap(),value:xt=>xt.distinct.count()+(xt.valid===xt.count?0:1),add:(xt,$t)=>xt.distinct.increment($t),rem:(xt,$t)=>xt.distinct.decrement($t)}),param:[1]},array_agg_distinct:{create:()=>initOp({value:xt=>xt.distinct.values()}),param:[1],req:["distinct"]},mode:{create:()=>initOp({value:xt=>{let $t=NULL$1,Ct=0;return xt.distinct.forEach((kt,Mt)=>{Mt>Ct&&(Ct=Mt,$t=kt)}),$t}}),param:[1],req:["distinct"]},sum:{create:()=>({init:xt=>xt.sum=0,value:xt=>xt.valid?xt.sum:NULL$1,add:(xt,$t)=>isBigInt($t)?xt.sum===0?xt.sum=$t:xt.sum+=$t:xt.sum+=+$t,rem:(xt,$t)=>xt.sum-=$t}),param:[1]},product:{create:()=>({init:xt=>initProduct(xt,1),value:xt=>xt.valid?xt.product_v?initProduct(xt,product(xt.list.values())):xt.product:void 0,add:(xt,$t)=>isBigInt($t)&&xt.product===1?xt.product=$t:xt.product*=$t,rem:(xt,$t)=>$t==0||$t===1/0||$t===-1/0?xt.product_v=!0:xt.product/=$t}),param:[1],stream:["array_agg"]},mean:{create:()=>({init:xt=>xt.mean=0,value:xt=>xt.valid?xt.mean:NULL$1,add:(xt,$t)=>{xt.mean_d=$t-xt.mean,xt.mean+=xt.mean_d/xt.valid},rem:(xt,$t)=>{xt.mean_d=$t-xt.mean,xt.mean-=xt.valid?xt.mean_d/xt.valid:xt.mean}}),param:[1]},average:{create:()=>initOp({value:xt=>xt.valid?xt.mean:NULL$1}),param:[1],req:["mean"]},variance:{create:()=>({init:xt=>xt.dev=0,value:xt=>xt.valid>1?xt.dev/(xt.valid-1):NULL$1,add:(xt,$t)=>xt.dev+=xt.mean_d*($t-xt.mean),rem:(xt,$t)=>xt.dev-=xt.mean_d*($t-xt.mean)}),param:[1],req:["mean"]},variancep:{create:()=>initOp({value:xt=>xt.valid>1?xt.dev/xt.valid:NULL$1}),param:[1],req:["variance"]},stdev:{create:()=>initOp({value:xt=>xt.valid>1?Math.sqrt(xt.dev/(xt.valid-1)):NULL$1}),param:[1],req:["variance"]},stdevp:{create:()=>initOp({value:xt=>xt.valid>1?Math.sqrt(xt.dev/xt.valid):NULL$1}),param:[1],req:["variance"]},min:{create:()=>({init:xt=>xt.min=NULL$1,value:xt=>xt.min=Number.isNaN(xt.min)?xt.list.min():xt.min,add:(xt,$t)=>{($t<xt.min||xt.min===NULL$1)&&(xt.min=$t)},rem:(xt,$t)=>{$t<=xt.min&&(xt.min=NaN)}}),param:[1],stream:["array_agg"]},max:{create:()=>({init:xt=>xt.max=NULL$1,value:xt=>xt.max=Number.isNaN(xt.max)?xt.list.max():xt.max,add:(xt,$t)=>{($t>xt.max||xt.max===NULL$1)&&(xt.max=$t)},rem:(xt,$t)=>{$t>=xt.max&&(xt.max=NaN)}}),param:[1],stream:["array_agg"]},quantile:{create:xt=>initOp({value:$t=>$t.list.quantile(xt)}),param:[1,1],req:["array_agg"]},median:{create:()=>initOp({value:xt=>xt.list.quantile(.5)}),param:[1],req:["array_agg"]},covariance:{create:()=>({init:xt=>{xt.cov=xt.mean_x=xt.mean_y=xt.dev_x=xt.dev_y=0},value:xt=>xt.valid>1?xt.cov/(xt.valid-1):NULL$1,add:(xt,$t,Ct)=>{const kt=$t-xt.mean_x,Mt=Ct-xt.mean_y;xt.mean_x+=kt/xt.valid,xt.mean_y+=Mt/xt.valid;const Ft=Ct-xt.mean_y;xt.dev_x+=kt*($t-xt.mean_x),xt.dev_y+=Mt*Ft,xt.cov+=kt*Ft},rem:(xt,$t,Ct)=>{const kt=$t-xt.mean_x,Mt=Ct-xt.mean_y;xt.mean_x-=xt.valid?kt/xt.valid:xt.mean_x,xt.mean_y-=xt.valid?Mt/xt.valid:xt.mean_y;const Ft=Ct-xt.mean_y;xt.dev_x-=kt*($t-xt.mean_x),xt.dev_y-=Mt*Ft,xt.cov-=kt*Ft}}),param:[2]},covariancep:{create:()=>initOp({value:xt=>xt.valid>1?xt.cov/xt.valid:NULL$1}),param:[2],req:["covariance"]},corr:{create:()=>initOp({value:xt=>xt.valid>1?xt.cov/(Math.sqrt(xt.dev_x)*Math.sqrt(xt.dev_y)):NULL$1}),param:[2],req:["covariance"]},bins:{create:(xt,$t,Ct,kt)=>initOp({value:Mt=>bins$1(Mt.min,Mt.max,xt,$t,Ct,kt)}),param:[1,4],req:["min","max"]}},rank$1={create(){let xt;return{init:()=>xt=1,value:$t=>{const Ct=$t.index;return Ct&&!$t.peer(Ct)?xt=Ct+1:xt}}},param:[]},cume_dist={create(){let xt;return{init:()=>xt=0,value:$t=>{const{index:Ct,peer:kt,size:Mt}=$t;let Ft=Ct;if(xt<Ft){for(;Ft+1<Mt&&kt(Ft+1);)++Ft;xt=Ft}return(1+xt)/Mt}}},param:[]},windowFunctions={row_number:{create(){return{init:noop$4,value:xt=>xt.index+1}},param:[]},rank:rank$1,avg_rank:{create(){let xt,$t;return{init:()=>(xt=-1,$t=1),value:Ct=>{const kt=Ct.index;if(kt>=xt){for($t=xt=kt+1;Ct.peer(xt);$t+=++xt);$t/=xt-kt}return $t}}},param:[]},dense_rank:{create(){let xt;return{init:()=>xt=1,value:$t=>{const Ct=$t.index;return Ct&&!$t.peer(Ct)?++xt:xt}}},param:[]},percent_rank:{create(){const{init:xt,value:$t}=rank$1.create();return{init:xt,value:Ct=>($t(Ct)-1)/(Ct.size-1)}},param:[]},cume_dist,ntile:{create(xt){xt=+xt,xt>0||error$k("ntile num must be greater than zero.");const{init:$t,value:Ct}=cume_dist.create();return{init:$t,value:kt=>Math.ceil(xt*Ct(kt))}},param:[0,1]},lag:{create(xt,$t=NULL$1){return xt=+xt||1,{init:noop$4,value:(Ct,kt)=>{const Mt=Ct.index-xt;return Mt>=0?Ct.value(Mt,kt):$t}}},param:[1,2]},lead:{create(xt,$t=NULL$1){return xt=+xt||1,{init:noop$4,value:(Ct,kt)=>{const Mt=Ct.index+xt;return Mt<Ct.size?Ct.value(Mt,kt):$t}}},param:[1,2]},first_value:{create(){return{init:noop$4,value:(xt,$t)=>xt.value(xt.i0,$t)}},param:[1]},last_value:{create(){return{init:noop$4,value:(xt,$t)=>xt.value(xt.i1-1,$t)}},param:[1]},nth_value:{create(xt){return xt=+xt,xt>0||error$k("nth_value nth must be greater than zero."),{init:noop$4,value:($t,Ct)=>{const kt=$t.i0+(xt-1);return kt<$t.i1?$t.value(kt,Ct):NULL$1}}},param:[1,1]},fill_down:{create(xt=NULL$1){let $t;return{init:()=>$t=xt,value:(Ct,kt)=>{const Mt=Ct.value(Ct.index,kt);return isValid$2(Mt)?$t=Mt:$t}}},param:[1,1]},fill_up:{create(xt=NULL$1){let $t,Ct;return{init:()=>($t=xt,Ct=-1),value:(kt,Mt)=>kt.index<=Ct?$t:(Ct=find$3(kt,Mt,kt.index))>=0?$t=kt.value(Ct,Mt):(Ct=kt.size,$t=xt)}},param:[1,1]}};function find$3(xt,$t,Ct){for(const kt=xt.size;Ct<kt;++Ct)if(isValid$2(xt.value(Ct,$t)))return Ct;return-1}function hasAggregate(xt){return has$3(aggregateFunctions,xt)}function hasWindow(xt){return has$3(windowFunctions,xt)}function hasFunction(xt){return has$3(functions,xt)||xt==="row_object"}function getAggregate(xt){return hasAggregate(xt)&&aggregateFunctions[xt]}function getWindow(xt){return hasWindow(xt)&&windowFunctions[xt]}function compile$2(xt,$t,Ct){return xt=`"use strict"; return ${xt};`,Function("fn","$",xt)($t,Ct)}const compile$3={escape:(xt,$t,Ct)=>compile$2(xt,$t,Ct),expr:(xt,$t)=>compile$2(`(row,data,op)=>${xt}`,functions,$t),expr2:(xt,$t)=>compile$2(`(row0,data0,row,data)=>${xt}`,functions,$t),join:(xt,$t)=>compile$2(`(row1,data1,row2,data2)=>${xt}`,functions,$t),param:(xt,$t)=>compile$2(xt,functions,$t)},dictOps={"==":1,"!=":1,"===":1,"!==":1};function rewrite(xt,$t,Ct=0,kt,Mt){if(xt.type=Column$1,xt.name=$t,xt.table=Ct,Mt&&kt&&isFunction$3(kt.keyFor)){const Ft=dictOps[Mt.operator]?Mt.left===xt?Mt.right:Mt.left:Mt.callee&&Mt.callee.name==="equal"?Mt.arguments[Mt.arguments[0]===xt?1:0]:null;Ft&&Ft.type===Literal$1&&rewriteDictionary(Mt,xt,Ft,kt.keyFor(Ft.value))}return xt}function rewriteDictionary(xt,$t,Ct,kt){return kt<0?(xt.type=Literal$1,xt.value=!1,xt.raw="false"):($t.type=Dictionary$1,Ct.value=kt,Ct.raw=kt+""),!0}function entries$2(xt){return isArray$3(xt)?xt:isMap(xt)?xt.entries():xt?Object.entries(xt):[]}const ROW_OBJECT="row_object";function rowObjectExpression(xt,$t){xt.type=ObjectExpression$1;const Ct=xt.properties=[];for(const kt of entries$2($t)){const[Mt,Ft]=isArray$3(kt)?kt:[kt,kt];Ct.push({type:Property$1,key:{type:Literal$1,raw:toString$2(Ft)},value:rewrite({computed:!0},Mt)})}return xt}function rowObjectCode(xt){return codegen$2(rowObjectExpression({},xt))}function rowObjectBuilder(xt){return compile$3.expr(rowObjectCode(xt))}const decoder=new TextDecoder("utf-8"),decodeUtf8=xt=>decoder.decode(xt),encoder$2=new TextEncoder,encodeUtf8=xt=>encoder$2.encode(xt),isBoolean$4=xt=>typeof xt=="boolean",isFunction$2=xt=>typeof xt=="function",isObject$3=xt=>xt!=null&&Object(xt)===xt,isPromise=xt=>isObject$3(xt)&&isFunction$2(xt.then),isIterable$1=xt=>isObject$3(xt)&&isFunction$2(xt[Symbol.iterator]),isAsyncIterable=xt=>isObject$3(xt)&&isFunction$2(xt[Symbol.asyncIterator]),isIteratorResult=xt=>isObject$3(xt)&&"done"in xt&&"value"in xt,isReadableInterop=xt=>"_getDOMStream"in xt&&"_getNodeStream"in xt,isWritableDOMStream=xt=>isObject$3(xt)&&isFunction$2(xt.abort)&&isFunction$2(xt.getWriter)&&!isReadableInterop(xt),isWritableNodeStream=xt=>isObject$3(xt)&&isFunction$2(xt.end)&&isFunction$2(xt.write)&&isBoolean$4(xt.writable)&&!isReadableInterop(xt),isFlatbuffersByteBuffer=xt=>isObject$3(xt)&&isFunction$2(xt.clear)&&isFunction$2(xt.bytes)&&isFunction$2(xt.position)&&isFunction$2(xt.setPosition)&&isFunction$2(xt.capacity)&&isFunction$2(xt.getBufferIdentifier)&&isFunction$2(xt.createLong),SharedArrayBuf=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function collapseContiguousByteRanges(xt){const $t=xt[0]?[xt[0]]:[];let Ct,kt,Mt,Ft;for(let jt,Bt,Vt=0,zt=0,Ht=xt.length;++Vt<Ht;){if(jt=$t[zt],Bt=xt[Vt],!jt||!Bt||jt.buffer!==Bt.buffer||Bt.byteOffset<jt.byteOffset){Bt&&($t[++zt]=Bt);continue}if({byteOffset:Ct,byteLength:Mt}=jt,{byteOffset:kt,byteLength:Ft}=Bt,Ct+Mt<kt||kt+Ft<Ct){Bt&&($t[++zt]=Bt);continue}$t[zt]=new Uint8Array(jt.buffer,Ct,kt-Ct+Ft)}return $t}function memcpy(xt,$t,Ct=0,kt=$t.byteLength){const Mt=xt.byteLength,Ft=new Uint8Array(xt.buffer,xt.byteOffset,Mt),jt=new Uint8Array($t.buffer,$t.byteOffset,Math.min(kt,Mt));return Ft.set(jt,Ct),xt}function joinUint8Arrays(xt,$t){const Ct=collapseContiguousByteRanges(xt),kt=Ct.reduce((Ht,Gt)=>Ht+Gt.byteLength,0);let Mt,Ft,jt,Bt=0,Vt=-1;const zt=Math.min($t||Number.POSITIVE_INFINITY,kt);for(const Ht=Ct.length;++Vt<Ht;){if(Mt=Ct[Vt],Ft=Mt.subarray(0,Math.min(Mt.length,zt-Bt)),zt<=Bt+Ft.length){Ft.length<Mt.length?Ct[Vt]=Mt.subarray(Ft.length):Ft.length===Mt.length&&Vt++,jt?memcpy(jt,Ft,Bt):jt=Ft;break}memcpy(jt||(jt=new Uint8Array(zt)),Ft,Bt),Bt+=Ft.length}return[jt||new Uint8Array(0),Ct.slice(Vt),kt-(jt?jt.byteLength:0)]}function toArrayBufferView(xt,$t){let Ct=isIteratorResult($t)?$t.value:$t;return Ct instanceof xt?xt===Uint8Array?new xt(Ct.buffer,Ct.byteOffset,Ct.byteLength):Ct:Ct?(typeof Ct=="string"&&(Ct=encodeUtf8(Ct)),Ct instanceof ArrayBuffer?new xt(Ct):Ct instanceof SharedArrayBuf?new xt(Ct):isFlatbuffersByteBuffer(Ct)?toArrayBufferView(xt,Ct.bytes()):ArrayBuffer.isView(Ct)?Ct.byteLength<=0?new xt(0):new xt(Ct.buffer,Ct.byteOffset,Ct.byteLength/xt.BYTES_PER_ELEMENT):xt.from(Ct)):new xt(0)}const toInt32Array=xt=>toArrayBufferView(Int32Array,xt),toUint8Array=xt=>toArrayBufferView(Uint8Array,xt),pump$1=xt=>(xt.next(),xt);function*toArrayBufferViewIterator(xt,$t){const Ct=function*(Mt){yield Mt},kt=typeof $t=="string"||ArrayBuffer.isView($t)||$t instanceof ArrayBuffer||$t instanceof SharedArrayBuf?Ct($t):isIterable$1($t)?$t:Ct($t);return yield*pump$1(function*(Mt){let Ft=null;do Ft=Mt.next(yield toArrayBufferView(xt,Ft));while(!Ft.done)}(kt[Symbol.iterator]())),new xt}const toUint8ArrayIterator=xt=>toArrayBufferViewIterator(Uint8Array,xt);function toArrayBufferViewAsyncIterator(xt,$t){return __asyncGenerator(this,arguments,function*(){if(isPromise($t))return yield __await(yield __await(yield*__asyncDelegator(__asyncValues(toArrayBufferViewAsyncIterator(xt,yield __await($t))))));const kt=function(jt){return __asyncGenerator(this,arguments,function*(){yield yield __await(yield __await(jt))})},Mt=function(jt){return __asyncGenerator(this,arguments,function*(){yield __await(yield*__asyncDelegator(__asyncValues(pump$1(function*(Bt){let Vt=null;do Vt=Bt.next(yield Vt==null?void 0:Vt.value);while(!Vt.done)}(jt[Symbol.iterator]())))))})},Ft=typeof $t=="string"||ArrayBuffer.isView($t)||$t instanceof ArrayBuffer||$t instanceof SharedArrayBuf?kt($t):isIterable$1($t)?Mt($t):isAsyncIterable($t)?$t:kt($t);return yield __await(yield*__asyncDelegator(__asyncValues(pump$1(function(jt){return __asyncGenerator(this,arguments,function*(){let Bt=null;do Bt=yield __await(jt.next(yield yield __await(toArrayBufferView(xt,Bt))));while(!Bt.done)})}(Ft[Symbol.asyncIterator]()))))),yield __await(new xt)})}const toUint8ArrayAsyncIterator=xt=>toArrayBufferViewAsyncIterator(Uint8Array,xt);function rebaseValueOffsets(xt,$t,Ct){if(xt!==0){Ct=Ct.slice(0,$t);for(let kt=-1,Mt=Ct.length;++kt<Mt;)Ct[kt]+=xt}return Ct.subarray(0,$t)}function compareArrayLike(xt,$t){let Ct=0;const kt=xt.length;if(kt!==$t.length)return!1;if(kt>0)do if(xt[Ct]!==$t[Ct])return!1;while(++Ct<kt);return!0}const streamAdapters={fromIterable(xt){return pump(fromIterable(xt))},fromAsyncIterable(xt){return pump(fromAsyncIterable(xt))},fromDOMStream(xt){return pump(fromDOMStream(xt))},fromNodeStream(xt){return pump(fromNodeStream(xt))},toDOMStream(xt,$t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(xt,$t){throw new Error('"toNodeStream" not available in this environment')}},pump=xt=>(xt.next(),xt);function*fromIterable(xt){let $t,Ct=!1,kt=[],Mt,Ft,jt,Bt=0;function Vt(){return Ft==="peek"?joinUint8Arrays(kt,jt)[0]:([Mt,kt,Bt]=joinUint8Arrays(kt,jt),Mt)}({cmd:Ft,size:jt}=yield null);const zt=toUint8ArrayIterator(xt)[Symbol.iterator]();try{do if({done:$t,value:Mt}=Number.isNaN(jt-Bt)?zt.next():zt.next(jt-Bt),!$t&&Mt.byteLength>0&&(kt.push(Mt),Bt+=Mt.byteLength),$t||jt<=Bt)do({cmd:Ft,size:jt}=yield Vt());while(jt<Bt);while(!$t)}catch(Ht){(Ct=!0)&&typeof zt.throw=="function"&&zt.throw(Ht)}finally{Ct===!1&&typeof zt.return=="function"&&zt.return(null)}return null}function fromAsyncIterable(xt){return __asyncGenerator(this,arguments,function*(){let Ct,kt=!1,Mt=[],Ft,jt,Bt,Vt=0;function zt(){return jt==="peek"?joinUint8Arrays(Mt,Bt)[0]:([Ft,Mt,Vt]=joinUint8Arrays(Mt,Bt),Ft)}({cmd:jt,size:Bt}=yield yield __await(null));const Ht=toUint8ArrayAsyncIterator(xt)[Symbol.asyncIterator]();try{do if({done:Ct,value:Ft}=Number.isNaN(Bt-Vt)?yield __await(Ht.next()):yield __await(Ht.next(Bt-Vt)),!Ct&&Ft.byteLength>0&&(Mt.push(Ft),Vt+=Ft.byteLength),Ct||Bt<=Vt)do({cmd:jt,size:Bt}=yield yield __await(zt()));while(Bt<Vt);while(!Ct)}catch(Gt){(kt=!0)&&typeof Ht.throw=="function"&&(yield __await(Ht.throw(Gt)))}finally{kt===!1&&typeof Ht.return=="function"&&(yield __await(Ht.return(new Uint8Array(0))))}return yield __await(null)})}function fromDOMStream(xt){return __asyncGenerator(this,arguments,function*(){let Ct=!1,kt=!1,Mt=[],Ft,jt,Bt,Vt=0;function zt(){return jt==="peek"?joinUint8Arrays(Mt,Bt)[0]:([Ft,Mt,Vt]=joinUint8Arrays(Mt,Bt),Ft)}({cmd:jt,size:Bt}=yield yield __await(null));const Ht=new AdaptiveByteReader(xt);try{do if({done:Ct,value:Ft}=Number.isNaN(Bt-Vt)?yield __await(Ht.read()):yield __await(Ht.read(Bt-Vt)),!Ct&&Ft.byteLength>0&&(Mt.push(toUint8Array(Ft)),Vt+=Ft.byteLength),Ct||Bt<=Vt)do({cmd:jt,size:Bt}=yield yield __await(zt()));while(Bt<Vt);while(!Ct)}catch(Gt){(kt=!0)&&(yield __await(Ht.cancel(Gt)))}finally{kt===!1?yield __await(Ht.cancel()):xt.locked&&Ht.releaseLock()}return yield __await(null)})}class AdaptiveByteReader{constructor($t){this.source=$t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel($t){return __awaiter(this,void 0,void 0,function*(){const{reader:Ct,source:kt}=this;Ct&&(yield Ct.cancel($t).catch(()=>{})),kt&&kt.locked&&this.releaseLock()})}read($t){return __awaiter(this,void 0,void 0,function*(){if($t===0)return{done:this.reader==null,value:new Uint8Array(0)};const Ct=yield this.reader.read();return!Ct.done&&(Ct.value=toUint8Array(Ct)),Ct})}}const onEvent=(xt,$t)=>{const Ct=Mt=>kt([$t,Mt]);let kt;return[$t,Ct,new Promise(Mt=>(kt=Mt)&&xt.once($t,Ct))]};function fromNodeStream(xt){return __asyncGenerator(this,arguments,function*(){const Ct=[];let kt="error",Mt=!1,Ft=null,jt,Bt,Vt=0,zt=[],Ht;function Gt(){return jt==="peek"?joinUint8Arrays(zt,Bt)[0]:([Ht,zt,Vt]=joinUint8Arrays(zt,Bt),Ht)}if({cmd:jt,size:Bt}=yield yield __await(null),xt.isTTY)return yield yield __await(new Uint8Array(0)),yield __await(null);try{Ct[0]=onEvent(xt,"end"),Ct[1]=onEvent(xt,"error");do{if(Ct[2]=onEvent(xt,"readable"),[kt,Ft]=yield __await(Promise.race(Ct.map(Wt=>Wt[2]))),kt==="error")break;if((Mt=kt==="end")||(Number.isFinite(Bt-Vt)?(Ht=toUint8Array(xt.read(Bt-Vt)),Ht.byteLength<Bt-Vt&&(Ht=toUint8Array(xt.read()))):Ht=toUint8Array(xt.read()),Ht.byteLength>0&&(zt.push(Ht),Vt+=Ht.byteLength)),Mt||Bt<=Vt)do({cmd:jt,size:Bt}=yield yield __await(Gt()));while(Bt<Vt)}while(!Mt)}finally{yield __await(qt(Ct,kt==="error"?Ft:null))}return yield __await(null);function qt(Wt,Yt){return Ht=zt=null,new Promise((Kt,Xt)=>{for(const[Qt,Jt]of Wt)xt.off(Qt,Jt);try{const Qt=xt.destroy;Qt&&Qt.call(xt,Yt),Yt=void 0}catch(Qt){Yt=Qt||Yt}finally{Yt!=null?Xt(Yt):Kt()}})}})}var MetadataVersion$1;(function(xt){xt[xt.V1=0]="V1",xt[xt.V2=1]="V2",xt[xt.V3=2]="V3",xt[xt.V4=3]="V4",xt[xt.V5=4]="V5"})(MetadataVersion$1||(MetadataVersion$1={}));var UnionMode$1;(function(xt){xt[xt.Sparse=0]="Sparse",xt[xt.Dense=1]="Dense"})(UnionMode$1||(UnionMode$1={}));var Precision$1;(function(xt){xt[xt.HALF=0]="HALF",xt[xt.SINGLE=1]="SINGLE",xt[xt.DOUBLE=2]="DOUBLE"})(Precision$1||(Precision$1={}));var DateUnit$1;(function(xt){xt[xt.DAY=0]="DAY",xt[xt.MILLISECOND=1]="MILLISECOND"})(DateUnit$1||(DateUnit$1={}));var TimeUnit$2;(function(xt){xt[xt.SECOND=0]="SECOND",xt[xt.MILLISECOND=1]="MILLISECOND",xt[xt.MICROSECOND=2]="MICROSECOND",xt[xt.NANOSECOND=3]="NANOSECOND"})(TimeUnit$2||(TimeUnit$2={}));var IntervalUnit$1;(function(xt){xt[xt.YEAR_MONTH=0]="YEAR_MONTH",xt[xt.DAY_TIME=1]="DAY_TIME",xt[xt.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(IntervalUnit$1||(IntervalUnit$1={}));var MessageHeader$1;(function(xt){xt[xt.NONE=0]="NONE",xt[xt.Schema=1]="Schema",xt[xt.DictionaryBatch=2]="DictionaryBatch",xt[xt.RecordBatch=3]="RecordBatch",xt[xt.Tensor=4]="Tensor",xt[xt.SparseTensor=5]="SparseTensor"})(MessageHeader$1||(MessageHeader$1={}));var Type$3;(function(xt){xt[xt.NONE=0]="NONE",xt[xt.Null=1]="Null",xt[xt.Int=2]="Int",xt[xt.Float=3]="Float",xt[xt.Binary=4]="Binary",xt[xt.Utf8=5]="Utf8",xt[xt.Bool=6]="Bool",xt[xt.Decimal=7]="Decimal",xt[xt.Date=8]="Date",xt[xt.Time=9]="Time",xt[xt.Timestamp=10]="Timestamp",xt[xt.Interval=11]="Interval",xt[xt.List=12]="List",xt[xt.Struct=13]="Struct",xt[xt.Union=14]="Union",xt[xt.FixedSizeBinary=15]="FixedSizeBinary",xt[xt.FixedSizeList=16]="FixedSizeList",xt[xt.Map=17]="Map",xt[xt.Duration=18]="Duration",xt[xt.Dictionary=-1]="Dictionary",xt[xt.Int8=-2]="Int8",xt[xt.Int16=-3]="Int16",xt[xt.Int32=-4]="Int32",xt[xt.Int64=-5]="Int64",xt[xt.Uint8=-6]="Uint8",xt[xt.Uint16=-7]="Uint16",xt[xt.Uint32=-8]="Uint32",xt[xt.Uint64=-9]="Uint64",xt[xt.Float16=-10]="Float16",xt[xt.Float32=-11]="Float32",xt[xt.Float64=-12]="Float64",xt[xt.DateDay=-13]="DateDay",xt[xt.DateMillisecond=-14]="DateMillisecond",xt[xt.TimestampSecond=-15]="TimestampSecond",xt[xt.TimestampMillisecond=-16]="TimestampMillisecond",xt[xt.TimestampMicrosecond=-17]="TimestampMicrosecond",xt[xt.TimestampNanosecond=-18]="TimestampNanosecond",xt[xt.TimeSecond=-19]="TimeSecond",xt[xt.TimeMillisecond=-20]="TimeMillisecond",xt[xt.TimeMicrosecond=-21]="TimeMicrosecond",xt[xt.TimeNanosecond=-22]="TimeNanosecond",xt[xt.DenseUnion=-23]="DenseUnion",xt[xt.SparseUnion=-24]="SparseUnion",xt[xt.IntervalDayTime=-25]="IntervalDayTime",xt[xt.IntervalYearMonth=-26]="IntervalYearMonth",xt[xt.DurationSecond=-27]="DurationSecond",xt[xt.DurationMillisecond=-28]="DurationMillisecond",xt[xt.DurationMicrosecond=-29]="DurationMicrosecond",xt[xt.DurationNanosecond=-30]="DurationNanosecond"})(Type$3||(Type$3={}));var BufferType;(function(xt){xt[xt.OFFSET=0]="OFFSET",xt[xt.DATA=1]="DATA",xt[xt.VALIDITY=2]="VALIDITY",xt[xt.TYPE=3]="TYPE"})(BufferType||(BufferType={}));const undf=void 0;function valueToString(xt){if(xt===null)return"null";if(xt===undf)return"undefined";switch(typeof xt){case"number":return`${xt}`;case"bigint":return`${xt}`;case"string":return`"${xt}"`}return typeof xt[Symbol.toPrimitive]=="function"?xt[Symbol.toPrimitive]("string"):ArrayBuffer.isView(xt)?xt instanceof BigInt64Array||xt instanceof BigUint64Array?`[${[...xt].map($t=>valueToString($t))}]`:`[${xt}]`:ArrayBuffer.isView(xt)?`[${xt}]`:JSON.stringify(xt,($t,Ct)=>typeof Ct=="bigint"?`${Ct}`:Ct)}const isArrowBigNumSymbol=Symbol.for("isArrowBigNum");function BigNum(xt,...$t){return $t.length===0?Object.setPrototypeOf(toArrayBufferView(this.TypedArray,xt),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(xt,...$t),this.constructor.prototype)}BigNum.prototype[isArrowBigNumSymbol]=!0;BigNum.prototype.toJSON=function(){return`"${bigNumToString(this)}"`};BigNum.prototype.valueOf=function(){return bigNumToNumber(this)};BigNum.prototype.toString=function(){return bigNumToString(this)};BigNum.prototype[Symbol.toPrimitive]=function(xt="default"){switch(xt){case"number":return bigNumToNumber(this);case"string":return bigNumToString(this);case"default":return bigNumToBigInt(this)}return bigNumToString(this)};function SignedBigNum(...xt){return BigNum.apply(this,xt)}function UnsignedBigNum(...xt){return BigNum.apply(this,xt)}function DecimalBigNum(...xt){return BigNum.apply(this,xt)}Object.setPrototypeOf(SignedBigNum.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(UnsignedBigNum.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(DecimalBigNum.prototype,Object.create(Uint32Array.prototype));Object.assign(SignedBigNum.prototype,BigNum.prototype,{constructor:SignedBigNum,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array});Object.assign(UnsignedBigNum.prototype,BigNum.prototype,{constructor:UnsignedBigNum,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array});Object.assign(DecimalBigNum.prototype,BigNum.prototype,{constructor:DecimalBigNum,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});function bigNumToNumber(xt){const{buffer:$t,byteOffset:Ct,length:kt,signed:Mt}=xt,Ft=new BigUint64Array($t,Ct,kt),jt=Mt&&Ft.at(-1)&BigInt(1)<<BigInt(63);let Bt=BigInt(jt?1:0),Vt=BigInt(0);if(jt){for(const zt of Ft)Bt+=~zt*(BigInt(1)<<BigInt(32)*Vt++);Bt*=BigInt(-1)}else for(const zt of Ft)Bt+=zt*(BigInt(1)<<BigInt(32)*Vt++);return Bt}const bigNumToString=xt=>{if(xt.byteLength===8)return`${new xt.BigIntArray(xt.buffer,xt.byteOffset,1)[0]}`;if(!xt.signed)return unsignedBigNumToString(xt);let $t=new Uint16Array(xt.buffer,xt.byteOffset,xt.byteLength/2);if(new Int16Array([$t.at(-1)])[0]>=0)return unsignedBigNumToString(xt);$t=$t.slice();let kt=1;for(let Ft=0;Ft<$t.length;Ft++){const jt=$t[Ft],Bt=~jt+kt;$t[Ft]=Bt,kt&=jt===0?1:0}return`-${unsignedBigNumToString($t)}`},bigNumToBigInt=xt=>xt.byteLength===8?new xt.BigIntArray(xt.buffer,xt.byteOffset,1)[0]:bigNumToString(xt);function unsignedBigNumToString(xt){let $t="";const Ct=new Uint32Array(2);let kt=new Uint16Array(xt.buffer,xt.byteOffset,xt.byteLength/2);const Mt=new Uint32Array((kt=new Uint16Array(kt).reverse()).buffer);let Ft=-1;const jt=kt.length-1;do{for(Ct[0]=kt[Ft=0];Ft<jt;)kt[Ft++]=Ct[1]=Ct[0]/10,Ct[0]=(Ct[0]-Ct[1]*10<<16)+kt[Ft];kt[Ft]=Ct[1]=Ct[0]/10,Ct[0]=Ct[0]-Ct[1]*10,$t=`${Ct[0]}${$t}`}while(Mt[0]||Mt[1]||Mt[2]||Mt[3]);return $t??"0"}class BN{static new($t,Ct){switch(Ct){case!0:return new SignedBigNum($t);case!1:return new UnsignedBigNum($t)}switch($t.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new SignedBigNum($t)}return $t.byteLength===16?new DecimalBigNum($t):new UnsignedBigNum($t)}static signed($t){return new SignedBigNum($t)}static unsigned($t){return new UnsignedBigNum($t)}static decimal($t){return new DecimalBigNum($t)}constructor($t,Ct){return BN.new($t,Ct)}}function bigIntToNumber(xt){if(typeof xt=="bigint"&&(xt<Number.MIN_SAFE_INTEGER||xt>Number.MAX_SAFE_INTEGER))throw new TypeError(`${xt} is not safe to convert to a number.`);return Number(xt)}var _a$3,_b,_c$1,_d$1,_e$1,_f$1,_g$1,_h,_j,_k$1,_l,_m,_o$1,_p,_q,_r$1,_s,_t$2,_u$1,_v;let DataType$1=class $u{static isNull($t){return($t==null?void 0:$t.typeId)===Type$3.Null}static isInt($t){return($t==null?void 0:$t.typeId)===Type$3.Int}static isFloat($t){return($t==null?void 0:$t.typeId)===Type$3.Float}static isBinary($t){return($t==null?void 0:$t.typeId)===Type$3.Binary}static isUtf8($t){return($t==null?void 0:$t.typeId)===Type$3.Utf8}static isBool($t){return($t==null?void 0:$t.typeId)===Type$3.Bool}static isDecimal($t){return($t==null?void 0:$t.typeId)===Type$3.Decimal}static isDate($t){return($t==null?void 0:$t.typeId)===Type$3.Date}static isTime($t){return($t==null?void 0:$t.typeId)===Type$3.Time}static isTimestamp($t){return($t==null?void 0:$t.typeId)===Type$3.Timestamp}static isInterval($t){return($t==null?void 0:$t.typeId)===Type$3.Interval}static isDuration($t){return($t==null?void 0:$t.typeId)===Type$3.Duration}static isList($t){return($t==null?void 0:$t.typeId)===Type$3.List}static isStruct($t){return($t==null?void 0:$t.typeId)===Type$3.Struct}static isUnion($t){return($t==null?void 0:$t.typeId)===Type$3.Union}static isFixedSizeBinary($t){return($t==null?void 0:$t.typeId)===Type$3.FixedSizeBinary}static isFixedSizeList($t){return($t==null?void 0:$t.typeId)===Type$3.FixedSizeList}static isMap($t){return($t==null?void 0:$t.typeId)===Type$3.Map}static isDictionary($t){return($t==null?void 0:$t.typeId)===Type$3.Dictionary}static isDenseUnion($t){return $u.isUnion($t)&&$t.mode===UnionMode$1.Dense}static isSparseUnion($t){return $u.isUnion($t)&&$t.mode===UnionMode$1.Sparse}get typeId(){return Type$3.NONE}};_a$3=Symbol.toStringTag;DataType$1[_a$3]=(xt=>(xt.children=null,xt.ArrayType=Array,xt[Symbol.toStringTag]="DataType"))(DataType$1.prototype);let Null$1=class extends DataType$1{toString(){return"Null"}get typeId(){return Type$3.Null}};_b=Symbol.toStringTag;Null$1[_b]=(xt=>xt[Symbol.toStringTag]="Null")(Null$1.prototype);class Int_ extends DataType$1{constructor($t,Ct){super(),this.isSigned=$t,this.bitWidth=Ct}get typeId(){return Type$3.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}_c$1=Symbol.toStringTag;Int_[_c$1]=(xt=>(xt.isSigned=null,xt.bitWidth=null,xt[Symbol.toStringTag]="Int"))(Int_.prototype);class Int8 extends Int_{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}class Int16 extends Int_{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}class Int32 extends Int_{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}class Int64 extends Int_{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}class Uint8 extends Int_{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}class Uint16 extends Int_{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}class Uint32 extends Int_{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}class Uint64 extends Int_{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}Object.defineProperty(Int8.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(Int16.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(Int32.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(Int64.prototype,"ArrayType",{value:BigInt64Array});Object.defineProperty(Uint8.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(Uint16.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Uint32.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(Uint64.prototype,"ArrayType",{value:BigUint64Array});class Float extends DataType$1{constructor($t){super(),this.precision=$t}get typeId(){return Type$3.Float}get ArrayType(){switch(this.precision){case Precision$1.HALF:return Uint16Array;case Precision$1.SINGLE:return Float32Array;case Precision$1.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}_d$1=Symbol.toStringTag;Float[_d$1]=(xt=>(xt.precision=null,xt[Symbol.toStringTag]="Float"))(Float.prototype);class Float16 extends Float{constructor(){super(Precision$1.HALF)}}class Float32 extends Float{constructor(){super(Precision$1.SINGLE)}}class Float64 extends Float{constructor(){super(Precision$1.DOUBLE)}}Object.defineProperty(Float16.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Float32.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(Float64.prototype,"ArrayType",{value:Float64Array});let Binary$1=class extends DataType$1{constructor(){super()}get typeId(){return Type$3.Binary}toString(){return"Binary"}};_e$1=Symbol.toStringTag;Binary$1[_e$1]=(xt=>(xt.ArrayType=Uint8Array,xt[Symbol.toStringTag]="Binary"))(Binary$1.prototype);let Utf8$1=class extends DataType$1{constructor(){super()}get typeId(){return Type$3.Utf8}toString(){return"Utf8"}};_f$1=Symbol.toStringTag;Utf8$1[_f$1]=(xt=>(xt.ArrayType=Uint8Array,xt[Symbol.toStringTag]="Utf8"))(Utf8$1.prototype);let Bool$1=class extends DataType$1{constructor(){super()}get typeId(){return Type$3.Bool}toString(){return"Bool"}};_g$1=Symbol.toStringTag;Bool$1[_g$1]=(xt=>(xt.ArrayType=Uint8Array,xt[Symbol.toStringTag]="Bool"))(Bool$1.prototype);let Decimal$1=class extends DataType$1{constructor($t,Ct,kt=128){super(),this.scale=$t,this.precision=Ct,this.bitWidth=kt}get typeId(){return Type$3.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};_h=Symbol.toStringTag;Decimal$1[_h]=(xt=>(xt.scale=null,xt.precision=null,xt.ArrayType=Uint32Array,xt[Symbol.toStringTag]="Decimal"))(Decimal$1.prototype);class Date_ extends DataType$1{constructor($t){super(),this.unit=$t}get typeId(){return Type$3.Date}toString(){return`Date${(this.unit+1)*32}<${DateUnit$1[this.unit]}>`}}_j=Symbol.toStringTag;Date_[_j]=(xt=>(xt.unit=null,xt.ArrayType=Int32Array,xt[Symbol.toStringTag]="Date"))(Date_.prototype);class DateDay extends Date_{constructor(){super(DateUnit$1.DAY)}}class DateMillisecond extends Date_{constructor(){super(DateUnit$1.MILLISECOND)}}class Time_ extends DataType$1{constructor($t,Ct){super(),this.unit=$t,this.bitWidth=Ct}get typeId(){return Type$3.Time}toString(){return`Time${this.bitWidth}<${TimeUnit$2[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}_k$1=Symbol.toStringTag;Time_[_k$1]=(xt=>(xt.unit=null,xt.bitWidth=null,xt[Symbol.toStringTag]="Time"))(Time_.prototype);class TimeSecond extends Time_{constructor(){super(TimeUnit$2.SECOND,32)}}class TimeMillisecond extends Time_{constructor(){super(TimeUnit$2.MILLISECOND,32)}}class TimeMicrosecond extends Time_{constructor(){super(TimeUnit$2.MICROSECOND,64)}}class TimeNanosecond extends Time_{constructor(){super(TimeUnit$2.NANOSECOND,64)}}class Timestamp_ extends DataType$1{constructor($t,Ct){super(),this.unit=$t,this.timezone=Ct}get typeId(){return Type$3.Timestamp}toString(){return`Timestamp<${TimeUnit$2[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}_l=Symbol.toStringTag;Timestamp_[_l]=(xt=>(xt.unit=null,xt.timezone=null,xt.ArrayType=Int32Array,xt[Symbol.toStringTag]="Timestamp"))(Timestamp_.prototype);class Interval_ extends DataType$1{constructor($t){super(),this.unit=$t}get typeId(){return Type$3.Interval}toString(){return`Interval<${IntervalUnit$1[this.unit]}>`}}_m=Symbol.toStringTag;Interval_[_m]=(xt=>(xt.unit=null,xt.ArrayType=Int32Array,xt[Symbol.toStringTag]="Interval"))(Interval_.prototype);class IntervalDayTime extends Interval_{constructor(){super(IntervalUnit$1.DAY_TIME)}}class IntervalYearMonth extends Interval_{constructor(){super(IntervalUnit$1.YEAR_MONTH)}}let Duration$1=class extends DataType$1{constructor($t){super(),this.unit=$t}get typeId(){return Type$3.Duration}toString(){return`Duration<${TimeUnit$2[this.unit]}>`}};_o$1=Symbol.toStringTag;Duration$1[_o$1]=(xt=>(xt.unit=null,xt.ArrayType=BigInt64Array,xt[Symbol.toStringTag]="Duration"))(Duration$1.prototype);let List$1=class extends DataType$1{constructor($t){super(),this.children=[$t]}get typeId(){return Type$3.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};_p=Symbol.toStringTag;List$1[_p]=(xt=>(xt.children=null,xt[Symbol.toStringTag]="List"))(List$1.prototype);class Struct extends DataType$1{constructor($t){super(),this.children=$t}get typeId(){return Type$3.Struct}toString(){return`Struct<{${this.children.map($t=>`${$t.name}:${$t.type}`).join(", ")}}>`}}_q=Symbol.toStringTag;Struct[_q]=(xt=>(xt.children=null,xt[Symbol.toStringTag]="Struct"))(Struct.prototype);class Union_ extends DataType$1{constructor($t,Ct,kt){super(),this.mode=$t,this.children=kt,this.typeIds=Ct=Int32Array.from(Ct),this.typeIdToChildIndex=Ct.reduce((Mt,Ft,jt)=>(Mt[Ft]=jt)&&Mt||Mt,Object.create(null))}get typeId(){return Type$3.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map($t=>`${$t.type}`).join(" | ")}>`}}_r$1=Symbol.toStringTag;Union_[_r$1]=(xt=>(xt.mode=null,xt.typeIds=null,xt.children=null,xt.typeIdToChildIndex=null,xt.ArrayType=Int8Array,xt[Symbol.toStringTag]="Union"))(Union_.prototype);let FixedSizeBinary$1=class extends DataType$1{constructor($t){super(),this.byteWidth=$t}get typeId(){return Type$3.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};_s=Symbol.toStringTag;FixedSizeBinary$1[_s]=(xt=>(xt.byteWidth=null,xt.ArrayType=Uint8Array,xt[Symbol.toStringTag]="FixedSizeBinary"))(FixedSizeBinary$1.prototype);let FixedSizeList$1=class extends DataType$1{constructor($t,Ct){super(),this.listSize=$t,this.children=[Ct]}get typeId(){return Type$3.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};_t$2=Symbol.toStringTag;FixedSizeList$1[_t$2]=(xt=>(xt.children=null,xt.listSize=null,xt[Symbol.toStringTag]="FixedSizeList"))(FixedSizeList$1.prototype);class Map_ extends DataType$1{constructor($t,Ct=!1){var kt,Mt,Ft;if(super(),this.children=[$t],this.keysSorted=Ct,$t&&($t.name="entries",!((kt=$t==null?void 0:$t.type)===null||kt===void 0)&&kt.children)){const jt=(Mt=$t==null?void 0:$t.type)===null||Mt===void 0?void 0:Mt.children[0];jt&&(jt.name="key");const Bt=(Ft=$t==null?void 0:$t.type)===null||Ft===void 0?void 0:Ft.children[1];Bt&&(Bt.name="value")}}get typeId(){return Type$3.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map($t=>`${$t.name}:${$t.type}`).join(", ")}}>`}}_u$1=Symbol.toStringTag;Map_[_u$1]=(xt=>(xt.children=null,xt.keysSorted=null,xt[Symbol.toStringTag]="Map_"))(Map_.prototype);const getId=(xt=>()=>++xt)(-1);class Dictionary extends DataType$1{constructor($t,Ct,kt,Mt){super(),this.indices=Ct,this.dictionary=$t,this.isOrdered=Mt||!1,this.id=kt==null?getId():bigIntToNumber(kt)}get typeId(){return Type$3.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}_v=Symbol.toStringTag;Dictionary[_v]=(xt=>(xt.id=null,xt.indices=null,xt.isOrdered=null,xt.dictionary=null,xt[Symbol.toStringTag]="Dictionary"))(Dictionary.prototype);function strideForType(xt){const $t=xt;switch(xt.typeId){case Type$3.Decimal:return xt.bitWidth/32;case Type$3.Timestamp:return 2;case Type$3.Date:return 1+$t.unit;case Type$3.Interval:return 1+$t.unit;case Type$3.FixedSizeList:return $t.listSize;case Type$3.FixedSizeBinary:return $t.byteWidth;default:return 1}}class Visitor{visitMany($t,...Ct){return $t.map((kt,Mt)=>this.visit(kt,...Ct.map(Ft=>Ft[Mt])))}visit(...$t){return this.getVisitFn($t[0],!1).apply(this,$t)}getVisitFn($t,Ct=!0){return getVisitFn(this,$t,Ct)}getVisitFnByTypeId($t,Ct=!0){return getVisitFnByTypeId(this,$t,Ct)}visitNull($t,...Ct){return null}visitBool($t,...Ct){return null}visitInt($t,...Ct){return null}visitFloat($t,...Ct){return null}visitUtf8($t,...Ct){return null}visitBinary($t,...Ct){return null}visitFixedSizeBinary($t,...Ct){return null}visitDate($t,...Ct){return null}visitTimestamp($t,...Ct){return null}visitTime($t,...Ct){return null}visitDecimal($t,...Ct){return null}visitList($t,...Ct){return null}visitStruct($t,...Ct){return null}visitUnion($t,...Ct){return null}visitDictionary($t,...Ct){return null}visitInterval($t,...Ct){return null}visitDuration($t,...Ct){return null}visitFixedSizeList($t,...Ct){return null}visitMap($t,...Ct){return null}}function getVisitFn(xt,$t,Ct=!0){return typeof $t=="number"?getVisitFnByTypeId(xt,$t,Ct):typeof $t=="string"&&$t in Type$3?getVisitFnByTypeId(xt,Type$3[$t],Ct):$t&&$t instanceof DataType$1?getVisitFnByTypeId(xt,inferDType($t),Ct):$t!=null&&$t.type&&$t.type instanceof DataType$1?getVisitFnByTypeId(xt,inferDType($t.type),Ct):getVisitFnByTypeId(xt,Type$3.NONE,Ct)}function getVisitFnByTypeId(xt,$t,Ct=!0){let kt=null;switch($t){case Type$3.Null:kt=xt.visitNull;break;case Type$3.Bool:kt=xt.visitBool;break;case Type$3.Int:kt=xt.visitInt;break;case Type$3.Int8:kt=xt.visitInt8||xt.visitInt;break;case Type$3.Int16:kt=xt.visitInt16||xt.visitInt;break;case Type$3.Int32:kt=xt.visitInt32||xt.visitInt;break;case Type$3.Int64:kt=xt.visitInt64||xt.visitInt;break;case Type$3.Uint8:kt=xt.visitUint8||xt.visitInt;break;case Type$3.Uint16:kt=xt.visitUint16||xt.visitInt;break;case Type$3.Uint32:kt=xt.visitUint32||xt.visitInt;break;case Type$3.Uint64:kt=xt.visitUint64||xt.visitInt;break;case Type$3.Float:kt=xt.visitFloat;break;case Type$3.Float16:kt=xt.visitFloat16||xt.visitFloat;break;case Type$3.Float32:kt=xt.visitFloat32||xt.visitFloat;break;case Type$3.Float64:kt=xt.visitFloat64||xt.visitFloat;break;case Type$3.Utf8:kt=xt.visitUtf8;break;case Type$3.Binary:kt=xt.visitBinary;break;case Type$3.FixedSizeBinary:kt=xt.visitFixedSizeBinary;break;case Type$3.Date:kt=xt.visitDate;break;case Type$3.DateDay:kt=xt.visitDateDay||xt.visitDate;break;case Type$3.DateMillisecond:kt=xt.visitDateMillisecond||xt.visitDate;break;case Type$3.Timestamp:kt=xt.visitTimestamp;break;case Type$3.TimestampSecond:kt=xt.visitTimestampSecond||xt.visitTimestamp;break;case Type$3.TimestampMillisecond:kt=xt.visitTimestampMillisecond||xt.visitTimestamp;break;case Type$3.TimestampMicrosecond:kt=xt.visitTimestampMicrosecond||xt.visitTimestamp;break;case Type$3.TimestampNanosecond:kt=xt.visitTimestampNanosecond||xt.visitTimestamp;break;case Type$3.Time:kt=xt.visitTime;break;case Type$3.TimeSecond:kt=xt.visitTimeSecond||xt.visitTime;break;case Type$3.TimeMillisecond:kt=xt.visitTimeMillisecond||xt.visitTime;break;case Type$3.TimeMicrosecond:kt=xt.visitTimeMicrosecond||xt.visitTime;break;case Type$3.TimeNanosecond:kt=xt.visitTimeNanosecond||xt.visitTime;break;case Type$3.Decimal:kt=xt.visitDecimal;break;case Type$3.List:kt=xt.visitList;break;case Type$3.Struct:kt=xt.visitStruct;break;case Type$3.Union:kt=xt.visitUnion;break;case Type$3.DenseUnion:kt=xt.visitDenseUnion||xt.visitUnion;break;case Type$3.SparseUnion:kt=xt.visitSparseUnion||xt.visitUnion;break;case Type$3.Dictionary:kt=xt.visitDictionary;break;case Type$3.Interval:kt=xt.visitInterval;break;case Type$3.IntervalDayTime:kt=xt.visitIntervalDayTime||xt.visitInterval;break;case Type$3.IntervalYearMonth:kt=xt.visitIntervalYearMonth||xt.visitInterval;break;case Type$3.Duration:kt=xt.visitDuration;break;case Type$3.DurationSecond:kt=xt.visitDurationSecond||xt.visitDuration;break;case Type$3.DurationMillisecond:kt=xt.visitDurationMillisecond||xt.visitDuration;break;case Type$3.DurationMicrosecond:kt=xt.visitDurationMicrosecond||xt.visitDuration;break;case Type$3.DurationNanosecond:kt=xt.visitDurationNanosecond||xt.visitDuration;break;case Type$3.FixedSizeList:kt=xt.visitFixedSizeList;break;case Type$3.Map:kt=xt.visitMap;break}if(typeof kt=="function")return kt;if(!Ct)return()=>null;throw new Error(`Unrecognized type '${Type$3[$t]}'`)}function inferDType(xt){switch(xt.typeId){case Type$3.Null:return Type$3.Null;case Type$3.Int:{const{bitWidth:$t,isSigned:Ct}=xt;switch($t){case 8:return Ct?Type$3.Int8:Type$3.Uint8;case 16:return Ct?Type$3.Int16:Type$3.Uint16;case 32:return Ct?Type$3.Int32:Type$3.Uint32;case 64:return Ct?Type$3.Int64:Type$3.Uint64}return Type$3.Int}case Type$3.Float:switch(xt.precision){case Precision$1.HALF:return Type$3.Float16;case Precision$1.SINGLE:return Type$3.Float32;case Precision$1.DOUBLE:return Type$3.Float64}return Type$3.Float;case Type$3.Binary:return Type$3.Binary;case Type$3.Utf8:return Type$3.Utf8;case Type$3.Bool:return Type$3.Bool;case Type$3.Decimal:return Type$3.Decimal;case Type$3.Time:switch(xt.unit){case TimeUnit$2.SECOND:return Type$3.TimeSecond;case TimeUnit$2.MILLISECOND:return Type$3.TimeMillisecond;case TimeUnit$2.MICROSECOND:return Type$3.TimeMicrosecond;case TimeUnit$2.NANOSECOND:return Type$3.TimeNanosecond}return Type$3.Time;case Type$3.Timestamp:switch(xt.unit){case TimeUnit$2.SECOND:return Type$3.TimestampSecond;case TimeUnit$2.MILLISECOND:return Type$3.TimestampMillisecond;case TimeUnit$2.MICROSECOND:return Type$3.TimestampMicrosecond;case TimeUnit$2.NANOSECOND:return Type$3.TimestampNanosecond}return Type$3.Timestamp;case Type$3.Date:switch(xt.unit){case DateUnit$1.DAY:return Type$3.DateDay;case DateUnit$1.MILLISECOND:return Type$3.DateMillisecond}return Type$3.Date;case Type$3.Interval:switch(xt.unit){case IntervalUnit$1.DAY_TIME:return Type$3.IntervalDayTime;case IntervalUnit$1.YEAR_MONTH:return Type$3.IntervalYearMonth}return Type$3.Interval;case Type$3.Duration:switch(xt.unit){case TimeUnit$2.SECOND:return Type$3.DurationSecond;case TimeUnit$2.MILLISECOND:return Type$3.DurationMillisecond;case TimeUnit$2.MICROSECOND:return Type$3.DurationMicrosecond;case TimeUnit$2.NANOSECOND:return Type$3.DurationNanosecond}return Type$3.Duration;case Type$3.Map:return Type$3.Map;case Type$3.List:return Type$3.List;case Type$3.Struct:return Type$3.Struct;case Type$3.Union:switch(xt.mode){case UnionMode$1.Dense:return Type$3.DenseUnion;case UnionMode$1.Sparse:return Type$3.SparseUnion}return Type$3.Union;case Type$3.FixedSizeBinary:return Type$3.FixedSizeBinary;case Type$3.FixedSizeList:return Type$3.FixedSizeList;case Type$3.Dictionary:return Type$3.Dictionary}throw new Error(`Unrecognized type '${Type$3[xt.typeId]}'`)}Visitor.prototype.visitInt8=null;Visitor.prototype.visitInt16=null;Visitor.prototype.visitInt32=null;Visitor.prototype.visitInt64=null;Visitor.prototype.visitUint8=null;Visitor.prototype.visitUint16=null;Visitor.prototype.visitUint32=null;Visitor.prototype.visitUint64=null;Visitor.prototype.visitFloat16=null;Visitor.prototype.visitFloat32=null;Visitor.prototype.visitFloat64=null;Visitor.prototype.visitDateDay=null;Visitor.prototype.visitDateMillisecond=null;Visitor.prototype.visitTimestampSecond=null;Visitor.prototype.visitTimestampMillisecond=null;Visitor.prototype.visitTimestampMicrosecond=null;Visitor.prototype.visitTimestampNanosecond=null;Visitor.prototype.visitTimeSecond=null;Visitor.prototype.visitTimeMillisecond=null;Visitor.prototype.visitTimeMicrosecond=null;Visitor.prototype.visitTimeNanosecond=null;Visitor.prototype.visitDenseUnion=null;Visitor.prototype.visitSparseUnion=null;Visitor.prototype.visitIntervalDayTime=null;Visitor.prototype.visitIntervalYearMonth=null;Visitor.prototype.visitDuration=null;Visitor.prototype.visitDurationSecond=null;Visitor.prototype.visitDurationMillisecond=null;Visitor.prototype.visitDurationMicrosecond=null;Visitor.prototype.visitDurationNanosecond=null;const f64=new Float64Array(1),u32=new Uint32Array(f64.buffer);function uint16ToFloat64(xt){const $t=(xt&31744)>>10,Ct=(xt&1023)/1024,kt=Math.pow(-1,(xt&32768)>>15);switch($t){case 31:return kt*(Ct?Number.NaN:1/0);case 0:return kt*(Ct?6103515625e-14*Ct:0)}return kt*Math.pow(2,$t-15)*(1+Ct)}function float64ToUint16(xt){if(xt!==xt)return 32256;f64[0]=xt;const $t=(u32[1]&2147483648)>>16&65535;let Ct=u32[1]&2146435072,kt=0;return Ct>=1089470464?u32[0]>0?Ct=31744:(Ct=(Ct&2080374784)>>16,kt=(u32[1]&1048575)>>10):Ct<=1056964608?(kt=1048576+(u32[1]&1048575),kt=1048576+(kt<<(Ct>>20)-998)>>21,Ct=0):(Ct=Ct-1056964608>>10,kt=(u32[1]&1048575)+512>>10),$t|Ct|kt&65535}class SetVisitor extends Visitor{}function wrapSet(xt){return($t,Ct,kt)=>{if($t.setValid(Ct,kt!=null))return xt($t,Ct,kt)}}const setEpochMsToDays=(xt,$t,Ct)=>{xt[$t]=Math.trunc(Ct/864e5)},setEpochMsToMillisecondsLong=(xt,$t,Ct)=>{xt[$t]=Math.trunc(Ct%4294967296),xt[$t+1]=Math.trunc(Ct/4294967296)},setEpochMsToMicrosecondsLong=(xt,$t,Ct)=>{xt[$t]=Math.trunc(Ct*1e3%4294967296),xt[$t+1]=Math.trunc(Ct*1e3/4294967296)},setEpochMsToNanosecondsLong=(xt,$t,Ct)=>{xt[$t]=Math.trunc(Ct*1e6%4294967296),xt[$t+1]=Math.trunc(Ct*1e6/4294967296)},setVariableWidthBytes=(xt,$t,Ct,kt)=>{if(Ct+1<$t.length){const{[Ct]:Mt,[Ct+1]:Ft}=$t;xt.set(kt.subarray(0,Ft-Mt),Mt)}},setBool=({offset:xt,values:$t},Ct,kt)=>{const Mt=xt+Ct;kt?$t[Mt>>3]|=1<<Mt%8:$t[Mt>>3]&=~(1<<Mt%8)},setInt=({values:xt},$t,Ct)=>{xt[$t]=Ct},setFloat=({values:xt},$t,Ct)=>{xt[$t]=Ct},setFloat16=({values:xt},$t,Ct)=>{xt[$t]=float64ToUint16(Ct)},setAnyFloat=(xt,$t,Ct)=>{switch(xt.type.precision){case Precision$1.HALF:return setFloat16(xt,$t,Ct);case Precision$1.SINGLE:case Precision$1.DOUBLE:return setFloat(xt,$t,Ct)}},setDateDay=({values:xt},$t,Ct)=>{setEpochMsToDays(xt,$t,Ct.valueOf())},setDateMillisecond=({values:xt},$t,Ct)=>{setEpochMsToMillisecondsLong(xt,$t*2,Ct.valueOf())},setFixedSizeBinary=({stride:xt,values:$t},Ct,kt)=>{$t.set(kt.subarray(0,xt),xt*Ct)},setBinary=({values:xt,valueOffsets:$t},Ct,kt)=>setVariableWidthBytes(xt,$t,Ct,kt),setUtf8=({values:xt,valueOffsets:$t},Ct,kt)=>{setVariableWidthBytes(xt,$t,Ct,encodeUtf8(kt))},setDate=(xt,$t,Ct)=>{xt.type.unit===DateUnit$1.DAY?setDateDay(xt,$t,Ct):setDateMillisecond(xt,$t,Ct)},setTimestampSecond=({values:xt},$t,Ct)=>setEpochMsToMillisecondsLong(xt,$t*2,Ct/1e3),setTimestampMillisecond=({values:xt},$t,Ct)=>setEpochMsToMillisecondsLong(xt,$t*2,Ct),setTimestampMicrosecond=({values:xt},$t,Ct)=>setEpochMsToMicrosecondsLong(xt,$t*2,Ct),setTimestampNanosecond=({values:xt},$t,Ct)=>setEpochMsToNanosecondsLong(xt,$t*2,Ct),setTimestamp=(xt,$t,Ct)=>{switch(xt.type.unit){case TimeUnit$2.SECOND:return setTimestampSecond(xt,$t,Ct);case TimeUnit$2.MILLISECOND:return setTimestampMillisecond(xt,$t,Ct);case TimeUnit$2.MICROSECOND:return setTimestampMicrosecond(xt,$t,Ct);case TimeUnit$2.NANOSECOND:return setTimestampNanosecond(xt,$t,Ct)}},setTimeSecond=({values:xt},$t,Ct)=>{xt[$t]=Ct},setTimeMillisecond=({values:xt},$t,Ct)=>{xt[$t]=Ct},setTimeMicrosecond=({values:xt},$t,Ct)=>{xt[$t]=Ct},setTimeNanosecond=({values:xt},$t,Ct)=>{xt[$t]=Ct},setTime=(xt,$t,Ct)=>{switch(xt.type.unit){case TimeUnit$2.SECOND:return setTimeSecond(xt,$t,Ct);case TimeUnit$2.MILLISECOND:return setTimeMillisecond(xt,$t,Ct);case TimeUnit$2.MICROSECOND:return setTimeMicrosecond(xt,$t,Ct);case TimeUnit$2.NANOSECOND:return setTimeNanosecond(xt,$t,Ct)}},setDecimal=({values:xt,stride:$t},Ct,kt)=>{xt.set(kt.subarray(0,$t),$t*Ct)},setList=(xt,$t,Ct)=>{const kt=xt.children[0],Mt=xt.valueOffsets,Ft=instance$7.getVisitFn(kt);if(Array.isArray(Ct))for(let jt=-1,Bt=Mt[$t],Vt=Mt[$t+1];Bt<Vt;)Ft(kt,Bt++,Ct[++jt]);else for(let jt=-1,Bt=Mt[$t],Vt=Mt[$t+1];Bt<Vt;)Ft(kt,Bt++,Ct.get(++jt))},setMap=(xt,$t,Ct)=>{const kt=xt.children[0],{valueOffsets:Mt}=xt,Ft=instance$7.getVisitFn(kt);let{[$t]:jt,[$t+1]:Bt}=Mt;const Vt=Ct instanceof Map?Ct.entries():Object.entries(Ct);for(const zt of Vt)if(Ft(kt,jt,zt),++jt>=Bt)break},_setStructArrayValue=(xt,$t)=>(Ct,kt,Mt,Ft)=>kt&&Ct(kt,xt,$t[Ft]),_setStructVectorValue=(xt,$t)=>(Ct,kt,Mt,Ft)=>kt&&Ct(kt,xt,$t.get(Ft)),_setStructMapValue=(xt,$t)=>(Ct,kt,Mt,Ft)=>kt&&Ct(kt,xt,$t.get(Mt.name)),_setStructObjectValue=(xt,$t)=>(Ct,kt,Mt,Ft)=>kt&&Ct(kt,xt,$t[Mt.name]),setStruct=(xt,$t,Ct)=>{const kt=xt.type.children.map(Ft=>instance$7.getVisitFn(Ft.type)),Mt=Ct instanceof Map?_setStructMapValue($t,Ct):Ct instanceof Vector?_setStructVectorValue($t,Ct):Array.isArray(Ct)?_setStructArrayValue($t,Ct):_setStructObjectValue($t,Ct);xt.type.children.forEach((Ft,jt)=>Mt(kt[jt],xt.children[jt],Ft,jt))},setUnion=(xt,$t,Ct)=>{xt.type.mode===UnionMode$1.Dense?setDenseUnion(xt,$t,Ct):setSparseUnion(xt,$t,Ct)},setDenseUnion=(xt,$t,Ct)=>{const kt=xt.type.typeIdToChildIndex[xt.typeIds[$t]],Mt=xt.children[kt];instance$7.visit(Mt,xt.valueOffsets[$t],Ct)},setSparseUnion=(xt,$t,Ct)=>{const kt=xt.type.typeIdToChildIndex[xt.typeIds[$t]],Mt=xt.children[kt];instance$7.visit(Mt,$t,Ct)},setDictionary=(xt,$t,Ct)=>{var kt;(kt=xt.dictionary)===null||kt===void 0||kt.set(xt.values[$t],Ct)},setIntervalValue=(xt,$t,Ct)=>{xt.type.unit===IntervalUnit$1.DAY_TIME?setIntervalDayTime(xt,$t,Ct):setIntervalYearMonth(xt,$t,Ct)},setIntervalDayTime=({values:xt},$t,Ct)=>{xt.set(Ct.subarray(0,2),2*$t)},setIntervalYearMonth=({values:xt},$t,Ct)=>{xt[$t]=Ct[0]*12+Ct[1]%12},setDurationSecond=({values:xt},$t,Ct)=>{xt[$t]=Ct},setDurationMillisecond=({values:xt},$t,Ct)=>{xt[$t]=Ct},setDurationMicrosecond=({values:xt},$t,Ct)=>{xt[$t]=Ct},setDurationNanosecond=({values:xt},$t,Ct)=>{xt[$t]=Ct},setDuration=(xt,$t,Ct)=>{switch(xt.type.unit){case TimeUnit$2.SECOND:return setDurationSecond(xt,$t,Ct);case TimeUnit$2.MILLISECOND:return setDurationMillisecond(xt,$t,Ct);case TimeUnit$2.MICROSECOND:return setDurationMicrosecond(xt,$t,Ct);case TimeUnit$2.NANOSECOND:return setDurationNanosecond(xt,$t,Ct)}},setFixedSizeList=(xt,$t,Ct)=>{const{stride:kt}=xt,Mt=xt.children[0],Ft=instance$7.getVisitFn(Mt);if(Array.isArray(Ct))for(let jt=-1,Bt=$t*kt;++jt<kt;)Ft(Mt,Bt+jt,Ct[jt]);else for(let jt=-1,Bt=$t*kt;++jt<kt;)Ft(Mt,Bt+jt,Ct.get(jt))};SetVisitor.prototype.visitBool=wrapSet(setBool);SetVisitor.prototype.visitInt=wrapSet(setInt);SetVisitor.prototype.visitInt8=wrapSet(setInt);SetVisitor.prototype.visitInt16=wrapSet(setInt);SetVisitor.prototype.visitInt32=wrapSet(setInt);SetVisitor.prototype.visitInt64=wrapSet(setInt);SetVisitor.prototype.visitUint8=wrapSet(setInt);SetVisitor.prototype.visitUint16=wrapSet(setInt);SetVisitor.prototype.visitUint32=wrapSet(setInt);SetVisitor.prototype.visitUint64=wrapSet(setInt);SetVisitor.prototype.visitFloat=wrapSet(setAnyFloat);SetVisitor.prototype.visitFloat16=wrapSet(setFloat16);SetVisitor.prototype.visitFloat32=wrapSet(setFloat);SetVisitor.prototype.visitFloat64=wrapSet(setFloat);SetVisitor.prototype.visitUtf8=wrapSet(setUtf8);SetVisitor.prototype.visitBinary=wrapSet(setBinary);SetVisitor.prototype.visitFixedSizeBinary=wrapSet(setFixedSizeBinary);SetVisitor.prototype.visitDate=wrapSet(setDate);SetVisitor.prototype.visitDateDay=wrapSet(setDateDay);SetVisitor.prototype.visitDateMillisecond=wrapSet(setDateMillisecond);SetVisitor.prototype.visitTimestamp=wrapSet(setTimestamp);SetVisitor.prototype.visitTimestampSecond=wrapSet(setTimestampSecond);SetVisitor.prototype.visitTimestampMillisecond=wrapSet(setTimestampMillisecond);SetVisitor.prototype.visitTimestampMicrosecond=wrapSet(setTimestampMicrosecond);SetVisitor.prototype.visitTimestampNanosecond=wrapSet(setTimestampNanosecond);SetVisitor.prototype.visitTime=wrapSet(setTime);SetVisitor.prototype.visitTimeSecond=wrapSet(setTimeSecond);SetVisitor.prototype.visitTimeMillisecond=wrapSet(setTimeMillisecond);SetVisitor.prototype.visitTimeMicrosecond=wrapSet(setTimeMicrosecond);SetVisitor.prototype.visitTimeNanosecond=wrapSet(setTimeNanosecond);SetVisitor.prototype.visitDecimal=wrapSet(setDecimal);SetVisitor.prototype.visitList=wrapSet(setList);SetVisitor.prototype.visitStruct=wrapSet(setStruct);SetVisitor.prototype.visitUnion=wrapSet(setUnion);SetVisitor.prototype.visitDenseUnion=wrapSet(setDenseUnion);SetVisitor.prototype.visitSparseUnion=wrapSet(setSparseUnion);SetVisitor.prototype.visitDictionary=wrapSet(setDictionary);SetVisitor.prototype.visitInterval=wrapSet(setIntervalValue);SetVisitor.prototype.visitIntervalDayTime=wrapSet(setIntervalDayTime);SetVisitor.prototype.visitIntervalYearMonth=wrapSet(setIntervalYearMonth);SetVisitor.prototype.visitDuration=wrapSet(setDuration);SetVisitor.prototype.visitDurationSecond=wrapSet(setDurationSecond);SetVisitor.prototype.visitDurationMillisecond=wrapSet(setDurationMillisecond);SetVisitor.prototype.visitDurationMicrosecond=wrapSet(setDurationMicrosecond);SetVisitor.prototype.visitDurationNanosecond=wrapSet(setDurationNanosecond);SetVisitor.prototype.visitFixedSizeList=wrapSet(setFixedSizeList);SetVisitor.prototype.visitMap=wrapSet(setMap);const instance$7=new SetVisitor,kParent=Symbol.for("parent"),kRowIndex=Symbol.for("rowIndex");class StructRow{constructor($t,Ct){return this[kParent]=$t,this[kRowIndex]=Ct,new Proxy(this,new StructRowProxyHandler)}toArray(){return Object.values(this.toJSON())}toJSON(){const $t=this[kRowIndex],Ct=this[kParent],kt=Ct.type.children,Mt={};for(let Ft=-1,jt=kt.length;++Ft<jt;)Mt[kt[Ft].name]=instance$6.visit(Ct.children[Ft],$t);return Mt}toString(){return`{${[...this].map(([$t,Ct])=>`${valueToString($t)}: ${valueToString(Ct)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new StructRowIterator(this[kParent],this[kRowIndex])}}class StructRowIterator{constructor($t,Ct){this.childIndex=0,this.children=$t.children,this.rowIndex=Ct,this.childFields=$t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const $t=this.childIndex;return $t<this.numChildren?(this.childIndex=$t+1,{done:!1,value:[this.childFields[$t].name,instance$6.visit(this.children[$t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(StructRow.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[kParent]:{writable:!0,enumerable:!1,configurable:!1,value:null},[kRowIndex]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class StructRowProxyHandler{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys($t){return $t[kParent].type.children.map(Ct=>Ct.name)}has($t,Ct){return $t[kParent].type.children.findIndex(kt=>kt.name===Ct)!==-1}getOwnPropertyDescriptor($t,Ct){if($t[kParent].type.children.findIndex(kt=>kt.name===Ct)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get($t,Ct){if(Reflect.has($t,Ct))return $t[Ct];const kt=$t[kParent].type.children.findIndex(Mt=>Mt.name===Ct);if(kt!==-1){const Mt=instance$6.visit($t[kParent].children[kt],$t[kRowIndex]);return Reflect.set($t,Ct,Mt),Mt}}set($t,Ct,kt){const Mt=$t[kParent].type.children.findIndex(Ft=>Ft.name===Ct);return Mt!==-1?(instance$7.visit($t[kParent].children[Mt],$t[kRowIndex],kt),Reflect.set($t,Ct,kt)):Reflect.has($t,Ct)||typeof Ct=="symbol"?Reflect.set($t,Ct,kt):!1}}class GetVisitor extends Visitor{}function wrapGet(xt){return($t,Ct)=>$t.getValid(Ct)?xt($t,Ct):null}const epochDaysToMs=(xt,$t)=>864e5*xt[$t],epochMillisecondsLongToMs=(xt,$t)=>4294967296*xt[$t+1]+(xt[$t]>>>0),epochMicrosecondsLongToMs=(xt,$t)=>4294967296*(xt[$t+1]/1e3)+(xt[$t]>>>0)/1e3,epochNanosecondsLongToMs=(xt,$t)=>4294967296*(xt[$t+1]/1e6)+(xt[$t]>>>0)/1e6,epochMillisecondsToDate=xt=>new Date(xt),epochDaysToDate=(xt,$t)=>epochMillisecondsToDate(epochDaysToMs(xt,$t)),epochMillisecondsLongToDate=(xt,$t)=>epochMillisecondsToDate(epochMillisecondsLongToMs(xt,$t)),getNull=(xt,$t)=>null,getVariableWidthBytes=(xt,$t,Ct)=>{if(Ct+1>=$t.length)return null;const kt=$t[Ct],Mt=$t[Ct+1];return xt.subarray(kt,Mt)},getBool$1=({offset:xt,values:$t},Ct)=>{const kt=xt+Ct;return($t[kt>>3]&1<<kt%8)!==0},getDateDay=({values:xt},$t)=>epochDaysToDate(xt,$t),getDateMillisecond=({values:xt},$t)=>epochMillisecondsLongToDate(xt,$t*2),getNumeric=({stride:xt,values:$t},Ct)=>$t[xt*Ct],getFloat16=({stride:xt,values:$t},Ct)=>uint16ToFloat64($t[xt*Ct]),getBigInts=({values:xt},$t)=>xt[$t],getFixedSizeBinary=({stride:xt,values:$t},Ct)=>$t.subarray(xt*Ct,xt*(Ct+1)),getBinary=({values:xt,valueOffsets:$t},Ct)=>getVariableWidthBytes(xt,$t,Ct),getUtf8=({values:xt,valueOffsets:$t},Ct)=>{const kt=getVariableWidthBytes(xt,$t,Ct);return kt!==null?decodeUtf8(kt):null},getInt=({values:xt},$t)=>xt[$t],getFloat=({type:xt,values:$t},Ct)=>xt.precision!==Precision$1.HALF?$t[Ct]:uint16ToFloat64($t[Ct]),getDate=(xt,$t)=>xt.type.unit===DateUnit$1.DAY?getDateDay(xt,$t):getDateMillisecond(xt,$t),getTimestampSecond=({values:xt},$t)=>1e3*epochMillisecondsLongToMs(xt,$t*2),getTimestampMillisecond=({values:xt},$t)=>epochMillisecondsLongToMs(xt,$t*2),getTimestampMicrosecond=({values:xt},$t)=>epochMicrosecondsLongToMs(xt,$t*2),getTimestampNanosecond=({values:xt},$t)=>epochNanosecondsLongToMs(xt,$t*2),getTimestamp=(xt,$t)=>{switch(xt.type.unit){case TimeUnit$2.SECOND:return getTimestampSecond(xt,$t);case TimeUnit$2.MILLISECOND:return getTimestampMillisecond(xt,$t);case TimeUnit$2.MICROSECOND:return getTimestampMicrosecond(xt,$t);case TimeUnit$2.NANOSECOND:return getTimestampNanosecond(xt,$t)}},getTimeSecond=({values:xt},$t)=>xt[$t],getTimeMillisecond=({values:xt},$t)=>xt[$t],getTimeMicrosecond=({values:xt},$t)=>xt[$t],getTimeNanosecond=({values:xt},$t)=>xt[$t],getTime=(xt,$t)=>{switch(xt.type.unit){case TimeUnit$2.SECOND:return getTimeSecond(xt,$t);case TimeUnit$2.MILLISECOND:return getTimeMillisecond(xt,$t);case TimeUnit$2.MICROSECOND:return getTimeMicrosecond(xt,$t);case TimeUnit$2.NANOSECOND:return getTimeNanosecond(xt,$t)}},getDecimal=({values:xt,stride:$t},Ct)=>BN.decimal(xt.subarray($t*Ct,$t*(Ct+1))),getList=(xt,$t)=>{const{valueOffsets:Ct,stride:kt,children:Mt}=xt,{[$t*kt]:Ft,[$t*kt+1]:jt}=Ct,Vt=Mt[0].slice(Ft,jt-Ft);return new Vector([Vt])},getMap=(xt,$t)=>{const{valueOffsets:Ct,children:kt}=xt,{[$t]:Mt,[$t+1]:Ft}=Ct,jt=kt[0];return new MapRow(jt.slice(Mt,Ft-Mt))},getStruct=(xt,$t)=>new StructRow(xt,$t),getUnion=(xt,$t)=>xt.type.mode===UnionMode$1.Dense?getDenseUnion(xt,$t):getSparseUnion(xt,$t),getDenseUnion=(xt,$t)=>{const Ct=xt.type.typeIdToChildIndex[xt.typeIds[$t]],kt=xt.children[Ct];return instance$6.visit(kt,xt.valueOffsets[$t])},getSparseUnion=(xt,$t)=>{const Ct=xt.type.typeIdToChildIndex[xt.typeIds[$t]],kt=xt.children[Ct];return instance$6.visit(kt,$t)},getDictionary=(xt,$t)=>{var Ct;return(Ct=xt.dictionary)===null||Ct===void 0?void 0:Ct.get(xt.values[$t])},getInterval=(xt,$t)=>xt.type.unit===IntervalUnit$1.DAY_TIME?getIntervalDayTime(xt,$t):getIntervalYearMonth(xt,$t),getIntervalDayTime=({values:xt},$t)=>xt.subarray(2*$t,2*($t+1)),getIntervalYearMonth=({values:xt},$t)=>{const Ct=xt[$t],kt=new Int32Array(2);return kt[0]=Math.trunc(Ct/12),kt[1]=Math.trunc(Ct%12),kt},getDurationSecond=({values:xt},$t)=>xt[$t],getDurationMillisecond=({values:xt},$t)=>xt[$t],getDurationMicrosecond=({values:xt},$t)=>xt[$t],getDurationNanosecond=({values:xt},$t)=>xt[$t],getDuration=(xt,$t)=>{switch(xt.type.unit){case TimeUnit$2.SECOND:return getDurationSecond(xt,$t);case TimeUnit$2.MILLISECOND:return getDurationMillisecond(xt,$t);case TimeUnit$2.MICROSECOND:return getDurationMicrosecond(xt,$t);case TimeUnit$2.NANOSECOND:return getDurationNanosecond(xt,$t)}},getFixedSizeList=(xt,$t)=>{const{stride:Ct,children:kt}=xt,Ft=kt[0].slice($t*Ct,Ct);return new Vector([Ft])};GetVisitor.prototype.visitNull=wrapGet(getNull);GetVisitor.prototype.visitBool=wrapGet(getBool$1);GetVisitor.prototype.visitInt=wrapGet(getInt);GetVisitor.prototype.visitInt8=wrapGet(getNumeric);GetVisitor.prototype.visitInt16=wrapGet(getNumeric);GetVisitor.prototype.visitInt32=wrapGet(getNumeric);GetVisitor.prototype.visitInt64=wrapGet(getBigInts);GetVisitor.prototype.visitUint8=wrapGet(getNumeric);GetVisitor.prototype.visitUint16=wrapGet(getNumeric);GetVisitor.prototype.visitUint32=wrapGet(getNumeric);GetVisitor.prototype.visitUint64=wrapGet(getBigInts);GetVisitor.prototype.visitFloat=wrapGet(getFloat);GetVisitor.prototype.visitFloat16=wrapGet(getFloat16);GetVisitor.prototype.visitFloat32=wrapGet(getNumeric);GetVisitor.prototype.visitFloat64=wrapGet(getNumeric);GetVisitor.prototype.visitUtf8=wrapGet(getUtf8);GetVisitor.prototype.visitBinary=wrapGet(getBinary);GetVisitor.prototype.visitFixedSizeBinary=wrapGet(getFixedSizeBinary);GetVisitor.prototype.visitDate=wrapGet(getDate);GetVisitor.prototype.visitDateDay=wrapGet(getDateDay);GetVisitor.prototype.visitDateMillisecond=wrapGet(getDateMillisecond);GetVisitor.prototype.visitTimestamp=wrapGet(getTimestamp);GetVisitor.prototype.visitTimestampSecond=wrapGet(getTimestampSecond);GetVisitor.prototype.visitTimestampMillisecond=wrapGet(getTimestampMillisecond);GetVisitor.prototype.visitTimestampMicrosecond=wrapGet(getTimestampMicrosecond);GetVisitor.prototype.visitTimestampNanosecond=wrapGet(getTimestampNanosecond);GetVisitor.prototype.visitTime=wrapGet(getTime);GetVisitor.prototype.visitTimeSecond=wrapGet(getTimeSecond);GetVisitor.prototype.visitTimeMillisecond=wrapGet(getTimeMillisecond);GetVisitor.prototype.visitTimeMicrosecond=wrapGet(getTimeMicrosecond);GetVisitor.prototype.visitTimeNanosecond=wrapGet(getTimeNanosecond);GetVisitor.prototype.visitDecimal=wrapGet(getDecimal);GetVisitor.prototype.visitList=wrapGet(getList);GetVisitor.prototype.visitStruct=wrapGet(getStruct);GetVisitor.prototype.visitUnion=wrapGet(getUnion);GetVisitor.prototype.visitDenseUnion=wrapGet(getDenseUnion);GetVisitor.prototype.visitSparseUnion=wrapGet(getSparseUnion);GetVisitor.prototype.visitDictionary=wrapGet(getDictionary);GetVisitor.prototype.visitInterval=wrapGet(getInterval);GetVisitor.prototype.visitIntervalDayTime=wrapGet(getIntervalDayTime);GetVisitor.prototype.visitIntervalYearMonth=wrapGet(getIntervalYearMonth);GetVisitor.prototype.visitDuration=wrapGet(getDuration);GetVisitor.prototype.visitDurationSecond=wrapGet(getDurationSecond);GetVisitor.prototype.visitDurationMillisecond=wrapGet(getDurationMillisecond);GetVisitor.prototype.visitDurationMicrosecond=wrapGet(getDurationMicrosecond);GetVisitor.prototype.visitDurationNanosecond=wrapGet(getDurationNanosecond);GetVisitor.prototype.visitFixedSizeList=wrapGet(getFixedSizeList);GetVisitor.prototype.visitMap=wrapGet(getMap);const instance$6=new GetVisitor,kKeys=Symbol.for("keys"),kVals=Symbol.for("vals");class MapRow{constructor($t){return this[kKeys]=new Vector([$t.children[0]]).memoize(),this[kVals]=$t.children[1],new Proxy(this,new MapRowProxyHandler)}[Symbol.iterator](){return new MapRowIterator(this[kKeys],this[kVals])}get size(){return this[kKeys].length}toArray(){return Object.values(this.toJSON())}toJSON(){const $t=this[kKeys],Ct=this[kVals],kt={};for(let Mt=-1,Ft=$t.length;++Mt<Ft;)kt[$t.get(Mt)]=instance$6.visit(Ct,Mt);return kt}toString(){return`{${[...this].map(([$t,Ct])=>`${valueToString($t)}: ${valueToString(Ct)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class MapRowIterator{constructor($t,Ct){this.keys=$t,this.vals=Ct,this.keyIndex=0,this.numKeys=$t.length}[Symbol.iterator](){return this}next(){const $t=this.keyIndex;return $t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get($t),instance$6.visit(this.vals,$t)]})}}class MapRowProxyHandler{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys($t){return $t[kKeys].toArray().map(String)}has($t,Ct){return $t[kKeys].includes(Ct)}getOwnPropertyDescriptor($t,Ct){if($t[kKeys].indexOf(Ct)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get($t,Ct){if(Reflect.has($t,Ct))return $t[Ct];const kt=$t[kKeys].indexOf(Ct);if(kt!==-1){const Mt=instance$6.visit(Reflect.get($t,kVals),kt);return Reflect.set($t,Ct,Mt),Mt}}set($t,Ct,kt){const Mt=$t[kKeys].indexOf(Ct);return Mt!==-1?(instance$7.visit(Reflect.get($t,kVals),Mt,kt),Reflect.set($t,Ct,kt)):Reflect.has($t,Ct)?Reflect.set($t,Ct,kt):!1}}Object.defineProperties(MapRow.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[kKeys]:{writable:!0,enumerable:!1,configurable:!1,value:null},[kVals]:{writable:!0,enumerable:!1,configurable:!1,value:null}});let tmp;function clampRange$1(xt,$t,Ct,kt){const{length:Mt=0}=xt;let Ft=typeof $t!="number"?0:$t,jt=typeof Ct!="number"?Mt:Ct;return Ft<0&&(Ft=(Ft%Mt+Mt)%Mt),jt<0&&(jt=(jt%Mt+Mt)%Mt),jt<Ft&&(tmp=Ft,Ft=jt,jt=tmp),jt>Mt&&(jt=Mt),kt?kt(xt,Ft,jt):[Ft,jt]}const isNaNFast=xt=>xt!==xt;function createElementComparator(xt){if(typeof xt!=="object"||xt===null)return isNaNFast(xt)?isNaNFast:Ct=>Ct===xt;if(xt instanceof Date){const Ct=xt.valueOf();return kt=>kt instanceof Date?kt.valueOf()===Ct:!1}return ArrayBuffer.isView(xt)?Ct=>Ct?compareArrayLike(xt,Ct):!1:xt instanceof Map?createMapComparator(xt):Array.isArray(xt)?createArrayLikeComparator(xt):xt instanceof Vector?createVectorComparator(xt):createObjectComparator(xt,!0)}function createArrayLikeComparator(xt){const $t=[];for(let Ct=-1,kt=xt.length;++Ct<kt;)$t[Ct]=createElementComparator(xt[Ct]);return createSubElementsComparator($t)}function createMapComparator(xt){let $t=-1;const Ct=[];for(const kt of xt.values())Ct[++$t]=createElementComparator(kt);return createSubElementsComparator(Ct)}function createVectorComparator(xt){const $t=[];for(let Ct=-1,kt=xt.length;++Ct<kt;)$t[Ct]=createElementComparator(xt.get(Ct));return createSubElementsComparator($t)}function createObjectComparator(xt,$t=!1){const Ct=Object.keys(xt);if(!$t&&Ct.length===0)return()=>!1;const kt=[];for(let Mt=-1,Ft=Ct.length;++Mt<Ft;)kt[Mt]=createElementComparator(xt[Ct[Mt]]);return createSubElementsComparator(kt,Ct)}function createSubElementsComparator(xt,$t){return Ct=>{if(!Ct||typeof Ct!="object")return!1;switch(Ct.constructor){case Array:return compareArray(xt,Ct);case Map:return compareObject(xt,Ct,Ct.keys());case MapRow:case StructRow:case Object:case void 0:return compareObject(xt,Ct,$t||Object.keys(Ct))}return Ct instanceof Vector?compareVector(xt,Ct):!1}}function compareArray(xt,$t){const Ct=xt.length;if($t.length!==Ct)return!1;for(let kt=-1;++kt<Ct;)if(!xt[kt]($t[kt]))return!1;return!0}function compareVector(xt,$t){const Ct=xt.length;if($t.length!==Ct)return!1;for(let kt=-1;++kt<Ct;)if(!xt[kt]($t.get(kt)))return!1;return!0}function compareObject(xt,$t,Ct){const kt=Ct[Symbol.iterator](),Mt=$t instanceof Map?$t.keys():Object.keys($t)[Symbol.iterator](),Ft=$t instanceof Map?$t.values():Object.values($t)[Symbol.iterator]();let jt=0;const Bt=xt.length;let Vt=Ft.next(),zt=kt.next(),Ht=Mt.next();for(;jt<Bt&&!zt.done&&!Ht.done&&!Vt.done&&!(zt.value!==Ht.value||!xt[jt](Vt.value));++jt,zt=kt.next(),Ht=Mt.next(),Vt=Ft.next());return jt===Bt&&zt.done&&Ht.done&&Vt.done?!0:(kt.return&&kt.return(),Mt.return&&Mt.return(),Ft.return&&Ft.return(),!1)}function getBool(xt,$t,Ct,kt){return(Ct&1<<kt)!==0}function getBit(xt,$t,Ct,kt){return(Ct&1<<kt)>>kt}function truncateBitmap(xt,$t,Ct){const kt=Ct.byteLength+7&-8;if(xt>0||Ct.byteLength<kt){const Mt=new Uint8Array(kt);return Mt.set(xt%8===0?Ct.subarray(xt>>3):packBools(new BitIterator(Ct,xt,$t,null,getBool)).subarray(0,kt)),Mt}return Ct}function packBools(xt){const $t=[];let Ct=0,kt=0,Mt=0;for(const jt of xt)jt&&(Mt|=1<<kt),++kt===8&&($t[Ct++]=Mt,Mt=kt=0);(Ct===0||kt>0)&&($t[Ct++]=Mt);const Ft=new Uint8Array($t.length+7&-8);return Ft.set($t),Ft}class BitIterator{constructor($t,Ct,kt,Mt,Ft){this.bytes=$t,this.length=kt,this.context=Mt,this.get=Ft,this.bit=Ct%8,this.byteIndex=Ct>>3,this.byte=$t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function popcnt_bit_range(xt,$t,Ct){if(Ct-$t<=0)return 0;if(Ct-$t<8){let Ft=0;for(const jt of new BitIterator(xt,$t,Ct-$t,xt,getBit))Ft+=jt;return Ft}const kt=Ct>>3<<3,Mt=$t+($t%8===0?0:8-$t%8);return popcnt_bit_range(xt,$t,Mt)+popcnt_bit_range(xt,kt,Ct)+popcnt_array(xt,Mt>>3,kt-Mt>>3)}function popcnt_array(xt,$t,Ct){let kt=0,Mt=Math.trunc($t);const Ft=new DataView(xt.buffer,xt.byteOffset,xt.byteLength),jt=Ct===void 0?xt.byteLength:Mt+Ct;for(;jt-Mt>=4;)kt+=popcnt_uint32(Ft.getUint32(Mt)),Mt+=4;for(;jt-Mt>=2;)kt+=popcnt_uint32(Ft.getUint16(Mt)),Mt+=2;for(;jt-Mt>=1;)kt+=popcnt_uint32(Ft.getUint8(Mt)),Mt+=1;return kt}function popcnt_uint32(xt){let $t=Math.trunc(xt);return $t=$t-($t>>>1&1431655765),$t=($t&858993459)+($t>>>2&858993459),($t+($t>>>4)&252645135)*16843009>>>24}const kUnknownNullCount=-1;class Data{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(this._nullCount!==0){const{type:$t}=this;return DataType$1.isSparseUnion($t)?this.children.some(Ct=>Ct.nullable):DataType$1.isDenseUnion($t)?this.children.some(Ct=>Ct.nullable):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let $t=0;const{valueOffsets:Ct,values:kt,nullBitmap:Mt,typeIds:Ft}=this;return Ct&&($t+=Ct.byteLength),kt&&($t+=kt.byteLength),Mt&&($t+=Mt.byteLength),Ft&&($t+=Ft.byteLength),this.children.reduce((jt,Bt)=>jt+Bt.byteLength,$t)}get nullCount(){if(DataType$1.isUnion(this.type))return this.children.reduce((kt,Mt)=>kt+Mt.nullCount,0);let $t=this._nullCount,Ct;return $t<=kUnknownNullCount&&(Ct=this.nullBitmap)&&(this._nullCount=$t=this.length-popcnt_bit_range(Ct,this.offset,this.offset+this.length)),$t}constructor($t,Ct,kt,Mt,Ft,jt=[],Bt){this.type=$t,this.children=jt,this.dictionary=Bt,this.offset=Math.floor(Math.max(Ct||0,0)),this.length=Math.floor(Math.max(kt||0,0)),this._nullCount=Math.floor(Math.max(Mt||0,-1));let Vt;Ft instanceof Data?(this.stride=Ft.stride,this.values=Ft.values,this.typeIds=Ft.typeIds,this.nullBitmap=Ft.nullBitmap,this.valueOffsets=Ft.valueOffsets):(this.stride=strideForType($t),Ft&&((Vt=Ft[0])&&(this.valueOffsets=Vt),(Vt=Ft[1])&&(this.values=Vt),(Vt=Ft[2])&&(this.nullBitmap=Vt),(Vt=Ft[3])&&(this.typeIds=Vt)))}getValid($t){const{type:Ct}=this;if(DataType$1.isUnion(Ct)){const kt=Ct,Mt=this.children[kt.typeIdToChildIndex[this.typeIds[$t]]],Ft=kt.mode===UnionMode$1.Dense?this.valueOffsets[$t]:$t;return Mt.getValid(Ft)}if(this.nullable&&this.nullCount>0){const kt=this.offset+$t;return(this.nullBitmap[kt>>3]&1<<kt%8)!==0}return!0}setValid($t,Ct){let kt;const{type:Mt}=this;if(DataType$1.isUnion(Mt)){const Ft=Mt,jt=this.children[Ft.typeIdToChildIndex[this.typeIds[$t]]],Bt=Ft.mode===UnionMode$1.Dense?this.valueOffsets[$t]:$t;kt=jt.getValid(Bt),jt.setValid(Bt,Ct)}else{let{nullBitmap:Ft}=this;const{offset:jt,length:Bt}=this,Vt=jt+$t,zt=1<<Vt%8,Ht=Vt>>3;(!Ft||Ft.byteLength<=Ht)&&(Ft=new Uint8Array((jt+Bt+63&-64)>>3).fill(255),this.nullCount>0&&Ft.set(truncateBitmap(jt,Bt,this.nullBitmap),0),Object.assign(this,{nullBitmap:Ft,_nullCount:-1}));const Gt=Ft[Ht];kt=(Gt&zt)!==0,Ct?Ft[Ht]=Gt|zt:Ft[Ht]=Gt&~zt}return kt!==!!Ct&&(this._nullCount=this.nullCount+(Ct?-1:1)),Ct}clone($t=this.type,Ct=this.offset,kt=this.length,Mt=this._nullCount,Ft=this,jt=this.children){return new Data($t,Ct,kt,Mt,Ft,jt,this.dictionary)}slice($t,Ct){const{stride:kt,typeId:Mt,children:Ft}=this,jt=+(this._nullCount===0)-1,Bt=Mt===16?kt:1,Vt=this._sliceBuffers($t,Ct,kt,Mt);return this.clone(this.type,this.offset+$t,Ct,jt,Vt,Ft.length===0||this.valueOffsets?Ft:this._sliceChildren(Ft,Bt*$t,Bt*Ct))}_changeLengthAndBackfillNullBitmap($t){if(this.typeId===Type$3.Null)return this.clone(this.type,0,$t,0);const{length:Ct,nullCount:kt}=this,Mt=new Uint8Array(($t+63&-64)>>3).fill(255,0,Ct>>3);Mt[Ct>>3]=(1<<Ct-(Ct&-8))-1,kt>0&&Mt.set(truncateBitmap(this.offset,Ct,this.nullBitmap),0);const Ft=this.buffers;return Ft[BufferType.VALIDITY]=Mt,this.clone(this.type,0,$t,kt+($t-Ct),Ft)}_sliceBuffers($t,Ct,kt,Mt){let Ft;const{buffers:jt}=this;return(Ft=jt[BufferType.TYPE])&&(jt[BufferType.TYPE]=Ft.subarray($t,$t+Ct)),(Ft=jt[BufferType.OFFSET])&&(jt[BufferType.OFFSET]=Ft.subarray($t,$t+Ct+1))||(Ft=jt[BufferType.DATA])&&(jt[BufferType.DATA]=Mt===6?Ft:Ft.subarray(kt*$t,kt*($t+Ct))),jt}_sliceChildren($t,Ct,kt){return $t.map(Mt=>Mt.slice(Ct,kt))}}Data.prototype.children=Object.freeze([]);class MakeDataVisitor extends Visitor{visit($t){return this.getVisitFn($t.type).call(this,$t)}visitNull($t){const{["type"]:Ct,["offset"]:kt=0,["length"]:Mt=0}=$t;return new Data(Ct,kt,Mt,Mt)}visitBool($t){const{["type"]:Ct,["offset"]:kt=0}=$t,Mt=toUint8Array($t.nullBitmap),Ft=toArrayBufferView(Ct.ArrayType,$t.data),{["length"]:jt=Ft.length>>3,["nullCount"]:Bt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,jt,Bt,[void 0,Ft,Mt])}visitInt($t){const{["type"]:Ct,["offset"]:kt=0}=$t,Mt=toUint8Array($t.nullBitmap),Ft=toArrayBufferView(Ct.ArrayType,$t.data),{["length"]:jt=Ft.length,["nullCount"]:Bt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,jt,Bt,[void 0,Ft,Mt])}visitFloat($t){const{["type"]:Ct,["offset"]:kt=0}=$t,Mt=toUint8Array($t.nullBitmap),Ft=toArrayBufferView(Ct.ArrayType,$t.data),{["length"]:jt=Ft.length,["nullCount"]:Bt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,jt,Bt,[void 0,Ft,Mt])}visitUtf8($t){const{["type"]:Ct,["offset"]:kt=0}=$t,Mt=toUint8Array($t.data),Ft=toUint8Array($t.nullBitmap),jt=toInt32Array($t.valueOffsets),{["length"]:Bt=jt.length-1,["nullCount"]:Vt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,Bt,Vt,[jt,Mt,Ft])}visitBinary($t){const{["type"]:Ct,["offset"]:kt=0}=$t,Mt=toUint8Array($t.data),Ft=toUint8Array($t.nullBitmap),jt=toInt32Array($t.valueOffsets),{["length"]:Bt=jt.length-1,["nullCount"]:Vt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,Bt,Vt,[jt,Mt,Ft])}visitFixedSizeBinary($t){const{["type"]:Ct,["offset"]:kt=0}=$t,Mt=toUint8Array($t.nullBitmap),Ft=toArrayBufferView(Ct.ArrayType,$t.data),{["length"]:jt=Ft.length/strideForType(Ct),["nullCount"]:Bt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,jt,Bt,[void 0,Ft,Mt])}visitDate($t){const{["type"]:Ct,["offset"]:kt=0}=$t,Mt=toUint8Array($t.nullBitmap),Ft=toArrayBufferView(Ct.ArrayType,$t.data),{["length"]:jt=Ft.length/strideForType(Ct),["nullCount"]:Bt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,jt,Bt,[void 0,Ft,Mt])}visitTimestamp($t){const{["type"]:Ct,["offset"]:kt=0}=$t,Mt=toUint8Array($t.nullBitmap),Ft=toArrayBufferView(Ct.ArrayType,$t.data),{["length"]:jt=Ft.length/strideForType(Ct),["nullCount"]:Bt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,jt,Bt,[void 0,Ft,Mt])}visitTime($t){const{["type"]:Ct,["offset"]:kt=0}=$t,Mt=toUint8Array($t.nullBitmap),Ft=toArrayBufferView(Ct.ArrayType,$t.data),{["length"]:jt=Ft.length/strideForType(Ct),["nullCount"]:Bt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,jt,Bt,[void 0,Ft,Mt])}visitDecimal($t){const{["type"]:Ct,["offset"]:kt=0}=$t,Mt=toUint8Array($t.nullBitmap),Ft=toArrayBufferView(Ct.ArrayType,$t.data),{["length"]:jt=Ft.length/strideForType(Ct),["nullCount"]:Bt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,jt,Bt,[void 0,Ft,Mt])}visitList($t){const{["type"]:Ct,["offset"]:kt=0,["child"]:Mt}=$t,Ft=toUint8Array($t.nullBitmap),jt=toInt32Array($t.valueOffsets),{["length"]:Bt=jt.length-1,["nullCount"]:Vt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,Bt,Vt,[jt,void 0,Ft],[Mt])}visitStruct($t){const{["type"]:Ct,["offset"]:kt=0,["children"]:Mt=[]}=$t,Ft=toUint8Array($t.nullBitmap),{length:jt=Mt.reduce((Vt,{length:zt})=>Math.max(Vt,zt),0),nullCount:Bt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,jt,Bt,[void 0,void 0,Ft],Mt)}visitUnion($t){const{["type"]:Ct,["offset"]:kt=0,["children"]:Mt=[]}=$t,Ft=toArrayBufferView(Ct.ArrayType,$t.typeIds),{["length"]:jt=Ft.length,["nullCount"]:Bt=-1}=$t;if(DataType$1.isSparseUnion(Ct))return new Data(Ct,kt,jt,Bt,[void 0,void 0,void 0,Ft],Mt);const Vt=toInt32Array($t.valueOffsets);return new Data(Ct,kt,jt,Bt,[Vt,void 0,void 0,Ft],Mt)}visitDictionary($t){const{["type"]:Ct,["offset"]:kt=0}=$t,Mt=toUint8Array($t.nullBitmap),Ft=toArrayBufferView(Ct.indices.ArrayType,$t.data),{["dictionary"]:jt=new Vector([new MakeDataVisitor().visit({type:Ct.dictionary})])}=$t,{["length"]:Bt=Ft.length,["nullCount"]:Vt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,Bt,Vt,[void 0,Ft,Mt],[],jt)}visitInterval($t){const{["type"]:Ct,["offset"]:kt=0}=$t,Mt=toUint8Array($t.nullBitmap),Ft=toArrayBufferView(Ct.ArrayType,$t.data),{["length"]:jt=Ft.length/strideForType(Ct),["nullCount"]:Bt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,jt,Bt,[void 0,Ft,Mt])}visitDuration($t){const{["type"]:Ct,["offset"]:kt=0}=$t,Mt=toUint8Array($t.nullBitmap),Ft=toArrayBufferView(Ct.ArrayType,$t.data),{["length"]:jt=Ft.length,["nullCount"]:Bt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,jt,Bt,[void 0,Ft,Mt])}visitFixedSizeList($t){const{["type"]:Ct,["offset"]:kt=0,["child"]:Mt=new MakeDataVisitor().visit({type:Ct.valueType})}=$t,Ft=toUint8Array($t.nullBitmap),{["length"]:jt=Mt.length/strideForType(Ct),["nullCount"]:Bt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,jt,Bt,[void 0,void 0,Ft],[Mt])}visitMap($t){const{["type"]:Ct,["offset"]:kt=0,["child"]:Mt=new MakeDataVisitor().visit({type:Ct.childType})}=$t,Ft=toUint8Array($t.nullBitmap),jt=toInt32Array($t.valueOffsets),{["length"]:Bt=jt.length-1,["nullCount"]:Vt=$t.nullBitmap?-1:0}=$t;return new Data(Ct,kt,Bt,Vt,[jt,void 0,Ft],[Mt])}}const makeDataVisitor=new MakeDataVisitor;function makeData(xt){return makeDataVisitor.visit(xt)}class ChunkedIterator{constructor($t=0,Ct){this.numChunks=$t,this.getChunkIterator=Ct,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const $t=this.chunkIterator.next();if(!$t.done)return $t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function computeChunkNullCounts(xt){return xt.reduce(($t,Ct)=>$t+Ct.nullCount,0)}function computeChunkOffsets(xt){return xt.reduce(($t,Ct,kt)=>($t[kt+1]=$t[kt]+Ct.length,$t),new Uint32Array(xt.length+1))}function sliceChunks(xt,$t,Ct,kt){const Mt=[];for(let Ft=-1,jt=xt.length;++Ft<jt;){const Bt=xt[Ft],Vt=$t[Ft],{length:zt}=Bt;if(Vt>=kt)break;if(Ct>=Vt+zt)continue;if(Vt>=Ct&&Vt+zt<=kt){Mt.push(Bt);continue}const Ht=Math.max(0,Ct-Vt),Gt=Math.min(kt-Vt,zt);Mt.push(Bt.slice(Ht,Gt-Ht))}return Mt.length===0&&Mt.push(xt[0].slice(0,0)),Mt}function binarySearch(xt,$t,Ct,kt){let Mt=0,Ft=0,jt=$t.length-1;do{if(Mt>=jt-1)return Ct<$t[jt]?kt(xt,Mt,Ct-$t[Mt]):null;Ft=Mt+Math.trunc((jt-Mt)*.5),Ct<$t[Ft]?jt=Ft:Mt=Ft}while(Mt<jt)}function isChunkedValid(xt,$t){return xt.getValid($t)}function wrapChunkedCall1(xt){function $t(Ct,kt,Mt){return xt(Ct[kt],Mt)}return function(Ct){const kt=this.data;return binarySearch(kt,this._offsets,Ct,$t)}}function wrapChunkedCall2(xt){let $t;function Ct(kt,Mt,Ft){return xt(kt[Mt],Ft,$t)}return function(kt,Mt){const Ft=this.data;$t=Mt;const jt=binarySearch(Ft,this._offsets,kt,Ct);return $t=void 0,jt}}function wrapChunkedIndexOf(xt){let $t;function Ct(kt,Mt,Ft){let jt=Ft,Bt=0,Vt=0;for(let zt=Mt-1,Ht=kt.length;++zt<Ht;){const Gt=kt[zt];if(~(Bt=xt(Gt,$t,jt)))return Vt+Bt;jt=0,Vt+=Gt.length}return-1}return function(kt,Mt){$t=kt;const Ft=this.data,jt=typeof Mt!="number"?Ct(Ft,0,0):binarySearch(Ft,this._offsets,Mt,Ct);return $t=void 0,jt}}class IndexOfVisitor extends Visitor{}function nullIndexOf(xt,$t){return $t===null&&xt.length>0?0:-1}function indexOfNull(xt,$t){const{nullBitmap:Ct}=xt;if(!Ct||xt.nullCount<=0)return-1;let kt=0;for(const Mt of new BitIterator(Ct,xt.offset+($t||0),xt.length,Ct,getBool)){if(!Mt)return kt;++kt}return-1}function indexOfValue(xt,$t,Ct){if($t===void 0)return-1;if($t===null)switch(xt.typeId){case Type$3.Union:break;case Type$3.Dictionary:break;default:return indexOfNull(xt,Ct)}const kt=instance$6.getVisitFn(xt),Mt=createElementComparator($t);for(let Ft=(Ct||0)-1,jt=xt.length;++Ft<jt;)if(Mt(kt(xt,Ft)))return Ft;return-1}function indexOfUnion(xt,$t,Ct){const kt=instance$6.getVisitFn(xt),Mt=createElementComparator($t);for(let Ft=(Ct||0)-1,jt=xt.length;++Ft<jt;)if(Mt(kt(xt,Ft)))return Ft;return-1}IndexOfVisitor.prototype.visitNull=nullIndexOf;IndexOfVisitor.prototype.visitBool=indexOfValue;IndexOfVisitor.prototype.visitInt=indexOfValue;IndexOfVisitor.prototype.visitInt8=indexOfValue;IndexOfVisitor.prototype.visitInt16=indexOfValue;IndexOfVisitor.prototype.visitInt32=indexOfValue;IndexOfVisitor.prototype.visitInt64=indexOfValue;IndexOfVisitor.prototype.visitUint8=indexOfValue;IndexOfVisitor.prototype.visitUint16=indexOfValue;IndexOfVisitor.prototype.visitUint32=indexOfValue;IndexOfVisitor.prototype.visitUint64=indexOfValue;IndexOfVisitor.prototype.visitFloat=indexOfValue;IndexOfVisitor.prototype.visitFloat16=indexOfValue;IndexOfVisitor.prototype.visitFloat32=indexOfValue;IndexOfVisitor.prototype.visitFloat64=indexOfValue;IndexOfVisitor.prototype.visitUtf8=indexOfValue;IndexOfVisitor.prototype.visitBinary=indexOfValue;IndexOfVisitor.prototype.visitFixedSizeBinary=indexOfValue;IndexOfVisitor.prototype.visitDate=indexOfValue;IndexOfVisitor.prototype.visitDateDay=indexOfValue;IndexOfVisitor.prototype.visitDateMillisecond=indexOfValue;IndexOfVisitor.prototype.visitTimestamp=indexOfValue;IndexOfVisitor.prototype.visitTimestampSecond=indexOfValue;IndexOfVisitor.prototype.visitTimestampMillisecond=indexOfValue;IndexOfVisitor.prototype.visitTimestampMicrosecond=indexOfValue;IndexOfVisitor.prototype.visitTimestampNanosecond=indexOfValue;IndexOfVisitor.prototype.visitTime=indexOfValue;IndexOfVisitor.prototype.visitTimeSecond=indexOfValue;IndexOfVisitor.prototype.visitTimeMillisecond=indexOfValue;IndexOfVisitor.prototype.visitTimeMicrosecond=indexOfValue;IndexOfVisitor.prototype.visitTimeNanosecond=indexOfValue;IndexOfVisitor.prototype.visitDecimal=indexOfValue;IndexOfVisitor.prototype.visitList=indexOfValue;IndexOfVisitor.prototype.visitStruct=indexOfValue;IndexOfVisitor.prototype.visitUnion=indexOfValue;IndexOfVisitor.prototype.visitDenseUnion=indexOfUnion;IndexOfVisitor.prototype.visitSparseUnion=indexOfUnion;IndexOfVisitor.prototype.visitDictionary=indexOfValue;IndexOfVisitor.prototype.visitInterval=indexOfValue;IndexOfVisitor.prototype.visitIntervalDayTime=indexOfValue;IndexOfVisitor.prototype.visitIntervalYearMonth=indexOfValue;IndexOfVisitor.prototype.visitDuration=indexOfValue;IndexOfVisitor.prototype.visitDurationSecond=indexOfValue;IndexOfVisitor.prototype.visitDurationMillisecond=indexOfValue;IndexOfVisitor.prototype.visitDurationMicrosecond=indexOfValue;IndexOfVisitor.prototype.visitDurationNanosecond=indexOfValue;IndexOfVisitor.prototype.visitFixedSizeList=indexOfValue;IndexOfVisitor.prototype.visitMap=indexOfValue;const instance$5=new IndexOfVisitor;class IteratorVisitor extends Visitor{}function vectorIterator(xt){const{type:$t}=xt;if(xt.nullCount===0&&xt.stride===1&&($t.typeId===Type$3.Timestamp||$t instanceof Int_&&$t.bitWidth!==64||$t instanceof Time_&&$t.bitWidth!==64||$t instanceof Float&&$t.precision!==Precision$1.HALF))return new ChunkedIterator(xt.data.length,kt=>{const Mt=xt.data[kt];return Mt.values.subarray(0,Mt.length)[Symbol.iterator]()});let Ct=0;return new ChunkedIterator(xt.data.length,kt=>{const Ft=xt.data[kt].length,jt=xt.slice(Ct,Ct+Ft);return Ct+=Ft,new VectorIterator(jt)})}class VectorIterator{constructor($t){this.vector=$t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}IteratorVisitor.prototype.visitNull=vectorIterator;IteratorVisitor.prototype.visitBool=vectorIterator;IteratorVisitor.prototype.visitInt=vectorIterator;IteratorVisitor.prototype.visitInt8=vectorIterator;IteratorVisitor.prototype.visitInt16=vectorIterator;IteratorVisitor.prototype.visitInt32=vectorIterator;IteratorVisitor.prototype.visitInt64=vectorIterator;IteratorVisitor.prototype.visitUint8=vectorIterator;IteratorVisitor.prototype.visitUint16=vectorIterator;IteratorVisitor.prototype.visitUint32=vectorIterator;IteratorVisitor.prototype.visitUint64=vectorIterator;IteratorVisitor.prototype.visitFloat=vectorIterator;IteratorVisitor.prototype.visitFloat16=vectorIterator;IteratorVisitor.prototype.visitFloat32=vectorIterator;IteratorVisitor.prototype.visitFloat64=vectorIterator;IteratorVisitor.prototype.visitUtf8=vectorIterator;IteratorVisitor.prototype.visitBinary=vectorIterator;IteratorVisitor.prototype.visitFixedSizeBinary=vectorIterator;IteratorVisitor.prototype.visitDate=vectorIterator;IteratorVisitor.prototype.visitDateDay=vectorIterator;IteratorVisitor.prototype.visitDateMillisecond=vectorIterator;IteratorVisitor.prototype.visitTimestamp=vectorIterator;IteratorVisitor.prototype.visitTimestampSecond=vectorIterator;IteratorVisitor.prototype.visitTimestampMillisecond=vectorIterator;IteratorVisitor.prototype.visitTimestampMicrosecond=vectorIterator;IteratorVisitor.prototype.visitTimestampNanosecond=vectorIterator;IteratorVisitor.prototype.visitTime=vectorIterator;IteratorVisitor.prototype.visitTimeSecond=vectorIterator;IteratorVisitor.prototype.visitTimeMillisecond=vectorIterator;IteratorVisitor.prototype.visitTimeMicrosecond=vectorIterator;IteratorVisitor.prototype.visitTimeNanosecond=vectorIterator;IteratorVisitor.prototype.visitDecimal=vectorIterator;IteratorVisitor.prototype.visitList=vectorIterator;IteratorVisitor.prototype.visitStruct=vectorIterator;IteratorVisitor.prototype.visitUnion=vectorIterator;IteratorVisitor.prototype.visitDenseUnion=vectorIterator;IteratorVisitor.prototype.visitSparseUnion=vectorIterator;IteratorVisitor.prototype.visitDictionary=vectorIterator;IteratorVisitor.prototype.visitInterval=vectorIterator;IteratorVisitor.prototype.visitIntervalDayTime=vectorIterator;IteratorVisitor.prototype.visitIntervalYearMonth=vectorIterator;IteratorVisitor.prototype.visitDuration=vectorIterator;IteratorVisitor.prototype.visitDurationSecond=vectorIterator;IteratorVisitor.prototype.visitDurationMillisecond=vectorIterator;IteratorVisitor.prototype.visitDurationMicrosecond=vectorIterator;IteratorVisitor.prototype.visitDurationNanosecond=vectorIterator;IteratorVisitor.prototype.visitFixedSizeList=vectorIterator;IteratorVisitor.prototype.visitMap=vectorIterator;const instance$4=new IteratorVisitor,sum=(xt,$t)=>xt+$t;class GetByteLengthVisitor extends Visitor{visitNull($t,Ct){return 0}visitInt($t,Ct){return $t.type.bitWidth/8}visitFloat($t,Ct){return $t.type.ArrayType.BYTES_PER_ELEMENT}visitBool($t,Ct){return 1/8}visitDecimal($t,Ct){return $t.type.bitWidth/8}visitDate($t,Ct){return($t.type.unit+1)*4}visitTime($t,Ct){return $t.type.bitWidth/8}visitTimestamp($t,Ct){return $t.type.unit===TimeUnit$2.SECOND?4:8}visitInterval($t,Ct){return($t.type.unit+1)*4}visitDuration($t,Ct){return 8}visitStruct($t,Ct){return $t.children.reduce((kt,Mt)=>kt+instance$3.visit(Mt,Ct),0)}visitFixedSizeBinary($t,Ct){return $t.type.byteWidth}visitMap($t,Ct){return 8+$t.children.reduce((kt,Mt)=>kt+instance$3.visit(Mt,Ct),0)}visitDictionary($t,Ct){var kt;return $t.type.indices.bitWidth/8+(((kt=$t.dictionary)===null||kt===void 0?void 0:kt.getByteLength($t.values[Ct]))||0)}}const getUtf8ByteLength=({valueOffsets:xt},$t)=>8+(xt[$t+1]-xt[$t]),getBinaryByteLength=({valueOffsets:xt},$t)=>8+(xt[$t+1]-xt[$t]),getListByteLength=({valueOffsets:xt,stride:$t,children:Ct},kt)=>{const Mt=Ct[0],{[kt*$t]:Ft}=xt,{[kt*$t+1]:jt}=xt,Bt=instance$3.getVisitFn(Mt.type),Vt=Mt.slice(Ft,jt-Ft);let zt=8;for(let Ht=-1,Gt=jt-Ft;++Ht<Gt;)zt+=Bt(Vt,Ht);return zt},getFixedSizeListByteLength=({stride:xt,children:$t},Ct)=>{const kt=$t[0],Mt=kt.slice(Ct*xt,xt),Ft=instance$3.getVisitFn(kt.type);let jt=0;for(let Bt=-1,Vt=Mt.length;++Bt<Vt;)jt+=Ft(Mt,Bt);return jt},getUnionByteLength=(xt,$t)=>xt.type.mode===UnionMode$1.Dense?getDenseUnionByteLength(xt,$t):getSparseUnionByteLength(xt,$t),getDenseUnionByteLength=({type:xt,children:$t,typeIds:Ct,valueOffsets:kt},Mt)=>{const Ft=xt.typeIdToChildIndex[Ct[Mt]];return 8+instance$3.visit($t[Ft],kt[Mt])},getSparseUnionByteLength=({children:xt},$t)=>4+instance$3.visitMany(xt,xt.map(()=>$t)).reduce(sum,0);GetByteLengthVisitor.prototype.visitUtf8=getUtf8ByteLength;GetByteLengthVisitor.prototype.visitBinary=getBinaryByteLength;GetByteLengthVisitor.prototype.visitList=getListByteLength;GetByteLengthVisitor.prototype.visitFixedSizeList=getFixedSizeListByteLength;GetByteLengthVisitor.prototype.visitUnion=getUnionByteLength;GetByteLengthVisitor.prototype.visitDenseUnion=getDenseUnionByteLength;GetByteLengthVisitor.prototype.visitSparseUnion=getSparseUnionByteLength;const instance$3=new GetByteLengthVisitor;var _a$2;const visitorsByTypeId={},vectorPrototypesByTypeId={};class Vector{constructor($t){var Ct,kt,Mt;const Ft=$t[0]instanceof Vector?$t.flatMap(Bt=>Bt.data):$t;if(Ft.length===0||Ft.some(Bt=>!(Bt instanceof Data)))throw new TypeError("Vector constructor expects an Array of Data instances.");const jt=(Ct=Ft[0])===null||Ct===void 0?void 0:Ct.type;switch(Ft.length){case 0:this._offsets=[0];break;case 1:{const{get:Bt,set:Vt,indexOf:zt,byteLength:Ht}=visitorsByTypeId[jt.typeId],Gt=Ft[0];this.isValid=qt=>isChunkedValid(Gt,qt),this.get=qt=>Bt(Gt,qt),this.set=(qt,Wt)=>Vt(Gt,qt,Wt),this.indexOf=qt=>zt(Gt,qt),this.getByteLength=qt=>Ht(Gt,qt),this._offsets=[0,Gt.length];break}default:Object.setPrototypeOf(this,vectorPrototypesByTypeId[jt.typeId]),this._offsets=computeChunkOffsets(Ft);break}this.data=Ft,this.type=jt,this.stride=strideForType(jt),this.numChildren=(Mt=(kt=jt.children)===null||kt===void 0?void 0:kt.length)!==null&&Mt!==void 0?Mt:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce(($t,Ct)=>$t+Ct.byteLength,0)}get nullCount(){return computeChunkNullCounts(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${Type$3[this.type.typeId]}Vector`}isValid($t){return!1}get($t){return null}set($t,Ct){}indexOf($t,Ct){return-1}includes($t,Ct){return this.indexOf($t,Ct)>-1}getByteLength($t){return 0}[Symbol.iterator](){return instance$4.visit(this)}concat(...$t){return new Vector(this.data.concat($t.flatMap(Ct=>Ct.data).flat(Number.POSITIVE_INFINITY)))}slice($t,Ct){return new Vector(clampRange$1(this,$t,Ct,({data:kt,_offsets:Mt},Ft,jt)=>sliceChunks(kt,Mt,Ft,jt)))}toJSON(){return[...this]}toArray(){const{type:$t,data:Ct,length:kt,stride:Mt,ArrayType:Ft}=this;switch($t.typeId){case Type$3.Int:case Type$3.Float:case Type$3.Decimal:case Type$3.Time:case Type$3.Timestamp:switch(Ct.length){case 0:return new Ft;case 1:return Ct[0].values.subarray(0,kt*Mt);default:return Ct.reduce((jt,{values:Bt,length:Vt})=>(jt.array.set(Bt.subarray(0,Vt*Mt),jt.offset),jt.offset+=Vt*Mt,jt),{array:new Ft(kt*Mt),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild($t){var Ct;return this.getChildAt((Ct=this.type.children)===null||Ct===void 0?void 0:Ct.findIndex(kt=>kt.name===$t))}getChildAt($t){return $t>-1&&$t<this.numChildren?new Vector(this.data.map(({children:Ct})=>Ct[$t])):null}get isMemoized(){return DataType$1.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(DataType$1.isDictionary(this.type)){const $t=new MemoizedVector(this.data[0].dictionary),Ct=this.data.map(kt=>{const Mt=kt.clone();return Mt.dictionary=$t,Mt});return new Vector(Ct)}return new MemoizedVector(this)}unmemoize(){if(DataType$1.isDictionary(this.type)&&this.isMemoized){const $t=this.data[0].dictionary.unmemoize(),Ct=this.data.map(kt=>{const Mt=kt.clone();return Mt.dictionary=$t,Mt});return new Vector(Ct)}return this}}_a$2=Symbol.toStringTag;Vector[_a$2]=(xt=>{xt.type=DataType$1.prototype,xt.data=[],xt.length=0,xt.stride=1,xt.numChildren=0,xt._offsets=new Uint32Array([0]),xt[Symbol.isConcatSpreadable]=!0;const $t=Object.keys(Type$3).map(Ct=>Type$3[Ct]).filter(Ct=>typeof Ct=="number"&&Ct!==Type$3.NONE);for(const Ct of $t){const kt=instance$6.getVisitFnByTypeId(Ct),Mt=instance$7.getVisitFnByTypeId(Ct),Ft=instance$5.getVisitFnByTypeId(Ct),jt=instance$3.getVisitFnByTypeId(Ct);visitorsByTypeId[Ct]={get:kt,set:Mt,indexOf:Ft,byteLength:jt},vectorPrototypesByTypeId[Ct]=Object.create(xt,{isValid:{value:wrapChunkedCall1(isChunkedValid)},get:{value:wrapChunkedCall1(instance$6.getVisitFnByTypeId(Ct))},set:{value:wrapChunkedCall2(instance$7.getVisitFnByTypeId(Ct))},indexOf:{value:wrapChunkedIndexOf(instance$5.getVisitFnByTypeId(Ct))},getByteLength:{value:wrapChunkedCall1(instance$3.getVisitFnByTypeId(Ct))}})}return"Vector"})(Vector.prototype);class MemoizedVector extends Vector{constructor($t){super($t.data);const Ct=this.get,kt=this.set,Mt=this.slice,Ft=new Array(this.length);Object.defineProperty(this,"get",{value(jt){const Bt=Ft[jt];if(Bt!==void 0)return Bt;const Vt=Ct.call(this,jt);return Ft[jt]=Vt,Vt}}),Object.defineProperty(this,"set",{value(jt,Bt){kt.call(this,jt,Bt),Ft[jt]=Bt}}),Object.defineProperty(this,"slice",{value:(jt,Bt)=>new MemoizedVector(Mt.call(this,jt,Bt))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new Vector(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}function createIsValidFunction(xt){if(!xt||xt.length<=0)return function(Mt){return!0};let $t="";const Ct=xt.filter(kt=>kt===kt);return Ct.length>0&&($t=`
    switch (x) {${Ct.map(kt=>`
        case ${valueToCase(kt)}:`).join("")}
            return false;
    }`),xt.length!==Ct.length&&($t=`if (x !== x) return false;
${$t}`),new Function("x",`${$t}
return true;`)}function valueToCase(xt){return typeof xt!="bigint"?valueToString(xt):`${valueToString(xt)}n`}const roundLengthUpToNearest64Bytes=(xt,$t)=>(Math.ceil(xt)*$t+63&-64||64)/$t,sliceOrExtendArray=(xt,$t=0)=>xt.length>=$t?xt.subarray(0,$t):memcpy(new xt.constructor($t),xt,0);class BufferBuilder{constructor($t,Ct=1){this.buffer=$t,this.stride=Ct,this.BYTES_PER_ELEMENT=$t.BYTES_PER_ELEMENT,this.ArrayType=$t.constructor,this._resize(this.length=Math.ceil($t.length/Ct))}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set($t,Ct){return this}append($t){return this.set(this.length,$t)}reserve($t){if($t>0){this.length+=$t;const Ct=this.stride,kt=this.length*Ct,Mt=this.buffer.length;kt>=Mt&&this._resize(Mt===0?roundLengthUpToNearest64Bytes(kt*1,this.BYTES_PER_ELEMENT):roundLengthUpToNearest64Bytes(kt*2,this.BYTES_PER_ELEMENT))}return this}flush($t=this.length){$t=roundLengthUpToNearest64Bytes($t*this.stride,this.BYTES_PER_ELEMENT);const Ct=sliceOrExtendArray(this.buffer,$t);return this.clear(),Ct}clear(){return this.length=0,this._resize(0),this}_resize($t){return this.buffer=memcpy(new this.ArrayType($t),this.buffer)}}BufferBuilder.prototype.offset=0;class DataBufferBuilder extends BufferBuilder{last(){return this.get(this.length-1)}get($t){return this.buffer[$t]}set($t,Ct){return this.reserve($t-this.length+1),this.buffer[$t*this.stride]=Ct,this}}class BitmapBufferBuilder extends DataBufferBuilder{constructor($t=new Uint8Array(0)){super($t,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get($t){return this.buffer[$t>>3]>>$t%8&1}set($t,Ct){const{buffer:kt}=this.reserve($t-this.length+1),Mt=$t>>3,Ft=$t%8,jt=kt[Mt]>>Ft&1;return Ct?jt===0&&(kt[Mt]|=1<<Ft,++this.numValid):jt===1&&(kt[Mt]&=~(1<<Ft),--this.numValid),this}clear(){return this.numValid=0,super.clear()}}class OffsetsBufferBuilder extends DataBufferBuilder{constructor($t=new Int32Array(1)){super($t,1)}append($t){return this.set(this.length-1,$t)}set($t,Ct){const kt=this.length-1,Mt=this.reserve($t-kt+1).buffer;return kt<$t++&&Mt.fill(Mt[kt],kt,$t),Mt[$t]=Mt[$t-1]+Ct,this}flush($t=this.length-1){return $t>this.length&&this.set($t-1,0),super.flush($t+1)}}let Builder$3=class{static throughNode($t){throw new Error('"throughNode" not available in this environment')}static throughDOM($t){throw new Error('"throughDOM" not available in this environment')}constructor({type:$t,nullValues:Ct}){this.length=0,this.finished=!1,this.type=$t,this.children=[],this.nullValues=Ct,this.stride=strideForType($t),this._nulls=new BitmapBufferBuilder,Ct&&Ct.length>0&&(this._isValid=createIsValidFunction(Ct))}toVector(){return new Vector([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let $t=0;const{_offsets:Ct,_values:kt,_nulls:Mt,_typeIds:Ft,children:jt}=this;return Ct&&($t+=Ct.byteLength),kt&&($t+=kt.byteLength),Mt&&($t+=Mt.byteLength),Ft&&($t+=Ft.byteLength),jt.reduce((Bt,Vt)=>Bt+Vt.byteLength,$t)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let $t=0;return this._offsets&&($t+=this._offsets.reservedByteLength),this._values&&($t+=this._values.reservedByteLength),this._nulls&&($t+=this._nulls.reservedByteLength),this._typeIds&&($t+=this._typeIds.reservedByteLength),this.children.reduce((Ct,kt)=>Ct+kt.reservedByteLength,$t)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append($t){return this.set(this.length,$t)}isValid($t){return this._isValid($t)}set($t,Ct){return this.setValid($t,this.isValid(Ct))&&this.setValue($t,Ct),this}setValue($t,Ct){this._setValue(this,$t,Ct)}setValid($t,Ct){return this.length=this._nulls.set($t,+Ct).length,Ct}addChild($t,Ct=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt($t){return this.children[$t]||null}flush(){let $t,Ct,kt,Mt;const{type:Ft,length:jt,nullCount:Bt,_typeIds:Vt,_offsets:zt,_values:Ht,_nulls:Gt}=this;(Ct=Vt==null?void 0:Vt.flush(jt))?Mt=zt==null?void 0:zt.flush(jt):(Mt=zt==null?void 0:zt.flush(jt))?$t=Ht==null?void 0:Ht.flush(zt.last()):$t=Ht==null?void 0:Ht.flush(jt),Bt>0&&(kt=Gt==null?void 0:Gt.flush(jt));const qt=this.children.map(Wt=>Wt.flush());return this.clear(),makeData({type:Ft,length:jt,nullCount:Bt,children:qt,child:qt[0],data:$t,typeIds:Ct,nullBitmap:kt,valueOffsets:Mt})}finish(){this.finished=!0;for(const $t of this.children)$t.finish();return this}clear(){var $t,Ct,kt,Mt;this.length=0,($t=this._nulls)===null||$t===void 0||$t.clear(),(Ct=this._values)===null||Ct===void 0||Ct.clear(),(kt=this._offsets)===null||kt===void 0||kt.clear(),(Mt=this._typeIds)===null||Mt===void 0||Mt.clear();for(const Ft of this.children)Ft.clear();return this}};Builder$3.prototype.length=1;Builder$3.prototype.stride=1;Builder$3.prototype.children=null;Builder$3.prototype.finished=!1;Builder$3.prototype.nullValues=null;Builder$3.prototype._isValid=()=>!0;class FixedWidthBuilder extends Builder$3{constructor($t){super($t),this._values=new DataBufferBuilder(new this.ArrayType(0),this.stride)}setValue($t,Ct){const kt=this._values;return kt.reserve($t-kt.length+1),super.setValue($t,Ct)}}class VariableWidthBuilder extends Builder$3{constructor($t){super($t),this._pendingLength=0,this._offsets=new OffsetsBufferBuilder}setValue($t,Ct){const kt=this._pending||(this._pending=new Map),Mt=kt.get($t);Mt&&(this._pendingLength-=Mt.length),this._pendingLength+=Ct instanceof MapRow?Ct[kKeys].length:Ct.length,kt.set($t,Ct)}setValid($t,Ct){return super.setValid($t,Ct)?!0:((this._pending||(this._pending=new Map)).set($t,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){const $t=this._pending,Ct=this._pendingLength;return this._pendingLength=0,this._pending=void 0,$t&&$t.size>0&&this._flushPending($t,Ct),this}}class Block{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock($t,Ct,kt,Mt){return $t.prep(8,24),$t.writeInt64(BigInt(Mt??0)),$t.pad(4),$t.writeInt32(kt),$t.writeInt64(BigInt(Ct??0)),$t.offset()}}const SIZEOF_SHORT=2,SIZEOF_INT=4,FILE_IDENTIFIER_LENGTH=4,SIZE_PREFIX_LENGTH=4,int32=new Int32Array(2),float32=new Float32Array(int32.buffer),float64=new Float64Array(int32.buffer),isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var Encoding;(function(xt){xt[xt.UTF8_BYTES=1]="UTF8_BYTES",xt[xt.UTF16_STRING=2]="UTF16_STRING"})(Encoding||(Encoding={}));let ByteBuffer$2=class sp{constructor($t){this.bytes_=$t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate($t){return new sp(new Uint8Array($t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition($t){this.position_=$t}capacity(){return this.bytes_.length}readInt8($t){return this.readUint8($t)<<24>>24}readUint8($t){return this.bytes_[$t]}readInt16($t){return this.readUint16($t)<<16>>16}readUint16($t){return this.bytes_[$t]|this.bytes_[$t+1]<<8}readInt32($t){return this.bytes_[$t]|this.bytes_[$t+1]<<8|this.bytes_[$t+2]<<16|this.bytes_[$t+3]<<24}readUint32($t){return this.readInt32($t)>>>0}readInt64($t){return BigInt.asIntN(64,BigInt(this.readUint32($t))+(BigInt(this.readUint32($t+4))<<BigInt(32)))}readUint64($t){return BigInt.asUintN(64,BigInt(this.readUint32($t))+(BigInt(this.readUint32($t+4))<<BigInt(32)))}readFloat32($t){return int32[0]=this.readInt32($t),float32[0]}readFloat64($t){return int32[isLittleEndian?0:1]=this.readInt32($t),int32[isLittleEndian?1:0]=this.readInt32($t+4),float64[0]}writeInt8($t,Ct){this.bytes_[$t]=Ct}writeUint8($t,Ct){this.bytes_[$t]=Ct}writeInt16($t,Ct){this.bytes_[$t]=Ct,this.bytes_[$t+1]=Ct>>8}writeUint16($t,Ct){this.bytes_[$t]=Ct,this.bytes_[$t+1]=Ct>>8}writeInt32($t,Ct){this.bytes_[$t]=Ct,this.bytes_[$t+1]=Ct>>8,this.bytes_[$t+2]=Ct>>16,this.bytes_[$t+3]=Ct>>24}writeUint32($t,Ct){this.bytes_[$t]=Ct,this.bytes_[$t+1]=Ct>>8,this.bytes_[$t+2]=Ct>>16,this.bytes_[$t+3]=Ct>>24}writeInt64($t,Ct){this.writeInt32($t,Number(BigInt.asIntN(32,Ct))),this.writeInt32($t+4,Number(BigInt.asIntN(32,Ct>>BigInt(32))))}writeUint64($t,Ct){this.writeUint32($t,Number(BigInt.asUintN(32,Ct))),this.writeUint32($t+4,Number(BigInt.asUintN(32,Ct>>BigInt(32))))}writeFloat32($t,Ct){float32[0]=Ct,this.writeInt32($t,int32[0])}writeFloat64($t,Ct){float64[0]=Ct,this.writeInt32($t,int32[isLittleEndian?0:1]),this.writeInt32($t+4,int32[isLittleEndian?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+SIZEOF_INT+FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let $t="";for(let Ct=0;Ct<FILE_IDENTIFIER_LENGTH;Ct++)$t+=String.fromCharCode(this.readInt8(this.position_+SIZEOF_INT+Ct));return $t}__offset($t,Ct){const kt=$t-this.readInt32($t);return Ct<this.readInt16(kt)?this.readInt16(kt+Ct):0}__union($t,Ct){return $t.bb_pos=Ct+this.readInt32(Ct),$t.bb=this,$t}__string($t,Ct){$t+=this.readInt32($t);const kt=this.readInt32($t);$t+=SIZEOF_INT;const Mt=this.bytes_.subarray($t,$t+kt);return Ct===Encoding.UTF8_BYTES?Mt:this.text_decoder_.decode(Mt)}__union_with_string($t,Ct){return typeof $t=="string"?this.__string(Ct):this.__union($t,Ct)}__indirect($t){return $t+this.readInt32($t)}__vector($t){return $t+this.readInt32($t)+SIZEOF_INT}__vector_len($t){return this.readInt32($t+this.readInt32($t))}__has_identifier($t){if($t.length!=FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+FILE_IDENTIFIER_LENGTH);for(let Ct=0;Ct<FILE_IDENTIFIER_LENGTH;Ct++)if($t.charCodeAt(Ct)!=this.readInt8(this.position()+SIZEOF_INT+Ct))return!1;return!0}createScalarList($t,Ct){const kt=[];for(let Mt=0;Mt<Ct;++Mt){const Ft=$t(Mt);Ft!==null&&kt.push(Ft)}return kt}createObjList($t,Ct){const kt=[];for(let Mt=0;Mt<Ct;++Mt){const Ft=$t(Mt);Ft!==null&&kt.push(Ft.unpack())}return kt}},Builder$2=class ap{constructor($t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let Ct;$t?Ct=$t:Ct=1024,this.bb=ByteBuffer$2.allocate(Ct),this.space=Ct}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults($t){this.force_defaults=$t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep($t,Ct){$t>this.minalign&&(this.minalign=$t);const kt=~(this.bb.capacity()-this.space+Ct)+1&$t-1;for(;this.space<kt+$t+Ct;){const Mt=this.bb.capacity();this.bb=ap.growByteBuffer(this.bb),this.space+=this.bb.capacity()-Mt}this.pad(kt)}pad($t){for(let Ct=0;Ct<$t;Ct++)this.bb.writeInt8(--this.space,0)}writeInt8($t){this.bb.writeInt8(this.space-=1,$t)}writeInt16($t){this.bb.writeInt16(this.space-=2,$t)}writeInt32($t){this.bb.writeInt32(this.space-=4,$t)}writeInt64($t){this.bb.writeInt64(this.space-=8,$t)}writeFloat32($t){this.bb.writeFloat32(this.space-=4,$t)}writeFloat64($t){this.bb.writeFloat64(this.space-=8,$t)}addInt8($t){this.prep(1,0),this.writeInt8($t)}addInt16($t){this.prep(2,0),this.writeInt16($t)}addInt32($t){this.prep(4,0),this.writeInt32($t)}addInt64($t){this.prep(8,0),this.writeInt64($t)}addFloat32($t){this.prep(4,0),this.writeFloat32($t)}addFloat64($t){this.prep(8,0),this.writeFloat64($t)}addFieldInt8($t,Ct,kt){(this.force_defaults||Ct!=kt)&&(this.addInt8(Ct),this.slot($t))}addFieldInt16($t,Ct,kt){(this.force_defaults||Ct!=kt)&&(this.addInt16(Ct),this.slot($t))}addFieldInt32($t,Ct,kt){(this.force_defaults||Ct!=kt)&&(this.addInt32(Ct),this.slot($t))}addFieldInt64($t,Ct,kt){(this.force_defaults||Ct!==kt)&&(this.addInt64(Ct),this.slot($t))}addFieldFloat32($t,Ct,kt){(this.force_defaults||Ct!=kt)&&(this.addFloat32(Ct),this.slot($t))}addFieldFloat64($t,Ct,kt){(this.force_defaults||Ct!=kt)&&(this.addFloat64(Ct),this.slot($t))}addFieldOffset($t,Ct,kt){(this.force_defaults||Ct!=kt)&&(this.addOffset(Ct),this.slot($t))}addFieldStruct($t,Ct,kt){Ct!=kt&&(this.nested(Ct),this.slot($t))}nested($t){if($t!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot($t){this.vtable!==null&&(this.vtable[$t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer($t){const Ct=$t.capacity();if(Ct&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const kt=Ct<<1,Mt=ByteBuffer$2.allocate(kt);return Mt.setPosition(kt-Ct),Mt.bytes().set($t.bytes(),kt-Ct),Mt}addOffset($t){this.prep(SIZEOF_INT,0),this.writeInt32(this.offset()-$t+SIZEOF_INT)}startObject($t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=$t;for(let Ct=0;Ct<$t;Ct++)this.vtable[Ct]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const $t=this.offset();let Ct=this.vtable_in_use-1;for(;Ct>=0&&this.vtable[Ct]==0;Ct--);const kt=Ct+1;for(;Ct>=0;Ct--)this.addInt16(this.vtable[Ct]!=0?$t-this.vtable[Ct]:0);const Mt=2;this.addInt16($t-this.object_start);const Ft=(kt+Mt)*SIZEOF_SHORT;this.addInt16(Ft);let jt=0;const Bt=this.space;e:for(Ct=0;Ct<this.vtables.length;Ct++){const Vt=this.bb.capacity()-this.vtables[Ct];if(Ft==this.bb.readInt16(Vt)){for(let zt=SIZEOF_SHORT;zt<Ft;zt+=SIZEOF_SHORT)if(this.bb.readInt16(Bt+zt)!=this.bb.readInt16(Vt+zt))continue e;jt=this.vtables[Ct];break}}return jt?(this.space=this.bb.capacity()-$t,this.bb.writeInt32(this.space,jt-$t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-$t,this.offset()-$t)),this.isNested=!1,$t}finish($t,Ct,kt){const Mt=kt?SIZE_PREFIX_LENGTH:0;if(Ct){const Ft=Ct;if(this.prep(this.minalign,SIZEOF_INT+FILE_IDENTIFIER_LENGTH+Mt),Ft.length!=FILE_IDENTIFIER_LENGTH)throw new TypeError("FlatBuffers: file identifier must be length "+FILE_IDENTIFIER_LENGTH);for(let jt=FILE_IDENTIFIER_LENGTH-1;jt>=0;jt--)this.writeInt8(Ft.charCodeAt(jt))}this.prep(this.minalign,SIZEOF_INT+Mt),this.addOffset($t),Mt&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed($t,Ct){this.finish($t,Ct,!0)}requiredField($t,Ct){const kt=this.bb.capacity()-$t,Mt=kt-this.bb.readInt32(kt);if(!(Ct<this.bb.readInt16(Mt)&&this.bb.readInt16(Mt+Ct)!=0))throw new TypeError("FlatBuffers: field "+Ct+" must be set")}startVector($t,Ct,kt){this.notNested(),this.vector_num_elems=Ct,this.prep(SIZEOF_INT,$t*Ct),this.prep(kt,$t*Ct)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString($t){if(!$t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has($t))return this.string_maps.get($t);const Ct=this.createString($t);return this.string_maps.set($t,Ct),Ct}createString($t){if($t==null)return 0;let Ct;$t instanceof Uint8Array?Ct=$t:Ct=this.text_encoder.encode($t),this.addInt8(0),this.startVector(1,Ct.length,1),this.bb.setPosition(this.space-=Ct.length);for(let kt=0,Mt=this.space,Ft=this.bb.bytes();kt<Ct.length;kt++)Ft[Mt++]=Ct[kt];return this.endVector()}createObjectOffset($t){return $t===null?0:typeof $t=="string"?this.createString($t):$t.pack(this)}createObjectOffsetList($t){const Ct=[];for(let kt=0;kt<$t.length;++kt){const Mt=$t[kt];if(Mt!==null)Ct.push(this.createObjectOffset(Mt));else throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return Ct}createStructOffsetList($t,Ct){return Ct(this,$t.length),this.createObjectOffsetList($t.slice().reverse()),this.endVector()}};class KeyValue{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsKeyValue($t,Ct){return(Ct||new KeyValue).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsKeyValue($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new KeyValue).__init($t.readInt32($t.position())+$t.position(),$t)}key($t){const Ct=this.bb.__offset(this.bb_pos,4);return Ct?this.bb.__string(this.bb_pos+Ct,$t):null}value($t){const Ct=this.bb.__offset(this.bb_pos,6);return Ct?this.bb.__string(this.bb_pos+Ct,$t):null}static startKeyValue($t){$t.startObject(2)}static addKey($t,Ct){$t.addFieldOffset(0,Ct,0)}static addValue($t,Ct){$t.addFieldOffset(1,Ct,0)}static endKeyValue($t){return $t.endObject()}static createKeyValue($t,Ct,kt){return KeyValue.startKeyValue($t),KeyValue.addKey($t,Ct),KeyValue.addValue($t,kt),KeyValue.endKeyValue($t)}}var MetadataVersion;(function(xt){xt[xt.V1=0]="V1",xt[xt.V2=1]="V2",xt[xt.V3=2]="V3",xt[xt.V4=3]="V4",xt[xt.V5=4]="V5"})(MetadataVersion||(MetadataVersion={}));var Endianness;(function(xt){xt[xt.Little=0]="Little",xt[xt.Big=1]="Big"})(Endianness||(Endianness={}));var DictionaryKind;(function(xt){xt[xt.DenseArray=0]="DenseArray"})(DictionaryKind||(DictionaryKind={}));class Int{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsInt($t,Ct){return(Ct||new Int).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsInt($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Int).__init($t.readInt32($t.position())+$t.position(),$t)}bitWidth(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt32(this.bb_pos+$t):0}isSigned(){const $t=this.bb.__offset(this.bb_pos,6);return $t?!!this.bb.readInt8(this.bb_pos+$t):!1}static startInt($t){$t.startObject(2)}static addBitWidth($t,Ct){$t.addFieldInt32(0,Ct,0)}static addIsSigned($t,Ct){$t.addFieldInt8(1,+Ct,0)}static endInt($t){return $t.endObject()}static createInt($t,Ct,kt){return Int.startInt($t),Int.addBitWidth($t,Ct),Int.addIsSigned($t,kt),Int.endInt($t)}}class DictionaryEncoding{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsDictionaryEncoding($t,Ct){return(Ct||new DictionaryEncoding).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsDictionaryEncoding($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new DictionaryEncoding).__init($t.readInt32($t.position())+$t.position(),$t)}id(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt64(this.bb_pos+$t):BigInt("0")}indexType($t){const Ct=this.bb.__offset(this.bb_pos,6);return Ct?($t||new Int).__init(this.bb.__indirect(this.bb_pos+Ct),this.bb):null}isOrdered(){const $t=this.bb.__offset(this.bb_pos,8);return $t?!!this.bb.readInt8(this.bb_pos+$t):!1}dictionaryKind(){const $t=this.bb.__offset(this.bb_pos,10);return $t?this.bb.readInt16(this.bb_pos+$t):DictionaryKind.DenseArray}static startDictionaryEncoding($t){$t.startObject(4)}static addId($t,Ct){$t.addFieldInt64(0,Ct,BigInt("0"))}static addIndexType($t,Ct){$t.addFieldOffset(1,Ct,0)}static addIsOrdered($t,Ct){$t.addFieldInt8(2,+Ct,0)}static addDictionaryKind($t,Ct){$t.addFieldInt16(3,Ct,DictionaryKind.DenseArray)}static endDictionaryEncoding($t){return $t.endObject()}}class Binary{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsBinary($t,Ct){return(Ct||new Binary).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsBinary($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Binary).__init($t.readInt32($t.position())+$t.position(),$t)}static startBinary($t){$t.startObject(0)}static endBinary($t){return $t.endObject()}static createBinary($t){return Binary.startBinary($t),Binary.endBinary($t)}}class Bool{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsBool($t,Ct){return(Ct||new Bool).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsBool($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Bool).__init($t.readInt32($t.position())+$t.position(),$t)}static startBool($t){$t.startObject(0)}static endBool($t){return $t.endObject()}static createBool($t){return Bool.startBool($t),Bool.endBool($t)}}var DateUnit;(function(xt){xt[xt.DAY=0]="DAY",xt[xt.MILLISECOND=1]="MILLISECOND"})(DateUnit||(DateUnit={}));let Date$1=class Jl{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsDate($t,Ct){return(Ct||new Jl).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsDate($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Jl).__init($t.readInt32($t.position())+$t.position(),$t)}unit(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt16(this.bb_pos+$t):DateUnit.MILLISECOND}static startDate($t){$t.startObject(1)}static addUnit($t,Ct){$t.addFieldInt16(0,Ct,DateUnit.MILLISECOND)}static endDate($t){return $t.endObject()}static createDate($t,Ct){return Jl.startDate($t),Jl.addUnit($t,Ct),Jl.endDate($t)}};class Decimal{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsDecimal($t,Ct){return(Ct||new Decimal).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsDecimal($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Decimal).__init($t.readInt32($t.position())+$t.position(),$t)}precision(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt32(this.bb_pos+$t):0}scale(){const $t=this.bb.__offset(this.bb_pos,6);return $t?this.bb.readInt32(this.bb_pos+$t):0}bitWidth(){const $t=this.bb.__offset(this.bb_pos,8);return $t?this.bb.readInt32(this.bb_pos+$t):128}static startDecimal($t){$t.startObject(3)}static addPrecision($t,Ct){$t.addFieldInt32(0,Ct,0)}static addScale($t,Ct){$t.addFieldInt32(1,Ct,0)}static addBitWidth($t,Ct){$t.addFieldInt32(2,Ct,128)}static endDecimal($t){return $t.endObject()}static createDecimal($t,Ct,kt,Mt){return Decimal.startDecimal($t),Decimal.addPrecision($t,Ct),Decimal.addScale($t,kt),Decimal.addBitWidth($t,Mt),Decimal.endDecimal($t)}}var TimeUnit$1;(function(xt){xt[xt.SECOND=0]="SECOND",xt[xt.MILLISECOND=1]="MILLISECOND",xt[xt.MICROSECOND=2]="MICROSECOND",xt[xt.NANOSECOND=3]="NANOSECOND"})(TimeUnit$1||(TimeUnit$1={}));class Duration{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsDuration($t,Ct){return(Ct||new Duration).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsDuration($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Duration).__init($t.readInt32($t.position())+$t.position(),$t)}unit(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt16(this.bb_pos+$t):TimeUnit$1.MILLISECOND}static startDuration($t){$t.startObject(1)}static addUnit($t,Ct){$t.addFieldInt16(0,Ct,TimeUnit$1.MILLISECOND)}static endDuration($t){return $t.endObject()}static createDuration($t,Ct){return Duration.startDuration($t),Duration.addUnit($t,Ct),Duration.endDuration($t)}}class FixedSizeBinary{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsFixedSizeBinary($t,Ct){return(Ct||new FixedSizeBinary).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsFixedSizeBinary($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new FixedSizeBinary).__init($t.readInt32($t.position())+$t.position(),$t)}byteWidth(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt32(this.bb_pos+$t):0}static startFixedSizeBinary($t){$t.startObject(1)}static addByteWidth($t,Ct){$t.addFieldInt32(0,Ct,0)}static endFixedSizeBinary($t){return $t.endObject()}static createFixedSizeBinary($t,Ct){return FixedSizeBinary.startFixedSizeBinary($t),FixedSizeBinary.addByteWidth($t,Ct),FixedSizeBinary.endFixedSizeBinary($t)}}class FixedSizeList{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsFixedSizeList($t,Ct){return(Ct||new FixedSizeList).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsFixedSizeList($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new FixedSizeList).__init($t.readInt32($t.position())+$t.position(),$t)}listSize(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt32(this.bb_pos+$t):0}static startFixedSizeList($t){$t.startObject(1)}static addListSize($t,Ct){$t.addFieldInt32(0,Ct,0)}static endFixedSizeList($t){return $t.endObject()}static createFixedSizeList($t,Ct){return FixedSizeList.startFixedSizeList($t),FixedSizeList.addListSize($t,Ct),FixedSizeList.endFixedSizeList($t)}}var Precision;(function(xt){xt[xt.HALF=0]="HALF",xt[xt.SINGLE=1]="SINGLE",xt[xt.DOUBLE=2]="DOUBLE"})(Precision||(Precision={}));class FloatingPoint{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsFloatingPoint($t,Ct){return(Ct||new FloatingPoint).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsFloatingPoint($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new FloatingPoint).__init($t.readInt32($t.position())+$t.position(),$t)}precision(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt16(this.bb_pos+$t):Precision.HALF}static startFloatingPoint($t){$t.startObject(1)}static addPrecision($t,Ct){$t.addFieldInt16(0,Ct,Precision.HALF)}static endFloatingPoint($t){return $t.endObject()}static createFloatingPoint($t,Ct){return FloatingPoint.startFloatingPoint($t),FloatingPoint.addPrecision($t,Ct),FloatingPoint.endFloatingPoint($t)}}var IntervalUnit;(function(xt){xt[xt.YEAR_MONTH=0]="YEAR_MONTH",xt[xt.DAY_TIME=1]="DAY_TIME",xt[xt.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(IntervalUnit||(IntervalUnit={}));class Interval{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsInterval($t,Ct){return(Ct||new Interval).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsInterval($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Interval).__init($t.readInt32($t.position())+$t.position(),$t)}unit(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt16(this.bb_pos+$t):IntervalUnit.YEAR_MONTH}static startInterval($t){$t.startObject(1)}static addUnit($t,Ct){$t.addFieldInt16(0,Ct,IntervalUnit.YEAR_MONTH)}static endInterval($t){return $t.endObject()}static createInterval($t,Ct){return Interval.startInterval($t),Interval.addUnit($t,Ct),Interval.endInterval($t)}}class List{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsList($t,Ct){return(Ct||new List).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsList($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new List).__init($t.readInt32($t.position())+$t.position(),$t)}static startList($t){$t.startObject(0)}static endList($t){return $t.endObject()}static createList($t){return List.startList($t),List.endList($t)}}let Map$1=class Zl{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsMap($t,Ct){return(Ct||new Zl).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsMap($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Zl).__init($t.readInt32($t.position())+$t.position(),$t)}keysSorted(){const $t=this.bb.__offset(this.bb_pos,4);return $t?!!this.bb.readInt8(this.bb_pos+$t):!1}static startMap($t){$t.startObject(1)}static addKeysSorted($t,Ct){$t.addFieldInt8(0,+Ct,0)}static endMap($t){return $t.endObject()}static createMap($t,Ct){return Zl.startMap($t),Zl.addKeysSorted($t,Ct),Zl.endMap($t)}};class Null{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsNull($t,Ct){return(Ct||new Null).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsNull($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Null).__init($t.readInt32($t.position())+$t.position(),$t)}static startNull($t){$t.startObject(0)}static endNull($t){return $t.endObject()}static createNull($t){return Null.startNull($t),Null.endNull($t)}}class Struct_{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsStruct_($t,Ct){return(Ct||new Struct_).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsStruct_($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Struct_).__init($t.readInt32($t.position())+$t.position(),$t)}static startStruct_($t){$t.startObject(0)}static endStruct_($t){return $t.endObject()}static createStruct_($t){return Struct_.startStruct_($t),Struct_.endStruct_($t)}}let Time$1=class Hl{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsTime($t,Ct){return(Ct||new Hl).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsTime($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Hl).__init($t.readInt32($t.position())+$t.position(),$t)}unit(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt16(this.bb_pos+$t):TimeUnit$1.MILLISECOND}bitWidth(){const $t=this.bb.__offset(this.bb_pos,6);return $t?this.bb.readInt32(this.bb_pos+$t):32}static startTime($t){$t.startObject(2)}static addUnit($t,Ct){$t.addFieldInt16(0,Ct,TimeUnit$1.MILLISECOND)}static addBitWidth($t,Ct){$t.addFieldInt32(1,Ct,32)}static endTime($t){return $t.endObject()}static createTime($t,Ct,kt){return Hl.startTime($t),Hl.addUnit($t,Ct),Hl.addBitWidth($t,kt),Hl.endTime($t)}},Timestamp$1=class Gl{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsTimestamp($t,Ct){return(Ct||new Gl).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsTimestamp($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Gl).__init($t.readInt32($t.position())+$t.position(),$t)}unit(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt16(this.bb_pos+$t):TimeUnit$1.SECOND}timezone($t){const Ct=this.bb.__offset(this.bb_pos,6);return Ct?this.bb.__string(this.bb_pos+Ct,$t):null}static startTimestamp($t){$t.startObject(2)}static addUnit($t,Ct){$t.addFieldInt16(0,Ct,TimeUnit$1.SECOND)}static addTimezone($t,Ct){$t.addFieldOffset(1,Ct,0)}static endTimestamp($t){return $t.endObject()}static createTimestamp($t,Ct,kt){return Gl.startTimestamp($t),Gl.addUnit($t,Ct),Gl.addTimezone($t,kt),Gl.endTimestamp($t)}};var UnionMode;(function(xt){xt[xt.Sparse=0]="Sparse",xt[xt.Dense=1]="Dense"})(UnionMode||(UnionMode={}));let Union$1=class Wl{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsUnion($t,Ct){return(Ct||new Wl).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsUnion($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Wl).__init($t.readInt32($t.position())+$t.position(),$t)}mode(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt16(this.bb_pos+$t):UnionMode.Sparse}typeIds($t){const Ct=this.bb.__offset(this.bb_pos,6);return Ct?this.bb.readInt32(this.bb.__vector(this.bb_pos+Ct)+$t*4):0}typeIdsLength(){const $t=this.bb.__offset(this.bb_pos,6);return $t?this.bb.__vector_len(this.bb_pos+$t):0}typeIdsArray(){const $t=this.bb.__offset(this.bb_pos,6);return $t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+$t),this.bb.__vector_len(this.bb_pos+$t)):null}static startUnion($t){$t.startObject(2)}static addMode($t,Ct){$t.addFieldInt16(0,Ct,UnionMode.Sparse)}static addTypeIds($t,Ct){$t.addFieldOffset(1,Ct,0)}static createTypeIdsVector($t,Ct){$t.startVector(4,Ct.length,4);for(let kt=Ct.length-1;kt>=0;kt--)$t.addInt32(Ct[kt]);return $t.endVector()}static startTypeIdsVector($t,Ct){$t.startVector(4,Ct,4)}static endUnion($t){return $t.endObject()}static createUnion($t,Ct,kt){return Wl.startUnion($t),Wl.addMode($t,Ct),Wl.addTypeIds($t,kt),Wl.endUnion($t)}};class Utf8{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsUtf8($t,Ct){return(Ct||new Utf8).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsUtf8($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Utf8).__init($t.readInt32($t.position())+$t.position(),$t)}static startUtf8($t){$t.startObject(0)}static endUtf8($t){return $t.endObject()}static createUtf8($t){return Utf8.startUtf8($t),Utf8.endUtf8($t)}}var Type$2;(function(xt){xt[xt.NONE=0]="NONE",xt[xt.Null=1]="Null",xt[xt.Int=2]="Int",xt[xt.FloatingPoint=3]="FloatingPoint",xt[xt.Binary=4]="Binary",xt[xt.Utf8=5]="Utf8",xt[xt.Bool=6]="Bool",xt[xt.Decimal=7]="Decimal",xt[xt.Date=8]="Date",xt[xt.Time=9]="Time",xt[xt.Timestamp=10]="Timestamp",xt[xt.Interval=11]="Interval",xt[xt.List=12]="List",xt[xt.Struct_=13]="Struct_",xt[xt.Union=14]="Union",xt[xt.FixedSizeBinary=15]="FixedSizeBinary",xt[xt.FixedSizeList=16]="FixedSizeList",xt[xt.Map=17]="Map",xt[xt.Duration=18]="Duration",xt[xt.LargeBinary=19]="LargeBinary",xt[xt.LargeUtf8=20]="LargeUtf8",xt[xt.LargeList=21]="LargeList",xt[xt.RunEndEncoded=22]="RunEndEncoded"})(Type$2||(Type$2={}));let Field$3=class du{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsField($t,Ct){return(Ct||new du).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsField($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new du).__init($t.readInt32($t.position())+$t.position(),$t)}name($t){const Ct=this.bb.__offset(this.bb_pos,4);return Ct?this.bb.__string(this.bb_pos+Ct,$t):null}nullable(){const $t=this.bb.__offset(this.bb_pos,6);return $t?!!this.bb.readInt8(this.bb_pos+$t):!1}typeType(){const $t=this.bb.__offset(this.bb_pos,8);return $t?this.bb.readUint8(this.bb_pos+$t):Type$2.NONE}type($t){const Ct=this.bb.__offset(this.bb_pos,10);return Ct?this.bb.__union($t,this.bb_pos+Ct):null}dictionary($t){const Ct=this.bb.__offset(this.bb_pos,12);return Ct?($t||new DictionaryEncoding).__init(this.bb.__indirect(this.bb_pos+Ct),this.bb):null}children($t,Ct){const kt=this.bb.__offset(this.bb_pos,14);return kt?(Ct||new du).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+kt)+$t*4),this.bb):null}childrenLength(){const $t=this.bb.__offset(this.bb_pos,14);return $t?this.bb.__vector_len(this.bb_pos+$t):0}customMetadata($t,Ct){const kt=this.bb.__offset(this.bb_pos,16);return kt?(Ct||new KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+kt)+$t*4),this.bb):null}customMetadataLength(){const $t=this.bb.__offset(this.bb_pos,16);return $t?this.bb.__vector_len(this.bb_pos+$t):0}static startField($t){$t.startObject(7)}static addName($t,Ct){$t.addFieldOffset(0,Ct,0)}static addNullable($t,Ct){$t.addFieldInt8(1,+Ct,0)}static addTypeType($t,Ct){$t.addFieldInt8(2,Ct,Type$2.NONE)}static addType($t,Ct){$t.addFieldOffset(3,Ct,0)}static addDictionary($t,Ct){$t.addFieldOffset(4,Ct,0)}static addChildren($t,Ct){$t.addFieldOffset(5,Ct,0)}static createChildrenVector($t,Ct){$t.startVector(4,Ct.length,4);for(let kt=Ct.length-1;kt>=0;kt--)$t.addOffset(Ct[kt]);return $t.endVector()}static startChildrenVector($t,Ct){$t.startVector(4,Ct,4)}static addCustomMetadata($t,Ct){$t.addFieldOffset(6,Ct,0)}static createCustomMetadataVector($t,Ct){$t.startVector(4,Ct.length,4);for(let kt=Ct.length-1;kt>=0;kt--)$t.addOffset(Ct[kt]);return $t.endVector()}static startCustomMetadataVector($t,Ct){$t.startVector(4,Ct,4)}static endField($t){return $t.endObject()}},Schema$1=class Pl{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsSchema($t,Ct){return(Ct||new Pl).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsSchema($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Pl).__init($t.readInt32($t.position())+$t.position(),$t)}endianness(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt16(this.bb_pos+$t):Endianness.Little}fields($t,Ct){const kt=this.bb.__offset(this.bb_pos,6);return kt?(Ct||new Field$3).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+kt)+$t*4),this.bb):null}fieldsLength(){const $t=this.bb.__offset(this.bb_pos,6);return $t?this.bb.__vector_len(this.bb_pos+$t):0}customMetadata($t,Ct){const kt=this.bb.__offset(this.bb_pos,8);return kt?(Ct||new KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+kt)+$t*4),this.bb):null}customMetadataLength(){const $t=this.bb.__offset(this.bb_pos,8);return $t?this.bb.__vector_len(this.bb_pos+$t):0}features($t){const Ct=this.bb.__offset(this.bb_pos,10);return Ct?this.bb.readInt64(this.bb.__vector(this.bb_pos+Ct)+$t*8):BigInt(0)}featuresLength(){const $t=this.bb.__offset(this.bb_pos,10);return $t?this.bb.__vector_len(this.bb_pos+$t):0}static startSchema($t){$t.startObject(4)}static addEndianness($t,Ct){$t.addFieldInt16(0,Ct,Endianness.Little)}static addFields($t,Ct){$t.addFieldOffset(1,Ct,0)}static createFieldsVector($t,Ct){$t.startVector(4,Ct.length,4);for(let kt=Ct.length-1;kt>=0;kt--)$t.addOffset(Ct[kt]);return $t.endVector()}static startFieldsVector($t,Ct){$t.startVector(4,Ct,4)}static addCustomMetadata($t,Ct){$t.addFieldOffset(2,Ct,0)}static createCustomMetadataVector($t,Ct){$t.startVector(4,Ct.length,4);for(let kt=Ct.length-1;kt>=0;kt--)$t.addOffset(Ct[kt]);return $t.endVector()}static startCustomMetadataVector($t,Ct){$t.startVector(4,Ct,4)}static addFeatures($t,Ct){$t.addFieldOffset(3,Ct,0)}static createFeaturesVector($t,Ct){$t.startVector(8,Ct.length,8);for(let kt=Ct.length-1;kt>=0;kt--)$t.addInt64(Ct[kt]);return $t.endVector()}static startFeaturesVector($t,Ct){$t.startVector(8,Ct,8)}static endSchema($t){return $t.endObject()}static finishSchemaBuffer($t,Ct){$t.finish(Ct)}static finishSizePrefixedSchemaBuffer($t,Ct){$t.finish(Ct,void 0,!0)}static createSchema($t,Ct,kt,Mt,Ft){return Pl.startSchema($t),Pl.addEndianness($t,Ct),Pl.addFields($t,kt),Pl.addCustomMetadata($t,Mt),Pl.addFeatures($t,Ft),Pl.endSchema($t)}};class Footer{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsFooter($t,Ct){return(Ct||new Footer).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsFooter($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Footer).__init($t.readInt32($t.position())+$t.position(),$t)}version(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt16(this.bb_pos+$t):MetadataVersion.V1}schema($t){const Ct=this.bb.__offset(this.bb_pos,6);return Ct?($t||new Schema$1).__init(this.bb.__indirect(this.bb_pos+Ct),this.bb):null}dictionaries($t,Ct){const kt=this.bb.__offset(this.bb_pos,8);return kt?(Ct||new Block).__init(this.bb.__vector(this.bb_pos+kt)+$t*24,this.bb):null}dictionariesLength(){const $t=this.bb.__offset(this.bb_pos,8);return $t?this.bb.__vector_len(this.bb_pos+$t):0}recordBatches($t,Ct){const kt=this.bb.__offset(this.bb_pos,10);return kt?(Ct||new Block).__init(this.bb.__vector(this.bb_pos+kt)+$t*24,this.bb):null}recordBatchesLength(){const $t=this.bb.__offset(this.bb_pos,10);return $t?this.bb.__vector_len(this.bb_pos+$t):0}customMetadata($t,Ct){const kt=this.bb.__offset(this.bb_pos,12);return kt?(Ct||new KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+kt)+$t*4),this.bb):null}customMetadataLength(){const $t=this.bb.__offset(this.bb_pos,12);return $t?this.bb.__vector_len(this.bb_pos+$t):0}static startFooter($t){$t.startObject(5)}static addVersion($t,Ct){$t.addFieldInt16(0,Ct,MetadataVersion.V1)}static addSchema($t,Ct){$t.addFieldOffset(1,Ct,0)}static addDictionaries($t,Ct){$t.addFieldOffset(2,Ct,0)}static startDictionariesVector($t,Ct){$t.startVector(24,Ct,8)}static addRecordBatches($t,Ct){$t.addFieldOffset(3,Ct,0)}static startRecordBatchesVector($t,Ct){$t.startVector(24,Ct,8)}static addCustomMetadata($t,Ct){$t.addFieldOffset(4,Ct,0)}static createCustomMetadataVector($t,Ct){$t.startVector(4,Ct.length,4);for(let kt=Ct.length-1;kt>=0;kt--)$t.addOffset(Ct[kt]);return $t.endVector()}static startCustomMetadataVector($t,Ct){$t.startVector(4,Ct,4)}static endFooter($t){return $t.endObject()}static finishFooterBuffer($t,Ct){$t.finish(Ct)}static finishSizePrefixedFooterBuffer($t,Ct){$t.finish(Ct,void 0,!0)}}class Schema{constructor($t=[],Ct,kt,Mt=MetadataVersion$1.V5){this.fields=$t||[],this.metadata=Ct||new Map,kt||(kt=generateDictionaryMap($t)),this.dictionaries=kt,this.metadataVersion=Mt}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map($t=>$t.name)}toString(){return`Schema<{ ${this.fields.map(($t,Ct)=>`${Ct}: ${$t}`).join(", ")} }>`}select($t){const Ct=new Set($t),kt=this.fields.filter(Mt=>Ct.has(Mt.name));return new Schema(kt,this.metadata)}selectAt($t){const Ct=$t.map(kt=>this.fields[kt]).filter(Boolean);return new Schema(Ct,this.metadata)}assign(...$t){const Ct=$t[0]instanceof Schema?$t[0]:Array.isArray($t[0])?new Schema($t[0]):new Schema($t),kt=[...this.fields],Mt=mergeMaps(mergeMaps(new Map,this.metadata),Ct.metadata),Ft=Ct.fields.filter(Bt=>{const Vt=kt.findIndex(zt=>zt.name===Bt.name);return~Vt?(kt[Vt]=Bt.clone({metadata:mergeMaps(mergeMaps(new Map,kt[Vt].metadata),Bt.metadata)}))&&!1:!0}),jt=generateDictionaryMap(Ft,new Map);return new Schema([...kt,...Ft],Mt,new Map([...this.dictionaries,...jt]))}}Schema.prototype.fields=null;Schema.prototype.metadata=null;Schema.prototype.dictionaries=null;let Field$2=class wu{static new(...$t){let[Ct,kt,Mt,Ft]=$t;return $t[0]&&typeof $t[0]=="object"&&({name:Ct}=$t[0],kt===void 0&&(kt=$t[0].type),Mt===void 0&&(Mt=$t[0].nullable),Ft===void 0&&(Ft=$t[0].metadata)),new wu(`${Ct}`,kt,Mt,Ft)}constructor($t,Ct,kt=!1,Mt){this.name=$t,this.type=Ct,this.nullable=kt,this.metadata=Mt||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...$t){let[Ct,kt,Mt,Ft]=$t;return!$t[0]||typeof $t[0]!="object"?[Ct=this.name,kt=this.type,Mt=this.nullable,Ft=this.metadata]=$t:{name:Ct=this.name,type:kt=this.type,nullable:Mt=this.nullable,metadata:Ft=this.metadata}=$t[0],wu.new(Ct,kt,Mt,Ft)}};Field$2.prototype.type=null;Field$2.prototype.name=null;Field$2.prototype.nullable=null;Field$2.prototype.metadata=null;function mergeMaps(xt,$t){return new Map([...xt||new Map,...$t||new Map])}function generateDictionaryMap(xt,$t=new Map){for(let Ct=-1,kt=xt.length;++Ct<kt;){const Ft=xt[Ct].type;if(DataType$1.isDictionary(Ft)){if(!$t.has(Ft.id))$t.set(Ft.id,Ft.dictionary);else if($t.get(Ft.id)!==Ft.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}Ft.children&&Ft.children.length>0&&generateDictionaryMap(Ft.children,$t)}return $t}var Builder$1=Builder$2,ByteBuffer$1=ByteBuffer$2;class Footer_{static decode($t){$t=new ByteBuffer$1(toUint8Array($t));const Ct=Footer.getRootAsFooter($t),kt=Schema.decode(Ct.schema(),new Map,Ct.version());return new OffHeapFooter(kt,Ct)}static encode($t){const Ct=new Builder$1,kt=Schema.encode(Ct,$t.schema);Footer.startRecordBatchesVector(Ct,$t.numRecordBatches);for(const jt of[...$t.recordBatches()].slice().reverse())FileBlock.encode(Ct,jt);const Mt=Ct.endVector();Footer.startDictionariesVector(Ct,$t.numDictionaries);for(const jt of[...$t.dictionaryBatches()].slice().reverse())FileBlock.encode(Ct,jt);const Ft=Ct.endVector();return Footer.startFooter(Ct),Footer.addSchema(Ct,kt),Footer.addVersion(Ct,MetadataVersion$1.V5),Footer.addRecordBatches(Ct,Mt),Footer.addDictionaries(Ct,Ft),Footer.finishFooterBuffer(Ct,Footer.endFooter(Ct)),Ct.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor($t,Ct=MetadataVersion$1.V5,kt,Mt){this.schema=$t,this.version=Ct,kt&&(this._recordBatches=kt),Mt&&(this._dictionaryBatches=Mt)}*recordBatches(){for(let $t,Ct=-1,kt=this.numRecordBatches;++Ct<kt;)($t=this.getRecordBatch(Ct))&&(yield $t)}*dictionaryBatches(){for(let $t,Ct=-1,kt=this.numDictionaries;++Ct<kt;)($t=this.getDictionaryBatch(Ct))&&(yield $t)}getRecordBatch($t){return $t>=0&&$t<this.numRecordBatches&&this._recordBatches[$t]||null}getDictionaryBatch($t){return $t>=0&&$t<this.numDictionaries&&this._dictionaryBatches[$t]||null}}class OffHeapFooter extends Footer_{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor($t,Ct){super($t,Ct.version()),this._footer=Ct}getRecordBatch($t){if($t>=0&&$t<this.numRecordBatches){const Ct=this._footer.recordBatches($t);if(Ct)return FileBlock.decode(Ct)}return null}getDictionaryBatch($t){if($t>=0&&$t<this.numDictionaries){const Ct=this._footer.dictionaries($t);if(Ct)return FileBlock.decode(Ct)}return null}}class FileBlock{static decode($t){return new FileBlock($t.metaDataLength(),$t.bodyLength(),$t.offset())}static encode($t,Ct){const{metaDataLength:kt}=Ct,Mt=BigInt(Ct.offset),Ft=BigInt(Ct.bodyLength);return Block.createBlock($t,Mt,kt,Ft)}constructor($t,Ct,kt){this.metaDataLength=$t,this.offset=bigIntToNumber(kt),this.bodyLength=bigIntToNumber(Ct)}}const ITERATOR_DONE=Object.freeze({done:!0,value:void 0});class ReadableInterop{tee(){return this._getDOMStream().tee()}pipe($t,Ct){return this._getNodeStream().pipe($t,Ct)}pipeTo($t,Ct){return this._getDOMStream().pipeTo($t,Ct)}pipeThrough($t,Ct){return this._getDOMStream().pipeThrough($t,Ct)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class AsyncQueue extends ReadableInterop{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise($t=>this._closedPromiseResolve=$t)}get closed(){return this._closedPromise}cancel($t){return __awaiter(this,void 0,void 0,function*(){yield this.return($t)})}write($t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push($t):this.resolvers.shift().resolve({done:!1,value:$t}))}abort($t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:$t}:this.resolvers.shift().reject({done:!0,value:$t}))}close(){if(this._closedPromiseResolve){const{resolvers:$t}=this;for(;$t.length>0;)$t.shift().resolve(ITERATOR_DONE);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream($t){return streamAdapters.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,$t)}toNodeStream($t){return streamAdapters.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,$t)}throw($t){return __awaiter(this,void 0,void 0,function*(){return yield this.abort($t),ITERATOR_DONE})}return($t){return __awaiter(this,void 0,void 0,function*(){return yield this.close(),ITERATOR_DONE})}read($t){return __awaiter(this,void 0,void 0,function*(){return(yield this.next($t,"read")).value})}peek($t){return __awaiter(this,void 0,void 0,function*(){return(yield this.next($t,"peek")).value})}next(...$t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((Ct,kt)=>{this.resolvers.push({resolve:Ct,reject:kt})}):Promise.resolve(ITERATOR_DONE)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class AsyncByteQueue extends AsyncQueue{write($t){if(($t=toUint8Array($t)).byteLength>0)return super.write($t)}toString($t=!1){return $t?decodeUtf8(this.toUint8Array(!0)):this.toUint8Array(!1).then(decodeUtf8)}toUint8Array($t=!1){return $t?joinUint8Arrays(this._values)[0]:__awaiter(this,void 0,void 0,function*(){var Ct,kt,Mt,Ft;const jt=[];let Bt=0;try{for(var Vt=!0,zt=__asyncValues(this),Ht;Ht=yield zt.next(),Ct=Ht.done,!Ct;Vt=!0){Ft=Ht.value,Vt=!1;const Gt=Ft;jt.push(Gt),Bt+=Gt.byteLength}}catch(Gt){kt={error:Gt}}finally{try{!Vt&&!Ct&&(Mt=zt.return)&&(yield Mt.call(zt))}finally{if(kt)throw kt.error}}return joinUint8Arrays(jt,Bt)[0]})}}class BinaryBuilder extends VariableWidthBuilder{constructor($t){super($t),this._values=new BufferBuilder(new Uint8Array(0))}get byteLength(){let $t=this._pendingLength+this.length*4;return this._offsets&&($t+=this._offsets.byteLength),this._values&&($t+=this._values.byteLength),this._nulls&&($t+=this._nulls.byteLength),$t}setValue($t,Ct){return super.setValue($t,toUint8Array(Ct))}_flushPending($t,Ct){const kt=this._offsets,Mt=this._values.reserve(Ct).buffer;let Ft=0;for(const[jt,Bt]of $t)if(Bt===void 0)kt.set(jt,0);else{const Vt=Bt.length;Mt.set(Bt,Ft),kt.set(jt,Vt),Ft+=Vt}}}class BoolBuilder extends Builder$3{constructor($t){super($t),this._values=new BitmapBufferBuilder}setValue($t,Ct){this._values.set($t,+Ct)}}class DateBuilder extends FixedWidthBuilder{}DateBuilder.prototype._setValue=setDate;class DateDayBuilder extends DateBuilder{}DateDayBuilder.prototype._setValue=setDateDay;class DateMillisecondBuilder extends DateBuilder{}DateMillisecondBuilder.prototype._setValue=setDateMillisecond;class DecimalBuilder extends FixedWidthBuilder{}DecimalBuilder.prototype._setValue=setDecimal;class DictionaryBuilder extends Builder$3{constructor({type:$t,nullValues:Ct,dictionaryHashFunction:kt}){super({type:new Dictionary($t.dictionary,$t.indices,$t.id,$t.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=makeBuilder({type:this.type.indices,nullValues:Ct}),this.dictionary=makeBuilder({type:this.type.dictionary,nullValues:null}),typeof kt=="function"&&(this.valueToKey=kt)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid($t){return this.indices.isValid($t)}setValid($t,Ct){const kt=this.indices;return Ct=kt.setValid($t,Ct),this.length=kt.length,Ct}setValue($t,Ct){const kt=this._keysToIndices,Mt=this.valueToKey(Ct);let Ft=kt[Mt];return Ft===void 0&&(kt[Mt]=Ft=this._dictionaryOffset+this.dictionary.append(Ct).length-1),this.indices.setValue($t,Ft)}flush(){const $t=this.type,Ct=this._dictionary,kt=this.dictionary.toVector(),Mt=this.indices.flush().clone($t);return Mt.dictionary=Ct?Ct.concat(kt):kt,this.finished||(this._dictionaryOffset+=kt.length),this._dictionary=Mt.dictionary,this.clear(),Mt}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey($t){return typeof $t=="string"?$t:`${$t}`}}class FixedSizeBinaryBuilder extends FixedWidthBuilder{}FixedSizeBinaryBuilder.prototype._setValue=setFixedSizeBinary;class FixedSizeListBuilder extends Builder$3{setValue($t,Ct){const[kt]=this.children,Mt=$t*this.stride;for(let Ft=-1,jt=Ct.length;++Ft<jt;)kt.set(Mt+Ft,Ct[Ft])}addChild($t,Ct="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");const kt=this.children.push($t);return this.type=new FixedSizeList$1(this.type.listSize,new Field$2(Ct,$t.type,!0)),kt}}class FloatBuilder extends FixedWidthBuilder{setValue($t,Ct){this._values.set($t,Ct)}}class Float16Builder extends FloatBuilder{setValue($t,Ct){super.setValue($t,float64ToUint16(Ct))}}class Float32Builder extends FloatBuilder{}class Float64Builder extends FloatBuilder{}class IntervalBuilder extends FixedWidthBuilder{}IntervalBuilder.prototype._setValue=setIntervalValue;class IntervalDayTimeBuilder extends IntervalBuilder{}IntervalDayTimeBuilder.prototype._setValue=setIntervalDayTime;class IntervalYearMonthBuilder extends IntervalBuilder{}IntervalYearMonthBuilder.prototype._setValue=setIntervalYearMonth;class DurationBuilder extends FixedWidthBuilder{}DurationBuilder.prototype._setValue=setDuration;class DurationSecondBuilder extends DurationBuilder{}DurationSecondBuilder.prototype._setValue=setDurationSecond;class DurationMillisecondBuilder extends DurationBuilder{}DurationMillisecondBuilder.prototype._setValue=setDurationMillisecond;class DurationMicrosecondBuilder extends DurationBuilder{}DurationMicrosecondBuilder.prototype._setValue=setDurationMicrosecond;class DurationNanosecondBuilder extends DurationBuilder{}DurationNanosecondBuilder.prototype._setValue=setDurationNanosecond;class IntBuilder extends FixedWidthBuilder{setValue($t,Ct){this._values.set($t,Ct)}}class Int8Builder extends IntBuilder{}class Int16Builder extends IntBuilder{}class Int32Builder extends IntBuilder{}class Int64Builder extends IntBuilder{}class Uint8Builder extends IntBuilder{}class Uint16Builder extends IntBuilder{}class Uint32Builder extends IntBuilder{}class Uint64Builder extends IntBuilder{}class ListBuilder extends VariableWidthBuilder{constructor($t){super($t),this._offsets=new OffsetsBufferBuilder}addChild($t,Ct="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=$t,this.type=new List$1(new Field$2(Ct,$t.type,!0)),this.numChildren-1}_flushPending($t){const Ct=this._offsets,[kt]=this.children;for(const[Mt,Ft]of $t)if(typeof Ft>"u")Ct.set(Mt,0);else{const jt=Ft,Bt=jt.length,Vt=Ct.set(Mt,Bt).buffer[Mt];for(let zt=-1;++zt<Bt;)kt.set(Vt+zt,jt[zt])}}}class MapBuilder extends VariableWidthBuilder{set($t,Ct){return super.set($t,Ct)}setValue($t,Ct){const kt=Ct instanceof Map?Ct:new Map(Object.entries(Ct)),Mt=this._pending||(this._pending=new Map),Ft=Mt.get($t);Ft&&(this._pendingLength-=Ft.size),this._pendingLength+=kt.size,Mt.set($t,kt)}addChild($t,Ct=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=$t,this.type=new Map_(new Field$2(Ct,$t.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending($t){const Ct=this._offsets,[kt]=this.children;for(const[Mt,Ft]of $t)if(Ft===void 0)Ct.set(Mt,0);else{let{[Mt]:jt,[Mt+1]:Bt}=Ct.set(Mt,Ft.size).buffer;for(const Vt of Ft.entries())if(kt.set(jt,Vt),++jt>=Bt)break}}}class NullBuilder extends Builder$3{setValue($t,Ct){}setValid($t,Ct){return this.length=Math.max($t+1,this.length),Ct}}class StructBuilder extends Builder$3{setValue($t,Ct){const{children:kt,type:Mt}=this;switch(Array.isArray(Ct)||Ct.constructor){case!0:return Mt.children.forEach((Ft,jt)=>kt[jt].set($t,Ct[jt]));case Map:return Mt.children.forEach((Ft,jt)=>kt[jt].set($t,Ct.get(Ft.name)));default:return Mt.children.forEach((Ft,jt)=>kt[jt].set($t,Ct[Ft.name]))}}setValid($t,Ct){return super.setValid($t,Ct)||this.children.forEach(kt=>kt.setValid($t,Ct)),Ct}addChild($t,Ct=`${this.numChildren}`){const kt=this.children.push($t);return this.type=new Struct([...this.type.children,new Field$2(Ct,$t.type,!0)]),kt}}class TimestampBuilder extends FixedWidthBuilder{}TimestampBuilder.prototype._setValue=setTimestamp;class TimestampSecondBuilder extends TimestampBuilder{}TimestampSecondBuilder.prototype._setValue=setTimestampSecond;class TimestampMillisecondBuilder extends TimestampBuilder{}TimestampMillisecondBuilder.prototype._setValue=setTimestampMillisecond;class TimestampMicrosecondBuilder extends TimestampBuilder{}TimestampMicrosecondBuilder.prototype._setValue=setTimestampMicrosecond;class TimestampNanosecondBuilder extends TimestampBuilder{}TimestampNanosecondBuilder.prototype._setValue=setTimestampNanosecond;class TimeBuilder extends FixedWidthBuilder{}TimeBuilder.prototype._setValue=setTime;class TimeSecondBuilder extends TimeBuilder{}TimeSecondBuilder.prototype._setValue=setTimeSecond;class TimeMillisecondBuilder extends TimeBuilder{}TimeMillisecondBuilder.prototype._setValue=setTimeMillisecond;class TimeMicrosecondBuilder extends TimeBuilder{}TimeMicrosecondBuilder.prototype._setValue=setTimeMicrosecond;class TimeNanosecondBuilder extends TimeBuilder{}TimeNanosecondBuilder.prototype._setValue=setTimeNanosecond;class UnionBuilder extends Builder$3{constructor($t){super($t),this._typeIds=new DataBufferBuilder(new Int8Array(0),1),typeof $t.valueToChildTypeId=="function"&&(this._valueToChildTypeId=$t.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append($t,Ct){return this.set(this.length,$t,Ct)}set($t,Ct,kt){return kt===void 0&&(kt=this._valueToChildTypeId(this,Ct,$t)),this.setValue($t,Ct,kt),this}setValue($t,Ct,kt){this._typeIds.set($t,kt);const Mt=this.type.typeIdToChildIndex[kt],Ft=this.children[Mt];Ft==null||Ft.set($t,Ct)}addChild($t,Ct=`${this.children.length}`){const kt=this.children.push($t),{type:{children:Mt,mode:Ft,typeIds:jt}}=this,Bt=[...Mt,new Field$2(Ct,$t.type)];return this.type=new Union_(Ft,[...jt,kt],Bt),kt}_valueToChildTypeId($t,Ct,kt){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}}class SparseUnionBuilder extends UnionBuilder{}class DenseUnionBuilder extends UnionBuilder{constructor($t){super($t),this._offsets=new DataBufferBuilder(new Int32Array(0))}setValue($t,Ct,kt){const Mt=this._typeIds.set($t,kt).buffer[$t],Ft=this.getChildAt(this.type.typeIdToChildIndex[Mt]),jt=this._offsets.set($t,Ft.length).buffer[$t];Ft==null||Ft.set(jt,Ct)}}class Utf8Builder extends VariableWidthBuilder{constructor($t){super($t),this._values=new BufferBuilder(new Uint8Array(0))}get byteLength(){let $t=this._pendingLength+this.length*4;return this._offsets&&($t+=this._offsets.byteLength),this._values&&($t+=this._values.byteLength),this._nulls&&($t+=this._nulls.byteLength),$t}setValue($t,Ct){return super.setValue($t,encodeUtf8(Ct))}_flushPending($t,Ct){}}Utf8Builder.prototype._flushPending=BinaryBuilder.prototype._flushPending;class GetBuilderCtor extends Visitor{visitNull(){return NullBuilder}visitBool(){return BoolBuilder}visitInt(){return IntBuilder}visitInt8(){return Int8Builder}visitInt16(){return Int16Builder}visitInt32(){return Int32Builder}visitInt64(){return Int64Builder}visitUint8(){return Uint8Builder}visitUint16(){return Uint16Builder}visitUint32(){return Uint32Builder}visitUint64(){return Uint64Builder}visitFloat(){return FloatBuilder}visitFloat16(){return Float16Builder}visitFloat32(){return Float32Builder}visitFloat64(){return Float64Builder}visitUtf8(){return Utf8Builder}visitBinary(){return BinaryBuilder}visitFixedSizeBinary(){return FixedSizeBinaryBuilder}visitDate(){return DateBuilder}visitDateDay(){return DateDayBuilder}visitDateMillisecond(){return DateMillisecondBuilder}visitTimestamp(){return TimestampBuilder}visitTimestampSecond(){return TimestampSecondBuilder}visitTimestampMillisecond(){return TimestampMillisecondBuilder}visitTimestampMicrosecond(){return TimestampMicrosecondBuilder}visitTimestampNanosecond(){return TimestampNanosecondBuilder}visitTime(){return TimeBuilder}visitTimeSecond(){return TimeSecondBuilder}visitTimeMillisecond(){return TimeMillisecondBuilder}visitTimeMicrosecond(){return TimeMicrosecondBuilder}visitTimeNanosecond(){return TimeNanosecondBuilder}visitDecimal(){return DecimalBuilder}visitList(){return ListBuilder}visitStruct(){return StructBuilder}visitUnion(){return UnionBuilder}visitDenseUnion(){return DenseUnionBuilder}visitSparseUnion(){return SparseUnionBuilder}visitDictionary(){return DictionaryBuilder}visitInterval(){return IntervalBuilder}visitIntervalDayTime(){return IntervalDayTimeBuilder}visitIntervalYearMonth(){return IntervalYearMonthBuilder}visitDuration(){return DurationBuilder}visitDurationSecond(){return DurationSecondBuilder}visitDurationMillisecond(){return DurationMillisecondBuilder}visitDurationMicrosecond(){return DurationMicrosecondBuilder}visistDurationNanosecond(){return DurationNanosecondBuilder}visitFixedSizeList(){return FixedSizeListBuilder}visitMap(){return MapBuilder}}const instance$2=new GetBuilderCtor;class TypeComparator extends Visitor{compareSchemas($t,Ct){return $t===Ct||Ct instanceof $t.constructor&&this.compareManyFields($t.fields,Ct.fields)}compareManyFields($t,Ct){return $t===Ct||Array.isArray($t)&&Array.isArray(Ct)&&$t.length===Ct.length&&$t.every((kt,Mt)=>this.compareFields(kt,Ct[Mt]))}compareFields($t,Ct){return $t===Ct||Ct instanceof $t.constructor&&$t.name===Ct.name&&$t.nullable===Ct.nullable&&this.visit($t.type,Ct.type)}}function compareConstructor(xt,$t){return $t instanceof xt.constructor}function compareAny(xt,$t){return xt===$t||compareConstructor(xt,$t)}function compareInt(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.bitWidth===$t.bitWidth&&xt.isSigned===$t.isSigned}function compareFloat(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.precision===$t.precision}function compareFixedSizeBinary(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.byteWidth===$t.byteWidth}function compareDate(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.unit===$t.unit}function compareTimestamp(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.unit===$t.unit&&xt.timezone===$t.timezone}function compareTime(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.unit===$t.unit&&xt.bitWidth===$t.bitWidth}function compareList(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.children.length===$t.children.length&&instance$1.compareManyFields(xt.children,$t.children)}function compareStruct(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.children.length===$t.children.length&&instance$1.compareManyFields(xt.children,$t.children)}function compareUnion(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.mode===$t.mode&&xt.typeIds.every((Ct,kt)=>Ct===$t.typeIds[kt])&&instance$1.compareManyFields(xt.children,$t.children)}function compareDictionary(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.id===$t.id&&xt.isOrdered===$t.isOrdered&&instance$1.visit(xt.indices,$t.indices)&&instance$1.visit(xt.dictionary,$t.dictionary)}function compareInterval(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.unit===$t.unit}function compareDuration(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.unit===$t.unit}function compareFixedSizeList(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.listSize===$t.listSize&&xt.children.length===$t.children.length&&instance$1.compareManyFields(xt.children,$t.children)}function compareMap(xt,$t){return xt===$t||compareConstructor(xt,$t)&&xt.keysSorted===$t.keysSorted&&xt.children.length===$t.children.length&&instance$1.compareManyFields(xt.children,$t.children)}TypeComparator.prototype.visitNull=compareAny;TypeComparator.prototype.visitBool=compareAny;TypeComparator.prototype.visitInt=compareInt;TypeComparator.prototype.visitInt8=compareInt;TypeComparator.prototype.visitInt16=compareInt;TypeComparator.prototype.visitInt32=compareInt;TypeComparator.prototype.visitInt64=compareInt;TypeComparator.prototype.visitUint8=compareInt;TypeComparator.prototype.visitUint16=compareInt;TypeComparator.prototype.visitUint32=compareInt;TypeComparator.prototype.visitUint64=compareInt;TypeComparator.prototype.visitFloat=compareFloat;TypeComparator.prototype.visitFloat16=compareFloat;TypeComparator.prototype.visitFloat32=compareFloat;TypeComparator.prototype.visitFloat64=compareFloat;TypeComparator.prototype.visitUtf8=compareAny;TypeComparator.prototype.visitBinary=compareAny;TypeComparator.prototype.visitFixedSizeBinary=compareFixedSizeBinary;TypeComparator.prototype.visitDate=compareDate;TypeComparator.prototype.visitDateDay=compareDate;TypeComparator.prototype.visitDateMillisecond=compareDate;TypeComparator.prototype.visitTimestamp=compareTimestamp;TypeComparator.prototype.visitTimestampSecond=compareTimestamp;TypeComparator.prototype.visitTimestampMillisecond=compareTimestamp;TypeComparator.prototype.visitTimestampMicrosecond=compareTimestamp;TypeComparator.prototype.visitTimestampNanosecond=compareTimestamp;TypeComparator.prototype.visitTime=compareTime;TypeComparator.prototype.visitTimeSecond=compareTime;TypeComparator.prototype.visitTimeMillisecond=compareTime;TypeComparator.prototype.visitTimeMicrosecond=compareTime;TypeComparator.prototype.visitTimeNanosecond=compareTime;TypeComparator.prototype.visitDecimal=compareAny;TypeComparator.prototype.visitList=compareList;TypeComparator.prototype.visitStruct=compareStruct;TypeComparator.prototype.visitUnion=compareUnion;TypeComparator.prototype.visitDenseUnion=compareUnion;TypeComparator.prototype.visitSparseUnion=compareUnion;TypeComparator.prototype.visitDictionary=compareDictionary;TypeComparator.prototype.visitInterval=compareInterval;TypeComparator.prototype.visitIntervalDayTime=compareInterval;TypeComparator.prototype.visitIntervalYearMonth=compareInterval;TypeComparator.prototype.visitDuration=compareDuration;TypeComparator.prototype.visitDurationSecond=compareDuration;TypeComparator.prototype.visitDurationMillisecond=compareDuration;TypeComparator.prototype.visitDurationMicrosecond=compareDuration;TypeComparator.prototype.visitDurationNanosecond=compareDuration;TypeComparator.prototype.visitFixedSizeList=compareFixedSizeList;TypeComparator.prototype.visitMap=compareMap;const instance$1=new TypeComparator;function compareSchemas(xt,$t){return instance$1.compareSchemas(xt,$t)}function makeBuilder(xt){const $t=xt.type,Ct=new(instance$2.getVisitFn($t)())(xt);if($t.children&&$t.children.length>0){const kt=xt.children||[],Mt={nullValues:xt.nullValues},Ft=Array.isArray(kt)?(jt,Bt)=>kt[Bt]||Mt:({name:jt})=>kt[jt]||Mt;for(const[jt,Bt]of $t.children.entries()){const{type:Vt}=Bt,zt=Ft(Bt,jt);Ct.children.push(makeBuilder(Object.assign(Object.assign({},zt),{type:Vt})))}}return Ct}function distributeVectorsIntoRecordBatches(xt,$t){return uniformlyDistributeChunksAcrossRecordBatches(xt,$t.map(Ct=>Ct.data.concat()))}function uniformlyDistributeChunksAcrossRecordBatches(xt,$t){const Ct=[...xt.fields],kt=[],Mt={numBatches:$t.reduce((Gt,qt)=>Math.max(Gt,qt.length),0)};let Ft=0,jt=0,Bt=-1;const Vt=$t.length;let zt,Ht=[];for(;Mt.numBatches-- >0;){for(jt=Number.POSITIVE_INFINITY,Bt=-1;++Bt<Vt;)Ht[Bt]=zt=$t[Bt].shift(),jt=Math.min(jt,zt?zt.length:jt);Number.isFinite(jt)&&(Ht=distributeChildren(Ct,jt,Ht,$t,Mt),jt>0&&(kt[Ft++]=makeData({type:new Struct(Ct),length:jt,nullCount:0,children:Ht.slice()})))}return[xt=xt.assign(Ct),kt.map(Gt=>new RecordBatch$2(xt,Gt))]}function distributeChildren(xt,$t,Ct,kt,Mt){var Ft;const jt=($t+63&-64)>>3;for(let Bt=-1,Vt=kt.length;++Bt<Vt;){const zt=Ct[Bt],Ht=zt==null?void 0:zt.length;if(Ht>=$t)Ht===$t?Ct[Bt]=zt:(Ct[Bt]=zt.slice(0,$t),Mt.numBatches=Math.max(Mt.numBatches,kt[Bt].unshift(zt.slice($t,Ht-$t))));else{const Gt=xt[Bt];xt[Bt]=Gt.clone({nullable:!0}),Ct[Bt]=(Ft=zt==null?void 0:zt._changeLengthAndBackfillNullBitmap($t))!==null&&Ft!==void 0?Ft:makeData({type:Gt.type,length:$t,nullCount:$t,nullBitmap:new Uint8Array(jt)})}}return Ct}var _a$1;class Table{constructor(...$t){var Ct,kt;if($t.length===0)return this.batches=[],this.schema=new Schema([]),this._offsets=[0],this;let Mt,Ft;$t[0]instanceof Schema&&(Mt=$t.shift()),$t.at(-1)instanceof Uint32Array&&(Ft=$t.pop());const jt=Vt=>{if(Vt){if(Vt instanceof RecordBatch$2)return[Vt];if(Vt instanceof Table)return Vt.batches;if(Vt instanceof Data){if(Vt.type instanceof Struct)return[new RecordBatch$2(new Schema(Vt.type.children),Vt)]}else{if(Array.isArray(Vt))return Vt.flatMap(zt=>jt(zt));if(typeof Vt[Symbol.iterator]=="function")return[...Vt].flatMap(zt=>jt(zt));if(typeof Vt=="object"){const zt=Object.keys(Vt),Ht=zt.map(Wt=>new Vector([Vt[Wt]])),Gt=new Schema(zt.map((Wt,Yt)=>new Field$2(String(Wt),Ht[Yt].type))),[,qt]=distributeVectorsIntoRecordBatches(Gt,Ht);return qt.length===0?[new RecordBatch$2(Vt)]:qt}}}return[]},Bt=$t.flatMap(Vt=>jt(Vt));if(Mt=(kt=Mt??((Ct=Bt[0])===null||Ct===void 0?void 0:Ct.schema))!==null&&kt!==void 0?kt:new Schema([]),!(Mt instanceof Schema))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const Vt of Bt){if(!(Vt instanceof RecordBatch$2))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!compareSchemas(Mt,Vt.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=Mt,this.batches=Bt,this._offsets=Ft??computeChunkOffsets(this.data)}get data(){return this.batches.map(({data:$t})=>$t)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce(($t,Ct)=>$t+Ct.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=computeChunkNullCounts(this.data)),this._nullCount}isValid($t){return!1}get($t){return null}set($t,Ct){}indexOf($t,Ct){return-1}getByteLength($t){return 0}[Symbol.iterator](){return this.batches.length>0?instance$4.visit(new Vector(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...$t){const Ct=this.schema,kt=this.data.concat($t.flatMap(({data:Mt})=>Mt));return new Table(Ct,kt.map(Mt=>new RecordBatch$2(Ct,Mt)))}slice($t,Ct){const kt=this.schema;[$t,Ct]=clampRange$1({length:this.numRows},$t,Ct);const Mt=sliceChunks(this.data,this._offsets,$t,Ct);return new Table(kt,Mt.map(Ft=>new RecordBatch$2(kt,Ft)))}getChild($t){return this.getChildAt(this.schema.fields.findIndex(Ct=>Ct.name===$t))}getChildAt($t){if($t>-1&&$t<this.schema.fields.length){const Ct=this.data.map(kt=>kt.children[$t]);if(Ct.length===0){const{type:kt}=this.schema.fields[$t],Mt=makeData({type:kt,length:0,nullCount:0});Ct.push(Mt._changeLengthAndBackfillNullBitmap(this.numRows))}return new Vector(Ct)}return null}setChild($t,Ct){var kt;return this.setChildAt((kt=this.schema.fields)===null||kt===void 0?void 0:kt.findIndex(Mt=>Mt.name===$t),Ct)}setChildAt($t,Ct){let kt=this.schema,Mt=[...this.batches];if($t>-1&&$t<this.numCols){Ct||(Ct=new Vector([makeData({type:new Null$1,length:this.numRows})]));const Ft=kt.fields.slice(),jt=Ft[$t].clone({type:Ct.type}),Bt=this.schema.fields.map((Vt,zt)=>this.getChildAt(zt));[Ft[$t],Bt[$t]]=[jt,Ct],[kt,Mt]=distributeVectorsIntoRecordBatches(kt,Bt)}return new Table(kt,Mt)}select($t){const Ct=this.schema.fields.reduce((kt,Mt,Ft)=>kt.set(Mt.name,Ft),new Map);return this.selectAt($t.map(kt=>Ct.get(kt)).filter(kt=>kt>-1))}selectAt($t){const Ct=this.schema.selectAt($t),kt=this.batches.map(Mt=>Mt.selectAt($t));return new Table(Ct,kt)}assign($t){const Ct=this.schema.fields,[kt,Mt]=$t.schema.fields.reduce((Bt,Vt,zt)=>{const[Ht,Gt]=Bt,qt=Ct.findIndex(Wt=>Wt.name===Vt.name);return~qt?Gt[qt]=zt:Ht.push(zt),Bt},[[],[]]),Ft=this.schema.assign($t.schema),jt=[...Ct.map((Bt,Vt)=>[Vt,Mt[Vt]]).map(([Bt,Vt])=>Vt===void 0?this.getChildAt(Bt):$t.getChildAt(Vt)),...kt.map(Bt=>$t.getChildAt(Bt))].filter(Boolean);return new Table(...distributeVectorsIntoRecordBatches(Ft,jt))}}_a$1=Symbol.toStringTag;Table[_a$1]=(xt=>(xt.schema=null,xt.batches=[],xt._offsets=new Uint32Array([0]),xt._nullCount=-1,xt[Symbol.isConcatSpreadable]=!0,xt.isValid=wrapChunkedCall1(isChunkedValid),xt.get=wrapChunkedCall1(instance$6.getVisitFn(Type$3.Struct)),xt.set=wrapChunkedCall2(instance$7.getVisitFn(Type$3.Struct)),xt.indexOf=wrapChunkedIndexOf(instance$5.getVisitFn(Type$3.Struct)),xt.getByteLength=wrapChunkedCall1(instance$3.getVisitFn(Type$3.Struct)),"Table"))(Table.prototype);var _a;let RecordBatch$2=class iu{constructor(...$t){switch($t.length){case 2:{if([this.schema]=$t,!(this.schema instanceof Schema))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=makeData({nullCount:0,type:new Struct(this.schema.fields),children:this.schema.fields.map(Ct=>makeData({type:Ct.type,nullCount:0}))})]=$t,!(this.data instanceof Data))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=ensureSameLengthData(this.schema,this.data.children);break}case 1:{const[Ct]=$t,{fields:kt,children:Mt,length:Ft}=Object.keys(Ct).reduce((Vt,zt,Ht)=>(Vt.children[Ht]=Ct[zt],Vt.length=Math.max(Vt.length,Ct[zt].length),Vt.fields[Ht]=Field$2.new({name:zt,type:Ct[zt].type,nullable:!0}),Vt),{length:0,fields:new Array,children:new Array}),jt=new Schema(kt),Bt=makeData({type:new Struct(kt),length:Ft,children:Mt,nullCount:0});[this.schema,this.data]=ensureSameLengthData(jt,Bt.children,Ft);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=collectDictionaries(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid($t){return this.data.getValid($t)}get($t){return instance$6.visit(this.data,$t)}set($t,Ct){return instance$7.visit(this.data,$t,Ct)}indexOf($t,Ct){return instance$5.visit(this.data,$t,Ct)}getByteLength($t){return instance$3.visit(this.data,$t)}[Symbol.iterator](){return instance$4.visit(new Vector([this.data]))}toArray(){return[...this]}concat(...$t){return new Table(this.schema,[this,...$t])}slice($t,Ct){const[kt]=new Vector([this.data]).slice($t,Ct).data;return new iu(this.schema,kt)}getChild($t){var Ct;return this.getChildAt((Ct=this.schema.fields)===null||Ct===void 0?void 0:Ct.findIndex(kt=>kt.name===$t))}getChildAt($t){return $t>-1&&$t<this.schema.fields.length?new Vector([this.data.children[$t]]):null}setChild($t,Ct){var kt;return this.setChildAt((kt=this.schema.fields)===null||kt===void 0?void 0:kt.findIndex(Mt=>Mt.name===$t),Ct)}setChildAt($t,Ct){let kt=this.schema,Mt=this.data;if($t>-1&&$t<this.numCols){Ct||(Ct=new Vector([makeData({type:new Null$1,length:this.numRows})]));const Ft=kt.fields.slice(),jt=Mt.children.slice(),Bt=Ft[$t].clone({type:Ct.type});[Ft[$t],jt[$t]]=[Bt,Ct.data[0]],kt=new Schema(Ft,new Map(this.schema.metadata)),Mt=makeData({type:new Struct(Ft),children:jt})}return new iu(kt,Mt)}select($t){const Ct=this.schema.select($t),kt=new Struct(Ct.fields),Mt=[];for(const Ft of $t){const jt=this.schema.fields.findIndex(Bt=>Bt.name===Ft);~jt&&(Mt[jt]=this.data.children[jt])}return new iu(Ct,makeData({type:kt,length:this.numRows,children:Mt}))}selectAt($t){const Ct=this.schema.selectAt($t),kt=$t.map(Ft=>this.data.children[Ft]).filter(Boolean),Mt=makeData({type:new Struct(Ct.fields),length:this.numRows,children:kt});return new iu(Ct,Mt)}};_a=Symbol.toStringTag;RecordBatch$2[_a]=(xt=>(xt._nullCount=-1,xt[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(RecordBatch$2.prototype);function ensureSameLengthData(xt,$t,Ct=$t.reduce((kt,Mt)=>Math.max(kt,Mt.length),0)){var kt;const Mt=[...xt.fields],Ft=[...$t],jt=(Ct+63&-64)>>3;for(const[Bt,Vt]of xt.fields.entries()){const zt=$t[Bt];(!zt||zt.length!==Ct)&&(Mt[Bt]=Vt.clone({nullable:!0}),Ft[Bt]=(kt=zt==null?void 0:zt._changeLengthAndBackfillNullBitmap(Ct))!==null&&kt!==void 0?kt:makeData({type:Vt.type,length:Ct,nullCount:Ct,nullBitmap:new Uint8Array(jt)}))}return[xt.assign(Mt),makeData({type:new Struct(Mt),length:Ct,children:Ft})]}function collectDictionaries(xt,$t,Ct=new Map){var kt,Mt;if(((kt=xt==null?void 0:xt.length)!==null&&kt!==void 0?kt:0)>0&&(xt==null?void 0:xt.length)===($t==null?void 0:$t.length))for(let Ft=-1,jt=xt.length;++Ft<jt;){const{type:Bt}=xt[Ft],Vt=$t[Ft];for(const zt of[Vt,...((Mt=Vt==null?void 0:Vt.dictionary)===null||Mt===void 0?void 0:Mt.data)||[]])collectDictionaries(Bt.children,zt==null?void 0:zt.children,Ct);if(DataType$1.isDictionary(Bt)){const{id:zt}=Bt;if(!Ct.has(zt))Vt!=null&&Vt.dictionary&&Ct.set(zt,Vt.dictionary);else if(Ct.get(zt)!==Vt.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}}return Ct}class _InternalEmptyPlaceholderRecordBatch extends RecordBatch$2{constructor($t){const Ct=$t.fields.map(Mt=>makeData({type:Mt.type})),kt=makeData({type:new Struct($t.fields),nullCount:0,children:Ct});super($t,kt)}}var BodyCompressionMethod;(function(xt){xt[xt.BUFFER=0]="BUFFER"})(BodyCompressionMethod||(BodyCompressionMethod={}));var CompressionType;(function(xt){xt[xt.LZ4_FRAME=0]="LZ4_FRAME",xt[xt.ZSTD=1]="ZSTD"})(CompressionType||(CompressionType={}));class BodyCompression{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsBodyCompression($t,Ct){return(Ct||new BodyCompression).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsBodyCompression($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new BodyCompression).__init($t.readInt32($t.position())+$t.position(),$t)}codec(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt8(this.bb_pos+$t):CompressionType.LZ4_FRAME}method(){const $t=this.bb.__offset(this.bb_pos,6);return $t?this.bb.readInt8(this.bb_pos+$t):BodyCompressionMethod.BUFFER}static startBodyCompression($t){$t.startObject(2)}static addCodec($t,Ct){$t.addFieldInt8(0,Ct,CompressionType.LZ4_FRAME)}static addMethod($t,Ct){$t.addFieldInt8(1,Ct,BodyCompressionMethod.BUFFER)}static endBodyCompression($t){return $t.endObject()}static createBodyCompression($t,Ct,kt){return BodyCompression.startBodyCompression($t),BodyCompression.addCodec($t,Ct),BodyCompression.addMethod($t,kt),BodyCompression.endBodyCompression($t)}}let Buffer$1=class{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer($t,Ct,kt){return $t.prep(8,16),$t.writeInt64(BigInt(kt??0)),$t.writeInt64(BigInt(Ct??0)),$t.offset()}},FieldNode$1=class{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode($t,Ct,kt){return $t.prep(8,16),$t.writeInt64(BigInt(kt??0)),$t.writeInt64(BigInt(Ct??0)),$t.offset()}},RecordBatch$1=class Cu{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsRecordBatch($t,Ct){return(Ct||new Cu).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsRecordBatch($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Cu).__init($t.readInt32($t.position())+$t.position(),$t)}length(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt64(this.bb_pos+$t):BigInt("0")}nodes($t,Ct){const kt=this.bb.__offset(this.bb_pos,6);return kt?(Ct||new FieldNode$1).__init(this.bb.__vector(this.bb_pos+kt)+$t*16,this.bb):null}nodesLength(){const $t=this.bb.__offset(this.bb_pos,6);return $t?this.bb.__vector_len(this.bb_pos+$t):0}buffers($t,Ct){const kt=this.bb.__offset(this.bb_pos,8);return kt?(Ct||new Buffer$1).__init(this.bb.__vector(this.bb_pos+kt)+$t*16,this.bb):null}buffersLength(){const $t=this.bb.__offset(this.bb_pos,8);return $t?this.bb.__vector_len(this.bb_pos+$t):0}compression($t){const Ct=this.bb.__offset(this.bb_pos,10);return Ct?($t||new BodyCompression).__init(this.bb.__indirect(this.bb_pos+Ct),this.bb):null}static startRecordBatch($t){$t.startObject(4)}static addLength($t,Ct){$t.addFieldInt64(0,Ct,BigInt("0"))}static addNodes($t,Ct){$t.addFieldOffset(1,Ct,0)}static startNodesVector($t,Ct){$t.startVector(16,Ct,8)}static addBuffers($t,Ct){$t.addFieldOffset(2,Ct,0)}static startBuffersVector($t,Ct){$t.startVector(16,Ct,8)}static addCompression($t,Ct){$t.addFieldOffset(3,Ct,0)}static endRecordBatch($t){return $t.endObject()}},DictionaryBatch$1=class Ru{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsDictionaryBatch($t,Ct){return(Ct||new Ru).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsDictionaryBatch($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new Ru).__init($t.readInt32($t.position())+$t.position(),$t)}id(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt64(this.bb_pos+$t):BigInt("0")}data($t){const Ct=this.bb.__offset(this.bb_pos,6);return Ct?($t||new RecordBatch$1).__init(this.bb.__indirect(this.bb_pos+Ct),this.bb):null}isDelta(){const $t=this.bb.__offset(this.bb_pos,8);return $t?!!this.bb.readInt8(this.bb_pos+$t):!1}static startDictionaryBatch($t){$t.startObject(3)}static addId($t,Ct){$t.addFieldInt64(0,Ct,BigInt("0"))}static addData($t,Ct){$t.addFieldOffset(1,Ct,0)}static addIsDelta($t,Ct){$t.addFieldInt8(2,+Ct,0)}static endDictionaryBatch($t){return $t.endObject()}};var MessageHeader;(function(xt){xt[xt.NONE=0]="NONE",xt[xt.Schema=1]="Schema",xt[xt.DictionaryBatch=2]="DictionaryBatch",xt[xt.RecordBatch=3]="RecordBatch",xt[xt.Tensor=4]="Tensor",xt[xt.SparseTensor=5]="SparseTensor"})(MessageHeader||(MessageHeader={}));let Message$1=class $l{constructor(){this.bb=null,this.bb_pos=0}__init($t,Ct){return this.bb_pos=$t,this.bb=Ct,this}static getRootAsMessage($t,Ct){return(Ct||new $l).__init($t.readInt32($t.position())+$t.position(),$t)}static getSizePrefixedRootAsMessage($t,Ct){return $t.setPosition($t.position()+SIZE_PREFIX_LENGTH),(Ct||new $l).__init($t.readInt32($t.position())+$t.position(),$t)}version(){const $t=this.bb.__offset(this.bb_pos,4);return $t?this.bb.readInt16(this.bb_pos+$t):MetadataVersion.V1}headerType(){const $t=this.bb.__offset(this.bb_pos,6);return $t?this.bb.readUint8(this.bb_pos+$t):MessageHeader.NONE}header($t){const Ct=this.bb.__offset(this.bb_pos,8);return Ct?this.bb.__union($t,this.bb_pos+Ct):null}bodyLength(){const $t=this.bb.__offset(this.bb_pos,10);return $t?this.bb.readInt64(this.bb_pos+$t):BigInt("0")}customMetadata($t,Ct){const kt=this.bb.__offset(this.bb_pos,12);return kt?(Ct||new KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+kt)+$t*4),this.bb):null}customMetadataLength(){const $t=this.bb.__offset(this.bb_pos,12);return $t?this.bb.__vector_len(this.bb_pos+$t):0}static startMessage($t){$t.startObject(5)}static addVersion($t,Ct){$t.addFieldInt16(0,Ct,MetadataVersion.V1)}static addHeaderType($t,Ct){$t.addFieldInt8(1,Ct,MessageHeader.NONE)}static addHeader($t,Ct){$t.addFieldOffset(2,Ct,0)}static addBodyLength($t,Ct){$t.addFieldInt64(3,Ct,BigInt("0"))}static addCustomMetadata($t,Ct){$t.addFieldOffset(4,Ct,0)}static createCustomMetadataVector($t,Ct){$t.startVector(4,Ct.length,4);for(let kt=Ct.length-1;kt>=0;kt--)$t.addOffset(Ct[kt]);return $t.endVector()}static startCustomMetadataVector($t,Ct){$t.startVector(4,Ct,4)}static endMessage($t){return $t.endObject()}static finishMessageBuffer($t,Ct){$t.finish(Ct)}static finishSizePrefixedMessageBuffer($t,Ct){$t.finish(Ct,void 0,!0)}static createMessage($t,Ct,kt,Mt,Ft,jt){return $l.startMessage($t),$l.addVersion($t,Ct),$l.addHeaderType($t,kt),$l.addHeader($t,Mt),$l.addBodyLength($t,Ft),$l.addCustomMetadata($t,jt),$l.endMessage($t)}};class TypeAssembler extends Visitor{visit($t,Ct){return $t==null||Ct==null?void 0:super.visit($t,Ct)}visitNull($t,Ct){return Null.startNull(Ct),Null.endNull(Ct)}visitInt($t,Ct){return Int.startInt(Ct),Int.addBitWidth(Ct,$t.bitWidth),Int.addIsSigned(Ct,$t.isSigned),Int.endInt(Ct)}visitFloat($t,Ct){return FloatingPoint.startFloatingPoint(Ct),FloatingPoint.addPrecision(Ct,$t.precision),FloatingPoint.endFloatingPoint(Ct)}visitBinary($t,Ct){return Binary.startBinary(Ct),Binary.endBinary(Ct)}visitBool($t,Ct){return Bool.startBool(Ct),Bool.endBool(Ct)}visitUtf8($t,Ct){return Utf8.startUtf8(Ct),Utf8.endUtf8(Ct)}visitDecimal($t,Ct){return Decimal.startDecimal(Ct),Decimal.addScale(Ct,$t.scale),Decimal.addPrecision(Ct,$t.precision),Decimal.addBitWidth(Ct,$t.bitWidth),Decimal.endDecimal(Ct)}visitDate($t,Ct){return Date$1.startDate(Ct),Date$1.addUnit(Ct,$t.unit),Date$1.endDate(Ct)}visitTime($t,Ct){return Time$1.startTime(Ct),Time$1.addUnit(Ct,$t.unit),Time$1.addBitWidth(Ct,$t.bitWidth),Time$1.endTime(Ct)}visitTimestamp($t,Ct){const kt=$t.timezone&&Ct.createString($t.timezone)||void 0;return Timestamp$1.startTimestamp(Ct),Timestamp$1.addUnit(Ct,$t.unit),kt!==void 0&&Timestamp$1.addTimezone(Ct,kt),Timestamp$1.endTimestamp(Ct)}visitInterval($t,Ct){return Interval.startInterval(Ct),Interval.addUnit(Ct,$t.unit),Interval.endInterval(Ct)}visitDuration($t,Ct){return Duration.startDuration(Ct),Duration.addUnit(Ct,$t.unit),Duration.endDuration(Ct)}visitList($t,Ct){return List.startList(Ct),List.endList(Ct)}visitStruct($t,Ct){return Struct_.startStruct_(Ct),Struct_.endStruct_(Ct)}visitUnion($t,Ct){Union$1.startTypeIdsVector(Ct,$t.typeIds.length);const kt=Union$1.createTypeIdsVector(Ct,$t.typeIds);return Union$1.startUnion(Ct),Union$1.addMode(Ct,$t.mode),Union$1.addTypeIds(Ct,kt),Union$1.endUnion(Ct)}visitDictionary($t,Ct){const kt=this.visit($t.indices,Ct);return DictionaryEncoding.startDictionaryEncoding(Ct),DictionaryEncoding.addId(Ct,BigInt($t.id)),DictionaryEncoding.addIsOrdered(Ct,$t.isOrdered),kt!==void 0&&DictionaryEncoding.addIndexType(Ct,kt),DictionaryEncoding.endDictionaryEncoding(Ct)}visitFixedSizeBinary($t,Ct){return FixedSizeBinary.startFixedSizeBinary(Ct),FixedSizeBinary.addByteWidth(Ct,$t.byteWidth),FixedSizeBinary.endFixedSizeBinary(Ct)}visitFixedSizeList($t,Ct){return FixedSizeList.startFixedSizeList(Ct),FixedSizeList.addListSize(Ct,$t.listSize),FixedSizeList.endFixedSizeList(Ct)}visitMap($t,Ct){return Map$1.startMap(Ct),Map$1.addKeysSorted(Ct,$t.keysSorted),Map$1.endMap(Ct)}}const instance=new TypeAssembler;function schemaFromJSON(xt,$t=new Map){return new Schema(schemaFieldsFromJSON(xt,$t),customMetadataFromJSON(xt.metadata),$t)}function recordBatchFromJSON(xt){return new RecordBatch(xt.count,fieldNodesFromJSON(xt.columns),buffersFromJSON(xt.columns))}function dictionaryBatchFromJSON(xt){return new DictionaryBatch(recordBatchFromJSON(xt.data),xt.id,xt.isDelta)}function schemaFieldsFromJSON(xt,$t){return(xt.fields||[]).filter(Boolean).map(Ct=>Field$2.fromJSON(Ct,$t))}function fieldChildrenFromJSON(xt,$t){return(xt.children||[]).filter(Boolean).map(Ct=>Field$2.fromJSON(Ct,$t))}function fieldNodesFromJSON(xt){return(xt||[]).reduce(($t,Ct)=>[...$t,new FieldNode(Ct.count,nullCountFromJSON(Ct.VALIDITY)),...fieldNodesFromJSON(Ct.children)],[])}function buffersFromJSON(xt,$t=[]){for(let Ct=-1,kt=(xt||[]).length;++Ct<kt;){const Mt=xt[Ct];Mt.VALIDITY&&$t.push(new BufferRegion($t.length,Mt.VALIDITY.length)),Mt.TYPE_ID&&$t.push(new BufferRegion($t.length,Mt.TYPE_ID.length)),Mt.OFFSET&&$t.push(new BufferRegion($t.length,Mt.OFFSET.length)),Mt.DATA&&$t.push(new BufferRegion($t.length,Mt.DATA.length)),$t=buffersFromJSON(Mt.children,$t)}return $t}function nullCountFromJSON(xt){return(xt||[]).reduce(($t,Ct)=>$t+ +(Ct===0),0)}function fieldFromJSON(xt,$t){let Ct,kt,Mt,Ft,jt,Bt;return!$t||!(Ft=xt.dictionary)?(jt=typeFromJSON(xt,fieldChildrenFromJSON(xt,$t)),Mt=new Field$2(xt.name,jt,xt.nullable,customMetadataFromJSON(xt.metadata))):$t.has(Ct=Ft.id)?(kt=(kt=Ft.indexType)?indexTypeFromJSON(kt):new Int32,Bt=new Dictionary($t.get(Ct),kt,Ct,Ft.isOrdered),Mt=new Field$2(xt.name,Bt,xt.nullable,customMetadataFromJSON(xt.metadata))):(kt=(kt=Ft.indexType)?indexTypeFromJSON(kt):new Int32,$t.set(Ct,jt=typeFromJSON(xt,fieldChildrenFromJSON(xt,$t))),Bt=new Dictionary(jt,kt,Ct,Ft.isOrdered),Mt=new Field$2(xt.name,Bt,xt.nullable,customMetadataFromJSON(xt.metadata))),Mt||null}function customMetadataFromJSON(xt=[]){return new Map(xt.map(({key:$t,value:Ct})=>[$t,Ct]))}function indexTypeFromJSON(xt){return new Int_(xt.isSigned,xt.bitWidth)}function typeFromJSON(xt,$t){const Ct=xt.type.name;switch(Ct){case"NONE":return new Null$1;case"null":return new Null$1;case"binary":return new Binary$1;case"utf8":return new Utf8$1;case"bool":return new Bool$1;case"list":return new List$1(($t||[])[0]);case"struct":return new Struct($t||[]);case"struct_":return new Struct($t||[])}switch(Ct){case"int":{const kt=xt.type;return new Int_(kt.isSigned,kt.bitWidth)}case"floatingpoint":{const kt=xt.type;return new Float(Precision$1[kt.precision])}case"decimal":{const kt=xt.type;return new Decimal$1(kt.scale,kt.precision,kt.bitWidth)}case"date":{const kt=xt.type;return new Date_(DateUnit$1[kt.unit])}case"time":{const kt=xt.type;return new Time_(TimeUnit$2[kt.unit],kt.bitWidth)}case"timestamp":{const kt=xt.type;return new Timestamp_(TimeUnit$2[kt.unit],kt.timezone)}case"interval":{const kt=xt.type;return new Interval_(IntervalUnit$1[kt.unit])}case"duration":{const kt=xt.type;return new Duration$1(TimeUnit$2[kt.unit])}case"union":{const kt=xt.type,[Mt,...Ft]=(kt.mode+"").toLowerCase(),jt=Mt.toUpperCase()+Ft.join("");return new Union_(UnionMode$1[jt],kt.typeIds||[],$t||[])}case"fixedsizebinary":{const kt=xt.type;return new FixedSizeBinary$1(kt.byteWidth)}case"fixedsizelist":{const kt=xt.type;return new FixedSizeList$1(kt.listSize,($t||[])[0])}case"map":{const kt=xt.type;return new Map_(($t||[])[0],kt.keysSorted)}}throw new Error(`Unrecognized type: "${Ct}"`)}var Builder=Builder$2,ByteBuffer=ByteBuffer$2;class Message{static fromJSON($t,Ct){const kt=new Message(0,MetadataVersion$1.V5,Ct);return kt._createHeader=messageHeaderFromJSON($t,Ct),kt}static decode($t){$t=new ByteBuffer(toUint8Array($t));const Ct=Message$1.getRootAsMessage($t),kt=Ct.bodyLength(),Mt=Ct.version(),Ft=Ct.headerType(),jt=new Message(kt,Mt,Ft);return jt._createHeader=decodeMessageHeader(Ct,Ft),jt}static encode($t){const Ct=new Builder;let kt=-1;return $t.isSchema()?kt=Schema.encode(Ct,$t.header()):$t.isRecordBatch()?kt=RecordBatch.encode(Ct,$t.header()):$t.isDictionaryBatch()&&(kt=DictionaryBatch.encode(Ct,$t.header())),Message$1.startMessage(Ct),Message$1.addVersion(Ct,MetadataVersion$1.V5),Message$1.addHeader(Ct,kt),Message$1.addHeaderType(Ct,$t.headerType),Message$1.addBodyLength(Ct,BigInt($t.bodyLength)),Message$1.finishMessageBuffer(Ct,Message$1.endMessage(Ct)),Ct.asUint8Array()}static from($t,Ct=0){if($t instanceof Schema)return new Message(0,MetadataVersion$1.V5,MessageHeader$1.Schema,$t);if($t instanceof RecordBatch)return new Message(Ct,MetadataVersion$1.V5,MessageHeader$1.RecordBatch,$t);if($t instanceof DictionaryBatch)return new Message(Ct,MetadataVersion$1.V5,MessageHeader$1.DictionaryBatch,$t);throw new Error(`Unrecognized Message header: ${$t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===MessageHeader$1.Schema}isRecordBatch(){return this.headerType===MessageHeader$1.RecordBatch}isDictionaryBatch(){return this.headerType===MessageHeader$1.DictionaryBatch}constructor($t,Ct,kt,Mt){this._version=Ct,this._headerType=kt,this.body=new Uint8Array(0),Mt&&(this._createHeader=()=>Mt),this._bodyLength=bigIntToNumber($t)}}class RecordBatch{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor($t,Ct,kt){this._nodes=Ct,this._buffers=kt,this._length=bigIntToNumber($t)}}class DictionaryBatch{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor($t,Ct,kt=!1){this._data=$t,this._isDelta=kt,this._id=bigIntToNumber(Ct)}}class BufferRegion{constructor($t,Ct){this.offset=bigIntToNumber($t),this.length=bigIntToNumber(Ct)}}class FieldNode{constructor($t,Ct){this.length=bigIntToNumber($t),this.nullCount=bigIntToNumber(Ct)}}function messageHeaderFromJSON(xt,$t){return()=>{switch($t){case MessageHeader$1.Schema:return Schema.fromJSON(xt);case MessageHeader$1.RecordBatch:return RecordBatch.fromJSON(xt);case MessageHeader$1.DictionaryBatch:return DictionaryBatch.fromJSON(xt)}throw new Error(`Unrecognized Message type: { name: ${MessageHeader$1[$t]}, type: ${$t} }`)}}function decodeMessageHeader(xt,$t){return()=>{switch($t){case MessageHeader$1.Schema:return Schema.decode(xt.header(new Schema$1),new Map,xt.version());case MessageHeader$1.RecordBatch:return RecordBatch.decode(xt.header(new RecordBatch$1),xt.version());case MessageHeader$1.DictionaryBatch:return DictionaryBatch.decode(xt.header(new DictionaryBatch$1),xt.version())}throw new Error(`Unrecognized Message type: { name: ${MessageHeader$1[$t]}, type: ${$t} }`)}}Field$2.encode=encodeField;Field$2.decode=decodeField;Field$2.fromJSON=fieldFromJSON;Schema.encode=encodeSchema;Schema.decode=decodeSchema;Schema.fromJSON=schemaFromJSON;RecordBatch.encode=encodeRecordBatch;RecordBatch.decode=decodeRecordBatch;RecordBatch.fromJSON=recordBatchFromJSON;DictionaryBatch.encode=encodeDictionaryBatch;DictionaryBatch.decode=decodeDictionaryBatch;DictionaryBatch.fromJSON=dictionaryBatchFromJSON;FieldNode.encode=encodeFieldNode;FieldNode.decode=decodeFieldNode;BufferRegion.encode=encodeBufferRegion;BufferRegion.decode=decodeBufferRegion;function decodeSchema(xt,$t=new Map,Ct=MetadataVersion$1.V5){const kt=decodeSchemaFields(xt,$t);return new Schema(kt,decodeCustomMetadata(xt),$t,Ct)}function decodeRecordBatch(xt,$t=MetadataVersion$1.V5){if(xt.compression()!==null)throw new Error("Record batch compression not implemented");return new RecordBatch(xt.length(),decodeFieldNodes(xt),decodeBuffers(xt,$t))}function decodeDictionaryBatch(xt,$t=MetadataVersion$1.V5){return new DictionaryBatch(RecordBatch.decode(xt.data(),$t),xt.id(),xt.isDelta())}function decodeBufferRegion(xt){return new BufferRegion(xt.offset(),xt.length())}function decodeFieldNode(xt){return new FieldNode(xt.length(),xt.nullCount())}function decodeFieldNodes(xt){const $t=[];for(let Ct,kt=-1,Mt=-1,Ft=xt.nodesLength();++kt<Ft;)(Ct=xt.nodes(kt))&&($t[++Mt]=FieldNode.decode(Ct));return $t}function decodeBuffers(xt,$t){const Ct=[];for(let kt,Mt=-1,Ft=-1,jt=xt.buffersLength();++Mt<jt;)(kt=xt.buffers(Mt))&&($t<MetadataVersion$1.V4&&(kt.bb_pos+=8*(Mt+1)),Ct[++Ft]=BufferRegion.decode(kt));return Ct}function decodeSchemaFields(xt,$t){const Ct=[];for(let kt,Mt=-1,Ft=-1,jt=xt.fieldsLength();++Mt<jt;)(kt=xt.fields(Mt))&&(Ct[++Ft]=Field$2.decode(kt,$t));return Ct}function decodeFieldChildren(xt,$t){const Ct=[];for(let kt,Mt=-1,Ft=-1,jt=xt.childrenLength();++Mt<jt;)(kt=xt.children(Mt))&&(Ct[++Ft]=Field$2.decode(kt,$t));return Ct}function decodeField(xt,$t){let Ct,kt,Mt,Ft,jt,Bt;return!$t||!(Bt=xt.dictionary())?(Mt=decodeFieldType(xt,decodeFieldChildren(xt,$t)),kt=new Field$2(xt.name(),Mt,xt.nullable(),decodeCustomMetadata(xt))):$t.has(Ct=bigIntToNumber(Bt.id()))?(Ft=(Ft=Bt.indexType())?decodeIndexType(Ft):new Int32,jt=new Dictionary($t.get(Ct),Ft,Ct,Bt.isOrdered()),kt=new Field$2(xt.name(),jt,xt.nullable(),decodeCustomMetadata(xt))):(Ft=(Ft=Bt.indexType())?decodeIndexType(Ft):new Int32,$t.set(Ct,Mt=decodeFieldType(xt,decodeFieldChildren(xt,$t))),jt=new Dictionary(Mt,Ft,Ct,Bt.isOrdered()),kt=new Field$2(xt.name(),jt,xt.nullable(),decodeCustomMetadata(xt))),kt||null}function decodeCustomMetadata(xt){const $t=new Map;if(xt)for(let Ct,kt,Mt=-1,Ft=Math.trunc(xt.customMetadataLength());++Mt<Ft;)(Ct=xt.customMetadata(Mt))&&(kt=Ct.key())!=null&&$t.set(kt,Ct.value());return $t}function decodeIndexType(xt){return new Int_(xt.isSigned(),xt.bitWidth())}function decodeFieldType(xt,$t){const Ct=xt.typeType();switch(Ct){case Type$2.NONE:return new Null$1;case Type$2.Null:return new Null$1;case Type$2.Binary:return new Binary$1;case Type$2.Utf8:return new Utf8$1;case Type$2.Bool:return new Bool$1;case Type$2.List:return new List$1(($t||[])[0]);case Type$2.Struct_:return new Struct($t||[])}switch(Ct){case Type$2.Int:{const kt=xt.type(new Int);return new Int_(kt.isSigned(),kt.bitWidth())}case Type$2.FloatingPoint:{const kt=xt.type(new FloatingPoint);return new Float(kt.precision())}case Type$2.Decimal:{const kt=xt.type(new Decimal);return new Decimal$1(kt.scale(),kt.precision(),kt.bitWidth())}case Type$2.Date:{const kt=xt.type(new Date$1);return new Date_(kt.unit())}case Type$2.Time:{const kt=xt.type(new Time$1);return new Time_(kt.unit(),kt.bitWidth())}case Type$2.Timestamp:{const kt=xt.type(new Timestamp$1);return new Timestamp_(kt.unit(),kt.timezone())}case Type$2.Interval:{const kt=xt.type(new Interval);return new Interval_(kt.unit())}case Type$2.Duration:{const kt=xt.type(new Duration);return new Duration$1(kt.unit())}case Type$2.Union:{const kt=xt.type(new Union$1);return new Union_(kt.mode(),kt.typeIdsArray()||[],$t||[])}case Type$2.FixedSizeBinary:{const kt=xt.type(new FixedSizeBinary);return new FixedSizeBinary$1(kt.byteWidth())}case Type$2.FixedSizeList:{const kt=xt.type(new FixedSizeList);return new FixedSizeList$1(kt.listSize(),($t||[])[0])}case Type$2.Map:{const kt=xt.type(new Map$1);return new Map_(($t||[])[0],kt.keysSorted())}}throw new Error(`Unrecognized type: "${Type$2[Ct]}" (${Ct})`)}function encodeSchema(xt,$t){const Ct=$t.fields.map(Ft=>Field$2.encode(xt,Ft));Schema$1.startFieldsVector(xt,Ct.length);const kt=Schema$1.createFieldsVector(xt,Ct),Mt=$t.metadata&&$t.metadata.size>0?Schema$1.createCustomMetadataVector(xt,[...$t.metadata].map(([Ft,jt])=>{const Bt=xt.createString(`${Ft}`),Vt=xt.createString(`${jt}`);return KeyValue.startKeyValue(xt),KeyValue.addKey(xt,Bt),KeyValue.addValue(xt,Vt),KeyValue.endKeyValue(xt)})):-1;return Schema$1.startSchema(xt),Schema$1.addFields(xt,kt),Schema$1.addEndianness(xt,platformIsLittleEndian?Endianness.Little:Endianness.Big),Mt!==-1&&Schema$1.addCustomMetadata(xt,Mt),Schema$1.endSchema(xt)}function encodeField(xt,$t){let Ct=-1,kt=-1,Mt=-1;const Ft=$t.type;let jt=$t.typeId;DataType$1.isDictionary(Ft)?(jt=Ft.dictionary.typeId,Mt=instance.visit(Ft,xt),kt=instance.visit(Ft.dictionary,xt)):kt=instance.visit(Ft,xt);const Bt=(Ft.children||[]).map(Ht=>Field$2.encode(xt,Ht)),Vt=Field$3.createChildrenVector(xt,Bt),zt=$t.metadata&&$t.metadata.size>0?Field$3.createCustomMetadataVector(xt,[...$t.metadata].map(([Ht,Gt])=>{const qt=xt.createString(`${Ht}`),Wt=xt.createString(`${Gt}`);return KeyValue.startKeyValue(xt),KeyValue.addKey(xt,qt),KeyValue.addValue(xt,Wt),KeyValue.endKeyValue(xt)})):-1;return $t.name&&(Ct=xt.createString($t.name)),Field$3.startField(xt),Field$3.addType(xt,kt),Field$3.addTypeType(xt,jt),Field$3.addChildren(xt,Vt),Field$3.addNullable(xt,!!$t.nullable),Ct!==-1&&Field$3.addName(xt,Ct),Mt!==-1&&Field$3.addDictionary(xt,Mt),zt!==-1&&Field$3.addCustomMetadata(xt,zt),Field$3.endField(xt)}function encodeRecordBatch(xt,$t){const Ct=$t.nodes||[],kt=$t.buffers||[];RecordBatch$1.startNodesVector(xt,Ct.length);for(const jt of Ct.slice().reverse())FieldNode.encode(xt,jt);const Mt=xt.endVector();RecordBatch$1.startBuffersVector(xt,kt.length);for(const jt of kt.slice().reverse())BufferRegion.encode(xt,jt);const Ft=xt.endVector();return RecordBatch$1.startRecordBatch(xt),RecordBatch$1.addLength(xt,BigInt($t.length)),RecordBatch$1.addNodes(xt,Mt),RecordBatch$1.addBuffers(xt,Ft),RecordBatch$1.endRecordBatch(xt)}function encodeDictionaryBatch(xt,$t){const Ct=RecordBatch.encode(xt,$t.data);return DictionaryBatch$1.startDictionaryBatch(xt),DictionaryBatch$1.addId(xt,BigInt($t.id)),DictionaryBatch$1.addIsDelta(xt,$t.isDelta),DictionaryBatch$1.addData(xt,Ct),DictionaryBatch$1.endDictionaryBatch(xt)}function encodeFieldNode(xt,$t){return FieldNode$1.createFieldNode(xt,BigInt($t.length),BigInt($t.nullCount))}function encodeBufferRegion(xt,$t){return Buffer$1.createBuffer(xt,BigInt($t.offset),BigInt($t.length))}const platformIsLittleEndian=(()=>{const xt=new ArrayBuffer(2);return new DataView(xt).setInt16(0,256,!0),new Int16Array(xt)[0]===256})(),MAGIC_STR="ARROW1",MAGIC=new Uint8Array(MAGIC_STR.length);for(let xt=0;xt<MAGIC_STR.length;xt+=1)MAGIC[xt]=MAGIC_STR.codePointAt(xt);MAGIC.length;class VectorAssembler extends Visitor{static assemble(...$t){const Ct=Mt=>Mt.flatMap(Ft=>Array.isArray(Ft)?Ct(Ft):Ft instanceof RecordBatch$2?Ft.data.children:Ft.data),kt=new VectorAssembler;return kt.visitMany(Ct($t)),kt}constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit($t){if($t instanceof Vector)return this.visitMany($t.data),this;const{type:Ct}=$t;if(!DataType$1.isDictionary(Ct)){const{length:kt}=$t;if(kt>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(DataType$1.isUnion(Ct))this.nodes.push(new FieldNode(kt,0));else{const{nullCount:Mt}=$t;DataType$1.isNull(Ct)||addBuffer.call(this,Mt<=0?new Uint8Array(0):truncateBitmap($t.offset,kt,$t.nullBitmap)),this.nodes.push(new FieldNode(kt,Mt))}}return super.visit($t)}visitNull($t){return this}visitDictionary($t){return this.visit($t.clone($t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function addBuffer(xt){const $t=xt.byteLength+7&-8;return this.buffers.push(xt),this.bufferRegions.push(new BufferRegion(this._byteLength,$t)),this._byteLength+=$t,this}function assembleUnion(xt){var $t;const{type:Ct,length:kt,typeIds:Mt,valueOffsets:Ft}=xt;if(addBuffer.call(this,Mt),Ct.mode===UnionMode$1.Sparse)return assembleNestedVector.call(this,xt);if(Ct.mode===UnionMode$1.Dense){if(xt.offset<=0)return addBuffer.call(this,Ft),assembleNestedVector.call(this,xt);{const jt=new Int32Array(kt),Bt=Object.create(null),Vt=Object.create(null);for(let zt,Ht,Gt=-1;++Gt<kt;)(zt=Mt[Gt])!==void 0&&((Ht=Bt[zt])===void 0&&(Ht=Bt[zt]=Ft[Gt]),jt[Gt]=Ft[Gt]-Ht,Vt[zt]=(($t=Vt[zt])!==null&&$t!==void 0?$t:0)+1);addBuffer.call(this,jt),this.visitMany(xt.children.map((zt,Ht)=>{const Gt=Ct.typeIds[Ht],qt=Bt[Gt],Wt=Vt[Gt];return zt.slice(qt,Math.min(kt,Wt))}))}}return this}function assembleBoolVector(xt){let $t;return xt.nullCount>=xt.length?addBuffer.call(this,new Uint8Array(0)):($t=xt.values)instanceof Uint8Array?addBuffer.call(this,truncateBitmap(xt.offset,xt.length,$t)):addBuffer.call(this,packBools(xt.values))}function assembleFlatVector(xt){return addBuffer.call(this,xt.values.subarray(0,xt.length*xt.stride))}function assembleFlatListVector(xt){const{length:$t,values:Ct,valueOffsets:kt}=xt,{[0]:Mt,[$t]:Ft}=kt,jt=Math.min(Ft-Mt,Ct.byteLength-Mt);return addBuffer.call(this,rebaseValueOffsets(-Mt,$t+1,kt)),addBuffer.call(this,Ct.subarray(Mt,Mt+jt)),this}function assembleListVector(xt){const{length:$t,valueOffsets:Ct}=xt;if(Ct){const{[0]:kt,[$t]:Mt}=Ct;return addBuffer.call(this,rebaseValueOffsets(-kt,$t+1,Ct)),this.visit(xt.children[0].slice(kt,Mt-kt))}return this.visit(xt.children[0])}function assembleNestedVector(xt){return this.visitMany(xt.type.children.map(($t,Ct)=>xt.children[Ct]).filter(Boolean))[0]}VectorAssembler.prototype.visitBool=assembleBoolVector;VectorAssembler.prototype.visitInt=assembleFlatVector;VectorAssembler.prototype.visitFloat=assembleFlatVector;VectorAssembler.prototype.visitUtf8=assembleFlatListVector;VectorAssembler.prototype.visitBinary=assembleFlatListVector;VectorAssembler.prototype.visitFixedSizeBinary=assembleFlatVector;VectorAssembler.prototype.visitDate=assembleFlatVector;VectorAssembler.prototype.visitTimestamp=assembleFlatVector;VectorAssembler.prototype.visitTime=assembleFlatVector;VectorAssembler.prototype.visitDecimal=assembleFlatVector;VectorAssembler.prototype.visitList=assembleListVector;VectorAssembler.prototype.visitStruct=assembleNestedVector;VectorAssembler.prototype.visitUnion=assembleUnion;VectorAssembler.prototype.visitInterval=assembleFlatVector;VectorAssembler.prototype.visitDuration=assembleFlatVector;VectorAssembler.prototype.visitFixedSizeList=assembleListVector;VectorAssembler.prototype.visitMap=assembleListVector;class RecordBatchWriter extends ReadableInterop{static throughNode($t){throw new Error('"throughNode" not available in this environment')}static throughDOM($t,Ct){throw new Error('"throughDOM" not available in this environment')}constructor($t){super(),this._position=0,this._started=!1,this._sink=new AsyncByteQueue,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,isObject$3($t)||($t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof $t.autoDestroy=="boolean"?$t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof $t.writeLegacyIpcFormat=="boolean"?$t.writeLegacyIpcFormat:!1}toString($t=!1){return this._sink.toString($t)}toUint8Array($t=!1){return this._sink.toUint8Array($t)}writeAll($t){return isPromise($t)?$t.then(Ct=>this.writeAll(Ct)):isAsyncIterable($t)?writeAllAsync(this,$t):writeAll(this,$t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream($t){return this._sink.toDOMStream($t)}toNodeStream($t){return this._sink.toNodeStream($t)}close(){return this.reset()._sink.close()}abort($t){return this.reset()._sink.abort($t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset($t=this._sink,Ct=null){return $t===this._sink||$t instanceof AsyncByteQueue?this._sink=$t:(this._sink=new AsyncByteQueue,$t&&isWritableDOMStream($t)?this.toDOMStream({type:"bytes"}).pipeTo($t):$t&&isWritableNodeStream($t)&&this.toNodeStream({objectMode:!1}).pipe($t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!Ct||!compareSchemas(Ct,this._schema))&&(Ct==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=Ct,this._writeSchema(Ct))),this}write($t){let Ct=null;if(this._sink){if($t==null)return this.finish()&&void 0;if($t instanceof Table&&!(Ct=$t.schema))return this.finish()&&void 0;if($t instanceof RecordBatch$2&&!(Ct=$t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(Ct&&!compareSchemas(Ct,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,Ct)}$t instanceof RecordBatch$2?$t instanceof _InternalEmptyPlaceholderRecordBatch||this._writeRecordBatch($t):$t instanceof Table?this.writeAll($t.batches):isIterable$1($t)&&this.writeAll($t)}_writeMessage($t,Ct=8){const kt=Ct-1,Mt=Message.encode($t),Ft=Mt.byteLength,jt=this._writeLegacyIpcFormat?4:8,Bt=Ft+jt+kt&~kt,Vt=Bt-Ft-jt;return $t.headerType===MessageHeader$1.RecordBatch?this._recordBatchBlocks.push(new FileBlock(Bt,$t.bodyLength,this._position)):$t.headerType===MessageHeader$1.DictionaryBatch&&this._dictionaryBlocks.push(new FileBlock(Bt,$t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(Bt-jt)),Ft>0&&this._write(Mt),this._writePadding(Vt)}_write($t){if(this._started){const Ct=toUint8Array($t);Ct&&Ct.byteLength>0&&(this._sink.write(Ct),this._position+=Ct.byteLength)}return this}_writeSchema($t){return this._writeMessage(Message.from($t))}_writeFooter($t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(MAGIC)}_writePadding($t){return $t>0?this._write(new Uint8Array($t)):this}_writeRecordBatch($t){const{byteLength:Ct,nodes:kt,bufferRegions:Mt,buffers:Ft}=VectorAssembler.assemble($t),jt=new RecordBatch($t.numRows,kt,Mt),Bt=Message.from(jt,Ct);return this._writeDictionaries($t)._writeMessage(Bt)._writeBodyBuffers(Ft)}_writeDictionaryBatch($t,Ct,kt=!1){this._dictionaryDeltaOffsets.set(Ct,$t.length+(this._dictionaryDeltaOffsets.get(Ct)||0));const{byteLength:Mt,nodes:Ft,bufferRegions:jt,buffers:Bt}=VectorAssembler.assemble(new Vector([$t])),Vt=new RecordBatch($t.length,Ft,jt),zt=new DictionaryBatch(Vt,Ct,kt),Ht=Message.from(zt,Mt);return this._writeMessage(Ht)._writeBodyBuffers(Bt)}_writeBodyBuffers($t){let Ct,kt,Mt;for(let Ft=-1,jt=$t.length;++Ft<jt;)(Ct=$t[Ft])&&(kt=Ct.byteLength)>0&&(this._write(Ct),(Mt=(kt+7&-8)-kt)>0&&this._writePadding(Mt));return this}_writeDictionaries($t){for(let[Ct,kt]of $t.dictionaries){let Mt=this._dictionaryDeltaOffsets.get(Ct)||0;if(Mt===0||(kt=kt==null?void 0:kt.slice(Mt)).length>0)for(const Ft of kt.data)this._writeDictionaryBatch(Ft,Ct,Mt>0),Mt+=Ft.length}return this}}class RecordBatchStreamWriter extends RecordBatchWriter{static writeAll($t,Ct){const kt=new RecordBatchStreamWriter(Ct);return isPromise($t)?$t.then(Mt=>kt.writeAll(Mt)):isAsyncIterable($t)?writeAllAsync(kt,$t):writeAll(kt,$t)}}class RecordBatchFileWriter extends RecordBatchWriter{static writeAll($t){const Ct=new RecordBatchFileWriter;return isPromise($t)?$t.then(kt=>Ct.writeAll(kt)):isAsyncIterable($t)?writeAllAsync(Ct,$t):writeAll(Ct,$t)}constructor(){super(),this._autoDestroy=!0}_writeSchema($t){return this._writeMagic()._writePadding(2)}_writeFooter($t){const Ct=Footer_.encode(new Footer_($t,MetadataVersion$1.V5,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter($t)._write(Ct)._write(Int32Array.of(Ct.byteLength))._writeMagic()}}function writeAll(xt,$t){let Ct=$t;$t instanceof Table&&(Ct=$t.batches,xt.reset(void 0,$t.schema));for(const kt of Ct)xt.write(kt);return xt.finish()}function writeAllAsync(xt,$t){var Ct,kt,Mt,Ft,jt,Bt,Vt;return __awaiter(this,void 0,void 0,function*(){try{for(Ct=!0,kt=__asyncValues($t);Mt=yield kt.next(),Ft=Mt.done,!Ft;Ct=!0){Vt=Mt.value,Ct=!1;const zt=Vt;xt.write(zt)}}catch(zt){jt={error:zt}}finally{try{!Ct&&!Ft&&(Bt=kt.return)&&(yield Bt.call(kt))}finally{if(jt)throw jt.error}}return xt.finish()})}function tableToIPC(xt,$t="stream"){return($t==="stream"?RecordBatchStreamWriter:RecordBatchFileWriter).writeAll(xt).toUint8Array(!0)}function ceil64Bytes(xt,$t=1){return(xt*$t+63&-64||64)/$t}function array$3(xt,$t,Ct=xt.BYTES_PER_ELEMENT){return new xt(ceil64Bytes($t,Ct))}function arrowData(xt){return xt instanceof Data?xt:new Data(xt.type,0,xt.length,xt.nulls,xt.buffers,null,xt.dict)}function arrowVector$1(xt){return new Vector([arrowData(xt)])}const encoder$1=new TextEncoder;function encode$2(xt,$t,Ct){const kt=encoder$1.encode(Ct);return xt.set(kt,$t),kt.length}function encodeInto(xt,$t,Ct){return encoder$1.encodeInto(Ct,xt.subarray($t)).written}const writeUtf8=encoder$1.encodeInto?encodeInto:encode$2;function arrayBuilder(xt,$t){const Ct=array$3(xt.ArrayType,$t);return{set(kt,Mt){Ct[Mt]=kt},data:()=>({type:xt,length:$t,buffers:[null,Ct]})}}function boolBuilder(xt,$t){const Ct=array$3(xt.ArrayType,$t/8);return{set(kt,Mt){kt&&(Ct[Mt>>3]|=1<<Mt%8)},data:()=>({type:xt,length:$t,buffers:[null,Ct]})}}function dateDayBuilder(xt,$t){const Ct=array$3(xt.ArrayType,$t);return{set(kt,Mt){Ct[Mt]=kt/864e5|0},data:()=>({type:xt,length:$t,buffers:[null,Ct]})}}function dateMillisBuilder(xt,$t){const Ct=array$3(xt.ArrayType,$t<<1);return{set(kt,Mt){const Ft=Mt<<1;Ct[Ft]=kt%4294967296|0,Ct[Ft+1]=kt/4294967296|0},data:()=>({type:xt,length:$t,buffers:[null,Ct]})}}function defaultBuilder(xt){const $t=makeBuilder({type:xt,nullValues:[null,void 0]});return{set(Ct,kt){$t.set(kt,Ct)},data:()=>$t.finish().flush()}}function utf8Builder(xt,$t,Ct){const kt=array$3(Int32Array,$t+1),Mt=array$3(Uint8Array,3*Ct);let Ft=0;return{set(jt,Bt){Ft+=writeUtf8(Mt,Ft,jt),kt[Bt+1]=Ft},data:()=>{const jt=ceil64Bytes(Ft),Bt=Mt.length>jt?Mt.subarray(0,jt):Mt;return{type:xt,length:$t,buffers:[kt,Bt]}}}}function dictionaryBuilder(xt,$t){const Ct=[],kt=array$3(xt.indices.ArrayType,$t),Mt=Object.create(null);let Ft=-1,jt=0;return{set(Bt,Vt){const zt=String(Bt);let Ht=Mt[zt];Ht===void 0&&(jt+=zt.length,Mt[zt]=Ht=++Ft,Ct.push(zt)),kt[Vt]=Ht},data:()=>({type:xt,length:$t,buffers:[null,kt],dict:dictionary(xt.dictionary,Ct,jt)})}}function dictionary(xt,$t,Ct){const kt=utf8Builder(xt,$t.length,Ct);return $t.forEach(kt.set),arrowVector$1(kt.data())}function validBuilder(xt,$t){const Ct=array$3(Uint8Array,$t/8);let kt=0;return{set(Mt,Ft){Mt==null?++kt:(xt.set(Mt,Ft),Ct[Ft>>3]|=1<<Ft%8)},data:()=>{const Mt=xt.data();return kt&&(Mt.nulls=kt,Mt.buffers[2]=Ct),Mt}}}function builder(xt,$t,Ct=!0){let kt;switch(xt.typeId){case Type$3.Int:kt=xt.bitWidth<64?arrayBuilder:null;break;case Type$3.Float:kt=xt.precision>0?arrayBuilder:null;break;case Type$3.Dictionary:kt=xt.dictionary.typeId===Type$3.Utf8&&xt.indices.typeId===Type$3.Int&&xt.indices.bitWidth<64?dictionaryBuilder:null;break;case Type$3.Bool:kt=boolBuilder;break;case Type$3.Date:kt=xt.unit?dateMillisBuilder:dateDayBuilder;break}return kt==null?defaultBuilder(xt):Ct?validBuilder(kt(xt,$t),$t):kt(xt,$t)}function dataFromArray(xt,$t){const Ct=xt.length,kt=ceil64Bytes(Ct,xt.BYTES_PER_ELEMENT);let Mt=xt;return Ct!==kt&&(Mt=new xt.constructor(kt),Mt.set(xt)),arrowData({type:$t,length:Ct,buffers:[null,Mt]})}function dataFromScan(xt,$t,Ct,kt,Mt=!0){const Ft=builder(kt,xt,Mt);return $t(Ct,Ft.set),arrowData(Ft.data())}function resolveType(xt){if(xt instanceof DataType$1||xt==null)return xt;switch(xt){case Type$3.Binary:return new Binary$1;case Type$3.Bool:return new Bool$1;case Type$3.DateDay:return new DateDay;case Type$3.DateMillisecond:case Type$3.Date:return new DateMillisecond;case Type$3.Dictionary:return new Dictionary(new Utf8$1,new Int32);case Type$3.Float16:return new Float16;case Type$3.Float32:return new Float32;case Type$3.Float64:case Type$3.Float:return new Float64;case Type$3.Int8:return new Int8;case Type$3.Int16:return new Int16;case Type$3.Int32:case Type$3.Int:return new Int32;case Type$3.Int64:return new Int64;case Type$3.IntervalDayTime:return new IntervalDayTime;case Type$3.Interval:case Type$3.IntervalYearMonth:return new IntervalYearMonth;case Type$3.Null:return new Null$1;case Type$3.TimeMicrosecond:return new TimeMicrosecond;case Type$3.TimeMillisecond:case Type$3.Time:return new TimeMillisecond;case Type$3.TimeNanosecond:return new TimeNanosecond;case Type$3.TimeSecond:return new TimeSecond;case Type$3.Uint8:return new Uint8;case Type$3.Uint16:return new Uint16;case Type$3.Uint32:return new Uint32;case Type$3.Uint64:return new Uint64;case Type$3.Utf8:return new Utf8$1;default:error$k(`Unsupported type code: ${toString$2(xt)}. Use a data type constructor instead?`)}}function isExactUTCDate(xt){return xt.getUTCHours()===0&&xt.getUTCMinutes()===0&&xt.getUTCSeconds()===0&&xt.getUTCMilliseconds()===0}function profile(xt,$t){const Ct=profiler();return xt($t,Ct.add),Ct}function profiler(){const xt={count:0,nulls:0,bools:0,nums:0,ints:0,bigints:0,min:1/0,max:-1/0,digits:0,dates:0,utcdays:0,strings:0,strlen:0,arrays:0,minlen:1/0,maxlen:0,structs:0,add($t){if(++xt.count,$t==null){++xt.nulls;return}const Ct=typeof $t;if(Ct==="string")++xt.strings;else if(Ct==="number")++xt.nums,$t<xt.min&&(xt.min=$t),$t>xt.max&&(xt.max=$t),Number.isInteger($t)&&++xt.ints;else if(Ct==="boolean")++xt.bools;else if(Ct==="object")if(isDate$2($t))++xt.dates,isExactUTCDate($t)&&++xt.utcdays;else if(isArrayType($t)){++xt.arrays,$t.length<xt.minlen&&(xt.minlen=$t.length),$t.length>xt.maxlen&&(xt.maxlen=$t.length);const kt=xt.array_prof||(xt.array_prof=profiler());$t.forEach(kt.add)}else{++xt.structs;const kt=xt.struct_prof||(xt.struct_prof={});for(const Mt in $t)(kt[Mt]||(kt[Mt]=profiler())).add($t[Mt])}else Ct==="bigint"&&(++xt.bigints,$t<xt.min&&(xt.min=$t),$t>xt.max&&(xt.max=$t))},type(){return resolveType(infer(xt))}};return xt}function infer(xt){const $t=xt.count-xt.nulls;if($t===0)return Type$3.Null;if(xt.ints===$t){const Ct=Math.max(Math.abs(xt.min)-1,xt.max);return xt.min<0?Ct>=2**31?Type$3.Float64:Ct<128?Type$3.Int8:Ct<32768?Type$3.Int16:Type$3.Int32:Ct>=2**32?Type$3.Float64:Ct<256?Type$3.Uint8:Ct<65536?Type$3.Uint16:Type$3.Uint32}else{if(xt.nums===$t)return Type$3.Float64;if(xt.bigints===$t){const Ct=-xt.min>xt.max?-xt.min-1n:xt.max;return xt.min<0?Ct<2**63?Type$3.Int64:error$k(`BigInt exceeds 64 bits: ${Ct}`):xt.max<2**64?Type$3.Uint64:error$k(`BigInt exceeds 64 bits: ${xt.max}`)}else{if(xt.bools===$t)return Type$3.Bool;if(xt.utcdays===$t)return Type$3.DateDay;if(xt.dates===$t)return Type$3.DateMillisecond;if(xt.arrays===$t){const Ct=Field$2.new("value",xt.array_prof.type(),!0);return xt.minlen===xt.maxlen?new FixedSizeList$1(xt.minlen,Ct):new List$1(Ct)}else if(xt.structs===$t){const Ct=xt.struct_prof;return new Struct(Object.keys(Ct).map(kt=>Field$2.new(kt,Ct[kt].type(),!0)))}else{if(xt.strings>0)return Type$3.Dictionary;error$k("Type inference failure")}}}}function dataFromObjects(xt,$t,Ct,kt,Mt,Ft=!0){if(Mt=resolveType(Mt),!Mt){const jt=profile(kt,$t);Ft=jt.nulls>0,Mt=jt.type()}return dataFromScan(Ct,kt,$t,Mt,Ft)}function dataFromTable(xt,$t,Ct,kt,Mt,Ft=!0){Mt=resolveType(Mt);const jt=xt.column($t),Bt=!(xt.isFiltered()||xt.isOrdered()),Vt=arrowVector(jt);if(Vt&&Bt&&typeCompatible(Vt.type,Mt))return Vt;const zt=jt.data;if(isTypedArray(zt)){const Ht=typeFromArray(zt);if(Bt&&Ht&&typeCompatible(Ht,Mt))return dataFromArray(zt,Ht);Mt=Mt||Ht,Ft=!1}if(!Mt){const Ht=profile(kt,jt);Ft=Ht.nulls>0,Mt=Ht.type()}return dataFromScan(Ct,kt,jt,Mt,Ft)}function arrowVector(xt){return xt instanceof Vector?xt:xt.vector instanceof Vector?xt.vector:null}function typeFromArray(xt){const Ct={Float32Array:Float32,Float64Array:Float64,Int8Array:Int8,Int16Array:Int16,Int32Array:Int32,Uint8Array:Uint8,Uint16Array:Uint16,Uint32Array:Uint32,BigInt64Array:Int64,BigUint64Array:Uint64}[xt.constructor.name];return Ct?new Ct:null}function typeCompatible(xt,$t){return!xt||!$t?!0:xt.compareTo($t)}function scanArray(xt,$t,Ct){const kt=Math.min(xt.length,Ct+$t);return(Mt,Ft)=>{for(let jt=Ct;jt<kt;++jt)Ft(xt[jt][Mt],jt)}}function scanTable(xt,$t,Ct){const kt=Ct===0&&xt.numRows()<=$t&&!xt.isFiltered()&&!xt.isOrdered();return(Mt,Ft)=>{let jt=-1;kt&&isArrayType(Mt.data)?Mt.data.forEach(Ft):xt.scan(Bt=>Ft(Mt.get(Bt),++jt),!0,$t,Ct)}}const fail$1=()=>error$k("Apache Arrow not imported, see https://github.com/uwdata/arquero#usage");function table(){try{return Table}catch{fail$1()}}function toArrow(xt,$t={}){const{types:Ct={}}=$t,{dataFrom:kt,names:Mt,nrows:Ft,scan:jt}=init$1(xt,$t),Bt={};Mt.forEach(zt=>{const Ht=kt(xt,zt,Ft,jt,Ct[zt]);Ht.length!==Ft&&error$k("Column length mismatch"),Bt[zt]=Ht});const Vt=table();return new Vt(Bt)}function init$1(xt,$t){const{columns:Ct,limit:kt=1/0,offset:Mt=0}=$t,Ft=isFunction$3(Ct)?Ct(xt):isArray$3(Ct)?Ct:null;if(isArray$3(xt))return{dataFrom:dataFromObjects,names:Ft||Object.keys(xt[0]),nrows:Math.min(kt,xt.length-Mt),scan:scanArray(xt,kt,Mt)};if(isTable(xt))return{dataFrom:dataFromTable,names:Ft||xt.columnNames(),nrows:Math.min(kt,xt.numRows()-Mt),scan:scanTable(xt,kt,Mt)};error$k("Unsupported input data type")}function isTable(xt){return xt&&isFunction$3(xt.reify)}function toArrowIPC(xt,$t={}){const{format:Ct,...kt}=$t,Mt=Ct||"stream";if(!["stream","file"].includes(Mt))throw Error("Unrecognised output format");return tableToIPC(toArrow(xt,kt),Ct)}function isExactDateUTC(xt){return xt.getUTCHours()===0&&xt.getUTCMinutes()===0&&xt.getUTCSeconds()===0&&xt.getUTCMilliseconds()===0}function inferFormat(xt,$t={}){let Ct=0,kt=0,Mt=0,Ft=0,jt=0,Bt=0;return xt(Vt=>{if(++Ct,Vt==null){++kt;return}const zt=typeof Vt;if(zt==="object"&&isDate$2(Vt))++Mt,isExactDateUTC(Vt)&&++Ft;else if(zt==="number"&&(++jt,Vt===Vt&&(Vt|0)!==Vt)){const Ht=Vt+"",Gt=Ht.indexOf(".");if(Gt>=0){const qt=Ht.indexOf("e"),Wt=qt>0?qt:Ht.length;Bt=Math.max(Bt,Wt-Gt-1)}}}),{align:(kt+jt+Mt)/Ct>.5?"r":"l",format:{utc:Mt===Ft,digits:Math.min(Bt,$t.maxdigits||6)}}}function columns(xt,$t){return isFunction$3($t)?$t(xt):$t||xt.columnNames()}function formats$2(xt,$t,Ct){const kt=Ct.format||{},Mt=Ct.align||{},Ft={},jt={};return $t.forEach(Bt=>{const Vt=inferFormat(values$3(xt,Bt),Ct);jt[Bt]=Mt[Bt]||Vt.align,Ft[Bt]=kt[Bt]||Vt.format}),{align:jt,format:Ft}}function values$3(xt,$t){const Ct=xt.column($t);return kt=>xt.scan(Mt=>kt(Ct.get(Mt)))}function scan(xt,$t,Ct=100,kt,Mt){const Ft=xt.data(),jt=$t.length;xt.scan(Bt=>{Mt.row(Bt);for(let Vt=0;Vt<jt;++Vt){const zt=$t[Vt];Mt.cell(Ft[$t[Vt]].get(Bt),zt,Vt)}},!0,Ct,kt)}function toCSV(xt,$t={}){const Ct=columns(xt,$t.columns),kt=$t.format||{},Mt=$t.delimiter||",",Ft=new RegExp(`["${Mt}
\r]`),jt=zt=>zt==null?"":isDate$2(zt)?formatUTCDate(zt,!0):Ft.test(zt+="")?'"'+zt.replace(/"/g,'""')+'"':zt,Bt=Ct.map(jt);let Vt="";return scan(xt,Ct,$t.limit||1/0,$t.offset,{row(){Vt+=Bt.join(Mt)+`
`},cell(zt,Ht,Gt){Bt[Gt]=jt(kt[Ht]?kt[Ht](zt):zt)}}),Vt+Bt.join(Mt)}function formatValue$4(xt,$t={}){if(isFunction$3($t))return $t(xt)+"";const Ct=typeof xt;if(Ct==="object"){if(isDate$2(xt))return $t.utc?formatUTCDate(xt):formatDate(xt);{const kt=JSON.stringify(xt,(Ft,jt)=>isTypedArray(jt)?Array.from(jt):jt),Mt=$t.maxlen||30;return kt.length>Mt?kt.slice(0,28)+""+(kt[0]==="["?"]":"}"):kt}}else if(Ct==="number"){const kt=$t.digits||0;let Mt;return xt!==0&&((Mt=Math.abs(xt))>=1e18||Mt<Math.pow(10,-kt))?xt.toExponential(kt):xt.toFixed(kt)}else return xt+""}function map$1(xt,$t,Ct={}){for(const kt in xt)Ct[kt]=$t(xt[kt],kt);return Ct}function toHTML(xt,$t={}){const Ct=columns(xt,$t.columns),{align:kt,format:Mt}=formats$2(xt,Ct,$t),Ft=styles$1($t),jt=$t.null,Bt=Kt=>Kt==="c"?"center":Kt==="r"?"right":"left",Vt=Kt=>Kt.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),zt=(Kt,Xt)=>Vt(formatValue$4(Kt,Xt)),Ht=jt?(Kt,Xt)=>Kt==null?jt(Kt):zt(Kt,Xt):zt;let Gt=-1,qt=-1;const Wt=(Kt,Xt,Qt)=>{const Jt=Qt?Bt(kt[Xt]):"",Zt=Ft[Kt]&&Ft[Kt](Xt,qt,Gt)||"",sn=(Jt?`text-align: ${Jt};`+(Zt?" ":""):"")+Zt;return`<${Kt}${sn?` style="${sn}"`:""}>`};let Yt=Wt("table")+Wt("thead")+Wt("tr",Gt)+Ct.map(Kt=>`${Wt("th",Kt,1)}${Kt}</th>`).join("")+"</tr></thead>"+Wt("tbody");return scan(xt,Ct,$t.limit,$t.offset,{row(Kt){Gt=Kt,Yt+=(++qt?"</tr>":"")+Wt("tr")},cell(Kt,Xt){Yt+=Wt("td",Xt,1)+Ht(Kt,Mt[Xt])+"</td>"}}),Yt+"</tr></tbody></table>"}function styles$1(xt){return map$1(xt.style,$t=>isFunction$3($t)?$t:()=>$t)}function defaultTrue(xt,$t=!0,Ct=!1){return xt===void 0||xt?$t:Ct}const defaultFormatter$1=xt=>isDate$2(xt)?formatUTCDate(xt,!0):xt;function toJSON(xt,$t={}){const Ct=defaultTrue($t.schema),kt=$t.format||{},Mt=columns(xt,$t.columns);let Ft="{";return Ct&&(Ft+='"schema":{"fields":'+JSON.stringify(Mt.map(jt=>({name:jt})))+'},"data":{'),Mt.forEach((jt,Bt)=>{Ft+=(Bt?",":"")+JSON.stringify(jt)+":[";const Vt=xt.column(jt),zt=kt[jt]||defaultFormatter$1;let Ht=-1;xt.scan(Gt=>{const qt=Vt.get(Gt);Ft+=(++Ht?",":"")+JSON.stringify(zt(qt))},!0,$t.limit,$t.offset),Ft+="]"}),Ft+"}"+(Ct?"}":"")}function toMarkdown(xt,$t={}){const Ct=columns(xt,$t.columns),{align:kt,format:Mt}=formats$2(xt,Ct,$t),Ft=Vt=>Vt==="c"?":-:":Vt==="r"?"-:":":-",jt=Vt=>Vt.replace(/\|/g,"\\|");let Bt="|"+Ct.map(jt).join("|")+`|
|`+Ct.map(Vt=>Ft(kt[Vt])).join("|")+"|";return scan(xt,Ct,$t.limit,$t.offset,{row(){Bt+=`
|`},cell(Vt,zt){Bt+=jt(formatValue$4(Vt,Mt[zt]))+"|"}}),Bt+`
`}function assign$1(xt,$t){for(const[Ct,kt]of entries$2($t))xt.set(Ct,kt);return xt}function escapeRegExp(xt){return xt.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function resolve$3(xt,$t,Ct=new Map){return $t=isNumber$2($t)?xt.columnName($t):$t,isString$2($t)?Ct.set($t,$t):isArray$3($t)?$t.forEach(kt=>resolve$3(xt,kt,Ct)):isFunction$3($t)?resolve$3(xt,$t(xt),Ct):isObject$4($t)?assign$1(Ct,$t):error$k(`Invalid column selection: ${toString$2($t)}`),Ct}function decorate(xt,$t){return xt.toObject=$t,xt}function toObject$1(xt){return isArray$3(xt)?xt.map(toObject$1):xt&&xt.toObject?xt.toObject():xt}function all(){return decorate(xt=>xt.columnNames(),()=>({all:[]}))}function not$1(...xt){return xt=xt.flat(),decorate($t=>{const Ct=resolve$3($t,xt);return $t.columnNames(kt=>!Ct.has(kt))},()=>({not:toObject$1(xt)}))}function range$4(xt,$t){return decorate(Ct=>{let kt=isNumber$2(xt)?xt:Ct.columnIndex(xt),Mt=isNumber$2($t)?$t:Ct.columnIndex($t);if(Mt<kt){const Ft=Mt;Mt=kt,kt=Ft}return Ct.columnNames().slice(kt,Mt+1)},()=>({range:[xt,$t]}))}function matches$1(xt){return isString$2(xt)&&(xt=RegExp(escapeRegExp(xt))),decorate($t=>$t.columnNames(Ct=>xt.test(Ct)),()=>({matches:[xt.source,xt.flags]}))}function arrayType(xt){return isTypedArray(xt.data)?xt.data.constructor:Array}class ColumnTable extends Table$1{static from($t,Ct){return new ColumnTable(columnsFrom($t,Ct),Ct)}static new($t,Ct){if($t instanceof ColumnTable)return $t;const kt={},Mt=[];for(const[Ft,jt]of entries$2($t))kt[Ft]=jt,Mt.push(Ft);return new ColumnTable(kt,Ct||Mt)}constructor($t,Ct,kt,Mt,Ft,jt){map$1($t,defaultColumnFactory,$t),Ct=Ct||Object.keys($t);const Bt=Ct.length?$t[Ct[0]].length:0;super(Ct,Bt,$t,kt,Mt,Ft,jt)}create({data:$t,names:Ct,filter:kt,groups:Mt,order:Ft}){const jt=kt!==void 0?kt:this.mask();return new ColumnTable($t||this._data,Ct||($t?null:this._names),jt,Mt!==void 0?Mt:regroup(this._group,kt&&jt),Ft!==void 0?Ft:this._order,this._params)}assign(...$t){const Ct=this.numRows(),kt=this.reify(),Mt=columnSet(kt).groupby(kt.groups());return $t.forEach(Ft=>{Ft=ColumnTable.new(Ft),Ft.numRows()!==Ct&&error$k("Assign row counts do not match"),Ft=Ft.reify(),Ft.columnNames(jt=>Mt.add(jt,Ft.column(jt)))}),this.create(Mt.new())}columns(){return this._data}column($t){return this._data[$t]}columnAt($t){return this._data[this._names[$t]]}array($t,Ct=Array){const kt=this.column($t),Mt=new Ct(this.numRows());let Ft=-1;return this.scan(jt=>Mt[++Ft]=kt.get(jt),!0),Mt}get($t,Ct=0){const kt=this.column($t);return this.isFiltered()||this.isOrdered()?kt.get(this.indices()[Ct]):kt.get(Ct)}getter($t){const Ct=this.column($t),kt=this.isFiltered()||this.isOrdered()?this.indices():null;return kt?Mt=>Ct.get(kt[Mt]):Ct?Mt=>Ct.get(Mt):error$k(`Unrecognized column: ${$t}`)}object($t=0){return objectBuilder(this)($t)}objects($t={}){const{grouped:Ct,limit:kt,offset:Mt}=$t,Ft=resolve$3(this,$t.columns||all()),jt=rowObjectBuilder(Ft),Bt=[];if(this.scan((Vt,zt)=>Bt.push(jt(Vt,zt)),!0,kt,Mt),Ct&&this.isGrouped()){const Vt=[];return this.scan(zt=>Vt.push(zt),!0,kt,Mt),nest$1(this,Vt,Bt,Ct)}return Bt}*[Symbol.iterator](){const $t=objectBuilder(this),Ct=this.numRows();for(let kt=0;kt<Ct;++kt)yield $t(kt)}reify($t){const Ct=$t?$t.length:this.numRows(),kt=this._names;let Mt,Ft;if(!$t&&!this.isOrdered())if(this.isFiltered())Ct===this.totalRows()&&(Mt=this.data());else return this;if(!Mt){const jt=$t?Vt=>$t.forEach(Vt):Vt=>this.scan(Vt,!0),Bt=kt.length;Mt={};for(let Vt=0;Vt<Bt;++Vt){const zt=kt[Vt],Ht=this.column(zt),Gt=Mt[zt]=new(arrayType(Ht))(Ct);let qt=-1;jt(Wt=>Gt[++qt]=Ht.get(Wt))}this.isGrouped()&&(Ft=reindex(this.groups(),jt,!!$t,Ct))}return this.create({data:Mt,names:kt,groups:Ft,filter:null,order:null})}transform(...$t){return $t.flat().reduce((Ct,kt)=>kt(Ct),this)}toArrow($t){return toArrow(this,$t)}toArrowBuffer($t){return toArrowIPC(this,$t)}toCSV($t){return toCSV(this,$t)}toHTML($t){return toHTML(this,$t)}toJSON($t){return toJSON(this,$t)}toMarkdown($t){return toMarkdown(this,$t)}}function objectBuilder(xt){let $t=xt._builder;if(!$t){const Ct=rowObjectBuilder(xt.columnNames()),kt=xt.data();if(xt.isOrdered()||xt.isFiltered()){const Mt=xt.indices();$t=Ft=>Ct(Mt[Ft],kt)}else $t=Mt=>Ct(Mt,kt);xt._builder=$t}return $t}class Reducer{constructor($t){this._outputs=$t}size(){return this._outputs.length}outputs(){return this._outputs}init(){return{}}add(){}rem(){}write(){}}function walk(xt,$t,Ct,kt){const Mt=Ct[xt.type]||Ct.Default;if(Mt&&Mt(xt,$t,kt)===!1)return;const Ft=walkers[xt.type];Ft&&Ft(xt,$t,Ct)}const unary=(xt,$t,Ct)=>{walk(xt.argument,$t,Ct,xt)},binary=(xt,$t,Ct)=>{walk(xt.left,$t,Ct,xt),walk(xt.right,$t,Ct,xt)},ternary=(xt,$t,Ct)=>{walk(xt.test,$t,Ct,xt),walk(xt.consequent,$t,Ct,xt),xt.alternate&&walk(xt.alternate,$t,Ct,xt)},func$1=(xt,$t,Ct)=>{list$3(xt.params,$t,Ct,xt),walk(xt.body,$t,Ct,xt)},call=(xt,$t,Ct)=>{walk(xt.callee,$t,Ct,xt),list$3(xt.arguments,$t,Ct,xt)},list$3=(xt,$t,Ct,kt)=>{xt.forEach(Mt=>walk(Mt,$t,Ct,kt))},walkers={TemplateLiteral:(xt,$t,Ct)=>{list$3(xt.expressions,$t,Ct,xt),list$3(xt.quasis,$t,Ct,xt)},MemberExpression:(xt,$t,Ct)=>{walk(xt.object,$t,Ct,xt),walk(xt.property,$t,Ct,xt)},CallExpression:call,NewExpression:call,ArrayExpression:(xt,$t,Ct)=>{list$3(xt.elements,$t,Ct,xt)},AssignmentExpression:binary,AwaitExpression:unary,BinaryExpression:binary,LogicalExpression:binary,UnaryExpression:unary,UpdateExpression:unary,ConditionalExpression:ternary,ObjectExpression:(xt,$t,Ct)=>{list$3(xt.properties,$t,Ct,xt)},Property:(xt,$t,Ct)=>{walk(xt.key,$t,Ct,xt),walk(xt.value,$t,Ct,xt)},ArrowFunctionExpression:func$1,FunctionExpression:func$1,FunctionDeclaration:func$1,VariableDeclaration:(xt,$t,Ct)=>{list$3(xt.declarations,$t,Ct,xt)},VariableDeclarator:(xt,$t,Ct)=>{walk(xt.id,$t,Ct,xt),walk(xt.init,$t,Ct,xt)},SpreadElement:(xt,$t,Ct)=>{walk(xt.argument,$t,Ct,xt)},BlockStatement:(xt,$t,Ct)=>{list$3(xt.body,$t,Ct,xt)},ExpressionStatement:(xt,$t,Ct)=>{walk(xt.expression,$t,Ct,xt)},IfStatement:ternary,ForStatement:(xt,$t,Ct)=>{walk(xt.init,$t,Ct,xt),walk(xt.test,$t,Ct,xt),walk(xt.update,$t,Ct,xt),walk(xt.body,$t,Ct,xt)},WhileStatement:(xt,$t,Ct)=>{walk(xt.test,$t,Ct,xt),walk(xt.body,$t,Ct,xt)},DoWhileStatement:(xt,$t,Ct)=>{walk(xt.body,$t,Ct,xt),walk(xt.test,$t,Ct,xt)},SwitchStatement:(xt,$t,Ct)=>{walk(xt.discriminant,$t,Ct,xt),list$3(xt.cases,$t,Ct,xt)},SwitchCase:(xt,$t,Ct)=>{xt.test&&walk(xt.test,$t,Ct,xt),list$3(xt.consequent,$t,Ct,xt)},ReturnStatement:unary,Program:(xt,$t,Ct)=>{walk(xt.body[0],$t,Ct,xt)}};function strip(xt){delete xt.start,delete xt.end,delete xt.optional}function stripMember(xt){strip(xt),delete xt.object,delete xt.property,delete xt.computed,xt.table||delete xt.table}function clean(xt){return walk(xt,null,{Column:stripMember,Constant:stripMember,Default:strip}),xt}function is(xt,$t){return $t&&$t.type===xt}function isFunctionExpression(xt){return is(FunctionExpression,xt)||is(ArrowFunctionExpression,xt)}function toFunction(xt){return isFunction$3(xt)?xt:()=>xt}const ERROR_ESC_AGGRONLY="Escaped functions are not valid as rollup or pivot values.";function parseEscape(xt,$t,Ct){xt.aggronly&&error$k(ERROR_ESC_AGGRONLY);const kt="(row,data)=>fn("+rowObjectCode(xt.table.columnNames())+",$)";return{escape:compile$3.escape(kt,toFunction($t.expr),Ct)}}var astralIdentifierCodes=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],astralIdentifierStartCodes=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],nonASCIIidentifierChars="-----------------------------------------------------------------------------------------------------------------------------------------------------",nonASCIIidentifierStartChars="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",reservedWords={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},ecma5AndLessKeywords="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",keywords$1$1={5:ecma5AndLessKeywords,"5module":ecma5AndLessKeywords+" export import",6:ecma5AndLessKeywords+" const class extends export import super"},keywordRelationalOperator=/^in(stanceof)?$/,nonASCIIidentifierStart=new RegExp("["+nonASCIIidentifierStartChars+"]"),nonASCIIidentifier=new RegExp("["+nonASCIIidentifierStartChars+nonASCIIidentifierChars+"]");function isInAstralSet(xt,$t){for(var Ct=65536,kt=0;kt<$t.length;kt+=2){if(Ct+=$t[kt],Ct>xt)return!1;if(Ct+=$t[kt+1],Ct>=xt)return!0}return!1}function isIdentifierStart$1(xt,$t){return xt<65?xt===36:xt<91?!0:xt<97?xt===95:xt<123?!0:xt<=65535?xt>=170&&nonASCIIidentifierStart.test(String.fromCharCode(xt)):$t===!1?!1:isInAstralSet(xt,astralIdentifierStartCodes)}function isIdentifierChar(xt,$t){return xt<48?xt===36:xt<58?!0:xt<65?!1:xt<91?!0:xt<97?xt===95:xt<123?!0:xt<=65535?xt>=170&&nonASCIIidentifier.test(String.fromCharCode(xt)):$t===!1?!1:isInAstralSet(xt,astralIdentifierStartCodes)||isInAstralSet(xt,astralIdentifierCodes)}var TokenType=function($t,Ct){Ct===void 0&&(Ct={}),this.label=$t,this.keyword=Ct.keyword,this.beforeExpr=!!Ct.beforeExpr,this.startsExpr=!!Ct.startsExpr,this.isLoop=!!Ct.isLoop,this.isAssign=!!Ct.isAssign,this.prefix=!!Ct.prefix,this.postfix=!!Ct.postfix,this.binop=Ct.binop||null,this.updateContext=null};function binop(xt,$t){return new TokenType(xt,{beforeExpr:!0,binop:$t})}var beforeExpr={beforeExpr:!0},startsExpr={startsExpr:!0},keywords$3={};function kw(xt,$t){return $t===void 0&&($t={}),$t.keyword=xt,keywords$3[xt]=new TokenType(xt,$t)}var types$1$1={num:new TokenType("num",startsExpr),regexp:new TokenType("regexp",startsExpr),string:new TokenType("string",startsExpr),name:new TokenType("name",startsExpr),privateId:new TokenType("privateId",startsExpr),eof:new TokenType("eof"),bracketL:new TokenType("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new TokenType("]"),braceL:new TokenType("{",{beforeExpr:!0,startsExpr:!0}),braceR:new TokenType("}"),parenL:new TokenType("(",{beforeExpr:!0,startsExpr:!0}),parenR:new TokenType(")"),comma:new TokenType(",",beforeExpr),semi:new TokenType(";",beforeExpr),colon:new TokenType(":",beforeExpr),dot:new TokenType("."),question:new TokenType("?",beforeExpr),questionDot:new TokenType("?."),arrow:new TokenType("=>",beforeExpr),template:new TokenType("template"),invalidTemplate:new TokenType("invalidTemplate"),ellipsis:new TokenType("...",beforeExpr),backQuote:new TokenType("`",startsExpr),dollarBraceL:new TokenType("${",{beforeExpr:!0,startsExpr:!0}),eq:new TokenType("=",{beforeExpr:!0,isAssign:!0}),assign:new TokenType("_=",{beforeExpr:!0,isAssign:!0}),incDec:new TokenType("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new TokenType("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:binop("||",1),logicalAND:binop("&&",2),bitwiseOR:binop("|",3),bitwiseXOR:binop("^",4),bitwiseAND:binop("&",5),equality:binop("==/!=/===/!==",6),relational:binop("</>/<=/>=",7),bitShift:binop("<</>>/>>>",8),plusMin:new TokenType("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:binop("%",10),star:binop("*",10),slash:binop("/",10),starstar:new TokenType("**",{beforeExpr:!0}),coalesce:binop("??",1),_break:kw("break"),_case:kw("case",beforeExpr),_catch:kw("catch"),_continue:kw("continue"),_debugger:kw("debugger"),_default:kw("default",beforeExpr),_do:kw("do",{isLoop:!0,beforeExpr:!0}),_else:kw("else",beforeExpr),_finally:kw("finally"),_for:kw("for",{isLoop:!0}),_function:kw("function",startsExpr),_if:kw("if"),_return:kw("return",beforeExpr),_switch:kw("switch"),_throw:kw("throw",beforeExpr),_try:kw("try"),_var:kw("var"),_const:kw("const"),_while:kw("while",{isLoop:!0}),_with:kw("with"),_new:kw("new",{beforeExpr:!0,startsExpr:!0}),_this:kw("this",startsExpr),_super:kw("super",startsExpr),_class:kw("class",startsExpr),_extends:kw("extends",beforeExpr),_export:kw("export"),_import:kw("import",startsExpr),_null:kw("null",startsExpr),_true:kw("true",startsExpr),_false:kw("false",startsExpr),_in:kw("in",{beforeExpr:!0,binop:7}),_instanceof:kw("instanceof",{beforeExpr:!0,binop:7}),_typeof:kw("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:kw("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:kw("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},lineBreak=/\r\n?|\n|\u2028|\u2029/,lineBreakG=new RegExp(lineBreak.source,"g");function isNewLine(xt){return xt===10||xt===13||xt===8232||xt===8233}function nextLineBreak(xt,$t,Ct){Ct===void 0&&(Ct=xt.length);for(var kt=$t;kt<Ct;kt++){var Mt=xt.charCodeAt(kt);if(isNewLine(Mt))return kt<Ct-1&&Mt===13&&xt.charCodeAt(kt+1)===10?kt+2:kt+1}return-1}var nonASCIIwhitespace=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,skipWhiteSpace=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,ref$4=Object.prototype,hasOwnProperty$1=ref$4.hasOwnProperty,toString$1=ref$4.toString,hasOwn=Object.hasOwn||function(xt,$t){return hasOwnProperty$1.call(xt,$t)},isArray$2=Array.isArray||function(xt){return toString$1.call(xt)==="[object Array]"},regexpCache=Object.create(null);function wordsRegexp(xt){return regexpCache[xt]||(regexpCache[xt]=new RegExp("^(?:"+xt.replace(/ /g,"|")+")$"))}function codePointToString(xt){return xt<=65535?String.fromCharCode(xt):(xt-=65536,String.fromCharCode((xt>>10)+55296,(xt&1023)+56320))}var loneSurrogate=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Position=function($t,Ct){this.line=$t,this.column=Ct};Position.prototype.offset=function($t){return new Position(this.line,this.column+$t)};var SourceLocation=function($t,Ct,kt){this.start=Ct,this.end=kt,$t.sourceFile!==null&&(this.source=$t.sourceFile)};function getLineInfo(xt,$t){for(var Ct=1,kt=0;;){var Mt=nextLineBreak(xt,kt,$t);if(Mt<0)return new Position(Ct,$t-kt);++Ct,kt=Mt}}var defaultOptions={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},warnedAboutEcmaVersion=!1;function getOptions(xt){var $t={};for(var Ct in defaultOptions)$t[Ct]=xt&&hasOwn(xt,Ct)?xt[Ct]:defaultOptions[Ct];if($t.ecmaVersion==="latest"?$t.ecmaVersion=1e8:$t.ecmaVersion==null?(!warnedAboutEcmaVersion&&typeof console=="object"&&console.warn&&(warnedAboutEcmaVersion=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),$t.ecmaVersion=11):$t.ecmaVersion>=2015&&($t.ecmaVersion-=2009),$t.allowReserved==null&&($t.allowReserved=$t.ecmaVersion<5),(!xt||xt.allowHashBang==null)&&($t.allowHashBang=$t.ecmaVersion>=14),isArray$2($t.onToken)){var kt=$t.onToken;$t.onToken=function(Mt){return kt.push(Mt)}}return isArray$2($t.onComment)&&($t.onComment=pushComment($t,$t.onComment)),$t}function pushComment(xt,$t){return function(Ct,kt,Mt,Ft,jt,Bt){var Vt={type:Ct?"Block":"Line",value:kt,start:Mt,end:Ft};xt.locations&&(Vt.loc=new SourceLocation(this,jt,Bt)),xt.ranges&&(Vt.range=[Mt,Ft]),$t.push(Vt)}}var SCOPE_TOP=1,SCOPE_FUNCTION=2,SCOPE_ASYNC=4,SCOPE_GENERATOR=8,SCOPE_ARROW=16,SCOPE_SIMPLE_CATCH=32,SCOPE_SUPER=64,SCOPE_DIRECT_SUPER=128,SCOPE_CLASS_STATIC_BLOCK=256,SCOPE_VAR=SCOPE_TOP|SCOPE_FUNCTION|SCOPE_CLASS_STATIC_BLOCK;function functionFlags(xt,$t){return SCOPE_FUNCTION|(xt?SCOPE_ASYNC:0)|($t?SCOPE_GENERATOR:0)}var BIND_NONE=0,BIND_VAR=1,BIND_LEXICAL=2,BIND_FUNCTION=3,BIND_SIMPLE_CATCH=4,BIND_OUTSIDE=5,Parser=function($t,Ct,kt){this.options=$t=getOptions($t),this.sourceFile=$t.sourceFile,this.keywords=wordsRegexp(keywords$1$1[$t.ecmaVersion>=6?6:$t.sourceType==="module"?"5module":5]);var Mt="";$t.allowReserved!==!0&&(Mt=reservedWords[$t.ecmaVersion>=6?6:$t.ecmaVersion===5?5:3],$t.sourceType==="module"&&(Mt+=" await")),this.reservedWords=wordsRegexp(Mt);var Ft=(Mt?Mt+" ":"")+reservedWords.strict;this.reservedWordsStrict=wordsRegexp(Ft),this.reservedWordsStrictBind=wordsRegexp(Ft+" "+reservedWords.strictBind),this.input=String(Ct),this.containsEsc=!1,kt?(this.pos=kt,this.lineStart=this.input.lastIndexOf(`
`,kt-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(lineBreak).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=types$1$1.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=$t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&$t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(SCOPE_TOP),this.regexpState=null,this.privateNameStack=[]},prototypeAccessors={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Parser.prototype.parse=function(){var $t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel($t)};prototypeAccessors.inFunction.get=function(){return(this.currentVarScope().flags&SCOPE_FUNCTION)>0};prototypeAccessors.inGenerator.get=function(){return(this.currentVarScope().flags&SCOPE_GENERATOR)>0&&!this.currentVarScope().inClassFieldInit};prototypeAccessors.inAsync.get=function(){return(this.currentVarScope().flags&SCOPE_ASYNC)>0&&!this.currentVarScope().inClassFieldInit};prototypeAccessors.canAwait.get=function(){for(var xt=this.scopeStack.length-1;xt>=0;xt--){var $t=this.scopeStack[xt];if($t.inClassFieldInit||$t.flags&SCOPE_CLASS_STATIC_BLOCK)return!1;if($t.flags&SCOPE_FUNCTION)return($t.flags&SCOPE_ASYNC)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};prototypeAccessors.allowSuper.get=function(){var xt=this.currentThisScope(),$t=xt.flags,Ct=xt.inClassFieldInit;return($t&SCOPE_SUPER)>0||Ct||this.options.allowSuperOutsideMethod};prototypeAccessors.allowDirectSuper.get=function(){return(this.currentThisScope().flags&SCOPE_DIRECT_SUPER)>0};prototypeAccessors.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};prototypeAccessors.allowNewDotTarget.get=function(){var xt=this.currentThisScope(),$t=xt.flags,Ct=xt.inClassFieldInit;return($t&(SCOPE_FUNCTION|SCOPE_CLASS_STATIC_BLOCK))>0||Ct};prototypeAccessors.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&SCOPE_CLASS_STATIC_BLOCK)>0};Parser.extend=function(){for(var $t=[],Ct=arguments.length;Ct--;)$t[Ct]=arguments[Ct];for(var kt=this,Mt=0;Mt<$t.length;Mt++)kt=$t[Mt](kt);return kt};Parser.parse=function($t,Ct){return new this(Ct,$t).parse()};Parser.parseExpressionAt=function($t,Ct,kt){var Mt=new this(kt,$t,Ct);return Mt.nextToken(),Mt.parseExpression()};Parser.tokenizer=function($t,Ct){return new this(Ct,$t)};Object.defineProperties(Parser.prototype,prototypeAccessors);var pp$9=Parser.prototype,literal=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;pp$9.strictDirective=function(xt){if(this.options.ecmaVersion<5)return!1;for(;;){skipWhiteSpace.lastIndex=xt,xt+=skipWhiteSpace.exec(this.input)[0].length;var $t=literal.exec(this.input.slice(xt));if(!$t)return!1;if(($t[1]||$t[2])==="use strict"){skipWhiteSpace.lastIndex=xt+$t[0].length;var Ct=skipWhiteSpace.exec(this.input),kt=Ct.index+Ct[0].length,Mt=this.input.charAt(kt);return Mt===";"||Mt==="}"||lineBreak.test(Ct[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(Mt)||Mt==="!"&&this.input.charAt(kt+1)==="=")}xt+=$t[0].length,skipWhiteSpace.lastIndex=xt,xt+=skipWhiteSpace.exec(this.input)[0].length,this.input[xt]===";"&&xt++}};pp$9.eat=function(xt){return this.type===xt?(this.next(),!0):!1};pp$9.isContextual=function(xt){return this.type===types$1$1.name&&this.value===xt&&!this.containsEsc};pp$9.eatContextual=function(xt){return this.isContextual(xt)?(this.next(),!0):!1};pp$9.expectContextual=function(xt){this.eatContextual(xt)||this.unexpected()};pp$9.canInsertSemicolon=function(){return this.type===types$1$1.eof||this.type===types$1$1.braceR||lineBreak.test(this.input.slice(this.lastTokEnd,this.start))};pp$9.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};pp$9.semicolon=function(){!this.eat(types$1$1.semi)&&!this.insertSemicolon()&&this.unexpected()};pp$9.afterTrailingComma=function(xt,$t){if(this.type===xt)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),$t||this.next(),!0};pp$9.expect=function(xt){this.eat(xt)||this.unexpected()};pp$9.unexpected=function(xt){this.raise(xt??this.start,"Unexpected token")};var DestructuringErrors=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};pp$9.checkPatternErrors=function(xt,$t){if(xt){xt.trailingComma>-1&&this.raiseRecoverable(xt.trailingComma,"Comma is not permitted after the rest element");var Ct=$t?xt.parenthesizedAssign:xt.parenthesizedBind;Ct>-1&&this.raiseRecoverable(Ct,$t?"Assigning to rvalue":"Parenthesized pattern")}};pp$9.checkExpressionErrors=function(xt,$t){if(!xt)return!1;var Ct=xt.shorthandAssign,kt=xt.doubleProto;if(!$t)return Ct>=0||kt>=0;Ct>=0&&this.raise(Ct,"Shorthand property assignments are valid only in destructuring patterns"),kt>=0&&this.raiseRecoverable(kt,"Redefinition of __proto__ property")};pp$9.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};pp$9.isSimpleAssignTarget=function(xt){return xt.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(xt.expression):xt.type==="Identifier"||xt.type==="MemberExpression"};var pp$8=Parser.prototype;pp$8.parseTopLevel=function(xt){var $t=Object.create(null);for(xt.body||(xt.body=[]);this.type!==types$1$1.eof;){var Ct=this.parseStatement(null,!0,$t);xt.body.push(Ct)}if(this.inModule)for(var kt=0,Mt=Object.keys(this.undefinedExports);kt<Mt.length;kt+=1){var Ft=Mt[kt];this.raiseRecoverable(this.undefinedExports[Ft].start,"Export '"+Ft+"' is not defined")}return this.adaptDirectivePrologue(xt.body),this.next(),xt.sourceType=this.options.sourceType,this.finishNode(xt,"Program")};var loopLabel={kind:"loop"},switchLabel={kind:"switch"};pp$8.isLet=function(xt){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;skipWhiteSpace.lastIndex=this.pos;var $t=skipWhiteSpace.exec(this.input),Ct=this.pos+$t[0].length,kt=this.input.charCodeAt(Ct);if(kt===91||kt===92)return!0;if(xt)return!1;if(kt===123||kt>55295&&kt<56320)return!0;if(isIdentifierStart$1(kt,!0)){for(var Mt=Ct+1;isIdentifierChar(kt=this.input.charCodeAt(Mt),!0);)++Mt;if(kt===92||kt>55295&&kt<56320)return!0;var Ft=this.input.slice(Ct,Mt);if(!keywordRelationalOperator.test(Ft))return!0}return!1};pp$8.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;skipWhiteSpace.lastIndex=this.pos;var xt=skipWhiteSpace.exec(this.input),$t=this.pos+xt[0].length,Ct;return!lineBreak.test(this.input.slice(this.pos,$t))&&this.input.slice($t,$t+8)==="function"&&($t+8===this.input.length||!(isIdentifierChar(Ct=this.input.charCodeAt($t+8))||Ct>55295&&Ct<56320))};pp$8.parseStatement=function(xt,$t,Ct){var kt=this.type,Mt=this.startNode(),Ft;switch(this.isLet(xt)&&(kt=types$1$1._var,Ft="let"),kt){case types$1$1._break:case types$1$1._continue:return this.parseBreakContinueStatement(Mt,kt.keyword);case types$1$1._debugger:return this.parseDebuggerStatement(Mt);case types$1$1._do:return this.parseDoStatement(Mt);case types$1$1._for:return this.parseForStatement(Mt);case types$1$1._function:return xt&&(this.strict||xt!=="if"&&xt!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(Mt,!1,!xt);case types$1$1._class:return xt&&this.unexpected(),this.parseClass(Mt,!0);case types$1$1._if:return this.parseIfStatement(Mt);case types$1$1._return:return this.parseReturnStatement(Mt);case types$1$1._switch:return this.parseSwitchStatement(Mt);case types$1$1._throw:return this.parseThrowStatement(Mt);case types$1$1._try:return this.parseTryStatement(Mt);case types$1$1._const:case types$1$1._var:return Ft=Ft||this.value,xt&&Ft!=="var"&&this.unexpected(),this.parseVarStatement(Mt,Ft);case types$1$1._while:return this.parseWhileStatement(Mt);case types$1$1._with:return this.parseWithStatement(Mt);case types$1$1.braceL:return this.parseBlock(!0,Mt);case types$1$1.semi:return this.parseEmptyStatement(Mt);case types$1$1._export:case types$1$1._import:if(this.options.ecmaVersion>10&&kt===types$1$1._import){skipWhiteSpace.lastIndex=this.pos;var jt=skipWhiteSpace.exec(this.input),Bt=this.pos+jt[0].length,Vt=this.input.charCodeAt(Bt);if(Vt===40||Vt===46)return this.parseExpressionStatement(Mt,this.parseExpression())}return this.options.allowImportExportEverywhere||($t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),kt===types$1$1._import?this.parseImport(Mt):this.parseExport(Mt,Ct);default:if(this.isAsyncFunction())return xt&&this.unexpected(),this.next(),this.parseFunctionStatement(Mt,!0,!xt);var zt=this.value,Ht=this.parseExpression();return kt===types$1$1.name&&Ht.type==="Identifier"&&this.eat(types$1$1.colon)?this.parseLabeledStatement(Mt,zt,Ht,xt):this.parseExpressionStatement(Mt,Ht)}};pp$8.parseBreakContinueStatement=function(xt,$t){var Ct=$t==="break";this.next(),this.eat(types$1$1.semi)||this.insertSemicolon()?xt.label=null:this.type!==types$1$1.name?this.unexpected():(xt.label=this.parseIdent(),this.semicolon());for(var kt=0;kt<this.labels.length;++kt){var Mt=this.labels[kt];if((xt.label==null||Mt.name===xt.label.name)&&(Mt.kind!=null&&(Ct||Mt.kind==="loop")||xt.label&&Ct))break}return kt===this.labels.length&&this.raise(xt.start,"Unsyntactic "+$t),this.finishNode(xt,Ct?"BreakStatement":"ContinueStatement")};pp$8.parseDebuggerStatement=function(xt){return this.next(),this.semicolon(),this.finishNode(xt,"DebuggerStatement")};pp$8.parseDoStatement=function(xt){return this.next(),this.labels.push(loopLabel),xt.body=this.parseStatement("do"),this.labels.pop(),this.expect(types$1$1._while),xt.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(types$1$1.semi):this.semicolon(),this.finishNode(xt,"DoWhileStatement")};pp$8.parseForStatement=function(xt){this.next();var $t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(loopLabel),this.enterScope(0),this.expect(types$1$1.parenL),this.type===types$1$1.semi)return $t>-1&&this.unexpected($t),this.parseFor(xt,null);var Ct=this.isLet();if(this.type===types$1$1._var||this.type===types$1$1._const||Ct){var kt=this.startNode(),Mt=Ct?"let":this.value;return this.next(),this.parseVar(kt,!0,Mt),this.finishNode(kt,"VariableDeclaration"),(this.type===types$1$1._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&kt.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===types$1$1._in?$t>-1&&this.unexpected($t):xt.await=$t>-1),this.parseForIn(xt,kt)):($t>-1&&this.unexpected($t),this.parseFor(xt,kt))}var Ft=this.isContextual("let"),jt=!1,Bt=new DestructuringErrors,Vt=this.parseExpression($t>-1?"await":!0,Bt);return this.type===types$1$1._in||(jt=this.options.ecmaVersion>=6&&this.isContextual("of"))?(this.options.ecmaVersion>=9&&(this.type===types$1$1._in?$t>-1&&this.unexpected($t):xt.await=$t>-1),Ft&&jt&&this.raise(Vt.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(Vt,!1,Bt),this.checkLValPattern(Vt),this.parseForIn(xt,Vt)):(this.checkExpressionErrors(Bt,!0),$t>-1&&this.unexpected($t),this.parseFor(xt,Vt))};pp$8.parseFunctionStatement=function(xt,$t,Ct){return this.next(),this.parseFunction(xt,FUNC_STATEMENT|(Ct?0:FUNC_HANGING_STATEMENT),!1,$t)};pp$8.parseIfStatement=function(xt){return this.next(),xt.test=this.parseParenExpression(),xt.consequent=this.parseStatement("if"),xt.alternate=this.eat(types$1$1._else)?this.parseStatement("if"):null,this.finishNode(xt,"IfStatement")};pp$8.parseReturnStatement=function(xt){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(types$1$1.semi)||this.insertSemicolon()?xt.argument=null:(xt.argument=this.parseExpression(),this.semicolon()),this.finishNode(xt,"ReturnStatement")};pp$8.parseSwitchStatement=function(xt){this.next(),xt.discriminant=this.parseParenExpression(),xt.cases=[],this.expect(types$1$1.braceL),this.labels.push(switchLabel),this.enterScope(0);for(var $t,Ct=!1;this.type!==types$1$1.braceR;)if(this.type===types$1$1._case||this.type===types$1$1._default){var kt=this.type===types$1$1._case;$t&&this.finishNode($t,"SwitchCase"),xt.cases.push($t=this.startNode()),$t.consequent=[],this.next(),kt?$t.test=this.parseExpression():(Ct&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),Ct=!0,$t.test=null),this.expect(types$1$1.colon)}else $t||this.unexpected(),$t.consequent.push(this.parseStatement(null));return this.exitScope(),$t&&this.finishNode($t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(xt,"SwitchStatement")};pp$8.parseThrowStatement=function(xt){return this.next(),lineBreak.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),xt.argument=this.parseExpression(),this.semicolon(),this.finishNode(xt,"ThrowStatement")};var empty$1=[];pp$8.parseCatchClauseParam=function(){var xt=this.parseBindingAtom(),$t=xt.type==="Identifier";return this.enterScope($t?SCOPE_SIMPLE_CATCH:0),this.checkLValPattern(xt,$t?BIND_SIMPLE_CATCH:BIND_LEXICAL),this.expect(types$1$1.parenR),xt};pp$8.parseTryStatement=function(xt){if(this.next(),xt.block=this.parseBlock(),xt.handler=null,this.type===types$1$1._catch){var $t=this.startNode();this.next(),this.eat(types$1$1.parenL)?$t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),$t.param=null,this.enterScope(0)),$t.body=this.parseBlock(!1),this.exitScope(),xt.handler=this.finishNode($t,"CatchClause")}return xt.finalizer=this.eat(types$1$1._finally)?this.parseBlock():null,!xt.handler&&!xt.finalizer&&this.raise(xt.start,"Missing catch or finally clause"),this.finishNode(xt,"TryStatement")};pp$8.parseVarStatement=function(xt,$t,Ct){return this.next(),this.parseVar(xt,!1,$t,Ct),this.semicolon(),this.finishNode(xt,"VariableDeclaration")};pp$8.parseWhileStatement=function(xt){return this.next(),xt.test=this.parseParenExpression(),this.labels.push(loopLabel),xt.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(xt,"WhileStatement")};pp$8.parseWithStatement=function(xt){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),xt.object=this.parseParenExpression(),xt.body=this.parseStatement("with"),this.finishNode(xt,"WithStatement")};pp$8.parseEmptyStatement=function(xt){return this.next(),this.finishNode(xt,"EmptyStatement")};pp$8.parseLabeledStatement=function(xt,$t,Ct,kt){for(var Mt=0,Ft=this.labels;Mt<Ft.length;Mt+=1){var jt=Ft[Mt];jt.name===$t&&this.raise(Ct.start,"Label '"+$t+"' is already declared")}for(var Bt=this.type.isLoop?"loop":this.type===types$1$1._switch?"switch":null,Vt=this.labels.length-1;Vt>=0;Vt--){var zt=this.labels[Vt];if(zt.statementStart===xt.start)zt.statementStart=this.start,zt.kind=Bt;else break}return this.labels.push({name:$t,kind:Bt,statementStart:this.start}),xt.body=this.parseStatement(kt?kt.indexOf("label")===-1?kt+"label":kt:"label"),this.labels.pop(),xt.label=Ct,this.finishNode(xt,"LabeledStatement")};pp$8.parseExpressionStatement=function(xt,$t){return xt.expression=$t,this.semicolon(),this.finishNode(xt,"ExpressionStatement")};pp$8.parseBlock=function(xt,$t,Ct){for(xt===void 0&&(xt=!0),$t===void 0&&($t=this.startNode()),$t.body=[],this.expect(types$1$1.braceL),xt&&this.enterScope(0);this.type!==types$1$1.braceR;){var kt=this.parseStatement(null);$t.body.push(kt)}return Ct&&(this.strict=!1),this.next(),xt&&this.exitScope(),this.finishNode($t,"BlockStatement")};pp$8.parseFor=function(xt,$t){return xt.init=$t,this.expect(types$1$1.semi),xt.test=this.type===types$1$1.semi?null:this.parseExpression(),this.expect(types$1$1.semi),xt.update=this.type===types$1$1.parenR?null:this.parseExpression(),this.expect(types$1$1.parenR),xt.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(xt,"ForStatement")};pp$8.parseForIn=function(xt,$t){var Ct=this.type===types$1$1._in;return this.next(),$t.type==="VariableDeclaration"&&$t.declarations[0].init!=null&&(!Ct||this.options.ecmaVersion<8||this.strict||$t.kind!=="var"||$t.declarations[0].id.type!=="Identifier")&&this.raise($t.start,(Ct?"for-in":"for-of")+" loop variable declaration may not have an initializer"),xt.left=$t,xt.right=Ct?this.parseExpression():this.parseMaybeAssign(),this.expect(types$1$1.parenR),xt.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(xt,Ct?"ForInStatement":"ForOfStatement")};pp$8.parseVar=function(xt,$t,Ct,kt){for(xt.declarations=[],xt.kind=Ct;;){var Mt=this.startNode();if(this.parseVarId(Mt,Ct),this.eat(types$1$1.eq)?Mt.init=this.parseMaybeAssign($t):!kt&&Ct==="const"&&!(this.type===types$1$1._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!kt&&Mt.id.type!=="Identifier"&&!($t&&(this.type===types$1$1._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):Mt.init=null,xt.declarations.push(this.finishNode(Mt,"VariableDeclarator")),!this.eat(types$1$1.comma))break}return xt};pp$8.parseVarId=function(xt,$t){xt.id=this.parseBindingAtom(),this.checkLValPattern(xt.id,$t==="var"?BIND_VAR:BIND_LEXICAL,!1)};var FUNC_STATEMENT=1,FUNC_HANGING_STATEMENT=2,FUNC_NULLABLE_ID=4;pp$8.parseFunction=function(xt,$t,Ct,kt,Mt){this.initFunction(xt),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!kt)&&(this.type===types$1$1.star&&$t&FUNC_HANGING_STATEMENT&&this.unexpected(),xt.generator=this.eat(types$1$1.star)),this.options.ecmaVersion>=8&&(xt.async=!!kt),$t&FUNC_STATEMENT&&(xt.id=$t&FUNC_NULLABLE_ID&&this.type!==types$1$1.name?null:this.parseIdent(),xt.id&&!($t&FUNC_HANGING_STATEMENT)&&this.checkLValSimple(xt.id,this.strict||xt.generator||xt.async?this.treatFunctionsAsVar?BIND_VAR:BIND_LEXICAL:BIND_FUNCTION));var Ft=this.yieldPos,jt=this.awaitPos,Bt=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(functionFlags(xt.async,xt.generator)),$t&FUNC_STATEMENT||(xt.id=this.type===types$1$1.name?this.parseIdent():null),this.parseFunctionParams(xt),this.parseFunctionBody(xt,Ct,!1,Mt),this.yieldPos=Ft,this.awaitPos=jt,this.awaitIdentPos=Bt,this.finishNode(xt,$t&FUNC_STATEMENT?"FunctionDeclaration":"FunctionExpression")};pp$8.parseFunctionParams=function(xt){this.expect(types$1$1.parenL),xt.params=this.parseBindingList(types$1$1.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};pp$8.parseClass=function(xt,$t){this.next();var Ct=this.strict;this.strict=!0,this.parseClassId(xt,$t),this.parseClassSuper(xt);var kt=this.enterClassBody(),Mt=this.startNode(),Ft=!1;for(Mt.body=[],this.expect(types$1$1.braceL);this.type!==types$1$1.braceR;){var jt=this.parseClassElement(xt.superClass!==null);jt&&(Mt.body.push(jt),jt.type==="MethodDefinition"&&jt.kind==="constructor"?(Ft&&this.raiseRecoverable(jt.start,"Duplicate constructor in the same class"),Ft=!0):jt.key&&jt.key.type==="PrivateIdentifier"&&isPrivateNameConflicted(kt,jt)&&this.raiseRecoverable(jt.key.start,"Identifier '#"+jt.key.name+"' has already been declared"))}return this.strict=Ct,this.next(),xt.body=this.finishNode(Mt,"ClassBody"),this.exitClassBody(),this.finishNode(xt,$t?"ClassDeclaration":"ClassExpression")};pp$8.parseClassElement=function(xt){if(this.eat(types$1$1.semi))return null;var $t=this.options.ecmaVersion,Ct=this.startNode(),kt="",Mt=!1,Ft=!1,jt="method",Bt=!1;if(this.eatContextual("static")){if($t>=13&&this.eat(types$1$1.braceL))return this.parseClassStaticBlock(Ct),Ct;this.isClassElementNameStart()||this.type===types$1$1.star?Bt=!0:kt="static"}if(Ct.static=Bt,!kt&&$t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===types$1$1.star)&&!this.canInsertSemicolon()?Ft=!0:kt="async"),!kt&&($t>=9||!Ft)&&this.eat(types$1$1.star)&&(Mt=!0),!kt&&!Ft&&!Mt){var Vt=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?jt=Vt:kt=Vt)}if(kt?(Ct.computed=!1,Ct.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),Ct.key.name=kt,this.finishNode(Ct.key,"Identifier")):this.parseClassElementName(Ct),$t<13||this.type===types$1$1.parenL||jt!=="method"||Mt||Ft){var zt=!Ct.static&&checkKeyName(Ct,"constructor"),Ht=zt&&xt;zt&&jt!=="method"&&this.raise(Ct.key.start,"Constructor can't have get/set modifier"),Ct.kind=zt?"constructor":jt,this.parseClassMethod(Ct,Mt,Ft,Ht)}else this.parseClassField(Ct);return Ct};pp$8.isClassElementNameStart=function(){return this.type===types$1$1.name||this.type===types$1$1.privateId||this.type===types$1$1.num||this.type===types$1$1.string||this.type===types$1$1.bracketL||this.type.keyword};pp$8.parseClassElementName=function(xt){this.type===types$1$1.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),xt.computed=!1,xt.key=this.parsePrivateIdent()):this.parsePropertyName(xt)};pp$8.parseClassMethod=function(xt,$t,Ct,kt){var Mt=xt.key;xt.kind==="constructor"?($t&&this.raise(Mt.start,"Constructor can't be a generator"),Ct&&this.raise(Mt.start,"Constructor can't be an async method")):xt.static&&checkKeyName(xt,"prototype")&&this.raise(Mt.start,"Classes may not have a static property named prototype");var Ft=xt.value=this.parseMethod($t,Ct,kt);return xt.kind==="get"&&Ft.params.length!==0&&this.raiseRecoverable(Ft.start,"getter should have no params"),xt.kind==="set"&&Ft.params.length!==1&&this.raiseRecoverable(Ft.start,"setter should have exactly one param"),xt.kind==="set"&&Ft.params[0].type==="RestElement"&&this.raiseRecoverable(Ft.params[0].start,"Setter cannot use rest params"),this.finishNode(xt,"MethodDefinition")};pp$8.parseClassField=function(xt){if(checkKeyName(xt,"constructor")?this.raise(xt.key.start,"Classes can't have a field named 'constructor'"):xt.static&&checkKeyName(xt,"prototype")&&this.raise(xt.key.start,"Classes can't have a static field named 'prototype'"),this.eat(types$1$1.eq)){var $t=this.currentThisScope(),Ct=$t.inClassFieldInit;$t.inClassFieldInit=!0,xt.value=this.parseMaybeAssign(),$t.inClassFieldInit=Ct}else xt.value=null;return this.semicolon(),this.finishNode(xt,"PropertyDefinition")};pp$8.parseClassStaticBlock=function(xt){xt.body=[];var $t=this.labels;for(this.labels=[],this.enterScope(SCOPE_CLASS_STATIC_BLOCK|SCOPE_SUPER);this.type!==types$1$1.braceR;){var Ct=this.parseStatement(null);xt.body.push(Ct)}return this.next(),this.exitScope(),this.labels=$t,this.finishNode(xt,"StaticBlock")};pp$8.parseClassId=function(xt,$t){this.type===types$1$1.name?(xt.id=this.parseIdent(),$t&&this.checkLValSimple(xt.id,BIND_LEXICAL,!1)):($t===!0&&this.unexpected(),xt.id=null)};pp$8.parseClassSuper=function(xt){xt.superClass=this.eat(types$1$1._extends)?this.parseExprSubscripts(null,!1):null};pp$8.enterClassBody=function(){var xt={declared:Object.create(null),used:[]};return this.privateNameStack.push(xt),xt.declared};pp$8.exitClassBody=function(){var xt=this.privateNameStack.pop(),$t=xt.declared,Ct=xt.used;if(this.options.checkPrivateFields)for(var kt=this.privateNameStack.length,Mt=kt===0?null:this.privateNameStack[kt-1],Ft=0;Ft<Ct.length;++Ft){var jt=Ct[Ft];hasOwn($t,jt.name)||(Mt?Mt.used.push(jt):this.raiseRecoverable(jt.start,"Private field '#"+jt.name+"' must be declared in an enclosing class"))}};function isPrivateNameConflicted(xt,$t){var Ct=$t.key.name,kt=xt[Ct],Mt="true";return $t.type==="MethodDefinition"&&($t.kind==="get"||$t.kind==="set")&&(Mt=($t.static?"s":"i")+$t.kind),kt==="iget"&&Mt==="iset"||kt==="iset"&&Mt==="iget"||kt==="sget"&&Mt==="sset"||kt==="sset"&&Mt==="sget"?(xt[Ct]="true",!1):kt?!0:(xt[Ct]=Mt,!1)}function checkKeyName(xt,$t){var Ct=xt.computed,kt=xt.key;return!Ct&&(kt.type==="Identifier"&&kt.name===$t||kt.type==="Literal"&&kt.value===$t)}pp$8.parseExportAllDeclaration=function(xt,$t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(xt.exported=this.parseModuleExportName(),this.checkExport($t,xt.exported,this.lastTokStart)):xt.exported=null),this.expectContextual("from"),this.type!==types$1$1.string&&this.unexpected(),xt.source=this.parseExprAtom(),this.semicolon(),this.finishNode(xt,"ExportAllDeclaration")};pp$8.parseExport=function(xt,$t){if(this.next(),this.eat(types$1$1.star))return this.parseExportAllDeclaration(xt,$t);if(this.eat(types$1$1._default))return this.checkExport($t,"default",this.lastTokStart),xt.declaration=this.parseExportDefaultDeclaration(),this.finishNode(xt,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())xt.declaration=this.parseExportDeclaration(xt),xt.declaration.type==="VariableDeclaration"?this.checkVariableExport($t,xt.declaration.declarations):this.checkExport($t,xt.declaration.id,xt.declaration.id.start),xt.specifiers=[],xt.source=null;else{if(xt.declaration=null,xt.specifiers=this.parseExportSpecifiers($t),this.eatContextual("from"))this.type!==types$1$1.string&&this.unexpected(),xt.source=this.parseExprAtom();else{for(var Ct=0,kt=xt.specifiers;Ct<kt.length;Ct+=1){var Mt=kt[Ct];this.checkUnreserved(Mt.local),this.checkLocalExport(Mt.local),Mt.local.type==="Literal"&&this.raise(Mt.local.start,"A string literal cannot be used as an exported binding without `from`.")}xt.source=null}this.semicolon()}return this.finishNode(xt,"ExportNamedDeclaration")};pp$8.parseExportDeclaration=function(xt){return this.parseStatement(null)};pp$8.parseExportDefaultDeclaration=function(){var xt;if(this.type===types$1$1._function||(xt=this.isAsyncFunction())){var $t=this.startNode();return this.next(),xt&&this.next(),this.parseFunction($t,FUNC_STATEMENT|FUNC_NULLABLE_ID,!1,xt)}else if(this.type===types$1$1._class){var Ct=this.startNode();return this.parseClass(Ct,"nullableID")}else{var kt=this.parseMaybeAssign();return this.semicolon(),kt}};pp$8.checkExport=function(xt,$t,Ct){xt&&(typeof $t!="string"&&($t=$t.type==="Identifier"?$t.name:$t.value),hasOwn(xt,$t)&&this.raiseRecoverable(Ct,"Duplicate export '"+$t+"'"),xt[$t]=!0)};pp$8.checkPatternExport=function(xt,$t){var Ct=$t.type;if(Ct==="Identifier")this.checkExport(xt,$t,$t.start);else if(Ct==="ObjectPattern")for(var kt=0,Mt=$t.properties;kt<Mt.length;kt+=1){var Ft=Mt[kt];this.checkPatternExport(xt,Ft)}else if(Ct==="ArrayPattern")for(var jt=0,Bt=$t.elements;jt<Bt.length;jt+=1){var Vt=Bt[jt];Vt&&this.checkPatternExport(xt,Vt)}else Ct==="Property"?this.checkPatternExport(xt,$t.value):Ct==="AssignmentPattern"?this.checkPatternExport(xt,$t.left):Ct==="RestElement"&&this.checkPatternExport(xt,$t.argument)};pp$8.checkVariableExport=function(xt,$t){if(xt)for(var Ct=0,kt=$t;Ct<kt.length;Ct+=1){var Mt=kt[Ct];this.checkPatternExport(xt,Mt.id)}};pp$8.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};pp$8.parseExportSpecifier=function(xt){var $t=this.startNode();return $t.local=this.parseModuleExportName(),$t.exported=this.eatContextual("as")?this.parseModuleExportName():$t.local,this.checkExport(xt,$t.exported,$t.exported.start),this.finishNode($t,"ExportSpecifier")};pp$8.parseExportSpecifiers=function(xt){var $t=[],Ct=!0;for(this.expect(types$1$1.braceL);!this.eat(types$1$1.braceR);){if(Ct)Ct=!1;else if(this.expect(types$1$1.comma),this.afterTrailingComma(types$1$1.braceR))break;$t.push(this.parseExportSpecifier(xt))}return $t};pp$8.parseImport=function(xt){return this.next(),this.type===types$1$1.string?(xt.specifiers=empty$1,xt.source=this.parseExprAtom()):(xt.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),xt.source=this.type===types$1$1.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(xt,"ImportDeclaration")};pp$8.parseImportSpecifier=function(){var xt=this.startNode();return xt.imported=this.parseModuleExportName(),this.eatContextual("as")?xt.local=this.parseIdent():(this.checkUnreserved(xt.imported),xt.local=xt.imported),this.checkLValSimple(xt.local,BIND_LEXICAL),this.finishNode(xt,"ImportSpecifier")};pp$8.parseImportDefaultSpecifier=function(){var xt=this.startNode();return xt.local=this.parseIdent(),this.checkLValSimple(xt.local,BIND_LEXICAL),this.finishNode(xt,"ImportDefaultSpecifier")};pp$8.parseImportNamespaceSpecifier=function(){var xt=this.startNode();return this.next(),this.expectContextual("as"),xt.local=this.parseIdent(),this.checkLValSimple(xt.local,BIND_LEXICAL),this.finishNode(xt,"ImportNamespaceSpecifier")};pp$8.parseImportSpecifiers=function(){var xt=[],$t=!0;if(this.type===types$1$1.name&&(xt.push(this.parseImportDefaultSpecifier()),!this.eat(types$1$1.comma)))return xt;if(this.type===types$1$1.star)return xt.push(this.parseImportNamespaceSpecifier()),xt;for(this.expect(types$1$1.braceL);!this.eat(types$1$1.braceR);){if($t)$t=!1;else if(this.expect(types$1$1.comma),this.afterTrailingComma(types$1$1.braceR))break;xt.push(this.parseImportSpecifier())}return xt};pp$8.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===types$1$1.string){var xt=this.parseLiteral(this.value);return loneSurrogate.test(xt.value)&&this.raise(xt.start,"An export name cannot include a lone surrogate."),xt}return this.parseIdent(!0)};pp$8.adaptDirectivePrologue=function(xt){for(var $t=0;$t<xt.length&&this.isDirectiveCandidate(xt[$t]);++$t)xt[$t].directive=xt[$t].expression.raw.slice(1,-1)};pp$8.isDirectiveCandidate=function(xt){return this.options.ecmaVersion>=5&&xt.type==="ExpressionStatement"&&xt.expression.type==="Literal"&&typeof xt.expression.value=="string"&&(this.input[xt.start]==='"'||this.input[xt.start]==="'")};var pp$7=Parser.prototype;pp$7.toAssignable=function(xt,$t,Ct){if(this.options.ecmaVersion>=6&&xt)switch(xt.type){case"Identifier":this.inAsync&&xt.name==="await"&&this.raise(xt.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":xt.type="ObjectPattern",Ct&&this.checkPatternErrors(Ct,!0);for(var kt=0,Mt=xt.properties;kt<Mt.length;kt+=1){var Ft=Mt[kt];this.toAssignable(Ft,$t),Ft.type==="RestElement"&&(Ft.argument.type==="ArrayPattern"||Ft.argument.type==="ObjectPattern")&&this.raise(Ft.argument.start,"Unexpected token")}break;case"Property":xt.kind!=="init"&&this.raise(xt.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(xt.value,$t);break;case"ArrayExpression":xt.type="ArrayPattern",Ct&&this.checkPatternErrors(Ct,!0),this.toAssignableList(xt.elements,$t);break;case"SpreadElement":xt.type="RestElement",this.toAssignable(xt.argument,$t),xt.argument.type==="AssignmentPattern"&&this.raise(xt.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":xt.operator!=="="&&this.raise(xt.left.end,"Only '=' operator can be used for specifying default value."),xt.type="AssignmentPattern",delete xt.operator,this.toAssignable(xt.left,$t);break;case"ParenthesizedExpression":this.toAssignable(xt.expression,$t,Ct);break;case"ChainExpression":this.raiseRecoverable(xt.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!$t)break;default:this.raise(xt.start,"Assigning to rvalue")}else Ct&&this.checkPatternErrors(Ct,!0);return xt};pp$7.toAssignableList=function(xt,$t){for(var Ct=xt.length,kt=0;kt<Ct;kt++){var Mt=xt[kt];Mt&&this.toAssignable(Mt,$t)}if(Ct){var Ft=xt[Ct-1];this.options.ecmaVersion===6&&$t&&Ft&&Ft.type==="RestElement"&&Ft.argument.type!=="Identifier"&&this.unexpected(Ft.argument.start)}return xt};pp$7.parseSpread=function(xt){var $t=this.startNode();return this.next(),$t.argument=this.parseMaybeAssign(!1,xt),this.finishNode($t,"SpreadElement")};pp$7.parseRestBinding=function(){var xt=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==types$1$1.name&&this.unexpected(),xt.argument=this.parseBindingAtom(),this.finishNode(xt,"RestElement")};pp$7.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case types$1$1.bracketL:var xt=this.startNode();return this.next(),xt.elements=this.parseBindingList(types$1$1.bracketR,!0,!0),this.finishNode(xt,"ArrayPattern");case types$1$1.braceL:return this.parseObj(!0)}return this.parseIdent()};pp$7.parseBindingList=function(xt,$t,Ct,kt){for(var Mt=[],Ft=!0;!this.eat(xt);)if(Ft?Ft=!1:this.expect(types$1$1.comma),$t&&this.type===types$1$1.comma)Mt.push(null);else{if(Ct&&this.afterTrailingComma(xt))break;if(this.type===types$1$1.ellipsis){var jt=this.parseRestBinding();this.parseBindingListItem(jt),Mt.push(jt),this.type===types$1$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(xt);break}else Mt.push(this.parseAssignableListItem(kt))}return Mt};pp$7.parseAssignableListItem=function(xt){var $t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem($t),$t};pp$7.parseBindingListItem=function(xt){return xt};pp$7.parseMaybeDefault=function(xt,$t,Ct){if(Ct=Ct||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(types$1$1.eq))return Ct;var kt=this.startNodeAt(xt,$t);return kt.left=Ct,kt.right=this.parseMaybeAssign(),this.finishNode(kt,"AssignmentPattern")};pp$7.checkLValSimple=function(xt,$t,Ct){$t===void 0&&($t=BIND_NONE);var kt=$t!==BIND_NONE;switch(xt.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(xt.name)&&this.raiseRecoverable(xt.start,(kt?"Binding ":"Assigning to ")+xt.name+" in strict mode"),kt&&($t===BIND_LEXICAL&&xt.name==="let"&&this.raiseRecoverable(xt.start,"let is disallowed as a lexically bound name"),Ct&&(hasOwn(Ct,xt.name)&&this.raiseRecoverable(xt.start,"Argument name clash"),Ct[xt.name]=!0),$t!==BIND_OUTSIDE&&this.declareName(xt.name,$t,xt.start));break;case"ChainExpression":this.raiseRecoverable(xt.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":kt&&this.raiseRecoverable(xt.start,"Binding member expression");break;case"ParenthesizedExpression":return kt&&this.raiseRecoverable(xt.start,"Binding parenthesized expression"),this.checkLValSimple(xt.expression,$t,Ct);default:this.raise(xt.start,(kt?"Binding":"Assigning to")+" rvalue")}};pp$7.checkLValPattern=function(xt,$t,Ct){switch($t===void 0&&($t=BIND_NONE),xt.type){case"ObjectPattern":for(var kt=0,Mt=xt.properties;kt<Mt.length;kt+=1){var Ft=Mt[kt];this.checkLValInnerPattern(Ft,$t,Ct)}break;case"ArrayPattern":for(var jt=0,Bt=xt.elements;jt<Bt.length;jt+=1){var Vt=Bt[jt];Vt&&this.checkLValInnerPattern(Vt,$t,Ct)}break;default:this.checkLValSimple(xt,$t,Ct)}};pp$7.checkLValInnerPattern=function(xt,$t,Ct){switch($t===void 0&&($t=BIND_NONE),xt.type){case"Property":this.checkLValInnerPattern(xt.value,$t,Ct);break;case"AssignmentPattern":this.checkLValPattern(xt.left,$t,Ct);break;case"RestElement":this.checkLValPattern(xt.argument,$t,Ct);break;default:this.checkLValPattern(xt,$t,Ct)}};var TokContext=function($t,Ct,kt,Mt,Ft){this.token=$t,this.isExpr=!!Ct,this.preserveSpace=!!kt,this.override=Mt,this.generator=!!Ft},types$3={b_stat:new TokContext("{",!1),b_expr:new TokContext("{",!0),b_tmpl:new TokContext("${",!1),p_stat:new TokContext("(",!1),p_expr:new TokContext("(",!0),q_tmpl:new TokContext("`",!0,!0,function(xt){return xt.tryReadTemplateToken()}),f_stat:new TokContext("function",!1),f_expr:new TokContext("function",!0),f_expr_gen:new TokContext("function",!0,!1,null,!0),f_gen:new TokContext("function",!1,!1,null,!0)},pp$6=Parser.prototype;pp$6.initialContext=function(){return[types$3.b_stat]};pp$6.curContext=function(){return this.context[this.context.length-1]};pp$6.braceIsBlock=function(xt){var $t=this.curContext();return $t===types$3.f_expr||$t===types$3.f_stat?!0:xt===types$1$1.colon&&($t===types$3.b_stat||$t===types$3.b_expr)?!$t.isExpr:xt===types$1$1._return||xt===types$1$1.name&&this.exprAllowed?lineBreak.test(this.input.slice(this.lastTokEnd,this.start)):xt===types$1$1._else||xt===types$1$1.semi||xt===types$1$1.eof||xt===types$1$1.parenR||xt===types$1$1.arrow?!0:xt===types$1$1.braceL?$t===types$3.b_stat:xt===types$1$1._var||xt===types$1$1._const||xt===types$1$1.name?!1:!this.exprAllowed};pp$6.inGeneratorContext=function(){for(var xt=this.context.length-1;xt>=1;xt--){var $t=this.context[xt];if($t.token==="function")return $t.generator}return!1};pp$6.updateContext=function(xt){var $t,Ct=this.type;Ct.keyword&&xt===types$1$1.dot?this.exprAllowed=!1:($t=Ct.updateContext)?$t.call(this,xt):this.exprAllowed=Ct.beforeExpr};pp$6.overrideContext=function(xt){this.curContext()!==xt&&(this.context[this.context.length-1]=xt)};types$1$1.parenR.updateContext=types$1$1.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var xt=this.context.pop();xt===types$3.b_stat&&this.curContext().token==="function"&&(xt=this.context.pop()),this.exprAllowed=!xt.isExpr};types$1$1.braceL.updateContext=function(xt){this.context.push(this.braceIsBlock(xt)?types$3.b_stat:types$3.b_expr),this.exprAllowed=!0};types$1$1.dollarBraceL.updateContext=function(){this.context.push(types$3.b_tmpl),this.exprAllowed=!0};types$1$1.parenL.updateContext=function(xt){var $t=xt===types$1$1._if||xt===types$1$1._for||xt===types$1$1._with||xt===types$1$1._while;this.context.push($t?types$3.p_stat:types$3.p_expr),this.exprAllowed=!0};types$1$1.incDec.updateContext=function(){};types$1$1._function.updateContext=types$1$1._class.updateContext=function(xt){xt.beforeExpr&&xt!==types$1$1._else&&!(xt===types$1$1.semi&&this.curContext()!==types$3.p_stat)&&!(xt===types$1$1._return&&lineBreak.test(this.input.slice(this.lastTokEnd,this.start)))&&!((xt===types$1$1.colon||xt===types$1$1.braceL)&&this.curContext()===types$3.b_stat)?this.context.push(types$3.f_expr):this.context.push(types$3.f_stat),this.exprAllowed=!1};types$1$1.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};types$1$1.backQuote.updateContext=function(){this.curContext()===types$3.q_tmpl?this.context.pop():this.context.push(types$3.q_tmpl),this.exprAllowed=!1};types$1$1.star.updateContext=function(xt){if(xt===types$1$1._function){var $t=this.context.length-1;this.context[$t]===types$3.f_expr?this.context[$t]=types$3.f_expr_gen:this.context[$t]=types$3.f_gen}this.exprAllowed=!0};types$1$1.name.updateContext=function(xt){var $t=!1;this.options.ecmaVersion>=6&&xt!==types$1$1.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&($t=!0),this.exprAllowed=$t};var pp$5=Parser.prototype;pp$5.checkPropClash=function(xt,$t,Ct){if(!(this.options.ecmaVersion>=9&&xt.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(xt.computed||xt.method||xt.shorthand))){var kt=xt.key,Mt;switch(kt.type){case"Identifier":Mt=kt.name;break;case"Literal":Mt=String(kt.value);break;default:return}var Ft=xt.kind;if(this.options.ecmaVersion>=6){Mt==="__proto__"&&Ft==="init"&&($t.proto&&(Ct?Ct.doubleProto<0&&(Ct.doubleProto=kt.start):this.raiseRecoverable(kt.start,"Redefinition of __proto__ property")),$t.proto=!0);return}Mt="$"+Mt;var jt=$t[Mt];if(jt){var Bt;Ft==="init"?Bt=this.strict&&jt.init||jt.get||jt.set:Bt=jt.init||jt[Ft],Bt&&this.raiseRecoverable(kt.start,"Redefinition of property")}else jt=$t[Mt]={init:!1,get:!1,set:!1};jt[Ft]=!0}};pp$5.parseExpression=function(xt,$t){var Ct=this.start,kt=this.startLoc,Mt=this.parseMaybeAssign(xt,$t);if(this.type===types$1$1.comma){var Ft=this.startNodeAt(Ct,kt);for(Ft.expressions=[Mt];this.eat(types$1$1.comma);)Ft.expressions.push(this.parseMaybeAssign(xt,$t));return this.finishNode(Ft,"SequenceExpression")}return Mt};pp$5.parseMaybeAssign=function(xt,$t,Ct){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(xt);this.exprAllowed=!1}var kt=!1,Mt=-1,Ft=-1,jt=-1;$t?(Mt=$t.parenthesizedAssign,Ft=$t.trailingComma,jt=$t.doubleProto,$t.parenthesizedAssign=$t.trailingComma=-1):($t=new DestructuringErrors,kt=!0);var Bt=this.start,Vt=this.startLoc;(this.type===types$1$1.parenL||this.type===types$1$1.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=xt==="await");var zt=this.parseMaybeConditional(xt,$t);if(Ct&&(zt=Ct.call(this,zt,Bt,Vt)),this.type.isAssign){var Ht=this.startNodeAt(Bt,Vt);return Ht.operator=this.value,this.type===types$1$1.eq&&(zt=this.toAssignable(zt,!1,$t)),kt||($t.parenthesizedAssign=$t.trailingComma=$t.doubleProto=-1),$t.shorthandAssign>=zt.start&&($t.shorthandAssign=-1),this.type===types$1$1.eq?this.checkLValPattern(zt):this.checkLValSimple(zt),Ht.left=zt,this.next(),Ht.right=this.parseMaybeAssign(xt),jt>-1&&($t.doubleProto=jt),this.finishNode(Ht,"AssignmentExpression")}else kt&&this.checkExpressionErrors($t,!0);return Mt>-1&&($t.parenthesizedAssign=Mt),Ft>-1&&($t.trailingComma=Ft),zt};pp$5.parseMaybeConditional=function(xt,$t){var Ct=this.start,kt=this.startLoc,Mt=this.parseExprOps(xt,$t);if(this.checkExpressionErrors($t))return Mt;if(this.eat(types$1$1.question)){var Ft=this.startNodeAt(Ct,kt);return Ft.test=Mt,Ft.consequent=this.parseMaybeAssign(),this.expect(types$1$1.colon),Ft.alternate=this.parseMaybeAssign(xt),this.finishNode(Ft,"ConditionalExpression")}return Mt};pp$5.parseExprOps=function(xt,$t){var Ct=this.start,kt=this.startLoc,Mt=this.parseMaybeUnary($t,!1,!1,xt);return this.checkExpressionErrors($t)||Mt.start===Ct&&Mt.type==="ArrowFunctionExpression"?Mt:this.parseExprOp(Mt,Ct,kt,-1,xt)};pp$5.parseExprOp=function(xt,$t,Ct,kt,Mt){var Ft=this.type.binop;if(Ft!=null&&(!Mt||this.type!==types$1$1._in)&&Ft>kt){var jt=this.type===types$1$1.logicalOR||this.type===types$1$1.logicalAND,Bt=this.type===types$1$1.coalesce;Bt&&(Ft=types$1$1.logicalAND.binop);var Vt=this.value;this.next();var zt=this.start,Ht=this.startLoc,Gt=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,Mt),zt,Ht,Ft,Mt),qt=this.buildBinary($t,Ct,xt,Gt,Vt,jt||Bt);return(jt&&this.type===types$1$1.coalesce||Bt&&(this.type===types$1$1.logicalOR||this.type===types$1$1.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(qt,$t,Ct,kt,Mt)}return xt};pp$5.buildBinary=function(xt,$t,Ct,kt,Mt,Ft){kt.type==="PrivateIdentifier"&&this.raise(kt.start,"Private identifier can only be left side of binary expression");var jt=this.startNodeAt(xt,$t);return jt.left=Ct,jt.operator=Mt,jt.right=kt,this.finishNode(jt,Ft?"LogicalExpression":"BinaryExpression")};pp$5.parseMaybeUnary=function(xt,$t,Ct,kt){var Mt=this.start,Ft=this.startLoc,jt;if(this.isContextual("await")&&this.canAwait)jt=this.parseAwait(kt),$t=!0;else if(this.type.prefix){var Bt=this.startNode(),Vt=this.type===types$1$1.incDec;Bt.operator=this.value,Bt.prefix=!0,this.next(),Bt.argument=this.parseMaybeUnary(null,!0,Vt,kt),this.checkExpressionErrors(xt,!0),Vt?this.checkLValSimple(Bt.argument):this.strict&&Bt.operator==="delete"&&Bt.argument.type==="Identifier"?this.raiseRecoverable(Bt.start,"Deleting local variable in strict mode"):Bt.operator==="delete"&&isPrivateFieldAccess(Bt.argument)?this.raiseRecoverable(Bt.start,"Private fields can not be deleted"):$t=!0,jt=this.finishNode(Bt,Vt?"UpdateExpression":"UnaryExpression")}else if(!$t&&this.type===types$1$1.privateId)(kt||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),jt=this.parsePrivateIdent(),this.type!==types$1$1._in&&this.unexpected();else{if(jt=this.parseExprSubscripts(xt,kt),this.checkExpressionErrors(xt))return jt;for(;this.type.postfix&&!this.canInsertSemicolon();){var zt=this.startNodeAt(Mt,Ft);zt.operator=this.value,zt.prefix=!1,zt.argument=jt,this.checkLValSimple(jt),this.next(),jt=this.finishNode(zt,"UpdateExpression")}}if(!Ct&&this.eat(types$1$1.starstar))if($t)this.unexpected(this.lastTokStart);else return this.buildBinary(Mt,Ft,jt,this.parseMaybeUnary(null,!1,!1,kt),"**",!1);else return jt};function isPrivateFieldAccess(xt){return xt.type==="MemberExpression"&&xt.property.type==="PrivateIdentifier"||xt.type==="ChainExpression"&&isPrivateFieldAccess(xt.expression)}pp$5.parseExprSubscripts=function(xt,$t){var Ct=this.start,kt=this.startLoc,Mt=this.parseExprAtom(xt,$t);if(Mt.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return Mt;var Ft=this.parseSubscripts(Mt,Ct,kt,!1,$t);return xt&&Ft.type==="MemberExpression"&&(xt.parenthesizedAssign>=Ft.start&&(xt.parenthesizedAssign=-1),xt.parenthesizedBind>=Ft.start&&(xt.parenthesizedBind=-1),xt.trailingComma>=Ft.start&&(xt.trailingComma=-1)),Ft};pp$5.parseSubscripts=function(xt,$t,Ct,kt,Mt){for(var Ft=this.options.ecmaVersion>=8&&xt.type==="Identifier"&&xt.name==="async"&&this.lastTokEnd===xt.end&&!this.canInsertSemicolon()&&xt.end-xt.start===5&&this.potentialArrowAt===xt.start,jt=!1;;){var Bt=this.parseSubscript(xt,$t,Ct,kt,Ft,jt,Mt);if(Bt.optional&&(jt=!0),Bt===xt||Bt.type==="ArrowFunctionExpression"){if(jt){var Vt=this.startNodeAt($t,Ct);Vt.expression=Bt,Bt=this.finishNode(Vt,"ChainExpression")}return Bt}xt=Bt}};pp$5.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(types$1$1.arrow)};pp$5.parseSubscriptAsyncArrow=function(xt,$t,Ct,kt){return this.parseArrowExpression(this.startNodeAt(xt,$t),Ct,!0,kt)};pp$5.parseSubscript=function(xt,$t,Ct,kt,Mt,Ft,jt){var Bt=this.options.ecmaVersion>=11,Vt=Bt&&this.eat(types$1$1.questionDot);kt&&Vt&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var zt=this.eat(types$1$1.bracketL);if(zt||Vt&&this.type!==types$1$1.parenL&&this.type!==types$1$1.backQuote||this.eat(types$1$1.dot)){var Ht=this.startNodeAt($t,Ct);Ht.object=xt,zt?(Ht.property=this.parseExpression(),this.expect(types$1$1.bracketR)):this.type===types$1$1.privateId&&xt.type!=="Super"?Ht.property=this.parsePrivateIdent():Ht.property=this.parseIdent(this.options.allowReserved!=="never"),Ht.computed=!!zt,Bt&&(Ht.optional=Vt),xt=this.finishNode(Ht,"MemberExpression")}else if(!kt&&this.eat(types$1$1.parenL)){var Gt=new DestructuringErrors,qt=this.yieldPos,Wt=this.awaitPos,Yt=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var Kt=this.parseExprList(types$1$1.parenR,this.options.ecmaVersion>=8,!1,Gt);if(Mt&&!Vt&&this.shouldParseAsyncArrow())return this.checkPatternErrors(Gt,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=qt,this.awaitPos=Wt,this.awaitIdentPos=Yt,this.parseSubscriptAsyncArrow($t,Ct,Kt,jt);this.checkExpressionErrors(Gt,!0),this.yieldPos=qt||this.yieldPos,this.awaitPos=Wt||this.awaitPos,this.awaitIdentPos=Yt||this.awaitIdentPos;var Xt=this.startNodeAt($t,Ct);Xt.callee=xt,Xt.arguments=Kt,Bt&&(Xt.optional=Vt),xt=this.finishNode(Xt,"CallExpression")}else if(this.type===types$1$1.backQuote){(Vt||Ft)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var Qt=this.startNodeAt($t,Ct);Qt.tag=xt,Qt.quasi=this.parseTemplate({isTagged:!0}),xt=this.finishNode(Qt,"TaggedTemplateExpression")}return xt};pp$5.parseExprAtom=function(xt,$t,Ct){this.type===types$1$1.slash&&this.readRegexp();var kt,Mt=this.potentialArrowAt===this.start;switch(this.type){case types$1$1._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),kt=this.startNode(),this.next(),this.type===types$1$1.parenL&&!this.allowDirectSuper&&this.raise(kt.start,"super() call outside constructor of a subclass"),this.type!==types$1$1.dot&&this.type!==types$1$1.bracketL&&this.type!==types$1$1.parenL&&this.unexpected(),this.finishNode(kt,"Super");case types$1$1._this:return kt=this.startNode(),this.next(),this.finishNode(kt,"ThisExpression");case types$1$1.name:var Ft=this.start,jt=this.startLoc,Bt=this.containsEsc,Vt=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!Bt&&Vt.name==="async"&&!this.canInsertSemicolon()&&this.eat(types$1$1._function))return this.overrideContext(types$3.f_expr),this.parseFunction(this.startNodeAt(Ft,jt),0,!1,!0,$t);if(Mt&&!this.canInsertSemicolon()){if(this.eat(types$1$1.arrow))return this.parseArrowExpression(this.startNodeAt(Ft,jt),[Vt],!1,$t);if(this.options.ecmaVersion>=8&&Vt.name==="async"&&this.type===types$1$1.name&&!Bt&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return Vt=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(types$1$1.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(Ft,jt),[Vt],!0,$t)}return Vt;case types$1$1.regexp:var zt=this.value;return kt=this.parseLiteral(zt.value),kt.regex={pattern:zt.pattern,flags:zt.flags},kt;case types$1$1.num:case types$1$1.string:return this.parseLiteral(this.value);case types$1$1._null:case types$1$1._true:case types$1$1._false:return kt=this.startNode(),kt.value=this.type===types$1$1._null?null:this.type===types$1$1._true,kt.raw=this.type.keyword,this.next(),this.finishNode(kt,"Literal");case types$1$1.parenL:var Ht=this.start,Gt=this.parseParenAndDistinguishExpression(Mt,$t);return xt&&(xt.parenthesizedAssign<0&&!this.isSimpleAssignTarget(Gt)&&(xt.parenthesizedAssign=Ht),xt.parenthesizedBind<0&&(xt.parenthesizedBind=Ht)),Gt;case types$1$1.bracketL:return kt=this.startNode(),this.next(),kt.elements=this.parseExprList(types$1$1.bracketR,!0,!0,xt),this.finishNode(kt,"ArrayExpression");case types$1$1.braceL:return this.overrideContext(types$3.b_expr),this.parseObj(!1,xt);case types$1$1._function:return kt=this.startNode(),this.next(),this.parseFunction(kt,0);case types$1$1._class:return this.parseClass(this.startNode(),!1);case types$1$1._new:return this.parseNew();case types$1$1.backQuote:return this.parseTemplate();case types$1$1._import:return this.options.ecmaVersion>=11?this.parseExprImport(Ct):this.unexpected();default:return this.parseExprAtomDefault()}};pp$5.parseExprAtomDefault=function(){this.unexpected()};pp$5.parseExprImport=function(xt){var $t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===types$1$1.parenL&&!xt)return this.parseDynamicImport($t);if(this.type===types$1$1.dot){var Ct=this.startNodeAt($t.start,$t.loc&&$t.loc.start);return Ct.name="import",$t.meta=this.finishNode(Ct,"Identifier"),this.parseImportMeta($t)}else this.unexpected()};pp$5.parseDynamicImport=function(xt){if(this.next(),xt.source=this.parseMaybeAssign(),!this.eat(types$1$1.parenR)){var $t=this.start;this.eat(types$1$1.comma)&&this.eat(types$1$1.parenR)?this.raiseRecoverable($t,"Trailing comma is not allowed in import()"):this.unexpected($t)}return this.finishNode(xt,"ImportExpression")};pp$5.parseImportMeta=function(xt){this.next();var $t=this.containsEsc;return xt.property=this.parseIdent(!0),xt.property.name!=="meta"&&this.raiseRecoverable(xt.property.start,"The only valid meta property for import is 'import.meta'"),$t&&this.raiseRecoverable(xt.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(xt.start,"Cannot use 'import.meta' outside a module"),this.finishNode(xt,"MetaProperty")};pp$5.parseLiteral=function(xt){var $t=this.startNode();return $t.value=xt,$t.raw=this.input.slice(this.start,this.end),$t.raw.charCodeAt($t.raw.length-1)===110&&($t.bigint=$t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode($t,"Literal")};pp$5.parseParenExpression=function(){this.expect(types$1$1.parenL);var xt=this.parseExpression();return this.expect(types$1$1.parenR),xt};pp$5.shouldParseArrow=function(xt){return!this.canInsertSemicolon()};pp$5.parseParenAndDistinguishExpression=function(xt,$t){var Ct=this.start,kt=this.startLoc,Mt,Ft=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var jt=this.start,Bt=this.startLoc,Vt=[],zt=!0,Ht=!1,Gt=new DestructuringErrors,qt=this.yieldPos,Wt=this.awaitPos,Yt;for(this.yieldPos=0,this.awaitPos=0;this.type!==types$1$1.parenR;)if(zt?zt=!1:this.expect(types$1$1.comma),Ft&&this.afterTrailingComma(types$1$1.parenR,!0)){Ht=!0;break}else if(this.type===types$1$1.ellipsis){Yt=this.start,Vt.push(this.parseParenItem(this.parseRestBinding())),this.type===types$1$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else Vt.push(this.parseMaybeAssign(!1,Gt,this.parseParenItem));var Kt=this.lastTokEnd,Xt=this.lastTokEndLoc;if(this.expect(types$1$1.parenR),xt&&this.shouldParseArrow(Vt)&&this.eat(types$1$1.arrow))return this.checkPatternErrors(Gt,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=qt,this.awaitPos=Wt,this.parseParenArrowList(Ct,kt,Vt,$t);(!Vt.length||Ht)&&this.unexpected(this.lastTokStart),Yt&&this.unexpected(Yt),this.checkExpressionErrors(Gt,!0),this.yieldPos=qt||this.yieldPos,this.awaitPos=Wt||this.awaitPos,Vt.length>1?(Mt=this.startNodeAt(jt,Bt),Mt.expressions=Vt,this.finishNodeAt(Mt,"SequenceExpression",Kt,Xt)):Mt=Vt[0]}else Mt=this.parseParenExpression();if(this.options.preserveParens){var Qt=this.startNodeAt(Ct,kt);return Qt.expression=Mt,this.finishNode(Qt,"ParenthesizedExpression")}else return Mt};pp$5.parseParenItem=function(xt){return xt};pp$5.parseParenArrowList=function(xt,$t,Ct,kt){return this.parseArrowExpression(this.startNodeAt(xt,$t),Ct,!1,kt)};var empty=[];pp$5.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var xt=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===types$1$1.dot){var $t=this.startNodeAt(xt.start,xt.loc&&xt.loc.start);$t.name="new",xt.meta=this.finishNode($t,"Identifier"),this.next();var Ct=this.containsEsc;return xt.property=this.parseIdent(!0),xt.property.name!=="target"&&this.raiseRecoverable(xt.property.start,"The only valid meta property for new is 'new.target'"),Ct&&this.raiseRecoverable(xt.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(xt.start,"'new.target' can only be used in functions and class static block"),this.finishNode(xt,"MetaProperty")}var kt=this.start,Mt=this.startLoc;return xt.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),kt,Mt,!0,!1),this.eat(types$1$1.parenL)?xt.arguments=this.parseExprList(types$1$1.parenR,this.options.ecmaVersion>=8,!1):xt.arguments=empty,this.finishNode(xt,"NewExpression")};pp$5.parseTemplateElement=function(xt){var $t=xt.isTagged,Ct=this.startNode();return this.type===types$1$1.invalidTemplate?($t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),Ct.value={raw:this.value,cooked:null}):Ct.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),Ct.tail=this.type===types$1$1.backQuote,this.finishNode(Ct,"TemplateElement")};pp$5.parseTemplate=function(xt){xt===void 0&&(xt={});var $t=xt.isTagged;$t===void 0&&($t=!1);var Ct=this.startNode();this.next(),Ct.expressions=[];var kt=this.parseTemplateElement({isTagged:$t});for(Ct.quasis=[kt];!kt.tail;)this.type===types$1$1.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(types$1$1.dollarBraceL),Ct.expressions.push(this.parseExpression()),this.expect(types$1$1.braceR),Ct.quasis.push(kt=this.parseTemplateElement({isTagged:$t}));return this.next(),this.finishNode(Ct,"TemplateLiteral")};pp$5.isAsyncProp=function(xt){return!xt.computed&&xt.key.type==="Identifier"&&xt.key.name==="async"&&(this.type===types$1$1.name||this.type===types$1$1.num||this.type===types$1$1.string||this.type===types$1$1.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===types$1$1.star)&&!lineBreak.test(this.input.slice(this.lastTokEnd,this.start))};pp$5.parseObj=function(xt,$t){var Ct=this.startNode(),kt=!0,Mt={};for(Ct.properties=[],this.next();!this.eat(types$1$1.braceR);){if(kt)kt=!1;else if(this.expect(types$1$1.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(types$1$1.braceR))break;var Ft=this.parseProperty(xt,$t);xt||this.checkPropClash(Ft,Mt,$t),Ct.properties.push(Ft)}return this.finishNode(Ct,xt?"ObjectPattern":"ObjectExpression")};pp$5.parseProperty=function(xt,$t){var Ct=this.startNode(),kt,Mt,Ft,jt;if(this.options.ecmaVersion>=9&&this.eat(types$1$1.ellipsis))return xt?(Ct.argument=this.parseIdent(!1),this.type===types$1$1.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(Ct,"RestElement")):(Ct.argument=this.parseMaybeAssign(!1,$t),this.type===types$1$1.comma&&$t&&$t.trailingComma<0&&($t.trailingComma=this.start),this.finishNode(Ct,"SpreadElement"));this.options.ecmaVersion>=6&&(Ct.method=!1,Ct.shorthand=!1,(xt||$t)&&(Ft=this.start,jt=this.startLoc),xt||(kt=this.eat(types$1$1.star)));var Bt=this.containsEsc;return this.parsePropertyName(Ct),!xt&&!Bt&&this.options.ecmaVersion>=8&&!kt&&this.isAsyncProp(Ct)?(Mt=!0,kt=this.options.ecmaVersion>=9&&this.eat(types$1$1.star),this.parsePropertyName(Ct)):Mt=!1,this.parsePropertyValue(Ct,xt,kt,Mt,Ft,jt,$t,Bt),this.finishNode(Ct,"Property")};pp$5.parseGetterSetter=function(xt){xt.kind=xt.key.name,this.parsePropertyName(xt),xt.value=this.parseMethod(!1);var $t=xt.kind==="get"?0:1;if(xt.value.params.length!==$t){var Ct=xt.value.start;xt.kind==="get"?this.raiseRecoverable(Ct,"getter should have no params"):this.raiseRecoverable(Ct,"setter should have exactly one param")}else xt.kind==="set"&&xt.value.params[0].type==="RestElement"&&this.raiseRecoverable(xt.value.params[0].start,"Setter cannot use rest params")};pp$5.parsePropertyValue=function(xt,$t,Ct,kt,Mt,Ft,jt,Bt){(Ct||kt)&&this.type===types$1$1.colon&&this.unexpected(),this.eat(types$1$1.colon)?(xt.value=$t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,jt),xt.kind="init"):this.options.ecmaVersion>=6&&this.type===types$1$1.parenL?($t&&this.unexpected(),xt.kind="init",xt.method=!0,xt.value=this.parseMethod(Ct,kt)):!$t&&!Bt&&this.options.ecmaVersion>=5&&!xt.computed&&xt.key.type==="Identifier"&&(xt.key.name==="get"||xt.key.name==="set")&&this.type!==types$1$1.comma&&this.type!==types$1$1.braceR&&this.type!==types$1$1.eq?((Ct||kt)&&this.unexpected(),this.parseGetterSetter(xt)):this.options.ecmaVersion>=6&&!xt.computed&&xt.key.type==="Identifier"?((Ct||kt)&&this.unexpected(),this.checkUnreserved(xt.key),xt.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=Mt),xt.kind="init",$t?xt.value=this.parseMaybeDefault(Mt,Ft,this.copyNode(xt.key)):this.type===types$1$1.eq&&jt?(jt.shorthandAssign<0&&(jt.shorthandAssign=this.start),xt.value=this.parseMaybeDefault(Mt,Ft,this.copyNode(xt.key))):xt.value=this.copyNode(xt.key),xt.shorthand=!0):this.unexpected()};pp$5.parsePropertyName=function(xt){if(this.options.ecmaVersion>=6){if(this.eat(types$1$1.bracketL))return xt.computed=!0,xt.key=this.parseMaybeAssign(),this.expect(types$1$1.bracketR),xt.key;xt.computed=!1}return xt.key=this.type===types$1$1.num||this.type===types$1$1.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};pp$5.initFunction=function(xt){xt.id=null,this.options.ecmaVersion>=6&&(xt.generator=xt.expression=!1),this.options.ecmaVersion>=8&&(xt.async=!1)};pp$5.parseMethod=function(xt,$t,Ct){var kt=this.startNode(),Mt=this.yieldPos,Ft=this.awaitPos,jt=this.awaitIdentPos;return this.initFunction(kt),this.options.ecmaVersion>=6&&(kt.generator=xt),this.options.ecmaVersion>=8&&(kt.async=!!$t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(functionFlags($t,kt.generator)|SCOPE_SUPER|(Ct?SCOPE_DIRECT_SUPER:0)),this.expect(types$1$1.parenL),kt.params=this.parseBindingList(types$1$1.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(kt,!1,!0,!1),this.yieldPos=Mt,this.awaitPos=Ft,this.awaitIdentPos=jt,this.finishNode(kt,"FunctionExpression")};pp$5.parseArrowExpression=function(xt,$t,Ct,kt){var Mt=this.yieldPos,Ft=this.awaitPos,jt=this.awaitIdentPos;return this.enterScope(functionFlags(Ct,!1)|SCOPE_ARROW),this.initFunction(xt),this.options.ecmaVersion>=8&&(xt.async=!!Ct),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,xt.params=this.toAssignableList($t,!0),this.parseFunctionBody(xt,!0,!1,kt),this.yieldPos=Mt,this.awaitPos=Ft,this.awaitIdentPos=jt,this.finishNode(xt,"ArrowFunctionExpression")};pp$5.parseFunctionBody=function(xt,$t,Ct,kt){var Mt=$t&&this.type!==types$1$1.braceL,Ft=this.strict,jt=!1;if(Mt)xt.body=this.parseMaybeAssign(kt),xt.expression=!0,this.checkParams(xt,!1);else{var Bt=this.options.ecmaVersion>=7&&!this.isSimpleParamList(xt.params);(!Ft||Bt)&&(jt=this.strictDirective(this.end),jt&&Bt&&this.raiseRecoverable(xt.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var Vt=this.labels;this.labels=[],jt&&(this.strict=!0),this.checkParams(xt,!Ft&&!jt&&!$t&&!Ct&&this.isSimpleParamList(xt.params)),this.strict&&xt.id&&this.checkLValSimple(xt.id,BIND_OUTSIDE),xt.body=this.parseBlock(!1,void 0,jt&&!Ft),xt.expression=!1,this.adaptDirectivePrologue(xt.body.body),this.labels=Vt}this.exitScope()};pp$5.isSimpleParamList=function(xt){for(var $t=0,Ct=xt;$t<Ct.length;$t+=1){var kt=Ct[$t];if(kt.type!=="Identifier")return!1}return!0};pp$5.checkParams=function(xt,$t){for(var Ct=Object.create(null),kt=0,Mt=xt.params;kt<Mt.length;kt+=1){var Ft=Mt[kt];this.checkLValInnerPattern(Ft,BIND_VAR,$t?null:Ct)}};pp$5.parseExprList=function(xt,$t,Ct,kt){for(var Mt=[],Ft=!0;!this.eat(xt);){if(Ft)Ft=!1;else if(this.expect(types$1$1.comma),$t&&this.afterTrailingComma(xt))break;var jt=void 0;Ct&&this.type===types$1$1.comma?jt=null:this.type===types$1$1.ellipsis?(jt=this.parseSpread(kt),kt&&this.type===types$1$1.comma&&kt.trailingComma<0&&(kt.trailingComma=this.start)):jt=this.parseMaybeAssign(!1,kt),Mt.push(jt)}return Mt};pp$5.checkUnreserved=function(xt){var $t=xt.start,Ct=xt.end,kt=xt.name;if(this.inGenerator&&kt==="yield"&&this.raiseRecoverable($t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&kt==="await"&&this.raiseRecoverable($t,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&kt==="arguments"&&this.raiseRecoverable($t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(kt==="arguments"||kt==="await")&&this.raise($t,"Cannot use "+kt+" in class static initialization block"),this.keywords.test(kt)&&this.raise($t,"Unexpected keyword '"+kt+"'"),!(this.options.ecmaVersion<6&&this.input.slice($t,Ct).indexOf("\\")!==-1)){var Mt=this.strict?this.reservedWordsStrict:this.reservedWords;Mt.test(kt)&&(!this.inAsync&&kt==="await"&&this.raiseRecoverable($t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable($t,"The keyword '"+kt+"' is reserved"))}};pp$5.parseIdent=function(xt){var $t=this.parseIdentNode();return this.next(!!xt),this.finishNode($t,"Identifier"),xt||(this.checkUnreserved($t),$t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=$t.start)),$t};pp$5.parseIdentNode=function(){var xt=this.startNode();return this.type===types$1$1.name?xt.name=this.value:this.type.keyword?(xt.name=this.type.keyword,(xt.name==="class"||xt.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=types$1$1.name):this.unexpected(),xt};pp$5.parsePrivateIdent=function(){var xt=this.startNode();return this.type===types$1$1.privateId?xt.name=this.value:this.unexpected(),this.next(),this.finishNode(xt,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(xt.start,"Private field '#"+xt.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(xt)),xt};pp$5.parseYield=function(xt){this.yieldPos||(this.yieldPos=this.start);var $t=this.startNode();return this.next(),this.type===types$1$1.semi||this.canInsertSemicolon()||this.type!==types$1$1.star&&!this.type.startsExpr?($t.delegate=!1,$t.argument=null):($t.delegate=this.eat(types$1$1.star),$t.argument=this.parseMaybeAssign(xt)),this.finishNode($t,"YieldExpression")};pp$5.parseAwait=function(xt){this.awaitPos||(this.awaitPos=this.start);var $t=this.startNode();return this.next(),$t.argument=this.parseMaybeUnary(null,!0,!1,xt),this.finishNode($t,"AwaitExpression")};var pp$4=Parser.prototype;pp$4.raise=function(xt,$t){var Ct=getLineInfo(this.input,xt);$t+=" ("+Ct.line+":"+Ct.column+")";var kt=new SyntaxError($t);throw kt.pos=xt,kt.loc=Ct,kt.raisedAt=this.pos,kt};pp$4.raiseRecoverable=pp$4.raise;pp$4.curPosition=function(){if(this.options.locations)return new Position(this.curLine,this.pos-this.lineStart)};var pp$3=Parser.prototype,Scope$2=function($t){this.flags=$t,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};pp$3.enterScope=function(xt){this.scopeStack.push(new Scope$2(xt))};pp$3.exitScope=function(){this.scopeStack.pop()};pp$3.treatFunctionsAsVarInScope=function(xt){return xt.flags&SCOPE_FUNCTION||!this.inModule&&xt.flags&SCOPE_TOP};pp$3.declareName=function(xt,$t,Ct){var kt=!1;if($t===BIND_LEXICAL){var Mt=this.currentScope();kt=Mt.lexical.indexOf(xt)>-1||Mt.functions.indexOf(xt)>-1||Mt.var.indexOf(xt)>-1,Mt.lexical.push(xt),this.inModule&&Mt.flags&SCOPE_TOP&&delete this.undefinedExports[xt]}else if($t===BIND_SIMPLE_CATCH){var Ft=this.currentScope();Ft.lexical.push(xt)}else if($t===BIND_FUNCTION){var jt=this.currentScope();this.treatFunctionsAsVar?kt=jt.lexical.indexOf(xt)>-1:kt=jt.lexical.indexOf(xt)>-1||jt.var.indexOf(xt)>-1,jt.functions.push(xt)}else for(var Bt=this.scopeStack.length-1;Bt>=0;--Bt){var Vt=this.scopeStack[Bt];if(Vt.lexical.indexOf(xt)>-1&&!(Vt.flags&SCOPE_SIMPLE_CATCH&&Vt.lexical[0]===xt)||!this.treatFunctionsAsVarInScope(Vt)&&Vt.functions.indexOf(xt)>-1){kt=!0;break}if(Vt.var.push(xt),this.inModule&&Vt.flags&SCOPE_TOP&&delete this.undefinedExports[xt],Vt.flags&SCOPE_VAR)break}kt&&this.raiseRecoverable(Ct,"Identifier '"+xt+"' has already been declared")};pp$3.checkLocalExport=function(xt){this.scopeStack[0].lexical.indexOf(xt.name)===-1&&this.scopeStack[0].var.indexOf(xt.name)===-1&&(this.undefinedExports[xt.name]=xt)};pp$3.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};pp$3.currentVarScope=function(){for(var xt=this.scopeStack.length-1;;xt--){var $t=this.scopeStack[xt];if($t.flags&SCOPE_VAR)return $t}};pp$3.currentThisScope=function(){for(var xt=this.scopeStack.length-1;;xt--){var $t=this.scopeStack[xt];if($t.flags&SCOPE_VAR&&!($t.flags&SCOPE_ARROW))return $t}};var Node$2=function($t,Ct,kt){this.type="",this.start=Ct,this.end=0,$t.options.locations&&(this.loc=new SourceLocation($t,kt)),$t.options.directSourceFile&&(this.sourceFile=$t.options.directSourceFile),$t.options.ranges&&(this.range=[Ct,0])},pp$2=Parser.prototype;pp$2.startNode=function(){return new Node$2(this,this.start,this.startLoc)};pp$2.startNodeAt=function(xt,$t){return new Node$2(this,xt,$t)};function finishNodeAt(xt,$t,Ct,kt){return xt.type=$t,xt.end=Ct,this.options.locations&&(xt.loc.end=kt),this.options.ranges&&(xt.range[1]=Ct),xt}pp$2.finishNode=function(xt,$t){return finishNodeAt.call(this,xt,$t,this.lastTokEnd,this.lastTokEndLoc)};pp$2.finishNodeAt=function(xt,$t,Ct,kt){return finishNodeAt.call(this,xt,$t,Ct,kt)};pp$2.copyNode=function(xt){var $t=new Node$2(this,xt.start,this.startLoc);for(var Ct in xt)$t[Ct]=xt[Ct];return $t};var ecma9BinaryProperties="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",ecma10BinaryProperties=ecma9BinaryProperties+" Extended_Pictographic",ecma11BinaryProperties=ecma10BinaryProperties,ecma12BinaryProperties=ecma11BinaryProperties+" EBase EComp EMod EPres ExtPict",ecma13BinaryProperties=ecma12BinaryProperties,ecma14BinaryProperties=ecma13BinaryProperties,unicodeBinaryProperties={9:ecma9BinaryProperties,10:ecma10BinaryProperties,11:ecma11BinaryProperties,12:ecma12BinaryProperties,13:ecma13BinaryProperties,14:ecma14BinaryProperties},ecma14BinaryPropertiesOfStrings="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",unicodeBinaryPropertiesOfStrings={9:"",10:"",11:"",12:"",13:"",14:ecma14BinaryPropertiesOfStrings},unicodeGeneralCategoryValues="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",ecma9ScriptValues="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",ecma10ScriptValues=ecma9ScriptValues+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",ecma11ScriptValues=ecma10ScriptValues+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",ecma12ScriptValues=ecma11ScriptValues+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",ecma13ScriptValues=ecma12ScriptValues+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",ecma14ScriptValues=ecma13ScriptValues+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz",unicodeScriptValues={9:ecma9ScriptValues,10:ecma10ScriptValues,11:ecma11ScriptValues,12:ecma12ScriptValues,13:ecma13ScriptValues,14:ecma14ScriptValues},data$2={};function buildUnicodeData(xt){var $t=data$2[xt]={binary:wordsRegexp(unicodeBinaryProperties[xt]+" "+unicodeGeneralCategoryValues),binaryOfStrings:wordsRegexp(unicodeBinaryPropertiesOfStrings[xt]),nonBinary:{General_Category:wordsRegexp(unicodeGeneralCategoryValues),Script:wordsRegexp(unicodeScriptValues[xt])}};$t.nonBinary.Script_Extensions=$t.nonBinary.Script,$t.nonBinary.gc=$t.nonBinary.General_Category,$t.nonBinary.sc=$t.nonBinary.Script,$t.nonBinary.scx=$t.nonBinary.Script_Extensions}for(var i$2=0,list=[9,10,11,12,13,14];i$2<list.length;i$2+=1){var ecmaVersion=list[i$2];buildUnicodeData(ecmaVersion)}var pp$1=Parser.prototype,RegExpValidationState=function($t){this.parser=$t,this.validFlags="gim"+($t.options.ecmaVersion>=6?"uy":"")+($t.options.ecmaVersion>=9?"s":"")+($t.options.ecmaVersion>=13?"d":"")+($t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=data$2[$t.options.ecmaVersion>=14?14:$t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};RegExpValidationState.prototype.reset=function($t,Ct,kt){var Mt=kt.indexOf("v")!==-1,Ft=kt.indexOf("u")!==-1;this.start=$t|0,this.source=Ct+"",this.flags=kt,Mt&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=Ft&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=Ft&&this.parser.options.ecmaVersion>=9)};RegExpValidationState.prototype.raise=function($t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+$t)};RegExpValidationState.prototype.at=function($t,Ct){Ct===void 0&&(Ct=!1);var kt=this.source,Mt=kt.length;if($t>=Mt)return-1;var Ft=kt.charCodeAt($t);if(!(Ct||this.switchU)||Ft<=55295||Ft>=57344||$t+1>=Mt)return Ft;var jt=kt.charCodeAt($t+1);return jt>=56320&&jt<=57343?(Ft<<10)+jt-56613888:Ft};RegExpValidationState.prototype.nextIndex=function($t,Ct){Ct===void 0&&(Ct=!1);var kt=this.source,Mt=kt.length;if($t>=Mt)return Mt;var Ft=kt.charCodeAt($t),jt;return!(Ct||this.switchU)||Ft<=55295||Ft>=57344||$t+1>=Mt||(jt=kt.charCodeAt($t+1))<56320||jt>57343?$t+1:$t+2};RegExpValidationState.prototype.current=function($t){return $t===void 0&&($t=!1),this.at(this.pos,$t)};RegExpValidationState.prototype.lookahead=function($t){return $t===void 0&&($t=!1),this.at(this.nextIndex(this.pos,$t),$t)};RegExpValidationState.prototype.advance=function($t){$t===void 0&&($t=!1),this.pos=this.nextIndex(this.pos,$t)};RegExpValidationState.prototype.eat=function($t,Ct){return Ct===void 0&&(Ct=!1),this.current(Ct)===$t?(this.advance(Ct),!0):!1};RegExpValidationState.prototype.eatChars=function($t,Ct){Ct===void 0&&(Ct=!1);for(var kt=this.pos,Mt=0,Ft=$t;Mt<Ft.length;Mt+=1){var jt=Ft[Mt],Bt=this.at(kt,Ct);if(Bt===-1||Bt!==jt)return!1;kt=this.nextIndex(kt,Ct)}return this.pos=kt,!0};pp$1.validateRegExpFlags=function(xt){for(var $t=xt.validFlags,Ct=xt.flags,kt=!1,Mt=!1,Ft=0;Ft<Ct.length;Ft++){var jt=Ct.charAt(Ft);$t.indexOf(jt)===-1&&this.raise(xt.start,"Invalid regular expression flag"),Ct.indexOf(jt,Ft+1)>-1&&this.raise(xt.start,"Duplicate regular expression flag"),jt==="u"&&(kt=!0),jt==="v"&&(Mt=!0)}this.options.ecmaVersion>=15&&kt&&Mt&&this.raise(xt.start,"Invalid regular expression flag")};pp$1.validateRegExpPattern=function(xt){this.regexp_pattern(xt),!xt.switchN&&this.options.ecmaVersion>=9&&xt.groupNames.length>0&&(xt.switchN=!0,this.regexp_pattern(xt))};pp$1.regexp_pattern=function(xt){xt.pos=0,xt.lastIntValue=0,xt.lastStringValue="",xt.lastAssertionIsQuantifiable=!1,xt.numCapturingParens=0,xt.maxBackReference=0,xt.groupNames.length=0,xt.backReferenceNames.length=0,this.regexp_disjunction(xt),xt.pos!==xt.source.length&&(xt.eat(41)&&xt.raise("Unmatched ')'"),(xt.eat(93)||xt.eat(125))&&xt.raise("Lone quantifier brackets")),xt.maxBackReference>xt.numCapturingParens&&xt.raise("Invalid escape");for(var $t=0,Ct=xt.backReferenceNames;$t<Ct.length;$t+=1){var kt=Ct[$t];xt.groupNames.indexOf(kt)===-1&&xt.raise("Invalid named capture referenced")}};pp$1.regexp_disjunction=function(xt){for(this.regexp_alternative(xt);xt.eat(124);)this.regexp_alternative(xt);this.regexp_eatQuantifier(xt,!0)&&xt.raise("Nothing to repeat"),xt.eat(123)&&xt.raise("Lone quantifier brackets")};pp$1.regexp_alternative=function(xt){for(;xt.pos<xt.source.length&&this.regexp_eatTerm(xt););};pp$1.regexp_eatTerm=function(xt){return this.regexp_eatAssertion(xt)?(xt.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(xt)&&xt.switchU&&xt.raise("Invalid quantifier"),!0):(xt.switchU?this.regexp_eatAtom(xt):this.regexp_eatExtendedAtom(xt))?(this.regexp_eatQuantifier(xt),!0):!1};pp$1.regexp_eatAssertion=function(xt){var $t=xt.pos;if(xt.lastAssertionIsQuantifiable=!1,xt.eat(94)||xt.eat(36))return!0;if(xt.eat(92)){if(xt.eat(66)||xt.eat(98))return!0;xt.pos=$t}if(xt.eat(40)&&xt.eat(63)){var Ct=!1;if(this.options.ecmaVersion>=9&&(Ct=xt.eat(60)),xt.eat(61)||xt.eat(33))return this.regexp_disjunction(xt),xt.eat(41)||xt.raise("Unterminated group"),xt.lastAssertionIsQuantifiable=!Ct,!0}return xt.pos=$t,!1};pp$1.regexp_eatQuantifier=function(xt,$t){return $t===void 0&&($t=!1),this.regexp_eatQuantifierPrefix(xt,$t)?(xt.eat(63),!0):!1};pp$1.regexp_eatQuantifierPrefix=function(xt,$t){return xt.eat(42)||xt.eat(43)||xt.eat(63)||this.regexp_eatBracedQuantifier(xt,$t)};pp$1.regexp_eatBracedQuantifier=function(xt,$t){var Ct=xt.pos;if(xt.eat(123)){var kt=0,Mt=-1;if(this.regexp_eatDecimalDigits(xt)&&(kt=xt.lastIntValue,xt.eat(44)&&this.regexp_eatDecimalDigits(xt)&&(Mt=xt.lastIntValue),xt.eat(125)))return Mt!==-1&&Mt<kt&&!$t&&xt.raise("numbers out of order in {} quantifier"),!0;xt.switchU&&!$t&&xt.raise("Incomplete quantifier"),xt.pos=Ct}return!1};pp$1.regexp_eatAtom=function(xt){return this.regexp_eatPatternCharacters(xt)||xt.eat(46)||this.regexp_eatReverseSolidusAtomEscape(xt)||this.regexp_eatCharacterClass(xt)||this.regexp_eatUncapturingGroup(xt)||this.regexp_eatCapturingGroup(xt)};pp$1.regexp_eatReverseSolidusAtomEscape=function(xt){var $t=xt.pos;if(xt.eat(92)){if(this.regexp_eatAtomEscape(xt))return!0;xt.pos=$t}return!1};pp$1.regexp_eatUncapturingGroup=function(xt){var $t=xt.pos;if(xt.eat(40)){if(xt.eat(63)&&xt.eat(58)){if(this.regexp_disjunction(xt),xt.eat(41))return!0;xt.raise("Unterminated group")}xt.pos=$t}return!1};pp$1.regexp_eatCapturingGroup=function(xt){if(xt.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(xt):xt.current()===63&&xt.raise("Invalid group"),this.regexp_disjunction(xt),xt.eat(41))return xt.numCapturingParens+=1,!0;xt.raise("Unterminated group")}return!1};pp$1.regexp_eatExtendedAtom=function(xt){return xt.eat(46)||this.regexp_eatReverseSolidusAtomEscape(xt)||this.regexp_eatCharacterClass(xt)||this.regexp_eatUncapturingGroup(xt)||this.regexp_eatCapturingGroup(xt)||this.regexp_eatInvalidBracedQuantifier(xt)||this.regexp_eatExtendedPatternCharacter(xt)};pp$1.regexp_eatInvalidBracedQuantifier=function(xt){return this.regexp_eatBracedQuantifier(xt,!0)&&xt.raise("Nothing to repeat"),!1};pp$1.regexp_eatSyntaxCharacter=function(xt){var $t=xt.current();return isSyntaxCharacter($t)?(xt.lastIntValue=$t,xt.advance(),!0):!1};function isSyntaxCharacter(xt){return xt===36||xt>=40&&xt<=43||xt===46||xt===63||xt>=91&&xt<=94||xt>=123&&xt<=125}pp$1.regexp_eatPatternCharacters=function(xt){for(var $t=xt.pos,Ct=0;(Ct=xt.current())!==-1&&!isSyntaxCharacter(Ct);)xt.advance();return xt.pos!==$t};pp$1.regexp_eatExtendedPatternCharacter=function(xt){var $t=xt.current();return $t!==-1&&$t!==36&&!($t>=40&&$t<=43)&&$t!==46&&$t!==63&&$t!==91&&$t!==94&&$t!==124?(xt.advance(),!0):!1};pp$1.regexp_groupSpecifier=function(xt){if(xt.eat(63)){if(this.regexp_eatGroupName(xt)){xt.groupNames.indexOf(xt.lastStringValue)!==-1&&xt.raise("Duplicate capture group name"),xt.groupNames.push(xt.lastStringValue);return}xt.raise("Invalid group")}};pp$1.regexp_eatGroupName=function(xt){if(xt.lastStringValue="",xt.eat(60)){if(this.regexp_eatRegExpIdentifierName(xt)&&xt.eat(62))return!0;xt.raise("Invalid capture group name")}return!1};pp$1.regexp_eatRegExpIdentifierName=function(xt){if(xt.lastStringValue="",this.regexp_eatRegExpIdentifierStart(xt)){for(xt.lastStringValue+=codePointToString(xt.lastIntValue);this.regexp_eatRegExpIdentifierPart(xt);)xt.lastStringValue+=codePointToString(xt.lastIntValue);return!0}return!1};pp$1.regexp_eatRegExpIdentifierStart=function(xt){var $t=xt.pos,Ct=this.options.ecmaVersion>=11,kt=xt.current(Ct);return xt.advance(Ct),kt===92&&this.regexp_eatRegExpUnicodeEscapeSequence(xt,Ct)&&(kt=xt.lastIntValue),isRegExpIdentifierStart(kt)?(xt.lastIntValue=kt,!0):(xt.pos=$t,!1)};function isRegExpIdentifierStart(xt){return isIdentifierStart$1(xt,!0)||xt===36||xt===95}pp$1.regexp_eatRegExpIdentifierPart=function(xt){var $t=xt.pos,Ct=this.options.ecmaVersion>=11,kt=xt.current(Ct);return xt.advance(Ct),kt===92&&this.regexp_eatRegExpUnicodeEscapeSequence(xt,Ct)&&(kt=xt.lastIntValue),isRegExpIdentifierPart(kt)?(xt.lastIntValue=kt,!0):(xt.pos=$t,!1)};function isRegExpIdentifierPart(xt){return isIdentifierChar(xt,!0)||xt===36||xt===95||xt===8204||xt===8205}pp$1.regexp_eatAtomEscape=function(xt){return this.regexp_eatBackReference(xt)||this.regexp_eatCharacterClassEscape(xt)||this.regexp_eatCharacterEscape(xt)||xt.switchN&&this.regexp_eatKGroupName(xt)?!0:(xt.switchU&&(xt.current()===99&&xt.raise("Invalid unicode escape"),xt.raise("Invalid escape")),!1)};pp$1.regexp_eatBackReference=function(xt){var $t=xt.pos;if(this.regexp_eatDecimalEscape(xt)){var Ct=xt.lastIntValue;if(xt.switchU)return Ct>xt.maxBackReference&&(xt.maxBackReference=Ct),!0;if(Ct<=xt.numCapturingParens)return!0;xt.pos=$t}return!1};pp$1.regexp_eatKGroupName=function(xt){if(xt.eat(107)){if(this.regexp_eatGroupName(xt))return xt.backReferenceNames.push(xt.lastStringValue),!0;xt.raise("Invalid named reference")}return!1};pp$1.regexp_eatCharacterEscape=function(xt){return this.regexp_eatControlEscape(xt)||this.regexp_eatCControlLetter(xt)||this.regexp_eatZero(xt)||this.regexp_eatHexEscapeSequence(xt)||this.regexp_eatRegExpUnicodeEscapeSequence(xt,!1)||!xt.switchU&&this.regexp_eatLegacyOctalEscapeSequence(xt)||this.regexp_eatIdentityEscape(xt)};pp$1.regexp_eatCControlLetter=function(xt){var $t=xt.pos;if(xt.eat(99)){if(this.regexp_eatControlLetter(xt))return!0;xt.pos=$t}return!1};pp$1.regexp_eatZero=function(xt){return xt.current()===48&&!isDecimalDigit$1(xt.lookahead())?(xt.lastIntValue=0,xt.advance(),!0):!1};pp$1.regexp_eatControlEscape=function(xt){var $t=xt.current();return $t===116?(xt.lastIntValue=9,xt.advance(),!0):$t===110?(xt.lastIntValue=10,xt.advance(),!0):$t===118?(xt.lastIntValue=11,xt.advance(),!0):$t===102?(xt.lastIntValue=12,xt.advance(),!0):$t===114?(xt.lastIntValue=13,xt.advance(),!0):!1};pp$1.regexp_eatControlLetter=function(xt){var $t=xt.current();return isControlLetter($t)?(xt.lastIntValue=$t%32,xt.advance(),!0):!1};function isControlLetter(xt){return xt>=65&&xt<=90||xt>=97&&xt<=122}pp$1.regexp_eatRegExpUnicodeEscapeSequence=function(xt,$t){$t===void 0&&($t=!1);var Ct=xt.pos,kt=$t||xt.switchU;if(xt.eat(117)){if(this.regexp_eatFixedHexDigits(xt,4)){var Mt=xt.lastIntValue;if(kt&&Mt>=55296&&Mt<=56319){var Ft=xt.pos;if(xt.eat(92)&&xt.eat(117)&&this.regexp_eatFixedHexDigits(xt,4)){var jt=xt.lastIntValue;if(jt>=56320&&jt<=57343)return xt.lastIntValue=(Mt-55296)*1024+(jt-56320)+65536,!0}xt.pos=Ft,xt.lastIntValue=Mt}return!0}if(kt&&xt.eat(123)&&this.regexp_eatHexDigits(xt)&&xt.eat(125)&&isValidUnicode(xt.lastIntValue))return!0;kt&&xt.raise("Invalid unicode escape"),xt.pos=Ct}return!1};function isValidUnicode(xt){return xt>=0&&xt<=1114111}pp$1.regexp_eatIdentityEscape=function(xt){if(xt.switchU)return this.regexp_eatSyntaxCharacter(xt)?!0:xt.eat(47)?(xt.lastIntValue=47,!0):!1;var $t=xt.current();return $t!==99&&(!xt.switchN||$t!==107)?(xt.lastIntValue=$t,xt.advance(),!0):!1};pp$1.regexp_eatDecimalEscape=function(xt){xt.lastIntValue=0;var $t=xt.current();if($t>=49&&$t<=57){do xt.lastIntValue=10*xt.lastIntValue+($t-48),xt.advance();while(($t=xt.current())>=48&&$t<=57);return!0}return!1};var CharSetNone=0,CharSetOk=1,CharSetString=2;pp$1.regexp_eatCharacterClassEscape=function(xt){var $t=xt.current();if(isCharacterClassEscape($t))return xt.lastIntValue=-1,xt.advance(),CharSetOk;var Ct=!1;if(xt.switchU&&this.options.ecmaVersion>=9&&((Ct=$t===80)||$t===112)){xt.lastIntValue=-1,xt.advance();var kt;if(xt.eat(123)&&(kt=this.regexp_eatUnicodePropertyValueExpression(xt))&&xt.eat(125))return Ct&&kt===CharSetString&&xt.raise("Invalid property name"),kt;xt.raise("Invalid property name")}return CharSetNone};function isCharacterClassEscape(xt){return xt===100||xt===68||xt===115||xt===83||xt===119||xt===87}pp$1.regexp_eatUnicodePropertyValueExpression=function(xt){var $t=xt.pos;if(this.regexp_eatUnicodePropertyName(xt)&&xt.eat(61)){var Ct=xt.lastStringValue;if(this.regexp_eatUnicodePropertyValue(xt)){var kt=xt.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(xt,Ct,kt),CharSetOk}}if(xt.pos=$t,this.regexp_eatLoneUnicodePropertyNameOrValue(xt)){var Mt=xt.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(xt,Mt)}return CharSetNone};pp$1.regexp_validateUnicodePropertyNameAndValue=function(xt,$t,Ct){hasOwn(xt.unicodeProperties.nonBinary,$t)||xt.raise("Invalid property name"),xt.unicodeProperties.nonBinary[$t].test(Ct)||xt.raise("Invalid property value")};pp$1.regexp_validateUnicodePropertyNameOrValue=function(xt,$t){if(xt.unicodeProperties.binary.test($t))return CharSetOk;if(xt.switchV&&xt.unicodeProperties.binaryOfStrings.test($t))return CharSetString;xt.raise("Invalid property name")};pp$1.regexp_eatUnicodePropertyName=function(xt){var $t=0;for(xt.lastStringValue="";isUnicodePropertyNameCharacter($t=xt.current());)xt.lastStringValue+=codePointToString($t),xt.advance();return xt.lastStringValue!==""};function isUnicodePropertyNameCharacter(xt){return isControlLetter(xt)||xt===95}pp$1.regexp_eatUnicodePropertyValue=function(xt){var $t=0;for(xt.lastStringValue="";isUnicodePropertyValueCharacter($t=xt.current());)xt.lastStringValue+=codePointToString($t),xt.advance();return xt.lastStringValue!==""};function isUnicodePropertyValueCharacter(xt){return isUnicodePropertyNameCharacter(xt)||isDecimalDigit$1(xt)}pp$1.regexp_eatLoneUnicodePropertyNameOrValue=function(xt){return this.regexp_eatUnicodePropertyValue(xt)};pp$1.regexp_eatCharacterClass=function(xt){if(xt.eat(91)){var $t=xt.eat(94),Ct=this.regexp_classContents(xt);return xt.eat(93)||xt.raise("Unterminated character class"),$t&&Ct===CharSetString&&xt.raise("Negated character class may contain strings"),!0}return!1};pp$1.regexp_classContents=function(xt){return xt.current()===93?CharSetOk:xt.switchV?this.regexp_classSetExpression(xt):(this.regexp_nonEmptyClassRanges(xt),CharSetOk)};pp$1.regexp_nonEmptyClassRanges=function(xt){for(;this.regexp_eatClassAtom(xt);){var $t=xt.lastIntValue;if(xt.eat(45)&&this.regexp_eatClassAtom(xt)){var Ct=xt.lastIntValue;xt.switchU&&($t===-1||Ct===-1)&&xt.raise("Invalid character class"),$t!==-1&&Ct!==-1&&$t>Ct&&xt.raise("Range out of order in character class")}}};pp$1.regexp_eatClassAtom=function(xt){var $t=xt.pos;if(xt.eat(92)){if(this.regexp_eatClassEscape(xt))return!0;if(xt.switchU){var Ct=xt.current();(Ct===99||isOctalDigit$1(Ct))&&xt.raise("Invalid class escape"),xt.raise("Invalid escape")}xt.pos=$t}var kt=xt.current();return kt!==93?(xt.lastIntValue=kt,xt.advance(),!0):!1};pp$1.regexp_eatClassEscape=function(xt){var $t=xt.pos;if(xt.eat(98))return xt.lastIntValue=8,!0;if(xt.switchU&&xt.eat(45))return xt.lastIntValue=45,!0;if(!xt.switchU&&xt.eat(99)){if(this.regexp_eatClassControlLetter(xt))return!0;xt.pos=$t}return this.regexp_eatCharacterClassEscape(xt)||this.regexp_eatCharacterEscape(xt)};pp$1.regexp_classSetExpression=function(xt){var $t=CharSetOk,Ct;if(!this.regexp_eatClassSetRange(xt))if(Ct=this.regexp_eatClassSetOperand(xt)){Ct===CharSetString&&($t=CharSetString);for(var kt=xt.pos;xt.eatChars([38,38]);){if(xt.current()!==38&&(Ct=this.regexp_eatClassSetOperand(xt))){Ct!==CharSetString&&($t=CharSetOk);continue}xt.raise("Invalid character in character class")}if(kt!==xt.pos)return $t;for(;xt.eatChars([45,45]);)this.regexp_eatClassSetOperand(xt)||xt.raise("Invalid character in character class");if(kt!==xt.pos)return $t}else xt.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(xt)){if(Ct=this.regexp_eatClassSetOperand(xt),!Ct)return $t;Ct===CharSetString&&($t=CharSetString)}};pp$1.regexp_eatClassSetRange=function(xt){var $t=xt.pos;if(this.regexp_eatClassSetCharacter(xt)){var Ct=xt.lastIntValue;if(xt.eat(45)&&this.regexp_eatClassSetCharacter(xt)){var kt=xt.lastIntValue;return Ct!==-1&&kt!==-1&&Ct>kt&&xt.raise("Range out of order in character class"),!0}xt.pos=$t}return!1};pp$1.regexp_eatClassSetOperand=function(xt){return this.regexp_eatClassSetCharacter(xt)?CharSetOk:this.regexp_eatClassStringDisjunction(xt)||this.regexp_eatNestedClass(xt)};pp$1.regexp_eatNestedClass=function(xt){var $t=xt.pos;if(xt.eat(91)){var Ct=xt.eat(94),kt=this.regexp_classContents(xt);if(xt.eat(93))return Ct&&kt===CharSetString&&xt.raise("Negated character class may contain strings"),kt;xt.pos=$t}if(xt.eat(92)){var Mt=this.regexp_eatCharacterClassEscape(xt);if(Mt)return Mt;xt.pos=$t}return null};pp$1.regexp_eatClassStringDisjunction=function(xt){var $t=xt.pos;if(xt.eatChars([92,113])){if(xt.eat(123)){var Ct=this.regexp_classStringDisjunctionContents(xt);if(xt.eat(125))return Ct}else xt.raise("Invalid escape");xt.pos=$t}return null};pp$1.regexp_classStringDisjunctionContents=function(xt){for(var $t=this.regexp_classString(xt);xt.eat(124);)this.regexp_classString(xt)===CharSetString&&($t=CharSetString);return $t};pp$1.regexp_classString=function(xt){for(var $t=0;this.regexp_eatClassSetCharacter(xt);)$t++;return $t===1?CharSetOk:CharSetString};pp$1.regexp_eatClassSetCharacter=function(xt){var $t=xt.pos;if(xt.eat(92))return this.regexp_eatCharacterEscape(xt)||this.regexp_eatClassSetReservedPunctuator(xt)?!0:xt.eat(98)?(xt.lastIntValue=8,!0):(xt.pos=$t,!1);var Ct=xt.current();return Ct<0||Ct===xt.lookahead()&&isClassSetReservedDoublePunctuatorCharacter(Ct)||isClassSetSyntaxCharacter(Ct)?!1:(xt.advance(),xt.lastIntValue=Ct,!0)};function isClassSetReservedDoublePunctuatorCharacter(xt){return xt===33||xt>=35&&xt<=38||xt>=42&&xt<=44||xt===46||xt>=58&&xt<=64||xt===94||xt===96||xt===126}function isClassSetSyntaxCharacter(xt){return xt===40||xt===41||xt===45||xt===47||xt>=91&&xt<=93||xt>=123&&xt<=125}pp$1.regexp_eatClassSetReservedPunctuator=function(xt){var $t=xt.current();return isClassSetReservedPunctuator($t)?(xt.lastIntValue=$t,xt.advance(),!0):!1};function isClassSetReservedPunctuator(xt){return xt===33||xt===35||xt===37||xt===38||xt===44||xt===45||xt>=58&&xt<=62||xt===64||xt===96||xt===126}pp$1.regexp_eatClassControlLetter=function(xt){var $t=xt.current();return isDecimalDigit$1($t)||$t===95?(xt.lastIntValue=$t%32,xt.advance(),!0):!1};pp$1.regexp_eatHexEscapeSequence=function(xt){var $t=xt.pos;if(xt.eat(120)){if(this.regexp_eatFixedHexDigits(xt,2))return!0;xt.switchU&&xt.raise("Invalid escape"),xt.pos=$t}return!1};pp$1.regexp_eatDecimalDigits=function(xt){var $t=xt.pos,Ct=0;for(xt.lastIntValue=0;isDecimalDigit$1(Ct=xt.current());)xt.lastIntValue=10*xt.lastIntValue+(Ct-48),xt.advance();return xt.pos!==$t};function isDecimalDigit$1(xt){return xt>=48&&xt<=57}pp$1.regexp_eatHexDigits=function(xt){var $t=xt.pos,Ct=0;for(xt.lastIntValue=0;isHexDigit$1(Ct=xt.current());)xt.lastIntValue=16*xt.lastIntValue+hexToInt(Ct),xt.advance();return xt.pos!==$t};function isHexDigit$1(xt){return xt>=48&&xt<=57||xt>=65&&xt<=70||xt>=97&&xt<=102}function hexToInt(xt){return xt>=65&&xt<=70?10+(xt-65):xt>=97&&xt<=102?10+(xt-97):xt-48}pp$1.regexp_eatLegacyOctalEscapeSequence=function(xt){if(this.regexp_eatOctalDigit(xt)){var $t=xt.lastIntValue;if(this.regexp_eatOctalDigit(xt)){var Ct=xt.lastIntValue;$t<=3&&this.regexp_eatOctalDigit(xt)?xt.lastIntValue=$t*64+Ct*8+xt.lastIntValue:xt.lastIntValue=$t*8+Ct}else xt.lastIntValue=$t;return!0}return!1};pp$1.regexp_eatOctalDigit=function(xt){var $t=xt.current();return isOctalDigit$1($t)?(xt.lastIntValue=$t-48,xt.advance(),!0):(xt.lastIntValue=0,!1)};function isOctalDigit$1(xt){return xt>=48&&xt<=55}pp$1.regexp_eatFixedHexDigits=function(xt,$t){var Ct=xt.pos;xt.lastIntValue=0;for(var kt=0;kt<$t;++kt){var Mt=xt.current();if(!isHexDigit$1(Mt))return xt.pos=Ct,!1;xt.lastIntValue=16*xt.lastIntValue+hexToInt(Mt),xt.advance()}return!0};var Token=function($t){this.type=$t.type,this.value=$t.value,this.start=$t.start,this.end=$t.end,$t.options.locations&&(this.loc=new SourceLocation($t,$t.startLoc,$t.endLoc)),$t.options.ranges&&(this.range=[$t.start,$t.end])},pp=Parser.prototype;pp.next=function(xt){!xt&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Token(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};pp.getToken=function(){return this.next(),new Token(this)};typeof Symbol<"u"&&(pp[Symbol.iterator]=function(){var xt=this;return{next:function(){var $t=xt.getToken();return{done:$t.type===types$1$1.eof,value:$t}}}});pp.nextToken=function(){var xt=this.curContext();if((!xt||!xt.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(types$1$1.eof);if(xt.override)return xt.override(this);this.readToken(this.fullCharCodeAtPos())};pp.readToken=function(xt){return isIdentifierStart$1(xt,this.options.ecmaVersion>=6)||xt===92?this.readWord():this.getTokenFromCode(xt)};pp.fullCharCodeAtPos=function(){var xt=this.input.charCodeAt(this.pos);if(xt<=55295||xt>=56320)return xt;var $t=this.input.charCodeAt(this.pos+1);return $t<=56319||$t>=57344?xt:(xt<<10)+$t-56613888};pp.skipBlockComment=function(){var xt=this.options.onComment&&this.curPosition(),$t=this.pos,Ct=this.input.indexOf("*/",this.pos+=2);if(Ct===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=Ct+2,this.options.locations)for(var kt=void 0,Mt=$t;(kt=nextLineBreak(this.input,Mt,this.pos))>-1;)++this.curLine,Mt=this.lineStart=kt;this.options.onComment&&this.options.onComment(!0,this.input.slice($t+2,Ct),$t,this.pos,xt,this.curPosition())};pp.skipLineComment=function(xt){for(var $t=this.pos,Ct=this.options.onComment&&this.curPosition(),kt=this.input.charCodeAt(this.pos+=xt);this.pos<this.input.length&&!isNewLine(kt);)kt=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice($t+xt,this.pos),$t,this.pos,Ct,this.curPosition())};pp.skipSpace=function(){e:for(;this.pos<this.input.length;){var xt=this.input.charCodeAt(this.pos);switch(xt){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(xt>8&&xt<14||xt>=5760&&nonASCIIwhitespace.test(String.fromCharCode(xt)))++this.pos;else break e}}};pp.finishToken=function(xt,$t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var Ct=this.type;this.type=xt,this.value=$t,this.updateContext(Ct)};pp.readToken_dot=function(){var xt=this.input.charCodeAt(this.pos+1);if(xt>=48&&xt<=57)return this.readNumber(!0);var $t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&xt===46&&$t===46?(this.pos+=3,this.finishToken(types$1$1.ellipsis)):(++this.pos,this.finishToken(types$1$1.dot))};pp.readToken_slash=function(){var xt=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):xt===61?this.finishOp(types$1$1.assign,2):this.finishOp(types$1$1.slash,1)};pp.readToken_mult_modulo_exp=function(xt){var $t=this.input.charCodeAt(this.pos+1),Ct=1,kt=xt===42?types$1$1.star:types$1$1.modulo;return this.options.ecmaVersion>=7&&xt===42&&$t===42&&(++Ct,kt=types$1$1.starstar,$t=this.input.charCodeAt(this.pos+2)),$t===61?this.finishOp(types$1$1.assign,Ct+1):this.finishOp(kt,Ct)};pp.readToken_pipe_amp=function(xt){var $t=this.input.charCodeAt(this.pos+1);if($t===xt){if(this.options.ecmaVersion>=12){var Ct=this.input.charCodeAt(this.pos+2);if(Ct===61)return this.finishOp(types$1$1.assign,3)}return this.finishOp(xt===124?types$1$1.logicalOR:types$1$1.logicalAND,2)}return $t===61?this.finishOp(types$1$1.assign,2):this.finishOp(xt===124?types$1$1.bitwiseOR:types$1$1.bitwiseAND,1)};pp.readToken_caret=function(){var xt=this.input.charCodeAt(this.pos+1);return xt===61?this.finishOp(types$1$1.assign,2):this.finishOp(types$1$1.bitwiseXOR,1)};pp.readToken_plus_min=function(xt){var $t=this.input.charCodeAt(this.pos+1);return $t===xt?$t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||lineBreak.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(types$1$1.incDec,2):$t===61?this.finishOp(types$1$1.assign,2):this.finishOp(types$1$1.plusMin,1)};pp.readToken_lt_gt=function(xt){var $t=this.input.charCodeAt(this.pos+1),Ct=1;return $t===xt?(Ct=xt===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+Ct)===61?this.finishOp(types$1$1.assign,Ct+1):this.finishOp(types$1$1.bitShift,Ct)):$t===33&&xt===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):($t===61&&(Ct=2),this.finishOp(types$1$1.relational,Ct))};pp.readToken_eq_excl=function(xt){var $t=this.input.charCodeAt(this.pos+1);return $t===61?this.finishOp(types$1$1.equality,this.input.charCodeAt(this.pos+2)===61?3:2):xt===61&&$t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(types$1$1.arrow)):this.finishOp(xt===61?types$1$1.eq:types$1$1.prefix,1)};pp.readToken_question=function(){var xt=this.options.ecmaVersion;if(xt>=11){var $t=this.input.charCodeAt(this.pos+1);if($t===46){var Ct=this.input.charCodeAt(this.pos+2);if(Ct<48||Ct>57)return this.finishOp(types$1$1.questionDot,2)}if($t===63){if(xt>=12){var kt=this.input.charCodeAt(this.pos+2);if(kt===61)return this.finishOp(types$1$1.assign,3)}return this.finishOp(types$1$1.coalesce,2)}}return this.finishOp(types$1$1.question,1)};pp.readToken_numberSign=function(){var xt=this.options.ecmaVersion,$t=35;if(xt>=13&&(++this.pos,$t=this.fullCharCodeAtPos(),isIdentifierStart$1($t,!0)||$t===92))return this.finishToken(types$1$1.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+codePointToString($t)+"'")};pp.getTokenFromCode=function(xt){switch(xt){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(types$1$1.parenL);case 41:return++this.pos,this.finishToken(types$1$1.parenR);case 59:return++this.pos,this.finishToken(types$1$1.semi);case 44:return++this.pos,this.finishToken(types$1$1.comma);case 91:return++this.pos,this.finishToken(types$1$1.bracketL);case 93:return++this.pos,this.finishToken(types$1$1.bracketR);case 123:return++this.pos,this.finishToken(types$1$1.braceL);case 125:return++this.pos,this.finishToken(types$1$1.braceR);case 58:return++this.pos,this.finishToken(types$1$1.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(types$1$1.backQuote);case 48:var $t=this.input.charCodeAt(this.pos+1);if($t===120||$t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if($t===111||$t===79)return this.readRadixNumber(8);if($t===98||$t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(xt);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(xt);case 124:case 38:return this.readToken_pipe_amp(xt);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(xt);case 60:case 62:return this.readToken_lt_gt(xt);case 61:case 33:return this.readToken_eq_excl(xt);case 63:return this.readToken_question();case 126:return this.finishOp(types$1$1.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+codePointToString(xt)+"'")};pp.finishOp=function(xt,$t){var Ct=this.input.slice(this.pos,this.pos+$t);return this.pos+=$t,this.finishToken(xt,Ct)};pp.readRegexp=function(){for(var xt,$t,Ct=this.pos;;){this.pos>=this.input.length&&this.raise(Ct,"Unterminated regular expression");var kt=this.input.charAt(this.pos);if(lineBreak.test(kt)&&this.raise(Ct,"Unterminated regular expression"),xt)xt=!1;else{if(kt==="[")$t=!0;else if(kt==="]"&&$t)$t=!1;else if(kt==="/"&&!$t)break;xt=kt==="\\"}++this.pos}var Mt=this.input.slice(Ct,this.pos);++this.pos;var Ft=this.pos,jt=this.readWord1();this.containsEsc&&this.unexpected(Ft);var Bt=this.regexpState||(this.regexpState=new RegExpValidationState(this));Bt.reset(Ct,Mt,jt),this.validateRegExpFlags(Bt),this.validateRegExpPattern(Bt);var Vt=null;try{Vt=new RegExp(Mt,jt)}catch{}return this.finishToken(types$1$1.regexp,{pattern:Mt,flags:jt,value:Vt})};pp.readInt=function(xt,$t,Ct){for(var kt=this.options.ecmaVersion>=12&&$t===void 0,Mt=Ct&&this.input.charCodeAt(this.pos)===48,Ft=this.pos,jt=0,Bt=0,Vt=0,zt=$t??1/0;Vt<zt;++Vt,++this.pos){var Ht=this.input.charCodeAt(this.pos),Gt=void 0;if(kt&&Ht===95){Mt&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),Bt===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),Vt===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),Bt=Ht;continue}if(Ht>=97?Gt=Ht-97+10:Ht>=65?Gt=Ht-65+10:Ht>=48&&Ht<=57?Gt=Ht-48:Gt=1/0,Gt>=xt)break;Bt=Ht,jt=jt*xt+Gt}return kt&&Bt===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Ft||$t!=null&&this.pos-Ft!==$t?null:jt};function stringToNumber(xt,$t){return $t?parseInt(xt,8):parseFloat(xt.replace(/_/g,""))}function stringToBigInt(xt){return typeof BigInt!="function"?null:BigInt(xt.replace(/_/g,""))}pp.readRadixNumber=function(xt){var $t=this.pos;this.pos+=2;var Ct=this.readInt(xt);return Ct==null&&this.raise(this.start+2,"Expected number in radix "+xt),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(Ct=stringToBigInt(this.input.slice($t,this.pos)),++this.pos):isIdentifierStart$1(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(types$1$1.num,Ct)};pp.readNumber=function(xt){var $t=this.pos;!xt&&this.readInt(10,void 0,!0)===null&&this.raise($t,"Invalid number");var Ct=this.pos-$t>=2&&this.input.charCodeAt($t)===48;Ct&&this.strict&&this.raise($t,"Invalid number");var kt=this.input.charCodeAt(this.pos);if(!Ct&&!xt&&this.options.ecmaVersion>=11&&kt===110){var Mt=stringToBigInt(this.input.slice($t,this.pos));return++this.pos,isIdentifierStart$1(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(types$1$1.num,Mt)}Ct&&/[89]/.test(this.input.slice($t,this.pos))&&(Ct=!1),kt===46&&!Ct&&(++this.pos,this.readInt(10),kt=this.input.charCodeAt(this.pos)),(kt===69||kt===101)&&!Ct&&(kt=this.input.charCodeAt(++this.pos),(kt===43||kt===45)&&++this.pos,this.readInt(10)===null&&this.raise($t,"Invalid number")),isIdentifierStart$1(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Ft=stringToNumber(this.input.slice($t,this.pos),Ct);return this.finishToken(types$1$1.num,Ft)};pp.readCodePoint=function(){var xt=this.input.charCodeAt(this.pos),$t;if(xt===123){this.options.ecmaVersion<6&&this.unexpected();var Ct=++this.pos;$t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,$t>1114111&&this.invalidStringToken(Ct,"Code point out of bounds")}else $t=this.readHexChar(4);return $t};pp.readString=function(xt){for(var $t="",Ct=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var kt=this.input.charCodeAt(this.pos);if(kt===xt)break;kt===92?($t+=this.input.slice(Ct,this.pos),$t+=this.readEscapedChar(!1),Ct=this.pos):kt===8232||kt===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(isNewLine(kt)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return $t+=this.input.slice(Ct,this.pos++),this.finishToken(types$1$1.string,$t)};var INVALID_TEMPLATE_ESCAPE_ERROR={};pp.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(xt){if(xt===INVALID_TEMPLATE_ESCAPE_ERROR)this.readInvalidTemplateToken();else throw xt}this.inTemplateElement=!1};pp.invalidStringToken=function(xt,$t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw INVALID_TEMPLATE_ESCAPE_ERROR;this.raise(xt,$t)};pp.readTmplToken=function(){for(var xt="",$t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var Ct=this.input.charCodeAt(this.pos);if(Ct===96||Ct===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===types$1$1.template||this.type===types$1$1.invalidTemplate)?Ct===36?(this.pos+=2,this.finishToken(types$1$1.dollarBraceL)):(++this.pos,this.finishToken(types$1$1.backQuote)):(xt+=this.input.slice($t,this.pos),this.finishToken(types$1$1.template,xt));if(Ct===92)xt+=this.input.slice($t,this.pos),xt+=this.readEscapedChar(!0),$t=this.pos;else if(isNewLine(Ct)){switch(xt+=this.input.slice($t,this.pos),++this.pos,Ct){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:xt+=`
`;break;default:xt+=String.fromCharCode(Ct);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),$t=this.pos}else++this.pos}};pp.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(types$1$1.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")};pp.readEscapedChar=function(xt){var $t=this.input.charCodeAt(++this.pos);switch(++this.pos,$t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return codePointToString(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),xt){var Ct=this.pos-1;this.invalidStringToken(Ct,"Invalid escape sequence in template string")}default:if($t>=48&&$t<=55){var kt=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],Mt=parseInt(kt,8);return Mt>255&&(kt=kt.slice(0,-1),Mt=parseInt(kt,8)),this.pos+=kt.length-1,$t=this.input.charCodeAt(this.pos),(kt!=="0"||$t===56||$t===57)&&(this.strict||xt)&&this.invalidStringToken(this.pos-1-kt.length,xt?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(Mt)}return isNewLine($t)?"":String.fromCharCode($t)}};pp.readHexChar=function(xt){var $t=this.pos,Ct=this.readInt(16,xt);return Ct===null&&this.invalidStringToken($t,"Bad character escape sequence"),Ct};pp.readWord1=function(){this.containsEsc=!1;for(var xt="",$t=!0,Ct=this.pos,kt=this.options.ecmaVersion>=6;this.pos<this.input.length;){var Mt=this.fullCharCodeAtPos();if(isIdentifierChar(Mt,kt))this.pos+=Mt<=65535?1:2;else if(Mt===92){this.containsEsc=!0,xt+=this.input.slice(Ct,this.pos);var Ft=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var jt=this.readCodePoint();($t?isIdentifierStart$1:isIdentifierChar)(jt,kt)||this.invalidStringToken(Ft,"Invalid Unicode escape"),xt+=codePointToString(jt),Ct=this.pos}else break;$t=!1}return xt+this.input.slice(Ct,this.pos)};pp.readWord=function(){var xt=this.readWord1(),$t=types$1$1.name;return this.keywords.test(xt)&&($t=keywords$3[xt]),this.finishToken($t,xt)};var version$b="8.11.3";Parser.acorn={Parser,version:version$b,defaultOptions,Position,SourceLocation,getLineInfo,Node:Node$2,TokenType,tokTypes:types$1$1,keywordTypes:keywords$3,TokContext,tokContexts:types$3,isIdentifierChar,isIdentifierStart:isIdentifierStart$1,Token,isNewLine,lineBreak,lineBreakG,nonASCIIwhitespace};function parse$b(xt,$t){return Parser.parse(xt,$t)}const constants$1={undefined:"void(0)",Infinity:"Number.POSITIVE_INFINITY",NaN:"Number.NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2"},PARSER_OPT={ecmaVersion:11},DEFAULT_PARAM_ID="$",DEFAULT_TUPLE_ID="d",DEFAULT_TUPLE_ID1="d1",DEFAULT_TUPLE_ID2="d2",NO=xt=>($t,Ct)=>Ct.error($t,xt+" not allowed"),ERROR_AGGREGATE=NO("Aggregate function"),ERROR_WINDOW=NO("Window function"),ERROR_ARGUMENT="Invalid argument",ERROR_COLUMN="Invalid column reference",ERROR_AGGRONLY=ERROR_COLUMN+" (must be input to an aggregate function)",ERROR_FUNCTION="Invalid function call",ERROR_MEMBER="Invalid member expression",ERROR_OP_PARAMETER="Invalid operator parameter",ERROR_PARAM="Invalid param reference",ERROR_VARIABLE="Invalid variable reference",ERROR_VARIABLE_OP="Variable not accessible in operator call",ERROR_DECLARATION="Unsupported variable declaration",ERROR_DESTRUCTURE="Unsupported destructuring pattern",ERROR_CLOSURE="Table expressions do not support closures",ERROR_ESCAPE="Use aq.escape(fn) to use a function as-is (including closures)",ERROR_USE_PARAMS="use table.params({ name: value }) to define dynamic parameters",ERROR_ADD_FUNCTION="use aq.addFunction(name, fn) to add new op functions",ERROR_VARIABLE_NOTE=`
Note: ${ERROR_CLOSURE}. ${ERROR_ESCAPE}, or ${ERROR_USE_PARAMS}.`,ERROR_FUNCTION_NOTE=`
Note: ${ERROR_CLOSURE}. ${ERROR_ESCAPE}, or ${ERROR_ADD_FUNCTION}.`,ERROR_ROW_OBJECT=`The ${ROW_OBJECT} method is not valid in multi-table expressions.`;function parseExpression$2(xt,$t){const Ct=parseAST($t);let kt=xt.root=Ct;return xt.spec=$t,xt.tuple=null,xt.tuple1=null,xt.tuple2=null,xt.$param=null,xt.$op=0,xt.scope=new Set,xt.paramsRef=new Map,xt.columnRef=new Map,isFunctionExpression(kt)?(parseFunction(kt,xt),kt=kt.body):xt.join?(xt.scope.add(xt.tuple1=DEFAULT_TUPLE_ID1),xt.scope.add(xt.tuple2=DEFAULT_TUPLE_ID2),xt.scope.add(xt.$param=DEFAULT_PARAM_ID)):(xt.scope.add(xt.tuple=DEFAULT_TUPLE_ID),xt.scope.add(xt.$param=DEFAULT_PARAM_ID)),walk(kt,xt,visitors),xt.root}function parseAST(xt){try{const $t=xt.field?fieldRef$2(xt):isArray$3(xt)?toString$2(xt):xt;return parse$b(`expr=(${$t})`,PARSER_OPT).body[0].expression.right}catch{error$k(`Expression parse error: ${xt+""}`)}}function fieldRef$2(xt){const $t=JSON.stringify(xt+"");return xt.table?`(a,b)=>b[${$t}]`:`d=>d[${$t}]`}const visitors={FunctionDeclaration:NO("Function definitions"),ForStatement:NO("For loops"),ForOfStatement:NO("For-of loops"),ForInStatement:NO("For-in loops"),WhileStatement:NO("While loops"),DoWhileStatement:NO("Do-while loops"),AwaitExpression:NO("Await expressions"),ArrowFunctionExpression:NO("Function definitions"),AssignmentExpression:NO("Assignments"),FunctionExpression:NO("Function definitions"),NewExpression:NO('Use of "new"'),UpdateExpression:NO("Update expressions"),VariableDeclarator(xt,$t){handleDeclaration(xt.id,$t)},Identifier(xt,$t,Ct){handleIdentifier(xt,$t,Ct)&&!$t.scope.has(xt.name)&&$t.error(xt,ERROR_VARIABLE,ERROR_VARIABLE_NOTE)},CallExpression(xt,$t){const Ct=functionName(xt.callee),kt=getAggregate(Ct)||getWindow(Ct);if(kt){if(($t.join||$t.aggregate===!1)&&hasAggregate(Ct)&&ERROR_AGGREGATE(xt,$t),($t.join||$t.window===!1)&&hasWindow(Ct)&&ERROR_WINDOW(xt,$t),$t.$op=1,$t.ast)updateFunctionNode(xt,Ct,$t),xt.arguments.forEach(Mt=>walk(Mt,$t,opVisitors));else{const Mt=$t.op(parseOperator$1($t,kt,Ct,xt.arguments));Object.assign(xt,{type:Op,name:Mt.id})}return $t.$op=0,!1}else hasFunction(Ct)?updateFunctionNode(xt,Ct,$t):$t.error(xt,ERROR_FUNCTION,ERROR_FUNCTION_NOTE)},MemberExpression(xt,$t,Ct){const{object:kt,property:Mt}=xt;if(!is(Identifier$2,kt))return;const{name:Ft}=kt;if(isMath(xt)&&is(Identifier$2,Mt)&&has$3(constants$1,Mt.name)){updateConstantNode(xt,Mt.name);return}const jt=Ft===$t.tuple?0:Ft===$t.tuple1?1:Ft===$t.tuple2?2:-1;if(jt>=0)return spliceMember(xt,jt,$t,checkColumn,Ct);if(Ft===$t.$param)return spliceMember(xt,jt,$t,checkParam);$t.paramsRef.has(Ft)?updateParameterNode(xt,$t.paramsRef.get(Ft)):$t.columnRef.has(Ft)?updateColumnNode(kt,Ft,$t,xt):has$3($t.params,Ft)&&updateParameterNode(kt,Ft)}};function spliceMember(xt,$t,Ct,kt,Mt){const{property:Ft,computed:jt}=xt;let Bt;if(!jt)Bt=Ft.name;else if(is(Literal$1,Ft))Bt=Ft.value;else try{walk(Ft,Ct,visitors,xt),Bt=Ct.param(Ft)}catch{Ct.error(xt,ERROR_MEMBER)}return kt(xt,Bt,$t,Ct,Mt),!1}const opVisitors={...visitors,VariableDeclarator:NO("Variable declaration in operator call"),Identifier(xt,$t,Ct){handleIdentifier(xt,$t,Ct)&&$t.error(xt,ERROR_VARIABLE_OP)},CallExpression(xt,$t){const Ct=functionName(xt.callee);hasFunction(Ct)?updateFunctionNode(xt,Ct,$t):$t.error(xt,ERROR_FUNCTION,ERROR_FUNCTION_NOTE)}};function parseFunction(xt,$t){xt.generator&&NO("Generator functions")(xt,$t),xt.async&&NO("Async functions")(xt,$t);const{params:Ct}=xt,kt=Ct.length,Mt=jt=>(Bt,Vt)=>$t.columnRef.set(Bt,[Vt,jt]),Ft=(jt,Bt)=>$t.paramsRef.set(jt,Bt);kt&&($t.join?(parseRef($t,Ct[0],"tuple1",Mt(1)),kt>1&&parseRef($t,Ct[1],"tuple2",Mt(2)),kt>2&&parseRef($t,Ct[2],"$param",Ft)):(parseRef($t,Ct[0],"tuple",Mt(0)),kt>1&&parseRef($t,Ct[1],"$param",Ft))),$t.root=xt.body}function parseRef(xt,$t,Ct,kt){is(Identifier$2,$t)?(xt.scope.add($t.name),xt[Ct]=$t.name):is(ObjectPattern,$t)&&$t.properties.forEach(Mt=>{const Ft=is(Identifier$2,Mt.key)?Mt.key.name:is(Literal$1,Mt.key)?Mt.key.value:xt.error(Mt,ERROR_ARGUMENT);is(Identifier$2,Mt.value)||xt.error(Mt.value,ERROR_DESTRUCTURE),kt(Mt.value.name,Ft)})}function parseOperator$1(xt,$t,Ct,kt){const Mt=[],Ft=[],jt=$t.param[0]||0,Bt=jt+($t.param[1]||0);return kt.forEach((Vt,zt)=>{zt<jt?(walk(Vt,xt,opVisitors),Mt.push(xt.field(Vt))):zt<Bt?(walk(Vt,xt,opVisitors),Ft.push(xt.param(Vt))):xt.error(Vt,ERROR_OP_PARAMETER)}),{name:Ct,fields:Mt,params:Ft,...xt.spec.window||{}}}function functionName(xt){return is(Identifier$2,xt)?xt.name:is(MemberExpression$1,xt)?isMath(xt)?rewriteMath(xt.property.name):xt.property.name:null}function isMath(xt){return is(Identifier$2,xt.object)&&xt.object.name==="Math"}function rewriteMath(xt){return xt==="max"?"greatest":xt==="min"?"least":xt}function handleIdentifier(xt,$t,Ct){const{name:kt}=xt;if(!(is(MemberExpression$1,Ct)&&Ct.property===xt)){if(!(is(Property$1,Ct)&&Ct.key===xt))if($t.paramsRef.has(kt))updateParameterNode(xt,$t.paramsRef.get(kt));else if($t.columnRef.has(kt))updateColumnNode(xt,kt,$t,Ct);else if(has$3($t.params,kt))updateParameterNode(xt,kt);else if(has$3(constants$1,kt))updateConstantNode(xt,kt);else return!0}}function checkColumn(xt,$t,Ct,kt,Mt){const Ft=Ct===0?kt.table:Ct>0?kt.join[Ct-1]:null,jt=Ft&&Ft.column($t);Ft&&!jt&&kt.error(xt,ERROR_COLUMN),kt.aggronly&&!kt.$op&&kt.error(xt,ERROR_AGGRONLY),rewrite(xt,$t,Ct,jt,Mt)}function updateColumnNode(xt,$t,Ct,kt){const[Mt,Ft]=Ct.columnRef.get($t);checkColumn(xt,Mt,Ft,Ct,kt)}function checkParam(xt,$t,Ct,kt){kt.params&&!has$3(kt.params,$t)&&kt.error(xt,ERROR_PARAM),updateParameterNode(xt,$t)}function updateParameterNode(xt,$t){xt.type=Parameter,xt.name=$t}function updateConstantNode(xt,$t){xt.type=Constant,xt.name=$t,xt.raw=constants$1[$t]}function updateFunctionNode(xt,$t,Ct){if($t===ROW_OBJECT){const kt=Ct.table;kt||Ct.error(xt,ERROR_ROW_OBJECT),rowObjectExpression(xt,xt.arguments.length?xt.arguments.map(Mt=>{const Ft=Ct.param(Mt),jt=isNumber$2(Ft)?kt.columnName(Ft):Ft;return kt.column(jt)||Ct.error(Mt,ERROR_COLUMN),jt}):kt.columnNames())}else xt.callee={type:Function$1,name:$t}}function handleDeclaration(xt,$t){is(Identifier$2,xt)?$t.scope.add(xt.name):is(ArrayPattern,xt)?xt.elements.forEach(Ct=>handleDeclaration(Ct,$t)):is(ObjectPattern,xt)?xt.properties.forEach(Ct=>handleDeclaration(Ct.value,$t)):$t.error(xt.id,ERROR_DECLARATION)}const ANNOTATE={[Column$1]:1,[Op]:1};function parse$a(xt,$t={}){const Ct=$t.generate||codegen$2,kt=$t.compiler||compile$3,Mt=getParams($t),Ft={},jt={},Bt=[],Vt=[];let zt=0,Ht=-1;const Gt=$t.join?kt.join:$t.index==1?kt.expr2:kt.expr,qt={op(Kt){const Xt=opKey(Kt);return jt[Xt]||(Kt.id=++Ht,jt[Xt]=Kt)},field(Kt){const Xt=Ct(Kt);return Ft[Xt]||(Ft[Xt]=++zt)},param(Kt){return is(Literal$1,Kt)?Kt.value:kt.param(Ct(Kt),Mt)},value(Kt,Xt){Bt.push(Kt);const Qt=Xt.escape||($t.ast?clean(Xt):Gt(Ct(Xt),Mt));Vt.push(Qt),ANNOTATE[Xt.type]&&Qt!==Xt&&isObject$4(Qt)&&(Qt.field=Xt.name)},error(Kt,Xt,Qt=""){const Jt=Kt.start-6,Zt=Kt.end-6,sn=String(qt.spec).slice(Jt,Zt);error$k(`${Xt}: "${sn}"${Qt}`)}};Object.assign(qt,$t,{params:Mt});for(const[Kt,Xt]of entries$2(xt))qt.value(Kt+"",Xt.escape?parseEscape(qt,Xt,Mt):parseExpression$2(qt,Xt));if($t.ast)return{names:Bt,exprs:Vt};const Wt=[];for(const Kt in Ft)Wt[Ft[Kt]]=kt.expr(Kt,Mt);const Yt=Object.values(jt);return Yt.forEach(Kt=>Kt.fields=Kt.fields.map(Xt=>Wt[Xt])),{names:Bt,exprs:Vt,ops:Yt}}function opKey(xt){let $t=`${xt.name}(${xt.fields.concat(xt.params).join(",")})`;if(xt.frame){const Ct=xt.frame.map(kt=>Number.isFinite(kt)?Math.abs(kt):-1);$t+=`[${Ct},${!!xt.peers}]`}return $t}function getParams(xt){return(xt.table?getTableParams(xt.table):xt.join?{...getTableParams(xt.join[1]),...getTableParams(xt.join[0])}:{})||{}}function getTableParams(xt){return xt&&isFunction$3(xt.params)?xt.params():{}}const Expr="Expr",ExprList="ExprList",ExprNumber="ExprNumber",ExprObject="ExprObject",JoinKeys="JoinKeys",JoinValues="JoinValues",Options="Options",OrderbyKeys="OrderKeys",SelectionList="SelectionList",TableRef="TableRef",TableRefList="TableRefList",Descending$1="Descending",Query$2="Query",Selection="Selection",Verb$1="Verb",Window$1="Window";function wrap$2(xt,$t){return xt&&xt.expr?new Wrapper({...xt,...$t}):new Wrapper($t,xt)}class Wrapper{constructor($t,Ct){this.expr=Ct,Object.assign(this,$t)}toString(){return String(this.expr)}toObject(){return{...this,expr:this.toString(),...isFunction$3(this.expr)?{func:!0}:{}}}}function desc(xt){return wrap$2(xt,{desc:!0})}function field$2(xt,$t,Ct=0){const kt=Ct?{field:!0,table:Ct}:{field:!0};return wrap$2(xt,$t?{expr:$t,...kt}:kt)}function rolling(xt,$t,Ct){return wrap$2(xt,{window:{frame:$t||[-1/0,0],peers:!!Ct}})}function func(xt){const $t=Ct=>Ct;return $t.toString=()=>xt,$t}function getTable(xt,$t){return $t=$t&&isFunction$3($t.query)?$t.query():$t,$t&&isFunction$3($t.evaluate)?$t.evaluate(null,xt):xt($t)}function isSelection(xt){return isObject$4(xt)&&(isArray$3(xt.all)||isArray$3(xt.matches)||isArray$3(xt.not)||isArray$3(xt.range))}function toObject(xt){return xt&&isFunction$3(xt.toObject)?xt.toObject():isFunction$3(xt)?{expr:String(xt),func:!0}:isArray$3(xt)?xt.map(toObject):isObject$4(xt)?map$1(xt,$t=>toObject($t)):xt}function fromObject(xt){return isArray$3(xt)?xt.map(fromObject):isObject$4(xt)?isArray$3(xt.verbs)?Query$1.from(xt):isArray$3(xt.all)?all():isArray$3(xt.range)?range$4(...xt.range):isArray$3(xt.match)?matches$1(RegExp(...xt.match)):isArray$3(xt.not)?not$1(xt.not.map(toObject)):fromExprObject(xt):xt}function fromExprObject(xt){let $t=xt,Ct=xt.expr;if(Ct!=null){if(xt.field===!0?$t=Ct=field$2(Ct):xt.func===!0&&($t=Ct=func(Ct)),isObject$4(xt.window)){const{frame:kt,peers:Mt}=xt.window;$t=Ct=rolling(Ct,kt,Mt)}xt.desc===!0&&($t=desc(Ct))}return xt===$t?map$1(xt,kt=>fromObject(kt)):$t}function joinKeys(xt){return isArray$3(xt)?xt.map(parseJoinKeys):xt}function parseJoinKeys(xt){const $t=[];return toArray(xt).forEach(Ct=>{isNumber$2(Ct)?$t.push(Ct):isString$2(Ct)?$t.push(field$2(Ct,null)):isObject$4(Ct)&&Ct.expr||isFunction$3(Ct)?$t.push(Ct):error$k(`Invalid key value: ${Ct+""}`)}),$t}function joinValues(xt){return isArray$3(xt)?xt.map(parseJoinValues):xt}function parseJoinValues(xt,$t){return $t<2?toArray(xt):xt}function orderbyKeys(xt){const $t=[];return xt.forEach(Ct=>{const kt=Ct.expr!=null?Ct.expr:Ct;if(isObject$4(kt)&&!isFunction$3(kt))for(const Mt in kt)$t.push(kt[Mt]);else Ct=isNumber$2(kt)?kt:isString$2(kt)?field$2(Ct):isFunction$3(kt)?Ct:error$k(`Invalid orderby field: ${Ct+""}`),$t.push(Ct)}),$t}const Methods$2={[Expr]:astExpr,[ExprList]:astExprList,[ExprNumber]:astExprNumber,[ExprObject]:astExprObject,[JoinKeys]:astJoinKeys,[JoinValues]:astJoinValues,[OrderbyKeys]:astExprList,[SelectionList]:astSelectionList};function toAST(xt,$t,Ct){return $t===TableRef?astTableRef(xt):$t===TableRefList?xt.map(astTableRef):ast(toObject(xt),$t,Ct)}function ast(xt,$t,Ct){return $t===Options?xt&&astOptions(xt,Ct):Methods$2[$t](xt)}function astOptions(xt,$t={}){const Ct={};for(const kt in xt){const Mt=xt[kt];Ct[kt]=$t[kt]?ast(Mt,$t[kt]):Mt}return Ct}function astParse(xt,$t){return parse$a({expr:xt},{...$t,ast:!0}).exprs[0]}function astColumn(xt){return{type:Column$1,name:xt}}function astColumnIndex(xt){return{type:Column$1,index:xt}}function astExprObject(xt,$t){if(isString$2(xt))return astParse(xt,$t);if(xt.expr){let Ct;if(xt.field===!0?Ct=astColumn(xt.expr):xt.func===!0&&(Ct=astExprObject(xt.expr,$t)),Ct)return xt.desc&&(Ct={type:Descending$1,expr:Ct}),xt.window&&(Ct={type:Window$1,expr:Ct,...xt.window}),Ct}return Object.keys(xt).map(Ct=>({...astExprObject(xt[Ct],$t),as:Ct}))}function astSelection(xt){const $t=Selection;return xt.all?{type:$t,operator:"all"}:xt.not?{type:$t,operator:"not",arguments:astExprList(xt.not)}:xt.range?{type:$t,operator:"range",arguments:astExprList(xt.range)}:xt.matches?{type:$t,operator:"matches",arguments:xt.matches}:error$k("Invalid input")}function astSelectionList(xt){return toArray(xt).map(astSelectionItem).flat()}function astSelectionItem(xt){return isSelection(xt)?astSelection(xt):isNumber$2(xt)?astColumnIndex(xt):isString$2(xt)?astColumn(xt):isObject$4(xt)?Object.keys(xt).map($t=>({type:Column$1,name:$t,as:xt[$t]})):error$k("Invalid input")}function astExpr(xt){return isSelection(xt)?astSelection(xt):isNumber$2(xt)?astColumnIndex(xt):isString$2(xt)?astColumn(xt):isObject$4(xt)?astExprObject(xt):error$k("Invalid input")}function astExprList(xt){return toArray(xt).map(astExpr).flat()}function astExprNumber(xt){return isNumber$2(xt)?xt:astExprObject(xt)}function astJoinKeys(xt){return isArray$3(xt)?xt.map(astExprList):astExprObject(xt,{join:!0})}function astJoinValues(xt){return isArray$3(xt)?xt.map(($t,Ct)=>Ct<2?astExprList($t):astExprObject($t,{join:!0})):astExprObject(xt,{join:!0})}function astTableRef(xt){return xt&&isFunction$3(xt.toAST)?xt.toAST():xt}class Verb{constructor($t,Ct=[],kt=[]){this.verb=$t,this.schema=Ct,Ct.forEach((Mt,Ft)=>{const jt=Mt.type,Bt=kt[Ft],Vt=jt===JoinKeys?joinKeys(Bt):jt===JoinValues?joinValues(Bt):jt===OrderbyKeys?orderbyKeys(Bt):Bt;this[Mt.name]=Vt!==void 0?Vt:Mt.default})}static from($t){const Ct=Verbs[$t.verb],kt=(Ct.schema||[]).map(({name:Mt})=>fromObject($t[Mt]));return Ct(...kt)}evaluate($t,Ct){const kt=this.schema.map(({name:Mt,type:Ft})=>{const jt=this[Mt];return Ft===TableRef?getTable(Ct,jt):Ft===TableRefList?jt.map(Bt=>getTable(Ct,Bt)):jt});return $t[this.verb](...kt)}toObject(){const $t={verb:this.verb};return this.schema.forEach(({name:Ct})=>{$t[Ct]=toObject(this[Ct])}),$t}toAST(){const $t={type:Verb$1,verb:this.verb};return this.schema.forEach(({name:Ct,type:kt,props:Mt})=>{$t[Ct]=toAST(this[Ct],kt,Mt)}),$t}}function createVerb(xt,$t){return Object.assign((...Ct)=>new Verb(xt,$t,Ct),{schema:$t})}const Verbs={count:createVerb("count",[{name:"options",type:Options}]),derive:createVerb("derive",[{name:"values",type:ExprObject},{name:"options",type:Options,props:{before:SelectionList,after:SelectionList}}]),filter:createVerb("filter",[{name:"criteria",type:ExprObject}]),groupby:createVerb("groupby",[{name:"keys",type:ExprList}]),orderby:createVerb("orderby",[{name:"keys",type:OrderbyKeys}]),relocate:createVerb("relocate",[{name:"columns",type:SelectionList},{name:"options",type:Options,props:{before:SelectionList,after:SelectionList}}]),rename:createVerb("rename",[{name:"columns",type:SelectionList}]),rollup:createVerb("rollup",[{name:"values",type:ExprObject}]),sample:createVerb("sample",[{name:"size",type:ExprNumber},{name:"options",type:Options,props:{weight:Expr}}]),select:createVerb("select",[{name:"columns",type:SelectionList}]),ungroup:createVerb("ungroup"),unorder:createVerb("unorder"),reify:createVerb("reify"),dedupe:createVerb("dedupe",[{name:"keys",type:ExprList,default:[]}]),impute:createVerb("impute",[{name:"values",type:ExprObject},{name:"options",type:Options,props:{expand:ExprList}}]),fold:createVerb("fold",[{name:"values",type:ExprList},{name:"options",type:Options}]),pivot:createVerb("pivot",[{name:"keys",type:ExprList},{name:"values",type:ExprList},{name:"options",type:Options}]),spread:createVerb("spread",[{name:"values",type:ExprList},{name:"options",type:Options}]),unroll:createVerb("unroll",[{name:"values",type:ExprList},{name:"options",type:Options,props:{drop:ExprList}}]),lookup:createVerb("lookup",[{name:"table",type:TableRef},{name:"on",type:JoinKeys},{name:"values",type:ExprList}]),join:createVerb("join",[{name:"table",type:TableRef},{name:"on",type:JoinKeys},{name:"values",type:JoinValues},{name:"options",type:Options}]),cross:createVerb("cross",[{name:"table",type:TableRef},{name:"values",type:JoinValues},{name:"options",type:Options}]),semijoin:createVerb("semijoin",[{name:"table",type:TableRef},{name:"on",type:JoinKeys}]),antijoin:createVerb("antijoin",[{name:"table",type:TableRef},{name:"on",type:JoinKeys}]),concat:createVerb("concat",[{name:"tables",type:TableRefList}]),union:createVerb("union",[{name:"tables",type:TableRefList}]),intersect:createVerb("intersect",[{name:"tables",type:TableRefList}]),except:createVerb("except",[{name:"tables",type:TableRefList}])};let Query$1=class lp extends Transformable{constructor($t,Ct,kt){super(Ct),this._verbs=$t||[],this._table=kt}static from({verbs:$t,table:Ct,params:kt}){return new lp($t.map(Verb.from),kt,Ct)}get[Symbol.toStringTag](){return this._verbs?`Query: ${this._verbs.length} verbs`+(this._table?` on '${this._table}'`:""):"Object"}get length(){return this._verbs.length}get tableName(){return this._table}params($t){return arguments.length?(this._params={...this._params,...$t},this):this._params}evaluate($t,Ct){$t=$t||Ct(this._table);for(const kt of this._verbs)$t=kt.evaluate($t.params(this._params),Ct);return $t}toObject(){return serialize(this,"toObject")}toJSON(){return this.toObject()}toAST(){return serialize(this,"toAST",{type:Query$2})}};function serialize(xt,$t,Ct){return{...Ct,verbs:xt._verbs.map(kt=>kt[$t]()),...xt._params?{params:xt._params}:null,...xt._table?{table:xt._table}:null}}function append(xt,$t){return new Query$1(xt._verbs.concat($t),xt._params,xt._table)}for(const xt in Verbs){const $t=Verbs[xt];Query$1.prototype["__"+xt]=function(Ct,...kt){return append(Ct,$t(...kt))}}function unroll(xt,$t,...Ct){const kt=["_","$"],Mt=kt.slice(0,Ct.length);return Mt.push('"use strict"; const '+Ct.map((Ft,jt)=>Ft.map((Bt,Vt)=>`${kt[jt]}${Vt} = ${kt[jt]}[${Vt}]`).join(", ")).join(", ")+`; return (${xt}) => ${$t};`),Function(...Mt)(...Ct)}function __dedupe(xt,$t=[]){return xt.groupby($t.length?$t:xt.columnNames()).filter("row_number() === 1").ungroup().reify()}function _select(xt,$t){const Ct=columnSet();return $t.forEach((kt,Mt)=>{const Ft=isString$2(kt)?kt:Mt;if(Ft){const jt=xt.column(Mt)||error$k(`Unrecognized column: ${Mt}`);Ct.add(Ft,jt)}}),xt.create(Ct)}function __relocate(xt,$t,{before:Ct,after:kt}={}){const Mt=Ct!=null,Ft=kt!=null;Mt||Ft||error$k("relocate requires a before or after option."),Mt&&Ft&&error$k("relocate accepts only one of the before or after options."),$t=resolve$3(xt,$t);const jt=[...resolve$3(xt,Mt?Ct:kt).keys()],Bt=Mt?jt[0]:jt.pop(),Vt=new Map;return xt.columnNames().forEach(zt=>{const Ht=!$t.has(zt);if(zt===Bt){Ft&&Ht&&Vt.set(zt,zt);for(const[Gt,qt]of $t)Vt.set(Gt,qt);if(Ft)return}Ht&&Vt.set(zt,zt)}),_select(xt,Vt)}function concat(xt,$t=kt=>kt,Ct=""){const kt=xt.length;if(!kt)return"";let Mt=$t(xt[0],0);for(let Ft=1;Ft<kt;++Ft)Mt+=Ct+$t(xt[Ft],Ft);return Mt}function ascending$2(xt,$t){return xt<$t?-1:xt>$t?1:xt>=$t?0:NaN}function min$1(xt,$t=0,Ct=xt.length){let kt=Ct?xt[$t++]:NULL$1;for(let Mt=$t;Mt<Ct;++Mt)kt>xt[Mt]&&(kt=xt[Mt]);return kt}function max$1(xt,$t=0,Ct=xt.length){let kt=Ct?xt[$t++]:NULL$1;for(let Mt=$t;Mt<Ct;++Mt)kt<xt[Mt]&&(kt=xt[Mt]);return kt}function toNumeric(xt){return isBigInt(xt)?xt:+xt}function quantile(xt,$t){const Ct=xt.length;if(!Ct)return NULL$1;if(($t=+$t)<=0||Ct<2)return toNumeric(xt[0]);if($t>=1)return toNumeric(xt[Ct-1]);const kt=(Ct-1)*$t,Mt=Math.floor(kt),Ft=toNumeric(xt[Mt]);return isBigInt(Ft)?Ft:Ft+(toNumeric(xt[Mt+1])-Ft)*(kt-Mt)}class ValueList{constructor($t){this._values=$t||[],this._sorted=null,this._start=0}values($t){return this._start&&(this._values=this._values.slice(this._start),this._start=0),$t?this._values.slice():this._values}add($t){this._values.push($t),this._sorted=null}rem(){this._start+=1,this._sorted=null}min(){return this._sorted&&this._sorted.length?this._sorted[0]:min$1(this._values,this._start)}max(){return this._sorted&&this._sorted.length?this._sorted[this._sorted.length-1]:max$1(this._values,this._start)}quantile($t){return this._sorted||(this._sorted=this.values(!0),this._sorted.sort(ascending$2)),quantile(this._sorted,$t)}}const update$7=(xt,$t,Ct)=>unroll($t,"{"+concat(xt,(kt,Mt)=>`_${Mt}.${Ct}(${$t});`)+"}",xt);function fieldReducer(xt,$t){const{ops:Ct,output:kt}=expand$1(xt,$t),Mt=xt[0].fields,Ft=Mt.length,jt=Ft===0?FieldReducer:Ft===1?Field1Reducer:Ft===2?Field2Reducer:error$k("Unsupported field count: "+Ft);return new jt(Mt,Ct,kt,$t)}function expand$1(xt,$t){const Ct={},kt=[];function Mt(jt,Bt=[]){const Vt=jt+":"+Bt;if(Ct[Vt])return Ct[Vt];const zt=getAggregate(jt),Ht=zt.create(...Bt);return $t<0&&zt.stream&&zt.stream.forEach(Gt=>Mt(Gt,[])),zt.req&&zt.req.forEach(Gt=>Mt(Gt,[])),Ct[Vt]=Ht,kt.push(Ht),Ht}const Ft=xt.map(jt=>{const Bt=Mt(jt.name,jt.params);return Bt.output=jt.id,Bt});return{ops:kt,output:Ft}}class FieldReducer extends Reducer{constructor($t,Ct,kt,Mt){super(kt),this._op=Ct,this._fields=$t,this._stream=!!Mt}init(){const $t={count:0,valid:0,stream:this._stream};return this._op.forEach(Ct=>Ct.init($t)),$t.values&&($t.list=new ValueList),$t}write($t,Ct,kt){const Mt=this._outputs,Ft=Mt.length;for(let jt=0;jt<Ft;++jt)Ct[Mt[jt].output][kt]=Mt[jt].value($t);return 1}_add(){}_rem(){}add($t){++$t.count}rem($t){--$t.count}}class Field1Reducer extends FieldReducer{constructor($t,Ct,kt,Mt){super($t,Ct,kt,Mt);const Ft=["state","v1","v2"];this._add=update$7(Ct,Ft,"add"),this._rem=update$7(Ct,Ft,"rem")}add($t,Ct,kt){const Mt=this._fields[0](Ct,kt);++$t.count,isValid$2(Mt)&&(++$t.valid,$t.list&&$t.list.add(Mt),this._add($t,Mt))}rem($t,Ct,kt){const Mt=this._fields[0](Ct,kt);--$t.count,isValid$2(Mt)&&(--$t.valid,$t.list&&$t.list.rem(),this._rem($t,Mt))}}class Field2Reducer extends FieldReducer{constructor($t,Ct,kt,Mt){super($t,Ct,kt,Mt);const Ft=["state","v1","v2"];this._add=update$7(Ct,Ft,"add"),this._rem=update$7(Ct,Ft,"rem")}add($t,Ct,kt){const Mt=this._fields[0](Ct,kt),Ft=this._fields[1](Ct,kt);++$t.count,isValid$2(Mt)&&isValid$2(Ft)&&(++$t.valid,$t.list&&$t.list.add([Mt,Ft]),this._add($t,Mt,Ft))}rem($t,Ct,kt){const Mt=this._fields[0](Ct,kt),Ft=this._fields[1](Ct,kt);--$t.count,isValid$2(Mt)&&isValid$2(Ft)&&(--$t.valid,$t.list&&$t.list.rem(),this._rem($t,Mt,Ft))}}function aggregateGet(xt,$t,Ct){if($t.length){const kt=xt.data(),{keys:Mt}=xt.groups()||{},Ft=aggregate(xt,$t),jt=Mt?(Bt,Vt)=>Ft[Bt][Mt[Vt]]:Bt=>Ft[Bt][0];Ct=Ct.map(Bt=>Vt=>Bt(Vt,kt,jt))}return Ct}function aggregate(xt,$t,Ct){if(!$t.length)return Ct;const kt=reducers($t),Mt=xt.groups(),Ft=Mt?Mt.size:1;return Ct=Ct||repeat$1($t.length,()=>Array(Ft)),Ft>1?kt.forEach(jt=>{const Bt=reduceGroups(xt,jt,Mt);for(let Vt=0;Vt<Ft;++Vt)jt.write(Bt[Vt],Ct,Vt)}):kt.forEach(jt=>{const Bt=reduceFlat(xt,jt);jt.write(Bt,Ct,0)}),Ct}function reducers(xt,$t){const Ct=[],kt={};for(const Mt of xt){const Ft=Mt.fields.map(jt=>jt+"").join(",");(kt[Ft]||(kt[Ft]=[])).push(Mt)}for(const Mt in kt)Ct.push(fieldReducer(kt[Mt],$t));return Ct}function reduceFlat(xt,$t){const Ct=$t.init(),kt=xt.totalRows(),Mt=xt.data(),Ft=xt.mask();if(xt.isOrdered()){const jt=xt.indices();for(let Bt=0;Bt<kt;++Bt)$t.add(Ct,jt[Bt],Mt)}else if(Ft)for(let jt=Ft.next(0);jt>=0;jt=Ft.next(jt+1))$t.add(Ct,jt,Mt);else for(let jt=0;jt<kt;++jt)$t.add(Ct,jt,Mt);return Ct}function reduceGroups(xt,$t,Ct){const{keys:kt,size:Mt}=Ct,Ft=repeat$1(Mt,()=>$t.init()),jt=xt.data();if(xt.isOrdered()){const Bt=xt.indices(),Vt=Bt.length;for(let zt=0;zt<Vt;++zt){const Ht=Bt[zt];$t.add(Ft[kt[Ht]],Ht,jt)}}else if(xt.isFiltered()){const Bt=xt.mask();for(let Vt=Bt.next(0);Vt>=0;Vt=Bt.next(Vt+1))$t.add(Ft[kt[Vt]],Vt,jt)}else{const Bt=xt.totalRows();for(let Vt=0;Vt<Bt;++Vt)$t.add(Ft[kt[Vt]],Vt,jt)}return Ft}function groupOutput(xt,$t){const{get:Ct,names:kt,rows:Mt,size:Ft}=$t,jt=kt.length;for(let Bt=0;Bt<jt;++Bt){const Vt=xt.add(kt[Bt],Array(Ft)),zt=Ct[Bt];for(let Ht=0;Ht<Ft;++Ht)Vt[Ht]=zt(Mt[Ht])}}function bisector(xt){return{left($t,Ct,kt,Mt){for(kt==null&&(kt=0),Mt==null&&(Mt=$t.length);kt<Mt;){const Ft=kt+Mt>>>1;xt($t[Ft],Ct)<0?kt=Ft+1:Mt=Ft}return kt},right($t,Ct,kt,Mt){for(kt==null&&(kt=0),Mt==null&&(Mt=$t.length);kt<Mt;){const Ft=kt+Mt>>>1;xt($t[Ft],Ct)>0?Mt=Ft:kt=Ft+1}return kt}}}const bisect$1=bisector(ascending$2);function windowState(xt,$t,Ct,kt,Mt){let Ft,jt,Bt,Vt,zt;const Ht=Kt=>jt[Kt-1]===jt[Kt],Gt=kt.length,qt=Mt.length,Wt=kt.length?unroll(["w","r","k"],"{"+concat(kt,(Kt,Xt)=>`r[_${Xt}.id][k]=_${Xt}.value(w,_${Xt}.get);`)+"}",kt):()=>{},Yt={i0:0,i1:0,index:0,size:0,peer:Ht,init(Kt,Xt,Qt,Jt){Yt.index=Yt.i0=Yt.i1=0,Yt.size=Xt.length,Ft=Kt,jt=Xt,Vt=Qt,zt=Jt,Bt=Mt?Mt.map(Zt=>Zt.init()):null;for(let Zt=0;Zt<Gt;++Zt)kt[Zt].init();return Yt},value(Kt,Xt){return Xt(Ft[Kt],xt)},step(Kt){const[Xt,Qt]=$t,Jt=Yt.size,Zt=Yt.i0,sn=Yt.i1;Yt.i0=Xt!=null?Math.max(0,Kt-Math.abs(Xt)):0,Yt.i1=Qt!=null?Math.min(Jt,Kt+Math.abs(Qt)+1):Jt,Yt.index=Kt,Ct&&(Yt.i0>0&&Ht(Yt.i0)&&(Yt.i0=bisect$1.left(jt,jt[Yt.i0])),Yt.i1<Jt&&Ht(Yt.i1)&&(Yt.i1=bisect$1.right(jt,jt[Yt.i1-1])));for(let ln=0;ln<qt;++ln){const dn=Mt[ln],hn=Bt[ln];for(let cn=Zt;cn<Yt.i0;++cn)dn.rem(hn,Ft[cn],xt);for(let cn=sn;cn<Yt.i1;++cn)dn.add(hn,Ft[cn],xt);dn.write(hn,Vt,zt)}return Wt(Yt,Vt,zt),Vt}};return Yt}const frameValue=xt=>(xt.frame||[null,null]).map($t=>Number.isFinite($t)?Math.abs($t):null),peersValue=xt=>!!xt.peers;function windowOp(xt){const{id:$t,name:Ct,fields:kt=[],params:Mt=[]}=xt,Ft=getWindow(Ct).create(...Mt);return kt.length&&(Ft.get=kt[0]),Ft.id=$t,Ft}function window$1(xt,$t,Ct,kt={},Mt){const Ft=xt.data(),jt=windowStates(Mt,Ft),Bt=jt.length,Vt=unroll(["r","d","op"],"{"+concat($t,(zt,Ht)=>`_${Ht}[r] = $${Ht}(r, d, op);`)+"}",$t,Ct);xt.partitions().forEach((zt,Ht)=>{const Gt=zt.length,qt=windowPeers(xt,zt);for(let Yt=0;Yt<Bt;++Yt)jt[Yt].init(zt,qt,kt,Ht);const Wt=Yt=>kt[Yt][Ht];for(let Yt=0;Yt<Gt;++Yt){for(let Kt=0;Kt<Bt;++Kt)jt[Kt].step(Yt);Vt(zt[Yt],Ft,Wt)}})}function windowStates(xt,$t){const Ct={};return xt.forEach(kt=>{const Mt=frameValue(kt),Ft=peersValue(kt),jt=`${Mt},${Ft}`,{aggOps:Bt,winOps:Vt}=Ct[jt]||(Ct[jt]={frame:Mt,peers:Ft,aggOps:[],winOps:[]});hasAggregate(kt.name)?Bt.push(kt):Vt.push(windowOp(kt))}),Object.values(Ct).map(kt=>windowState($t,kt.frame,kt.peers,kt.winOps,reducers(kt.aggOps,kt.frame[0]!=null?-1:1)))}function windowPeers(xt,$t){if(xt.isOrdered()){const Ct=xt.comparator(),kt=xt.data(),Mt=$t.length,Ft=new Uint32Array(Mt);for(let jt=1,Bt=0;jt<Mt;++jt)Ft[jt]=Ct($t[jt-1],$t[jt],kt)?++Bt:Bt;return Ft}else return $t}function isWindowed(xt){return hasWindow(xt.name)||xt.frame&&(Number.isFinite(xt.frame[0])||Number.isFinite(xt.frame[1]))}function _derive(xt,{names:$t,exprs:Ct,ops:kt},Mt={}){const Ft=xt.totalRows(),jt=columnSet(Mt.drop?null:xt),Bt=$t.map(qt=>jt.add(qt,Array(Ft))),[Vt,zt]=segmentOps(kt),Ht=xt.isGrouped()?xt.groups().size:1,Gt=aggregate(xt,Vt,repeat$1(kt.length,()=>Array(Ht)));return zt.length?window$1(xt,Bt,Ct,Gt,zt):output$4(xt,Bt,Ct,Gt),xt.create(jt)}function segmentOps(xt){const $t=[],Ct=[],kt=xt.length;for(let Mt=0;Mt<kt;++Mt){const Ft=xt[Mt];Ft.id=Mt,(isWindowed(Ft)?Ct:$t).push(Ft)}return[$t,Ct]}function output$4(xt,$t,Ct,kt){const Mt=xt.mask(),Ft=xt.data(),{keys:jt}=xt.groups()||{},Bt=jt?(zt,Ht)=>kt[zt][jt[Ht]]:zt=>kt[zt][0],Vt=$t.length;for(let zt=0;zt<Vt;++zt){const Ht=Ct[zt],Gt=$t[zt];if(Mt)for(let qt=Mt.next(0);qt>=0;qt=Mt.next(qt+1))Gt[qt]=Ht(qt,Ft,Bt);else{const qt=xt.totalRows();for(let Wt=0;Wt<qt;++Wt)Gt[Wt]=Ht(Wt,Ft,Bt)}}}function __derive(xt,$t,Ct={}){const kt=_derive(xt,parse$a($t,{table:xt}),Ct);return Ct.drop||Ct.before==null&&Ct.after==null?kt:__relocate(kt,Object.keys($t).filter(Mt=>!xt.column(Mt)),Ct)}function __except(xt,$t){if($t.length===0)return xt;const Ct=xt.columnNames();return $t.reduce((kt,Mt)=>kt.antijoin(Mt.select(Ct)),xt).dedupe()}const ONE=2147483648,ALL$1=4294967295;class BitSet{constructor($t){this._size=$t,this._bits=new Uint32Array(Math.ceil($t/32))}get length(){return this._size}count(){const $t=this._bits.length;let Ct=0;for(let kt=0;kt<$t;++kt)for(let Mt=this._bits[kt];Mt;++Ct)Mt&=Mt-1;return Ct}get($t){return this._bits[$t>>5]&ONE>>>$t}set($t){this._bits[$t>>5]|=ONE>>>$t}clear($t){this._bits[$t>>5]&=~(ONE>>>$t)}scan($t){for(let Ct=this.next(0);Ct>=0;Ct=this.next(Ct+1))$t(Ct)}next($t){const Ct=this._bits,kt=Ct.length;let Mt=$t>>5,Ft=Ct[Mt]&ALL$1>>>$t;for(;Mt<kt;Ft=Ct[++Mt])if(Ft!==0)return(Mt<<5)+Math.clz32(Ft);return-1}nth($t){let Ct=this.next(0);for(;$t--&&Ct>=0;)Ct=this.next(Ct+1);return Ct}not(){const $t=this._bits,Ct=$t.length;for(let Mt=0;Mt<Ct;++Mt)$t[Mt]=~$t[Mt];const kt=this._size%32;return kt&&($t[Ct-1]&=ONE>>kt-1),this}and($t){if($t){const Ct=this._bits,kt=$t._bits,Mt=Ct.length;for(let Ft=0;Ft<Mt;++Ft)Ct[Ft]&=kt[Ft]}return this}or($t){if($t){const Ct=this._bits,kt=$t._bits,Mt=Ct.length;for(let Ft=0;Ft<Mt;++Ft)Ct[Ft]|=kt[Ft]}return this}}function _filter(xt,$t){const Ct=xt.totalRows(),kt=xt.mask(),Mt=xt.data(),Ft=new BitSet(Ct);if(kt)for(let jt=kt.next(0);jt>=0;jt=kt.next(jt+1))$t(jt,Mt)&&Ft.set(jt);else for(let jt=0;jt<Ct;++jt)$t(jt,Mt)&&Ft.set(jt);return xt.create({filter:Ft})}function __filter(xt,$t){const Ct=parse$a({p:$t},{table:xt});let kt=Ct.exprs[0];if(Ct.ops.length){const{data:Mt}=_derive(xt,Ct,{drop:!0}).column("p");kt=Ft=>Mt[Ft]}return _filter(xt,kt)}function _unroll(xt,{names:$t=[],exprs:Ct=[],ops:kt=[]},Mt={}){if(!$t.length)return xt;const Ft=Mt.limit>0?+Mt.limit:1/0,jt=Mt.index?Mt.index===!0?"index":Mt.index+"":null,Bt=new Set(Mt.drop),Vt=aggregateGet(xt,kt,Ct),zt=columnSet(),Ht=new Set($t),Gt=[],qt=[],Wt=[];xt.columnNames().forEach(sn=>{if(!Bt.has(sn)){const ln=zt.add(sn,[]);Ht.has(sn)||(Gt.push(xt.column(sn)),qt.push(ln))}}),$t.forEach(sn=>{Bt.has(sn)||(zt.has(sn)||zt.add(sn,[]),Wt.push(zt.data[sn]))});const Yt=jt?zt.add(jt,[]):null;let Kt=0;const Xt=Gt.length,Qt=Wt.length,Jt=(sn,ln)=>{for(let dn=0;dn<Xt;++dn)qt[dn].length=Kt+ln,qt[dn].fill(Gt[dn].get(sn),Kt,Kt+ln)},Zt=Yt?(sn,ln)=>{for(let dn=0;dn<ln;++dn)Yt[sn+dn]=dn}:()=>{};if(Qt===1){const sn=Vt[0],ln=Wt[0];xt.scan((dn,hn)=>{const cn=toArray(sn(dn,hn)),pn=Math.min(cn.length,Ft);Jt(dn,pn);for(let yn=0;yn<pn;++yn)ln[Kt+yn]=cn[yn];Zt(Kt,pn),Kt+=pn})}else xt.scan((sn,ln)=>{let dn=0;const hn=Vt.map(cn=>{const pn=toArray(cn(sn,ln));return dn=Math.min(Math.max(dn,pn.length),Ft),pn});Jt(sn,dn);for(let cn=0;cn<Qt;++cn){const pn=Wt[cn],yn=hn[cn];for(let gn=0;gn<dn;++gn)pn[Kt+gn]=yn[gn]}Zt(Kt,dn),Kt+=dn});return xt.create(zt.new())}function _fold(xt,{names:$t=[],exprs:Ct=[],ops:kt=[]},Mt={}){if($t.length===0)return xt;const[Ft="key",jt="value"]=Mt.as||[],Bt=aggregateGet(xt,kt,Ct);return _unroll(xt,{names:[Ft,jt],exprs:[()=>$t,(Vt,zt)=>Bt.map(Ht=>Ht(Vt,zt))]},{...Mt,drop:$t})}function parse$9(xt,$t,Ct,kt={window:!1}){const Mt=new Map,Ft=jt=>{jt=isNumber$2(jt)?$t.columnName(jt):jt,isString$2(jt)?Mt.set(jt,field$2(jt)):isFunction$3(jt)?resolve$3($t,jt).forEach(Ft):isObject$4(jt)?assign$1(Mt,jt):error$k(`Invalid ${xt} value: ${jt+""}`)};return toArray(Ct).forEach(Ft),kt.preparse&&kt.preparse(Mt),parse$a(Mt,{table:$t,...kt})}function __fold(xt,$t,Ct){return _fold(xt,parse$9("fold",xt,$t),Ct)}function _impute(xt,$t,Ct,kt){const Mt=Ct&&Ct.length;return impute(Mt?expand(xt,Ct,kt):xt,$t,Mt)}function impute(xt,{names:$t,exprs:Ct,ops:kt},Mt){const Ft=aggregateGet(xt,kt,Ct),jt=Mt?null:columnSet(xt),Bt=xt.totalRows();return $t.forEach((Vt,zt)=>{const Ht=xt.column(Vt),Gt=Mt?Ht.data:jt.add(Vt,Array(Bt)),qt=Ft[zt];xt.scan(Wt=>{const Yt=Ht.get(Wt);Gt[Wt]=isValid$2(Yt)?Yt:qt(Wt)})}),Mt?xt:xt.create(jt)}function expand(xt,$t,Ct){const kt=xt.groups(),Mt=xt.data(),Ft=(kt?kt.names:[]).concat($t),jt=(kt?kt.get:[]).concat($t.map(Yt=>xt.getter(Yt))),Bt=new Set,Vt=keyFunction(jt);xt.scan((Yt,Kt)=>Bt.add(Vt(Yt,Kt)));const zt=xt.columnNames(),Ht=columnSet(),Gt=zt.map(Yt=>Ht.add(Yt,[]));zt.forEach((Yt,Kt)=>{const Xt=Mt[Yt],Qt=Gt[Kt];xt.scan(Jt=>Qt.push(Xt.get(Jt)))});const qt=keyFunction(jt.map((Yt,Kt)=>Xt=>Xt[Kt])),Wt=unroll("v","{"+Gt.map((Yt,Kt)=>`_${Kt}.push(v[$${Kt}]);`).join("")+"}",Gt,zt.map(Yt=>Ft.indexOf(Yt)));if(kt){let Yt=kt.keys.length;const Kt=Ct.reduce((Qt,Jt)=>Qt*Jt.length,kt.size),Xt=new Uint32Array(Kt+(Yt-Bt.size));Xt.set(kt.keys),enumerate(kt,Ct,(Qt,Jt)=>{Bt.has(qt(Qt))||(Wt(Qt),Xt[Yt++]=Jt[0])}),Ht.groupby({...kt,keys:Xt})}else enumerate(kt,Ct,Yt=>{Bt.has(qt(Yt))||Wt(Yt)});return xt.create(Ht.new())}function enumerate(xt,$t,Ct){const kt=xt?xt.get.length:0,Mt=xt?1:0,Ft=Mt+$t.length,jt=new Int32Array(Ft),Bt=new Int32Array(Ft),Vt=[];if(xt){const{get:Ht,rows:Gt,size:qt}=xt;jt[0]=qt,Vt.push((Wt,Yt)=>{const Kt=Gt[Yt];for(let Xt=0;Xt<kt;++Xt)Wt[Xt]=Ht[Xt](Kt)})}$t.forEach((Ht,Gt)=>{const qt=Gt+kt;jt[Gt+Mt]=Ht.length,Vt.push((Wt,Yt)=>Wt[qt]=Ht[Yt])});const zt=Array(kt+$t.length);for(let Ht=0;Ht<Ft;++Ht)Vt[Ht](zt,0);Ct(zt,Bt);for(let Ht=Ft-1;Ht>=0;){const Gt=++Bt[Ht];Gt<jt[Ht]?(Vt[Ht](zt,Gt),Ct(zt,Bt),Ht=Ft-1):(Bt[Ht]=0,Vt[Ht](zt,0),--Ht)}}function _rollup(xt,{names:$t,exprs:Ct,ops:kt}){const Mt=columnSet(),Ft=xt.groups();return Ft&&groupOutput(Mt,Ft),output$3($t,Ct,Ft,aggregate(xt,kt),Mt),xt.create(Mt.new())}function output$3(xt,$t,Ct,kt=[],Mt){if(!$t.length)return;const Ft=Ct?Ct.size:1,jt=(Vt,zt)=>kt[Vt][zt],Bt=xt.length;for(let Vt=0;Vt<Bt;++Vt){const zt=$t[Vt];if(zt.field!=null)Mt.add(xt[Vt],kt[zt.field]);else if(Ft>1){const Ht=Mt.add(xt[Vt],Array(Ft));for(let Gt=0;Gt<Ft;++Gt)Ht[Gt]=zt(Gt,null,jt)}else Mt.add(xt[Vt],[zt(0,null,jt)])}}function __impute(xt,$t,Ct={}){if($t=parse$a($t,{table:xt}),$t.names.forEach(kt=>xt.column(kt)?0:error$k(`Invalid impute column ${toString$2(kt)}`)),Ct.expand){const kt={preparse:preparse$1,aggronly:!0},Mt=parse$9("impute",xt,Ct.expand,kt),Ft=_rollup(xt.ungroup(),Mt);return _impute(xt,$t,Mt.names,Mt.names.map(jt=>Ft.get(jt,0)))}else return _impute(xt,$t)}function preparse$1(xt){xt.forEach(($t,Ct)=>$t.field?xt.set(Ct,array_agg_distinct($t+"")):0)}function __intersect(xt,$t){const Ct=xt.columnNames();return $t.length?$t.reduce((kt,Mt)=>kt.semijoin(Mt.select(Ct)),xt).dedupe():xt.reify([])}function rowLookup(xt,$t){const Ct=new Map;return xt.scan((kt,Mt)=>{const Ft=$t(kt,Mt);Ft!=null&&Ft===Ft&&Ct.set(Ft,kt)}),Ct}function indexLookup(xt,$t,Ct){const kt=new Map,Mt=xt.length;for(let Ft=0;Ft<Mt;++Ft){const jt=xt[Ft],Bt=Ct(jt,$t);Bt!=null&&Bt===Bt&&(kt.has(Bt)?kt.get(Bt).push(Ft):kt.set(Bt,[Ft]))}return kt}function emitter(xt,$t){const Ct=["i","a","j","b"];return unroll(Ct,"{"+concat(xt,(kt,Mt)=>`_${Mt}.push($${Mt}(${Ct}));`)+"}",xt,$t)}function _join(xt,$t,Ct,{names:kt,exprs:Mt},Ft={}){const jt=xt.data(),Bt=xt.indices(!1),Vt=Bt.length,zt=new Int32Array(Vt),Ht=$t.data(),Gt=$t.indices(!1),qt=Gt.length,Wt=new Int32Array(qt),Yt=kt.length,Kt=columnSet(),Xt=Array(Yt),Qt=Array(Yt);for(let sn=0;sn<kt.length;++sn)Xt[sn]=Kt.add(kt[sn],[]),Qt[sn]=Mt[sn];const Jt=emitter(Xt,Qt);if((isArray$3(Ct)?hashJoin:loopJoin)(Jt,Ct,jt,Ht,Bt,Gt,zt,Wt,Vt,qt),Ft.left)for(let sn=0;sn<Vt;++sn)zt[sn]||Jt(Bt[sn],jt,-1,Ht);if(Ft.right)for(let sn=0;sn<qt;++sn)Wt[sn]||Jt(-1,jt,Gt[sn],Ht);return xt.create(Kt.new())}function loopJoin(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt,zt){for(let Ht=0;Ht<Vt;++Ht){const Gt=Mt[Ht];for(let qt=0;qt<zt;++qt){const Wt=Ft[qt];$t(Gt,Ct,Wt,kt)&&(xt(Gt,Ct,Wt,kt),jt[Ht]=1,Bt[qt]=1)}}}function hashJoin(xt,[$t,Ct],kt,Mt,Ft,jt,Bt,Vt,zt,Ht){let Gt,qt,Wt,Yt,Kt,Xt,Qt,Jt,Zt=xt;zt>=Ht?(Gt=kt,qt=$t,Wt=Bt,Yt=Ft,Kt=Mt,Xt=Ct,Qt=Vt,Jt=jt):(Gt=Mt,qt=Ct,Wt=Vt,Yt=jt,Kt=kt,Xt=$t,Qt=Bt,Jt=Ft,Zt=(dn,hn,cn,pn)=>xt(cn,pn,dn,hn));const sn=indexLookup(Jt,Kt,Xt),ln=Yt.length;for(let dn=0;dn<ln;++dn){const hn=Yt[dn],cn=sn.get(qt(hn,Gt));if(cn){const pn=cn.length;for(let yn=0;yn<pn;++yn){const gn=cn[yn];Zt(hn,Gt,Jt[gn],Kt),Qt[gn]=1}Wt[dn]=1}}}function parseKey(xt,$t,Ct){const kt=new Map;toArray(Ct).forEach((Ft,jt)=>{Ft=isNumber$2(Ft)?$t.columnName(Ft):Ft,isString$2(Ft)?kt.set(jt,field$2(Ft)):isFunction$3(Ft)||isObject$4(Ft)&&Ft.expr?kt.set(jt,Ft):error$k(`Invalid ${xt} key value: ${Ft+""}`)});const Mt=parse$a(kt,{table:$t,aggregate:!1,window:!1});return keyFunction(Mt.exprs,!0)}function intersect$3(xt,$t){const Ct=new Set($t);return xt.filter(kt=>Ct.has(kt))}function inferKeys(xt,$t,Ct){if(Ct)isString$2(Ct)?Ct=[Ct,Ct]:isArray$3(Ct)&&Ct.length===1&&(Ct=[Ct[0],Ct[0]]);else{const kt=intersect$3(xt.columnNames(),$t.columnNames());kt.length||error$k("Natural join requires shared column names."),Ct=[kt,kt]}return Ct}function keyPredicate(xt,$t,Ct,kt){return Ct.length!==kt.length&&error$k("Mismatched number of join keys"),[parseKey("join",xt,Ct),parseKey("join",$t,kt)]}const OPT_L={aggregate:!1,window:!1},OPT_R={...OPT_L,index:1};function __join(xt,$t,Ct,kt,Mt={}){Ct=inferKeys(xt,$t,Ct);const Ft={join:[xt,$t]};let jt;if(isArray$3(Ct)){const[Bt,Vt]=Ct.map(toArray);jt=keyPredicate(xt,$t,Bt,Vt),kt||(kt=inferValues(xt,Bt,Vt,Mt))}else jt=parse$a({on:Ct},Ft).exprs[0],kt||(kt=[all(),all()]);return _join(xt,$t,jt,parseValues$1(xt,$t,kt,Ft,Mt&&Mt.suffix),Mt)}function inferValues(xt,$t,Ct,kt){const Mt=[];$t.forEach((jt,Bt)=>isString$2(jt)&&jt===Ct[Bt]?Mt.push(jt):0);const Ft=not$1(Mt);if(kt.left&&kt.right){const jt=new Set(Mt);return[xt.columnNames().map(Bt=>{const Vt=`[${toString$2(Bt)}]`;return jt.has(Bt)?{[Bt]:`(a, b) => a${Vt} == null ? b${Vt} : a${Vt}`}:Bt}),Ft]}return kt.right?[Ft,all()]:[all(),Ft]}function parseValues$1(xt,$t,Ct,kt,Mt=[]){if(isArray$3(Ct)){let Ft,jt,Bt,Vt=Ct.length;Ft=jt=Bt={names:[],exprs:[]},Vt--&&(Ft=parse$9("join",xt,Ct[0],kt)),Vt--&&(jt=parse$9("join",$t,Ct[1],OPT_R)),Vt--&&(Bt=parse$a(Ct[2],kt));const zt=new Set,Ht=new Set(Ft.names);return jt.names.forEach(Gt=>{Ht.has(Gt)&&zt.add(Gt)}),zt.size&&(Mt[0]!==""&&rekey(Ft.names,zt,Mt[0]||"_1"),Mt[1]!==""&&rekey(jt.names,zt,Mt[1]||"_2")),{names:Ft.names.concat(jt.names,Bt.names),exprs:Ft.exprs.concat(jt.exprs,Bt.exprs)}}else return parse$a(Ct,kt)}function rekey(xt,$t,Ct){xt.forEach((kt,Mt)=>$t.has(kt)?xt[Mt]=kt+Ct:0)}function _join_filter(xt,$t,Ct,kt={}){const Mt=new BitSet(xt.totalRows());return(isArray$3(Ct)?hashSemiJoin:loopSemiJoin)(Mt,xt,$t,Ct),kt.anti&&Mt.not().and(xt.mask()),xt.create({filter:Mt})}function hashSemiJoin(xt,$t,Ct,[kt,Mt]){const Ft=rowLookup(Ct,Mt);$t.scan((jt,Bt)=>{Ft.get(kt(jt,Bt))>=0&&xt.set(jt)})}function loopSemiJoin(xt,$t,Ct,kt){const Mt=$t.numRows(),Ft=Ct.numRows(),jt=$t.data(),Bt=Ct.data();if($t.isFiltered()||Ct.isFiltered()){const Vt=$t.indices(!1),zt=Ct.indices(!1);for(let Ht=0;Ht<Mt;++Ht){const Gt=Vt[Ht];for(let qt=0;qt<Ft;++qt)if(kt(Gt,jt,zt[qt],Bt)){xt.set(Gt);break}}}else for(let Vt=0;Vt<Mt;++Vt)for(let zt=0;zt<Ft;++zt)if(kt(Vt,jt,zt,Bt)){xt.set(Vt);break}}function __semijoin(xt,$t,Ct,kt){Ct=inferKeys(xt,$t,Ct);const Mt=isArray$3(Ct)?keyPredicate(xt,$t,...Ct.map(toArray)):parse$a({on:Ct},{join:[xt,$t]}).exprs[0];return _join_filter(xt,$t,Mt,kt)}function _lookup(xt,$t,[Ct,kt],{names:Mt,exprs:Ft,ops:jt}){const Bt=columnSet(xt),Vt=xt.totalRows();Mt.forEach(qt=>Bt.add(qt,Array(Vt).fill(NULL$1)));const zt=rowLookup($t,kt),Ht=unroll(["lr","rr","data"],"{"+concat(Mt,(qt,Wt)=>`_[${Wt}][lr] = $[${Wt}](rr, data);`)+"}",Mt.map(qt=>Bt.data[qt]),aggregateGet($t,jt,Ft)),Gt=$t.data();return xt.scan((qt,Wt)=>{const Yt=zt.get(Ct(qt,Wt));Yt>=0&&Ht(qt,Yt,Gt)}),xt.create(Bt)}function __lookup(xt,$t,Ct,kt){return Ct=inferKeys(xt,$t,Ct),_lookup(xt,$t,[parseKey("lookup",xt,Ct[0]),parseKey("lookup",$t,Ct[1])],parse$9("lookup",$t,kt))}const opt=(xt,$t)=>xt??$t;function _pivot(xt,$t,Ct,kt={}){const{keys:Mt,keyColumn:Ft}=pivotKeys$1(xt,$t,kt),jt=opt(kt.valueSeparator,"_"),Bt=Ct.names.length>1?(zt,Ht)=>Ht+jt+Mt[zt]:zt=>Mt[zt],Vt=Mt.map(zt=>aggregate(xt,Ct.ops.map(Ht=>{if(Ht.name==="count"){const qt=Wt=>zt===Ft[Wt]?1:NaN;return qt.toString=()=>zt+":1",{...Ht,name:"sum",fields:[qt]}}const Gt=Ht.fields.map(qt=>{const Wt=(Yt,Kt)=>zt===Ft[Yt]?qt(Yt,Kt):NaN;return Wt.toString=()=>zt+":"+qt,Wt});return{...Ht,fields:Gt}})));return xt.create(output$2(Ct,Bt,xt.groups(),Vt))}function pivotKeys$1(xt,$t,Ct){const kt=Ct.limit>0?+Ct.limit:1/0,Mt=opt(Ct.sort,!0),Ft=opt(Ct.keySeparator,"_"),jt=aggregateGet(xt,$t.ops,$t.exprs),Bt=jt.length===1?jt[0]:(Gt,qt)=>jt.map(Wt=>Wt(Gt,qt)).join(Ft),Vt=Array(xt.totalRows());xt.scan((Gt,qt)=>Vt[Gt]=Bt(Gt,qt));const zt=aggregate(xt.ungroup(),[{id:0,name:"array_agg_distinct",fields:[Gt=>Vt[Gt]],params:[]}])[0][0],Ht=Mt?zt.sort():zt;return{keys:Number.isFinite(kt)?Ht.slice(0,kt):Ht,keyColumn:Vt}}function output$2({names:xt,exprs:$t},Ct,kt,Mt){const Ft=kt?kt.size:1,jt=columnSet(),Bt=Mt.length,Vt=xt.length;let zt;const Ht=(Gt,qt)=>zt[Gt][qt];kt&&groupOutput(jt,kt);for(let Gt=0;Gt<Vt;++Gt){const qt=$t[Gt];if(qt.field!=null)for(let Wt=0;Wt<Bt;++Wt)jt.add(Ct(Wt,xt[Gt]),Mt[Wt][qt.field]);else if(Ft>1)for(let Wt=0;Wt<Bt;++Wt){zt=Mt[Wt];const Yt=jt.add(Ct(Wt,xt[Gt]),Array(Ft));for(let Kt=0;Kt<Ft;++Kt)Yt[Kt]=qt(Kt,null,Ht)}else for(let Wt=0;Wt<Bt;++Wt)zt=Mt[Wt],jt.add(Ct(Wt,xt[Gt]),[qt(0,null,Ht)])}return jt.new()}function __pivot(xt,$t,Ct,kt){return _pivot(xt,parse$9("fold",xt,$t),parse$9("fold",xt,Ct,{preparse,aggronly:!0}),kt)}function preparse(xt){xt.forEach(($t,Ct)=>$t.field?xt.set(Ct,any($t+"")):0)}function __rename(xt,$t){const Ct=new Map;return xt.columnNames(kt=>(Ct.set(kt,kt),0)),_select(xt,resolve$3(xt,$t,Ct))}function __rollup(xt,$t){return _rollup(xt,parse$a($t,{table:xt,aggronly:!0,window:!1}))}function sample(xt,$t,Ct,kt){return($t?kt?sampleRW:sampleRU:kt?sampleNW:sampleNU)(xt.length,xt,Ct,kt)}function sampleRU(xt,$t,Ct){const kt=Ct.length;for(let Mt=0;Mt<xt;++Mt)$t[Mt]=Ct[kt*random$1()|0];return $t}function sampleRW(xt,$t,Ct,kt){const Mt=Ct.length,Ft=new Float64Array(Mt);let jt=0;for(let Vt=0;Vt<Mt;++Vt)Ft[Vt]=jt+=kt(Ct[Vt]);const Bt=bisector(ascending$2).right;for(let Vt=0;Vt<xt;++Vt)$t[Vt]=Ct[Bt(Ft,jt*random$1())];return $t}function sampleNU(xt,$t,Ct){const kt=Ct.length;if(xt>=kt)return Ct;for(let Mt=0;Mt<xt;++Mt)$t[Mt]=Ct[Mt];for(let Mt=xt;Mt<kt;++Mt){const Ft=Mt*random$1();Ft<xt&&($t[Ft|0]=Ct[Mt])}return $t}function sampleNW(xt,$t,Ct,kt){const Mt=Ct.length;if(xt>=Mt)return Ct;const Ft=new Float32Array(Mt),jt=new Uint32Array(Mt);for(let Bt=0;Bt<Mt;++Bt)jt[Bt]=Bt,Ft[Bt]=-Math.log(random$1())/kt(Ct[Bt]);jt.sort((Bt,Vt)=>Ft[Bt]-Ft[Vt]);for(let Bt=0;Bt<xt;++Bt)$t[Bt]=Ct[jt[Bt]];return $t}function _shuffle(xt,$t=0,Ct=xt.length){let kt=Ct-($t=+$t);for(;kt;){const Mt=random$1()*kt--|0,Ft=xt[kt+$t];xt[kt+$t]=xt[Mt+$t],xt[Mt+$t]=Ft}return xt}function _sample(xt,$t,Ct,kt={}){const{replace:Mt,shuffle:Ft}=kt,jt=xt.partitions(!1);let Bt=0;$t=jt.map((Ht,Gt)=>{let qt=$t(Gt);return Bt+=qt=Mt?qt:Math.min(Ht.length,qt),qt});const Vt=new Uint32Array(Bt);let zt=0;return jt.forEach((Ht,Gt)=>{const qt=$t[Gt],Wt=Vt.subarray(zt,zt+=qt);!Mt&&qt===Ht.length?Wt.set(Ht):sample(Wt,Mt,Ht,Ct)}),Ft!==!1&&(jt.length>1||!Mt)&&_shuffle(Vt),xt.reify(Vt)}function __sample(xt,$t,Ct={}){return _sample(xt,parseSize(xt,$t),parseWeight(xt,Ct.weight),Ct)}const get$5=xt=>$t=>xt.get($t)||0;function parseSize(xt,$t){return isNumber$2($t)?()=>$t:get$5(_rollup(xt,parse$a({size:$t},{table:xt,window:!1})).column("size"))}function parseWeight(xt,$t){return $t==null?null:($t=isNumber$2($t)?xt.columnName($t):$t,get$5(isString$2($t)?xt.column($t):_derive(xt,parse$a({w:$t},{table:xt}),{drop:!0}).column("w")))}function __select(xt,$t){return _select(xt,resolve$3(xt,$t))}function _spread(xt,{names:$t,exprs:Ct,ops:kt=[]},Mt={}){if($t.length===0)return xt;const Ft=$t.length===1&&Mt.as||[],jt=Mt.drop==null?!0:!!Mt.drop,Bt=Mt.limit==null?Ft.length||1/0:Math.max(1,+Mt.limit||1),Vt=aggregateGet(xt,kt,Ct),zt=columnSet(),Ht=$t.reduce((qt,Wt,Yt)=>qt.set(Wt,Yt),new Map),Gt=(qt,Wt)=>{const Yt=spread(xt,Vt[qt],Bt),Kt=Yt.length;for(let Xt=0;Xt<Kt;++Xt)zt.add(Ft[Xt]||`${Wt}_${Xt+1}`,Yt[Xt])};return xt.columnNames().forEach(qt=>{Ht.has(qt)?(jt||zt.add(qt,xt.column(qt)),Gt(Ht.get(qt),qt),Ht.delete(qt)):zt.add(qt,xt.column(qt))}),Ht.forEach(Gt),xt.create(zt)}function spread(xt,$t,Ct){const kt=xt.totalRows(),Mt=[];return xt.scan((Ft,jt)=>{const Bt=toArray($t(Ft,jt)),Vt=Math.min(Bt.length,Ct);for(;Mt.length<Vt;)Mt.push(Array(kt).fill(NULL$1));for(let zt=0;zt<Vt;++zt)Mt[zt][Ft]=Bt[zt]}),Mt}function __spread(xt,$t,Ct){return _spread(xt,parse$9("spread",xt,$t),Ct)}function __union(xt,$t){return xt.concat($t).dedupe()}function __unroll(xt,$t,Ct){return _unroll(xt,parse$9("unroll",xt,$t),Ct&&Ct.drop?{...Ct,drop:parse$9("unroll",xt,Ct.drop).names}:Ct)}function _groupby(xt,$t){return xt.create({groups:createGroups(xt,$t)})}function createGroups(xt,{names:$t=[],exprs:Ct=[],ops:kt=[]}){const Mt=$t.length;if(Mt===0)return null;if(Mt===1&&!xt.isFiltered()&&Ct[0].field){const Wt=xt.column(Ct[0].field);if(Wt.groups)return Wt.groups($t)}let Ft=aggregateGet(xt,kt,Ct);const jt=keyFunction(Ft),Bt=xt.totalRows(),Vt=new Uint32Array(Bt),zt={},Ht=[],Gt=xt.data(),qt=xt.mask();if(qt)for(let Wt=qt.next(0);Wt>=0;Wt=qt.next(Wt+1)){const Yt=jt(Wt,Gt)+"",Kt=zt[Yt];Vt[Wt]=Kt??(zt[Yt]=Ht.push(Wt)-1)}else for(let Wt=0;Wt<Bt;++Wt){const Yt=jt(Wt,Gt)+"",Kt=zt[Yt];Vt[Wt]=Kt??(zt[Yt]=Ht.push(Wt)-1)}return kt.length||(Ft=Ft.map(Wt=>Yt=>Wt(Yt,Gt))),{keys:Vt,get:Ft,names:$t,rows:Ht,size:Ht.length}}function __groupby(xt,$t){return _groupby(xt,parse$9("groupby",xt,$t))}function _orderby(xt,$t){return xt.create({order:$t})}const _compare$1=(xt,$t,Ct,kt)=>`((u = ${xt}) < (v = ${$t}) || u == null) && v != null ? ${Ct}
    : (u > v || v == null) && u != null ? ${kt}
    : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${Ct}
    : v !== v && u === u ? ${kt} : `;function parse$8(xt,$t){const Ct=[],kt=[],Mt=[];let Ft=null,jt="0",Bt="0";xt.isGrouped()&&(Ft=xt.groups().keys,jt="ka",Bt="kb");const{ops:Vt}=parse$a($t,{table:xt,value:(Wt,Yt)=>{if(Ct.push(Wt),Yt.escape){const Kt=Xt=>`fn[${Mt.length}](${Xt}, data)`;kt.push([Kt("a"),Kt("b")]),Mt.push(Yt.escape)}else kt.push([codegen$2(Yt,{index:"a",op:jt}),codegen$2(Yt,{index:"b",op:Bt})])},window:!1}),zt=aggregate(xt,Vt),Ht=(Wt,Yt)=>zt[Wt][Yt],Gt=Ct.length;let qt="return (a, b) => {"+(Ht&&xt.isGrouped()?"const ka = keys[a], kb = keys[b];":"")+"let u, v; return ";for(let Wt=0;Wt<Gt;++Wt){const Yt=$t.get(Ct[Wt]).desc?-1:1,[Kt,Xt]=kt[Wt];qt+=_compare$1(Kt,Xt,-Yt,Yt)}return qt+="0;};",Function("op","keys","fn","data",qt)(Ht,Ft,Mt,xt.data())}function __orderby(xt,$t){return _orderby(xt,parseValues(xt,$t))}function parseValues(xt,$t){let Ct=-1;const kt=new Map,Mt=Ft=>kt.set(++Ct+"",Ft);return $t.forEach(Ft=>{const jt=Ft.expr!=null?Ft.expr:Ft;if(isObject$4(jt)&&!isFunction$3(jt))for(const Bt in jt)Mt(jt[Bt]);else Mt(isNumber$2(jt)?field$2(Ft,xt.columnName(jt)):isString$2(jt)?field$2(Ft):isFunction$3(jt)?Ft:error$k(`Invalid orderby field: ${Ft+""}`))}),parse$8(xt,kt)}function __concat(xt,$t){const Ct=xt.numRows(),kt=Ct+$t.reduce((jt,Bt)=>jt+Bt.numRows(),0);if(Ct===kt)return xt;const Mt=[xt,...$t],Ft=columnSet();return xt.columnNames().forEach(jt=>{const Bt=Array(kt);let Vt=0;Mt.forEach(zt=>{const Ht=zt.column(jt)||{get:()=>NULL$1};zt.scan(Gt=>Bt[Vt++]=Ht.get(Gt))}),Ft.add(jt,Bt)}),xt.create(Ft.new())}function __reduce(xt,$t){const Ct=columnSet(),kt=xt.groups(),{get:Mt,names:Ft=[],rows:jt,size:Bt=1}=kt||{},Vt=new Uint32Array(Bt+1);Ft.forEach(qt=>Ct.add(qt,null));const zt=kt?reduceGroups(xt,$t,kt):[reduceFlat(xt,$t)];$t.outputs().map(qt=>Ct.add(qt,[]));const Ht=Vt.length-1;let Gt=0;for(let qt=0;qt<Ht;++qt)Gt+=Vt[qt+1]=$t.write(zt[qt],Ct.data,Vt[qt]);if(kt){const qt=xt.data();Ft.forEach((Wt,Yt)=>{const Kt=Ct.data[Wt]=Array(Gt),Xt=Mt[Yt];for(let Qt=0,Jt=0;Qt<Bt;++Qt)Kt.fill(Xt(jt[Qt],qt),Jt,Jt+=Vt[Qt+1])})}return xt.create(Ct.new())}function __ungroup(xt){return xt.isGrouped()?xt.create({groups:null}):xt}function __unorder(xt){return xt.isOrdered()?xt.create({order:null}):xt}const verbs={__antijoin:(xt,$t,Ct)=>__semijoin(xt,$t,Ct,{anti:!0}),__count:(xt,$t={})=>__rollup(xt,{[$t.as||"count"]:count()}),__cross:(xt,$t,Ct,kt)=>__join(xt,$t,()=>!0,Ct,{...kt,left:!0,right:!0}),__concat,__dedupe,__derive,__except,__filter,__fold,__impute,__intersect,__join,__lookup,__pivot,__relocate,__rename,__rollup,__sample,__select,__semijoin,__spread,__union,__unroll,__groupby,__orderby,__ungroup,__unorder,__reduce};Object.assign(ColumnTable.prototype,verbs);function from(xt,$t){return ColumnTable.from(xt,$t)}function escape$1(xt){return wrap$2(xt,{escape:!0,toString(){error$k("Escaped values can not be serialized.")}})}ColumnTable.prototype;function n(xt){for(var $t=arguments.length,Ct=Array($t>1?$t-1:0),kt=1;kt<$t;kt++)Ct[kt-1]=arguments[kt];throw Error("[Immer] minified error nr: "+xt+(Ct.length?" "+Ct.map(function(Mt){return"'"+Mt+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function r(xt){return!!xt&&!!xt[Q$1]}function t$1(xt){var $t;return!!xt&&(function(Ct){if(!Ct||typeof Ct!="object")return!1;var kt=Object.getPrototypeOf(Ct);if(kt===null)return!0;var Mt=Object.hasOwnProperty.call(kt,"constructor")&&kt.constructor;return Mt===Object||typeof Mt=="function"&&Function.toString.call(Mt)===Z$1}(xt)||Array.isArray(xt)||!!xt[L$1]||!!(!(($t=xt.constructor)===null||$t===void 0)&&$t[L$1])||s(xt)||v$1(xt))}function i$1(xt,$t,Ct){Ct===void 0&&(Ct=!1),o(xt)===0?(Ct?Object.keys:nn)(xt).forEach(function(kt){Ct&&typeof kt=="symbol"||$t(kt,xt[kt],xt)}):xt.forEach(function(kt,Mt){return $t(Mt,kt,xt)})}function o(xt){var $t=xt[Q$1];return $t?$t.i>3?$t.i-4:$t.i:Array.isArray(xt)?1:s(xt)?2:v$1(xt)?3:0}function u(xt,$t){return o(xt)===2?xt.has($t):Object.prototype.hasOwnProperty.call(xt,$t)}function a(xt,$t){return o(xt)===2?xt.get($t):xt[$t]}function f(xt,$t,Ct){var kt=o(xt);kt===2?xt.set($t,Ct):kt===3?xt.add(Ct):xt[$t]=Ct}function c(xt,$t){return xt===$t?xt!==0||1/xt==1/$t:xt!=xt&&$t!=$t}function s(xt){return X$3&&xt instanceof Map}function v$1(xt){return q$1&&xt instanceof Set}function p(xt){return xt.o||xt.t}function l(xt){if(Array.isArray(xt))return Array.prototype.slice.call(xt);var $t=rn(xt);delete $t[Q$1];for(var Ct=nn($t),kt=0;kt<Ct.length;kt++){var Mt=Ct[kt],Ft=$t[Mt];Ft.writable===!1&&(Ft.writable=!0,Ft.configurable=!0),(Ft.get||Ft.set)&&($t[Mt]={configurable:!0,writable:!0,enumerable:Ft.enumerable,value:xt[Mt]})}return Object.create(Object.getPrototypeOf(xt),$t)}function d(xt,$t){return $t===void 0&&($t=!1),y$2(xt)||r(xt)||!t$1(xt)||(o(xt)>1&&(xt.set=xt.add=xt.clear=xt.delete=h$1),Object.freeze(xt),$t&&i$1(xt,function(Ct,kt){return d(kt,!0)},!0)),xt}function h$1(){n(2)}function y$2(xt){return xt==null||typeof xt!="object"||Object.isFrozen(xt)}function b$3(xt){var $t=tn[xt];return $t||n(18,xt),$t}function m$1(xt,$t){tn[xt]||(tn[xt]=$t)}function _$1(){return U$1}function j$1(xt,$t){$t&&(b$3("Patches"),xt.u=[],xt.s=[],xt.v=$t)}function g$1(xt){O(xt),xt.p.forEach(S$2),xt.p=null}function O(xt){xt===U$1&&(U$1=xt.l)}function w$2(xt){return U$1={p:[],l:U$1,h:xt,m:!0,_:0}}function S$2(xt){var $t=xt[Q$1];$t.i===0||$t.i===1?$t.j():$t.g=!0}function P$1(xt,$t){$t._=$t.p.length;var Ct=$t.p[0],kt=xt!==void 0&&xt!==Ct;return $t.h.O||b$3("ES5").S($t,xt,kt),kt?(Ct[Q$1].P&&(g$1($t),n(4)),t$1(xt)&&(xt=M$1($t,xt),$t.l||x$2($t,xt)),$t.u&&b$3("Patches").M(Ct[Q$1].t,xt,$t.u,$t.s)):xt=M$1($t,Ct,[]),g$1($t),$t.u&&$t.v($t.u,$t.s),xt!==H$1?xt:void 0}function M$1(xt,$t,Ct){if(y$2($t))return $t;var kt=$t[Q$1];if(!kt)return i$1($t,function(Bt,Vt){return A(xt,kt,$t,Bt,Vt,Ct)},!0),$t;if(kt.A!==xt)return $t;if(!kt.P)return x$2(xt,kt.t,!0),kt.t;if(!kt.I){kt.I=!0,kt.A._--;var Mt=kt.i===4||kt.i===5?kt.o=l(kt.k):kt.o,Ft=Mt,jt=!1;kt.i===3&&(Ft=new Set(Mt),Mt.clear(),jt=!0),i$1(Ft,function(Bt,Vt){return A(xt,kt,Mt,Bt,Vt,Ct,jt)}),x$2(xt,Mt,!1),Ct&&xt.u&&b$3("Patches").N(kt,Ct,xt.u,xt.s)}return kt.o}function A(xt,$t,Ct,kt,Mt,Ft,jt){if(r(Mt)){var Bt=M$1(xt,Mt,Ft&&$t&&$t.i!==3&&!u($t.R,kt)?Ft.concat(kt):void 0);if(f(Ct,kt,Bt),!r(Bt))return;xt.m=!1}else jt&&Ct.add(Mt);if(t$1(Mt)&&!y$2(Mt)){if(!xt.h.D&&xt._<1)return;M$1(xt,Mt),$t&&$t.A.l||x$2(xt,Mt)}}function x$2(xt,$t,Ct){Ct===void 0&&(Ct=!1),!xt.l&&xt.h.D&&xt.m&&d($t,Ct)}function z$1(xt,$t){var Ct=xt[Q$1];return(Ct?p(Ct):xt)[$t]}function I$1(xt,$t){if($t in xt)for(var Ct=Object.getPrototypeOf(xt);Ct;){var kt=Object.getOwnPropertyDescriptor(Ct,$t);if(kt)return kt;Ct=Object.getPrototypeOf(Ct)}}function k$1(xt){xt.P||(xt.P=!0,xt.l&&k$1(xt.l))}function E$1(xt){xt.o||(xt.o=l(xt.t))}function N$1(xt,$t,Ct){var kt=s($t)?b$3("MapSet").F($t,Ct):v$1($t)?b$3("MapSet").T($t,Ct):xt.O?function(Mt,Ft){var jt=Array.isArray(Mt),Bt={i:jt?1:0,A:Ft?Ft.A:_$1(),P:!1,I:!1,R:{},l:Ft,t:Mt,k:null,o:null,j:null,C:!1},Vt=Bt,zt=en;jt&&(Vt=[Bt],zt=on$1);var Ht=Proxy.revocable(Vt,zt),Gt=Ht.revoke,qt=Ht.proxy;return Bt.k=qt,Bt.j=Gt,qt}($t,Ct):b$3("ES5").J($t,Ct);return(Ct?Ct.A:_$1()).p.push(kt),kt}function R(xt){return r(xt)||n(22,xt),function $t(Ct){if(!t$1(Ct))return Ct;var kt,Mt=Ct[Q$1],Ft=o(Ct);if(Mt){if(!Mt.P&&(Mt.i<4||!b$3("ES5").K(Mt)))return Mt.t;Mt.I=!0,kt=D$2(Ct,Ft),Mt.I=!1}else kt=D$2(Ct,Ft);return i$1(kt,function(jt,Bt){Mt&&a(Mt.t,jt)===Bt||f(kt,jt,$t(Bt))}),Ft===3?new Set(kt):kt}(xt)}function D$2(xt,$t){switch($t){case 2:return new Map(xt);case 3:return Array.from(xt)}return l(xt)}function F$2(){function xt(Ft,jt){var Bt=Mt[Ft];return Bt?Bt.enumerable=jt:Mt[Ft]=Bt={configurable:!0,enumerable:jt,get:function(){var Vt=this[Q$1];return en.get(Vt,Ft)},set:function(Vt){var zt=this[Q$1];en.set(zt,Ft,Vt)}},Bt}function $t(Ft){for(var jt=Ft.length-1;jt>=0;jt--){var Bt=Ft[jt][Q$1];if(!Bt.P)switch(Bt.i){case 5:kt(Bt)&&k$1(Bt);break;case 4:Ct(Bt)&&k$1(Bt)}}}function Ct(Ft){for(var jt=Ft.t,Bt=Ft.k,Vt=nn(Bt),zt=Vt.length-1;zt>=0;zt--){var Ht=Vt[zt];if(Ht!==Q$1){var Gt=jt[Ht];if(Gt===void 0&&!u(jt,Ht))return!0;var qt=Bt[Ht],Wt=qt&&qt[Q$1];if(Wt?Wt.t!==Gt:!c(qt,Gt))return!0}}var Yt=!!jt[Q$1];return Vt.length!==nn(jt).length+(Yt?0:1)}function kt(Ft){var jt=Ft.k;if(jt.length!==Ft.t.length)return!0;var Bt=Object.getOwnPropertyDescriptor(jt,jt.length-1);if(Bt&&!Bt.get)return!0;for(var Vt=0;Vt<jt.length;Vt++)if(!jt.hasOwnProperty(Vt))return!0;return!1}var Mt={};m$1("ES5",{J:function(Ft,jt){var Bt=Array.isArray(Ft),Vt=function(Ht,Gt){if(Ht){for(var qt=Array(Gt.length),Wt=0;Wt<Gt.length;Wt++)Object.defineProperty(qt,""+Wt,xt(Wt,!0));return qt}var Yt=rn(Gt);delete Yt[Q$1];for(var Kt=nn(Yt),Xt=0;Xt<Kt.length;Xt++){var Qt=Kt[Xt];Yt[Qt]=xt(Qt,Ht||!!Yt[Qt].enumerable)}return Object.create(Object.getPrototypeOf(Gt),Yt)}(Bt,Ft),zt={i:Bt?5:4,A:jt?jt.A:_$1(),P:!1,I:!1,R:{},l:jt,t:Ft,k:Vt,o:null,g:!1,C:!1};return Object.defineProperty(Vt,Q$1,{value:zt,writable:!0}),Vt},S:function(Ft,jt,Bt){Bt?r(jt)&&jt[Q$1].A===Ft&&$t(Ft.p):(Ft.u&&function Vt(zt){if(zt&&typeof zt=="object"){var Ht=zt[Q$1];if(Ht){var Gt=Ht.t,qt=Ht.k,Wt=Ht.R,Yt=Ht.i;if(Yt===4)i$1(qt,function(Zt){Zt!==Q$1&&(Gt[Zt]!==void 0||u(Gt,Zt)?Wt[Zt]||Vt(qt[Zt]):(Wt[Zt]=!0,k$1(Ht)))}),i$1(Gt,function(Zt){qt[Zt]!==void 0||u(qt,Zt)||(Wt[Zt]=!1,k$1(Ht))});else if(Yt===5){if(kt(Ht)&&(k$1(Ht),Wt.length=!0),qt.length<Gt.length)for(var Kt=qt.length;Kt<Gt.length;Kt++)Wt[Kt]=!1;else for(var Xt=Gt.length;Xt<qt.length;Xt++)Wt[Xt]=!0;for(var Qt=Math.min(qt.length,Gt.length),Jt=0;Jt<Qt;Jt++)qt.hasOwnProperty(Jt)||(Wt[Jt]=!0),Wt[Jt]===void 0&&Vt(qt[Jt])}}}}(Ft.p[0]),$t(Ft.p))},K:function(Ft){return Ft.i===4?Ct(Ft):kt(Ft)}})}var G$1,U$1,W$1=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",X$3=typeof Map<"u",q$1=typeof Set<"u",B$1=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",H$1=W$1?Symbol.for("immer-nothing"):((G$1={})["immer-nothing"]=!0,G$1),L$1=W$1?Symbol.for("immer-draftable"):"__$immer_draftable",Q$1=W$1?Symbol.for("immer-state"):"__$immer_state",Z$1=""+Object.prototype.constructor,nn=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(xt){return Object.getOwnPropertyNames(xt).concat(Object.getOwnPropertySymbols(xt))}:Object.getOwnPropertyNames,rn=Object.getOwnPropertyDescriptors||function(xt){var $t={};return nn(xt).forEach(function(Ct){$t[Ct]=Object.getOwnPropertyDescriptor(xt,Ct)}),$t},tn={},en={get:function(xt,$t){if($t===Q$1)return xt;var Ct=p(xt);if(!u(Ct,$t))return function(Mt,Ft,jt){var Bt,Vt=I$1(Ft,jt);return Vt?"value"in Vt?Vt.value:(Bt=Vt.get)===null||Bt===void 0?void 0:Bt.call(Mt.k):void 0}(xt,Ct,$t);var kt=Ct[$t];return xt.I||!t$1(kt)?kt:kt===z$1(xt.t,$t)?(E$1(xt),xt.o[$t]=N$1(xt.A.h,kt,xt)):kt},has:function(xt,$t){return $t in p(xt)},ownKeys:function(xt){return Reflect.ownKeys(p(xt))},set:function(xt,$t,Ct){var kt=I$1(p(xt),$t);if(kt!=null&&kt.set)return kt.set.call(xt.k,Ct),!0;if(!xt.P){var Mt=z$1(p(xt),$t),Ft=Mt==null?void 0:Mt[Q$1];if(Ft&&Ft.t===Ct)return xt.o[$t]=Ct,xt.R[$t]=!1,!0;if(c(Ct,Mt)&&(Ct!==void 0||u(xt.t,$t)))return!0;E$1(xt),k$1(xt)}return xt.o[$t]===Ct&&(Ct!==void 0||$t in xt.o)||Number.isNaN(Ct)&&Number.isNaN(xt.o[$t])||(xt.o[$t]=Ct,xt.R[$t]=!0),!0},deleteProperty:function(xt,$t){return z$1(xt.t,$t)!==void 0||$t in xt.t?(xt.R[$t]=!1,E$1(xt),k$1(xt)):delete xt.R[$t],xt.o&&delete xt.o[$t],!0},getOwnPropertyDescriptor:function(xt,$t){var Ct=p(xt),kt=Reflect.getOwnPropertyDescriptor(Ct,$t);return kt&&{writable:!0,configurable:xt.i!==1||$t!=="length",enumerable:kt.enumerable,value:Ct[$t]}},defineProperty:function(){n(11)},getPrototypeOf:function(xt){return Object.getPrototypeOf(xt.t)},setPrototypeOf:function(){n(12)}},on$1={};i$1(en,function(xt,$t){on$1[xt]=function(){return arguments[0]=arguments[0][0],$t.apply(this,arguments)}}),on$1.deleteProperty=function(xt,$t){return on$1.set.call(this,xt,$t,void 0)},on$1.set=function(xt,$t,Ct){return en.set.call(this,xt[0],$t,Ct,xt[0])};var un=function(){function xt(Ct){var kt=this;this.O=B$1,this.D=!0,this.produce=function(Mt,Ft,jt){if(typeof Mt=="function"&&typeof Ft!="function"){var Bt=Ft;Ft=Mt;var Vt=kt;return function(Kt){var Xt=this;Kt===void 0&&(Kt=Bt);for(var Qt=arguments.length,Jt=Array(Qt>1?Qt-1:0),Zt=1;Zt<Qt;Zt++)Jt[Zt-1]=arguments[Zt];return Vt.produce(Kt,function(sn){var ln;return(ln=Ft).call.apply(ln,[Xt,sn].concat(Jt))})}}var zt;if(typeof Ft!="function"&&n(6),jt!==void 0&&typeof jt!="function"&&n(7),t$1(Mt)){var Ht=w$2(kt),Gt=N$1(kt,Mt,void 0),qt=!0;try{zt=Ft(Gt),qt=!1}finally{qt?g$1(Ht):O(Ht)}return typeof Promise<"u"&&zt instanceof Promise?zt.then(function(Kt){return j$1(Ht,jt),P$1(Kt,Ht)},function(Kt){throw g$1(Ht),Kt}):(j$1(Ht,jt),P$1(zt,Ht))}if(!Mt||typeof Mt!="object"){if((zt=Ft(Mt))===void 0&&(zt=Mt),zt===H$1&&(zt=void 0),kt.D&&d(zt,!0),jt){var Wt=[],Yt=[];b$3("Patches").M(Mt,zt,Wt,Yt),jt(Wt,Yt)}return zt}n(21,Mt)},this.produceWithPatches=function(Mt,Ft){if(typeof Mt=="function")return function(zt){for(var Ht=arguments.length,Gt=Array(Ht>1?Ht-1:0),qt=1;qt<Ht;qt++)Gt[qt-1]=arguments[qt];return kt.produceWithPatches(zt,function(Wt){return Mt.apply(void 0,[Wt].concat(Gt))})};var jt,Bt,Vt=kt.produce(Mt,Ft,function(zt,Ht){jt=zt,Bt=Ht});return typeof Promise<"u"&&Vt instanceof Promise?Vt.then(function(zt){return[zt,jt,Bt]}):[Vt,jt,Bt]},typeof(Ct==null?void 0:Ct.useProxies)=="boolean"&&this.setUseProxies(Ct.useProxies),typeof(Ct==null?void 0:Ct.autoFreeze)=="boolean"&&this.setAutoFreeze(Ct.autoFreeze)}var $t=xt.prototype;return $t.createDraft=function(Ct){t$1(Ct)||n(8),r(Ct)&&(Ct=R(Ct));var kt=w$2(this),Mt=N$1(this,Ct,void 0);return Mt[Q$1].C=!0,O(kt),Mt},$t.finishDraft=function(Ct,kt){var Mt=Ct&&Ct[Q$1],Ft=Mt.A;return j$1(Ft,kt),P$1(void 0,Ft)},$t.setAutoFreeze=function(Ct){this.D=Ct},$t.setUseProxies=function(Ct){Ct&&!B$1&&n(20),this.O=Ct},$t.applyPatches=function(Ct,kt){var Mt;for(Mt=kt.length-1;Mt>=0;Mt--){var Ft=kt[Mt];if(Ft.path.length===0&&Ft.op==="replace"){Ct=Ft.value;break}}Mt>-1&&(kt=kt.slice(Mt+1));var jt=b$3("Patches").$;return r(Ct)?jt(Ct,kt):this.produce(Ct,function(Bt){return jt(Bt,kt)})},xt}(),an=new un,fn=an.produce;an.produceWithPatches.bind(an);an.setAutoFreeze.bind(an);an.setUseProxies.bind(an);an.applyPatches.bind(an);an.createDraft.bind(an);an.finishDraft.bind(an);const createNextState3=fn;function _typeof(xt){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($t){return typeof $t}:function($t){return $t&&typeof Symbol=="function"&&$t.constructor===Symbol&&$t!==Symbol.prototype?"symbol":typeof $t},_typeof(xt)}function toPrimitive(xt,$t){if(_typeof(xt)!="object"||!xt)return xt;var Ct=xt[Symbol.toPrimitive];if(Ct!==void 0){var kt=Ct.call(xt,$t||"default");if(_typeof(kt)!="object")return kt;throw new TypeError("@@toPrimitive must return a primitive value.")}return($t==="string"?String:Number)(xt)}function toPropertyKey(xt){var $t=toPrimitive(xt,"string");return _typeof($t)=="symbol"?$t:$t+""}function _defineProperty$2(xt,$t,Ct){return($t=toPropertyKey($t))in xt?Object.defineProperty(xt,$t,{value:Ct,enumerable:!0,configurable:!0,writable:!0}):xt[$t]=Ct,xt}function ownKeys(xt,$t){var Ct=Object.keys(xt);if(Object.getOwnPropertySymbols){var kt=Object.getOwnPropertySymbols(xt);$t&&(kt=kt.filter(function(Mt){return Object.getOwnPropertyDescriptor(xt,Mt).enumerable})),Ct.push.apply(Ct,kt)}return Ct}function _objectSpread2(xt){for(var $t=1;$t<arguments.length;$t++){var Ct=arguments[$t]!=null?arguments[$t]:{};$t%2?ownKeys(Object(Ct),!0).forEach(function(kt){_defineProperty$2(xt,kt,Ct[kt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(xt,Object.getOwnPropertyDescriptors(Ct)):ownKeys(Object(Ct)).forEach(function(kt){Object.defineProperty(xt,kt,Object.getOwnPropertyDescriptor(Ct,kt))})}return xt}function formatProdErrorMessage(xt){return"Minified Redux error #"+xt+"; visit https://redux.js.org/Errors?code="+xt+" for the full message or use the non-minified dev environment for full errors. "}var $$observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),randomString=function(){return Math.random().toString(36).substring(7).split("").join(".")},ActionTypes={INIT:"@@redux/INIT"+randomString(),REPLACE:"@@redux/REPLACE"+randomString(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+randomString()}};function isPlainObject$1(xt){if(typeof xt!="object"||xt===null)return!1;for(var $t=xt;Object.getPrototypeOf($t)!==null;)$t=Object.getPrototypeOf($t);return Object.getPrototypeOf(xt)===$t}function createStore(xt,$t,Ct){var kt;if(typeof $t=="function"&&typeof Ct=="function"||typeof Ct=="function"&&typeof arguments[3]=="function")throw new Error(formatProdErrorMessage(0));if(typeof $t=="function"&&typeof Ct>"u"&&(Ct=$t,$t=void 0),typeof Ct<"u"){if(typeof Ct!="function")throw new Error(formatProdErrorMessage(1));return Ct(createStore)(xt,$t)}if(typeof xt!="function")throw new Error(formatProdErrorMessage(2));var Mt=xt,Ft=$t,jt=[],Bt=jt,Vt=!1;function zt(){Bt===jt&&(Bt=jt.slice())}function Ht(){if(Vt)throw new Error(formatProdErrorMessage(3));return Ft}function Gt(Kt){if(typeof Kt!="function")throw new Error(formatProdErrorMessage(4));if(Vt)throw new Error(formatProdErrorMessage(5));var Xt=!0;return zt(),Bt.push(Kt),function(){if(Xt){if(Vt)throw new Error(formatProdErrorMessage(6));Xt=!1,zt();var Jt=Bt.indexOf(Kt);Bt.splice(Jt,1),jt=null}}}function qt(Kt){if(!isPlainObject$1(Kt))throw new Error(formatProdErrorMessage(7));if(typeof Kt.type>"u")throw new Error(formatProdErrorMessage(8));if(Vt)throw new Error(formatProdErrorMessage(9));try{Vt=!0,Ft=Mt(Ft,Kt)}finally{Vt=!1}for(var Xt=jt=Bt,Qt=0;Qt<Xt.length;Qt++){var Jt=Xt[Qt];Jt()}return Kt}function Wt(Kt){if(typeof Kt!="function")throw new Error(formatProdErrorMessage(10));Mt=Kt,qt({type:ActionTypes.REPLACE})}function Yt(){var Kt,Xt=Gt;return Kt={subscribe:function(Jt){if(typeof Jt!="object"||Jt===null)throw new Error(formatProdErrorMessage(11));function Zt(){Jt.next&&Jt.next(Ht())}Zt();var sn=Xt(Zt);return{unsubscribe:sn}}},Kt[$$observable]=function(){return this},Kt}return qt({type:ActionTypes.INIT}),kt={dispatch:qt,subscribe:Gt,getState:Ht,replaceReducer:Wt},kt[$$observable]=Yt,kt}function assertReducerShape(xt){Object.keys(xt).forEach(function($t){var Ct=xt[$t],kt=Ct(void 0,{type:ActionTypes.INIT});if(typeof kt>"u")throw new Error(formatProdErrorMessage(12));if(typeof Ct(void 0,{type:ActionTypes.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(formatProdErrorMessage(13))})}function combineReducers(xt){for(var $t=Object.keys(xt),Ct={},kt=0;kt<$t.length;kt++){var Mt=$t[kt];typeof xt[Mt]=="function"&&(Ct[Mt]=xt[Mt])}var Ft=Object.keys(Ct),jt;try{assertReducerShape(Ct)}catch(Bt){jt=Bt}return function(Vt,zt){if(Vt===void 0&&(Vt={}),jt)throw jt;for(var Ht=!1,Gt={},qt=0;qt<Ft.length;qt++){var Wt=Ft[qt],Yt=Ct[Wt],Kt=Vt[Wt],Xt=Yt(Kt,zt);if(typeof Xt>"u")throw zt&&zt.type,new Error(formatProdErrorMessage(14));Gt[Wt]=Xt,Ht=Ht||Xt!==Kt}return Ht=Ht||Ft.length!==Object.keys(Vt).length,Ht?Gt:Vt}}function compose(){for(var xt=arguments.length,$t=new Array(xt),Ct=0;Ct<xt;Ct++)$t[Ct]=arguments[Ct];return $t.length===0?function(kt){return kt}:$t.length===1?$t[0]:$t.reduce(function(kt,Mt){return function(){return kt(Mt.apply(void 0,arguments))}})}function applyMiddleware(){for(var xt=arguments.length,$t=new Array(xt),Ct=0;Ct<xt;Ct++)$t[Ct]=arguments[Ct];return function(kt){return function(){var Mt=kt.apply(void 0,arguments),Ft=function(){throw new Error(formatProdErrorMessage(15))},jt={getState:Mt.getState,dispatch:function(){return Ft.apply(void 0,arguments)}},Bt=$t.map(function(Vt){return Vt(jt)});return Ft=compose.apply(void 0,Bt)(Mt.dispatch),_objectSpread2(_objectSpread2({},Mt),{},{dispatch:Ft})}}}function createThunkMiddleware(xt){var $t=function(kt){var Mt=kt.dispatch,Ft=kt.getState;return function(jt){return function(Bt){return typeof Bt=="function"?Bt(Mt,Ft,xt):jt(Bt)}}};return $t}var thunk=createThunkMiddleware();thunk.withExtraArgument=createThunkMiddleware;var __extends$1=function(){var xt=function($t,Ct){return xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(kt,Mt){kt.__proto__=Mt}||function(kt,Mt){for(var Ft in Mt)Object.prototype.hasOwnProperty.call(Mt,Ft)&&(kt[Ft]=Mt[Ft])},xt($t,Ct)};return function($t,Ct){if(typeof Ct!="function"&&Ct!==null)throw new TypeError("Class extends value "+String(Ct)+" is not a constructor or null");xt($t,Ct);function kt(){this.constructor=$t}$t.prototype=Ct===null?Object.create(Ct):(kt.prototype=Ct.prototype,new kt)}}(),__generator=function(xt,$t){var Ct={label:0,sent:function(){if(Ft[0]&1)throw Ft[1];return Ft[1]},trys:[],ops:[]},kt,Mt,Ft,jt;return jt={next:Bt(0),throw:Bt(1),return:Bt(2)},typeof Symbol=="function"&&(jt[Symbol.iterator]=function(){return this}),jt;function Bt(zt){return function(Ht){return Vt([zt,Ht])}}function Vt(zt){if(kt)throw new TypeError("Generator is already executing.");for(;Ct;)try{if(kt=1,Mt&&(Ft=zt[0]&2?Mt.return:zt[0]?Mt.throw||((Ft=Mt.return)&&Ft.call(Mt),0):Mt.next)&&!(Ft=Ft.call(Mt,zt[1])).done)return Ft;switch(Mt=0,Ft&&(zt=[zt[0]&2,Ft.value]),zt[0]){case 0:case 1:Ft=zt;break;case 4:return Ct.label++,{value:zt[1],done:!1};case 5:Ct.label++,Mt=zt[1],zt=[0];continue;case 7:zt=Ct.ops.pop(),Ct.trys.pop();continue;default:if(Ft=Ct.trys,!(Ft=Ft.length>0&&Ft[Ft.length-1])&&(zt[0]===6||zt[0]===2)){Ct=0;continue}if(zt[0]===3&&(!Ft||zt[1]>Ft[0]&&zt[1]<Ft[3])){Ct.label=zt[1];break}if(zt[0]===6&&Ct.label<Ft[1]){Ct.label=Ft[1],Ft=zt;break}if(Ft&&Ct.label<Ft[2]){Ct.label=Ft[2],Ct.ops.push(zt);break}Ft[2]&&Ct.ops.pop(),Ct.trys.pop();continue}zt=$t.call(xt,Ct)}catch(Ht){zt=[6,Ht],Mt=0}finally{kt=Ft=0}if(zt[0]&5)throw zt[1];return{value:zt[0]?zt[1]:void 0,done:!0}}},__spreadArray=function(xt,$t){for(var Ct=0,kt=$t.length,Mt=xt.length;Ct<kt;Ct++,Mt++)xt[Mt]=$t[Ct];return xt},__defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=function(xt,$t,Ct){return $t in xt?__defProp(xt,$t,{enumerable:!0,configurable:!0,writable:!0,value:Ct}):xt[$t]=Ct},__spreadValues=function(xt,$t){for(var Ct in $t||($t={}))__hasOwnProp.call($t,Ct)&&__defNormalProp(xt,Ct,$t[Ct]);if(__getOwnPropSymbols)for(var kt=0,Mt=__getOwnPropSymbols($t);kt<Mt.length;kt++){var Ct=Mt[kt];__propIsEnum.call($t,Ct)&&__defNormalProp(xt,Ct,$t[Ct])}return xt},__spreadProps=function(xt,$t){return __defProps(xt,__getOwnPropDescs($t))},__async=function(xt,$t,Ct){return new Promise(function(kt,Mt){var Ft=function(Vt){try{Bt(Ct.next(Vt))}catch(zt){Mt(zt)}},jt=function(Vt){try{Bt(Ct.throw(Vt))}catch(zt){Mt(zt)}},Bt=function(Vt){return Vt.done?kt(Vt.value):Promise.resolve(Vt.value).then(Ft,jt)};Bt((Ct=Ct.apply(xt,$t)).next())})},composeWithDevTools=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?compose:compose.apply(null,arguments)};function isPlainObject(xt){if(typeof xt!="object"||xt===null)return!1;var $t=Object.getPrototypeOf(xt);if($t===null)return!0;for(var Ct=$t;Object.getPrototypeOf(Ct)!==null;)Ct=Object.getPrototypeOf(Ct);return $t===Ct}var hasMatchFunction=function(xt){return xt&&typeof xt.match=="function"};function createAction(xt,$t){function Ct(){for(var kt=[],Mt=0;Mt<arguments.length;Mt++)kt[Mt]=arguments[Mt];if($t){var Ft=$t.apply(void 0,kt);if(!Ft)throw new Error("prepareAction did not return an object");return __spreadValues(__spreadValues({type:xt,payload:Ft.payload},"meta"in Ft&&{meta:Ft.meta}),"error"in Ft&&{error:Ft.error})}return{type:xt,payload:kt[0]}}return Ct.toString=function(){return""+xt},Ct.type=xt,Ct.match=function(kt){return kt.type===xt},Ct}function isAction(xt){return isPlainObject(xt)&&"type"in xt}var MiddlewareArray=function(xt){__extends$1($t,xt);function $t(){for(var Ct=[],kt=0;kt<arguments.length;kt++)Ct[kt]=arguments[kt];var Mt=xt.apply(this,Ct)||this;return Object.setPrototypeOf(Mt,$t.prototype),Mt}return Object.defineProperty($t,Symbol.species,{get:function(){return $t},enumerable:!1,configurable:!0}),$t.prototype.concat=function(){for(var Ct=[],kt=0;kt<arguments.length;kt++)Ct[kt]=arguments[kt];return xt.prototype.concat.apply(this,Ct)},$t.prototype.prepend=function(){for(var Ct=[],kt=0;kt<arguments.length;kt++)Ct[kt]=arguments[kt];return Ct.length===1&&Array.isArray(Ct[0])?new($t.bind.apply($t,__spreadArray([void 0],Ct[0].concat(this)))):new($t.bind.apply($t,__spreadArray([void 0],Ct.concat(this))))},$t}(Array),EnhancerArray=function(xt){__extends$1($t,xt);function $t(){for(var Ct=[],kt=0;kt<arguments.length;kt++)Ct[kt]=arguments[kt];var Mt=xt.apply(this,Ct)||this;return Object.setPrototypeOf(Mt,$t.prototype),Mt}return Object.defineProperty($t,Symbol.species,{get:function(){return $t},enumerable:!1,configurable:!0}),$t.prototype.concat=function(){for(var Ct=[],kt=0;kt<arguments.length;kt++)Ct[kt]=arguments[kt];return xt.prototype.concat.apply(this,Ct)},$t.prototype.prepend=function(){for(var Ct=[],kt=0;kt<arguments.length;kt++)Ct[kt]=arguments[kt];return Ct.length===1&&Array.isArray(Ct[0])?new($t.bind.apply($t,__spreadArray([void 0],Ct[0].concat(this)))):new($t.bind.apply($t,__spreadArray([void 0],Ct.concat(this))))},$t}(Array);function freezeDraftable(xt){return t$1(xt)?createNextState3(xt,function(){}):xt}function isBoolean$3(xt){return typeof xt=="boolean"}function curryGetDefaultMiddleware(){return function($t){return getDefaultMiddleware($t)}}function getDefaultMiddleware(xt){xt===void 0&&(xt={});var $t=xt.thunk,Ct=$t===void 0?!0:$t;xt.immutableCheck,xt.serializableCheck,xt.actionCreatorCheck;var kt=new MiddlewareArray;return Ct&&(isBoolean$3(Ct)?kt.push(thunk):kt.push(thunk.withExtraArgument(Ct.extraArgument))),kt}var IS_PRODUCTION=!0;function configureStore(xt){var $t=curryGetDefaultMiddleware(),Ct=xt||{},kt=Ct.reducer,Mt=kt===void 0?void 0:kt,Ft=Ct.middleware,jt=Ft===void 0?$t():Ft,Bt=Ct.devTools,Vt=Bt===void 0?!0:Bt,zt=Ct.preloadedState,Ht=zt===void 0?void 0:zt,Gt=Ct.enhancers,qt=Gt===void 0?void 0:Gt,Wt;if(typeof Mt=="function")Wt=Mt;else if(isPlainObject(Mt))Wt=combineReducers(Mt);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var Yt=jt;typeof Yt=="function"&&(Yt=Yt($t));var Kt=applyMiddleware.apply(void 0,Yt),Xt=compose;Vt&&(Xt=composeWithDevTools(__spreadValues({trace:!IS_PRODUCTION},typeof Vt=="object"&&Vt)));var Qt=new EnhancerArray(Kt),Jt=Qt;Array.isArray(qt)?Jt=__spreadArray([Kt],qt):typeof qt=="function"&&(Jt=qt(Qt));var Zt=Xt.apply(void 0,Jt);return createStore(Wt,Ht,Zt)}function executeReducerBuilderCallback(xt){var $t={},Ct=[],kt,Mt={addCase:function(Ft,jt){var Bt=typeof Ft=="string"?Ft:Ft.type;if(!Bt)throw new Error("`builder.addCase` cannot be called with an empty action type");if(Bt in $t)throw new Error("`builder.addCase` cannot be called with two reducers for the same action type");return $t[Bt]=jt,Mt},addMatcher:function(Ft,jt){return Ct.push({matcher:Ft,reducer:jt}),Mt},addDefaultCase:function(Ft){return kt=Ft,Mt}};return xt(Mt),[$t,Ct,kt]}function isStateFunction(xt){return typeof xt=="function"}function createReducer(xt,$t,Ct,kt){Ct===void 0&&(Ct=[]);var Mt=typeof $t=="function"?executeReducerBuilderCallback($t):[$t,Ct,kt],Ft=Mt[0],jt=Mt[1],Bt=Mt[2],Vt;if(isStateFunction(xt))Vt=function(){return freezeDraftable(xt())};else{var zt=freezeDraftable(xt);Vt=function(){return zt}}function Ht(Gt,qt){Gt===void 0&&(Gt=Vt());var Wt=__spreadArray([Ft[qt.type]],jt.filter(function(Yt){var Kt=Yt.matcher;return Kt(qt)}).map(function(Yt){var Kt=Yt.reducer;return Kt}));return Wt.filter(function(Yt){return!!Yt}).length===0&&(Wt=[Bt]),Wt.reduce(function(Yt,Kt){if(Kt)if(r(Yt)){var Xt=Yt,Qt=Kt(Xt,qt);return Qt===void 0?Yt:Qt}else{if(t$1(Yt))return createNextState3(Yt,function(Jt){return Kt(Jt,qt)});var Qt=Kt(Yt,qt);if(Qt===void 0){if(Yt===null)return Yt;throw Error("A case reducer on a non-draftable value must not return undefined")}return Qt}return Yt},Gt)}return Ht.getInitialState=Vt,Ht}function getType2(xt,$t){return xt+"/"+$t}function createSlice(xt){var $t=xt.name;if(!$t)throw new Error("`name` is a required option for createSlice");typeof process<"u";var Ct=typeof xt.initialState=="function"?xt.initialState:freezeDraftable(xt.initialState),kt=xt.reducers||{},Mt=Object.keys(kt),Ft={},jt={},Bt={};Mt.forEach(function(Ht){var Gt=kt[Ht],qt=getType2($t,Ht),Wt,Yt;"reducer"in Gt?(Wt=Gt.reducer,Yt=Gt.prepare):Wt=Gt,Ft[Ht]=Wt,jt[qt]=Wt,Bt[Ht]=Yt?createAction(qt,Yt):createAction(qt)});function Vt(){var Ht=typeof xt.extraReducers=="function"?executeReducerBuilderCallback(xt.extraReducers):[xt.extraReducers],Gt=Ht[0],qt=Gt===void 0?{}:Gt,Wt=Ht[1],Yt=Wt===void 0?[]:Wt,Kt=Ht[2],Xt=Kt===void 0?void 0:Kt,Qt=__spreadValues(__spreadValues({},qt),jt);return createReducer(Ct,function(Jt){for(var Zt in Qt)Jt.addCase(Zt,Qt[Zt]);for(var sn=0,ln=Yt;sn<ln.length;sn++){var dn=ln[sn];Jt.addMatcher(dn.matcher,dn.reducer)}Xt&&Jt.addDefaultCase(Xt)})}var zt;return{name:$t,reducer:function(Ht,Gt){return zt||(zt=Vt()),zt(Ht,Gt)},actions:Bt,caseReducers:Ft,getInitialState:function(){return zt||(zt=Vt()),zt.getInitialState()}}}var urlAlphabet="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",nanoid=function(xt){xt===void 0&&(xt=21);for(var $t="",Ct=xt;Ct--;)$t+=urlAlphabet[Math.random()*64|0];return $t},commonProperties=["name","message","stack","code"],RejectWithValue=function(){function xt($t,Ct){this.payload=$t,this.meta=Ct}return xt}(),FulfillWithMeta=function(){function xt($t,Ct){this.payload=$t,this.meta=Ct}return xt}(),miniSerializeError=function(xt){if(typeof xt=="object"&&xt!==null){for(var $t={},Ct=0,kt=commonProperties;Ct<kt.length;Ct++){var Mt=kt[Ct];typeof xt[Mt]=="string"&&($t[Mt]=xt[Mt])}return $t}return{message:String(xt)}};(function(){function xt($t,Ct,kt){var Mt=createAction($t+"/fulfilled",function(zt,Ht,Gt,qt){return{payload:zt,meta:__spreadProps(__spreadValues({},qt||{}),{arg:Gt,requestId:Ht,requestStatus:"fulfilled"})}}),Ft=createAction($t+"/pending",function(zt,Ht,Gt){return{payload:void 0,meta:__spreadProps(__spreadValues({},Gt||{}),{arg:Ht,requestId:zt,requestStatus:"pending"})}}),jt=createAction($t+"/rejected",function(zt,Ht,Gt,qt,Wt){return{payload:qt,error:(kt&&kt.serializeError||miniSerializeError)(zt||"Rejected"),meta:__spreadProps(__spreadValues({},Wt||{}),{arg:Gt,requestId:Ht,rejectedWithValue:!!qt,requestStatus:"rejected",aborted:(zt==null?void 0:zt.name)==="AbortError",condition:(zt==null?void 0:zt.name)==="ConditionError"})}}),Bt=typeof AbortController<"u"?AbortController:function(){function zt(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return zt.prototype.abort=function(){},zt}();function Vt(zt){return function(Ht,Gt,qt){var Wt=kt!=null&&kt.idGenerator?kt.idGenerator(zt):nanoid(),Yt=new Bt,Kt;function Xt(Jt){Kt=Jt,Yt.abort()}var Qt=function(){return __async(this,null,function(){var Jt,Zt,sn,ln,dn,hn,cn;return __generator(this,function(pn){switch(pn.label){case 0:return pn.trys.push([0,4,,5]),ln=(Jt=kt==null?void 0:kt.condition)==null?void 0:Jt.call(kt,zt,{getState:Gt,extra:qt}),isThenable(ln)?[4,ln]:[3,2];case 1:ln=pn.sent(),pn.label=2;case 2:if(ln===!1||Yt.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return dn=new Promise(function(yn,gn){return Yt.signal.addEventListener("abort",function(){return gn({name:"AbortError",message:Kt||"Aborted"})})}),Ht(Ft(Wt,zt,(Zt=kt==null?void 0:kt.getPendingMeta)==null?void 0:Zt.call(kt,{requestId:Wt,arg:zt},{getState:Gt,extra:qt}))),[4,Promise.race([dn,Promise.resolve(Ct(zt,{dispatch:Ht,getState:Gt,extra:qt,requestId:Wt,signal:Yt.signal,abort:Xt,rejectWithValue:function(yn,gn){return new RejectWithValue(yn,gn)},fulfillWithValue:function(yn,gn){return new FulfillWithMeta(yn,gn)}})).then(function(yn){if(yn instanceof RejectWithValue)throw yn;return yn instanceof FulfillWithMeta?Mt(yn.payload,Wt,zt,yn.meta):Mt(yn,Wt,zt)})])];case 3:return sn=pn.sent(),[3,5];case 4:return hn=pn.sent(),sn=hn instanceof RejectWithValue?jt(null,Wt,zt,hn.payload,hn.meta):jt(hn,Wt,zt),[3,5];case 5:return cn=kt&&!kt.dispatchConditionRejection&&jt.match(sn)&&sn.meta.condition,cn||Ht(sn),[2,sn]}})})}();return Object.assign(Qt,{abort:Xt,requestId:Wt,arg:zt,unwrap:function(){return Qt.then(unwrapResult)}})}}return Object.assign(Vt,{pending:Ft,rejected:jt,fulfilled:Mt,typePrefix:$t})}return xt.withTypes=function(){return xt},xt})();function unwrapResult(xt){if(xt.meta&&xt.meta.rejectedWithValue)throw xt.payload;if(xt.error)throw xt.error;return xt.payload}function isThenable(xt){return xt!==null&&typeof xt=="object"&&typeof xt.then=="function"}var matches=function(xt,$t){return hasMatchFunction(xt)?xt.match($t):xt($t)};function isAnyOf(){for(var xt=[],$t=0;$t<arguments.length;$t++)xt[$t]=arguments[$t];return function(Ct){return xt.some(function(kt){return matches(kt,Ct)})}}var assertFunction=function(xt,$t){if(typeof xt!="function")throw new TypeError($t+" is not a function")},noop$3=function(){},catchRejection=function(xt,$t){return $t===void 0&&($t=noop$3),xt.catch($t),xt},addAbortSignalListener=function(xt,$t){return xt.addEventListener("abort",$t,{once:!0}),function(){return xt.removeEventListener("abort",$t)}},abortControllerWithReason=function(xt,$t){var Ct=xt.signal;Ct.aborted||("reason"in Ct||Object.defineProperty(Ct,"reason",{enumerable:!0,value:$t,configurable:!0,writable:!0}),xt.abort($t))},task="task",listener$1="listener",completed="completed",cancelled="cancelled",taskCancelled="task-"+cancelled,taskCompleted="task-"+completed,listenerCancelled=listener$1+"-"+cancelled,listenerCompleted=listener$1+"-"+completed,TaskAbortError=function(){function xt($t){this.code=$t,this.name="TaskAbortError",this.message=task+" "+cancelled+" (reason: "+$t+")"}return xt}(),validateActive=function(xt){if(xt.aborted)throw new TaskAbortError(xt.reason)};function raceWithSignal(xt,$t){var Ct=noop$3;return new Promise(function(kt,Mt){var Ft=function(){return Mt(new TaskAbortError(xt.reason))};if(xt.aborted){Ft();return}Ct=addAbortSignalListener(xt,Ft),$t.finally(function(){return Ct()}).then(kt,Mt)}).finally(function(){Ct=noop$3})}var runTask=function(xt,$t){return __async(void 0,null,function(){var Ct,kt;return __generator(this,function(Mt){switch(Mt.label){case 0:return Mt.trys.push([0,3,4,5]),[4,Promise.resolve()];case 1:return Mt.sent(),[4,xt()];case 2:return Ct=Mt.sent(),[2,{status:"ok",value:Ct}];case 3:return kt=Mt.sent(),[2,{status:kt instanceof TaskAbortError?"cancelled":"rejected",error:kt}];case 4:return $t==null||$t(),[7];case 5:return[2]}})})},createPause=function(xt){return function($t){return catchRejection(raceWithSignal(xt,$t).then(function(Ct){return validateActive(xt),Ct}))}},createDelay=function(xt){var $t=createPause(xt);return function(Ct){return $t(new Promise(function(kt){return setTimeout(kt,Ct)}))}},assign=Object.assign,INTERNAL_NIL_TOKEN={},alm="listenerMiddleware",createFork=function(xt,$t){var Ct=function(kt){return addAbortSignalListener(xt,function(){return abortControllerWithReason(kt,xt.reason)})};return function(kt,Mt){assertFunction(kt,"taskExecutor");var Ft=new AbortController;Ct(Ft);var jt=runTask(function(){return __async(void 0,null,function(){var Bt;return __generator(this,function(Vt){switch(Vt.label){case 0:return validateActive(xt),validateActive(Ft.signal),[4,kt({pause:createPause(Ft.signal),delay:createDelay(Ft.signal),signal:Ft.signal})];case 1:return Bt=Vt.sent(),validateActive(Ft.signal),[2,Bt]}})})},function(){return abortControllerWithReason(Ft,taskCompleted)});return Mt!=null&&Mt.autoJoin&&$t.push(jt),{result:createPause(xt)(jt),cancel:function(){abortControllerWithReason(Ft,taskCancelled)}}}},createTakePattern=function(xt,$t){var Ct=function(kt,Mt){return __async(void 0,null,function(){var Ft,jt,Bt,Vt;return __generator(this,function(zt){switch(zt.label){case 0:validateActive($t),Ft=function(){},jt=new Promise(function(Ht,Gt){var qt=xt({predicate:kt,effect:function(Wt,Yt){Yt.unsubscribe(),Ht([Wt,Yt.getState(),Yt.getOriginalState()])}});Ft=function(){qt(),Gt()}}),Bt=[jt],Mt!=null&&Bt.push(new Promise(function(Ht){return setTimeout(Ht,Mt,null)})),zt.label=1;case 1:return zt.trys.push([1,,3,4]),[4,raceWithSignal($t,Promise.race(Bt))];case 2:return Vt=zt.sent(),validateActive($t),[2,Vt];case 3:return Ft(),[7];case 4:return[2]}})})};return function(kt,Mt){return catchRejection(Ct(kt,Mt))}},getListenerEntryPropsFrom=function(xt){var $t=xt.type,Ct=xt.actionCreator,kt=xt.matcher,Mt=xt.predicate,Ft=xt.effect;if($t)Mt=createAction($t).match;else if(Ct)$t=Ct.type,Mt=Ct.match;else if(kt)Mt=kt;else if(!Mt)throw new Error("Creating or removing a listener requires one of the known fields for matching an action");return assertFunction(Ft,"options.listener"),{predicate:Mt,type:$t,effect:Ft}},createListenerEntry=function(xt){var $t=getListenerEntryPropsFrom(xt),Ct=$t.type,kt=$t.predicate,Mt=$t.effect,Ft=nanoid(),jt={id:Ft,effect:Mt,type:Ct,predicate:kt,pending:new Set,unsubscribe:function(){throw new Error("Unsubscribe not initialized")}};return jt},cancelActiveListeners=function(xt){xt.pending.forEach(function($t){abortControllerWithReason($t,listenerCancelled)})},createClearListenerMiddleware=function(xt){return function(){xt.forEach(cancelActiveListeners),xt.clear()}},safelyNotifyError=function(xt,$t,Ct){try{xt($t,Ct)}catch(kt){setTimeout(function(){throw kt},0)}},addListener=createAction(alm+"/add"),clearAllListeners=createAction(alm+"/removeAll"),removeListener=createAction(alm+"/remove"),defaultErrorHandler=function(){for(var xt=[],$t=0;$t<arguments.length;$t++)xt[$t]=arguments[$t];console.error.apply(console,__spreadArray([alm+"/error"],xt))};function createListenerMiddleware(xt){var $t=this;xt===void 0&&(xt={});var Ct=new Map,kt=xt.extra,Mt=xt.onError,Ft=Mt===void 0?defaultErrorHandler:Mt;assertFunction(Ft,"onError");var jt=function(Wt){return Wt.unsubscribe=function(){return Ct.delete(Wt.id)},Ct.set(Wt.id,Wt),function(Yt){Wt.unsubscribe(),Yt!=null&&Yt.cancelActive&&cancelActiveListeners(Wt)}},Bt=function(Wt){for(var Yt=0,Kt=Array.from(Ct.values());Yt<Kt.length;Yt++){var Xt=Kt[Yt];if(Wt(Xt))return Xt}},Vt=function(Wt){var Yt=Bt(function(Kt){return Kt.effect===Wt.effect});return Yt||(Yt=createListenerEntry(Wt)),jt(Yt)},zt=function(Wt){var Yt=getListenerEntryPropsFrom(Wt),Kt=Yt.type,Xt=Yt.effect,Qt=Yt.predicate,Jt=Bt(function(Zt){var sn=typeof Kt=="string"?Zt.type===Kt:Zt.predicate===Qt;return sn&&Zt.effect===Xt});return Jt&&(Jt.unsubscribe(),Wt.cancelActive&&cancelActiveListeners(Jt)),!!Jt},Ht=function(Wt,Yt,Kt,Xt){return __async($t,null,function(){var Qt,Jt,Zt,sn;return __generator(this,function(ln){switch(ln.label){case 0:Qt=new AbortController,Jt=createTakePattern(Vt,Qt.signal),Zt=[],ln.label=1;case 1:return ln.trys.push([1,3,4,6]),Wt.pending.add(Qt),[4,Promise.resolve(Wt.effect(Yt,assign({},Kt,{getOriginalState:Xt,condition:function(dn,hn){return Jt(dn,hn).then(Boolean)},take:Jt,delay:createDelay(Qt.signal),pause:createPause(Qt.signal),extra:kt,signal:Qt.signal,fork:createFork(Qt.signal,Zt),unsubscribe:Wt.unsubscribe,subscribe:function(){Ct.set(Wt.id,Wt)},cancelActiveListeners:function(){Wt.pending.forEach(function(dn,hn,cn){dn!==Qt&&(abortControllerWithReason(dn,listenerCancelled),cn.delete(dn))})}})))];case 2:return ln.sent(),[3,6];case 3:return sn=ln.sent(),sn instanceof TaskAbortError||safelyNotifyError(Ft,sn,{raisedBy:"effect"}),[3,6];case 4:return[4,Promise.allSettled(Zt)];case 5:return ln.sent(),abortControllerWithReason(Qt,listenerCompleted),Wt.pending.delete(Qt),[7];case 6:return[2]}})})},Gt=createClearListenerMiddleware(Ct),qt=function(Wt){return function(Yt){return function(Kt){if(!isAction(Kt))return Yt(Kt);if(addListener.match(Kt))return Vt(Kt.payload);if(clearAllListeners.match(Kt)){Gt();return}if(removeListener.match(Kt))return zt(Kt.payload);var Xt=Wt.getState(),Qt=function(){if(Xt===INTERNAL_NIL_TOKEN)throw new Error(alm+": getOriginalState can only be called synchronously");return Xt},Jt;try{if(Jt=Yt(Kt),Ct.size>0)for(var Zt=Wt.getState(),sn=Array.from(Ct.values()),ln=0,dn=sn;ln<dn.length;ln++){var hn=dn[ln],cn=!1;try{cn=hn.predicate(Kt,Zt,Xt)}catch(pn){cn=!1,safelyNotifyError(Ft,pn,{raisedBy:"predicate"})}cn&&Ht(hn,Kt,Wt,Qt)}}finally{Xt=INTERNAL_NIL_TOKEN}return Jt}}};return{middleware:qt,startListening:Vt,stopListening:zt,clearListeners:Gt}}var promise;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);F$2();function Qe(){const xt=new Map;return{listen($t,Ct){return xt.has($t)||xt.set($t,[]),xt.get($t).push(Ct),()=>{xt.set($t,(xt.get($t)||[]).filter(kt=>kt!==Ct))}},fire($t,Ct){const kt=xt.get($t);kt&&kt.forEach(Mt=>Mt(Ct))}}}let H;const Ge=new Uint8Array(16);function Ye(){if(!H&&(H=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!H))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return H(Ge)}const m=[];for(let xt=0;xt<256;++xt)m.push((xt+256).toString(16).slice(1));function qe(xt,$t=0){return(m[xt[$t+0]]+m[xt[$t+1]]+m[xt[$t+2]]+m[xt[$t+3]]+"-"+m[xt[$t+4]]+m[xt[$t+5]]+"-"+m[xt[$t+6]]+m[xt[$t+7]]+"-"+m[xt[$t+8]]+m[xt[$t+9]]+"-"+m[xt[$t+10]]+m[xt[$t+11]]+m[xt[$t+12]]+m[xt[$t+13]]+m[xt[$t+14]]+m[xt[$t+15]]).toLowerCase()}const Xe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Pe$1={randomUUID:Xe};function Ne(xt,$t,Ct){if(Pe$1.randomUUID&&!$t&&!xt)return Pe$1.randomUUID();xt=xt||{};const kt=xt.random||(xt.rng||Ye)();return kt[6]=kt[6]&15|64,kt[8]=kt[8]&63|128,qe(kt)}class N{static get(){let $t=Ne();for(;this.ids.has($t);)$t=Ne();return this.ids.set($t,!0),$t}}N.ids=new Map;function P(xt){return"parent"in xt}function Ze(xt){const{label:$t=void 0,state:Ct,initialArtifact:kt,initialMetadata:Mt}=xt,Ft={annotation:[],bookmark:[]},jt=Object.keys(Mt||{}).reduce((Vt,zt)=>(Vt[zt]=[],Mt&&Mt[zt]&&Vt[zt].push({type:zt,id:N.get(),val:Mt[zt],createdOn:Date.now()}),Vt),Ft),Bt=kt?[{id:N.get(),createdOn:Date.now(),val:kt}]:[];return{id:N.get(),label:$t||"Root",event:"Root",children:[],level:0,createdOn:Date.now(),meta:jt,artifacts:Bt,state:{type:"checkpoint",val:Ct}}}function Ve$1({parent:xt,state:$t,label:Ct,sideEffects:kt={do:[],undo:[]},initialMetadata:Mt,initialArtifact:Ft,event:jt}){const Bt={annotation:[],bookmark:[]},Vt=Object.keys(Mt||{}).reduce((Ht,Gt)=>(Ht[Gt]=[],Mt&&Mt[Gt]&&Ht[Gt].push({type:Gt,id:N.get(),val:Mt[Gt],createdOn:Date.now()}),Ht),Bt),zt=Ft?[{id:N.get(),createdOn:Date.now(),val:Ft}]:[];return{id:N.get(),label:Ct,event:jt,children:[],parent:xt.id,createdOn:Date.now(),meta:Vt,artifacts:zt,sideEffects:kt,state:$t,level:xt.level+1}}function g(xt){for(var $t=arguments.length,Ct=Array($t>1?$t-1:0),kt=1;kt<$t;kt++)Ct[kt-1]=arguments[kt];if({}.NODE_ENV!=="production"){var Mt=ct[xt],Ft=Mt?typeof Mt=="function"?Mt.apply(null,Ct):Mt:"unknown error nr: "+xt;throw Error("[Immer] "+Ft)}throw Error("[Immer] minified error nr: "+xt+(Ct.length?" "+Ct.map(function(jt){return"'"+jt+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function M(xt){return!!xt&&!!xt[_]}function S$1(xt){var $t;return!!xt&&(function(Ct){if(!Ct||typeof Ct!="object")return!1;var kt=Object.getPrototypeOf(Ct);if(kt===null)return!0;var Mt=Object.hasOwnProperty.call(kt,"constructor")&&kt.constructor;return Mt===Object||typeof Mt=="function"&&Function.toString.call(Mt)===st}(xt)||Array.isArray(xt)||!!xt[J]||!!(!(($t=xt.constructor)===null||$t===void 0)&&$t[J])||X$2(xt)||Z(xt))}function C$2(xt,$t,Ct){Ct===void 0&&(Ct=!1),D$1(xt)===0?(Ct?Object.keys:Oe)(xt).forEach(function(kt){Ct&&typeof kt=="symbol"||$t(kt,xt[kt],xt)}):xt.forEach(function(kt,Mt){return $t(Mt,kt,xt)})}function D$1(xt){var $t=xt[_];return $t?$t.i>3?$t.i-4:$t.i:Array.isArray(xt)?1:X$2(xt)?2:Z(xt)?3:0}function k(xt,$t){return D$1(xt)===2?xt.has($t):Object.prototype.hasOwnProperty.call(xt,$t)}function B(xt,$t){return D$1(xt)===2?xt.get($t):xt[$t]}function Ue(xt,$t,Ct){var kt=D$1(xt);kt===2?xt.set($t,Ct):kt===3?(xt.delete($t),xt.add(Ct)):xt[$t]=Ct}function et(xt,$t){return xt===$t?xt!==0||1/xt==1/$t:xt!=xt&&$t!=$t}function X$2(xt){return it&&xt instanceof Map}function Z(xt){return ut&&xt instanceof Set}function I(xt){return xt.o||xt.t}function ve(xt){if(Array.isArray(xt))return Array.prototype.slice.call(xt);var $t=ft(xt);delete $t[_];for(var Ct=Oe($t),kt=0;kt<Ct.length;kt++){var Mt=Ct[kt],Ft=$t[Mt];Ft.writable===!1&&(Ft.writable=!0,Ft.configurable=!0),(Ft.get||Ft.set)&&($t[Mt]={configurable:!0,writable:!0,enumerable:Ft.enumerable,value:xt[Mt]})}return Object.create(Object.getPrototypeOf(xt),$t)}function ye$1(xt,$t){return $t===void 0&&($t=!1),ge$1(xt)||M(xt)||!S$1(xt)||(D$1(xt)>1&&(xt.set=xt.add=xt.clear=xt.delete=tt),Object.freeze(xt),$t&&C$2(xt,function(Ct,kt){return ye$1(kt,!0)},!0)),xt}function tt(){g(2)}function ge$1(xt){return xt==null||typeof xt!="object"||Object.isFrozen(xt)}function T(xt){var $t=ce$1[xt];return $t||g(18,xt),$t}function rt(xt,$t){ce$1[xt]||(ce$1[xt]=$t)}function Te$1(){return{}.NODE_ENV==="production"||F$1||g(0),F$1}function te(xt,$t){$t&&(T("Patches"),xt.u=[],xt.s=[],xt.v=$t)}function W(xt){ae$1(xt),xt.p.forEach(nt),xt.p=null}function ae$1(xt){xt===F$1&&(F$1=xt.l)}function Se$1(xt){return F$1={p:[],l:F$1,h:xt,m:!0,_:0}}function nt(xt){var $t=xt[_];$t.i===0||$t.i===1?$t.j():$t.O=!0}function re$3(xt,$t){$t._=$t.p.length;var Ct=$t.p[0],kt=xt!==void 0&&xt!==Ct;return $t.h.g||T("ES5").S($t,xt,kt),kt?(Ct[_].P&&(W($t),g(4)),S$1(xt)&&(xt=Q($t,xt),$t.l||G($t,xt)),$t.u&&T("Patches").M(Ct[_].t,xt,$t.u,$t.s)):xt=Q($t,Ct,[]),W($t),$t.u&&$t.v($t.u,$t.s),xt!==me$1?xt:void 0}function Q(xt,$t,Ct){if(ge$1($t))return $t;var kt=$t[_];if(!kt)return C$2($t,function(Ft,jt){return De(xt,kt,$t,Ft,jt,Ct)},!0),$t;if(kt.A!==xt)return $t;if(!kt.P)return G(xt,kt.t,!0),kt.t;if(!kt.I){kt.I=!0,kt.A._--;var Mt=kt.i===4||kt.i===5?kt.o=ve(kt.k):kt.o;C$2(kt.i===3?new Set(Mt):Mt,function(Ft,jt){return De(xt,kt,Mt,Ft,jt,Ct)}),G(xt,Mt,!1),Ct&&xt.u&&T("Patches").R(kt,Ct,xt.u,xt.s)}return kt.o}function De(xt,$t,Ct,kt,Mt,Ft){if({}.NODE_ENV!=="production"&&Mt===Ct&&g(5),M(Mt)){var jt=Q(xt,Mt,Ft&&$t&&$t.i!==3&&!k($t.D,kt)?Ft.concat(kt):void 0);if(Ue(Ct,kt,jt),!M(jt))return;xt.m=!1}if(S$1(Mt)&&!ge$1(Mt)){if(!xt.h.F&&xt._<1)return;Q(xt,Mt),$t&&$t.A.l||G(xt,Mt)}}function G(xt,$t,Ct){Ct===void 0&&(Ct=!1),xt.h.F&&xt.m&&ye$1($t,Ct)}function ne$1(xt,$t){var Ct=xt[_];return(Ct?I(Ct):xt)[$t]}function Re(xt,$t){if($t in xt)for(var Ct=Object.getPrototypeOf(xt);Ct;){var kt=Object.getOwnPropertyDescriptor(Ct,$t);if(kt)return kt;Ct=Object.getPrototypeOf(Ct)}}function ie(xt){xt.P||(xt.P=!0,xt.l&&ie(xt.l))}function oe$1(xt){xt.o||(xt.o=ve(xt.t))}function ue$1(xt,$t,Ct){var kt=X$2($t)?T("MapSet").N($t,Ct):Z($t)?T("MapSet").T($t,Ct):xt.g?function(Mt,Ft){var jt=Array.isArray(Mt),Bt={i:jt?1:0,A:Ft?Ft.A:Te$1(),P:!1,I:!1,D:{},l:Ft,t:Mt,k:null,o:null,j:null,C:!1},Vt=Bt,zt=se$1;jt&&(Vt=[Bt],zt=x$1);var Ht=Proxy.revocable(Vt,zt),Gt=Ht.revoke,qt=Ht.proxy;return Bt.k=qt,Bt.j=Gt,qt}($t,Ct):T("ES5").J($t,Ct);return(Ct?Ct.A:Te$1()).p.push(kt),kt}function ot(xt){return M(xt)||g(22,xt),function $t(Ct){if(!S$1(Ct))return Ct;var kt,Mt=Ct[_],Ft=D$1(Ct);if(Mt){if(!Mt.P&&(Mt.i<4||!T("ES5").K(Mt)))return Mt.t;Mt.I=!0,kt=Ie$1(Ct,Ft),Mt.I=!1}else kt=Ie$1(Ct,Ft);return C$2(kt,function(jt,Bt){Mt&&B(Mt.t,jt)===Bt||Ue(kt,jt,$t(Bt))}),Ft===3?new Set(kt):kt}(xt)}function Ie$1(xt,$t){switch($t){case 2:return new Map(xt);case 3:return Array.from(xt)}return ve(xt)}function at(){function xt(kt){if(!S$1(kt))return kt;if(Array.isArray(kt))return kt.map(xt);if(X$2(kt))return new Map(Array.from(kt.entries()).map(function(jt){return[jt[0],xt(jt[1])]}));if(Z(kt))return new Set(Array.from(kt).map(xt));var Mt=Object.create(Object.getPrototypeOf(kt));for(var Ft in kt)Mt[Ft]=xt(kt[Ft]);return k(kt,J)&&(Mt[J]=kt[J]),Mt}function $t(kt){return M(kt)?xt(kt):kt}var Ct="add";rt("Patches",{$:function(kt,Mt){return Mt.forEach(function(Ft){for(var jt=Ft.path,Bt=Ft.op,Vt=kt,zt=0;zt<jt.length-1;zt++){var Ht=D$1(Vt),Gt=""+jt[zt];Ht!==0&&Ht!==1||Gt!=="__proto__"&&Gt!=="constructor"||g(24),typeof Vt=="function"&&Gt==="prototype"&&g(24),typeof(Vt=B(Vt,Gt))!="object"&&g(15,jt.join("/"))}var qt=D$1(Vt),Wt=xt(Ft.value),Yt=jt[jt.length-1];switch(Bt){case"replace":switch(qt){case 2:return Vt.set(Yt,Wt);case 3:g(16);default:return Vt[Yt]=Wt}case Ct:switch(qt){case 1:return Yt==="-"?Vt.push(Wt):Vt.splice(Yt,0,Wt);case 2:return Vt.set(Yt,Wt);case 3:return Vt.add(Wt);default:return Vt[Yt]=Wt}case"remove":switch(qt){case 1:return Vt.splice(Yt,1);case 2:return Vt.delete(Yt);case 3:return Vt.delete(Ft.value);default:return delete Vt[Yt]}default:g(17,Bt)}}),kt},R:function(kt,Mt,Ft,jt){switch(kt.i){case 0:case 4:case 2:return function(Bt,Vt,zt,Ht){var Gt=Bt.t,qt=Bt.o;C$2(Bt.D,function(Wt,Yt){var Kt=B(Gt,Wt),Xt=B(qt,Wt),Qt=Yt?k(Gt,Wt)?"replace":Ct:"remove";if(Kt!==Xt||Qt!=="replace"){var Jt=Vt.concat(Wt);zt.push(Qt==="remove"?{op:Qt,path:Jt}:{op:Qt,path:Jt,value:Xt}),Ht.push(Qt===Ct?{op:"remove",path:Jt}:Qt==="remove"?{op:Ct,path:Jt,value:$t(Kt)}:{op:"replace",path:Jt,value:$t(Kt)})}})}(kt,Mt,Ft,jt);case 5:case 1:return function(Bt,Vt,zt,Ht){var Gt=Bt.t,qt=Bt.D,Wt=Bt.o;if(Wt.length<Gt.length){var Yt=[Wt,Gt];Gt=Yt[0],Wt=Yt[1];var Kt=[Ht,zt];zt=Kt[0],Ht=Kt[1]}for(var Xt=0;Xt<Gt.length;Xt++)if(qt[Xt]&&Wt[Xt]!==Gt[Xt]){var Qt=Vt.concat([Xt]);zt.push({op:"replace",path:Qt,value:$t(Wt[Xt])}),Ht.push({op:"replace",path:Qt,value:$t(Gt[Xt])})}for(var Jt=Gt.length;Jt<Wt.length;Jt++){var Zt=Vt.concat([Jt]);zt.push({op:Ct,path:Zt,value:$t(Wt[Jt])})}Gt.length<Wt.length&&Ht.push({op:"replace",path:Vt.concat(["length"]),value:Gt.length})}(kt,Mt,Ft,jt);case 3:return function(Bt,Vt,zt,Ht){var Gt=Bt.t,qt=Bt.o,Wt=0;Gt.forEach(function(Yt){if(!qt.has(Yt)){var Kt=Vt.concat([Wt]);zt.push({op:"remove",path:Kt,value:Yt}),Ht.unshift({op:Ct,path:Kt,value:Yt})}Wt++}),Wt=0,qt.forEach(function(Yt){if(!Gt.has(Yt)){var Kt=Vt.concat([Wt]);zt.push({op:Ct,path:Kt,value:Yt}),Ht.unshift({op:"remove",path:Kt,value:Yt})}Wt++})}(kt,Mt,Ft,jt)}},M:function(kt,Mt,Ft,jt){Ft.push({op:"replace",path:[],value:Mt===me$1?void 0:Mt}),jt.push({op:"replace",path:[],value:kt})}})}var Le,F$1,we=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",it=typeof Map<"u",ut=typeof Set<"u",je=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",me$1=we?Symbol.for("immer-nothing"):((Le={})["immer-nothing"]=!0,Le),J=we?Symbol.for("immer-draftable"):"__$immer_draftable",_=we?Symbol.for("immer-state"):"__$immer_state",ct={0:"Illegal state",1:"Immer drafts cannot have computed properties",2:"This object has been frozen and should not be mutated",3:function(xt){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+xt},4:"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.",5:"Immer forbids circular references",6:"The first or second argument to `produce` must be a function",7:"The third argument to `produce` must be a function or undefined",8:"First argument to `createDraft` must be a plain object, an array, or an immerable object",9:"First argument to `finishDraft` must be a draft returned by `createDraft`",10:"The given draft is already finalized",11:"Object.defineProperty() cannot be used on an Immer draft",12:"Object.setPrototypeOf() cannot be used on an Immer draft",13:"Immer only supports deleting array indices",14:"Immer only supports setting array indices and the 'length' property",15:function(xt){return"Cannot apply patch, path doesn't resolve: "+xt},16:'Sets cannot have "replace" patches.',17:function(xt){return"Unsupported patch operation: "+xt},18:function(xt){return"The plugin for '"+xt+"' has not been loaded into Immer. To enable the plugin, import and call `enable"+xt+"()` when initializing your application."},20:"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available",21:function(xt){return"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '"+xt+"'"},22:function(xt){return"'current' expects a draft, got: "+xt},23:function(xt){return"'original' expects a draft, got: "+xt},24:"Patching reserved attributes like __proto__, prototype and constructor is not allowed"},st=""+Object.prototype.constructor,Oe=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(xt){return Object.getOwnPropertyNames(xt).concat(Object.getOwnPropertySymbols(xt))}:Object.getOwnPropertyNames,ft=Object.getOwnPropertyDescriptors||function(xt){var $t={};return Oe(xt).forEach(function(Ct){$t[Ct]=Object.getOwnPropertyDescriptor(xt,Ct)}),$t},ce$1={},se$1={get:function(xt,$t){if($t===_)return xt;var Ct=I(xt);if(!k(Ct,$t))return function(Mt,Ft,jt){var Bt,Vt=Re(Ft,jt);return Vt?"value"in Vt?Vt.value:(Bt=Vt.get)===null||Bt===void 0?void 0:Bt.call(Mt.k):void 0}(xt,Ct,$t);var kt=Ct[$t];return xt.I||!S$1(kt)?kt:kt===ne$1(xt.t,$t)?(oe$1(xt),xt.o[$t]=ue$1(xt.A.h,kt,xt)):kt},has:function(xt,$t){return $t in I(xt)},ownKeys:function(xt){return Reflect.ownKeys(I(xt))},set:function(xt,$t,Ct){var kt=Re(I(xt),$t);if(kt!=null&&kt.set)return kt.set.call(xt.k,Ct),!0;if(!xt.P){var Mt=ne$1(I(xt),$t),Ft=Mt==null?void 0:Mt[_];if(Ft&&Ft.t===Ct)return xt.o[$t]=Ct,xt.D[$t]=!1,!0;if(et(Ct,Mt)&&(Ct!==void 0||k(xt.t,$t)))return!0;oe$1(xt),ie(xt)}return xt.o[$t]===Ct&&typeof Ct!="number"&&(Ct!==void 0||$t in xt.o)||(xt.o[$t]=Ct,xt.D[$t]=!0,!0)},deleteProperty:function(xt,$t){return ne$1(xt.t,$t)!==void 0||$t in xt.t?(xt.D[$t]=!1,oe$1(xt),ie(xt)):delete xt.D[$t],xt.o&&delete xt.o[$t],!0},getOwnPropertyDescriptor:function(xt,$t){var Ct=I(xt),kt=Reflect.getOwnPropertyDescriptor(Ct,$t);return kt&&{writable:!0,configurable:xt.i!==1||$t!=="length",enumerable:kt.enumerable,value:Ct[$t]}},defineProperty:function(){g(11)},getPrototypeOf:function(xt){return Object.getPrototypeOf(xt.t)},setPrototypeOf:function(){g(12)}},x$1={};C$2(se$1,function(xt,$t){x$1[xt]=function(){return arguments[0]=arguments[0][0],$t.apply(this,arguments)}}),x$1.deleteProperty=function(xt,$t){return{}.NODE_ENV!=="production"&&isNaN(parseInt($t))&&g(13),x$1.set.call(this,xt,$t,void 0)},x$1.set=function(xt,$t,Ct){return{}.NODE_ENV!=="production"&&$t!=="length"&&isNaN(parseInt($t))&&g(14),se$1.set.call(this,xt[0],$t,Ct,xt[0])};var lt$2=function(){function xt(Ct){var kt=this;this.g=je,this.F=!0,this.produce=function(Mt,Ft,jt){if(typeof Mt=="function"&&typeof Ft!="function"){var Bt=Ft;Ft=Mt;var Vt=kt;return function(Kt){var Xt=this;Kt===void 0&&(Kt=Bt);for(var Qt=arguments.length,Jt=Array(Qt>1?Qt-1:0),Zt=1;Zt<Qt;Zt++)Jt[Zt-1]=arguments[Zt];return Vt.produce(Kt,function(sn){var ln;return(ln=Ft).call.apply(ln,[Xt,sn].concat(Jt))})}}var zt;if(typeof Ft!="function"&&g(6),jt!==void 0&&typeof jt!="function"&&g(7),S$1(Mt)){var Ht=Se$1(kt),Gt=ue$1(kt,Mt,void 0),qt=!0;try{zt=Ft(Gt),qt=!1}finally{qt?W(Ht):ae$1(Ht)}return typeof Promise<"u"&&zt instanceof Promise?zt.then(function(Kt){return te(Ht,jt),re$3(Kt,Ht)},function(Kt){throw W(Ht),Kt}):(te(Ht,jt),re$3(zt,Ht))}if(!Mt||typeof Mt!="object"){if((zt=Ft(Mt))===void 0&&(zt=Mt),zt===me$1&&(zt=void 0),kt.F&&ye$1(zt,!0),jt){var Wt=[],Yt=[];T("Patches").M(Mt,zt,Wt,Yt),jt(Wt,Yt)}return zt}g(21,Mt)},this.produceWithPatches=function(Mt,Ft){if(typeof Mt=="function")return function(zt){for(var Ht=arguments.length,Gt=Array(Ht>1?Ht-1:0),qt=1;qt<Ht;qt++)Gt[qt-1]=arguments[qt];return kt.produceWithPatches(zt,function(Wt){return Mt.apply(void 0,[Wt].concat(Gt))})};var jt,Bt,Vt=kt.produce(Mt,Ft,function(zt,Ht){jt=zt,Bt=Ht});return typeof Promise<"u"&&Vt instanceof Promise?Vt.then(function(zt){return[zt,jt,Bt]}):[Vt,jt,Bt]},typeof(Ct==null?void 0:Ct.useProxies)=="boolean"&&this.setUseProxies(Ct.useProxies),typeof(Ct==null?void 0:Ct.autoFreeze)=="boolean"&&this.setAutoFreeze(Ct.autoFreeze)}var $t=xt.prototype;return $t.createDraft=function(Ct){S$1(Ct)||g(8),M(Ct)&&(Ct=ot(Ct));var kt=Se$1(this),Mt=ue$1(this,Ct,void 0);return Mt[_].C=!0,ae$1(kt),Mt},$t.finishDraft=function(Ct,kt){var Mt=Ct&&Ct[_];({}).NODE_ENV!=="production"&&(Mt&&Mt.C||g(9),Mt.I&&g(10));var Ft=Mt.A;return te(Ft,kt),re$3(void 0,Ft)},$t.setAutoFreeze=function(Ct){this.F=Ct},$t.setUseProxies=function(Ct){Ct&&!je&&g(20),this.g=Ct},$t.applyPatches=function(Ct,kt){var Mt;for(Mt=kt.length-1;Mt>=0;Mt--){var Ft=kt[Mt];if(Ft.path.length===0&&Ft.op==="replace"){Ct=Ft.value;break}}Mt>-1&&(kt=kt.slice(Mt+1));var jt=T("Patches").$;return M(Ct)?jt(Ct,kt):this.produce(Ct,function(Bt){return jt(Bt,kt)})},xt}(),b$2=new lt$2,pt=b$2.produce;b$2.produceWithPatches.bind(b$2);b$2.setAutoFreeze.bind(b$2);b$2.setUseProxies.bind(b$2);b$2.applyPatches.bind(b$2);b$2.createDraft.bind(b$2);b$2.finishDraft.bind(b$2);function dt(xt,$t={}){const{artifact:Ct=void 0,metadata:kt=void 0,rootLabel:Mt="Root"}=$t,Ft=Ze({state:xt,label:Mt,initialArtifact:Ct,initialMetadata:kt}),jt={nodes:{[Ft.id]:Ft},root:Ft.id,current:Ft.id};return createSlice({name:"provenance-graph",initialState:jt,reducers:{addMetadata(Bt,Vt){const{id:zt,meta:Ht}=Vt.payload,Gt=Bt.nodes[zt].meta,qt=Object.keys(Ht).reduce((Wt,Yt)=>(Wt[Yt]||(Wt[Yt]=[]),Wt[Yt].push({type:Yt,id:N.get(),val:Ht[Yt],createdOn:Date.now()}),Wt),Gt);Bt.nodes[Vt.payload.id].meta=qt},addArtifact(Bt,Vt){Bt.nodes[Vt.payload.id].artifacts.push({id:N.get(),createdOn:Date.now(),val:Vt.payload.artifact})},changeCurrent(Bt,Vt){Bt.current=Vt.payload},addNode(Bt,{payload:Vt}){Bt.nodes[Vt.id]=Vt,Bt.nodes[Vt.parent].children.push(Vt.id),Bt.current=Vt.id},load(Bt,{payload:Vt}){return Vt}}})}function ht(xt){const $t=new Map,{reducer:Ct,actions:kt,getInitialState:Mt}=dt(xt),Ft=createListenerMiddleware();Ft.startListening({matcher:isAnyOf(kt.changeCurrent,kt.addNode),effect:(Bt,Vt)=>{Vt.cancelActiveListeners(),$t.forEach(zt=>{const Ht=isAnyOf(kt.addNode)(Bt),{skipOnNew:Gt}=zt.config;Gt&&Ht||zt.func(Ht?"new":"traversal")})}});const jt=configureStore({reducer:Ct,middleware:Bt=>Bt().prepend(Ft.middleware)});return{initialState:Mt(),get backend(){return jt.getState()},get current(){return jt.getState().nodes[jt.getState().current]},get root(){return jt.getState().nodes[jt.getState().root]},currentChange(Bt,Vt){const zt={id:N.get(),func:Bt,config:Vt};return $t.set(zt.id,zt),()=>$t.delete(zt.id)},update:jt.dispatch,...kt}}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var vt=globalThis&&globalThis.__extends||function(){var xt=function($t,Ct){return xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(kt,Mt){kt.__proto__=Mt}||function(kt,Mt){for(var Ft in Mt)Mt.hasOwnProperty(Ft)&&(kt[Ft]=Mt[Ft])},xt($t,Ct)};return function($t,Ct){xt($t,Ct);function kt(){this.constructor=$t}$t.prototype=Ct===null?Object.create(Ct):(kt.prototype=Ct.prototype,new kt)}}(),yt=Object.prototype.hasOwnProperty;function fe$1(xt,$t){return yt.call(xt,$t)}function le$1(xt){if(Array.isArray(xt)){for(var $t=new Array(xt.length),Ct=0;Ct<$t.length;Ct++)$t[Ct]=""+Ct;return $t}if(Object.keys)return Object.keys(xt);var kt=[];for(var Mt in xt)fe$1(xt,Mt)&&kt.push(Mt);return kt}function E(xt){switch(typeof xt){case"object":return JSON.parse(JSON.stringify(xt));case"undefined":return null;default:return xt}}function pe$1(xt){for(var $t=0,Ct=xt.length,kt;$t<Ct;){if(kt=xt.charCodeAt($t),kt>=48&&kt<=57){$t++;continue}return!1}return!0}function L(xt){return xt.indexOf("/")===-1&&xt.indexOf("~")===-1?xt:xt.replace(/~/g,"~0").replace(/\//g,"~1")}function Ce(xt){return xt.replace(/~1/g,"/").replace(/~0/g,"~")}function de(xt){if(xt===void 0)return!0;if(xt){if(Array.isArray(xt)){for(var $t=0,Ct=xt.length;$t<Ct;$t++)if(de(xt[$t]))return!0}else if(typeof xt=="object"){for(var kt=le$1(xt),Mt=kt.length,Ft=0;Ft<Mt;Ft++)if(de(xt[kt[Ft]]))return!0}}return!1}function Me(xt,$t){var Ct=[xt];for(var kt in $t){var Mt=typeof $t[kt]=="object"?JSON.stringify($t[kt],null,2):$t[kt];typeof Mt<"u"&&Ct.push(kt+": "+Mt)}return Ct.join(`
`)}var Fe=function(xt){vt($t,xt);function $t(Ct,kt,Mt,Ft,jt){var Bt=this.constructor,Vt=xt.call(this,Me(Ct,{name:kt,index:Mt,operation:Ft,tree:jt}))||this;return Vt.name=kt,Vt.index=Mt,Vt.operation=Ft,Vt.tree=jt,Object.setPrototypeOf(Vt,Bt.prototype),Vt.message=Me(Ct,{name:kt,index:Mt,operation:Ft,tree:jt}),Vt}return $t}(Error),y$1=Fe,gt$2=E,U={add:function(xt,$t,Ct){return xt[$t]=this.value,{newDocument:Ct}},remove:function(xt,$t,Ct){var kt=xt[$t];return delete xt[$t],{newDocument:Ct,removed:kt}},replace:function(xt,$t,Ct){var kt=xt[$t];return xt[$t]=this.value,{newDocument:Ct,removed:kt}},move:function(xt,$t,Ct){var kt=Y$2(Ct,this.path);kt&&(kt=E(kt));var Mt=j(Ct,{op:"remove",path:this.from}).removed;return j(Ct,{op:"add",path:this.path,value:Mt}),{newDocument:Ct,removed:kt}},copy:function(xt,$t,Ct){var kt=Y$2(Ct,this.from);return j(Ct,{op:"add",path:this.path,value:E(kt)}),{newDocument:Ct}},test:function(xt,$t,Ct){return{newDocument:Ct,test:K(xt[$t],this.value)}},_get:function(xt,$t,Ct){return this.value=xt[$t],{newDocument:Ct}}},wt={add:function(xt,$t,Ct){return pe$1($t)?xt.splice($t,0,this.value):xt[$t]=this.value,{newDocument:Ct,index:$t}},remove:function(xt,$t,Ct){var kt=xt.splice($t,1);return{newDocument:Ct,removed:kt[0]}},replace:function(xt,$t,Ct){var kt=xt[$t];return xt[$t]=this.value,{newDocument:Ct,removed:kt}},move:U.move,copy:U.copy,test:U.test,_get:U._get};function Y$2(xt,$t){if($t=="")return xt;var Ct={op:"_get",path:$t};return j(xt,Ct),Ct.value}function j(xt,$t,Ct,kt,Mt,Ft){if(Ct===void 0&&(Ct=!1),kt===void 0&&(kt=!0),Mt===void 0&&(Mt=!0),Ft===void 0&&(Ft=0),Ct&&(typeof Ct=="function"?Ct($t,0,xt,$t.path):q($t,0)),$t.path===""){var jt={newDocument:xt};if($t.op==="add")return jt.newDocument=$t.value,jt;if($t.op==="replace")return jt.newDocument=$t.value,jt.removed=xt,jt;if($t.op==="move"||$t.op==="copy")return jt.newDocument=Y$2(xt,$t.from),$t.op==="move"&&(jt.removed=xt),jt;if($t.op==="test"){if(jt.test=K(xt,$t.value),jt.test===!1)throw new y$1("Test operation failed","TEST_OPERATION_FAILED",Ft,$t,xt);return jt.newDocument=xt,jt}else{if($t.op==="remove")return jt.removed=xt,jt.newDocument=null,jt;if($t.op==="_get")return $t.value=xt,jt;if(Ct)throw new y$1("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",Ft,$t,xt);return jt}}else{kt||(xt=E(xt));var Bt=$t.path||"",Vt=Bt.split("/"),zt=xt,Ht=1,Gt=Vt.length,qt=void 0,Wt=void 0,Yt=void 0;for(typeof Ct=="function"?Yt=Ct:Yt=q;;){if(Wt=Vt[Ht],Wt&&Wt.indexOf("~")!=-1&&(Wt=Ce(Wt)),Mt&&(Wt=="__proto__"||Wt=="prototype"&&Ht>0&&Vt[Ht-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(Ct&&qt===void 0&&(zt[Wt]===void 0?qt=Vt.slice(0,Ht).join("/"):Ht==Gt-1&&(qt=$t.path),qt!==void 0&&Yt($t,0,xt,qt)),Ht++,Array.isArray(zt)){if(Wt==="-")Wt=zt.length;else{if(Ct&&!pe$1(Wt))throw new y$1("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",Ft,$t,xt);pe$1(Wt)&&(Wt=~~Wt)}if(Ht>=Gt){if(Ct&&$t.op==="add"&&Wt>zt.length)throw new y$1("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",Ft,$t,xt);var jt=wt[$t.op].call($t,zt,Wt,xt);if(jt.test===!1)throw new y$1("Test operation failed","TEST_OPERATION_FAILED",Ft,$t,xt);return jt}}else if(Ht>=Gt){var jt=U[$t.op].call($t,zt,Wt,xt);if(jt.test===!1)throw new y$1("Test operation failed","TEST_OPERATION_FAILED",Ft,$t,xt);return jt}if(zt=zt[Wt],Ct&&Ht<Gt&&(!zt||typeof zt!="object"))throw new y$1("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",Ft,$t,xt)}}}function V(xt,$t,Ct,kt,Mt){if(kt===void 0&&(kt=!0),Mt===void 0&&(Mt=!0),Ct&&!Array.isArray($t))throw new y$1("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");kt||(xt=E(xt));for(var Ft=new Array($t.length),jt=0,Bt=$t.length;jt<Bt;jt++)Ft[jt]=j(xt,$t[jt],Ct,!0,Mt,jt),xt=Ft[jt].newDocument;return Ft.newDocument=xt,Ft}function mt(xt,$t,Ct){var kt=j(xt,$t);if(kt.test===!1)throw new y$1("Test operation failed","TEST_OPERATION_FAILED",Ct,$t,xt);return kt.newDocument}function q(xt,$t,Ct,kt){if(typeof xt!="object"||xt===null||Array.isArray(xt))throw new y$1("Operation is not an object","OPERATION_NOT_AN_OBJECT",$t,xt,Ct);if(U[xt.op]){if(typeof xt.path!="string")throw new y$1("Operation `path` property is not a string","OPERATION_PATH_INVALID",$t,xt,Ct);if(xt.path.indexOf("/")!==0&&xt.path.length>0)throw new y$1('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",$t,xt,Ct);if((xt.op==="move"||xt.op==="copy")&&typeof xt.from!="string")throw new y$1("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",$t,xt,Ct);if((xt.op==="add"||xt.op==="replace"||xt.op==="test")&&xt.value===void 0)throw new y$1("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",$t,xt,Ct);if((xt.op==="add"||xt.op==="replace"||xt.op==="test")&&de(xt.value))throw new y$1("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",$t,xt,Ct);if(Ct){if(xt.op=="add"){var Mt=xt.path.split("/").length,Ft=kt.split("/").length;if(Mt!==Ft+1&&Mt!==Ft)throw new y$1("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",$t,xt,Ct)}else if(xt.op==="replace"||xt.op==="remove"||xt.op==="_get"){if(xt.path!==kt)throw new y$1("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",$t,xt,Ct)}else if(xt.op==="move"||xt.op==="copy"){var jt={op:"_get",path:xt.from,value:void 0},Bt=xe([jt],Ct);if(Bt&&Bt.name==="OPERATION_PATH_UNRESOLVABLE")throw new y$1("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",$t,xt,Ct)}}}else throw new y$1("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",$t,xt,Ct)}function xe(xt,$t,Ct){try{if(!Array.isArray(xt))throw new y$1("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if($t)V(E($t),E(xt),Ct||!0);else{Ct=Ct||q;for(var kt=0;kt<xt.length;kt++)Ct(xt[kt],kt,$t,void 0)}}catch(Mt){if(Mt instanceof y$1)return Mt;throw Mt}}function K(xt,$t){if(xt===$t)return!0;if(xt&&$t&&typeof xt=="object"&&typeof $t=="object"){var Ct=Array.isArray(xt),kt=Array.isArray($t),Mt,Ft,jt;if(Ct&&kt){if(Ft=xt.length,Ft!=$t.length)return!1;for(Mt=Ft;Mt--!==0;)if(!K(xt[Mt],$t[Mt]))return!1;return!0}if(Ct!=kt)return!1;var Bt=Object.keys(xt);if(Ft=Bt.length,Ft!==Object.keys($t).length)return!1;for(Mt=Ft;Mt--!==0;)if(!$t.hasOwnProperty(Bt[Mt]))return!1;for(Mt=Ft;Mt--!==0;)if(jt=Bt[Mt],!K(xt[jt],$t[jt]))return!1;return!0}return xt!==xt&&$t!==$t}const Ot=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:y$1,_areEquals:K,applyOperation:j,applyPatch:V,applyReducer:mt,deepClone:gt$2,getValueByPointer:Y$2,validate:xe,validator:q},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var Ae=new WeakMap,At=function(){function xt($t){this.observers=new Map,this.obj=$t}return xt}(),Et=function(){function xt($t,Ct){this.callback=$t,this.observer=Ct}return xt}();function _t$1(xt){return Ae.get(xt)}function bt(xt,$t){return xt.observers.get($t)}function Pt(xt,$t){xt.observers.delete($t.callback)}function Nt(xt,$t){$t.unobserve()}function Tt(xt,$t){var Ct=[],kt,Mt=_t$1(xt);if(!Mt)Mt=new At(xt),Ae.set(xt,Mt);else{var Ft=bt(Mt,$t);kt=Ft&&Ft.observer}if(kt)return kt;if(kt={},Mt.value=E(xt),$t){kt.callback=$t,kt.next=null;var jt=function(){he(kt)},Bt=function(){clearTimeout(kt.next),kt.next=setTimeout(jt)};typeof window<"u"&&(window.addEventListener("mouseup",Bt),window.addEventListener("keyup",Bt),window.addEventListener("mousedown",Bt),window.addEventListener("keydown",Bt),window.addEventListener("change",Bt))}return kt.patches=Ct,kt.object=xt,kt.unobserve=function(){he(kt),clearTimeout(kt.next),Pt(Mt,kt),typeof window<"u"&&(window.removeEventListener("mouseup",Bt),window.removeEventListener("keyup",Bt),window.removeEventListener("mousedown",Bt),window.removeEventListener("keydown",Bt),window.removeEventListener("change",Bt))},Mt.observers.set($t,new Et($t,kt)),kt}function he(xt,$t){$t===void 0&&($t=!1);var Ct=Ae.get(xt.object);Ee$1(Ct.value,xt.object,xt.patches,"",$t),xt.patches.length&&V(Ct.value,xt.patches);var kt=xt.patches;return kt.length>0&&(xt.patches=[],xt.callback&&xt.callback(kt)),kt}function Ee$1(xt,$t,Ct,kt,Mt){if($t!==xt){typeof $t.toJSON=="function"&&($t=$t.toJSON());for(var Ft=le$1($t),jt=le$1(xt),Bt=!1,Vt=jt.length-1;Vt>=0;Vt--){var zt=jt[Vt],Ht=xt[zt];if(fe$1($t,zt)&&!($t[zt]===void 0&&Ht!==void 0&&Array.isArray($t)===!1)){var Gt=$t[zt];typeof Ht=="object"&&Ht!=null&&typeof Gt=="object"&&Gt!=null&&Array.isArray(Ht)===Array.isArray(Gt)?Ee$1(Ht,Gt,Ct,kt+"/"+L(zt),Mt):Ht!==Gt&&(Mt&&Ct.push({op:"test",path:kt+"/"+L(zt),value:E(Ht)}),Ct.push({op:"replace",path:kt+"/"+L(zt),value:E(Gt)}))}else Array.isArray(xt)===Array.isArray($t)?(Mt&&Ct.push({op:"test",path:kt+"/"+L(zt),value:E(Ht)}),Ct.push({op:"remove",path:kt+"/"+L(zt)}),Bt=!0):(Mt&&Ct.push({op:"test",path:kt,value:xt}),Ct.push({op:"replace",path:kt,value:$t}))}if(!(!Bt&&Ft.length==jt.length))for(var Vt=0;Vt<Ft.length;Vt++){var zt=Ft[Vt];!fe$1(xt,zt)&&$t[zt]!==void 0&&Ct.push({op:"add",path:kt+"/"+L(zt),value:E($t[zt])})}}}function ze(xt,$t,Ct){Ct===void 0&&(Ct=!1);var kt=[];return Ee$1(xt,$t,kt,"",Ct),kt}const St=Object.freeze(Object.defineProperty({__proto__:null,compare:ze,generate:he,observe:Tt,unobserve:Nt},Symbol.toStringTag,{value:"Module"}));Object.assign({},Ot,St,{JsonPatchError:Fe,deepClone:E,escapePathComponent:L,unescapePathComponent:Ce});var z=(xt=>(xt.TRAVERSAL_START="Traversal_Start",xt.TRAVERSAL_END="Traversal_End",xt))(z||{});function $$1(xt,$t){const Ct=xt.state;if(Ct.type==="checkpoint")return Ct.val;const{checkpointRef:kt}=Ct,Mt=$t[kt],Ft=Je(Mt,xt,$t);Ft.shift();const jt=Ft.map(Vt=>$t[Vt]).map(Vt=>Vt.state.val).reduce((Vt,zt)=>[...Vt,...zt],[]),Bt=$$1(Mt,$t);return V(Bt,E(jt),!0,!1).newDocument}function Dt(xt,$t){const Ct=Object.keys(xt).length;return new Set($t.map(kt=>kt.path.split("/")[0])).size<Ct/2?"patch":"checkpoint"}function Ut({registry:xt,initialState:$t}){let Ct=!1;const kt=Qe(),Mt=ht($t);function Ft(Ht){return Mt.backend.nodes[Ht]}kt.listen(z.TRAVERSAL_START,()=>{Ct=!0}),kt.listen(z.TRAVERSAL_END,()=>{Ct=!1});const jt={add(Ht,Gt=Mt.current.id){Mt.update(Mt.addMetadata({id:Gt,meta:Ht}))},latestOfType(Ht,Gt=Mt.current.id){var qt;return(qt=Mt.backend.nodes[Gt].meta[Ht])==null?void 0:qt.at(-1)},allOfType(Ht,Gt=Mt.current.id){return Mt.backend.nodes[Gt].meta[Ht]},latest(Ht=Mt.current.id){const Gt=Mt.backend.nodes[Ht].meta,qt=Object.keys(Gt).reduce((Wt,Yt)=>{const Kt=Gt[Yt].at(-1);return Kt&&(Wt[Yt]=Kt),Wt},{});return Object.keys(qt).length>0?qt:void 0},all(Ht=Mt.current.id){return Mt.backend.nodes[Ht].meta},types(Ht=Mt.current.id){return Object.keys(Mt.backend.nodes[Ht].meta)}},Bt={add(Ht,Gt=Mt.current.id){Mt.update(Mt.addArtifact({id:Gt,artifact:Ht}))},latest(Ht=Mt.current.id){return Mt.backend.nodes[Ht].artifacts.at(-1)},all(Ht=Mt.current.id){return Mt.backend.nodes[Ht].artifacts}},Vt={add(Ht,Gt=Mt.current.id){jt.add({annotation:Ht},Gt)},latest(Ht=Mt.current.id){var Gt;return(Gt=jt.latestOfType("annotation",Ht))==null?void 0:Gt.val},all(Ht=Mt.current.id){var Gt;return(Gt=jt.allOfType("annotation",Ht))==null?void 0:Gt.map(qt=>qt.val)}},zt={add(Ht=Mt.current.id){jt.add({bookmark:!0},Ht)},remove(Ht=Mt.current.id){jt.add({bookmark:!1},Ht)},is(Ht=Mt.current.id){var Gt;return!!((Gt=jt.latestOfType("bookmark",Ht))!=null&&Gt.val)},toggle(Ht=Mt.current.id){zt.is(Ht)?zt.remove(Ht):zt.add(Ht)}};return{registry:xt,get isTraversing(){return Ct},getState(Ht=Mt.current){return $$1(Ht,Mt.backend.nodes)},graph:Mt,get current(){return Mt.current},get root(){return Mt.root},record({label:Ht,state:Gt,sideEffects:qt,eventType:Wt,onlySideEffects:Yt=!1}){let Kt=null,Xt=null;const Qt=$$1(this.current,this.graph.backend.nodes);if(Yt)Xt={type:"checkpoint",val:Gt};else{const Jt=ze(Qt,Gt);if(Dt(Gt,Jt)==="checkpoint")Xt={type:"checkpoint",val:Gt};else{const Zt=this.current.state.type==="checkpoint"?this.current.id:this.current.state.checkpointRef;Xt={type:"patch",val:Jt,checkpointRef:Zt}}}if(!Xt)throw new Error(`Could not calculate new state. Previous state is: ${JSON.stringify(this.current.state,null,2)}`);if(Kt=Ve$1({label:Ht,state:Xt,parent:this.current,sideEffects:qt,event:Wt}),!Kt)throw new Error("State Node creation failed!");Mt.update(Mt.addNode(Kt))},async apply(Ht,Gt){const qt=xt.get(Gt.type),Wt=$$1(this.current,this.graph.backend.nodes);if(qt.config.hasSideEffects){const{do:Yt=Gt,undo:Kt}=qt.func(Gt.payload);this.record({label:Ht,state:Wt,sideEffects:{do:[Yt],undo:[Kt]},eventType:qt.config.eventType})}else{const Yt=qt.func(Wt,Gt.payload);this.record({label:Ht,state:Yt,sideEffects:{do:[],undo:[]},eventType:qt.config.eventType})}},async to(Ht){kt.fire(z.TRAVERSAL_START);const Gt=Je(Mt.current,Mt.backend.nodes[Ht],Mt.backend.nodes),qt=[];for(let Wt=0;Wt<Gt.length-1;++Wt){const Yt=Ft(Gt[Wt]),Kt=Ft(Gt[Wt+1]);It(Yt,Kt)?P(Yt)&&qt.push(...Yt.sideEffects.undo):P(Kt)&&qt.push(...Kt.sideEffects.do)}for(const Wt of qt){const Yt=xt.get(Wt.type).func;await Yt(Wt.payload)}Mt.update(Mt.changeCurrent(Ht)),kt.fire(z.TRAVERSAL_END)},undo(){const{current:Ht}=Mt;return P(Ht)?this.to(Ht.parent):Promise.resolve(console.warn("Already at root!"))},redo(Ht="latest"){const{current:Gt}=Mt;return Gt.children.length>0?this.to(Gt.children[Ht==="oldest"?0:Gt.children.length-1]):Promise.resolve(console.warn("Already at latest in this branch!"))},currentChange(Ht,Gt=!1){return Mt.currentChange(Ht,{skipOnNew:Gt})},done(){console.log("Setup later for URL sharing.")},tree(){return ke(Mt.root,Mt.backend.nodes)},on(Ht,Gt){kt.listen(Ht,Gt)},export(){return JSON.stringify(Mt.backend)},exportObject(){return JSON.parse(JSON.stringify(Mt.backend))},import(Ht){const Gt=JSON.parse(Ht),qt=Gt.current;Gt.current=Gt.root,Mt.update(Mt.load(Gt)),this.to(qt)},importObject(Ht){const Gt=Ht.current;Ht.current=Ht.root,Mt.update(Mt.load(Ht)),this.to(Gt)},metadata:jt,artifact:Bt,annotations:Vt,bookmarks:zt}}function Rt(xt,$t,Ct){let[kt,Mt]=[xt,$t];kt.level>Mt.level&&([kt,Mt]=[Mt,kt]);let Ft=Mt.level-kt.level;for(;P(Mt)&&Ft!==0;)Mt=Ct[Mt.parent],Ft-=1;if(kt.id===Mt.id)return kt.id;for(;kt.id!==Mt.id;)P(kt)&&(kt=Ct[kt.parent]),P(Mt)&&(Mt=Ct[Mt.parent]);return kt.id}function Je(xt,$t,Ct){const kt=Rt(xt,$t,Ct),Mt=Ct[kt],Ft=[],jt=[];let[Bt,Vt]=[xt,$t];for(;Bt.id!==Mt.id;)Ft.push(Bt),P(Bt)&&(Bt=Ct[Bt.parent]);for(Ft.push(Bt);Vt.id!==Mt.id;)jt.push(Vt),P(Vt)&&(Vt=Ct[Vt.parent]);const zt=jt.reverse();return[...Ft,...zt].map(Ht=>Ht.id)}function It(xt,$t){if(P(xt)&&xt.parent===$t.id)return!0;if(P($t)&&$t.parent===xt.id)return!1;throw new Error("Incorrect use of function. Nodes are not connected to each other.")}function ke(xt,$t){return{...xt,children:xt.children.map(Ct=>ke($t[Ct],$t)),name:`${xt.label}`}}at();function Lt(xt){return xt.length===2?pt(xt):xt}class Ke{static create(){return new Ke}constructor(){this.registry=new Map}has($t){return this.registry.has($t)}register($t,Ct,kt){const Mt=Ct.length===2;if(Ct.length>2)throw new Error("Incorrect action function signature. Action function can only have two arguments at most!");if(this.has($t))throw new Error(`Already registered: ${$t}`);const{label:Ft=$t,eventType:jt=$t}=kt||{};return this.registry.set($t,{func:Lt(Ct),config:{hasSideEffects:!Mt,label:typeof Ft=="string"?()=>Ft:Ft,eventType:jt}}),createAction($t)}get($t){const Ct=this.registry.get($t);if(!Ct)throw new Error(`Not registered: ${$t}`);return Ct}}var FUNC_ERROR_TEXT="Expected a function",NAN=NaN,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal=typeof commonjsGlobal$2=="object"&&commonjsGlobal$2&&commonjsGlobal$2.Object===Object&&commonjsGlobal$2,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),objectProto=Object.prototype,objectToString=objectProto.toString,nativeMax=Math.max,nativeMin=Math.min,now=function(){return root.Date.now()};function debounce$1(xt,$t,Ct){var kt,Mt,Ft,jt,Bt,Vt,zt=0,Ht=!1,Gt=!1,qt=!0;if(typeof xt!="function")throw new TypeError(FUNC_ERROR_TEXT);$t=toNumber$2($t)||0,isObject$2(Ct)&&(Ht=!!Ct.leading,Gt="maxWait"in Ct,Ft=Gt?nativeMax(toNumber$2(Ct.maxWait)||0,$t):Ft,qt="trailing"in Ct?!!Ct.trailing:qt);function Wt(dn){var hn=kt,cn=Mt;return kt=Mt=void 0,zt=dn,jt=xt.apply(cn,hn),jt}function Yt(dn){return zt=dn,Bt=setTimeout(Qt,$t),Ht?Wt(dn):jt}function Kt(dn){var hn=dn-Vt,cn=dn-zt,pn=$t-hn;return Gt?nativeMin(pn,Ft-cn):pn}function Xt(dn){var hn=dn-Vt,cn=dn-zt;return Vt===void 0||hn>=$t||hn<0||Gt&&cn>=Ft}function Qt(){var dn=now();if(Xt(dn))return Jt(dn);Bt=setTimeout(Qt,Kt(dn))}function Jt(dn){return Bt=void 0,qt&&kt?Wt(dn):(kt=Mt=void 0,jt)}function Zt(){Bt!==void 0&&clearTimeout(Bt),zt=0,kt=Vt=Mt=Bt=void 0}function sn(){return Bt===void 0?jt:Jt(now())}function ln(){var dn=now(),hn=Xt(dn);if(kt=arguments,Mt=this,Vt=dn,hn){if(Bt===void 0)return Yt(Vt);if(Gt)return Bt=setTimeout(Qt,$t),Wt(Vt)}return Bt===void 0&&(Bt=setTimeout(Qt,$t)),jt}return ln.cancel=Zt,ln.flush=sn,ln}function isObject$2(xt){var $t=typeof xt;return!!xt&&($t=="object"||$t=="function")}function isObjectLike(xt){return!!xt&&typeof xt=="object"}function isSymbol(xt){return typeof xt=="symbol"||isObjectLike(xt)&&objectToString.call(xt)==symbolTag}function toNumber$2(xt){if(typeof xt=="number")return xt;if(isSymbol(xt))return NAN;if(isObject$2(xt)){var $t=typeof xt.valueOf=="function"?xt.valueOf():xt;xt=isObject$2($t)?$t+"":$t}if(typeof xt!="string")return xt===0?xt:+xt;xt=xt.replace(reTrim,"");var Ct=reIsBinary.test(xt);return Ct||reIsOctal.test(xt)?freeParseInt(xt.slice(2),Ct?2:8):reIsBadHex.test(xt)?NAN:+xt}var lodash_debounce=debounce$1;const debounce$2=getDefaultExportFromCjs$1(lodash_debounce);function YAxis({yScale:xt,xRange:$t,horizontalPosition:Ct,label:kt}){const Mt=reactExports.useMemo(()=>xt.ticks(5).map(jt=>({value:jt,yOffset:xt(jt)})),[xt]),Ft=reactExports.useMemo(()=>format$6(".2s"),[]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("g",{transform:`translate(${Ct-60}, ${xt.range()[0]}) rotate(-90)`,children:jsxRuntimeExports.jsx("foreignObject",{width:Math.abs(xt.range()[1]-xt.range()[0]),height:20,children:jsxRuntimeExports.jsx(Center$2,{children:jsxRuntimeExports.jsx(Group$1,{gap:3,children:jsxRuntimeExports.jsx(Text,{size:"14px",style:{color:"#878E95"},children:kt})})})})}),jsxRuntimeExports.jsx("path",{transform:`translate(${Ct}, 0)`,d:["M",0,xt.range()[0],"V",xt.range()[1]].join(" "),fill:"none",stroke:"lightgray"}),jsxRuntimeExports.jsx("path",{transform:`translate(${$t[1]}, 0)`,d:["M",0,xt.range()[0],"V",xt.range()[1]].join(" "),fill:"none",stroke:"lightgray"}),Mt.map(({value:jt,yOffset:Bt})=>jsxRuntimeExports.jsxs("g",{transform:`translate(${Ct}, ${Bt})`,children:[jsxRuntimeExports.jsx("line",{x2:"-6",stroke:"currentColor"}),jsxRuntimeExports.jsx("line",{x2:`${$t[1]-$t[0]}`,stroke:`${jt===0?"black":"lightgray"}`}),jsxRuntimeExports.jsx("text",{style:{dominantBaseline:"middle",fontSize:"10px",textAnchor:"end",transform:"translateX(-8px)",fill:"black",font:"Roboto"},children:Ft(jt)},jt)]},jt))]})}const __vite_glob_0_5=Object.freeze(Object.defineProperty({__proto__:null,YAxis},Symbol.toStringTag,{value:"Module"})),BRUSH_SIZE=15;function Paintbrush({xScale:xt,yScale:$t,setBrushedSpace:Ct,params:kt,data:Mt,brushState:Ft,isSelect:jt=!0}){const[Bt,Vt]=reactExports.useState([0,0]),[zt,Ht]=reactExports.useState(!1);return reactExports.useEffect(()=>{const Gt=select$1("#scatterSvgBrushStudy");if(Gt){const qt=Gt.node().getBoundingClientRect();Gt.on("mousemove",Wt=>{const Yt=[Wt.clientX-qt.x,Wt.clientY-qt.y];if(Vt(Yt),zt){const Kt=Mt.filter(Xt=>Math.abs(xt(Xt[kt.x])-Yt[0])<BRUSH_SIZE&&Math.abs($t(Xt[kt.y])-Yt[1])<BRUSH_SIZE);if(Wt.ctrlKey||Wt.metaKey||!jt){const Xt=new Set(Ft.ids);Kt.forEach(Jt=>{Xt.has(Jt[kt.ids])&&Xt.delete(Jt[kt.ids])});const Qt=Array.from(Xt);Ct([[Bt[0],Bt[1]],[Bt[0],Bt[1]]],xt,$t,Qt.length===0?"clear":"drag",Qt)}else{const Xt=Array.from(new Set([...Ft.ids,...Kt.map(Qt=>Qt[kt.ids])]));Xt.length>0&&Ct([[Bt[0],Bt[1]],[Bt[0],Bt[1]]],xt,$t,"drag",Xt)}}}),Gt.on("mousedown",Wt=>{Ht(!0),Wt.stopPropagation(),Wt.preventDefault()}),Gt.on("mouseup",()=>{Ht(!1)})}},[Bt,Ft.ids,Mt,zt,jt,kt,Ct,xt,$t]),jsxRuntimeExports.jsx("circle",{style:{cursor:zt?"pointer":"default"},r:BRUSH_SIZE,fill:"darkgray",opacity:.5,cx:Bt[0],cy:Bt[1]})}const __vite_glob_0_2=Object.freeze(Object.defineProperty({__proto__:null,Paintbrush},Symbol.toStringTag,{value:"Module"})),margin={top:15,left:100,right:15,bottom:70};function Scatter({setFilteredTable:xt,brushState:$t,setBrushedSpace:Ct,brushType:kt,params:Mt,data:Ft,brushedPoints:jt}){const[Bt,{height:Vt,width:zt}]=useResizeObserver$1(),[Ht]=useResizeObserver$1(),[Gt]=useResizeObserver$1(),[qt,Wt]=reactExports.useState(!0),Yt=reactExports.useMemo(()=>zt-margin.left-margin.right,[zt]),Kt=reactExports.useMemo(()=>Vt-margin.top-margin.bottom,[Vt]),Xt=reactExports.useMemo(()=>{const yn=Array.from(new Set(Ft.map(gn=>gn[Mt.category])));return ordinal(Tableau10).domain(yn)},[Ft,Mt.category]),{xMin:Qt,yMin:Jt,xMax:Zt,yMax:sn}=reactExports.useMemo(()=>{const yn=Ft.map($n=>+$n[Mt.x]).filter($n=>$n!==null),[gn,En]=extent$1(yn),bn=Ft.map($n=>+$n[Mt.y]).filter($n=>$n!==null),[xn,Cn]=extent$1(bn);return{xMin:gn,xMax:En,yMin:xn,yMax:Cn}},[Ft,Mt.x,Mt.y]),ln=reactExports.useMemo(()=>{const yn=Zt-Qt;return Yt<=0?null:Mt.dataType==="date"?time$1([margin.left,Yt+margin.left]).domain([new Date("2014-12-20"),new Date("2016-01-10")]):linear$1([margin.left,Yt+margin.left]).domain([Qt-yn/10,Zt+yn/10]).nice()},[Mt.dataType,Yt,Zt,Qt]),dn=reactExports.useMemo(()=>{const yn=sn-Jt;return Kt<=0?null:linear$1([Kt+margin.top,margin.top]).domain([Jt-yn/10,sn+yn/10]).nice()},[Kt,sn,Jt]),hn=reactExports.useMemo(()=>{if(!ln||!dn)return()=>null;if(kt==="Axis Selection"){const yn=brushX().extent([[margin.left,margin.top+Kt-5],[margin.left+Yt,margin.top+Kt+5]]).on("brush end",En=>{En.sourceEvent!==void 0&&Ct([[En.selection[0],null],[En.selection[1],null]],ln,dn,En.mode)}),gn=brushY().extent([[margin.left-5,margin.top],[margin.left+5,margin.top+Kt]]).on("brush end",En=>{En.sourceEvent!==void 0&&Ct([[null,En.selection[0]],[null,En.selection[1]]],ln,dn,En.mode)});return Ht.current&&Gt.current&&(select$1(Gt.current).call(gn),select$1(Ht.current).call(yn),$t.hasBrush||(select$1(Gt.current).call(gn.move,[dn(sn),dn(Jt)]),select$1(Ht.current).call(yn.move,[ln(new Date("2015-01-02")),ln(new Date("2015-12-31"))]),Ct([[ln(new Date("2015-01-02")),dn(sn)],[ln(new Date("2015-12-31")),dn(Jt)]],ln,dn,"drag"))),()=>{select$1(Gt.current).call(gn.move,[dn(sn),dn(Jt)]),select$1(Ht.current).call(yn.move,[ln(new Date("2015-01-02")),ln(new Date("2015-12-31"))]),Ct([[ln(new Date("2015-01-02")),dn(sn)],[ln(new Date("2015-12-31")),dn(Jt)]],ln,dn,"clear")}}if(kt==="Rectangular Selection"){const yn=brush().extent([[margin.left,margin.top],[margin.left+Yt,margin.top+Kt]]).on("brush",gn=>{gn.sourceEvent!==void 0&&Ct([[gn.selection[0][0],gn.selection[0][1]],[gn.selection[1][0],gn.selection[1][1]]],ln,dn,gn.mode)}).on("end",gn=>{gn.selection===null&&gn.sourceEvent!==void 0&&(select$1(Bt.current).call(yn.move,null),xt(null))});return select$1(Bt.current).call(yn),()=>{select$1(Bt.current).call(yn.move,null),Ct([[null,null],[null,null]],ln,dn,"clear")}}return kt==="Slider Selection"?($t.hasBrush||Ct([[ln(Qt),dn(sn)],[ln(Zt),dn(Jt)]],ln,dn,null),()=>Ct([[ln(Qt),dn(sn)],[ln(Zt),dn(Jt)]],ln,dn,"clear")):kt==="Paintbrush Selection"?()=>Ct([[ln(Qt),dn(sn)],[ln(Zt),dn(Jt)]],ln,dn,"clear",[]):()=>null},[$t.hasBrush,kt,Ht,Gt,Kt,Bt,Ct,xt,Yt,Zt,Qt,ln,sn,Jt,dn]),cn=reactExports.useMemo(()=>jt.length===0?null:new Set(jt),[jt]),pn=reactExports.useMemo(()=>!ln||!dn?null:Ft.map((yn,gn)=>{if(yn[Mt.x]===null||yn[Mt.y]===null)return null;const En=Mt.dataType==="date"?ln(new Date(yn[Mt.x])):ln(yn[Mt.x]);return jsxRuntimeExports.jsx("circle",{opacity:cn&&!cn.has(yn[Mt.ids])?.3:1,r:3,fill:cn&&!cn.has(yn[Mt.ids])?"lightgray":Xt(yn[Mt.category]),cx:En,cy:dn(yn[Mt.y])},gn)}),[cn,Xt,Ft,Mt.category,Mt.dataType,Mt.ids,Mt.x,Mt.y,ln,dn]);return reactExports.useEffect(()=>{kt==="Axis Selection"&&selectAll(".handle").style("fill","darkgrey")},[$t,kt]),jsxRuntimeExports.jsxs(Stack$1,{children:[jsxRuntimeExports.jsxs(Group$1,{children:[jsxRuntimeExports.jsx(Button,{ml:60,size:"compact-sm",style:{width:"130px"},disabled:jt.length===0,onClick:()=>{xt(null),hn==null||hn()},children:"Clear Selection"}),Mt.brushType==="Paintbrush Selection"?jsxRuntimeExports.jsx(SegmentedControl,{defaultChecked:!0,value:qt?"Select":"De-Select",onChange:yn=>Wt(yn==="Select"),data:[{label:"Select",value:"Select"},{label:"De-Select",value:"De-Select",disabled:jt.length===0}]}):null]}),jsxRuntimeExports.jsxs(Group$1,{style:{width:"100%",height:"100%"},wrap:"nowrap",children:[jsxRuntimeExports.jsxs("svg",{id:"scatterSvgBrushStudy",ref:Bt,style:{height:"500px",width:Mt.brushType==="Axis Selection"?"800px":"530px",fontFamily:'BlinkMacSystemFont, -apple-system, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", "Helvetica", "Arial", sans-serif'},children:[ln&&dn?jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx(YAxis,{yScale:dn,label:Mt.y,horizontalPosition:margin.left,xRange:ln.range()}),jsxRuntimeExports.jsx(XAxisBar,{xScale:ln,yRange:dn.range(),isDate:Mt.dataType==="date",vertPosition:Kt+margin.top,label:Mt.x,ticks:ln.ticks(Mt.brushType==="Axis Selection"?12:5).map(yn=>({value:yn.toString(),offset:ln(yn)}))})]}):null,pn,jsxRuntimeExports.jsx("g",{id:"brushXRef",ref:Ht}),jsxRuntimeExports.jsx("g",{id:"brushYRef",ref:Gt}),ln&&dn&&kt==="Paintbrush Selection"?jsxRuntimeExports.jsx(Paintbrush,{brushState:$t,setBrushedSpace:Ct,params:Mt,data:Ft,isSelect:qt,xScale:ln,yScale:dn}):null]}),kt==="Slider Selection"&&ln&&dn?jsxRuntimeExports.jsxs(Stack$1,{style:{flexGrow:1},gap:50,children:[jsxRuntimeExports.jsxs(Stack$1,{gap:0,children:[jsxRuntimeExports.jsx(Text,{children:Mt.x}),jsxRuntimeExports.jsx(RangeSlider,{minRange:1,label:null,min:ln.domain()[0],max:ln.domain()[1],labelAlwaysOn:!1,onChange:yn=>{Ct([[ln(yn[0]),$t.y1],[ln(yn[1]),$t.y2]],ln,dn,"drag")},style:{width:"300px"},marks:ln.ticks(5).map(yn=>({value:yn,label:yn})),value:[ln.invert($t.x1),ln.invert($t.x2)]})]}),jsxRuntimeExports.jsxs(Stack$1,{gap:0,children:[jsxRuntimeExports.jsx(Text,{children:Mt.y}),jsxRuntimeExports.jsx(RangeSlider,{minRange:1,label:null,min:dn.domain()[0],max:dn.domain()[1],onChange:yn=>{Ct([[$t.x1,dn(yn[1])],[$t.x2,dn(yn[0])]],ln,dn,"drag")},style:{width:"300px"},marks:dn.ticks(5).map(yn=>({value:yn,label:yn})),value:[dn.invert($t.y2),dn.invert($t.y1)]})]})]}):null]})]})}const __vite_glob_0_3=Object.freeze(Object.defineProperty({__proto__:null,Scatter,default:Scatter},Symbol.toStringTag,{value:"Module"}));function BrushPlot({parameters:xt,setAnswer:$t}){const[Ct,kt]=reactExports.useState(null),[Mt,Ft]=reactExports.useState({hasBrush:!1,x1:0,y1:0,x2:0,y2:0,ids:[]}),[jt,Bt]=reactExports.useState(null);reactExports.useEffect(()=>{csv(`./data/${xt.dataset}.csv`).then(Xt=>{Bt(Xt)})},[xt]);const Vt=reactExports.useMemo(()=>jt?from(jt):null,[jt]),{actions:zt,trrack:Ht}=reactExports.useMemo(()=>{const Xt=Ke.create(),Qt=Xt.register("brush",(dn,hn)=>(dn.all={brush:hn},dn)),Jt=Xt.register("brushMove",(dn,hn)=>(dn.all={brush:hn},dn)),Zt=Xt.register("brushResize",(dn,hn)=>(dn.all={brush:hn},dn)),sn=Xt.register("brushClear",(dn,hn)=>(dn.all={brush:hn},dn)),ln=Ut({registry:Xt,initialState:{all:{hasBrush:!1,x1:null,x2:null,y1:null,y2:null,ids:[]}}});return{actions:{brush:Qt,brushMove:Jt,brushResize:Zt,clearBrush:sn},trrack:ln}},[]),Gt=reactExports.useCallback((Xt,Qt)=>{Xt==="drag"?Ht.apply("Move Brush",zt.brushMove(Qt)):Xt==="handle"&&Ht.apply("Brush",zt.brush(Qt))},[zt,Ht]),qt=reactExports.useMemo(()=>debounce$2(Gt,100,{maxWait:100}),[Gt]),Wt=reactExports.useCallback((Xt,Qt,Jt,Zt,sn)=>{if(!Qt||!Jt)return;const ln=Qt.invert(Xt[0][0]||Mt.x1),dn=Qt.invert(Xt[1][0]||Mt.x2),hn=Jt.invert(Xt[1][1]||Mt.y2),cn=Jt.invert(Xt[0][1]||Mt.y1);let pn=null;if(Zt==="clear")pn=Vt;else if(sn){const gn=new Set(sn);pn=Vt.filter(escape$1(En=>gn.has(En[xt.ids])))}else xt.brushType==="Axis Selection"?pn=Vt.filter(escape$1(gn=>new Date(gn[xt.x])>=new Date(ln)&&new Date(gn[xt.x])<=new Date(dn)&&gn[xt.y]>=hn&&gn[xt.y]<=cn)):pn=Vt.filter(escape$1(gn=>gn[xt.x]>=ln&&gn[xt.x]<=dn&&gn[xt.y]>=hn&&gn[xt.y]<=cn));const yn={x1:Xt[0][0]||(Mt==null?void 0:Mt.x1)||0,x2:Xt[1][0]||(Mt==null?void 0:Mt.x2)||0,y1:Xt[0][1]||(Mt==null?void 0:Mt.y1)||0,y2:Xt[1][1]||(Mt==null?void 0:Mt.y2)||0,hasBrush:Zt!=="clear",ids:Zt!=="clear"?pn==null?void 0:pn.array("id"):[]};Ft(yn),Zt==="drag"||Zt==="handle"?qt(Zt,yn):Zt==="clear"&&Ht.apply("Clear Brush",zt.clearBrush(yn)),kt(pn),$t({status:!0,provenanceGraph:Ht.graph.backend,answers:{}})},[Mt,Vt,xt,Ht,$t,qt,zt]),Yt=reactExports.useMemo(()=>Ct?Ct==null?void 0:Ct.groupby(xt.category).count():Vt?Vt==null?void 0:Vt.groupby(xt.category).count():null,[Ct,Vt,xt.category]),Kt=reactExports.useCallback(Xt=>{kt(Xt)},[]);return jt?jsxRuntimeExports.jsxs(Stack$1,{gap:"xs",children:[jsxRuntimeExports.jsx(Scatter,{brushedPoints:Mt==null?void 0:Mt.ids,data:jt,params:xt,brushType:xt.brushType,setBrushedSpace:Wt,brushState:Mt,setFilteredTable:Kt}),jsxRuntimeExports.jsx(Bar,{data:jt,parameters:xt,barsTable:Yt})]}):jsxRuntimeExports.jsx(Loader,{})}const __vite_glob_0_1=Object.freeze(Object.defineProperty({__proto__:null,BrushPlot,default:BrushPlot},Symbol.toStringTag,{value:"Module"})),__vite_glob_0_7=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),combineChartDimensions=xt=>{const $t={...xt,marginTop:xt.marginTop||10,marginRight:xt.marginRight||10,marginBottom:xt.marginBottom||40,marginLeft:xt.marginLeft||75};return{...$t,boundedHeight:$t.height?Math.max($t.height-$t.marginTop-$t.marginBottom,0):0,boundedWidth:$t.width?Math.max($t.width-$t.marginLeft-$t.marginRight,0):0}},useChartDimensions=xt=>{const $t=reactExports.useRef(null),Ct=combineChartDimensions(xt),[kt,Mt]=reactExports.useState(0),[Ft,jt]=reactExports.useState(0);reactExports.useEffect(()=>{const Vt=$t.current;if(Vt){const zt=new ResizeObserver(Ht=>{if(!Array.isArray(Ht)||!Ht.length)return;const Gt=Ht[0];kt!==Gt.contentRect.width&&Mt(Gt.contentRect.width),Ft!==Gt.contentRect.height&&jt(Gt.contentRect.height)});return zt.observe(Vt),()=>zt.unobserve(Vt)}return()=>null},[Ft,kt]);const Bt=combineChartDimensions({...Ct,width:Ct.width||kt,height:Ct.height||Ft});return[$t,Bt]},__vite_glob_0_21=Object.freeze(Object.defineProperty({__proto__:null,useChartDimensions},Symbol.toStringTag,{value:"Module"}));function Bars({data:xt,xScale:$t,yScale:Ct,height:kt}){return jsxRuntimeExports.jsx("g",{children:xt.map((Mt,Ft)=>jsxRuntimeExports.jsx("rect",{x:$t(Mt.name),y:Ct(Mt.value),width:$t.bandwidth(),height:kt-Ct(Mt.value),fill:"transparent",stroke:"currentColor"},Ft))})}const __vite_glob_0_12=Object.freeze(Object.defineProperty({__proto__:null,Bars},Symbol.toStringTag,{value:"Module"}));function NumericAxisV({domain:xt=[0,100],range:$t=[10,100],withTick:Ct=!0,tickLen:kt=5,tickFilter:Mt=Ft=>Ft}){const Ft=reactExports.useMemo(()=>{const jt=linear$1().domain(xt).range($t),Bt=$t[1]-$t[0],zt=Math.max(1,Math.floor(Bt/30));return Mt(jt.ticks(zt).map(Ht=>({value:Ht,xOffset:jt(Ht)})))},[xt,$t,Mt]);return jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx("path",{d:["M",0,$t[0],"h",kt,"V",$t[1],"h",-kt].join(" "),fill:"none",stroke:"currentColor"}),Ct&&Ft.map(({value:jt,xOffset:Bt})=>jsxRuntimeExports.jsxs("g",{transform:`translate(0,${Bt})`,children:[jsxRuntimeExports.jsx("line",{x2:`${kt}`,stroke:"currentColor"}),jsxRuntimeExports.jsx("text",{style:{fontSize:"10px",textAnchor:"middle",transform:"translateX(-10px)"},children:jt},jt)]},jt))]})}const __vite_glob_0_16=Object.freeze(Object.defineProperty({__proto__:null,NumericAxisV},Symbol.toStringTag,{value:"Module"}));function OrdinalAxisHWithDotMarks({domain:xt=["A","B","C","D","E"],range:$t=[10,100],withTick:Ct=!0,tickLen:kt=5,tickFilter:Mt=Ft=>Ft}){const Ft=reactExports.useMemo(()=>{const jt=band$1().domain(xt).range($t).padding(.2);return Mt(xt.map(Bt=>({value:Bt,xOffset:(jt(Bt)||0)+jt.bandwidth()/2-5})))},[xt,$t,Mt]);return jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx("path",{d:["M",$t[0],kt,"v",-kt,"H",$t[1],"v",kt].join(" "),fill:"none",stroke:"currentColor"}),Ct&&Ft.map(({value:jt,xOffset:Bt})=>jsxRuntimeExports.jsx("g",{transform:`translate(${Bt}, 10)`,children:jsxRuntimeExports.jsx("circle",{r:2,cx:0,cy:0,children:jt},jt)},jt))]})}const __vite_glob_0_17=Object.freeze(Object.defineProperty({__proto__:null,OrdinalAxisHWithDotMarks},Symbol.toStringTag,{value:"Module"})),chartSettings$4={marginBottom:40,marginLeft:40,marginTop:15,marginRight:15,width:400,height:400};function BarChart({parameters:xt}){const[Ct,kt]=useChartDimensions(chartSettings$4),Mt=band$1().domain(xt.data.map(Vt=>Vt.name)).range([0,kt.boundedWidth]).padding(.2),Ft=linear$1().domain([100,0]).range([0,kt.boundedHeight]),jt=Vt=>Vt.filter((zt,Ht)=>Ht===0||Ht===Vt.length-1),Bt=Vt=>Vt.filter((zt,Ht)=>xt.selectedIndices.includes(Ht));return jsxRuntimeExports.jsx("div",{className:"Chart__wrapper",ref:Ct,style:{height:400},children:jsxRuntimeExports.jsx("svg",{width:kt.width,height:kt.height,children:jsxRuntimeExports.jsxs("g",{transform:`translate(${[kt.marginLeft,kt.marginTop].join(",")})`,children:[jsxRuntimeExports.jsx("g",{transform:`translate(${[6,kt.boundedHeight].join(",")})`,children:jsxRuntimeExports.jsx(OrdinalAxisHWithDotMarks,{domain:Mt.domain(),range:Mt.range(),withTick:!0,tickLen:0,tickFilter:Bt})}),jsxRuntimeExports.jsx("g",{transform:`translate(${[0,0].join(",")})`,children:jsxRuntimeExports.jsx(NumericAxisV,{domain:Ft.domain(),range:Ft.range(),withTick:!0,tickLen:6,tickFilter:jt})}),jsxRuntimeExports.jsx("g",{transform:`translate(${[0,0].join(",")})`,children:jsxRuntimeExports.jsx(Bars,{data:xt.data,xScale:Mt,yScale:Ft,height:kt.boundedHeight})})]})})})}const __vite_glob_0_8=Object.freeze(Object.defineProperty({__proto__:null,default:BarChart},Symbol.toStringTag,{value:"Module"}));function Bubbles({data:xt}){return jsxRuntimeExports.jsx("g",{children:xt.map(({bubble:$t},Ct)=>jsxRuntimeExports.jsx("circle",{cx:$t.x,cy:$t.y,r:$t.r,fill:"transparent",stroke:"currentColor"},Ct))})}const __vite_glob_0_13=Object.freeze(Object.defineProperty({__proto__:null,Bubbles},Symbol.toStringTag,{value:"Module"}));function DotMarks({positions:xt}){return jsxRuntimeExports.jsx("g",{children:xt.map(($t,Ct)=>jsxRuntimeExports.jsx("circle",{cx:$t.x,cy:$t.y,r:2,fill:"black",stroke:"currentColor"},Ct))})}const __vite_glob_0_14=Object.freeze(Object.defineProperty({__proto__:null,DotMarks},Symbol.toStringTag,{value:"Module"})),chartSettings$3={marginBottom:40,marginLeft:40,marginTop:15,marginRight:15,height:400,width:400},createBubbleData=({data:xt},$t=100,Ct=100)=>{const Mt={children:xt.map(Bt=>+Bt.value).map(Bt=>({value:Bt}))},Ft=pack().size([$t-10,Ct-10]).padding(1.5),jt=hierarchy(Mt).sum(Bt=>Bt.value);return Ft(jt).descendants().filter(Bt=>!Bt.children).map((Bt,Vt)=>({bubble:Bt,data:xt[Vt]}))},createMarkPositions=(xt,$t)=>xt.filter((Ct,kt)=>$t.includes(kt)).map(({bubble:Ct})=>({x:Ct.x,y:Ct.y}));function BubbleChart({parameters:xt}){const[$t,Ct]=useChartDimensions(chartSettings$3),kt=createBubbleData(xt,Ct.width,Ct.height),Mt=createMarkPositions(kt,xt.selectedIndices);return jsxRuntimeExports.jsx("div",{className:"Chart__wrapper",ref:$t,style:{height:"400px"},children:jsxRuntimeExports.jsx("svg",{width:Ct.width,height:Ct.height,children:jsxRuntimeExports.jsxs("g",{transform:`translate(${[Ct.marginLeft/2,Ct.marginTop/2].join(",")})`,children:[jsxRuntimeExports.jsx(Bubbles,{data:kt}),jsxRuntimeExports.jsx(DotMarks,{positions:Mt})]})})})}const __vite_glob_0_9=Object.freeze(Object.defineProperty({__proto__:null,default:BubbleChart},Symbol.toStringTag,{value:"Module"}));function Slices({arcs:xt}){return jsxRuntimeExports.jsx("g",{children:xt.map(($t,Ct)=>jsxRuntimeExports.jsx("path",{d:$t(),fill:"transparent",stroke:"currentColor"},Ct))})}const __vite_glob_0_18=Object.freeze(Object.defineProperty({__proto__:null,Slices},Symbol.toStringTag,{value:"Module"}));function SlicesDotMarks({positions:xt}){return jsxRuntimeExports.jsx("g",{children:xt.map(($t,Ct)=>jsxRuntimeExports.jsx("g",{transform:`translate(${$t.centroid()})`,children:jsxRuntimeExports.jsx("circle",{r:2,cx:0,cy:0},Ct)},Ct))})}const __vite_glob_0_19=Object.freeze(Object.defineProperty({__proto__:null,SlicesDotMarks},Symbol.toStringTag,{value:"Module"})),chartSettings$2={marginBottom:40,marginLeft:40,marginTop:15,marginRight:15,height:400,width:500},angleGen=pie().value(xt=>xt.value),radius$1=150;function PieChart({parameters:xt}){const[$t,Ct]=useChartDimensions(chartSettings$2),kt=angleGen(xt.data),Mt=kt.map(jt=>arc$2$1().innerRadius(0).outerRadius(radius$1).startAngle(jt.startAngle).endAngle(jt.endAngle)),Ft=kt.map(jt=>arc$2$1().outerRadius(radius$1+10).innerRadius(radius$1+10).startAngle(jt.startAngle).endAngle(jt.endAngle)).filter((jt,Bt)=>xt.selectedIndices.includes(Bt));return jsxRuntimeExports.jsx("div",{className:"Chart__wrapper",ref:$t,style:{height:400},children:jsxRuntimeExports.jsx("svg",{width:Ct.width,height:Ct.height,children:jsxRuntimeExports.jsxs("g",{transform:`translate(${[Ct.marginLeft+radius$1,Ct.marginTop+radius$1].join(",")})`,children:[jsxRuntimeExports.jsx(Slices,{arcs:Mt}),jsxRuntimeExports.jsx(SlicesDotMarks,{positions:Ft})]})})})}const __vite_glob_0_10=Object.freeze(Object.defineProperty({__proto__:null,default:PieChart},Symbol.toStringTag,{value:"Module"}));function NumericAxisH({domain:xt=[0,100],range:$t=[10,100],withTick:Ct=!0,tickLen:kt=5,tickFilter:Mt=Ft=>Ft}){const Ft=reactExports.useMemo(()=>{const jt=linear$1().domain(xt).range($t),Bt=$t[1]-$t[0],zt=Math.max(1,Math.floor(Bt/30));return Mt(jt.ticks(zt).map(Ht=>({value:Ht,xOffset:jt(Ht)})))},[xt,$t,Mt]);return jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx("path",{d:["M",$t[0],kt,"v",-kt,"H",$t[1],"v",kt].join(" "),fill:"none",stroke:"currentColor"}),Ct&&Ft.map(({value:jt,xOffset:Bt})=>jsxRuntimeExports.jsxs("g",{transform:`translate(${Bt}, 0)`,children:[jsxRuntimeExports.jsx("line",{y2:`${kt}`,stroke:"currentColor"}),jsxRuntimeExports.jsx("text",{style:{fontSize:"10px",textAnchor:"middle",transform:"translateY(20px)"},children:jt},jt)]},jt))]})}const __vite_glob_0_15=Object.freeze(Object.defineProperty({__proto__:null,NumericAxisH},Symbol.toStringTag,{value:"Module"}));function StackedBars({data:xt,barWidth:$t,yScale:Ct}){return jsxRuntimeExports.jsx("g",{children:xt.map((kt,Mt)=>jsxRuntimeExports.jsx("rect",{x:$t/2,y:Ct(kt[0][1]),width:$t,height:Ct(kt[0][0])-Ct(kt[0][1]),fill:"transparent",stroke:"currentColor"},Mt))})}const __vite_glob_0_20=Object.freeze(Object.defineProperty({__proto__:null,StackedBars},Symbol.toStringTag,{value:"Module"})),chartSettings$1={marginBottom:40,marginLeft:40,marginTop:15,marginRight:15,height:400,width:400};function StackedBarChart({parameters:xt}){const[Ct,kt]=useChartDimensions(chartSettings$1),Mt=band$1().domain(xt.data.map(Wt=>Wt.name)).range([0,kt.boundedWidth]).padding(.2),Ft=linear$1().domain([100,0]).range([0,kt.boundedWidth]),jt=Wt=>Wt.filter((Yt,Kt)=>Kt===0||Kt===Wt.length-1),Bt=Wt=>Wt.filter((Yt,Kt)=>xt.selectedIndices.includes(Kt)),Vt=Wt=>{const Yt=Wt.map(Zt=>+Zt.value),Xt=Yt.reduce((Zt,sn)=>Number(Zt)+Number(sn))/100,Qt={};Yt.forEach((Zt,sn)=>{Qt[String.fromCharCode(sn+65)]=Zt/Xt});const Jt=[Qt];return stack$1().keys(xt.data.map(Zt=>Zt.name))(Jt)},zt=(Wt,Yt,Kt)=>Wt.filter((Qt,Jt)=>Yt.includes(Jt)).map(Qt=>({x:Kt,y:Ft(Qt[0][1])+.5*(Ft(Qt[0][0])-Ft(Qt[0][1]))})),Ht=Vt(xt.data),Gt=Math.min(kt.width,kt.height)/2-20,qt=zt(Ht,xt.selectedIndices,Gt);return jsxRuntimeExports.jsx("div",{className:"Chart__wrapper",ref:Ct,style:{height:"400"},children:jsxRuntimeExports.jsx("svg",{width:kt.width,height:kt.height,children:jsxRuntimeExports.jsxs("g",{transform:`translate(${[kt.marginLeft,kt.marginTop].join(",")})`,children:[jsxRuntimeExports.jsx("g",{transform:`translate(${[6,kt.boundedHeight].join(",")})`,children:jsxRuntimeExports.jsx(NumericAxisH,{domain:Mt.domain(),range:Mt.range(),withTick:!0,tickLen:0,tickFilter:Bt})}),jsxRuntimeExports.jsx("g",{transform:"translate(0, 0)",children:jsxRuntimeExports.jsx(NumericAxisV,{domain:Ft.domain(),range:Ft.range(),withTick:!0,tickLen:6,tickFilter:jt})}),jsxRuntimeExports.jsxs("g",{transform:"translate(0, 0)",children:[jsxRuntimeExports.jsx(StackedBars,{data:Ht,barWidth:Gt,yScale:Ft}),jsxRuntimeExports.jsx(DotMarks,{positions:qt})]})]})})})}const __vite_glob_0_11=Object.freeze(Object.defineProperty({__proto__:null,default:StackedBarChart},Symbol.toStringTag,{value:"Module"})),chartSettings={marginBottom:40,marginLeft:40,marginTop:15,marginRight:15,height:650,width:850};function ClickAccuracyTest({parameters:xt,setAnswer:$t}){const[Ct,kt]=useChartDimensions(chartSettings),[Mt,Ft]=reactExports.useState(100),[jt,Bt]=reactExports.useState(100),[Vt,zt]=reactExports.useState(300),{taskid:Ht}=xt,{actions:Gt,trrack:qt}=reactExports.useMemo(()=>{const Yt=Ke.create(),Kt=Yt.register("click",(Qt,Jt)=>(Qt.clickX=Jt.clickX,Qt.clickY=Jt.clickY,Qt.distance=Jt.distance,Qt)),Xt=Ut({registry:Yt,initialState:{distance:0,speed:10,clickX:0,clickY:0}});return{actions:{clickAction:Kt},trrack:Xt}},[]),Wt=reactExports.useCallback(Yt=>{const Kt=select$1("#movingCircle"),Xt=select$1("#clickAccuracySvg"),Qt=pointer(Yt,Xt.node()),Jt=[+Kt.attr("cx"),+Kt.attr("cy")],Zt=`${Math.round(Math.sqrt((Qt[0]-Jt[0])**2+(Qt[1]-Jt[1])**2))}px`;qt.apply("Clicked",Gt.clickAction({distance:+Zt,clickX:Qt[0],clickY:Qt[1]})),$t({status:!0,provenanceGraph:qt.graph.backend,answers:{[Ht]:Zt}})},[Gt,$t,Ht,qt]);return reactExports.useEffect(()=>{const Yt=Math.random()*800,Kt=Math.random()*600,Qt=Math.sqrt((Yt-Mt)**2+(Kt-jt)**2)/Vt*1e3;select$1(Ct.current).select("circle").transition().duration(Qt).ease(linear$2).attr("cx",Yt).attr("cy",Kt).on("end",()=>{Ft(Yt),Bt(Kt)})},[Ct,Vt,Mt,jt]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"Chart__wrapper",ref:Ct,onClick:Wt,style:{height:"650px"},children:jsxRuntimeExports.jsx("svg",{id:"clickAccuracySvg",width:kt.width,height:kt.height,children:jsxRuntimeExports.jsxs("g",{transform:`translate(${[kt.marginLeft/2,kt.marginTop/2].join(",")})`,children:[jsxRuntimeExports.jsx("rect",{width:"800",height:"600",stroke:"black",strokeWidth:"5",fill:"none"}),jsxRuntimeExports.jsx("circle",{id:"movingCircle",cx:"100",cy:"100",r:"10"})]})})}),jsxRuntimeExports.jsxs(Box,{children:["Adjust speed (px/s):",jsxRuntimeExports.jsx(Slider,{w:800,min:10,max:1e3,value:Vt,onChange:zt})]})]})}const __vite_glob_0_22=Object.freeze(Object.defineProperty({__proto__:null,default:ClickAccuracyTest},Symbol.toStringTag,{value:"Module"}));function Ranking({rankings:xt}){return jsxRuntimeExports.jsx("div",{style:{fontFamily:"sans-serif"},children:jsxRuntimeExports.jsx("div",{children:xt.map(($t,Ct)=>jsxRuntimeExports.jsx("div",{style:{textAlign:"center",marginBottom:1,padding:2,background:`${$t===0?"#AEC7E8":"#FF9896"}`},children:$t===0?"Group A":"Group B"},Ct))})})}function FairnessJND({parameters:xt,setAnswer:$t}){const Ct=useCurrentComponent(),[kt,Mt]=reactExports.useState(""),{goToNextStep:Ft,isNextDisabled:jt}=useNextStep(),Bt=reactExports.useMemo(()=>Math.floor(Math.random()*2)===0?"r1":"r2",[]),[Vt]=reactExports.useState(new URLSearchParams(window.location.search)),zt=(Vt.get("admin")||"f")==="t",Ht=reactExports.useCallback(Wt=>{Mt(Wt),$t({status:!0,answers:{[`${Ct}/leftARP`]:Bt==="r1"?xt.data.r1ARP:xt.data.r2ARP,[`${Ct}/rightARP`]:Bt==="r2"?xt.data.r1ARP:xt.data.r2ARP,[`${Ct}/leftRanking`]:JSON.stringify(Bt==="r1"?xt.data.r1:xt.data.r2),[`${Ct}/rightRanking`]:JSON.stringify(Bt==="r2"?xt.data.r1:xt.data.r2),[`${Ct}/choice`]:Wt,[`${Ct}/correctChoice`]:Bt==="r1"&&parseFloat(xt.data.r1ARP)<parseFloat(xt.data.r2ARP)?"left":"right"}})},[Ct,Bt,xt.data,$t]),Gt=reactExports.useCallback(()=>{jt||Ft()},[jt,Ft]);reactExports.useEffect(()=>{const Wt=getHotkeyHandler([["ArrowLeft",()=>Ht("left")],["ArrowRight",()=>Ht("right")],["Enter",Gt]]);return document.body.addEventListener("keydown",Wt),()=>{document.body.removeEventListener("keydown",Wt)}},[Ht,Gt]);let qt=!1;return Bt==="r1"?(kt==="left"&&parseFloat(xt.data.r1ARP)<parseFloat(xt.data.r2ARP)||kt==="right"&&parseFloat(xt.data.r2ARP)<parseFloat(xt.data.r1ARP))&&(qt=!0):(kt==="left"&&parseFloat(xt.data.r2ARP)<parseFloat(xt.data.r1ARP)||kt==="right"&&parseFloat(xt.data.r1ARP)<parseFloat(xt.data.r2ARP))&&(qt=!0),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs(Grid,{children:[jsxRuntimeExports.jsxs(Grid.Col,{span:2,children:[jsxRuntimeExports.jsx(Ranking,{rankings:Bt==="r1"?xt.data.r1:xt.data.r2}),jsxRuntimeExports.jsx(Button,{fullWidth:!0,disabled:kt==="left",onClick:()=>{Ht("left")},children:kt==="left"?jsxRuntimeExports.jsx(IconCircleCheck,{}):"Select this ranking"}),zt&&kt&&jsxRuntimeExports.jsx("div",{children:Bt==="r1"?xt.data.r1ARP:xt.data.r2ARP})]}),jsxRuntimeExports.jsxs(Grid.Col,{span:2,children:[jsxRuntimeExports.jsx(Ranking,{rankings:Bt==="r1"?xt.data.r2:xt.data.r1}),jsxRuntimeExports.jsx(Button,{fullWidth:!0,disabled:kt==="right",onClick:()=>{Ht("right")},children:kt==="right"?jsxRuntimeExports.jsx(IconCircleCheck,{}):"Select this ranking"}),zt&&kt&&jsxRuntimeExports.jsx("div",{children:Bt==="r1"?xt.data.r2ARP:xt.data.r1ARP})]})]}),zt&&kt&&jsxRuntimeExports.jsx("div",{style:{padding:20,textAlign:"center",width:300},children:qt?"CORRECT":"INCORRECT"})]})}const __vite_glob_0_23=Object.freeze(Object.defineProperty({__proto__:null,default:FairnessJND},Symbol.toStringTag,{value:"Module"})),badge$4="_badge_2n7qn_1",sourceItem$4="_sourceItem_2n7qn_10",sourceItemBadge$4="_sourceItemBadge_2n7qn_14",splitWord="_splitWord_2n7qn_22",splitter="_splitter_2n7qn_22",splitWordActive="_splitWordActive_2n7qn_26",styles={badge:badge$4,sourceItem:sourceItem$4,sourceItemBadge:sourceItemBadge$4,splitWord,splitter,splitWordActive};function SourceItem$4({source:xt,isActive:$t,onActiveRefChange:Ct}){const kt=React$1.useRef(null);return reactExports.useEffect(()=>{var Mt;$t&&((Mt=kt.current)==null||Mt.scrollIntoView({behavior:"smooth",block:"center"}),Ct(kt.current))},[xt.id,$t,Ct]),jsxRuntimeExports.jsx(Text,{className:styles.sourceItem,ref:kt,component:"span",px:5,children:jsxRuntimeExports.jsx(Text,{component:"span",bg:$t?"blue.3":"transparent",dangerouslySetInnerHTML:{__html:xt.text}})})}const MemoizedSourceItem$4=React$1.memo(SourceItem$4);function Source$4({sourceList:xt,activeSourceId:$t,onSourceBadgePositionChange:Ct}){var Ht;const kt=React$1.useRef(null),Mt=React$1.useRef(null),[Ft,jt]=React$1.useState(0),[Bt,Vt]=React$1.useState(0);reactExports.useEffect(()=>{if(kt.current){const Gt=kt.current,qt=()=>{var Wt,Yt;Vt((Gt==null?void 0:Gt.getBoundingClientRect().left)||0),jt(((Wt=Mt.current)==null?void 0:Wt.getBoundingClientRect().top)||0),Ct((Gt==null?void 0:Gt.getBoundingClientRect().left)||0,((Yt=Mt.current)==null?void 0:Yt.getBoundingClientRect().top)||0)};return kt.current.addEventListener("scroll",qt),()=>{Gt.removeEventListener("scroll",qt)}}return()=>{}},[kt,Ct]);const zt=reactExports.useCallback(Gt=>{Mt.current=Gt},[]);return reactExports.useEffect(()=>{var qt,Wt;const Gt=kt.current;Vt((Gt==null?void 0:Gt.getBoundingClientRect().left)||0),jt(((qt=Mt.current)==null?void 0:qt.getBoundingClientRect().top)||0),Ct((Gt==null?void 0:Gt.getBoundingClientRect().left)||0,((Wt=Mt.current)==null?void 0:Wt.getBoundingClientRect().top)||0)},[$t,Ct]),jsxRuntimeExports.jsxs(ScrollArea,{style:{height:"calc(100vh - 110px)"},viewportRef:kt,children:[jsxRuntimeExports.jsx(Title,{order:2,children:"Source Document"}),xt.map((Gt,qt)=>jsxRuntimeExports.jsx(MemoizedSourceItem$4,{source:Gt,isActive:Gt.id===$t,onActiveRefChange:zt},qt)),$t&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Badge,{className:styles.sourceItemBadge,color:"blue.5",style:{position:"fixed",left:Bt-10,top:Ft,transform:"translate(-100%, 0)"},children:$t},$t),jsxRuntimeExports.jsx("div",{style:{position:"fixed",left:Bt-10,top:Ft+16,backgroundColor:"var(--mantine-color-blue-5)",height:2,width:((Ht=kt.current)==null?void 0:Ht.clientWidth)||0}})]})]})}const __vite_glob_0_24=Object.freeze(Object.defineProperty({__proto__:null,default:Source$4},Symbol.toStringTag,{value:"Module"}));function SummarySourceItem$4({sentence:xt,src:$t,idx:Ct,onSourceClick:kt,activeSourceId:Mt}){const Ft=React$1.useRef(null);return jsxRuntimeExports.jsxs(React$1.Fragment,{children:[jsxRuntimeExports.jsx(Badge,{ref:Ft,className:styles.badge,onClick:()=>{kt(Ft.current,xt.id,$t)},style:{cursor:"pointer"},color:Mt===$t?"blue.5":"gray.5",children:$t}),Ct<xt.sources.length-1&&", "]},Ct)}function Summary$4({sentences:xt,onSourceClick:$t,activeSourceId:Ct,onSummaryBadgePositionChange:kt}){const Mt=React$1.useRef(null),Ft=React$1.useRef(null),[jt,Bt]=React$1.useState(0),[Vt,zt]=React$1.useState(0),[Ht,Gt]=React$1.useState(0);reactExports.useEffect(()=>{if(Mt.current){const Wt=Mt.current,Yt=()=>{var Kt,Xt,Qt,Jt;Bt(((Kt=Ft.current)==null?void 0:Kt.getBoundingClientRect().top)||0),Gt(((Xt=Ft.current)==null?void 0:Xt.getBoundingClientRect().left)||0),zt(((Qt=Mt.current)==null?void 0:Qt.getBoundingClientRect().right)||0),kt(((Jt=Ft.current)==null?void 0:Jt.getBoundingClientRect().top)||0)};return Mt.current.addEventListener("scroll",Yt),()=>{Wt.removeEventListener("scroll",Yt)}}return()=>{}},[Mt,kt]);const qt=xt.map((Wt,Yt)=>{const Kt=/^(.*?)([.?!])?$/,Xt=Wt.text.match(Kt),Qt=Xt?Xt[1]:Wt.text,Jt=Xt?Xt[2]:"",Zt=(sn,ln,dn)=>{var hn;$t(ln,dn),kt((sn==null?void 0:sn.getBoundingClientRect().top)||0),Ft.current=sn,Bt((sn==null?void 0:sn.getBoundingClientRect().top)||0),Gt((sn==null?void 0:sn.getBoundingClientRect().left)||0),zt(((hn=Mt.current)==null?void 0:hn.getBoundingClientRect().right)||0)};return jsxRuntimeExports.jsxs(React$1.Fragment,{children:[Qt," ",Wt.sources.length>0&&jsxRuntimeExports.jsxs("span",{children:["[",Wt.sources.map((sn,ln)=>jsxRuntimeExports.jsx(SummarySourceItem$4,{sentence:Wt,src:sn,idx:ln,onSourceClick:Zt,activeSourceId:Ct},ln)),"]"]}),Jt," "]},Yt)});return jsxRuntimeExports.jsxs(ScrollArea,{style:{height:"calc(100vh - 110px)"},viewportRef:Mt,children:[jsxRuntimeExports.jsx(Title,{order:2,mb:16,children:"LLM-Generated Summary"}),jsxRuntimeExports.jsx(Text,{children:qt}),jsxRuntimeExports.jsx("div",{style:{position:"fixed",top:jt+18,left:Ht+5,backgroundColor:"var(--mantine-color-blue-5)",height:2,width:Vt-Ht+35}})]})}const __vite_glob_0_25=Object.freeze(Object.defineProperty({__proto__:null,default:Summary$4},Symbol.toStringTag,{value:"Module"}));function Word({text:xt,wordIdx:$t,isActive:Ct,onClick:kt}){const Mt=()=>{kt($t)};return jsxRuntimeExports.jsxs("span",{className:`${styles.splitWord} ${Ct&&styles.splitWordActive}`,children:[jsxRuntimeExports.jsx("span",{onClick:Mt,children:xt}),jsxRuntimeExports.jsx("span",{className:styles.splitter,onClick:Mt,children:" "})]})}function WordSplit({text:xt,onWordClick:$t,chunkBreaks:Ct}){return jsxRuntimeExports.jsx("div",{children:xt.split(" ").map((kt,Mt)=>jsxRuntimeExports.jsx(Word,{wordIdx:Mt,text:kt,onClick:$t,isActive:Ct[Mt]},Mt))})}function SummaryApp$7({parameters:xt,setAnswer:$t}){const[Ct,kt]=reactExports.useState(0);useNextStep();const[Mt,Ft]=reactExports.useState({}),[jt]=reactExports.useState(xt),{actions:Bt,trrack:Vt}=reactExports.useMemo(()=>{const Gt=Ke.create(),qt=Gt.register("click",(Yt,Kt)=>(Yt.documentIdx=Kt.documentIdx,Yt.documentPath=Kt.documentPath,Yt)),Wt=Ut({registry:Gt,initialState:{documentIdx:0,documentPath:jt.documents[0]}});return{actions:{documentClickAction:qt},trrack:Wt}},[jt]);reactExports.useEffect(()=>{jt.documents.length&&kt(0)},[jt]);const zt=Gt=>{const qt={...Mt};qt[Gt]=!qt[Gt],Ft(qt)},Ht=reactExports.useMemo(()=>{if(Object.keys(Mt).length){const Gt=jt.documentText.split(" "),qt=Object.keys(Mt).reduce((Xt,Qt)=>{const Jt=+Qt;return Mt[Jt]&&Xt.push(Jt),Xt},[]);let Wt=0,Yt=0;const Kt=qt.reduce((Xt,Qt)=>(Yt=Qt+1,Xt.push(Gt.slice(Wt,Yt)),Wt=Qt+1,Xt),[]);return Kt.push(Gt.slice(Wt)),Kt}return[jt.documentText.split(" ")]},[jt.documentText,Mt]);return reactExports.useEffect(()=>{$t({status:!0,provenanceGraph:Vt.graph.backend,answers:{"q-splittext":Ht.length===1?null:Ht.map(Gt=>Gt.join(" "))}})},[Ht,Vt]),jsxRuntimeExports.jsx(Box,{pos:"relative",children:jsxRuntimeExports.jsxs(Grid,{gutter:50,children:[jsxRuntimeExports.jsx(Grid.Col,{span:2}),jsxRuntimeExports.jsx(Grid.Col,{span:8,children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{children:"Document:"}),jsxRuntimeExports.jsx(WordSplit,{text:jt.documentText,chunkBreaks:Mt,onWordClick:zt})]})})]})})}const SummaryApp$8=reactExports.memo(SummaryApp$7),__vite_glob_0_26=Object.freeze(Object.defineProperty({__proto__:null,default:SummaryApp$8},Symbol.toStringTag,{value:"Module"})),__vite_glob_0_27=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),badge$3="_badge_1xjx6_1",sourceItem$3="_sourceItem_1xjx6_10",sourceItemBadge$3="_sourceItemBadge_1xjx6_14",style$4={badge:badge$3,sourceItem:sourceItem$3,sourceItemBadge:sourceItemBadge$3};function SourceItem$3({source:xt,isActive:$t,onActiveRefChange:Ct}){const kt=React$1.useRef(null);return reactExports.useEffect(()=>{var Mt;$t&&((Mt=kt.current)==null||Mt.scrollIntoView({behavior:"smooth",block:"center"}),Ct(kt.current))},[xt.id,$t,Ct]),jsxRuntimeExports.jsx(Text,{className:style$4.sourceItem,ref:kt,component:"span",px:5,children:jsxRuntimeExports.jsx(Text,{component:"span",bg:$t?"blue.3":"transparent",dangerouslySetInnerHTML:{__html:xt.text}})})}const MemoizedSourceItem$3=React$1.memo(SourceItem$3);function Source$3({sourceList:xt,activeSourceId:$t,onSourceBadgePositionChange:Ct}){var Ht;const kt=React$1.useRef(null),Mt=React$1.useRef(null),[Ft,jt]=React$1.useState(0),[Bt,Vt]=React$1.useState(0);reactExports.useEffect(()=>{if(kt.current){const Gt=kt.current,qt=()=>{var Wt,Yt;Vt((Gt==null?void 0:Gt.getBoundingClientRect().left)||0),jt(((Wt=Mt.current)==null?void 0:Wt.getBoundingClientRect().top)||0),Ct((Gt==null?void 0:Gt.getBoundingClientRect().left)||0,((Yt=Mt.current)==null?void 0:Yt.getBoundingClientRect().top)||0)};return kt.current.addEventListener("scroll",qt),()=>{Gt.removeEventListener("scroll",qt)}}return()=>{}},[kt,Ct]);const zt=reactExports.useCallback(Gt=>{Mt.current=Gt},[]);return reactExports.useEffect(()=>{var qt,Wt;const Gt=kt.current;Vt((Gt==null?void 0:Gt.getBoundingClientRect().left)||0),jt(((qt=Mt.current)==null?void 0:qt.getBoundingClientRect().top)||0),Ct((Gt==null?void 0:Gt.getBoundingClientRect().left)||0,((Wt=Mt.current)==null?void 0:Wt.getBoundingClientRect().top)||0)},[$t,Ct]),jsxRuntimeExports.jsxs(ScrollArea,{style:{height:"calc(100vh - 110px)"},viewportRef:kt,children:[jsxRuntimeExports.jsx(Title,{order:2,children:"Source Document"}),xt.map((Gt,qt)=>jsxRuntimeExports.jsx(MemoizedSourceItem$3,{source:Gt,isActive:Gt.id===$t,onActiveRefChange:zt},qt)),$t&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Badge,{className:style$4.sourceItemBadge,color:"blue.5",style:{position:"fixed",left:Bt-10,top:Ft,transform:"translate(-100%, 0)"},children:$t},$t),jsxRuntimeExports.jsx("div",{style:{position:"fixed",left:Bt-10,top:Ft+16,backgroundColor:"var(--mantine-color-blue-5)",height:2,width:((Ht=kt.current)==null?void 0:Ht.clientWidth)||0}})]})]})}const __vite_glob_0_28=Object.freeze(Object.defineProperty({__proto__:null,default:Source$3},Symbol.toStringTag,{value:"Module"}));function SummarySourceItem$3({sentence:xt,src:$t,idx:Ct,onSourceClick:kt,activeSourceId:Mt}){const Ft=React$1.useRef(null);return jsxRuntimeExports.jsxs(React$1.Fragment,{children:[jsxRuntimeExports.jsx(Badge,{ref:Ft,className:style$4.badge,onClick:()=>{kt(Ft.current,xt.id,$t)},style:{cursor:"pointer"},color:Mt===$t?"blue.5":"gray.5",children:$t}),Ct<xt.sources.length-1&&", "]},Ct)}function Summary$3({sentences:xt,onSourceClick:$t,activeSourceId:Ct,onSummaryBadgePositionChange:kt}){const Mt=React$1.useRef(null),Ft=React$1.useRef(null),[jt,Bt]=React$1.useState(0),[Vt,zt]=React$1.useState(0),[Ht,Gt]=React$1.useState(0);reactExports.useEffect(()=>{if(Mt.current){const Wt=Mt.current,Yt=()=>{var Kt,Xt,Qt,Jt;Bt(((Kt=Ft.current)==null?void 0:Kt.getBoundingClientRect().top)||0),Gt(((Xt=Ft.current)==null?void 0:Xt.getBoundingClientRect().left)||0),zt(((Qt=Mt.current)==null?void 0:Qt.getBoundingClientRect().right)||0),kt(((Jt=Ft.current)==null?void 0:Jt.getBoundingClientRect().top)||0)};return Mt.current.addEventListener("scroll",Yt),()=>{Wt.removeEventListener("scroll",Yt)}}return()=>{}},[Mt,kt]);const qt=xt.map((Wt,Yt)=>{const Kt=/^(.*?)([.?!])?$/,Xt=Wt.text.match(Kt),Qt=Xt?Xt[1]:Wt.text,Jt=Xt?Xt[2]:"",Zt=(sn,ln,dn)=>{var hn;$t(ln,dn),kt((sn==null?void 0:sn.getBoundingClientRect().top)||0),Ft.current=sn,Bt((sn==null?void 0:sn.getBoundingClientRect().top)||0),Gt((sn==null?void 0:sn.getBoundingClientRect().left)||0),zt(((hn=Mt.current)==null?void 0:hn.getBoundingClientRect().right)||0)};return jsxRuntimeExports.jsxs(React$1.Fragment,{children:[Qt," ",Wt.sources.length>0&&jsxRuntimeExports.jsxs("span",{children:["[",Wt.sources.map((sn,ln)=>jsxRuntimeExports.jsx(SummarySourceItem$3,{sentence:Wt,src:sn,idx:ln,onSourceClick:Zt,activeSourceId:Ct},ln)),"]"]}),Jt," "]},Yt)});return jsxRuntimeExports.jsxs(ScrollArea,{style:{height:"calc(100vh - 110px)"},viewportRef:Mt,children:[jsxRuntimeExports.jsx(Title,{order:2,mb:16,children:"LLM-Generated Summary"}),jsxRuntimeExports.jsx(Text,{children:qt}),jsxRuntimeExports.jsx("div",{style:{position:"fixed",top:jt+18,left:Ht+5,backgroundColor:"var(--mantine-color-blue-5)",height:2,width:Vt-Ht+35}})]})}const __vite_glob_0_29=Object.freeze(Object.defineProperty({__proto__:null,default:Summary$3},Symbol.toStringTag,{value:"Module"}));var lib={exports:{}},core_min={};function commonjsRequire(xt){throw new Error('Could not dynamically require "'+xt+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function($t,Ct){module.exports=Ct()})(globalThis,()=>(()=>{var __webpack_modules__=[,(xt,$t)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.VerbosityLevel=$t.Util=$t.UnknownErrorException=$t.UnexpectedResponseException=$t.UNSUPPORTED_FEATURES=$t.TextRenderingMode=$t.RenderingIntentFlag=$t.PermissionFlag=$t.PasswordResponses=$t.PasswordException=$t.PageActionEventType=$t.OPS=$t.MissingPDFException=$t.LINE_FACTOR=$t.LINE_DESCENT_FACTOR=$t.InvalidPDFException=$t.ImageKind=$t.IDENTITY_MATRIX=$t.FormatError=$t.FeatureTest=$t.FONT_IDENTITY_MATRIX=$t.DocumentActionEventType=$t.CMapCompressionType=$t.BaseException=$t.BASELINE_FACTOR=$t.AnnotationType=$t.AnnotationStateModelType=$t.AnnotationReviewState=$t.AnnotationReplyType=$t.AnnotationMode=$t.AnnotationMarkedState=$t.AnnotationFlag=$t.AnnotationFieldFlag=$t.AnnotationEditorType=$t.AnnotationEditorPrefix=$t.AnnotationEditorParamsType=$t.AnnotationBorderStyleType=$t.AnnotationActionEventType=$t.AbortException=void 0,$t.assert=Sn,$t.bytesToString=mr,$t.createPromiseCapability=Zr,$t.createValidAbsoluteUrl=_n,$t.getModificationDate=Xr,$t.getVerbosityLevel=wn,$t.info=Rn,$t.isArrayBuffer=Tr,$t.isArrayEqual=Hr,$t.objectFromMap=Bn,$t.objectSize=Hn,$t.setVerbosityLevel=$n,$t.shadow=Tn,$t.string32=Fn,$t.stringToBytes=kn,$t.stringToPDFString=jr,$t.stringToUTF8String=Mr,$t.unreachable=An,$t.utf8StringToString=pr,$t.warn=Dn;const Ct=[1,0,0,1,0,0];$t.IDENTITY_MATRIX=Ct;const kt=[.001,0,0,.001,0,0];$t.FONT_IDENTITY_MATRIX=kt;const Mt=1.35;$t.LINE_FACTOR=Mt;const Ft=.35;$t.LINE_DESCENT_FACTOR=Ft;const jt=Ft/Mt;$t.BASELINE_FACTOR=jt;const Bt={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};$t.RenderingIntentFlag=Bt;const Vt={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};$t.AnnotationMode=Vt;const zt="pdfjs_internal_editor_";$t.AnnotationEditorPrefix=zt;const Ht={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};$t.AnnotationEditorType=Ht;const Gt={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};$t.AnnotationEditorParamsType=Gt;const qt={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};$t.PermissionFlag=qt;const Wt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};$t.TextRenderingMode=Wt;const Yt={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};$t.ImageKind=Yt;const Kt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};$t.AnnotationType=Kt;const Xt={MARKED:"Marked",REVIEW:"Review"};$t.AnnotationStateModelType=Xt;const Qt={MARKED:"Marked",UNMARKED:"Unmarked"};$t.AnnotationMarkedState=Qt;const Jt={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};$t.AnnotationReviewState=Jt;const Zt={GROUP:"Group",REPLY:"R"};$t.AnnotationReplyType=Zt;const sn={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};$t.AnnotationFlag=sn;const ln={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};$t.AnnotationFieldFlag=ln;const dn={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};$t.AnnotationBorderStyleType=dn;const hn={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};$t.AnnotationActionEventType=hn;const cn={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};$t.DocumentActionEventType=cn;const pn={O:"PageOpen",C:"PageClose"};$t.PageActionEventType=pn;const yn={ERRORS:0,WARNINGS:1,INFOS:5};$t.VerbosityLevel=yn;const gn={NONE:0,BINARY:1};$t.CMapCompressionType=gn;const En={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};$t.OPS=En;const bn={forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};$t.UNSUPPORTED_FEATURES=bn;const xn={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};$t.PasswordResponses=xn;let Cn=yn.WARNINGS;function $n(ur){Number.isInteger(ur)&&(Cn=ur)}function wn(){return Cn}function Rn(ur){Cn>=yn.INFOS&&console.log(`Info: ${ur}`)}function Dn(ur){Cn>=yn.WARNINGS&&console.log(`Warning: ${ur}`)}function An(ur){throw new Error(ur)}function Sn(ur,hr){ur||An(hr)}function vn(ur){if(!ur)return!1;switch(ur.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function _n(ur,hr=null,gr=null){if(!ur)return null;try{if(gr&&typeof ur=="string"){if(gr.addDefaultProtocol&&ur.startsWith("www.")){const ds=ur.match(/\./g);ds&&ds.length>=2&&(ur=`http://${ur}`)}if(gr.tryConvertEncoding)try{ur=Mr(ur)}catch{}}const qr=hr?new URL(ur,hr):new URL(ur);if(vn(qr))return qr}catch{}return null}function Tn(ur,hr,gr,qr=!1){return Object.defineProperty(ur,hr,{value:gr,enumerable:!qr,configurable:!0,writable:!1}),gr}const Pn=function(){function hr(gr,qr){this.constructor===hr&&An("Cannot initialize BaseException."),this.message=gr,this.name=qr}return hr.prototype=new Error,hr.constructor=hr,hr}();$t.BaseException=Pn;class Ln extends Pn{constructor(hr,gr){super(hr,"PasswordException"),this.code=gr}}$t.PasswordException=Ln;class Vn extends Pn{constructor(hr,gr){super(hr,"UnknownErrorException"),this.details=gr}}$t.UnknownErrorException=Vn;class Un extends Pn{constructor(hr){super(hr,"InvalidPDFException")}}$t.InvalidPDFException=Un;class Wn extends Pn{constructor(hr){super(hr,"MissingPDFException")}}$t.MissingPDFException=Wn;class rr extends Pn{constructor(hr,gr){super(hr,"UnexpectedResponseException"),this.status=gr}}$t.UnexpectedResponseException=rr;class ar extends Pn{constructor(hr){super(hr,"FormatError")}}$t.FormatError=ar;class nr extends Pn{constructor(hr){super(hr,"AbortException")}}$t.AbortException=nr;function mr(ur){(typeof ur!="object"||ur===null||ur.length===void 0)&&An("Invalid argument for bytesToString");const hr=ur.length,gr=8192;if(hr<gr)return String.fromCharCode.apply(null,ur);const qr=[];for(let ds=0;ds<hr;ds+=gr){const ms=Math.min(ds+gr,hr),wr=ur.subarray(ds,ms);qr.push(String.fromCharCode.apply(null,wr))}return qr.join("")}function kn(ur){typeof ur!="string"&&An("Invalid argument for stringToBytes");const hr=ur.length,gr=new Uint8Array(hr);for(let qr=0;qr<hr;++qr)gr[qr]=ur.charCodeAt(qr)&255;return gr}function Fn(ur){return String.fromCharCode(ur>>24&255,ur>>16&255,ur>>8&255,ur&255)}function Hn(ur){return Object.keys(ur).length}function Bn(ur){const hr=Object.create(null);for(const[gr,qr]of ur)hr[gr]=qr;return hr}function jn(){const ur=new Uint8Array(4);return ur[0]=1,new Uint32Array(ur.buffer,0,1)[0]===1}function sr(){try{return new Function(""),!0}catch{return!1}}class Ar{static get isLittleEndian(){return Tn(this,"isLittleEndian",jn())}static get isEvalSupported(){return Tn(this,"isEvalSupported",sr())}static get isOffscreenCanvasSupported(){return Tn(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?Tn(this,"platform",{isWin:!1,isMac:!1}):Tn(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}$t.FeatureTest=Ar;const Fr=[...Array(256).keys()].map(ur=>ur.toString(16).padStart(2,"0"));class Rr{static makeHexColor(hr,gr,qr){return`#${Fr[hr]}${Fr[gr]}${Fr[qr]}`}static scaleMinMax(hr,gr){let qr;hr[0]?(hr[0]<0&&(qr=gr[0],gr[0]=gr[1],gr[1]=qr),gr[0]*=hr[0],gr[1]*=hr[0],hr[3]<0&&(qr=gr[2],gr[2]=gr[3],gr[3]=qr),gr[2]*=hr[3],gr[3]*=hr[3]):(qr=gr[0],gr[0]=gr[2],gr[2]=qr,qr=gr[1],gr[1]=gr[3],gr[3]=qr,hr[1]<0&&(qr=gr[2],gr[2]=gr[3],gr[3]=qr),gr[2]*=hr[1],gr[3]*=hr[1],hr[2]<0&&(qr=gr[0],gr[0]=gr[1],gr[1]=qr),gr[0]*=hr[2],gr[1]*=hr[2]),gr[0]+=hr[4],gr[1]+=hr[4],gr[2]+=hr[5],gr[3]+=hr[5]}static transform(hr,gr){return[hr[0]*gr[0]+hr[2]*gr[1],hr[1]*gr[0]+hr[3]*gr[1],hr[0]*gr[2]+hr[2]*gr[3],hr[1]*gr[2]+hr[3]*gr[3],hr[0]*gr[4]+hr[2]*gr[5]+hr[4],hr[1]*gr[4]+hr[3]*gr[5]+hr[5]]}static applyTransform(hr,gr){const qr=hr[0]*gr[0]+hr[1]*gr[2]+gr[4],ds=hr[0]*gr[1]+hr[1]*gr[3]+gr[5];return[qr,ds]}static applyInverseTransform(hr,gr){const qr=gr[0]*gr[3]-gr[1]*gr[2],ds=(hr[0]*gr[3]-hr[1]*gr[2]+gr[2]*gr[5]-gr[4]*gr[3])/qr,ms=(-hr[0]*gr[1]+hr[1]*gr[0]+gr[4]*gr[1]-gr[5]*gr[0])/qr;return[ds,ms]}static getAxialAlignedBoundingBox(hr,gr){const qr=Rr.applyTransform(hr,gr),ds=Rr.applyTransform(hr.slice(2,4),gr),ms=Rr.applyTransform([hr[0],hr[3]],gr),wr=Rr.applyTransform([hr[2],hr[1]],gr);return[Math.min(qr[0],ds[0],ms[0],wr[0]),Math.min(qr[1],ds[1],ms[1],wr[1]),Math.max(qr[0],ds[0],ms[0],wr[0]),Math.max(qr[1],ds[1],ms[1],wr[1])]}static inverseTransform(hr){const gr=hr[0]*hr[3]-hr[1]*hr[2];return[hr[3]/gr,-hr[1]/gr,-hr[2]/gr,hr[0]/gr,(hr[2]*hr[5]-hr[4]*hr[3])/gr,(hr[4]*hr[1]-hr[5]*hr[0])/gr]}static singularValueDecompose2dScale(hr){const gr=[hr[0],hr[2],hr[1],hr[3]],qr=hr[0]*gr[0]+hr[1]*gr[2],ds=hr[0]*gr[1]+hr[1]*gr[3],ms=hr[2]*gr[0]+hr[3]*gr[2],wr=hr[2]*gr[1]+hr[3]*gr[3],Wr=(qr+wr)/2,ns=Math.sqrt((qr+wr)**2-4*(qr*wr-ms*ds))/2,us=Wr+ns||1,ps=Wr-ns||1;return[Math.sqrt(us),Math.sqrt(ps)]}static normalizeRect(hr){const gr=hr.slice(0);return hr[0]>hr[2]&&(gr[0]=hr[2],gr[2]=hr[0]),hr[1]>hr[3]&&(gr[1]=hr[3],gr[3]=hr[1]),gr}static intersect(hr,gr){const qr=Math.max(Math.min(hr[0],hr[2]),Math.min(gr[0],gr[2])),ds=Math.min(Math.max(hr[0],hr[2]),Math.max(gr[0],gr[2]));if(qr>ds)return null;const ms=Math.max(Math.min(hr[1],hr[3]),Math.min(gr[1],gr[3])),wr=Math.min(Math.max(hr[1],hr[3]),Math.max(gr[1],gr[3]));return ms>wr?null:[qr,ms,ds,wr]}static bezierBoundingBox(hr,gr,qr,ds,ms,wr,Wr,ns){const us=[],ps=[[],[]];let Ls,vs,Ps,Fs,zs,Eo,js,Hs;for(let vo=0;vo<2;++vo){if(vo===0?(vs=6*hr-12*qr+6*ms,Ls=-3*hr+9*qr-9*ms+3*Wr,Ps=3*qr-3*hr):(vs=6*gr-12*ds+6*wr,Ls=-3*gr+9*ds-9*wr+3*ns,Ps=3*ds-3*gr),Math.abs(Ls)<1e-12){if(Math.abs(vs)<1e-12)continue;Fs=-Ps/vs,0<Fs&&Fs<1&&us.push(Fs);continue}js=vs*vs-4*Ps*Ls,Hs=Math.sqrt(js),!(js<0)&&(zs=(-vs+Hs)/(2*Ls),0<zs&&zs<1&&us.push(zs),Eo=(-vs-Hs)/(2*Ls),0<Eo&&Eo<1&&us.push(Eo))}let Us=us.length,Ks;const go=Us;for(;Us--;)Fs=us[Us],Ks=1-Fs,ps[0][Us]=Ks*Ks*Ks*hr+3*Ks*Ks*Fs*qr+3*Ks*Fs*Fs*ms+Fs*Fs*Fs*Wr,ps[1][Us]=Ks*Ks*Ks*gr+3*Ks*Ks*Fs*ds+3*Ks*Fs*Fs*wr+Fs*Fs*Fs*ns;return ps[0][go]=hr,ps[1][go]=gr,ps[0][go+1]=Wr,ps[1][go+1]=ns,ps[0].length=ps[1].length=go+2,[Math.min(...ps[0]),Math.min(...ps[1]),Math.max(...ps[0]),Math.max(...ps[1])]}}$t.Util=Rr;const Qn=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function jr(ur){if(ur[0]>=""){let gr;if(ur[0]===""&&ur[1]===""?gr="utf-16be":ur[0]===""&&ur[1]===""?gr="utf-16le":ur[0]===""&&ur[1]===""&&ur[2]===""&&(gr="utf-8"),gr)try{const qr=new TextDecoder(gr,{fatal:!0}),ds=kn(ur);return qr.decode(ds)}catch(qr){Dn(`stringToPDFString: "${qr}".`)}}const hr=[];for(let gr=0,qr=ur.length;gr<qr;gr++){const ds=Qn[ur.charCodeAt(gr)];hr.push(ds?String.fromCharCode(ds):ur.charAt(gr))}return hr.join("")}function Mr(ur){return decodeURIComponent(escape(ur))}function pr(ur){return unescape(encodeURIComponent(ur))}function Tr(ur){return typeof ur=="object"&&ur!==null&&ur.byteLength!==void 0}function Hr(ur,hr){if(ur.length!==hr.length)return!1;for(let gr=0,qr=ur.length;gr<qr;gr++)if(ur[gr]!==hr[gr])return!1;return!0}function Xr(ur=new Date){return[ur.getUTCFullYear().toString(),(ur.getUTCMonth()+1).toString().padStart(2,"0"),ur.getUTCDate().toString().padStart(2,"0"),ur.getUTCHours().toString().padStart(2,"0"),ur.getUTCMinutes().toString().padStart(2,"0"),ur.getUTCSeconds().toString().padStart(2,"0")].join("")}function Zr(){const ur=Object.create(null);let hr=!1;return Object.defineProperty(ur,"settled",{get(){return hr}}),ur.promise=new Promise(function(gr,qr){ur.resolve=function(ds){hr=!0,gr(ds)},ur.reject=function(ds){hr=!0,qr(ds)}}),ur}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var xt,$t,kt,Mt,Ft,jt,Bt,Vt,zt,Ht,Iu,qt,Wt,Pu,Kt,Xt;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:Jt,NodeCMapReaderFactory:Zt,NodeStandardFontDataFactory:sn}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=Jt,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=Zt,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=sn}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:Jt}=__w_pdfjs_require__(21);createPDFNetworkStream=Zt=>new Jt(Zt)}else{const{PDFNetworkStream:Jt}=__w_pdfjs_require__(24),{PDFFetchStream:Zt}=__w_pdfjs_require__(25);createPDFNetworkStream=sn=>(0,_display_utils.isValidFetchUrl)(sn.url)?new Zt(sn):new Jt(sn)}function getDocument(Jt){if(typeof Jt=="string"||Jt instanceof URL)Jt={url:Jt};else if((0,_util.isArrayBuffer)(Jt))Jt={data:Jt};else if(Jt instanceof PDFDataRangeTransport)(0,_display_utils.deprecated)("`PDFDataRangeTransport`-instance, please use a parameter object with `range`-property instead."),Jt={range:Jt};else if(typeof Jt!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!Jt.url&&!Jt.data&&!Jt.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const Zt=new PDFDocumentLoadingTask,sn=Jt.url?getUrlProp(Jt.url):null,ln=Jt.data?getDataProp(Jt.data):null,dn=Jt.httpHeaders||null,hn=Jt.withCredentials===!0,cn=Jt.password??null,pn=Jt.range instanceof PDFDataRangeTransport?Jt.range:null,yn=Number.isInteger(Jt.rangeChunkSize)&&Jt.rangeChunkSize>0?Jt.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let gn=Jt.worker instanceof PDFWorker?Jt.worker:null;const En=Jt.verbosity,bn=typeof Jt.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(Jt.docBaseUrl)?Jt.docBaseUrl:null,xn=typeof Jt.cMapUrl=="string"?Jt.cMapUrl:null,Cn=Jt.cMapPacked!==!1,$n=Jt.CMapReaderFactory||DefaultCMapReaderFactory,wn=typeof Jt.standardFontDataUrl=="string"?Jt.standardFontDataUrl:null,Rn=Jt.StandardFontDataFactory||DefaultStandardFontDataFactory,Dn=Jt.stopAtErrors!==!0,An=Number.isInteger(Jt.maxImageSize)&&Jt.maxImageSize>-1?Jt.maxImageSize:-1,Sn=Jt.isEvalSupported!==!1,vn=typeof Jt.isOffscreenCanvasSupported=="boolean"?Jt.isOffscreenCanvasSupported:!_is_node.isNodeJS,_n=typeof Jt.disableFontFace=="boolean"?Jt.disableFontFace:_is_node.isNodeJS,Tn=Jt.fontExtraProperties===!0,Pn=Jt.enableXfa===!0,Ln=Jt.ownerDocument||globalThis.document,Vn=Jt.disableRange===!0,Un=Jt.disableStream===!0,Wn=Jt.disableAutoFetch===!0,rr=Jt.pdfBug===!0,ar=pn?pn.length:Jt.length??NaN,nr=typeof Jt.useSystemFonts=="boolean"?Jt.useSystemFonts:!_is_node.isNodeJS&&!_n,mr=typeof Jt.useWorkerFetch=="boolean"?Jt.useWorkerFetch:$n===_display_utils.DOMCMapReaderFactory&&Rn===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(xn,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(wn,document.baseURI),kn=null;(0,_util.setVerbosityLevel)(En);const Fn=mr?null:{cMapReaderFactory:new $n({baseUrl:xn,isCompressed:Cn}),standardFontDataFactory:new Rn({baseUrl:wn})};if(!gn){const sr={verbosity:En,port:_worker_options.GlobalWorkerOptions.workerPort};gn=sr.port?PDFWorker.fromPort(sr):new PDFWorker(sr),Zt._worker=gn}const Hn=Zt.docId,Bn={docId:Hn,apiVersion:"3.4.120",data:ln,password:cn,disableAutoFetch:Wn,rangeChunkSize:yn,length:ar,docBaseUrl:bn,enableXfa:Pn,evaluatorOptions:{maxImageSize:An,disableFontFace:_n,ignoreErrors:Dn,isEvalSupported:Sn,isOffscreenCanvasSupported:vn,fontExtraProperties:Tn,useSystemFonts:nr,cMapUrl:mr?xn:null,standardFontDataUrl:mr?wn:null}},jn={ignoreErrors:Dn,isEvalSupported:Sn,disableFontFace:_n,fontExtraProperties:Tn,enableXfa:Pn,ownerDocument:Ln,disableAutoFetch:Wn,pdfBug:rr,styleElement:kn};return gn.promise.then(function(){if(Zt.destroyed)throw new Error("Loading aborted");const sr=_fetchDocument(gn,Bn),Ar=new Promise(function(Fr){let Rr;pn?Rr=new _transport_stream.PDFDataTransportStream({length:ar,initialData:pn.initialData,progressiveDone:pn.progressiveDone,contentDispositionFilename:pn.contentDispositionFilename,disableRange:Vn,disableStream:Un},pn):ln||(Rr=createPDFNetworkStream({url:sn,length:ar,httpHeaders:dn,withCredentials:hn,rangeChunkSize:yn,disableRange:Vn,disableStream:Un})),Fr(Rr)});return Promise.all([sr,Ar]).then(function([Fr,Rr]){if(Zt.destroyed)throw new Error("Loading aborted");const Qn=new _message_handler.MessageHandler(Hn,Fr,gn.port),jr=new WorkerTransport(Qn,Zt,Rr,jn,Fn);Zt._transport=jr,Qn.send("Ready",null)})}).catch(Zt._capability.reject),Zt}async function _fetchDocument(Jt,Zt){if(Jt.destroyed)throw new Error("Worker was destroyed");const sn=await Jt.messageHandler.sendWithPromise("GetDocRequest",Zt,Zt.data?[Zt.data.buffer]:null);if(Jt.destroyed)throw new Error("Worker was destroyed");return sn}function getUrlProp(Jt){if(Jt instanceof URL)return Jt.href;try{return new URL(Jt,window.location).href}catch{if(_is_node.isNodeJS&&typeof Jt=="string")return Jt}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(Jt){if(_is_node.isNodeJS&&typeof Buffer<"u"&&Jt instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(Jt);if(Jt instanceof Uint8Array&&Jt.byteLength===Jt.buffer.byteLength)return Jt;if(typeof Jt=="string")return(0,_util.stringToBytes)(Jt);if(typeof Jt=="object"&&!isNaN(Jt==null?void 0:Jt.length)||(0,_util.isArrayBuffer)(Jt))return new Uint8Array(Jt);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const Ct=class Ct{constructor(){Yr(this,$t,null);this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${Au(Ct,xt)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get onUnsupportedFeature(){return Kn(this,$t)}set onUnsupportedFeature(Zt){(0,_display_utils.deprecated)("The PDFDocumentLoadingTask onUnsupportedFeature property will be removed in the future."),gs(this,$t,Zt)}get promise(){return this._capability.promise}async destroy(){var Zt;this.destroyed=!0,await((Zt=this._transport)==null?void 0:Zt.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};xt=new WeakMap,$t=new WeakMap,Yr(Ct,xt,0);let PDFDocumentLoadingTask=Ct;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(Zt,sn,ln=!1,dn=null){this.length=Zt,this.initialData=sn,this.progressiveDone=ln,this.contentDispositionFilename=dn,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(Zt){this._rangeListeners.push(Zt)}addProgressListener(Zt){this._progressListeners.push(Zt)}addProgressiveReadListener(Zt){this._progressiveReadListeners.push(Zt)}addProgressiveDoneListener(Zt){this._progressiveDoneListeners.push(Zt)}onDataRange(Zt,sn){for(const ln of this._rangeListeners)ln(Zt,sn)}onDataProgress(Zt,sn){this._readyCapability.promise.then(()=>{for(const ln of this._progressListeners)ln(Zt,sn)})}onDataProgressiveRead(Zt){this._readyCapability.promise.then(()=>{for(const sn of this._progressiveReadListeners)sn(Zt)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const Zt of this._progressiveDoneListeners)Zt()})}transportReady(){this._readyCapability.resolve()}requestDataRange(Zt,sn){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(Zt,sn){this._pdfInfo=Zt,this._transport=sn}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(Zt){return this._transport.getPage(Zt)}getPageIndex(Zt){return this._transport.getPageIndex(Zt)}getDestinations(){return this._transport.getDestinations()}getDestination(Zt){return this._transport.getDestination(Zt)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(Zt=!1){return this._transport.startCleanup(Zt||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(Zt,sn,ln,dn,hn=!1){this._pageIndex=Zt,this._pageInfo=sn,this._ownerDocument=dn,this._transport=ln,this._stats=hn?new _display_utils.StatTimer:null,this._pdfBug=hn,this.commonObjs=ln.commonObjs,this.objs=new PDFObjects,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:Zt,rotation:sn=this.rotate,offsetX:ln=0,offsetY:dn=0,dontFlip:hn=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:Zt,rotation:sn,offsetX:ln,offsetY:dn,dontFlip:hn})}getAnnotations({intent:Zt="display"}={}){const sn=this._transport.getRenderingIntent(Zt);return this._transport.getAnnotations(this._pageIndex,sn.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var Zt;return((Zt=this._transport._htmlForXfa)==null?void 0:Zt.children[this._pageIndex])||null}render({canvasContext:Zt,viewport:sn,intent:ln="display",annotationMode:dn=_util.AnnotationMode.ENABLE,transform:hn=null,canvasFactory:cn=null,background:pn=null,optionalContentConfigPromise:yn=null,annotationCanvasMap:gn=null,pageColors:En=null,printAnnotationStorage:bn=null}){var Sn,vn;(Sn=this._stats)==null||Sn.time("Overall");const xn=this._transport.getRenderingIntent(ln,dn,bn);this.pendingCleanup=!1,yn||(yn=this._transport.getOptionalContentConfig());let Cn=this._intentStates.get(xn.cacheKey);Cn||(Cn=Object.create(null),this._intentStates.set(xn.cacheKey,Cn)),Cn.streamReaderCancelTimeout&&(clearTimeout(Cn.streamReaderCancelTimeout),Cn.streamReaderCancelTimeout=null);const $n=cn||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),wn=!!(xn.renderingIntent&_util.RenderingIntentFlag.PRINT);Cn.displayReadyCapability||(Cn.displayReadyCapability=(0,_util.createPromiseCapability)(),Cn.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(vn=this._stats)==null||vn.time("Page Request"),this._pumpOperatorList(xn));const Rn=_n=>{var Tn,Pn;Cn.renderTasks.delete(Dn),(this.cleanupAfterRender||wn)&&(this.pendingCleanup=!0),this._tryCleanup(),_n?(Dn.capability.reject(_n),this._abortOperatorList({intentState:Cn,reason:_n instanceof Error?_n:new Error(_n)})):Dn.capability.resolve(),(Tn=this._stats)==null||Tn.timeEnd("Rendering"),(Pn=this._stats)==null||Pn.timeEnd("Overall")},Dn=new InternalRenderTask({callback:Rn,params:{canvasContext:Zt,viewport:sn,transform:hn,background:pn},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:gn,operatorList:Cn.operatorList,pageIndex:this._pageIndex,canvasFactory:$n,useRequestAnimationFrame:!wn,pdfBug:this._pdfBug,pageColors:En});(Cn.renderTasks||(Cn.renderTasks=new Set)).add(Dn);const An=Dn.task;return Promise.all([Cn.displayReadyCapability.promise,yn]).then(([_n,Tn])=>{var Pn;if(this.pendingCleanup){Rn();return}(Pn=this._stats)==null||Pn.time("Rendering"),Dn.initializeGraphics({transparency:_n,optionalContentConfig:Tn}),Dn.operatorListChanged()}).catch(Rn),An}getOperatorList({intent:Zt="display",annotationMode:sn=_util.AnnotationMode.ENABLE,printAnnotationStorage:ln=null}={}){var yn;function dn(){cn.operatorList.lastChunk&&(cn.opListReadCapability.resolve(cn.operatorList),cn.renderTasks.delete(pn))}const hn=this._transport.getRenderingIntent(Zt,sn,ln,!0);let cn=this._intentStates.get(hn.cacheKey);cn||(cn=Object.create(null),this._intentStates.set(hn.cacheKey,cn));let pn;return cn.opListReadCapability||(pn=Object.create(null),pn.operatorListChanged=dn,cn.opListReadCapability=(0,_util.createPromiseCapability)(),(cn.renderTasks||(cn.renderTasks=new Set)).add(pn),cn.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(yn=this._stats)==null||yn.time("Page Request"),this._pumpOperatorList(hn)),cn.opListReadCapability.promise}streamTextContent({disableCombineTextItems:Zt=!1,includeMarkedContent:sn=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:Zt!==!0,includeMarkedContent:sn===!0},{highWaterMark:100,size(dn){return dn.items.length}})}getTextContent(Zt={}){if(this._transport._htmlForXfa)return this.getXfa().then(ln=>_xfa_text.XfaText.textContent(ln));const sn=this.streamTextContent(Zt);return new Promise(function(ln,dn){function hn(){cn.read().then(function({value:yn,done:gn}){if(gn){ln(pn);return}Object.assign(pn.styles,yn.styles),pn.items.push(...yn.items),hn()},dn)}const cn=sn.getReader(),pn={items:[],styles:Object.create(null)};hn()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const Zt=[];for(const sn of this._intentStates.values())if(this._abortOperatorList({intentState:sn,reason:new Error("Page was destroyed."),force:!0}),!sn.opListReadCapability)for(const ln of sn.renderTasks)Zt.push(ln.completed),ln.cancel();return this.objs.clear(),this.pendingCleanup=!1,Promise.all(Zt)}cleanup(Zt=!1){return this.pendingCleanup=!0,this._tryCleanup(Zt)}_tryCleanup(Zt=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:sn,operatorList:ln}of this._intentStates.values())if(sn.size>0||!ln.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Zt&&this._stats&&(this._stats=new _display_utils.StatTimer),this.pendingCleanup=!1,!0}_startRenderPage(Zt,sn){var dn,hn;const ln=this._intentStates.get(sn);ln&&((dn=this._stats)==null||dn.timeEnd("Page Request"),(hn=ln.displayReadyCapability)==null||hn.resolve(Zt))}_renderPageChunk(Zt,sn){for(let ln=0,dn=Zt.length;ln<dn;ln++)sn.operatorList.fnArray.push(Zt.fnArray[ln]),sn.operatorList.argsArray.push(Zt.argsArray[ln]);sn.operatorList.lastChunk=Zt.lastChunk,sn.operatorList.separateAnnots=Zt.separateAnnots;for(const ln of sn.renderTasks)ln.operatorListChanged();Zt.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:Zt,cacheKey:sn,annotationStorageMap:ln}){const hn=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:Zt,cacheKey:sn,annotationStorage:ln}).getReader(),cn=this._intentStates.get(sn);cn.streamReader=hn;const pn=()=>{hn.read().then(({value:yn,done:gn})=>{if(gn){cn.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(yn,cn),pn())},yn=>{if(cn.streamReader=null,!this._transport.destroyed){if(cn.operatorList){cn.operatorList.lastChunk=!0;for(const gn of cn.renderTasks)gn.operatorListChanged();this._tryCleanup()}if(cn.displayReadyCapability)cn.displayReadyCapability.reject(yn);else if(cn.opListReadCapability)cn.opListReadCapability.reject(yn);else throw yn}})};pn()}_abortOperatorList({intentState:Zt,reason:sn,force:ln=!1}){if(Zt.streamReader){if(Zt.streamReaderCancelTimeout&&(clearTimeout(Zt.streamReaderCancelTimeout),Zt.streamReaderCancelTimeout=null),!ln){if(Zt.renderTasks.size>0)return;if(sn instanceof _display_utils.RenderingCancelledException){let dn=RENDERING_CANCELLED_TIMEOUT;sn.extraDelay>0&&sn.extraDelay<1e3&&(dn+=sn.extraDelay),Zt.streamReaderCancelTimeout=setTimeout(()=>{Zt.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:Zt,reason:sn,force:!0})},dn);return}}if(Zt.streamReader.cancel(new _util.AbortException(sn.message)).catch(()=>{}),Zt.streamReader=null,!this._transport.destroyed){for(const[dn,hn]of this._intentStates)if(hn===Zt){this._intentStates.delete(dn);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Yr(this,kt,new Set);Yr(this,Mt,Promise.resolve())}postMessage(Zt,sn){const ln={data:structuredClone(Zt,sn)};Kn(this,Mt).then(()=>{for(const dn of Kn(this,kt))dn.call(this,ln)})}addEventListener(Zt,sn){Kn(this,kt).add(sn)}removeEventListener(Zt,sn){Kn(this,kt).delete(sn)}terminate(){Kn(this,kt).clear()}}kt=new WeakMap,Mt=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const Jt=(Ft=document==null?void 0:document.currentScript)==null?void 0:Ft.src;Jt&&(PDFWorkerUtil.fallbackWorkerSrc=Jt.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(Jt,Zt){let sn;try{if(sn=new URL(Jt),!sn.origin||sn.origin==="null")return!1}catch{return!1}const ln=new URL(Zt,sn);return sn.origin===ln.origin},PDFWorkerUtil.createCDNWrapper=function(Jt){const Zt=`importScripts("${Jt}");`;return URL.createObjectURL(new Blob([Zt]))}}const _PDFWorker=class _PDFWorker{constructor({name:Jt=null,port:Zt=null,verbosity:sn=(0,_util.getVerbosityLevel)()}={}){if(Zt&&Kn(_PDFWorker,jt).has(Zt))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=Jt,this.destroyed=!1,this.verbosity=sn,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,Zt){Kn(_PDFWorker,jt).set(Zt,this),this._initializeFromPort(Zt);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(Jt){this._port=Jt,this._messageHandler=new _message_handler.MessageHandler("main","worker",Jt),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:Jt}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,Jt)||(Jt=PDFWorkerUtil.createCDNWrapper(new URL(Jt,window.location).href));const Zt=new Worker(Jt),sn=new _message_handler.MessageHandler("main","worker",Zt),ln=()=>{Zt.removeEventListener("error",dn),sn.destroy(),Zt.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},dn=()=>{this._webWorker||ln()};Zt.addEventListener("error",dn),sn.on("test",cn=>{if(Zt.removeEventListener("error",dn),this.destroyed){ln();return}cn?(this._messageHandler=sn,this._port=Zt,this._webWorker=Zt,this._readyCapability.resolve(),sn.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),sn.destroy(),Zt.terminate())}),sn.on("ready",cn=>{if(Zt.removeEventListener("error",dn),this.destroyed){ln();return}try{hn()}catch{this._setupFakeWorker()}});const hn=()=>{const cn=new Uint8Array;sn.send("test",cn,[cn.buffer])};hn();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(Jt=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const Zt=new LoopbackPort;this._port=Zt;const sn=`fake${PDFWorkerUtil.fakeWorkerId++}`,ln=new _message_handler.MessageHandler(sn+"_worker",sn,Zt);Jt.setup(ln,Zt);const dn=new _message_handler.MessageHandler(sn,sn+"_worker",Zt);this._messageHandler=dn,this._readyCapability.resolve(),dn.send("configure",{verbosity:this.verbosity})}).catch(Jt=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${Jt.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),Kn(_PDFWorker,jt).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(Jt){if(!(Jt!=null&&Jt.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Kn(this,jt).has(Jt.port)?Kn(this,jt).get(Jt.port):new _PDFWorker(Jt)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var Jt;try{return((Jt=globalThis.pdfjsWorker)==null?void 0:Jt.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};jt=new WeakMap,Yr(_PDFWorker,jt,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(Zt,sn,ln,dn,hn){Yr(this,Ht);Yr(this,Bt,new Map);Yr(this,Vt,new Map);Yr(this,zt,new Map);this.messageHandler=Zt,this.loadingTask=sn,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:dn.ownerDocument,styleElement:dn.styleElement}),this._params=dn,this.cMapReaderFactory=hn==null?void 0:hn.cMapReaderFactory,this.standardFontDataFactory=hn==null?void 0:hn.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=ln,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(Zt,sn=_util.AnnotationMode.ENABLE,ln=null,dn=!1){let hn=_util.RenderingIntentFlag.DISPLAY,cn=null;switch(Zt){case"any":hn=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":hn=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${Zt}`)}switch(sn){case _util.AnnotationMode.DISABLE:hn+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:hn+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:hn+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,cn=(hn&_util.RenderingIntentFlag.PRINT&&ln instanceof _annotation_storage.PrintAnnotationStorage?ln:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${sn}`)}return dn&&(hn+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:hn,cacheKey:`${hn}_${_annotation_storage.AnnotationStorage.getHash(cn)}`,annotationStorageMap:cn}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const Zt=[];for(const ln of Kn(this,Vt).values())Zt.push(ln._destroy());Kn(this,Vt).clear(),Kn(this,zt).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const sn=this.messageHandler.sendWithPromise("Terminate",null);return Zt.push(sn),Promise.all(Zt).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),Kn(this,Bt).clear(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:Zt,loadingTask:sn}=this;Zt.on("GetReader",(ln,dn)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=hn=>{this._lastProgress={loaded:hn.loaded,total:hn.total}},dn.onPull=()=>{this._fullReader.read().then(function({value:hn,done:cn}){if(cn){dn.close();return}(0,_util.assert)(hn instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),dn.enqueue(new Uint8Array(hn),1,[hn])}).catch(hn=>{dn.error(hn)})},dn.onCancel=hn=>{this._fullReader.cancel(hn),dn.ready.catch(cn=>{if(!this.destroyed)throw cn})}}),Zt.on("ReaderHeadersReady",ln=>{const dn=(0,_util.createPromiseCapability)(),hn=this._fullReader;return hn.headersReady.then(()=>{var cn;(!hn.isStreamingSupported||!hn.isRangeSupported)&&(this._lastProgress&&((cn=sn.onProgress)==null||cn.call(sn,this._lastProgress)),hn.onProgress=pn=>{var yn;(yn=sn.onProgress)==null||yn.call(sn,{loaded:pn.loaded,total:pn.total})}),dn.resolve({isStreamingSupported:hn.isStreamingSupported,isRangeSupported:hn.isRangeSupported,contentLength:hn.contentLength})},dn.reject),dn.promise}),Zt.on("GetRangeReader",(ln,dn)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const hn=this._networkStream.getRangeReader(ln.begin,ln.end);if(!hn){dn.close();return}dn.onPull=()=>{hn.read().then(function({value:cn,done:pn}){if(pn){dn.close();return}(0,_util.assert)(cn instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),dn.enqueue(new Uint8Array(cn),1,[cn])}).catch(cn=>{dn.error(cn)})},dn.onCancel=cn=>{hn.cancel(cn),dn.ready.catch(pn=>{if(!this.destroyed)throw pn})}}),Zt.on("GetDoc",({pdfInfo:ln})=>{this._numPages=ln.numPages,this._htmlForXfa=ln.htmlForXfa,delete ln.htmlForXfa,sn._capability.resolve(new PDFDocumentProxy(ln,this))}),Zt.on("DocException",function(ln){let dn;switch(ln.name){case"PasswordException":dn=new _util.PasswordException(ln.message,ln.code);break;case"InvalidPDFException":dn=new _util.InvalidPDFException(ln.message);break;case"MissingPDFException":dn=new _util.MissingPDFException(ln.message);break;case"UnexpectedResponseException":dn=new _util.UnexpectedResponseException(ln.message,ln.status);break;case"UnknownErrorException":dn=new _util.UnknownErrorException(ln.message,ln.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}sn._capability.reject(dn)}),Zt.on("PasswordRequest",ln=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),sn.onPassword){const dn=hn=>{hn instanceof Error?this._passwordCapability.reject(hn):this._passwordCapability.resolve({password:hn})};try{sn.onPassword(dn,ln.code)}catch(hn){this._passwordCapability.reject(hn)}}else this._passwordCapability.reject(new _util.PasswordException(ln.message,ln.code));return this._passwordCapability.promise}),Zt.on("DataLoaded",ln=>{var dn;(dn=sn.onProgress)==null||dn.call(sn,{loaded:ln.length,total:ln.length}),this.downloadInfoCapability.resolve(ln)}),Zt.on("StartRenderPage",ln=>{if(this.destroyed)return;Kn(this,Vt).get(ln.pageIndex)._startRenderPage(ln.transparency,ln.cacheKey)}),Zt.on("commonobj",([ln,dn,hn])=>{var cn;if(!this.destroyed&&!this.commonObjs.has(ln))switch(dn){case"Font":const pn=this._params;if("error"in hn){const En=hn.error;(0,_util.warn)(`Error during font loading: ${En}`),this.commonObjs.resolve(ln,En);break}let yn=null;pn.pdfBug&&((cn=globalThis.FontInspector)!=null&&cn.enabled)&&(yn={registerFont(En,bn){globalThis.FontInspector.fontAdded(En,bn)}});const gn=new _font_loader.FontFaceObject(hn,{isEvalSupported:pn.isEvalSupported,disableFontFace:pn.disableFontFace,ignoreErrors:pn.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:yn});this.fontLoader.bind(gn).catch(En=>Zt.sendWithPromise("FontFallback",{id:ln})).finally(()=>{!pn.fontExtraProperties&&gn.data&&(gn.data=null),this.commonObjs.resolve(ln,gn)});break;case"FontPath":case"Image":this.commonObjs.resolve(ln,hn);break;default:throw new Error(`Got unknown common object type ${dn}`)}}),Zt.on("obj",([ln,dn,hn,cn])=>{var yn;if(this.destroyed)return;const pn=Kn(this,Vt).get(dn);if(!pn.objs.has(ln))switch(hn){case"Image":pn.objs.resolve(ln,cn);const gn=8e6;if(cn){let En;if(cn.bitmap){const{width:bn,height:xn}=cn;En=bn*xn*4}else En=((yn=cn.data)==null?void 0:yn.length)||0;En>gn&&(pn.cleanupAfterRender=!0)}break;case"Pattern":pn.objs.resolve(ln,cn);break;default:throw new Error(`Got unknown object type ${hn}`)}}),Zt.on("DocProgress",ln=>{var dn;this.destroyed||(dn=sn.onProgress)==null||dn.call(sn,{loaded:ln.loaded,total:ln.total})}),Zt.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),Zt.on("FetchBuiltInCMap",ln=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(ln):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),Zt.on("FetchStandardFontData",ln=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(ln):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:Zt}){var sn,ln;this.destroyed||(ln=(sn=this.loadingTask).onUnsupportedFeature)==null||ln.call(sn,Zt)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var Zt;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((Zt=this._fullReader)==null?void 0:Zt.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(Zt){if(!Number.isInteger(Zt)||Zt<=0||Zt>this._numPages)return Promise.reject(new Error("Invalid page request."));const sn=Zt-1,ln=Kn(this,zt).get(sn);if(ln)return ln;const dn=this.messageHandler.sendWithPromise("GetPage",{pageIndex:sn}).then(hn=>{if(this.destroyed)throw new Error("Transport destroyed");const cn=new PDFPageProxy(sn,hn,this,this._params.ownerDocument,this._params.pdfBug);return Kn(this,Vt).set(sn,cn),cn});return Kn(this,zt).set(sn,dn),dn}getPageIndex(Zt){return typeof Zt!="object"||Zt===null||!Number.isInteger(Zt.num)||Zt.num<0||!Number.isInteger(Zt.gen)||Zt.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:Zt.num,gen:Zt.gen})}getAnnotations(Zt,sn){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:Zt,intent:sn})}getFieldObjects(){return es(this,Ht,Iu).call(this,"GetFieldObjects")}hasJSActions(){return es(this,Ht,Iu).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(Zt){return typeof Zt!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:Zt})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(Zt){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:Zt})}getStructTree(Zt){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:Zt})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(Zt=>new _optional_content_config.OptionalContentConfig(Zt))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const Zt="GetMetadata",sn=Kn(this,Bt).get(Zt);if(sn)return sn;const ln=this.messageHandler.sendWithPromise(Zt,null).then(dn=>{var hn,cn;return{info:dn[0],metadata:dn[1]?new _metadata.Metadata(dn[1]):null,contentDispositionFilename:((hn=this._fullReader)==null?void 0:hn.filename)??null,contentLength:((cn=this._fullReader)==null?void 0:cn.contentLength)??null}});return Kn(this,Bt).set(Zt,ln),ln}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(Zt=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const sn of Kn(this,Vt).values())if(!sn.cleanup())throw new Error(`startCleanup: Page ${sn.pageNumber} is currently rendering.`);this.commonObjs.clear(),Zt||this.fontLoader.clear(),Kn(this,Bt).clear()}}get loadingParams(){const{disableAutoFetch:Zt,enableXfa:sn}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:Zt,enableXfa:sn})}}Bt=new WeakMap,Vt=new WeakMap,zt=new WeakMap,Ht=new WeakSet,Iu=function(Zt,sn=null){const ln=Kn(this,Bt).get(Zt);if(ln)return ln;const dn=this.messageHandler.sendWithPromise(Zt,sn);return Kn(this,Bt).set(Zt,dn),dn};class PDFObjects{constructor(){Yr(this,Wt);Yr(this,qt,Object.create(null))}get(Zt,sn=null){if(sn){const dn=es(this,Wt,Pu).call(this,Zt);return dn.capability.promise.then(()=>sn(dn.data)),null}const ln=Kn(this,qt)[Zt];if(!(ln!=null&&ln.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${Zt}.`);return ln.data}has(Zt){const sn=Kn(this,qt)[Zt];return(sn==null?void 0:sn.capability.settled)||!1}resolve(Zt,sn=null){const ln=es(this,Wt,Pu).call(this,Zt);ln.data=sn,ln.capability.resolve()}clear(){var Zt;for(const sn in Kn(this,qt)){const{data:ln}=Kn(this,qt)[sn];(Zt=ln==null?void 0:ln.bitmap)==null||Zt.close()}gs(this,qt,Object.create(null))}}qt=new WeakMap,Wt=new WeakSet,Pu=function(Zt){const sn=Kn(this,qt)[Zt];return sn||(Kn(this,qt)[Zt]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(Zt){Yr(this,Kt,null);gs(this,Kt,Zt),this.onContinue=null}get promise(){return Kn(this,Kt).capability.promise}cancel(Zt=0){Kn(this,Kt).cancel(null,Zt)}get separateAnnots(){const{separateAnnots:Zt}=Kn(this,Kt).operatorList;if(!Zt)return!1;const{annotationCanvasMap:sn}=Kn(this,Kt);return Zt.form||Zt.canvas&&(sn==null?void 0:sn.size)>0}}Kt=new WeakMap,exports.RenderTask=RenderTask;const Qt=class Qt{constructor({callback:Zt,params:sn,objs:ln,commonObjs:dn,annotationCanvasMap:hn,operatorList:cn,pageIndex:pn,canvasFactory:yn,useRequestAnimationFrame:gn=!1,pdfBug:En=!1,pageColors:bn=null}){this.callback=Zt,this.params=sn,this.objs=ln,this.commonObjs=dn,this.annotationCanvasMap=hn,this.operatorListIdx=null,this.operatorList=cn,this._pageIndex=pn,this.canvasFactory=yn,this._pdfBug=En,this.pageColors=bn,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=gn===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=sn.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:Zt=!1,optionalContentConfig:sn}){var pn,yn;if(this.cancelled)return;if(this._canvas){if(Kn(Qt,Xt).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Kn(Qt,Xt).add(this._canvas)}this._pdfBug&&((pn=globalThis.StepperManager)!=null&&pn.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:ln,viewport:dn,transform:hn,background:cn}=this.params;this.gfx=new _canvas.CanvasGraphics(ln,this.commonObjs,this.objs,this.canvasFactory,{optionalContentConfig:sn},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:hn,viewport:dn,transparency:Zt,background:cn}),this.operatorListIdx=0,this.graphicsReady=!0,(yn=this.graphicsReadyCallback)==null||yn.call(this)}cancel(Zt=null,sn=0){var ln;this.running=!1,this.cancelled=!0,(ln=this.gfx)==null||ln.endDrawing(),this._canvas&&Kn(Qt,Xt).delete(this._canvas),this.callback(Zt||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",sn))}operatorListChanged(){var Zt;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(Zt=this.stepper)==null||Zt.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&Kn(Qt,Xt).delete(this._canvas),this.callback())))}};Xt=new WeakMap,Yr(Qt,Xt,new WeakSet);let InternalRenderTask=Qt;const version="3.4.120";exports.version=version;const build="af6414988";exports.build=build},(xt,$t,Ct)=>{var Vt,zt,Ht,up,qt;Object.defineProperty($t,"__esModule",{value:!0}),$t.PrintAnnotationStorage=$t.AnnotationStorage=void 0;var kt=Ct(1),Mt=Ct(4),Ft=Ct(8);class jt{constructor(){Yr(this,Ht);Yr(this,Vt,!1);Yr(this,zt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(Yt,Kt){const Xt=Kn(this,zt).get(Yt);return Xt===void 0?Kt:Object.assign(Kt,Xt)}getRawValue(Yt){return Kn(this,zt).get(Yt)}remove(Yt){if(Kn(this,zt).delete(Yt),Kn(this,zt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const Kt of Kn(this,zt).values())if(Kt instanceof Mt.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(Yt,Kt){const Xt=Kn(this,zt).get(Yt);let Qt=!1;if(Xt!==void 0)for(const[Jt,Zt]of Object.entries(Kt))Xt[Jt]!==Zt&&(Qt=!0,Xt[Jt]=Zt);else Qt=!0,Kn(this,zt).set(Yt,Kt);Qt&&es(this,Ht,up).call(this),Kt instanceof Mt.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(Kt.constructor._type)}has(Yt){return Kn(this,zt).has(Yt)}getAll(){return Kn(this,zt).size>0?(0,kt.objectFromMap)(Kn(this,zt)):null}setAll(Yt){for(const[Kt,Xt]of Object.entries(Yt))this.setValue(Kt,Xt)}get size(){return Kn(this,zt).size}resetModified(){Kn(this,Vt)&&(gs(this,Vt,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Bt(this)}get serializable(){if(Kn(this,zt).size===0)return null;const Yt=new Map;for(const[Kt,Xt]of Kn(this,zt)){const Qt=Xt instanceof Mt.AnnotationEditor?Xt.serialize():Xt;Qt&&Yt.set(Kt,Qt)}return Yt}static getHash(Yt){if(!Yt)return"";const Kt=new Ft.MurmurHash3_64;for(const[Xt,Qt]of Yt)Kt.update(`${Xt}:${JSON.stringify(Qt)}`);return Kt.hexdigest()}}Vt=new WeakMap,zt=new WeakMap,Ht=new WeakSet,up=function(){Kn(this,Vt)||(gs(this,Vt,!0),typeof this.onSetModified=="function"&&this.onSetModified())},$t.AnnotationStorage=jt;class Bt extends jt{constructor(Kt){super();Yr(this,qt,null);gs(this,qt,structuredClone(Kt.serializable))}get print(){(0,kt.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return Kn(this,qt)}}qt=new WeakMap,$t.PrintAnnotationStorage=Bt},(xt,$t,Ct)=>{var jt,Bt,Vt,zt,Ht,Gt;Object.defineProperty($t,"__esModule",{value:!0}),$t.AnnotationEditor=void 0;var kt=Ct(5),Mt=Ct(1);const qt=class qt{constructor(Yt){Yr(this,jt,this.focusin.bind(this));Yr(this,Bt,this.focusout.bind(this));Yr(this,Vt,!1);Yr(this,zt,!1);Yr(this,Ht,!1);so(this,"_uiManager",null);Yr(this,Gt,qt._zIndex++);this.constructor===qt&&(0,Mt.unreachable)("Cannot initialize AnnotationEditor."),this.parent=Yt.parent,this.id=Yt.id,this.width=this.height=null,this.pageIndex=Yt.parent.pageIndex,this.name=Yt.name,this.div=null,this._uiManager=Yt.uiManager;const{rotation:Kt,rawDims:{pageWidth:Xt,pageHeight:Qt,pageX:Jt,pageY:Zt}}=this.parent.viewport;this.rotation=Kt,this.pageDimensions=[Xt,Qt],this.pageTranslation=[Jt,Zt];const[sn,ln]=this.parentDimensions;this.x=Yt.x/sn,this.y=Yt.y/ln,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,Mt.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(Yt){this._uiManager.addCommands(Yt)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=Kn(this,Gt)}setParent(Yt){Yt!==null&&(this.pageIndex=Yt.pageIndex,this.pageDimensions=Yt.pageDimensions),this.parent=Yt}focusin(Yt){Kn(this,Vt)?gs(this,Vt,!1):this.parent.setSelected(this)}focusout(Yt){var Xt;if(!this.isAttachedToDOM)return;const Kt=Yt.relatedTarget;Kt!=null&&Kt.closest(`#${this.id}`)||(Yt.preventDefault(),(Xt=this.parent)!=null&&Xt.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(Yt){const Kt=this.parent.div.getBoundingClientRect();this.startX=Yt.clientX-Kt.x,this.startY=Yt.clientY-Kt.y,Yt.dataTransfer.setData("text/plain",this.id),Yt.dataTransfer.effectAllowed="move"}setAt(Yt,Kt,Xt,Qt){const[Jt,Zt]=this.parentDimensions;[Xt,Qt]=this.screenToPageTranslation(Xt,Qt),this.x=(Yt+Xt)/Jt,this.y=(Kt+Qt)/Zt,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(Yt,Kt){const[Xt,Qt]=this.parentDimensions;[Yt,Kt]=this.screenToPageTranslation(Yt,Kt),this.x+=Yt/Xt,this.y+=Kt/Qt,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(Yt,Kt){switch(this.parentRotation){case 90:return[Kt,-Yt];case 180:return[-Yt,-Kt];case 270:return[-Kt,Yt];default:return[Yt,Kt]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return this._uiManager.viewParameters.rotation}get parentDimensions(){const{realScale:Yt}=this._uiManager.viewParameters,[Kt,Xt]=this.pageDimensions;return[Kt*Yt,Xt*Yt]}setDims(Yt,Kt){const[Xt,Qt]=this.parentDimensions;this.div.style.width=`${100*Yt/Xt}%`,this.div.style.height=`${100*Kt/Qt}%`}fixDims(){const{style:Yt}=this.div,{height:Kt,width:Xt}=Yt,Qt=Xt.endsWith("%"),Jt=Kt.endsWith("%");if(Qt&&Jt)return;const[Zt,sn]=this.parentDimensions;Qt||(Yt.width=`${100*parseFloat(Xt)/Zt}%`),Jt||(Yt.height=`${100*parseFloat(Kt)/sn}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",Kn(this,jt)),this.div.addEventListener("focusout",Kn(this,Bt));const[Yt,Kt]=this.getInitialTranslation();return this.translate(Yt,Kt),(0,kt.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(Yt){const{isMac:Kt}=Mt.FeatureTest.platform;if(Yt.button!==0||Yt.ctrlKey&&Kt){Yt.preventDefault();return}Yt.ctrlKey&&!Kt||Yt.shiftKey||Yt.metaKey&&Kt?this.parent.toggleSelected(this):this.parent.setSelected(this),gs(this,Vt,!0)}getRect(Yt,Kt){const Xt=this.parentScale,[Qt,Jt]=this.pageDimensions,[Zt,sn]=this.pageTranslation,ln=Yt/Xt,dn=Kt/Xt,hn=this.x*Qt,cn=this.y*Jt,pn=this.width*Qt,yn=this.height*Jt;switch(this.rotation){case 0:return[hn+ln+Zt,Jt-cn-dn-yn+sn,hn+ln+pn+Zt,Jt-cn-dn+sn];case 90:return[hn+dn+Zt,Jt-cn+ln+sn,hn+dn+yn+Zt,Jt-cn+ln+pn+sn];case 180:return[hn-ln-pn+Zt,Jt-cn+dn+sn,hn-ln+Zt,Jt-cn+dn+yn+sn];case 270:return[hn-dn-yn+Zt,Jt-cn-ln-pn+sn,hn-dn+Zt,Jt-cn-ln+sn];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(Yt,Kt){const[Xt,Qt,Jt,Zt]=Yt,sn=Jt-Xt,ln=Zt-Qt;switch(this.rotation){case 0:return[Xt,Kt-Zt,sn,ln];case 90:return[Xt,Kt-Qt,ln,sn];case 180:return[Jt,Kt-Qt,sn,ln];case 270:return[Jt,Kt-Zt,ln,sn];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){gs(this,Ht,!0)}disableEditMode(){gs(this,Ht,!1)}isInEditMode(){return Kn(this,Ht)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var Yt;(Yt=this.div)==null||Yt.addEventListener("focusin",Kn(this,jt))}serialize(){(0,Mt.unreachable)("An editor must be serializable")}static deserialize(Yt,Kt,Xt){const Qt=new this.prototype.constructor({parent:Kt,id:Kt.getNextId(),uiManager:Xt});Qt.rotation=Yt.rotation;const[Jt,Zt]=Qt.pageDimensions,[sn,ln,dn,hn]=Qt.getRectInCurrentCoords(Yt.rect,Zt);return Qt.x=sn/Jt,Qt.y=ln/Zt,Qt.width=dn/Jt,Qt.height=hn/Zt,Qt}remove(){this.div.removeEventListener("focusin",Kn(this,jt)),this.div.removeEventListener("focusout",Kn(this,Bt)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var Yt;(Yt=this.div)==null||Yt.classList.add("selectedEditor")}unselect(){var Yt;(Yt=this.div)==null||Yt.classList.remove("selectedEditor")}updateParams(Yt,Kt){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return Kn(this,zt)}set isEditing(Yt){gs(this,zt,Yt),Yt?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};jt=new WeakMap,Bt=new WeakMap,Vt=new WeakMap,zt=new WeakMap,Ht=new WeakMap,Gt=new WeakMap,so(qt,"_colorManager",new kt.ColorManager),so(qt,"_zIndex",1);let Ft=qt;$t.AnnotationEditor=Ft},(xt,$t,Ct)=>{var qt,Wt,Yt,Kt,Xt,Qt,cp,sn,ln,dn,hn,cn,pn,yn,gn,En,bn,xn,Cn,$n,wn,Rn,Dn,An,Sn,vn,_n,Tn,Pn,Ln,Vn,dp,Wn,Du,ar,fp,mr,hp,Fn,Tl,Bn,su,sr,mp,Fr,gp,Qn,ku,Mr,ou,Tr,Ou;Object.defineProperty($t,"__esModule",{value:!0}),$t.KeyboardManager=$t.CommandManager=$t.ColorManager=$t.AnnotationEditorUIManager=void 0,$t.bindEvents=Ft,$t.opacityToHex=jt;var kt=Ct(1),Mt=Ct(6);function Ft(Zr,ur,hr){for(const gr of hr)ur.addEventListener(gr,Zr[gr].bind(Zr))}function jt(Zr){return Math.round(Math.min(255,Math.max(1,255*Zr))).toString(16).padStart(2,"0")}class Bt{constructor(){Yr(this,qt,0)}getId(){return`${kt.AnnotationEditorPrefix}${Au(this,qt)._++}`}}qt=new WeakMap;class Vt{constructor(ur=128){Yr(this,Wt,[]);Yr(this,Yt,!1);Yr(this,Kt,void 0);Yr(this,Xt,-1);gs(this,Kt,ur)}add({cmd:ur,undo:hr,mustExec:gr,type:qr=NaN,overwriteIfSameType:ds=!1,keepUndo:ms=!1}){if(gr&&ur(),Kn(this,Yt))return;const wr={cmd:ur,undo:hr,type:qr};if(Kn(this,Xt)===-1){Kn(this,Wt).length>0&&(Kn(this,Wt).length=0),gs(this,Xt,0),Kn(this,Wt).push(wr);return}if(ds&&Kn(this,Wt)[Kn(this,Xt)].type===qr){ms&&(wr.undo=Kn(this,Wt)[Kn(this,Xt)].undo),Kn(this,Wt)[Kn(this,Xt)]=wr;return}const Wr=Kn(this,Xt)+1;Wr===Kn(this,Kt)?Kn(this,Wt).splice(0,1):(gs(this,Xt,Wr),Wr<Kn(this,Wt).length&&Kn(this,Wt).splice(Wr)),Kn(this,Wt).push(wr)}undo(){Kn(this,Xt)!==-1&&(gs(this,Yt,!0),Kn(this,Wt)[Kn(this,Xt)].undo(),gs(this,Yt,!1),gs(this,Xt,Kn(this,Xt)-1))}redo(){Kn(this,Xt)<Kn(this,Wt).length-1&&(gs(this,Xt,Kn(this,Xt)+1),gs(this,Yt,!0),Kn(this,Wt)[Kn(this,Xt)].cmd(),gs(this,Yt,!1))}hasSomethingToUndo(){return Kn(this,Xt)!==-1}hasSomethingToRedo(){return Kn(this,Xt)<Kn(this,Wt).length-1}destroy(){gs(this,Wt,null)}}Wt=new WeakMap,Yt=new WeakMap,Kt=new WeakMap,Xt=new WeakMap,$t.CommandManager=Vt;class zt{constructor(ur){Yr(this,Qt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:hr}=kt.FeatureTest.platform;for(const[gr,qr]of ur)for(const ds of gr){const ms=ds.startsWith("mac+");hr&&ms?(this.callbacks.set(ds.slice(4),qr),this.allKeys.add(ds.split("+").at(-1))):!hr&&!ms&&(this.callbacks.set(ds,qr),this.allKeys.add(ds.split("+").at(-1)))}}exec(ur,hr){if(!this.allKeys.has(hr.key))return;const gr=this.callbacks.get(es(this,Qt,cp).call(this,hr));gr&&(gr.bind(ur)(),hr.stopPropagation(),hr.preventDefault())}}Qt=new WeakSet,cp=function(ur){ur.altKey&&this.buffer.push("alt"),ur.ctrlKey&&this.buffer.push("ctrl"),ur.metaKey&&this.buffer.push("meta"),ur.shiftKey&&this.buffer.push("shift"),this.buffer.push(ur.key);const hr=this.buffer.join("+");return this.buffer.length=0,hr},$t.KeyboardManager=zt;const Zt=class Zt{get _colors(){const ur=new Map([["CanvasText",null],["Canvas",null]]);return(0,Mt.getColorValues)(ur),(0,kt.shadow)(this,"_colors",ur)}convert(ur){const hr=(0,Mt.getRGB)(ur);if(!window.matchMedia("(forced-colors: active)").matches)return hr;for(const[gr,qr]of this._colors)if(qr.every((ds,ms)=>ds===hr[ms]))return Zt._colorsMapping.get(gr);return hr}getHexCode(ur){const hr=this._colors.get(ur);return hr?kt.Util.makeHexColor(...hr):ur}};so(Zt,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Ht=Zt;$t.ColorManager=Ht;const Xr=class Xr{constructor(ur,hr,gr){Yr(this,Vn);Yr(this,Wn);Yr(this,ar);Yr(this,mr);Yr(this,Fn);Yr(this,Bn);Yr(this,sr);Yr(this,Fr);Yr(this,Qn);Yr(this,Mr);Yr(this,Tr);Yr(this,sn,null);Yr(this,ln,new Map);Yr(this,dn,new Map);Yr(this,hn,null);Yr(this,cn,new Vt);Yr(this,pn,0);Yr(this,yn,null);Yr(this,gn,new Set);Yr(this,En,null);Yr(this,bn,new Bt);Yr(this,xn,!1);Yr(this,Cn,kt.AnnotationEditorType.NONE);Yr(this,$n,new Set);Yr(this,wn,this.copy.bind(this));Yr(this,Rn,this.cut.bind(this));Yr(this,Dn,this.paste.bind(this));Yr(this,An,this.keydown.bind(this));Yr(this,Sn,this.onEditingAction.bind(this));Yr(this,vn,this.onPageChanging.bind(this));Yr(this,_n,this.onScaleChanging.bind(this));Yr(this,Tn,this.onRotationChanging.bind(this));Yr(this,Pn,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Yr(this,Ln,null);gs(this,Ln,ur),gs(this,En,hr),Kn(this,En)._on("editingaction",Kn(this,Sn)),Kn(this,En)._on("pagechanging",Kn(this,vn)),Kn(this,En)._on("scalechanging",Kn(this,_n)),Kn(this,En)._on("rotationchanging",Kn(this,Tn)),gs(this,hn,gr),this.viewParameters={realScale:Mt.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){es(this,Wn,Du).call(this),Kn(this,En)._off("editingaction",Kn(this,Sn)),Kn(this,En)._off("pagechanging",Kn(this,vn)),Kn(this,En)._off("scalechanging",Kn(this,_n)),Kn(this,En)._off("rotationchanging",Kn(this,Tn));for(const ur of Kn(this,dn).values())ur.destroy();Kn(this,dn).clear(),Kn(this,ln).clear(),Kn(this,gn).clear(),gs(this,sn,null),Kn(this,$n).clear(),Kn(this,cn).destroy()}onPageChanging({pageNumber:ur}){gs(this,pn,ur-1)}focusMainContainer(){Kn(this,Ln).focus()}addShouldRescale(ur){Kn(this,gn).add(ur)}removeShouldRescale(ur){Kn(this,gn).delete(ur)}onScaleChanging({scale:ur}){this.commitOrRemove(),this.viewParameters.realScale=ur*Mt.PixelsPerInch.PDF_TO_CSS_UNITS;for(const hr of Kn(this,gn))hr.onScaleChanging()}onRotationChanging({pagesRotation:ur}){this.commitOrRemove(),this.viewParameters.rotation=ur}addToAnnotationStorage(ur){!ur.isEmpty()&&Kn(this,hn)&&!Kn(this,hn).has(ur.id)&&Kn(this,hn).setValue(ur.id,ur)}copy(ur){if(ur.preventDefault(),Kn(this,sn)&&Kn(this,sn).commitOrRemove(),!this.hasSelection)return;const hr=[];for(const gr of Kn(this,$n))gr.isEmpty()||hr.push(gr.serialize());hr.length!==0&&ur.clipboardData.setData("application/pdfjs",JSON.stringify(hr))}cut(ur){this.copy(ur),this.delete()}paste(ur){ur.preventDefault();let hr=ur.clipboardData.getData("application/pdfjs");if(!hr)return;try{hr=JSON.parse(hr)}catch(qr){(0,kt.warn)(`paste: "${qr.message}".`);return}if(!Array.isArray(hr))return;this.unselectAll();const gr=Kn(this,dn).get(Kn(this,pn));try{const qr=[];for(const wr of hr){const Wr=gr.deserialize(wr);if(!Wr)return;qr.push(Wr)}const ds=()=>{for(const wr of qr)es(this,Qn,ku).call(this,wr);es(this,Tr,Ou).call(this,qr)},ms=()=>{for(const wr of qr)wr.remove()};this.addCommands({cmd:ds,undo:ms,mustExec:!0})}catch(qr){(0,kt.warn)(`paste: "${qr.message}".`)}}keydown(ur){var hr;(hr=this.getActive())!=null&&hr.shouldGetKeyboardEvents()||Xr._keyboardManager.exec(this,ur)}onEditingAction(ur){["undo","redo","delete","selectAll"].includes(ur.name)&&this[ur.name]()}setEditingState(ur){ur?(es(this,Vn,dp).call(this),es(this,ar,fp).call(this),es(this,Fn,Tl).call(this,{isEditing:Kn(this,Cn)!==kt.AnnotationEditorType.NONE,isEmpty:es(this,Mr,ou).call(this),hasSomethingToUndo:Kn(this,cn).hasSomethingToUndo(),hasSomethingToRedo:Kn(this,cn).hasSomethingToRedo(),hasSelectedEditor:!1})):(es(this,Wn,Du).call(this),es(this,mr,hp).call(this),es(this,Fn,Tl).call(this,{isEditing:!1}))}registerEditorTypes(ur){if(!Kn(this,yn)){gs(this,yn,ur);for(const hr of Kn(this,yn))es(this,Bn,su).call(this,hr.defaultPropertiesToUpdate)}}getId(){return Kn(this,bn).getId()}get currentLayer(){return Kn(this,dn).get(Kn(this,pn))}get currentPageIndex(){return Kn(this,pn)}addLayer(ur){Kn(this,dn).set(ur.pageIndex,ur),Kn(this,xn)?ur.enable():ur.disable()}removeLayer(ur){Kn(this,dn).delete(ur.pageIndex)}updateMode(ur){if(gs(this,Cn,ur),ur===kt.AnnotationEditorType.NONE)this.setEditingState(!1),es(this,Fr,gp).call(this);else{this.setEditingState(!0),es(this,sr,mp).call(this);for(const hr of Kn(this,dn).values())hr.updateMode(ur)}}updateToolbar(ur){ur!==Kn(this,Cn)&&Kn(this,En).dispatch("switchannotationeditormode",{source:this,mode:ur})}updateParams(ur,hr){if(Kn(this,yn)){for(const gr of Kn(this,$n))gr.updateParams(ur,hr);for(const gr of Kn(this,yn))gr.updateDefaultParams(ur,hr)}}getEditors(ur){const hr=[];for(const gr of Kn(this,ln).values())gr.pageIndex===ur&&hr.push(gr);return hr}getEditor(ur){return Kn(this,ln).get(ur)}addEditor(ur){Kn(this,ln).set(ur.id,ur)}removeEditor(ur){var hr;Kn(this,ln).delete(ur.id),this.unselect(ur),(hr=Kn(this,hn))==null||hr.remove(ur.id)}setActiveEditor(ur){Kn(this,sn)!==ur&&(gs(this,sn,ur),ur&&es(this,Bn,su).call(this,ur.propertiesToUpdate))}toggleSelected(ur){if(Kn(this,$n).has(ur)){Kn(this,$n).delete(ur),ur.unselect(),es(this,Fn,Tl).call(this,{hasSelectedEditor:this.hasSelection});return}Kn(this,$n).add(ur),ur.select(),es(this,Bn,su).call(this,ur.propertiesToUpdate),es(this,Fn,Tl).call(this,{hasSelectedEditor:!0})}setSelected(ur){for(const hr of Kn(this,$n))hr!==ur&&hr.unselect();Kn(this,$n).clear(),Kn(this,$n).add(ur),ur.select(),es(this,Bn,su).call(this,ur.propertiesToUpdate),es(this,Fn,Tl).call(this,{hasSelectedEditor:!0})}isSelected(ur){return Kn(this,$n).has(ur)}unselect(ur){ur.unselect(),Kn(this,$n).delete(ur),es(this,Fn,Tl).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return Kn(this,$n).size!==0}undo(){Kn(this,cn).undo(),es(this,Fn,Tl).call(this,{hasSomethingToUndo:Kn(this,cn).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:es(this,Mr,ou).call(this)})}redo(){Kn(this,cn).redo(),es(this,Fn,Tl).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:Kn(this,cn).hasSomethingToRedo(),isEmpty:es(this,Mr,ou).call(this)})}addCommands(ur){Kn(this,cn).add(ur),es(this,Fn,Tl).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:es(this,Mr,ou).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const ur=[...Kn(this,$n)],hr=()=>{for(const qr of ur)qr.remove()},gr=()=>{for(const qr of ur)es(this,Qn,ku).call(this,qr)};this.addCommands({cmd:hr,undo:gr,mustExec:!0})}commitOrRemove(){var ur;(ur=Kn(this,sn))==null||ur.commitOrRemove()}selectAll(){for(const ur of Kn(this,$n))ur.commit();es(this,Tr,Ou).call(this,Kn(this,ln).values())}unselectAll(){if(Kn(this,sn)){Kn(this,sn).commitOrRemove();return}if(Kn(this,$n).size!==0){for(const ur of Kn(this,$n))ur.unselect();Kn(this,$n).clear(),es(this,Fn,Tl).call(this,{hasSelectedEditor:!1})}}isActive(ur){return Kn(this,sn)===ur}getActive(){return Kn(this,sn)}getMode(){return Kn(this,Cn)}};sn=new WeakMap,ln=new WeakMap,dn=new WeakMap,hn=new WeakMap,cn=new WeakMap,pn=new WeakMap,yn=new WeakMap,gn=new WeakMap,En=new WeakMap,bn=new WeakMap,xn=new WeakMap,Cn=new WeakMap,$n=new WeakMap,wn=new WeakMap,Rn=new WeakMap,Dn=new WeakMap,An=new WeakMap,Sn=new WeakMap,vn=new WeakMap,_n=new WeakMap,Tn=new WeakMap,Pn=new WeakMap,Ln=new WeakMap,Vn=new WeakSet,dp=function(){Kn(this,Ln).addEventListener("keydown",Kn(this,An))},Wn=new WeakSet,Du=function(){Kn(this,Ln).removeEventListener("keydown",Kn(this,An))},ar=new WeakSet,fp=function(){document.addEventListener("copy",Kn(this,wn)),document.addEventListener("cut",Kn(this,Rn)),document.addEventListener("paste",Kn(this,Dn))},mr=new WeakSet,hp=function(){document.removeEventListener("copy",Kn(this,wn)),document.removeEventListener("cut",Kn(this,Rn)),document.removeEventListener("paste",Kn(this,Dn))},Fn=new WeakSet,Tl=function(ur){Object.entries(ur).some(([gr,qr])=>Kn(this,Pn)[gr]!==qr)&&Kn(this,En).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(Kn(this,Pn),ur)})},Bn=new WeakSet,su=function(ur){Kn(this,En).dispatch("annotationeditorparamschanged",{source:this,details:ur})},sr=new WeakSet,mp=function(){if(!Kn(this,xn)){gs(this,xn,!0);for(const ur of Kn(this,dn).values())ur.enable()}},Fr=new WeakSet,gp=function(){if(this.unselectAll(),Kn(this,xn)){gs(this,xn,!1);for(const ur of Kn(this,dn).values())ur.disable()}},Qn=new WeakSet,ku=function(ur){const hr=Kn(this,dn).get(ur.pageIndex);hr?hr.addOrRebuild(ur):this.addEditor(ur)},Mr=new WeakSet,ou=function(){if(Kn(this,ln).size===0)return!0;if(Kn(this,ln).size===1)for(const ur of Kn(this,ln).values())return ur.isEmpty();return!1},Tr=new WeakSet,Ou=function(ur){Kn(this,$n).clear();for(const hr of ur)hr.isEmpty()||(Kn(this,$n).add(hr),hr.select());es(this,Fn,Tl).call(this,{hasSelectedEditor:!0})},so(Xr,"_keyboardManager",new zt([[["ctrl+a","mac+meta+a"],Xr.prototype.selectAll],[["ctrl+z","mac+meta+z"],Xr.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],Xr.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],Xr.prototype.delete],[["Escape","mac+Escape"],Xr.prototype.unselectAll]]));let Gt=Xr;$t.AnnotationEditorUIManager=Gt},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.StatTimer=$t.RenderingCancelledException=$t.PixelsPerInch=$t.PageViewport=$t.PDFDateString=$t.DOMStandardFontDataFactory=$t.DOMSVGFactory=$t.DOMCanvasFactory=$t.DOMCMapReaderFactory=$t.AnnotationPrefix=void 0,$t.deprecated=dn,$t.getColorValues=gn,$t.getCurrentTransform=En,$t.getCurrentTransformInverse=bn,$t.getFilenameFromUrl=Qt,$t.getPdfFilenameFromUrl=Jt,$t.getRGB=yn,$t.getXfaPageViewport=pn,$t.isDataScheme=Kt,$t.isPdfFile=Xt,$t.isValidFetchUrl=sn,$t.loadScript=ln,$t.setLayerDimensions=xn;var kt=Ct(7),Mt=Ct(1);const Ft="http://www.w3.org/2000/svg",jt="pdfjs_internal_id_";$t.AnnotationPrefix=jt;const Cn=class Cn{};so(Cn,"CSS",96),so(Cn,"PDF",72),so(Cn,"PDF_TO_CSS_UNITS",Cn.CSS/Cn.PDF);let Bt=Cn;$t.PixelsPerInch=Bt;class Vt extends kt.BaseCanvasFactory{constructor({ownerDocument:wn=globalThis.document}={}){super(),this._document=wn}_createCanvas(wn,Rn){const Dn=this._document.createElement("canvas");return Dn.width=wn,Dn.height=Rn,Dn}}$t.DOMCanvasFactory=Vt;async function zt($n,wn=!1){if(sn($n,document.baseURI)){const Rn=await fetch($n);if(!Rn.ok)throw new Error(Rn.statusText);return wn?new Uint8Array(await Rn.arrayBuffer()):(0,Mt.stringToBytes)(await Rn.text())}return new Promise((Rn,Dn)=>{const An=new XMLHttpRequest;An.open("GET",$n,!0),wn&&(An.responseType="arraybuffer"),An.onreadystatechange=()=>{if(An.readyState===XMLHttpRequest.DONE){if(An.status===200||An.status===0){let Sn;if(wn&&An.response?Sn=new Uint8Array(An.response):!wn&&An.responseText&&(Sn=(0,Mt.stringToBytes)(An.responseText)),Sn){Rn(Sn);return}}Dn(new Error(An.statusText))}},An.send(null)})}class Ht extends kt.BaseCMapReaderFactory{_fetchData(wn,Rn){return zt(wn,this.isCompressed).then(Dn=>({cMapData:Dn,compressionType:Rn}))}}$t.DOMCMapReaderFactory=Ht;class Gt extends kt.BaseStandardFontDataFactory{_fetchData(wn){return zt(wn,!0)}}$t.DOMStandardFontDataFactory=Gt;class qt extends kt.BaseSVGFactory{_createSVG(wn){return document.createElementNS(Ft,wn)}}$t.DOMSVGFactory=qt;class Wt{constructor({viewBox:wn,scale:Rn,rotation:Dn,offsetX:An=0,offsetY:Sn=0,dontFlip:vn=!1}){this.viewBox=wn,this.scale=Rn,this.rotation=Dn,this.offsetX=An,this.offsetY=Sn;const _n=(wn[2]+wn[0])/2,Tn=(wn[3]+wn[1])/2;let Pn,Ln,Vn,Un;switch(Dn%=360,Dn<0&&(Dn+=360),Dn){case 180:Pn=-1,Ln=0,Vn=0,Un=1;break;case 90:Pn=0,Ln=1,Vn=1,Un=0;break;case 270:Pn=0,Ln=-1,Vn=-1,Un=0;break;case 0:Pn=1,Ln=0,Vn=0,Un=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}vn&&(Vn=-Vn,Un=-Un);let Wn,rr,ar,nr;Pn===0?(Wn=Math.abs(Tn-wn[1])*Rn+An,rr=Math.abs(_n-wn[0])*Rn+Sn,ar=(wn[3]-wn[1])*Rn,nr=(wn[2]-wn[0])*Rn):(Wn=Math.abs(_n-wn[0])*Rn+An,rr=Math.abs(Tn-wn[1])*Rn+Sn,ar=(wn[2]-wn[0])*Rn,nr=(wn[3]-wn[1])*Rn),this.transform=[Pn*Rn,Ln*Rn,Vn*Rn,Un*Rn,Wn-Pn*Rn*_n-Vn*Rn*Tn,rr-Ln*Rn*_n-Un*Rn*Tn],this.width=ar,this.height=nr}get rawDims(){const{viewBox:wn}=this;return(0,Mt.shadow)(this,"rawDims",{pageWidth:wn[2]-wn[0],pageHeight:wn[3]-wn[1],pageX:wn[0],pageY:wn[1]})}clone({scale:wn=this.scale,rotation:Rn=this.rotation,offsetX:Dn=this.offsetX,offsetY:An=this.offsetY,dontFlip:Sn=!1}={}){return new Wt({viewBox:this.viewBox.slice(),scale:wn,rotation:Rn,offsetX:Dn,offsetY:An,dontFlip:Sn})}convertToViewportPoint(wn,Rn){return Mt.Util.applyTransform([wn,Rn],this.transform)}convertToViewportRectangle(wn){const Rn=Mt.Util.applyTransform([wn[0],wn[1]],this.transform),Dn=Mt.Util.applyTransform([wn[2],wn[3]],this.transform);return[Rn[0],Rn[1],Dn[0],Dn[1]]}convertToPdfPoint(wn,Rn){return Mt.Util.applyInverseTransform([wn,Rn],this.transform)}}$t.PageViewport=Wt;class Yt extends Mt.BaseException{constructor(wn,Rn,Dn=0){super(wn,"RenderingCancelledException"),this.type=Rn,this.extraDelay=Dn}}$t.RenderingCancelledException=Yt;function Kt($n){const wn=$n.length;let Rn=0;for(;Rn<wn&&$n[Rn].trim()==="";)Rn++;return $n.substring(Rn,Rn+5).toLowerCase()==="data:"}function Xt($n){return typeof $n=="string"&&/\.pdf$/i.test($n)}function Qt($n,wn=!1){return wn||([$n]=$n.split(/[#?]/,1)),$n.substring($n.lastIndexOf("/")+1)}function Jt($n,wn="document.pdf"){if(typeof $n!="string")return wn;if(Kt($n))return(0,Mt.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),wn;const Rn=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Dn=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,An=Rn.exec($n);let Sn=Dn.exec(An[1])||Dn.exec(An[2])||Dn.exec(An[3]);if(Sn&&(Sn=Sn[0],Sn.includes("%")))try{Sn=Dn.exec(decodeURIComponent(Sn))[0]}catch{}return Sn||wn}class Zt{constructor(){so(this,"started",Object.create(null));so(this,"times",[])}time(wn){wn in this.started&&(0,Mt.warn)(`Timer is already running for ${wn}`),this.started[wn]=Date.now()}timeEnd(wn){wn in this.started||(0,Mt.warn)(`Timer has not been started for ${wn}`),this.times.push({name:wn,start:this.started[wn],end:Date.now()}),delete this.started[wn]}toString(){const wn=[];let Rn=0;for(const{name:Dn}of this.times)Rn=Math.max(Dn.length,Rn);for(const{name:Dn,start:An,end:Sn}of this.times)wn.push(`${Dn.padEnd(Rn)} ${Sn-An}ms
`);return wn.join("")}}$t.StatTimer=Zt;function sn($n,wn){try{const{protocol:Rn}=wn?new URL($n,wn):new URL($n);return Rn==="http:"||Rn==="https:"}catch{return!1}}function ln($n,wn=!1){return new Promise((Rn,Dn)=>{const An=document.createElement("script");An.src=$n,An.onload=function(Sn){wn&&An.remove(),Rn(Sn)},An.onerror=function(){Dn(new Error(`Cannot load script at: ${An.src}`))},(document.head||document.documentElement).append(An)})}function dn($n){console.log("Deprecated API usage: "+$n)}let hn;class cn{static toDateObject(wn){if(!wn||typeof wn!="string")return null;hn||(hn=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Rn=hn.exec(wn);if(!Rn)return null;const Dn=parseInt(Rn[1],10);let An=parseInt(Rn[2],10);An=An>=1&&An<=12?An-1:0;let Sn=parseInt(Rn[3],10);Sn=Sn>=1&&Sn<=31?Sn:1;let vn=parseInt(Rn[4],10);vn=vn>=0&&vn<=23?vn:0;let _n=parseInt(Rn[5],10);_n=_n>=0&&_n<=59?_n:0;let Tn=parseInt(Rn[6],10);Tn=Tn>=0&&Tn<=59?Tn:0;const Pn=Rn[7]||"Z";let Ln=parseInt(Rn[8],10);Ln=Ln>=0&&Ln<=23?Ln:0;let Vn=parseInt(Rn[9],10)||0;return Vn=Vn>=0&&Vn<=59?Vn:0,Pn==="-"?(vn+=Ln,_n+=Vn):Pn==="+"&&(vn-=Ln,_n-=Vn),new Date(Date.UTC(Dn,An,Sn,vn,_n,Tn))}}$t.PDFDateString=cn;function pn($n,{scale:wn=1,rotation:Rn=0}){const{width:Dn,height:An}=$n.attributes.style,Sn=[0,0,parseInt(Dn),parseInt(An)];return new Wt({viewBox:Sn,scale:wn,rotation:Rn})}function yn($n){if($n.startsWith("#")){const wn=parseInt($n.slice(1),16);return[(wn&16711680)>>16,(wn&65280)>>8,wn&255]}return $n.startsWith("rgb(")?$n.slice(4,-1).split(",").map(wn=>parseInt(wn)):$n.startsWith("rgba(")?$n.slice(5,-1).split(",").map(wn=>parseInt(wn)).slice(0,3):((0,Mt.warn)(`Not a valid color format: "${$n}"`),[0,0,0])}function gn($n){const wn=document.createElement("span");wn.style.visibility="hidden",document.body.append(wn);for(const Rn of $n.keys()){wn.style.color=Rn;const Dn=window.getComputedStyle(wn).color;$n.set(Rn,yn(Dn))}wn.remove()}function En($n){const{a:wn,b:Rn,c:Dn,d:An,e:Sn,f:vn}=$n.getTransform();return[wn,Rn,Dn,An,Sn,vn]}function bn($n){const{a:wn,b:Rn,c:Dn,d:An,e:Sn,f:vn}=$n.getTransform().invertSelf();return[wn,Rn,Dn,An,Sn,vn]}function xn($n,wn,Rn=!1,Dn=!0){if(wn instanceof Wt){const{pageWidth:An,pageHeight:Sn}=wn.rawDims,{style:vn}=$n,_n=`calc(var(--scale-factor) * ${An}px)`,Tn=`calc(var(--scale-factor) * ${Sn}px)`;!Rn||wn.rotation%180===0?(vn.width=_n,vn.height=Tn):(vn.width=Tn,vn.height=_n)}Dn&&$n.setAttribute("data-main-rotation",wn.rotation)}},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.BaseStandardFontDataFactory=$t.BaseSVGFactory=$t.BaseCanvasFactory=$t.BaseCMapReaderFactory=void 0;var kt=Ct(1);class Mt{constructor(){this.constructor===Mt&&(0,kt.unreachable)("Cannot initialize BaseCanvasFactory.")}create(zt,Ht){if(zt<=0||Ht<=0)throw new Error("Invalid canvas size");const Gt=this._createCanvas(zt,Ht);return{canvas:Gt,context:Gt.getContext("2d")}}reset(zt,Ht,Gt){if(!zt.canvas)throw new Error("Canvas is not specified");if(Ht<=0||Gt<=0)throw new Error("Invalid canvas size");zt.canvas.width=Ht,zt.canvas.height=Gt}destroy(zt){if(!zt.canvas)throw new Error("Canvas is not specified");zt.canvas.width=0,zt.canvas.height=0,zt.canvas=null,zt.context=null}_createCanvas(zt,Ht){(0,kt.unreachable)("Abstract method `_createCanvas` called.")}}$t.BaseCanvasFactory=Mt;class Ft{constructor({baseUrl:zt=null,isCompressed:Ht=!0}){this.constructor===Ft&&(0,kt.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=zt,this.isCompressed=Ht}async fetch({name:zt}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!zt)throw new Error("CMap name must be specified.");const Ht=this.baseUrl+zt+(this.isCompressed?".bcmap":""),Gt=this.isCompressed?kt.CMapCompressionType.BINARY:kt.CMapCompressionType.NONE;return this._fetchData(Ht,Gt).catch(qt=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${Ht}`)})}_fetchData(zt,Ht){(0,kt.unreachable)("Abstract method `_fetchData` called.")}}$t.BaseCMapReaderFactory=Ft;class jt{constructor({baseUrl:zt=null}){this.constructor===jt&&(0,kt.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=zt}async fetch({filename:zt}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!zt)throw new Error("Font filename must be specified.");const Ht=`${this.baseUrl}${zt}`;return this._fetchData(Ht).catch(Gt=>{throw new Error(`Unable to load font data at: ${Ht}`)})}_fetchData(zt){(0,kt.unreachable)("Abstract method `_fetchData` called.")}}$t.BaseStandardFontDataFactory=jt;class Bt{constructor(){this.constructor===Bt&&(0,kt.unreachable)("Cannot initialize BaseSVGFactory.")}create(zt,Ht,Gt=!1){if(zt<=0||Ht<=0)throw new Error("Invalid SVG dimensions");const qt=this._createSVG("svg:svg");return qt.setAttribute("version","1.1"),Gt||(qt.setAttribute("width",`${zt}px`),qt.setAttribute("height",`${Ht}px`)),qt.setAttribute("preserveAspectRatio","none"),qt.setAttribute("viewBox",`0 0 ${zt} ${Ht}`),qt}createElement(zt){if(typeof zt!="string")throw new Error("Invalid SVG element type");return this._createSVG(zt)}_createSVG(zt){(0,kt.unreachable)("Abstract method `_createSVG` called.")}}$t.BaseSVGFactory=Bt},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.MurmurHash3_64=void 0;var kt=Ct(1);const Mt=3285377520,Ft=4294901760,jt=65535;class Bt{constructor(zt){this.h1=zt?zt&4294967295:Mt,this.h2=zt?zt&4294967295:Mt}update(zt){let Ht,Gt;if(typeof zt=="string"){Ht=new Uint8Array(zt.length*2),Gt=0;for(let hn=0,cn=zt.length;hn<cn;hn++){const pn=zt.charCodeAt(hn);pn<=255?Ht[Gt++]=pn:(Ht[Gt++]=pn>>>8,Ht[Gt++]=pn&255)}}else if((0,kt.isArrayBuffer)(zt))Ht=zt.slice(),Gt=Ht.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const qt=Gt>>2,Wt=Gt-qt*4,Yt=new Uint32Array(Ht.buffer,0,qt);let Kt=0,Xt=0,Qt=this.h1,Jt=this.h2;const Zt=3432918353,sn=461845907,ln=Zt&jt,dn=sn&jt;for(let hn=0;hn<qt;hn++)hn&1?(Kt=Yt[hn],Kt=Kt*Zt&Ft|Kt*ln&jt,Kt=Kt<<15|Kt>>>17,Kt=Kt*sn&Ft|Kt*dn&jt,Qt^=Kt,Qt=Qt<<13|Qt>>>19,Qt=Qt*5+3864292196):(Xt=Yt[hn],Xt=Xt*Zt&Ft|Xt*ln&jt,Xt=Xt<<15|Xt>>>17,Xt=Xt*sn&Ft|Xt*dn&jt,Jt^=Xt,Jt=Jt<<13|Jt>>>19,Jt=Jt*5+3864292196);switch(Kt=0,Wt){case 3:Kt^=Ht[qt*4+2]<<16;case 2:Kt^=Ht[qt*4+1]<<8;case 1:Kt^=Ht[qt*4],Kt=Kt*Zt&Ft|Kt*ln&jt,Kt=Kt<<15|Kt>>>17,Kt=Kt*sn&Ft|Kt*dn&jt,qt&1?Qt^=Kt:Jt^=Kt}this.h1=Qt,this.h2=Jt}hexdigest(){let zt=this.h1,Ht=this.h2;return zt^=Ht>>>1,zt=zt*3981806797&Ft|zt*36045&jt,Ht=Ht*4283543511&Ft|((Ht<<16|zt>>>16)*2950163797&Ft)>>>16,zt^=Ht>>>1,zt=zt*444984403&Ft|zt*60499&jt,Ht=Ht*3301882366&Ft|((Ht<<16|zt>>>16)*3120437893&Ft)>>>16,zt^=Ht>>>1,(zt>>>0).toString(16).padStart(8,"0")+(Ht>>>0).toString(16).padStart(8,"0")}}$t.MurmurHash3_64=Bt},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.FontLoader=$t.FontFaceObject=void 0;var kt=Ct(1),Mt=Ct(10);class Ft{constructor({onUnsupportedFeature:Vt,ownerDocument:zt=globalThis.document,styleElement:Ht=null}){this._onUnsupportedFeature=Vt,this._document=zt,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(Vt){this.nativeFontFaces.push(Vt),this._document.fonts.add(Vt)}insertRule(Vt){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const zt=this.styleElement.sheet;zt.insertRule(Vt,zt.cssRules.length)}clear(){for(const Vt of this.nativeFontFaces)this._document.fonts.delete(Vt);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(Vt){if(Vt.attached||Vt.missingFile)return;if(Vt.attached=!0,this.isFontLoadingAPISupported){const Ht=Vt.createNativeFontFace();if(Ht){this.addNativeFontFace(Ht);try{await Ht.loaded}catch(Gt){throw this._onUnsupportedFeature({featureId:kt.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,kt.warn)(`Failed to load font '${Ht.family}': '${Gt}'.`),Vt.disableFontFace=!0,Gt}}return}const zt=Vt.createFontFaceRule();if(zt){if(this.insertRule(zt),this.isSyncFontLoadingSupported)return;await new Promise(Ht=>{const Gt=this._queueLoadingCallback(Ht);this._prepareFontLoadEvent(Vt,Gt)})}}get isFontLoadingAPISupported(){var zt;const Vt=!!((zt=this._document)!=null&&zt.fonts);return(0,kt.shadow)(this,"isFontLoadingAPISupported",Vt)}get isSyncFontLoadingSupported(){let Vt=!1;return(Mt.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(Vt=!0),(0,kt.shadow)(this,"isSyncFontLoadingSupported",Vt)}_queueLoadingCallback(Vt){function zt(){for((0,kt.assert)(!Gt.done,"completeRequest() cannot be called twice."),Gt.done=!0;Ht.length>0&&Ht[0].done;){const qt=Ht.shift();setTimeout(qt.callback,0)}}const{loadingRequests:Ht}=this,Gt={done:!1,complete:zt,callback:Vt};return Ht.push(Gt),Gt}get _loadTestFont(){const Vt=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,kt.shadow)(this,"_loadTestFont",Vt)}_prepareFontLoadEvent(Vt,zt){function Ht(gn,En){return gn.charCodeAt(En)<<24|gn.charCodeAt(En+1)<<16|gn.charCodeAt(En+2)<<8|gn.charCodeAt(En+3)&255}function Gt(gn,En,bn,xn){const Cn=gn.substring(0,En),$n=gn.substring(En+bn);return Cn+xn+$n}let qt,Wt;const Yt=this._document.createElement("canvas");Yt.width=1,Yt.height=1;const Kt=Yt.getContext("2d");let Xt=0;function Qt(gn,En){if(++Xt>30){(0,kt.warn)("Load test font never loaded."),En();return}if(Kt.font="30px "+gn,Kt.fillText(".",0,20),Kt.getImageData(0,0,1,1).data[3]>0){En();return}setTimeout(Qt.bind(null,gn,En))}const Jt=`lt${Date.now()}${this.loadTestFontId++}`;let Zt=this._loadTestFont;Zt=Gt(Zt,976,Jt.length,Jt);const ln=16,dn=1482184792;let hn=Ht(Zt,ln);for(qt=0,Wt=Jt.length-3;qt<Wt;qt+=4)hn=hn-dn+Ht(Jt,qt)|0;qt<Jt.length&&(hn=hn-dn+Ht(Jt+"XXX",qt)|0),Zt=Gt(Zt,ln,4,(0,kt.string32)(hn));const cn=`url(data:font/opentype;base64,${btoa(Zt)});`,pn=`@font-face {font-family:"${Jt}";src:${cn}}`;this.insertRule(pn);const yn=this._document.createElement("div");yn.style.visibility="hidden",yn.style.width=yn.style.height="10px",yn.style.position="absolute",yn.style.top=yn.style.left="0px";for(const gn of[Vt.loadedName,Jt]){const En=this._document.createElement("span");En.textContent="Hi",En.style.fontFamily=gn,yn.append(En)}this._document.body.append(yn),Qt(Jt,()=>{yn.remove(),zt.complete()})}}$t.FontLoader=Ft;class jt{constructor(Vt,{isEvalSupported:zt=!0,disableFontFace:Ht=!1,ignoreErrors:Gt=!1,onUnsupportedFeature:qt,fontRegistry:Wt=null}){this.compiledGlyphs=Object.create(null);for(const Yt in Vt)this[Yt]=Vt[Yt];this.isEvalSupported=zt!==!1,this.disableFontFace=Ht===!0,this.ignoreErrors=Gt===!0,this._onUnsupportedFeature=qt,this.fontRegistry=Wt}createNativeFontFace(){var zt;if(!this.data||this.disableFontFace)return null;let Vt;if(!this.cssFontInfo)Vt=new FontFace(this.loadedName,this.data,{});else{const Ht={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(Ht.style=`oblique ${this.cssFontInfo.italicAngle}deg`),Vt=new FontFace(this.cssFontInfo.fontFamily,this.data,Ht)}return(zt=this.fontRegistry)==null||zt.registerFont(this),Vt}createFontFaceRule(){var Gt;if(!this.data||this.disableFontFace)return null;const Vt=(0,kt.bytesToString)(this.data),zt=`url(data:${this.mimetype};base64,${btoa(Vt)});`;let Ht;if(!this.cssFontInfo)Ht=`@font-face {font-family:"${this.loadedName}";src:${zt}}`;else{let qt=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(qt+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),Ht=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${qt}src:${zt}}`}return(Gt=this.fontRegistry)==null||Gt.registerFont(this,zt),Ht}getPathGenerator(Vt,zt){if(this.compiledGlyphs[zt]!==void 0)return this.compiledGlyphs[zt];let Ht;try{Ht=Vt.get(this.loadedName+"_path_"+zt)}catch(Gt){if(!this.ignoreErrors)throw Gt;return this._onUnsupportedFeature({featureId:kt.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,kt.warn)(`getPathGenerator - ignoring character: "${Gt}".`),this.compiledGlyphs[zt]=function(qt,Wt){}}if(this.isEvalSupported&&kt.FeatureTest.isEvalSupported){const Gt=[];for(const qt of Ht){const Wt=qt.args!==void 0?qt.args.join(","):"";Gt.push("c.",qt.cmd,"(",Wt,`);
`)}return this.compiledGlyphs[zt]=new Function("c","size",Gt.join(""))}return this.compiledGlyphs[zt]=function(Gt,qt){for(const Wt of Ht)Wt.cmd==="scale"&&(Wt.args=[qt,-qt]),Gt[Wt.cmd].apply(Gt,Wt.args)}}}$t.FontFaceObject=jt},(xt,$t)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.isNodeJS=void 0;const Ct=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");$t.isNodeJS=Ct},(xt,$t,Ct)=>{var Rn,Nu;Object.defineProperty($t,"__esModule",{value:!0}),$t.CanvasGraphics=void 0;var kt=Ct(1),Mt=Ct(6),Ft=Ct(12),jt=Ct(13);const Bt=16,Vt=100,zt=4096,Ht=15,Gt=10,qt=1e3,Wt=16;function Yt(Sn,vn){if(Sn._removeMirroring)throw new Error("Context is already forwarding operations.");Sn.__originalSave=Sn.save,Sn.__originalRestore=Sn.restore,Sn.__originalRotate=Sn.rotate,Sn.__originalScale=Sn.scale,Sn.__originalTranslate=Sn.translate,Sn.__originalTransform=Sn.transform,Sn.__originalSetTransform=Sn.setTransform,Sn.__originalResetTransform=Sn.resetTransform,Sn.__originalClip=Sn.clip,Sn.__originalMoveTo=Sn.moveTo,Sn.__originalLineTo=Sn.lineTo,Sn.__originalBezierCurveTo=Sn.bezierCurveTo,Sn.__originalRect=Sn.rect,Sn.__originalClosePath=Sn.closePath,Sn.__originalBeginPath=Sn.beginPath,Sn._removeMirroring=()=>{Sn.save=Sn.__originalSave,Sn.restore=Sn.__originalRestore,Sn.rotate=Sn.__originalRotate,Sn.scale=Sn.__originalScale,Sn.translate=Sn.__originalTranslate,Sn.transform=Sn.__originalTransform,Sn.setTransform=Sn.__originalSetTransform,Sn.resetTransform=Sn.__originalResetTransform,Sn.clip=Sn.__originalClip,Sn.moveTo=Sn.__originalMoveTo,Sn.lineTo=Sn.__originalLineTo,Sn.bezierCurveTo=Sn.__originalBezierCurveTo,Sn.rect=Sn.__originalRect,Sn.closePath=Sn.__originalClosePath,Sn.beginPath=Sn.__originalBeginPath,delete Sn._removeMirroring},Sn.save=function(){vn.save(),this.__originalSave()},Sn.restore=function(){vn.restore(),this.__originalRestore()},Sn.translate=function(Tn,Pn){vn.translate(Tn,Pn),this.__originalTranslate(Tn,Pn)},Sn.scale=function(Tn,Pn){vn.scale(Tn,Pn),this.__originalScale(Tn,Pn)},Sn.transform=function(Tn,Pn,Ln,Vn,Un,Wn){vn.transform(Tn,Pn,Ln,Vn,Un,Wn),this.__originalTransform(Tn,Pn,Ln,Vn,Un,Wn)},Sn.setTransform=function(Tn,Pn,Ln,Vn,Un,Wn){vn.setTransform(Tn,Pn,Ln,Vn,Un,Wn),this.__originalSetTransform(Tn,Pn,Ln,Vn,Un,Wn)},Sn.resetTransform=function(){vn.resetTransform(),this.__originalResetTransform()},Sn.rotate=function(Tn){vn.rotate(Tn),this.__originalRotate(Tn)},Sn.clip=function(Tn){vn.clip(Tn),this.__originalClip(Tn)},Sn.moveTo=function(_n,Tn){vn.moveTo(_n,Tn),this.__originalMoveTo(_n,Tn)},Sn.lineTo=function(_n,Tn){vn.lineTo(_n,Tn),this.__originalLineTo(_n,Tn)},Sn.bezierCurveTo=function(_n,Tn,Pn,Ln,Vn,Un){vn.bezierCurveTo(_n,Tn,Pn,Ln,Vn,Un),this.__originalBezierCurveTo(_n,Tn,Pn,Ln,Vn,Un)},Sn.rect=function(_n,Tn,Pn,Ln){vn.rect(_n,Tn,Pn,Ln),this.__originalRect(_n,Tn,Pn,Ln)},Sn.closePath=function(){vn.closePath(),this.__originalClosePath()},Sn.beginPath=function(){vn.beginPath(),this.__originalBeginPath()}}class Kt{constructor(vn){this.canvasFactory=vn,this.cache=Object.create(null)}getCanvas(vn,_n,Tn){let Pn;return this.cache[vn]!==void 0?(Pn=this.cache[vn],this.canvasFactory.reset(Pn,_n,Tn)):(Pn=this.canvasFactory.create(_n,Tn),this.cache[vn]=Pn),Pn}delete(vn){delete this.cache[vn]}clear(){for(const vn in this.cache){const _n=this.cache[vn];this.canvasFactory.destroy(_n),delete this.cache[vn]}}}function Xt(Sn,vn,_n,Tn,Pn,Ln,Vn,Un,Wn,rr){const[ar,nr,mr,kn,Fn,Hn]=(0,Mt.getCurrentTransform)(Sn);if(nr===0&&mr===0){const sr=Vn*ar+Fn,Ar=Math.round(sr),Fr=Un*kn+Hn,Rr=Math.round(Fr),Qn=(Vn+Wn)*ar+Fn,jr=Math.abs(Math.round(Qn)-Ar)||1,Mr=(Un+rr)*kn+Hn,pr=Math.abs(Math.round(Mr)-Rr)||1;return Sn.setTransform(Math.sign(ar),0,0,Math.sign(kn),Ar,Rr),Sn.drawImage(vn,_n,Tn,Pn,Ln,0,0,jr,pr),Sn.setTransform(ar,nr,mr,kn,Fn,Hn),[jr,pr]}if(ar===0&&kn===0){const sr=Un*mr+Fn,Ar=Math.round(sr),Fr=Vn*nr+Hn,Rr=Math.round(Fr),Qn=(Un+rr)*mr+Fn,jr=Math.abs(Math.round(Qn)-Ar)||1,Mr=(Vn+Wn)*nr+Hn,pr=Math.abs(Math.round(Mr)-Rr)||1;return Sn.setTransform(0,Math.sign(nr),Math.sign(mr),0,Ar,Rr),Sn.drawImage(vn,_n,Tn,Pn,Ln,0,0,pr,jr),Sn.setTransform(ar,nr,mr,kn,Fn,Hn),[pr,jr]}Sn.drawImage(vn,_n,Tn,Pn,Ln,Vn,Un,Wn,rr);const Bn=Math.hypot(ar,nr),jn=Math.hypot(mr,kn);return[Bn*Wn,jn*rr]}function Qt(Sn){const{width:vn,height:_n}=Sn;if(vn>qt||_n>qt)return null;const Tn=1e3,Pn=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),Ln=vn+1;let Vn=new Uint8Array(Ln*(_n+1)),Un,Wn,rr;const ar=vn+7&-8;let nr=new Uint8Array(ar*_n),mr=0;for(const jn of Sn.data){let sr=128;for(;sr>0;)nr[mr++]=jn&sr?0:255,sr>>=1}let kn=0;for(mr=0,nr[mr]!==0&&(Vn[0]=1,++kn),Wn=1;Wn<vn;Wn++)nr[mr]!==nr[mr+1]&&(Vn[Wn]=nr[mr]?2:1,++kn),mr++;for(nr[mr]!==0&&(Vn[Wn]=2,++kn),Un=1;Un<_n;Un++){mr=Un*ar,rr=Un*Ln,nr[mr-ar]!==nr[mr]&&(Vn[rr]=nr[mr]?1:8,++kn);let jn=(nr[mr]?4:0)+(nr[mr-ar]?8:0);for(Wn=1;Wn<vn;Wn++)jn=(jn>>2)+(nr[mr+1]?4:0)+(nr[mr-ar+1]?8:0),Pn[jn]&&(Vn[rr+Wn]=Pn[jn],++kn),mr++;if(nr[mr-ar]!==nr[mr]&&(Vn[rr+Wn]=nr[mr]?2:4,++kn),kn>Tn)return null}for(mr=ar*(_n-1),rr=Un*Ln,nr[mr]!==0&&(Vn[rr]=8,++kn),Wn=1;Wn<vn;Wn++)nr[mr]!==nr[mr+1]&&(Vn[rr+Wn]=nr[mr]?4:8,++kn),mr++;if(nr[mr]!==0&&(Vn[rr+Wn]=4,++kn),kn>Tn)return null;const Fn=new Int32Array([0,Ln,-1,0,-Ln,0,0,0,1]),Hn=new Path2D;for(Un=0;kn&&Un<=_n;Un++){let jn=Un*Ln;const sr=jn+vn;for(;jn<sr&&!Vn[jn];)jn++;if(jn===sr)continue;Hn.moveTo(jn%Ln,Un);const Ar=jn;let Fr=Vn[jn];do{const Rr=Fn[Fr];do jn+=Rr;while(!Vn[jn]);const Qn=Vn[jn];Qn!==5&&Qn!==10?(Fr=Qn,Vn[jn]=0):(Fr=Qn&51*Fr>>4,Vn[jn]&=Fr>>2|Fr<<2),Hn.lineTo(jn%Ln,jn/Ln|0),Vn[jn]||--kn}while(Ar!==jn);--Un}return nr=null,Vn=null,function(jn){jn.save(),jn.scale(1/vn,-1/_n),jn.translate(0,-_n),jn.fill(Hn),jn.beginPath(),jn.restore()}}class Jt{constructor(vn,_n){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=kt.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=kt.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=kt.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,vn,_n])}clone(){const vn=Object.create(this);return vn.clipBox=this.clipBox.slice(),vn}setCurrentPoint(vn,_n){this.x=vn,this.y=_n}updatePathMinMax(vn,_n,Tn){[_n,Tn]=kt.Util.applyTransform([_n,Tn],vn),this.minX=Math.min(this.minX,_n),this.minY=Math.min(this.minY,Tn),this.maxX=Math.max(this.maxX,_n),this.maxY=Math.max(this.maxY,Tn)}updateRectMinMax(vn,_n){const Tn=kt.Util.applyTransform(_n,vn),Pn=kt.Util.applyTransform(_n.slice(2),vn);this.minX=Math.min(this.minX,Tn[0],Pn[0]),this.minY=Math.min(this.minY,Tn[1],Pn[1]),this.maxX=Math.max(this.maxX,Tn[0],Pn[0]),this.maxY=Math.max(this.maxY,Tn[1],Pn[1])}updateScalingPathMinMax(vn,_n){kt.Util.scaleMinMax(vn,_n),this.minX=Math.min(this.minX,_n[0]),this.maxX=Math.max(this.maxX,_n[1]),this.minY=Math.min(this.minY,_n[2]),this.maxY=Math.max(this.maxY,_n[3])}updateCurvePathMinMax(vn,_n,Tn,Pn,Ln,Vn,Un,Wn,rr,ar){const nr=kt.Util.bezierBoundingBox(_n,Tn,Pn,Ln,Vn,Un,Wn,rr);if(ar){ar[0]=Math.min(ar[0],nr[0],nr[2]),ar[1]=Math.max(ar[1],nr[0],nr[2]),ar[2]=Math.min(ar[2],nr[1],nr[3]),ar[3]=Math.max(ar[3],nr[1],nr[3]);return}this.updateRectMinMax(vn,nr)}getPathBoundingBox(vn=Ft.PathType.FILL,_n=null){const Tn=[this.minX,this.minY,this.maxX,this.maxY];if(vn===Ft.PathType.STROKE){_n||(0,kt.unreachable)("Stroke bounding box must include transform.");const Pn=kt.Util.singularValueDecompose2dScale(_n),Ln=Pn[0]*this.lineWidth/2,Vn=Pn[1]*this.lineWidth/2;Tn[0]-=Ln,Tn[1]-=Vn,Tn[2]+=Ln,Tn[3]+=Vn}return Tn}updateClipFromPath(){const vn=kt.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(vn||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(vn){this.clipBox=vn,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(vn=Ft.PathType.FILL,_n=null){return kt.Util.intersect(this.clipBox,this.getPathBoundingBox(vn,_n))}}function Zt(Sn,vn,_n=null){if(typeof ImageData<"u"&&vn instanceof ImageData){Sn.putImageData(vn,0,0);return}const Tn=vn.height,Pn=vn.width,Ln=Tn%Wt,Vn=(Tn-Ln)/Wt,Un=Ln===0?Vn:Vn+1,Wn=Sn.createImageData(Pn,Wt);let rr=0,ar;const nr=vn.data,mr=Wn.data;let kn,Fn,Hn,Bn,jn,sr,Ar,Fr;if(_n)switch(_n.length){case 1:jn=_n[0],sr=_n[0],Ar=_n[0],Fr=_n[0];break;case 4:jn=_n[0],sr=_n[1],Ar=_n[2],Fr=_n[3];break}if(vn.kind===kt.ImageKind.GRAYSCALE_1BPP){const Rr=nr.byteLength,Qn=new Uint32Array(mr.buffer,0,mr.byteLength>>2),jr=Qn.length,Mr=Pn+7>>3;let pr=4294967295,Tr=kt.FeatureTest.isLittleEndian?4278190080:255;for(Fr&&Fr[0]===255&&Fr[255]===0&&([pr,Tr]=[Tr,pr]),kn=0;kn<Un;kn++){for(Hn=kn<Vn?Wt:Ln,ar=0,Fn=0;Fn<Hn;Fn++){const Hr=Rr-rr;let Xr=0;const Zr=Hr>Mr?Pn:Hr*8-7,ur=Zr&-8;let hr=0,gr=0;for(;Xr<ur;Xr+=8)gr=nr[rr++],Qn[ar++]=gr&128?pr:Tr,Qn[ar++]=gr&64?pr:Tr,Qn[ar++]=gr&32?pr:Tr,Qn[ar++]=gr&16?pr:Tr,Qn[ar++]=gr&8?pr:Tr,Qn[ar++]=gr&4?pr:Tr,Qn[ar++]=gr&2?pr:Tr,Qn[ar++]=gr&1?pr:Tr;for(;Xr<Zr;Xr++)hr===0&&(gr=nr[rr++],hr=128),Qn[ar++]=gr&hr?pr:Tr,hr>>=1}for(;ar<jr;)Qn[ar++]=0;Sn.putImageData(Wn,0,kn*Wt)}}else if(vn.kind===kt.ImageKind.RGBA_32BPP){const Rr=!!(jn||sr||Ar);for(Fn=0,Bn=Pn*Wt*4,kn=0;kn<Vn;kn++){if(mr.set(nr.subarray(rr,rr+Bn)),rr+=Bn,Rr)for(let Qn=0;Qn<Bn;Qn+=4)jn&&(mr[Qn+0]=jn[mr[Qn+0]]),sr&&(mr[Qn+1]=sr[mr[Qn+1]]),Ar&&(mr[Qn+2]=Ar[mr[Qn+2]]);Sn.putImageData(Wn,0,Fn),Fn+=Wt}if(kn<Un){if(Bn=Pn*Ln*4,mr.set(nr.subarray(rr,rr+Bn)),Rr)for(let Qn=0;Qn<Bn;Qn+=4)jn&&(mr[Qn+0]=jn[mr[Qn+0]]),sr&&(mr[Qn+1]=sr[mr[Qn+1]]),Ar&&(mr[Qn+2]=Ar[mr[Qn+2]]);Sn.putImageData(Wn,0,Fn)}}else if(vn.kind===kt.ImageKind.RGB_24BPP){const Rr=!!(jn||sr||Ar);for(Hn=Wt,Bn=Pn*Hn,kn=0;kn<Un;kn++){for(kn>=Vn&&(Hn=Ln,Bn=Pn*Hn),ar=0,Fn=Bn;Fn--;)mr[ar++]=nr[rr++],mr[ar++]=nr[rr++],mr[ar++]=nr[rr++],mr[ar++]=255;if(Rr)for(let Qn=0;Qn<ar;Qn+=4)jn&&(mr[Qn+0]=jn[mr[Qn+0]]),sr&&(mr[Qn+1]=sr[mr[Qn+1]]),Ar&&(mr[Qn+2]=Ar[mr[Qn+2]]);Sn.putImageData(Wn,0,kn*Wt)}}else throw new Error(`bad image kind: ${vn.kind}`)}function sn(Sn,vn){if(vn.bitmap){Sn.drawImage(vn.bitmap,0,0);return}const _n=vn.height,Tn=vn.width,Pn=_n%Wt,Ln=(_n-Pn)/Wt,Vn=Pn===0?Ln:Ln+1,Un=Sn.createImageData(Tn,Wt);let Wn=0;const rr=vn.data,ar=Un.data;for(let nr=0;nr<Vn;nr++){const mr=nr<Ln?Wt:Pn;({srcPos:Wn}=(0,jt.applyMaskImageData)({src:rr,srcPos:Wn,dest:ar,width:Tn,height:mr})),Sn.putImageData(Un,0,nr*Wt)}}function ln(Sn,vn){const _n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(const Tn of _n)Sn[Tn]!==void 0&&(vn[Tn]=Sn[Tn]);Sn.setLineDash!==void 0&&(vn.setLineDash(Sn.getLineDash()),vn.lineDashOffset=Sn.lineDashOffset)}function dn(Sn,vn){Sn.strokeStyle=Sn.fillStyle=vn||"#000000",Sn.fillRule="nonzero",Sn.globalAlpha=1,Sn.lineWidth=1,Sn.lineCap="butt",Sn.lineJoin="miter",Sn.miterLimit=10,Sn.globalCompositeOperation="source-over",Sn.font="10px sans-serif",Sn.setLineDash!==void 0&&(Sn.setLineDash([]),Sn.lineDashOffset=0)}function hn(Sn,vn,_n,Tn){const Pn=Sn.length;for(let Ln=3;Ln<Pn;Ln+=4){const Vn=Sn[Ln];if(Vn===0)Sn[Ln-3]=vn,Sn[Ln-2]=_n,Sn[Ln-1]=Tn;else if(Vn<255){const Un=255-Vn;Sn[Ln-3]=Sn[Ln-3]*Vn+vn*Un>>8,Sn[Ln-2]=Sn[Ln-2]*Vn+_n*Un>>8,Sn[Ln-1]=Sn[Ln-1]*Vn+Tn*Un>>8}}}function cn(Sn,vn,_n){const Tn=Sn.length,Pn=1/255;for(let Ln=3;Ln<Tn;Ln+=4){const Vn=_n?_n[Sn[Ln]]:Sn[Ln];vn[Ln]=vn[Ln]*Vn*Pn|0}}function pn(Sn,vn,_n){const Tn=Sn.length;for(let Pn=3;Pn<Tn;Pn+=4){const Ln=Sn[Pn-3]*77+Sn[Pn-2]*152+Sn[Pn-1]*28;vn[Pn]=_n?vn[Pn]*_n[Ln>>8]>>8:vn[Pn]*Ln>>16}}function yn(Sn,vn,_n,Tn,Pn,Ln,Vn,Un,Wn,rr,ar){const nr=!!Ln,mr=nr?Ln[0]:0,kn=nr?Ln[1]:0,Fn=nr?Ln[2]:0;let Hn;Pn==="Luminosity"?Hn=pn:Hn=cn;const jn=Math.min(Tn,Math.ceil(1048576/_n));for(let sr=0;sr<Tn;sr+=jn){const Ar=Math.min(jn,Tn-sr),Fr=Sn.getImageData(Un-rr,sr+(Wn-ar),_n,Ar),Rr=vn.getImageData(Un,sr+Wn,_n,Ar);nr&&hn(Fr.data,mr,kn,Fn),Hn(Fr.data,Rr.data,Vn),vn.putImageData(Rr,Un,sr+Wn)}}function gn(Sn,vn,_n,Tn){const Pn=Tn[0],Ln=Tn[1],Vn=Tn[2]-Pn,Un=Tn[3]-Ln;Vn===0||Un===0||(yn(vn.context,_n,Vn,Un,vn.subtype,vn.backdrop,vn.transferMap,Pn,Ln,vn.offsetX,vn.offsetY),Sn.save(),Sn.globalAlpha=1,Sn.globalCompositeOperation="source-over",Sn.setTransform(1,0,0,1,0,0),Sn.drawImage(_n.canvas,0,0),Sn.restore())}function En(Sn,vn){const _n=kt.Util.singularValueDecompose2dScale(Sn);_n[0]=Math.fround(_n[0]),_n[1]=Math.fround(_n[1]);const Tn=Math.fround((globalThis.devicePixelRatio||1)*Mt.PixelsPerInch.PDF_TO_CSS_UNITS);return vn!==void 0?vn:_n[0]<=Tn||_n[1]<=Tn}const bn=["butt","round","square"],xn=["miter","round","bevel"],Cn={},$n={},An=class An{constructor(vn,_n,Tn,Pn,{optionalContentConfig:Ln,markedContentStack:Vn=null},Un,Wn){Yr(this,Rn);this.ctx=vn,this.current=new Jt(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=_n,this.objs=Tn,this.canvasFactory=Pn,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Vn||[],this.optionalContentConfig=Ln,this.cachedCanvases=new Kt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Un,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(Wn==null?void 0:Wn.background)||null,this.foregroundColor=(Wn==null?void 0:Wn.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(vn,_n=null){return typeof vn=="string"?vn.startsWith("g_")?this.commonObjs.get(vn):this.objs.get(vn):_n}beginDrawing({transform:vn,viewport:_n,transparency:Tn=!1,background:Pn=null}){const Ln=this.ctx.canvas.width,Vn=this.ctx.canvas.height,Un=Pn||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const Wn=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const rr=this.backgroundColor=this.ctx.fillStyle;let ar=!0,nr=Un;if(this.ctx.fillStyle=Un,nr=this.ctx.fillStyle,ar=typeof nr=="string"&&/^#[0-9A-Fa-f]{6}$/.test(nr),Wn==="#000000"&&rr==="#ffffff"||Wn===rr||!ar)this.foregroundColor=this.backgroundColor=null;else{const[mr,kn,Fn]=(0,Mt.getRGB)(nr),Hn=jn=>(jn/=255,jn<=.03928?jn/12.92:((jn+.055)/1.055)**2.4),Bn=Math.round(.2126*Hn(mr)+.7152*Hn(kn)+.0722*Hn(Fn));this.selectColor=(jn,sr,Ar)=>{const Fr=.2126*Hn(jn)+.7152*Hn(sr)+.0722*Hn(Ar);return Math.round(Fr)===Bn?rr:Wn}}}if(this.ctx.fillStyle=this.backgroundColor||Un,this.ctx.fillRect(0,0,Ln,Vn),this.ctx.restore(),Tn){const Wn=this.cachedCanvases.getCanvas("transparent",Ln,Vn);this.compositeCtx=this.ctx,this.transparentCanvas=Wn.canvas,this.ctx=Wn.context,this.ctx.save(),this.ctx.transform(...(0,Mt.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),dn(this.ctx,this.foregroundColor),vn&&(this.ctx.transform(...vn),this.outputScaleX=vn[0],this.outputScaleY=vn[0]),this.ctx.transform(..._n.transform),this.viewportScale=_n.scale,this.baseTransform=(0,Mt.getCurrentTransform)(this.ctx)}executeOperatorList(vn,_n,Tn,Pn){const Ln=vn.argsArray,Vn=vn.fnArray;let Un=_n||0;const Wn=Ln.length;if(Wn===Un)return Un;const rr=Wn-Un>Gt&&typeof Tn=="function",ar=rr?Date.now()+Ht:0;let nr=0;const mr=this.commonObjs,kn=this.objs;let Fn;for(;;){if(Pn!==void 0&&Un===Pn.nextBreakPoint)return Pn.breakIt(Un,Tn),Un;if(Fn=Vn[Un],Fn!==kt.OPS.dependency)this[Fn].apply(this,Ln[Un]);else for(const Hn of Ln[Un]){const Bn=Hn.startsWith("g_")?mr:kn;if(!Bn.has(Hn))return Bn.get(Hn,Tn),Un}if(Un++,Un===Wn)return Un;if(rr&&++nr>Gt){if(Date.now()>ar)return Tn(),Un;nr=0}}}endDrawing(){es(this,Rn,Nu).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const vn of this._cachedBitmapsMap.values()){for(const _n of vn.values())typeof HTMLCanvasElement<"u"&&_n instanceof HTMLCanvasElement&&(_n.width=_n.height=0);vn.clear()}this._cachedBitmapsMap.clear()}_scaleImage(vn,_n){const Tn=vn.width,Pn=vn.height;let Ln=Math.max(Math.hypot(_n[0],_n[1]),1),Vn=Math.max(Math.hypot(_n[2],_n[3]),1),Un=Tn,Wn=Pn,rr="prescale1",ar,nr;for(;Ln>2&&Un>1||Vn>2&&Wn>1;){let mr=Un,kn=Wn;Ln>2&&Un>1&&(mr=Math.ceil(Un/2),Ln/=Un/mr),Vn>2&&Wn>1&&(kn=Math.ceil(Wn/2),Vn/=Wn/kn),ar=this.cachedCanvases.getCanvas(rr,mr,kn),nr=ar.context,nr.clearRect(0,0,mr,kn),nr.drawImage(vn,0,0,Un,Wn,0,0,mr,kn),vn=ar.canvas,Un=mr,Wn=kn,rr=rr==="prescale1"?"prescale2":"prescale1"}return{img:vn,paintWidth:Un,paintHeight:Wn}}_createMaskCanvas(vn){const _n=this.ctx,{width:Tn,height:Pn}=vn,Ln=this.current.fillColor,Vn=this.current.patternFill,Un=(0,Mt.getCurrentTransform)(_n);let Wn,rr,ar,nr;if((vn.bitmap||vn.data)&&vn.count>1){const jr=vn.bitmap||vn.data.buffer;rr=JSON.stringify(Vn?Un:[Un.slice(0,4),Ln]),Wn=this._cachedBitmapsMap.get(jr),Wn||(Wn=new Map,this._cachedBitmapsMap.set(jr,Wn));const Mr=Wn.get(rr);if(Mr&&!Vn){const pr=Math.round(Math.min(Un[0],Un[2])+Un[4]),Tr=Math.round(Math.min(Un[1],Un[3])+Un[5]);return{canvas:Mr,offsetX:pr,offsetY:Tr}}ar=Mr}ar||(nr=this.cachedCanvases.getCanvas("maskCanvas",Tn,Pn),sn(nr.context,vn));let mr=kt.Util.transform(Un,[1/Tn,0,0,-1/Pn,0,0]);mr=kt.Util.transform(mr,[1,0,0,1,0,-Pn]);const kn=kt.Util.applyTransform([0,0],mr),Fn=kt.Util.applyTransform([Tn,Pn],mr),Hn=kt.Util.normalizeRect([kn[0],kn[1],Fn[0],Fn[1]]),Bn=Math.round(Hn[2]-Hn[0])||1,jn=Math.round(Hn[3]-Hn[1])||1,sr=this.cachedCanvases.getCanvas("fillCanvas",Bn,jn),Ar=sr.context,Fr=Math.min(kn[0],Fn[0]),Rr=Math.min(kn[1],Fn[1]);Ar.translate(-Fr,-Rr),Ar.transform(...mr),ar||(ar=this._scaleImage(nr.canvas,(0,Mt.getCurrentTransformInverse)(Ar)),ar=ar.img,Wn&&Vn&&Wn.set(rr,ar)),Ar.imageSmoothingEnabled=En((0,Mt.getCurrentTransform)(Ar),vn.interpolate),Xt(Ar,ar,0,0,ar.width,ar.height,0,0,Tn,Pn),Ar.globalCompositeOperation="source-in";const Qn=kt.Util.transform((0,Mt.getCurrentTransformInverse)(Ar),[1,0,0,1,-Fr,-Rr]);return Ar.fillStyle=Vn?Ln.getPattern(_n,this,Qn,Ft.PathType.FILL):Ln,Ar.fillRect(0,0,Tn,Pn),Wn&&!Vn&&(this.cachedCanvases.delete("fillCanvas"),Wn.set(rr,sr.canvas)),{canvas:sr.canvas,offsetX:Math.round(Fr),offsetY:Math.round(Rr)}}setLineWidth(vn){vn!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=vn,this.ctx.lineWidth=vn}setLineCap(vn){this.ctx.lineCap=bn[vn]}setLineJoin(vn){this.ctx.lineJoin=xn[vn]}setMiterLimit(vn){this.ctx.miterLimit=vn}setDash(vn,_n){const Tn=this.ctx;Tn.setLineDash!==void 0&&(Tn.setLineDash(vn),Tn.lineDashOffset=_n)}setRenderingIntent(vn){}setFlatness(vn){}setGState(vn){for(const[_n,Tn]of vn)switch(_n){case"LW":this.setLineWidth(Tn);break;case"LC":this.setLineCap(Tn);break;case"LJ":this.setLineJoin(Tn);break;case"ML":this.setMiterLimit(Tn);break;case"D":this.setDash(Tn[0],Tn[1]);break;case"RI":this.setRenderingIntent(Tn);break;case"FL":this.setFlatness(Tn);break;case"Font":this.setFont(Tn[0],Tn[1]);break;case"CA":this.current.strokeAlpha=Tn;break;case"ca":this.current.fillAlpha=Tn,this.ctx.globalAlpha=Tn;break;case"BM":this.ctx.globalCompositeOperation=Tn;break;case"SMask":this.current.activeSMask=Tn?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=Tn}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const vn=this.inSMaskMode;this.current.activeSMask&&!vn?this.beginSMaskMode():!this.current.activeSMask&&vn&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const vn=this.ctx.canvas.width,_n=this.ctx.canvas.height,Tn="smaskGroupAt"+this.groupLevel,Pn=this.cachedCanvases.getCanvas(Tn,vn,_n);this.suspendedCtx=this.ctx,this.ctx=Pn.context;const Ln=this.ctx;Ln.setTransform(...(0,Mt.getCurrentTransform)(this.suspendedCtx)),ln(this.suspendedCtx,Ln),Yt(Ln,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ln(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(vn){if(!this.current.activeSMask)return;vn?(vn[0]=Math.floor(vn[0]),vn[1]=Math.floor(vn[1]),vn[2]=Math.ceil(vn[2]),vn[3]=Math.ceil(vn[3])):vn=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const _n=this.current.activeSMask,Tn=this.suspendedCtx;gn(Tn,_n,this.ctx,vn),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(ln(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const vn=this.current;this.stateStack.push(vn),this.current=vn.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),ln(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(vn,_n,Tn,Pn,Ln,Vn){this.ctx.transform(vn,_n,Tn,Pn,Ln,Vn),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(vn,_n,Tn){const Pn=this.ctx,Ln=this.current;let Vn=Ln.x,Un=Ln.y,Wn,rr;const ar=(0,Mt.getCurrentTransform)(Pn),nr=ar[0]===0&&ar[3]===0||ar[1]===0&&ar[2]===0,mr=nr?Tn.slice(0):null;for(let kn=0,Fn=0,Hn=vn.length;kn<Hn;kn++)switch(vn[kn]|0){case kt.OPS.rectangle:Vn=_n[Fn++],Un=_n[Fn++];const Bn=_n[Fn++],jn=_n[Fn++],sr=Vn+Bn,Ar=Un+jn;Pn.moveTo(Vn,Un),Bn===0||jn===0?Pn.lineTo(sr,Ar):(Pn.lineTo(sr,Un),Pn.lineTo(sr,Ar),Pn.lineTo(Vn,Ar)),nr||Ln.updateRectMinMax(ar,[Vn,Un,sr,Ar]),Pn.closePath();break;case kt.OPS.moveTo:Vn=_n[Fn++],Un=_n[Fn++],Pn.moveTo(Vn,Un),nr||Ln.updatePathMinMax(ar,Vn,Un);break;case kt.OPS.lineTo:Vn=_n[Fn++],Un=_n[Fn++],Pn.lineTo(Vn,Un),nr||Ln.updatePathMinMax(ar,Vn,Un);break;case kt.OPS.curveTo:Wn=Vn,rr=Un,Vn=_n[Fn+4],Un=_n[Fn+5],Pn.bezierCurveTo(_n[Fn],_n[Fn+1],_n[Fn+2],_n[Fn+3],Vn,Un),Ln.updateCurvePathMinMax(ar,Wn,rr,_n[Fn],_n[Fn+1],_n[Fn+2],_n[Fn+3],Vn,Un,mr),Fn+=6;break;case kt.OPS.curveTo2:Wn=Vn,rr=Un,Pn.bezierCurveTo(Vn,Un,_n[Fn],_n[Fn+1],_n[Fn+2],_n[Fn+3]),Ln.updateCurvePathMinMax(ar,Wn,rr,Vn,Un,_n[Fn],_n[Fn+1],_n[Fn+2],_n[Fn+3],mr),Vn=_n[Fn+2],Un=_n[Fn+3],Fn+=4;break;case kt.OPS.curveTo3:Wn=Vn,rr=Un,Vn=_n[Fn+2],Un=_n[Fn+3],Pn.bezierCurveTo(_n[Fn],_n[Fn+1],Vn,Un,Vn,Un),Ln.updateCurvePathMinMax(ar,Wn,rr,_n[Fn],_n[Fn+1],Vn,Un,Vn,Un,mr),Fn+=4;break;case kt.OPS.closePath:Pn.closePath();break}nr&&Ln.updateScalingPathMinMax(ar,mr),Ln.setCurrentPoint(Vn,Un)}closePath(){this.ctx.closePath()}stroke(vn=!0){const _n=this.ctx,Tn=this.current.strokeColor;_n.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof Tn=="object"&&(Tn!=null&&Tn.getPattern)?(_n.save(),_n.strokeStyle=Tn.getPattern(_n,this,(0,Mt.getCurrentTransformInverse)(_n),Ft.PathType.STROKE),this.rescaleAndStroke(!1),_n.restore()):this.rescaleAndStroke(!0)),vn&&this.consumePath(this.current.getClippedPathBoundingBox()),_n.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(vn=!0){const _n=this.ctx,Tn=this.current.fillColor,Pn=this.current.patternFill;let Ln=!1;Pn&&(_n.save(),_n.fillStyle=Tn.getPattern(_n,this,(0,Mt.getCurrentTransformInverse)(_n),Ft.PathType.FILL),Ln=!0);const Vn=this.current.getClippedPathBoundingBox();this.contentVisible&&Vn!==null&&(this.pendingEOFill?(_n.fill("evenodd"),this.pendingEOFill=!1):_n.fill()),Ln&&_n.restore(),vn&&this.consumePath(Vn)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Cn}eoClip(){this.pendingClip=$n}beginText(){this.current.textMatrix=kt.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const vn=this.pendingTextPaths,_n=this.ctx;if(vn===void 0){_n.beginPath();return}_n.save(),_n.beginPath();for(const Tn of vn)_n.setTransform(...Tn.transform),_n.translate(Tn.x,Tn.y),Tn.addToPath(_n,Tn.fontSize);_n.restore(),_n.clip(),_n.beginPath(),delete this.pendingTextPaths}setCharSpacing(vn){this.current.charSpacing=vn}setWordSpacing(vn){this.current.wordSpacing=vn}setHScale(vn){this.current.textHScale=vn/100}setLeading(vn){this.current.leading=-vn}setFont(vn,_n){const Tn=this.commonObjs.get(vn),Pn=this.current;if(!Tn)throw new Error(`Can't find font for ${vn}`);if(Pn.fontMatrix=Tn.fontMatrix||kt.FONT_IDENTITY_MATRIX,(Pn.fontMatrix[0]===0||Pn.fontMatrix[3]===0)&&(0,kt.warn)("Invalid font matrix for font "+vn),_n<0?(_n=-_n,Pn.fontDirection=-1):Pn.fontDirection=1,this.current.font=Tn,this.current.fontSize=_n,Tn.isType3Font)return;const Ln=Tn.loadedName||"sans-serif";let Vn="normal";Tn.black?Vn="900":Tn.bold&&(Vn="bold");const Un=Tn.italic?"italic":"normal",Wn=`"${Ln}", ${Tn.fallbackName}`;let rr=_n;_n<Bt?rr=Bt:_n>Vt&&(rr=Vt),this.current.fontSizeScale=_n/rr,this.ctx.font=`${Un} ${Vn} ${rr}px ${Wn}`}setTextRenderingMode(vn){this.current.textRenderingMode=vn}setTextRise(vn){this.current.textRise=vn}moveText(vn,_n){this.current.x=this.current.lineX+=vn,this.current.y=this.current.lineY+=_n}setLeadingMoveText(vn,_n){this.setLeading(-_n),this.moveText(vn,_n)}setTextMatrix(vn,_n,Tn,Pn,Ln,Vn){this.current.textMatrix=[vn,_n,Tn,Pn,Ln,Vn],this.current.textMatrixScale=Math.hypot(vn,_n),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(vn,_n,Tn,Pn){const Ln=this.ctx,Vn=this.current,Un=Vn.font,Wn=Vn.textRenderingMode,rr=Vn.fontSize/Vn.fontSizeScale,ar=Wn&kt.TextRenderingMode.FILL_STROKE_MASK,nr=!!(Wn&kt.TextRenderingMode.ADD_TO_PATH_FLAG),mr=Vn.patternFill&&!Un.missingFile;let kn;(Un.disableFontFace||nr||mr)&&(kn=Un.getPathGenerator(this.commonObjs,vn)),Un.disableFontFace||mr?(Ln.save(),Ln.translate(_n,Tn),Ln.beginPath(),kn(Ln,rr),Pn&&Ln.setTransform(...Pn),(ar===kt.TextRenderingMode.FILL||ar===kt.TextRenderingMode.FILL_STROKE)&&Ln.fill(),(ar===kt.TextRenderingMode.STROKE||ar===kt.TextRenderingMode.FILL_STROKE)&&Ln.stroke(),Ln.restore()):((ar===kt.TextRenderingMode.FILL||ar===kt.TextRenderingMode.FILL_STROKE)&&Ln.fillText(vn,_n,Tn),(ar===kt.TextRenderingMode.STROKE||ar===kt.TextRenderingMode.FILL_STROKE)&&Ln.strokeText(vn,_n,Tn)),nr&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,Mt.getCurrentTransform)(Ln),x:_n,y:Tn,fontSize:rr,addToPath:kn})}get isFontSubpixelAAEnabled(){const{context:vn}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);vn.scale(1.5,1),vn.fillText("I",0,10);const _n=vn.getImageData(0,0,10,10).data;let Tn=!1;for(let Pn=3;Pn<_n.length;Pn+=4)if(_n[Pn]>0&&_n[Pn]<255){Tn=!0;break}return(0,kt.shadow)(this,"isFontSubpixelAAEnabled",Tn)}showText(vn){const _n=this.current,Tn=_n.font;if(Tn.isType3Font)return this.showType3Text(vn);const Pn=_n.fontSize;if(Pn===0)return;const Ln=this.ctx,Vn=_n.fontSizeScale,Un=_n.charSpacing,Wn=_n.wordSpacing,rr=_n.fontDirection,ar=_n.textHScale*rr,nr=vn.length,mr=Tn.vertical,kn=mr?1:-1,Fn=Tn.defaultVMetrics,Hn=Pn*_n.fontMatrix[0],Bn=_n.textRenderingMode===kt.TextRenderingMode.FILL&&!Tn.disableFontFace&&!_n.patternFill;Ln.save(),Ln.transform(..._n.textMatrix),Ln.translate(_n.x,_n.y+_n.textRise),rr>0?Ln.scale(ar,-1):Ln.scale(ar,1);let jn;if(_n.patternFill){Ln.save();const Qn=_n.fillColor.getPattern(Ln,this,(0,Mt.getCurrentTransformInverse)(Ln),Ft.PathType.FILL);jn=(0,Mt.getCurrentTransform)(Ln),Ln.restore(),Ln.fillStyle=Qn}let sr=_n.lineWidth;const Ar=_n.textMatrixScale;if(Ar===0||sr===0){const Qn=_n.textRenderingMode&kt.TextRenderingMode.FILL_STROKE_MASK;(Qn===kt.TextRenderingMode.STROKE||Qn===kt.TextRenderingMode.FILL_STROKE)&&(sr=this.getSinglePixelWidth())}else sr/=Ar;if(Vn!==1&&(Ln.scale(Vn,Vn),sr/=Vn),Ln.lineWidth=sr,Tn.isInvalidPDFjsFont){const Qn=[];let jr=0;for(const Mr of vn)Qn.push(Mr.unicode),jr+=Mr.width;Ln.fillText(Qn.join(""),0,0),_n.x+=jr*Hn*ar,Ln.restore(),this.compose();return}let Fr=0,Rr;for(Rr=0;Rr<nr;++Rr){const Qn=vn[Rr];if(typeof Qn=="number"){Fr+=kn*Qn*Pn/1e3;continue}let jr=!1;const Mr=(Qn.isSpace?Wn:0)+Un,pr=Qn.fontChar,Tr=Qn.accent;let Hr,Xr,Zr=Qn.width;if(mr){const hr=Qn.vmetric||Fn,gr=-(Qn.vmetric?hr[1]:Zr*.5)*Hn,qr=hr[2]*Hn;Zr=hr?-hr[0]:Zr,Hr=gr/Vn,Xr=(Fr+qr)/Vn}else Hr=Fr/Vn,Xr=0;if(Tn.remeasure&&Zr>0){const hr=Ln.measureText(pr).width*1e3/Pn*Vn;if(Zr<hr&&this.isFontSubpixelAAEnabled){const gr=Zr/hr;jr=!0,Ln.save(),Ln.scale(gr,1),Hr/=gr}else Zr!==hr&&(Hr+=(Zr-hr)/2e3*Pn/Vn)}if(this.contentVisible&&(Qn.isInFont||Tn.missingFile)){if(Bn&&!Tr)Ln.fillText(pr,Hr,Xr);else if(this.paintChar(pr,Hr,Xr,jn),Tr){const hr=Hr+Pn*Tr.offset.x/Vn,gr=Xr-Pn*Tr.offset.y/Vn;this.paintChar(Tr.fontChar,hr,gr,jn)}}let ur;mr?ur=Zr*Hn-Mr*rr:ur=Zr*Hn+Mr*rr,Fr+=ur,jr&&Ln.restore()}mr?_n.y-=Fr:_n.x+=Fr*ar,Ln.restore(),this.compose()}showType3Text(vn){const _n=this.ctx,Tn=this.current,Pn=Tn.font,Ln=Tn.fontSize,Vn=Tn.fontDirection,Un=Pn.vertical?1:-1,Wn=Tn.charSpacing,rr=Tn.wordSpacing,ar=Tn.textHScale*Vn,nr=Tn.fontMatrix||kt.FONT_IDENTITY_MATRIX,mr=vn.length,kn=Tn.textRenderingMode===kt.TextRenderingMode.INVISIBLE;let Fn,Hn,Bn,jn;if(!(kn||Ln===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,_n.save(),_n.transform(...Tn.textMatrix),_n.translate(Tn.x,Tn.y),_n.scale(ar,Vn),Fn=0;Fn<mr;++Fn){if(Hn=vn[Fn],typeof Hn=="number"){jn=Un*Hn*Ln/1e3,this.ctx.translate(jn,0),Tn.x+=jn*ar;continue}const sr=(Hn.isSpace?rr:0)+Wn,Ar=Pn.charProcOperatorList[Hn.operatorListId];if(!Ar){(0,kt.warn)(`Type3 character "${Hn.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Hn,this.save(),_n.scale(Ln,Ln),_n.transform(...nr),this.executeOperatorList(Ar),this.restore()),Bn=kt.Util.applyTransform([Hn.width,0],nr)[0]*Ln+sr,_n.translate(Bn,0),Tn.x+=Bn*ar}_n.restore(),this.processingType3=null}}setCharWidth(vn,_n){}setCharWidthAndBounds(vn,_n,Tn,Pn,Ln,Vn){this.ctx.rect(Tn,Pn,Ln-Tn,Vn-Pn),this.ctx.clip(),this.endPath()}getColorN_Pattern(vn){let _n;if(vn[0]==="TilingPattern"){const Tn=vn[1],Pn=this.baseTransform||(0,Mt.getCurrentTransform)(this.ctx),Ln={createCanvasGraphics:Vn=>new An(Vn,this.commonObjs,this.objs,this.canvasFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};_n=new Ft.TilingPattern(vn,Tn,this.ctx,Ln,Pn)}else _n=this._getPattern(vn[1],vn[2]);return _n}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(vn,_n,Tn){var Ln;const Pn=((Ln=this.selectColor)==null?void 0:Ln.call(this,vn,_n,Tn))||kt.Util.makeHexColor(vn,_n,Tn);this.ctx.strokeStyle=Pn,this.current.strokeColor=Pn}setFillRGBColor(vn,_n,Tn){var Ln;const Pn=((Ln=this.selectColor)==null?void 0:Ln.call(this,vn,_n,Tn))||kt.Util.makeHexColor(vn,_n,Tn);this.ctx.fillStyle=Pn,this.current.fillColor=Pn,this.current.patternFill=!1}_getPattern(vn,_n=null){let Tn;return this.cachedPatterns.has(vn)?Tn=this.cachedPatterns.get(vn):(Tn=(0,Ft.getShadingPattern)(this.objs.get(vn)),this.cachedPatterns.set(vn,Tn)),_n&&(Tn.matrix=_n),Tn}shadingFill(vn){if(!this.contentVisible)return;const _n=this.ctx;this.save();const Tn=this._getPattern(vn);_n.fillStyle=Tn.getPattern(_n,this,(0,Mt.getCurrentTransformInverse)(_n),Ft.PathType.SHADING);const Pn=(0,Mt.getCurrentTransformInverse)(_n);if(Pn){const Ln=_n.canvas,Vn=Ln.width,Un=Ln.height,Wn=kt.Util.applyTransform([0,0],Pn),rr=kt.Util.applyTransform([0,Un],Pn),ar=kt.Util.applyTransform([Vn,0],Pn),nr=kt.Util.applyTransform([Vn,Un],Pn),mr=Math.min(Wn[0],rr[0],ar[0],nr[0]),kn=Math.min(Wn[1],rr[1],ar[1],nr[1]),Fn=Math.max(Wn[0],rr[0],ar[0],nr[0]),Hn=Math.max(Wn[1],rr[1],ar[1],nr[1]);this.ctx.fillRect(mr,kn,Fn-mr,Hn-kn)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,kt.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,kt.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(vn,_n){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(vn)&&vn.length===6&&this.transform(...vn),this.baseTransform=(0,Mt.getCurrentTransform)(this.ctx),_n)){const Tn=_n[2]-_n[0],Pn=_n[3]-_n[1];this.ctx.rect(_n[0],_n[1],Tn,Pn),this.current.updateRectMinMax((0,Mt.getCurrentTransform)(this.ctx),_n),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(vn){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const _n=this.ctx;vn.isolated||(0,kt.info)("TODO: Support non-isolated groups."),vn.knockout&&(0,kt.warn)("Knockout groups not supported.");const Tn=(0,Mt.getCurrentTransform)(_n);if(vn.matrix&&_n.transform(...vn.matrix),!vn.bbox)throw new Error("Bounding box is required.");let Pn=kt.Util.getAxialAlignedBoundingBox(vn.bbox,(0,Mt.getCurrentTransform)(_n));const Ln=[0,0,_n.canvas.width,_n.canvas.height];Pn=kt.Util.intersect(Pn,Ln)||[0,0,0,0];const Vn=Math.floor(Pn[0]),Un=Math.floor(Pn[1]);let Wn=Math.max(Math.ceil(Pn[2])-Vn,1),rr=Math.max(Math.ceil(Pn[3])-Un,1),ar=1,nr=1;Wn>zt&&(ar=Wn/zt,Wn=zt),rr>zt&&(nr=rr/zt,rr=zt),this.current.startNewPathAndClipBox([0,0,Wn,rr]);let mr="groupAt"+this.groupLevel;vn.smask&&(mr+="_smask_"+this.smaskCounter++%2);const kn=this.cachedCanvases.getCanvas(mr,Wn,rr),Fn=kn.context;Fn.scale(1/ar,1/nr),Fn.translate(-Vn,-Un),Fn.transform(...Tn),vn.smask?this.smaskStack.push({canvas:kn.canvas,context:Fn,offsetX:Vn,offsetY:Un,scaleX:ar,scaleY:nr,subtype:vn.smask.subtype,backdrop:vn.smask.backdrop,transferMap:vn.smask.transferMap||null,startTransformInverse:null}):(_n.setTransform(1,0,0,1,0,0),_n.translate(Vn,Un),_n.scale(ar,nr),_n.save()),ln(_n,Fn),this.ctx=Fn,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(_n),this.groupLevel++}endGroup(vn){if(!this.contentVisible)return;this.groupLevel--;const _n=this.ctx,Tn=this.groupStack.pop();if(this.ctx=Tn,this.ctx.imageSmoothingEnabled=!1,vn.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const Pn=(0,Mt.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...Pn);const Ln=kt.Util.getAxialAlignedBoundingBox([0,0,_n.canvas.width,_n.canvas.height],Pn);this.ctx.drawImage(_n.canvas,0,0),this.ctx.restore(),this.compose(Ln)}}beginAnnotation(vn,_n,Tn,Pn,Ln){if(es(this,Rn,Nu).call(this),dn(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(_n)&&_n.length===4){const Vn=_n[2]-_n[0],Un=_n[3]-_n[1];if(Ln&&this.annotationCanvasMap){Tn=Tn.slice(),Tn[4]-=_n[0],Tn[5]-=_n[1],_n=_n.slice(),_n[0]=_n[1]=0,_n[2]=Vn,_n[3]=Un;const[Wn,rr]=kt.Util.singularValueDecompose2dScale((0,Mt.getCurrentTransform)(this.ctx)),{viewportScale:ar}=this,nr=Math.ceil(Vn*this.outputScaleX*ar),mr=Math.ceil(Un*this.outputScaleY*ar);this.annotationCanvas=this.canvasFactory.create(nr,mr);const{canvas:kn,context:Fn}=this.annotationCanvas;this.annotationCanvasMap.set(vn,kn),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Fn,this.ctx.setTransform(Wn,0,0,-rr,0,Un*rr),dn(this.ctx,this.foregroundColor)}else dn(this.ctx,this.foregroundColor),this.ctx.rect(_n[0],_n[1],Vn,Un),this.ctx.clip(),this.endPath()}this.current=new Jt(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...Tn),this.transform(...Pn)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(vn){if(!this.contentVisible)return;const _n=vn.count;vn=this.getObject(vn.data,vn),vn.count=_n;const Tn=this.ctx,Pn=this.processingType3;if(Pn&&(Pn.compiled===void 0&&(Pn.compiled=Qt(vn)),Pn.compiled)){Pn.compiled(Tn);return}const Ln=this._createMaskCanvas(vn),Vn=Ln.canvas;Tn.save(),Tn.setTransform(1,0,0,1,0,0),Tn.drawImage(Vn,Ln.offsetX,Ln.offsetY),Tn.restore(),this.compose()}paintImageMaskXObjectRepeat(vn,_n,Tn=0,Pn=0,Ln,Vn){if(!this.contentVisible)return;vn=this.getObject(vn.data,vn);const Un=this.ctx;Un.save();const Wn=(0,Mt.getCurrentTransform)(Un);Un.transform(_n,Tn,Pn,Ln,0,0);const rr=this._createMaskCanvas(vn);Un.setTransform(1,0,0,1,rr.offsetX-Wn[4],rr.offsetY-Wn[5]);for(let ar=0,nr=Vn.length;ar<nr;ar+=2){const mr=kt.Util.transform(Wn,[_n,Tn,Pn,Ln,Vn[ar],Vn[ar+1]]),[kn,Fn]=kt.Util.applyTransform([0,0],mr);Un.drawImage(rr.canvas,kn,Fn)}Un.restore(),this.compose()}paintImageMaskXObjectGroup(vn){if(!this.contentVisible)return;const _n=this.ctx,Tn=this.current.fillColor,Pn=this.current.patternFill;for(const Ln of vn){const{data:Vn,width:Un,height:Wn,transform:rr}=Ln,ar=this.cachedCanvases.getCanvas("maskCanvas",Un,Wn),nr=ar.context;nr.save();const mr=this.getObject(Vn,Ln);sn(nr,mr),nr.globalCompositeOperation="source-in",nr.fillStyle=Pn?Tn.getPattern(nr,this,(0,Mt.getCurrentTransformInverse)(_n),Ft.PathType.FILL):Tn,nr.fillRect(0,0,Un,Wn),nr.restore(),_n.save(),_n.transform(...rr),_n.scale(1,-1),Xt(_n,ar.canvas,0,0,Un,Wn,0,-1,1,1),_n.restore()}this.compose()}paintImageXObject(vn){if(!this.contentVisible)return;const _n=this.getObject(vn);if(!_n){(0,kt.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(_n)}paintImageXObjectRepeat(vn,_n,Tn,Pn){if(!this.contentVisible)return;const Ln=this.getObject(vn);if(!Ln){(0,kt.warn)("Dependent image isn't ready yet");return}const Vn=Ln.width,Un=Ln.height,Wn=[];for(let rr=0,ar=Pn.length;rr<ar;rr+=2)Wn.push({transform:[_n,0,0,Tn,Pn[rr],Pn[rr+1]],x:0,y:0,w:Vn,h:Un});this.paintInlineImageXObjectGroup(Ln,Wn)}paintInlineImageXObject(vn){if(!this.contentVisible)return;const _n=vn.width,Tn=vn.height,Pn=this.ctx;this.save(),Pn.scale(1/_n,-1/Tn);let Ln;if(typeof HTMLElement=="function"&&vn instanceof HTMLElement||!vn.data)Ln=vn;else{const Un=this.cachedCanvases.getCanvas("inlineImage",_n,Tn),Wn=Un.context;Zt(Wn,vn,this.current.transferMaps),Ln=Un.canvas}const Vn=this._scaleImage(Ln,(0,Mt.getCurrentTransformInverse)(Pn));Pn.imageSmoothingEnabled=En((0,Mt.getCurrentTransform)(Pn),vn.interpolate),Xt(Pn,Vn.img,0,0,Vn.paintWidth,Vn.paintHeight,0,-Tn,_n,Tn),this.compose(),this.restore()}paintInlineImageXObjectGroup(vn,_n){if(!this.contentVisible)return;const Tn=this.ctx,Pn=vn.width,Ln=vn.height,Vn=this.cachedCanvases.getCanvas("inlineImage",Pn,Ln),Un=Vn.context;Zt(Un,vn,this.current.transferMaps);for(const Wn of _n)Tn.save(),Tn.transform(...Wn.transform),Tn.scale(1,-1),Xt(Tn,Vn.canvas,Wn.x,Wn.y,Wn.w,Wn.h,0,-1,1,1),Tn.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(vn){}markPointProps(vn,_n){}beginMarkedContent(vn){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(vn,_n){vn==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(_n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(vn){const _n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(vn);const Tn=this.ctx;this.pendingClip&&(_n||(this.pendingClip===$n?Tn.clip("evenodd"):Tn.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),Tn.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const vn=(0,Mt.getCurrentTransform)(this.ctx);if(vn[1]===0&&vn[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(vn[0]),Math.abs(vn[3]));else{const _n=Math.abs(vn[0]*vn[3]-vn[2]*vn[1]),Tn=Math.hypot(vn[0],vn[2]),Pn=Math.hypot(vn[1],vn[3]);this._cachedGetSinglePixelWidth=Math.max(Tn,Pn)/_n}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:vn}=this.current,_n=(0,Mt.getCurrentTransform)(this.ctx);let Tn,Pn;if(_n[1]===0&&_n[2]===0){const Ln=Math.abs(_n[0]),Vn=Math.abs(_n[3]);if(vn===0)Tn=1/Ln,Pn=1/Vn;else{const Un=Ln*vn,Wn=Vn*vn;Tn=Un<1?1/Un:1,Pn=Wn<1?1/Wn:1}}else{const Ln=Math.abs(_n[0]*_n[3]-_n[2]*_n[1]),Vn=Math.hypot(_n[0],_n[1]),Un=Math.hypot(_n[2],_n[3]);if(vn===0)Tn=Un/Ln,Pn=Vn/Ln;else{const Wn=vn*Ln;Tn=Un>Wn?Un/Wn:1,Pn=Vn>Wn?Vn/Wn:1}}this._cachedScaleForStroking=[Tn,Pn]}return this._cachedScaleForStroking}rescaleAndStroke(vn){const{ctx:_n}=this,{lineWidth:Tn}=this.current,[Pn,Ln]=this.getScaleForStroking();if(_n.lineWidth=Tn||1,Pn===1&&Ln===1){_n.stroke();return}let Vn,Un,Wn;vn&&(Vn=(0,Mt.getCurrentTransform)(_n),Un=_n.getLineDash().slice(),Wn=_n.lineDashOffset),_n.scale(Pn,Ln);const rr=Math.max(Pn,Ln);_n.setLineDash(_n.getLineDash().map(ar=>ar/rr)),_n.lineDashOffset/=rr,_n.stroke(),vn&&(_n.setTransform(...Vn),_n.setLineDash(Un),_n.lineDashOffset=Wn)}isContentVisible(){for(let vn=this.markedContentStack.length-1;vn>=0;vn--)if(!this.markedContentStack[vn].visible)return!1;return!0}};Rn=new WeakSet,Nu=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)};let wn=An;$t.CanvasGraphics=wn;for(const Sn in kt.OPS)wn.prototype[Sn]!==void 0&&(wn.prototype[kt.OPS[Sn]]=wn.prototype[Sn])},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.TilingPattern=$t.PathType=void 0,$t.getShadingPattern=Wt;var kt=Ct(1),Mt=Ct(6);const Ft={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};$t.PathType=Ft;function jt(Xt,Qt){if(!Qt)return;const Jt=Qt[2]-Qt[0],Zt=Qt[3]-Qt[1],sn=new Path2D;sn.rect(Qt[0],Qt[1],Jt,Zt),Xt.clip(sn)}class Bt{constructor(){this.constructor===Bt&&(0,kt.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,kt.unreachable)("Abstract method `getPattern` called.")}}class Vt extends Bt{constructor(Qt){super(),this._type=Qt[1],this._bbox=Qt[2],this._colorStops=Qt[3],this._p0=Qt[4],this._p1=Qt[5],this._r0=Qt[6],this._r1=Qt[7],this.matrix=null}_createGradient(Qt){let Jt;this._type==="axial"?Jt=Qt.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(Jt=Qt.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const Zt of this._colorStops)Jt.addColorStop(Zt[0],Zt[1]);return Jt}getPattern(Qt,Jt,Zt,sn){let ln;if(sn===Ft.STROKE||sn===Ft.FILL){const dn=Jt.current.getClippedPathBoundingBox(sn,(0,Mt.getCurrentTransform)(Qt))||[0,0,0,0],hn=Math.ceil(dn[2]-dn[0])||1,cn=Math.ceil(dn[3]-dn[1])||1,pn=Jt.cachedCanvases.getCanvas("pattern",hn,cn,!0),yn=pn.context;yn.clearRect(0,0,yn.canvas.width,yn.canvas.height),yn.beginPath(),yn.rect(0,0,yn.canvas.width,yn.canvas.height),yn.translate(-dn[0],-dn[1]),Zt=kt.Util.transform(Zt,[1,0,0,1,dn[0],dn[1]]),yn.transform(...Jt.baseTransform),this.matrix&&yn.transform(...this.matrix),jt(yn,this._bbox),yn.fillStyle=this._createGradient(yn),yn.fill(),ln=Qt.createPattern(pn.canvas,"no-repeat");const gn=new DOMMatrix(Zt);ln.setTransform(gn)}else jt(Qt,this._bbox),ln=this._createGradient(Qt);return ln}}function zt(Xt,Qt,Jt,Zt,sn,ln,dn,hn){const cn=Qt.coords,pn=Qt.colors,yn=Xt.data,gn=Xt.width*4;let En;cn[Jt+1]>cn[Zt+1]&&(En=Jt,Jt=Zt,Zt=En,En=ln,ln=dn,dn=En),cn[Zt+1]>cn[sn+1]&&(En=Zt,Zt=sn,sn=En,En=dn,dn=hn,hn=En),cn[Jt+1]>cn[Zt+1]&&(En=Jt,Jt=Zt,Zt=En,En=ln,ln=dn,dn=En);const bn=(cn[Jt]+Qt.offsetX)*Qt.scaleX,xn=(cn[Jt+1]+Qt.offsetY)*Qt.scaleY,Cn=(cn[Zt]+Qt.offsetX)*Qt.scaleX,$n=(cn[Zt+1]+Qt.offsetY)*Qt.scaleY,wn=(cn[sn]+Qt.offsetX)*Qt.scaleX,Rn=(cn[sn+1]+Qt.offsetY)*Qt.scaleY;if(xn>=Rn)return;const Dn=pn[ln],An=pn[ln+1],Sn=pn[ln+2],vn=pn[dn],_n=pn[dn+1],Tn=pn[dn+2],Pn=pn[hn],Ln=pn[hn+1],Vn=pn[hn+2],Un=Math.round(xn),Wn=Math.round(Rn);let rr,ar,nr,mr,kn,Fn,Hn,Bn;for(let jn=Un;jn<=Wn;jn++){if(jn<$n){let Qn;jn<xn?Qn=0:Qn=(xn-jn)/(xn-$n),rr=bn-(bn-Cn)*Qn,ar=Dn-(Dn-vn)*Qn,nr=An-(An-_n)*Qn,mr=Sn-(Sn-Tn)*Qn}else{let Qn;jn>Rn?Qn=1:$n===Rn?Qn=0:Qn=($n-jn)/($n-Rn),rr=Cn-(Cn-wn)*Qn,ar=vn-(vn-Pn)*Qn,nr=_n-(_n-Ln)*Qn,mr=Tn-(Tn-Vn)*Qn}let sr;jn<xn?sr=0:jn>Rn?sr=1:sr=(xn-jn)/(xn-Rn),kn=bn-(bn-wn)*sr,Fn=Dn-(Dn-Pn)*sr,Hn=An-(An-Ln)*sr,Bn=Sn-(Sn-Vn)*sr;const Ar=Math.round(Math.min(rr,kn)),Fr=Math.round(Math.max(rr,kn));let Rr=gn*jn+Ar*4;for(let Qn=Ar;Qn<=Fr;Qn++)sr=(rr-Qn)/(rr-kn),sr<0?sr=0:sr>1&&(sr=1),yn[Rr++]=ar-(ar-Fn)*sr|0,yn[Rr++]=nr-(nr-Hn)*sr|0,yn[Rr++]=mr-(mr-Bn)*sr|0,yn[Rr++]=255}}function Ht(Xt,Qt,Jt){const Zt=Qt.coords,sn=Qt.colors;let ln,dn;switch(Qt.type){case"lattice":const hn=Qt.verticesPerRow,cn=Math.floor(Zt.length/hn)-1,pn=hn-1;for(ln=0;ln<cn;ln++){let yn=ln*hn;for(let gn=0;gn<pn;gn++,yn++)zt(Xt,Jt,Zt[yn],Zt[yn+1],Zt[yn+hn],sn[yn],sn[yn+1],sn[yn+hn]),zt(Xt,Jt,Zt[yn+hn+1],Zt[yn+1],Zt[yn+hn],sn[yn+hn+1],sn[yn+1],sn[yn+hn])}break;case"triangles":for(ln=0,dn=Zt.length;ln<dn;ln+=3)zt(Xt,Jt,Zt[ln],Zt[ln+1],Zt[ln+2],sn[ln],sn[ln+1],sn[ln+2]);break;default:throw new Error("illegal figure")}}class Gt extends Bt{constructor(Qt){super(),this._coords=Qt[2],this._colors=Qt[3],this._figures=Qt[4],this._bounds=Qt[5],this._bbox=Qt[7],this._background=Qt[8],this.matrix=null}_createMeshCanvas(Qt,Jt,Zt){const hn=Math.floor(this._bounds[0]),cn=Math.floor(this._bounds[1]),pn=Math.ceil(this._bounds[2])-hn,yn=Math.ceil(this._bounds[3])-cn,gn=Math.min(Math.ceil(Math.abs(pn*Qt[0]*1.1)),3e3),En=Math.min(Math.ceil(Math.abs(yn*Qt[1]*1.1)),3e3),bn=pn/gn,xn=yn/En,Cn={coords:this._coords,colors:this._colors,offsetX:-hn,offsetY:-cn,scaleX:1/bn,scaleY:1/xn},$n=gn+2*2,wn=En+2*2,Rn=Zt.getCanvas("mesh",$n,wn,!1),Dn=Rn.context,An=Dn.createImageData(gn,En);if(Jt){const vn=An.data;for(let _n=0,Tn=vn.length;_n<Tn;_n+=4)vn[_n]=Jt[0],vn[_n+1]=Jt[1],vn[_n+2]=Jt[2],vn[_n+3]=255}for(const vn of this._figures)Ht(An,vn,Cn);return Dn.putImageData(An,2,2),{canvas:Rn.canvas,offsetX:hn-2*bn,offsetY:cn-2*xn,scaleX:bn,scaleY:xn}}getPattern(Qt,Jt,Zt,sn){jt(Qt,this._bbox);let ln;if(sn===Ft.SHADING)ln=kt.Util.singularValueDecompose2dScale((0,Mt.getCurrentTransform)(Qt));else if(ln=kt.Util.singularValueDecompose2dScale(Jt.baseTransform),this.matrix){const hn=kt.Util.singularValueDecompose2dScale(this.matrix);ln=[ln[0]*hn[0],ln[1]*hn[1]]}const dn=this._createMeshCanvas(ln,sn===Ft.SHADING?null:this._background,Jt.cachedCanvases);return sn!==Ft.SHADING&&(Qt.setTransform(...Jt.baseTransform),this.matrix&&Qt.transform(...this.matrix)),Qt.translate(dn.offsetX,dn.offsetY),Qt.scale(dn.scaleX,dn.scaleY),Qt.createPattern(dn.canvas,"no-repeat")}}class qt extends Bt{getPattern(){return"hotpink"}}function Wt(Xt){switch(Xt[0]){case"RadialAxial":return new Vt(Xt);case"Mesh":return new Gt(Xt);case"Dummy":return new qt}throw new Error(`Unknown IR type: ${Xt[0]}`)}const Yt={COLORED:1,UNCOLORED:2};class Kt{static get MAX_PATTERN_SIZE(){return(0,kt.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(Qt,Jt,Zt,sn,ln){this.operatorList=Qt[2],this.matrix=Qt[3]||[1,0,0,1,0,0],this.bbox=Qt[4],this.xstep=Qt[5],this.ystep=Qt[6],this.paintType=Qt[7],this.tilingType=Qt[8],this.color=Jt,this.ctx=Zt,this.canvasGraphicsFactory=sn,this.baseTransform=ln}createPatternCanvas(Qt){const Jt=this.operatorList,Zt=this.bbox,sn=this.xstep,ln=this.ystep,dn=this.paintType,hn=this.tilingType,cn=this.color,pn=this.canvasGraphicsFactory;(0,kt.info)("TilingType: "+hn);const yn=Zt[0],gn=Zt[1],En=Zt[2],bn=Zt[3],xn=kt.Util.singularValueDecompose2dScale(this.matrix),Cn=kt.Util.singularValueDecompose2dScale(this.baseTransform),$n=[xn[0]*Cn[0],xn[1]*Cn[1]],wn=this.getSizeAndScale(sn,this.ctx.canvas.width,$n[0]),Rn=this.getSizeAndScale(ln,this.ctx.canvas.height,$n[1]),Dn=Qt.cachedCanvases.getCanvas("pattern",wn.size,Rn.size,!0),An=Dn.context,Sn=pn.createCanvasGraphics(An);Sn.groupLevel=Qt.groupLevel,this.setFillAndStrokeStyleToContext(Sn,dn,cn);let vn=yn,_n=gn,Tn=En,Pn=bn;return yn<0&&(vn=0,Tn+=Math.abs(yn)),gn<0&&(_n=0,Pn+=Math.abs(gn)),An.translate(-(wn.scale*vn),-(Rn.scale*_n)),Sn.transform(wn.scale,0,0,Rn.scale,0,0),An.save(),this.clipBbox(Sn,vn,_n,Tn,Pn),Sn.baseTransform=(0,Mt.getCurrentTransform)(Sn.ctx),Sn.executeOperatorList(Jt),Sn.endDrawing(),{canvas:Dn.canvas,scaleX:wn.scale,scaleY:Rn.scale,offsetX:vn,offsetY:_n}}getSizeAndScale(Qt,Jt,Zt){Qt=Math.abs(Qt);const sn=Math.max(Kt.MAX_PATTERN_SIZE,Jt);let ln=Math.ceil(Qt*Zt);return ln>=sn?ln=sn:Zt=ln/Qt,{scale:Zt,size:ln}}clipBbox(Qt,Jt,Zt,sn,ln){const dn=sn-Jt,hn=ln-Zt;Qt.ctx.rect(Jt,Zt,dn,hn),Qt.current.updateRectMinMax((0,Mt.getCurrentTransform)(Qt.ctx),[Jt,Zt,sn,ln]),Qt.clip(),Qt.endPath()}setFillAndStrokeStyleToContext(Qt,Jt,Zt){const sn=Qt.ctx,ln=Qt.current;switch(Jt){case Yt.COLORED:const dn=this.ctx;sn.fillStyle=dn.fillStyle,sn.strokeStyle=dn.strokeStyle,ln.fillColor=dn.fillStyle,ln.strokeColor=dn.strokeStyle;break;case Yt.UNCOLORED:const hn=kt.Util.makeHexColor(Zt[0],Zt[1],Zt[2]);sn.fillStyle=hn,sn.strokeStyle=hn,ln.fillColor=hn,ln.strokeColor=hn;break;default:throw new kt.FormatError(`Unsupported paint type: ${Jt}`)}}getPattern(Qt,Jt,Zt,sn){let ln=Zt;sn!==Ft.SHADING&&(ln=kt.Util.transform(ln,Jt.baseTransform),this.matrix&&(ln=kt.Util.transform(ln,this.matrix)));const dn=this.createPatternCanvas(Jt);let hn=new DOMMatrix(ln);hn=hn.translate(dn.offsetX,dn.offsetY),hn=hn.scale(1/dn.scaleX,1/dn.scaleY);const cn=Qt.createPattern(dn.canvas,"repeat");return cn.setTransform(hn),cn}}$t.TilingPattern=Kt},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.applyMaskImageData=Mt;var kt=Ct(1);function Mt({src:Ft,srcPos:jt=0,dest:Bt,destPos:Vt=0,width:zt,height:Ht,inverseDecode:Gt=!1}){const qt=kt.FeatureTest.isLittleEndian?4278190080:255,[Wt,Yt]=Gt?[0,qt]:[qt,0],Kt=zt>>3,Xt=zt&7,Qt=Ft.length;Bt=new Uint32Array(Bt.buffer);for(let Jt=0;Jt<Ht;Jt++){for(const sn=jt+Kt;jt<sn;jt++){const ln=jt<Qt?Ft[jt]:255;Bt[Vt++]=ln&128?Yt:Wt,Bt[Vt++]=ln&64?Yt:Wt,Bt[Vt++]=ln&32?Yt:Wt,Bt[Vt++]=ln&16?Yt:Wt,Bt[Vt++]=ln&8?Yt:Wt,Bt[Vt++]=ln&4?Yt:Wt,Bt[Vt++]=ln&2?Yt:Wt,Bt[Vt++]=ln&1?Yt:Wt}if(Xt===0)continue;const Zt=jt<Qt?Ft[jt++]:255;for(let sn=0;sn<Xt;sn++)Bt[Vt++]=Zt&1<<7-sn?Yt:Wt}return{srcPos:jt,destPos:Vt}}},(xt,$t)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.GlobalWorkerOptions=void 0;const Ct=Object.create(null);$t.GlobalWorkerOptions=Ct,Ct.workerPort=null,Ct.workerSrc=""},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.MessageHandler=void 0;var kt=Ct(1);const Mt={UNKNOWN:0,DATA:1,ERROR:2},Ft={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function jt(Vt){switch(Vt instanceof Error||typeof Vt=="object"&&Vt!==null||(0,kt.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),Vt.name){case"AbortException":return new kt.AbortException(Vt.message);case"MissingPDFException":return new kt.MissingPDFException(Vt.message);case"PasswordException":return new kt.PasswordException(Vt.message,Vt.code);case"UnexpectedResponseException":return new kt.UnexpectedResponseException(Vt.message,Vt.status);case"UnknownErrorException":return new kt.UnknownErrorException(Vt.message,Vt.details);default:return new kt.UnknownErrorException(Vt.message,Vt.toString())}}class Bt{constructor(zt,Ht,Gt){this.sourceName=zt,this.targetName=Ht,this.comObj=Gt,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=qt=>{const Wt=qt.data;if(Wt.targetName!==this.sourceName)return;if(Wt.stream){this._processStreamMessage(Wt);return}if(Wt.callback){const Kt=Wt.callbackId,Xt=this.callbackCapabilities[Kt];if(!Xt)throw new Error(`Cannot resolve callback ${Kt}`);if(delete this.callbackCapabilities[Kt],Wt.callback===Mt.DATA)Xt.resolve(Wt.data);else if(Wt.callback===Mt.ERROR)Xt.reject(jt(Wt.reason));else throw new Error("Unexpected callback case");return}const Yt=this.actionHandler[Wt.action];if(!Yt)throw new Error(`Unknown action from worker: ${Wt.action}`);if(Wt.callbackId){const Kt=this.sourceName,Xt=Wt.sourceName;new Promise(function(Qt){Qt(Yt(Wt.data))}).then(function(Qt){Gt.postMessage({sourceName:Kt,targetName:Xt,callback:Mt.DATA,callbackId:Wt.callbackId,data:Qt})},function(Qt){Gt.postMessage({sourceName:Kt,targetName:Xt,callback:Mt.ERROR,callbackId:Wt.callbackId,reason:jt(Qt)})});return}if(Wt.streamId){this._createStreamSink(Wt);return}Yt(Wt.data)},Gt.addEventListener("message",this._onComObjOnMessage)}on(zt,Ht){const Gt=this.actionHandler;if(Gt[zt])throw new Error(`There is already an actionName called "${zt}"`);Gt[zt]=Ht}send(zt,Ht,Gt){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:zt,data:Ht},Gt)}sendWithPromise(zt,Ht,Gt){const qt=this.callbackId++,Wt=(0,kt.createPromiseCapability)();this.callbackCapabilities[qt]=Wt;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:zt,callbackId:qt,data:Ht},Gt)}catch(Yt){Wt.reject(Yt)}return Wt.promise}sendWithStream(zt,Ht,Gt,qt){const Wt=this.streamId++,Yt=this.sourceName,Kt=this.targetName,Xt=this.comObj;return new ReadableStream({start:Qt=>{const Jt=(0,kt.createPromiseCapability)();return this.streamControllers[Wt]={controller:Qt,startCall:Jt,pullCall:null,cancelCall:null,isClosed:!1},Xt.postMessage({sourceName:Yt,targetName:Kt,action:zt,streamId:Wt,data:Ht,desiredSize:Qt.desiredSize},qt),Jt.promise},pull:Qt=>{const Jt=(0,kt.createPromiseCapability)();return this.streamControllers[Wt].pullCall=Jt,Xt.postMessage({sourceName:Yt,targetName:Kt,stream:Ft.PULL,streamId:Wt,desiredSize:Qt.desiredSize}),Jt.promise},cancel:Qt=>{(0,kt.assert)(Qt instanceof Error,"cancel must have a valid reason");const Jt=(0,kt.createPromiseCapability)();return this.streamControllers[Wt].cancelCall=Jt,this.streamControllers[Wt].isClosed=!0,Xt.postMessage({sourceName:Yt,targetName:Kt,stream:Ft.CANCEL,streamId:Wt,reason:jt(Qt)}),Jt.promise}},Gt)}_createStreamSink(zt){const Ht=zt.streamId,Gt=this.sourceName,qt=zt.sourceName,Wt=this.comObj,Yt=this,Kt=this.actionHandler[zt.action],Xt={enqueue(Qt,Jt=1,Zt){if(this.isCancelled)return;const sn=this.desiredSize;this.desiredSize-=Jt,sn>0&&this.desiredSize<=0&&(this.sinkCapability=(0,kt.createPromiseCapability)(),this.ready=this.sinkCapability.promise),Wt.postMessage({sourceName:Gt,targetName:qt,stream:Ft.ENQUEUE,streamId:Ht,chunk:Qt},Zt)},close(){this.isCancelled||(this.isCancelled=!0,Wt.postMessage({sourceName:Gt,targetName:qt,stream:Ft.CLOSE,streamId:Ht}),delete Yt.streamSinks[Ht])},error(Qt){(0,kt.assert)(Qt instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,Wt.postMessage({sourceName:Gt,targetName:qt,stream:Ft.ERROR,streamId:Ht,reason:jt(Qt)}))},sinkCapability:(0,kt.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:zt.desiredSize,ready:null};Xt.sinkCapability.resolve(),Xt.ready=Xt.sinkCapability.promise,this.streamSinks[Ht]=Xt,new Promise(function(Qt){Qt(Kt(zt.data,Xt))}).then(function(){Wt.postMessage({sourceName:Gt,targetName:qt,stream:Ft.START_COMPLETE,streamId:Ht,success:!0})},function(Qt){Wt.postMessage({sourceName:Gt,targetName:qt,stream:Ft.START_COMPLETE,streamId:Ht,reason:jt(Qt)})})}_processStreamMessage(zt){const Ht=zt.streamId,Gt=this.sourceName,qt=zt.sourceName,Wt=this.comObj,Yt=this.streamControllers[Ht],Kt=this.streamSinks[Ht];switch(zt.stream){case Ft.START_COMPLETE:zt.success?Yt.startCall.resolve():Yt.startCall.reject(jt(zt.reason));break;case Ft.PULL_COMPLETE:zt.success?Yt.pullCall.resolve():Yt.pullCall.reject(jt(zt.reason));break;case Ft.PULL:if(!Kt){Wt.postMessage({sourceName:Gt,targetName:qt,stream:Ft.PULL_COMPLETE,streamId:Ht,success:!0});break}Kt.desiredSize<=0&&zt.desiredSize>0&&Kt.sinkCapability.resolve(),Kt.desiredSize=zt.desiredSize,new Promise(function(Xt){Xt(Kt.onPull&&Kt.onPull())}).then(function(){Wt.postMessage({sourceName:Gt,targetName:qt,stream:Ft.PULL_COMPLETE,streamId:Ht,success:!0})},function(Xt){Wt.postMessage({sourceName:Gt,targetName:qt,stream:Ft.PULL_COMPLETE,streamId:Ht,reason:jt(Xt)})});break;case Ft.ENQUEUE:if((0,kt.assert)(Yt,"enqueue should have stream controller"),Yt.isClosed)break;Yt.controller.enqueue(zt.chunk);break;case Ft.CLOSE:if((0,kt.assert)(Yt,"close should have stream controller"),Yt.isClosed)break;Yt.isClosed=!0,Yt.controller.close(),this._deleteStreamController(Yt,Ht);break;case Ft.ERROR:(0,kt.assert)(Yt,"error should have stream controller"),Yt.controller.error(jt(zt.reason)),this._deleteStreamController(Yt,Ht);break;case Ft.CANCEL_COMPLETE:zt.success?Yt.cancelCall.resolve():Yt.cancelCall.reject(jt(zt.reason)),this._deleteStreamController(Yt,Ht);break;case Ft.CANCEL:if(!Kt)break;new Promise(function(Xt){Xt(Kt.onCancel&&Kt.onCancel(jt(zt.reason)))}).then(function(){Wt.postMessage({sourceName:Gt,targetName:qt,stream:Ft.CANCEL_COMPLETE,streamId:Ht,success:!0})},function(Xt){Wt.postMessage({sourceName:Gt,targetName:qt,stream:Ft.CANCEL_COMPLETE,streamId:Ht,reason:jt(Xt)})}),Kt.sinkCapability.reject(jt(zt.reason)),Kt.isCancelled=!0,delete this.streamSinks[Ht];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(zt,Ht){await Promise.allSettled([zt.startCall&&zt.startCall.promise,zt.pullCall&&zt.pullCall.promise,zt.cancelCall&&zt.cancelCall.promise]),delete this.streamControllers[Ht]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}$t.MessageHandler=Bt},(xt,$t,Ct)=>{var Ft,jt;Object.defineProperty($t,"__esModule",{value:!0}),$t.Metadata=void 0;var kt=Ct(1);class Mt{constructor({parsedData:Vt,rawData:zt}){Yr(this,Ft,void 0);Yr(this,jt,void 0);gs(this,Ft,Vt),gs(this,jt,zt)}getRaw(){return Kn(this,jt)}get(Vt){return Kn(this,Ft).get(Vt)??null}getAll(){return(0,kt.objectFromMap)(Kn(this,Ft))}has(Vt){return Kn(this,Ft).has(Vt)}}Ft=new WeakMap,jt=new WeakMap,$t.Metadata=Mt},(xt,$t,Ct)=>{var Vt,zt,Ht,Gt,qt,Wt,Mu;Object.defineProperty($t,"__esModule",{value:!0}),$t.OptionalContentConfig=void 0;var kt=Ct(1),Mt=Ct(8);const Ft=Symbol("INTERNAL");class jt{constructor(Xt,Qt){Yr(this,Vt,!0);this.name=Xt,this.intent=Qt}get visible(){return Kn(this,Vt)}_setVisible(Xt,Qt){Xt!==Ft&&(0,kt.unreachable)("Internal method `_setVisible` called."),gs(this,Vt,Qt)}}Vt=new WeakMap;class Bt{constructor(Xt){Yr(this,Wt);Yr(this,zt,null);Yr(this,Ht,new Map);Yr(this,Gt,null);Yr(this,qt,null);if(this.name=null,this.creator=null,Xt!==null){this.name=Xt.name,this.creator=Xt.creator,gs(this,qt,Xt.order);for(const Qt of Xt.groups)Kn(this,Ht).set(Qt.id,new jt(Qt.name,Qt.intent));if(Xt.baseState==="OFF")for(const Qt of Kn(this,Ht).values())Qt._setVisible(Ft,!1);for(const Qt of Xt.on)Kn(this,Ht).get(Qt)._setVisible(Ft,!0);for(const Qt of Xt.off)Kn(this,Ht).get(Qt)._setVisible(Ft,!1);gs(this,Gt,this.getHash())}}isVisible(Xt){if(Kn(this,Ht).size===0)return!0;if(!Xt)return(0,kt.warn)("Optional content group not defined."),!0;if(Xt.type==="OCG")return Kn(this,Ht).has(Xt.id)?Kn(this,Ht).get(Xt.id).visible:((0,kt.warn)(`Optional content group not found: ${Xt.id}`),!0);if(Xt.type==="OCMD"){if(Xt.expression)return es(this,Wt,Mu).call(this,Xt.expression);if(!Xt.policy||Xt.policy==="AnyOn"){for(const Qt of Xt.ids){if(!Kn(this,Ht).has(Qt))return(0,kt.warn)(`Optional content group not found: ${Qt}`),!0;if(Kn(this,Ht).get(Qt).visible)return!0}return!1}else if(Xt.policy==="AllOn"){for(const Qt of Xt.ids){if(!Kn(this,Ht).has(Qt))return(0,kt.warn)(`Optional content group not found: ${Qt}`),!0;if(!Kn(this,Ht).get(Qt).visible)return!1}return!0}else if(Xt.policy==="AnyOff"){for(const Qt of Xt.ids){if(!Kn(this,Ht).has(Qt))return(0,kt.warn)(`Optional content group not found: ${Qt}`),!0;if(!Kn(this,Ht).get(Qt).visible)return!0}return!1}else if(Xt.policy==="AllOff"){for(const Qt of Xt.ids){if(!Kn(this,Ht).has(Qt))return(0,kt.warn)(`Optional content group not found: ${Qt}`),!0;if(Kn(this,Ht).get(Qt).visible)return!1}return!0}return(0,kt.warn)(`Unknown optional content policy ${Xt.policy}.`),!0}return(0,kt.warn)(`Unknown group type ${Xt.type}.`),!0}setVisibility(Xt,Qt=!0){if(!Kn(this,Ht).has(Xt)){(0,kt.warn)(`Optional content group not found: ${Xt}`);return}Kn(this,Ht).get(Xt)._setVisible(Ft,!!Qt),gs(this,zt,null)}get hasInitialVisibility(){return this.getHash()===Kn(this,Gt)}getOrder(){return Kn(this,Ht).size?Kn(this,qt)?Kn(this,qt).slice():[...Kn(this,Ht).keys()]:null}getGroups(){return Kn(this,Ht).size>0?(0,kt.objectFromMap)(Kn(this,Ht)):null}getGroup(Xt){return Kn(this,Ht).get(Xt)||null}getHash(){if(Kn(this,zt)!==null)return Kn(this,zt);const Xt=new Mt.MurmurHash3_64;for(const[Qt,Jt]of Kn(this,Ht))Xt.update(`${Qt}:${Jt.visible}`);return gs(this,zt,Xt.hexdigest())}}zt=new WeakMap,Ht=new WeakMap,Gt=new WeakMap,qt=new WeakMap,Wt=new WeakSet,Mu=function(Xt){const Qt=Xt.length;if(Qt<2)return!0;const Jt=Xt[0];for(let Zt=1;Zt<Qt;Zt++){const sn=Xt[Zt];let ln;if(Array.isArray(sn))ln=es(this,Wt,Mu).call(this,sn);else if(Kn(this,Ht).has(sn))ln=Kn(this,Ht).get(sn).visible;else return(0,kt.warn)(`Optional content group not found: ${sn}`),!0;switch(Jt){case"And":if(!ln)return!1;break;case"Or":if(ln)return!0;break;case"Not":return!ln;default:return!0}}return Jt==="And"},$t.OptionalContentConfig=Bt},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.PDFDataTransportStream=void 0;var kt=Ct(1),Mt=Ct(6);class Ft{constructor({length:zt,initialData:Ht,progressiveDone:Gt=!1,contentDispositionFilename:qt=null,disableRange:Wt=!1,disableStream:Yt=!1},Kt){if((0,kt.assert)(Kt,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=Gt,this._contentDispositionFilename=qt,(Ht==null?void 0:Ht.length)>0){const Xt=Ht instanceof Uint8Array&&Ht.byteLength===Ht.buffer.byteLength?Ht.buffer:new Uint8Array(Ht).buffer;this._queuedChunks.push(Xt)}this._pdfDataRangeTransport=Kt,this._isStreamingSupported=!Yt,this._isRangeSupported=!Wt,this._contentLength=zt,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((Xt,Qt)=>{this._onReceiveData({begin:Xt,chunk:Qt})}),this._pdfDataRangeTransport.addProgressListener((Xt,Qt)=>{this._onProgress({loaded:Xt,total:Qt})}),this._pdfDataRangeTransport.addProgressiveReadListener(Xt=>{this._onReceiveData({chunk:Xt})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:zt,chunk:Ht}){const Gt=Ht instanceof Uint8Array&&Ht.byteLength===Ht.buffer.byteLength?Ht.buffer:new Uint8Array(Ht).buffer;if(zt===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(Gt):this._queuedChunks.push(Gt);else{const qt=this._rangeReaders.some(function(Wt){return Wt._begin!==zt?!1:(Wt._enqueue(Gt),!0)});(0,kt.assert)(qt,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var zt;return((zt=this._fullRequestReader)==null?void 0:zt._loaded)??0}_onProgress(zt){var Ht,Gt,qt,Wt;zt.total===void 0?(Gt=(Ht=this._rangeReaders[0])==null?void 0:Ht.onProgress)==null||Gt.call(Ht,{loaded:zt.loaded}):(Wt=(qt=this._fullRequestReader)==null?void 0:qt.onProgress)==null||Wt.call(qt,{loaded:zt.loaded,total:zt.total})}_onProgressiveDone(){var zt;(zt=this._fullRequestReader)==null||zt.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(zt){const Ht=this._rangeReaders.indexOf(zt);Ht>=0&&this._rangeReaders.splice(Ht,1)}getFullReader(){(0,kt.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const zt=this._queuedChunks;return this._queuedChunks=null,new jt(this,zt,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(zt,Ht){if(Ht<=this._progressiveDataLength)return null;const Gt=new Bt(this,zt,Ht);return this._pdfDataRangeTransport.requestDataRange(zt,Ht),this._rangeReaders.push(Gt),Gt}cancelAllRequests(zt){var Ht;(Ht=this._fullRequestReader)==null||Ht.cancel(zt);for(const Gt of this._rangeReaders.slice(0))Gt.cancel(zt);this._pdfDataRangeTransport.abort()}}$t.PDFDataTransportStream=Ft;class jt{constructor(zt,Ht,Gt=!1,qt=null){this._stream=zt,this._done=Gt||!1,this._filename=(0,Mt.isPdfFile)(qt)?qt:null,this._queuedChunks=Ht||[],this._loaded=0;for(const Wt of this._queuedChunks)this._loaded+=Wt.byteLength;this._requests=[],this._headersReady=Promise.resolve(),zt._fullRequestReader=this,this.onProgress=null}_enqueue(zt){this._done||(this._requests.length>0?this._requests.shift().resolve({value:zt,done:!1}):this._queuedChunks.push(zt),this._loaded+=zt.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const zt=(0,kt.createPromiseCapability)();return this._requests.push(zt),zt.promise}cancel(zt){this._done=!0;for(const Ht of this._requests)Ht.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Bt{constructor(zt,Ht,Gt){this._stream=zt,this._begin=Ht,this._end=Gt,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(zt){if(!this._done){if(this._requests.length===0)this._queuedChunk=zt;else{this._requests.shift().resolve({value:zt,done:!1});for(const Gt of this._requests)Gt.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const Ht=this._queuedChunk;return this._queuedChunk=null,{value:Ht,done:!1}}if(this._done)return{value:void 0,done:!0};const zt=(0,kt.createPromiseCapability)();return this._requests.push(zt),zt.promise}cancel(zt){this._done=!0;for(const Ht of this._requests)Ht.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(xt,$t)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.XfaText=void 0;class Ct{static textContent(Mt){const Ft=[],jt={items:Ft,styles:Object.create(null)};function Bt(Vt){var Gt;if(!Vt)return;let zt=null;const Ht=Vt.name;if(Ht==="#text")zt=Vt.value;else if(Ct.shouldBuildText(Ht))(Gt=Vt==null?void 0:Vt.attributes)!=null&&Gt.textContent?zt=Vt.attributes.textContent:Vt.value&&(zt=Vt.value);else return;if(zt!==null&&Ft.push({str:zt}),!!Vt.children)for(const qt of Vt.children)Bt(qt)}return Bt(Mt),jt}static shouldBuildText(Mt){return!(Mt==="textarea"||Mt==="input"||Mt==="option"||Mt==="select")}}$t.XfaText=Ct},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.NodeStandardFontDataFactory=$t.NodeCanvasFactory=$t.NodeCMapReaderFactory=void 0;var kt=Ct(7);const Mt=function(Vt){return new Promise((zt,Ht)=>{require$$0.readFile(Vt,(qt,Wt)=>{if(qt||!Wt){Ht(new Error(qt));return}zt(new Uint8Array(Wt))})})};class Ft extends kt.BaseCanvasFactory{_createCanvas(zt,Ht){return require$$0.createCanvas(zt,Ht)}}$t.NodeCanvasFactory=Ft;class jt extends kt.BaseCMapReaderFactory{_fetchData(zt,Ht){return Mt(zt).then(Gt=>({cMapData:Gt,compressionType:Ht}))}}$t.NodeCMapReaderFactory=jt;class Bt extends kt.BaseStandardFontDataFactory{_fetchData(zt){return Mt(zt)}}$t.NodeStandardFontDataFactory=Bt},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.PDFNodeStream=void 0;var kt=Ct(1),Mt=Ct(22);const Ft=require$$0,jt=require$$0,Bt=require$$0,Vt=require$$0,zt=/^file:\/\/\/[a-zA-Z]:\//;function Ht(Zt){const sn=Vt.parse(Zt);return sn.protocol==="file:"||sn.host?sn:/^[a-z]:[/\\]/i.test(Zt)?Vt.parse(`file:///${Zt}`):(sn.host||(sn.protocol="file:"),sn)}class Gt{constructor(sn){this.source=sn,this.url=Ht(sn.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&sn.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var sn;return((sn=this._fullRequestReader)==null?void 0:sn._loaded)??0}getFullReader(){return(0,kt.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new Qt(this):new Kt(this),this._fullRequestReader}getRangeReader(sn,ln){if(ln<=this._progressiveDataLength)return null;const dn=this.isFsUrl?new Jt(this,sn,ln):new Xt(this,sn,ln);return this._rangeRequestReaders.push(dn),dn}cancelAllRequests(sn){var ln;(ln=this._fullRequestReader)==null||ln.cancel(sn);for(const dn of this._rangeRequestReaders.slice(0))dn.cancel(sn)}}$t.PDFNodeStream=Gt;class qt{constructor(sn){this._url=sn.url,this._done=!1,this._storedError=null,this.onProgress=null;const ln=sn.source;this._contentLength=ln.length,this._loaded=0,this._filename=null,this._disableRange=ln.disableRange||!1,this._rangeChunkSize=ln.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!ln.disableStream,this._isRangeSupported=!ln.disableRange,this._readableStream=null,this._readCapability=(0,kt.createPromiseCapability)(),this._headersCapability=(0,kt.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var dn;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const sn=this._readableStream.read();return sn===null?(this._readCapability=(0,kt.createPromiseCapability)(),this.read()):(this._loaded+=sn.length,(dn=this.onProgress)==null||dn.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(sn).buffer,done:!1})}cancel(sn){if(!this._readableStream){this._error(sn);return}this._readableStream.destroy(sn)}_error(sn){this._storedError=sn,this._readCapability.resolve()}_setReadableStream(sn){this._readableStream=sn,sn.on("readable",()=>{this._readCapability.resolve()}),sn.on("end",()=>{sn.destroy(),this._done=!0,this._readCapability.resolve()}),sn.on("error",ln=>{this._error(ln)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new kt.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Wt{constructor(sn){this._url=sn.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,kt.createPromiseCapability)();const ln=sn.source;this._isStreamingSupported=!ln.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var dn;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const sn=this._readableStream.read();return sn===null?(this._readCapability=(0,kt.createPromiseCapability)(),this.read()):(this._loaded+=sn.length,(dn=this.onProgress)==null||dn.call(this,{loaded:this._loaded}),{value:new Uint8Array(sn).buffer,done:!1})}cancel(sn){if(!this._readableStream){this._error(sn);return}this._readableStream.destroy(sn)}_error(sn){this._storedError=sn,this._readCapability.resolve()}_setReadableStream(sn){this._readableStream=sn,sn.on("readable",()=>{this._readCapability.resolve()}),sn.on("end",()=>{sn.destroy(),this._done=!0,this._readCapability.resolve()}),sn.on("error",ln=>{this._error(ln)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function Yt(Zt,sn){return{protocol:Zt.protocol,auth:Zt.auth,host:Zt.hostname,port:Zt.port,path:Zt.path,method:"GET",headers:sn}}class Kt extends qt{constructor(sn){super(sn);const ln=dn=>{if(dn.statusCode===404){const yn=new kt.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=yn,this._headersCapability.reject(yn);return}this._headersCapability.resolve(),this._setReadableStream(dn);const hn=yn=>this._readableStream.headers[yn.toLowerCase()],{allowRangeRequests:cn,suggestedLength:pn}=(0,Mt.validateRangeRequestCapabilities)({getResponseHeader:hn,isHttp:sn.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=cn,this._contentLength=pn||this._contentLength,this._filename=(0,Mt.extractFilenameFromHeader)(hn)};this._request=null,this._url.protocol==="http:"?this._request=jt.request(Yt(this._url,sn.httpHeaders),ln):this._request=Bt.request(Yt(this._url,sn.httpHeaders),ln),this._request.on("error",dn=>{this._storedError=dn,this._headersCapability.reject(dn)}),this._request.end()}}class Xt extends Wt{constructor(sn,ln,dn){super(sn),this._httpHeaders={};for(const cn in sn.httpHeaders){const pn=sn.httpHeaders[cn];pn!==void 0&&(this._httpHeaders[cn]=pn)}this._httpHeaders.Range=`bytes=${ln}-${dn-1}`;const hn=cn=>{if(cn.statusCode===404){const pn=new kt.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=pn;return}this._setReadableStream(cn)};this._request=null,this._url.protocol==="http:"?this._request=jt.request(Yt(this._url,this._httpHeaders),hn):this._request=Bt.request(Yt(this._url,this._httpHeaders),hn),this._request.on("error",cn=>{this._storedError=cn}),this._request.end()}}class Qt extends qt{constructor(sn){super(sn);let ln=decodeURIComponent(this._url.path);zt.test(this._url.href)&&(ln=ln.replace(/^\//,"")),Ft.lstat(ln,(dn,hn)=>{if(dn){dn.code==="ENOENT"&&(dn=new kt.MissingPDFException(`Missing PDF "${ln}".`)),this._storedError=dn,this._headersCapability.reject(dn);return}this._contentLength=hn.size,this._setReadableStream(Ft.createReadStream(ln)),this._headersCapability.resolve()})}}class Jt extends Wt{constructor(sn,ln,dn){super(sn);let hn=decodeURIComponent(this._url.path);zt.test(this._url.href)&&(hn=hn.replace(/^\//,"")),this._setReadableStream(Ft.createReadStream(hn,{start:ln,end:dn-1}))}}},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.createResponseStatusError=Vt,$t.extractFilenameFromHeader=Bt,$t.validateRangeRequestCapabilities=jt,$t.validateResponseStatus=zt;var kt=Ct(1),Mt=Ct(23),Ft=Ct(6);function jt({getResponseHeader:Ht,isHttp:Gt,rangeChunkSize:qt,disableRange:Wt}){const Yt={allowRangeRequests:!1,suggestedLength:void 0},Kt=parseInt(Ht("Content-Length"),10);return!Number.isInteger(Kt)||(Yt.suggestedLength=Kt,Kt<=2*qt)||Wt||!Gt||Ht("Accept-Ranges")!=="bytes"||(Ht("Content-Encoding")||"identity")!=="identity"||(Yt.allowRangeRequests=!0),Yt}function Bt(Ht){const Gt=Ht("Content-Disposition");if(Gt){let qt=(0,Mt.getFilenameFromContentDispositionHeader)(Gt);if(qt.includes("%"))try{qt=decodeURIComponent(qt)}catch{}if((0,Ft.isPdfFile)(qt))return qt}return null}function Vt(Ht,Gt){return Ht===404||Ht===0&&Gt.startsWith("file:")?new kt.MissingPDFException('Missing PDF "'+Gt+'".'):new kt.UnexpectedResponseException(`Unexpected server response (${Ht}) while retrieving PDF "${Gt}".`,Ht)}function zt(Ht){return Ht===200||Ht===206}},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.getFilenameFromContentDispositionHeader=Mt;var kt=Ct(1);function Mt(Ft){let jt=!0,Bt=Vt("filename\\*","i").exec(Ft);if(Bt){Bt=Bt[1];let Kt=qt(Bt);return Kt=unescape(Kt),Kt=Wt(Kt),Kt=Yt(Kt),Ht(Kt)}if(Bt=Gt(Ft),Bt){const Kt=Yt(Bt);return Ht(Kt)}if(Bt=Vt("filename","i").exec(Ft),Bt){Bt=Bt[1];let Kt=qt(Bt);return Kt=Yt(Kt),Ht(Kt)}function Vt(Kt,Xt){return new RegExp("(?:^|;)\\s*"+Kt+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',Xt)}function zt(Kt,Xt){if(Kt){if(!/^[\x00-\xFF]+$/.test(Xt))return Xt;try{const Qt=new TextDecoder(Kt,{fatal:!0}),Jt=(0,kt.stringToBytes)(Xt);Xt=Qt.decode(Jt),jt=!1}catch{}}return Xt}function Ht(Kt){return jt&&/[\x80-\xff]/.test(Kt)&&(Kt=zt("utf-8",Kt),jt&&(Kt=zt("iso-8859-1",Kt))),Kt}function Gt(Kt){const Xt=[];let Qt;const Jt=Vt("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(Qt=Jt.exec(Kt))!==null;){let[,sn,ln,dn]=Qt;if(sn=parseInt(sn,10),sn in Xt){if(sn===0)break;continue}Xt[sn]=[ln,dn]}const Zt=[];for(let sn=0;sn<Xt.length&&sn in Xt;++sn){let[ln,dn]=Xt[sn];dn=qt(dn),ln&&(dn=unescape(dn),sn===0&&(dn=Wt(dn))),Zt.push(dn)}return Zt.join("")}function qt(Kt){if(Kt.startsWith('"')){const Xt=Kt.slice(1).split('\\"');for(let Qt=0;Qt<Xt.length;++Qt){const Jt=Xt[Qt].indexOf('"');Jt!==-1&&(Xt[Qt]=Xt[Qt].slice(0,Jt),Xt.length=Qt+1),Xt[Qt]=Xt[Qt].replace(/\\(.)/g,"$1")}Kt=Xt.join('"')}return Kt}function Wt(Kt){const Xt=Kt.indexOf("'");if(Xt===-1)return Kt;const Qt=Kt.slice(0,Xt),Zt=Kt.slice(Xt+1).replace(/^[^']*'/,"");return zt(Qt,Zt)}function Yt(Kt){return!Kt.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(Kt)?Kt:Kt.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(Xt,Qt,Jt,Zt){if(Jt==="q"||Jt==="Q")return Zt=Zt.replace(/_/g," "),Zt=Zt.replace(/=([0-9a-fA-F]{2})/g,function(sn,ln){return String.fromCharCode(parseInt(ln,16))}),zt(Qt,Zt);try{Zt=atob(Zt)}catch{}return zt(Qt,Zt)})}return""}},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.PDFNetworkStream=void 0;var kt=Ct(1),Mt=Ct(22);const Ft=200,jt=206;function Bt(qt){const Wt=qt.response;return typeof Wt!="string"?Wt:(0,kt.stringToBytes)(Wt).buffer}class Vt{constructor(Wt,Yt={}){this.url=Wt,this.isHttp=/^https?:/i.test(Wt),this.httpHeaders=this.isHttp&&Yt.httpHeaders||Object.create(null),this.withCredentials=Yt.withCredentials||!1,this.getXhr=Yt.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(Wt,Yt,Kt){const Xt={begin:Wt,end:Yt};for(const Qt in Kt)Xt[Qt]=Kt[Qt];return this.request(Xt)}requestFull(Wt){return this.request(Wt)}request(Wt){const Yt=this.getXhr(),Kt=this.currXhrId++,Xt=this.pendingRequests[Kt]={xhr:Yt};Yt.open("GET",this.url),Yt.withCredentials=this.withCredentials;for(const Qt in this.httpHeaders){const Jt=this.httpHeaders[Qt];Jt!==void 0&&Yt.setRequestHeader(Qt,Jt)}return this.isHttp&&"begin"in Wt&&"end"in Wt?(Yt.setRequestHeader("Range",`bytes=${Wt.begin}-${Wt.end-1}`),Xt.expectedStatus=jt):Xt.expectedStatus=Ft,Yt.responseType="arraybuffer",Wt.onError&&(Yt.onerror=function(Qt){Wt.onError(Yt.status)}),Yt.onreadystatechange=this.onStateChange.bind(this,Kt),Yt.onprogress=this.onProgress.bind(this,Kt),Xt.onHeadersReceived=Wt.onHeadersReceived,Xt.onDone=Wt.onDone,Xt.onError=Wt.onError,Xt.onProgress=Wt.onProgress,Yt.send(null),Kt}onProgress(Wt,Yt){var Xt;const Kt=this.pendingRequests[Wt];Kt&&((Xt=Kt.onProgress)==null||Xt.call(Kt,Yt))}onStateChange(Wt,Yt){var sn,ln,dn;const Kt=this.pendingRequests[Wt];if(!Kt)return;const Xt=Kt.xhr;if(Xt.readyState>=2&&Kt.onHeadersReceived&&(Kt.onHeadersReceived(),delete Kt.onHeadersReceived),Xt.readyState!==4||!(Wt in this.pendingRequests))return;if(delete this.pendingRequests[Wt],Xt.status===0&&this.isHttp){(sn=Kt.onError)==null||sn.call(Kt,Xt.status);return}const Qt=Xt.status||Ft;if(!(Qt===Ft&&Kt.expectedStatus===jt)&&Qt!==Kt.expectedStatus){(ln=Kt.onError)==null||ln.call(Kt,Xt.status);return}const Zt=Bt(Xt);if(Qt===jt){const hn=Xt.getResponseHeader("Content-Range"),cn=/bytes (\d+)-(\d+)\/(\d+)/.exec(hn);Kt.onDone({begin:parseInt(cn[1],10),chunk:Zt})}else Zt?Kt.onDone({begin:0,chunk:Zt}):(dn=Kt.onError)==null||dn.call(Kt,Xt.status)}getRequestXhr(Wt){return this.pendingRequests[Wt].xhr}isPendingRequest(Wt){return Wt in this.pendingRequests}abortRequest(Wt){const Yt=this.pendingRequests[Wt].xhr;delete this.pendingRequests[Wt],Yt.abort()}}class zt{constructor(Wt){this._source=Wt,this._manager=new Vt(Wt.url,{httpHeaders:Wt.httpHeaders,withCredentials:Wt.withCredentials}),this._rangeChunkSize=Wt.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(Wt){const Yt=this._rangeRequestReaders.indexOf(Wt);Yt>=0&&this._rangeRequestReaders.splice(Yt,1)}getFullReader(){return(0,kt.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Ht(this._manager,this._source),this._fullRequestReader}getRangeReader(Wt,Yt){const Kt=new Gt(this._manager,Wt,Yt);return Kt.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(Kt),Kt}cancelAllRequests(Wt){var Yt;(Yt=this._fullRequestReader)==null||Yt.cancel(Wt);for(const Kt of this._rangeRequestReaders.slice(0))Kt.cancel(Wt)}}$t.PDFNetworkStream=zt;class Ht{constructor(Wt,Yt){this._manager=Wt;const Kt={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=Yt.url,this._fullRequestId=Wt.requestFull(Kt),this._headersReceivedCapability=(0,kt.createPromiseCapability)(),this._disableRange=Yt.disableRange||!1,this._contentLength=Yt.length,this._rangeChunkSize=Yt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const Wt=this._fullRequestId,Yt=this._manager.getRequestXhr(Wt),Kt=Jt=>Yt.getResponseHeader(Jt),{allowRangeRequests:Xt,suggestedLength:Qt}=(0,Mt.validateRangeRequestCapabilities)({getResponseHeader:Kt,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});Xt&&(this._isRangeSupported=!0),this._contentLength=Qt||this._contentLength,this._filename=(0,Mt.extractFilenameFromHeader)(Kt),this._isRangeSupported&&this._manager.abortRequest(Wt),this._headersReceivedCapability.resolve()}_onDone(Wt){if(Wt&&(this._requests.length>0?this._requests.shift().resolve({value:Wt.chunk,done:!1}):this._cachedChunks.push(Wt.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const Yt of this._requests)Yt.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(Wt){this._storedError=(0,Mt.createResponseStatusError)(Wt,this._url),this._headersReceivedCapability.reject(this._storedError);for(const Yt of this._requests)Yt.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(Wt){var Yt;(Yt=this.onProgress)==null||Yt.call(this,{loaded:Wt.loaded,total:Wt.lengthComputable?Wt.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const Wt=(0,kt.createPromiseCapability)();return this._requests.push(Wt),Wt.promise}cancel(Wt){this._done=!0,this._headersReceivedCapability.reject(Wt);for(const Yt of this._requests)Yt.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Gt{constructor(Wt,Yt,Kt){this._manager=Wt;const Xt={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=Wt.url,this._requestId=Wt.requestRange(Yt,Kt,Xt),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var Wt;(Wt=this.onClosed)==null||Wt.call(this,this)}_onDone(Wt){const Yt=Wt.chunk;this._requests.length>0?this._requests.shift().resolve({value:Yt,done:!1}):this._queuedChunk=Yt,this._done=!0;for(const Kt of this._requests)Kt.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(Wt){this._storedError=(0,Mt.createResponseStatusError)(Wt,this._url);for(const Yt of this._requests)Yt.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(Wt){var Yt;this.isStreamingSupported||(Yt=this.onProgress)==null||Yt.call(this,{loaded:Wt.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const Yt=this._queuedChunk;return this._queuedChunk=null,{value:Yt,done:!1}}if(this._done)return{value:void 0,done:!0};const Wt=(0,kt.createPromiseCapability)();return this._requests.push(Wt),Wt.promise}cancel(Wt){this._done=!0;for(const Yt of this._requests)Yt.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.PDFFetchStream=void 0;var kt=Ct(1),Mt=Ct(22);function Ft(Gt,qt,Wt){return{method:"GET",headers:Gt,signal:Wt.signal,mode:"cors",credentials:qt?"include":"same-origin",redirect:"follow"}}function jt(Gt){const qt=new Headers;for(const Wt in Gt){const Yt=Gt[Wt];Yt!==void 0&&qt.append(Wt,Yt)}return qt}function Bt(Gt){return Gt instanceof Uint8Array?Gt.buffer:Gt instanceof ArrayBuffer?Gt:((0,kt.warn)(`getArrayBuffer - unexpected data format: ${Gt}`),new Uint8Array(Gt).buffer)}class Vt{constructor(qt){this.source=qt,this.isHttp=/^https?:/i.test(qt.url),this.httpHeaders=this.isHttp&&qt.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var qt;return((qt=this._fullRequestReader)==null?void 0:qt._loaded)??0}getFullReader(){return(0,kt.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new zt(this),this._fullRequestReader}getRangeReader(qt,Wt){if(Wt<=this._progressiveDataLength)return null;const Yt=new Ht(this,qt,Wt);return this._rangeRequestReaders.push(Yt),Yt}cancelAllRequests(qt){var Wt;(Wt=this._fullRequestReader)==null||Wt.cancel(qt);for(const Yt of this._rangeRequestReaders.slice(0))Yt.cancel(qt)}}$t.PDFFetchStream=Vt;class zt{constructor(qt){this._stream=qt,this._reader=null,this._loaded=0,this._filename=null;const Wt=qt.source;this._withCredentials=Wt.withCredentials||!1,this._contentLength=Wt.length,this._headersCapability=(0,kt.createPromiseCapability)(),this._disableRange=Wt.disableRange||!1,this._rangeChunkSize=Wt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!Wt.disableStream,this._isRangeSupported=!Wt.disableRange,this._headers=jt(this._stream.httpHeaders);const Yt=Wt.url;fetch(Yt,Ft(this._headers,this._withCredentials,this._abortController)).then(Kt=>{if(!(0,Mt.validateResponseStatus)(Kt.status))throw(0,Mt.createResponseStatusError)(Kt.status,Yt);this._reader=Kt.body.getReader(),this._headersCapability.resolve();const Xt=Zt=>Kt.headers.get(Zt),{allowRangeRequests:Qt,suggestedLength:Jt}=(0,Mt.validateRangeRequestCapabilities)({getResponseHeader:Xt,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Qt,this._contentLength=Jt||this._contentLength,this._filename=(0,Mt.extractFilenameFromHeader)(Xt),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new kt.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Yt;await this._headersCapability.promise;const{value:qt,done:Wt}=await this._reader.read();return Wt?{value:qt,done:Wt}:(this._loaded+=qt.byteLength,(Yt=this.onProgress)==null||Yt.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Bt(qt),done:!1})}cancel(qt){var Wt;(Wt=this._reader)==null||Wt.cancel(qt),this._abortController.abort()}}class Ht{constructor(qt,Wt,Yt){this._stream=qt,this._reader=null,this._loaded=0;const Kt=qt.source;this._withCredentials=Kt.withCredentials||!1,this._readCapability=(0,kt.createPromiseCapability)(),this._isStreamingSupported=!Kt.disableStream,this._abortController=new AbortController,this._headers=jt(this._stream.httpHeaders),this._headers.append("Range",`bytes=${Wt}-${Yt-1}`);const Xt=Kt.url;fetch(Xt,Ft(this._headers,this._withCredentials,this._abortController)).then(Qt=>{if(!(0,Mt.validateResponseStatus)(Qt.status))throw(0,Mt.createResponseStatusError)(Qt.status,Xt);this._readCapability.resolve(),this._reader=Qt.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Yt;await this._readCapability.promise;const{value:qt,done:Wt}=await this._reader.read();return Wt?{value:qt,done:Wt}:(this._loaded+=qt.byteLength,(Yt=this.onProgress)==null||Yt.call(this,{loaded:this._loaded}),{value:Bt(qt),done:!1})}cancel(qt){var Wt;(Wt=this._reader)==null||Wt.cancel(qt),this._abortController.abort()}}},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.TextLayerRenderTask=void 0,$t.renderTextLayer=Kt,$t.updateTextLayer=Xt;var kt=Ct(1),Mt=Ct(6);const Ft=1e5,jt=30,Bt=.8,Vt=new Map;function zt(Qt,Jt){let Zt;if(Jt&&kt.FeatureTest.isOffscreenCanvasSupported)Zt=new OffscreenCanvas(Qt,Qt).getContext("2d",{alpha:!1});else{const sn=document.createElement("canvas");sn.width=sn.height=Qt,Zt=sn.getContext("2d",{alpha:!1})}return Zt}function Ht(Qt,Jt){const Zt=Vt.get(Qt);if(Zt)return Zt;const sn=zt(jt,Jt);sn.font=`${jt}px ${Qt}`;const ln=sn.measureText("");let dn=ln.fontBoundingBoxAscent,hn=Math.abs(ln.fontBoundingBoxDescent);if(dn){const pn=dn/(dn+hn);return Vt.set(Qt,pn),sn.canvas.width=sn.canvas.height=0,pn}sn.strokeStyle="red",sn.clearRect(0,0,jt,jt),sn.strokeText("g",0,0);let cn=sn.getImageData(0,0,jt,jt).data;hn=0;for(let pn=cn.length-1-3;pn>=0;pn-=4)if(cn[pn]>0){hn=Math.ceil(pn/4/jt);break}sn.clearRect(0,0,jt,jt),sn.strokeText("A",0,jt),cn=sn.getImageData(0,0,jt,jt).data,dn=0;for(let pn=0,yn=cn.length;pn<yn;pn+=4)if(cn[pn]>0){dn=jt-Math.floor(pn/4/jt);break}if(sn.canvas.width=sn.canvas.height=0,dn){const pn=dn/(dn+hn);return Vt.set(Qt,pn),pn}return Vt.set(Qt,Bt),Bt}function Gt(Qt,Jt,Zt){const sn=document.createElement("span"),ln={angle:0,canvasWidth:0,hasText:Jt.str!=="",hasEOL:Jt.hasEOL,fontSize:0};Qt._textDivs.push(sn);const dn=kt.Util.transform(Qt._transform,Jt.transform);let hn=Math.atan2(dn[1],dn[0]);const cn=Zt[Jt.fontName];cn.vertical&&(hn+=Math.PI/2);const pn=Math.hypot(dn[2],dn[3]),yn=pn*Ht(cn.fontFamily,Qt._isOffscreenCanvasSupported);let gn,En;hn===0?(gn=dn[4],En=dn[5]-yn):(gn=dn[4]+yn*Math.sin(hn),En=dn[5]-yn*Math.cos(hn));const bn="calc(var(--scale-factor)*",xn=sn.style;Qt._container===Qt._rootContainer?(xn.left=`${(100*gn/Qt._pageWidth).toFixed(2)}%`,xn.top=`${(100*En/Qt._pageHeight).toFixed(2)}%`):(xn.left=`${bn}${gn.toFixed(2)}px)`,xn.top=`${bn}${En.toFixed(2)}px)`),xn.fontSize=`${bn}${pn.toFixed(2)}px)`,xn.fontFamily=cn.fontFamily,ln.fontSize=pn,sn.setAttribute("role","presentation"),sn.textContent=Jt.str,sn.dir=Jt.dir,Qt._fontInspectorEnabled&&(sn.dataset.fontName=Jt.fontName),hn!==0&&(ln.angle=hn*(180/Math.PI));let Cn=!1;if(Jt.str.length>1)Cn=!0;else if(Jt.str!==" "&&Jt.transform[0]!==Jt.transform[3]){const $n=Math.abs(Jt.transform[0]),wn=Math.abs(Jt.transform[3]);$n!==wn&&Math.max($n,wn)/Math.min($n,wn)>1.5&&(Cn=!0)}Cn&&(ln.canvasWidth=cn.vertical?Jt.height:Jt.width),Qt._textDivProperties.set(sn,ln),Qt._isReadableStream&&Qt._layoutText(sn)}function qt(Qt){const{div:Jt,scale:Zt,properties:sn,ctx:ln,prevFontSize:dn,prevFontFamily:hn}=Qt,{style:cn}=Jt;let pn="";if(sn.canvasWidth!==0&&sn.hasText){const{fontFamily:yn}=cn,{canvasWidth:gn,fontSize:En}=sn;(dn!==En||hn!==yn)&&(ln.font=`${En*Zt}px ${yn}`,Qt.prevFontSize=En,Qt.prevFontFamily=yn);const{width:bn}=ln.measureText(Jt.textContent);bn>0&&(pn=`scaleX(${gn*Zt/bn})`)}sn.angle!==0&&(pn=`rotate(${sn.angle}deg) ${pn}`),pn.length>0&&(cn.transform=pn)}function Wt(Qt){if(Qt._canceled)return;const Jt=Qt._textDivs,Zt=Qt._capability;if(Jt.length>Ft){Zt.resolve();return}if(!Qt._isReadableStream)for(const ln of Jt)Qt._layoutText(ln);Zt.resolve()}class Yt{constructor({textContentSource:Jt,container:Zt,viewport:sn,textDivs:ln,textDivProperties:dn,textContentItemsStr:hn,isOffscreenCanvasSupported:cn}){var bn;this._textContentSource=Jt,this._isReadableStream=Jt instanceof ReadableStream,this._container=this._rootContainer=Zt,this._textDivs=ln||[],this._textContentItemsStr=hn||[],this._isOffscreenCanvasSupported=cn,this._fontInspectorEnabled=!!((bn=globalThis.FontInspector)!=null&&bn.enabled),this._reader=null,this._textDivProperties=dn||new WeakMap,this._canceled=!1,this._capability=(0,kt.createPromiseCapability)(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:sn.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:zt(0,cn)};const{pageWidth:pn,pageHeight:yn,pageX:gn,pageY:En}=sn.rawDims;this._transform=[1,0,0,-1,-gn,En+yn],this._pageWidth=pn,this._pageHeight=yn,(0,Mt.setLayerDimensions)(Zt,sn),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new kt.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new kt.AbortException("TextLayer task cancelled."))}_processItems(Jt,Zt){for(const sn of Jt){if(sn.str===void 0){if(sn.type==="beginMarkedContentProps"||sn.type==="beginMarkedContent"){const ln=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),sn.id!==null&&this._container.setAttribute("id",`${sn.id}`),ln.append(this._container)}else sn.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(sn.str),Gt(this,sn,Zt)}}_layoutText(Jt){const Zt=this._layoutTextParams.properties=this._textDivProperties.get(Jt);if(this._layoutTextParams.div=Jt,qt(this._layoutTextParams),Zt.hasText&&this._container.append(Jt),Zt.hasEOL){const sn=document.createElement("br");sn.setAttribute("role","presentation"),this._container.append(sn)}}_render(){const Jt=(0,kt.createPromiseCapability)();let Zt=Object.create(null);if(this._isReadableStream){const sn=()=>{this._reader.read().then(({value:ln,done:dn})=>{if(dn){Jt.resolve();return}Object.assign(Zt,ln.styles),this._processItems(ln.items,Zt),sn()},Jt.reject)};this._reader=this._textContentSource.getReader(),sn()}else if(this._textContentSource){const{items:sn,styles:ln}=this._textContentSource;this._processItems(sn,ln),Jt.resolve()}else throw new Error('No "textContentSource" parameter specified.');Jt.promise.then(()=>{Zt=null,Wt(this)},this._capability.reject)}}$t.TextLayerRenderTask=Yt;function Kt(Qt){!Qt.textContentSource&&(Qt.textContent||Qt.textContentStream)&&((0,Mt.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),Qt.textContentSource=Qt.textContent||Qt.textContentStream);const Jt=new Yt(Qt);return Jt._render(),Jt}function Xt({container:Qt,viewport:Jt,textDivs:Zt,textDivProperties:sn,isOffscreenCanvasSupported:ln,mustRotate:dn=!0,mustRescale:hn=!0}){if(dn&&(0,Mt.setLayerDimensions)(Qt,{rotation:Jt.rotation}),hn){const cn=zt(0,ln),yn={prevFontSize:null,prevFontFamily:null,div:null,scale:Jt.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:cn};for(const gn of Zt)yn.properties=sn.get(gn),yn.div=gn,qt(yn)}}},(xt,$t,Ct)=>{var zt,Ht,Gt,qt,Wt,Yt,Kt,Xt,Qt,Lu,Zt,yp,ln,Fu,hn,ju;Object.defineProperty($t,"__esModule",{value:!0}),$t.AnnotationEditorLayer=void 0;var kt=Ct(1),Mt=Ct(5),Ft=Ct(28),jt=Ct(29),Bt=Ct(6);const pn=class pn{constructor(gn){Yr(this,Qt);Yr(this,Zt);Yr(this,ln);Yr(this,hn);Yr(this,zt,void 0);Yr(this,Ht,!1);Yr(this,Gt,this.pointerup.bind(this));Yr(this,qt,this.pointerdown.bind(this));Yr(this,Wt,new Map);Yr(this,Yt,!1);Yr(this,Kt,!1);Yr(this,Xt,void 0);pn._initialized||(pn._initialized=!0,Ft.FreeTextEditor.initialize(gn.l10n),jt.InkEditor.initialize(gn.l10n)),gn.uiManager.registerEditorTypes([Ft.FreeTextEditor,jt.InkEditor]),gs(this,Xt,gn.uiManager),this.pageIndex=gn.pageIndex,this.div=gn.div,gs(this,zt,gn.accessibilityManager),Kn(this,Xt).addLayer(this)}get isEmpty(){return Kn(this,Wt).size===0}updateToolbar(gn){Kn(this,Xt).updateToolbar(gn)}updateMode(gn=Kn(this,Xt).getMode()){es(this,hn,ju).call(this),gn===kt.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),Kn(this,Xt).unselectAll(),gn!==kt.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",gn===kt.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",gn===kt.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(gn){if(!gn&&Kn(this,Xt).getMode()!==kt.AnnotationEditorType.INK)return;if(!gn){for(const bn of Kn(this,Wt).values())if(bn.isEmpty()){bn.setInBackground();return}}es(this,ln,Fu).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(gn){Kn(this,Xt).setEditingState(gn)}addCommands(gn){Kn(this,Xt).addCommands(gn)}enable(){this.div.style.pointerEvents="auto";for(const gn of Kn(this,Wt).values())gn.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const gn of Kn(this,Wt).values())gn.disableEditing();es(this,hn,ju).call(this),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(gn){Kn(this,Xt).getActive()!==gn&&Kn(this,Xt).setActiveEditor(gn)}enableClick(){this.div.addEventListener("pointerdown",Kn(this,qt)),this.div.addEventListener("pointerup",Kn(this,Gt))}disableClick(){this.div.removeEventListener("pointerdown",Kn(this,qt)),this.div.removeEventListener("pointerup",Kn(this,Gt))}attach(gn){Kn(this,Wt).set(gn.id,gn)}detach(gn){var En;Kn(this,Wt).delete(gn.id),(En=Kn(this,zt))==null||En.removePointerInTextLayer(gn.contentDiv)}remove(gn){Kn(this,Xt).removeEditor(gn),this.detach(gn),gn.div.style.display="none",setTimeout(()=>{gn.div.style.display="",gn.div.remove(),gn.isAttachedToDOM=!1,document.activeElement===document.body&&Kn(this,Xt).focusMainContainer()},0),Kn(this,Kt)||this.addInkEditorIfNeeded(!1)}add(gn){if(es(this,Qt,Lu).call(this,gn),Kn(this,Xt).addEditor(gn),this.attach(gn),!gn.isAttachedToDOM){const En=gn.render();this.div.append(En),gn.isAttachedToDOM=!0}this.moveEditorInDOM(gn),gn.onceAdded(),Kn(this,Xt).addToAnnotationStorage(gn)}moveEditorInDOM(gn){var En;(En=Kn(this,zt))==null||En.moveElementInDOM(this.div,gn.div,gn.contentDiv,!0)}addOrRebuild(gn){gn.needsToBeRebuilt()?gn.rebuild():this.add(gn)}addANewEditor(gn){const En=()=>{this.addOrRebuild(gn)},bn=()=>{gn.remove()};this.addCommands({cmd:En,undo:bn,mustExec:!0})}addUndoableEditor(gn){const En=()=>{this.addOrRebuild(gn)},bn=()=>{gn.remove()};this.addCommands({cmd:En,undo:bn,mustExec:!1})}getNextId(){return Kn(this,Xt).getId()}deserialize(gn){switch(gn.annotationType){case kt.AnnotationEditorType.FREETEXT:return Ft.FreeTextEditor.deserialize(gn,this,Kn(this,Xt));case kt.AnnotationEditorType.INK:return jt.InkEditor.deserialize(gn,this,Kn(this,Xt))}return null}setSelected(gn){Kn(this,Xt).setSelected(gn)}toggleSelected(gn){Kn(this,Xt).toggleSelected(gn)}isSelected(gn){return Kn(this,Xt).isSelected(gn)}unselect(gn){Kn(this,Xt).unselect(gn)}pointerup(gn){const{isMac:En}=kt.FeatureTest.platform;if(!(gn.button!==0||gn.ctrlKey&&En)&&gn.target===this.div&&Kn(this,Yt)){if(gs(this,Yt,!1),!Kn(this,Ht)){gs(this,Ht,!0);return}es(this,ln,Fu).call(this,gn)}}pointerdown(gn){const{isMac:En}=kt.FeatureTest.platform;if(gn.button!==0||gn.ctrlKey&&En||gn.target!==this.div)return;gs(this,Yt,!0);const bn=Kn(this,Xt).getActive();gs(this,Ht,!bn||bn.isEmpty())}drop(gn){const En=gn.dataTransfer.getData("text/plain"),bn=Kn(this,Xt).getEditor(En);if(!bn)return;gn.preventDefault(),gn.dataTransfer.dropEffect="move",es(this,Qt,Lu).call(this,bn);const xn=this.div.getBoundingClientRect(),Cn=gn.clientX-xn.x,$n=gn.clientY-xn.y;bn.translate(Cn-bn.startX,$n-bn.startY),this.moveEditorInDOM(bn),bn.div.focus()}dragover(gn){gn.preventDefault()}destroy(){var gn,En;((gn=Kn(this,Xt).getActive())==null?void 0:gn.parent)===this&&Kn(this,Xt).setActiveEditor(null);for(const bn of Kn(this,Wt).values())(En=Kn(this,zt))==null||En.removePointerInTextLayer(bn.contentDiv),bn.setParent(null),bn.isAttachedToDOM=!1,bn.div.remove();this.div=null,Kn(this,Wt).clear(),Kn(this,Xt).removeLayer(this)}render({viewport:gn}){this.viewport=gn,(0,Bt.setLayerDimensions)(this.div,gn),(0,Mt.bindEvents)(this,this.div,["dragover","drop"]);for(const En of Kn(this,Xt).getEditors(this.pageIndex))this.add(En);this.updateMode()}update({viewport:gn}){Kn(this,Xt).commitOrRemove(),this.viewport=gn,(0,Bt.setLayerDimensions)(this.div,{rotation:gn.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:gn,pageHeight:En}=this.viewport.rawDims;return[gn,En]}};zt=new WeakMap,Ht=new WeakMap,Gt=new WeakMap,qt=new WeakMap,Wt=new WeakMap,Yt=new WeakMap,Kt=new WeakMap,Xt=new WeakMap,Qt=new WeakSet,Lu=function(gn){var En;gn.parent!==this&&(this.attach(gn),(En=gn.parent)==null||En.detach(gn),gn.setParent(this),gn.div&&gn.isAttachedToDOM&&(gn.div.remove(),this.div.append(gn.div)))},Zt=new WeakSet,yp=function(gn){switch(Kn(this,Xt).getMode()){case kt.AnnotationEditorType.FREETEXT:return new Ft.FreeTextEditor(gn);case kt.AnnotationEditorType.INK:return new jt.InkEditor(gn)}return null},ln=new WeakSet,Fu=function(gn){const En=this.getNextId(),bn=es(this,Zt,yp).call(this,{parent:this,id:En,x:gn.offsetX,y:gn.offsetY,uiManager:Kn(this,Xt)});return bn&&this.add(bn),bn},hn=new WeakSet,ju=function(){gs(this,Kt,!0);for(const gn of Kn(this,Wt).values())gn.isEmpty()&&gn.remove();gs(this,Kt,!1)},so(pn,"_initialized",!1);let Vt=pn;$t.AnnotationEditorLayer=Vt},(xt,$t,Ct)=>{var Bt,Vt,zt,Ht,Gt,qt,Wt,Yt,Kt,Xt,Ep,Jt,vp,sn,bp,dn,Bu;Object.defineProperty($t,"__esModule",{value:!0}),$t.FreeTextEditor=void 0;var kt=Ct(1),Mt=Ct(5),Ft=Ct(4);const cn=class cn extends Ft.AnnotationEditor{constructor(gn){super({...gn,name:"freeTextEditor"});Yr(this,Xt);Yr(this,Jt);Yr(this,sn);Yr(this,dn);Yr(this,Bt,this.editorDivBlur.bind(this));Yr(this,Vt,this.editorDivFocus.bind(this));Yr(this,zt,this.editorDivInput.bind(this));Yr(this,Ht,this.editorDivKeydown.bind(this));Yr(this,Gt,void 0);Yr(this,qt,"");Yr(this,Wt,`${this.id}-editor`);Yr(this,Yt,!1);Yr(this,Kt,void 0);gs(this,Gt,gn.color||cn._defaultColor||Ft.AnnotationEditor._defaultLineColor),gs(this,Kt,gn.fontSize||cn._defaultFontSize)}static initialize(gn){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(bn=>[bn,gn.get(bn)]));const En=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(En.getPropertyValue("--freetext-padding"))}static updateDefaultParams(gn,En){switch(gn){case kt.AnnotationEditorParamsType.FREETEXT_SIZE:cn._defaultFontSize=En;break;case kt.AnnotationEditorParamsType.FREETEXT_COLOR:cn._defaultColor=En;break}}updateParams(gn,En){switch(gn){case kt.AnnotationEditorParamsType.FREETEXT_SIZE:es(this,Xt,Ep).call(this,En);break;case kt.AnnotationEditorParamsType.FREETEXT_COLOR:es(this,Jt,vp).call(this,En);break}}static get defaultPropertiesToUpdate(){return[[kt.AnnotationEditorParamsType.FREETEXT_SIZE,cn._defaultFontSize],[kt.AnnotationEditorParamsType.FREETEXT_COLOR,cn._defaultColor||Ft.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[kt.AnnotationEditorParamsType.FREETEXT_SIZE,Kn(this,Kt)],[kt.AnnotationEditorParamsType.FREETEXT_COLOR,Kn(this,Gt)]]}getInitialTranslation(){const gn=this.parentScale;return[-cn._internalPadding*gn,-(cn._internalPadding+Kn(this,Kt))*gn]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(kt.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",Kn(this,Ht)),this.editorDiv.addEventListener("focus",Kn(this,Vt)),this.editorDiv.addEventListener("blur",Kn(this,Bt)),this.editorDiv.addEventListener("input",Kn(this,zt)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",Kn(this,Wt)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",Kn(this,Ht)),this.editorDiv.removeEventListener("focus",Kn(this,Vt)),this.editorDiv.removeEventListener("blur",Kn(this,Bt)),this.editorDiv.removeEventListener("input",Kn(this,zt)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(gn){super.focusin(gn),gn.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){this.isInEditMode()&&(super.commit(),Kn(this,Yt)||(gs(this,Yt,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),gs(this,qt,es(this,sn,bp).call(this).trimEnd()),es(this,dn,Bu).call(this))}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(gn){this.enableEditMode(),this.editorDiv.focus()}keydown(gn){gn.target===this.div&&gn.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(gn){cn._keyboardManager.exec(this,gn)}editorDivFocus(gn){this.isEditing=!0}editorDivBlur(gn){this.isEditing=!1}editorDivInput(gn){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let gn,En;this.width&&(gn=this.x,En=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",Kn(this,Wt)),this.enableEditing(),cn._l10nPromise.get("editor_free_text2_aria_label").then(xn=>{var Cn;return(Cn=this.editorDiv)==null?void 0:Cn.setAttribute("aria-label",xn)}),cn._l10nPromise.get("free_text2_default_content").then(xn=>{var Cn;return(Cn=this.editorDiv)==null?void 0:Cn.setAttribute("default-content",xn)}),this.editorDiv.contentEditable=!0;const{style:bn}=this.editorDiv;if(bn.fontSize=`calc(${Kn(this,Kt)}px * var(--scale-factor))`,bn.color=Kn(this,Gt),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,Mt.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[xn,Cn]=this.parentDimensions;this.setAt(gn*xn,En*Cn,this.width*xn,this.height*Cn);for(const $n of Kn(this,qt).split(`
`)){const wn=document.createElement("div");wn.append($n?document.createTextNode($n):document.createElement("br")),this.editorDiv.append(wn)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(gn,En,bn){const xn=super.deserialize(gn,En,bn);return gs(xn,Kt,gn.fontSize),gs(xn,Gt,kt.Util.makeHexColor(...gn.color)),gs(xn,qt,gn.value),xn}serialize(){if(this.isEmpty())return null;const gn=cn._internalPadding*this.parentScale,En=this.getRect(gn,gn),bn=Ft.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:Kn(this,Gt));return{annotationType:kt.AnnotationEditorType.FREETEXT,color:bn,fontSize:Kn(this,Kt),value:Kn(this,qt),pageIndex:this.pageIndex,rect:En,rotation:this.rotation}}};Bt=new WeakMap,Vt=new WeakMap,zt=new WeakMap,Ht=new WeakMap,Gt=new WeakMap,qt=new WeakMap,Wt=new WeakMap,Yt=new WeakMap,Kt=new WeakMap,Xt=new WeakSet,Ep=function(gn){const En=xn=>{this.editorDiv.style.fontSize=`calc(${xn}px * var(--scale-factor))`,this.translate(0,-(xn-Kn(this,Kt))*this.parentScale),gs(this,Kt,xn),es(this,dn,Bu).call(this)},bn=Kn(this,Kt);this.addCommands({cmd:()=>{En(gn)},undo:()=>{En(bn)},mustExec:!0,type:kt.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Jt=new WeakSet,vp=function(gn){const En=Kn(this,Gt);this.addCommands({cmd:()=>{gs(this,Gt,this.editorDiv.style.color=gn)},undo:()=>{gs(this,Gt,this.editorDiv.style.color=En)},mustExec:!0,type:kt.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},sn=new WeakSet,bp=function(){const gn=this.editorDiv.getElementsByTagName("div");if(gn.length===0)return this.editorDiv.innerText;const En=[];for(const bn of gn)En.push(bn.innerText.replace(/\r\n?|\n/,""));return En.join(`
`)},dn=new WeakSet,Bu=function(){const[gn,En]=this.parentDimensions;let bn;if(this.isAttachedToDOM)bn=this.div.getBoundingClientRect();else{const{currentLayer:xn,div:Cn}=this,$n=Cn.style.display;Cn.style.display="hidden",xn.div.append(this.div),bn=Cn.getBoundingClientRect(),Cn.remove(),Cn.style.display=$n}this.width=bn.width/gn,this.height=bn.height/En},so(cn,"_freeTextDefaultContent",""),so(cn,"_l10nPromise"),so(cn,"_internalPadding",0),so(cn,"_defaultColor",null),so(cn,"_defaultFontSize",10),so(cn,"_keyboardManager",new Mt.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],cn.prototype.commitOrRemove]])),so(cn,"_type","freetext");let jt=cn;$t.FreeTextEditor=jt},(xt,$t,Ct)=>{var Ht,Gt,qt,Wt,Yt,Kt,Xt,Qt,Jt,Zt,sn,ln,dn,hn,cn,xp,yn,Tp,En,Sp,xn,Ap,$n,Vu,Rn,$p,An,wp,vn,Cp,Tn,wl,Ln,Uu,Un,fu,rr,hu,nr,eu,kn,zu,Hn,pu,jn,Hu,Ar,Rp,Rr,Ip,jr,Pp,pr,Gu,Hr,mu,Zr,tu,hr,qu;Object.defineProperty($t,"__esModule",{value:!0}),$t.InkEditor=void 0,Object.defineProperty($t,"fitCurve",{enumerable:!0,get:function(){return Ft.fitCurve}});var kt=Ct(1),Mt=Ct(4),Ft=Ct(30),jt=Ct(5);const Bt=16,Vt=100,qr=class qr extends Mt.AnnotationEditor{constructor(wr){super({...wr,name:"inkEditor"});Yr(this,cn);Yr(this,yn);Yr(this,En);Yr(this,xn);Yr(this,$n);Yr(this,Rn);Yr(this,An);Yr(this,vn);Yr(this,Tn);Yr(this,Ln);Yr(this,Un);Yr(this,rr);Yr(this,nr);Yr(this,kn);Yr(this,Hn);Yr(this,Ar);Yr(this,Rr);Yr(this,jr);Yr(this,pr);Yr(this,Hr);Yr(this,Zr);Yr(this,hr);Yr(this,Ht,0);Yr(this,Gt,0);Yr(this,qt,0);Yr(this,Wt,this.canvasPointermove.bind(this));Yr(this,Yt,this.canvasPointerleave.bind(this));Yr(this,Kt,this.canvasPointerup.bind(this));Yr(this,Xt,this.canvasPointerdown.bind(this));Yr(this,Qt,!1);Yr(this,Jt,!1);Yr(this,Zt,null);Yr(this,sn,null);Yr(this,ln,0);Yr(this,dn,0);Yr(this,hn,null);this.color=wr.color||null,this.thickness=wr.thickness||null,this.opacity=wr.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(wr){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(Wr=>[Wr,wr.get(Wr)]))}static updateDefaultParams(wr,Wr){switch(wr){case kt.AnnotationEditorParamsType.INK_THICKNESS:qr._defaultThickness=Wr;break;case kt.AnnotationEditorParamsType.INK_COLOR:qr._defaultColor=Wr;break;case kt.AnnotationEditorParamsType.INK_OPACITY:qr._defaultOpacity=Wr/100;break}}updateParams(wr,Wr){switch(wr){case kt.AnnotationEditorParamsType.INK_THICKNESS:es(this,cn,xp).call(this,Wr);break;case kt.AnnotationEditorParamsType.INK_COLOR:es(this,yn,Tp).call(this,Wr);break;case kt.AnnotationEditorParamsType.INK_OPACITY:es(this,En,Sp).call(this,Wr);break}}static get defaultPropertiesToUpdate(){return[[kt.AnnotationEditorParamsType.INK_THICKNESS,qr._defaultThickness],[kt.AnnotationEditorParamsType.INK_COLOR,qr._defaultColor||Mt.AnnotationEditor._defaultLineColor],[kt.AnnotationEditorParamsType.INK_OPACITY,Math.round(qr._defaultOpacity*100)]]}get propertiesToUpdate(){return[[kt.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||qr._defaultThickness],[kt.AnnotationEditorParamsType.INK_COLOR,this.color||qr._defaultColor||Mt.AnnotationEditor._defaultLineColor],[kt.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??qr._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(es(this,Un,fu).call(this),es(this,rr,hu).call(this)),this.isAttachedToDOM||(this.parent.add(this),es(this,nr,eu).call(this)),es(this,Zr,tu).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,Kn(this,sn).disconnect(),gs(this,sn,null),super.remove())}setParent(wr){!this.parent&&wr?this._uiManager.removeShouldRescale(this):this.parent&&wr===null&&this._uiManager.addShouldRescale(this),super.setParent(wr)}onScaleChanging(){const[wr,Wr]=this.parentDimensions,ns=this.width*wr,us=this.height*Wr;this.setDimensions(ns,us)}enableEditMode(){Kn(this,Qt)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",Kn(this,Xt)),this.canvas.addEventListener("pointerup",Kn(this,Kt)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",Kn(this,Xt)),this.canvas.removeEventListener("pointerup",Kn(this,Kt)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){Kn(this,Qt)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),gs(this,Qt,!0),this.div.classList.add("disabled"),es(this,Zr,tu).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(wr){super.focusin(wr),this.enableEditMode()}canvasPointerdown(wr){wr.button!==0||!this.isInEditMode()||Kn(this,Qt)||(this.setInForeground(),wr.type!=="mouse"&&this.div.focus(),wr.stopPropagation(),this.canvas.addEventListener("pointerleave",Kn(this,Yt)),this.canvas.addEventListener("pointermove",Kn(this,Wt)),es(this,Rn,$p).call(this,wr.offsetX,wr.offsetY))}canvasPointermove(wr){wr.stopPropagation(),es(this,An,wp).call(this,wr.offsetX,wr.offsetY)}canvasPointerup(wr){wr.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(wr.stopPropagation(),es(this,Ln,Uu).call(this,wr),this.setInBackground())}canvasPointerleave(wr){es(this,Ln,Uu).call(this,wr),this.setInBackground()}render(){if(this.div)return this.div;let wr,Wr;this.width&&(wr=this.x,Wr=this.y),super.render(),qr._l10nPromise.get("editor_ink2_aria_label").then(vs=>{var Ps;return(Ps=this.div)==null?void 0:Ps.setAttribute("aria-label",vs)});const[ns,us,ps,Ls]=es(this,xn,Ap).call(this);if(this.setAt(ns,us,0,0),this.setDims(ps,Ls),es(this,Un,fu).call(this),this.width){const[vs,Ps]=this.parentDimensions;this.setAt(wr*vs,Wr*Ps,this.width*vs,this.height*Ps),gs(this,Jt,!0),es(this,nr,eu).call(this),this.setDims(this.width*vs,this.height*Ps),es(this,Tn,wl).call(this),es(this,hr,qu).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return es(this,rr,hu).call(this),this.div}setDimensions(wr,Wr){const ns=Math.round(wr),us=Math.round(Wr);if(Kn(this,ln)===ns&&Kn(this,dn)===us)return;gs(this,ln,ns),gs(this,dn,us),this.canvas.style.visibility="hidden",Kn(this,Ht)&&Math.abs(Kn(this,Ht)-wr/Wr)>.01&&(Wr=Math.ceil(wr/Kn(this,Ht)),this.setDims(wr,Wr));const[ps,Ls]=this.parentDimensions;this.width=wr/ps,this.height=Wr/Ls,Kn(this,Qt)&&es(this,kn,zu).call(this,wr,Wr),es(this,nr,eu).call(this),es(this,Tn,wl).call(this),this.canvas.style.visibility="visible"}static deserialize(wr,Wr,ns){var js,Hs;const us=super.deserialize(wr,Wr,ns);us.thickness=wr.thickness,us.color=kt.Util.makeHexColor(...wr.color),us.opacity=wr.opacity;const[ps,Ls]=us.pageDimensions,vs=us.width*ps,Ps=us.height*Ls,Fs=us.parentScale,zs=wr.thickness/2;gs(us,Ht,vs/Ps),gs(us,Qt,!0),gs(us,ln,Math.round(vs)),gs(us,dn,Math.round(Ps));for(const{bezier:Us}of wr.paths){const Ks=[];us.paths.push(Ks);let go=Fs*(Us[0]-zs),vo=Fs*(Ps-Us[1]-zs);for(let lr=2,$r=Us.length;lr<$r;lr+=6){const Gr=Fs*(Us[lr]-zs),zr=Fs*(Ps-Us[lr+1]-zs),fs=Fs*(Us[lr+2]-zs),Ts=Fs*(Ps-Us[lr+3]-zs),Bs=Fs*(Us[lr+4]-zs),Xs=Fs*(Ps-Us[lr+5]-zs);Ks.push([[go,vo],[Gr,zr],[fs,Ts],[Bs,Xs]]),go=Bs,vo=Xs}const vr=es(this,jn,Hu).call(this,Ks);us.bezierPath2D.push(vr)}const Eo=es(js=us,pr,Gu).call(js);return gs(us,qt,Math.max(Bt,Eo[2]-Eo[0])),gs(us,Gt,Math.max(Bt,Eo[3]-Eo[1])),es(Hs=us,kn,zu).call(Hs,vs,Ps),us}serialize(){if(this.isEmpty())return null;const wr=this.getRect(0,0),Wr=this.rotation%180===0?wr[3]-wr[1]:wr[2]-wr[0],ns=Mt.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:kt.AnnotationEditorType.INK,color:ns,thickness:this.thickness,opacity:this.opacity,paths:es(this,Ar,Rp).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Wr),pageIndex:this.pageIndex,rect:wr,rotation:this.rotation}}};Ht=new WeakMap,Gt=new WeakMap,qt=new WeakMap,Wt=new WeakMap,Yt=new WeakMap,Kt=new WeakMap,Xt=new WeakMap,Qt=new WeakMap,Jt=new WeakMap,Zt=new WeakMap,sn=new WeakMap,ln=new WeakMap,dn=new WeakMap,hn=new WeakMap,cn=new WeakSet,xp=function(wr){const Wr=this.thickness;this.addCommands({cmd:()=>{this.thickness=wr,es(this,Zr,tu).call(this)},undo:()=>{this.thickness=Wr,es(this,Zr,tu).call(this)},mustExec:!0,type:kt.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},yn=new WeakSet,Tp=function(wr){const Wr=this.color;this.addCommands({cmd:()=>{this.color=wr,es(this,Tn,wl).call(this)},undo:()=>{this.color=Wr,es(this,Tn,wl).call(this)},mustExec:!0,type:kt.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},En=new WeakSet,Sp=function(wr){wr/=100;const Wr=this.opacity;this.addCommands({cmd:()=>{this.opacity=wr,es(this,Tn,wl).call(this)},undo:()=>{this.opacity=Wr,es(this,Tn,wl).call(this)},mustExec:!0,type:kt.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},xn=new WeakSet,Ap=function(){const{parentRotation:wr,parentDimensions:[Wr,ns]}=this;switch(wr){case 90:return[0,ns,ns,Wr];case 180:return[Wr,ns,Wr,ns];case 270:return[Wr,0,ns,Wr];default:return[0,0,Wr,ns]}},$n=new WeakSet,Vu=function(){const{ctx:wr,color:Wr,opacity:ns,thickness:us,parentScale:ps,scaleFactor:Ls}=this;wr.lineWidth=us*ps/Ls,wr.lineCap="round",wr.lineJoin="round",wr.miterLimit=10,wr.strokeStyle=`${Wr}${(0,jt.opacityToHex)(ns)}`},Rn=new WeakSet,$p=function(wr,Wr){this.isEditing=!0,Kn(this,Jt)||(gs(this,Jt,!0),es(this,nr,eu).call(this),this.thickness||(this.thickness=qr._defaultThickness),this.color||(this.color=qr._defaultColor||Mt.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=qr._defaultOpacity)),this.currentPath.push([wr,Wr]),gs(this,Zt,null),es(this,$n,Vu).call(this),this.ctx.beginPath(),this.ctx.moveTo(wr,Wr),gs(this,hn,()=>{Kn(this,hn)&&(Kn(this,Zt)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):es(this,Tn,wl).call(this),this.ctx.lineTo(...Kn(this,Zt)),gs(this,Zt,null),this.ctx.stroke()),window.requestAnimationFrame(Kn(this,hn)))}),window.requestAnimationFrame(Kn(this,hn))},An=new WeakSet,wp=function(wr,Wr){const[ns,us]=this.currentPath.at(-1);wr===ns&&Wr===us||(this.currentPath.push([wr,Wr]),gs(this,Zt,[wr,Wr]))},vn=new WeakSet,Cp=function(wr,Wr){var Fs;this.ctx.closePath(),gs(this,hn,null),wr=Math.min(Math.max(wr,0),this.canvas.width),Wr=Math.min(Math.max(Wr,0),this.canvas.height);const[ns,us]=this.currentPath.at(-1);(wr!==ns||Wr!==us)&&this.currentPath.push([wr,Wr]);let ps;if(this.currentPath.length!==1)ps=(0,Ft.fitCurve)(this.currentPath,30,null);else{const zs=[wr,Wr];ps=[[zs,zs.slice(),zs.slice(),zs]]}const Ls=es(Fs=qr,jn,Hu).call(Fs,ps);this.currentPath.length=0;const vs=()=>{this.paths.push(ps),this.bezierPath2D.push(Ls),this.rebuild()},Ps=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(es(this,Un,fu).call(this),es(this,rr,hu).call(this)),es(this,Zr,tu).call(this))};this.addCommands({cmd:vs,undo:Ps,mustExec:!0})},Tn=new WeakSet,wl=function(){if(this.isEmpty()){es(this,Hn,pu).call(this);return}es(this,$n,Vu).call(this);const{canvas:wr,ctx:Wr}=this;Wr.setTransform(1,0,0,1,0,0),Wr.clearRect(0,0,wr.width,wr.height),es(this,Hn,pu).call(this);for(const ns of this.bezierPath2D)Wr.stroke(ns)},Ln=new WeakSet,Uu=function(wr){es(this,vn,Cp).call(this,wr.offsetX,wr.offsetY),this.canvas.removeEventListener("pointerleave",Kn(this,Yt)),this.canvas.removeEventListener("pointermove",Kn(this,Wt)),this.addToAnnotationStorage()},Un=new WeakSet,fu=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",qr._l10nPromise.get("editor_ink_canvas_aria_label").then(wr=>{var Wr;return(Wr=this.canvas)==null?void 0:Wr.setAttribute("aria-label",wr)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},rr=new WeakSet,hu=function(){let wr=null;gs(this,sn,new ResizeObserver(Wr=>{const ns=Wr[0].contentRect;ns.width&&ns.height&&(wr!==null&&clearTimeout(wr),wr=setTimeout(()=>{this.fixDims(),wr=null},Vt),this.setDimensions(ns.width,ns.height))})),Kn(this,sn).observe(this.div)},nr=new WeakSet,eu=function(){if(!Kn(this,Jt))return;const[wr,Wr]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*wr),this.canvas.height=Math.ceil(this.height*Wr),es(this,Hn,pu).call(this)},kn=new WeakSet,zu=function(wr,Wr){const ns=es(this,Hr,mu).call(this),us=(wr-ns)/Kn(this,qt),ps=(Wr-ns)/Kn(this,Gt);this.scaleFactor=Math.min(us,ps)},Hn=new WeakSet,pu=function(){const wr=es(this,Hr,mu).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+wr,this.translationY*this.scaleFactor+wr)},jn=new WeakSet,Hu=function(wr){const Wr=new Path2D;for(let ns=0,us=wr.length;ns<us;ns++){const[ps,Ls,vs,Ps]=wr[ns];ns===0&&Wr.moveTo(...ps),Wr.bezierCurveTo(Ls[0],Ls[1],vs[0],vs[1],Ps[0],Ps[1])}return Wr},Ar=new WeakSet,Rp=function(wr,Wr,ns,us){const Ls=[],vs=this.thickness/2;let Ps,Fs;for(const zs of this.paths){Ps=[],Fs=[];for(let Eo=0,js=zs.length;Eo<js;Eo++){const[Hs,Us,Ks,go]=zs[Eo],vo=wr*(Hs[0]+Wr)+vs,vr=us-wr*(Hs[1]+ns)-vs,lr=wr*(Us[0]+Wr)+vs,$r=us-wr*(Us[1]+ns)-vs,Gr=wr*(Ks[0]+Wr)+vs,zr=us-wr*(Ks[1]+ns)-vs,fs=wr*(go[0]+Wr)+vs,Ts=us-wr*(go[1]+ns)-vs;Eo===0&&(Ps.push(vo,vr),Fs.push(vo,vr)),Ps.push(lr,$r,Gr,zr,fs,Ts),es(this,Rr,Ip).call(this,vo,vr,lr,$r,Gr,zr,fs,Ts,4,Fs)}Ls.push({bezier:Ps,points:Fs})}return Ls},Rr=new WeakSet,Ip=function(wr,Wr,ns,us,ps,Ls,vs,Ps,Fs,zs){if(es(this,jr,Pp).call(this,wr,Wr,ns,us,ps,Ls,vs,Ps)){zs.push(vs,Ps);return}for(let Eo=1;Eo<Fs-1;Eo++){const js=Eo/Fs,Hs=1-js;let Us=js*wr+Hs*ns,Ks=js*Wr+Hs*us,go=js*ns+Hs*ps,vo=js*us+Hs*Ls;const vr=js*ps+Hs*vs,lr=js*Ls+Hs*Ps;Us=js*Us+Hs*go,Ks=js*Ks+Hs*vo,go=js*go+Hs*vr,vo=js*vo+Hs*lr,Us=js*Us+Hs*go,Ks=js*Ks+Hs*vo,zs.push(Us,Ks)}zs.push(vs,Ps)},jr=new WeakSet,Pp=function(wr,Wr,ns,us,ps,Ls,vs,Ps){const zs=(3*ns-2*wr-vs)**2,Eo=(3*us-2*Wr-Ps)**2,js=(3*ps-wr-2*vs)**2,Hs=(3*Ls-Wr-2*Ps)**2;return Math.max(zs,js)+Math.max(Eo,Hs)<=10},pr=new WeakSet,Gu=function(){let wr=1/0,Wr=-1/0,ns=1/0,us=-1/0;for(const ps of this.paths)for(const[Ls,vs,Ps,Fs]of ps){const zs=kt.Util.bezierBoundingBox(...Ls,...vs,...Ps,...Fs);wr=Math.min(wr,zs[0]),ns=Math.min(ns,zs[1]),Wr=Math.max(Wr,zs[2]),us=Math.max(us,zs[3])}return[wr,ns,Wr,us]},Hr=new WeakSet,mu=function(){return Kn(this,Qt)?Math.ceil(this.thickness*this.parentScale):0},Zr=new WeakSet,tu=function(wr=!1){if(this.isEmpty())return;if(!Kn(this,Qt)){es(this,Tn,wl).call(this);return}const Wr=es(this,pr,Gu).call(this),ns=es(this,Hr,mu).call(this);gs(this,qt,Math.max(Bt,Wr[2]-Wr[0])),gs(this,Gt,Math.max(Bt,Wr[3]-Wr[1]));const us=Math.ceil(ns+Kn(this,qt)*this.scaleFactor),ps=Math.ceil(ns+Kn(this,Gt)*this.scaleFactor),[Ls,vs]=this.parentDimensions;this.width=us/Ls,this.height=ps/vs,gs(this,Ht,us/ps),es(this,hr,qu).call(this);const Ps=this.translationX,Fs=this.translationY;this.translationX=-Wr[0],this.translationY=-Wr[1],es(this,nr,eu).call(this),es(this,Tn,wl).call(this),gs(this,ln,us),gs(this,dn,ps),this.setDims(us,ps);const zs=wr?ns/this.scaleFactor/2:0;this.translate(Ps-this.translationX-zs,Fs-this.translationY-zs)},hr=new WeakSet,qu=function(){const{style:wr}=this.div;Kn(this,Ht)>=1?(wr.minHeight=`${Bt}px`,wr.minWidth=`${Math.round(Kn(this,Ht)*Bt)}px`):(wr.minWidth=`${Bt}px`,wr.minHeight=`${Math.round(Bt/Kn(this,Ht))}px`)},Yr(qr,jn),so(qr,"_defaultColor",null),so(qr,"_defaultOpacity",1),so(qr,"_defaultThickness",1),so(qr,"_l10nPromise"),so(qr,"_type","ink");let zt=qr;$t.InkEditor=zt},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.fitCurve=void 0;const kt=Ct(31);$t.fitCurve=kt},xt=>{function $t(Yt,Kt,Xt){if(!Array.isArray(Yt))throw new TypeError("First argument should be an array");if(Yt.forEach(sn=>{if(!Array.isArray(sn)||sn.some(ln=>typeof ln!="number")||sn.length!==Yt[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),Yt=Yt.filter((sn,ln)=>ln===0||!sn.every((dn,hn)=>dn===Yt[ln-1][hn])),Yt.length<2)return[];const Qt=Yt.length,Jt=Gt(Yt[1],Yt[0]),Zt=Gt(Yt[Qt-2],Yt[Qt-1]);return Ct(Yt,Jt,Zt,Kt,Xt)}function Ct(Yt,Kt,Xt,Qt,Jt){var sn,ln,dn,hn,cn,pn,yn,gn,En,bn,xn,Cn,$n;if(Yt.length===2)return Cn=qt.vectorLen(qt.subtract(Yt[0],Yt[1]))/3,sn=[Yt[0],qt.addArrays(Yt[0],qt.mulItems(Kt,Cn)),qt.addArrays(Yt[1],qt.mulItems(Xt,Cn)),Yt[1]],[sn];if(ln=Bt(Yt),[sn,hn,pn]=kt(Yt,ln,ln,Kt,Xt,Jt),hn===0||hn<Qt)return[sn];if(hn<Qt*Qt)for(dn=ln,cn=hn,yn=pn,$n=0;$n<20;$n++){if(dn=Ft(sn,Yt,dn),[sn,hn,pn]=kt(Yt,ln,dn,Kt,Xt,Jt),hn<Qt)return[sn];if(pn===yn){let wn=hn/cn;if(wn>.9999&&wn<1.0001)break}cn=hn,yn=pn}return xn=[],gn=qt.subtract(Yt[pn-1],Yt[pn+1]),gn.every(wn=>wn===0)&&(gn=qt.subtract(Yt[pn-1],Yt[pn]),[gn[0],gn[1]]=[-gn[1],gn[0]]),En=qt.normalize(gn),bn=qt.mulItems(En,-1),xn=xn.concat(Ct(Yt.slice(0,pn+1),Kt,En,Qt,Jt)),xn=xn.concat(Ct(Yt.slice(pn),bn,Xt,Qt,Jt)),xn}function kt(Yt,Kt,Xt,Qt,Jt,Zt){var sn,ln,dn;return sn=Mt(Yt,Xt,Qt,Jt),[ln,dn]=Vt(Yt,sn,Kt),Zt&&Zt({bez:sn,points:Yt,params:Kt,maxErr:ln,maxPoint:dn}),[sn,ln,dn]}function Mt(Yt,Kt,Xt,Qt){var Jt,Zt,sn,ln,dn,hn,cn,pn,yn,gn,En,bn,xn,Cn,$n,wn,Rn,Dn=Yt[0],An=Yt[Yt.length-1];for(Jt=[Dn,null,null,An],Zt=qt.zeros_Xx2x2(Kt.length),xn=0,Cn=Kt.length;xn<Cn;xn++)wn=Kt[xn],Rn=1-wn,sn=Zt[xn],sn[0]=qt.mulItems(Xt,3*wn*(Rn*Rn)),sn[1]=qt.mulItems(Qt,3*Rn*(wn*wn));for(ln=[[0,0],[0,0]],dn=[0,0],xn=0,Cn=Yt.length;xn<Cn;xn++)wn=Kt[xn],sn=Zt[xn],ln[0][0]+=qt.dot(sn[0],sn[0]),ln[0][1]+=qt.dot(sn[0],sn[1]),ln[1][0]+=qt.dot(sn[0],sn[1]),ln[1][1]+=qt.dot(sn[1],sn[1]),$n=qt.subtract(Yt[xn],Wt.q([Dn,Dn,An,An],wn)),dn[0]+=qt.dot(sn[0],$n),dn[1]+=qt.dot(sn[1],$n);return hn=ln[0][0]*ln[1][1]-ln[1][0]*ln[0][1],cn=ln[0][0]*dn[1]-ln[1][0]*dn[0],pn=dn[0]*ln[1][1]-dn[1]*ln[0][1],yn=hn===0?0:pn/hn,gn=hn===0?0:cn/hn,bn=qt.vectorLen(qt.subtract(Dn,An)),En=1e-6*bn,yn<En||gn<En?(Jt[1]=qt.addArrays(Dn,qt.mulItems(Xt,bn/3)),Jt[2]=qt.addArrays(An,qt.mulItems(Qt,bn/3))):(Jt[1]=qt.addArrays(Dn,qt.mulItems(Xt,yn)),Jt[2]=qt.addArrays(An,qt.mulItems(Qt,gn))),Jt}function Ft(Yt,Kt,Xt){return Xt.map((Qt,Jt)=>jt(Yt,Kt[Jt],Qt))}function jt(Yt,Kt,Xt){var Qt=qt.subtract(Wt.q(Yt,Xt),Kt),Jt=Wt.qprime(Yt,Xt),Zt=qt.mulMatrix(Qt,Jt),sn=qt.sum(qt.squareItems(Jt))+2*qt.mulMatrix(Qt,Wt.qprimeprime(Yt,Xt));return sn===0?Xt:Xt-Zt/sn}function Bt(Yt){var Kt=[],Xt,Qt,Jt;return Yt.forEach((Zt,sn)=>{Xt=sn?Qt+qt.vectorLen(qt.subtract(Zt,Jt)):0,Kt.push(Xt),Qt=Xt,Jt=Zt}),Kt=Kt.map(Zt=>Zt/Qt),Kt}function Vt(Yt,Kt,Xt){var Qt,Jt,Zt,sn,ln,dn,hn,cn;Jt=0,Zt=Math.floor(Yt.length/2);const pn=zt(Kt,10);for(ln=0,dn=Yt.length;ln<dn;ln++)hn=Yt[ln],cn=Ht(Kt,Xt[ln],pn,10),sn=qt.subtract(Wt.q(Kt,cn),hn),Qt=sn[0]*sn[0]+sn[1]*sn[1],Qt>Jt&&(Jt=Qt,Zt=ln);return[Jt,Zt]}var zt=function(Yt,Kt){for(var Xt,Qt=[0],Jt=Yt[0],Zt=0,sn=1;sn<=Kt;sn++)Xt=Wt.q(Yt,sn/Kt),Zt+=qt.vectorLen(qt.subtract(Xt,Jt)),Qt.push(Zt),Jt=Xt;return Qt=Qt.map(ln=>ln/Zt),Qt};function Ht(Yt,Kt,Xt,Qt){if(Kt<0)return 0;if(Kt>1)return 1;for(var Jt,Zt,sn,ln,dn,hn=1;hn<=Qt;hn++)if(Kt<=Xt[hn]){ln=(hn-1)/Qt,sn=hn/Qt,Zt=Xt[hn-1],Jt=Xt[hn],dn=(Kt-Zt)/(Jt-Zt)*(sn-ln)+ln;break}return dn}function Gt(Yt,Kt){return qt.normalize(qt.subtract(Yt,Kt))}class qt{static zeros_Xx2x2(Kt){for(var Xt=[];Kt--;)Xt.push([0,0]);return Xt}static mulItems(Kt,Xt){return Kt.map(Qt=>Qt*Xt)}static mulMatrix(Kt,Xt){return Kt.reduce((Qt,Jt,Zt)=>Qt+Jt*Xt[Zt],0)}static subtract(Kt,Xt){return Kt.map((Qt,Jt)=>Qt-Xt[Jt])}static addArrays(Kt,Xt){return Kt.map((Qt,Jt)=>Qt+Xt[Jt])}static addItems(Kt,Xt){return Kt.map(Qt=>Qt+Xt)}static sum(Kt){return Kt.reduce((Xt,Qt)=>Xt+Qt)}static dot(Kt,Xt){return qt.mulMatrix(Kt,Xt)}static vectorLen(Kt){return Math.hypot(...Kt)}static divItems(Kt,Xt){return Kt.map(Qt=>Qt/Xt)}static squareItems(Kt){return Kt.map(Xt=>Xt*Xt)}static normalize(Kt){return this.divItems(Kt,this.vectorLen(Kt))}}class Wt{static q(Kt,Xt){var Qt=1-Xt,Jt=qt.mulItems(Kt[0],Qt*Qt*Qt),Zt=qt.mulItems(Kt[1],3*Qt*Qt*Xt),sn=qt.mulItems(Kt[2],3*Qt*Xt*Xt),ln=qt.mulItems(Kt[3],Xt*Xt*Xt);return qt.addArrays(qt.addArrays(Jt,Zt),qt.addArrays(sn,ln))}static qprime(Kt,Xt){var Qt=1-Xt,Jt=qt.mulItems(qt.subtract(Kt[1],Kt[0]),3*Qt*Qt),Zt=qt.mulItems(qt.subtract(Kt[2],Kt[1]),6*Qt*Xt),sn=qt.mulItems(qt.subtract(Kt[3],Kt[2]),3*Xt*Xt);return qt.addArrays(qt.addArrays(Jt,Zt),sn)}static qprimeprime(Kt,Xt){return qt.addArrays(qt.mulItems(qt.addArrays(qt.subtract(Kt[2],qt.mulItems(Kt[1],2)),Kt[0]),6*(1-Xt)),qt.mulItems(qt.addArrays(qt.subtract(Kt[3],qt.mulItems(Kt[2],2)),Kt[1]),6*Xt))}}xt.exports=$t,xt.exports.fitCubic=Ct,xt.exports.createTangent=Gt},(xt,$t,Ct)=>{var _n,Yl,Pn,Dp,Un,Wu,rr,Yu;Object.defineProperty($t,"__esModule",{value:!0}),$t.AnnotationLayer=void 0;var kt=Ct(1),Mt=Ct(6),Ft=Ct(3),jt=Ct(33),Bt=Ct(34);const Vt=1e3,zt=9,Ht=new WeakSet;function Gt(mr){return{width:mr[2]-mr[0],height:mr[3]-mr[1]}}class qt{static create(kn){switch(kn.data.annotationType){case kt.AnnotationType.LINK:return new Yt(kn);case kt.AnnotationType.TEXT:return new Kt(kn);case kt.AnnotationType.WIDGET:switch(kn.data.fieldType){case"Tx":return new Qt(kn);case"Btn":return kn.data.radioButton?new Zt(kn):kn.data.checkBox?new Jt(kn):new sn(kn);case"Ch":return new ln(kn)}return new Xt(kn);case kt.AnnotationType.POPUP:return new dn(kn);case kt.AnnotationType.FREETEXT:return new cn(kn);case kt.AnnotationType.LINE:return new pn(kn);case kt.AnnotationType.SQUARE:return new yn(kn);case kt.AnnotationType.CIRCLE:return new gn(kn);case kt.AnnotationType.POLYLINE:return new En(kn);case kt.AnnotationType.CARET:return new xn(kn);case kt.AnnotationType.INK:return new Cn(kn);case kt.AnnotationType.POLYGON:return new bn(kn);case kt.AnnotationType.HIGHLIGHT:return new $n(kn);case kt.AnnotationType.UNDERLINE:return new wn(kn);case kt.AnnotationType.SQUIGGLY:return new Rn(kn);case kt.AnnotationType.STRIKEOUT:return new Dn(kn);case kt.AnnotationType.STAMP:return new An(kn);case kt.AnnotationType.FILEATTACHMENT:return new Sn(kn);default:return new Wt(kn)}}}class Wt{constructor(kn,{isRenderable:Fn=!1,ignoreBorder:Hn=!1,createQuadrilaterals:Bn=!1}={}){this.isRenderable=Fn,this.data=kn.data,this.layer=kn.layer,this.page=kn.page,this.viewport=kn.viewport,this.linkService=kn.linkService,this.downloadManager=kn.downloadManager,this.imageResourcesPath=kn.imageResourcesPath,this.renderForms=kn.renderForms,this.svgFactory=kn.svgFactory,this.annotationStorage=kn.annotationStorage,this.enableScripting=kn.enableScripting,this.hasJSActions=kn.hasJSActions,this._fieldObjects=kn.fieldObjects,Fn&&(this.container=this._createContainer(Hn)),Bn&&(this.quadrilaterals=this._createQuadrilaterals(Hn))}_createContainer(kn=!1){const{data:Fn,page:Hn,viewport:Bn}=this,jn=document.createElement("section");jn.setAttribute("data-annotation-id",Fn.id);const{pageWidth:sr,pageHeight:Ar,pageX:Fr,pageY:Rr}=Bn.rawDims,{width:Qn,height:jr}=Gt(Fn.rect),Mr=kt.Util.normalizeRect([Fn.rect[0],Hn.view[3]-Fn.rect[1]+Hn.view[1],Fn.rect[2],Hn.view[3]-Fn.rect[3]+Hn.view[1]]);if(!kn&&Fn.borderStyle.width>0){jn.style.borderWidth=`${Fn.borderStyle.width}px`;const Tr=Fn.borderStyle.horizontalCornerRadius,Hr=Fn.borderStyle.verticalCornerRadius;if(Tr>0||Hr>0){const Zr=`calc(${Tr}px * var(--scale-factor)) / calc(${Hr}px * var(--scale-factor))`;jn.style.borderRadius=Zr}else if(this instanceof Zt){const Zr=`calc(${Qn}px * var(--scale-factor)) / calc(${jr}px * var(--scale-factor))`;jn.style.borderRadius=Zr}switch(Fn.borderStyle.style){case kt.AnnotationBorderStyleType.SOLID:jn.style.borderStyle="solid";break;case kt.AnnotationBorderStyleType.DASHED:jn.style.borderStyle="dashed";break;case kt.AnnotationBorderStyleType.BEVELED:(0,kt.warn)("Unimplemented border style: beveled");break;case kt.AnnotationBorderStyleType.INSET:(0,kt.warn)("Unimplemented border style: inset");break;case kt.AnnotationBorderStyleType.UNDERLINE:jn.style.borderBottomStyle="solid";break}const Xr=Fn.borderColor||null;Xr?jn.style.borderColor=kt.Util.makeHexColor(Xr[0]|0,Xr[1]|0,Xr[2]|0):jn.style.borderWidth=0}jn.style.left=`${100*(Mr[0]-Fr)/sr}%`,jn.style.top=`${100*(Mr[1]-Rr)/Ar}%`;const{rotation:pr}=Fn;return Fn.hasOwnCanvas||pr===0?(jn.style.width=`${100*Qn/sr}%`,jn.style.height=`${100*jr/Ar}%`):this.setRotation(pr,jn),jn}setRotation(kn,Fn=this.container){const{pageWidth:Hn,pageHeight:Bn}=this.viewport.rawDims,{width:jn,height:sr}=Gt(this.data.rect);let Ar,Fr;kn%180===0?(Ar=100*jn/Hn,Fr=100*sr/Bn):(Ar=100*sr/Hn,Fr=100*jn/Bn),Fn.style.width=`${Ar}%`,Fn.style.height=`${Fr}%`,Fn.setAttribute("data-main-rotation",(360-kn)%360)}get _commonActions(){const kn=(Fn,Hn,Bn)=>{const jn=Bn.detail[Fn];Bn.target.style[Hn]=jt.ColorConverters[`${jn[0]}_HTML`](jn.slice(1))};return(0,kt.shadow)(this,"_commonActions",{display:Fn=>{const Hn=Fn.detail.display%2===1;this.container.style.visibility=Hn?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:Hn,print:Fn.detail.display===0||Fn.detail.display===3})},print:Fn=>{this.annotationStorage.setValue(this.data.id,{print:Fn.detail.print})},hidden:Fn=>{this.container.style.visibility=Fn.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:Fn.detail.hidden})},focus:Fn=>{setTimeout(()=>Fn.target.focus({preventScroll:!1}),0)},userName:Fn=>{Fn.target.title=Fn.detail.userName},readonly:Fn=>{Fn.detail.readonly?Fn.target.setAttribute("readonly",""):Fn.target.removeAttribute("readonly")},required:Fn=>{this._setRequired(Fn.target,Fn.detail.required)},bgColor:Fn=>{kn("bgColor","backgroundColor",Fn)},fillColor:Fn=>{kn("fillColor","backgroundColor",Fn)},fgColor:Fn=>{kn("fgColor","color",Fn)},textColor:Fn=>{kn("textColor","color",Fn)},borderColor:Fn=>{kn("borderColor","borderColor",Fn)},strokeColor:Fn=>{kn("strokeColor","borderColor",Fn)},rotation:Fn=>{const Hn=Fn.detail.rotation;this.setRotation(Hn),this.annotationStorage.setValue(this.data.id,{rotation:Hn})}})}_dispatchEventFromSandbox(kn,Fn){const Hn=this._commonActions;for(const Bn of Object.keys(Fn.detail)){const jn=kn[Bn]||Hn[Bn];jn==null||jn(Fn)}}_setDefaultPropertiesFromJS(kn){if(!this.enableScripting)return;const Fn=this.annotationStorage.getRawValue(this.data.id);if(!Fn)return;const Hn=this._commonActions;for(const[Bn,jn]of Object.entries(Fn)){const sr=Hn[Bn];if(sr){const Ar={detail:{[Bn]:jn},target:kn};sr(Ar),delete Fn[Bn]}}}_createQuadrilaterals(kn=!1){if(!this.data.quadPoints)return null;const Fn=[],Hn=this.data.rect;for(const Bn of this.data.quadPoints)this.data.rect=[Bn[2].x,Bn[2].y,Bn[1].x,Bn[1].y],Fn.push(this._createContainer(kn));return this.data.rect=Hn,Fn}_createPopup(kn,Fn){let Hn=this.container;this.quadrilaterals&&(kn=kn||this.quadrilaterals,Hn=this.quadrilaterals[0]),kn||(kn=document.createElement("div"),kn.className="popupTriggerArea",Hn.append(kn));const jn=new hn({container:Hn,trigger:kn,color:Fn.color,titleObj:Fn.titleObj,modificationDate:Fn.modificationDate,contentsObj:Fn.contentsObj,richText:Fn.richText,hideWrapper:!0}).render();jn.style.left="100%",Hn.append(jn)}_renderQuadrilaterals(kn){for(const Fn of this.quadrilaterals)Fn.className=kn;return this.quadrilaterals}render(){(0,kt.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(kn,Fn=null){const Hn=[];if(this._fieldObjects){const Bn=this._fieldObjects[kn];if(Bn)for(const{page:jn,id:sr,exportValues:Ar}of Bn){if(jn===-1||sr===Fn)continue;const Fr=typeof Ar=="string"?Ar:null,Rr=document.querySelector(`[data-element-id="${sr}"]`);if(Rr&&!Ht.has(Rr)){(0,kt.warn)(`_getElementsByName - element not allowed: ${sr}`);continue}Hn.push({id:sr,exportValue:Fr,domElement:Rr})}return Hn}for(const Bn of document.getElementsByName(kn)){const{exportValue:jn}=Bn,sr=Bn.getAttribute("data-element-id");sr!==Fn&&Ht.has(Bn)&&Hn.push({id:sr,exportValue:jn,domElement:Bn})}return Hn}}class Yt extends Wt{constructor(Fn,Hn=null){super(Fn,{isRenderable:!0,ignoreBorder:!!(Hn!=null&&Hn.ignoreBorder),createQuadrilaterals:!0});Yr(this,_n);Yr(this,Pn);this.isTooltipOnly=Fn.data.isTooltipOnly}render(){const{data:Fn,linkService:Hn}=this,Bn=document.createElement("a");Bn.setAttribute("data-element-id",Fn.id);let jn=!1;return Fn.url?(Hn.addLinkAttributes(Bn,Fn.url,Fn.newWindow),jn=!0):Fn.action?(this._bindNamedAction(Bn,Fn.action),jn=!0):Fn.attachment?(this._bindAttachment(Bn,Fn.attachment),jn=!0):Fn.setOCGState?(es(this,Pn,Dp).call(this,Bn,Fn.setOCGState),jn=!0):Fn.dest?(this._bindLink(Bn,Fn.dest),jn=!0):(Fn.actions&&(Fn.actions.Action||Fn.actions["Mouse Up"]||Fn.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Bn,Fn),jn=!0),Fn.resetForm?(this._bindResetFormAction(Bn,Fn.resetForm),jn=!0):this.isTooltipOnly&&!jn&&(this._bindLink(Bn,""),jn=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((sr,Ar)=>{const Fr=Ar===0?Bn:Bn.cloneNode();return sr.append(Fr),sr}):(this.container.className="linkAnnotation",jn&&this.container.append(Bn),this.container)}_bindLink(Fn,Hn){Fn.href=this.linkService.getDestinationHash(Hn),Fn.onclick=()=>(Hn&&this.linkService.goToDestination(Hn),!1),(Hn||Hn==="")&&es(this,_n,Yl).call(this)}_bindNamedAction(Fn,Hn){Fn.href=this.linkService.getAnchorUrl(""),Fn.onclick=()=>(this.linkService.executeNamedAction(Hn),!1),es(this,_n,Yl).call(this)}_bindAttachment(Fn,Hn){Fn.href=this.linkService.getAnchorUrl(""),Fn.onclick=()=>{var Bn;return(Bn=this.downloadManager)==null||Bn.openOrDownloadData(this.container,Hn.content,Hn.filename),!1},es(this,_n,Yl).call(this)}_bindJSAction(Fn,Hn){Fn.href=this.linkService.getAnchorUrl("");const Bn=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const jn of Object.keys(Hn.actions)){const sr=Bn.get(jn);sr&&(Fn[sr]=()=>{var Ar;return(Ar=this.linkService.eventBus)==null||Ar.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Hn.id,name:jn}}),!1})}Fn.onclick||(Fn.onclick=()=>!1),es(this,_n,Yl).call(this)}_bindResetFormAction(Fn,Hn){const Bn=Fn.onclick;if(Bn||(Fn.href=this.linkService.getAnchorUrl("")),es(this,_n,Yl).call(this),!this._fieldObjects){(0,kt.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Bn||(Fn.onclick=()=>!1);return}Fn.onclick=()=>{var jr;Bn==null||Bn();const{fields:jn,refs:sr,include:Ar}=Hn,Fr=[];if(jn.length!==0||sr.length!==0){const Mr=new Set(sr);for(const pr of jn){const Tr=this._fieldObjects[pr]||[];for(const{id:Hr}of Tr)Mr.add(Hr)}for(const pr of Object.values(this._fieldObjects))for(const Tr of pr)Mr.has(Tr.id)===Ar&&Fr.push(Tr)}else for(const Mr of Object.values(this._fieldObjects))Fr.push(...Mr);const Rr=this.annotationStorage,Qn=[];for(const Mr of Fr){const{id:pr}=Mr;switch(Qn.push(pr),Mr.type){case"text":{const Hr=Mr.defaultValue||"";Rr.setValue(pr,{value:Hr});break}case"checkbox":case"radiobutton":{const Hr=Mr.defaultValue===Mr.exportValues;Rr.setValue(pr,{value:Hr});break}case"combobox":case"listbox":{const Hr=Mr.defaultValue||"";Rr.setValue(pr,{value:Hr});break}default:continue}const Tr=document.querySelector(`[data-element-id="${pr}"]`);if(Tr){if(!Ht.has(Tr)){(0,kt.warn)(`_bindResetFormAction - element not allowed: ${pr}`);continue}}else continue;Tr.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((jr=this.linkService.eventBus)==null||jr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Qn,name:"ResetForm"}})),!1}}}_n=new WeakSet,Yl=function(){this.container.setAttribute("data-internal-link","")},Pn=new WeakSet,Dp=function(Fn,Hn){Fn.href=this.linkService.getAnchorUrl(""),Fn.onclick=()=>(this.linkService.executeSetOCGState(Hn),!1),es(this,_n,Yl).call(this)};class Kt extends Wt{constructor(kn){var Hn,Bn,jn;const Fn=!!(kn.data.hasPopup||(Hn=kn.data.titleObj)!=null&&Hn.str||(Bn=kn.data.contentsObj)!=null&&Bn.str||(jn=kn.data.richText)!=null&&jn.str);super(kn,{isRenderable:Fn})}render(){this.container.className="textAnnotation";const kn=document.createElement("img");return kn.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",kn.alt="[{{type}} Annotation]",kn.dataset.l10nId="text_annotation_type",kn.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(kn,this.data),this.container.append(kn),this.container}}class Xt extends Wt{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(kn){const{isWin:Fn,isMac:Hn}=kt.FeatureTest.platform;return Fn&&kn.ctrlKey||Hn&&kn.metaKey}_setEventListener(kn,Fn,Hn,Bn){Fn.includes("mouse")?kn.addEventListener(Fn,jn=>{var sr;(sr=this.linkService.eventBus)==null||sr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Hn,value:Bn(jn),shift:jn.shiftKey,modifier:this._getKeyModifier(jn)}})}):kn.addEventListener(Fn,jn=>{var sr;(sr=this.linkService.eventBus)==null||sr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Hn,value:Bn(jn)}})})}_setEventListeners(kn,Fn,Hn){var Bn;for(const[jn,sr]of Fn)(sr==="Action"||(Bn=this.data.actions)!=null&&Bn[sr])&&this._setEventListener(kn,jn,sr,Hn)}_setBackgroundColor(kn){const Fn=this.data.backgroundColor||null;kn.style.backgroundColor=Fn===null?"transparent":kt.Util.makeHexColor(Fn[0],Fn[1],Fn[2])}_setTextStyle(kn){const Fn=["left","center","right"],{fontColor:Hn}=this.data.defaultAppearanceData,Bn=this.data.defaultAppearanceData.fontSize||zt,jn=kn.style;let sr;const Ar=2,Fr=Rr=>Math.round(10*Rr)/10;if(this.data.multiLine){const Rr=Math.abs(this.data.rect[3]-this.data.rect[1]-Ar),Qn=Math.round(Rr/(kt.LINE_FACTOR*Bn))||1,jr=Rr/Qn;sr=Math.min(Bn,Fr(jr/kt.LINE_FACTOR))}else{const Rr=Math.abs(this.data.rect[3]-this.data.rect[1]-Ar);sr=Math.min(Bn,Fr(Rr/kt.LINE_FACTOR))}jn.fontSize=`calc(${sr}px * var(--scale-factor))`,jn.color=kt.Util.makeHexColor(Hn[0],Hn[1],Hn[2]),this.data.textAlignment!==null&&(jn.textAlign=Fn[this.data.textAlignment])}_setRequired(kn,Fn){Fn?kn.setAttribute("required",!0):kn.removeAttribute("required"),kn.setAttribute("aria-required",Fn)}}class Qt extends Xt{constructor(kn){const Fn=kn.renderForms||!kn.data.hasAppearance&&!!kn.data.fieldValue;super(kn,{isRenderable:Fn})}setPropertyOnSiblings(kn,Fn,Hn,Bn){const jn=this.annotationStorage;for(const sr of this._getElementsByName(kn.name,kn.id))sr.domElement&&(sr.domElement[Fn]=Hn),jn.setValue(sr.id,{[Bn]:Hn})}render(){var Bn;const kn=this.annotationStorage,Fn=this.data.id;this.container.className="textWidgetAnnotation";let Hn=null;if(this.renderForms){const jn=kn.getValue(Fn,{value:this.data.fieldValue});let sr=jn.formattedValue||jn.value||"";const Ar=kn.getValue(Fn,{charLimit:this.data.maxLen}).charLimit;Ar&&sr.length>Ar&&(sr=sr.slice(0,Ar));const Fr={userValue:sr,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(Hn=document.createElement("textarea"),Hn.textContent=sr,this.data.doNotScroll&&(Hn.style.overflowY="hidden")):(Hn=document.createElement("input"),Hn.type="text",Hn.setAttribute("value",sr),this.data.doNotScroll&&(Hn.style.overflowX="hidden")),Ht.add(Hn),Hn.setAttribute("data-element-id",Fn),Hn.disabled=this.data.readOnly,Hn.name=this.data.fieldName,Hn.tabIndex=Vt,this._setRequired(Hn,this.data.required),Ar&&(Hn.maxLength=Ar),Hn.addEventListener("input",Qn=>{kn.setValue(Fn,{value:Qn.target.value}),this.setPropertyOnSiblings(Hn,"value",Qn.target.value,"value")}),Hn.addEventListener("resetform",Qn=>{const jr=this.data.defaultFieldValue??"";Hn.value=Fr.userValue=jr,Fr.formattedValue=null});let Rr=Qn=>{const{formattedValue:jr}=Fr;jr!=null&&(Qn.target.value=jr),Qn.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Hn.addEventListener("focus",jr=>{const{target:Mr}=jr;Fr.userValue&&(Mr.value=Fr.userValue),Fr.lastCommittedValue=Mr.value,Fr.commitKey=1}),Hn.addEventListener("updatefromsandbox",jr=>{const Mr={value(pr){Fr.userValue=pr.detail.value??"",kn.setValue(Fn,{value:Fr.userValue.toString()}),pr.target.value=Fr.userValue},formattedValue(pr){const{formattedValue:Tr}=pr.detail;Fr.formattedValue=Tr,Tr!=null&&pr.target!==document.activeElement&&(pr.target.value=Tr),kn.setValue(Fn,{formattedValue:Tr})},selRange(pr){pr.target.setSelectionRange(...pr.detail.selRange)},charLimit:pr=>{var Zr;const{charLimit:Tr}=pr.detail,{target:Hr}=pr;if(Tr===0){Hr.removeAttribute("maxLength");return}Hr.setAttribute("maxLength",Tr);let Xr=Fr.userValue;!Xr||Xr.length<=Tr||(Xr=Xr.slice(0,Tr),Hr.value=Fr.userValue=Xr,kn.setValue(Fn,{value:Xr}),(Zr=this.linkService.eventBus)==null||Zr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Fn,name:"Keystroke",value:Xr,willCommit:!0,commitKey:1,selStart:Hr.selectionStart,selEnd:Hr.selectionEnd}}))}};this._dispatchEventFromSandbox(Mr,jr)}),Hn.addEventListener("keydown",jr=>{var Tr;Fr.commitKey=1;let Mr=-1;if(jr.key==="Escape"?Mr=0:jr.key==="Enter"&&!this.data.multiLine?Mr=2:jr.key==="Tab"&&(Fr.commitKey=3),Mr===-1)return;const{value:pr}=jr.target;Fr.lastCommittedValue!==pr&&(Fr.lastCommittedValue=pr,Fr.userValue=pr,(Tr=this.linkService.eventBus)==null||Tr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Fn,name:"Keystroke",value:pr,willCommit:!0,commitKey:Mr,selStart:jr.target.selectionStart,selEnd:jr.target.selectionEnd}}))});const Qn=Rr;Rr=null,Hn.addEventListener("blur",jr=>{var pr;if(!jr.relatedTarget)return;const{value:Mr}=jr.target;Fr.userValue=Mr,Fr.lastCommittedValue!==Mr&&((pr=this.linkService.eventBus)==null||pr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Fn,name:"Keystroke",value:Mr,willCommit:!0,commitKey:Fr.commitKey,selStart:jr.target.selectionStart,selEnd:jr.target.selectionEnd}})),Qn(jr)}),(Bn=this.data.actions)!=null&&Bn.Keystroke&&Hn.addEventListener("beforeinput",jr=>{var hr;Fr.lastCommittedValue=null;const{data:Mr,target:pr}=jr,{value:Tr,selectionStart:Hr,selectionEnd:Xr}=pr;let Zr=Hr,ur=Xr;switch(jr.inputType){case"deleteWordBackward":{const gr=Tr.substring(0,Hr).match(/\w*[^\w]*$/);gr&&(Zr-=gr[0].length);break}case"deleteWordForward":{const gr=Tr.substring(Hr).match(/^[^\w]*\w*/);gr&&(ur+=gr[0].length);break}case"deleteContentBackward":Hr===Xr&&(Zr-=1);break;case"deleteContentForward":Hr===Xr&&(ur+=1);break}jr.preventDefault(),(hr=this.linkService.eventBus)==null||hr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Fn,name:"Keystroke",value:Tr,change:Mr||"",willCommit:!1,selStart:Zr,selEnd:ur}})}),this._setEventListeners(Hn,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],jr=>jr.target.value)}if(Rr&&Hn.addEventListener("blur",Rr),this.data.comb){const jr=(this.data.rect[2]-this.data.rect[0])/Ar;Hn.classList.add("comb"),Hn.style.letterSpacing=`calc(${jr}px * var(--scale-factor) - 1ch)`}}else Hn=document.createElement("div"),Hn.textContent=this.data.fieldValue,Hn.style.verticalAlign="middle",Hn.style.display="table-cell";return this._setTextStyle(Hn),this._setBackgroundColor(Hn),this._setDefaultPropertiesFromJS(Hn),this.container.append(Hn),this.container}}class Jt extends Xt{constructor(kn){super(kn,{isRenderable:kn.renderForms})}render(){const kn=this.annotationStorage,Fn=this.data,Hn=Fn.id;let Bn=kn.getValue(Hn,{value:Fn.exportValue===Fn.fieldValue}).value;typeof Bn=="string"&&(Bn=Bn!=="Off",kn.setValue(Hn,{value:Bn})),this.container.className="buttonWidgetAnnotation checkBox";const jn=document.createElement("input");return Ht.add(jn),jn.setAttribute("data-element-id",Hn),jn.disabled=Fn.readOnly,this._setRequired(jn,this.data.required),jn.type="checkbox",jn.name=Fn.fieldName,Bn&&jn.setAttribute("checked",!0),jn.setAttribute("exportValue",Fn.exportValue),jn.tabIndex=Vt,jn.addEventListener("change",sr=>{const{name:Ar,checked:Fr}=sr.target;for(const Rr of this._getElementsByName(Ar,Hn)){const Qn=Fr&&Rr.exportValue===Fn.exportValue;Rr.domElement&&(Rr.domElement.checked=Qn),kn.setValue(Rr.id,{value:Qn})}kn.setValue(Hn,{value:Fr})}),jn.addEventListener("resetform",sr=>{const Ar=Fn.defaultFieldValue||"Off";sr.target.checked=Ar===Fn.exportValue}),this.enableScripting&&this.hasJSActions&&(jn.addEventListener("updatefromsandbox",sr=>{const Ar={value(Fr){Fr.target.checked=Fr.detail.value!=="Off",kn.setValue(Hn,{value:Fr.target.checked})}};this._dispatchEventFromSandbox(Ar,sr)}),this._setEventListeners(jn,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],sr=>sr.target.checked)),this._setBackgroundColor(jn),this._setDefaultPropertiesFromJS(jn),this.container.append(jn),this.container}}class Zt extends Xt{constructor(kn){super(kn,{isRenderable:kn.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const kn=this.annotationStorage,Fn=this.data,Hn=Fn.id;let Bn=kn.getValue(Hn,{value:Fn.fieldValue===Fn.buttonValue}).value;typeof Bn=="string"&&(Bn=Bn!==Fn.buttonValue,kn.setValue(Hn,{value:Bn}));const jn=document.createElement("input");if(Ht.add(jn),jn.setAttribute("data-element-id",Hn),jn.disabled=Fn.readOnly,this._setRequired(jn,this.data.required),jn.type="radio",jn.name=Fn.fieldName,Bn&&jn.setAttribute("checked",!0),jn.tabIndex=Vt,jn.addEventListener("change",sr=>{const{name:Ar,checked:Fr}=sr.target;for(const Rr of this._getElementsByName(Ar,Hn))kn.setValue(Rr.id,{value:!1});kn.setValue(Hn,{value:Fr})}),jn.addEventListener("resetform",sr=>{const Ar=Fn.defaultFieldValue;sr.target.checked=Ar!=null&&Ar===Fn.buttonValue}),this.enableScripting&&this.hasJSActions){const sr=Fn.buttonValue;jn.addEventListener("updatefromsandbox",Ar=>{const Fr={value:Rr=>{const Qn=sr===Rr.detail.value;for(const jr of this._getElementsByName(Rr.target.name)){const Mr=Qn&&jr.id===Hn;jr.domElement&&(jr.domElement.checked=Mr),kn.setValue(jr.id,{value:Mr})}}};this._dispatchEventFromSandbox(Fr,Ar)}),this._setEventListeners(jn,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ar=>Ar.target.checked)}return this._setBackgroundColor(jn),this._setDefaultPropertiesFromJS(jn),this.container.append(jn),this.container}}class sn extends Yt{constructor(kn){super(kn,{ignoreBorder:kn.data.hasAppearance})}render(){const kn=super.render();kn.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(kn.title=this.data.alternativeText);const Fn=kn.lastChild;return this.enableScripting&&this.hasJSActions&&Fn&&(this._setDefaultPropertiesFromJS(Fn),Fn.addEventListener("updatefromsandbox",Hn=>{this._dispatchEventFromSandbox({},Hn)})),kn}}class ln extends Xt{constructor(kn){super(kn,{isRenderable:kn.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const kn=this.annotationStorage,Fn=this.data.id,Hn=kn.getValue(Fn,{value:this.data.fieldValue}),Bn=document.createElement("select");Ht.add(Bn),Bn.setAttribute("data-element-id",Fn),Bn.disabled=this.data.readOnly,this._setRequired(Bn,this.data.required),Bn.name=this.data.fieldName,Bn.tabIndex=Vt;let jn=this.data.combo&&this.data.options.length>0;this.data.combo||(Bn.size=this.data.options.length,this.data.multiSelect&&(Bn.multiple=!0)),Bn.addEventListener("resetform",Qn=>{const jr=this.data.defaultFieldValue;for(const Mr of Bn.options)Mr.selected=Mr.value===jr});for(const Qn of this.data.options){const jr=document.createElement("option");jr.textContent=Qn.displayValue,jr.value=Qn.exportValue,Hn.value.includes(Qn.exportValue)&&(jr.setAttribute("selected",!0),jn=!1),Bn.append(jr)}let sr=null;if(jn){const Qn=document.createElement("option");Qn.value=" ",Qn.setAttribute("hidden",!0),Qn.setAttribute("selected",!0),Bn.prepend(Qn),sr=()=>{Qn.remove(),Bn.removeEventListener("input",sr),sr=null},Bn.addEventListener("input",sr)}const Ar=Qn=>{const jr=Qn?"value":"textContent",{options:Mr,multiple:pr}=Bn;return pr?Array.prototype.filter.call(Mr,Tr=>Tr.selected).map(Tr=>Tr[jr]):Mr.selectedIndex===-1?null:Mr[Mr.selectedIndex][jr]};let Fr=Ar(!1);const Rr=Qn=>{const jr=Qn.target.options;return Array.prototype.map.call(jr,Mr=>({displayValue:Mr.textContent,exportValue:Mr.value}))};return this.enableScripting&&this.hasJSActions?(Bn.addEventListener("updatefromsandbox",Qn=>{const jr={value(Mr){sr==null||sr();const pr=Mr.detail.value,Tr=new Set(Array.isArray(pr)?pr:[pr]);for(const Hr of Bn.options)Hr.selected=Tr.has(Hr.value);kn.setValue(Fn,{value:Ar(!0)}),Fr=Ar(!1)},multipleSelection(Mr){Bn.multiple=!0},remove(Mr){const pr=Bn.options,Tr=Mr.detail.remove;pr[Tr].selected=!1,Bn.remove(Tr),pr.length>0&&Array.prototype.findIndex.call(pr,Xr=>Xr.selected)===-1&&(pr[0].selected=!0),kn.setValue(Fn,{value:Ar(!0),items:Rr(Mr)}),Fr=Ar(!1)},clear(Mr){for(;Bn.length!==0;)Bn.remove(0);kn.setValue(Fn,{value:null,items:[]}),Fr=Ar(!1)},insert(Mr){const{index:pr,displayValue:Tr,exportValue:Hr}=Mr.detail.insert,Xr=Bn.children[pr],Zr=document.createElement("option");Zr.textContent=Tr,Zr.value=Hr,Xr?Xr.before(Zr):Bn.append(Zr),kn.setValue(Fn,{value:Ar(!0),items:Rr(Mr)}),Fr=Ar(!1)},items(Mr){const{items:pr}=Mr.detail;for(;Bn.length!==0;)Bn.remove(0);for(const Tr of pr){const{displayValue:Hr,exportValue:Xr}=Tr,Zr=document.createElement("option");Zr.textContent=Hr,Zr.value=Xr,Bn.append(Zr)}Bn.options.length>0&&(Bn.options[0].selected=!0),kn.setValue(Fn,{value:Ar(!0),items:Rr(Mr)}),Fr=Ar(!1)},indices(Mr){const pr=new Set(Mr.detail.indices);for(const Tr of Mr.target.options)Tr.selected=pr.has(Tr.index);kn.setValue(Fn,{value:Ar(!0)}),Fr=Ar(!1)},editable(Mr){Mr.target.disabled=!Mr.detail.editable}};this._dispatchEventFromSandbox(jr,Qn)}),Bn.addEventListener("input",Qn=>{var Mr;const jr=Ar(!0);kn.setValue(Fn,{value:jr}),Qn.preventDefault(),(Mr=this.linkService.eventBus)==null||Mr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Fn,name:"Keystroke",value:Fr,changeEx:jr,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Bn,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Qn=>Qn.target.value)):Bn.addEventListener("input",function(Qn){kn.setValue(Fn,{value:Ar(!0)})}),this.data.combo&&this._setTextStyle(Bn),this._setBackgroundColor(Bn),this._setDefaultPropertiesFromJS(Bn),this.container.append(Bn),this.container}}const Vn=class Vn extends Wt{constructor(kn){var Bn,jn,sr;const{data:Fn}=kn,Hn=!Vn.IGNORE_TYPES.has(Fn.parentType)&&!!((Bn=Fn.titleObj)!=null&&Bn.str||(jn=Fn.contentsObj)!=null&&jn.str||(sr=Fn.richText)!=null&&sr.str);super(kn,{isRenderable:Hn})}render(){this.container.className="popupAnnotation";const kn=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(kn.length===0)return this.container;const Fn=new hn({container:this.container,trigger:Array.from(kn),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),Hn=this.page,Bn=kt.Util.normalizeRect([this.data.parentRect[0],Hn.view[3]-this.data.parentRect[1]+Hn.view[1],this.data.parentRect[2],Hn.view[3]-this.data.parentRect[3]+Hn.view[1]]),jn=Bn[0]+this.data.parentRect[2]-this.data.parentRect[0],sr=Bn[1],{pageWidth:Ar,pageHeight:Fr,pageX:Rr,pageY:Qn}=this.viewport.rawDims;return this.container.style.left=`${100*(jn-Rr)/Ar}%`,this.container.style.top=`${100*(sr-Qn)/Fr}%`,this.container.append(Fn.render()),this.container}};so(Vn,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));let dn=Vn;class hn{constructor(kn){this.container=kn.container,this.trigger=kn.trigger,this.color=kn.color,this.titleObj=kn.titleObj,this.modificationDate=kn.modificationDate,this.contentsObj=kn.contentsObj,this.richText=kn.richText,this.hideWrapper=kn.hideWrapper||!1,this.pinned=!1}render(){var Ar,Fr;const Fn=document.createElement("div");Fn.className="popupWrapper",this.hideElement=this.hideWrapper?Fn:this.container,this.hideElement.hidden=!0;const Hn=document.createElement("div");Hn.className="popup";const Bn=this.color;if(Bn){const Rr=.7*(255-Bn[0])+Bn[0],Qn=.7*(255-Bn[1])+Bn[1],jr=.7*(255-Bn[2])+Bn[2];Hn.style.backgroundColor=kt.Util.makeHexColor(Rr|0,Qn|0,jr|0)}const jn=document.createElement("h1");jn.dir=this.titleObj.dir,jn.textContent=this.titleObj.str,Hn.append(jn);const sr=Mt.PDFDateString.toDateObject(this.modificationDate);if(sr){const Rr=document.createElement("span");Rr.className="popupDate",Rr.textContent="{{date}}, {{time}}",Rr.dataset.l10nId="annotation_date_string",Rr.dataset.l10nArgs=JSON.stringify({date:sr.toLocaleDateString(),time:sr.toLocaleTimeString()}),Hn.append(Rr)}if((Ar=this.richText)!=null&&Ar.str&&(!((Fr=this.contentsObj)!=null&&Fr.str)||this.contentsObj.str===this.richText.str))Bt.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:Hn}),Hn.lastChild.className="richText popupContent";else{const Rr=this._formatContents(this.contentsObj);Hn.append(Rr)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const Rr of this.trigger)Rr.addEventListener("click",this._toggle.bind(this)),Rr.addEventListener("mouseover",this._show.bind(this,!1)),Rr.addEventListener("mouseout",this._hide.bind(this,!1));return Hn.addEventListener("click",this._hide.bind(this,!0)),Fn.append(Hn),Fn}_formatContents({str:kn,dir:Fn}){const Hn=document.createElement("p");Hn.className="popupContent",Hn.dir=Fn;const Bn=kn.split(/(?:\r\n?|\n)/);for(let jn=0,sr=Bn.length;jn<sr;++jn){const Ar=Bn[jn];Hn.append(document.createTextNode(Ar)),jn<sr-1&&Hn.append(document.createElement("br"))}return Hn}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(kn=!1){kn&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(kn=!0){kn&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class cn extends Wt{constructor(kn){var Hn,Bn,jn;const Fn=!!(kn.data.hasPopup||(Hn=kn.data.titleObj)!=null&&Hn.str||(Bn=kn.data.contentsObj)!=null&&Bn.str||(jn=kn.data.richText)!=null&&jn.str);super(kn,{isRenderable:Fn,ignoreBorder:!0}),this.textContent=kn.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const kn=document.createElement("div");kn.className="annotationTextContent",kn.setAttribute("role","comment");for(const Fn of this.textContent){const Hn=document.createElement("span");Hn.textContent=Fn,kn.append(Hn)}this.container.append(kn)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class pn extends Wt{constructor(kn){var Hn,Bn,jn;const Fn=!!(kn.data.hasPopup||(Hn=kn.data.titleObj)!=null&&Hn.str||(Bn=kn.data.contentsObj)!=null&&Bn.str||(jn=kn.data.richText)!=null&&jn.str);super(kn,{isRenderable:Fn,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const kn=this.data,{width:Fn,height:Hn}=Gt(kn.rect),Bn=this.svgFactory.create(Fn,Hn,!0),jn=this.svgFactory.createElement("svg:line");return jn.setAttribute("x1",kn.rect[2]-kn.lineCoordinates[0]),jn.setAttribute("y1",kn.rect[3]-kn.lineCoordinates[1]),jn.setAttribute("x2",kn.rect[2]-kn.lineCoordinates[2]),jn.setAttribute("y2",kn.rect[3]-kn.lineCoordinates[3]),jn.setAttribute("stroke-width",kn.borderStyle.width||1),jn.setAttribute("stroke","transparent"),jn.setAttribute("fill","transparent"),Bn.append(jn),this.container.append(Bn),this._createPopup(jn,kn),this.container}}class yn extends Wt{constructor(kn){var Hn,Bn,jn;const Fn=!!(kn.data.hasPopup||(Hn=kn.data.titleObj)!=null&&Hn.str||(Bn=kn.data.contentsObj)!=null&&Bn.str||(jn=kn.data.richText)!=null&&jn.str);super(kn,{isRenderable:Fn,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const kn=this.data,{width:Fn,height:Hn}=Gt(kn.rect),Bn=this.svgFactory.create(Fn,Hn,!0),jn=kn.borderStyle.width,sr=this.svgFactory.createElement("svg:rect");return sr.setAttribute("x",jn/2),sr.setAttribute("y",jn/2),sr.setAttribute("width",Fn-jn),sr.setAttribute("height",Hn-jn),sr.setAttribute("stroke-width",jn||1),sr.setAttribute("stroke","transparent"),sr.setAttribute("fill","transparent"),Bn.append(sr),this.container.append(Bn),this._createPopup(sr,kn),this.container}}class gn extends Wt{constructor(kn){var Hn,Bn,jn;const Fn=!!(kn.data.hasPopup||(Hn=kn.data.titleObj)!=null&&Hn.str||(Bn=kn.data.contentsObj)!=null&&Bn.str||(jn=kn.data.richText)!=null&&jn.str);super(kn,{isRenderable:Fn,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const kn=this.data,{width:Fn,height:Hn}=Gt(kn.rect),Bn=this.svgFactory.create(Fn,Hn,!0),jn=kn.borderStyle.width,sr=this.svgFactory.createElement("svg:ellipse");return sr.setAttribute("cx",Fn/2),sr.setAttribute("cy",Hn/2),sr.setAttribute("rx",Fn/2-jn/2),sr.setAttribute("ry",Hn/2-jn/2),sr.setAttribute("stroke-width",jn||1),sr.setAttribute("stroke","transparent"),sr.setAttribute("fill","transparent"),Bn.append(sr),this.container.append(Bn),this._createPopup(sr,kn),this.container}}class En extends Wt{constructor(kn){var Hn,Bn,jn;const Fn=!!(kn.data.hasPopup||(Hn=kn.data.titleObj)!=null&&Hn.str||(Bn=kn.data.contentsObj)!=null&&Bn.str||(jn=kn.data.richText)!=null&&jn.str);super(kn,{isRenderable:Fn,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const kn=this.data,{width:Fn,height:Hn}=Gt(kn.rect),Bn=this.svgFactory.create(Fn,Hn,!0);let jn=[];for(const Ar of kn.vertices){const Fr=Ar.x-kn.rect[0],Rr=kn.rect[3]-Ar.y;jn.push(Fr+","+Rr)}jn=jn.join(" ");const sr=this.svgFactory.createElement(this.svgElementName);return sr.setAttribute("points",jn),sr.setAttribute("stroke-width",kn.borderStyle.width||1),sr.setAttribute("stroke","transparent"),sr.setAttribute("fill","transparent"),Bn.append(sr),this.container.append(Bn),this._createPopup(sr,kn),this.container}}class bn extends En{constructor(kn){super(kn),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class xn extends Wt{constructor(kn){var Hn,Bn,jn;const Fn=!!(kn.data.hasPopup||(Hn=kn.data.titleObj)!=null&&Hn.str||(Bn=kn.data.contentsObj)!=null&&Bn.str||(jn=kn.data.richText)!=null&&jn.str);super(kn,{isRenderable:Fn,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class Cn extends Wt{constructor(kn){var Hn,Bn,jn;const Fn=!!(kn.data.hasPopup||(Hn=kn.data.titleObj)!=null&&Hn.str||(Bn=kn.data.contentsObj)!=null&&Bn.str||(jn=kn.data.richText)!=null&&jn.str);super(kn,{isRenderable:Fn,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const kn=this.data,{width:Fn,height:Hn}=Gt(kn.rect),Bn=this.svgFactory.create(Fn,Hn,!0);for(const jn of kn.inkLists){let sr=[];for(const Fr of jn){const Rr=Fr.x-kn.rect[0],Qn=kn.rect[3]-Fr.y;sr.push(`${Rr},${Qn}`)}sr=sr.join(" ");const Ar=this.svgFactory.createElement(this.svgElementName);Ar.setAttribute("points",sr),Ar.setAttribute("stroke-width",kn.borderStyle.width||1),Ar.setAttribute("stroke","transparent"),Ar.setAttribute("fill","transparent"),this._createPopup(Ar,kn),Bn.append(Ar)}return this.container.append(Bn),this.container}}class $n extends Wt{constructor(kn){var Hn,Bn,jn;const Fn=!!(kn.data.hasPopup||(Hn=kn.data.titleObj)!=null&&Hn.str||(Bn=kn.data.contentsObj)!=null&&Bn.str||(jn=kn.data.richText)!=null&&jn.str);super(kn,{isRenderable:Fn,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class wn extends Wt{constructor(kn){var Hn,Bn,jn;const Fn=!!(kn.data.hasPopup||(Hn=kn.data.titleObj)!=null&&Hn.str||(Bn=kn.data.contentsObj)!=null&&Bn.str||(jn=kn.data.richText)!=null&&jn.str);super(kn,{isRenderable:Fn,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class Rn extends Wt{constructor(kn){var Hn,Bn,jn;const Fn=!!(kn.data.hasPopup||(Hn=kn.data.titleObj)!=null&&Hn.str||(Bn=kn.data.contentsObj)!=null&&Bn.str||(jn=kn.data.richText)!=null&&jn.str);super(kn,{isRenderable:Fn,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class Dn extends Wt{constructor(kn){var Hn,Bn,jn;const Fn=!!(kn.data.hasPopup||(Hn=kn.data.titleObj)!=null&&Hn.str||(Bn=kn.data.contentsObj)!=null&&Bn.str||(jn=kn.data.richText)!=null&&jn.str);super(kn,{isRenderable:Fn,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class An extends Wt{constructor(kn){var Hn,Bn,jn;const Fn=!!(kn.data.hasPopup||(Hn=kn.data.titleObj)!=null&&Hn.str||(Bn=kn.data.contentsObj)!=null&&Bn.str||(jn=kn.data.richText)!=null&&jn.str);super(kn,{isRenderable:Fn,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class Sn extends Wt{constructor(kn){var Bn;super(kn,{isRenderable:!0});const{filename:Fn,content:Hn}=this.data.file;this.filename=(0,Mt.getFilenameFromUrl)(Fn,!0),this.content=Hn,(Bn=this.linkService.eventBus)==null||Bn.dispatch("fileattachmentannotation",{source:this,filename:Fn,content:Hn})}render(){var Fn,Hn;this.container.className="fileAttachmentAnnotation";let kn;return this.data.hasAppearance?kn=document.createElement("div"):(kn=document.createElement("img"),kn.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),kn.className="popupTriggerArea",kn.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((Fn=this.data.titleObj)!=null&&Fn.str||(Hn=this.data.contentsObj)!=null&&Hn.str||this.data.richText)&&this._createPopup(kn,this.data),this.container.append(kn),this.container}_download(){var kn;(kn=this.downloadManager)==null||kn.openOrDownloadData(this.container,this.content,this.filename)}}const nr=class nr{static render(kn){var Fr,Rr;const{annotations:Fn,div:Hn,viewport:Bn,accessibilityManager:jn}=kn;(0,Mt.setLayerDimensions)(Hn,Bn);const sr={data:null,layer:Hn,page:kn.page,viewport:Bn,linkService:kn.linkService,downloadManager:kn.downloadManager,imageResourcesPath:kn.imageResourcesPath||"",renderForms:kn.renderForms!==!1,svgFactory:new Mt.DOMSVGFactory,annotationStorage:kn.annotationStorage||new Ft.AnnotationStorage,enableScripting:kn.enableScripting===!0,hasJSActions:kn.hasJSActions,fieldObjects:kn.fieldObjects};let Ar=0;for(const Qn of Fn){if(Qn.annotationType!==kt.AnnotationType.POPUP){const{width:pr,height:Tr}=Gt(Qn.rect);if(pr<=0||Tr<=0)continue}sr.data=Qn;const jr=qt.create(sr);if(!jr.isRenderable)continue;const Mr=jr.render();if(Qn.hidden&&(Mr.style.visibility="hidden"),Array.isArray(Mr))for(const pr of Mr)pr.style.zIndex=Ar++,es(Fr=nr,Un,Wu).call(Fr,pr,Qn.id,Hn,jn);else Mr.style.zIndex=Ar++,jr instanceof dn?Hn.prepend(Mr):es(Rr=nr,Un,Wu).call(Rr,Mr,Qn.id,Hn,jn)}es(this,rr,Yu).call(this,Hn,kn.annotationCanvasMap)}static update(kn){const{annotationCanvasMap:Fn,div:Hn,viewport:Bn}=kn;(0,Mt.setLayerDimensions)(Hn,{rotation:Bn.rotation}),es(this,rr,Yu).call(this,Hn,Fn),Hn.hidden=!1}};Un=new WeakSet,Wu=function(kn,Fn,Hn,Bn){const jn=kn.firstChild||kn;jn.id=`${Mt.AnnotationPrefix}${Fn}`,Hn.append(kn),Bn==null||Bn.moveElementInDOM(Hn,kn,jn,!1)},rr=new WeakSet,Yu=function(kn,Fn){if(Fn){for(const[Hn,Bn]of Fn){const jn=kn.querySelector(`[data-annotation-id="${Hn}"]`);if(!jn)continue;const{firstChild:sr}=jn;sr?sr.nodeName==="CANVAS"?sr.replaceWith(Bn):sr.before(Bn):jn.append(Bn)}Fn.clear()}},Yr(nr,Un),Yr(nr,rr);let vn=nr;$t.AnnotationLayer=vn},(xt,$t)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.ColorConverters=void 0;function Ct(Mt){return Math.floor(Math.max(0,Math.min(1,Mt))*255).toString(16).padStart(2,"0")}class kt{static CMYK_G([Ft,jt,Bt,Vt]){return["G",1-Math.min(1,.3*Ft+.59*Bt+.11*jt+Vt)]}static G_CMYK([Ft]){return["CMYK",0,0,0,1-Ft]}static G_RGB([Ft]){return["RGB",Ft,Ft,Ft]}static G_HTML([Ft]){const jt=Ct(Ft);return`#${jt}${jt}${jt}`}static RGB_G([Ft,jt,Bt]){return["G",.3*Ft+.59*jt+.11*Bt]}static RGB_HTML([Ft,jt,Bt]){const Vt=Ct(Ft),zt=Ct(jt),Ht=Ct(Bt);return`#${Vt}${zt}${Ht}`}static T_HTML(){return"#00000000"}static CMYK_RGB([Ft,jt,Bt,Vt]){return["RGB",1-Math.min(1,Ft+Vt),1-Math.min(1,Bt+Vt),1-Math.min(1,jt+Vt)]}static CMYK_HTML(Ft){const jt=this.CMYK_RGB(Ft).slice(1);return this.RGB_HTML(jt)}static RGB_CMYK([Ft,jt,Bt]){const Vt=1-Ft,zt=1-jt,Ht=1-Bt,Gt=Math.min(Vt,zt,Ht);return["CMYK",Vt,zt,Ht,Gt]}}$t.ColorConverters=kt},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.XfaLayer=void 0;var kt=Ct(19);class Mt{static setupStorage(jt,Bt,Vt,zt,Ht){const Gt=zt.getValue(Bt,{value:null});switch(Vt.name){case"textarea":if(Gt.value!==null&&(jt.textContent=Gt.value),Ht==="print")break;jt.addEventListener("input",qt=>{zt.setValue(Bt,{value:qt.target.value})});break;case"input":if(Vt.attributes.type==="radio"||Vt.attributes.type==="checkbox"){if(Gt.value===Vt.attributes.xfaOn?jt.setAttribute("checked",!0):Gt.value===Vt.attributes.xfaOff&&jt.removeAttribute("checked"),Ht==="print")break;jt.addEventListener("change",qt=>{zt.setValue(Bt,{value:qt.target.checked?qt.target.getAttribute("xfaOn"):qt.target.getAttribute("xfaOff")})})}else{if(Gt.value!==null&&jt.setAttribute("value",Gt.value),Ht==="print")break;jt.addEventListener("input",qt=>{zt.setValue(Bt,{value:qt.target.value})})}break;case"select":if(Gt.value!==null)for(const qt of Vt.children)qt.attributes.value===Gt.value&&(qt.attributes.selected=!0);jt.addEventListener("input",qt=>{const Wt=qt.target.options,Yt=Wt.selectedIndex===-1?"":Wt[Wt.selectedIndex].value;zt.setValue(Bt,{value:Yt})});break}}static setAttributes({html:jt,element:Bt,storage:Vt=null,intent:zt,linkService:Ht}){const{attributes:Gt}=Bt,qt=jt instanceof HTMLAnchorElement;Gt.type==="radio"&&(Gt.name=`${Gt.name}-${zt}`);for(const[Wt,Yt]of Object.entries(Gt))if(Yt!=null)switch(Wt){case"class":Yt.length&&jt.setAttribute(Wt,Yt.join(" "));break;case"dataId":break;case"id":jt.setAttribute("data-element-id",Yt);break;case"style":Object.assign(jt.style,Yt);break;case"textContent":jt.textContent=Yt;break;default:(!qt||Wt!=="href"&&Wt!=="newWindow")&&jt.setAttribute(Wt,Yt)}qt&&Ht.addLinkAttributes(jt,Gt.href,Gt.newWindow),Vt&&Gt.dataId&&this.setupStorage(jt,Gt.dataId,Bt,Vt)}static render(jt){var Kt;const Bt=jt.annotationStorage,Vt=jt.linkService,zt=jt.xfaHtml,Ht=jt.intent||"display",Gt=document.createElement(zt.name);zt.attributes&&this.setAttributes({html:Gt,element:zt,intent:Ht,linkService:Vt});const qt=[[zt,-1,Gt]],Wt=jt.div;if(Wt.append(Gt),jt.viewport){const Xt=`matrix(${jt.viewport.transform.join(",")})`;Wt.style.transform=Xt}Ht!=="richText"&&Wt.setAttribute("class","xfaLayer xfaFont");const Yt=[];for(;qt.length>0;){const[Xt,Qt,Jt]=qt.at(-1);if(Qt+1===Xt.children.length){qt.pop();continue}const Zt=Xt.children[++qt.at(-1)[1]];if(Zt===null)continue;const{name:sn}=Zt;if(sn==="#text"){const dn=document.createTextNode(Zt.value);Yt.push(dn),Jt.append(dn);continue}let ln;if((Kt=Zt==null?void 0:Zt.attributes)!=null&&Kt.xmlns?ln=document.createElementNS(Zt.attributes.xmlns,sn):ln=document.createElement(sn),Jt.append(ln),Zt.attributes&&this.setAttributes({html:ln,element:Zt,storage:Bt,intent:Ht,linkService:Vt}),Zt.children&&Zt.children.length>0)qt.push([Zt,-1,ln]);else if(Zt.value){const dn=document.createTextNode(Zt.value);kt.XfaText.shouldBuildText(sn)&&Yt.push(dn),ln.append(dn)}}for(const Xt of Wt.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))Xt.setAttribute("readOnly",!0);return{textDivs:Yt}}static update(jt){const Bt=`matrix(${jt.viewport.transform.join(",")})`;jt.div.style.transform=Bt,jt.div.hidden=!1}}$t.XfaLayer=Mt},(xt,$t,Ct)=>{Object.defineProperty($t,"__esModule",{value:!0}),$t.SVGGraphics=void 0;var kt=Ct(6),Mt=Ct(1),Ft=Ct(10);let jt=class{constructor(){(0,Mt.unreachable)("Not implemented: SVGGraphics")}};$t.SVGGraphics=jt;{let Jt=function(cn){let pn=[];const yn=[];for(const gn of cn){if(gn.fn==="save"){pn.push({fnId:92,fn:"group",items:[]}),yn.push(pn),pn=pn.at(-1).items;continue}gn.fn==="restore"?pn=yn.pop():pn.push(gn)}return pn},Zt=function(cn){if(Number.isInteger(cn))return cn.toString();const pn=cn.toFixed(10);let yn=pn.length-1;if(pn[yn]!=="0")return pn;do yn--;while(pn[yn]==="0");return pn.substring(0,pn[yn]==="."?yn:yn+1)},sn=function(cn){if(cn[4]===0&&cn[5]===0){if(cn[1]===0&&cn[2]===0)return cn[0]===1&&cn[3]===1?"":`scale(${Zt(cn[0])} ${Zt(cn[3])})`;if(cn[0]===cn[3]&&cn[1]===-cn[2]){const pn=Math.acos(cn[0])*180/Math.PI;return`rotate(${Zt(pn)})`}}else if(cn[0]===1&&cn[1]===0&&cn[2]===0&&cn[3]===1)return`translate(${Zt(cn[4])} ${Zt(cn[5])})`;return`matrix(${Zt(cn[0])} ${Zt(cn[1])} ${Zt(cn[2])} ${Zt(cn[3])} ${Zt(cn[4])} ${Zt(cn[5])})`};var Bt=Jt,Vt=Zt,zt=sn;const Ht={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},Gt="http://www.w3.org/XML/1998/namespace",qt="http://www.w3.org/1999/xlink",Wt=["butt","round","square"],Yt=["miter","round","bevel"],Kt=function(cn,pn="",yn=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!yn)return URL.createObjectURL(new Blob([cn],{type:pn}));const gn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let En=`data:${pn};base64,`;for(let bn=0,xn=cn.length;bn<xn;bn+=3){const Cn=cn[bn]&255,$n=cn[bn+1]&255,wn=cn[bn+2]&255,Rn=Cn>>2,Dn=(Cn&3)<<4|$n>>4,An=bn+1<xn?($n&15)<<2|wn>>6:64,Sn=bn+2<xn?wn&63:64;En+=gn[Rn]+gn[Dn]+gn[An]+gn[Sn]}return En},Xt=function(){const cn=new Uint8Array([137,80,78,71,13,10,26,10]),pn=12,yn=new Int32Array(256);for(let wn=0;wn<256;wn++){let Rn=wn;for(let Dn=0;Dn<8;Dn++)Rn&1?Rn=3988292384^Rn>>1&2147483647:Rn=Rn>>1&2147483647;yn[wn]=Rn}function gn(wn,Rn,Dn){let An=-1;for(let Sn=Rn;Sn<Dn;Sn++){const vn=(An^wn[Sn])&255,_n=yn[vn];An=An>>>8^_n}return An^-1}function En(wn,Rn,Dn,An){let Sn=An;const vn=Rn.length;Dn[Sn]=vn>>24&255,Dn[Sn+1]=vn>>16&255,Dn[Sn+2]=vn>>8&255,Dn[Sn+3]=vn&255,Sn+=4,Dn[Sn]=wn.charCodeAt(0)&255,Dn[Sn+1]=wn.charCodeAt(1)&255,Dn[Sn+2]=wn.charCodeAt(2)&255,Dn[Sn+3]=wn.charCodeAt(3)&255,Sn+=4,Dn.set(Rn,Sn),Sn+=Rn.length;const _n=gn(Dn,An+4,Sn);Dn[Sn]=_n>>24&255,Dn[Sn+1]=_n>>16&255,Dn[Sn+2]=_n>>8&255,Dn[Sn+3]=_n&255}function bn(wn,Rn,Dn){let An=1,Sn=0;for(let vn=Rn;vn<Dn;++vn)An=(An+(wn[vn]&255))%65521,Sn=(Sn+An)%65521;return Sn<<16|An}function xn(wn){if(!Ft.isNodeJS)return Cn(wn);try{let Rn;parseInt(process.versions.node)>=8?Rn=wn:Rn=Buffer.from(wn);const Dn=require$$0.deflateSync(Rn,{level:9});return Dn instanceof Uint8Array?Dn:new Uint8Array(Dn)}catch(Rn){(0,Mt.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Rn)}return Cn(wn)}function Cn(wn){let Rn=wn.length;const Dn=65535,An=Math.ceil(Rn/Dn),Sn=new Uint8Array(2+Rn+An*5+4);let vn=0;Sn[vn++]=120,Sn[vn++]=156;let _n=0;for(;Rn>Dn;)Sn[vn++]=0,Sn[vn++]=255,Sn[vn++]=255,Sn[vn++]=0,Sn[vn++]=0,Sn.set(wn.subarray(_n,_n+Dn),vn),vn+=Dn,_n+=Dn,Rn-=Dn;Sn[vn++]=1,Sn[vn++]=Rn&255,Sn[vn++]=Rn>>8&255,Sn[vn++]=~Rn&65535&255,Sn[vn++]=(~Rn&65535)>>8&255,Sn.set(wn.subarray(_n),vn),vn+=wn.length-_n;const Tn=bn(wn,0,wn.length);return Sn[vn++]=Tn>>24&255,Sn[vn++]=Tn>>16&255,Sn[vn++]=Tn>>8&255,Sn[vn++]=Tn&255,Sn}function $n(wn,Rn,Dn,An){const Sn=wn.width,vn=wn.height;let _n,Tn,Pn;const Ln=wn.data;switch(Rn){case Mt.ImageKind.GRAYSCALE_1BPP:Tn=0,_n=1,Pn=Sn+7>>3;break;case Mt.ImageKind.RGB_24BPP:Tn=2,_n=8,Pn=Sn*3;break;case Mt.ImageKind.RGBA_32BPP:Tn=6,_n=8,Pn=Sn*4;break;default:throw new Error("invalid format")}const Vn=new Uint8Array((1+Pn)*vn);let Un=0,Wn=0;for(let Fn=0;Fn<vn;++Fn)Vn[Un++]=0,Vn.set(Ln.subarray(Wn,Wn+Pn),Un),Wn+=Pn,Un+=Pn;if(Rn===Mt.ImageKind.GRAYSCALE_1BPP&&An){Un=0;for(let Fn=0;Fn<vn;Fn++){Un++;for(let Hn=0;Hn<Pn;Hn++)Vn[Un++]^=255}}const rr=new Uint8Array([Sn>>24&255,Sn>>16&255,Sn>>8&255,Sn&255,vn>>24&255,vn>>16&255,vn>>8&255,vn&255,_n,Tn,0,0,0]),ar=xn(Vn),nr=cn.length+pn*3+rr.length+ar.length,mr=new Uint8Array(nr);let kn=0;return mr.set(cn,kn),kn+=cn.length,En("IHDR",rr,mr,kn),kn+=pn+rr.length,En("IDATA",ar,mr,kn),kn+=pn+ar.length,En("IEND",new Uint8Array(0),mr,kn),Kt(mr,"image/png",Dn)}return function(Rn,Dn,An){const Sn=Rn.kind===void 0?Mt.ImageKind.GRAYSCALE_1BPP:Rn.kind;return $n(Rn,Sn,Dn,An)}}();class Qt{constructor(){this.fontSizeScale=1,this.fontWeight=Ht.fontWeight,this.fontSize=0,this.textMatrix=Mt.IDENTITY_MATRIX,this.fontMatrix=Mt.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=Mt.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=Ht.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(pn,yn){this.x=pn,this.y=yn}}let ln=0,dn=0,hn=0;$t.SVGGraphics=jt=class{constructor(cn,pn,yn=!1){(0,kt.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new kt.DOMSVGFactory,this.current=new Qt,this.transformMatrix=Mt.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=cn,this.objs=pn,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!yn,this._operatorIdMapping=[];for(const gn in Mt.OPS)this._operatorIdMapping[Mt.OPS[gn]]=gn}getObject(cn,pn=null){return typeof cn=="string"?cn.startsWith("g_")?this.commonObjs.get(cn):this.objs.get(cn):pn}save(){this.transformStack.push(this.transformMatrix);const cn=this.current;this.extraStack.push(cn),this.current=cn.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(cn){this.save(),this.executeOpTree(cn),this.restore()}loadDependencies(cn){const pn=cn.fnArray,yn=cn.argsArray;for(let gn=0,En=pn.length;gn<En;gn++)if(pn[gn]===Mt.OPS.dependency)for(const bn of yn[gn]){const xn=bn.startsWith("g_")?this.commonObjs:this.objs,Cn=new Promise($n=>{xn.get(bn,$n)});this.current.dependencies.push(Cn)}return Promise.all(this.current.dependencies)}transform(cn,pn,yn,gn,En,bn){const xn=[cn,pn,yn,gn,En,bn];this.transformMatrix=Mt.Util.transform(this.transformMatrix,xn),this.tgrp=null}getSVG(cn,pn){this.viewport=pn;const yn=this._initialize(pn);return this.loadDependencies(cn).then(()=>(this.transformMatrix=Mt.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(cn)),yn))}convertOpList(cn){const pn=this._operatorIdMapping,yn=cn.argsArray,gn=cn.fnArray,En=[];for(let bn=0,xn=gn.length;bn<xn;bn++){const Cn=gn[bn];En.push({fnId:Cn,fn:pn[Cn],args:yn[bn]})}return Jt(En)}executeOpTree(cn){for(const pn of cn){const yn=pn.fn,gn=pn.fnId,En=pn.args;switch(gn|0){case Mt.OPS.beginText:this.beginText();break;case Mt.OPS.dependency:break;case Mt.OPS.setLeading:this.setLeading(En);break;case Mt.OPS.setLeadingMoveText:this.setLeadingMoveText(En[0],En[1]);break;case Mt.OPS.setFont:this.setFont(En);break;case Mt.OPS.showText:this.showText(En[0]);break;case Mt.OPS.showSpacedText:this.showText(En[0]);break;case Mt.OPS.endText:this.endText();break;case Mt.OPS.moveText:this.moveText(En[0],En[1]);break;case Mt.OPS.setCharSpacing:this.setCharSpacing(En[0]);break;case Mt.OPS.setWordSpacing:this.setWordSpacing(En[0]);break;case Mt.OPS.setHScale:this.setHScale(En[0]);break;case Mt.OPS.setTextMatrix:this.setTextMatrix(En[0],En[1],En[2],En[3],En[4],En[5]);break;case Mt.OPS.setTextRise:this.setTextRise(En[0]);break;case Mt.OPS.setTextRenderingMode:this.setTextRenderingMode(En[0]);break;case Mt.OPS.setLineWidth:this.setLineWidth(En[0]);break;case Mt.OPS.setLineJoin:this.setLineJoin(En[0]);break;case Mt.OPS.setLineCap:this.setLineCap(En[0]);break;case Mt.OPS.setMiterLimit:this.setMiterLimit(En[0]);break;case Mt.OPS.setFillRGBColor:this.setFillRGBColor(En[0],En[1],En[2]);break;case Mt.OPS.setStrokeRGBColor:this.setStrokeRGBColor(En[0],En[1],En[2]);break;case Mt.OPS.setStrokeColorN:this.setStrokeColorN(En);break;case Mt.OPS.setFillColorN:this.setFillColorN(En);break;case Mt.OPS.shadingFill:this.shadingFill(En[0]);break;case Mt.OPS.setDash:this.setDash(En[0],En[1]);break;case Mt.OPS.setRenderingIntent:this.setRenderingIntent(En[0]);break;case Mt.OPS.setFlatness:this.setFlatness(En[0]);break;case Mt.OPS.setGState:this.setGState(En[0]);break;case Mt.OPS.fill:this.fill();break;case Mt.OPS.eoFill:this.eoFill();break;case Mt.OPS.stroke:this.stroke();break;case Mt.OPS.fillStroke:this.fillStroke();break;case Mt.OPS.eoFillStroke:this.eoFillStroke();break;case Mt.OPS.clip:this.clip("nonzero");break;case Mt.OPS.eoClip:this.clip("evenodd");break;case Mt.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case Mt.OPS.paintImageXObject:this.paintImageXObject(En[0]);break;case Mt.OPS.paintInlineImageXObject:this.paintInlineImageXObject(En[0]);break;case Mt.OPS.paintImageMaskXObject:this.paintImageMaskXObject(En[0]);break;case Mt.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(En[0],En[1]);break;case Mt.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case Mt.OPS.closePath:this.closePath();break;case Mt.OPS.closeStroke:this.closeStroke();break;case Mt.OPS.closeFillStroke:this.closeFillStroke();break;case Mt.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case Mt.OPS.nextLine:this.nextLine();break;case Mt.OPS.transform:this.transform(En[0],En[1],En[2],En[3],En[4],En[5]);break;case Mt.OPS.constructPath:this.constructPath(En[0],En[1]);break;case Mt.OPS.endPath:this.endPath();break;case 92:this.group(pn.items);break;default:(0,Mt.warn)(`Unimplemented operator ${yn}`);break}}}setWordSpacing(cn){this.current.wordSpacing=cn}setCharSpacing(cn){this.current.charSpacing=cn}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(cn,pn,yn,gn,En,bn){const xn=this.current;xn.textMatrix=xn.lineMatrix=[cn,pn,yn,gn,En,bn],xn.textMatrixScale=Math.hypot(cn,pn),xn.x=xn.lineX=0,xn.y=xn.lineY=0,xn.xcoords=[],xn.ycoords=[],xn.tspan=this.svgFactory.createElement("svg:tspan"),xn.tspan.setAttributeNS(null,"font-family",xn.fontFamily),xn.tspan.setAttributeNS(null,"font-size",`${Zt(xn.fontSize)}px`),xn.tspan.setAttributeNS(null,"y",Zt(-xn.y)),xn.txtElement=this.svgFactory.createElement("svg:text"),xn.txtElement.append(xn.tspan)}beginText(){const cn=this.current;cn.x=cn.lineX=0,cn.y=cn.lineY=0,cn.textMatrix=Mt.IDENTITY_MATRIX,cn.lineMatrix=Mt.IDENTITY_MATRIX,cn.textMatrixScale=1,cn.tspan=this.svgFactory.createElement("svg:tspan"),cn.txtElement=this.svgFactory.createElement("svg:text"),cn.txtgrp=this.svgFactory.createElement("svg:g"),cn.xcoords=[],cn.ycoords=[]}moveText(cn,pn){const yn=this.current;yn.x=yn.lineX+=cn,yn.y=yn.lineY+=pn,yn.xcoords=[],yn.ycoords=[],yn.tspan=this.svgFactory.createElement("svg:tspan"),yn.tspan.setAttributeNS(null,"font-family",yn.fontFamily),yn.tspan.setAttributeNS(null,"font-size",`${Zt(yn.fontSize)}px`),yn.tspan.setAttributeNS(null,"y",Zt(-yn.y))}showText(cn){const pn=this.current,yn=pn.font,gn=pn.fontSize;if(gn===0)return;const En=pn.fontSizeScale,bn=pn.charSpacing,xn=pn.wordSpacing,Cn=pn.fontDirection,$n=pn.textHScale*Cn,wn=yn.vertical,Rn=wn?1:-1,Dn=yn.defaultVMetrics,An=gn*pn.fontMatrix[0];let Sn=0;for(const Tn of cn){if(Tn===null){Sn+=Cn*xn;continue}else if(typeof Tn=="number"){Sn+=Rn*Tn*gn/1e3;continue}const Pn=(Tn.isSpace?xn:0)+bn,Ln=Tn.fontChar;let Vn,Un,Wn=Tn.width;if(wn){let ar;const nr=Tn.vmetric||Dn;ar=Tn.vmetric?nr[1]:Wn*.5,ar=-ar*An;const mr=nr[2]*An;Wn=nr?-nr[0]:Wn,Vn=ar/En,Un=(Sn+mr)/En}else Vn=Sn/En,Un=0;(Tn.isInFont||yn.missingFile)&&(pn.xcoords.push(pn.x+Vn),wn&&pn.ycoords.push(-pn.y+Un),pn.tspan.textContent+=Ln);let rr;wn?rr=Wn*An-Pn*Cn:rr=Wn*An+Pn*Cn,Sn+=rr}pn.tspan.setAttributeNS(null,"x",pn.xcoords.map(Zt).join(" ")),wn?pn.tspan.setAttributeNS(null,"y",pn.ycoords.map(Zt).join(" ")):pn.tspan.setAttributeNS(null,"y",Zt(-pn.y)),wn?pn.y-=Sn:pn.x+=Sn*$n,pn.tspan.setAttributeNS(null,"font-family",pn.fontFamily),pn.tspan.setAttributeNS(null,"font-size",`${Zt(pn.fontSize)}px`),pn.fontStyle!==Ht.fontStyle&&pn.tspan.setAttributeNS(null,"font-style",pn.fontStyle),pn.fontWeight!==Ht.fontWeight&&pn.tspan.setAttributeNS(null,"font-weight",pn.fontWeight);const vn=pn.textRenderingMode&Mt.TextRenderingMode.FILL_STROKE_MASK;if(vn===Mt.TextRenderingMode.FILL||vn===Mt.TextRenderingMode.FILL_STROKE?(pn.fillColor!==Ht.fillColor&&pn.tspan.setAttributeNS(null,"fill",pn.fillColor),pn.fillAlpha<1&&pn.tspan.setAttributeNS(null,"fill-opacity",pn.fillAlpha)):pn.textRenderingMode===Mt.TextRenderingMode.ADD_TO_PATH?pn.tspan.setAttributeNS(null,"fill","transparent"):pn.tspan.setAttributeNS(null,"fill","none"),vn===Mt.TextRenderingMode.STROKE||vn===Mt.TextRenderingMode.FILL_STROKE){const Tn=1/(pn.textMatrixScale||1);this._setStrokeAttributes(pn.tspan,Tn)}let _n=pn.textMatrix;pn.textRise!==0&&(_n=_n.slice(),_n[5]+=pn.textRise),pn.txtElement.setAttributeNS(null,"transform",`${sn(_n)} scale(${Zt($n)}, -1)`),pn.txtElement.setAttributeNS(Gt,"xml:space","preserve"),pn.txtElement.append(pn.tspan),pn.txtgrp.append(pn.txtElement),this._ensureTransformGroup().append(pn.txtElement)}setLeadingMoveText(cn,pn){this.setLeading(-pn),this.moveText(cn,pn)}addFontStyle(cn){if(!cn.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const pn=Kt(cn.data,cn.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${cn.loadedName}"; src: url(${pn}); }
`}setFont(cn){const pn=this.current,yn=this.commonObjs.get(cn[0]);let gn=cn[1];pn.font=yn,this.embedFonts&&!yn.missingFile&&!this.embeddedFonts[yn.loadedName]&&(this.addFontStyle(yn),this.embeddedFonts[yn.loadedName]=yn),pn.fontMatrix=yn.fontMatrix||Mt.FONT_IDENTITY_MATRIX;let En="normal";yn.black?En="900":yn.bold&&(En="bold");const bn=yn.italic?"italic":"normal";gn<0?(gn=-gn,pn.fontDirection=-1):pn.fontDirection=1,pn.fontSize=gn,pn.fontFamily=yn.loadedName,pn.fontWeight=En,pn.fontStyle=bn,pn.tspan=this.svgFactory.createElement("svg:tspan"),pn.tspan.setAttributeNS(null,"y",Zt(-pn.y)),pn.xcoords=[],pn.ycoords=[]}endText(){var pn;const cn=this.current;cn.textRenderingMode&Mt.TextRenderingMode.ADD_TO_PATH_FLAG&&((pn=cn.txtElement)!=null&&pn.hasChildNodes())&&(cn.element=cn.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(cn){cn>0&&(this.current.lineWidth=cn)}setLineCap(cn){this.current.lineCap=Wt[cn]}setLineJoin(cn){this.current.lineJoin=Yt[cn]}setMiterLimit(cn){this.current.miterLimit=cn}setStrokeAlpha(cn){this.current.strokeAlpha=cn}setStrokeRGBColor(cn,pn,yn){this.current.strokeColor=Mt.Util.makeHexColor(cn,pn,yn)}setFillAlpha(cn){this.current.fillAlpha=cn}setFillRGBColor(cn,pn,yn){this.current.fillColor=Mt.Util.makeHexColor(cn,pn,yn),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(cn){this.current.strokeColor=this._makeColorN_Pattern(cn)}setFillColorN(cn){this.current.fillColor=this._makeColorN_Pattern(cn)}shadingFill(cn){const pn=this.viewport.width,yn=this.viewport.height,gn=Mt.Util.inverseTransform(this.transformMatrix),En=Mt.Util.applyTransform([0,0],gn),bn=Mt.Util.applyTransform([0,yn],gn),xn=Mt.Util.applyTransform([pn,0],gn),Cn=Mt.Util.applyTransform([pn,yn],gn),$n=Math.min(En[0],bn[0],xn[0],Cn[0]),wn=Math.min(En[1],bn[1],xn[1],Cn[1]),Rn=Math.max(En[0],bn[0],xn[0],Cn[0]),Dn=Math.max(En[1],bn[1],xn[1],Cn[1]),An=this.svgFactory.createElement("svg:rect");An.setAttributeNS(null,"x",$n),An.setAttributeNS(null,"y",wn),An.setAttributeNS(null,"width",Rn-$n),An.setAttributeNS(null,"height",Dn-wn),An.setAttributeNS(null,"fill",this._makeShadingPattern(cn)),this.current.fillAlpha<1&&An.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(An)}_makeColorN_Pattern(cn){return cn[0]==="TilingPattern"?this._makeTilingPattern(cn):this._makeShadingPattern(cn)}_makeTilingPattern(cn){const pn=cn[1],yn=cn[2],gn=cn[3]||Mt.IDENTITY_MATRIX,[En,bn,xn,Cn]=cn[4],$n=cn[5],wn=cn[6],Rn=cn[7],Dn=`shading${hn++}`,[An,Sn,vn,_n]=Mt.Util.normalizeRect([...Mt.Util.applyTransform([En,bn],gn),...Mt.Util.applyTransform([xn,Cn],gn)]),[Tn,Pn]=Mt.Util.singularValueDecompose2dScale(gn),Ln=$n*Tn,Vn=wn*Pn,Un=this.svgFactory.createElement("svg:pattern");Un.setAttributeNS(null,"id",Dn),Un.setAttributeNS(null,"patternUnits","userSpaceOnUse"),Un.setAttributeNS(null,"width",Ln),Un.setAttributeNS(null,"height",Vn),Un.setAttributeNS(null,"x",`${An}`),Un.setAttributeNS(null,"y",`${Sn}`);const Wn=this.svg,rr=this.transformMatrix,ar=this.current.fillColor,nr=this.current.strokeColor,mr=this.svgFactory.create(vn-An,_n-Sn);if(this.svg=mr,this.transformMatrix=gn,Rn===2){const kn=Mt.Util.makeHexColor(...pn);this.current.fillColor=kn,this.current.strokeColor=kn}return this.executeOpTree(this.convertOpList(yn)),this.svg=Wn,this.transformMatrix=rr,this.current.fillColor=ar,this.current.strokeColor=nr,Un.append(mr.childNodes[0]),this.defs.append(Un),`url(#${Dn})`}_makeShadingPattern(cn){switch(typeof cn=="string"&&(cn=this.objs.get(cn)),cn[0]){case"RadialAxial":const pn=`shading${hn++}`,yn=cn[3];let gn;switch(cn[1]){case"axial":const En=cn[4],bn=cn[5];gn=this.svgFactory.createElement("svg:linearGradient"),gn.setAttributeNS(null,"id",pn),gn.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),gn.setAttributeNS(null,"x1",En[0]),gn.setAttributeNS(null,"y1",En[1]),gn.setAttributeNS(null,"x2",bn[0]),gn.setAttributeNS(null,"y2",bn[1]);break;case"radial":const xn=cn[4],Cn=cn[5],$n=cn[6],wn=cn[7];gn=this.svgFactory.createElement("svg:radialGradient"),gn.setAttributeNS(null,"id",pn),gn.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),gn.setAttributeNS(null,"cx",Cn[0]),gn.setAttributeNS(null,"cy",Cn[1]),gn.setAttributeNS(null,"r",wn),gn.setAttributeNS(null,"fx",xn[0]),gn.setAttributeNS(null,"fy",xn[1]),gn.setAttributeNS(null,"fr",$n);break;default:throw new Error(`Unknown RadialAxial type: ${cn[1]}`)}for(const En of yn){const bn=this.svgFactory.createElement("svg:stop");bn.setAttributeNS(null,"offset",En[0]),bn.setAttributeNS(null,"stop-color",En[1]),gn.append(bn)}return this.defs.append(gn),`url(#${pn})`;case"Mesh":return(0,Mt.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${cn[0]}`)}}setDash(cn,pn){this.current.dashArray=cn,this.current.dashPhase=pn}constructPath(cn,pn){const yn=this.current;let gn=yn.x,En=yn.y,bn=[],xn=0;for(const Cn of cn)switch(Cn|0){case Mt.OPS.rectangle:gn=pn[xn++],En=pn[xn++];const $n=pn[xn++],wn=pn[xn++],Rn=gn+$n,Dn=En+wn;bn.push("M",Zt(gn),Zt(En),"L",Zt(Rn),Zt(En),"L",Zt(Rn),Zt(Dn),"L",Zt(gn),Zt(Dn),"Z");break;case Mt.OPS.moveTo:gn=pn[xn++],En=pn[xn++],bn.push("M",Zt(gn),Zt(En));break;case Mt.OPS.lineTo:gn=pn[xn++],En=pn[xn++],bn.push("L",Zt(gn),Zt(En));break;case Mt.OPS.curveTo:gn=pn[xn+4],En=pn[xn+5],bn.push("C",Zt(pn[xn]),Zt(pn[xn+1]),Zt(pn[xn+2]),Zt(pn[xn+3]),Zt(gn),Zt(En)),xn+=6;break;case Mt.OPS.curveTo2:bn.push("C",Zt(gn),Zt(En),Zt(pn[xn]),Zt(pn[xn+1]),Zt(pn[xn+2]),Zt(pn[xn+3])),gn=pn[xn+2],En=pn[xn+3],xn+=4;break;case Mt.OPS.curveTo3:gn=pn[xn+2],En=pn[xn+3],bn.push("C",Zt(pn[xn]),Zt(pn[xn+1]),Zt(gn),Zt(En),Zt(gn),Zt(En)),xn+=4;break;case Mt.OPS.closePath:bn.push("Z");break}bn=bn.join(" "),yn.path&&cn.length>0&&cn[0]!==Mt.OPS.rectangle&&cn[0]!==Mt.OPS.moveTo?bn=yn.path.getAttributeNS(null,"d")+bn:(yn.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(yn.path)),yn.path.setAttributeNS(null,"d",bn),yn.path.setAttributeNS(null,"fill","none"),yn.element=yn.path,yn.setCurrentPoint(gn,En)}endPath(){const cn=this.current;if(cn.path=null,!this.pendingClip)return;if(!cn.element){this.pendingClip=null;return}const pn=`clippath${ln++}`,yn=this.svgFactory.createElement("svg:clipPath");yn.setAttributeNS(null,"id",pn),yn.setAttributeNS(null,"transform",sn(this.transformMatrix));const gn=cn.element.cloneNode(!0);if(this.pendingClip==="evenodd"?gn.setAttributeNS(null,"clip-rule","evenodd"):gn.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,yn.append(gn),this.defs.append(yn),cn.activeClipUrl){cn.clipGroup=null;for(const En of this.extraStack)En.clipGroup=null;yn.setAttributeNS(null,"clip-path",cn.activeClipUrl)}cn.activeClipUrl=`url(#${pn})`,this.tgrp=null}clip(cn){this.pendingClip=cn}closePath(){const cn=this.current;if(cn.path){const pn=`${cn.path.getAttributeNS(null,"d")}Z`;cn.path.setAttributeNS(null,"d",pn)}}setLeading(cn){this.current.leading=-cn}setTextRise(cn){this.current.textRise=cn}setTextRenderingMode(cn){this.current.textRenderingMode=cn}setHScale(cn){this.current.textHScale=cn/100}setRenderingIntent(cn){}setFlatness(cn){}setGState(cn){for(const[pn,yn]of cn)switch(pn){case"LW":this.setLineWidth(yn);break;case"LC":this.setLineCap(yn);break;case"LJ":this.setLineJoin(yn);break;case"ML":this.setMiterLimit(yn);break;case"D":this.setDash(yn[0],yn[1]);break;case"RI":this.setRenderingIntent(yn);break;case"FL":this.setFlatness(yn);break;case"Font":this.setFont(yn);break;case"CA":this.setStrokeAlpha(yn);break;case"ca":this.setFillAlpha(yn);break;default:(0,Mt.warn)(`Unimplemented graphic state operator ${pn}`);break}}fill(){const cn=this.current;cn.element&&(cn.element.setAttributeNS(null,"fill",cn.fillColor),cn.element.setAttributeNS(null,"fill-opacity",cn.fillAlpha),this.endPath())}stroke(){const cn=this.current;cn.element&&(this._setStrokeAttributes(cn.element),cn.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(cn,pn=1){const yn=this.current;let gn=yn.dashArray;pn!==1&&gn.length>0&&(gn=gn.map(function(En){return pn*En})),cn.setAttributeNS(null,"stroke",yn.strokeColor),cn.setAttributeNS(null,"stroke-opacity",yn.strokeAlpha),cn.setAttributeNS(null,"stroke-miterlimit",Zt(yn.miterLimit)),cn.setAttributeNS(null,"stroke-linecap",yn.lineCap),cn.setAttributeNS(null,"stroke-linejoin",yn.lineJoin),cn.setAttributeNS(null,"stroke-width",Zt(pn*yn.lineWidth)+"px"),cn.setAttributeNS(null,"stroke-dasharray",gn.map(Zt).join(" ")),cn.setAttributeNS(null,"stroke-dashoffset",Zt(pn*yn.dashPhase)+"px")}eoFill(){var cn;(cn=this.current.element)==null||cn.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var cn;(cn=this.current.element)==null||cn.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const cn=this.svgFactory.createElement("svg:rect");cn.setAttributeNS(null,"x","0"),cn.setAttributeNS(null,"y","0"),cn.setAttributeNS(null,"width","1px"),cn.setAttributeNS(null,"height","1px"),cn.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(cn)}paintImageXObject(cn){const pn=this.getObject(cn);if(!pn){(0,Mt.warn)(`Dependent image with object ID ${cn} is not ready yet`);return}this.paintInlineImageXObject(pn)}paintInlineImageXObject(cn,pn){const yn=cn.width,gn=cn.height,En=Xt(cn,this.forceDataSchema,!!pn),bn=this.svgFactory.createElement("svg:rect");bn.setAttributeNS(null,"x","0"),bn.setAttributeNS(null,"y","0"),bn.setAttributeNS(null,"width",Zt(yn)),bn.setAttributeNS(null,"height",Zt(gn)),this.current.element=bn,this.clip("nonzero");const xn=this.svgFactory.createElement("svg:image");xn.setAttributeNS(qt,"xlink:href",En),xn.setAttributeNS(null,"x","0"),xn.setAttributeNS(null,"y",Zt(-gn)),xn.setAttributeNS(null,"width",Zt(yn)+"px"),xn.setAttributeNS(null,"height",Zt(gn)+"px"),xn.setAttributeNS(null,"transform",`scale(${Zt(1/yn)} ${Zt(-1/gn)})`),pn?pn.append(xn):this._ensureTransformGroup().append(xn)}paintImageMaskXObject(cn){const pn=this.getObject(cn.data,cn);if(pn.bitmap){(0,Mt.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const yn=this.current,gn=pn.width,En=pn.height,bn=yn.fillColor;yn.maskId=`mask${dn++}`;const xn=this.svgFactory.createElement("svg:mask");xn.setAttributeNS(null,"id",yn.maskId);const Cn=this.svgFactory.createElement("svg:rect");Cn.setAttributeNS(null,"x","0"),Cn.setAttributeNS(null,"y","0"),Cn.setAttributeNS(null,"width",Zt(gn)),Cn.setAttributeNS(null,"height",Zt(En)),Cn.setAttributeNS(null,"fill",bn),Cn.setAttributeNS(null,"mask",`url(#${yn.maskId})`),this.defs.append(xn),this._ensureTransformGroup().append(Cn),this.paintInlineImageXObject(pn,xn)}paintFormXObjectBegin(cn,pn){if(Array.isArray(cn)&&cn.length===6&&this.transform(cn[0],cn[1],cn[2],cn[3],cn[4],cn[5]),pn){const yn=pn[2]-pn[0],gn=pn[3]-pn[1],En=this.svgFactory.createElement("svg:rect");En.setAttributeNS(null,"x",pn[0]),En.setAttributeNS(null,"y",pn[1]),En.setAttributeNS(null,"width",Zt(yn)),En.setAttributeNS(null,"height",Zt(gn)),this.current.element=En,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(cn){const pn=this.svgFactory.create(cn.width,cn.height),yn=this.svgFactory.createElement("svg:defs");pn.append(yn),this.defs=yn;const gn=this.svgFactory.createElement("svg:g");return gn.setAttributeNS(null,"transform",sn(cn.transform)),pn.append(gn),this.svg=gn,pn}_ensureClipGroup(){if(!this.current.clipGroup){const cn=this.svgFactory.createElement("svg:g");cn.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(cn),this.current.clipGroup=cn}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",sn(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(xt){var $t=__webpack_module_cache__[xt];if($t!==void 0)return $t.exports;var Ct=__webpack_module_cache__[xt]={exports:{}};return __webpack_modules__[xt](Ct,Ct.exports,__w_pdfjs_require__),Ct.exports}var __webpack_exports__={};return(()=>{var xt=__webpack_exports__;Object.defineProperty(xt,"__esModule",{value:!0}),Object.defineProperty(xt,"AbortException",{enumerable:!0,get:function(){return $t.AbortException}}),Object.defineProperty(xt,"AnnotationEditorLayer",{enumerable:!0,get:function(){return Ft.AnnotationEditorLayer}}),Object.defineProperty(xt,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return $t.AnnotationEditorParamsType}}),Object.defineProperty(xt,"AnnotationEditorType",{enumerable:!0,get:function(){return $t.AnnotationEditorType}}),Object.defineProperty(xt,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return jt.AnnotationEditorUIManager}}),Object.defineProperty(xt,"AnnotationLayer",{enumerable:!0,get:function(){return Bt.AnnotationLayer}}),Object.defineProperty(xt,"AnnotationMode",{enumerable:!0,get:function(){return $t.AnnotationMode}}),Object.defineProperty(xt,"CMapCompressionType",{enumerable:!0,get:function(){return $t.CMapCompressionType}}),Object.defineProperty(xt,"FeatureTest",{enumerable:!0,get:function(){return $t.FeatureTest}}),Object.defineProperty(xt,"GlobalWorkerOptions",{enumerable:!0,get:function(){return Vt.GlobalWorkerOptions}}),Object.defineProperty(xt,"InvalidPDFException",{enumerable:!0,get:function(){return $t.InvalidPDFException}}),Object.defineProperty(xt,"MissingPDFException",{enumerable:!0,get:function(){return $t.MissingPDFException}}),Object.defineProperty(xt,"OPS",{enumerable:!0,get:function(){return $t.OPS}}),Object.defineProperty(xt,"PDFDataRangeTransport",{enumerable:!0,get:function(){return Ct.PDFDataRangeTransport}}),Object.defineProperty(xt,"PDFDateString",{enumerable:!0,get:function(){return kt.PDFDateString}}),Object.defineProperty(xt,"PDFWorker",{enumerable:!0,get:function(){return Ct.PDFWorker}}),Object.defineProperty(xt,"PasswordResponses",{enumerable:!0,get:function(){return $t.PasswordResponses}}),Object.defineProperty(xt,"PermissionFlag",{enumerable:!0,get:function(){return $t.PermissionFlag}}),Object.defineProperty(xt,"PixelsPerInch",{enumerable:!0,get:function(){return kt.PixelsPerInch}}),Object.defineProperty(xt,"RenderingCancelledException",{enumerable:!0,get:function(){return kt.RenderingCancelledException}}),Object.defineProperty(xt,"SVGGraphics",{enumerable:!0,get:function(){return zt.SVGGraphics}}),Object.defineProperty(xt,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return $t.UNSUPPORTED_FEATURES}}),Object.defineProperty(xt,"UnexpectedResponseException",{enumerable:!0,get:function(){return $t.UnexpectedResponseException}}),Object.defineProperty(xt,"Util",{enumerable:!0,get:function(){return $t.Util}}),Object.defineProperty(xt,"VerbosityLevel",{enumerable:!0,get:function(){return $t.VerbosityLevel}}),Object.defineProperty(xt,"XfaLayer",{enumerable:!0,get:function(){return Ht.XfaLayer}}),Object.defineProperty(xt,"build",{enumerable:!0,get:function(){return Ct.build}}),Object.defineProperty(xt,"createPromiseCapability",{enumerable:!0,get:function(){return $t.createPromiseCapability}}),Object.defineProperty(xt,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return $t.createValidAbsoluteUrl}}),Object.defineProperty(xt,"getDocument",{enumerable:!0,get:function(){return Ct.getDocument}}),Object.defineProperty(xt,"getFilenameFromUrl",{enumerable:!0,get:function(){return kt.getFilenameFromUrl}}),Object.defineProperty(xt,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return kt.getPdfFilenameFromUrl}}),Object.defineProperty(xt,"getXfaPageViewport",{enumerable:!0,get:function(){return kt.getXfaPageViewport}}),Object.defineProperty(xt,"isDataScheme",{enumerable:!0,get:function(){return kt.isDataScheme}}),Object.defineProperty(xt,"isPdfFile",{enumerable:!0,get:function(){return kt.isPdfFile}}),Object.defineProperty(xt,"loadScript",{enumerable:!0,get:function(){return kt.loadScript}}),Object.defineProperty(xt,"renderTextLayer",{enumerable:!0,get:function(){return Mt.renderTextLayer}}),Object.defineProperty(xt,"setLayerDimensions",{enumerable:!0,get:function(){return kt.setLayerDimensions}}),Object.defineProperty(xt,"shadow",{enumerable:!0,get:function(){return $t.shadow}}),Object.defineProperty(xt,"updateTextLayer",{enumerable:!0,get:function(){return Mt.updateTextLayer}}),Object.defineProperty(xt,"version",{enumerable:!0,get:function(){return Ct.version}});var $t=__w_pdfjs_require__(1),Ct=__w_pdfjs_require__(2),kt=__w_pdfjs_require__(6),Mt=__w_pdfjs_require__(26),Ft=__w_pdfjs_require__(27),jt=__w_pdfjs_require__(5),Bt=__w_pdfjs_require__(32),Vt=__w_pdfjs_require__(14),zt=__w_pdfjs_require__(35),Ht=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;(function(xt){var $t=reactExports,Ct=pdfExports;function kt(Nn){var qn=Object.create(null);return Nn&&Object.keys(Nn).forEach(function(fr){if(fr!=="default"){var yr=Object.getOwnPropertyDescriptor(Nn,fr);Object.defineProperty(qn,fr,yr.get?yr:{enumerable:!0,get:function(){return Nn[fr]}})}}),qn.default=Nn,Object.freeze(qn)}var Mt,Ft=kt($t),jt=kt(Ct);xt.AnnotationType=void 0,(Mt=xt.AnnotationType||(xt.AnnotationType={}))[Mt.Text=1]="Text",Mt[Mt.Link=2]="Link",Mt[Mt.FreeText=3]="FreeText",Mt[Mt.Line=4]="Line",Mt[Mt.Square=5]="Square",Mt[Mt.Circle=6]="Circle",Mt[Mt.Polygon=7]="Polygon",Mt[Mt.Polyline=8]="Polyline",Mt[Mt.Highlight=9]="Highlight",Mt[Mt.Underline=10]="Underline",Mt[Mt.Squiggly=11]="Squiggly",Mt[Mt.StrikeOut=12]="StrikeOut",Mt[Mt.Stamp=13]="Stamp",Mt[Mt.Caret=14]="Caret",Mt[Mt.Ink=15]="Ink",Mt[Mt.Popup=16]="Popup",Mt[Mt.FileAttachment=17]="FileAttachment";var Bt=function(Nn,qn){return Bt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(fr,yr){fr.__proto__=yr}||function(fr,yr){for(var Er in yr)Object.prototype.hasOwnProperty.call(yr,Er)&&(fr[Er]=yr[Er])},Bt(Nn,qn)};function Vt(Nn,qn){if(typeof qn!="function"&&qn!==null)throw new TypeError("Class extends value "+String(qn)+" is not a constructor or null");function fr(){this.constructor=Nn}Bt(Nn,qn),Nn.prototype=qn===null?Object.create(qn):(fr.prototype=qn.prototype,new fr)}var zt,Ht=function(){return Ht=Object.assign||function(Nn){for(var qn,fr=1,yr=arguments.length;fr<yr;fr++)for(var Er in qn=arguments[fr])Object.prototype.hasOwnProperty.call(qn,Er)&&(Nn[Er]=qn[Er]);return Nn},Ht.apply(this,arguments)};xt.TextDirection=void 0,(zt=xt.TextDirection||(xt.TextDirection={})).RightToLeft="RTL",zt.LeftToRight="LTR";var Gt,qt=Ft.createContext({currentTheme:"light",direction:xt.TextDirection.LeftToRight,setCurrentTheme:function(){}}),Wt=function(Nn){var qn=[];return Object.keys(Nn).forEach(function(fr){fr&&Nn[fr]&&qn.push(fr)}),qn.join(" ")},Yt=typeof window<"u"?Ft.useLayoutEffect:Ft.useEffect,Kt=function(Nn){var qn=Ft.useRef(null),fr=Nn.once,yr=Nn.threshold,Er=Nn.onVisibilityChanged;return Yt(function(){var Sr=qn.current;if(Sr){var Dr=new IntersectionObserver(function(Ir){Ir.forEach(function(Mn){var zn=Mn.isIntersecting,er=Mn.intersectionRatio;Er({isVisible:zn,ratio:er}),zn&&fr&&(Dr.unobserve(Sr),Dr.disconnect())})},{threshold:yr||0});return Dr.observe(Sr),function(){Dr.unobserve(Sr),Dr.disconnect()}}},[]),qn},Xt=function(Nn){var qn=Nn.children,fr=Nn.ignoreDirection,yr=fr!==void 0&&fr,Er=Nn.size,Sr=Er===void 0?24:Er,Dr=Ft.useContext(qt).direction,Ir=!yr&&Dr===xt.TextDirection.RightToLeft,Mn="".concat(Sr||24,"px");return Ft.createElement("svg",{"aria-hidden":"true",className:Wt({"rpv-core__icon":!0,"rpv-core__icon--rtl":Ir}),focusable:"false",height:Mn,viewBox:"0 0 24 24",width:Mn},qn)},Qt=function(){return Ft.createElement(Xt,{size:16},Ft.createElement("path",{d:"M23.5,0.499l-16.5,23l-6.5-6.5"}))},Jt=function(Nn){var qn=Nn.children,fr=Nn.testId,yr=Nn.onClick,Er=Ft.useContext(qt).direction===xt.TextDirection.RightToLeft,Sr=fr?{"data-testid":fr}:{};return Ft.createElement("button",Ht({className:Wt({"rpv-core__primary-button":!0,"rpv-core__primary-button--rtl":Er}),type:"button",onClick:yr},Sr),qn)},Zt=function(Nn){var qn=Nn.size,fr=qn===void 0?"4rem":qn,yr=Nn.testId,Er=Ft.useState(!1),Sr=Er[0],Dr=Er[1],Ir=yr?{"data-testid":yr}:{},Mn=Kt({onVisibilityChanged:function(zn){Dr(zn.isVisible)}});return Ft.createElement("div",Ht({},Ir,{className:Wt({"rpv-core__spinner":!0,"rpv-core__spinner--animating":Sr}),ref:Mn,style:{height:fr,width:fr}}))},sn=function(Nn){var qn=Nn.ariaLabel,fr=qn===void 0?"":qn,yr=Nn.autoFocus,Er=yr!==void 0&&yr,Sr=Nn.placeholder,Dr=Sr===void 0?"":Sr,Ir=Nn.testId,Mn=Nn.type,zn=Mn===void 0?"text":Mn,er=Nn.value,Nr=er===void 0?"":er,Vr=Nn.onChange,Ur=Nn.onKeyDown,_i=Ur===void 0?function(){}:Ur,Kr=Ft.useContext(qt).direction,Qr=Ft.useRef(),$s=Kr===xt.TextDirection.RightToLeft,ys={ref:Qr,"data-testid":"","aria-label":fr,className:Wt({"rpv-core__textbox":!0,"rpv-core__textbox--rtl":$s}),placeholder:Dr,value:Nr,onChange:function(ws){return Vr(ws.target.value)},onKeyDown:_i};return Ir&&(ys["data-testid"]=Ir),Yt(function(){if(Er){var ws=Qr.current;if(ws){var Rs=window.scrollX,Es=window.scrollY;ws.focus(),window.scrollTo(Rs,Es)}}},[]),zn==="text"?Ft.createElement("input",Ht({type:"text"},ys)):Ft.createElement("input",Ht({type:"password"},ys))};(function(Nn){Nn[Nn.ExitFullScreen=0]="ExitFullScreen",Nn[Nn.FullScreenChange=1]="FullScreenChange",Nn[Nn.FullScreenElement=2]="FullScreenElement",Nn[Nn.FullScreenEnabled=3]="FullScreenEnabled",Nn[Nn.RequestFullScreen=4]="RequestFullScreen"})(Gt||(Gt={}));var ln,dn={ExitFullScreen:"exitFullscreen",FullScreenChange:"fullscreenchange",FullScreenElement:"fullscreenElement",FullScreenEnabled:"fullscreenEnabled",RequestFullScreen:"requestFullscreen"},hn={ExitFullScreen:"webkitExitFullscreen",FullScreenChange:"webkitfullscreenchange",FullScreenElement:"webkitFullscreenElement",FullScreenEnabled:"webkitFullscreenEnabled",RequestFullScreen:"webkitRequestFullscreen"},cn={ExitFullScreen:"msExitFullscreen",FullScreenChange:"msFullscreenChange",FullScreenElement:"msFullscreenElement",FullScreenEnabled:"msFullscreenEnabled",RequestFullScreen:"msRequestFullscreen"},pn=typeof window<"u",yn=pn&&(Gt.FullScreenEnabled in document&&dn||hn.FullScreenEnabled in document&&hn||cn.FullScreenEnabled in document&&cn)||dn,gn=function(){return pn&&yn.FullScreenEnabled in document&&document[yn.FullScreenEnabled]===!0},En=function(Nn){return pn?Nn[yn.ExitFullScreen]():Promise.resolve({})},bn=function(){return pn?document[yn.FullScreenElement]:null},xn=function(Nn,qn){var fr=Ft.useRef(),yr=function(){fr.current&&clearTimeout(fr.current)};return Ft.useEffect(function(){return function(){return yr()}},[]),Ft.useCallback(function(){for(var Er=[],Sr=0;Sr<arguments.length;Sr++)Er[Sr]=arguments[Sr];yr(),fr.current=setTimeout(function(){Nn.apply(void 0,Er)},qn)},[Nn,qn])},Cn=function(){var Nn=Ft.useRef(!1);return Ft.useEffect(function(){return Nn.current=!0,function(){Nn.current=!1}},[]),Nn},$n=function(Nn){var qn=Ft.useRef(Nn);return Ft.useEffect(function(){qn.current=Nn},[Nn]),qn.current};(function(Nn){Nn.NotRenderedYet="NotRenderedYet",Nn.Rendering="Rendering",Nn.Rendered="Rendered"})(ln||(ln={}));var wn,Rn=-9999,Dn=function(Nn){var qn=Nn.doc,fr=qn.numPages,yr=qn.loadingTask.docId,Er=Ft.useMemo(function(){return Array(fr).fill(null).map(function(Ir,Mn){return{pageIndex:Mn,renderStatus:ln.NotRenderedYet,visibility:Rn}})},[yr]),Sr=Ft.useRef({currentRenderingPage:-1,startRange:0,endRange:fr-1,visibilities:Er}),Dr=function(Ir,Mn){Sr.current.visibilities[Ir].visibility=Mn};return{getHighestPriorityPage:function(){var Ir=Sr.current.visibilities.slice(Sr.current.startRange,Sr.current.endRange+1).filter(function(Vr){return Vr.visibility>Rn});if(!Ir.length)return-1;for(var Mn=Ir[0].pageIndex,zn=Ir[Ir.length-1].pageIndex,er=Ir.length,Nr=0;Nr<er;Nr++){if(Ir[Nr].renderStatus===ln.Rendering)return-1;if(Ir[Nr].renderStatus===ln.NotRenderedYet)return Ir[Nr].pageIndex}return zn+1<fr&&Sr.current.visibilities[zn+1].renderStatus!==ln.Rendered?zn+1:Mn-1>=0&&Sr.current.visibilities[Mn-1].renderStatus!==ln.Rendered?Mn-1:-1},isInRange:function(Ir){return Ir>=Sr.current.startRange&&Ir<=Sr.current.endRange},markNotRendered:function(){for(var Ir=0;Ir<fr;Ir++)Sr.current.visibilities[Ir].renderStatus=ln.NotRenderedYet},markRendered:function(Ir){Sr.current.visibilities[Ir].renderStatus=ln.Rendered},markRendering:function(Ir){Sr.current.currentRenderingPage!==-1&&Sr.current.currentRenderingPage!==Ir&&Sr.current.visibilities[Sr.current.currentRenderingPage].renderStatus===ln.Rendering&&(Sr.current.visibilities[Sr.current.currentRenderingPage].renderStatus=ln.NotRenderedYet),Sr.current.visibilities[Ir].renderStatus=ln.Rendering,Sr.current.currentRenderingPage=Ir},setOutOfRange:function(Ir){Dr(Ir,Rn)},setRange:function(Ir,Mn){Sr.current.startRange=Ir,Sr.current.endRange=Mn;for(var zn=0;zn<fr;zn++)(zn<Ir||zn>Mn)&&(Sr.current.visibilities[zn].visibility=Rn,Sr.current.visibilities[zn].renderStatus=ln.NotRenderedYet)},setVisibility:Dr}},An={core:{askingPassword:{requirePasswordToOpen:"This document requires a password to open",submit:"Submit"},wrongPassword:{tryAgain:"The password is wrong. Please try again"},pageLabel:"Page {{pageIndex}}"}},Sn=Ft.createContext({l10n:An,setL10n:function(){}}),vn=0,_n=function(){return vn++},Tn=function(Nn,qn,fr){var yr=function(Er){var Sr=qn.current;if(Sr){var Dr=Er.target;if(Dr instanceof Element&&Dr.shadowRoot){var Ir=Er.composedPath();Ir.length>0&&!Sr.contains(Ir[0])&&fr()}else Sr.contains(Dr)||fr()}};Ft.useEffect(function(){if(Nn){var Er={capture:!0};return document.addEventListener("click",yr,Er),function(){document.removeEventListener("click",yr,Er)}}},[])},Pn=function(Nn){var qn=function(fr){fr.key==="Escape"&&Nn()};Ft.useEffect(function(){return document.addEventListener("keyup",qn),function(){document.removeEventListener("keyup",qn)}},[])},Ln=function(Nn){var qn=Nn.ariaControlsSuffix,fr=Nn.children,yr=Nn.closeOnClickOutside,Er=Nn.closeOnEscape,Sr=Nn.onToggle,Dr=Ft.useRef(),Ir=Ft.useContext(qt).direction===xt.TextDirection.RightToLeft;return Ft.useEffect(function(){var Mn=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",function(){document.body.style.overflow=Mn}},[]),Pn(function(){Dr.current&&Er&&Sr()}),Tn(yr,Dr,Sr),Yt(function(){var Mn=Dr.current;if(Mn){var zn=.75*document.body.clientHeight;Mn.getBoundingClientRect().height>=zn&&(Mn.style.overflow="auto",Mn.style.maxHeight="".concat(zn,"px"))}},[]),Ft.createElement("div",{"aria-modal":"true",className:Wt({"rpv-core__modal-body":!0,"rpv-core__modal-body--rtl":Ir}),id:"rpv-core__modal-body-".concat(qn),ref:Dr,role:"dialog",tabIndex:-1},fr)},Vn=function(Nn){var qn=Nn.children;return Ft.createElement("div",{className:"rpv-core__modal-overlay"},qn)};xt.ToggleStatus=void 0,(wn=xt.ToggleStatus||(xt.ToggleStatus={})).Close="Close",wn.Open="Open",wn.Toggle="Toggle";var Un,Wn=function(Nn){var qn=Ft.useState(Nn),fr=qn[0],yr=qn[1];return{opened:fr,toggle:function(Er){switch(Er){case xt.ToggleStatus.Close:yr(!1);break;case xt.ToggleStatus.Open:yr(!0);break;case xt.ToggleStatus.Toggle:default:yr(function(Sr){return!Sr})}}}},rr=function(Nn){var qn=Nn.content,fr=Nn.isOpened,yr=fr!==void 0&&fr,Er=Nn.target,Sr=Wn(yr),Dr=Sr.opened,Ir=Sr.toggle;return Ft.createElement(Ft.Fragment,null,Er&&Er(Ir,Dr),Dr&&qn(Ir))};xt.Position=void 0,(Un=xt.Position||(xt.Position={})).TopLeft="TOP_LEFT",Un.TopCenter="TOP_CENTER",Un.TopRight="TOP_RIGHT",Un.RightTop="RIGHT_TOP",Un.RightCenter="RIGHT_CENTER",Un.RightBottom="RIGHT_BOTTOM",Un.BottomLeft="BOTTOM_LEFT",Un.BottomCenter="BOTTOM_CENTER",Un.BottomRight="BOTTOM_RIGHT",Un.LeftTop="LEFT_TOP",Un.LeftCenter="LEFT_CENTER",Un.LeftBottom="LEFT_BOTTOM";var ar,nr,mr,kn,Fn,Hn,Bn,jn,sr=function(Nn,qn,fr,yr,Er){Yt(function(){var Sr=qn.current,Dr=Nn.current,Ir=fr.current;if(Dr&&Sr&&Ir){var Mn=Ir.getBoundingClientRect(),zn=function(Vr,Ur,_i,Kr){var Qr=Ur.getBoundingClientRect(),$s=Vr.getBoundingClientRect(),ys=$s.height,ws=$s.width,Rs=0,Es=0;switch(_i){case xt.Position.TopLeft:Rs=Qr.top-ys,Es=Qr.left;break;case xt.Position.TopCenter:Rs=Qr.top-ys,Es=Qr.left+Qr.width/2-ws/2;break;case xt.Position.TopRight:Rs=Qr.top-ys,Es=Qr.left+Qr.width-ws;break;case xt.Position.RightTop:Rs=Qr.top,Es=Qr.left+Qr.width;break;case xt.Position.RightCenter:Rs=Qr.top+Qr.height/2-ys/2,Es=Qr.left+Qr.width;break;case xt.Position.RightBottom:Rs=Qr.top+Qr.height-ys,Es=Qr.left+Qr.width;break;case xt.Position.BottomLeft:Rs=Qr.top+Qr.height,Es=Qr.left;break;case xt.Position.BottomCenter:Rs=Qr.top+Qr.height,Es=Qr.left+Qr.width/2-ws/2;break;case xt.Position.BottomRight:Rs=Qr.top+Qr.height,Es=Qr.left+Qr.width-ws;break;case xt.Position.LeftTop:Rs=Qr.top,Es=Qr.left-ws;break;case xt.Position.LeftCenter:Rs=Qr.top+Qr.height/2-ys/2,Es=Qr.left-ws;break;case xt.Position.LeftBottom:Rs=Qr.top+Qr.height-ys,Es=Qr.left-ws}return{left:Es+(Kr.left||0),top:Rs+(Kr.top||0)}}(Dr,Sr,yr,Er),er=zn.top,Nr=zn.left;Dr.style.top="".concat(er-Mn.top,"px"),Dr.style.left="".concat(Nr-Mn.left,"px")}},[])},Ar=function(Nn){var qn,fr=Nn.customClassName,yr=Nn.position;return Ft.createElement("div",{className:Wt((qn={"rpv-core__arrow":!0,"rpv-core__arrow--tl":yr===xt.Position.TopLeft,"rpv-core__arrow--tc":yr===xt.Position.TopCenter,"rpv-core__arrow--tr":yr===xt.Position.TopRight,"rpv-core__arrow--rt":yr===xt.Position.RightTop,"rpv-core__arrow--rc":yr===xt.Position.RightCenter,"rpv-core__arrow--rb":yr===xt.Position.RightBottom,"rpv-core__arrow--bl":yr===xt.Position.BottomLeft,"rpv-core__arrow--bc":yr===xt.Position.BottomCenter,"rpv-core__arrow--br":yr===xt.Position.BottomRight,"rpv-core__arrow--lt":yr===xt.Position.LeftTop,"rpv-core__arrow--lc":yr===xt.Position.LeftCenter,"rpv-core__arrow--lb":yr===xt.Position.LeftBottom},qn["".concat(fr)]=fr!=="",qn))})},Fr=function(Nn){var qn=Nn.ariaControlsSuffix,fr=Nn.children,yr=Nn.closeOnClickOutside,Er=Nn.offset,Sr=Nn.position,Dr=Nn.targetRef,Ir=Nn.onClose,Mn=Ft.useRef(),zn=Ft.useRef(),er=Ft.useRef(),Nr=Ft.useContext(qt).direction===xt.TextDirection.RightToLeft;Tn(yr,Mn,Ir),sr(Mn,Dr,er,Sr,Er),Yt(function(){var Ur=zn.current;if(Ur){var _i=.75*document.body.clientHeight;Ur.getBoundingClientRect().height>=_i&&(Ur.style.overflow="auto",Ur.style.maxHeight="".concat(_i,"px"))}},[]);var Vr="rpv-core__popover-body-inner-".concat(qn);return Ft.createElement(Ft.Fragment,null,Ft.createElement("div",{ref:er,style:{left:0,position:"absolute",top:0}}),Ft.createElement("div",{"aria-describedby":Vr,className:Wt({"rpv-core__popover-body":!0,"rpv-core__popover-body--rtl":Nr}),id:"rpv-core__popover-body-".concat(qn),ref:Mn,role:"dialog",tabIndex:-1},Ft.createElement(Ar,{customClassName:"rpv-core__popover-body-arrow",position:Sr}),Ft.createElement("div",{id:Vr,ref:zn},fr)))},Rr=function(Nn){var qn=Nn.closeOnEscape,fr=Nn.onClose,yr=Ft.useRef();return Pn(function(){yr.current&&qn&&fr()}),Ft.createElement("div",{className:"rpv-core__popover-overlay",ref:yr})},Qn=function(Nn){var qn=Nn.ariaControlsSuffix,fr=Nn.children,yr=Nn.contentRef,Er=Nn.offset,Sr=Nn.position,Dr=Nn.targetRef,Ir=Ft.useRef(),Mn=Ft.useContext(qt).direction===xt.TextDirection.RightToLeft;return sr(yr,Dr,Ir,Sr,Er),Ft.createElement(Ft.Fragment,null,Ft.createElement("div",{ref:Ir,style:{left:0,position:"absolute",top:0}}),Ft.createElement("div",{className:Wt({"rpv-core__tooltip-body":!0,"rpv-core__tooltip-body--rtl":Mn}),id:"rpv-core__tooltip-body-".concat(qn),ref:yr,role:"tooltip"},Ft.createElement(Ar,{customClassName:"rpv-core__tooltip-body-arrow",position:Sr}),Ft.createElement("div",{className:"rpv-core__tooltip-body-content"},fr)))};xt.FullScreenMode=void 0,(ar=xt.FullScreenMode||(xt.FullScreenMode={})).Normal="Normal",ar.Entering="Entering",ar.Entered="Entered",ar.EnteredCompletely="EnteredCompletely",ar.Exitting="Exitting",ar.Exited="Exited",xt.LayerRenderStatus=void 0,(nr=xt.LayerRenderStatus||(xt.LayerRenderStatus={}))[nr.PreRender=0]="PreRender",nr[nr.DidRender=1]="DidRender",xt.PageMode=void 0,(mr=xt.PageMode||(xt.PageMode={})).Attachments="UseAttachments",mr.Bookmarks="UseOutlines",mr.ContentGroup="UseOC",mr.Default="UserNone",mr.FullScreen="FullScreen",mr.Thumbnails="UseThumbs",xt.PasswordStatus=void 0,(kn=xt.PasswordStatus||(xt.PasswordStatus={})).RequiredPassword="RequiredPassword",kn.WrongPassword="WrongPassword",xt.RotateDirection=void 0,(Fn=xt.RotateDirection||(xt.RotateDirection={})).Backward="Backward",Fn.Forward="Forward",xt.ScrollMode=void 0,(Hn=xt.ScrollMode||(xt.ScrollMode={})).Page="Page",Hn.Horizontal="Horizontal",Hn.Vertical="Vertical",Hn.Wrapped="Wrapped",xt.SpecialZoomLevel=void 0,(Bn=xt.SpecialZoomLevel||(xt.SpecialZoomLevel={})).ActualSize="ActualSize",Bn.PageFit="PageFit",Bn.PageWidth="PageWidth",xt.ViewMode=void 0,(jn=xt.ViewMode||(xt.ViewMode={})).DualPage="DualPage",jn.DualPageWithCover="DualPageWithCover",jn.SinglePage="SinglePage";var jr,Mr=function(Nn,qn){return Nn.reduce(function(fr,yr,Er){return Er%qn?fr[fr.length-1].push(yr):fr.push([yr]),fr},[])},pr=function(Nn,qn){switch(qn[1].name){case"XYZ":return{bottomOffset:function(fr,yr){return qn[3]===null?yr:qn[3]},leftOffset:function(fr,yr){return qn[2]===null?0:qn[2]},pageIndex:Nn,scaleTo:qn[4]};case"Fit":case"FitB":return{bottomOffset:0,leftOffset:0,pageIndex:Nn,scaleTo:xt.SpecialZoomLevel.PageFit};case"FitH":case"FitBH":return{bottomOffset:qn[2],leftOffset:0,pageIndex:Nn,scaleTo:xt.SpecialZoomLevel.PageWidth};default:return{bottomOffset:0,leftOffset:0,pageIndex:Nn,scaleTo:1}}},Tr=new Map,Hr=new Map,Xr=function(Nn,qn){return"".concat(Nn.loadingTask.docId,"___").concat(qn.num,"R").concat(qn.gen===0?"":qn.gen)},Zr=function(Nn,qn,fr){Tr.set(Xr(Nn,qn),fr)},ur=function(Nn,qn){if(!Nn)return Promise.reject("The document is not loaded yet");var fr="".concat(Nn.loadingTask.docId,"___").concat(qn),yr=Hr.get(fr);return yr?Promise.resolve(yr):new Promise(function(Er,Sr){Nn.getPage(qn+1).then(function(Dr){Hr.set(fr,Dr),Dr.ref&&Zr(Nn,Dr.ref,qn),Er(Dr)})})},hr=function(Nn,qn){return new Promise(function(fr){new Promise(function(yr){typeof qn=="string"?Nn.getDestination(qn).then(function(Er){yr(Er)}):yr(qn)}).then(function(yr){if(typeof yr[0]=="object"&&yr[0]!==null){var Er=yr[0],Sr=function(Ir,Mn){var zn=Xr(Ir,Mn);return Tr.has(zn)?Tr.get(zn):null}(Nn,Er);Sr===null?Nn.getPageIndex(Er).then(function(Ir){Zr(Nn,Er,Ir),hr(Nn,qn).then(function(Mn){return fr(Mn)})}):fr(pr(Sr,yr))}else{var Dr=pr(yr[0],yr);fr(Dr)}})})};(function(Nn){Nn[Nn.Solid=1]="Solid",Nn[Nn.Dashed=2]="Dashed",Nn[Nn.Beveled=3]="Beveled",Nn[Nn.Inset=4]="Inset",Nn[Nn.Underline=5]="Underline"})(jr||(jr={}));var gr,qr=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"),ds=function(Nn,qn,fr,yr){var Er=parseInt(Nn,10);return Er>=qn&&Er<=fr?Er:yr},ms=function(Nn){return Nn.contentsObj?Nn.contentsObj.str:Nn.contents||""},wr=function(Nn){return Nn.titleObj?Nn.titleObj.str:Nn.title||""},Wr=function(Nn){var qn=Nn.annotation,fr=Ft.useContext(qt).direction,yr=wr(qn),Er=ms(qn),Sr=fr===xt.TextDirection.RightToLeft,Dr=Ft.useRef(),Ir="";if(qn.modificationDate){var Mn=function(zn){var er=qr.exec(zn);if(!er)return null;var Nr=parseInt(er[1],10),Vr=ds(er[2],1,12,1)-1,Ur=ds(er[3],1,31,1),_i=ds(er[4],0,23,0),Kr=ds(er[5],0,59,0),Qr=ds(er[6],0,59,0),$s=er[7]||"Z",ys=ds(er[8],0,23,0),ws=ds(er[9],0,59,0);switch($s){case"-":_i+=ys,Kr+=ws;break;case"+":_i-=ys,Kr-=ws}return new Date(Date.UTC(Nr,Vr,Ur,_i,Kr,Qr))}(qn.modificationDate);Ir=Mn?"".concat(Mn.toLocaleDateString(),", ").concat(Mn.toLocaleTimeString()):""}return Ft.useLayoutEffect(function(){if(Dr.current){var zn=document.querySelector('[data-annotation-id="'.concat(qn.id,'"]'));if(zn){var er=zn;return er.style.zIndex+=1,function(){er.style.zIndex="".concat(parseInt(er.style.zIndex,10)-1)}}}},[]),Ft.createElement("div",{ref:Dr,className:Wt({"rpv-core__annotation-popup-wrapper":!0,"rpv-core__annotation-popup-wrapper--rtl":Sr}),style:{top:qn.annotationType===xt.AnnotationType.Popup?"":"100%"}},yr&&Ft.createElement(Ft.Fragment,null,Ft.createElement("div",{className:Wt({"rpv-core__annotation-popup-title":!0,"rpv-core__annotation-popup-title--ltr":!Sr,"rpv-core__annotation-popup-title--rtl":Sr})},yr),Ft.createElement("div",{className:"rpv-core__annotation-popup-date"},Ir)),Er&&Ft.createElement("div",{className:"rpv-core__annotation-popup-content"},Er.split(`
`).map(function(zn,er){return Ft.createElement(Ft.Fragment,{key:er},zn,Ft.createElement("br",null))})))};(function(Nn){Nn.Click="Click",Nn.Hover="Hover"})(gr||(gr={}));var ns,us=function(Nn){var qn,fr=Nn.annotation,yr=Nn.children,Er=Nn.ignoreBorder,Sr=Nn.hasPopup,Dr=Nn.isRenderable,Ir=Nn.page,Mn=Nn.viewport,zn=fr.rect,er=function(){var Ds=Wn(!1),io=Ds.opened,Qs=Ds.toggle,oo=Ft.useState(gr.Hover),ao=oo[0],to=oo[1];return{opened:io,closeOnHover:function(){ao===gr.Hover&&Qs(xt.ToggleStatus.Close)},openOnHover:function(){ao===gr.Hover&&Qs(xt.ToggleStatus.Open)},toggleOnClick:function(){switch(ao){case gr.Click:io&&to(gr.Hover),Qs(xt.ToggleStatus.Toggle);break;case gr.Hover:to(gr.Click),Qs(xt.ToggleStatus.Open)}}}}(),Nr=er.closeOnHover,Vr=er.opened,Ur=er.openOnHover,_i=er.toggleOnClick,Kr=(qn=[zn[0],Ir.view[3]+Ir.view[1]-zn[1],zn[2],Ir.view[3]+Ir.view[1]-zn[3]],[Math.min(qn[0],qn[2]),Math.min(qn[1],qn[3]),Math.max(qn[0],qn[2]),Math.max(qn[1],qn[3])]),Qr=zn[2]-zn[0],$s=zn[3]-zn[1],ys={borderColor:"",borderRadius:"",borderStyle:"",borderWidth:""};if(!Er&&fr.borderStyle.width>0){switch(fr.borderStyle.style){case jr.Dashed:ys.borderStyle="dashed";break;case jr.Solid:ys.borderStyle="solid";break;case jr.Underline:ys=Object.assign({borderBottomStyle:"solid"},ys);case jr.Beveled:case jr.Inset:}var ws=fr.borderStyle.width;ys.borderWidth="".concat(ws,"px"),fr.borderStyle.style!==jr.Underline&&(Qr-=2*ws,$s-=2*ws);var Rs=fr.borderStyle,Es=Rs.horizontalCornerRadius,Ns=Rs.verticalCornerRadius;(Es>0||Ns>0)&&(ys.borderRadius="".concat(Es,"px / ").concat(Ns,"px")),fr.color?ys.borderColor="rgb(".concat(0|fr.color[0],", ").concat(0|fr.color[1],", ").concat(0|fr.color[2],")"):ys.borderWidth="0"}return Ft.createElement(Ft.Fragment,null,Dr&&yr({popup:{opened:Vr,closeOnHover:Nr,openOnHover:Ur,toggleOnClick:_i},slot:{attrs:{style:Object.assign({height:"".concat($s,"px"),left:"".concat(Kr[0],"px"),top:"".concat(Kr[1],"px"),transform:"matrix(".concat(Mn.transform.join(","),")"),transformOrigin:"-".concat(Kr[0],"px -").concat(Kr[1],"px"),width:"".concat(Qr,"px")},ys)},children:Ft.createElement(Ft.Fragment,null,Sr&&Vr&&Ft.createElement(Wr,{annotation:fr}))}}))},ps=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=qn.hasPopup===!1,Sr=wr(qn),Dr=ms(qn),Ir=!!(qn.hasPopup||Sr||Dr);return Ft.createElement(us,{annotation:qn,hasPopup:Er,ignoreBorder:!0,isRenderable:Ir,page:fr,viewport:yr},function(Mn){return Ft.createElement("div",Ht({},Mn.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--caret","data-annotation-id":qn.id,onClick:Mn.popup.toggleOnClick,onMouseEnter:Mn.popup.openOnHover,onMouseLeave:Mn.popup.closeOnHover}),Mn.slot.children)})},Ls=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=qn.hasPopup===!1,Sr=wr(qn),Dr=ms(qn),Ir=!!(qn.hasPopup||Sr||Dr),Mn=qn.rect,zn=Mn[2]-Mn[0],er=Mn[3]-Mn[1],Nr=qn.borderStyle.width;return Ft.createElement(us,{annotation:qn,hasPopup:Er,ignoreBorder:!0,isRenderable:Ir,page:fr,viewport:yr},function(Vr){return Ft.createElement("div",Ht({},Vr.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--circle","data-annotation-id":qn.id,onClick:Vr.popup.toggleOnClick,onMouseEnter:Vr.popup.openOnHover,onMouseLeave:Vr.popup.closeOnHover}),Ft.createElement("svg",{height:"".concat(er,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(zn," ").concat(er),width:"".concat(zn,"px")},Ft.createElement("circle",{cy:er/2,fill:"none",rx:zn/2-Nr/2,ry:er/2-Nr/2,stroke:"transparent",strokeWidth:Nr||1})),Vr.slot.children)})},vs=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=wr(qn),Sr=ms(qn),Dr=!(qn.hasPopup!==!1||!Er&&!Sr),Ir=function(){var Mn,zn,er,Nr,Vr=qn.file;Vr&&(Mn=Vr.filename,zn=Vr.content,er=typeof zn=="string"?"":URL.createObjectURL(new Blob([zn],{type:""})),(Nr=document.createElement("a")).style.display="none",Nr.href=er||Mn,Nr.setAttribute("download",function(Ur){var _i=Ur.split("/").pop();return _i?_i.split("#")[0].split("?")[0]:Ur}(Mn)),document.body.appendChild(Nr),Nr.click(),document.body.removeChild(Nr),er&&URL.revokeObjectURL(er))};return Ft.createElement(us,{annotation:qn,hasPopup:Dr,ignoreBorder:!0,isRenderable:!0,page:fr,viewport:yr},function(Mn){return Ft.createElement("div",Ht({},Mn.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--file-attachment","data-annotation-id":qn.id,onClick:Mn.popup.toggleOnClick,onDoubleClick:Ir,onMouseEnter:Mn.popup.openOnHover,onMouseLeave:Mn.popup.closeOnHover}),Mn.slot.children)})},Ps=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=qn.hasPopup===!1,Sr=wr(qn),Dr=ms(qn),Ir=!!(qn.hasPopup||Sr||Dr);return Ft.createElement(us,{annotation:qn,hasPopup:Er,ignoreBorder:!0,isRenderable:Ir,page:fr,viewport:yr},function(Mn){return Ft.createElement("div",Ht({},Mn.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--free-text","data-annotation-id":qn.id,onClick:Mn.popup.toggleOnClick,onMouseEnter:Mn.popup.openOnHover,onMouseLeave:Mn.popup.closeOnHover}),Mn.slot.children)})},Fs=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=wr(qn),Sr=ms(qn),Dr=!(!Er&&!Sr),Ir=!qn.parentType||["Circle","Ink","Line","Polygon","PolyLine","Square"].indexOf(qn.parentType)!==-1;return Yt(function(){if(qn.parentId){var Mn=document.querySelector('[data-annotation-id="'.concat(qn.parentId,'"]')),zn=document.querySelector('[data-annotation-id="'.concat(qn.id,'"]'));if(Mn&&zn){var er=parseFloat(Mn.style.left),Nr=parseFloat(Mn.style.top)+parseFloat(Mn.style.height);zn.style.left="".concat(er,"px"),zn.style.top="".concat(Nr,"px"),zn.style.transformOrigin="-".concat(er,"px -").concat(Nr,"px")}}},[]),Ft.createElement(us,{annotation:qn,hasPopup:Ir,ignoreBorder:!1,isRenderable:Dr,page:fr,viewport:yr},function(Mn){return Ft.createElement("div",Ht({},Mn.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--popup","data-annotation-id":qn.id}),Ft.createElement(Wr,{annotation:qn}))})},zs=function(Nn){var qn=Nn.annotation,fr=Nn.childAnnotation,yr=Nn.page,Er=Nn.viewport,Sr=qn.hasPopup===!1,Dr=wr(qn),Ir=ms(qn),Mn=!!(qn.hasPopup||Dr||Ir);if(qn.quadPoints&&qn.quadPoints.length>0){var zn=qn.quadPoints.map(function(er){return Object.assign({},qn,{rect:[er[2].x,er[2].y,er[1].x,er[1].y],quadPoints:[]})});return Ft.createElement(Ft.Fragment,null,zn.map(function(er,Nr){return Ft.createElement(zs,{key:Nr,annotation:er,childAnnotation:fr,page:yr,viewport:Er})}))}return Ft.createElement(us,{annotation:qn,hasPopup:Sr,ignoreBorder:!0,isRenderable:Mn,page:yr,viewport:Er},function(er){return Ft.createElement(Ft.Fragment,null,Ft.createElement("div",Ht({},er.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--highlight","data-annotation-id":qn.id,onClick:er.popup.toggleOnClick,onMouseEnter:er.popup.openOnHover,onMouseLeave:er.popup.closeOnHover}),er.slot.children),fr&&fr.annotationType===xt.AnnotationType.Popup&&er.popup.opened&&Ft.createElement(Fs,{annotation:fr,page:yr,viewport:Er}))})},Eo=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=qn.hasPopup===!1,Sr=wr(qn),Dr=ms(qn),Ir=!!(qn.hasPopup||Sr||Dr),Mn=qn.rect,zn=Mn[2]-Mn[0],er=Mn[3]-Mn[1],Nr=qn.borderStyle.width;return Ft.createElement(us,{annotation:qn,hasPopup:Er,ignoreBorder:!0,isRenderable:Ir,page:fr,viewport:yr},function(Vr){return Ft.createElement("div",Ht({},Vr.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--ink","data-annotation-id":qn.id,onClick:Vr.popup.toggleOnClick,onMouseEnter:Vr.popup.openOnHover,onMouseLeave:Vr.popup.closeOnHover}),qn.inkLists&&qn.inkLists.length&&Ft.createElement("svg",{height:"".concat(er,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(zn," ").concat(er),width:"".concat(zn,"px")},qn.inkLists.map(function(Ur,_i){return Ft.createElement("polyline",{key:_i,fill:"none",stroke:"transparent",strokeWidth:Nr||1,points:Ur.map(function(Kr){return"".concat(Kr.x-Mn[0],",").concat(Mn[3]-Kr.y)}).join(" ")})})),Vr.slot.children)})},js=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=qn.hasPopup===!1,Sr=wr(qn),Dr=ms(qn),Ir=!!(qn.hasPopup||Sr||Dr),Mn=qn.rect,zn=Mn[2]-Mn[0],er=Mn[3]-Mn[1],Nr=qn.borderStyle.width;return Ft.createElement(us,{annotation:qn,hasPopup:Er,ignoreBorder:!0,isRenderable:Ir,page:fr,viewport:yr},function(Vr){return Ft.createElement("div",Ht({},Vr.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--line","data-annotation-id":qn.id,onClick:Vr.popup.toggleOnClick,onMouseEnter:Vr.popup.openOnHover,onMouseLeave:Vr.popup.closeOnHover}),Ft.createElement("svg",{height:"".concat(er,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(zn," ").concat(er),width:"".concat(zn,"px")},Ft.createElement("line",{stroke:"transparent",strokeWidth:Nr||1,x1:Mn[2]-qn.lineCoordinates[0],x2:Mn[2]-qn.lineCoordinates[2],y1:Mn[3]-qn.lineCoordinates[1],y2:Mn[3]-qn.lineCoordinates[3]})),Vr.slot.children)})},Hs=/^([^\w]*)(javascript|data|vbscript)/im,Us=/&#(\w+)(^\w|;)?/g,Ks=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,go=/^([^:]+):/gm,vo=function(Nn,qn){var fr,yr=(fr=Nn||"",fr.replace(Us,function(Ir,Mn){return String.fromCharCode(Mn)})).replace(Ks,"").trim();if(!yr)return qn;var Er=yr[0];if(Er==="."||Er==="/")return yr;var Sr=yr.match(go);if(!Sr)return yr;var Dr=Sr[0];return Hs.test(Dr)?qn:yr},vr=function(Nn){var qn,fr=Nn.annotation,yr=Nn.annotationContainerRef,Er=Nn.doc,Sr=Nn.outlines,Dr=Nn.page,Ir=Nn.pageIndex,Mn=Nn.scale,zn=Nn.viewport,er=Nn.onExecuteNamedAction,Nr=Nn.onJumpFromLinkAnnotation,Vr=Nn.onJumpToDest,Ur=Ft.useRef(),_i=Sr&&Sr.length&&fr.dest&&typeof fr.dest=="string"?(qn=Sr.find(function(ys){return ys.dest===fr.dest}))===null||qn===void 0?void 0:qn.title:"",Kr=!!(fr.url||fr.dest||fr.action||fr.unsafeUrl),Qr={};if(fr.url||fr.unsafeUrl){var $s=vo(fr.url||fr.unsafeUrl,"");$s?Qr={"data-target":"external",href:$s,rel:"noopener noreferrer nofollow",target:fr.newWindow?"_blank":"",title:$s}:Kr=!1}else Qr={href:"","data-annotation-link":fr.id,onClick:function(ys){ys.preventDefault(),fr.action?er(fr.action):hr(Er,fr.dest).then(function(ws){var Rs=Ur.current,Es=yr.current;if(Rs&&Es){var Ns=Rs.getBoundingClientRect();Es.style.setProperty("height","100%"),Es.style.setProperty("width","100%");var Ds=Es.getBoundingClientRect();Es.style.removeProperty("height"),Es.style.removeProperty("width");var io=(Ns.left-Ds.left)/Mn,Qs=(Ds.bottom-Ns.bottom+Ns.height)/Mn;Nr({bottomOffset:Qs,label:_i,leftOffset:io,pageIndex:Ir})}Vr(ws)})}};return _i&&(Qr=Object.assign({},Qr,{title:_i,"aria-label":_i})),Ft.createElement(us,{annotation:fr,hasPopup:!1,ignoreBorder:!1,isRenderable:Kr,page:Dr,viewport:zn},function(ys){return Ft.createElement("div",Ht({},ys.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--link","data-annotation-id":fr.id,"data-testid":"core__annotation--link-".concat(fr.id)}),Ft.createElement("a",Ht({ref:Ur},Qr)))})},lr=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=qn.hasPopup===!1,Sr=wr(qn),Dr=ms(qn),Ir=!!(qn.hasPopup||Sr||Dr),Mn=qn.rect,zn=Mn[2]-Mn[0],er=Mn[3]-Mn[1],Nr=qn.borderStyle.width;return Ft.createElement(us,{annotation:qn,hasPopup:Er,ignoreBorder:!0,isRenderable:Ir,page:fr,viewport:yr},function(Vr){return Ft.createElement("div",Ht({},Vr.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polygon","data-annotation-id":qn.id,onClick:Vr.popup.toggleOnClick,onMouseEnter:Vr.popup.openOnHover,onMouseLeave:Vr.popup.closeOnHover}),qn.vertices&&qn.vertices.length&&Ft.createElement("svg",{height:"".concat(er,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(zn," ").concat(er),width:"".concat(zn,"px")},Ft.createElement("polygon",{fill:"none",stroke:"transparent",strokeWidth:Nr||1,points:qn.vertices.map(function(Ur){return"".concat(Ur.x-Mn[0],",").concat(Mn[3]-Ur.y)}).join(" ")})),Vr.slot.children)})},$r=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=qn.hasPopup===!1,Sr=wr(qn),Dr=ms(qn),Ir=!!(qn.hasPopup||Sr||Dr),Mn=qn.rect,zn=Mn[2]-Mn[0],er=Mn[3]-Mn[1],Nr=qn.borderStyle.width;return Ft.createElement(us,{annotation:qn,hasPopup:Er,ignoreBorder:!0,isRenderable:Ir,page:fr,viewport:yr},function(Vr){return Ft.createElement("div",Ht({},Vr.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polyline","data-annotation-id":qn.id,onClick:Vr.popup.toggleOnClick,onMouseEnter:Vr.popup.openOnHover,onMouseLeave:Vr.popup.closeOnHover}),qn.vertices&&qn.vertices.length&&Ft.createElement("svg",{height:"".concat(er,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(zn," ").concat(er),width:"".concat(zn,"px")},Ft.createElement("polyline",{fill:"none",stroke:"transparent",strokeWidth:Nr||1,points:qn.vertices.map(function(Ur){return"".concat(Ur.x-Mn[0],",").concat(Mn[3]-Ur.y)}).join(" ")})),Vr.slot.children)})},Gr=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=qn.hasPopup===!1,Sr=wr(qn),Dr=ms(qn),Ir=!!(qn.hasPopup||Sr||Dr),Mn=qn.rect,zn=Mn[2]-Mn[0],er=Mn[3]-Mn[1],Nr=qn.borderStyle.width;return Ft.createElement(us,{annotation:qn,hasPopup:Er,ignoreBorder:!0,isRenderable:Ir,page:fr,viewport:yr},function(Vr){return Ft.createElement("div",Ht({},Vr.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--square","data-annotation-id":qn.id,onClick:Vr.popup.toggleOnClick,onMouseEnter:Vr.popup.openOnHover,onMouseLeave:Vr.popup.closeOnHover}),Ft.createElement("svg",{height:"".concat(er,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(zn," ").concat(er),width:"".concat(zn,"px")},Ft.createElement("rect",{height:er-Nr,fill:"none",stroke:"transparent",strokeWidth:Nr||1,x:Nr/2,y:Nr/2,width:zn-Nr})),Vr.slot.children)})},zr=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=qn.hasPopup===!1,Sr=wr(qn),Dr=ms(qn),Ir=!!(qn.hasPopup||Sr||Dr);return Ft.createElement(us,{annotation:qn,hasPopup:Er,ignoreBorder:!0,isRenderable:Ir,page:fr,viewport:yr},function(Mn){return Ft.createElement("div",Ht({},Mn.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--squiggly","data-annotation-id":qn.id,onClick:Mn.popup.toggleOnClick,onMouseEnter:Mn.popup.openOnHover,onMouseLeave:Mn.popup.closeOnHover}),Mn.slot.children)})},fs=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=qn.hasPopup===!1,Sr=wr(qn),Dr=ms(qn),Ir=!!(qn.hasPopup||Sr||Dr);return Ft.createElement(us,{annotation:qn,hasPopup:Er,ignoreBorder:!0,isRenderable:Ir,page:fr,viewport:yr},function(Mn){return Ft.createElement("div",Ht({},Mn.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--stamp","data-annotation-id":qn.id,onClick:Mn.popup.toggleOnClick,onMouseEnter:Mn.popup.openOnHover,onMouseLeave:Mn.popup.closeOnHover}),Mn.slot.children)})},Ts=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=qn.hasPopup===!1,Sr=wr(qn),Dr=ms(qn),Ir=!!(qn.hasPopup||Sr||Dr);return Ft.createElement(us,{annotation:qn,hasPopup:Er,ignoreBorder:!0,isRenderable:Ir,page:fr,viewport:yr},function(Mn){return Ft.createElement("div",Ht({},Mn.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--strike-out","data-annotation-id":qn.id,onClick:Mn.popup.toggleOnClick,onMouseEnter:Mn.popup.openOnHover,onMouseLeave:Mn.popup.closeOnHover}),Mn.slot.children)})},Bs=function(){return Ft.createElement(Xt,{size:16},Ft.createElement("path",{d:"M.5,16.5a1,1,0,0,0,1,1h2v4l4-4h15a1,1,0,0,0,1-1V3.5a1,1,0,0,0-1-1H1.5a1,1,0,0,0-1,1Z"}),Ft.createElement("path",{d:"M7.25,9.75A.25.25,0,1,1,7,10a.25.25,0,0,1,.25-.25"}),Ft.createElement("path",{d:"M12,9.75a.25.25,0,1,1-.25.25A.25.25,0,0,1,12,9.75"}),Ft.createElement("path",{d:"M16.75,9.75a.25.25,0,1,1-.25.25.25.25,0,0,1,.25-.25"}))},Xs=function(){return Ft.createElement(Xt,{size:16},Ft.createElement("path",{d:"M0.500 12.001 A11.500 11.500 0 1 0 23.500 12.001 A11.500 11.500 0 1 0 0.500 12.001 Z"}),Ft.createElement("path",{d:"M6.000 12.001 A6.000 6.000 0 1 0 18.000 12.001 A6.000 6.000 0 1 0 6.000 12.001 Z"}),Ft.createElement("path",{d:"M21.423 5.406L17.415 9.414"}),Ft.createElement("path",{d:"M14.587 6.585L18.607 2.565"}),Ft.createElement("path",{d:"M5.405 21.424L9.413 17.416"}),Ft.createElement("path",{d:"M6.585 14.588L2.577 18.596"}),Ft.createElement("path",{d:"M18.602 21.419L14.595 17.412"}),Ft.createElement("path",{d:"M17.419 14.58L21.428 18.589"}),Ft.createElement("path",{d:"M2.582 5.399L6.588 9.406"}),Ft.createElement("path",{d:"M9.421 6.581L5.412 2.572"}))},ro=function(){return Ft.createElement(Xt,{size:16},Ft.createElement("path",{d:"M4.000 18.500 A1.500 1.500 0 1 0 7.000 18.500 A1.500 1.500 0 1 0 4.000 18.500 Z"}),Ft.createElement("path",{d:"M20.5.5l-9.782,9.783a7,7,0,1,0,3,3L17,10h1.5V8.5L19,8h1.5V6.5L21,6h1.5V4.5l1-1V.5Z"}))},Ys=function(){return Ft.createElement(Xt,{size:16},Ft.createElement("path",{d:"M2.000 2.500 L22.000 2.500 L22.000 23.500 L2.000 23.500 Z"}),Ft.createElement("path",{d:"M6 4.5L6 0.5"}),Ft.createElement("path",{d:"M18 4.5L18 0.5"}),Ft.createElement("path",{d:"M10 4.5L10 0.5"}),Ft.createElement("path",{d:"M14 4.5L14 0.5"}))},co=function(){return Ft.createElement(Xt,{size:16},Ft.createElement("path",{d:"M17.5 0.498L17.5 23.498"}),Ft.createElement("path",{d:"M10.5 0.498L10.5 23.498"}),Ft.createElement("path",{d:"M23.5.5H6.5a6,6,0,0,0,0,12h4"}))},To=function(){return Ft.createElement(Xt,{size:16},Ft.createElement("path",{d:"M2.5 22.995L12 6.005 21.5 22.995 2.5 22.995z"}))},Vs=function(Nn){var qn=Nn.annotation,fr=Nn.childAnnotation,yr=Nn.page,Er=Nn.viewport,Sr=qn.hasPopup===!1,Dr=wr(qn),Ir=ms(qn),Mn=!!(qn.hasPopup||Dr||Ir),zn=qn.name?qn.name.toLowerCase():"";return Ft.createElement(us,{annotation:qn,hasPopup:Sr,ignoreBorder:!1,isRenderable:Mn,page:yr,viewport:Er},function(er){return Ft.createElement(Ft.Fragment,null,Ft.createElement("div",Ht({},er.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--text","data-annotation-id":qn.id,onClick:er.popup.toggleOnClick,onMouseEnter:er.popup.openOnHover,onMouseLeave:er.popup.closeOnHover}),zn&&Ft.createElement("div",{className:"rpv-core__annotation-text-icon"},zn==="check"&&Ft.createElement(Qt,null),zn==="comment"&&Ft.createElement(Bs,null),zn==="help"&&Ft.createElement(Xs,null),zn==="insert"&&Ft.createElement(To,null),zn==="key"&&Ft.createElement(ro,null),zn==="note"&&Ft.createElement(Ys,null),(zn==="newparagraph"||zn==="paragraph")&&Ft.createElement(co,null)),er.slot.children),fr&&fr.annotationType===xt.AnnotationType.Popup&&er.popup.opened&&Ft.createElement(Fs,{annotation:fr,page:yr,viewport:Er}))})},fo=function(Nn){var qn=Nn.annotation,fr=Nn.page,yr=Nn.viewport,Er=qn.hasPopup===!1,Sr=wr(qn),Dr=ms(qn),Ir=!!(qn.hasPopup||Sr||Dr);return Ft.createElement(us,{annotation:qn,hasPopup:Er,ignoreBorder:!0,isRenderable:Ir,page:fr,viewport:yr},function(Mn){return Ft.createElement("div",Ht({},Mn.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--underline","data-annotation-id":qn.id,onClick:Mn.popup.toggleOnClick,onMouseEnter:Mn.popup.openOnHover,onMouseLeave:Mn.popup.closeOnHover}),Mn.slot.children)})},$o=function(Nn){var qn=Nn.annotations,fr=Nn.doc,yr=Nn.outlines,Er=Nn.page,Sr=Nn.pageIndex,Dr=Nn.plugins,Ir=Nn.rotation,Mn=Nn.scale,zn=Nn.onExecuteNamedAction,er=Nn.onJumpFromLinkAnnotation,Nr=Nn.onJumpToDest,Vr=Ft.useRef(),Ur=Er.getViewport({rotation:Ir,scale:Mn}).clone({dontFlip:!0}),_i=qn.filter(function(Kr){return!Kr.parentId});return Yt(function(){var Kr=Vr.current;Kr&&Dr.forEach(function(Qr){Qr.onAnnotationLayerRender&&Qr.onAnnotationLayerRender({annotations:_i,container:Kr,pageIndex:Sr,rotation:Ir,scale:Mn})})},[]),Ft.createElement("div",{ref:Vr,className:"rpv-core__annotation-layer","data-testid":"core__annotation-layer-".concat(Sr)},_i.map(function(Kr){var Qr=qn.find(function($s){return $s.parentId===Kr.id});switch(Kr.annotationType){case xt.AnnotationType.Caret:return Ft.createElement(ps,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});case xt.AnnotationType.Circle:return Ft.createElement(Ls,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});case xt.AnnotationType.FileAttachment:return Ft.createElement(vs,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});case xt.AnnotationType.FreeText:return Ft.createElement(Ps,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});case xt.AnnotationType.Highlight:return Ft.createElement(zs,{key:Kr.id,annotation:Kr,childAnnotation:Qr,page:Er,viewport:Ur});case xt.AnnotationType.Ink:return Ft.createElement(Eo,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});case xt.AnnotationType.Line:return Ft.createElement(js,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});case xt.AnnotationType.Link:return Ft.createElement(vr,{key:Kr.id,annotation:Kr,annotationContainerRef:Vr,doc:fr,outlines:yr,page:Er,pageIndex:Sr,scale:Mn,viewport:Ur,onExecuteNamedAction:zn,onJumpFromLinkAnnotation:er,onJumpToDest:Nr});case xt.AnnotationType.Polygon:return Ft.createElement(lr,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});case xt.AnnotationType.Polyline:return Ft.createElement($r,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});case xt.AnnotationType.Popup:return Ft.createElement(Fs,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});case xt.AnnotationType.Square:return Ft.createElement(Gr,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});case xt.AnnotationType.Squiggly:return Ft.createElement(zr,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});case xt.AnnotationType.Stamp:return Ft.createElement(fs,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});case xt.AnnotationType.StrikeOut:return Ft.createElement(Ts,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});case xt.AnnotationType.Text:return Ft.createElement(Vs,{key:Kr.id,annotation:Kr,childAnnotation:Qr,page:Er,viewport:Ur});case xt.AnnotationType.Underline:return Ft.createElement(fo,{key:Kr.id,annotation:Kr,page:Er,viewport:Ur});default:return Ft.createElement(Ft.Fragment,{key:Kr.id})}}))},lo=function(Nn){var qn=Nn.page,fr=Nn.renderAnnotations,yr=Cn(),Er=Ft.useState({loading:!0,annotations:[]}),Sr=Er[0],Dr=Er[1];return Ft.useEffect(function(){qn.getAnnotations({intent:"display"}).then(function(Ir){yr.current&&Dr({loading:!1,annotations:Ir})})},[]),Sr.loading?Ft.createElement(Ft.Fragment,null):fr(Sr.annotations)},ko=function(Nn){var qn=Nn.doc,fr=Nn.outlines,yr=Nn.page,Er=Nn.pageIndex,Sr=Nn.plugins,Dr=Nn.rotation,Ir=Nn.scale,Mn=Nn.onExecuteNamedAction,zn=Nn.onJumpFromLinkAnnotation,er=Nn.onJumpToDest;return Ft.createElement(lo,{page:yr,renderAnnotations:function(Nr){return Ft.createElement($o,{annotations:Nr,doc:qn,outlines:fr,page:yr,pageIndex:Er,plugins:Sr,rotation:Dr,scale:Ir,onExecuteNamedAction:Mn,onJumpFromLinkAnnotation:zn,onJumpToDest:er})}})},jo=function(Nn,qn){var fr=Nn%qn;return fr===0?Nn:Math.floor(Nn-fr)},Co=function(Nn){var qn=Nn.canvasLayerRef,fr=Nn.height,yr=Nn.page,Er=Nn.pageIndex,Sr=Nn.plugins,Dr=Nn.rotation,Ir=Nn.scale,Mn=Nn.width,zn=Nn.onRenderCanvasCompleted,er=Ft.useRef();return Yt(function(){var Nr=er.current;Nr&&Nr.cancel();var Vr=qn.current;Vr.removeAttribute("data-testid"),Sr.forEach(function(Ds){Ds.onCanvasLayerRender&&Ds.onCanvasLayerRender({ele:Vr,pageIndex:Er,rotation:Dr,scale:Ir,status:xt.LayerRenderStatus.PreRender})});var Ur=yr.getViewport({rotation:Dr,scale:Ir}),_i=window.devicePixelRatio||1,Kr=Math.sqrt(16777216/(Ur.width*Ur.height)),Qr=_i>Kr;Qr?Vr.style.transform="scale(1, 1)":Vr.style.removeProperty("transform");var $s=Math.min(Kr,_i),ys=function(Ds,io){var Qs,oo;if(Math.floor(Ds)===Ds)return[Ds,1];var ao=1/Ds;if(ao>io)return[1,io];if(Math.floor(ao)===ao)return[1,ao];for(var to=Ds>1?ao:Ds,Oo=0,Ao=1,No=1,Ro=1;;){var Do=Oo+No,Io=Ao+Ro;if(Io>io)break;to<=Do/Io?(No=(Qs=[Do,Io])[0],Ro=Qs[1]):(Oo=(oo=[Do,Io])[0],Ao=oo[1])}return to<(Oo/Ao+No/Ro)/2?to===Ds?[Oo,Ao]:[Ao,Oo]:to===Ds?[No,Ro]:[Ro,No]}($s,8),ws=ys[0],Rs=ys[1];Vr.width=jo(Ur.width*$s,ws),Vr.height=jo(Ur.height*$s,ws),Vr.style.width="".concat(jo(Ur.width,Rs),"px"),Vr.style.height="".concat(jo(Ur.height,Rs),"px"),Vr.hidden=!0;var Es=Vr.getContext("2d",{alpha:!1}),Ns=Qr||_i!==1?[$s,0,0,$s,0,0]:null;return er.current=yr.render({canvasContext:Es,transform:Ns,viewport:Ur}),er.current.promise.then(function(){Vr.hidden=!1,Vr.setAttribute("data-testid","core__canvas-layer-".concat(Er)),Sr.forEach(function(Ds){Ds.onCanvasLayerRender&&Ds.onCanvasLayerRender({ele:Vr,pageIndex:Er,rotation:Dr,scale:Ir,status:xt.LayerRenderStatus.DidRender})}),zn()},function(){zn()}),function(){Vr&&(Vr.width=0,Vr.height=0)}},[]),Ft.createElement("div",{className:"rpv-core__canvas-layer",style:{height:"".concat(fr,"px"),width:"".concat(Mn,"px")}},Ft.createElement("canvas",{ref:qn}))},Go=function(Nn){var qn=Nn.height,fr=Nn.page,yr=Nn.rotation,Er=Nn.scale,Sr=Nn.width,Dr=Ft.useRef();return Yt(function(){var Ir=Dr.current,Mn=fr.getViewport({rotation:yr,scale:Er});fr.getOperatorList().then(function(zn){(function(){var er=Dr.current;er&&(er.innerHTML="")})(),new jt.SVGGraphics(fr.commonObjs,fr.objs).getSVG(zn,Mn).then(function(er){er.style.height="".concat(qn,"px"),er.style.width="".concat(Sr,"px"),Ir.appendChild(er)})})},[]),Ft.createElement("div",{className:"rpv-core__svg-layer",ref:Dr})},Lo=function(Nn){var qn=Nn.containerRef,fr=Nn.page,yr=Nn.pageIndex,Er=Nn.plugins,Sr=Nn.rotation,Dr=Nn.scale,Ir=Nn.onRenderTextCompleted,Mn=Ft.useRef(),zn=function(){var er=qn.current;er&&([].slice.call(er.querySelectorAll(".rpv-core__text-layer-text")).forEach(function(Nr){return er.removeChild(Nr)}),[].slice.call(er.querySelectorAll('br[role="presentation"]')).forEach(function(Nr){return er.removeChild(Nr)}))};return Yt(function(){var er=Mn.current;er&&er.cancel();var Nr=qn.current;if(Nr){Nr.removeAttribute("data-testid");var Vr=fr.getViewport({rotation:Sr,scale:Dr});return Er.forEach(function(Ur){Ur.onTextLayerRender&&Ur.onTextLayerRender({ele:Nr,pageIndex:yr,scale:Dr,status:xt.LayerRenderStatus.PreRender})}),fr.getTextContent().then(function(Ur){zn(),Mn.current=jt.renderTextLayer({container:Nr,textContent:Ur,textContentSource:Ur,viewport:Vr}),Mn.current.promise.then(function(){Nr.setAttribute("data-testid","core__text-layer-".concat(yr)),[].slice.call(Nr.children).forEach(function(_i){_i.classList.contains("rpv-core__text-layer-text--not")||_i.classList.add("rpv-core__text-layer-text")}),Er.forEach(function(_i){_i.onTextLayerRender&&_i.onTextLayerRender({ele:Nr,pageIndex:yr,scale:Dr,status:xt.LayerRenderStatus.DidRender})}),Ir()},function(){Nr.removeAttribute("data-testid"),Ir()})}),function(){var Ur;zn(),(Ur=Mn.current)===null||Ur===void 0||Ur.cancel()}}},[]),Ft.createElement("div",{className:"rpv-core__text-layer",ref:qn})},Fo=function(Nn){var qn=Nn.doc,fr=Nn.measureRef,yr=Nn.outlines,Er=Nn.pageIndex,Sr=Nn.pageRotation,Dr=Nn.pageSize,Ir=Nn.plugins,Mn=Nn.renderPage,zn=Nn.renderQueueKey,er=Nn.rotation,Nr=Nn.scale,Vr=Nn.shouldRender,Ur=Nn.viewMode,_i=Nn.onExecuteNamedAction,Kr=Nn.onJumpFromLinkAnnotation,Qr=Nn.onJumpToDest,$s=Nn.onRenderCompleted,ys=Nn.onRotatePage,ws=Cn(),Rs=Ft.useState(null),Es=Rs[0],Ns=Rs[1],Ds=Ft.useState(!1),io=Ds[0],Qs=Ds[1],oo=Ft.useState(!1),ao=oo[0],to=oo[1],Oo=Ft.useRef(),Ao=Ft.useRef(),No=Math.abs(er+Sr)%180==0,Ro=Dr.pageWidth*Nr,Do=Dr.pageHeight*Nr,Io=No?Ro:Do,Po=No?Do:Ro,zo=(Dr.rotation+er+Sr)%360,Yo=Ft.useRef(0),na=Mn||function(Vo){return Ft.createElement(Ft.Fragment,null,Vo.canvasLayer.children,Vo.textLayer.children,Vo.annotationLayer.children)};return Ft.useEffect(function(){Ns(null),Qs(!1),to(!1)},[Sr,er,Nr]),Ft.useEffect(function(){Vr&&ws.current&&!Es&&ur(qn,Er).then(function(Vo){ws.current&&(Yo.current=zn,Ns(Vo))})},[Vr,Es]),Ft.useEffect(function(){io&&ao&&(zn!==Yo.current?(Ns(null),Qs(!1),to(!1)):$s(Er))},[io,ao]),Ft.createElement("div",{className:Wt({"rpv-core__page-layer":!0,"rpv-core__page-layer--dual":Ur===xt.ViewMode.DualPage,"rpv-core__page-layer--dual-cover":Ur===xt.ViewMode.DualPageWithCover,"rpv-core__page-layer--single":Ur===xt.ViewMode.SinglePage}),"data-testid":"core__page-layer-".concat(Er),ref:fr,style:{height:"".concat(Po,"px"),width:"".concat(Io,"px")}},Es?Ft.createElement(Ft.Fragment,null,na({annotationLayer:{attrs:{},children:Ft.createElement(ko,{doc:qn,outlines:yr,page:Es,pageIndex:Er,plugins:Ir,rotation:zo,scale:Nr,onExecuteNamedAction:_i,onJumpFromLinkAnnotation:Kr,onJumpToDest:Qr})},canvasLayer:{attrs:{},children:Ft.createElement(Co,{canvasLayerRef:Oo,height:Po,page:Es,pageIndex:Er,plugins:Ir,rotation:zo,scale:Nr,width:Io,onRenderCanvasCompleted:function(){ws.current&&Qs(!0)}})},canvasLayerRendered:io,doc:qn,height:Po,pageIndex:Er,rotation:zo,scale:Nr,svgLayer:{attrs:{},children:Ft.createElement(Go,{height:Po,page:Es,rotation:zo,scale:Nr,width:Io})},textLayer:{attrs:{},children:Ft.createElement(Lo,{containerRef:Ao,page:Es,pageIndex:Er,plugins:Ir,rotation:zo,scale:Nr,onRenderTextCompleted:function(){ws.current&&to(!0)}})},textLayerRendered:ao,width:Io,markRendered:$s,onRotatePage:function(Vo){return ys(Er,Vo)}}),Ir.map(function(Vo,Xo){return Vo.renderPageLayer?Ft.createElement(Ft.Fragment,{key:Xo},Vo.renderPageLayer({canvasLayerRef:Oo,canvasLayerRendered:io,doc:qn,height:Po,pageIndex:Er,rotation:zo,scale:Nr,textLayerRef:Ao,textLayerRendered:ao,width:Io})):Ft.createElement(Ft.Fragment,{key:Xo})})):Ft.createElement(Zt,{testId:"core__page-layer-loading-".concat(Er)}))},Wo=function(Nn,qn){var fr=qn.rect;return Nn.height!==fr.height||Nn.width!==fr.width?fr:Nn};(function(Nn){Nn.Horizontal="Horizontal",Nn.Vertical="Vertical",Nn.Both="Both"})(ns||(ns={}));var Ko=function(Nn){return 1-Math.pow(1-Nn,4)},Bo=1e-4,Jo={left:0,top:0},ga={capture:!1,passive:!0},Jn=function(Nn){var qn=Nn.elementRef,fr=Nn.enableSmoothScroll,yr=Nn.isRtl,Er=Nn.scrollDirection,Sr=Nn.onSmoothScroll,Dr=Ft.useState(Jo),Ir=Dr[0],Mn=Dr[1],zn=Ft.useState(qn.current),er=zn[0],Nr=zn[1],Vr=yr?-1:1,Ur=Ft.useRef(Er);Ur.current=Er;var _i=Ft.useRef(Jo),Kr=Ft.useRef(!0),Qr=Ft.useCallback(function(){Kr.current=!0,fr&&Mn(_i.current),Sr(!1)},[]),$s=Ft.useCallback(function(){if(er){switch(Ur.current){case ns.Horizontal:_i.current={left:Vr*er.scrollLeft,top:0};break;case ns.Both:_i.current={left:Vr*er.scrollLeft,top:er.scrollTop};break;case ns.Vertical:default:_i.current={left:0,top:er.scrollTop}}fr&&!Kr.current||Mn(_i.current)}},[er]);Yt(function(){Nr(qn.current)}),Yt(function(){if(er)return er.addEventListener("scroll",$s,ga),function(){er.removeEventListener("scroll",$s,ga)}},[er]);var ys=Ft.useCallback(function(ws,Rs){var Es=qn.current;if(!Es)return Promise.resolve();var Ns={left:0,top:0};switch(Ur.current){case ns.Horizontal:Ns.left=Vr*ws.left;break;case ns.Both:Ns.left=Vr*ws.left,Ns.top=ws.top;break;case ns.Vertical:default:Ns.top=ws.top}return Rs?(Kr.current=!1,Sr(!0),new Promise(function(Ds,io){(function(Qs,oo,ao,to,Oo,Ao){Oo===void 0&&(Oo=function(Xo){return Xo}),Ao===void 0&&(Ao=function(){});var No=0,Ro=0,Do=!1;switch(oo){case ns.Horizontal:Ro=Qs.scrollLeft,No=0;case ns.Both:Ro=Qs.scrollLeft,No=Qs.scrollTop;break;case ns.Vertical:default:Ro=0,No=Qs.scrollTop}var Io=function(){Do||(Do=!0,Qs.scrollLeft=ao.left,Qs.scrollTop=ao.top,Ao())};if(Math.abs(No-ao.top)<=Bo&&oo===ns.Vertical)Io();else if(Math.abs(Ro-ao.left)<=Bo&&oo===ns.Horizontal)Io();else{var Po,zo=-1,Yo=Ro-ao.left,na=No-ao.top,Vo=function(Xo){zo===-1&&(zo=Xo);var xl=Xo-zo,ks=Math.min(xl/to,1),xs=Oo(ks),Ss={left:Ro-Yo*xs,top:No-na*xs};switch(oo){case ns.Horizontal:Qs.scrollLeft=Ss.left;break;case ns.Both:Qs.scrollLeft=Ss.left,Qs.scrollTop=Ss.top;break;case ns.Vertical:default:Qs.scrollTop=Ss.top}Math.abs(Ss.top-ao.top)<=Bo&&Math.abs(Ss.left-ao.left)<=Bo&&!Do&&(window.cancelAnimationFrame(Po),Io()),xl<to?Po=window.requestAnimationFrame(Vo):window.cancelAnimationFrame(Po)};Po=window.requestAnimationFrame(Vo)}})(Es,Ur.current,Ns,400,Ko,function(){Qr(),Ds()})})):new Promise(function(Ds,io){switch(Ur.current){case ns.Horizontal:Es.scrollLeft=Ns.left;break;case ns.Both:Es.scrollLeft=Ns.left,Es.scrollTop=Ns.top;break;case ns.Vertical:default:Es.scrollTop=Ns.top}Ds()})},[qn]);return{scrollOffset:Ir,scrollTo:ys}},xr=function(Nn,qn,fr){return Math.max(Nn,Math.min(fr,qn))},dr=function(Nn,qn){if(qn!==xt.ViewMode.DualPageWithCover)return 0;if(!function(Er){var Sr=Er.length;if(Sr===1)return!1;for(var Dr=1;Dr<Sr;Dr++)if(Er[Dr].height!==Er[0].height||Er[Dr].width!==Er[0].width)return!0;return!1}(Nn))return 2*Nn[0].width;var fr=Mr(Nn.slice(1),2).map(function(Er){return Er.length===2?Er[0].width+Er[1].width:Er[0].width}),yr=[Nn[0].width].concat(fr);return Math.max.apply(Math,yr)},kr={left:0,top:0},Lr={left:0,top:0},Pr={left:0,top:0},Jr={left:0,top:0},ss={height:0,width:0},ls={left:0,top:0},cs="data-virtual-index",hs=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],As=function(Nn){var qn=Nn.enableSmoothScroll,fr=Nn.isRtl,yr=Nn.numberOfItems,Er=Nn.parentRef,Sr=Nn.setRenderRange,Dr=Nn.sizes,Ir=Nn.scrollMode,Mn=Nn.viewMode,zn=Ft.useState(!1),er=zn[0],Nr=zn[1],Vr=Ft.useCallback(function(ks){return Nr(ks)},[]),Ur=Ft.useRef(Ir);Ur.current=Ir;var _i=Ft.useRef(Mn);_i.current=Mn;var Kr=Ir===xt.ScrollMode.Wrapped||Mn===xt.ViewMode.DualPageWithCover||Mn===xt.ViewMode.DualPage?ns.Both:Ir===xt.ScrollMode.Horizontal?ns.Horizontal:ns.Vertical,Qr=Jn({elementRef:Er,enableSmoothScroll:qn,isRtl:fr,scrollDirection:Kr,onSmoothScroll:Vr}),$s=Qr.scrollOffset,ys=Qr.scrollTo,ws=function(ks){var xs=ks.elementRef,Ss=Ft.useState(xs.current),Cs=Ss[0],bs=Ss[1],mn=Ft.useRef(!1),In=Ft.useReducer(Wo,{height:0,width:0}),On=In[0],Gn=In[1];return Yt(function(){xs.current!==Cs&&bs(xs.current)}),Yt(function(){if(Cs&&!mn.current){mn.current=!0;var Cr=Cs.getBoundingClientRect(),Br=Cr.height,rs=Cr.width;Gn({rect:{height:Br,width:rs}})}},[Cs]),Ft.useEffect(function(){if(Cs){var Cr=new ResizeObserver(function(Br,rs){Br.forEach(function(Ms){if(Ms.target===Cs){var uo=Ms.contentRect,Ws=uo.height,Is=uo.width;Gn({rect:{height:Ws,width:Is}})}})});return Cr.observe(Cs),function(){Cr.unobserve(Cs)}}},[Cs]),On}({elementRef:Er}),Rs=Ft.useRef({scrollOffset:ls,measurements:[]});Rs.current.scrollOffset=$s;var Es=Ft.useMemo(function(){return Array(yr).fill(-1)},[]),Ns=Ft.useState(Es),Ds=Ns[0],io=Ns[1],Qs=Ft.useMemo(function(){var ks=new IntersectionObserver(function(xs){xs.forEach(function(Ss){var Cs=Ss.isIntersecting?Ss.intersectionRatio:-1,bs=Ss.target.getAttribute(cs);if(bs){var mn=parseInt(bs,10);0<=mn&&mn<yr&&io(function(In){return In[mn]=Cs,function(On,Gn,Cr){for(var Br,rs=0,Ms=Gn.length;rs<Ms;rs++)!Br&&rs in Gn||(Br||(Br=Array.prototype.slice.call(Gn,0,rs)),Br[rs]=Gn[rs]);return On.concat(Br||Array.prototype.slice.call(Gn))}([],In)})}})},{threshold:hs});return ks},[]),oo=Ft.useMemo(function(){return Ir===xt.ScrollMode.Page&&Mn===xt.ViewMode.SinglePage?function(ks,xs,Ss){for(var Cs=[],bs=0;bs<ks;bs++){var mn={height:Math.max(xs.height,Ss[bs].height),width:Math.max(xs.width,Ss[bs].width)},In=bs===0?Jr:Cs[bs-1].end,On={left:In.left+mn.width,top:In.top+mn.height};Cs[bs]={index:bs,start:In,size:mn,end:On,visibility:-1}}return Cs}(yr,ws,Dr):Mn===xt.ViewMode.DualPageWithCover?function(ks,xs,Ss,Cs){for(var bs=[],mn=0,In=0,On=Pr,Gn=0;Gn<ks;Gn++){var Cr=Gn===0?{height:Cs===xt.ScrollMode.Page?Math.max(xs.height,Ss[Gn].height):Ss[Gn].height,width:Cs===xt.ScrollMode.Page?Math.max(xs.width,Ss[Gn].width):Ss[Gn].width}:{height:Cs===xt.ScrollMode.Page?Math.max(xs.height,Ss[Gn].height):Ss[Gn].height,width:Math.max(xs.width/2,Ss[Gn].width)};Cs===xt.ScrollMode.Page?On=Gn===0?Pr:{left:Gn%2==0?Cr.width:0,top:Math.floor((Gn-1)/2)*Cr.height+bs[0].end.top}:Gn===0?(On=Pr,mn=Ss[0].height,In=0):Gn%2==1?(On={left:0,top:mn+=In},In=Gn===ks-1?Ss[Gn].height:Math.max(Ss[Gn].height,Ss[Gn+1].height)):On={left:bs[Gn-1].end.left,top:mn};var Br={left:On.left+Cr.width,top:On.top+Cr.height};bs[Gn]={index:Gn,start:On,size:Cr,end:Br,visibility:-1}}return bs}(yr,ws,Dr,Ir):Mn===xt.ViewMode.DualPage?function(ks,xs,Ss,Cs){for(var bs=[],mn=0,In=0,On=Lr,Gn=0;Gn<ks;Gn++){var Cr={height:Cs===xt.ScrollMode.Page?Math.max(xs.height,Ss[Gn].height):Ss[Gn].height,width:Math.max(xs.width/2,Ss[Gn].width)};Cs===xt.ScrollMode.Page?On={left:Gn%2==0?0:Cr.width,top:Math.floor(Gn/2)*Cr.height}:Gn%2==0?(On={left:0,top:mn+=In},In=Gn===ks-1?Ss[Gn].height:Math.max(Ss[Gn].height,Ss[Gn+1].height)):On={left:bs[Gn-1].end.left,top:mn};var Br={left:On.left+Cr.width,top:On.top+Cr.height};bs[Gn]={index:Gn,start:On,size:Cr,end:Br,visibility:-1}}return bs}(yr,ws,Dr,Ir):function(ks,xs,Ss,Cs){for(var bs=[],mn=0,In={left:0,top:0},On=0,Gn=kr,Cr=0;Cr<ks;Cr++){var Br=Ss[Cr];if(Cr===0)mn=Br.width,In={left:0,top:0},On=Br.height;else switch(Cs){case xt.ScrollMode.Wrapped:(mn+=Br.width)<xs.width?(Gn={left:bs[Cr-1].end.left,top:In.top},On=Math.max(On,Br.height)):(mn=Br.width,In={left:(Gn={left:In.left,top:In.top+On}).left,top:Gn.top},On=Br.height);break;case xt.ScrollMode.Horizontal:case xt.ScrollMode.Vertical:default:Gn=bs[Cr-1].end}var rs={left:Gn.left+Br.width,top:Gn.top+Br.height};bs[Cr]={index:Cr,start:Gn,size:Br,end:rs,visibility:-1}}return bs}(yr,ws,Dr,Ir)},[Ir,Dr,Mn,ws]),ao=oo[yr-1]?{height:oo[yr-1].end.top,width:oo[yr-1].end.left}:ss;Rs.current.measurements=oo;var to=Ft.useMemo(function(){var ks=function(Cr,Br,rs,Ms){var uo=0;switch(Cr){case ns.Horizontal:uo=Ms.left;break;case ns.Vertical:default:uo=Ms.top}var Ws=Br.length-1,Is=function(mo,Ol,Xl,au){for(;mo<=Ol;){var Ul=(mo+Ol)/2|0,nu=au(Ul);if(nu<Xl)mo=Ul+1;else{if(!(nu>Xl))return Ul;Ol=Ul-1}}return mo>0?mo-1:0}(0,Ws,uo,function(mo){switch(Cr){case ns.Horizontal:return Br[mo].start.left;case ns.Both:case ns.Vertical:default:return Br[mo].start.top}});if(Cr===ns.Both)for(var ho=Br[Is].start.top;Is-1>=0&&Br[Is-1].start.top===ho&&Br[Is-1].start.left>=Ms.left;)Is--;for(var po=Is;po<=Ws;){var no={top:Br[po].start.top-Ms.top,left:Br[po].start.left-Ms.left},Mo={height:rs.height-no.top,width:rs.width-no.left};if(Cr===ns.Horizontal&&Mo.width<0||Cr===ns.Vertical&&Mo.height<0||Cr===ns.Both&&(Mo.width<0||Mo.height<0))break;po++}return{start:Is,end:po}}(Kr,oo,ws,$s),xs=ks.start,Ss=ks.end,Cs=Ds.slice(xr(0,yr,xs),xr(0,yr,Ss)),bs=xs+Cs.reduce(function(Cr,Br,rs,Ms){return Br>Ms[Cr]?rs:Cr},0),mn=bs=xr(0,yr-1,bs),In=Sr({endPage:Ss,numPages:yr,startPage:xs}),On=In.startPage,Gn=In.endPage;switch(On=Math.max(On,0),Gn=Math.min(Gn,yr-1),Mn){case xt.ViewMode.DualPageWithCover:bs>0&&(mn=bs%2==1?bs:bs-1),On=On===0?0:On%2==1?On:On-1,yr-(Gn=Gn%2==1?Gn-1:Gn)<=2&&(Gn=yr-1);break;case xt.ViewMode.DualPage:mn=bs%2==0?bs:bs-1,On=On%2==0?On:On-1,Gn=Gn%2==1?Gn:Gn-1;break;case xt.ViewMode.SinglePage:default:mn=bs}return{startPage:On,endPage:Gn,maxVisbilityIndex:mn}},[oo,ws,$s,Mn,Ds]),Oo=to.startPage,Ao=to.endPage,No=to.maxVisbilityIndex,Ro=Ft.useMemo(function(){for(var ks=[],xs=function(Cs){var bs=oo[Cs],mn=Ht(Ht({},bs),{visibility:Ds[Cs]!==void 0?Ds[Cs]:-1,measureRef:function(In){In&&(In.setAttribute(cs,"".concat(Cs)),Qs.observe(In))}});ks.push(mn)},Ss=Oo;Ss<=Ao;Ss++)xs(Ss);return ks},[Oo,Ao,Ds,oo]),Do=Ft.useCallback(function(ks,xs){var Ss=Rs.current.measurements[xr(0,yr-1,ks)],Cs=Ur.current===xt.ScrollMode.Page?ls:xs;return Ss?ys({left:Cs.left+Ss.start.left,top:Cs.top+Ss.start.top},qn):Promise.resolve()},[ys,qn]),Io=Ft.useCallback(function(ks,xs){var Ss=Rs.current.measurements,Cs=Ss[ks].start,bs=Ss.find(function(In){return In.start.top-Cs.top>1e-12});if(!bs)return Promise.resolve();var mn=bs.index;switch(_i.current){case xt.ViewMode.DualPage:mn=mn%2==0?mn:mn+1;break;case xt.ViewMode.DualPageWithCover:mn=mn%2==1?mn:mn+1}return Do(mn,xs)},[]),Po=Ft.useCallback(function(ks,xs){for(var Ss=Rs.current.measurements,Cs=Ss[ks].start,bs=ks,mn=!1,In=yr-1;In>=0;In--)if(Cs.top-Ss[In].start.top>1e-12){mn=!0,bs=Ss[In].index;break}if(!mn)return Promise.resolve();switch(_i.current){case xt.ViewMode.DualPage:bs=bs%2==0?bs:bs-1;break;case xt.ViewMode.DualPageWithCover:bs=bs%2==0?bs-1:bs}return bs===ks&&(bs=ks-1),Do(bs,xs)},[]),zo=Ft.useCallback(function(ks,xs){if(_i.current===xt.ViewMode.DualPageWithCover||_i.current===xt.ViewMode.DualPage)return Io(ks,xs);switch(Ur.current){case xt.ScrollMode.Wrapped:return Io(ks,xs);case xt.ScrollMode.Horizontal:case xt.ScrollMode.Vertical:default:return Do(ks+1,xs)}},[]),Yo=Ft.useCallback(function(ks,xs){if(_i.current===xt.ViewMode.DualPageWithCover||_i.current===xt.ViewMode.DualPage)return Po(ks,xs);switch(Ur.current){case xt.ScrollMode.Wrapped:return Po(ks,xs);case xt.ScrollMode.Horizontal:case xt.ScrollMode.Vertical:default:return Do(ks-1,xs)}},[]),na=Ft.useCallback(function(){return function(ks,xs){switch(xs){case xt.ScrollMode.Horizontal:return{position:"relative",height:"100%",width:"".concat(ks.width,"px")};case xt.ScrollMode.Vertical:default:return{position:"relative",height:"".concat(ks.height,"px"),width:"100%"}}}(ao,Ur.current)},[ao]),Vo=Ft.useCallback(function(ks){return function(xs,Ss,Cs){return Cs!==xt.ScrollMode.Page?{}:{height:"".concat(Ss.height,"px"),width:"100%",position:"absolute",top:0,transform:"translateY(".concat(xs.start.top,"px)")}}(ks,ws,Ur.current)},[ws]),Xo=Ft.useCallback(function(ks){return function(xs,Ss,Cs,bs,mn){var In,On,Gn,Cr,Br,rs,Ms,uo=Ss?"right":"left",Ws=Ss?-1:1,Is=Cs.length,ho=xs.start.left*Ws,po=xs.size,no=po.height,Mo=po.width;if(bs===xt.ViewMode.DualPageWithCover){var mo=mn===xt.ScrollMode.Page?0:xs.start.top;return xs.index===0||Is%2==0&&xs.index===Is-1?((In={height:"".concat(no,"px"),minWidth:"".concat(dr(Cs,bs),"px"),width:"100%"})[uo]=0,In.position="absolute",In.top=0,In.transform="translate(".concat(ho,"px, ").concat(mo,"px)"),In):((On={height:"".concat(no,"px"),width:"".concat(Mo,"px")})[uo]=0,On.position="absolute",On.top=0,On.transform="translate(".concat(ho,"px, ").concat(mo,"px)"),On)}if(bs===xt.ViewMode.DualPage)return(Gn={height:"".concat(no,"px"),width:"".concat(Mo,"px")})[uo]=0,Gn.position="absolute",Gn.top=0,Gn.transform="translate(".concat(ho,"px, ").concat(mn===xt.ScrollMode.Page?0:xs.start.top,"px)"),Gn;switch(mn){case xt.ScrollMode.Horizontal:return(Cr={height:"100%",width:"".concat(Mo,"px")})[uo]=0,Cr.position="absolute",Cr.top=0,Cr.transform="translateX(".concat(ho,"px)"),Cr;case xt.ScrollMode.Page:return(Br={height:"".concat(no,"px"),width:"".concat(Mo,"px")})[uo]=0,Br.position="absolute",Br.top=0,Br;case xt.ScrollMode.Wrapped:return(rs={height:"".concat(no,"px"),width:"".concat(Mo,"px")})[uo]=0,rs.position="absolute",rs.top=0,rs.transform="translate(".concat(ho,"px, ").concat(xs.start.top,"px)"),rs;case xt.ScrollMode.Vertical:default:return(Ms={height:"".concat(no,"px"),width:"100%"})[uo]=0,Ms.position="absolute",Ms.top=0,Ms.transform="translateY(".concat(xs.start.top,"px)"),Ms}}(ks,fr,Dr,_i.current,Ur.current)},[fr,Dr]),xl=Ft.useCallback(function(ks,xs){var Ss=Rs.current,Cs=Ss.measurements,bs=Ss.scrollOffset,mn=Cs[xr(0,yr-1,xs)];if(mn){var In=Ur.current===xt.ScrollMode.Page?{left:mn.start.left,top:mn.start.top}:{left:bs.left*ks,top:bs.top*ks};return ys(In,!1)}return Promise.resolve()},[]);return Ft.useEffect(function(){return function(){Qs.disconnect()}},[]),{boundingClientRect:ws,isSmoothScrolling:er,startPage:Oo,endPage:Ao,maxVisbilityIndex:No,virtualItems:Ro,getContainerStyles:na,getItemContainerStyles:Vo,getItemStyles:Xo,scrollToItem:Do,scrollToNextItem:zo,scrollToPreviousItem:Yo,zoom:xl}},qs=function(Nn,qn,fr,yr,Er,Sr){var Dr=fr;switch(!0){case(Er===xt.ViewMode.DualPageWithCover&&Sr>=3):case(Er===xt.ViewMode.DualPage&&Sr>=3):Dr=2*fr;break;default:Dr=fr}switch(yr){case xt.SpecialZoomLevel.ActualSize:return 1;case xt.SpecialZoomLevel.PageFit:return Math.min((Nn.clientWidth-17)/Dr,(Nn.clientHeight-16)/qn);case xt.SpecialZoomLevel.PageWidth:return(Nn.clientWidth-17)/Dr}},Os=function(Nn){var qn,fr,yr=Nn.getCurrentPage,Er=(qn=50,fr=Ft.useRef([]),Ft.useEffect(function(){return function(){fr.current=[]}},[]),{push:function(zn){var er=fr.current;er.length+1>qn&&er.shift(),er.push(zn),fr.current=er},map:function(zn){return fr.current.map(function(er){return zn(er)})},pop:function(){var zn=fr.current;if(zn.length===0)return null;var er=zn.pop();return fr.current=zn,er}}),Sr=function(zn){var er=Ft.useRef([]);return Ft.useEffect(function(){return function(){er.current=[]}},[]),{dequeue:function(){var Nr=er.current;if(Nr.length===0)return null;var Vr=Nr.shift();return er.current=Nr,Vr||null},enqueue:function(Nr){var Vr=er.current;Vr.length+1>zn&&Vr.pop(),er.current=[Nr].concat(Vr)},map:function(Nr){return er.current.map(function(Vr){return Nr(Vr)})}}}(50),Dr=function(){var zn=Sr.dequeue();return zn&&Er.push(zn),zn&&zn.pageIndex===yr()?Dr():zn},Ir=function(){var zn=Er.pop();return zn&&Sr.enqueue(zn),zn&&zn.pageIndex===yr()?Ir():zn},Mn=Ft.useCallback(function(zn){Er.push(zn)},[]);return{getNextDestination:Dr,getPreviousDestination:Ir,markVisitedDestination:Mn}},eo=function(Nn){var qn=[];return Nn.map(function(fr){qn=qn.concat(fr).concat(function(yr){var Er=[];return yr.items&&yr.items.length>0&&(Er=Er.concat(eo(yr.items))),Er}(fr))}),qn},xo={capture:!1,passive:!0},So={height:0,width:0},Uo={height:0,width:0},$a=function(Nn){var qn=Nn.getCurrentPage,fr=Nn.getCurrentScrollMode,yr=Nn.jumpToPage,Er=Nn.targetRef,Sr=Ft.useState(xt.FullScreenMode.Normal),Dr=Sr[0],Ir=Sr[1],Mn=function(){var Ds=Ft.useState(So),io=Ds[0],Qs=Ds[1],oo=xn(function(){Qs({height:window.innerHeight,width:window.innerWidth})},100);return Yt(function(){return window.addEventListener("resize",oo,xo),function(){window.removeEventListener("resize",oo,xo)}},[]),io}(),zn=Ft.useState(Uo),er=zn[0],Nr=zn[1],Vr=Ft.useRef(Uo),Ur=Ft.useRef(qn()),_i=Ft.useRef(Uo),Kr=Ft.useState(Er.current),Qr=Kr[0],$s=Kr[1],ys=Ft.useRef();Yt(function(){Er.current!==Qr&&$s(Er.current)},[]),Yt(function(){if(Qr){var Ds=new ResizeObserver(function(io){io.forEach(function(Qs){var oo=Qs.target.getBoundingClientRect(),ao=oo.height,to=oo.width;Nr({height:ao,width:to})})});return Ds.observe(Qr),function(){Ds.unobserve(Qr),Ds.disconnect()}}},[Qr]);var ws=Ft.useCallback(function(Ds){var io=bn();return io&&io!==Ds?(Ir(xt.FullScreenMode.Normal),En(io)):Promise.resolve()},[]),Rs=Ft.useCallback(function(Ds){Ds&&gn()&&($s(Ds),ws(Ds).then(function(){ys.current=Ds,Ir(xt.FullScreenMode.Entering),function(io){pn&&io[yn.RequestFullScreen]()}(Ds)}))},[]),Es=Ft.useCallback(function(){bn()&&(Ir(xt.FullScreenMode.Exitting),En(document))},[]),Ns=Ft.useCallback(function(){Qr&&bn()!==Qr&&Ir(xt.FullScreenMode.Exitting)},[Qr]);return Ft.useEffect(function(){switch(Dr){case xt.FullScreenMode.Entering:ys.current&&(ys.current.style.backgroundColor="var(--rpv-core__full-screen-target-background-color)"),Ur.current=qn(),Vr.current={height:window.innerHeight,width:window.innerWidth};break;case xt.FullScreenMode.Entered:fr()===xt.ScrollMode.Page?yr(Ur.current).then(function(){Ir(xt.FullScreenMode.EnteredCompletely)}):Ir(xt.FullScreenMode.EnteredCompletely);break;case xt.FullScreenMode.Exitting:ys.current&&(ys.current.style.backgroundColor="",ys.current=null),Ur.current=qn();break;case xt.FullScreenMode.Exited:Ir(xt.FullScreenMode.Normal),fr()===xt.ScrollMode.Page&&yr(Ur.current)}},[Dr]),Ft.useEffect(function(){if(Dr!==xt.FullScreenMode.Normal)return Dr===xt.FullScreenMode.Entering&&Mn.height===er.height&&Mn.width===er.width&&Mn.height>0&&Mn.width>0&&(_i.current.height===0||Mn.height==_i.current.height)?(_i.current={height:window.innerHeight,width:window.innerWidth},void Ir(xt.FullScreenMode.Entered)):void(Dr===xt.FullScreenMode.Exitting&&Vr.current.height===Mn.height&&Vr.current.width===Mn.width&&Mn.height>0&&Mn.width>0&&Ir(xt.FullScreenMode.Exited))},[Dr,Mn,er]),Ft.useEffect(function(){var Ds;return Ds=Ns,pn&&document.addEventListener(yn.FullScreenChange,Ds),function(){(function(io){pn&&document.removeEventListener(yn.FullScreenChange,io)})(Ns)}},[Qr]),{enterFullScreenMode:Rs,exitFullScreenMode:Es,fullScreenMode:Dr}},Sl={buildPageStyles:function(){return{}},transformSize:function(Nn){return Nn.size}},yl={left:0,top:0},Rl=function(Nn){var qn=Nn.currentFile,fr=Nn.defaultScale,yr=Nn.doc,Er=Nn.enableSmoothScroll,Sr=Nn.initialPage,Dr=Nn.initialRotation,Ir=Nn.initialScale,Mn=Nn.pageLayout,zn=Nn.pageSizes,er=Nn.plugins,Nr=Nn.renderPage,Vr=Nn.scrollMode,Ur=Nn.setRenderRange,_i=Nn.viewMode,Kr=Nn.viewerState,Qr=Nn.onDocumentLoad,$s=Nn.onOpenFile,ys=Nn.onPageChange,ws=Nn.onRotate,Rs=Nn.onRotatePage,Es=Nn.onZoom,Ns=yr.numPages,Ds=yr.loadingTask.docId,io=Ft.useContext(Sn).l10n,Qs=Ft.useContext(qt),oo=Qs.direction===xt.TextDirection.RightToLeft,ao=Ft.useRef(),to=Ft.useRef(),Oo=Ft.useState(Sr),Ao=Oo[0],No=Oo[1],Ro=Ft.useRef(null),Do=Os({getCurrentPage:function(){return Is.current.pageIndex}}),Io=Ft.useState(Dr),Po=Io[0],zo=Io[1],Yo=$n(Po),na=Ft.useState(!1),Vo=na[0],Xo=na[1],xl=Ft.useState(new Map),ks=xl[0],xs=xl[1],Ss=Ft.useState(Vr),Cs=Ss[0],bs=Ss[1],mn=$n(Cs),In=Ft.useState(_i),On=In[0],Gn=In[1],Cr=$n(On),Br=function(as){var Gs=Cn(),Js=Ft.useState([]),bo=Js[0],yo=Js[1];return Ft.useEffect(function(){as.getOutline().then(function(Zs){if(Gs.current&&Zs!==null){var Ho=eo(Zs);yo(Ho)}})},[]),bo}(yr),rs=Ft.useState(Ir),Ms=rs[0],uo=rs[1],Ws=$n(Ms),Is=Ft.useRef(Kr),ho=Ft.useRef(typeof fr=="string"?fr:null),po=Ft.useRef(-1),no=Ft.useRef(-1),Mo=Ft.useRef(Sr),mo=$a({getCurrentPage:function(){return Is.current.pageIndex},getCurrentScrollMode:function(){return Is.current.scrollMode},jumpToPage:function(as){return Ml(as)},targetRef:to}),Ol=Ft.useState(-1),Xl=Ol[0],au=Ol[1],Ul=Ft.useState(0),nu=Ul[0],kp=Ul[1],xa=Dn({doc:yr});Ft.useEffect(function(){return function(){Tr.clear(),Hr.clear()}},[Ds]);var Ku=Ft.useMemo(function(){return Object.assign({},Sl,Mn)},[]),Np=Ft.useMemo(function(){return Array(Ns).fill(0).map(function(as,Gs){var Js=[zn[Gs].pageHeight,zn[Gs].pageWidth],bo=Math.abs(Po)%180==0?{height:Js[0],width:Js[1]}:{height:Js[1],width:Js[0]},yo={height:bo.height*Ms,width:bo.width*Ms};return Ku.transformSize({numPages:Ns,pageIndex:Gs,size:yo})})},[Po,Ms]),wo=As({enableSmoothScroll:Er,isRtl:oo,numberOfItems:Ns,parentRef:to,scrollMode:Cs,setRenderRange:Ur,sizes:Np,viewMode:On}),Mp=xn(function(){!ho.current||Is.current.fullScreenMode!==xt.FullScreenMode.Normal||Sr>0&&Mo.current===Sr||zl(ho.current)},200);(function(as){var Gs=as.targetRef,Js=as.onResize;Yt(function(){var bo=new ResizeObserver(function(Zs){Zs.forEach(function(Ho){Js(Ho.target)})}),yo=Gs.current;if(yo)return bo.observe(yo),function(){bo.unobserve(yo)}},[])})({targetRef:to,onResize:Mp});var Nl=function(as){var Gs=as;er.forEach(function(Js){Js.onViewerStateChange&&(Gs=Js.onViewerStateChange(Gs))}),Is.current=Gs},Lp=function(){return to.current},Fp=function(){return Is.current},jp=Ft.useCallback(function(as){Do.markVisitedDestination(as)},[]),gu=Ft.useCallback(function(as){var Gs=as.pageIndex,Js=as.bottomOffset,bo=as.leftOffset,yo=as.scaleTo,Zs=to.current,Ho=Is.current;return Zs&&Ho?new Promise(function(Ll,Tu){ur(yr,Gs).then(function(lu){var Fl=lu.getViewport({scale:1}),uu=0,rp=(typeof Js=="function"?Js(Fl.width,Fl.height):Js)||0,cu=(typeof bo=="function"?bo(Fl.width,Fl.height):bo)||0,Ql=Ho.scale;switch(yo){case xt.SpecialZoomLevel.PageFit:uu=0,cu=0,zl(xt.SpecialZoomLevel.PageFit);break;case xt.SpecialZoomLevel.PageWidth:Ql=qs(Zs,zn[Gs].pageHeight,zn[Gs].pageWidth,xt.SpecialZoomLevel.PageWidth,_i,Ns),uu=(Fl.height-rp)*Ql,cu*=Ql,zl(Ql);break;default:uu=(Fl.height-rp)*Ql,cu*=Ql}switch(Ho.scrollMode){case xt.ScrollMode.Horizontal:wo.scrollToItem(Gs,{left:cu,top:0}).then(function(){Ll()});break;case xt.ScrollMode.Vertical:default:wo.scrollToItem(Gs,{left:0,top:uu}).then(function(){Ll()})}})}):Promise.resolve()},[]),Xu=Ft.useCallback(function(as){return Do.markVisitedDestination(as),gu(as)},[]),Bp=Ft.useCallback(function(){var as=Do.getNextDestination();return as?gu(as):Promise.resolve()},[]),Vp=Ft.useCallback(function(){var as=Do.getPreviousDestination();return as?gu(as):Promise.resolve()},[]),Up=Ft.useCallback(function(){return wo.scrollToNextItem(Is.current.pageIndex,yl)},[]),Ml=Ft.useCallback(function(as){return 0<=as&&as<Ns?wo.scrollToItem(as,yl):Promise.resolve()},[]),zp=Ft.useCallback(function(){return wo.scrollToPreviousItem(Is.current.pageIndex,yl)},[]),Qu=Ft.useCallback(function(as){var Gs,Js;(Gs=as.name,Js=Gs.split(/\./).pop(),Js?Js.toLowerCase():"").toLowerCase()==="pdf"&&new Promise(function(bo){var yo=new FileReader;yo.readAsArrayBuffer(as),yo.onload=function(){var Zs=new Uint8Array(yo.result);bo(Zs)}}).then(function(bo){$s(as.name,bo)})},[$s]),Ju=Ft.useCallback(function(as){var Gs=as===xt.RotateDirection.Backward?-90:90,Js=Is.current.rotation,bo=Js===360||Js===-360?Gs:Js+Gs;xa.markNotRendered(),zo(bo),Nl(Ht(Ht({},Is.current),{rotation:bo})),ws({direction:as,doc:yr,rotation:bo})},[]),yu=Ft.useCallback(function(as,Gs){var Js=Gs===xt.RotateDirection.Backward?-90:90,bo=Is.current.pagesRotation,yo=(bo.has(as)?bo.get(as):Dr)+Js,Zs=bo.set(as,yo);xs(Zs),Xo(function(Ho){return!Ho}),Nl(Ht(Ht({},Is.current),{pagesRotation:Zs,rotatedPage:as})),Rs({direction:Gs,doc:yr,pageIndex:as,rotation:yo}),xa.markRendering(as),au(as)},[]),Zu=Ft.useCallback(function(as){Nl(Ht(Ht({},Is.current),{scrollMode:as})),bs(as)},[]),ep=Ft.useCallback(function(as){Nl(Ht(Ht({},Is.current),{viewMode:as})),Gn(as)},[]),zl=Ft.useCallback(function(as){var Gs=to.current,Js=Is.current.pageIndex;if(!(Js<0||Js>=Ns)){var bo=zn[Js].pageHeight,yo=zn[Js].pageWidth,Zs=Gs?typeof as=="string"?qs(Gs,bo,yo,as,Is.current.viewMode,Ns):as:1;ho.current=typeof as=="string"?as:null,Zs!==Is.current.scale&&(kp(function(Ho){return Ho+1}),xa.markNotRendered(),uo(Zs),Es({doc:yr,scale:Zs}),Nl(Ht(Ht({},Is.current),{scale:Zs})))}},[]),Hp=Ft.useCallback(function(as){mo.enterFullScreenMode(as)},[]),Gp=Ft.useCallback(function(){mo.exitFullScreenMode()},[]);Ft.useEffect(function(){Nl(Ht(Ht({},Is.current),{fullScreenMode:mo.fullScreenMode}))},[mo.fullScreenMode]),Ft.useEffect(function(){var as={enterFullScreenMode:Hp,exitFullScreenMode:Gp,getPagesContainer:Lp,getViewerState:Fp,jumpToDestination:Xu,jumpToNextDestination:Bp,jumpToPreviousDestination:Vp,jumpToNextPage:Up,jumpToPreviousPage:zp,jumpToPage:Ml,openFile:Qu,rotate:Ju,rotatePage:yu,setViewerState:Nl,switchScrollMode:Zu,switchViewMode:ep,zoom:zl};return er.forEach(function(Gs){Gs.install&&Gs.install(as)}),function(){er.forEach(function(Gs){Gs.uninstall&&Gs.uninstall(as)})}},[Ds]),Ft.useEffect(function(){Qr({doc:yr,file:qn}),er.forEach(function(as){as.onDocumentLoad&&as.onDocumentLoad({doc:yr,file:qn})})},[Ds]);var Eu,vu,bu,tp=wo.boundingClientRect;Eu=function(){Sr&&Ml(Sr)},vu=tp.height>0&&tp.width>0,bu=Ft.useRef(!1),Yt(function(){vu&&!bu.current&&(bu.current=!0,Eu())},[Eu,vu]),Yt(function(){var as=Is.current.pageIndex;as>-1&&mn!==Cs&&wo.scrollToItem(as,yl).then(function(){mo.fullScreenMode===xt.FullScreenMode.EnteredCompletely&&(Er||xa.markNotRendered(),po.current=-1)})},[Cs]),Yt(function(){var as=Is.current.pageIndex;as>-1&&Yo!==Po&&wo.scrollToItem(as,yl)},[Po]),Yt(function(){Ws!=0&&Ws!=Is.current.scale&&wo.zoom(Is.current.scale/Ws,Is.current.pageIndex).then(function(){mo.fullScreenMode===xt.FullScreenMode.EnteredCompletely&&(no.current=-1)})},[Ms]),Yt(function(){if(Cr!==Is.current.viewMode){var as=wo.startPage,Gs=wo.endPage,Js=wo.virtualItems;xa.markNotRendered(),xa.setRange(as,Gs);for(var bo=function(Zs){var Ho=Js.find(function(Ll){return Ll.index===Zs});Ho&&xa.setVisibility(Zs,Ho.visibility)},yo=as;yo<=Gs;yo++)bo(yo);xu()}},[On]),Yt(function(){var as=Is.current.pageIndex;as>-1&&Cr!==On&&wo.scrollToItem(as,yl)},[On]),Yt(function(){var as=Is.current.pageIndex;as>0&&as===Sr&&Mo.current===Sr&&ho.current&&(Mo.current=-1,zl(ho.current))},[Ao]),Ft.useEffect(function(){wo.isSmoothScrolling||Ro.current!==null&&Ro.current===Ao||(Ro.current=Ao,ys({currentPage:Ao,doc:yr}))},[Ao,wo.isSmoothScrolling]),Ft.useEffect(function(){mo.fullScreenMode===xt.FullScreenMode.Entering&&Is.current.scrollMode===xt.ScrollMode.Page&&(po.current=Is.current.pageIndex),mo.fullScreenMode===xt.FullScreenMode.EnteredCompletely&&Is.current.scrollMode===xt.ScrollMode.Page&&Er&&(po.current=-1),mo.fullScreenMode===xt.FullScreenMode.EnteredCompletely&&ho.current&&(no.current=Is.current.pageIndex,zl(ho.current))},[mo.fullScreenMode]),Ft.useEffect(function(){if(mo.fullScreenMode!==xt.FullScreenMode.Entering&&mo.fullScreenMode!==xt.FullScreenMode.Exitting&&!wo.isSmoothScrolling){var as=wo.startPage,Gs=wo.endPage,Js=wo.maxVisbilityIndex,bo=wo.virtualItems,yo=Js,Zs=mo.fullScreenMode===xt.FullScreenMode.Entered||mo.fullScreenMode===xt.FullScreenMode.EnteredCompletely;if(!(Zs&&yo!==po.current&&po.current>-1||Zs&&yo!==no.current&&no.current>-1)){No(yo),Nl(Ht(Ht({},Is.current),{pageIndex:yo})),xa.setRange(as,Gs);for(var Ho=function(Tu){var lu=bo.find(function(Fl){return Fl.index===Tu});lu&&xa.setVisibility(Tu,lu.visibility)},Ll=as;Ll<=Gs;Ll++)Ho(Ll);xu()}}},[wo.startPage,wo.endPage,wo.isSmoothScrolling,wo.maxVisbilityIndex,mo.fullScreenMode,Vo,Po,Ms]);var qp=Ft.useCallback(function(as){xa.markRendered(as),xu()},[nu]),xu=function(){var as=xa.getHighestPriorityPage();as>-1&&xa.isInRange(as)&&(xa.markRendering(as),au(as))},Wp=function(as){var Gs=Ao-1,Js=Ao+1;switch(as){case"FirstPage":Ml(0);break;case"LastPage":Ml(Ns-1);break;case"NextPage":Js<Ns&&Ml(Js);break;case"PrevPage":Gs>=0&&Ml(Gs)}},Yp=Ft.useCallback(function(){var as=wo.virtualItems,Gs=[];switch(On){case xt.ViewMode.DualPage:Gs=Mr(as,2);break;case xt.ViewMode.DualPageWithCover:as.length&&(Gs=as[0].index===0?[[as[0]]].concat(Mr(as.slice(1),2)):Mr(as,2));break;case xt.ViewMode.SinglePage:default:Gs=Mr(as,1)}var Js=io&&io.core?io.core.pageLabel:"Page {{pageIndex}}",bo={attrs:{className:"rpv-core__inner-container","data-testid":"core__inner-container",ref:ao,style:{height:"100%"}},children:Ft.createElement(Ft.Fragment,null),subSlot:{attrs:{"data-testid":"core__inner-pages",className:Wt({"rpv-core__inner-pages":!0,"rpv-core__inner-pages--horizontal":Cs===xt.ScrollMode.Horizontal,"rpv-core__inner-pages--rtl":oo,"rpv-core__inner-pages--single":Cs===xt.ScrollMode.Page,"rpv-core__inner-pages--vertical":Cs===xt.ScrollMode.Vertical,"rpv-core__inner-pages--wrapped":Cs===xt.ScrollMode.Wrapped}),ref:to,style:{height:"100%",position:"relative"}},children:Ft.createElement("div",{"data-testid":"core__inner-current-page-".concat(Ao),style:Object.assign({"--scale-factor":Ms},wo.getContainerStyles())},Gs.map(function(yo){return Ft.createElement("div",{className:Wt({"rpv-core__inner-page-container":!0,"rpv-core__inner-page-container--single":Cs===xt.ScrollMode.Page}),style:wo.getItemContainerStyles(yo[0]),key:"".concat(yo[0].index,"-").concat(On)},yo.map(function(Zs){var Ho=On===xt.ViewMode.DualPageWithCover&&(Zs.index===0||Ns%2==0&&Zs.index===Ns-1);return Ft.createElement("div",{"aria-label":Js.replace("{{pageIndex}}","".concat(Zs.index+1)),className:Wt({"rpv-core__inner-page":!0,"rpv-core__inner-page--dual-even":On===xt.ViewMode.DualPage&&Zs.index%2==0,"rpv-core__inner-page--dual-odd":On===xt.ViewMode.DualPage&&Zs.index%2==1,"rpv-core__inner-page--dual-cover":Ho,"rpv-core__inner-page--dual-cover-even":On===xt.ViewMode.DualPageWithCover&&!Ho&&Zs.index%2==0,"rpv-core__inner-page--dual-cover-odd":On===xt.ViewMode.DualPageWithCover&&!Ho&&Zs.index%2==1,"rpv-core__inner-page--single":On===xt.ViewMode.SinglePage&&Cs===xt.ScrollMode.Page}),role:"region",key:"".concat(Zs.index,"-").concat(On),style:Object.assign({},wo.getItemStyles(Zs),Ku.buildPageStyles({numPages:Ns,pageIndex:Zs.index,scrollMode:Cs,viewMode:On}))},Ft.createElement(Fo,{doc:yr,measureRef:Zs.measureRef,outlines:Br,pageIndex:Zs.index,pageRotation:ks.has(Zs.index)?ks.get(Zs.index):0,pageSize:zn[Zs.index],plugins:er,renderPage:Nr,renderQueueKey:nu,rotation:Po,scale:Ms,shouldRender:Xl===Zs.index,viewMode:On,onExecuteNamedAction:Wp,onJumpFromLinkAnnotation:jp,onJumpToDest:Xu,onRenderCompleted:qp,onRotatePage:yu}))}))}))}};return er.forEach(function(yo){yo.renderViewer&&(bo=yo.renderViewer({containerRef:ao,doc:yr,pagesContainerRef:to,pagesRotation:ks,pageSizes:zn,rotation:Po,slot:bo,themeContext:Qs,jumpToPage:Ml,openFile:Qu,rotate:Ju,rotatePage:yu,switchScrollMode:Zu,switchViewMode:ep,zoom:zl}))}),bo},[er,wo]),np=Ft.useCallback(function(as){return Ft.createElement("div",Ht({},as.attrs,{style:as.attrs&&as.attrs.style?as.attrs.style:{}}),as.children,as.subSlot&&np(as.subSlot))},[]);return np(Yp())},Bl=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.3,1.5,1.7,1.9,2.1,2.4,2.7,3,3.3,3.7,4.1,4.6,5.1,5.7,6.3,7,7.7,8.5,9.4,10],Zo=function(Nn){var qn=Nn.defaultScale,fr=Nn.doc,yr=Nn.render,Er=Nn.scrollMode,Sr=Nn.viewMode,Dr=Ft.useRef(),Ir=Ft.useState({pageSizes:[],scale:0}),Mn=Ir[0],zn=Ir[1];return Ft.useLayoutEffect(function(){var er=Array(fr.numPages).fill(0).map(function(Nr,Vr){return new Promise(function(Ur,_i){ur(fr,Vr).then(function(Kr){var Qr=Kr.getViewport({scale:1});Ur({pageHeight:Qr.height,pageWidth:Qr.width,rotation:Qr.rotation})})})});Promise.all(er).then(function(Nr){var Vr=Dr.current;if(Vr&&Nr.length!==0){var Ur=Nr[0].pageWidth,_i=Nr[0].pageHeight,Kr=Vr.parentElement,Qr=(Kr.clientWidth-45)/Ur,$s=(Kr.clientHeight-45)/_i,ys=Qr;switch(Er){case xt.ScrollMode.Horizontal:ys=Math.min(Qr,$s);break;case xt.ScrollMode.Vertical:default:ys=Qr}var ws,Rs,Es=qn?typeof qn=="string"?qs(Kr,_i,Ur,qn,Sr,fr.numPages):qn:(ws=ys,(Rs=Bl.findIndex(function(Ns){return Ns>=ws}))===-1||Rs===0?ws:Bl[Rs-1]);zn({pageSizes:Nr,scale:Es})}})},[fr.loadingTask.docId]),Mn.pageSizes.length===0||Mn.scale===0?Ft.createElement("div",{className:"rpv-core__page-size-calculator","data-testid":"core__page-size-calculating",ref:Dr},Ft.createElement(Zt,null)):yr(Mn.pageSizes,Mn.scale)},qo=function(){},ba=function(Nn){function qn(fr,yr){var Er=Nn.call(this)||this;return Er.verifyPassword=fr,Er.passwordStatus=yr,Er}return Vt(qn,Nn),qn}(qo),Dl=function(Nn){var qn=Nn.passwordStatus,fr=Nn.renderProtectedView,yr=Nn.verifyPassword,Er=Nn.onDocumentAskPassword,Sr=Ft.useContext(Sn).l10n,Dr=Ft.useState(""),Ir=Dr[0],Mn=Dr[1],zn=Ft.useContext(qt).direction===xt.TextDirection.RightToLeft,er=function(){return yr(Ir)};return Ft.useEffect(function(){Er&&Er({verifyPassword:yr})},[]),fr?fr({passwordStatus:qn,verifyPassword:yr}):Ft.createElement("div",{className:"rpv-core__asking-password-wrapper"},Ft.createElement("div",{className:Wt({"rpv-core__asking-password":!0,"rpv-core__asking-password--rtl":zn})},Ft.createElement("div",{className:"rpv-core__asking-password-message"},qn===xt.PasswordStatus.RequiredPassword&&Sr.core.askingPassword.requirePasswordToOpen,qn===xt.PasswordStatus.WrongPassword&&Sr.core.wrongPassword.tryAgain),Ft.createElement("div",{className:"rpv-core__asking-password-body"},Ft.createElement("div",{className:Wt({"rpv-core__asking-password-input":!0,"rpv-core__asking-password-input--ltr":!zn,"rpv-core__asking-password-input--rtl":zn})},Ft.createElement(sn,{testId:"core__asking-password-input",type:"password",value:Ir,onChange:Mn,onKeyDown:function(Nr){Nr.key==="Enter"&&er()}})),Ft.createElement(Jt,{onClick:er},Sr.core.askingPassword.submit))))},Vl=function(Nn){function qn(fr){var yr=Nn.call(this)||this;return yr.doc=fr,yr}return Vt(qn,Nn),qn}(qo),El=function(Nn){function qn(fr){var yr=Nn.call(this)||this;return yr.error=fr,yr}return Vt(qn,Nn),qn}(qo),Il=function(Nn){function qn(fr){var yr=Nn.call(this)||this;return yr.percentages=fr,yr}return Vt(qn,Nn),qn}(qo),Kl=function(Nn){var qn=Nn.characterMap,fr=Nn.file,yr=Nn.httpHeaders,Er=Nn.render,Sr=Nn.renderError,Dr=Nn.renderLoader,Ir=Nn.renderProtectedView,Mn=Nn.transformGetDocumentParams,zn=Nn.withCredentials,er=Nn.onDocumentAskPassword,Nr=Ft.useContext(qt).direction===xt.TextDirection.RightToLeft,Vr=Ft.useState(new Il(0)),Ur=Vr[0],_i=Vr[1],Kr=Ft.useRef(""),Qr=Cn();return Ft.useEffect(function(){Kr.current="",_i(new Il(0));var $s=new jt.PDFWorker({name:"PDFWorker_".concat(Date.now())}),ys=Object.assign({httpHeaders:yr,withCredentials:zn,worker:$s},typeof fr=="string"?{url:fr}:{data:fr},qn?{cMapUrl:qn.url,cMapPacked:qn.isCompressed}:{}),ws=Mn?Mn(ys):ys,Rs=jt.getDocument(ws);return Rs.onPassword=function(Es,Ns){switch(Ns){case jt.PasswordResponses.NEED_PASSWORD:Qr.current&&_i(new ba(Es,xt.PasswordStatus.RequiredPassword));break;case jt.PasswordResponses.INCORRECT_PASSWORD:Qr.current&&_i(new ba(Es,xt.PasswordStatus.WrongPassword))}},Rs.onProgress=function(Es){var Ns=Es.total>0?Math.min(100,100*Es.loaded/Es.total):100;Qr.current&&Kr.current===""&&_i(new Il(Ns))},Rs.promise.then(function(Es){Kr.current=Es.loadingTask.docId,Qr.current&&_i(new Vl(Es))},function(Es){return Qr.current&&!$s.destroyed&&_i(new El({message:Es.message||"Cannot load document",name:Es.name}))}),function(){Rs.destroy(),$s.destroy()}},[fr]),Ur instanceof ba?Ft.createElement(Dl,{passwordStatus:Ur.passwordStatus,renderProtectedView:Ir,verifyPassword:Ur.verifyPassword,onDocumentAskPassword:er}):Ur instanceof Vl?Er(Ur.doc):Ur instanceof El?Sr?Sr(Ur.error):Ft.createElement("div",{className:Wt({"rpv-core__doc-error":!0,"rpv-core__doc-error--rtl":Nr})},Ft.createElement("div",{className:"rpv-core__doc-error-text"},Ur.error.message)):Ft.createElement("div",{"data-testid":"core__doc-loading",className:Wt({"rpv-core__doc-loading":!0,"rpv-core__doc-loading--rtl":Nr})},Dr?Dr(Ur.percentages):Ft.createElement(Zt,null))},Al=function(Nn,qn){var fr=Ft.useMemo(function(){return Nn==="auto"?typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":Nn},[]),yr=Ft.useState(fr),Er=yr[0],Sr=yr[1],Dr=$n(Er);return Ft.useEffect(function(){if(Nn==="auto"){var Ir=window.matchMedia("(prefers-color-scheme: dark)"),Mn=function(zn){Sr(zn.matches?"dark":"light")};return Ir.addEventListener("change",Mn),function(){return Ir.removeEventListener("change",Mn)}}},[]),Ft.useEffect(function(){Er!==Dr&&qn&&qn(Er)},[Er]),Ft.useEffect(function(){Nn!==Er&&Sr(Nn)},[Nn]),{currentTheme:Er,setCurrentTheme:Sr}},Qo=function(Nn){return{startPage:Nn.startPage-3,endPage:Nn.endPage+3}};xt.Button=function(Nn){var qn=Nn.children,fr=Nn.testId,yr=Nn.onClick,Er=Ft.useContext(qt).direction===xt.TextDirection.RightToLeft,Sr=fr?{"data-testid":fr}:{};return Ft.createElement("button",Ht({className:Wt({"rpv-core__button":!0,"rpv-core__button--rtl":Er}),type:"button",onClick:yr},Sr),qn)},xt.Icon=Xt,xt.LazyRender=function(Nn){var qn=Nn.attrs,fr=Nn.children,yr=Nn.testId,Er=Ft.useState(!1),Sr=Er[0],Dr=Er[1],Ir=yr?Ht(Ht({},qn),{"data-testid":yr}):qn,Mn=Kt({once:!0,onVisibilityChanged:function(zn){zn.isVisible&&Dr(!0)}});return Ft.createElement("div",Ht({ref:Mn},Ir),Sr&&fr)},xt.LocalizationContext=Sn,xt.Menu=function(Nn){var qn=Nn.children,fr=Ft.useRef(),yr=Ft.useRef([]),Er=Ft.useContext(qt).direction===xt.TextDirection.RightToLeft,Sr=function(Ir){if(fr.current)switch(Ir.key){case"Tab":Ir.preventDefault();break;case"ArrowDown":Ir.preventDefault(),Dr(function(Mn,zn){return zn+1});break;case"ArrowUp":Ir.preventDefault(),Dr(function(Mn,zn){return zn-1});break;case"End":Ir.preventDefault(),Dr(function(Mn,zn){return Mn.length-1});break;case"Home":Ir.preventDefault(),Dr(function(Mn,zn){return 0})}},Dr=function(Ir){if(fr.current){var Mn=yr.current,zn=Mn.findIndex(function(Nr){return Nr.getAttribute("tabindex")==="0"}),er=Math.min(Mn.length-1,Math.max(0,Ir(Mn,zn)));zn>=0&&zn<=Mn.length-1&&Mn[zn].setAttribute("tabindex","-1"),Mn[er].setAttribute("tabindex","0"),Mn[er].focus()}};return Yt(function(){var Ir=fr.current;if(Ir){var Mn=function(zn){var er=[];return zn.querySelectorAll('.rpv-core__menu-item[role="menuitem"]').forEach(function(Nr){if(Nr instanceof HTMLElement){var Vr=Nr.parentElement;(Vr===zn||window.getComputedStyle(Vr).display!=="none")&&er.push(Nr)}}),er}(Ir);yr.current=Mn}},[]),Yt(function(){return document.addEventListener("keydown",Sr),function(){document.removeEventListener("keydown",Sr)}},[]),Ft.createElement("div",{ref:fr,"aria-orientation":"vertical",className:Wt({"rpv-core__menu":!0,"rpv-core__menu--rtl":Er}),role:"menu",tabIndex:0},qn)},xt.MenuDivider=function(){return Ft.createElement("div",{"aria-orientation":"horizontal",className:"rpv-core__menu-divider",role:"separator"})},xt.MenuItem=function(Nn){var qn=Nn.checked,fr=qn!==void 0&&qn,yr=Nn.children,Er=Nn.icon,Sr=Er===void 0?null:Er,Dr=Nn.isDisabled,Ir=Dr!==void 0&&Dr,Mn=Nn.testId,zn=Nn.onClick,er=Ft.useContext(qt).direction===xt.TextDirection.RightToLeft,Nr=Mn?{"data-testid":Mn}:{};return Ft.createElement("button",Ht({className:Wt({"rpv-core__menu-item":!0,"rpv-core__menu-item--disabled":Ir,"rpv-core__menu-item--ltr":!er,"rpv-core__menu-item--rtl":er}),role:"menuitem",tabIndex:-1,type:"button",onClick:zn},Nr),Ft.createElement("div",{className:Wt({"rpv-core__menu-item-icon":!0,"rpv-core__menu-item-icon--ltr":!er,"rpv-core__menu-item-icon--rtl":er})},Sr),Ft.createElement("div",{className:Wt({"rpv-core__menu-item-label":!0,"rpv-core__menu-item-label--ltr":!er,"rpv-core__menu-item-label--rtl":er})},yr),Ft.createElement("div",{className:Wt({"rpv-core__menu-item-check":!0,"rpv-core__menu-item-check--ltr":!er,"rpv-core__menu-item-check--rtl":er})},fr&&Ft.createElement(Qt,null)))},xt.MinimalButton=function(Nn){var qn=Nn.ariaLabel,fr=qn===void 0?"":qn,yr=Nn.ariaKeyShortcuts,Er=yr===void 0?"":yr,Sr=Nn.children,Dr=Nn.isDisabled,Ir=Dr!==void 0&&Dr,Mn=Nn.isSelected,zn=Mn!==void 0&&Mn,er=Nn.testId,Nr=Nn.onClick,Vr=Ft.useContext(qt).direction===xt.TextDirection.RightToLeft,Ur=er?{"data-testid":er}:{};return Ft.createElement("button",Ht({"aria-label":fr},Er&&{"aria-keyshortcuts":Er},Ir&&{"aria-disabled":!0},{className:Wt({"rpv-core__minimal-button":!0,"rpv-core__minimal-button--disabled":Ir,"rpv-core__minimal-button--rtl":Vr,"rpv-core__minimal-button--selected":zn}),type:"button",onClick:Nr},Ur),Sr)},xt.Modal=function(Nn){var qn=Nn.ariaControlsSuffix,fr=Nn.closeOnClickOutside,yr=Nn.closeOnEscape,Er=Nn.content,Sr=Nn.isOpened,Dr=Sr!==void 0&&Sr,Ir=Nn.target,Mn=qn||"".concat(_n());return Ft.createElement(rr,{target:Ir?function(zn,er){return Ft.createElement("div",{"aria-expanded":er?"true":"false","aria-haspopup":"dialog","aria-controls":"rpv-core__modal-body-".concat(Mn)},Ir(zn,er))}:null,content:function(zn){return Ft.createElement(Vn,null,Ft.createElement(Ln,{ariaControlsSuffix:Mn,closeOnClickOutside:fr,closeOnEscape:yr,onToggle:zn},Er(zn)))},isOpened:Dr})},xt.Popover=function(Nn){var qn=Nn.ariaHasPopup,fr=qn===void 0?"dialog":qn,yr=Nn.ariaControlsSuffix,Er=Nn.closeOnClickOutside,Sr=Nn.closeOnEscape,Dr=Nn.content,Ir=Nn.lockScroll,Mn=Ir===void 0||Ir,zn=Nn.offset,er=Nn.position,Nr=Nn.target,Vr=Wn(!1),Ur=Vr.opened,_i=Vr.toggle,Kr=Ft.useRef(),Qr=Ft.useMemo(function(){return yr||"".concat(_n())},[]);return Ft.createElement("div",{ref:Kr,"aria-expanded":Ur?"true":"false","aria-haspopup":fr,"aria-controls":"rpv-core__popver-body-".concat(Qr)},Nr(_i,Ur),Ur&&Ft.createElement(Ft.Fragment,null,Mn&&Ft.createElement(Rr,{closeOnEscape:Sr,onClose:_i}),Ft.createElement(Fr,{ariaControlsSuffix:Qr,closeOnClickOutside:Er,offset:zn,position:er,targetRef:Kr,onClose:_i},Dr(_i))))},xt.PrimaryButton=Jt,xt.ProgressBar=function(Nn){var qn=Nn.progress,fr=Ft.useContext(qt).direction===xt.TextDirection.RightToLeft;return Ft.createElement("div",{className:Wt({"rpv-core__progress-bar":!0,"rpv-core__progress-bar--rtl":fr})},Ft.createElement("div",{className:"rpv-core__progress-bar-progress",style:{width:"".concat(qn,"%")}},qn,"%"))},xt.Separator=function(){return Ft.createElement("div",{className:"rpv-core__separator"})},xt.Spinner=Zt,xt.Splitter=function(Nn){var qn=Nn.constrain,fr=Ft.useContext(qt).direction===xt.TextDirection.RightToLeft,yr=Ft.useRef(),Er=Ft.useRef(),Sr=Ft.useRef(),Dr=Ft.useRef(0),Ir=Ft.useRef(0),Mn=Ft.useRef(0),zn=Ft.useRef(0),er={capture:!0},Nr=function(Ur){var _i=yr.current,Kr=Er.current,Qr=Sr.current;if(_i&&Kr&&Qr){var $s=zn.current,ys=Ur.clientX-Dr.current,ws=Mn.current+(fr?-ys:ys),Rs=_i.parentElement.getBoundingClientRect().width,Es=100*ws/Rs;if(_i.classList.add("rpv-core__splitter--resizing"),qn){var Ns=Rs-ws-$s;if(!qn({firstHalfPercentage:Es,firstHalfSize:ws,secondHalfPercentage:100*Ns/Rs,secondHalfSize:Ns}))return}Kr.style.width="".concat(Es,"%"),document.body.classList.add("rpv-core__splitter-body--resizing"),Kr.classList.add("rpv-core__splitter-sibling--resizing"),Qr.classList.add("rpv-core__splitter-sibling--resizing")}},Vr=function(Ur){var _i=yr.current,Kr=Er.current,Qr=Sr.current;_i&&Kr&&Qr&&(document.body.classList.remove("rpv-core__splitter-body--resizing"),_i.classList.remove("rpv-core__splitter--resizing"),Kr.classList.remove("rpv-core__splitter-sibling--resizing"),Qr.classList.remove("rpv-core__splitter-sibling--resizing"),document.removeEventListener("mousemove",Nr,er),document.removeEventListener("mouseup",Vr,er))};return Ft.useEffect(function(){var Ur=yr.current;Ur&&(zn.current=Ur.getBoundingClientRect().width,Er.current=Ur.previousElementSibling,Sr.current=Ur.nextElementSibling)},[]),Ft.createElement("div",{ref:yr,className:"rpv-core__splitter",onMouseDown:function(Ur){var _i=Er.current;_i&&(Dr.current=Ur.clientX,Ir.current=Ur.clientY,Mn.current=_i.getBoundingClientRect().width,document.addEventListener("mousemove",Nr,er),document.addEventListener("mouseup",Vr,er))}})},xt.TextBox=sn,xt.ThemeContext=qt,xt.Tooltip=function(Nn){var qn=Nn.ariaControlsSuffix,fr=Nn.content,yr=Nn.offset,Er=Nn.position,Sr=Nn.target,Dr=Wn(!1),Ir=Dr.opened,Mn=Dr.toggle,zn=Ft.useRef(),er=Ft.useRef(),Nr=Ft.useMemo(function(){return qn||"".concat(_n())},[]);Pn(function(){zn.current&&document.activeElement&&zn.current.contains(document.activeElement)&&Ur()});var Vr=function(){Mn(xt.ToggleStatus.Open)},Ur=function(){Mn(xt.ToggleStatus.Close)};return Ft.createElement(Ft.Fragment,null,Ft.createElement("div",{ref:zn,"aria-describedby":"rpv-core__tooltip-body-".concat(Nr),onBlur:function(_i){_i.relatedTarget instanceof HTMLElement&&_i.currentTarget.parentElement&&_i.currentTarget.parentElement.contains(_i.relatedTarget)?er.current&&(er.current.style.display="none"):Ur()},onFocus:Vr,onMouseEnter:Vr,onMouseLeave:Ur},Sr),Ir&&Ft.createElement(Qn,{ariaControlsSuffix:Nr,contentRef:er,offset:yr,position:Er,targetRef:zn},fr()))},xt.Viewer=function(Nn){var qn=Nn.characterMap,fr=Nn.defaultScale,yr=Nn.enableSmoothScroll,Er=yr===void 0||yr,Sr=Nn.fileUrl,Dr=Nn.httpHeaders,Ir=Dr===void 0?{}:Dr,Mn=Nn.initialPage,zn=Mn===void 0?0:Mn,er=Nn.pageLayout,Nr=Nn.initialRotation,Vr=Nr===void 0?0:Nr,Ur=Nn.localization,_i=Nn.plugins,Kr=_i===void 0?[]:_i,Qr=Nn.renderError,$s=Nn.renderLoader,ys=Nn.renderPage,ws=Nn.renderProtectedView,Rs=Nn.scrollMode,Es=Rs===void 0?xt.ScrollMode.Vertical:Rs,Ns=Nn.setRenderRange,Ds=Ns===void 0?Qo:Ns,io=Nn.transformGetDocumentParams,Qs=Nn.theme,oo=Qs===void 0?{direction:xt.TextDirection.LeftToRight,theme:"light"}:Qs,ao=Nn.viewMode,to=ao===void 0?xt.ViewMode.SinglePage:ao,Oo=Nn.withCredentials,Ao=Oo!==void 0&&Oo,No=Nn.onDocumentAskPassword,Ro=Nn.onDocumentLoad,Do=Ro===void 0?function(){}:Ro,Io=Nn.onPageChange,Po=Io===void 0?function(){}:Io,zo=Nn.onRotate,Yo=zo===void 0?function(){}:zo,na=Nn.onRotatePage,Vo=na===void 0?function(){}:na,Xo=Nn.onSwitchTheme,xl=Xo===void 0?function(){}:Xo,ks=Nn.onZoom,xs=ks===void 0?function(){}:ks,Ss=Ft.useState({data:Sr,name:typeof Sr=="string"?Sr:"",shouldLoad:!1}),Cs=Ss[0],bs=Ss[1],mn=function(po,no){bs({data:no,name:po,shouldLoad:!0})},In=Ft.useState(!1),On=In[0],Gn=In[1],Cr=$n(Cs);Ft.useEffect(function(){var po,no,Mo,mo;po=Cr.data,mo=typeof(no=Sr),(Mo=typeof po)=="string"&&mo==="string"&&po===no||Mo==="object"&&mo==="object"&&po.length===no.length&&po.every(function(Ol,Xl){return Ol===no[Xl]})||bs({data:Sr,name:typeof Sr=="string"?Sr:"",shouldLoad:On})},[Sr,On]);var Br=Kt({onVisibilityChanged:function(po){Gn(po.isVisible),po.isVisible&&bs(function(no){return Object.assign({},no,{shouldLoad:!0})})}}),rs=typeof oo=="string"?{direction:xt.TextDirection.LeftToRight,theme:oo}:oo,Ms=Ft.useState(Ur||An),uo=Ms[0],Ws=Ms[1],Is={l10n:uo,setL10n:Ws},ho=Object.assign({},{direction:rs.direction},Al(rs.theme||"light",xl));return Ft.useEffect(function(){Ur&&Ws(Ur)},[Ur]),Ft.createElement(Sn.Provider,{value:Is},Ft.createElement(qt.Provider,{value:ho},Ft.createElement("div",{ref:Br,className:"rpv-core__viewer rpv-core__viewer--".concat(ho.currentTheme),"data-testid":"core__viewer",style:{height:"100%",width:"100%"}},Cs.shouldLoad&&Ft.createElement(Kl,{characterMap:qn,file:Cs.data,httpHeaders:Ir,render:function(po){return Ft.createElement(Zo,{defaultScale:fr,doc:po,render:function(no,Mo){return Ft.createElement(Rl,{currentFile:{data:Cs.data,name:Cs.name},defaultScale:fr,doc:po,enableSmoothScroll:Er,initialPage:zn,initialRotation:Vr,initialScale:Mo,pageLayout:er,pageSizes:no,plugins:Kr,renderPage:ys,scrollMode:Es,setRenderRange:Ds,viewMode:to,viewerState:{file:Cs,fullScreenMode:xt.FullScreenMode.Normal,pageIndex:-1,pageHeight:no[0].pageHeight,pageWidth:no[0].pageWidth,pagesRotation:new Map,rotation:Vr,scale:Mo,scrollMode:Es,viewMode:to},onDocumentLoad:Do,onOpenFile:mn,onPageChange:Po,onRotate:Yo,onRotatePage:Vo,onZoom:xs})},scrollMode:Es,viewMode:to})},renderError:Qr,renderLoader:$s,renderProtectedView:ws,transformGetDocumentParams:io,withCredentials:Ao,onDocumentAskPassword:No}))))},xt.Worker=function(Nn){var qn=Nn.children,fr=Nn.workerUrl;return jt.GlobalWorkerOptions.workerSrc=fr,Ft.createElement(Ft.Fragment,null,qn)},xt.chunk=Mr,xt.classNames=Wt,xt.createStore=function(Nn){var qn=Nn||{},fr={},yr=function(Sr,Dr){var Ir;qn=Ht(Ht({},qn),((Ir={})[Sr]=Dr,Ir)),(fr[Sr]||[]).forEach(function(Mn){return Mn(qn[Sr])})},Er=function(Sr){return qn[Sr]};return{subscribe:function(Sr,Dr){fr[Sr]=(fr[Sr]||[]).concat(Dr)},unsubscribe:function(Sr,Dr){fr[Sr]=(fr[Sr]||[]).filter(function(Ir){return Ir!==Dr})},update:function(Sr,Dr){yr(Sr,Dr)},updateCurrentValue:function(Sr,Dr){var Ir=Er(Sr);Ir!==void 0&&yr(Sr,Dr(Ir))},get:function(Sr){return Er(Sr)}}},xt.getDestination=hr,xt.getPage=ur,xt.isFullScreenEnabled=gn,xt.isMac=function(){return typeof window<"u"&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)},xt.useDebounceCallback=xn,xt.useIntersectionObserver=Kt,xt.useIsMounted=Cn,xt.useIsomorphicLayoutEffect=Yt,xt.usePrevious=$n,xt.useRenderQueue=Dn})(core_min);/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib.exports=core_min;var libExports=lib.exports;const TOTAL_TIME$1=15*60*1e3;function SummaryApp$5({parameters:xt,setAnswer:$t}){const[Ct,kt]=reactExports.useState(0),[Mt]=reactExports.useState(Date.now()),{goToNextStep:Ft}=useNextStep(),[jt]=reactExports.useState(xt),[Bt,Vt]=reactExports.useState(TOTAL_TIME$1),{actions:zt,trrack:Ht}=reactExports.useMemo(()=>{const Gt=Ke.create(),qt=Gt.register("click",(Yt,Kt)=>(Yt.documentIdx=Kt.documentIdx,Yt.documentPath=Kt.documentPath,Yt)),Wt=Ut({registry:Gt,initialState:{documentIdx:0,documentPath:jt.documents[0]}});return{actions:{documentClickAction:qt},trrack:Wt}},[jt]);return reactExports.useEffect(()=>{const Gt=setInterval(()=>{const qt=Date.now()-Mt;Vt(TOTAL_TIME$1-qt),qt>=TOTAL_TIME$1&&Ft()},1e3);return()=>clearInterval(Gt)},[Mt,Ft,$t,Ht]),reactExports.useEffect(()=>{jt.documents.length&&kt(0)},[jt]),jsxRuntimeExports.jsxs(Box,{pos:"relative",children:[jsxRuntimeExports.jsx("div",{style:{position:"absolute",right:0,top:0},children:jsxRuntimeExports.jsx("div",{style:{position:"fixed",width:100,background:"#fff",zIndex:2,color:"orange",fontSize:32,fontWeight:"bold",transform:"translateX(-100%)"},children:jsxRuntimeExports.jsxs("p",{children:[Math.floor(Bt/1e3/60),":",Math.floor(Bt/1e3%60).toString().length===1?"0":"",Math.floor(Bt/1e3%60)]})})}),jsxRuntimeExports.jsxs(Grid,{gutter:50,children:[jsxRuntimeExports.jsx(Grid.Col,{span:2,children:jsxRuntimeExports.jsx("div",{style:{position:"sticky",top:100},children:jt.documents.map((Gt,qt)=>{const Wt=Gt.match(/sumsifter-documents\/(\d+_)?([A-Z0-9]+)_/),Yt=Wt?Wt[2]:"Doc";return jsxRuntimeExports.jsx(NavLink,{onClick:()=>{kt(qt),Ht.apply("Clicked",zt.documentClickAction({documentIdx:qt,documentPath:Gt})),$t({status:!0,provenanceGraph:Ht.graph.backend,answers:{}})},label:Yt,active:qt===Ct},qt)})})}),jsxRuntimeExports.jsx(Grid.Col,{span:8,children:jsxRuntimeExports.jsx(libExports.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.4.120/build/pdf.worker.min.js",children:jt.documents.length>0&&jsxRuntimeExports.jsx(libExports.Viewer,{fileUrl:`${PREFIX$1}${jt.documents[Ct]}`})})})]})]})}const SummaryApp$6=reactExports.memo(SummaryApp$5),__vite_glob_0_30=Object.freeze(Object.defineProperty({__proto__:null,default:SummaryApp$6},Symbol.toStringTag,{value:"Module"})),__vite_glob_0_31=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),badge$2="_badge_1xjx6_1",sourceItem$2="_sourceItem_1xjx6_10",sourceItemBadge$2="_sourceItemBadge_1xjx6_14",style$3={badge:badge$2,sourceItem:sourceItem$2,sourceItemBadge:sourceItemBadge$2};function SourceItem$2({source:xt,isActive:$t,onActiveRefChange:Ct}){const kt=React$1.useRef(null);return reactExports.useEffect(()=>{var Mt;$t&&((Mt=kt.current)==null||Mt.scrollIntoView({behavior:"smooth",block:"center"}),Ct(kt.current))},[xt.id,$t,Ct]),jsxRuntimeExports.jsx(Text,{className:style$3.sourceItem,ref:kt,component:"span",px:5,children:jsxRuntimeExports.jsx(Text,{component:"span",bg:$t?"blue.3":"transparent",dangerouslySetInnerHTML:{__html:xt.text}})})}const MemoizedSourceItem$2=React$1.memo(SourceItem$2);function Source$2({sourceList:xt,activeSourceId:$t,onSourceBadgePositionChange:Ct}){var Ht;const kt=React$1.useRef(null),Mt=React$1.useRef(null),[Ft,jt]=React$1.useState(0),[Bt,Vt]=React$1.useState(0);reactExports.useEffect(()=>{if(kt.current){const Gt=kt.current,qt=()=>{var Wt,Yt;Vt((Gt==null?void 0:Gt.getBoundingClientRect().left)||0),jt(((Wt=Mt.current)==null?void 0:Wt.getBoundingClientRect().top)||0),Ct((Gt==null?void 0:Gt.getBoundingClientRect().left)||0,((Yt=Mt.current)==null?void 0:Yt.getBoundingClientRect().top)||0)};return kt.current.addEventListener("scroll",qt),()=>{Gt.removeEventListener("scroll",qt)}}return()=>{}},[kt,Ct]);const zt=reactExports.useCallback(Gt=>{Mt.current=Gt},[]);return reactExports.useEffect(()=>{var qt,Wt;const Gt=kt.current;Vt((Gt==null?void 0:Gt.getBoundingClientRect().left)||0),jt(((qt=Mt.current)==null?void 0:qt.getBoundingClientRect().top)||0),Ct((Gt==null?void 0:Gt.getBoundingClientRect().left)||0,((Wt=Mt.current)==null?void 0:Wt.getBoundingClientRect().top)||0)},[$t,Ct]),jsxRuntimeExports.jsxs(ScrollArea,{style:{height:"calc(100vh - 110px)"},viewportRef:kt,children:[jsxRuntimeExports.jsx(Title,{order:2,children:"Source Document"}),xt.map((Gt,qt)=>jsxRuntimeExports.jsx(MemoizedSourceItem$2,{source:Gt,isActive:Gt.id===$t,onActiveRefChange:zt},qt)),$t&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Badge,{className:style$3.sourceItemBadge,color:"blue.5",style:{position:"fixed",left:Bt-10,top:Ft,transform:"translate(-100%, 0)"},children:$t},$t),jsxRuntimeExports.jsx("div",{style:{position:"fixed",left:Bt-10,top:Ft+16,backgroundColor:"var(--mantine-color-blue-5)",height:2,width:((Ht=kt.current)==null?void 0:Ht.clientWidth)||0}})]})]})}const __vite_glob_0_32=Object.freeze(Object.defineProperty({__proto__:null,default:Source$2},Symbol.toStringTag,{value:"Module"}));function SummarySourceItem$2({sentence:xt,src:$t,idx:Ct,onSourceClick:kt,activeSourceId:Mt}){const Ft=React$1.useRef(null);return jsxRuntimeExports.jsxs(React$1.Fragment,{children:[jsxRuntimeExports.jsx(Badge,{ref:Ft,className:style$3.badge,onClick:()=>{kt(Ft.current,xt.id,$t)},style:{cursor:"pointer"},color:Mt===$t?"blue.5":"gray.5",children:$t}),Ct<xt.sources.length-1&&", "]},Ct)}function Summary$2({sentences:xt,onSourceClick:$t,activeSourceId:Ct,onSummaryBadgePositionChange:kt}){const Mt=React$1.useRef(null),Ft=React$1.useRef(null),[jt,Bt]=React$1.useState(0),[Vt,zt]=React$1.useState(0),[Ht,Gt]=React$1.useState(0);reactExports.useEffect(()=>{if(Mt.current){const Wt=Mt.current,Yt=()=>{var Kt,Xt,Qt,Jt;Bt(((Kt=Ft.current)==null?void 0:Kt.getBoundingClientRect().top)||0),Gt(((Xt=Ft.current)==null?void 0:Xt.getBoundingClientRect().left)||0),zt(((Qt=Mt.current)==null?void 0:Qt.getBoundingClientRect().right)||0),kt(((Jt=Ft.current)==null?void 0:Jt.getBoundingClientRect().top)||0)};return Mt.current.addEventListener("scroll",Yt),()=>{Wt.removeEventListener("scroll",Yt)}}return()=>{}},[Mt,kt]);const qt=xt.map((Wt,Yt)=>{const Kt=/^(.*?)([.?!])?$/,Xt=Wt.text.match(Kt),Qt=Xt?Xt[1]:Wt.text,Jt=Xt?Xt[2]:"",Zt=(sn,ln,dn)=>{var hn;$t(ln,dn),kt((sn==null?void 0:sn.getBoundingClientRect().top)||0),Ft.current=sn,Bt((sn==null?void 0:sn.getBoundingClientRect().top)||0),Gt((sn==null?void 0:sn.getBoundingClientRect().left)||0),zt(((hn=Mt.current)==null?void 0:hn.getBoundingClientRect().right)||0)};return jsxRuntimeExports.jsxs(React$1.Fragment,{children:[Qt," ",Wt.sources.length>0&&jsxRuntimeExports.jsxs("span",{children:["[",Wt.sources.map((sn,ln)=>jsxRuntimeExports.jsx(SummarySourceItem$2,{sentence:Wt,src:sn,idx:ln,onSourceClick:Zt,activeSourceId:Ct},ln)),"]"]}),Jt," "]},Yt)});return jsxRuntimeExports.jsxs(ScrollArea,{style:{height:"calc(100vh - 110px)"},viewportRef:Mt,children:[jsxRuntimeExports.jsx(Title,{order:2,mb:16,children:"LLM-Generated Summary"}),jsxRuntimeExports.jsx(Text,{children:qt}),jsxRuntimeExports.jsx("div",{style:{position:"fixed",top:jt+18,left:Ht+5,backgroundColor:"var(--mantine-color-blue-5)",height:2,width:Vt-Ht+35}})]})}const __vite_glob_0_33=Object.freeze(Object.defineProperty({__proto__:null,default:Summary$2},Symbol.toStringTag,{value:"Module"})),TOTAL_TIME=30*60*1e3;function SummaryApp$3({parameters:xt,setAnswer:$t}){const[Ct,kt]=reactExports.useState(0),[Mt]=reactExports.useState(Date.now()),{goToNextStep:Ft}=useNextStep(),[jt]=reactExports.useState(xt),[Bt,Vt]=reactExports.useState(TOTAL_TIME),{actions:zt,trrack:Ht}=reactExports.useMemo(()=>{const Gt=Ke.create(),qt=Gt.register("click",(Yt,Kt)=>(Yt.documentIdx=Kt.documentIdx,Yt.documentPath=Kt.documentPath,Yt)),Wt=Ut({registry:Gt,initialState:{documentIdx:0,documentPath:jt.documents[0]}});return{actions:{documentClickAction:qt},trrack:Wt}},[jt]);return reactExports.useEffect(()=>{const Gt=setInterval(()=>{const qt=Date.now()-Mt;Vt(TOTAL_TIME-qt),qt>=TOTAL_TIME&&Ft()},1e3);return()=>clearInterval(Gt)},[Mt,Ft,$t,Ht]),reactExports.useEffect(()=>{jt.documents.length&&kt(0)},[jt]),jsxRuntimeExports.jsxs(Box,{pos:"relative",children:[jsxRuntimeExports.jsx("div",{style:{position:"absolute",right:0,top:0},children:jsxRuntimeExports.jsx("div",{style:{position:"fixed",width:100,background:"#fff",zIndex:2,color:"orange",fontSize:32,fontWeight:"bold",transform:"translateX(-100%)"},children:jsxRuntimeExports.jsxs("p",{children:[Math.floor(Bt/1e3/60),":",Math.floor(Bt/1e3%60).toString().length===1?"0":"",Math.floor(Bt/1e3%60)]})})}),jsxRuntimeExports.jsxs(Grid,{gutter:50,children:[jsxRuntimeExports.jsx(Grid.Col,{span:2,children:jsxRuntimeExports.jsx("div",{style:{position:"sticky",top:100},children:jt.documents.map((Gt,qt)=>jsxRuntimeExports.jsx(NavLink,{onClick:()=>{kt(qt),Ht.apply("Clicked",zt.documentClickAction({documentIdx:qt,documentPath:Gt})),$t({status:!0,provenanceGraph:Ht.graph.backend,answers:{}})},label:`Doc ${qt+1}`,active:qt===Ct},qt))})}),jsxRuntimeExports.jsx(Grid.Col,{span:8,children:jsxRuntimeExports.jsx(libExports.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.4.120/build/pdf.worker.min.js",children:jt.documents.length>0&&jsxRuntimeExports.jsx(libExports.Viewer,{fileUrl:`${PREFIX$1}${jt.documents[Ct]}`})})})]})]})}const SummaryApp$4=reactExports.memo(SummaryApp$3),__vite_glob_0_34=Object.freeze(Object.defineProperty({__proto__:null,default:SummaryApp$4},Symbol.toStringTag,{value:"Module"})),__vite_glob_0_35=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),badge$1="_badge_1xjx6_1",sourceItem$1="_sourceItem_1xjx6_10",sourceItemBadge$1="_sourceItemBadge_1xjx6_14",style$2={badge:badge$1,sourceItem:sourceItem$1,sourceItemBadge:sourceItemBadge$1};function SourceItem$1({source:xt,isActive:$t,onActiveRefChange:Ct}){const kt=React$1.useRef(null);return reactExports.useEffect(()=>{var Mt;$t&&((Mt=kt.current)==null||Mt.scrollIntoView({behavior:"smooth",block:"center"}),Ct(kt.current))},[xt.id,$t,Ct]),jsxRuntimeExports.jsx(Text,{className:style$2.sourceItem,ref:kt,component:"span",px:5,children:jsxRuntimeExports.jsx(Text,{component:"span",bg:$t?"blue.3":"transparent",dangerouslySetInnerHTML:{__html:xt.text}})})}const MemoizedSourceItem$1=React$1.memo(SourceItem$1);function Source$1({sourceList:xt,activeSourceId:$t,onSourceBadgePositionChange:Ct}){var Ht;const kt=React$1.useRef(null),Mt=React$1.useRef(null),[Ft,jt]=React$1.useState(0),[Bt,Vt]=React$1.useState(0);reactExports.useEffect(()=>{if(kt.current){const Gt=kt.current,qt=()=>{var Wt,Yt;Vt((Gt==null?void 0:Gt.getBoundingClientRect().left)||0),jt(((Wt=Mt.current)==null?void 0:Wt.getBoundingClientRect().top)||0),Ct((Gt==null?void 0:Gt.getBoundingClientRect().left)||0,((Yt=Mt.current)==null?void 0:Yt.getBoundingClientRect().top)||0)};return kt.current.addEventListener("scroll",qt),()=>{Gt.removeEventListener("scroll",qt)}}return()=>{}},[kt,Ct]);const zt=reactExports.useCallback(Gt=>{Mt.current=Gt},[]);return reactExports.useEffect(()=>{var qt,Wt;const Gt=kt.current;Vt((Gt==null?void 0:Gt.getBoundingClientRect().left)||0),jt(((qt=Mt.current)==null?void 0:qt.getBoundingClientRect().top)||0),Ct((Gt==null?void 0:Gt.getBoundingClientRect().left)||0,((Wt=Mt.current)==null?void 0:Wt.getBoundingClientRect().top)||0)},[$t,Ct]),jsxRuntimeExports.jsxs(ScrollArea,{style:{height:"calc(100vh - 110px)"},viewportRef:kt,children:[jsxRuntimeExports.jsx(Title,{order:2,children:"Source Document"}),xt.map((Gt,qt)=>jsxRuntimeExports.jsx(MemoizedSourceItem$1,{source:Gt,isActive:Gt.id===$t,onActiveRefChange:zt},qt)),$t&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Badge,{className:style$2.sourceItemBadge,color:"blue.5",style:{position:"fixed",left:Bt-10,top:Ft,transform:"translate(-100%, 0)"},children:$t},$t),jsxRuntimeExports.jsx("div",{style:{position:"fixed",left:Bt-10,top:Ft+16,backgroundColor:"var(--mantine-color-blue-5)",height:2,width:((Ht=kt.current)==null?void 0:Ht.clientWidth)||0}})]})]})}const __vite_glob_0_36=Object.freeze(Object.defineProperty({__proto__:null,default:Source$1},Symbol.toStringTag,{value:"Module"}));function SummarySourceItem$1({sentence:xt,src:$t,idx:Ct,onSourceClick:kt,activeSourceId:Mt}){const Ft=React$1.useRef(null);return jsxRuntimeExports.jsxs(React$1.Fragment,{children:[jsxRuntimeExports.jsx(Badge,{ref:Ft,className:style$2.badge,onClick:()=>{kt(Ft.current,xt.id,$t)},style:{cursor:"pointer"},color:Mt===$t?"blue.5":"gray.5",children:$t}),Ct<xt.sources.length-1&&", "]},Ct)}function Summary$1({sentences:xt,onSourceClick:$t,activeSourceId:Ct,onSummaryBadgePositionChange:kt}){const Mt=React$1.useRef(null),Ft=React$1.useRef(null),[jt,Bt]=React$1.useState(0),[Vt,zt]=React$1.useState(0),[Ht,Gt]=React$1.useState(0);reactExports.useEffect(()=>{if(Mt.current){const Wt=Mt.current,Yt=()=>{var Kt,Xt,Qt,Jt;Bt(((Kt=Ft.current)==null?void 0:Kt.getBoundingClientRect().top)||0),Gt(((Xt=Ft.current)==null?void 0:Xt.getBoundingClientRect().left)||0),zt(((Qt=Mt.current)==null?void 0:Qt.getBoundingClientRect().right)||0),kt(((Jt=Ft.current)==null?void 0:Jt.getBoundingClientRect().top)||0)};return Mt.current.addEventListener("scroll",Yt),()=>{Wt.removeEventListener("scroll",Yt)}}return()=>{}},[Mt,kt]);const qt=xt.map((Wt,Yt)=>{const Kt=/^(.*?)([.?!])?$/,Xt=Wt.text.match(Kt),Qt=Xt?Xt[1]:Wt.text,Jt=Xt?Xt[2]:"",Zt=(sn,ln,dn)=>{var hn;$t(ln,dn),kt((sn==null?void 0:sn.getBoundingClientRect().top)||0),Ft.current=sn,Bt((sn==null?void 0:sn.getBoundingClientRect().top)||0),Gt((sn==null?void 0:sn.getBoundingClientRect().left)||0),zt(((hn=Mt.current)==null?void 0:hn.getBoundingClientRect().right)||0)};return jsxRuntimeExports.jsxs(React$1.Fragment,{children:[Qt," ",Wt.sources.length>0&&jsxRuntimeExports.jsxs("span",{children:["[",Wt.sources.map((sn,ln)=>jsxRuntimeExports.jsx(SummarySourceItem$1,{sentence:Wt,src:sn,idx:ln,onSourceClick:Zt,activeSourceId:Ct},ln)),"]"]}),Jt," "]},Yt)});return jsxRuntimeExports.jsxs(ScrollArea,{style:{height:"calc(100vh - 110px)"},viewportRef:Mt,children:[jsxRuntimeExports.jsx(Title,{order:2,mb:16,children:"LLM-Generated Summary"}),jsxRuntimeExports.jsx(Text,{children:qt}),jsxRuntimeExports.jsx("div",{style:{position:"fixed",top:jt+18,left:Ht+5,backgroundColor:"var(--mantine-color-blue-5)",height:2,width:Vt-Ht+35}})]})}const __vite_glob_0_37=Object.freeze(Object.defineProperty({__proto__:null,default:Summary$1},Symbol.toStringTag,{value:"Module"}));function SummaryApp$2({parameters:xt,setAnswer:$t}){const[Ct,kt]=reactExports.useState(null),[Mt,Ft]=reactExports.useState([]),[jt,Bt]=reactExports.useState([]),[Vt,zt]=reactExports.useState(0),[Ht,Gt]=reactExports.useState(0),[qt,Wt]=reactExports.useState(0),{datasetSource:Yt,datasetSummary:Kt}=xt,{actions:Xt,trrack:Qt}=reactExports.useMemo(()=>{const ln=Ke.create(),dn=ln.register("mouseHover",(cn,pn)=>(cn.activeSummaryId=pn.summaryId,cn.activeSourceId=pn.sourceId,cn)),hn=Ut({registry:ln,initialState:{activeSummaryId:null,activeSourceId:null}});return{actions:{mouseHoverAction:dn},trrack:hn}},[]);reactExports.useEffect(()=>{csv(`./data/${Kt}.csv`).then(ln=>{const dn=ln.map(hn=>({id:String(hn.id),text:hn.text??"",sources:(hn.sources??"").split(",").map(cn=>cn.trim())}));Ft(dn)})},[Kt]),reactExports.useEffect(()=>{csv(`./data/${Yt}.csv`).then(ln=>{const dn=ln.map(hn=>({id:String(hn.id),text:hn.text??"",sources:(hn.sources??"").split(",").map(cn=>cn.trim())}));Bt(dn)})},[Yt]),reactExports.useEffect(()=>{},[]);const Jt=(ln,dn)=>{Qt.apply("Clicked",Xt.mouseHoverAction({summaryId:ln,sourceId:dn})),$t({status:!0,provenanceGraph:Qt.graph.backend,answers:{}}),kt(dn)},Zt=ln=>{zt(ln)},sn=(ln,dn)=>{Gt(dn),Wt(ln)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Grid,{gutter:50,children:[jsxRuntimeExports.jsx(Grid.Col,{span:6,children:jsxRuntimeExports.jsx(Summary$1,{sentences:Mt,onSummaryBadgePositionChange:Zt,onSourceClick:Jt,activeSourceId:Ct})}),jsxRuntimeExports.jsx(Grid.Col,{span:6,children:jsxRuntimeExports.jsx(Source$1,{sourceList:jt,onSourceBadgePositionChange:sn,activeSourceId:Ct})})]}),Ct&&jsxRuntimeExports.jsx("div",{style:{position:"fixed",top:(Vt>Ht?Ht:Vt)+18,left:qt-10,width:2,height:Math.abs(Vt-Ht)-(Vt>Ht?-2:2),backgroundColor:"var(--mantine-color-blue-5)"}})]})}const __vite_glob_0_38=Object.freeze(Object.defineProperty({__proto__:null,default:SummaryApp$2},Symbol.toStringTag,{value:"Module"})),__vite_glob_0_39=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),badge="_badge_ojjwa_1",sourceItem="_sourceItem_ojjwa_10",sourceItemBadge="_sourceItemBadge_ojjwa_14",sourceContextPopup="_sourceContextPopup_ojjwa_22",style$1={badge,sourceItem,sourceItemBadge,sourceContextPopup};function SourceItem({source:xt,isActive:$t,onActiveRefChange:Ct}){const kt=React$1.useRef(null);return reactExports.useEffect(()=>{var Mt;$t&&((Mt=kt.current)==null||Mt.scrollIntoView({behavior:"smooth",block:"center"}),Ct(kt.current))},[xt.id,$t,Ct]),jsxRuntimeExports.jsx(Text,{className:style$1.sourceItem,ref:kt,component:"span",px:5,children:jsxRuntimeExports.jsx(Text,{component:"span",bg:$t?"blue.3":"transparent",dangerouslySetInnerHTML:{__html:xt.text}})})}const MemoizedSourceItem=React$1.memo(SourceItem);function Source({sourceList:xt,activeSourceId:$t,onSourceBadgePositionChange:Ct,onAddToSummary:kt}){var Jt;const Mt=React$1.useRef(null),Ft=React$1.useRef(null),jt=React$1.useRef(null),[Bt,Vt]=React$1.useState(0),[zt,Ht]=React$1.useState(0),[Gt,qt]=React$1.useState(null),[Wt,Yt]=React$1.useState(null);reactExports.useEffect(()=>{if(Mt.current){const Zt=Mt.current,sn=()=>{var ln,dn;Ht((Zt==null?void 0:Zt.getBoundingClientRect().left)||0),Vt(((ln=jt.current)==null?void 0:ln.getBoundingClientRect().top)||0),Ct((Zt==null?void 0:Zt.getBoundingClientRect().left)||0,((dn=jt.current)==null?void 0:dn.getBoundingClientRect().top)||0)};return Mt.current.addEventListener("scroll",sn),()=>{Zt.removeEventListener("scroll",sn)}}return()=>{}},[Mt,Ct]);const Kt=reactExports.useCallback(Zt=>{jt.current=Zt},[]);reactExports.useEffect(()=>{if(Mt.current){const Zt=Mt.current,sn=()=>{const ln=window.getSelection();ln?(qt(ln.toString()),Yt(ln.getRangeAt(0).getBoundingClientRect())):qt(null)};return Zt.addEventListener("mouseup",sn),()=>{Zt.removeEventListener("mouseup",sn)}}return()=>{}},[Mt]),reactExports.useEffect(()=>{var sn,ln;const Zt=Mt.current;Ht((Zt==null?void 0:Zt.getBoundingClientRect().left)||0),Vt(((sn=jt.current)==null?void 0:sn.getBoundingClientRect().top)||0),Ct((Zt==null?void 0:Zt.getBoundingClientRect().left)||0,((ln=jt.current)==null?void 0:ln.getBoundingClientRect().top)||0)},[$t,Ct]);const Xt=reactExports.useMemo(()=>{var Zt,sn;return{top:((Wt==null?void 0:Wt.top)||0)-(((Zt=Ft.current)==null?void 0:Zt.getBoundingClientRect().top)||0),left:((Wt==null?void 0:Wt.left)||0)-(((sn=Ft.current)==null?void 0:sn.getBoundingClientRect().left)||0)+((Wt==null?void 0:Wt.width)||0)/2}},[Wt,Ft]),Qt=reactExports.useCallback(()=>{var Zt;kt(Gt||""),(Zt=window.getSelection())==null||Zt.removeAllRanges(),qt(null)},[Gt,kt]);return jsxRuntimeExports.jsx(ScrollArea,{style:{height:"calc(100vh - 110px)"},pos:"relative",viewportRef:Mt,children:jsxRuntimeExports.jsxs("div",{ref:Ft,style:{position:"relative"},children:[jsxRuntimeExports.jsx(Title,{order:2,children:"Source Document"}),xt.map((Zt,sn)=>jsxRuntimeExports.jsx(MemoizedSourceItem,{source:Zt,isActive:Zt.id===$t,onActiveRefChange:Kt},sn)),Gt&&jsxRuntimeExports.jsx("div",{className:style$1.sourceContextPopup,style:{top:Xt.top,left:Xt.left},children:jsxRuntimeExports.jsx(Button,{variant:"transparent",size:"xs",color:"gray",onClick:Qt,children:"Add to Summary"})}),$t&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Badge,{className:style$1.sourceItemBadge,color:"blue.5",style:{position:"fixed",left:zt-10,top:Bt,transform:"translate(-100%, 0)"},children:$t},$t),jsxRuntimeExports.jsx("div",{style:{position:"fixed",left:zt-10,top:Bt+16,backgroundColor:"var(--mantine-color-blue-5)",height:2,width:((Jt=Mt.current)==null?void 0:Jt.clientWidth)||0}})]})]})})}const __vite_glob_0_40=Object.freeze(Object.defineProperty({__proto__:null,default:Source},Symbol.toStringTag,{value:"Module"}));function SummarySourceItem({sentence:xt,src:$t,idx:Ct,onSourceClick:kt,activeSourceId:Mt}){const Ft=React$1.useRef(null);return jsxRuntimeExports.jsxs(React$1.Fragment,{children:[jsxRuntimeExports.jsx(Badge,{ref:Ft,className:style$1.badge,onClick:()=>{kt(Ft.current,xt.id,$t)},style:{cursor:"pointer"},color:Mt===$t?"blue.5":"gray.5",children:$t}),Ct<xt.sources.length-1&&", "]},Ct)}function Summary({sentences:xt,onSourceClick:$t,activeSourceId:Ct,onSummaryBadgePositionChange:kt,onSubmitQuery:Mt,queryText:Ft,onQueryTextChange:jt}){const Bt=React$1.useRef(null),Vt=React$1.useRef(null),[zt,Ht]=React$1.useState(0),[Gt,qt]=React$1.useState(0),[Wt,Yt]=React$1.useState(0);reactExports.useEffect(()=>{if(Bt.current){const Xt=Bt.current,Qt=()=>{var Jt,Zt,sn,ln;Ht(((Jt=Vt.current)==null?void 0:Jt.getBoundingClientRect().top)||0),Yt(((Zt=Vt.current)==null?void 0:Zt.getBoundingClientRect().left)||0),qt(((sn=Bt.current)==null?void 0:sn.getBoundingClientRect().right)||0),kt(((ln=Vt.current)==null?void 0:ln.getBoundingClientRect().top)||0)};return Bt.current.addEventListener("scroll",Qt),()=>{Xt.removeEventListener("scroll",Qt)}}return()=>{}},[Bt,kt]);const Kt=xt.map((Xt,Qt)=>{const Jt=/^(.*?)([.?!])?$/,Zt=Xt.text.match(Jt),sn=Zt?Zt[1]:Xt.text,ln=Zt?Zt[2]:"",dn=(hn,cn,pn)=>{var yn;$t(cn,pn),kt((hn==null?void 0:hn.getBoundingClientRect().top)||0),Vt.current=hn,Ht((hn==null?void 0:hn.getBoundingClientRect().top)||0),Yt((hn==null?void 0:hn.getBoundingClientRect().left)||0),qt(((yn=Bt.current)==null?void 0:yn.getBoundingClientRect().right)||0)};return jsxRuntimeExports.jsxs(React$1.Fragment,{children:[sn," ",Xt.sources.length>0&&jsxRuntimeExports.jsxs("span",{children:["[",Xt.sources.map((hn,cn)=>jsxRuntimeExports.jsx(SummarySourceItem,{sentence:Xt,src:hn,idx:cn,onSourceClick:dn,activeSourceId:Ct},cn)),"]"]}),ln," "]},Qt)});return jsxRuntimeExports.jsxs(ScrollArea,{style:{height:"calc(100vh - 110px)"},viewportRef:Bt,children:[jsxRuntimeExports.jsx(Title,{order:2,mb:16,children:"LLM-Generated Summary"}),jsxRuntimeExports.jsx(Text,{children:Kt}),jsxRuntimeExports.jsxs(Box,{display:"flex",pos:"sticky",bottom:0,pt:10,mt:10,bg:"#fff",style:{borderTop:"1px solid #ddd"},children:[jsxRuntimeExports.jsx(Textarea,{minRows:1,maxRows:4,autosize:!0,placeholder:"Type your query here.",value:Ft,onChange:Xt=>{jt(Xt.target.value)},mr:10,flex:1}),jsxRuntimeExports.jsx(Button,{onClick:()=>{Mt(Ft)},children:"Send"})]}),jsxRuntimeExports.jsx("div",{style:{position:"fixed",top:zt+18,left:Wt+5,backgroundColor:"var(--mantine-color-blue-5)",height:2,width:Gt-Wt+35}})]})}const __vite_glob_0_41=Object.freeze(Object.defineProperty({__proto__:null,default:Summary},Symbol.toStringTag,{value:"Module"})),API_BASE_URL="https://sumsifterchatbot.shrestha.club";function SummaryApp({parameters:xt,setAnswer:$t}){const[Ct,kt]=reactExports.useState(null),[Mt,Ft]=reactExports.useState([]),[jt,Bt]=reactExports.useState([]),[Vt,zt]=reactExports.useState(0),[Ht,Gt]=reactExports.useState(0),[qt,Wt]=reactExports.useState(0),[Yt,Kt]=reactExports.useState(!0),[Xt,Qt]=reactExports.useState(""),{prompt:Jt,document:Zt}=xt,{actions:sn,trrack:ln}=reactExports.useMemo(()=>{const gn=Ke.create(),En=gn.register("mouseHover",(xn,Cn)=>(xn.activeSummaryId=Cn.summaryId,xn.activeSourceId=Cn.sourceId,xn)),bn=Ut({registry:gn,initialState:{activeSummaryId:null,activeSourceId:null}});return{actions:{mouseHoverAction:En},trrack:bn}},[]);reactExports.useEffect(()=>{async function gn(){Kt(!0);const bn=await(await fetch(`${API_BASE_URL}/summary/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:Jt,document:Zt})})).json(),xn=bn.summary.map(($n,wn)=>({id:String(wn),text:$n.text,sources:$n.sources})),Cn=bn.source.map($n=>({id:$n.id,text:$n.text}));Ft(xn),Bt(Cn),Kt(!1)}gn()},[Jt,Zt]);const dn=(gn,En)=>{ln.apply("Clicked",sn.mouseHoverAction({summaryId:gn,sourceId:En})),$t({status:!0,provenanceGraph:ln.graph.backend,answers:{}}),kt(En)},hn=gn=>{zt(gn)},cn=(gn,En)=>{Gt(En),Wt(gn)},pn=reactExports.useCallback(gn=>{async function En(){Kt(!0);const xn=await(await fetch(`${API_BASE_URL}/summary/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:gn,document:Zt})})).json(),Cn=xn.summary.map((wn,Rn)=>({id:String(Rn),text:wn.text,sources:wn.sources})),$n=xn.source.map(wn=>({id:wn.id,text:wn.text}));Ft(Cn),Bt($n),Kt(!1)}En()},[Zt]),yn=reactExports.useCallback(gn=>{Qt(En=>`${En}
${gn}`)},[]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Yt&&jsxRuntimeExports.jsx("div",{style:{position:"fixed",top:"0",left:"0",zIndex:1e3,height:"100vh",width:"100vw",background:"rgba(255, 255, 255, 0.9)"},children:jsxRuntimeExports.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"24px",fontWeight:"bold",textAlign:"center"},children:[jsxRuntimeExports.jsx(Loader,{color:"blue"}),jsxRuntimeExports.jsx("div",{children:"Please wait while we summarize the document..."})]})}),jsxRuntimeExports.jsxs(Grid,{gutter:50,children:[jsxRuntimeExports.jsx(Grid.Col,{span:6,pos:"relative",children:jsxRuntimeExports.jsx(Summary,{sentences:Mt,onSummaryBadgePositionChange:hn,onSourceClick:dn,activeSourceId:Ct,onSubmitQuery:pn,queryText:Xt,onQueryTextChange:Qt})}),jsxRuntimeExports.jsx(Grid.Col,{span:6,children:jsxRuntimeExports.jsx(Source,{sourceList:jt,onSourceBadgePositionChange:cn,activeSourceId:Ct,onAddToSummary:yn})})]}),Ct&&jsxRuntimeExports.jsx("div",{style:{position:"fixed",top:(Vt>Ht?Ht:Vt)+18,left:qt-10,width:2,height:Math.abs(Vt-Ht)-(Vt>Ht?-2:2),backgroundColor:"var(--mantine-color-blue-5)"}})]})}const SummaryApp$1=reactExports.memo(SummaryApp),__vite_glob_0_42=Object.freeze(Object.defineProperty({__proto__:null,default:SummaryApp$1},Symbol.toStringTag,{value:"Module"})),__vite_glob_0_43=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),modules$1=Object.assign({"../public/demo-brush-interactions/assets/Bar.tsx":__vite_glob_0_0,"../public/demo-brush-interactions/assets/BrushPlot.tsx":__vite_glob_0_1,"../public/demo-brush-interactions/assets/Paintbrush.tsx":__vite_glob_0_2,"../public/demo-brush-interactions/assets/Scatter.tsx":__vite_glob_0_3,"../public/demo-brush-interactions/assets/XAxisBar.tsx":__vite_glob_0_4,"../public/demo-brush-interactions/assets/YAxis.tsx":__vite_glob_0_5,"../public/demo-brush-interactions/assets/YAxisBar.tsx":__vite_glob_0_6,"../public/demo-brush-interactions/assets/types.ts":__vite_glob_0_7,"../public/demo-cleveland/assets/BarChart.tsx":__vite_glob_0_8,"../public/demo-cleveland/assets/BubbleChart.tsx":__vite_glob_0_9,"../public/demo-cleveland/assets/PieChart.tsx":__vite_glob_0_10,"../public/demo-cleveland/assets/StackedBarChart.tsx":__vite_glob_0_11,"../public/demo-cleveland/assets/chartcomponents/Bars.tsx":__vite_glob_0_12,"../public/demo-cleveland/assets/chartcomponents/Bubbles.tsx":__vite_glob_0_13,"../public/demo-cleveland/assets/chartcomponents/DotMarks.tsx":__vite_glob_0_14,"../public/demo-cleveland/assets/chartcomponents/NumericAxisH.tsx":__vite_glob_0_15,"../public/demo-cleveland/assets/chartcomponents/NumericAxisV.tsx":__vite_glob_0_16,"../public/demo-cleveland/assets/chartcomponents/OrdinalAxisHWithDotMarks.tsx":__vite_glob_0_17,"../public/demo-cleveland/assets/chartcomponents/Slices.tsx":__vite_glob_0_18,"../public/demo-cleveland/assets/chartcomponents/SlicesDotMarks.tsx":__vite_glob_0_19,"../public/demo-cleveland/assets/chartcomponents/StackedBars.tsx":__vite_glob_0_20,"../public/demo-cleveland/assets/hooks/useChartDimensions.tsx":__vite_glob_0_21,"../public/demo-click-accuracy-test/assets/ClickAccuracyTest.tsx":__vite_glob_0_22,"../public/demo-fairness-jnd/assets/FairnessJND.tsx":__vite_glob_0_23,"../public/sumsifter-chunking/Source.tsx":__vite_glob_0_24,"../public/sumsifter-chunking/Summary.tsx":__vite_glob_0_25,"../public/sumsifter-chunking/SummaryApp.tsx":__vite_glob_0_26,"../public/sumsifter-chunking/types.ts":__vite_glob_0_27,"../public/sumsifter-memory-study-p1/Source.tsx":__vite_glob_0_28,"../public/sumsifter-memory-study-p1/Summary.tsx":__vite_glob_0_29,"../public/sumsifter-memory-study-p1/SummaryApp.tsx":__vite_glob_0_30,"../public/sumsifter-memory-study-p1/types.ts":__vite_glob_0_31,"../public/sumsifter-memory-study-p2/Source.tsx":__vite_glob_0_32,"../public/sumsifter-memory-study-p2/Summary.tsx":__vite_glob_0_33,"../public/sumsifter-memory-study-p2/SummaryApp.tsx":__vite_glob_0_34,"../public/sumsifter-memory-study-p2/types.ts":__vite_glob_0_35,"../public/sumsifter-translation-and-attribution/Source.tsx":__vite_glob_0_36,"../public/sumsifter-translation-and-attribution/Summary.tsx":__vite_glob_0_37,"../public/sumsifter-translation-and-attribution/SummaryApp.tsx":__vite_glob_0_38,"../public/sumsifter-translation-and-attribution/types.ts":__vite_glob_0_39,"../public/sumsifter/Source.tsx":__vite_glob_0_40,"../public/sumsifter/Summary.tsx":__vite_glob_0_41,"../public/sumsifter/SummaryApp.tsx":__vite_glob_0_42,"../public/sumsifter/types.ts":__vite_glob_0_43});function ReactComponentController({currentConfig:xt}){const $t=useCurrentStep(),Ct=useCurrentComponent(),kt=`../public/${xt.path}`,Mt=kt in modules$1?modules$1[kt].default:null,Ft=useStoreDispatch(),{updateResponseBlockValidation:jt,setIframeAnswers:Bt}=useStoreActions();function Vt({status:zt,provenanceGraph:Ht,answers:Gt}){Ft(jt({location:"sidebar",identifier:`${Ct}_${$t}`,status:zt,values:Gt,provenanceGraph:Ht})),Ft(Bt(Gt))}return jsxRuntimeExports.jsx(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx("div",{children:"Loading..."}),children:Mt?jsxRuntimeExports.jsx(Mt,{parameters:xt.parameters,setAnswer:Vt}):jsxRuntimeExports.jsx(ResourceNotFound,{path:xt.path})})}function MarkdownController({currentConfig:xt}){const[$t,Ct]=reactExports.useState(""),[kt,Mt]=reactExports.useState(!0);return reactExports.useEffect(()=>{async function Ft(){const jt=await getStaticAssetByPath(xt.path);jt!==void 0&&Ct(jt),Mt(!1)}Ft()},[xt.path]),kt||$t?jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:$t}):jsxRuntimeExports.jsx(ResourceNotFound,{path:xt.path})}var os=require$$0;function tryParseNumber(xt,$t){var Ct,kt="",Mt=0,Ft=!0,jt=0,Bt;function Vt(){return Bt=xt.charAt(jt),jt++,Bt}for(Vt(),Bt==="-"&&(kt="-",Vt());Bt>="0"&&Bt<="9";)Ft&&(Bt=="0"?Mt++:Ft=!1),kt+=Bt,Vt();if(Ft&&Mt--,Bt===".")for(kt+=".";Vt()&&Bt>="0"&&Bt<="9";)kt+=Bt;if(Bt==="e"||Bt==="E")for(kt+=Bt,Vt(),(Bt==="-"||Bt==="+")&&(kt+=Bt,Vt());Bt>="0"&&Bt<="9";)kt+=Bt,Vt();for(;Bt&&Bt<=" ";)Vt();if($t&&(Bt===","||Bt==="}"||Bt==="]"||Bt==="#"||Bt==="/"&&(xt[jt]==="/"||xt[jt]==="*"))&&(Bt=0),Ct=+kt,!(Bt||Mt||!isFinite(Ct)))return Ct}function createComment(xt,$t){return Object.defineProperty&&Object.defineProperty(xt,"__COMMENTS__",{enumerable:!1,writable:!0}),xt.__COMMENTS__=$t||{}}function removeComment(xt){Object.defineProperty(xt,"__COMMENTS__",{value:void 0})}function getComment(xt){return xt.__COMMENTS__}function forceComment(xt){if(!xt)return"";var $t=xt.split(`
`),Ct,kt,Mt,Ft;for(Mt=0;Mt<$t.length;Mt++)for(Ct=$t[Mt],Ft=Ct.length,kt=0;kt<Ft;kt++){var jt=Ct[kt];if(jt==="#")break;if(jt==="/"&&(Ct[kt+1]==="/"||Ct[kt+1]==="*")){Ct[kt+1]==="*"&&(Mt=$t.length);break}else if(jt>" "){$t[Mt]="# "+Ct;break}}return $t.join(`
`)}var hjsonCommon={EOL:os.EOL||`
`,tryParseNumber,createComment,removeComment,getComment,forceComment},hjsonVersion="3.2.1";function loadDsf(xt,$t){if(Object.prototype.toString.apply(xt)!=="[object Array]"){if(xt)throw new Error("dsf option must contain an array!");return nopDsf}else if(xt.length===0)return nopDsf;var Ct=[];function kt(Mt){return{}.toString.call(Mt)==="[object Function]"}return xt.forEach(function(Mt){if(!Mt.name||!kt(Mt.parse)||!kt(Mt.stringify))throw new Error("extension does not match the DSF interface");Ct.push(function(){try{if($t=="parse")return Mt.parse.apply(null,arguments);if($t=="stringify"){var Ft=Mt.stringify.apply(null,arguments);if(Ft!==void 0&&(typeof Ft!="string"||Ft.length===0||Ft[0]==='"'||[].some.call(Ft,function(jt){return isInvalidDsfChar(jt)})))throw new Error("value may not be empty, start with a quote or contain a punctuator character except colon: "+Ft);return Ft}else throw new Error("Invalid type")}catch(jt){throw new Error("DSF-"+Mt.name+" failed; "+jt.message)}})}),runDsf.bind(null,Ct)}function runDsf(xt,$t){if(xt)for(var Ct=0;Ct<xt.length;Ct++){var kt=xt[Ct]($t);if(kt!==void 0)return kt}}function nopDsf(){}function isInvalidDsfChar(xt){return xt==="{"||xt==="}"||xt==="["||xt==="]"||xt===","}function math(){return{name:"math",parse:function(xt){switch(xt){case"+inf":case"inf":case"+Inf":case"Inf":return 1/0;case"-inf":case"-Inf":return-1/0;case"nan":case"NaN":return NaN}},stringify:function(xt){if(typeof xt=="number"){if(1/xt===-1/0)return"-0";if(xt===1/0)return"Inf";if(xt===-1/0)return"-Inf";if(isNaN(xt))return"NaN"}}}}math.description="support for Inf/inf, -Inf/-inf, Nan/naN and -0";function hex(xt){var $t=xt&&xt.out;return{name:"hex",parse:function(Ct){if(/^0x[0-9A-Fa-f]+$/.test(Ct))return parseInt(Ct,16)},stringify:function(Ct){if($t&&Number.isInteger(Ct))return"0x"+Ct.toString(16)}}}hex.description="parse hexadecimal numbers prefixed with 0x";function date(){return{name:"date",parse:function(xt){if(/^\d{4}-\d{2}-\d{2}$/.test(xt)||/^\d{4}-\d{2}-\d{2}T\d{2}\:\d{2}\:\d{2}(?:.\d+)(?:Z|[+-]\d{2}:\d{2})$/.test(xt)){var $t=Date.parse(xt);if(!isNaN($t))return new Date($t)}},stringify:function(xt){if(Object.prototype.toString.call(xt)==="[object Date]"){var $t=xt.toISOString();return $t.indexOf("T00:00:00.000Z",$t.length-14)!==-1?$t.substr(0,10):$t}}}}date.description="support ISO dates";var hjsonDsf={loadDsf,std:{math,hex,date}},hjsonParse=function(xt,$t){var Ct=hjsonCommon,kt=hjsonDsf,Mt,Ft,jt,Bt={'"':'"',"'":"'","\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},Vt,zt;function Ht(){Ft=0,jt=" "}function Gt(xn){return xn==="{"||xn==="}"||xn==="["||xn==="]"||xn===","||xn===":"}function qt(xn){var Cn,$n=0,wn=1;for(Cn=Ft-1;Cn>0&&Mt[Cn]!==`
`;Cn--,$n++);for(;Cn>0;Cn--)Mt[Cn]===`
`&&wn++;throw new Error(xn+" at line "+wn+","+$n+" >>>"+Mt.substr(Ft-$n,20)+" ...")}function Wt(){return jt=Mt.charAt(Ft),Ft++,jt}function Yt(xn){return Mt.charAt(Ft+xn)}function Kt(xn){for(var Cn="",$n=jt;Wt();){if(jt===$n)return Wt(),xn&&$n==="'"&&jt==="'"&&Cn.length===0?(Wt(),Xt()):Cn;if(jt==="\\")if(Wt(),jt==="u"){for(var wn=0,Rn=0;Rn<4;Rn++){Wt();var Dn=jt.charCodeAt(0),An;jt>="0"&&jt<="9"?An=Dn-48:jt>="a"&&jt<="f"?An=Dn-97+10:jt>="A"&&jt<="F"?An=Dn-65+10:qt("Bad \\u char "+jt),wn=wn*16+An}Cn+=String.fromCharCode(wn)}else if(typeof Bt[jt]=="string")Cn+=Bt[jt];else break;else jt===`
`||jt==="\r"?qt("Bad string containing newline"):Cn+=jt}qt("Bad string")}function Xt(){for(var xn="",Cn=0,$n=0;;){var wn=Yt(-$n-5);if(!wn||wn===`
`)break;$n++}function Rn(){for(var Dn=$n;jt&&jt<=" "&&jt!==`
`&&Dn-- >0;)Wt()}for(;jt&&jt<=" "&&jt!==`
`;)Wt();for(jt===`
`&&(Wt(),Rn());;){if(!jt)qt("Bad multiline string");else if(jt==="'"){if(Cn++,Wt(),Cn===3)return xn.slice(-1)===`
`&&(xn=xn.slice(0,-1)),xn;continue}else for(;Cn>0;)xn+="'",Cn--;jt===`
`?(xn+=`
`,Wt(),Rn()):(jt!=="\r"&&(xn+=jt),Wt())}}function Qt(){if(jt==='"'||jt==="'")return Kt(!1);for(var xn="",Cn=Ft,$n=-1;;){if(jt===":")return xn?$n>=0&&$n!==xn.length&&(Ft=Cn+$n,qt("Found whitespace in your key name (use quotes to include)")):qt("Found ':' but no key name (for an empty key name use quotes)"),xn;jt<=" "?jt?$n<0&&($n=xn.length):qt("Found EOF while looking for a key name (check your syntax)"):Gt(jt)?qt("Found '"+jt+"' where a key name was expected (check your syntax or use quotes if the key name includes {}[],: or whitespace)"):xn+=jt,Wt()}}function Jt(){for(;jt;){for(;jt&&jt<=" ";)Wt();if(jt==="#"||jt==="/"&&Yt(0)==="/")for(;jt&&jt!==`
`;)Wt();else if(jt==="/"&&Yt(0)==="*"){for(Wt(),Wt();jt&&!(jt==="*"&&Yt(0)==="/");)Wt();jt&&(Wt(),Wt())}else break}}function Zt(){var xn=jt;for(Gt(jt)&&qt("Found a punctuator character '"+jt+"' when expecting a quoteless string (check your syntax)");;){Wt();var Cn=jt==="\r"||jt===`
`||jt==="";if(Cn||jt===","||jt==="}"||jt==="]"||jt==="#"||jt==="/"&&(Yt(0)==="/"||Yt(0)==="*")){var $n=xn[0];switch($n){case"f":if(xn.trim()==="false")return!1;break;case"n":if(xn.trim()==="null")return null;break;case"t":if(xn.trim()==="true")return!0;break;default:if($n==="-"||$n>="0"&&$n<="9"){var wn=Ct.tryParseNumber(xn);if(wn!==void 0)return wn}}if(Cn){xn=xn.trim();var Rn=zt(xn);return Rn!==void 0?Rn:xn}}xn+=jt}}function sn(xn,Cn){var $n;for(xn--,$n=Ft-2;$n>xn&&Mt[$n]<=" "&&Mt[$n]!==`
`;$n--);Mt[$n]===`
`&&$n--,Mt[$n]==="\r"&&$n--;var wn=Mt.substr(xn,$n-xn+1);for($n=0;$n<wn.length;$n++)if(wn[$n]>" "){var Rn=wn.indexOf(`
`);if(Rn>=0){var Dn=[wn.substr(0,Rn),wn.substr(Rn+1)];return Cn&&Dn[0].trim().length===0&&Dn.shift(),Dn}else return[wn]}return[]}function ln(xn){function Cn(wn,Rn){var Dn,An,Sn,vn;switch(typeof wn){case"string":wn.indexOf(Rn)>=0&&(vn=wn);break;case"object":if(Object.prototype.toString.apply(wn)==="[object Array]")for(Dn=0,Sn=wn.length;Dn<Sn;Dn++)vn=Cn(wn[Dn],Rn)||vn;else for(An in wn)Object.prototype.hasOwnProperty.call(wn,An)&&(vn=Cn(wn[An],Rn)||vn)}return vn}function $n(wn){var Rn=Cn(xn,wn);return Rn?"found '"+wn+`' in a string value, your mistake could be with:
  > `+Rn+`
  (unquoted strings contain everything up to the next line!)`:""}return $n("}")||$n("]")}function dn(){var xn=[],Cn,$n,wn;try{if(Vt&&(Cn=Ct.createComment(xn,{a:[]})),Wt(),$n=Ft,Jt(),Cn&&(wn=sn($n,!0).join(`
`)),jt==="]")return Wt(),Cn&&(Cn.e=[wn]),xn;for(;jt;){if(xn.push(cn()),$n=Ft,Jt(),jt===","&&(Wt(),$n=Ft,Jt()),Cn){var Rn=sn($n);Cn.a.push([wn||"",Rn[0]||""]),wn=Rn[1]}if(jt==="]")return Wt(),Cn&&(Cn.a[Cn.a.length-1][1]+=wn||""),xn;Jt()}qt("End of input while parsing an array (missing ']')")}catch(Dn){throw Dn.hint=Dn.hint||ln(xn),Dn}}function hn(xn){var Cn="",$n={},wn,Rn,Dn;try{if(Vt&&(wn=Ct.createComment($n,{c:{},o:[]})),xn?Rn=1:(Wt(),Rn=Ft),Jt(),wn&&(Dn=sn(Rn,!0).join(`
`)),jt==="}"&&!xn)return wn&&(wn.e=[Dn]),Wt(),$n;for(;jt;){if(Cn=Qt(),Jt(),jt!==":"&&qt("Expected ':' instead of '"+jt+"'"),Wt(),$n[Cn]=cn(),Rn=Ft,Jt(),jt===","&&(Wt(),Rn=Ft,Jt()),wn){var An=sn(Rn);wn.c[Cn]=[Dn||"",An[0]||""],Dn=An[1],wn.o.push(Cn)}if(jt==="}"&&!xn)return Wt(),wn&&(wn.c[Cn][1]+=Dn||""),$n;Jt()}if(xn)return $n;qt("End of input while parsing an object (missing '}')")}catch(Sn){throw Sn.hint=Sn.hint||ln($n),Sn}}function cn(){switch(Jt(),jt){case"{":return hn();case"[":return dn();case"'":case'"':return Kt(!0);default:return Zt()}}function pn(xn,Cn){var $n=Ft;if(Jt(),jt&&qt("Syntax error, found trailing characters"),Vt){var wn=Cn.join(`
`),Rn=sn($n).join(`
`);if(Rn||wn){var Dn=Ct.createComment(xn,Ct.getComment(xn));Dn.r=[wn,Rn]}}return xn}function yn(){Jt();var xn=Vt?sn(1):null;switch(jt){case"{":return pn(hn(),xn);case"[":return pn(dn(),xn);default:return pn(cn(),xn)}}function gn(){Jt();var xn=Vt?sn(1):null;switch(jt){case"{":return pn(hn(),xn);case"[":return pn(dn(),xn)}try{return pn(hn(!0),xn)}catch(Cn){Ht();try{return pn(cn(),xn)}catch{throw Cn}}}if(typeof xt!="string")throw new Error("source is not a string");var En=null,bn=!0;return $t&&typeof $t=="object"&&(Vt=$t.keepWsc,En=$t.dsf,bn=$t.legacyRoot!==!1),zt=kt.loadDsf(En,"parse"),Mt=xt,Ht(),bn?gn():yn()},hjsonStringify=function(xt,$t){var Ct=hjsonCommon,kt=hjsonDsf,Mt={obj:["{","}"],arr:["[","]"],key:["",""],qkey:['"','"'],col:[":",""],com:[",",""],str:["",""],qstr:['"','"'],mstr:["'''","'''"],num:["",""],lit:["",""],dsf:["",""],esc:["\\",""],uni:["\\u",""],rem:["",""]},Ft=Ct.EOL,jt="  ",Bt=!1,Vt=!1,zt=!1,Ht=!1,Gt=0,qt=1,Wt="",Yt=null,Kt=!1,Xt=Mt;if($t&&typeof $t=="object"){$t.quotes=$t.quotes==="always"?"strings":$t.quotes,($t.eol===`
`||$t.eol===`\r
`)&&(Ft=$t.eol),Bt=$t.keepWsc,Gt=$t.condense||0,Vt=$t.bracesSameLine,zt=$t.quotes==="all"||$t.quotes==="keys",Ht=$t.quotes==="all"||$t.quotes==="strings"||$t.separator===!0,Ht||$t.multiline=="off"?qt=0:qt=$t.multiline=="no-tabs"?2:1,Wt=$t.separator===!0?Xt.com[0]:"",Yt=$t.dsf,Kt=$t.sortProps,typeof $t.space=="number"?jt=new Array($t.space+1).join(" "):typeof $t.space=="string"&&(jt=$t.space),$t.colors===!0&&(Xt={obj:["\x1B[37m{\x1B[0m","\x1B[37m}\x1B[0m"],arr:["\x1B[37m[\x1B[0m","\x1B[37m]\x1B[0m"],key:["\x1B[33m","\x1B[0m"],qkey:['\x1B[33m"','"\x1B[0m'],col:["\x1B[37m:\x1B[0m",""],com:["\x1B[37m,\x1B[0m",""],str:["\x1B[37;1m","\x1B[0m"],qstr:['\x1B[37;1m"','"\x1B[0m'],mstr:["\x1B[37;1m'''","'''\x1B[0m"],num:["\x1B[36;1m","\x1B[0m"],lit:["\x1B[36m","\x1B[0m"],dsf:["\x1B[37m","\x1B[0m"],esc:["\x1B[31m\\","\x1B[0m"],uni:["\x1B[31m\\u","\x1B[0m"],rem:["\x1B[35m","\x1B[0m"]});var Qt,Jt=Object.keys(Mt);for(Qt=Jt.length-1;Qt>=0;Qt--){var Zt=Jt[Qt];Xt[Zt].push(Mt[Zt][0].length,Mt[Zt][1].length)}}var sn,ln="---\u2028--\uFEFF-",dn=new RegExp('[\\\\\\"\0-'+ln+"]","g"),hn=new RegExp(`^\\s|^"|^'|^#|^\\/\\*|^\\/\\/|^\\{|^\\}|^\\[|^\\]|^:|^,|\\s$|[\0-`+ln+"]","g"),cn=new RegExp("'''|^[\\s]+$|[\0-"+(qt===2?"	":"\b")+"\v\f-"+ln+"]","g"),pn=new RegExp("^(true|false|null)\\s*((,|\\]|\\}|#|//|/\\*).*)?$"),yn={"\b":"b","	":"t","\n":"n","\f":"f","\r":"r",'"':'"',"\\":"\\"},gn=/[,\{\[\}\]\s:#"']|\/\/|\/\*/,En="",bn=0;function xn(vn,_n){return bn+=vn[0].length+vn[1].length-vn[2]-vn[3],vn[0]+_n+vn[1]}function Cn(vn){return vn.replace(dn,function(_n){var Tn=yn[_n];return typeof Tn=="string"?xn(Xt.esc,Tn):xn(Xt.uni,("0000"+_n.charCodeAt(0).toString(16)).slice(-4))})}function $n(vn,_n,Tn,Pn){return vn?(hn.lastIndex=0,pn.lastIndex=0,Ht||Tn||hn.test(vn)||Ct.tryParseNumber(vn,!0)!==void 0||pn.test(vn)?(dn.lastIndex=0,cn.lastIndex=0,dn.test(vn)?!cn.test(vn)&&!Pn&&qt?wn(vn,_n):xn(Xt.qstr,Cn(vn)):xn(Xt.qstr,vn)):xn(Xt.str,vn)):xn(Xt.qstr,"")}function wn(vn,_n){var Tn,Pn=vn.replace(/\r/g,"").split(`
`);if(_n+=jt,Pn.length===1)return xn(Xt.mstr,Pn[0]);var Ln=Ft+_n+Xt.mstr[0];for(Tn=0;Tn<Pn.length;Tn++)Ln+=Ft,Pn[Tn]&&(Ln+=_n+Pn[Tn]);return Ln+Ft+_n+Xt.mstr[1]}function Rn(vn){return vn?zt||gn.test(vn)?(dn.lastIndex=0,xn(Xt.qkey,dn.test(vn)?Cn(vn):vn)):xn(Xt.key,vn):'""'}function Dn(vn,_n,Tn,Pn){function Ln(ds){return ds&&ds[ds[0]==="\r"?1:0]===`
`}function Vn(ds){return ds&&!Ln(ds)}function Un(ds,ms,wr){if(!ds)return"";ds=Ct.forceComment(ds);var Wr,ns=ds.length;for(Wr=0;Wr<ns&&ds[Wr]<=" ";Wr++);return wr&&Wr>0&&(ds=ds.substr(Wr)),Wr<ns?ms+xn(Xt.rem,ds):ds}var Wn=sn(vn);if(Wn!==void 0)return xn(Xt.dsf,Wn);switch(typeof vn){case"string":return $n(vn,En,_n,Pn);case"number":return isFinite(vn)?xn(Xt.num,String(vn)):xn(Xt.lit,"null");case"boolean":return xn(Xt.lit,String(vn));case"object":if(!vn)return xn(Xt.lit,"null");var rr;Bt&&(rr=Ct.getComment(vn));var ar=Object.prototype.toString.apply(vn)==="[object Array]",nr=En;En+=jt;var mr=Ft+nr,kn=Ft+En,Fn=Tn||Vt?"":mr,Hn=[],Bn,jn=Gt?[]:null,sr=Ht,Ar=qt,Fr=Wt?"":Xt.com[0],Rr=0,Qn,jr,Mr,pr,Tr,Hr,Xr,Zr,ur;if(ar){for(Qn=0,jr=vn.length;Qn<jr;Qn++){if(Bn=Qn<jr-1,rr?(Hr=rr.a[Qn]||[],Xr=Vn(Hr[1]),Hn.push(Un(Hr[0],`
`)+kn),jn&&(Hr[0]||Hr[1]||Xr)&&(jn=null)):Hn.push(kn),bn=0,pr=vn[Qn],Hn.push(Dn(pr,rr?Xr:!1,!0)+(Bn?Wt:"")),jn){switch(typeof pr){case"string":bn=0,Ht=!0,qt=0,jn.push(Dn(pr,!1,!0)+(Bn?Xt.com[0]:"")),Ht=sr,qt=Ar;break;case"object":if(pr){jn=null;break}default:jn.push(Hn[Hn.length-1]+(Bn?Fr:""));break}Bn&&(bn+=Xt.com[0].length-Xt.com[2]),Rr+=bn}rr&&Hr[1]&&Hn.push(Un(Hr[1],Xr?" ":`
`,Xr))}jr===0?rr&&rr.e&&Hn.push(Un(rr.e[0],`
`)+mr):Hn.push(mr),Hn.length===0?Zr=xn(Xt.arr,""):(Zr=Fn+xn(Xt.arr,Hn.join("")),jn&&(ur=jn.join(" "),ur.length-Rr<=Gt&&(Zr=xn(Xt.arr,ur))))}else{var hr=rr?rr.o.slice():[],gr=[];for(Mr in vn)Object.prototype.hasOwnProperty.call(vn,Mr)&&hr.indexOf(Mr)<0&&gr.push(Mr);Kt&&gr.sort();var qr=hr.concat(gr);for(Qn=0,jr=qr.length;Qn<jr;Qn++)if(Bn=Qn<jr-1,Mr=qr[Qn],rr?(Hr=rr.c[Mr]||[],Xr=Vn(Hr[1]),Hn.push(Un(Hr[0],`
`)+kn),jn&&(Hr[0]||Hr[1]||Xr)&&(jn=null)):Hn.push(kn),bn=0,pr=vn[Mr],Tr=Dn(pr,rr&&Xr),Hn.push(Rn(Mr)+Xt.col[0]+(Ln(Tr)?"":" ")+Tr+(Bn?Wt:"")),rr&&Hr[1]&&Hn.push(Un(Hr[1],Xr?" ":`
`,Xr)),jn){switch(typeof pr){case"string":bn=0,Ht=!0,qt=0,Tr=Dn(pr,!1),Ht=sr,qt=Ar,jn.push(Rn(Mr)+Xt.col[0]+" "+Tr+(Bn?Xt.com[0]:""));break;case"object":if(pr){jn=null;break}default:jn.push(Hn[Hn.length-1]+(Bn?Fr:""));break}bn+=Xt.col[0].length-Xt.col[2],Bn&&(bn+=Xt.com[0].length-Xt.com[2]),Rr+=bn}jr===0?rr&&rr.e&&Hn.push(Un(rr.e[0],`
`)+mr):Hn.push(mr),Hn.length===0?Zr=xn(Xt.obj,""):(Zr=Fn+xn(Xt.obj,Hn.join("")),jn&&(ur=jn.join(" "),ur.length-Rr<=Gt&&(Zr=xn(Xt.obj,ur))))}return En=nr,Zr}}sn=kt.loadDsf(Yt,"stringify");var An="",Sn=Bt?Sn=(Ct.getComment(xt)||{}).r:null;return Sn&&Sn[0]&&(An=Sn[0]+`
`),An+=Dn(xt,null,!0,!0),Sn&&(An+=Sn[1]||""),An},common$1=hjsonCommon;function makeComment(xt,$t,Ct){var kt;return xt&&(kt={b:xt}),$t&&((kt=kt||{}).a=$t),Ct&&((kt=kt||{}).x=Ct),kt}function extractComments(xt,$t){if(!(xt===null||typeof xt!="object")){var Ct=common$1.getComment(xt);Ct&&common$1.removeComment(xt);var kt,Mt,Ft,jt;if(Object.prototype.toString.apply(xt)==="[object Array]"){for(jt={a:{}},kt=0,Mt=xt.length;kt<Mt;kt++)saveComment(jt.a,kt,Ct.a[kt],extractComments(xt[kt]))&&(Ft=!0);!Ft&&Ct.e&&(jt.e=makeComment(Ct.e[0],Ct.e[1]),Ft=!0)}else{jt={s:{}};var Bt,Vt=Object.keys(xt);for(Ct&&Ct.o?(Bt=[],Ct.o.concat(Vt).forEach(function(Ht){Object.prototype.hasOwnProperty.call(xt,Ht)&&Bt.indexOf(Ht)<0&&Bt.push(Ht)})):Bt=Vt,jt.o=Bt,kt=0,Mt=Bt.length;kt<Mt;kt++){var zt=Bt[kt];saveComment(jt.s,zt,Ct.c[zt],extractComments(xt[zt]))&&(Ft=!0)}!Ft&&Ct.e&&(jt.e=makeComment(Ct.e[0],Ct.e[1]),Ft=!0)}return $t&&Ct&&Ct.r&&(jt.r=makeComment(Ct.r[0],Ct.r[1])),Ft?jt:void 0}}function mergeStr(){var xt="";return[].forEach.call(arguments,function($t){$t&&$t.trim()!==""&&(xt&&(xt+="; "),xt+=$t.trim())}),xt}function mergeComments(xt,$t){var Ct=[];if(merge$3(xt,$t,Ct,[]),Ct.length>0){var kt=rootComment($t,null,1);kt+=`
# Orphaned comments:
`,Ct.forEach(function(Mt){kt+=("# "+Mt.path.join("/")+": "+mergeStr(Mt.b,Mt.a,Mt.e)).replace(`
`,"\\n ")+`
`}),rootComment($t,kt,1)}}function saveComment(xt,$t,Ct,kt){var Mt=makeComment(Ct?Ct[0]:void 0,Ct?Ct[1]:void 0,kt);return Mt&&(xt[$t]=Mt),Mt}function droppedComment(xt,$t){var Ct=makeComment($t.b,$t.a);return Ct.path=xt,Ct}function dropAll(xt,$t,Ct){if(xt){var kt,Mt;if(xt.a)for(kt=0,Mt=xt.a.length;kt<Mt;kt++){var Ft=Ct.slice().concat([kt]),jt=xt.a[kt];jt&&($t.push(droppedComment(Ft,jt)),dropAll(jt.x,$t,Ft))}else xt.o&&xt.o.forEach(function(Bt){var Vt=Ct.slice().concat([Bt]),zt=xt.s[Bt];zt&&($t.push(droppedComment(Vt,zt)),dropAll(zt.x,$t,Vt))});xt.e&&$t.push(droppedComment(Ct,xt.e))}}function merge$3(xt,$t,Ct,kt){if(xt){if($t===null||typeof $t!="object"){dropAll(xt,Ct,kt);return}var Mt,Ft=common$1.createComment($t);if(kt.length===0&&xt.r&&(Ft.r=[xt.r.b,xt.r.a]),Object.prototype.toString.apply($t)==="[object Array]"){Ft.a=[];var jt=xt.a||{};for(var Bt in jt)if(jt.hasOwnProperty(Bt)){Mt=parseInt(Bt);var Vt=xt.a[Bt];if(Vt){var zt=kt.slice().concat([Mt]);Mt<$t.length?(Ft.a[Mt]=[Vt.b,Vt.a],merge$3(Vt.x,$t[Mt],Ct,zt)):(Ct.push(droppedComment(zt,Vt)),dropAll(Vt.x,Ct,zt))}}Mt===0&&xt.e&&(Ft.e=[xt.e.b,xt.e.a])}else Ft.c={},Ft.o=[],(xt.o||[]).forEach(function(Ht){var Gt=kt.slice().concat([Ht]),qt=xt.s[Ht];Object.prototype.hasOwnProperty.call($t,Ht)?(Ft.o.push(Ht),qt&&(Ft.c[Ht]=[qt.b,qt.a],merge$3(qt.x,$t[Ht],Ct,Gt))):qt&&(Ct.push(droppedComment(Gt,qt)),dropAll(qt.x,Ct,Gt))}),xt.e&&(Ft.e=[xt.e.b,xt.e.a])}}function rootComment(xt,$t,Ct){var kt=common$1.createComment(xt,common$1.getComment(xt));return kt.r||(kt.r=["",""]),($t||$t==="")&&(kt.r[Ct]=common$1.forceComment($t)),kt.r[Ct]||""}var hjsonComments={extract:function(xt){return extractComments(xt,!0)},merge:mergeComments,header:function(xt,$t){return rootComment(xt,$t,0)},footer:function(xt,$t){return rootComment(xt,$t,1)}};/*!
 * Hjson v3.2.1
 * https://hjson.github.io
 *
 * Copyright 2014-2017 Christian Zangl, MIT license
 * Details and documentation:
 * https://github.com/hjson/hjson-js
 *
 * This code is based on the the JSON version by Douglas Crockford:
 * https://github.com/douglascrockford/JSON-js (json_parse.js, json2.js)
 */var common=hjsonCommon,version$a=hjsonVersion,parse$7=hjsonParse,stringify$3=hjsonStringify,comments=hjsonComments,dsf=hjsonDsf,hjson={parse:parse$7,stringify:stringify$3,endOfLine:function(){return common.EOL},setEndOfLine:function(xt){(xt===`
`||xt===`\r
`)&&(common.EOL=xt)},version:version$a,rt:{parse:function(xt,$t){return($t=$t||{}).keepWsc=!0,parse$7(xt,$t)},stringify:function(xt,$t){return($t=$t||{}).keepWsc=!0,stringify$3(xt,$t)}},comments,dsf:dsf.std},ajv={exports:{}},core$3={},validate$1={},boolSchema={},errors={},codegen$1={},code$1={};(function(xt){Object.defineProperty(xt,"__esModule",{value:!0}),xt.regexpCode=xt.getEsmExportName=xt.getProperty=xt.safeStringify=xt.stringify=xt.strConcat=xt.addCodeArg=xt.str=xt._=xt.nil=xt._Code=xt.Name=xt.IDENTIFIER=xt._CodeOrName=void 0;class $t{}xt._CodeOrName=$t,xt.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class Ct extends $t{constructor(Jt){if(super(),!xt.IDENTIFIER.test(Jt))throw new Error("CodeGen: name must be a valid identifier");this.str=Jt}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}xt.Name=Ct;class kt extends $t{constructor(Jt){super(),this._items=typeof Jt=="string"?[Jt]:Jt}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const Jt=this._items[0];return Jt===""||Jt==='""'}get str(){var Jt;return(Jt=this._str)!==null&&Jt!==void 0?Jt:this._str=this._items.reduce((Zt,sn)=>`${Zt}${sn}`,"")}get names(){var Jt;return(Jt=this._names)!==null&&Jt!==void 0?Jt:this._names=this._items.reduce((Zt,sn)=>(sn instanceof Ct&&(Zt[sn.str]=(Zt[sn.str]||0)+1),Zt),{})}}xt._Code=kt,xt.nil=new kt("");function Mt(Qt,...Jt){const Zt=[Qt[0]];let sn=0;for(;sn<Jt.length;)Bt(Zt,Jt[sn]),Zt.push(Qt[++sn]);return new kt(Zt)}xt._=Mt;const Ft=new kt("+");function jt(Qt,...Jt){const Zt=[Wt(Qt[0])];let sn=0;for(;sn<Jt.length;)Zt.push(Ft),Bt(Zt,Jt[sn]),Zt.push(Ft,Wt(Qt[++sn]));return Vt(Zt),new kt(Zt)}xt.str=jt;function Bt(Qt,Jt){Jt instanceof kt?Qt.push(...Jt._items):Jt instanceof Ct?Qt.push(Jt):Qt.push(Gt(Jt))}xt.addCodeArg=Bt;function Vt(Qt){let Jt=1;for(;Jt<Qt.length-1;){if(Qt[Jt]===Ft){const Zt=zt(Qt[Jt-1],Qt[Jt+1]);if(Zt!==void 0){Qt.splice(Jt-1,3,Zt);continue}Qt[Jt++]="+"}Jt++}}function zt(Qt,Jt){if(Jt==='""')return Qt;if(Qt==='""')return Jt;if(typeof Qt=="string")return Jt instanceof Ct||Qt[Qt.length-1]!=='"'?void 0:typeof Jt!="string"?`${Qt.slice(0,-1)}${Jt}"`:Jt[0]==='"'?Qt.slice(0,-1)+Jt.slice(1):void 0;if(typeof Jt=="string"&&Jt[0]==='"'&&!(Qt instanceof Ct))return`"${Qt}${Jt.slice(1)}`}function Ht(Qt,Jt){return Jt.emptyStr()?Qt:Qt.emptyStr()?Jt:jt`${Qt}${Jt}`}xt.strConcat=Ht;function Gt(Qt){return typeof Qt=="number"||typeof Qt=="boolean"||Qt===null?Qt:Wt(Array.isArray(Qt)?Qt.join(","):Qt)}function qt(Qt){return new kt(Wt(Qt))}xt.stringify=qt;function Wt(Qt){return JSON.stringify(Qt).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}xt.safeStringify=Wt;function Yt(Qt){return typeof Qt=="string"&&xt.IDENTIFIER.test(Qt)?new kt(`.${Qt}`):Mt`[${Qt}]`}xt.getProperty=Yt;function Kt(Qt){if(typeof Qt=="string"&&xt.IDENTIFIER.test(Qt))return new kt(`${Qt}`);throw new Error(`CodeGen: invalid export name: ${Qt}, use explicit $id name mapping`)}xt.getEsmExportName=Kt;function Xt(Qt){return new kt(Qt.toString())}xt.regexpCode=Xt})(code$1);var scope={};(function(xt){Object.defineProperty(xt,"__esModule",{value:!0}),xt.ValueScope=xt.ValueScopeName=xt.Scope=xt.varKinds=xt.UsedValueState=void 0;const $t=code$1;class Ct extends Error{constructor(zt){super(`CodeGen: "code" for ${zt} not defined`),this.value=zt.value}}var kt;(function(Vt){Vt[Vt.Started=0]="Started",Vt[Vt.Completed=1]="Completed"})(kt||(xt.UsedValueState=kt={})),xt.varKinds={const:new $t.Name("const"),let:new $t.Name("let"),var:new $t.Name("var")};class Mt{constructor({prefixes:zt,parent:Ht}={}){this._names={},this._prefixes=zt,this._parent=Ht}toName(zt){return zt instanceof $t.Name?zt:this.name(zt)}name(zt){return new $t.Name(this._newName(zt))}_newName(zt){const Ht=this._names[zt]||this._nameGroup(zt);return`${zt}${Ht.index++}`}_nameGroup(zt){var Ht,Gt;if(!((Gt=(Ht=this._parent)===null||Ht===void 0?void 0:Ht._prefixes)===null||Gt===void 0)&&Gt.has(zt)||this._prefixes&&!this._prefixes.has(zt))throw new Error(`CodeGen: prefix "${zt}" is not allowed in this scope`);return this._names[zt]={prefix:zt,index:0}}}xt.Scope=Mt;class Ft extends $t.Name{constructor(zt,Ht){super(Ht),this.prefix=zt}setValue(zt,{property:Ht,itemIndex:Gt}){this.value=zt,this.scopePath=(0,$t._)`.${new $t.Name(Ht)}[${Gt}]`}}xt.ValueScopeName=Ft;const jt=(0,$t._)`\n`;class Bt extends Mt{constructor(zt){super(zt),this._values={},this._scope=zt.scope,this.opts={...zt,_n:zt.lines?jt:$t.nil}}get(){return this._scope}name(zt){return new Ft(zt,this._newName(zt))}value(zt,Ht){var Gt;if(Ht.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const qt=this.toName(zt),{prefix:Wt}=qt,Yt=(Gt=Ht.key)!==null&&Gt!==void 0?Gt:Ht.ref;let Kt=this._values[Wt];if(Kt){const Jt=Kt.get(Yt);if(Jt)return Jt}else Kt=this._values[Wt]=new Map;Kt.set(Yt,qt);const Xt=this._scope[Wt]||(this._scope[Wt]=[]),Qt=Xt.length;return Xt[Qt]=Ht.ref,qt.setValue(Ht,{property:Wt,itemIndex:Qt}),qt}getValue(zt,Ht){const Gt=this._values[zt];if(Gt)return Gt.get(Ht)}scopeRefs(zt,Ht=this._values){return this._reduceValues(Ht,Gt=>{if(Gt.scopePath===void 0)throw new Error(`CodeGen: name "${Gt}" has no value`);return(0,$t._)`${zt}${Gt.scopePath}`})}scopeCode(zt=this._values,Ht,Gt){return this._reduceValues(zt,qt=>{if(qt.value===void 0)throw new Error(`CodeGen: name "${qt}" has no value`);return qt.value.code},Ht,Gt)}_reduceValues(zt,Ht,Gt={},qt){let Wt=$t.nil;for(const Yt in zt){const Kt=zt[Yt];if(!Kt)continue;const Xt=Gt[Yt]=Gt[Yt]||new Map;Kt.forEach(Qt=>{if(Xt.has(Qt))return;Xt.set(Qt,kt.Started);let Jt=Ht(Qt);if(Jt){const Zt=this.opts.es5?xt.varKinds.var:xt.varKinds.const;Wt=(0,$t._)`${Wt}${Zt} ${Qt} = ${Jt};${this.opts._n}`}else if(Jt=qt==null?void 0:qt(Qt))Wt=(0,$t._)`${Wt}${Jt}${this.opts._n}`;else throw new Ct(Qt);Xt.set(Qt,kt.Completed)})}return Wt}}xt.ValueScope=Bt})(scope);(function(xt){Object.defineProperty(xt,"__esModule",{value:!0}),xt.or=xt.and=xt.not=xt.CodeGen=xt.operators=xt.varKinds=xt.ValueScopeName=xt.ValueScope=xt.Scope=xt.Name=xt.regexpCode=xt.stringify=xt.getProperty=xt.nil=xt.strConcat=xt.str=xt._=void 0;const $t=code$1,Ct=scope;var kt=code$1;Object.defineProperty(xt,"_",{enumerable:!0,get:function(){return kt._}}),Object.defineProperty(xt,"str",{enumerable:!0,get:function(){return kt.str}}),Object.defineProperty(xt,"strConcat",{enumerable:!0,get:function(){return kt.strConcat}}),Object.defineProperty(xt,"nil",{enumerable:!0,get:function(){return kt.nil}}),Object.defineProperty(xt,"getProperty",{enumerable:!0,get:function(){return kt.getProperty}}),Object.defineProperty(xt,"stringify",{enumerable:!0,get:function(){return kt.stringify}}),Object.defineProperty(xt,"regexpCode",{enumerable:!0,get:function(){return kt.regexpCode}}),Object.defineProperty(xt,"Name",{enumerable:!0,get:function(){return kt.Name}});var Mt=scope;Object.defineProperty(xt,"Scope",{enumerable:!0,get:function(){return Mt.Scope}}),Object.defineProperty(xt,"ValueScope",{enumerable:!0,get:function(){return Mt.ValueScope}}),Object.defineProperty(xt,"ValueScopeName",{enumerable:!0,get:function(){return Mt.ValueScopeName}}),Object.defineProperty(xt,"varKinds",{enumerable:!0,get:function(){return Mt.varKinds}}),xt.operators={GT:new $t._Code(">"),GTE:new $t._Code(">="),LT:new $t._Code("<"),LTE:new $t._Code("<="),EQ:new $t._Code("==="),NEQ:new $t._Code("!=="),NOT:new $t._Code("!"),OR:new $t._Code("||"),AND:new $t._Code("&&"),ADD:new $t._Code("+")};class Ft{optimizeNodes(){return this}optimizeNames(Tn,Pn){return this}}class jt extends Ft{constructor(Tn,Pn,Ln){super(),this.varKind=Tn,this.name=Pn,this.rhs=Ln}render({es5:Tn,_n:Pn}){const Ln=Tn?Ct.varKinds.var:this.varKind,Vn=this.rhs===void 0?"":` = ${this.rhs}`;return`${Ln} ${this.name}${Vn};`+Pn}optimizeNames(Tn,Pn){if(Tn[this.name.str])return this.rhs&&(this.rhs=xn(this.rhs,Tn,Pn)),this}get names(){return this.rhs instanceof $t._CodeOrName?this.rhs.names:{}}}class Bt extends Ft{constructor(Tn,Pn,Ln){super(),this.lhs=Tn,this.rhs=Pn,this.sideEffects=Ln}render({_n:Tn}){return`${this.lhs} = ${this.rhs};`+Tn}optimizeNames(Tn,Pn){if(!(this.lhs instanceof $t.Name&&!Tn[this.lhs.str]&&!this.sideEffects))return this.rhs=xn(this.rhs,Tn,Pn),this}get names(){const Tn=this.lhs instanceof $t.Name?{}:{...this.lhs.names};return bn(Tn,this.rhs)}}class Vt extends Bt{constructor(Tn,Pn,Ln,Vn){super(Tn,Ln,Vn),this.op=Pn}render({_n:Tn}){return`${this.lhs} ${this.op}= ${this.rhs};`+Tn}}class zt extends Ft{constructor(Tn){super(),this.label=Tn,this.names={}}render({_n:Tn}){return`${this.label}:`+Tn}}class Ht extends Ft{constructor(Tn){super(),this.label=Tn,this.names={}}render({_n:Tn}){return`break${this.label?` ${this.label}`:""};`+Tn}}class Gt extends Ft{constructor(Tn){super(),this.error=Tn}render({_n:Tn}){return`throw ${this.error};`+Tn}get names(){return this.error.names}}class qt extends Ft{constructor(Tn){super(),this.code=Tn}render({_n:Tn}){return`${this.code};`+Tn}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(Tn,Pn){return this.code=xn(this.code,Tn,Pn),this}get names(){return this.code instanceof $t._CodeOrName?this.code.names:{}}}class Wt extends Ft{constructor(Tn=[]){super(),this.nodes=Tn}render(Tn){return this.nodes.reduce((Pn,Ln)=>Pn+Ln.render(Tn),"")}optimizeNodes(){const{nodes:Tn}=this;let Pn=Tn.length;for(;Pn--;){const Ln=Tn[Pn].optimizeNodes();Array.isArray(Ln)?Tn.splice(Pn,1,...Ln):Ln?Tn[Pn]=Ln:Tn.splice(Pn,1)}return Tn.length>0?this:void 0}optimizeNames(Tn,Pn){const{nodes:Ln}=this;let Vn=Ln.length;for(;Vn--;){const Un=Ln[Vn];Un.optimizeNames(Tn,Pn)||(Cn(Tn,Un.names),Ln.splice(Vn,1))}return Ln.length>0?this:void 0}get names(){return this.nodes.reduce((Tn,Pn)=>En(Tn,Pn.names),{})}}class Yt extends Wt{render(Tn){return"{"+Tn._n+super.render(Tn)+"}"+Tn._n}}class Kt extends Wt{}class Xt extends Yt{}Xt.kind="else";class Qt extends Yt{constructor(Tn,Pn){super(Pn),this.condition=Tn}render(Tn){let Pn=`if(${this.condition})`+super.render(Tn);return this.else&&(Pn+="else "+this.else.render(Tn)),Pn}optimizeNodes(){super.optimizeNodes();const Tn=this.condition;if(Tn===!0)return this.nodes;let Pn=this.else;if(Pn){const Ln=Pn.optimizeNodes();Pn=this.else=Array.isArray(Ln)?new Xt(Ln):Ln}if(Pn)return Tn===!1?Pn instanceof Qt?Pn:Pn.nodes:this.nodes.length?this:new Qt($n(Tn),Pn instanceof Qt?[Pn]:Pn.nodes);if(!(Tn===!1||!this.nodes.length))return this}optimizeNames(Tn,Pn){var Ln;if(this.else=(Ln=this.else)===null||Ln===void 0?void 0:Ln.optimizeNames(Tn,Pn),!!(super.optimizeNames(Tn,Pn)||this.else))return this.condition=xn(this.condition,Tn,Pn),this}get names(){const Tn=super.names;return bn(Tn,this.condition),this.else&&En(Tn,this.else.names),Tn}}Qt.kind="if";class Jt extends Yt{}Jt.kind="for";class Zt extends Jt{constructor(Tn){super(),this.iteration=Tn}render(Tn){return`for(${this.iteration})`+super.render(Tn)}optimizeNames(Tn,Pn){if(super.optimizeNames(Tn,Pn))return this.iteration=xn(this.iteration,Tn,Pn),this}get names(){return En(super.names,this.iteration.names)}}class sn extends Jt{constructor(Tn,Pn,Ln,Vn){super(),this.varKind=Tn,this.name=Pn,this.from=Ln,this.to=Vn}render(Tn){const Pn=Tn.es5?Ct.varKinds.var:this.varKind,{name:Ln,from:Vn,to:Un}=this;return`for(${Pn} ${Ln}=${Vn}; ${Ln}<${Un}; ${Ln}++)`+super.render(Tn)}get names(){const Tn=bn(super.names,this.from);return bn(Tn,this.to)}}class ln extends Jt{constructor(Tn,Pn,Ln,Vn){super(),this.loop=Tn,this.varKind=Pn,this.name=Ln,this.iterable=Vn}render(Tn){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(Tn)}optimizeNames(Tn,Pn){if(super.optimizeNames(Tn,Pn))return this.iterable=xn(this.iterable,Tn,Pn),this}get names(){return En(super.names,this.iterable.names)}}class dn extends Yt{constructor(Tn,Pn,Ln){super(),this.name=Tn,this.args=Pn,this.async=Ln}render(Tn){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(Tn)}}dn.kind="func";class hn extends Wt{render(Tn){return"return "+super.render(Tn)}}hn.kind="return";class cn extends Yt{render(Tn){let Pn="try"+super.render(Tn);return this.catch&&(Pn+=this.catch.render(Tn)),this.finally&&(Pn+=this.finally.render(Tn)),Pn}optimizeNodes(){var Tn,Pn;return super.optimizeNodes(),(Tn=this.catch)===null||Tn===void 0||Tn.optimizeNodes(),(Pn=this.finally)===null||Pn===void 0||Pn.optimizeNodes(),this}optimizeNames(Tn,Pn){var Ln,Vn;return super.optimizeNames(Tn,Pn),(Ln=this.catch)===null||Ln===void 0||Ln.optimizeNames(Tn,Pn),(Vn=this.finally)===null||Vn===void 0||Vn.optimizeNames(Tn,Pn),this}get names(){const Tn=super.names;return this.catch&&En(Tn,this.catch.names),this.finally&&En(Tn,this.finally.names),Tn}}class pn extends Yt{constructor(Tn){super(),this.error=Tn}render(Tn){return`catch(${this.error})`+super.render(Tn)}}pn.kind="catch";class yn extends Yt{render(Tn){return"finally"+super.render(Tn)}}yn.kind="finally";class gn{constructor(Tn,Pn={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...Pn,_n:Pn.lines?`
`:""},this._extScope=Tn,this._scope=new Ct.Scope({parent:Tn}),this._nodes=[new Kt]}toString(){return this._root.render(this.opts)}name(Tn){return this._scope.name(Tn)}scopeName(Tn){return this._extScope.name(Tn)}scopeValue(Tn,Pn){const Ln=this._extScope.value(Tn,Pn);return(this._values[Ln.prefix]||(this._values[Ln.prefix]=new Set)).add(Ln),Ln}getScopeValue(Tn,Pn){return this._extScope.getValue(Tn,Pn)}scopeRefs(Tn){return this._extScope.scopeRefs(Tn,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(Tn,Pn,Ln,Vn){const Un=this._scope.toName(Pn);return Ln!==void 0&&Vn&&(this._constants[Un.str]=Ln),this._leafNode(new jt(Tn,Un,Ln)),Un}const(Tn,Pn,Ln){return this._def(Ct.varKinds.const,Tn,Pn,Ln)}let(Tn,Pn,Ln){return this._def(Ct.varKinds.let,Tn,Pn,Ln)}var(Tn,Pn,Ln){return this._def(Ct.varKinds.var,Tn,Pn,Ln)}assign(Tn,Pn,Ln){return this._leafNode(new Bt(Tn,Pn,Ln))}add(Tn,Pn){return this._leafNode(new Vt(Tn,xt.operators.ADD,Pn))}code(Tn){return typeof Tn=="function"?Tn():Tn!==$t.nil&&this._leafNode(new qt(Tn)),this}object(...Tn){const Pn=["{"];for(const[Ln,Vn]of Tn)Pn.length>1&&Pn.push(","),Pn.push(Ln),(Ln!==Vn||this.opts.es5)&&(Pn.push(":"),(0,$t.addCodeArg)(Pn,Vn));return Pn.push("}"),new $t._Code(Pn)}if(Tn,Pn,Ln){if(this._blockNode(new Qt(Tn)),Pn&&Ln)this.code(Pn).else().code(Ln).endIf();else if(Pn)this.code(Pn).endIf();else if(Ln)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(Tn){return this._elseNode(new Qt(Tn))}else(){return this._elseNode(new Xt)}endIf(){return this._endBlockNode(Qt,Xt)}_for(Tn,Pn){return this._blockNode(Tn),Pn&&this.code(Pn).endFor(),this}for(Tn,Pn){return this._for(new Zt(Tn),Pn)}forRange(Tn,Pn,Ln,Vn,Un=this.opts.es5?Ct.varKinds.var:Ct.varKinds.let){const Wn=this._scope.toName(Tn);return this._for(new sn(Un,Wn,Pn,Ln),()=>Vn(Wn))}forOf(Tn,Pn,Ln,Vn=Ct.varKinds.const){const Un=this._scope.toName(Tn);if(this.opts.es5){const Wn=Pn instanceof $t.Name?Pn:this.var("_arr",Pn);return this.forRange("_i",0,(0,$t._)`${Wn}.length`,rr=>{this.var(Un,(0,$t._)`${Wn}[${rr}]`),Ln(Un)})}return this._for(new ln("of",Vn,Un,Pn),()=>Ln(Un))}forIn(Tn,Pn,Ln,Vn=this.opts.es5?Ct.varKinds.var:Ct.varKinds.const){if(this.opts.ownProperties)return this.forOf(Tn,(0,$t._)`Object.keys(${Pn})`,Ln);const Un=this._scope.toName(Tn);return this._for(new ln("in",Vn,Un,Pn),()=>Ln(Un))}endFor(){return this._endBlockNode(Jt)}label(Tn){return this._leafNode(new zt(Tn))}break(Tn){return this._leafNode(new Ht(Tn))}return(Tn){const Pn=new hn;if(this._blockNode(Pn),this.code(Tn),Pn.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(hn)}try(Tn,Pn,Ln){if(!Pn&&!Ln)throw new Error('CodeGen: "try" without "catch" and "finally"');const Vn=new cn;if(this._blockNode(Vn),this.code(Tn),Pn){const Un=this.name("e");this._currNode=Vn.catch=new pn(Un),Pn(Un)}return Ln&&(this._currNode=Vn.finally=new yn,this.code(Ln)),this._endBlockNode(pn,yn)}throw(Tn){return this._leafNode(new Gt(Tn))}block(Tn,Pn){return this._blockStarts.push(this._nodes.length),Tn&&this.code(Tn).endBlock(Pn),this}endBlock(Tn){const Pn=this._blockStarts.pop();if(Pn===void 0)throw new Error("CodeGen: not in self-balancing block");const Ln=this._nodes.length-Pn;if(Ln<0||Tn!==void 0&&Ln!==Tn)throw new Error(`CodeGen: wrong number of nodes: ${Ln} vs ${Tn} expected`);return this._nodes.length=Pn,this}func(Tn,Pn=$t.nil,Ln,Vn){return this._blockNode(new dn(Tn,Pn,Ln)),Vn&&this.code(Vn).endFunc(),this}endFunc(){return this._endBlockNode(dn)}optimize(Tn=1){for(;Tn-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(Tn){return this._currNode.nodes.push(Tn),this}_blockNode(Tn){this._currNode.nodes.push(Tn),this._nodes.push(Tn)}_endBlockNode(Tn,Pn){const Ln=this._currNode;if(Ln instanceof Tn||Pn&&Ln instanceof Pn)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${Pn?`${Tn.kind}/${Pn.kind}`:Tn.kind}"`)}_elseNode(Tn){const Pn=this._currNode;if(!(Pn instanceof Qt))throw new Error('CodeGen: "else" without "if"');return this._currNode=Pn.else=Tn,this}get _root(){return this._nodes[0]}get _currNode(){const Tn=this._nodes;return Tn[Tn.length-1]}set _currNode(Tn){const Pn=this._nodes;Pn[Pn.length-1]=Tn}}xt.CodeGen=gn;function En(_n,Tn){for(const Pn in Tn)_n[Pn]=(_n[Pn]||0)+(Tn[Pn]||0);return _n}function bn(_n,Tn){return Tn instanceof $t._CodeOrName?En(_n,Tn.names):_n}function xn(_n,Tn,Pn){if(_n instanceof $t.Name)return Ln(_n);if(!Vn(_n))return _n;return new $t._Code(_n._items.reduce((Un,Wn)=>(Wn instanceof $t.Name&&(Wn=Ln(Wn)),Wn instanceof $t._Code?Un.push(...Wn._items):Un.push(Wn),Un),[]));function Ln(Un){const Wn=Pn[Un.str];return Wn===void 0||Tn[Un.str]!==1?Un:(delete Tn[Un.str],Wn)}function Vn(Un){return Un instanceof $t._Code&&Un._items.some(Wn=>Wn instanceof $t.Name&&Tn[Wn.str]===1&&Pn[Wn.str]!==void 0)}}function Cn(_n,Tn){for(const Pn in Tn)_n[Pn]=(_n[Pn]||0)-(Tn[Pn]||0)}function $n(_n){return typeof _n=="boolean"||typeof _n=="number"||_n===null?!_n:(0,$t._)`!${vn(_n)}`}xt.not=$n;const wn=Sn(xt.operators.AND);function Rn(..._n){return _n.reduce(wn)}xt.and=Rn;const Dn=Sn(xt.operators.OR);function An(..._n){return _n.reduce(Dn)}xt.or=An;function Sn(_n){return(Tn,Pn)=>Tn===$t.nil?Pn:Pn===$t.nil?Tn:(0,$t._)`${vn(Tn)} ${_n} ${vn(Pn)}`}function vn(_n){return _n instanceof $t.Name?_n:(0,$t._)`(${_n})`}})(codegen$1);var util={};Object.defineProperty(util,"__esModule",{value:!0});util.checkStrictMode=util.getErrorPath=util.Type=util.useFunc=util.setEvaluated=util.evaluatedPropsToName=util.mergeEvaluated=util.eachItem=util.unescapeJsonPointer=util.escapeJsonPointer=util.escapeFragment=util.unescapeFragment=util.schemaRefOrVal=util.schemaHasRulesButRef=util.schemaHasRules=util.checkUnknownRules=util.alwaysValidSchema=util.toHash=void 0;const codegen_1$v=codegen$1,code_1$a=code$1;function toHash(xt){const $t={};for(const Ct of xt)$t[Ct]=!0;return $t}util.toHash=toHash;function alwaysValidSchema(xt,$t){return typeof $t=="boolean"?$t:Object.keys($t).length===0?!0:(checkUnknownRules(xt,$t),!schemaHasRules($t,xt.self.RULES.all))}util.alwaysValidSchema=alwaysValidSchema;function checkUnknownRules(xt,$t=xt.schema){const{opts:Ct,self:kt}=xt;if(!Ct.strictSchema||typeof $t=="boolean")return;const Mt=kt.RULES.keywords;for(const Ft in $t)Mt[Ft]||checkStrictMode(xt,`unknown keyword: "${Ft}"`)}util.checkUnknownRules=checkUnknownRules;function schemaHasRules(xt,$t){if(typeof xt=="boolean")return!xt;for(const Ct in xt)if($t[Ct])return!0;return!1}util.schemaHasRules=schemaHasRules;function schemaHasRulesButRef(xt,$t){if(typeof xt=="boolean")return!xt;for(const Ct in xt)if(Ct!=="$ref"&&$t.all[Ct])return!0;return!1}util.schemaHasRulesButRef=schemaHasRulesButRef;function schemaRefOrVal({topSchemaRef:xt,schemaPath:$t},Ct,kt,Mt){if(!Mt){if(typeof Ct=="number"||typeof Ct=="boolean")return Ct;if(typeof Ct=="string")return(0,codegen_1$v._)`${Ct}`}return(0,codegen_1$v._)`${xt}${$t}${(0,codegen_1$v.getProperty)(kt)}`}util.schemaRefOrVal=schemaRefOrVal;function unescapeFragment(xt){return unescapeJsonPointer(decodeURIComponent(xt))}util.unescapeFragment=unescapeFragment;function escapeFragment(xt){return encodeURIComponent(escapeJsonPointer(xt))}util.escapeFragment=escapeFragment;function escapeJsonPointer(xt){return typeof xt=="number"?`${xt}`:xt.replace(/~/g,"~0").replace(/\//g,"~1")}util.escapeJsonPointer=escapeJsonPointer;function unescapeJsonPointer(xt){return xt.replace(/~1/g,"/").replace(/~0/g,"~")}util.unescapeJsonPointer=unescapeJsonPointer;function eachItem(xt,$t){if(Array.isArray(xt))for(const Ct of xt)$t(Ct);else $t(xt)}util.eachItem=eachItem;function makeMergeEvaluated({mergeNames:xt,mergeToName:$t,mergeValues:Ct,resultToName:kt}){return(Mt,Ft,jt,Bt)=>{const Vt=jt===void 0?Ft:jt instanceof codegen_1$v.Name?(Ft instanceof codegen_1$v.Name?xt(Mt,Ft,jt):$t(Mt,Ft,jt),jt):Ft instanceof codegen_1$v.Name?($t(Mt,jt,Ft),Ft):Ct(Ft,jt);return Bt===codegen_1$v.Name&&!(Vt instanceof codegen_1$v.Name)?kt(Mt,Vt):Vt}}util.mergeEvaluated={props:makeMergeEvaluated({mergeNames:(xt,$t,Ct)=>xt.if((0,codegen_1$v._)`${Ct} !== true && ${$t} !== undefined`,()=>{xt.if((0,codegen_1$v._)`${$t} === true`,()=>xt.assign(Ct,!0),()=>xt.assign(Ct,(0,codegen_1$v._)`${Ct} || {}`).code((0,codegen_1$v._)`Object.assign(${Ct}, ${$t})`))}),mergeToName:(xt,$t,Ct)=>xt.if((0,codegen_1$v._)`${Ct} !== true`,()=>{$t===!0?xt.assign(Ct,!0):(xt.assign(Ct,(0,codegen_1$v._)`${Ct} || {}`),setEvaluated(xt,Ct,$t))}),mergeValues:(xt,$t)=>xt===!0?!0:{...xt,...$t},resultToName:evaluatedPropsToName}),items:makeMergeEvaluated({mergeNames:(xt,$t,Ct)=>xt.if((0,codegen_1$v._)`${Ct} !== true && ${$t} !== undefined`,()=>xt.assign(Ct,(0,codegen_1$v._)`${$t} === true ? true : ${Ct} > ${$t} ? ${Ct} : ${$t}`)),mergeToName:(xt,$t,Ct)=>xt.if((0,codegen_1$v._)`${Ct} !== true`,()=>xt.assign(Ct,$t===!0?!0:(0,codegen_1$v._)`${Ct} > ${$t} ? ${Ct} : ${$t}`)),mergeValues:(xt,$t)=>xt===!0?!0:Math.max(xt,$t),resultToName:(xt,$t)=>xt.var("items",$t)})};function evaluatedPropsToName(xt,$t){if($t===!0)return xt.var("props",!0);const Ct=xt.var("props",(0,codegen_1$v._)`{}`);return $t!==void 0&&setEvaluated(xt,Ct,$t),Ct}util.evaluatedPropsToName=evaluatedPropsToName;function setEvaluated(xt,$t,Ct){Object.keys(Ct).forEach(kt=>xt.assign((0,codegen_1$v._)`${$t}${(0,codegen_1$v.getProperty)(kt)}`,!0))}util.setEvaluated=setEvaluated;const snippets={};function useFunc(xt,$t){return xt.scopeValue("func",{ref:$t,code:snippets[$t.code]||(snippets[$t.code]=new code_1$a._Code($t.code))})}util.useFunc=useFunc;var Type$1;(function(xt){xt[xt.Num=0]="Num",xt[xt.Str=1]="Str"})(Type$1||(util.Type=Type$1={}));function getErrorPath(xt,$t,Ct){if(xt instanceof codegen_1$v.Name){const kt=$t===Type$1.Num;return Ct?kt?(0,codegen_1$v._)`"[" + ${xt} + "]"`:(0,codegen_1$v._)`"['" + ${xt} + "']"`:kt?(0,codegen_1$v._)`"/" + ${xt}`:(0,codegen_1$v._)`"/" + ${xt}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return Ct?(0,codegen_1$v.getProperty)(xt).toString():"/"+escapeJsonPointer(xt)}util.getErrorPath=getErrorPath;function checkStrictMode(xt,$t,Ct=xt.opts.strictSchema){if(Ct){if($t=`strict mode: ${$t}`,Ct===!0)throw new Error($t);xt.self.logger.warn($t)}}util.checkStrictMode=checkStrictMode;var names$1={};Object.defineProperty(names$1,"__esModule",{value:!0});const codegen_1$u=codegen$1,names={data:new codegen_1$u.Name("data"),valCxt:new codegen_1$u.Name("valCxt"),instancePath:new codegen_1$u.Name("instancePath"),parentData:new codegen_1$u.Name("parentData"),parentDataProperty:new codegen_1$u.Name("parentDataProperty"),rootData:new codegen_1$u.Name("rootData"),dynamicAnchors:new codegen_1$u.Name("dynamicAnchors"),vErrors:new codegen_1$u.Name("vErrors"),errors:new codegen_1$u.Name("errors"),this:new codegen_1$u.Name("this"),self:new codegen_1$u.Name("self"),scope:new codegen_1$u.Name("scope"),json:new codegen_1$u.Name("json"),jsonPos:new codegen_1$u.Name("jsonPos"),jsonLen:new codegen_1$u.Name("jsonLen"),jsonPart:new codegen_1$u.Name("jsonPart")};names$1.default=names;(function(xt){Object.defineProperty(xt,"__esModule",{value:!0}),xt.extendErrors=xt.resetErrorsCount=xt.reportExtraError=xt.reportError=xt.keyword$DataError=xt.keywordError=void 0;const $t=codegen$1,Ct=util,kt=names$1;xt.keywordError={message:({keyword:Xt})=>(0,$t.str)`must pass "${Xt}" keyword validation`},xt.keyword$DataError={message:({keyword:Xt,schemaType:Qt})=>Qt?(0,$t.str)`"${Xt}" keyword must be ${Qt} ($data)`:(0,$t.str)`"${Xt}" keyword is invalid ($data)`};function Mt(Xt,Qt=xt.keywordError,Jt,Zt){const{it:sn}=Xt,{gen:ln,compositeRule:dn,allErrors:hn}=sn,cn=Gt(Xt,Qt,Jt);Zt??(dn||hn)?Vt(ln,cn):zt(sn,(0,$t._)`[${cn}]`)}xt.reportError=Mt;function Ft(Xt,Qt=xt.keywordError,Jt){const{it:Zt}=Xt,{gen:sn,compositeRule:ln,allErrors:dn}=Zt,hn=Gt(Xt,Qt,Jt);Vt(sn,hn),ln||dn||zt(Zt,kt.default.vErrors)}xt.reportExtraError=Ft;function jt(Xt,Qt){Xt.assign(kt.default.errors,Qt),Xt.if((0,$t._)`${kt.default.vErrors} !== null`,()=>Xt.if(Qt,()=>Xt.assign((0,$t._)`${kt.default.vErrors}.length`,Qt),()=>Xt.assign(kt.default.vErrors,null)))}xt.resetErrorsCount=jt;function Bt({gen:Xt,keyword:Qt,schemaValue:Jt,data:Zt,errsCount:sn,it:ln}){if(sn===void 0)throw new Error("ajv implementation error");const dn=Xt.name("err");Xt.forRange("i",sn,kt.default.errors,hn=>{Xt.const(dn,(0,$t._)`${kt.default.vErrors}[${hn}]`),Xt.if((0,$t._)`${dn}.instancePath === undefined`,()=>Xt.assign((0,$t._)`${dn}.instancePath`,(0,$t.strConcat)(kt.default.instancePath,ln.errorPath))),Xt.assign((0,$t._)`${dn}.schemaPath`,(0,$t.str)`${ln.errSchemaPath}/${Qt}`),ln.opts.verbose&&(Xt.assign((0,$t._)`${dn}.schema`,Jt),Xt.assign((0,$t._)`${dn}.data`,Zt))})}xt.extendErrors=Bt;function Vt(Xt,Qt){const Jt=Xt.const("err",Qt);Xt.if((0,$t._)`${kt.default.vErrors} === null`,()=>Xt.assign(kt.default.vErrors,(0,$t._)`[${Jt}]`),(0,$t._)`${kt.default.vErrors}.push(${Jt})`),Xt.code((0,$t._)`${kt.default.errors}++`)}function zt(Xt,Qt){const{gen:Jt,validateName:Zt,schemaEnv:sn}=Xt;sn.$async?Jt.throw((0,$t._)`new ${Xt.ValidationError}(${Qt})`):(Jt.assign((0,$t._)`${Zt}.errors`,Qt),Jt.return(!1))}const Ht={keyword:new $t.Name("keyword"),schemaPath:new $t.Name("schemaPath"),params:new $t.Name("params"),propertyName:new $t.Name("propertyName"),message:new $t.Name("message"),schema:new $t.Name("schema"),parentSchema:new $t.Name("parentSchema")};function Gt(Xt,Qt,Jt){const{createErrors:Zt}=Xt.it;return Zt===!1?(0,$t._)`{}`:qt(Xt,Qt,Jt)}function qt(Xt,Qt,Jt={}){const{gen:Zt,it:sn}=Xt,ln=[Wt(sn,Jt),Yt(Xt,Jt)];return Kt(Xt,Qt,ln),Zt.object(...ln)}function Wt({errorPath:Xt},{instancePath:Qt}){const Jt=Qt?(0,$t.str)`${Xt}${(0,Ct.getErrorPath)(Qt,Ct.Type.Str)}`:Xt;return[kt.default.instancePath,(0,$t.strConcat)(kt.default.instancePath,Jt)]}function Yt({keyword:Xt,it:{errSchemaPath:Qt}},{schemaPath:Jt,parentSchema:Zt}){let sn=Zt?Qt:(0,$t.str)`${Qt}/${Xt}`;return Jt&&(sn=(0,$t.str)`${sn}${(0,Ct.getErrorPath)(Jt,Ct.Type.Str)}`),[Ht.schemaPath,sn]}function Kt(Xt,{params:Qt,message:Jt},Zt){const{keyword:sn,data:ln,schemaValue:dn,it:hn}=Xt,{opts:cn,propertyName:pn,topSchemaRef:yn,schemaPath:gn}=hn;Zt.push([Ht.keyword,sn],[Ht.params,typeof Qt=="function"?Qt(Xt):Qt||(0,$t._)`{}`]),cn.messages&&Zt.push([Ht.message,typeof Jt=="function"?Jt(Xt):Jt]),cn.verbose&&Zt.push([Ht.schema,dn],[Ht.parentSchema,(0,$t._)`${yn}${gn}`],[kt.default.data,ln]),pn&&Zt.push([Ht.propertyName,pn])}})(errors);Object.defineProperty(boolSchema,"__esModule",{value:!0});boolSchema.boolOrEmptySchema=boolSchema.topBoolOrEmptySchema=void 0;const errors_1$3=errors,codegen_1$t=codegen$1,names_1$6=names$1,boolError={message:"boolean schema is false"};function topBoolOrEmptySchema(xt){const{gen:$t,schema:Ct,validateName:kt}=xt;Ct===!1?falseSchemaError(xt,!1):typeof Ct=="object"&&Ct.$async===!0?$t.return(names_1$6.default.data):($t.assign((0,codegen_1$t._)`${kt}.errors`,null),$t.return(!0))}boolSchema.topBoolOrEmptySchema=topBoolOrEmptySchema;function boolOrEmptySchema(xt,$t){const{gen:Ct,schema:kt}=xt;kt===!1?(Ct.var($t,!1),falseSchemaError(xt)):Ct.var($t,!0)}boolSchema.boolOrEmptySchema=boolOrEmptySchema;function falseSchemaError(xt,$t){const{gen:Ct,data:kt}=xt,Mt={gen:Ct,keyword:"false schema",data:kt,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:xt};(0,errors_1$3.reportError)(Mt,boolError,void 0,$t)}var dataType={},rules={};Object.defineProperty(rules,"__esModule",{value:!0});rules.getRules=rules.isJSONType=void 0;const _jsonTypes=["string","number","integer","boolean","null","object","array"],jsonTypes=new Set(_jsonTypes);function isJSONType(xt){return typeof xt=="string"&&jsonTypes.has(xt)}rules.isJSONType=isJSONType;function getRules(){const xt={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...xt,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},xt.number,xt.string,xt.array,xt.object],post:{rules:[]},all:{},keywords:{}}}rules.getRules=getRules;var applicability={};Object.defineProperty(applicability,"__esModule",{value:!0});applicability.shouldUseRule=applicability.shouldUseGroup=applicability.schemaHasRulesForType=void 0;function schemaHasRulesForType({schema:xt,self:$t},Ct){const kt=$t.RULES.types[Ct];return kt&&kt!==!0&&shouldUseGroup(xt,kt)}applicability.schemaHasRulesForType=schemaHasRulesForType;function shouldUseGroup(xt,$t){return $t.rules.some(Ct=>shouldUseRule(xt,Ct))}applicability.shouldUseGroup=shouldUseGroup;function shouldUseRule(xt,$t){var Ct;return xt[$t.keyword]!==void 0||((Ct=$t.definition.implements)===null||Ct===void 0?void 0:Ct.some(kt=>xt[kt]!==void 0))}applicability.shouldUseRule=shouldUseRule;Object.defineProperty(dataType,"__esModule",{value:!0});dataType.reportTypeError=dataType.checkDataTypes=dataType.checkDataType=dataType.coerceAndCheckDataType=dataType.getJSONTypes=dataType.getSchemaTypes=dataType.DataType=void 0;const rules_1=rules,applicability_1$1=applicability,errors_1$2=errors,codegen_1$s=codegen$1,util_1$q=util;var DataType;(function(xt){xt[xt.Correct=0]="Correct",xt[xt.Wrong=1]="Wrong"})(DataType||(dataType.DataType=DataType={}));function getSchemaTypes(xt){const $t=getJSONTypes(xt.type);if($t.includes("null")){if(xt.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!$t.length&&xt.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');xt.nullable===!0&&$t.push("null")}return $t}dataType.getSchemaTypes=getSchemaTypes;function getJSONTypes(xt){const $t=Array.isArray(xt)?xt:xt?[xt]:[];if($t.every(rules_1.isJSONType))return $t;throw new Error("type must be JSONType or JSONType[]: "+$t.join(","))}dataType.getJSONTypes=getJSONTypes;function coerceAndCheckDataType(xt,$t){const{gen:Ct,data:kt,opts:Mt}=xt,Ft=coerceToTypes($t,Mt.coerceTypes),jt=$t.length>0&&!(Ft.length===0&&$t.length===1&&(0,applicability_1$1.schemaHasRulesForType)(xt,$t[0]));if(jt){const Bt=checkDataTypes($t,kt,Mt.strictNumbers,DataType.Wrong);Ct.if(Bt,()=>{Ft.length?coerceData(xt,$t,Ft):reportTypeError(xt)})}return jt}dataType.coerceAndCheckDataType=coerceAndCheckDataType;const COERCIBLE=new Set(["string","number","integer","boolean","null"]);function coerceToTypes(xt,$t){return $t?xt.filter(Ct=>COERCIBLE.has(Ct)||$t==="array"&&Ct==="array"):[]}function coerceData(xt,$t,Ct){const{gen:kt,data:Mt,opts:Ft}=xt,jt=kt.let("dataType",(0,codegen_1$s._)`typeof ${Mt}`),Bt=kt.let("coerced",(0,codegen_1$s._)`undefined`);Ft.coerceTypes==="array"&&kt.if((0,codegen_1$s._)`${jt} == 'object' && Array.isArray(${Mt}) && ${Mt}.length == 1`,()=>kt.assign(Mt,(0,codegen_1$s._)`${Mt}[0]`).assign(jt,(0,codegen_1$s._)`typeof ${Mt}`).if(checkDataTypes($t,Mt,Ft.strictNumbers),()=>kt.assign(Bt,Mt))),kt.if((0,codegen_1$s._)`${Bt} !== undefined`);for(const zt of Ct)(COERCIBLE.has(zt)||zt==="array"&&Ft.coerceTypes==="array")&&Vt(zt);kt.else(),reportTypeError(xt),kt.endIf(),kt.if((0,codegen_1$s._)`${Bt} !== undefined`,()=>{kt.assign(Mt,Bt),assignParentData(xt,Bt)});function Vt(zt){switch(zt){case"string":kt.elseIf((0,codegen_1$s._)`${jt} == "number" || ${jt} == "boolean"`).assign(Bt,(0,codegen_1$s._)`"" + ${Mt}`).elseIf((0,codegen_1$s._)`${Mt} === null`).assign(Bt,(0,codegen_1$s._)`""`);return;case"number":kt.elseIf((0,codegen_1$s._)`${jt} == "boolean" || ${Mt} === null
              || (${jt} == "string" && ${Mt} && ${Mt} == +${Mt})`).assign(Bt,(0,codegen_1$s._)`+${Mt}`);return;case"integer":kt.elseIf((0,codegen_1$s._)`${jt} === "boolean" || ${Mt} === null
              || (${jt} === "string" && ${Mt} && ${Mt} == +${Mt} && !(${Mt} % 1))`).assign(Bt,(0,codegen_1$s._)`+${Mt}`);return;case"boolean":kt.elseIf((0,codegen_1$s._)`${Mt} === "false" || ${Mt} === 0 || ${Mt} === null`).assign(Bt,!1).elseIf((0,codegen_1$s._)`${Mt} === "true" || ${Mt} === 1`).assign(Bt,!0);return;case"null":kt.elseIf((0,codegen_1$s._)`${Mt} === "" || ${Mt} === 0 || ${Mt} === false`),kt.assign(Bt,null);return;case"array":kt.elseIf((0,codegen_1$s._)`${jt} === "string" || ${jt} === "number"
              || ${jt} === "boolean" || ${Mt} === null`).assign(Bt,(0,codegen_1$s._)`[${Mt}]`)}}}function assignParentData({gen:xt,parentData:$t,parentDataProperty:Ct},kt){xt.if((0,codegen_1$s._)`${$t} !== undefined`,()=>xt.assign((0,codegen_1$s._)`${$t}[${Ct}]`,kt))}function checkDataType(xt,$t,Ct,kt=DataType.Correct){const Mt=kt===DataType.Correct?codegen_1$s.operators.EQ:codegen_1$s.operators.NEQ;let Ft;switch(xt){case"null":return(0,codegen_1$s._)`${$t} ${Mt} null`;case"array":Ft=(0,codegen_1$s._)`Array.isArray(${$t})`;break;case"object":Ft=(0,codegen_1$s._)`${$t} && typeof ${$t} == "object" && !Array.isArray(${$t})`;break;case"integer":Ft=jt((0,codegen_1$s._)`!(${$t} % 1) && !isNaN(${$t})`);break;case"number":Ft=jt();break;default:return(0,codegen_1$s._)`typeof ${$t} ${Mt} ${xt}`}return kt===DataType.Correct?Ft:(0,codegen_1$s.not)(Ft);function jt(Bt=codegen_1$s.nil){return(0,codegen_1$s.and)((0,codegen_1$s._)`typeof ${$t} == "number"`,Bt,Ct?(0,codegen_1$s._)`isFinite(${$t})`:codegen_1$s.nil)}}dataType.checkDataType=checkDataType;function checkDataTypes(xt,$t,Ct,kt){if(xt.length===1)return checkDataType(xt[0],$t,Ct,kt);let Mt;const Ft=(0,util_1$q.toHash)(xt);if(Ft.array&&Ft.object){const jt=(0,codegen_1$s._)`typeof ${$t} != "object"`;Mt=Ft.null?jt:(0,codegen_1$s._)`!${$t} || ${jt}`,delete Ft.null,delete Ft.array,delete Ft.object}else Mt=codegen_1$s.nil;Ft.number&&delete Ft.integer;for(const jt in Ft)Mt=(0,codegen_1$s.and)(Mt,checkDataType(jt,$t,Ct,kt));return Mt}dataType.checkDataTypes=checkDataTypes;const typeError={message:({schema:xt})=>`must be ${xt}`,params:({schema:xt,schemaValue:$t})=>typeof xt=="string"?(0,codegen_1$s._)`{type: ${xt}}`:(0,codegen_1$s._)`{type: ${$t}}`};function reportTypeError(xt){const $t=getTypeErrorContext(xt);(0,errors_1$2.reportError)($t,typeError)}dataType.reportTypeError=reportTypeError;function getTypeErrorContext(xt){const{gen:$t,data:Ct,schema:kt}=xt,Mt=(0,util_1$q.schemaRefOrVal)(xt,kt,"type");return{gen:$t,keyword:"type",data:Ct,schema:kt.type,schemaCode:Mt,schemaValue:Mt,parentSchema:kt,params:{},it:xt}}var defaults$1={};Object.defineProperty(defaults$1,"__esModule",{value:!0});defaults$1.assignDefaults=void 0;const codegen_1$r=codegen$1,util_1$p=util;function assignDefaults(xt,$t){const{properties:Ct,items:kt}=xt.schema;if($t==="object"&&Ct)for(const Mt in Ct)assignDefault(xt,Mt,Ct[Mt].default);else $t==="array"&&Array.isArray(kt)&&kt.forEach((Mt,Ft)=>assignDefault(xt,Ft,Mt.default))}defaults$1.assignDefaults=assignDefaults;function assignDefault(xt,$t,Ct){const{gen:kt,compositeRule:Mt,data:Ft,opts:jt}=xt;if(Ct===void 0)return;const Bt=(0,codegen_1$r._)`${Ft}${(0,codegen_1$r.getProperty)($t)}`;if(Mt){(0,util_1$p.checkStrictMode)(xt,`default is ignored for: ${Bt}`);return}let Vt=(0,codegen_1$r._)`${Bt} === undefined`;jt.useDefaults==="empty"&&(Vt=(0,codegen_1$r._)`${Vt} || ${Bt} === null || ${Bt} === ""`),kt.if(Vt,(0,codegen_1$r._)`${Bt} = ${(0,codegen_1$r.stringify)(Ct)}`)}var keyword={},code={};Object.defineProperty(code,"__esModule",{value:!0});code.validateUnion=code.validateArray=code.usePattern=code.callValidateCode=code.schemaProperties=code.allSchemaProperties=code.noPropertyInData=code.propertyInData=code.isOwnProperty=code.hasPropFunc=code.reportMissingProp=code.checkMissingProp=code.checkReportMissingProp=void 0;const codegen_1$q=codegen$1,util_1$o=util,names_1$5=names$1,util_2$1=util;function checkReportMissingProp(xt,$t){const{gen:Ct,data:kt,it:Mt}=xt;Ct.if(noPropertyInData(Ct,kt,$t,Mt.opts.ownProperties),()=>{xt.setParams({missingProperty:(0,codegen_1$q._)`${$t}`},!0),xt.error()})}code.checkReportMissingProp=checkReportMissingProp;function checkMissingProp({gen:xt,data:$t,it:{opts:Ct}},kt,Mt){return(0,codegen_1$q.or)(...kt.map(Ft=>(0,codegen_1$q.and)(noPropertyInData(xt,$t,Ft,Ct.ownProperties),(0,codegen_1$q._)`${Mt} = ${Ft}`)))}code.checkMissingProp=checkMissingProp;function reportMissingProp(xt,$t){xt.setParams({missingProperty:$t},!0),xt.error()}code.reportMissingProp=reportMissingProp;function hasPropFunc(xt){return xt.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,codegen_1$q._)`Object.prototype.hasOwnProperty`})}code.hasPropFunc=hasPropFunc;function isOwnProperty(xt,$t,Ct){return(0,codegen_1$q._)`${hasPropFunc(xt)}.call(${$t}, ${Ct})`}code.isOwnProperty=isOwnProperty;function propertyInData(xt,$t,Ct,kt){const Mt=(0,codegen_1$q._)`${$t}${(0,codegen_1$q.getProperty)(Ct)} !== undefined`;return kt?(0,codegen_1$q._)`${Mt} && ${isOwnProperty(xt,$t,Ct)}`:Mt}code.propertyInData=propertyInData;function noPropertyInData(xt,$t,Ct,kt){const Mt=(0,codegen_1$q._)`${$t}${(0,codegen_1$q.getProperty)(Ct)} === undefined`;return kt?(0,codegen_1$q.or)(Mt,(0,codegen_1$q.not)(isOwnProperty(xt,$t,Ct))):Mt}code.noPropertyInData=noPropertyInData;function allSchemaProperties(xt){return xt?Object.keys(xt).filter($t=>$t!=="__proto__"):[]}code.allSchemaProperties=allSchemaProperties;function schemaProperties(xt,$t){return allSchemaProperties($t).filter(Ct=>!(0,util_1$o.alwaysValidSchema)(xt,$t[Ct]))}code.schemaProperties=schemaProperties;function callValidateCode({schemaCode:xt,data:$t,it:{gen:Ct,topSchemaRef:kt,schemaPath:Mt,errorPath:Ft},it:jt},Bt,Vt,zt){const Ht=zt?(0,codegen_1$q._)`${xt}, ${$t}, ${kt}${Mt}`:$t,Gt=[[names_1$5.default.instancePath,(0,codegen_1$q.strConcat)(names_1$5.default.instancePath,Ft)],[names_1$5.default.parentData,jt.parentData],[names_1$5.default.parentDataProperty,jt.parentDataProperty],[names_1$5.default.rootData,names_1$5.default.rootData]];jt.opts.dynamicRef&&Gt.push([names_1$5.default.dynamicAnchors,names_1$5.default.dynamicAnchors]);const qt=(0,codegen_1$q._)`${Ht}, ${Ct.object(...Gt)}`;return Vt!==codegen_1$q.nil?(0,codegen_1$q._)`${Bt}.call(${Vt}, ${qt})`:(0,codegen_1$q._)`${Bt}(${qt})`}code.callValidateCode=callValidateCode;const newRegExp=(0,codegen_1$q._)`new RegExp`;function usePattern({gen:xt,it:{opts:$t}},Ct){const kt=$t.unicodeRegExp?"u":"",{regExp:Mt}=$t.code,Ft=Mt(Ct,kt);return xt.scopeValue("pattern",{key:Ft.toString(),ref:Ft,code:(0,codegen_1$q._)`${Mt.code==="new RegExp"?newRegExp:(0,util_2$1.useFunc)(xt,Mt)}(${Ct}, ${kt})`})}code.usePattern=usePattern;function validateArray(xt){const{gen:$t,data:Ct,keyword:kt,it:Mt}=xt,Ft=$t.name("valid");if(Mt.allErrors){const Bt=$t.let("valid",!0);return jt(()=>$t.assign(Bt,!1)),Bt}return $t.var(Ft,!0),jt(()=>$t.break()),Ft;function jt(Bt){const Vt=$t.const("len",(0,codegen_1$q._)`${Ct}.length`);$t.forRange("i",0,Vt,zt=>{xt.subschema({keyword:kt,dataProp:zt,dataPropType:util_1$o.Type.Num},Ft),$t.if((0,codegen_1$q.not)(Ft),Bt)})}}code.validateArray=validateArray;function validateUnion(xt){const{gen:$t,schema:Ct,keyword:kt,it:Mt}=xt;if(!Array.isArray(Ct))throw new Error("ajv implementation error");if(Ct.some(Vt=>(0,util_1$o.alwaysValidSchema)(Mt,Vt))&&!Mt.opts.unevaluated)return;const jt=$t.let("valid",!1),Bt=$t.name("_valid");$t.block(()=>Ct.forEach((Vt,zt)=>{const Ht=xt.subschema({keyword:kt,schemaProp:zt,compositeRule:!0},Bt);$t.assign(jt,(0,codegen_1$q._)`${jt} || ${Bt}`),xt.mergeValidEvaluated(Ht,Bt)||$t.if((0,codegen_1$q.not)(jt))})),xt.result(jt,()=>xt.reset(),()=>xt.error(!0))}code.validateUnion=validateUnion;Object.defineProperty(keyword,"__esModule",{value:!0});keyword.validateKeywordUsage=keyword.validSchemaType=keyword.funcKeywordCode=keyword.macroKeywordCode=void 0;const codegen_1$p=codegen$1,names_1$4=names$1,code_1$9=code,errors_1$1=errors;function macroKeywordCode(xt,$t){const{gen:Ct,keyword:kt,schema:Mt,parentSchema:Ft,it:jt}=xt,Bt=$t.macro.call(jt.self,Mt,Ft,jt),Vt=useKeyword(Ct,kt,Bt);jt.opts.validateSchema!==!1&&jt.self.validateSchema(Bt,!0);const zt=Ct.name("valid");xt.subschema({schema:Bt,schemaPath:codegen_1$p.nil,errSchemaPath:`${jt.errSchemaPath}/${kt}`,topSchemaRef:Vt,compositeRule:!0},zt),xt.pass(zt,()=>xt.error(!0))}keyword.macroKeywordCode=macroKeywordCode;function funcKeywordCode(xt,$t){var Ct;const{gen:kt,keyword:Mt,schema:Ft,parentSchema:jt,$data:Bt,it:Vt}=xt;checkAsyncKeyword(Vt,$t);const zt=!Bt&&$t.compile?$t.compile.call(Vt.self,Ft,jt,Vt):$t.validate,Ht=useKeyword(kt,Mt,zt),Gt=kt.let("valid");xt.block$data(Gt,qt),xt.ok((Ct=$t.valid)!==null&&Ct!==void 0?Ct:Gt);function qt(){if($t.errors===!1)Kt(),$t.modifying&&modifyData(xt),Xt(()=>xt.error());else{const Qt=$t.async?Wt():Yt();$t.modifying&&modifyData(xt),Xt(()=>addErrs(xt,Qt))}}function Wt(){const Qt=kt.let("ruleErrs",null);return kt.try(()=>Kt((0,codegen_1$p._)`await `),Jt=>kt.assign(Gt,!1).if((0,codegen_1$p._)`${Jt} instanceof ${Vt.ValidationError}`,()=>kt.assign(Qt,(0,codegen_1$p._)`${Jt}.errors`),()=>kt.throw(Jt))),Qt}function Yt(){const Qt=(0,codegen_1$p._)`${Ht}.errors`;return kt.assign(Qt,null),Kt(codegen_1$p.nil),Qt}function Kt(Qt=$t.async?(0,codegen_1$p._)`await `:codegen_1$p.nil){const Jt=Vt.opts.passContext?names_1$4.default.this:names_1$4.default.self,Zt=!("compile"in $t&&!Bt||$t.schema===!1);kt.assign(Gt,(0,codegen_1$p._)`${Qt}${(0,code_1$9.callValidateCode)(xt,Ht,Jt,Zt)}`,$t.modifying)}function Xt(Qt){var Jt;kt.if((0,codegen_1$p.not)((Jt=$t.valid)!==null&&Jt!==void 0?Jt:Gt),Qt)}}keyword.funcKeywordCode=funcKeywordCode;function modifyData(xt){const{gen:$t,data:Ct,it:kt}=xt;$t.if(kt.parentData,()=>$t.assign(Ct,(0,codegen_1$p._)`${kt.parentData}[${kt.parentDataProperty}]`))}function addErrs(xt,$t){const{gen:Ct}=xt;Ct.if((0,codegen_1$p._)`Array.isArray(${$t})`,()=>{Ct.assign(names_1$4.default.vErrors,(0,codegen_1$p._)`${names_1$4.default.vErrors} === null ? ${$t} : ${names_1$4.default.vErrors}.concat(${$t})`).assign(names_1$4.default.errors,(0,codegen_1$p._)`${names_1$4.default.vErrors}.length`),(0,errors_1$1.extendErrors)(xt)},()=>xt.error())}function checkAsyncKeyword({schemaEnv:xt},$t){if($t.async&&!xt.$async)throw new Error("async keyword in sync schema")}function useKeyword(xt,$t,Ct){if(Ct===void 0)throw new Error(`keyword "${$t}" failed to compile`);return xt.scopeValue("keyword",typeof Ct=="function"?{ref:Ct}:{ref:Ct,code:(0,codegen_1$p.stringify)(Ct)})}function validSchemaType(xt,$t,Ct=!1){return!$t.length||$t.some(kt=>kt==="array"?Array.isArray(xt):kt==="object"?xt&&typeof xt=="object"&&!Array.isArray(xt):typeof xt==kt||Ct&&typeof xt>"u")}keyword.validSchemaType=validSchemaType;function validateKeywordUsage({schema:xt,opts:$t,self:Ct,errSchemaPath:kt},Mt,Ft){if(Array.isArray(Mt.keyword)?!Mt.keyword.includes(Ft):Mt.keyword!==Ft)throw new Error("ajv implementation error");const jt=Mt.dependencies;if(jt!=null&&jt.some(Bt=>!Object.prototype.hasOwnProperty.call(xt,Bt)))throw new Error(`parent schema must have dependencies of ${Ft}: ${jt.join(",")}`);if(Mt.validateSchema&&!Mt.validateSchema(xt[Ft])){const Vt=`keyword "${Ft}" value is invalid at path "${kt}": `+Ct.errorsText(Mt.validateSchema.errors);if($t.validateSchema==="log")Ct.logger.error(Vt);else throw new Error(Vt)}}keyword.validateKeywordUsage=validateKeywordUsage;var subschema={};Object.defineProperty(subschema,"__esModule",{value:!0});subschema.extendSubschemaMode=subschema.extendSubschemaData=subschema.getSubschema=void 0;const codegen_1$o=codegen$1,util_1$n=util;function getSubschema(xt,{keyword:$t,schemaProp:Ct,schema:kt,schemaPath:Mt,errSchemaPath:Ft,topSchemaRef:jt}){if($t!==void 0&&kt!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if($t!==void 0){const Bt=xt.schema[$t];return Ct===void 0?{schema:Bt,schemaPath:(0,codegen_1$o._)`${xt.schemaPath}${(0,codegen_1$o.getProperty)($t)}`,errSchemaPath:`${xt.errSchemaPath}/${$t}`}:{schema:Bt[Ct],schemaPath:(0,codegen_1$o._)`${xt.schemaPath}${(0,codegen_1$o.getProperty)($t)}${(0,codegen_1$o.getProperty)(Ct)}`,errSchemaPath:`${xt.errSchemaPath}/${$t}/${(0,util_1$n.escapeFragment)(Ct)}`}}if(kt!==void 0){if(Mt===void 0||Ft===void 0||jt===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:kt,schemaPath:Mt,topSchemaRef:jt,errSchemaPath:Ft}}throw new Error('either "keyword" or "schema" must be passed')}subschema.getSubschema=getSubschema;function extendSubschemaData(xt,$t,{dataProp:Ct,dataPropType:kt,data:Mt,dataTypes:Ft,propertyName:jt}){if(Mt!==void 0&&Ct!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:Bt}=$t;if(Ct!==void 0){const{errorPath:zt,dataPathArr:Ht,opts:Gt}=$t,qt=Bt.let("data",(0,codegen_1$o._)`${$t.data}${(0,codegen_1$o.getProperty)(Ct)}`,!0);Vt(qt),xt.errorPath=(0,codegen_1$o.str)`${zt}${(0,util_1$n.getErrorPath)(Ct,kt,Gt.jsPropertySyntax)}`,xt.parentDataProperty=(0,codegen_1$o._)`${Ct}`,xt.dataPathArr=[...Ht,xt.parentDataProperty]}if(Mt!==void 0){const zt=Mt instanceof codegen_1$o.Name?Mt:Bt.let("data",Mt,!0);Vt(zt),jt!==void 0&&(xt.propertyName=jt)}Ft&&(xt.dataTypes=Ft);function Vt(zt){xt.data=zt,xt.dataLevel=$t.dataLevel+1,xt.dataTypes=[],$t.definedProperties=new Set,xt.parentData=$t.data,xt.dataNames=[...$t.dataNames,zt]}}subschema.extendSubschemaData=extendSubschemaData;function extendSubschemaMode(xt,{jtdDiscriminator:$t,jtdMetadata:Ct,compositeRule:kt,createErrors:Mt,allErrors:Ft}){kt!==void 0&&(xt.compositeRule=kt),Mt!==void 0&&(xt.createErrors=Mt),Ft!==void 0&&(xt.allErrors=Ft),xt.jtdDiscriminator=$t,xt.jtdMetadata=Ct}subschema.extendSubschemaMode=extendSubschemaMode;var resolve$2={},jsonSchemaTraverse={exports:{}},traverse$1=jsonSchemaTraverse.exports=function(xt,$t,Ct){typeof $t=="function"&&(Ct=$t,$t={}),Ct=$t.cb||Ct;var kt=typeof Ct=="function"?Ct:Ct.pre||function(){},Mt=Ct.post||function(){};_traverse($t,kt,Mt,xt,"",xt)};traverse$1.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};traverse$1.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};traverse$1.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};traverse$1.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function _traverse(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt,zt){if(kt&&typeof kt=="object"&&!Array.isArray(kt)){$t(kt,Mt,Ft,jt,Bt,Vt,zt);for(var Ht in kt){var Gt=kt[Ht];if(Array.isArray(Gt)){if(Ht in traverse$1.arrayKeywords)for(var qt=0;qt<Gt.length;qt++)_traverse(xt,$t,Ct,Gt[qt],Mt+"/"+Ht+"/"+qt,Ft,Mt,Ht,kt,qt)}else if(Ht in traverse$1.propsKeywords){if(Gt&&typeof Gt=="object")for(var Wt in Gt)_traverse(xt,$t,Ct,Gt[Wt],Mt+"/"+Ht+"/"+escapeJsonPtr(Wt),Ft,Mt,Ht,kt,Wt)}else(Ht in traverse$1.keywords||xt.allKeys&&!(Ht in traverse$1.skipKeywords))&&_traverse(xt,$t,Ct,Gt,Mt+"/"+Ht,Ft,Mt,Ht,kt)}Ct(kt,Mt,Ft,jt,Bt,Vt,zt)}}function escapeJsonPtr(xt){return xt.replace(/~/g,"~0").replace(/\//g,"~1")}var jsonSchemaTraverseExports=jsonSchemaTraverse.exports;Object.defineProperty(resolve$2,"__esModule",{value:!0});resolve$2.getSchemaRefs=resolve$2.resolveUrl=resolve$2.normalizeId=resolve$2._getFullPath=resolve$2.getFullPath=resolve$2.inlineRef=void 0;const util_1$m=util,equal$3=fastDeepEqual,traverse=jsonSchemaTraverseExports,SIMPLE_INLINED=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function inlineRef(xt,$t=!0){return typeof xt=="boolean"?!0:$t===!0?!hasRef(xt):$t?countKeys(xt)<=$t:!1}resolve$2.inlineRef=inlineRef;const REF_KEYWORDS=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function hasRef(xt){for(const $t in xt){if(REF_KEYWORDS.has($t))return!0;const Ct=xt[$t];if(Array.isArray(Ct)&&Ct.some(hasRef)||typeof Ct=="object"&&hasRef(Ct))return!0}return!1}function countKeys(xt){let $t=0;for(const Ct in xt){if(Ct==="$ref")return 1/0;if($t++,!SIMPLE_INLINED.has(Ct)&&(typeof xt[Ct]=="object"&&(0,util_1$m.eachItem)(xt[Ct],kt=>$t+=countKeys(kt)),$t===1/0))return 1/0}return $t}function getFullPath(xt,$t="",Ct){Ct!==!1&&($t=normalizeId($t));const kt=xt.parse($t);return _getFullPath(xt,kt)}resolve$2.getFullPath=getFullPath;function _getFullPath(xt,$t){return xt.serialize($t).split("#")[0]+"#"}resolve$2._getFullPath=_getFullPath;const TRAILING_SLASH_HASH=/#\/?$/;function normalizeId(xt){return xt?xt.replace(TRAILING_SLASH_HASH,""):""}resolve$2.normalizeId=normalizeId;function resolveUrl(xt,$t,Ct){return Ct=normalizeId(Ct),xt.resolve($t,Ct)}resolve$2.resolveUrl=resolveUrl;const ANCHOR$2=/^[a-z_][-a-z0-9._]*$/i;function getSchemaRefs(xt,$t){if(typeof xt=="boolean")return{};const{schemaId:Ct,uriResolver:kt}=this.opts,Mt=normalizeId(xt[Ct]||$t),Ft={"":Mt},jt=getFullPath(kt,Mt,!1),Bt={},Vt=new Set;return traverse(xt,{allKeys:!0},(Gt,qt,Wt,Yt)=>{if(Yt===void 0)return;const Kt=jt+qt;let Xt=Ft[Yt];typeof Gt[Ct]=="string"&&(Xt=Qt.call(this,Gt[Ct])),Jt.call(this,Gt.$anchor),Jt.call(this,Gt.$dynamicAnchor),Ft[qt]=Xt;function Qt(Zt){const sn=this.opts.uriResolver.resolve;if(Zt=normalizeId(Xt?sn(Xt,Zt):Zt),Vt.has(Zt))throw Ht(Zt);Vt.add(Zt);let ln=this.refs[Zt];return typeof ln=="string"&&(ln=this.refs[ln]),typeof ln=="object"?zt(Gt,ln.schema,Zt):Zt!==normalizeId(Kt)&&(Zt[0]==="#"?(zt(Gt,Bt[Zt],Zt),Bt[Zt]=Gt):this.refs[Zt]=Kt),Zt}function Jt(Zt){if(typeof Zt=="string"){if(!ANCHOR$2.test(Zt))throw new Error(`invalid anchor "${Zt}"`);Qt.call(this,`#${Zt}`)}}}),Bt;function zt(Gt,qt,Wt){if(qt!==void 0&&!equal$3(Gt,qt))throw Ht(Wt)}function Ht(Gt){return new Error(`reference "${Gt}" resolves to more than one schema`)}}resolve$2.getSchemaRefs=getSchemaRefs;Object.defineProperty(validate$1,"__esModule",{value:!0});validate$1.getData=validate$1.KeywordCxt=validate$1.validateFunctionCode=void 0;const boolSchema_1=boolSchema,dataType_1$1=dataType,applicability_1=applicability,dataType_2=dataType,defaults_1=defaults$1,keyword_1=keyword,subschema_1=subschema,codegen_1$n=codegen$1,names_1$3=names$1,resolve_1$2=resolve$2,util_1$l=util,errors_1=errors;function validateFunctionCode(xt){if(isSchemaObj(xt)&&(checkKeywords(xt),schemaCxtHasRules(xt))){topSchemaObjCode(xt);return}validateFunction(xt,()=>(0,boolSchema_1.topBoolOrEmptySchema)(xt))}validate$1.validateFunctionCode=validateFunctionCode;function validateFunction({gen:xt,validateName:$t,schema:Ct,schemaEnv:kt,opts:Mt},Ft){Mt.code.es5?xt.func($t,(0,codegen_1$n._)`${names_1$3.default.data}, ${names_1$3.default.valCxt}`,kt.$async,()=>{xt.code((0,codegen_1$n._)`"use strict"; ${funcSourceUrl(Ct,Mt)}`),destructureValCxtES5(xt,Mt),xt.code(Ft)}):xt.func($t,(0,codegen_1$n._)`${names_1$3.default.data}, ${destructureValCxt(Mt)}`,kt.$async,()=>xt.code(funcSourceUrl(Ct,Mt)).code(Ft))}function destructureValCxt(xt){return(0,codegen_1$n._)`{${names_1$3.default.instancePath}="", ${names_1$3.default.parentData}, ${names_1$3.default.parentDataProperty}, ${names_1$3.default.rootData}=${names_1$3.default.data}${xt.dynamicRef?(0,codegen_1$n._)`, ${names_1$3.default.dynamicAnchors}={}`:codegen_1$n.nil}}={}`}function destructureValCxtES5(xt,$t){xt.if(names_1$3.default.valCxt,()=>{xt.var(names_1$3.default.instancePath,(0,codegen_1$n._)`${names_1$3.default.valCxt}.${names_1$3.default.instancePath}`),xt.var(names_1$3.default.parentData,(0,codegen_1$n._)`${names_1$3.default.valCxt}.${names_1$3.default.parentData}`),xt.var(names_1$3.default.parentDataProperty,(0,codegen_1$n._)`${names_1$3.default.valCxt}.${names_1$3.default.parentDataProperty}`),xt.var(names_1$3.default.rootData,(0,codegen_1$n._)`${names_1$3.default.valCxt}.${names_1$3.default.rootData}`),$t.dynamicRef&&xt.var(names_1$3.default.dynamicAnchors,(0,codegen_1$n._)`${names_1$3.default.valCxt}.${names_1$3.default.dynamicAnchors}`)},()=>{xt.var(names_1$3.default.instancePath,(0,codegen_1$n._)`""`),xt.var(names_1$3.default.parentData,(0,codegen_1$n._)`undefined`),xt.var(names_1$3.default.parentDataProperty,(0,codegen_1$n._)`undefined`),xt.var(names_1$3.default.rootData,names_1$3.default.data),$t.dynamicRef&&xt.var(names_1$3.default.dynamicAnchors,(0,codegen_1$n._)`{}`)})}function topSchemaObjCode(xt){const{schema:$t,opts:Ct,gen:kt}=xt;validateFunction(xt,()=>{Ct.$comment&&$t.$comment&&commentKeyword(xt),checkNoDefault(xt),kt.let(names_1$3.default.vErrors,null),kt.let(names_1$3.default.errors,0),Ct.unevaluated&&resetEvaluated(xt),typeAndKeywords(xt),returnResults(xt)})}function resetEvaluated(xt){const{gen:$t,validateName:Ct}=xt;xt.evaluated=$t.const("evaluated",(0,codegen_1$n._)`${Ct}.evaluated`),$t.if((0,codegen_1$n._)`${xt.evaluated}.dynamicProps`,()=>$t.assign((0,codegen_1$n._)`${xt.evaluated}.props`,(0,codegen_1$n._)`undefined`)),$t.if((0,codegen_1$n._)`${xt.evaluated}.dynamicItems`,()=>$t.assign((0,codegen_1$n._)`${xt.evaluated}.items`,(0,codegen_1$n._)`undefined`))}function funcSourceUrl(xt,$t){const Ct=typeof xt=="object"&&xt[$t.schemaId];return Ct&&($t.code.source||$t.code.process)?(0,codegen_1$n._)`/*# sourceURL=${Ct} */`:codegen_1$n.nil}function subschemaCode(xt,$t){if(isSchemaObj(xt)&&(checkKeywords(xt),schemaCxtHasRules(xt))){subSchemaObjCode(xt,$t);return}(0,boolSchema_1.boolOrEmptySchema)(xt,$t)}function schemaCxtHasRules({schema:xt,self:$t}){if(typeof xt=="boolean")return!xt;for(const Ct in xt)if($t.RULES.all[Ct])return!0;return!1}function isSchemaObj(xt){return typeof xt.schema!="boolean"}function subSchemaObjCode(xt,$t){const{schema:Ct,gen:kt,opts:Mt}=xt;Mt.$comment&&Ct.$comment&&commentKeyword(xt),updateContext(xt),checkAsyncSchema(xt);const Ft=kt.const("_errs",names_1$3.default.errors);typeAndKeywords(xt,Ft),kt.var($t,(0,codegen_1$n._)`${Ft} === ${names_1$3.default.errors}`)}function checkKeywords(xt){(0,util_1$l.checkUnknownRules)(xt),checkRefsAndKeywords(xt)}function typeAndKeywords(xt,$t){if(xt.opts.jtd)return schemaKeywords(xt,[],!1,$t);const Ct=(0,dataType_1$1.getSchemaTypes)(xt.schema),kt=(0,dataType_1$1.coerceAndCheckDataType)(xt,Ct);schemaKeywords(xt,Ct,!kt,$t)}function checkRefsAndKeywords(xt){const{schema:$t,errSchemaPath:Ct,opts:kt,self:Mt}=xt;$t.$ref&&kt.ignoreKeywordsWithRef&&(0,util_1$l.schemaHasRulesButRef)($t,Mt.RULES)&&Mt.logger.warn(`$ref: keywords ignored in schema at path "${Ct}"`)}function checkNoDefault(xt){const{schema:$t,opts:Ct}=xt;$t.default!==void 0&&Ct.useDefaults&&Ct.strictSchema&&(0,util_1$l.checkStrictMode)(xt,"default is ignored in the schema root")}function updateContext(xt){const $t=xt.schema[xt.opts.schemaId];$t&&(xt.baseId=(0,resolve_1$2.resolveUrl)(xt.opts.uriResolver,xt.baseId,$t))}function checkAsyncSchema(xt){if(xt.schema.$async&&!xt.schemaEnv.$async)throw new Error("async schema in sync schema")}function commentKeyword({gen:xt,schemaEnv:$t,schema:Ct,errSchemaPath:kt,opts:Mt}){const Ft=Ct.$comment;if(Mt.$comment===!0)xt.code((0,codegen_1$n._)`${names_1$3.default.self}.logger.log(${Ft})`);else if(typeof Mt.$comment=="function"){const jt=(0,codegen_1$n.str)`${kt}/$comment`,Bt=xt.scopeValue("root",{ref:$t.root});xt.code((0,codegen_1$n._)`${names_1$3.default.self}.opts.$comment(${Ft}, ${jt}, ${Bt}.schema)`)}}function returnResults(xt){const{gen:$t,schemaEnv:Ct,validateName:kt,ValidationError:Mt,opts:Ft}=xt;Ct.$async?$t.if((0,codegen_1$n._)`${names_1$3.default.errors} === 0`,()=>$t.return(names_1$3.default.data),()=>$t.throw((0,codegen_1$n._)`new ${Mt}(${names_1$3.default.vErrors})`)):($t.assign((0,codegen_1$n._)`${kt}.errors`,names_1$3.default.vErrors),Ft.unevaluated&&assignEvaluated(xt),$t.return((0,codegen_1$n._)`${names_1$3.default.errors} === 0`))}function assignEvaluated({gen:xt,evaluated:$t,props:Ct,items:kt}){Ct instanceof codegen_1$n.Name&&xt.assign((0,codegen_1$n._)`${$t}.props`,Ct),kt instanceof codegen_1$n.Name&&xt.assign((0,codegen_1$n._)`${$t}.items`,kt)}function schemaKeywords(xt,$t,Ct,kt){const{gen:Mt,schema:Ft,data:jt,allErrors:Bt,opts:Vt,self:zt}=xt,{RULES:Ht}=zt;if(Ft.$ref&&(Vt.ignoreKeywordsWithRef||!(0,util_1$l.schemaHasRulesButRef)(Ft,Ht))){Mt.block(()=>keywordCode(xt,"$ref",Ht.all.$ref.definition));return}Vt.jtd||checkStrictTypes(xt,$t),Mt.block(()=>{for(const qt of Ht.rules)Gt(qt);Gt(Ht.post)});function Gt(qt){(0,applicability_1.shouldUseGroup)(Ft,qt)&&(qt.type?(Mt.if((0,dataType_2.checkDataType)(qt.type,jt,Vt.strictNumbers)),iterateKeywords(xt,qt),$t.length===1&&$t[0]===qt.type&&Ct&&(Mt.else(),(0,dataType_2.reportTypeError)(xt)),Mt.endIf()):iterateKeywords(xt,qt),Bt||Mt.if((0,codegen_1$n._)`${names_1$3.default.errors} === ${kt||0}`))}}function iterateKeywords(xt,$t){const{gen:Ct,schema:kt,opts:{useDefaults:Mt}}=xt;Mt&&(0,defaults_1.assignDefaults)(xt,$t.type),Ct.block(()=>{for(const Ft of $t.rules)(0,applicability_1.shouldUseRule)(kt,Ft)&&keywordCode(xt,Ft.keyword,Ft.definition,$t.type)})}function checkStrictTypes(xt,$t){xt.schemaEnv.meta||!xt.opts.strictTypes||(checkContextTypes(xt,$t),xt.opts.allowUnionTypes||checkMultipleTypes(xt,$t),checkKeywordTypes(xt,xt.dataTypes))}function checkContextTypes(xt,$t){if($t.length){if(!xt.dataTypes.length){xt.dataTypes=$t;return}$t.forEach(Ct=>{includesType(xt.dataTypes,Ct)||strictTypesError(xt,`type "${Ct}" not allowed by context "${xt.dataTypes.join(",")}"`)}),narrowSchemaTypes(xt,$t)}}function checkMultipleTypes(xt,$t){$t.length>1&&!($t.length===2&&$t.includes("null"))&&strictTypesError(xt,"use allowUnionTypes to allow union type keyword")}function checkKeywordTypes(xt,$t){const Ct=xt.self.RULES.all;for(const kt in Ct){const Mt=Ct[kt];if(typeof Mt=="object"&&(0,applicability_1.shouldUseRule)(xt.schema,Mt)){const{type:Ft}=Mt.definition;Ft.length&&!Ft.some(jt=>hasApplicableType($t,jt))&&strictTypesError(xt,`missing type "${Ft.join(",")}" for keyword "${kt}"`)}}}function hasApplicableType(xt,$t){return xt.includes($t)||$t==="number"&&xt.includes("integer")}function includesType(xt,$t){return xt.includes($t)||$t==="integer"&&xt.includes("number")}function narrowSchemaTypes(xt,$t){const Ct=[];for(const kt of xt.dataTypes)includesType($t,kt)?Ct.push(kt):$t.includes("integer")&&kt==="number"&&Ct.push("integer");xt.dataTypes=Ct}function strictTypesError(xt,$t){const Ct=xt.schemaEnv.baseId+xt.errSchemaPath;$t+=` at "${Ct}" (strictTypes)`,(0,util_1$l.checkStrictMode)(xt,$t,xt.opts.strictTypes)}class KeywordCxt{constructor($t,Ct,kt){if((0,keyword_1.validateKeywordUsage)($t,Ct,kt),this.gen=$t.gen,this.allErrors=$t.allErrors,this.keyword=kt,this.data=$t.data,this.schema=$t.schema[kt],this.$data=Ct.$data&&$t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,util_1$l.schemaRefOrVal)($t,this.schema,kt,this.$data),this.schemaType=Ct.schemaType,this.parentSchema=$t.schema,this.params={},this.it=$t,this.def=Ct,this.$data)this.schemaCode=$t.gen.const("vSchema",getData(this.$data,$t));else if(this.schemaCode=this.schemaValue,!(0,keyword_1.validSchemaType)(this.schema,Ct.schemaType,Ct.allowUndefined))throw new Error(`${kt} value must be ${JSON.stringify(Ct.schemaType)}`);("code"in Ct?Ct.trackErrors:Ct.errors!==!1)&&(this.errsCount=$t.gen.const("_errs",names_1$3.default.errors))}result($t,Ct,kt){this.failResult((0,codegen_1$n.not)($t),Ct,kt)}failResult($t,Ct,kt){this.gen.if($t),kt?kt():this.error(),Ct?(this.gen.else(),Ct(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass($t,Ct){this.failResult((0,codegen_1$n.not)($t),void 0,Ct)}fail($t){if($t===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if($t),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data($t){if(!this.$data)return this.fail($t);const{schemaCode:Ct}=this;this.fail((0,codegen_1$n._)`${Ct} !== undefined && (${(0,codegen_1$n.or)(this.invalid$data(),$t)})`)}error($t,Ct,kt){if(Ct){this.setParams(Ct),this._error($t,kt),this.setParams({});return}this._error($t,kt)}_error($t,Ct){($t?errors_1.reportExtraError:errors_1.reportError)(this,this.def.error,Ct)}$dataError(){(0,errors_1.reportError)(this,this.def.$dataError||errors_1.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,errors_1.resetErrorsCount)(this.gen,this.errsCount)}ok($t){this.allErrors||this.gen.if($t)}setParams($t,Ct){Ct?Object.assign(this.params,$t):this.params=$t}block$data($t,Ct,kt=codegen_1$n.nil){this.gen.block(()=>{this.check$data($t,kt),Ct()})}check$data($t=codegen_1$n.nil,Ct=codegen_1$n.nil){if(!this.$data)return;const{gen:kt,schemaCode:Mt,schemaType:Ft,def:jt}=this;kt.if((0,codegen_1$n.or)((0,codegen_1$n._)`${Mt} === undefined`,Ct)),$t!==codegen_1$n.nil&&kt.assign($t,!0),(Ft.length||jt.validateSchema)&&(kt.elseIf(this.invalid$data()),this.$dataError(),$t!==codegen_1$n.nil&&kt.assign($t,!1)),kt.else()}invalid$data(){const{gen:$t,schemaCode:Ct,schemaType:kt,def:Mt,it:Ft}=this;return(0,codegen_1$n.or)(jt(),Bt());function jt(){if(kt.length){if(!(Ct instanceof codegen_1$n.Name))throw new Error("ajv implementation error");const Vt=Array.isArray(kt)?kt:[kt];return(0,codegen_1$n._)`${(0,dataType_2.checkDataTypes)(Vt,Ct,Ft.opts.strictNumbers,dataType_2.DataType.Wrong)}`}return codegen_1$n.nil}function Bt(){if(Mt.validateSchema){const Vt=$t.scopeValue("validate$data",{ref:Mt.validateSchema});return(0,codegen_1$n._)`!${Vt}(${Ct})`}return codegen_1$n.nil}}subschema($t,Ct){const kt=(0,subschema_1.getSubschema)(this.it,$t);(0,subschema_1.extendSubschemaData)(kt,this.it,$t),(0,subschema_1.extendSubschemaMode)(kt,$t);const Mt={...this.it,...kt,items:void 0,props:void 0};return subschemaCode(Mt,Ct),Mt}mergeEvaluated($t,Ct){const{it:kt,gen:Mt}=this;kt.opts.unevaluated&&(kt.props!==!0&&$t.props!==void 0&&(kt.props=util_1$l.mergeEvaluated.props(Mt,$t.props,kt.props,Ct)),kt.items!==!0&&$t.items!==void 0&&(kt.items=util_1$l.mergeEvaluated.items(Mt,$t.items,kt.items,Ct)))}mergeValidEvaluated($t,Ct){const{it:kt,gen:Mt}=this;if(kt.opts.unevaluated&&(kt.props!==!0||kt.items!==!0))return Mt.if(Ct,()=>this.mergeEvaluated($t,codegen_1$n.Name)),!0}}validate$1.KeywordCxt=KeywordCxt;function keywordCode(xt,$t,Ct,kt){const Mt=new KeywordCxt(xt,Ct,$t);"code"in Ct?Ct.code(Mt,kt):Mt.$data&&Ct.validate?(0,keyword_1.funcKeywordCode)(Mt,Ct):"macro"in Ct?(0,keyword_1.macroKeywordCode)(Mt,Ct):(Ct.compile||Ct.validate)&&(0,keyword_1.funcKeywordCode)(Mt,Ct)}const JSON_POINTER=/^\/(?:[^~]|~0|~1)*$/,RELATIVE_JSON_POINTER=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function getData(xt,{dataLevel:$t,dataNames:Ct,dataPathArr:kt}){let Mt,Ft;if(xt==="")return names_1$3.default.rootData;if(xt[0]==="/"){if(!JSON_POINTER.test(xt))throw new Error(`Invalid JSON-pointer: ${xt}`);Mt=xt,Ft=names_1$3.default.rootData}else{const zt=RELATIVE_JSON_POINTER.exec(xt);if(!zt)throw new Error(`Invalid JSON-pointer: ${xt}`);const Ht=+zt[1];if(Mt=zt[2],Mt==="#"){if(Ht>=$t)throw new Error(Vt("property/index",Ht));return kt[$t-Ht]}if(Ht>$t)throw new Error(Vt("data",Ht));if(Ft=Ct[$t-Ht],!Mt)return Ft}let jt=Ft;const Bt=Mt.split("/");for(const zt of Bt)zt&&(Ft=(0,codegen_1$n._)`${Ft}${(0,codegen_1$n.getProperty)((0,util_1$l.unescapeJsonPointer)(zt))}`,jt=(0,codegen_1$n._)`${jt} && ${Ft}`);return jt;function Vt(zt,Ht){return`Cannot access ${zt} ${Ht} levels up, current level is ${$t}`}}validate$1.getData=getData;var validation_error={};Object.defineProperty(validation_error,"__esModule",{value:!0});class ValidationError extends Error{constructor($t){super("validation failed"),this.errors=$t,this.ajv=this.validation=!0}}validation_error.default=ValidationError;var ref_error={};Object.defineProperty(ref_error,"__esModule",{value:!0});const resolve_1$1=resolve$2;class MissingRefError extends Error{constructor($t,Ct,kt,Mt){super(Mt||`can't resolve reference ${kt} from id ${Ct}`),this.missingRef=(0,resolve_1$1.resolveUrl)($t,Ct,kt),this.missingSchema=(0,resolve_1$1.normalizeId)((0,resolve_1$1.getFullPath)($t,this.missingRef))}}ref_error.default=MissingRefError;var compile$1={};Object.defineProperty(compile$1,"__esModule",{value:!0});compile$1.resolveSchema=compile$1.getCompilingSchema=compile$1.resolveRef=compile$1.compileSchema=compile$1.SchemaEnv=void 0;const codegen_1$m=codegen$1,validation_error_1=validation_error,names_1$2=names$1,resolve_1=resolve$2,util_1$k=util,validate_1$1=validate$1;class SchemaEnv{constructor($t){var Ct;this.refs={},this.dynamicAnchors={};let kt;typeof $t.schema=="object"&&(kt=$t.schema),this.schema=$t.schema,this.schemaId=$t.schemaId,this.root=$t.root||this,this.baseId=(Ct=$t.baseId)!==null&&Ct!==void 0?Ct:(0,resolve_1.normalizeId)(kt==null?void 0:kt[$t.schemaId||"$id"]),this.schemaPath=$t.schemaPath,this.localRefs=$t.localRefs,this.meta=$t.meta,this.$async=kt==null?void 0:kt.$async,this.refs={}}}compile$1.SchemaEnv=SchemaEnv;function compileSchema(xt){const $t=getCompilingSchema.call(this,xt);if($t)return $t;const Ct=(0,resolve_1.getFullPath)(this.opts.uriResolver,xt.root.baseId),{es5:kt,lines:Mt}=this.opts.code,{ownProperties:Ft}=this.opts,jt=new codegen_1$m.CodeGen(this.scope,{es5:kt,lines:Mt,ownProperties:Ft});let Bt;xt.$async&&(Bt=jt.scopeValue("Error",{ref:validation_error_1.default,code:(0,codegen_1$m._)`require("ajv/dist/runtime/validation_error").default`}));const Vt=jt.scopeName("validate");xt.validateName=Vt;const zt={gen:jt,allErrors:this.opts.allErrors,data:names_1$2.default.data,parentData:names_1$2.default.parentData,parentDataProperty:names_1$2.default.parentDataProperty,dataNames:[names_1$2.default.data],dataPathArr:[codegen_1$m.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:jt.scopeValue("schema",this.opts.code.source===!0?{ref:xt.schema,code:(0,codegen_1$m.stringify)(xt.schema)}:{ref:xt.schema}),validateName:Vt,ValidationError:Bt,schema:xt.schema,schemaEnv:xt,rootId:Ct,baseId:xt.baseId||Ct,schemaPath:codegen_1$m.nil,errSchemaPath:xt.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,codegen_1$m._)`""`,opts:this.opts,self:this};let Ht;try{this._compilations.add(xt),(0,validate_1$1.validateFunctionCode)(zt),jt.optimize(this.opts.code.optimize);const Gt=jt.toString();Ht=`${jt.scopeRefs(names_1$2.default.scope)}return ${Gt}`,this.opts.code.process&&(Ht=this.opts.code.process(Ht,xt));const Wt=new Function(`${names_1$2.default.self}`,`${names_1$2.default.scope}`,Ht)(this,this.scope.get());if(this.scope.value(Vt,{ref:Wt}),Wt.errors=null,Wt.schema=xt.schema,Wt.schemaEnv=xt,xt.$async&&(Wt.$async=!0),this.opts.code.source===!0&&(Wt.source={validateName:Vt,validateCode:Gt,scopeValues:jt._values}),this.opts.unevaluated){const{props:Yt,items:Kt}=zt;Wt.evaluated={props:Yt instanceof codegen_1$m.Name?void 0:Yt,items:Kt instanceof codegen_1$m.Name?void 0:Kt,dynamicProps:Yt instanceof codegen_1$m.Name,dynamicItems:Kt instanceof codegen_1$m.Name},Wt.source&&(Wt.source.evaluated=(0,codegen_1$m.stringify)(Wt.evaluated))}return xt.validate=Wt,xt}catch(Gt){throw delete xt.validate,delete xt.validateName,Ht&&this.logger.error("Error compiling schema, function code:",Ht),Gt}finally{this._compilations.delete(xt)}}compile$1.compileSchema=compileSchema;function resolveRef(xt,$t,Ct){var kt;Ct=(0,resolve_1.resolveUrl)(this.opts.uriResolver,$t,Ct);const Mt=xt.refs[Ct];if(Mt)return Mt;let Ft=resolve$1.call(this,xt,Ct);if(Ft===void 0){const jt=(kt=xt.localRefs)===null||kt===void 0?void 0:kt[Ct],{schemaId:Bt}=this.opts;jt&&(Ft=new SchemaEnv({schema:jt,schemaId:Bt,root:xt,baseId:$t}))}if(Ft!==void 0)return xt.refs[Ct]=inlineOrCompile.call(this,Ft)}compile$1.resolveRef=resolveRef;function inlineOrCompile(xt){return(0,resolve_1.inlineRef)(xt.schema,this.opts.inlineRefs)?xt.schema:xt.validate?xt:compileSchema.call(this,xt)}function getCompilingSchema(xt){for(const $t of this._compilations)if(sameSchemaEnv($t,xt))return $t}compile$1.getCompilingSchema=getCompilingSchema;function sameSchemaEnv(xt,$t){return xt.schema===$t.schema&&xt.root===$t.root&&xt.baseId===$t.baseId}function resolve$1(xt,$t){let Ct;for(;typeof(Ct=this.refs[$t])=="string";)$t=Ct;return Ct||this.schemas[$t]||resolveSchema.call(this,xt,$t)}function resolveSchema(xt,$t){const Ct=this.opts.uriResolver.parse($t),kt=(0,resolve_1._getFullPath)(this.opts.uriResolver,Ct);let Mt=(0,resolve_1.getFullPath)(this.opts.uriResolver,xt.baseId,void 0);if(Object.keys(xt.schema).length>0&&kt===Mt)return getJsonPointer.call(this,Ct,xt);const Ft=(0,resolve_1.normalizeId)(kt),jt=this.refs[Ft]||this.schemas[Ft];if(typeof jt=="string"){const Bt=resolveSchema.call(this,xt,jt);return typeof(Bt==null?void 0:Bt.schema)!="object"?void 0:getJsonPointer.call(this,Ct,Bt)}if(typeof(jt==null?void 0:jt.schema)=="object"){if(jt.validate||compileSchema.call(this,jt),Ft===(0,resolve_1.normalizeId)($t)){const{schema:Bt}=jt,{schemaId:Vt}=this.opts,zt=Bt[Vt];return zt&&(Mt=(0,resolve_1.resolveUrl)(this.opts.uriResolver,Mt,zt)),new SchemaEnv({schema:Bt,schemaId:Vt,root:xt,baseId:Mt})}return getJsonPointer.call(this,Ct,jt)}}compile$1.resolveSchema=resolveSchema;const PREVENT_SCOPE_CHANGE=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function getJsonPointer(xt,{baseId:$t,schema:Ct,root:kt}){var Mt;if(((Mt=xt.fragment)===null||Mt===void 0?void 0:Mt[0])!=="/")return;for(const Bt of xt.fragment.slice(1).split("/")){if(typeof Ct=="boolean")return;const Vt=Ct[(0,util_1$k.unescapeFragment)(Bt)];if(Vt===void 0)return;Ct=Vt;const zt=typeof Ct=="object"&&Ct[this.opts.schemaId];!PREVENT_SCOPE_CHANGE.has(Bt)&&zt&&($t=(0,resolve_1.resolveUrl)(this.opts.uriResolver,$t,zt))}let Ft;if(typeof Ct!="boolean"&&Ct.$ref&&!(0,util_1$k.schemaHasRulesButRef)(Ct,this.RULES)){const Bt=(0,resolve_1.resolveUrl)(this.opts.uriResolver,$t,Ct.$ref);Ft=resolveSchema.call(this,kt,Bt)}const{schemaId:jt}=this.opts;if(Ft=Ft||new SchemaEnv({schema:Ct,schemaId:jt,root:kt,baseId:$t}),Ft.schema!==Ft.root.schema)return Ft}const $id$1="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description$3="Meta-schema for $data reference (JSON AnySchema extension proposal)",type$3="object",required$1=["$data"],properties$2={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties$1=!1,require$$9={$id:$id$1,description:description$3,type:type$3,required:required$1,properties:properties$2,additionalProperties:additionalProperties$1};var uri$1={},uri_all={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(xt,$t){(function(Ct,kt){kt($t)})(commonjsGlobal$2,function(Ct){function kt(){for(var vr=arguments.length,lr=Array(vr),$r=0;$r<vr;$r++)lr[$r]=arguments[$r];if(lr.length>1){lr[0]=lr[0].slice(0,-1);for(var Gr=lr.length-1,zr=1;zr<Gr;++zr)lr[zr]=lr[zr].slice(1,-1);return lr[Gr]=lr[Gr].slice(1),lr.join("")}else return lr[0]}function Mt(vr){return"(?:"+vr+")"}function Ft(vr){return vr===void 0?"undefined":vr===null?"null":Object.prototype.toString.call(vr).split(" ").pop().split("]").shift().toLowerCase()}function jt(vr){return vr.toUpperCase()}function Bt(vr){return vr!=null?vr instanceof Array?vr:typeof vr.length!="number"||vr.split||vr.setInterval||vr.call?[vr]:Array.prototype.slice.call(vr):[]}function Vt(vr,lr){var $r=vr;if(lr)for(var Gr in lr)$r[Gr]=lr[Gr];return $r}function zt(vr){var lr="[A-Za-z]",$r="[0-9]",Gr=kt($r,"[A-Fa-f]"),zr=Mt(Mt("%[EFef]"+Gr+"%"+Gr+Gr+"%"+Gr+Gr)+"|"+Mt("%[89A-Fa-f]"+Gr+"%"+Gr+Gr)+"|"+Mt("%"+Gr+Gr)),fs="[\\:\\/\\?\\#\\[\\]\\@]",Ts="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Bs=kt(fs,Ts),Xs=vr?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",ro=vr?"[\\uE000-\\uF8FF]":"[]",Ys=kt(lr,$r,"[\\-\\.\\_\\~]",Xs);Mt(lr+kt(lr,$r,"[\\+\\-\\.]")+"*"),Mt(Mt(zr+"|"+kt(Ys,Ts,"[\\:]"))+"*");var co=Mt(Mt("25[0-5]")+"|"+Mt("2[0-4]"+$r)+"|"+Mt("1"+$r+$r)+"|"+Mt("0?[1-9]"+$r)+"|0?0?"+$r),To=Mt(co+"\\."+co+"\\."+co+"\\."+co),Vs=Mt(Gr+"{1,4}"),fo=Mt(Mt(Vs+"\\:"+Vs)+"|"+To),$o=Mt(Mt(Vs+"\\:")+"{6}"+fo),lo=Mt("\\:\\:"+Mt(Vs+"\\:")+"{5}"+fo),ko=Mt(Mt(Vs)+"?\\:\\:"+Mt(Vs+"\\:")+"{4}"+fo),jo=Mt(Mt(Mt(Vs+"\\:")+"{0,1}"+Vs)+"?\\:\\:"+Mt(Vs+"\\:")+"{3}"+fo),Co=Mt(Mt(Mt(Vs+"\\:")+"{0,2}"+Vs)+"?\\:\\:"+Mt(Vs+"\\:")+"{2}"+fo),Go=Mt(Mt(Mt(Vs+"\\:")+"{0,3}"+Vs)+"?\\:\\:"+Vs+"\\:"+fo),Lo=Mt(Mt(Mt(Vs+"\\:")+"{0,4}"+Vs)+"?\\:\\:"+fo),Fo=Mt(Mt(Mt(Vs+"\\:")+"{0,5}"+Vs)+"?\\:\\:"+Vs),Wo=Mt(Mt(Mt(Vs+"\\:")+"{0,6}"+Vs)+"?\\:\\:"),Ko=Mt([$o,lo,ko,jo,Co,Go,Lo,Fo,Wo].join("|")),Bo=Mt(Mt(Ys+"|"+zr)+"+");Mt("[vV]"+Gr+"+\\."+kt(Ys,Ts,"[\\:]")+"+"),Mt(Mt(zr+"|"+kt(Ys,Ts))+"*");var Jo=Mt(zr+"|"+kt(Ys,Ts,"[\\:\\@]"));return Mt(Mt(zr+"|"+kt(Ys,Ts,"[\\@]"))+"+"),Mt(Mt(Jo+"|"+kt("[\\/\\?]",ro))+"*"),{NOT_SCHEME:new RegExp(kt("[^]",lr,$r,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(kt("[^\\%\\:]",Ys,Ts),"g"),NOT_HOST:new RegExp(kt("[^\\%\\[\\]\\:]",Ys,Ts),"g"),NOT_PATH:new RegExp(kt("[^\\%\\/\\:\\@]",Ys,Ts),"g"),NOT_PATH_NOSCHEME:new RegExp(kt("[^\\%\\/\\@]",Ys,Ts),"g"),NOT_QUERY:new RegExp(kt("[^\\%]",Ys,Ts,"[\\:\\@\\/\\?]",ro),"g"),NOT_FRAGMENT:new RegExp(kt("[^\\%]",Ys,Ts,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(kt("[^]",Ys,Ts),"g"),UNRESERVED:new RegExp(Ys,"g"),OTHER_CHARS:new RegExp(kt("[^\\%]",Ys,Bs),"g"),PCT_ENCODED:new RegExp(zr,"g"),IPV4ADDRESS:new RegExp("^("+To+")$"),IPV6ADDRESS:new RegExp("^\\[?("+Ko+")"+Mt(Mt("\\%25|\\%(?!"+Gr+"{2})")+"("+Bo+")")+"?\\]?$")}}var Ht=zt(!1),Gt=zt(!0),qt=function(){function vr(lr,$r){var Gr=[],zr=!0,fs=!1,Ts=void 0;try{for(var Bs=lr[Symbol.iterator](),Xs;!(zr=(Xs=Bs.next()).done)&&(Gr.push(Xs.value),!($r&&Gr.length===$r));zr=!0);}catch(ro){fs=!0,Ts=ro}finally{try{!zr&&Bs.return&&Bs.return()}finally{if(fs)throw Ts}}return Gr}return function(lr,$r){if(Array.isArray(lr))return lr;if(Symbol.iterator in Object(lr))return vr(lr,$r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Wt=function(vr){if(Array.isArray(vr)){for(var lr=0,$r=Array(vr.length);lr<vr.length;lr++)$r[lr]=vr[lr];return $r}else return Array.from(vr)},Yt=2147483647,Kt=36,Xt=1,Qt=26,Jt=38,Zt=700,sn=72,ln=128,dn="-",hn=/^xn--/,cn=/[^\0-\x7E]/,pn=/[\x2E\u3002\uFF0E\uFF61]/g,yn={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},gn=Kt-Xt,En=Math.floor,bn=String.fromCharCode;function xn(vr){throw new RangeError(yn[vr])}function Cn(vr,lr){for(var $r=[],Gr=vr.length;Gr--;)$r[Gr]=lr(vr[Gr]);return $r}function $n(vr,lr){var $r=vr.split("@"),Gr="";$r.length>1&&(Gr=$r[0]+"@",vr=$r[1]),vr=vr.replace(pn,".");var zr=vr.split("."),fs=Cn(zr,lr).join(".");return Gr+fs}function wn(vr){for(var lr=[],$r=0,Gr=vr.length;$r<Gr;){var zr=vr.charCodeAt($r++);if(zr>=55296&&zr<=56319&&$r<Gr){var fs=vr.charCodeAt($r++);(fs&64512)==56320?lr.push(((zr&1023)<<10)+(fs&1023)+65536):(lr.push(zr),$r--)}else lr.push(zr)}return lr}var Rn=function(lr){return String.fromCodePoint.apply(String,Wt(lr))},Dn=function(lr){return lr-48<10?lr-22:lr-65<26?lr-65:lr-97<26?lr-97:Kt},An=function(lr,$r){return lr+22+75*(lr<26)-(($r!=0)<<5)},Sn=function(lr,$r,Gr){var zr=0;for(lr=Gr?En(lr/Zt):lr>>1,lr+=En(lr/$r);lr>gn*Qt>>1;zr+=Kt)lr=En(lr/gn);return En(zr+(gn+1)*lr/(lr+Jt))},vn=function(lr){var $r=[],Gr=lr.length,zr=0,fs=ln,Ts=sn,Bs=lr.lastIndexOf(dn);Bs<0&&(Bs=0);for(var Xs=0;Xs<Bs;++Xs)lr.charCodeAt(Xs)>=128&&xn("not-basic"),$r.push(lr.charCodeAt(Xs));for(var ro=Bs>0?Bs+1:0;ro<Gr;){for(var Ys=zr,co=1,To=Kt;;To+=Kt){ro>=Gr&&xn("invalid-input");var Vs=Dn(lr.charCodeAt(ro++));(Vs>=Kt||Vs>En((Yt-zr)/co))&&xn("overflow"),zr+=Vs*co;var fo=To<=Ts?Xt:To>=Ts+Qt?Qt:To-Ts;if(Vs<fo)break;var $o=Kt-fo;co>En(Yt/$o)&&xn("overflow"),co*=$o}var lo=$r.length+1;Ts=Sn(zr-Ys,lo,Ys==0),En(zr/lo)>Yt-fs&&xn("overflow"),fs+=En(zr/lo),zr%=lo,$r.splice(zr++,0,fs)}return String.fromCodePoint.apply(String,$r)},_n=function(lr){var $r=[];lr=wn(lr);var Gr=lr.length,zr=ln,fs=0,Ts=sn,Bs=!0,Xs=!1,ro=void 0;try{for(var Ys=lr[Symbol.iterator](),co;!(Bs=(co=Ys.next()).done);Bs=!0){var To=co.value;To<128&&$r.push(bn(To))}}catch(Jr){Xs=!0,ro=Jr}finally{try{!Bs&&Ys.return&&Ys.return()}finally{if(Xs)throw ro}}var Vs=$r.length,fo=Vs;for(Vs&&$r.push(dn);fo<Gr;){var $o=Yt,lo=!0,ko=!1,jo=void 0;try{for(var Co=lr[Symbol.iterator](),Go;!(lo=(Go=Co.next()).done);lo=!0){var Lo=Go.value;Lo>=zr&&Lo<$o&&($o=Lo)}}catch(Jr){ko=!0,jo=Jr}finally{try{!lo&&Co.return&&Co.return()}finally{if(ko)throw jo}}var Fo=fo+1;$o-zr>En((Yt-fs)/Fo)&&xn("overflow"),fs+=($o-zr)*Fo,zr=$o;var Wo=!0,Ko=!1,Bo=void 0;try{for(var Jo=lr[Symbol.iterator](),ga;!(Wo=(ga=Jo.next()).done);Wo=!0){var Jn=ga.value;if(Jn<zr&&++fs>Yt&&xn("overflow"),Jn==zr){for(var xr=fs,dr=Kt;;dr+=Kt){var kr=dr<=Ts?Xt:dr>=Ts+Qt?Qt:dr-Ts;if(xr<kr)break;var Lr=xr-kr,Pr=Kt-kr;$r.push(bn(An(kr+Lr%Pr,0))),xr=En(Lr/Pr)}$r.push(bn(An(xr,0))),Ts=Sn(fs,Fo,fo==Vs),fs=0,++fo}}}catch(Jr){Ko=!0,Bo=Jr}finally{try{!Wo&&Jo.return&&Jo.return()}finally{if(Ko)throw Bo}}++fs,++zr}return $r.join("")},Tn=function(lr){return $n(lr,function($r){return hn.test($r)?vn($r.slice(4).toLowerCase()):$r})},Pn=function(lr){return $n(lr,function($r){return cn.test($r)?"xn--"+_n($r):$r})},Ln={version:"2.1.0",ucs2:{decode:wn,encode:Rn},decode:vn,encode:_n,toASCII:Pn,toUnicode:Tn},Vn={};function Un(vr){var lr=vr.charCodeAt(0),$r=void 0;return lr<16?$r="%0"+lr.toString(16).toUpperCase():lr<128?$r="%"+lr.toString(16).toUpperCase():lr<2048?$r="%"+(lr>>6|192).toString(16).toUpperCase()+"%"+(lr&63|128).toString(16).toUpperCase():$r="%"+(lr>>12|224).toString(16).toUpperCase()+"%"+(lr>>6&63|128).toString(16).toUpperCase()+"%"+(lr&63|128).toString(16).toUpperCase(),$r}function Wn(vr){for(var lr="",$r=0,Gr=vr.length;$r<Gr;){var zr=parseInt(vr.substr($r+1,2),16);if(zr<128)lr+=String.fromCharCode(zr),$r+=3;else if(zr>=194&&zr<224){if(Gr-$r>=6){var fs=parseInt(vr.substr($r+4,2),16);lr+=String.fromCharCode((zr&31)<<6|fs&63)}else lr+=vr.substr($r,6);$r+=6}else if(zr>=224){if(Gr-$r>=9){var Ts=parseInt(vr.substr($r+4,2),16),Bs=parseInt(vr.substr($r+7,2),16);lr+=String.fromCharCode((zr&15)<<12|(Ts&63)<<6|Bs&63)}else lr+=vr.substr($r,9);$r+=9}else lr+=vr.substr($r,3),$r+=3}return lr}function rr(vr,lr){function $r(Gr){var zr=Wn(Gr);return zr.match(lr.UNRESERVED)?zr:Gr}return vr.scheme&&(vr.scheme=String(vr.scheme).replace(lr.PCT_ENCODED,$r).toLowerCase().replace(lr.NOT_SCHEME,"")),vr.userinfo!==void 0&&(vr.userinfo=String(vr.userinfo).replace(lr.PCT_ENCODED,$r).replace(lr.NOT_USERINFO,Un).replace(lr.PCT_ENCODED,jt)),vr.host!==void 0&&(vr.host=String(vr.host).replace(lr.PCT_ENCODED,$r).toLowerCase().replace(lr.NOT_HOST,Un).replace(lr.PCT_ENCODED,jt)),vr.path!==void 0&&(vr.path=String(vr.path).replace(lr.PCT_ENCODED,$r).replace(vr.scheme?lr.NOT_PATH:lr.NOT_PATH_NOSCHEME,Un).replace(lr.PCT_ENCODED,jt)),vr.query!==void 0&&(vr.query=String(vr.query).replace(lr.PCT_ENCODED,$r).replace(lr.NOT_QUERY,Un).replace(lr.PCT_ENCODED,jt)),vr.fragment!==void 0&&(vr.fragment=String(vr.fragment).replace(lr.PCT_ENCODED,$r).replace(lr.NOT_FRAGMENT,Un).replace(lr.PCT_ENCODED,jt)),vr}function ar(vr){return vr.replace(/^0*(.*)/,"$1")||"0"}function nr(vr,lr){var $r=vr.match(lr.IPV4ADDRESS)||[],Gr=qt($r,2),zr=Gr[1];return zr?zr.split(".").map(ar).join("."):vr}function mr(vr,lr){var $r=vr.match(lr.IPV6ADDRESS)||[],Gr=qt($r,3),zr=Gr[1],fs=Gr[2];if(zr){for(var Ts=zr.toLowerCase().split("::").reverse(),Bs=qt(Ts,2),Xs=Bs[0],ro=Bs[1],Ys=ro?ro.split(":").map(ar):[],co=Xs.split(":").map(ar),To=lr.IPV4ADDRESS.test(co[co.length-1]),Vs=To?7:8,fo=co.length-Vs,$o=Array(Vs),lo=0;lo<Vs;++lo)$o[lo]=Ys[lo]||co[fo+lo]||"";To&&($o[Vs-1]=nr($o[Vs-1],lr));var ko=$o.reduce(function(Fo,Wo,Ko){if(!Wo||Wo==="0"){var Bo=Fo[Fo.length-1];Bo&&Bo.index+Bo.length===Ko?Bo.length++:Fo.push({index:Ko,length:1})}return Fo},[]),jo=ko.sort(function(Fo,Wo){return Wo.length-Fo.length})[0],Co=void 0;if(jo&&jo.length>1){var Go=$o.slice(0,jo.index),Lo=$o.slice(jo.index+jo.length);Co=Go.join(":")+"::"+Lo.join(":")}else Co=$o.join(":");return fs&&(Co+="%"+fs),Co}else return vr}var kn=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Fn="".match(/(){0}/)[1]===void 0;function Hn(vr){var lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},$r={},Gr=lr.iri!==!1?Gt:Ht;lr.reference==="suffix"&&(vr=(lr.scheme?lr.scheme+":":"")+"//"+vr);var zr=vr.match(kn);if(zr){Fn?($r.scheme=zr[1],$r.userinfo=zr[3],$r.host=zr[4],$r.port=parseInt(zr[5],10),$r.path=zr[6]||"",$r.query=zr[7],$r.fragment=zr[8],isNaN($r.port)&&($r.port=zr[5])):($r.scheme=zr[1]||void 0,$r.userinfo=vr.indexOf("@")!==-1?zr[3]:void 0,$r.host=vr.indexOf("//")!==-1?zr[4]:void 0,$r.port=parseInt(zr[5],10),$r.path=zr[6]||"",$r.query=vr.indexOf("?")!==-1?zr[7]:void 0,$r.fragment=vr.indexOf("#")!==-1?zr[8]:void 0,isNaN($r.port)&&($r.port=vr.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?zr[4]:void 0)),$r.host&&($r.host=mr(nr($r.host,Gr),Gr)),$r.scheme===void 0&&$r.userinfo===void 0&&$r.host===void 0&&$r.port===void 0&&!$r.path&&$r.query===void 0?$r.reference="same-document":$r.scheme===void 0?$r.reference="relative":$r.fragment===void 0?$r.reference="absolute":$r.reference="uri",lr.reference&&lr.reference!=="suffix"&&lr.reference!==$r.reference&&($r.error=$r.error||"URI is not a "+lr.reference+" reference.");var fs=Vn[(lr.scheme||$r.scheme||"").toLowerCase()];if(!lr.unicodeSupport&&(!fs||!fs.unicodeSupport)){if($r.host&&(lr.domainHost||fs&&fs.domainHost))try{$r.host=Ln.toASCII($r.host.replace(Gr.PCT_ENCODED,Wn).toLowerCase())}catch(Ts){$r.error=$r.error||"Host's domain name can not be converted to ASCII via punycode: "+Ts}rr($r,Ht)}else rr($r,Gr);fs&&fs.parse&&fs.parse($r,lr)}else $r.error=$r.error||"URI can not be parsed.";return $r}function Bn(vr,lr){var $r=lr.iri!==!1?Gt:Ht,Gr=[];return vr.userinfo!==void 0&&(Gr.push(vr.userinfo),Gr.push("@")),vr.host!==void 0&&Gr.push(mr(nr(String(vr.host),$r),$r).replace($r.IPV6ADDRESS,function(zr,fs,Ts){return"["+fs+(Ts?"%25"+Ts:"")+"]"})),(typeof vr.port=="number"||typeof vr.port=="string")&&(Gr.push(":"),Gr.push(String(vr.port))),Gr.length?Gr.join(""):void 0}var jn=/^\.\.?\//,sr=/^\/\.(\/|$)/,Ar=/^\/\.\.(\/|$)/,Fr=/^\/?(?:.|\n)*?(?=\/|$)/;function Rr(vr){for(var lr=[];vr.length;)if(vr.match(jn))vr=vr.replace(jn,"");else if(vr.match(sr))vr=vr.replace(sr,"/");else if(vr.match(Ar))vr=vr.replace(Ar,"/"),lr.pop();else if(vr==="."||vr==="..")vr="";else{var $r=vr.match(Fr);if($r){var Gr=$r[0];vr=vr.slice(Gr.length),lr.push(Gr)}else throw new Error("Unexpected dot segment condition")}return lr.join("")}function Qn(vr){var lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},$r=lr.iri?Gt:Ht,Gr=[],zr=Vn[(lr.scheme||vr.scheme||"").toLowerCase()];if(zr&&zr.serialize&&zr.serialize(vr,lr),vr.host&&!$r.IPV6ADDRESS.test(vr.host)){if(lr.domainHost||zr&&zr.domainHost)try{vr.host=lr.iri?Ln.toUnicode(vr.host):Ln.toASCII(vr.host.replace($r.PCT_ENCODED,Wn).toLowerCase())}catch(Bs){vr.error=vr.error||"Host's domain name can not be converted to "+(lr.iri?"Unicode":"ASCII")+" via punycode: "+Bs}}rr(vr,$r),lr.reference!=="suffix"&&vr.scheme&&(Gr.push(vr.scheme),Gr.push(":"));var fs=Bn(vr,lr);if(fs!==void 0&&(lr.reference!=="suffix"&&Gr.push("//"),Gr.push(fs),vr.path&&vr.path.charAt(0)!=="/"&&Gr.push("/")),vr.path!==void 0){var Ts=vr.path;!lr.absolutePath&&(!zr||!zr.absolutePath)&&(Ts=Rr(Ts)),fs===void 0&&(Ts=Ts.replace(/^\/\//,"/%2F")),Gr.push(Ts)}return vr.query!==void 0&&(Gr.push("?"),Gr.push(vr.query)),vr.fragment!==void 0&&(Gr.push("#"),Gr.push(vr.fragment)),Gr.join("")}function jr(vr,lr){var $r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Gr=arguments[3],zr={};return Gr||(vr=Hn(Qn(vr,$r),$r),lr=Hn(Qn(lr,$r),$r)),$r=$r||{},!$r.tolerant&&lr.scheme?(zr.scheme=lr.scheme,zr.userinfo=lr.userinfo,zr.host=lr.host,zr.port=lr.port,zr.path=Rr(lr.path||""),zr.query=lr.query):(lr.userinfo!==void 0||lr.host!==void 0||lr.port!==void 0?(zr.userinfo=lr.userinfo,zr.host=lr.host,zr.port=lr.port,zr.path=Rr(lr.path||""),zr.query=lr.query):(lr.path?(lr.path.charAt(0)==="/"?zr.path=Rr(lr.path):((vr.userinfo!==void 0||vr.host!==void 0||vr.port!==void 0)&&!vr.path?zr.path="/"+lr.path:vr.path?zr.path=vr.path.slice(0,vr.path.lastIndexOf("/")+1)+lr.path:zr.path=lr.path,zr.path=Rr(zr.path)),zr.query=lr.query):(zr.path=vr.path,lr.query!==void 0?zr.query=lr.query:zr.query=vr.query),zr.userinfo=vr.userinfo,zr.host=vr.host,zr.port=vr.port),zr.scheme=vr.scheme),zr.fragment=lr.fragment,zr}function Mr(vr,lr,$r){var Gr=Vt({scheme:"null"},$r);return Qn(jr(Hn(vr,Gr),Hn(lr,Gr),Gr,!0),Gr)}function pr(vr,lr){return typeof vr=="string"?vr=Qn(Hn(vr,lr),lr):Ft(vr)==="object"&&(vr=Hn(Qn(vr,lr),lr)),vr}function Tr(vr,lr,$r){return typeof vr=="string"?vr=Qn(Hn(vr,$r),$r):Ft(vr)==="object"&&(vr=Qn(vr,$r)),typeof lr=="string"?lr=Qn(Hn(lr,$r),$r):Ft(lr)==="object"&&(lr=Qn(lr,$r)),vr===lr}function Hr(vr,lr){return vr&&vr.toString().replace(!lr||!lr.iri?Ht.ESCAPE:Gt.ESCAPE,Un)}function Xr(vr,lr){return vr&&vr.toString().replace(!lr||!lr.iri?Ht.PCT_ENCODED:Gt.PCT_ENCODED,Wn)}var Zr={scheme:"http",domainHost:!0,parse:function(lr,$r){return lr.host||(lr.error=lr.error||"HTTP URIs must have a host."),lr},serialize:function(lr,$r){var Gr=String(lr.scheme).toLowerCase()==="https";return(lr.port===(Gr?443:80)||lr.port==="")&&(lr.port=void 0),lr.path||(lr.path="/"),lr}},ur={scheme:"https",domainHost:Zr.domainHost,parse:Zr.parse,serialize:Zr.serialize};function hr(vr){return typeof vr.secure=="boolean"?vr.secure:String(vr.scheme).toLowerCase()==="wss"}var gr={scheme:"ws",domainHost:!0,parse:function(lr,$r){var Gr=lr;return Gr.secure=hr(Gr),Gr.resourceName=(Gr.path||"/")+(Gr.query?"?"+Gr.query:""),Gr.path=void 0,Gr.query=void 0,Gr},serialize:function(lr,$r){if((lr.port===(hr(lr)?443:80)||lr.port==="")&&(lr.port=void 0),typeof lr.secure=="boolean"&&(lr.scheme=lr.secure?"wss":"ws",lr.secure=void 0),lr.resourceName){var Gr=lr.resourceName.split("?"),zr=qt(Gr,2),fs=zr[0],Ts=zr[1];lr.path=fs&&fs!=="/"?fs:void 0,lr.query=Ts,lr.resourceName=void 0}return lr.fragment=void 0,lr}},qr={scheme:"wss",domainHost:gr.domainHost,parse:gr.parse,serialize:gr.serialize},ds={},ms="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",wr="[0-9A-Fa-f]",Wr=Mt(Mt("%[EFef]"+wr+"%"+wr+wr+"%"+wr+wr)+"|"+Mt("%[89A-Fa-f]"+wr+"%"+wr+wr)+"|"+Mt("%"+wr+wr)),ns="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",us="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",ps=kt(us,'[\\"\\\\]'),Ls="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",vs=new RegExp(ms,"g"),Ps=new RegExp(Wr,"g"),Fs=new RegExp(kt("[^]",ns,"[\\.]",'[\\"]',ps),"g"),zs=new RegExp(kt("[^]",ms,Ls),"g"),Eo=zs;function js(vr){var lr=Wn(vr);return lr.match(vs)?lr:vr}var Hs={scheme:"mailto",parse:function(lr,$r){var Gr=lr,zr=Gr.to=Gr.path?Gr.path.split(","):[];if(Gr.path=void 0,Gr.query){for(var fs=!1,Ts={},Bs=Gr.query.split("&"),Xs=0,ro=Bs.length;Xs<ro;++Xs){var Ys=Bs[Xs].split("=");switch(Ys[0]){case"to":for(var co=Ys[1].split(","),To=0,Vs=co.length;To<Vs;++To)zr.push(co[To]);break;case"subject":Gr.subject=Xr(Ys[1],$r);break;case"body":Gr.body=Xr(Ys[1],$r);break;default:fs=!0,Ts[Xr(Ys[0],$r)]=Xr(Ys[1],$r);break}}fs&&(Gr.headers=Ts)}Gr.query=void 0;for(var fo=0,$o=zr.length;fo<$o;++fo){var lo=zr[fo].split("@");if(lo[0]=Xr(lo[0]),$r.unicodeSupport)lo[1]=Xr(lo[1],$r).toLowerCase();else try{lo[1]=Ln.toASCII(Xr(lo[1],$r).toLowerCase())}catch(ko){Gr.error=Gr.error||"Email address's domain name can not be converted to ASCII via punycode: "+ko}zr[fo]=lo.join("@")}return Gr},serialize:function(lr,$r){var Gr=lr,zr=Bt(lr.to);if(zr){for(var fs=0,Ts=zr.length;fs<Ts;++fs){var Bs=String(zr[fs]),Xs=Bs.lastIndexOf("@"),ro=Bs.slice(0,Xs).replace(Ps,js).replace(Ps,jt).replace(Fs,Un),Ys=Bs.slice(Xs+1);try{Ys=$r.iri?Ln.toUnicode(Ys):Ln.toASCII(Xr(Ys,$r).toLowerCase())}catch(fo){Gr.error=Gr.error||"Email address's domain name can not be converted to "+($r.iri?"Unicode":"ASCII")+" via punycode: "+fo}zr[fs]=ro+"@"+Ys}Gr.path=zr.join(",")}var co=lr.headers=lr.headers||{};lr.subject&&(co.subject=lr.subject),lr.body&&(co.body=lr.body);var To=[];for(var Vs in co)co[Vs]!==ds[Vs]&&To.push(Vs.replace(Ps,js).replace(Ps,jt).replace(zs,Un)+"="+co[Vs].replace(Ps,js).replace(Ps,jt).replace(Eo,Un));return To.length&&(Gr.query=To.join("&")),Gr}},Us=/^([^\:]+)\:(.*)/,Ks={scheme:"urn",parse:function(lr,$r){var Gr=lr.path&&lr.path.match(Us),zr=lr;if(Gr){var fs=$r.scheme||zr.scheme||"urn",Ts=Gr[1].toLowerCase(),Bs=Gr[2],Xs=fs+":"+($r.nid||Ts),ro=Vn[Xs];zr.nid=Ts,zr.nss=Bs,zr.path=void 0,ro&&(zr=ro.parse(zr,$r))}else zr.error=zr.error||"URN can not be parsed.";return zr},serialize:function(lr,$r){var Gr=$r.scheme||lr.scheme||"urn",zr=lr.nid,fs=Gr+":"+($r.nid||zr),Ts=Vn[fs];Ts&&(lr=Ts.serialize(lr,$r));var Bs=lr,Xs=lr.nss;return Bs.path=(zr||$r.nid)+":"+Xs,Bs}},go=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,vo={scheme:"urn:uuid",parse:function(lr,$r){var Gr=lr;return Gr.uuid=Gr.nss,Gr.nss=void 0,!$r.tolerant&&(!Gr.uuid||!Gr.uuid.match(go))&&(Gr.error=Gr.error||"UUID is not valid."),Gr},serialize:function(lr,$r){var Gr=lr;return Gr.nss=(lr.uuid||"").toLowerCase(),Gr}};Vn[Zr.scheme]=Zr,Vn[ur.scheme]=ur,Vn[gr.scheme]=gr,Vn[qr.scheme]=qr,Vn[Hs.scheme]=Hs,Vn[Ks.scheme]=Ks,Vn[vo.scheme]=vo,Ct.SCHEMES=Vn,Ct.pctEncChar=Un,Ct.pctDecChars=Wn,Ct.parse=Hn,Ct.removeDotSegments=Rr,Ct.serialize=Qn,Ct.resolveComponents=jr,Ct.resolve=Mr,Ct.normalize=pr,Ct.equal=Tr,Ct.escapeComponent=Hr,Ct.unescapeComponent=Xr,Object.defineProperty(Ct,"__esModule",{value:!0})})})(uri_all,uri_all.exports);var uri_allExports=uri_all.exports;Object.defineProperty(uri$1,"__esModule",{value:!0});const uri=uri_allExports;uri.code='require("ajv/dist/runtime/uri").default';uri$1.default=uri;(function(xt){Object.defineProperty(xt,"__esModule",{value:!0}),xt.CodeGen=xt.Name=xt.nil=xt.stringify=xt.str=xt._=xt.KeywordCxt=void 0;var $t=validate$1;Object.defineProperty(xt,"KeywordCxt",{enumerable:!0,get:function(){return $t.KeywordCxt}});var Ct=codegen$1;Object.defineProperty(xt,"_",{enumerable:!0,get:function(){return Ct._}}),Object.defineProperty(xt,"str",{enumerable:!0,get:function(){return Ct.str}}),Object.defineProperty(xt,"stringify",{enumerable:!0,get:function(){return Ct.stringify}}),Object.defineProperty(xt,"nil",{enumerable:!0,get:function(){return Ct.nil}}),Object.defineProperty(xt,"Name",{enumerable:!0,get:function(){return Ct.Name}}),Object.defineProperty(xt,"CodeGen",{enumerable:!0,get:function(){return Ct.CodeGen}});const kt=validation_error,Mt=ref_error,Ft=rules,jt=compile$1,Bt=codegen$1,Vt=resolve$2,zt=dataType,Ht=util,Gt=require$$9,qt=uri$1,Wt=(An,Sn)=>new RegExp(An,Sn);Wt.code="new RegExp";const Yt=["removeAdditional","useDefaults","coerceTypes"],Kt=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),Xt={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},Qt={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},Jt=200;function Zt(An){var Sn,vn,_n,Tn,Pn,Ln,Vn,Un,Wn,rr,ar,nr,mr,kn,Fn,Hn,Bn,jn,sr,Ar,Fr,Rr,Qn,jr,Mr;const pr=An.strict,Tr=(Sn=An.code)===null||Sn===void 0?void 0:Sn.optimize,Hr=Tr===!0||Tr===void 0?1:Tr||0,Xr=(_n=(vn=An.code)===null||vn===void 0?void 0:vn.regExp)!==null&&_n!==void 0?_n:Wt,Zr=(Tn=An.uriResolver)!==null&&Tn!==void 0?Tn:qt.default;return{strictSchema:(Ln=(Pn=An.strictSchema)!==null&&Pn!==void 0?Pn:pr)!==null&&Ln!==void 0?Ln:!0,strictNumbers:(Un=(Vn=An.strictNumbers)!==null&&Vn!==void 0?Vn:pr)!==null&&Un!==void 0?Un:!0,strictTypes:(rr=(Wn=An.strictTypes)!==null&&Wn!==void 0?Wn:pr)!==null&&rr!==void 0?rr:"log",strictTuples:(nr=(ar=An.strictTuples)!==null&&ar!==void 0?ar:pr)!==null&&nr!==void 0?nr:"log",strictRequired:(kn=(mr=An.strictRequired)!==null&&mr!==void 0?mr:pr)!==null&&kn!==void 0?kn:!1,code:An.code?{...An.code,optimize:Hr,regExp:Xr}:{optimize:Hr,regExp:Xr},loopRequired:(Fn=An.loopRequired)!==null&&Fn!==void 0?Fn:Jt,loopEnum:(Hn=An.loopEnum)!==null&&Hn!==void 0?Hn:Jt,meta:(Bn=An.meta)!==null&&Bn!==void 0?Bn:!0,messages:(jn=An.messages)!==null&&jn!==void 0?jn:!0,inlineRefs:(sr=An.inlineRefs)!==null&&sr!==void 0?sr:!0,schemaId:(Ar=An.schemaId)!==null&&Ar!==void 0?Ar:"$id",addUsedSchema:(Fr=An.addUsedSchema)!==null&&Fr!==void 0?Fr:!0,validateSchema:(Rr=An.validateSchema)!==null&&Rr!==void 0?Rr:!0,validateFormats:(Qn=An.validateFormats)!==null&&Qn!==void 0?Qn:!0,unicodeRegExp:(jr=An.unicodeRegExp)!==null&&jr!==void 0?jr:!0,int32range:(Mr=An.int32range)!==null&&Mr!==void 0?Mr:!0,uriResolver:Zr}}class sn{constructor(Sn={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,Sn=this.opts={...Sn,...Zt(Sn)};const{es5:vn,lines:_n}=this.opts.code;this.scope=new Bt.ValueScope({scope:{},prefixes:Kt,es5:vn,lines:_n}),this.logger=En(Sn.logger);const Tn=Sn.validateFormats;Sn.validateFormats=!1,this.RULES=(0,Ft.getRules)(),ln.call(this,Xt,Sn,"NOT SUPPORTED"),ln.call(this,Qt,Sn,"DEPRECATED","warn"),this._metaOpts=yn.call(this),Sn.formats&&cn.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),Sn.keywords&&pn.call(this,Sn.keywords),typeof Sn.meta=="object"&&this.addMetaSchema(Sn.meta),hn.call(this),Sn.validateFormats=Tn}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:Sn,meta:vn,schemaId:_n}=this.opts;let Tn=Gt;_n==="id"&&(Tn={...Gt},Tn.id=Tn.$id,delete Tn.$id),vn&&Sn&&this.addMetaSchema(Tn,Tn[_n],!1)}defaultMeta(){const{meta:Sn,schemaId:vn}=this.opts;return this.opts.defaultMeta=typeof Sn=="object"?Sn[vn]||Sn:void 0}validate(Sn,vn){let _n;if(typeof Sn=="string"){if(_n=this.getSchema(Sn),!_n)throw new Error(`no schema with key or ref "${Sn}"`)}else _n=this.compile(Sn);const Tn=_n(vn);return"$async"in _n||(this.errors=_n.errors),Tn}compile(Sn,vn){const _n=this._addSchema(Sn,vn);return _n.validate||this._compileSchemaEnv(_n)}compileAsync(Sn,vn){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:_n}=this.opts;return Tn.call(this,Sn,vn);async function Tn(rr,ar){await Pn.call(this,rr.$schema);const nr=this._addSchema(rr,ar);return nr.validate||Ln.call(this,nr)}async function Pn(rr){rr&&!this.getSchema(rr)&&await Tn.call(this,{$ref:rr},!0)}async function Ln(rr){try{return this._compileSchemaEnv(rr)}catch(ar){if(!(ar instanceof Mt.default))throw ar;return Vn.call(this,ar),await Un.call(this,ar.missingSchema),Ln.call(this,rr)}}function Vn({missingSchema:rr,missingRef:ar}){if(this.refs[rr])throw new Error(`AnySchema ${rr} is loaded but ${ar} cannot be resolved`)}async function Un(rr){const ar=await Wn.call(this,rr);this.refs[rr]||await Pn.call(this,ar.$schema),this.refs[rr]||this.addSchema(ar,rr,vn)}async function Wn(rr){const ar=this._loading[rr];if(ar)return ar;try{return await(this._loading[rr]=_n(rr))}finally{delete this._loading[rr]}}}addSchema(Sn,vn,_n,Tn=this.opts.validateSchema){if(Array.isArray(Sn)){for(const Ln of Sn)this.addSchema(Ln,void 0,_n,Tn);return this}let Pn;if(typeof Sn=="object"){const{schemaId:Ln}=this.opts;if(Pn=Sn[Ln],Pn!==void 0&&typeof Pn!="string")throw new Error(`schema ${Ln} must be string`)}return vn=(0,Vt.normalizeId)(vn||Pn),this._checkUnique(vn),this.schemas[vn]=this._addSchema(Sn,_n,vn,Tn,!0),this}addMetaSchema(Sn,vn,_n=this.opts.validateSchema){return this.addSchema(Sn,vn,!0,_n),this}validateSchema(Sn,vn){if(typeof Sn=="boolean")return!0;let _n;if(_n=Sn.$schema,_n!==void 0&&typeof _n!="string")throw new Error("$schema must be a string");if(_n=_n||this.opts.defaultMeta||this.defaultMeta(),!_n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const Tn=this.validate(_n,Sn);if(!Tn&&vn){const Pn="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(Pn);else throw new Error(Pn)}return Tn}getSchema(Sn){let vn;for(;typeof(vn=dn.call(this,Sn))=="string";)Sn=vn;if(vn===void 0){const{schemaId:_n}=this.opts,Tn=new jt.SchemaEnv({schema:{},schemaId:_n});if(vn=jt.resolveSchema.call(this,Tn,Sn),!vn)return;this.refs[Sn]=vn}return vn.validate||this._compileSchemaEnv(vn)}removeSchema(Sn){if(Sn instanceof RegExp)return this._removeAllSchemas(this.schemas,Sn),this._removeAllSchemas(this.refs,Sn),this;switch(typeof Sn){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const vn=dn.call(this,Sn);return typeof vn=="object"&&this._cache.delete(vn.schema),delete this.schemas[Sn],delete this.refs[Sn],this}case"object":{const vn=Sn;this._cache.delete(vn);let _n=Sn[this.opts.schemaId];return _n&&(_n=(0,Vt.normalizeId)(_n),delete this.schemas[_n],delete this.refs[_n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(Sn){for(const vn of Sn)this.addKeyword(vn);return this}addKeyword(Sn,vn){let _n;if(typeof Sn=="string")_n=Sn,typeof vn=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),vn.keyword=_n);else if(typeof Sn=="object"&&vn===void 0){if(vn=Sn,_n=vn.keyword,Array.isArray(_n)&&!_n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(xn.call(this,_n,vn),!vn)return(0,Ht.eachItem)(_n,Pn=>Cn.call(this,Pn)),this;wn.call(this,vn);const Tn={...vn,type:(0,zt.getJSONTypes)(vn.type),schemaType:(0,zt.getJSONTypes)(vn.schemaType)};return(0,Ht.eachItem)(_n,Tn.type.length===0?Pn=>Cn.call(this,Pn,Tn):Pn=>Tn.type.forEach(Ln=>Cn.call(this,Pn,Tn,Ln))),this}getKeyword(Sn){const vn=this.RULES.all[Sn];return typeof vn=="object"?vn.definition:!!vn}removeKeyword(Sn){const{RULES:vn}=this;delete vn.keywords[Sn],delete vn.all[Sn];for(const _n of vn.rules){const Tn=_n.rules.findIndex(Pn=>Pn.keyword===Sn);Tn>=0&&_n.rules.splice(Tn,1)}return this}addFormat(Sn,vn){return typeof vn=="string"&&(vn=new RegExp(vn)),this.formats[Sn]=vn,this}errorsText(Sn=this.errors,{separator:vn=", ",dataVar:_n="data"}={}){return!Sn||Sn.length===0?"No errors":Sn.map(Tn=>`${_n}${Tn.instancePath} ${Tn.message}`).reduce((Tn,Pn)=>Tn+vn+Pn)}$dataMetaSchema(Sn,vn){const _n=this.RULES.all;Sn=JSON.parse(JSON.stringify(Sn));for(const Tn of vn){const Pn=Tn.split("/").slice(1);let Ln=Sn;for(const Vn of Pn)Ln=Ln[Vn];for(const Vn in _n){const Un=_n[Vn];if(typeof Un!="object")continue;const{$data:Wn}=Un.definition,rr=Ln[Vn];Wn&&rr&&(Ln[Vn]=Dn(rr))}}return Sn}_removeAllSchemas(Sn,vn){for(const _n in Sn){const Tn=Sn[_n];(!vn||vn.test(_n))&&(typeof Tn=="string"?delete Sn[_n]:Tn&&!Tn.meta&&(this._cache.delete(Tn.schema),delete Sn[_n]))}}_addSchema(Sn,vn,_n,Tn=this.opts.validateSchema,Pn=this.opts.addUsedSchema){let Ln;const{schemaId:Vn}=this.opts;if(typeof Sn=="object")Ln=Sn[Vn];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof Sn!="boolean")throw new Error("schema must be object or boolean")}let Un=this._cache.get(Sn);if(Un!==void 0)return Un;_n=(0,Vt.normalizeId)(Ln||_n);const Wn=Vt.getSchemaRefs.call(this,Sn,_n);return Un=new jt.SchemaEnv({schema:Sn,schemaId:Vn,meta:vn,baseId:_n,localRefs:Wn}),this._cache.set(Un.schema,Un),Pn&&!_n.startsWith("#")&&(_n&&this._checkUnique(_n),this.refs[_n]=Un),Tn&&this.validateSchema(Sn,!0),Un}_checkUnique(Sn){if(this.schemas[Sn]||this.refs[Sn])throw new Error(`schema with key or id "${Sn}" already exists`)}_compileSchemaEnv(Sn){if(Sn.meta?this._compileMetaSchema(Sn):jt.compileSchema.call(this,Sn),!Sn.validate)throw new Error("ajv implementation error");return Sn.validate}_compileMetaSchema(Sn){const vn=this.opts;this.opts=this._metaOpts;try{jt.compileSchema.call(this,Sn)}finally{this.opts=vn}}}sn.ValidationError=kt.default,sn.MissingRefError=Mt.default,xt.default=sn;function ln(An,Sn,vn,_n="error"){for(const Tn in An){const Pn=Tn;Pn in Sn&&this.logger[_n](`${vn}: option ${Tn}. ${An[Pn]}`)}}function dn(An){return An=(0,Vt.normalizeId)(An),this.schemas[An]||this.refs[An]}function hn(){const An=this.opts.schemas;if(An)if(Array.isArray(An))this.addSchema(An);else for(const Sn in An)this.addSchema(An[Sn],Sn)}function cn(){for(const An in this.opts.formats){const Sn=this.opts.formats[An];Sn&&this.addFormat(An,Sn)}}function pn(An){if(Array.isArray(An)){this.addVocabulary(An);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const Sn in An){const vn=An[Sn];vn.keyword||(vn.keyword=Sn),this.addKeyword(vn)}}function yn(){const An={...this.opts};for(const Sn of Yt)delete An[Sn];return An}const gn={log(){},warn(){},error(){}};function En(An){if(An===!1)return gn;if(An===void 0)return console;if(An.log&&An.warn&&An.error)return An;throw new Error("logger must implement log, warn and error methods")}const bn=/^[a-z_$][a-z0-9_$:-]*$/i;function xn(An,Sn){const{RULES:vn}=this;if((0,Ht.eachItem)(An,_n=>{if(vn.keywords[_n])throw new Error(`Keyword ${_n} is already defined`);if(!bn.test(_n))throw new Error(`Keyword ${_n} has invalid name`)}),!!Sn&&Sn.$data&&!("code"in Sn||"validate"in Sn))throw new Error('$data keyword must have "code" or "validate" function')}function Cn(An,Sn,vn){var _n;const Tn=Sn==null?void 0:Sn.post;if(vn&&Tn)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:Pn}=this;let Ln=Tn?Pn.post:Pn.rules.find(({type:Un})=>Un===vn);if(Ln||(Ln={type:vn,rules:[]},Pn.rules.push(Ln)),Pn.keywords[An]=!0,!Sn)return;const Vn={keyword:An,definition:{...Sn,type:(0,zt.getJSONTypes)(Sn.type),schemaType:(0,zt.getJSONTypes)(Sn.schemaType)}};Sn.before?$n.call(this,Ln,Vn,Sn.before):Ln.rules.push(Vn),Pn.all[An]=Vn,(_n=Sn.implements)===null||_n===void 0||_n.forEach(Un=>this.addKeyword(Un))}function $n(An,Sn,vn){const _n=An.rules.findIndex(Tn=>Tn.keyword===vn);_n>=0?An.rules.splice(_n,0,Sn):(An.rules.push(Sn),this.logger.warn(`rule ${vn} is not defined`))}function wn(An){let{metaSchema:Sn}=An;Sn!==void 0&&(An.$data&&this.opts.$data&&(Sn=Dn(Sn)),An.validateSchema=this.compile(Sn,!0))}const Rn={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Dn(An){return{anyOf:[An,Rn]}}})(core$3);var draft7={},core$2={},id$1={};Object.defineProperty(id$1,"__esModule",{value:!0});const def$t={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};id$1.default=def$t;var ref$3={};Object.defineProperty(ref$3,"__esModule",{value:!0});ref$3.callRef=ref$3.getValidate=void 0;const ref_error_1$1=ref_error,code_1$8=code,codegen_1$l=codegen$1,names_1$1=names$1,compile_1$1=compile$1,util_1$j=util,def$s={keyword:"$ref",schemaType:"string",code(xt){const{gen:$t,schema:Ct,it:kt}=xt,{baseId:Mt,schemaEnv:Ft,validateName:jt,opts:Bt,self:Vt}=kt,{root:zt}=Ft;if((Ct==="#"||Ct==="#/")&&Mt===zt.baseId)return Gt();const Ht=compile_1$1.resolveRef.call(Vt,zt,Mt,Ct);if(Ht===void 0)throw new ref_error_1$1.default(kt.opts.uriResolver,Mt,Ct);if(Ht instanceof compile_1$1.SchemaEnv)return qt(Ht);return Wt(Ht);function Gt(){if(Ft===zt)return callRef(xt,jt,Ft,Ft.$async);const Yt=$t.scopeValue("root",{ref:zt});return callRef(xt,(0,codegen_1$l._)`${Yt}.validate`,zt,zt.$async)}function qt(Yt){const Kt=getValidate(xt,Yt);callRef(xt,Kt,Yt,Yt.$async)}function Wt(Yt){const Kt=$t.scopeValue("schema",Bt.code.source===!0?{ref:Yt,code:(0,codegen_1$l.stringify)(Yt)}:{ref:Yt}),Xt=$t.name("valid"),Qt=xt.subschema({schema:Yt,dataTypes:[],schemaPath:codegen_1$l.nil,topSchemaRef:Kt,errSchemaPath:Ct},Xt);xt.mergeEvaluated(Qt),xt.ok(Xt)}}};function getValidate(xt,$t){const{gen:Ct}=xt;return $t.validate?Ct.scopeValue("validate",{ref:$t.validate}):(0,codegen_1$l._)`${Ct.scopeValue("wrapper",{ref:$t})}.validate`}ref$3.getValidate=getValidate;function callRef(xt,$t,Ct,kt){const{gen:Mt,it:Ft}=xt,{allErrors:jt,schemaEnv:Bt,opts:Vt}=Ft,zt=Vt.passContext?names_1$1.default.this:codegen_1$l.nil;kt?Ht():Gt();function Ht(){if(!Bt.$async)throw new Error("async schema referenced by sync schema");const Yt=Mt.let("valid");Mt.try(()=>{Mt.code((0,codegen_1$l._)`await ${(0,code_1$8.callValidateCode)(xt,$t,zt)}`),Wt($t),jt||Mt.assign(Yt,!0)},Kt=>{Mt.if((0,codegen_1$l._)`!(${Kt} instanceof ${Ft.ValidationError})`,()=>Mt.throw(Kt)),qt(Kt),jt||Mt.assign(Yt,!1)}),xt.ok(Yt)}function Gt(){xt.result((0,code_1$8.callValidateCode)(xt,$t,zt),()=>Wt($t),()=>qt($t))}function qt(Yt){const Kt=(0,codegen_1$l._)`${Yt}.errors`;Mt.assign(names_1$1.default.vErrors,(0,codegen_1$l._)`${names_1$1.default.vErrors} === null ? ${Kt} : ${names_1$1.default.vErrors}.concat(${Kt})`),Mt.assign(names_1$1.default.errors,(0,codegen_1$l._)`${names_1$1.default.vErrors}.length`)}function Wt(Yt){var Kt;if(!Ft.opts.unevaluated)return;const Xt=(Kt=Ct==null?void 0:Ct.validate)===null||Kt===void 0?void 0:Kt.evaluated;if(Ft.props!==!0)if(Xt&&!Xt.dynamicProps)Xt.props!==void 0&&(Ft.props=util_1$j.mergeEvaluated.props(Mt,Xt.props,Ft.props));else{const Qt=Mt.var("props",(0,codegen_1$l._)`${Yt}.evaluated.props`);Ft.props=util_1$j.mergeEvaluated.props(Mt,Qt,Ft.props,codegen_1$l.Name)}if(Ft.items!==!0)if(Xt&&!Xt.dynamicItems)Xt.items!==void 0&&(Ft.items=util_1$j.mergeEvaluated.items(Mt,Xt.items,Ft.items));else{const Qt=Mt.var("items",(0,codegen_1$l._)`${Yt}.evaluated.items`);Ft.items=util_1$j.mergeEvaluated.items(Mt,Qt,Ft.items,codegen_1$l.Name)}}}ref$3.callRef=callRef;ref$3.default=def$s;Object.defineProperty(core$2,"__esModule",{value:!0});const id_1=id$1,ref_1=ref$3,core$1=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",id_1.default,ref_1.default];core$2.default=core$1;var validation$1={},limitNumber={};Object.defineProperty(limitNumber,"__esModule",{value:!0});const codegen_1$k=codegen$1,ops$1=codegen_1$k.operators,KWDs={maximum:{okStr:"<=",ok:ops$1.LTE,fail:ops$1.GT},minimum:{okStr:">=",ok:ops$1.GTE,fail:ops$1.LT},exclusiveMaximum:{okStr:"<",ok:ops$1.LT,fail:ops$1.GTE},exclusiveMinimum:{okStr:">",ok:ops$1.GT,fail:ops$1.LTE}},error$j={message:({keyword:xt,schemaCode:$t})=>(0,codegen_1$k.str)`must be ${KWDs[xt].okStr} ${$t}`,params:({keyword:xt,schemaCode:$t})=>(0,codegen_1$k._)`{comparison: ${KWDs[xt].okStr}, limit: ${$t}}`},def$r={keyword:Object.keys(KWDs),type:"number",schemaType:"number",$data:!0,error:error$j,code(xt){const{keyword:$t,data:Ct,schemaCode:kt}=xt;xt.fail$data((0,codegen_1$k._)`${Ct} ${KWDs[$t].fail} ${kt} || isNaN(${Ct})`)}};limitNumber.default=def$r;var multipleOf={};Object.defineProperty(multipleOf,"__esModule",{value:!0});const codegen_1$j=codegen$1,error$i={message:({schemaCode:xt})=>(0,codegen_1$j.str)`must be multiple of ${xt}`,params:({schemaCode:xt})=>(0,codegen_1$j._)`{multipleOf: ${xt}}`},def$q={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:error$i,code(xt){const{gen:$t,data:Ct,schemaCode:kt,it:Mt}=xt,Ft=Mt.opts.multipleOfPrecision,jt=$t.let("res"),Bt=Ft?(0,codegen_1$j._)`Math.abs(Math.round(${jt}) - ${jt}) > 1e-${Ft}`:(0,codegen_1$j._)`${jt} !== parseInt(${jt})`;xt.fail$data((0,codegen_1$j._)`(${kt} === 0 || (${jt} = ${Ct}/${kt}, ${Bt}))`)}};multipleOf.default=def$q;var limitLength={},ucs2length$1={};Object.defineProperty(ucs2length$1,"__esModule",{value:!0});function ucs2length(xt){const $t=xt.length;let Ct=0,kt=0,Mt;for(;kt<$t;)Ct++,Mt=xt.charCodeAt(kt++),Mt>=55296&&Mt<=56319&&kt<$t&&(Mt=xt.charCodeAt(kt),(Mt&64512)===56320&&kt++);return Ct}ucs2length$1.default=ucs2length;ucs2length.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(limitLength,"__esModule",{value:!0});const codegen_1$i=codegen$1,util_1$i=util,ucs2length_1=ucs2length$1,error$h={message({keyword:xt,schemaCode:$t}){const Ct=xt==="maxLength"?"more":"fewer";return(0,codegen_1$i.str)`must NOT have ${Ct} than ${$t} characters`},params:({schemaCode:xt})=>(0,codegen_1$i._)`{limit: ${xt}}`},def$p={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:error$h,code(xt){const{keyword:$t,data:Ct,schemaCode:kt,it:Mt}=xt,Ft=$t==="maxLength"?codegen_1$i.operators.GT:codegen_1$i.operators.LT,jt=Mt.opts.unicode===!1?(0,codegen_1$i._)`${Ct}.length`:(0,codegen_1$i._)`${(0,util_1$i.useFunc)(xt.gen,ucs2length_1.default)}(${Ct})`;xt.fail$data((0,codegen_1$i._)`${jt} ${Ft} ${kt}`)}};limitLength.default=def$p;var pattern={};Object.defineProperty(pattern,"__esModule",{value:!0});const code_1$7=code,codegen_1$h=codegen$1,error$g={message:({schemaCode:xt})=>(0,codegen_1$h.str)`must match pattern "${xt}"`,params:({schemaCode:xt})=>(0,codegen_1$h._)`{pattern: ${xt}}`},def$o={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:error$g,code(xt){const{data:$t,$data:Ct,schema:kt,schemaCode:Mt,it:Ft}=xt,jt=Ft.opts.unicodeRegExp?"u":"",Bt=Ct?(0,codegen_1$h._)`(new RegExp(${Mt}, ${jt}))`:(0,code_1$7.usePattern)(xt,kt);xt.fail$data((0,codegen_1$h._)`!${Bt}.test(${$t})`)}};pattern.default=def$o;var limitProperties={};Object.defineProperty(limitProperties,"__esModule",{value:!0});const codegen_1$g=codegen$1,error$f={message({keyword:xt,schemaCode:$t}){const Ct=xt==="maxProperties"?"more":"fewer";return(0,codegen_1$g.str)`must NOT have ${Ct} than ${$t} properties`},params:({schemaCode:xt})=>(0,codegen_1$g._)`{limit: ${xt}}`},def$n={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:error$f,code(xt){const{keyword:$t,data:Ct,schemaCode:kt}=xt,Mt=$t==="maxProperties"?codegen_1$g.operators.GT:codegen_1$g.operators.LT;xt.fail$data((0,codegen_1$g._)`Object.keys(${Ct}).length ${Mt} ${kt}`)}};limitProperties.default=def$n;var required={};Object.defineProperty(required,"__esModule",{value:!0});const code_1$6=code,codegen_1$f=codegen$1,util_1$h=util,error$e={message:({params:{missingProperty:xt}})=>(0,codegen_1$f.str)`must have required property '${xt}'`,params:({params:{missingProperty:xt}})=>(0,codegen_1$f._)`{missingProperty: ${xt}}`},def$m={keyword:"required",type:"object",schemaType:"array",$data:!0,error:error$e,code(xt){const{gen:$t,schema:Ct,schemaCode:kt,data:Mt,$data:Ft,it:jt}=xt,{opts:Bt}=jt;if(!Ft&&Ct.length===0)return;const Vt=Ct.length>=Bt.loopRequired;if(jt.allErrors?zt():Ht(),Bt.strictRequired){const Wt=xt.parentSchema.properties,{definedProperties:Yt}=xt.it;for(const Kt of Ct)if((Wt==null?void 0:Wt[Kt])===void 0&&!Yt.has(Kt)){const Xt=jt.schemaEnv.baseId+jt.errSchemaPath,Qt=`required property "${Kt}" is not defined at "${Xt}" (strictRequired)`;(0,util_1$h.checkStrictMode)(jt,Qt,jt.opts.strictRequired)}}function zt(){if(Vt||Ft)xt.block$data(codegen_1$f.nil,Gt);else for(const Wt of Ct)(0,code_1$6.checkReportMissingProp)(xt,Wt)}function Ht(){const Wt=$t.let("missing");if(Vt||Ft){const Yt=$t.let("valid",!0);xt.block$data(Yt,()=>qt(Wt,Yt)),xt.ok(Yt)}else $t.if((0,code_1$6.checkMissingProp)(xt,Ct,Wt)),(0,code_1$6.reportMissingProp)(xt,Wt),$t.else()}function Gt(){$t.forOf("prop",kt,Wt=>{xt.setParams({missingProperty:Wt}),$t.if((0,code_1$6.noPropertyInData)($t,Mt,Wt,Bt.ownProperties),()=>xt.error())})}function qt(Wt,Yt){xt.setParams({missingProperty:Wt}),$t.forOf(Wt,kt,()=>{$t.assign(Yt,(0,code_1$6.propertyInData)($t,Mt,Wt,Bt.ownProperties)),$t.if((0,codegen_1$f.not)(Yt),()=>{xt.error(),$t.break()})},codegen_1$f.nil)}}};required.default=def$m;var limitItems={};Object.defineProperty(limitItems,"__esModule",{value:!0});const codegen_1$e=codegen$1,error$d={message({keyword:xt,schemaCode:$t}){const Ct=xt==="maxItems"?"more":"fewer";return(0,codegen_1$e.str)`must NOT have ${Ct} than ${$t} items`},params:({schemaCode:xt})=>(0,codegen_1$e._)`{limit: ${xt}}`},def$l={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:error$d,code(xt){const{keyword:$t,data:Ct,schemaCode:kt}=xt,Mt=$t==="maxItems"?codegen_1$e.operators.GT:codegen_1$e.operators.LT;xt.fail$data((0,codegen_1$e._)`${Ct}.length ${Mt} ${kt}`)}};limitItems.default=def$l;var uniqueItems={},equal$2={};Object.defineProperty(equal$2,"__esModule",{value:!0});const equal$1=fastDeepEqual;equal$1.code='require("ajv/dist/runtime/equal").default';equal$2.default=equal$1;Object.defineProperty(uniqueItems,"__esModule",{value:!0});const dataType_1=dataType,codegen_1$d=codegen$1,util_1$g=util,equal_1$2=equal$2,error$c={message:({params:{i:xt,j:$t}})=>(0,codegen_1$d.str)`must NOT have duplicate items (items ## ${$t} and ${xt} are identical)`,params:({params:{i:xt,j:$t}})=>(0,codegen_1$d._)`{i: ${xt}, j: ${$t}}`},def$k={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:error$c,code(xt){const{gen:$t,data:Ct,$data:kt,schema:Mt,parentSchema:Ft,schemaCode:jt,it:Bt}=xt;if(!kt&&!Mt)return;const Vt=$t.let("valid"),zt=Ft.items?(0,dataType_1.getSchemaTypes)(Ft.items):[];xt.block$data(Vt,Ht,(0,codegen_1$d._)`${jt} === false`),xt.ok(Vt);function Ht(){const Yt=$t.let("i",(0,codegen_1$d._)`${Ct}.length`),Kt=$t.let("j");xt.setParams({i:Yt,j:Kt}),$t.assign(Vt,!0),$t.if((0,codegen_1$d._)`${Yt} > 1`,()=>(Gt()?qt:Wt)(Yt,Kt))}function Gt(){return zt.length>0&&!zt.some(Yt=>Yt==="object"||Yt==="array")}function qt(Yt,Kt){const Xt=$t.name("item"),Qt=(0,dataType_1.checkDataTypes)(zt,Xt,Bt.opts.strictNumbers,dataType_1.DataType.Wrong),Jt=$t.const("indices",(0,codegen_1$d._)`{}`);$t.for((0,codegen_1$d._)`;${Yt}--;`,()=>{$t.let(Xt,(0,codegen_1$d._)`${Ct}[${Yt}]`),$t.if(Qt,(0,codegen_1$d._)`continue`),zt.length>1&&$t.if((0,codegen_1$d._)`typeof ${Xt} == "string"`,(0,codegen_1$d._)`${Xt} += "_"`),$t.if((0,codegen_1$d._)`typeof ${Jt}[${Xt}] == "number"`,()=>{$t.assign(Kt,(0,codegen_1$d._)`${Jt}[${Xt}]`),xt.error(),$t.assign(Vt,!1).break()}).code((0,codegen_1$d._)`${Jt}[${Xt}] = ${Yt}`)})}function Wt(Yt,Kt){const Xt=(0,util_1$g.useFunc)($t,equal_1$2.default),Qt=$t.name("outer");$t.label(Qt).for((0,codegen_1$d._)`;${Yt}--;`,()=>$t.for((0,codegen_1$d._)`${Kt} = ${Yt}; ${Kt}--;`,()=>$t.if((0,codegen_1$d._)`${Xt}(${Ct}[${Yt}], ${Ct}[${Kt}])`,()=>{xt.error(),$t.assign(Vt,!1).break(Qt)})))}}};uniqueItems.default=def$k;var _const={};Object.defineProperty(_const,"__esModule",{value:!0});const codegen_1$c=codegen$1,util_1$f=util,equal_1$1=equal$2,error$b={message:"must be equal to constant",params:({schemaCode:xt})=>(0,codegen_1$c._)`{allowedValue: ${xt}}`},def$j={keyword:"const",$data:!0,error:error$b,code(xt){const{gen:$t,data:Ct,$data:kt,schemaCode:Mt,schema:Ft}=xt;kt||Ft&&typeof Ft=="object"?xt.fail$data((0,codegen_1$c._)`!${(0,util_1$f.useFunc)($t,equal_1$1.default)}(${Ct}, ${Mt})`):xt.fail((0,codegen_1$c._)`${Ft} !== ${Ct}`)}};_const.default=def$j;var _enum={};Object.defineProperty(_enum,"__esModule",{value:!0});const codegen_1$b=codegen$1,util_1$e=util,equal_1=equal$2,error$a={message:"must be equal to one of the allowed values",params:({schemaCode:xt})=>(0,codegen_1$b._)`{allowedValues: ${xt}}`},def$i={keyword:"enum",schemaType:"array",$data:!0,error:error$a,code(xt){const{gen:$t,data:Ct,$data:kt,schema:Mt,schemaCode:Ft,it:jt}=xt;if(!kt&&Mt.length===0)throw new Error("enum must have non-empty array");const Bt=Mt.length>=jt.opts.loopEnum;let Vt;const zt=()=>Vt??(Vt=(0,util_1$e.useFunc)($t,equal_1.default));let Ht;if(Bt||kt)Ht=$t.let("valid"),xt.block$data(Ht,Gt);else{if(!Array.isArray(Mt))throw new Error("ajv implementation error");const Wt=$t.const("vSchema",Ft);Ht=(0,codegen_1$b.or)(...Mt.map((Yt,Kt)=>qt(Wt,Kt)))}xt.pass(Ht);function Gt(){$t.assign(Ht,!1),$t.forOf("v",Ft,Wt=>$t.if((0,codegen_1$b._)`${zt()}(${Ct}, ${Wt})`,()=>$t.assign(Ht,!0).break()))}function qt(Wt,Yt){const Kt=Mt[Yt];return typeof Kt=="object"&&Kt!==null?(0,codegen_1$b._)`${zt()}(${Ct}, ${Wt}[${Yt}])`:(0,codegen_1$b._)`${Ct} === ${Kt}`}}};_enum.default=def$i;Object.defineProperty(validation$1,"__esModule",{value:!0});const limitNumber_1=limitNumber,multipleOf_1=multipleOf,limitLength_1=limitLength,pattern_1=pattern,limitProperties_1=limitProperties,required_1=required,limitItems_1=limitItems,uniqueItems_1=uniqueItems,const_1=_const,enum_1=_enum,validation=[limitNumber_1.default,multipleOf_1.default,limitLength_1.default,pattern_1.default,limitProperties_1.default,required_1.default,limitItems_1.default,uniqueItems_1.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},const_1.default,enum_1.default];validation$1.default=validation;var applicator={},additionalItems={};Object.defineProperty(additionalItems,"__esModule",{value:!0});additionalItems.validateAdditionalItems=void 0;const codegen_1$a=codegen$1,util_1$d=util,error$9={message:({params:{len:xt}})=>(0,codegen_1$a.str)`must NOT have more than ${xt} items`,params:({params:{len:xt}})=>(0,codegen_1$a._)`{limit: ${xt}}`},def$h={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:error$9,code(xt){const{parentSchema:$t,it:Ct}=xt,{items:kt}=$t;if(!Array.isArray(kt)){(0,util_1$d.checkStrictMode)(Ct,'"additionalItems" is ignored when "items" is not an array of schemas');return}validateAdditionalItems(xt,kt)}};function validateAdditionalItems(xt,$t){const{gen:Ct,schema:kt,data:Mt,keyword:Ft,it:jt}=xt;jt.items=!0;const Bt=Ct.const("len",(0,codegen_1$a._)`${Mt}.length`);if(kt===!1)xt.setParams({len:$t.length}),xt.pass((0,codegen_1$a._)`${Bt} <= ${$t.length}`);else if(typeof kt=="object"&&!(0,util_1$d.alwaysValidSchema)(jt,kt)){const zt=Ct.var("valid",(0,codegen_1$a._)`${Bt} <= ${$t.length}`);Ct.if((0,codegen_1$a.not)(zt),()=>Vt(zt)),xt.ok(zt)}function Vt(zt){Ct.forRange("i",$t.length,Bt,Ht=>{xt.subschema({keyword:Ft,dataProp:Ht,dataPropType:util_1$d.Type.Num},zt),jt.allErrors||Ct.if((0,codegen_1$a.not)(zt),()=>Ct.break())})}}additionalItems.validateAdditionalItems=validateAdditionalItems;additionalItems.default=def$h;var prefixItems={},items={};Object.defineProperty(items,"__esModule",{value:!0});items.validateTuple=void 0;const codegen_1$9=codegen$1,util_1$c=util,code_1$5=code,def$g={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(xt){const{schema:$t,it:Ct}=xt;if(Array.isArray($t))return validateTuple(xt,"additionalItems",$t);Ct.items=!0,!(0,util_1$c.alwaysValidSchema)(Ct,$t)&&xt.ok((0,code_1$5.validateArray)(xt))}};function validateTuple(xt,$t,Ct=xt.schema){const{gen:kt,parentSchema:Mt,data:Ft,keyword:jt,it:Bt}=xt;Ht(Mt),Bt.opts.unevaluated&&Ct.length&&Bt.items!==!0&&(Bt.items=util_1$c.mergeEvaluated.items(kt,Ct.length,Bt.items));const Vt=kt.name("valid"),zt=kt.const("len",(0,codegen_1$9._)`${Ft}.length`);Ct.forEach((Gt,qt)=>{(0,util_1$c.alwaysValidSchema)(Bt,Gt)||(kt.if((0,codegen_1$9._)`${zt} > ${qt}`,()=>xt.subschema({keyword:jt,schemaProp:qt,dataProp:qt},Vt)),xt.ok(Vt))});function Ht(Gt){const{opts:qt,errSchemaPath:Wt}=Bt,Yt=Ct.length,Kt=Yt===Gt.minItems&&(Yt===Gt.maxItems||Gt[$t]===!1);if(qt.strictTuples&&!Kt){const Xt=`"${jt}" is ${Yt}-tuple, but minItems or maxItems/${$t} are not specified or different at path "${Wt}"`;(0,util_1$c.checkStrictMode)(Bt,Xt,qt.strictTuples)}}}items.validateTuple=validateTuple;items.default=def$g;Object.defineProperty(prefixItems,"__esModule",{value:!0});const items_1$1=items,def$f={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:xt=>(0,items_1$1.validateTuple)(xt,"items")};prefixItems.default=def$f;var items2020={};Object.defineProperty(items2020,"__esModule",{value:!0});const codegen_1$8=codegen$1,util_1$b=util,code_1$4=code,additionalItems_1$1=additionalItems,error$8={message:({params:{len:xt}})=>(0,codegen_1$8.str)`must NOT have more than ${xt} items`,params:({params:{len:xt}})=>(0,codegen_1$8._)`{limit: ${xt}}`},def$e={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:error$8,code(xt){const{schema:$t,parentSchema:Ct,it:kt}=xt,{prefixItems:Mt}=Ct;kt.items=!0,!(0,util_1$b.alwaysValidSchema)(kt,$t)&&(Mt?(0,additionalItems_1$1.validateAdditionalItems)(xt,Mt):xt.ok((0,code_1$4.validateArray)(xt)))}};items2020.default=def$e;var contains$2={};Object.defineProperty(contains$2,"__esModule",{value:!0});const codegen_1$7=codegen$1,util_1$a=util,error$7={message:({params:{min:xt,max:$t}})=>$t===void 0?(0,codegen_1$7.str)`must contain at least ${xt} valid item(s)`:(0,codegen_1$7.str)`must contain at least ${xt} and no more than ${$t} valid item(s)`,params:({params:{min:xt,max:$t}})=>$t===void 0?(0,codegen_1$7._)`{minContains: ${xt}}`:(0,codegen_1$7._)`{minContains: ${xt}, maxContains: ${$t}}`},def$d={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:error$7,code(xt){const{gen:$t,schema:Ct,parentSchema:kt,data:Mt,it:Ft}=xt;let jt,Bt;const{minContains:Vt,maxContains:zt}=kt;Ft.opts.next?(jt=Vt===void 0?1:Vt,Bt=zt):jt=1;const Ht=$t.const("len",(0,codegen_1$7._)`${Mt}.length`);if(xt.setParams({min:jt,max:Bt}),Bt===void 0&&jt===0){(0,util_1$a.checkStrictMode)(Ft,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(Bt!==void 0&&jt>Bt){(0,util_1$a.checkStrictMode)(Ft,'"minContains" > "maxContains" is always invalid'),xt.fail();return}if((0,util_1$a.alwaysValidSchema)(Ft,Ct)){let Kt=(0,codegen_1$7._)`${Ht} >= ${jt}`;Bt!==void 0&&(Kt=(0,codegen_1$7._)`${Kt} && ${Ht} <= ${Bt}`),xt.pass(Kt);return}Ft.items=!0;const Gt=$t.name("valid");Bt===void 0&&jt===1?Wt(Gt,()=>$t.if(Gt,()=>$t.break())):jt===0?($t.let(Gt,!0),Bt!==void 0&&$t.if((0,codegen_1$7._)`${Mt}.length > 0`,qt)):($t.let(Gt,!1),qt()),xt.result(Gt,()=>xt.reset());function qt(){const Kt=$t.name("_valid"),Xt=$t.let("count",0);Wt(Kt,()=>$t.if(Kt,()=>Yt(Xt)))}function Wt(Kt,Xt){$t.forRange("i",0,Ht,Qt=>{xt.subschema({keyword:"contains",dataProp:Qt,dataPropType:util_1$a.Type.Num,compositeRule:!0},Kt),Xt()})}function Yt(Kt){$t.code((0,codegen_1$7._)`${Kt}++`),Bt===void 0?$t.if((0,codegen_1$7._)`${Kt} >= ${jt}`,()=>$t.assign(Gt,!0).break()):($t.if((0,codegen_1$7._)`${Kt} > ${Bt}`,()=>$t.assign(Gt,!1).break()),jt===1?$t.assign(Gt,!0):$t.if((0,codegen_1$7._)`${Kt} >= ${jt}`,()=>$t.assign(Gt,!0)))}}};contains$2.default=def$d;var dependencies$2={};(function(xt){Object.defineProperty(xt,"__esModule",{value:!0}),xt.validateSchemaDeps=xt.validatePropertyDeps=xt.error=void 0;const $t=codegen$1,Ct=util,kt=code;xt.error={message:({params:{property:Vt,depsCount:zt,deps:Ht}})=>{const Gt=zt===1?"property":"properties";return(0,$t.str)`must have ${Gt} ${Ht} when property ${Vt} is present`},params:({params:{property:Vt,depsCount:zt,deps:Ht,missingProperty:Gt}})=>(0,$t._)`{property: ${Vt},
    missingProperty: ${Gt},
    depsCount: ${zt},
    deps: ${Ht}}`};const Mt={keyword:"dependencies",type:"object",schemaType:"object",error:xt.error,code(Vt){const[zt,Ht]=Ft(Vt);jt(Vt,zt),Bt(Vt,Ht)}};function Ft({schema:Vt}){const zt={},Ht={};for(const Gt in Vt){if(Gt==="__proto__")continue;const qt=Array.isArray(Vt[Gt])?zt:Ht;qt[Gt]=Vt[Gt]}return[zt,Ht]}function jt(Vt,zt=Vt.schema){const{gen:Ht,data:Gt,it:qt}=Vt;if(Object.keys(zt).length===0)return;const Wt=Ht.let("missing");for(const Yt in zt){const Kt=zt[Yt];if(Kt.length===0)continue;const Xt=(0,kt.propertyInData)(Ht,Gt,Yt,qt.opts.ownProperties);Vt.setParams({property:Yt,depsCount:Kt.length,deps:Kt.join(", ")}),qt.allErrors?Ht.if(Xt,()=>{for(const Qt of Kt)(0,kt.checkReportMissingProp)(Vt,Qt)}):(Ht.if((0,$t._)`${Xt} && (${(0,kt.checkMissingProp)(Vt,Kt,Wt)})`),(0,kt.reportMissingProp)(Vt,Wt),Ht.else())}}xt.validatePropertyDeps=jt;function Bt(Vt,zt=Vt.schema){const{gen:Ht,data:Gt,keyword:qt,it:Wt}=Vt,Yt=Ht.name("valid");for(const Kt in zt)(0,Ct.alwaysValidSchema)(Wt,zt[Kt])||(Ht.if((0,kt.propertyInData)(Ht,Gt,Kt,Wt.opts.ownProperties),()=>{const Xt=Vt.subschema({keyword:qt,schemaProp:Kt},Yt);Vt.mergeValidEvaluated(Xt,Yt)},()=>Ht.var(Yt,!0)),Vt.ok(Yt))}xt.validateSchemaDeps=Bt,xt.default=Mt})(dependencies$2);var propertyNames={};Object.defineProperty(propertyNames,"__esModule",{value:!0});const codegen_1$6=codegen$1,util_1$9=util,error$6={message:"property name must be valid",params:({params:xt})=>(0,codegen_1$6._)`{propertyName: ${xt.propertyName}}`},def$c={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:error$6,code(xt){const{gen:$t,schema:Ct,data:kt,it:Mt}=xt;if((0,util_1$9.alwaysValidSchema)(Mt,Ct))return;const Ft=$t.name("valid");$t.forIn("key",kt,jt=>{xt.setParams({propertyName:jt}),xt.subschema({keyword:"propertyNames",data:jt,dataTypes:["string"],propertyName:jt,compositeRule:!0},Ft),$t.if((0,codegen_1$6.not)(Ft),()=>{xt.error(!0),Mt.allErrors||$t.break()})}),xt.ok(Ft)}};propertyNames.default=def$c;var additionalProperties={};Object.defineProperty(additionalProperties,"__esModule",{value:!0});const code_1$3=code,codegen_1$5=codegen$1,names_1=names$1,util_1$8=util,error$5={message:"must NOT have additional properties",params:({params:xt})=>(0,codegen_1$5._)`{additionalProperty: ${xt.additionalProperty}}`},def$b={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:error$5,code(xt){const{gen:$t,schema:Ct,parentSchema:kt,data:Mt,errsCount:Ft,it:jt}=xt;if(!Ft)throw new Error("ajv implementation error");const{allErrors:Bt,opts:Vt}=jt;if(jt.props=!0,Vt.removeAdditional!=="all"&&(0,util_1$8.alwaysValidSchema)(jt,Ct))return;const zt=(0,code_1$3.allSchemaProperties)(kt.properties),Ht=(0,code_1$3.allSchemaProperties)(kt.patternProperties);Gt(),xt.ok((0,codegen_1$5._)`${Ft} === ${names_1.default.errors}`);function Gt(){$t.forIn("key",Mt,Xt=>{!zt.length&&!Ht.length?Yt(Xt):$t.if(qt(Xt),()=>Yt(Xt))})}function qt(Xt){let Qt;if(zt.length>8){const Jt=(0,util_1$8.schemaRefOrVal)(jt,kt.properties,"properties");Qt=(0,code_1$3.isOwnProperty)($t,Jt,Xt)}else zt.length?Qt=(0,codegen_1$5.or)(...zt.map(Jt=>(0,codegen_1$5._)`${Xt} === ${Jt}`)):Qt=codegen_1$5.nil;return Ht.length&&(Qt=(0,codegen_1$5.or)(Qt,...Ht.map(Jt=>(0,codegen_1$5._)`${(0,code_1$3.usePattern)(xt,Jt)}.test(${Xt})`))),(0,codegen_1$5.not)(Qt)}function Wt(Xt){$t.code((0,codegen_1$5._)`delete ${Mt}[${Xt}]`)}function Yt(Xt){if(Vt.removeAdditional==="all"||Vt.removeAdditional&&Ct===!1){Wt(Xt);return}if(Ct===!1){xt.setParams({additionalProperty:Xt}),xt.error(),Bt||$t.break();return}if(typeof Ct=="object"&&!(0,util_1$8.alwaysValidSchema)(jt,Ct)){const Qt=$t.name("valid");Vt.removeAdditional==="failing"?(Kt(Xt,Qt,!1),$t.if((0,codegen_1$5.not)(Qt),()=>{xt.reset(),Wt(Xt)})):(Kt(Xt,Qt),Bt||$t.if((0,codegen_1$5.not)(Qt),()=>$t.break()))}}function Kt(Xt,Qt,Jt){const Zt={keyword:"additionalProperties",dataProp:Xt,dataPropType:util_1$8.Type.Str};Jt===!1&&Object.assign(Zt,{compositeRule:!0,createErrors:!1,allErrors:!1}),xt.subschema(Zt,Qt)}}};additionalProperties.default=def$b;var properties$1={};Object.defineProperty(properties$1,"__esModule",{value:!0});const validate_1=validate$1,code_1$2=code,util_1$7=util,additionalProperties_1$1=additionalProperties,def$a={keyword:"properties",type:"object",schemaType:"object",code(xt){const{gen:$t,schema:Ct,parentSchema:kt,data:Mt,it:Ft}=xt;Ft.opts.removeAdditional==="all"&&kt.additionalProperties===void 0&&additionalProperties_1$1.default.code(new validate_1.KeywordCxt(Ft,additionalProperties_1$1.default,"additionalProperties"));const jt=(0,code_1$2.allSchemaProperties)(Ct);for(const Gt of jt)Ft.definedProperties.add(Gt);Ft.opts.unevaluated&&jt.length&&Ft.props!==!0&&(Ft.props=util_1$7.mergeEvaluated.props($t,(0,util_1$7.toHash)(jt),Ft.props));const Bt=jt.filter(Gt=>!(0,util_1$7.alwaysValidSchema)(Ft,Ct[Gt]));if(Bt.length===0)return;const Vt=$t.name("valid");for(const Gt of Bt)zt(Gt)?Ht(Gt):($t.if((0,code_1$2.propertyInData)($t,Mt,Gt,Ft.opts.ownProperties)),Ht(Gt),Ft.allErrors||$t.else().var(Vt,!0),$t.endIf()),xt.it.definedProperties.add(Gt),xt.ok(Vt);function zt(Gt){return Ft.opts.useDefaults&&!Ft.compositeRule&&Ct[Gt].default!==void 0}function Ht(Gt){xt.subschema({keyword:"properties",schemaProp:Gt,dataProp:Gt},Vt)}}};properties$1.default=def$a;var patternProperties={};Object.defineProperty(patternProperties,"__esModule",{value:!0});const code_1$1=code,codegen_1$4=codegen$1,util_1$6=util,util_2=util,def$9={keyword:"patternProperties",type:"object",schemaType:"object",code(xt){const{gen:$t,schema:Ct,data:kt,parentSchema:Mt,it:Ft}=xt,{opts:jt}=Ft,Bt=(0,code_1$1.allSchemaProperties)(Ct),Vt=Bt.filter(Kt=>(0,util_1$6.alwaysValidSchema)(Ft,Ct[Kt]));if(Bt.length===0||Vt.length===Bt.length&&(!Ft.opts.unevaluated||Ft.props===!0))return;const zt=jt.strictSchema&&!jt.allowMatchingProperties&&Mt.properties,Ht=$t.name("valid");Ft.props!==!0&&!(Ft.props instanceof codegen_1$4.Name)&&(Ft.props=(0,util_2.evaluatedPropsToName)($t,Ft.props));const{props:Gt}=Ft;qt();function qt(){for(const Kt of Bt)zt&&Wt(Kt),Ft.allErrors?Yt(Kt):($t.var(Ht,!0),Yt(Kt),$t.if(Ht))}function Wt(Kt){for(const Xt in zt)new RegExp(Kt).test(Xt)&&(0,util_1$6.checkStrictMode)(Ft,`property ${Xt} matches pattern ${Kt} (use allowMatchingProperties)`)}function Yt(Kt){$t.forIn("key",kt,Xt=>{$t.if((0,codegen_1$4._)`${(0,code_1$1.usePattern)(xt,Kt)}.test(${Xt})`,()=>{const Qt=Vt.includes(Kt);Qt||xt.subschema({keyword:"patternProperties",schemaProp:Kt,dataProp:Xt,dataPropType:util_2.Type.Str},Ht),Ft.opts.unevaluated&&Gt!==!0?$t.assign((0,codegen_1$4._)`${Gt}[${Xt}]`,!0):!Qt&&!Ft.allErrors&&$t.if((0,codegen_1$4.not)(Ht),()=>$t.break())})})}}};patternProperties.default=def$9;var not={};Object.defineProperty(not,"__esModule",{value:!0});const util_1$5=util,def$8={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(xt){const{gen:$t,schema:Ct,it:kt}=xt;if((0,util_1$5.alwaysValidSchema)(kt,Ct)){xt.fail();return}const Mt=$t.name("valid");xt.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},Mt),xt.failResult(Mt,()=>xt.reset(),()=>xt.error())},error:{message:"must NOT be valid"}};not.default=def$8;var anyOf={};Object.defineProperty(anyOf,"__esModule",{value:!0});const code_1=code,def$7={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:code_1.validateUnion,error:{message:"must match a schema in anyOf"}};anyOf.default=def$7;var oneOf={};Object.defineProperty(oneOf,"__esModule",{value:!0});const codegen_1$3=codegen$1,util_1$4=util,error$4={message:"must match exactly one schema in oneOf",params:({params:xt})=>(0,codegen_1$3._)`{passingSchemas: ${xt.passing}}`},def$6={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:error$4,code(xt){const{gen:$t,schema:Ct,parentSchema:kt,it:Mt}=xt;if(!Array.isArray(Ct))throw new Error("ajv implementation error");if(Mt.opts.discriminator&&kt.discriminator)return;const Ft=Ct,jt=$t.let("valid",!1),Bt=$t.let("passing",null),Vt=$t.name("_valid");xt.setParams({passing:Bt}),$t.block(zt),xt.result(jt,()=>xt.reset(),()=>xt.error(!0));function zt(){Ft.forEach((Ht,Gt)=>{let qt;(0,util_1$4.alwaysValidSchema)(Mt,Ht)?$t.var(Vt,!0):qt=xt.subschema({keyword:"oneOf",schemaProp:Gt,compositeRule:!0},Vt),Gt>0&&$t.if((0,codegen_1$3._)`${Vt} && ${jt}`).assign(jt,!1).assign(Bt,(0,codegen_1$3._)`[${Bt}, ${Gt}]`).else(),$t.if(Vt,()=>{$t.assign(jt,!0),$t.assign(Bt,Gt),qt&&xt.mergeEvaluated(qt,codegen_1$3.Name)})})}}};oneOf.default=def$6;var allOf={};Object.defineProperty(allOf,"__esModule",{value:!0});const util_1$3=util,def$5={keyword:"allOf",schemaType:"array",code(xt){const{gen:$t,schema:Ct,it:kt}=xt;if(!Array.isArray(Ct))throw new Error("ajv implementation error");const Mt=$t.name("valid");Ct.forEach((Ft,jt)=>{if((0,util_1$3.alwaysValidSchema)(kt,Ft))return;const Bt=xt.subschema({keyword:"allOf",schemaProp:jt},Mt);xt.ok(Mt),xt.mergeEvaluated(Bt)})}};allOf.default=def$5;var _if={};Object.defineProperty(_if,"__esModule",{value:!0});const codegen_1$2=codegen$1,util_1$2=util,error$3={message:({params:xt})=>(0,codegen_1$2.str)`must match "${xt.ifClause}" schema`,params:({params:xt})=>(0,codegen_1$2._)`{failingKeyword: ${xt.ifClause}}`},def$4={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:error$3,code(xt){const{gen:$t,parentSchema:Ct,it:kt}=xt;Ct.then===void 0&&Ct.else===void 0&&(0,util_1$2.checkStrictMode)(kt,'"if" without "then" and "else" is ignored');const Mt=hasSchema(kt,"then"),Ft=hasSchema(kt,"else");if(!Mt&&!Ft)return;const jt=$t.let("valid",!0),Bt=$t.name("_valid");if(Vt(),xt.reset(),Mt&&Ft){const Ht=$t.let("ifClause");xt.setParams({ifClause:Ht}),$t.if(Bt,zt("then",Ht),zt("else",Ht))}else Mt?$t.if(Bt,zt("then")):$t.if((0,codegen_1$2.not)(Bt),zt("else"));xt.pass(jt,()=>xt.error(!0));function Vt(){const Ht=xt.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},Bt);xt.mergeEvaluated(Ht)}function zt(Ht,Gt){return()=>{const qt=xt.subschema({keyword:Ht},Bt);$t.assign(jt,Bt),xt.mergeValidEvaluated(qt,jt),Gt?$t.assign(Gt,(0,codegen_1$2._)`${Ht}`):xt.setParams({ifClause:Ht})}}}};function hasSchema(xt,$t){const Ct=xt.schema[$t];return Ct!==void 0&&!(0,util_1$2.alwaysValidSchema)(xt,Ct)}_if.default=def$4;var thenElse={};Object.defineProperty(thenElse,"__esModule",{value:!0});const util_1$1=util,def$3={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:xt,parentSchema:$t,it:Ct}){$t.if===void 0&&(0,util_1$1.checkStrictMode)(Ct,`"${xt}" without "if" is ignored`)}};thenElse.default=def$3;Object.defineProperty(applicator,"__esModule",{value:!0});const additionalItems_1=additionalItems,prefixItems_1=prefixItems,items_1=items,items2020_1=items2020,contains_1=contains$2,dependencies_1=dependencies$2,propertyNames_1=propertyNames,additionalProperties_1=additionalProperties,properties_1=properties$1,patternProperties_1=patternProperties,not_1=not,anyOf_1=anyOf,oneOf_1=oneOf,allOf_1=allOf,if_1=_if,thenElse_1=thenElse;function getApplicator(xt=!1){const $t=[not_1.default,anyOf_1.default,oneOf_1.default,allOf_1.default,if_1.default,thenElse_1.default,propertyNames_1.default,additionalProperties_1.default,dependencies_1.default,properties_1.default,patternProperties_1.default];return xt?$t.push(prefixItems_1.default,items2020_1.default):$t.push(additionalItems_1.default,items_1.default),$t.push(contains_1.default),$t}applicator.default=getApplicator;var format$5={},format$4={};Object.defineProperty(format$4,"__esModule",{value:!0});const codegen_1$1=codegen$1,error$2={message:({schemaCode:xt})=>(0,codegen_1$1.str)`must match format "${xt}"`,params:({schemaCode:xt})=>(0,codegen_1$1._)`{format: ${xt}}`},def$2={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:error$2,code(xt,$t){const{gen:Ct,data:kt,$data:Mt,schema:Ft,schemaCode:jt,it:Bt}=xt,{opts:Vt,errSchemaPath:zt,schemaEnv:Ht,self:Gt}=Bt;if(!Vt.validateFormats)return;Mt?qt():Wt();function qt(){const Yt=Ct.scopeValue("formats",{ref:Gt.formats,code:Vt.code.formats}),Kt=Ct.const("fDef",(0,codegen_1$1._)`${Yt}[${jt}]`),Xt=Ct.let("fType"),Qt=Ct.let("format");Ct.if((0,codegen_1$1._)`typeof ${Kt} == "object" && !(${Kt} instanceof RegExp)`,()=>Ct.assign(Xt,(0,codegen_1$1._)`${Kt}.type || "string"`).assign(Qt,(0,codegen_1$1._)`${Kt}.validate`),()=>Ct.assign(Xt,(0,codegen_1$1._)`"string"`).assign(Qt,Kt)),xt.fail$data((0,codegen_1$1.or)(Jt(),Zt()));function Jt(){return Vt.strictSchema===!1?codegen_1$1.nil:(0,codegen_1$1._)`${jt} && !${Qt}`}function Zt(){const sn=Ht.$async?(0,codegen_1$1._)`(${Kt}.async ? await ${Qt}(${kt}) : ${Qt}(${kt}))`:(0,codegen_1$1._)`${Qt}(${kt})`,ln=(0,codegen_1$1._)`(typeof ${Qt} == "function" ? ${sn} : ${Qt}.test(${kt}))`;return(0,codegen_1$1._)`${Qt} && ${Qt} !== true && ${Xt} === ${$t} && !${ln}`}}function Wt(){const Yt=Gt.formats[Ft];if(!Yt){Jt();return}if(Yt===!0)return;const[Kt,Xt,Qt]=Zt(Yt);Kt===$t&&xt.pass(sn());function Jt(){if(Vt.strictSchema===!1){Gt.logger.warn(ln());return}throw new Error(ln());function ln(){return`unknown format "${Ft}" ignored in schema at path "${zt}"`}}function Zt(ln){const dn=ln instanceof RegExp?(0,codegen_1$1.regexpCode)(ln):Vt.code.formats?(0,codegen_1$1._)`${Vt.code.formats}${(0,codegen_1$1.getProperty)(Ft)}`:void 0,hn=Ct.scopeValue("formats",{key:Ft,ref:ln,code:dn});return typeof ln=="object"&&!(ln instanceof RegExp)?[ln.type||"string",ln.validate,(0,codegen_1$1._)`${hn}.validate`]:["string",ln,hn]}function sn(){if(typeof Yt=="object"&&!(Yt instanceof RegExp)&&Yt.async){if(!Ht.$async)throw new Error("async format in sync schema");return(0,codegen_1$1._)`await ${Qt}(${kt})`}return typeof Xt=="function"?(0,codegen_1$1._)`${Qt}(${kt})`:(0,codegen_1$1._)`${Qt}.test(${kt})`}}}};format$4.default=def$2;Object.defineProperty(format$5,"__esModule",{value:!0});const format_1$1=format$4,format$3=[format_1$1.default];format$5.default=format$3;var metadata$1={};Object.defineProperty(metadata$1,"__esModule",{value:!0});metadata$1.contentVocabulary=metadata$1.metadataVocabulary=void 0;metadata$1.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];metadata$1.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(draft7,"__esModule",{value:!0});const core_1=core$2,validation_1=validation$1,applicator_1=applicator,format_1=format$5,metadata_1=metadata$1,draft7Vocabularies=[core_1.default,validation_1.default,(0,applicator_1.default)(),format_1.default,metadata_1.metadataVocabulary,metadata_1.contentVocabulary];draft7.default=draft7Vocabularies;var discriminator={},types$2={};Object.defineProperty(types$2,"__esModule",{value:!0});types$2.DiscrError=void 0;var DiscrError;(function(xt){xt.Tag="tag",xt.Mapping="mapping"})(DiscrError||(types$2.DiscrError=DiscrError={}));Object.defineProperty(discriminator,"__esModule",{value:!0});const codegen_1=codegen$1,types_1=types$2,compile_1=compile$1,ref_error_1=ref_error,util_1=util,error$1={message:({params:{discrError:xt,tagName:$t}})=>xt===types_1.DiscrError.Tag?`tag "${$t}" must be string`:`value of tag "${$t}" must be in oneOf`,params:({params:{discrError:xt,tag:$t,tagName:Ct}})=>(0,codegen_1._)`{error: ${xt}, tag: ${Ct}, tagValue: ${$t}}`},def$1={keyword:"discriminator",type:"object",schemaType:"object",error:error$1,code(xt){const{gen:$t,data:Ct,schema:kt,parentSchema:Mt,it:Ft}=xt,{oneOf:jt}=Mt;if(!Ft.opts.discriminator)throw new Error("discriminator: requires discriminator option");const Bt=kt.propertyName;if(typeof Bt!="string")throw new Error("discriminator: requires propertyName");if(kt.mapping)throw new Error("discriminator: mapping is not supported");if(!jt)throw new Error("discriminator: requires oneOf keyword");const Vt=$t.let("valid",!1),zt=$t.const("tag",(0,codegen_1._)`${Ct}${(0,codegen_1.getProperty)(Bt)}`);$t.if((0,codegen_1._)`typeof ${zt} == "string"`,()=>Ht(),()=>xt.error(!1,{discrError:types_1.DiscrError.Tag,tag:zt,tagName:Bt})),xt.ok(Vt);function Ht(){const Wt=qt();$t.if(!1);for(const Yt in Wt)$t.elseIf((0,codegen_1._)`${zt} === ${Yt}`),$t.assign(Vt,Gt(Wt[Yt]));$t.else(),xt.error(!1,{discrError:types_1.DiscrError.Mapping,tag:zt,tagName:Bt}),$t.endIf()}function Gt(Wt){const Yt=$t.name("valid"),Kt=xt.subschema({keyword:"oneOf",schemaProp:Wt},Yt);return xt.mergeEvaluated(Kt,codegen_1.Name),Yt}function qt(){var Wt;const Yt={},Kt=Qt(Mt);let Xt=!0;for(let sn=0;sn<jt.length;sn++){let ln=jt[sn];if(ln!=null&&ln.$ref&&!(0,util_1.schemaHasRulesButRef)(ln,Ft.self.RULES)){const hn=ln.$ref;if(ln=compile_1.resolveRef.call(Ft.self,Ft.schemaEnv.root,Ft.baseId,hn),ln instanceof compile_1.SchemaEnv&&(ln=ln.schema),ln===void 0)throw new ref_error_1.default(Ft.opts.uriResolver,Ft.baseId,hn)}const dn=(Wt=ln==null?void 0:ln.properties)===null||Wt===void 0?void 0:Wt[Bt];if(typeof dn!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${Bt}"`);Xt=Xt&&(Kt||Qt(ln)),Jt(dn,sn)}if(!Xt)throw new Error(`discriminator: "${Bt}" must be required`);return Yt;function Qt({required:sn}){return Array.isArray(sn)&&sn.includes(Bt)}function Jt(sn,ln){if(sn.const)Zt(sn.const,ln);else if(sn.enum)for(const dn of sn.enum)Zt(dn,ln);else throw new Error(`discriminator: "properties/${Bt}" must have "const" or "enum"`)}function Zt(sn,ln){if(typeof sn!="string"||sn in Yt)throw new Error(`discriminator: "${Bt}" values must be unique strings`);Yt[sn]=ln}}}};discriminator.default=def$1;const $schema$2="http://json-schema.org/draft-07/schema#",$id="http://json-schema.org/draft-07/schema#",title$1="Core schema meta-schema",definitions$2={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type$2=["object","boolean"],properties={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},require$$3={$schema:$schema$2,$id,title:title$1,definitions:definitions$2,type:type$2,properties,default:!0};(function(xt,$t){Object.defineProperty($t,"__esModule",{value:!0}),$t.MissingRefError=$t.ValidationError=$t.CodeGen=$t.Name=$t.nil=$t.stringify=$t.str=$t._=$t.KeywordCxt=$t.Ajv=void 0;const Ct=core$3,kt=draft7,Mt=discriminator,Ft=require$$3,jt=["/properties"],Bt="http://json-schema.org/draft-07/schema";class Vt extends Ct.default{_addVocabularies(){super._addVocabularies(),kt.default.forEach(Yt=>this.addVocabulary(Yt)),this.opts.discriminator&&this.addKeyword(Mt.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const Yt=this.opts.$data?this.$dataMetaSchema(Ft,jt):Ft;this.addMetaSchema(Yt,Bt,!1),this.refs["http://json-schema.org/schema"]=Bt}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(Bt)?Bt:void 0)}}$t.Ajv=Vt,xt.exports=$t=Vt,xt.exports.Ajv=Vt,Object.defineProperty($t,"__esModule",{value:!0}),$t.default=Vt;var zt=validate$1;Object.defineProperty($t,"KeywordCxt",{enumerable:!0,get:function(){return zt.KeywordCxt}});var Ht=codegen$1;Object.defineProperty($t,"_",{enumerable:!0,get:function(){return Ht._}}),Object.defineProperty($t,"str",{enumerable:!0,get:function(){return Ht.str}}),Object.defineProperty($t,"stringify",{enumerable:!0,get:function(){return Ht.stringify}}),Object.defineProperty($t,"nil",{enumerable:!0,get:function(){return Ht.nil}}),Object.defineProperty($t,"Name",{enumerable:!0,get:function(){return Ht.Name}}),Object.defineProperty($t,"CodeGen",{enumerable:!0,get:function(){return Ht.CodeGen}});var Gt=validation_error;Object.defineProperty($t,"ValidationError",{enumerable:!0,get:function(){return Gt.default}});var qt=ref_error;Object.defineProperty($t,"MissingRefError",{enumerable:!0,get:function(){return qt.default}})})(ajv,ajv.exports);var ajvExports=ajv.exports;const Ajv=getDefaultExportFromCjs$1(ajvExports),$ref$1="#/definitions/StudyConfig",$schema$1="http://json-schema.org/draft-07/schema#",definitions$1={Answer:{additionalProperties:!1,description:`The Answer interface is used to define the properties of an answer. Answers are used to define the correct answer for a task. These are generally used in training tasks or if skip logic is required based on the answer.

Answers are used to defined correct answers for a task. These are generally used in training tasks or if skip logic is required based on the answer. The answer field is used to define the correct answer to the question. The acceptableLow and acceptableHigh fields are used to define a range of acceptable answers (these are currently only used for training). For example, if the correct answer is 5, and the acceptableLow is 4 and the acceptableHigh is 6, then any answer between 4 and 6 will be considered correct.

Here's an example of how to use the Answer interface to define the correct answer to a question:

\`\`\`js { "type": "markdown", "path": "<study-name>/assets/question.md", "response": [  {    "id": "response1",    "prompt": "What is 2 + 2?",    "required": true,    "location": "belowStimulus",    "type": "numerical"  } ] "correctAnswer": [{  "id": "response1",  "answer": 4 }] } \`\`\`

In this example, the correct answer to the question "What is 2 + 2?" is 4. If the participant answers 4, they will be considered correct. If they answer anything other than 4, they will be considered incorrect.`,properties:{acceptableHigh:{description:"The acceptable high value for the answer. This is used to define a range of acceptable answers.",type:"number"},acceptableLow:{description:"The acceptable low value for the answer. This is used to define a range of acceptable answers.",type:"number"},answer:{description:"The correct answer to the question."},id:{description:"The id of the answer. This is used to identify the answer in the data file.",type:"string"}},required:["id","answer"],type:"object"},BaseComponents:{additionalProperties:{additionalProperties:!1,properties:{correctAnswer:{description:"The correct answer to the component. This is used for training trials where the user is shown the correct answer after a guess.",items:{$ref:"#/definitions/Answer"},type:"array"},description:{description:"The description of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instruction:{description:"The instruction of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instructionLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the instructions."},meta:{additionalProperties:{},description:"The meta data for the component. This is used to identify and provide additional information for the component in the admin panel.",type:"object"},nextButtonLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the next button."},nextButtonText:{description:"The text that is displayed on the next button.",type:"string"},parameters:{anyOf:[{additionalProperties:{},description:"The parameters that are passed to the react component. These can be used within your react component to render different things.",type:"object"},{additionalProperties:{},description:"The parameters that are passed to the website (iframe). These can be used within your website to render different things.",type:"object"}],description:"The parameters that are passed to the react component. These can be used within your react component to render different things."},path:{anyOf:[{description:"The path to the markdown file. This should be a relative path from the public folder.",type:"string"},{description:"The path to the react component. This should be a relative path from the src/public folder.",type:"string"},{description:"The path to the image. This should be a relative path from the public folder.",type:"string"},{description:"The path to the website. This should be a relative path from the public folder or could be an external website.",type:"string"}],description:"The path to the markdown file. This should be a relative path from the public folder."},provideFeedback:{description:"Controls whether the component should provide feedback to the participant, such as in a training trial. If not provided, the default is false.",type:"boolean"},response:{description:"The responses to the component",items:{$ref:"#/definitions/Response"},type:"array"},style:{additionalProperties:{type:"string"},description:"The style of the image. This is an object with css properties as keys and css values as values.",type:"object"},type:{enum:["markdown","react-component","image","website","questionnaire"],type:"string"}},type:"object"},description:'The baseComponents is an optional set of components which can help template other components. For example, suppose you have a single HTML file that you want to display to the user several times. Instead of having the same component twice in the `components` list, you can have a single baseComponent with all the information that the two HTML components will share. A great example is showing the same HTML component but with two different questions;\n\n Using baseComponents:\n\n```js "baseComponents": { "my-image-component": { "instructionLocation": "sidebar", "nextButtonLocation": "sidebar", "path": "<study-name>/assets/my-image.jpg", "response": [   {     "id": "my-image-id",     "options": [       {         "label": "Europe",         "value": "Europe"       },       {         "label": "Japan",         "value": "Japan"       },       {         "label": "USA",         "value": "USA"       }     ],     "prompt": "Your Selected Answer:",     "type": "dropdown"   } ], "type": "image" } } ``` In the above code snippet, we have a single base component which holds the information about the type of component, the path to the image, and the response (which is a dropdown containing three choices). Any component which contains the `"baseComponent":"my-image-component"` key-value pair will inherit each of these properties. Thus, if we have three different questions which have the same choices and are concerning the same image, we can define our components like below: ```js "components": { "q1": { "baseComponent": "my-image-component", "description": "Choosing section with largest GDP", "instruction": "Which region has the largest GDP?" }, "q2": { "baseComponent": "my-image-component", "description": "Choosing section with lowest GDP", "instruction": "Which region has the lowest GDP?" }, "q3": { "baseComponent": "my-image-component", "description": "Choosing section with highest exports of Wheat", "instruction": "Which region had the most Wheat exported in 2022?" } } ```',type:"object"},CheckboxResponse:{additionalProperties:!1,description:'The CheckboxResponse interface is used to define the properties of a checkbox response. CheckboxResponses render as a checkbox input with user specified options.\n\n```js { "id": "q7", "prompt": "Checkbox example (not required)", "required": false, "location": "aboveStimulus", "type": "checkbox", "options": [  {    "label": "Option 1",    "value": "opt-1"  },  {    "label": "Option 2",    "value": "opt-2"  },  {    "label": "Option 3",    "value": "opt-3"  } ] } ```',properties:{hidden:{description:"Controls whether the response is hidden.",type:"boolean"},id:{description:"The id of the response. This is used to identify the response in the data file.",type:"string"},location:{$ref:"#/definitions/ResponseBlockLocation",description:"Controls the response location. These might be the same for all responses, or differ across responses. Defaults to `belowStimulus`"},options:{description:"The options that are displayed as checkboxes, provided as an array of objects, with label and value fields.",items:{$ref:"#/definitions/StringOption"},type:"array"},paramCapture:{description:"Use to capture querystring parameters in answers such as participant_name. See the examples for how this is used, but prefer uiConfig.urlParticipantIdParam if you are capturing a participant ID.",type:"string"},prompt:{description:"The prompt that is displayed to the participant. You can use markdown here to render images, links, etc.",type:"string"},required:{description:"Controls whether the response is required to be answered.",type:"boolean"},requiredLabel:{description:"You can provide a required label, which makes it so a participant has to answer with a response that matches label.",type:"string"},requiredValue:{description:"You can provide a required value, which makes it so a participant has to answer with that value."},secondaryText:{description:"The secondary text that is displayed to the participant under the prompt. This does not accept markdown.",type:"string"},type:{const:"checkbox",type:"string"}},required:["id","options","prompt","required","type"],type:"object"},ComponentBlock:{additionalProperties:!1,description:'The ComponentBlock interface is used to define order properties within the sequence. This is used to define the order of components in a study and the skip logic. It supports random assignment of trials using a pure random assignment and a [latin square](https://en.wikipedia.org/wiki/Latin_square).\n\nThe pure random assignment is a random assignment with no guarantees. For example, one component _could_ show up in the first position 10 times in a row. However, this situation is unlikely.\n\nHere\'s a snippet that shows how to use the random order:\n\n```js { "order": "random", "components": [ "component1", "component2", "component3" ] } ``` This snippet would produce a random order of the components in the sequence array. For example, the resulting sequence array could be :\n\n```js [ ["component2", "component3", "component1"], ["component1", "component3", "component2"], ["component3", "component1", "component2"], ... ] ```\n\nThe latin square assignment is a random assignment with some guarantees. It ensures that each component is shown an equal number of times in each position. Here\'s a snippet that shows how to use the latin square order:\n\n```js { "order": "latinSquare", "components": [ "component1", "component2", "component3" ] } ```\n\nThis snippet would produce a latin square order of the components in the sequence array. Since the latin square guarantees that each component is shown an equal number of times in each position, the resulting sequence array could be:\n\n```js [ ["component1", "component2", "component3"], ["component2", "component3", "component1"], ["component3", "component1", "component2"], ... ] ```\n\nThe fixed assignment is a fixed assignment of components. This is used when you want to show the components in a specific order. Here\'s a snippet that shows how to use the fixed order:\n\n```js { "order": "fixed", "components": [ "component1", "component2", "component3" ] } ```\n\nThis snippet would produce a fixed order of the components in the sequence array. The resulting sequence array would be:\n\n```js [ ["component1", "component2", "component3"], ["component1", "component2", "component3"], ["component1", "component2", "component3"], ... ] ```\n\nIn addition to the order property, the ComponentBlock interface also includes the `"numSamples"` property. This is used to reduce the number of components shown to a participant. This property respects the order property and the guarantees provided by the order property. For example, if you have three components in the components array and you set `"numSamples"` to 2, you would randomize across the three components while only showing a participant two of them. Here\'s a snippet that shows how to use the numSamples property:\n\n```js { "order": "latinSquare", "components": [ "component1", "component2", "component3" ], "numSamples": 2 } ```\n\nThis snippet would produce a latin square order of the components in the sequence array. Since the latin square guarantees that each component is shown an equal number of times in each position, the resulting sequence array could be:\n\n```js [ ["component1", "component2"], ["component2", "component3"], ["component3", "component1"], ... ] ```\n\nThe interruptions property specifies an array of interruptions. These can be used for breaks or attention checks. Interruptions can be deterministic or random. Please see [InterruptionBlock](../../type-aliases/InterruptionBlock) for more specific information.\n\nThe skip property is used to define skip conditions. This is used to skip to a different component or block based on the response to a component or the number of correct or incorrect responses in a block. Please see [SkipConditions](../../type-aliases/SkipConditions) for more specific information.',properties:{components:{description:"The components that are included in the order.",items:{anyOf:[{type:"string"},{$ref:"#/definitions/ComponentBlock"}]},type:"array"},id:{description:"The id of the block. This is used to identify the block in the SkipConditions and is only required if you want to refer to the whole block in the condition.to property.",type:"string"},interruptions:{description:"The interruptions property specifies an array of interruptions. These can be used for breaks or attention checks.",items:{$ref:"#/definitions/InterruptionBlock"},type:"array"},numSamples:{description:"The number of samples to use for the random assignments. This means you can randomize across 3 components while only showing a participant 2 at a time.",type:"number"},order:{description:"The type of order. This can be random (pure random), latinSquare (random with some guarantees), or fixed.",enum:["random","latinSquare","fixed"],type:"string"},skip:{$ref:"#/definitions/SkipConditions",description:"The skip conditions for the block."}},required:["order","components"],type:"object"},ComponentBlockCondition:{additionalProperties:!1,description:`The ComponentBlockCondition interface is used to define a SkipCondition based on the number of correct or incorrect components in a block. All answers on all components in the block are checked.

Answers are checked against the correct answers defined in the IndividualComponent's [CorrectAnswer](../Answer). If no correct answers are defined, the component is considered correct by default.

You might use this if a participant answers two questions in a block incorrectly. Here's an example of how to use the ComponentBlockCondition:

\`\`\`js { ... "skip": [ {   "check": "block",   "condition": "numIncorrect",   "value": 2,   "to": "end" } ] ... } \`\`\`

In this example, when the number of components with incorrect responses in the block is two, the participant will be redirected to the end of the study. If the number of incorrect responses is less than two, the participant will continue to the next component in the sequence.

When the condition is met, the participant will immediately be redirected to the component or block specified in the \`"to"\` property. If no conditions are met, the participant will continue to the next component in the sequence.`,properties:{check:{const:"block",description:"The check we'll perform.",type:"string"},condition:{description:"The condition to check.",enum:["numCorrect","numIncorrect"],type:"string"},to:{description:"The id of the component or block to skip to",type:"string"},value:{description:"The number of correct or incorrect responses to check for.",type:"number"}},required:["check","condition","value","to"],type:"object"},DeterministicInterruption:{additionalProperties:!1,description:`The DeterministicInterruption interface is used to define an interruption that will be shown at a specific location in the block.

For example, if you want to show an interruption after the second component in the block, you would set firstLocation to 2. If you want to show an interruption after every 3 components, you would set spacing to 3. If you want to show an interruption after the second component and then every 3 components, you would set firstLocation to 2 and spacing to 3.

The components property is an array of the components that will be inserted at the location specified by firstLocation and spacing. These components should reference components in the StudyConfig.components section of the config.

Here's an example of how to use the DeterministicInterruption:

\`\`\`js { "order": "fixed", "components": [ "component1", "component2", "component3", "component4", "component5", "component6" ], "interruptions": [ {   "firstLocation": 2,   "spacing": 3,   "components": [     "interruption1",     "interruption2"   ] } ] } \`\`\`

The resulting sequence array could be:

\`\`\`js [ ["component1", "component2", "interruption1", "component3", "component4", "component5", "interruption2", "component6"], ["component1", "component2", "interruption1", "component3", "component4", "component5", "interruption2", "component6"], ["component1", "component2", "interruption1", "component3", "component4", "component5", "interruption2", "component6"], ... ] \`\`\``,properties:{components:{description:"The components that are included in the interruption. These reference components in the StudyConfig.components section of the config.",items:{type:"string"},type:"array"},firstLocation:{description:"The Location of the first instance of the interruption. If this is set to 2, the interruption will be shown after the second component (inserted at index 2).",type:"number"},spacing:{description:"The number of components between breaks.",type:"number"}},required:["firstLocation","spacing","components"],type:"object"},DropdownResponse:{additionalProperties:!1,description:'The DropdownResponse interface is used to define the properties of a dropdown response. DropdownResponses render as a select input with user specified options.\n\nExample: ```js { "id": "q-color", "prompt": "What is your favorite color?", "required": true, "location": "aboveStimulus", "type": "dropdown", "placeholder": "Please choose your favorite color", "options": [  {    "label": "Red",    "value": "red"  },  {    "label": "Blue",    "value": "blue"  } ] } ```',properties:{hidden:{description:"Controls whether the response is hidden.",type:"boolean"},id:{description:"The id of the response. This is used to identify the response in the data file.",type:"string"},location:{$ref:"#/definitions/ResponseBlockLocation",description:"Controls the response location. These might be the same for all responses, or differ across responses. Defaults to `belowStimulus`"},options:{description:"The options that are displayed in the dropdown.",items:{$ref:"#/definitions/StringOption"},type:"array"},paramCapture:{description:"Use to capture querystring parameters in answers such as participant_name. See the examples for how this is used, but prefer uiConfig.urlParticipantIdParam if you are capturing a participant ID.",type:"string"},placeholder:{description:"The placeholder text that is displayed in the input.",type:"string"},prompt:{description:"The prompt that is displayed to the participant. You can use markdown here to render images, links, etc.",type:"string"},required:{description:"Controls whether the response is required to be answered.",type:"boolean"},requiredLabel:{description:"You can provide a required label, which makes it so a participant has to answer with a response that matches label.",type:"string"},requiredValue:{description:"You can provide a required value, which makes it so a participant has to answer with that value."},secondaryText:{description:"The secondary text that is displayed to the participant under the prompt. This does not accept markdown.",type:"string"},type:{const:"dropdown",type:"string"}},required:["id","options","prompt","required","type"],type:"object"},IFrameResponse:{additionalProperties:!1,description:"The IFrameResponse interface is used to define the properties of an iframe response. IFrameResponses render as a list, that is connected to a WebsiteComponent. When data is sent from the WebsiteComponent, it is displayed in the list.",properties:{hidden:{description:"Controls whether the response is hidden.",type:"boolean"},id:{description:"The id of the response. This is used to identify the response in the data file.",type:"string"},location:{$ref:"#/definitions/ResponseBlockLocation",description:"Controls the response location. These might be the same for all responses, or differ across responses. Defaults to `belowStimulus`"},paramCapture:{description:"Use to capture querystring parameters in answers such as participant_name. See the examples for how this is used, but prefer uiConfig.urlParticipantIdParam if you are capturing a participant ID.",type:"string"},prompt:{description:"The prompt that is displayed to the participant. You can use markdown here to render images, links, etc.",type:"string"},required:{description:"Controls whether the response is required to be answered.",type:"boolean"},requiredLabel:{description:"You can provide a required label, which makes it so a participant has to answer with a response that matches label.",type:"string"},requiredValue:{description:"You can provide a required value, which makes it so a participant has to answer with that value."},secondaryText:{description:"The secondary text that is displayed to the participant under the prompt. This does not accept markdown.",type:"string"},type:{const:"iframe",type:"string"}},required:["id","prompt","required","type"],type:"object"},ImageComponent:{additionalProperties:!1,description:'The ImageComponent interface is used to define the properties of an image component. This component is used to render an image with optional styling.\n\nFor example, to render an image with a path of `path/to/study/assets/image.jpg` and a max width of 50%, you would use the following snippet: ```js { "type": "image", "path": "<study-name>/assets/image.jpg", "style": { "maxWidth": "50%" } } ```',properties:{correctAnswer:{description:"The correct answer to the component. This is used for training trials where the user is shown the correct answer after a guess.",items:{$ref:"#/definitions/Answer"},type:"array"},description:{description:"The description of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instruction:{description:"The instruction of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instructionLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the instructions."},meta:{additionalProperties:{},description:"The meta data for the component. This is used to identify and provide additional information for the component in the admin panel.",type:"object"},nextButtonLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the next button."},nextButtonText:{description:"The text that is displayed on the next button.",type:"string"},path:{description:"The path to the image. This should be a relative path from the public folder.",type:"string"},provideFeedback:{description:"Controls whether the component should provide feedback to the participant, such as in a training trial. If not provided, the default is false.",type:"boolean"},response:{description:"The responses to the component",items:{$ref:"#/definitions/Response"},type:"array"},style:{additionalProperties:{type:"string"},description:"The style of the image. This is an object with css properties as keys and css values as values.",type:"object"},type:{const:"image",type:"string"}},required:["path","response","type"],type:"object"},IndividualComponent:{anyOf:[{$ref:"#/definitions/MarkdownComponent"},{$ref:"#/definitions/ReactComponent"},{$ref:"#/definitions/ImageComponent"},{$ref:"#/definitions/WebsiteComponent"},{$ref:"#/definitions/QuestionnaireComponent"}]},IndividualComponentAllResponsesCondition:{additionalProperties:!1,description:`The IndividualComponentAllResponsesCondition interface is used to define a SkipCondition based on all answers to a specific component. The skip logic will be checked for every component in the block that has the specified name.

:::info

If you need to check all instances of a repeated component, you should use the RepeatedComponentBlockCondition.

:::


Here's an example of how to use the IndividualComponentAllResponsesCondition:

\`\`\`js { ... "skip": [ {   "name": "attentionCheck",   "check": "responses",   "to": "end" } ] ... } \`\`\`

In this example, if all responses to the component with the ID "attentionCheck" are correct, the participant will be redirected to the end of the study. If any response is incorrect, the participant will continue to the next component in the sequence.`,properties:{check:{const:"responses",description:"The check we'll perform.",type:"string"},name:{description:"The name of the component to check.",type:"string"},to:{description:"The id of the component or block to skip to",type:"string"}},required:["name","check","to"],type:"object"},IndividualComponentSingleResponseCondition:{additionalProperties:!1,description:`The IndividualComponentSingleResponseCondition interface is used to define a SkipCondition based on a single answer to a specific component. The skip logic will be checked for every component in the block that has the specified name.

:::info

If you need to check all instances of a repeated component, you should use the RepeatedComponentBlockCondition.

:::

For example, if you want to skip to a different component based on a response to a specific component, you would use the IndividualComponentSingleResponseCondition. Here's an example of how to use the IndividualComponentSingleResponseCondition:

\`\`\`js { ... "skip": [ {   "name": "attentionCheck",   "check": "response",   "responseId": "attentionCheckResponse",   "value": "the right answer",   "to": "end" } ] ... } \`\`\`

In this example, we assign our skip logic to the component whose ID is "attentionCheck". If the answer given to the response "attentionCheckResponse" is equal to "the right answer", then the user will be redirected to the end of the study. If the response is _not_ equal to "the right answer", then the participant will continue to the next component in the sequence.`,properties:{check:{const:"response",description:"The check we'll perform.",type:"string"},name:{description:"The name of the component to check.",type:"string"},responseId:{description:"The response id to check.",type:"string"},to:{description:"The id of the component or block to skip to",type:"string"},value:{description:"The value to check.",type:["string","number"]}},required:["name","check","responseId","value","to"],type:"object"},InheritedComponent:{additionalProperties:!1,description:"An InheritedComponent is a component that inherits properties from a baseComponent. This is used to avoid repeating properties in components. This also means that components in the baseComponents object can be partially defined, while components in the components object can inherit from them and must be fully defined and include all properties (after potentially merging with a base component).",properties:{baseComponent:{type:"string"},correctAnswer:{description:"The correct answer to the component. This is used for training trials where the user is shown the correct answer after a guess.",items:{$ref:"#/definitions/Answer"},type:"array"},description:{description:"The description of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instruction:{description:"The instruction of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instructionLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the instructions."},meta:{additionalProperties:{},description:"The meta data for the component. This is used to identify and provide additional information for the component in the admin panel.",type:"object"},nextButtonLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the next button."},nextButtonText:{description:"The text that is displayed on the next button.",type:"string"},parameters:{anyOf:[{additionalProperties:{},description:"The parameters that are passed to the react component. These can be used within your react component to render different things.",type:"object"},{additionalProperties:{},description:"The parameters that are passed to the website (iframe). These can be used within your website to render different things.",type:"object"}],description:"The parameters that are passed to the react component. These can be used within your react component to render different things."},path:{anyOf:[{description:"The path to the markdown file. This should be a relative path from the public folder.",type:"string"},{description:"The path to the react component. This should be a relative path from the src/public folder.",type:"string"},{description:"The path to the image. This should be a relative path from the public folder.",type:"string"},{description:"The path to the website. This should be a relative path from the public folder or could be an external website.",type:"string"}],description:"The path to the markdown file. This should be a relative path from the public folder."},provideFeedback:{description:"Controls whether the component should provide feedback to the participant, such as in a training trial. If not provided, the default is false.",type:"boolean"},response:{description:"The responses to the component",items:{$ref:"#/definitions/Response"},type:"array"},style:{additionalProperties:{type:"string"},description:"The style of the image. This is an object with css properties as keys and css values as values.",type:"object"},type:{enum:["markdown","react-component","image","website","questionnaire"],type:"string"}},required:["baseComponent"],type:"object"},InterruptionBlock:{anyOf:[{$ref:"#/definitions/DeterministicInterruption"},{$ref:"#/definitions/RandomInterruption"}],description:"The InterruptionBlock interface is used to define interruptions in a block. These can be used for breaks or attention checks. Interruptions can be deterministic or random."},LikertResponse:{additionalProperties:!1,description:`The LikertResponse interface is used to define the properties of a likert response. LikertResponses render as radio buttons with a user specified number of options, which can be controlled through the numItems. For example, numItems: 5 will render 5 radio buttons, and numItems: 7 will render 7 radio buttons. LikertResponses can also have a description, and left and right labels. The left and right labels are used to label the left and right ends of the likert scale with values such as 'Strongly Disagree' and 'Strongly Agree'.

Example for a five-point Likert Scale:

\`\`\`js { "id": "q-satisfaction", "prompt": "Rate your satisfaction from 1 (not enjoyable) to 5 (very enjoyable).", "required": true, "location": "aboveStimulus", "type": "likert", "leftLabel": "Not Enjoyable", "rightLabel": "Very Enjoyable", "numItems": 5 } \`\`\``,properties:{desc:{description:"The description of the likert scale.",type:"string"},hidden:{description:"Controls whether the response is hidden.",type:"boolean"},id:{description:"The id of the response. This is used to identify the response in the data file.",type:"string"},leftLabel:{description:"The left label of the likert scale. E.g Strongly Disagree",type:"string"},location:{$ref:"#/definitions/ResponseBlockLocation",description:"Controls the response location. These might be the same for all responses, or differ across responses. Defaults to `belowStimulus`"},numItems:{description:"The number of options to render.",type:"number"},paramCapture:{description:"Use to capture querystring parameters in answers such as participant_name. See the examples for how this is used, but prefer uiConfig.urlParticipantIdParam if you are capturing a participant ID.",type:"string"},prompt:{description:"The prompt that is displayed to the participant. You can use markdown here to render images, links, etc.",type:"string"},required:{description:"Controls whether the response is required to be answered.",type:"boolean"},requiredLabel:{description:"You can provide a required label, which makes it so a participant has to answer with a response that matches label.",type:"string"},requiredValue:{description:"You can provide a required value, which makes it so a participant has to answer with that value."},rightLabel:{description:"The right label of the likert scale. E.g Strongly Agree",type:"string"},secondaryText:{description:"The secondary text that is displayed to the participant under the prompt. This does not accept markdown.",type:"string"},type:{const:"likert",type:"string"}},required:["id","numItems","prompt","required","type"],type:"object"},LongTextResponse:{additionalProperties:!1,description:'The LongTextResponse interface is used to define the properties of a long text response. LongTextResponses render as a text area that accepts any text and can optionally have a placeholder. ```js { "id": "q-name", "prompt": "What is your first name?", "required": true, "location": "aboveStimulus", "type": "longText", "placeholder": "Please enter your first name" } ```',properties:{hidden:{description:"Controls whether the response is hidden.",type:"boolean"},id:{description:"The id of the response. This is used to identify the response in the data file.",type:"string"},location:{$ref:"#/definitions/ResponseBlockLocation",description:"Controls the response location. These might be the same for all responses, or differ across responses. Defaults to `belowStimulus`"},paramCapture:{description:"Use to capture querystring parameters in answers such as participant_name. See the examples for how this is used, but prefer uiConfig.urlParticipantIdParam if you are capturing a participant ID.",type:"string"},placeholder:{description:"The placeholder text that is displayed in the input.",type:"string"},prompt:{description:"The prompt that is displayed to the participant. You can use markdown here to render images, links, etc.",type:"string"},required:{description:"Controls whether the response is required to be answered.",type:"boolean"},requiredLabel:{description:"You can provide a required label, which makes it so a participant has to answer with a response that matches label.",type:"string"},requiredValue:{description:"You can provide a required value, which makes it so a participant has to answer with that value."},secondaryText:{description:"The secondary text that is displayed to the participant under the prompt. This does not accept markdown.",type:"string"},type:{const:"longText",type:"string"}},required:["id","prompt","required","type"],type:"object"},MarkdownComponent:{additionalProperties:!1,description:'The MarkdownComponent interface is used to define the properties of a markdown component. The components can be used to render many different things, such as consent forms, instructions, and debriefs. Additionally, you can use the markdown component to render images, videos, and other media, with supporting text. Markdown components can have responses (e.g. in a consent form), or no responses (e.g. in a help text file). Here\'s an example with no responses for a simple help text file:\n\n```js { "type": "markdown", "path": "<study-name>/assets/help.md", "response": [] } ```',properties:{correctAnswer:{description:"The correct answer to the component. This is used for training trials where the user is shown the correct answer after a guess.",items:{$ref:"#/definitions/Answer"},type:"array"},description:{description:"The description of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instruction:{description:"The instruction of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instructionLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the instructions."},meta:{additionalProperties:{},description:"The meta data for the component. This is used to identify and provide additional information for the component in the admin panel.",type:"object"},nextButtonLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the next button."},nextButtonText:{description:"The text that is displayed on the next button.",type:"string"},path:{description:"The path to the markdown file. This should be a relative path from the public folder.",type:"string"},provideFeedback:{description:"Controls whether the component should provide feedback to the participant, such as in a training trial. If not provided, the default is false.",type:"boolean"},response:{description:"The responses to the component",items:{$ref:"#/definitions/Response"},type:"array"},type:{const:"markdown",type:"string"}},required:["path","response","type"],type:"object"},NumberOption:{additionalProperties:!1,description:"The NumberOption interface is used to define the options for a slider response. The label is the text that is displayed to the user, and the value is the value that is stored in the data file.",properties:{label:{description:"The label displayed to participants.",type:"string"},value:{description:"The value stored in the participant's data.",type:"number"}},required:["label","value"],type:"object"},NumericalResponse:{additionalProperties:!1,description:'The NumericalResponse interface is used to define the properties of a numerical response. NumericalResponses render as a text input that only accepts numbers, and can optionally have a min and max value, or a placeholder.\n\nExample: ```js { "id": "q-numerical", "prompt": "Numerical example", "required": true, "location": "aboveStimulus", "type": "numerical", "placeholder": "Enter your age, range from 0 - 120", "max": 120, "min": 0 } ```',properties:{hidden:{description:"Controls whether the response is hidden.",type:"boolean"},id:{description:"The id of the response. This is used to identify the response in the data file.",type:"string"},location:{$ref:"#/definitions/ResponseBlockLocation",description:"Controls the response location. These might be the same for all responses, or differ across responses. Defaults to `belowStimulus`"},max:{description:"The maximum value that is accepted in the input.",type:"number"},min:{description:"The minimum value that is accepted in the input.",type:"number"},paramCapture:{description:"Use to capture querystring parameters in answers such as participant_name. See the examples for how this is used, but prefer uiConfig.urlParticipantIdParam if you are capturing a participant ID.",type:"string"},placeholder:{description:"The placeholder text that is displayed in the input.",type:"string"},prompt:{description:"The prompt that is displayed to the participant. You can use markdown here to render images, links, etc.",type:"string"},required:{description:"Controls whether the response is required to be answered.",type:"boolean"},requiredLabel:{description:"You can provide a required label, which makes it so a participant has to answer with a response that matches label.",type:"string"},requiredValue:{description:"You can provide a required value, which makes it so a participant has to answer with that value."},secondaryText:{description:"The secondary text that is displayed to the participant under the prompt. This does not accept markdown.",type:"string"},type:{const:"numerical",type:"string"}},required:["id","prompt","required","type"],type:"object"},QuestionnaireComponent:{additionalProperties:!1,description:'A QuestionnaireComponent is used to render simple questions that require a response. The main use case of this component type is to ask participants questions when you don\'t need to render a stimulus. Please note, that even though we\'re not using a stimulus, the responses still require a `location`. For example this could be used to collect demographic information from a participant using the following snippet:\n\n```js { "type": "questionnaire", "response": [  {    "id": "gender",    "prompt": "Gender:",    "required": true,    "location": "belowStimulus",    "type": "checkbox",    "options": [      {        "label": "Man",        "value": "Man"      },      {        "label": "Woman",        "value": "Woman"      },      {        "label": "Genderqueer",        "value": "Genderqueer"      },      {        "label": "Third-gender",        "value": "Third-gender"      },      ... etc.    ]  } ] } ```',properties:{correctAnswer:{description:"The correct answer to the component. This is used for training trials where the user is shown the correct answer after a guess.",items:{$ref:"#/definitions/Answer"},type:"array"},description:{description:"The description of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instruction:{description:"The instruction of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instructionLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the instructions."},meta:{additionalProperties:{},description:"The meta data for the component. This is used to identify and provide additional information for the component in the admin panel.",type:"object"},nextButtonLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the next button."},nextButtonText:{description:"The text that is displayed on the next button.",type:"string"},provideFeedback:{description:"Controls whether the component should provide feedback to the participant, such as in a training trial. If not provided, the default is false.",type:"boolean"},response:{description:"The responses to the component",items:{$ref:"#/definitions/Response"},type:"array"},type:{const:"questionnaire",type:"string"}},required:["response","type"],type:"object"},RadioResponse:{additionalProperties:!1,description:'The RadioResponse interface is used to define the properties of a radio response. Radios have only one allowable selection. RadioResponses render as a radio input with user specified options, and optionally left and right labels.\n\nExample: ```js { "id": "q-radio", "prompt": "Radio button example", "required": true, "location": "aboveStimulus", "type": "radio", "options": [  {    "label": "Option 1",    "value": "opt-1"  },  {    "label": "Option 2",    "value": "opt-2"  } ] } ```',properties:{hidden:{description:"Controls whether the response is hidden.",type:"boolean"},id:{description:"The id of the response. This is used to identify the response in the data file.",type:"string"},leftLabel:{description:"The left label of the radio group. Used in Likert scales for example",type:"string"},location:{$ref:"#/definitions/ResponseBlockLocation",description:"Controls the response location. These might be the same for all responses, or differ across responses. Defaults to `belowStimulus`"},options:{description:"The options that are displayed as checkboxes, provided as an array of objects, with label and value fields.",items:{$ref:"#/definitions/StringOption"},type:"array"},paramCapture:{description:"Use to capture querystring parameters in answers such as participant_name. See the examples for how this is used, but prefer uiConfig.urlParticipantIdParam if you are capturing a participant ID.",type:"string"},prompt:{description:"The prompt that is displayed to the participant. You can use markdown here to render images, links, etc.",type:"string"},required:{description:"Controls whether the response is required to be answered.",type:"boolean"},requiredLabel:{description:"You can provide a required label, which makes it so a participant has to answer with a response that matches label.",type:"string"},requiredValue:{description:"You can provide a required value, which makes it so a participant has to answer with that value."},rightLabel:{description:"The right label of the radio group. Used in Likert scales for example",type:"string"},secondaryText:{description:"The secondary text that is displayed to the participant under the prompt. This does not accept markdown.",type:"string"},type:{const:"radio",type:"string"}},required:["id","options","prompt","required","type"],type:"object"},RandomInterruption:{additionalProperties:!1,description:'The RandomInterruption interface is used to define an interruption that will be shown randomly in the block.\n\nFor example, if you want to show a single interruption randomly in the block, you would set `"spacing"` to "random" and `"numInterruptions"` to 1. If you want to show 3 interruptions randomly in the block, you would set `"spacing"` to "random" and `"numInterruptions"` to 3.\n\nThe components property is an array of the components that will be inserted randomly in the block. These components should reference components in the StudyConfig.components section of the config.\n\nHere\'s an example of how to use the RandomInterruption:\n\n```js { "order": "fixed", "components": [ "component1", "component2", "component3", "component4", "component5", "component6" ], "interruptions": [ {   "spacing": "random",   "numInterruptions": 3,   "components": [     "interruption1",     "interruption2"   ] } ] } ```\n\nThe resulting sequence array could be:\n\n```js [ ["component1", "interruption1", "interruption2", "component2", "interruption1", "interruption2", "component3", "component4", "component5", "interruption1", "interruption2", "component6], ["component1", "interruption1", "interruption2", "component2", "interruption1", "interruption2", "component3", "component4", "interruption1", "interruption2", "component5", "component6], ["component1", "component2" "interruption1", "interruption2", "component3", "interruption1", "interruption2", "component4", "component5", "interruption1", "interruption2", "component6], ... ] ```',properties:{components:{description:"The components that are included in the interruption. These reference components in the StudyConfig.components section of the config.",items:{type:"string"},type:"array"},numInterruptions:{description:"The number of times the interruption will be randomly added",type:"number"},spacing:{const:"random",description:"If spacing is set to random, reVISit will add interruptions randomly. These interruptions will not ever be displayed as the first component in the block.",type:"string"}},required:["spacing","numInterruptions","components"],type:"object"},ReactComponent:{additionalProperties:!1,description:"The ReactComponent interface is used to define the properties of a react component. This component is used to render react code with certain parameters. These parameters can be used within your react code to render different things.\n\nUnlike other types of components, the path for a React component is relative to the `src/public/` folder. Similar to our standard assets, we suggest creating a folder named `src/public/{studyName}/assets` to house all of the React component assets for a particular study. Your React component which you link to in the path must be default exported from its file.\n\nReact components created this way have a generic prop type passed to the component on render, `<StimulusParams<T>>`, which has the following types.\n\n```ts { parameters: T; setAnswer: ({ status, provenanceGraph, answers }: { status: boolean, provenanceGraph?: TrrackedProvenance, answers: Record<string, any> }) => void } ```\n\nparameters is the same object passed in from the ReactComponent type below, allowing you to pass options in from the config to your component. setAnswer is a callback function allowing the creator of the ReactComponent to programmatically set the answer, as well as the provenance graph. This can be useful if you don't use the default answer interface, and instead have something more unique.\n\nSo, for example, if I had the following ReactComponent in my config ```js { type: 'react-component'; path: 'my_study/CoolComponent.tsx'; parameters: {  name: 'Zach';  age: 26; } } ```\n\nMy react component, CoolComponent.tsx, would exist in src/public/my_study/assets, and look something like this\n\n```ts export default function CoolComponent({ parameters, setAnswer }: StimulusParams<{name: string, age: number}>) { // render something } ```\n\nFor in depth examples, see the following studies, and their associated codebases. https://revisit.dev/study/demo-click-accuracy-test (https://github.com/revisit-studies/study/tree/v1.0.0/src/public/demo-click-accuracy-test/assets) https://revisit.dev/study/demo-brush-interactions (https://github.com/revisit-studies/study/tree/v1.0.0/src/public/demo-brush-interactions/assets)",properties:{correctAnswer:{description:"The correct answer to the component. This is used for training trials where the user is shown the correct answer after a guess.",items:{$ref:"#/definitions/Answer"},type:"array"},description:{description:"The description of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instruction:{description:"The instruction of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instructionLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the instructions."},meta:{additionalProperties:{},description:"The meta data for the component. This is used to identify and provide additional information for the component in the admin panel.",type:"object"},nextButtonLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the next button."},nextButtonText:{description:"The text that is displayed on the next button.",type:"string"},parameters:{additionalProperties:{},description:"The parameters that are passed to the react component. These can be used within your react component to render different things.",type:"object"},path:{description:"The path to the react component. This should be a relative path from the src/public folder.",type:"string"},provideFeedback:{description:"Controls whether the component should provide feedback to the participant, such as in a training trial. If not provided, the default is false.",type:"boolean"},response:{description:"The responses to the component",items:{$ref:"#/definitions/Response"},type:"array"},type:{const:"react-component",type:"string"}},required:["path","response","type"],type:"object"},RepeatedComponentBlockCondition:{additionalProperties:!1,description:`The RepeatedComponentBlockCondition interface is used to define a SkipCondition based on the number of correct or incorrect repeated components. You might use this if you need to check if an attention check was failed multiple times. This is similar to the [ComponentBlockCondition](../ComponentBlockCondition), but it only checks a specific repeated component.

Here's an example of how to use the RepeatedComponentBlockCondition:

\`\`\`js { ... "skip": [ {   "name": "attentionCheck",   "check": "repeatedComponent",   "condition": "numIncorrect",   "value": 2,   "to": "end" } ] ... } \`\`\`

In this example, when the number of incorrect responses to the repeated component with the name "attentionCheck" is two, the participant will be redirected to the end of the study. If the number of incorrect responses is less than two, the participant will continue to the next component in the sequence.`,properties:{check:{const:"repeatedComponent",description:"The check we'll perform.",type:"string"},condition:{description:"The condition to check.",enum:["numCorrect","numIncorrect"],type:"string"},name:{description:"The name of the repeated component to check (e.g. attentionCheck).",type:"string"},to:{description:"The id of the component or block to skip to",type:"string"},value:{description:"The number of correct or incorrect responses to check for.",type:"number"}},required:["name","check","condition","value","to"],type:"object"},Response:{anyOf:[{$ref:"#/definitions/NumericalResponse"},{$ref:"#/definitions/ShortTextResponse"},{$ref:"#/definitions/LongTextResponse"},{$ref:"#/definitions/LikertResponse"},{$ref:"#/definitions/DropdownResponse"},{$ref:"#/definitions/SliderResponse"},{$ref:"#/definitions/RadioResponse"},{$ref:"#/definitions/CheckboxResponse"},{$ref:"#/definitions/IFrameResponse"}]},ResponseBlockLocation:{enum:["sidebar","aboveStimulus","belowStimulus"],type:"string"},ShortTextResponse:{additionalProperties:!1,description:'The ShortTextResponse interface is used to define the properties of a short text response. ShortTextResponses render as a text input that accepts any text and can optionally have a placeholder.\n\n```js { "id": "q-short-text", "prompt": "Short text example", "required": true, "location": "aboveStimulus", "type": "shortText", "placeholder": "Enter your answer here" } ```',properties:{hidden:{description:"Controls whether the response is hidden.",type:"boolean"},id:{description:"The id of the response. This is used to identify the response in the data file.",type:"string"},location:{$ref:"#/definitions/ResponseBlockLocation",description:"Controls the response location. These might be the same for all responses, or differ across responses. Defaults to `belowStimulus`"},paramCapture:{description:"Use to capture querystring parameters in answers such as participant_name. See the examples for how this is used, but prefer uiConfig.urlParticipantIdParam if you are capturing a participant ID.",type:"string"},placeholder:{description:"The placeholder text that is displayed in the input.",type:"string"},prompt:{description:"The prompt that is displayed to the participant. You can use markdown here to render images, links, etc.",type:"string"},required:{description:"Controls whether the response is required to be answered.",type:"boolean"},requiredLabel:{description:"You can provide a required label, which makes it so a participant has to answer with a response that matches label.",type:"string"},requiredValue:{description:"You can provide a required value, which makes it so a participant has to answer with that value."},secondaryText:{description:"The secondary text that is displayed to the participant under the prompt. This does not accept markdown.",type:"string"},type:{const:"shortText",type:"string"}},required:["id","prompt","required","type"],type:"object"},SkipConditions:{description:`The SkipConditions interface is used to define skip conditions. This is used to skip to a different component/block based on the response to a component or based on the number of correct/incorrect responses in a block. Skip conditions work recursively: if you have a nested block, the parent blocks' skip conditions will be considered when computing the skip logic.

Skip conditions are evaluated in the order they are defined in the array. If a condition is met, the participant will be redirected to the component or block specified in the \`"to"\` property. If no conditions are met, the participant will continue to the next component in the sequence.

Skip conditions allow you to jump to a different component or block. If you intend to skip to a block, you should specify a block id in the sequence. If you intend to skip to a component, you should specify a component id. Skipping backwards is not supported. Skipping to a repeated component will skip to the first instance of the component after the component that triggered the skip.

Please see the interface definitions for more specific information on the different types of skip conditions.`,items:{anyOf:[{$ref:"#/definitions/IndividualComponentSingleResponseCondition"},{$ref:"#/definitions/IndividualComponentAllResponsesCondition"},{$ref:"#/definitions/ComponentBlockCondition"},{$ref:"#/definitions/RepeatedComponentBlockCondition"}]},type:"array"},SliderResponse:{additionalProperties:!1,description:'The SliderResponse interface is used to define the properties of a slider response. SliderResponses render as a slider input with user specified steps. For example, you could have steps of 0, 50, and 100.\n\nExample: ```js { "id": "q-slider", "prompt": "How are you feeling?", "location": "aboveStimulus", "required": true, "type": "slider", "options": [  {    "label": "Bad",    "value": 0  },  {    "label": "OK",    "value": 50  },  {    "label": "Good",    "value": 100  } ] } ```',properties:{hidden:{description:"Controls whether the response is hidden.",type:"boolean"},id:{description:"The id of the response. This is used to identify the response in the data file.",type:"string"},location:{$ref:"#/definitions/ResponseBlockLocation",description:"Controls the response location. These might be the same for all responses, or differ across responses. Defaults to `belowStimulus`"},options:{description:"This defines the steps in the slider and the extent of the slider as an array of objects that have a label and a value.",items:{$ref:"#/definitions/NumberOption"},type:"array"},paramCapture:{description:"Use to capture querystring parameters in answers such as participant_name. See the examples for how this is used, but prefer uiConfig.urlParticipantIdParam if you are capturing a participant ID.",type:"string"},prompt:{description:"The prompt that is displayed to the participant. You can use markdown here to render images, links, etc.",type:"string"},required:{description:"Controls whether the response is required to be answered.",type:"boolean"},requiredLabel:{description:"You can provide a required label, which makes it so a participant has to answer with a response that matches label.",type:"string"},requiredValue:{description:"You can provide a required value, which makes it so a participant has to answer with that value."},secondaryText:{description:"The secondary text that is displayed to the participant under the prompt. This does not accept markdown.",type:"string"},type:{const:"slider",type:"string"}},required:["id","options","prompt","required","type"],type:"object"},StringOption:{additionalProperties:!1,description:"The StringOption interface is used to define the options for a dropdown, radio, or checkbox response. The label is the text that is displayed to the user, and the value is the value that is stored in the data file.",properties:{label:{description:"The label displayed to participants.",type:"string"},value:{description:"The value stored in the participant's data.",type:"string"}},required:["label","value"],type:"object"},StudyConfig:{additionalProperties:!1,description:'The StudyConfig interface is used to define the properties of a study configuration. This is a JSON object with four main components: the StudyMetadata, the UIConfig, the Components, and the Sequence. Below is the general template that should be followed when constructing a Study configuration file.\n\n```js { "$schema": "https://raw.githubusercontent.com/revisit-studies/study/v1.0.0/src/parser/StudyConfigSchema.json", "studyMetadata": {  ... }, "uiConfig": {  ... }, "components": {  ... }, "sequence": {  ... } } ```\n\n:::info For information about each of the individual pieces of the study configuration file, you can visit the documentation for each one individually. ::: <br/>\n\nThe `$schema` line is used to verify the schema. If you\'re using VSCode (or other similar IDEs), including this line will allow for autocomplete and helpful suggestions when writing the study configuration.',properties:{$schema:{description:"A required json schema property. This should point to the github link for the version of the schema you would like. The `$schema` line is used to verify the schema. If you're using VSCode (or other similar IDEs), including this line will allow for autocomplete and helpful suggestions when writing the study configuration. See examples for more information",type:"string"},baseComponents:{$ref:"#/definitions/BaseComponents",description:"The base components that are used in the study. These components can be used to template other components. See [BaseComponents](../../type-aliases/BaseComponents) for more information."},components:{additionalProperties:{anyOf:[{$ref:"#/definitions/IndividualComponent"},{$ref:"#/definitions/InheritedComponent"}]},description:"The components that are used in the study. They must be fully defined here with all properties. Some properties may be inherited from baseComponents.",type:"object"},sequence:{$ref:"#/definitions/ComponentBlock",description:"The order of the components in the study. This might include some randomness."},studyMetadata:{$ref:"#/definitions/StudyMetadata",description:"The metadata for the study. This is used to identify the study and version in the data file."},uiConfig:{$ref:"#/definitions/UIConfig",description:"The UI configuration for the study. This is used to configure the UI of the app."}},required:["$schema","studyMetadata","uiConfig","components","sequence"],type:"object"},StudyMetadata:{additionalProperties:!1,description:'The StudyMetadata is used to describe certain properties of a study. Some of this data is displayed on the landing page when running the app, such as the title and description. Below is an example of a StudyMetadata entry in your study configuration file:\n\n```js "studyMetadata" : { "title": "My New Study", "version": "pilot", "authors": [  "Jane Doe",  "John Doe" ], "date": "2024-04-01", "description": "This study is meant to test your ability.", "organizations": [  "The reVISit Team",  "The Other Team" ] } ```',properties:{authors:{description:"The authors of your study.",items:{type:"string"},type:"array"},date:{description:"The date of your study, may be useful for the researcher.",type:"string"},description:{description:"The description of your study, shown on the landing page.",type:"string"},organizations:{description:"The organizations that are associated with your study.",items:{type:"string"},type:"array"},title:{description:"The title of your study, shown on the landing page.",type:"string"},version:{description:"The version of your study. When you change a configuration file after a study has already been distributed to participants, you can change the version number so that the participants who see this new configuration file can be identified.",type:"string"}},required:["title","version","authors","date","description","organizations"],type:"object"},UIConfig:{additionalProperties:!1,description:'The UIConfig is used to configure the UI of the app. This includes the logo, contact email, and whether to show a progress bar. The UIConfig is also used to configure the sidebar, which can be used to display the task instructions and capture responses. Below is an example of how the UI Config would look in your study configuration (note, there are optional fields that are not shown here): ```js uiConfig:{ "contactEmail": "contact@revisit.dev", "helpTextPath": "<study-name>/assets/help.md", "logoPath": "<study-name>/assets/logo.jpg", "withProgressBar": true, "autoDownloadStudy": true "autoDownloadTime": 5000, "studyEndMsg": "Thank you for completing this study. You\'re the best!", "sidebar": true, "windowEventDebounceTime": 500, "urlParticipantIdParam": "PROLIFIC_ID", "numSequences": 500 } ``` In the above, the `path/to/assets/` path is referring to the path to your individual study assets. It is common practice to have your study directory contain an `assets` directory where all components and images relevant to your study reside. Note that this path is relative to the `public` folder of the repository - as is all other paths you define in reVISit (aside from React components whose paths are relative to `src/public`.)',properties:{autoDownloadStudy:{description:"Controls whether the study data is automatically downloaded at the end of the study.",type:"boolean"},autoDownloadTime:{description:"The time in milliseconds to wait before automatically downloading the study data.",type:"number"},contactEmail:{description:"The email address that used during the study if a participant clicks contact.",type:"string"},enumerateQuestions:{description:"Whether to prepend questions with their index (+ 1). This should only be used when all questions are in the same location, e.g. all are in the side bar.",type:"boolean"},helpTextPath:{description:"The path to the help text file. This is displayed when a participant clicks help. Markdown is supported.",type:"string"},logoPath:{description:"The path to the logo image. This is displayed on the landing page and the header.",type:"string"},numSequences:{description:"The number of sequences to generate for the study. This is used to generate the random sequences for the study. The default is 1000.",type:"number"},sidebar:{description:"Controls whether the left sidebar is rendered at all. Required to be true if your response's location is set to sidebar for any question.",type:"boolean"},sidebarWidth:{description:"The width of the left sidebar. Defaults to 300.",type:"number"},studyEndMsg:{description:"The message to display when the study ends.",type:"string"},urlParticipantIdParam:{description:"If the participant ID is passed in the URL, this is the name of the querystring parameter that is used to capture the participant ID (e.g. PROLIFIC_ID). This will allow a user to continue a study on different devices and browsers.",type:"string"},windowEventDebounceTime:{description:"Debounce time in milliseconds for automatically tracked window events. Defaults to 100. E.g 100 here means 1000ms / 100ms = 10 times a second, 200 here means 1000ms / 200ms = 5 times per second",type:"number"},withProgressBar:{description:"Controls whether the progress bar is rendered in the study.",type:"boolean"}},required:["contactEmail","logoPath","withProgressBar","sidebar"],type:"object"},WebsiteComponent:{additionalProperties:!1,description:'The WebsiteComponent interface is used to define the properties of a website component. A WebsiteComponent is used to render an iframe with a website inside of it. This can be used to display an external website or an html file that is located in the public folder.\n\n```js { "type": "website", "path": "<study-name>/assets/website.html", } ```\n\nTo pass a data from the config to the website, you can use the `parameters` field as below:\n\n```js { "type": "website", "path": "<study-name>/website.html", "parameters": {  "barData": [0.32, 0.01, 1.2, 1.3, 0.82, 0.4, 0.3] } "response": [  {    "id": "barChart",    "prompt": "Your selected answer:",    "required": true,    "location": "belowStimulus",    "type": "iframe"  } ], } ``` In the `website.html` file, by including `revisit-communicate.js`, you can use the `Revisit.onDataReceive` method to retrieve the data, and `Revisit.postAnswers` to send the user\'s responses back to the reVISit as shown in the example below:\n\n```html <script src="../../revisitUtilities/revisit-communicate.js"><\/script> <script> Revisit.onDataReceive((data) => {  const barData = data[\'barData\'];  ... });\n\n// Call out that \'barChart\' needs to match ID in \'response\' object Revisit.postAnswers({ barChart: userAnswer }); <\/script> ```\n\n If the html website implements Trrack library for provenance tracking, you can send the provenance graph back to reVISit by calling `Revisit.postProvenanceGraph` as shown in the example below. You need to call this each time the Trrack state is updated so that reVISit is kept aware of the changes in the provenance graph.\n\n```js const trrack = initializeTrrack({ initialState, registry });\n\n... Revisit.postProvenance(trrack.graph.backend); ```',properties:{correctAnswer:{description:"The correct answer to the component. This is used for training trials where the user is shown the correct answer after a guess.",items:{$ref:"#/definitions/Answer"},type:"array"},description:{description:"The description of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instruction:{description:"The instruction of the component. This is used to identify and provide additional information for the component in the admin panel.",type:"string"},instructionLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the instructions."},meta:{additionalProperties:{},description:"The meta data for the component. This is used to identify and provide additional information for the component in the admin panel.",type:"object"},nextButtonLocation:{$ref:"#/definitions/ResponseBlockLocation",description:"The location of the next button."},nextButtonText:{description:"The text that is displayed on the next button.",type:"string"},parameters:{additionalProperties:{},description:"The parameters that are passed to the website (iframe). These can be used within your website to render different things.",type:"object"},path:{description:"The path to the website. This should be a relative path from the public folder or could be an external website.",type:"string"},provideFeedback:{description:"Controls whether the component should provide feedback to the participant, such as in a training trial. If not provided, the default is false.",type:"boolean"},response:{description:"The responses to the component",items:{$ref:"#/definitions/Response"},type:"array"},type:{const:"website",type:"string"}},required:["path","response","type"],type:"object"}},configSchema={$ref:$ref$1,$schema:$schema$1,definitions:definitions$1},$ref="#/definitions/GlobalConfig",$schema="http://json-schema.org/draft-07/schema#",definitions={GlobalConfig:{additionalProperties:!1,description:"The GlobalConfig is used to generate the list of available studies in the UI. This list is displayed on the landing page when running the app.",properties:{$schema:{description:"A required json schema property. This should point to the github link for the version of the schema you would like. See examples in the public folder for more information",type:"string"},configs:{additionalProperties:{additionalProperties:!1,description:"The key is used to identify the study config file. This key is used in the configList property.",properties:{path:{description:"The path to the study config file. This should be a relative path from the public folder.",type:"string"},test:{description:"Indicates whether the study is a test study. This is used to hide the study from the landing page.",type:"boolean"}},required:["path"],type:"object"},description:"A required property that specifies the options for the configList property.",type:"object"},configsList:{description:"A required property that is used to generate the list of available studies in the UI. This list is displayed on the landing page when running the app.",items:{type:"string"},type:"array"}},required:["$schema","configs","configsList"],type:"object"}},globalSchema={$ref,$schema,definitions},ajv1=new Ajv;ajv1.addSchema(globalSchema);const globalValidate=ajv1.getSchema("#/definitions/GlobalConfig"),ajv2=new Ajv;ajv2.addSchema(configSchema);const studyValidate=ajv2.getSchema("#/definitions/StudyConfig");function verifyGlobalConfig(xt){const $t=[];return[xt.configsList.every(kt=>xt.configs[kt]===void 0?($t.push({message:`Config ${kt} is not defined in configs object, but is present in configsList`}),!1):!0),$t]}function isInheritedComponent(xt){return xt.baseComponent!==void 0}function parseGlobalConfig(xt){const $t=hjson.parse(xt),Ct=globalValidate($t),kt=verifyGlobalConfig($t);if(Ct&&kt[0])return $t;throw console.error("Global config parsing errors",[...globalValidate.errors||[],...kt[1]]),Error("There was an issue validating your file global.json")}function verifyStudySkip(xt,$t,Ct=[]){if(xt.components.length===0){Ct.push({message:"Sequence has an empty components array",instancePath:"/sequence/",params:{action:"remove empty components block"}});return}xt.id&&$t.map((Mt,Ft)=>Mt===xt.id?Ft:null).forEach(Mt=>{Mt!==null&&$t.splice(Mt,1)}),xt.components.forEach(kt=>{typeof kt=="string"?$t.includes(kt)&&$t.map((Ft,jt)=>Ft===kt?jt:null).forEach(Ft=>{Ft!==null&&$t.splice(Ft,1)}):verifyStudySkip(kt,$t,Ct)}),xt.skip&&$t.push(...xt.skip.map(kt=>kt.to).filter(kt=>kt!=="end"))}function verifyStudyConfig(xt){const $t=[],Ct=[];Object.entries(xt.components).forEach(([Ft,jt])=>{var Bt;isInheritedComponent(jt)&&!((Bt=xt.baseComponents)!=null&&Bt[jt.baseComponent])&&$t.push({message:`Base component \`${jt.baseComponent}\` is not defined in baseComponents object`,instancePath:`/components/${Ft}`,params:{action:"add the base component to the baseComponents object"}})});const kt=getSequenceFlatMapWithInterruptions(xt.sequence);kt.forEach(Ft=>{var jt;xt.components[Ft]||$t.push({message:(jt=xt.baseComponents)!=null&&jt[Ft]?`Component \`${Ft}\` is a base component and cannot be used in the sequence`:`Component \`${Ft}\` is not defined in components object`,instancePath:"/sequence/",params:{action:"add the component to the components object"}})}),Object.keys(xt.components).filter(Ft=>!kt.includes(Ft)).forEach(Ft=>{Ct.push({message:`Component \`${Ft}\` is defined in components object but not used in the sequence`,instancePath:"/components/",params:{action:"remove the component from the components object or add it to the sequence"}})});const Mt=[];return verifyStudySkip(xt.sequence,Mt),Mt.forEach(Ft=>{$t.push({message:`Skip target \`${Ft}\` does not occur after the skip block it is used in`,instancePath:"/sequence/",params:{action:"add the target to the sequence after the skip block"}})}),{errors:$t,warnings:Ct}}function parseStudyConfig(xt){let $t=!1,Ct;try{Ct=hjson.parse(xt),$t=studyValidate(Ct)}catch{$t=!1}let kt=[],Mt=[];if($t){const{errors:Ft,warnings:jt}=verifyStudyConfig(Ct);kt=[...studyValidate.errors||[],...Ft],Mt=jt}else kt=studyValidate.errors||[{message:"There was an issue validating your config file",instancePath:"root",params:{action:"fix the errors in your file or make sure the global config references the right file path"}}];return{...Ct,errors:kt,warnings:Mt}}function useDisableBrowserBack(){const xt=useCurrentStep(),{setAlertModal:$t}=useStoreActions(),Ct=useStoreDispatch();reactExports.useEffect(()=>{window.history.pushState(null,"",window.location.href),window.onpopstate=()=>{window.history.pushState(null,"",window.location.href),Ct($t({show:!0,message:"Using the browser's back button is prohibited during the study."}))}},[xt,$t,Ct])}var has$2=Object.prototype.hasOwnProperty;function find$2(xt,$t,Ct){for(Ct of xt.keys())if(dequal(Ct,$t))return Ct}function dequal(xt,$t){var Ct,kt,Mt;if(xt===$t)return!0;if(xt&&$t&&(Ct=xt.constructor)===$t.constructor){if(Ct===Date)return xt.getTime()===$t.getTime();if(Ct===RegExp)return xt.toString()===$t.toString();if(Ct===Array){if((kt=xt.length)===$t.length)for(;kt--&&dequal(xt[kt],$t[kt]););return kt===-1}if(Ct===Set){if(xt.size!==$t.size)return!1;for(kt of xt)if(Mt=kt,Mt&&typeof Mt=="object"&&(Mt=find$2($t,Mt),!Mt)||!$t.has(Mt))return!1;return!0}if(Ct===Map){if(xt.size!==$t.size)return!1;for(kt of xt)if(Mt=kt[0],Mt&&typeof Mt=="object"&&(Mt=find$2($t,Mt),!Mt)||!dequal(kt[1],$t.get(Mt)))return!1;return!0}if(Ct===ArrayBuffer)xt=new Uint8Array(xt),$t=new Uint8Array($t);else if(Ct===DataView){if((kt=xt.byteLength)===$t.byteLength)for(;kt--&&xt.getInt8(kt)===$t.getInt8(kt););return kt===-1}if(ArrayBuffer.isView(xt)){if((kt=xt.byteLength)===$t.byteLength)for(;kt--&&xt[kt]===$t[kt];);return kt===-1}if(!Ct||typeof xt=="object"){kt=0;for(Ct in xt)if(has$2.call(xt,Ct)&&++kt&&!has$2.call($t,Ct)||!(Ct in $t)||!dequal(xt[Ct],$t[Ct]))return!1;return Object.keys($t).length===kt}}return xt!==xt&&$t!==$t}function useDeepCompareMemoize(xt){var $t=reactExports.useRef(xt),Ct=reactExports.useRef(0);return dequal(xt,$t.current)||($t.current=xt,Ct.current+=1),reactExports.useMemo(function(){return $t.current},[Ct.current])}function useDeepCompareEffect(xt,$t){return reactExports.useEffect(xt,useDeepCompareMemoize($t))}const useAsync=(xt,$t=null)=>{const[Ct,kt]=reactExports.useState("idle"),[Mt,Ft]=reactExports.useState(null),[jt,Bt]=reactExports.useState(null),Vt=reactExports.useRef(),zt=reactExports.useRef(!1);reactExports.useEffect(()=>(zt.current=!0,()=>{zt.current=!1}),[]);const Ht=reactExports.useCallback((...Gt)=>{kt("pending"),Bt(null);const qt=Promise.resolve(xt(...Gt)).then(Wt=>(zt.current&&qt===Vt.current&&(Ft(Wt),kt("success")),Wt)).catch(Wt=>{throw zt.current&&qt===Vt.current&&(Ft(null),Bt(Wt),kt("error")),Wt});return Vt.current=qt,qt},[xt]);return useDeepCompareEffect(()=>{if($t)try{Ht(...$t)}catch{}},[Ht,$t]),{execute:Ht,status:Ct,value:Mt,error:jt}},OPTIONAL_COMMON_PROPS=["status","percentComplete","description","instruction","responsePrompt","answer","correctAnswer","responseMin","responseMax","startTime","endTime","duration","meta","configHash"],REQUIRED_PROPS=["participantId","trialId","trialOrder","responseId"];function download(xt,$t){const Ct=`data:text/json;charset=utf-8,${encodeURIComponent(xt)}`,kt=document.createElement("a");kt.setAttribute("href",Ct),kt.setAttribute("download",$t),document.body.appendChild(kt),kt.click(),kt.remove()}function participantDataToRows(xt,$t,Ct){const kt=(Object.entries(xt.answers).filter(([Mt,Ft])=>Ft.endTime!==void 0).length/(getSequenceFlatMap(xt.sequence).length-1)*100).toFixed(2);return Object.entries(xt.answers).map(([Mt,Ft])=>{const jt=Mt.split("_").slice(0,-1).join("_"),Bt=parseInt(`${Mt.split("_").at(-1)}`,10),Vt=Ct.components[jt],zt=isInheritedComponent(Vt)&&Vt.baseComponent&&Ct.baseComponents?merge$5({},Ct.baseComponents[Vt.baseComponent],Vt):Vt,Ht=Ft.endTime-Ft.startTime;return Object.entries(Ft.answer).map(([qt,Wt])=>{var Xt,Qt;const Yt={participantId:xt.participantId,trialId:jt,trialOrder:Bt,responseId:qt},Kt=zt.response.find(Jt=>Jt.id===qt);if($t.includes("status")&&(Yt.status=xt.rejected?"rejected":xt.completed?"completed":"in progress"),$t.includes("configHash")&&(Yt.configHash=xt.participantConfigHash),$t.includes("percentComplete")&&(Yt.percentComplete=kt),$t.includes("description")&&(Yt.description=zt.description),$t.includes("instruction")&&(Yt.instruction=zt.instruction),$t.includes("responsePrompt")&&(Yt.responsePrompt=Kt==null?void 0:Kt.prompt),$t.includes("answer")&&(Yt.answer=Wt),$t.includes("correctAnswer")){const Jt=(Qt=(Xt=zt.correctAnswer)==null?void 0:Xt.find(Zt=>Zt.id===qt))==null?void 0:Qt.answer;Yt.correctAnswer=typeof Jt=="object"?JSON.stringify(Jt):Jt}return $t.includes("responseMin")&&(Yt.responseMin=(Kt==null?void 0:Kt.type)==="numerical"?Kt.min:void 0),$t.includes("responseMax")&&(Yt.responseMax=(Kt==null?void 0:Kt.type)==="numerical"?Kt.max:void 0),$t.includes("startTime")&&(Yt.startTime=new Date(Ft.startTime).toISOString()),$t.includes("endTime")&&(Yt.endTime=new Date(Ft.endTime).toISOString()),$t.includes("duration")&&(Yt.duration=Ht),$t.includes("meta")&&(Yt.meta=JSON.stringify(zt.meta,null,2)),Yt}).flat()}).flat()}async function getTableData(xt,$t,Ct,kt){if(!Ct)return{header:[],rows:[]};const Mt=[...REQUIRED_PROPS,...xt],Ft=[...new Set($t.map(Ht=>Ht.participantConfigHash))],jt=await Ct.getAllConfigsFromHash(Ft,kt),Bt=Mt,zt=(await Promise.all($t.map(async Ht=>await participantDataToRows(Ht,Mt,jt[Ht.participantConfigHash])))).flat().sort((Ht,Gt)=>Ht!==Gt?Ht.participantId.localeCompare(Gt.participantId):Ht.trialOrder-Gt.trialOrder);return{header:Bt,rows:zt}}function DownloadTidy({opened:xt,close:$t,filename:Ct,data:kt,studyId:Mt}){const[Ft,jt]=reactExports.useState([...OPTIONAL_COMMON_PROPS].filter(Wt=>Wt!=="meta")),Bt=useStorageEngine(),{value:Vt,status:zt,error:Ht}=useAsync(getTableData,[Ft,kt,Bt.storageEngine,Mt]),Gt=reactExports.useCallback(()=>{if(!Vt)return;const Wt=[Vt.header.join(","),...Vt.rows.map(Yt=>Vt.header.map(Kt=>Yt[Kt]).join(","))].join(`
`);download(Wt,Ct)},[Ct,Vt]),qt=reactExports.useMemo(()=>{if(!Vt)return"";const Wt=Vt.rows.length>5?5:Vt.rows.length,Yt=Wt===1?"":"s";return`This is a preview of the first ${Yt?Wt:""} row${Yt} of the CSV. The full CSV contains ${Vt.rows.length} row${Yt}.`},[Vt]);return jsxRuntimeExports.jsxs(Modal,{opened:xt,size:"90%",onClose:$t,title:"Tidy CSV Exporter",centered:!0,withCloseButton:!1,children:[jsxRuntimeExports.jsx(MultiSelect,{searchable:!0,nothingFoundMessage:"Property not found",data:[...OPTIONAL_COMMON_PROPS],value:Ft,onChange:Wt=>jt(Wt),label:"Included optional columns:",leftSection:jsxRuntimeExports.jsx(IconLayoutColumns,{}),variant:"filled"}),jsxRuntimeExports.jsx(Space,{h:"md"}),jsxRuntimeExports.jsxs(Box,{mih:300,style:{width:"100%",overflow:"scroll"},children:[zt==="success"&&Vt?jsxRuntimeExports.jsxs(Table$2,{striped:!0,captionSide:"bottom",withTableBorder:!0,children:[jsxRuntimeExports.jsx(Table$2.Thead,{children:jsxRuntimeExports.jsx(Table$2.Tr,{children:Vt.header.map(Wt=>jsxRuntimeExports.jsx(Table$2.Th,{style:{whiteSpace:"nowrap",minWidth:["description","instruction","participantId"].includes(Wt)?200:void 0},children:jsxRuntimeExports.jsxs(Flex,{direction:"row",justify:"space-between",align:"center",children:[Wt,!REQUIRED_PROPS.includes(Wt)&&jsxRuntimeExports.jsx(ActionIcon,{onClick:()=>jt(Ft.filter(Yt=>Yt!==Wt)),style:{marginBottom:-3,marginLeft:8},variant:"subtle",color:"gray",children:jsxRuntimeExports.jsx(IconX,{size:16})})]})},Wt))})}),jsxRuntimeExports.jsx(Table$2.Tbody,{children:Vt.rows.slice(0,5).map((Wt,Yt)=>jsxRuntimeExports.jsx(Table$2.Tr,{children:Vt.header.map(Kt=>jsxRuntimeExports.jsx(Table$2.Td,{style:{whiteSpace:["description","instruction","participantId"].includes(Kt)?"normal":"nowrap"},children:Wt[Kt]},`${Yt}-${Kt}`))},Yt))})]}):zt==="error"&&Ht?jsxRuntimeExports.jsx(Alert,{variant:"light",children:Ht.message}):null,jsxRuntimeExports.jsx(LoadingOverlay,{visible:zt==="pending"||zt==="idle"})]}),jsxRuntimeExports.jsx(Space,{h:"sm"}),jsxRuntimeExports.jsx(Flex,{justify:"center",fz:"sm",c:"dimmed",children:jsxRuntimeExports.jsx(Text,{children:qt})}),jsxRuntimeExports.jsx(Space,{h:"md"}),jsxRuntimeExports.jsxs(Group$1,{justify:"right",children:[jsxRuntimeExports.jsx(Button,{onClick:$t,color:"dark",variant:"subtle",children:"Close"}),jsxRuntimeExports.jsx(Button,{leftSection:jsxRuntimeExports.jsx(IconTableExport,{}),onClick:()=>Gt(),"data-autofocus":!0,children:"Download"})]})]})}function StudyEnd(){const xt=useStudyConfig(),{storageEngine:$t}=useStorageEngine(),{answers:Ct}=useStoreSelector(Jt=>Jt),[kt,Mt]=reactExports.useState(!1);reactExports.useEffect(()=>{const Jt=setInterval(async()=>{await $t.verifyCompletion(Ct)&&(Mt(!0),clearInterval(Jt))},1e3)},[]),useDisableBrowserBack();const[Ft,jt]=reactExports.useState(),[Bt,Vt]=reactExports.useState(""),zt=xt.studyMetadata.title.replace(" ","_");reactExports.useEffect(()=>{async function Jt(){if($t){const Zt=await $t.getCurrentParticipantId(),sn=await $t.getParticipantData();Vt(Zt),jt(sn)}}Jt()},[$t]);const Ht=reactExports.useCallback(async()=>{download(JSON.stringify(Ft,null,2),`${zt}_${Bt}.json`)},[zt,Ft,Bt]),Gt=xt.uiConfig.autoDownloadStudy||!1,qt=Gt&&xt.uiConfig.autoDownloadTime||-1,[Wt,Yt]=reactExports.useState(Math.floor(qt/1e3));reactExports.useEffect(()=>{if(kt){const Jt=setInterval(()=>{Yt(Zt=>Zt-1)},1e3);return Wt<=0?(Gt&&Ht(),clearInterval(Jt),()=>clearInterval(Jt)):()=>clearInterval(Jt)}return()=>{}},[Gt,kt,Wt,Ht]);const Kt=useStudyId(),[Xt,Qt]=reactExports.useState(!1);return reactExports.useEffect(()=>{(async()=>{if($t){const Zt=await $t.getModes(Kt);Qt(Zt.dataCollectionEnabled)}})()},[$t,Kt]),jsxRuntimeExports.jsx(Center$2,{style:{height:"100%"},children:jsxRuntimeExports.jsx(Flex,{direction:"column",children:kt||!Xt?jsxRuntimeExports.jsx(Text,{size:"xl",display:"block",children:xt.uiConfig.studyEndMsg?jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:xt.uiConfig.studyEndMsg}):"Thank you for completing the study. You may close this window now."}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Text,{size:"xl",display:"block",children:"Please wait while your answers are uploaded."}),jsxRuntimeExports.jsx(Space,{h:"lg"}),jsxRuntimeExports.jsx(Center$2,{children:jsxRuntimeExports.jsx(Loader,{color:"blue"})})]})})})}function ComponentController(){var qt;const xt=useStudyConfig(),$t=useCurrentStep(),Ct=useCurrentComponent()||"Notfound",kt=xt.components[Ct],Mt=useStoredAnswer();useDisableBrowserBack();const{storageEngine:Ft}=useStorageEngine(),jt=useStoreDispatch(),{setAlertModal:Bt}=useStoreActions();if(reactExports.useEffect(()=>{(Ft==null?void 0:Ft.getEngine())!=="firebase"&&jt(Bt({show:!0,message:"There was an issue connecting to the firebase database. This could be caused by a network issue or your adblocker. If you are using an adblocker, please disable it for this website and refresh."}))},[Bt,Ft,jt]),Ct==="end")return jsxRuntimeExports.jsx(StudyEnd,{});if(Ct==="Notfound")return jsxRuntimeExports.jsx(ResourceNotFound,{email:xt.uiConfig.contactEmail});const Vt=isInheritedComponent(kt)&&xt.baseComponents?merge$5({},(qt=xt.baseComponents)==null?void 0:qt[kt.baseComponent],kt):kt,zt=Vt.instruction||"",{instructionLocation:Ht}=Vt,Gt=xt.uiConfig.sidebar&&(Ht==="sidebar"||Ht===void 0);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Ht==="aboveStimulus"&&jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:zt}),jsxRuntimeExports.jsx(ResponseBlock,{status:Mt,config:Vt,location:"aboveStimulus"},`${$t}-above-response-block`),jsxRuntimeExports.jsxs(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx("div",{children:"Loading..."}),children:[Vt.type==="markdown"&&jsxRuntimeExports.jsx(MarkdownController,{currentConfig:Vt}),Vt.type==="website"&&jsxRuntimeExports.jsx(IframeController,{currentConfig:Vt}),Vt.type==="image"&&jsxRuntimeExports.jsx(ImageController,{currentConfig:Vt}),Vt.type==="react-component"&&jsxRuntimeExports.jsx(ReactComponentController,{currentConfig:Vt})]},`${$t}-stimulus`),(Ht==="belowStimulus"||Ht===void 0&&!Gt)&&jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:zt}),jsxRuntimeExports.jsx(ResponseBlock,{status:Mt,config:Vt,location:"belowStimulus"},`${$t}-below-response-block`)]})}function NavigateWithParams(xt){const[$t]=useSearchParams();return jsxRuntimeExports.jsx(Navigate,{...xt,to:{pathname:xt.to,search:$t.toString()}})}function findTaskIndexInSequence(xt,$t,Ct,kt){let Mt=0;for(let Ft=0;Ft<xt.components.length;Ft+=1){const jt=xt.components[Ft];if(typeof jt=="string"){if(kt===xt.orderPath&&jt===$t&&Ft>=Ct)break;Mt+=1}else if(Mt+=findTaskIndexInSequence(jt,$t,Ct,kt),kt.includes(jt.orderPath))break}return Mt}function countInterruptionsRecursively(xt,$t){let Ct=0;return $t.components.forEach(kt=>{var Mt;if(typeof kt=="string"&&((Mt=xt.interruptions)!=null&&Mt.flatMap(Ft=>Ft.components).includes(kt)))Ct+=1;else if(typeof kt!="string"){const Ft=xt.components.find(jt=>typeof jt!="string"&&jt.orderPath===kt.orderPath);Ct+=countInterruptionsRecursively(Ft,kt)}}),Ct}function reorderComponents(xt,$t){const Ct=[];return $t.forEach(kt=>{const Mt=xt.findIndex(Ft=>typeof Ft=="string"?Ft===kt:typeof kt!="string"&&Ft.orderPath===kt.orderPath);Mt!==-1&&(Ct.push(xt[Mt]),xt.splice(Mt,1)),Mt===-1&&typeof kt=="string"&&Ct.push(kt)}),Ct.push(...xt),Ct}function StepItem({step:xt,disabled:$t,fullSequence:Ct,startIndex:kt,interruption:Mt,subSequence:Ft,participantView:jt}){const Bt=useStudyId(),Vt=useNavigate(),zt=useCurrentStep(),Ht=useStudyConfig(),[Gt,{close:qt,open:Wt}]=useDisclosure(!1),Yt=xt in Ht.components&&Ht.components[xt],Kt=Ft&&Ft.components.slice(kt).includes(xt)?findTaskIndexInSequence(Ct,xt,kt,Ft.orderPath):-1,Xt=jt?zt===Kt:zt===`reviewer-${xt}`;return jsxRuntimeExports.jsxs(Popover,{withinPortal:!0,position:"left",withArrow:!0,arrowSize:10,shadow:"md",opened:Gt,offset:20,children:[jsxRuntimeExports.jsx(Popover.Target,{children:jsxRuntimeExports.jsx(Box,{onMouseEnter:Wt,onMouseLeave:qt,children:jsxRuntimeExports.jsx(NavLink,{active:Xt,style:{lineHeight:"32px",height:"32px"},label:jsxRuntimeExports.jsxs(Box,{children:[Mt&&jsxRuntimeExports.jsx(IconBrain,{size:16,style:{marginRight:4,marginBottom:-2},color:"orange"}),Xt?jsxRuntimeExports.jsx(Text,{size:"sm",span:!0,fw:"700",display:"inline",children:xt}):jsxRuntimeExports.jsx(Text,{size:"sm",display:"inline",children:xt})]}),onClick:()=>Vt(jt?`/${Bt}/${Kt}`:`/${Bt}/reviewer-${xt}`),disabled:$t})})}),Yt&&(Yt.description||Yt.meta)&&jsxRuntimeExports.jsx(Popover.Dropdown,{onMouseLeave:qt,children:jsxRuntimeExports.jsx(Text,{size:"sm",children:jsxRuntimeExports.jsxs(Box,{children:[Yt.description&&jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsx(Text,{fw:900,display:"inline-block",mr:2,children:"Description:"}),jsxRuntimeExports.jsx(Text,{fw:400,component:"span",children:Yt.description})]}),Yt.meta&&jsxRuntimeExports.jsxs(Text,{children:[jsxRuntimeExports.jsx(Text,{fw:"900",component:"span",children:"Task Meta: "}),jsxRuntimeExports.jsx(Text,{component:"pre",style:{margin:0,padding:0},children:`${JSON.stringify(Yt.meta,null,2)}`})]})]})})})]})}function StepsPanel({configSequence:xt,fullSequence:$t,participantSequence:Ct,participantView:kt}){var Ft;let Mt=deepCopy(xt.components);return Ct&&kt&&(Mt=reorderComponents(deepCopy(xt.components),deepCopy(Ct.components))),kt||(Mt=[...((Ft=xt.interruptions)==null?void 0:Ft.flatMap(jt=>jt.components))||[],...Mt]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:Mt.map((jt,Bt)=>{if(typeof jt=="string")return jsxRuntimeExports.jsx(StepItem,{step:jt,disabled:kt&&(Ct==null?void 0:Ct.components[Bt])!==jt,fullSequence:$t,startIndex:Bt,interruption:xt.interruptions&&xt.interruptions.findIndex(Gt=>Gt.components.includes(jt))>-1||!1,subSequence:Ct,participantView:kt},Bt);const Vt=Ct==null?void 0:Ct.components.find(Gt=>typeof Gt!="string"&&Gt.orderPath===jt.orderPath),zt=Vt?getSequenceFlatMap(Vt).length-countInterruptionsRecursively(jt,Vt):0,Ht=getSequenceFlatMap(jt);return jsxRuntimeExports.jsx(NavLink,{label:jsxRuntimeExports.jsxs(Box,{style:{opacity:zt>0?1:.5},children:[jsxRuntimeExports.jsx(Text,{size:"sm",display:"inline",children:jt.order}),jt.order==="random"||jt.order==="latinSquare"?jsxRuntimeExports.jsx(IconArrowsShuffle,{size:"15",opacity:.5,style:{marginLeft:"5px",verticalAlign:"middle"}}):null,kt&&jsxRuntimeExports.jsxs(Badge,{ml:5,variant:"light",children:[zt,"/",Ht.length]}),kt&&jt.interruptions&&jsxRuntimeExports.jsx(Badge,{ml:5,color:"orange",variant:"light",children:(Vt==null?void 0:Vt.components.filter(Gt=>{var qt;return typeof Gt=="string"&&((qt=jt.interruptions)==null?void 0:qt.flatMap(Wt=>Wt.components).includes(Gt))}).length)||0})]}),defaultOpened:!0,childrenOffset:32,style:{lineHeight:"32px",height:"32px"},children:jsxRuntimeExports.jsx(Box,{style:{borderLeft:"1px solid #e9ecef"},children:jsxRuntimeExports.jsx(StepsPanel,{configSequence:jt,participantSequence:Vt,fullSequence:$t,participantView:kt})})},Bt)})})}function getNewParticipant(xt,$t,Ct,kt){xt==null||xt.nextParticipant().then(()=>{window.location.href=kt}).catch(Mt=>{console.error(Mt)})}function addPathToComponentBlock(xt,$t){return typeof xt=="string"?xt:{...xt,orderPath:$t,components:xt.components.map((Ct,kt)=>addPathToComponentBlock(Ct,`${$t}-${kt}`))}}function InfoHover({text:xt}){return jsxRuntimeExports.jsx(Tooltip,{label:xt,multiline:!0,w:200,style:{whiteSpace:"normal"},withinPortal:!0,position:"bottom",children:jsxRuntimeExports.jsx(IconInfoCircle,{size:16,style:{marginBottom:-3,marginLeft:4}})})}function AppAside(){const{sequence:xt,metadata:$t}=useStoreSelector(Gt=>Gt),{toggleStudyBrowser:Ct}=useStoreActions(),kt=useStudyConfig(),Mt=useStoreDispatch(),Ft=useStudyId(),jt=useHref(`/${Ft}`),{storageEngine:Bt}=useStorageEngine(),Vt=reactExports.useMemo(()=>{let Gt=deepCopy(kt.sequence);return Gt=addPathToComponentBlock(Gt,"root"),Gt.components.push("end"),Gt},[kt.sequence]),[zt,Ht]=reactExports.useState("participant");return jsxRuntimeExports.jsxs(AppShell.Aside,{p:"0",children:[jsxRuntimeExports.jsx(AppShell.Section,{children:jsxRuntimeExports.jsxs(Flex,{direction:"row",p:"sm",justify:"space-between",pb:"xs",children:[jsxRuntimeExports.jsx(Text,{size:"md",fw:700,pt:3,children:"Study Browser"}),jsxRuntimeExports.jsx(Button,{variant:"light",leftSection:jsxRuntimeExports.jsx(IconUserPlus,{size:14}),onClick:()=>getNewParticipant(Bt,kt,$t,jt),size:"xs",disabled:zt==="allTrials",children:"Next Participant"}),jsxRuntimeExports.jsx(CloseButton,{onClick:()=>Mt(Ct()),mt:1})]})}),jsxRuntimeExports.jsx(AppShell.Section,{grow:!0,component:ScrollArea,p:"xs",pt:0,children:jsxRuntimeExports.jsxs(Tabs,{value:zt,onChange:Ht,children:[jsxRuntimeExports.jsx(Box,{style:{position:"sticky",top:0,backgroundColor:"white",zIndex:1},children:jsxRuntimeExports.jsxs(Tabs.List,{grow:!0,children:[jsxRuntimeExports.jsxs(Tabs.Tab,{value:"participant",children:["Participant View",jsxRuntimeExports.jsx(InfoHover,{text:"The Participants View shows items just as a participants would see them, considering randomization, omissions, etc. You can navigate between multiple participants using the next participant button."})]}),jsxRuntimeExports.jsxs(Tabs.Tab,{value:"allTrials",children:["All Trials View",jsxRuntimeExports.jsx(InfoHover,{text:"The All Trials View shows all items in the order defined in the config."})]})]})}),jsxRuntimeExports.jsx(Tabs.Panel,{value:"participant",children:jsxRuntimeExports.jsx(StepsPanel,{configSequence:Vt,participantSequence:xt,fullSequence:xt,participantView:!0})}),jsxRuntimeExports.jsx(Tabs.Panel,{value:"allTrials",children:jsxRuntimeExports.jsx(StepsPanel,{configSequence:Vt,participantSequence:xt,fullSequence:xt,participantView:!1})})]})})]})}function AppHeader$1({studyNavigatorEnabled:xt,dataCollectionEnabled:$t}){const{config:Ct,metadata:kt}=useStoreSelector(ln=>ln),Mt=useFlatSequence(),Ft=useStoreDispatch(),{toggleShowHelpText:jt,toggleStudyBrowser:Bt}=useStoreActions(),{storageEngine:Vt}=useStorageEngine(),zt=useCurrentStep(),Ht=Mt.length-1,Gt=typeof zt=="number"?zt/Ht*100:0,[qt,Wt]=reactExports.useState(!1),Yt=Ct==null?void 0:Ct.uiConfig.logoPath,Kt=Ct==null?void 0:Ct.uiConfig.withProgressBar,Xt=useStudyId(),Qt=useHref(`/${Xt}`),Jt=reactExports.useRef(null),[Zt,sn]=reactExports.useState(!1);return reactExports.useEffect(()=>{const ln=Jt.current;ln&&sn(ln.scrollWidth>ln.offsetWidth)},[Ct]),jsxRuntimeExports.jsx(AppShell.Header,{p:"md",children:jsxRuntimeExports.jsxs(Grid,{mt:-7,align:"center",children:[jsxRuntimeExports.jsx(Grid.Col,{span:4,children:jsxRuntimeExports.jsxs(Flex,{align:"center",children:[jsxRuntimeExports.jsx(Image$1,{w:40,src:`${PREFIX$1}${Yt}`,alt:"Study Logo"}),jsxRuntimeExports.jsx(Space,{w:"md"}),jsxRuntimeExports.jsx(Title,{ref:Jt,order:4,style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:Zt?Ct==null?void 0:Ct.studyMetadata.title:void 0,children:Ct==null?void 0:Ct.studyMetadata.title})]})}),jsxRuntimeExports.jsx(Grid.Col,{span:4,children:Kt&&jsxRuntimeExports.jsx(Progress,{radius:"md",size:"lg",value:Gt})}),jsxRuntimeExports.jsx(Grid.Col,{span:4,children:jsxRuntimeExports.jsxs(Group$1,{wrap:"nowrap",justify:"right",children:[!$t&&jsxRuntimeExports.jsx(Tooltip,{multiline:!0,withArrow:!0,arrowSize:6,w:300,label:"This is a demo version of the study, were not collecting any data.",children:jsxRuntimeExports.jsx(Badge,{size:"lg",color:"orange",children:"Demo Mode"})}),(Ct==null?void 0:Ct.uiConfig.helpTextPath)!==void 0&&jsxRuntimeExports.jsx(Button,{variant:"outline",onClick:()=>Ft(jt()),children:"Help"}),jsxRuntimeExports.jsxs(Menu,{shadow:"md",width:200,withinPortal:!0,opened:qt,onChange:Wt,children:[jsxRuntimeExports.jsx(Menu.Target,{children:jsxRuntimeExports.jsx(ActionIcon,{size:"lg",className:"studyBrowserMenuDropdown",variant:"subtle",color:"gray",children:jsxRuntimeExports.jsx(IconDotsVertical,{})})}),jsxRuntimeExports.jsxs(Menu.Dropdown,{children:[xt&&jsxRuntimeExports.jsx(Menu.Item,{leftSection:jsxRuntimeExports.jsx(IconSchema,{size:14}),onClick:()=>Ft(Bt()),children:"Study Browser"}),jsxRuntimeExports.jsx(Menu.Item,{component:"a",href:Ct!==null?`mailto:${Ct.uiConfig.contactEmail}`:void 0,leftSection:jsxRuntimeExports.jsx(IconMail,{size:14}),children:"Contact"}),xt&&jsxRuntimeExports.jsx(Menu.Item,{leftSection:jsxRuntimeExports.jsx(IconUserPlus,{size:14}),onClick:()=>getNewParticipant(Vt,Ct,kt,Qt),children:"Next Participant"})]})]})]})})]})})}function AppNavBar(){var Vt;const xt=(Vt=useStudyConfig())==null?void 0:Vt.uiConfig.sidebar,$t=useStudyConfig(),Ct=useCurrentComponent(),kt=$t.components[Ct],Mt=reactExports.useMemo(()=>{var zt;return kt?isInheritedComponent(kt)&&$t.baseComponents?merge$5({},(zt=$t.baseComponents)==null?void 0:zt[kt.baseComponent],kt):kt:null},[kt,$t.baseComponents]),Ft=useStoredAnswer(),jt=(Mt==null?void 0:Mt.instruction)||"",Bt=(Mt==null?void 0:Mt.instructionLocation)==="sidebar"||(Mt==null?void 0:Mt.instructionLocation)===void 0;return xt&&Mt?jsxRuntimeExports.jsxs(AppShell.Navbar,{bg:"gray.1",display:"block",style:{zIndex:0,overflowY:"scroll"},children:[Bt&&jt!==""&&jsxRuntimeExports.jsx(AppShell.Section,{bg:"gray.3",p:"md",children:jsxRuntimeExports.jsxs(Text,{c:"gray.9",children:[jsxRuntimeExports.jsx(Text,{span:!0,c:"orange.8",fw:700,inherit:!0,children:"Task:"}),jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:jt})]})}),jsxRuntimeExports.jsx(AppShell.Section,{p:"md",children:jsxRuntimeExports.jsx(ResponseBlock,{status:Ft,config:Mt,location:"sidebar"},`${Ct}-sidebar-response-block`)})]}):jsxRuntimeExports.jsx(AppShell.Navbar,{bg:"gray.1",display:"block",style:{zIndex:0,overflowY:"scroll"},children:jsxRuntimeExports.jsx(ResponseBlock,{status:Ft,config:Mt,location:"sidebar",style:{display:"hidden"}},`${Ct}-sidebar-response-block`)})}function HelpModal(){const{showHelpText:xt,config:$t}=useStoreSelector(Vt=>Vt),Ct=useStoreDispatch(),{toggleShowHelpText:kt}=useStoreActions(),[Mt,Ft]=reactExports.useState(""),[jt,Bt]=reactExports.useState(!0);return reactExports.useEffect(()=>{async function Vt(){const zt=await getStaticAssetByPath($t.uiConfig.helpTextPath);zt!==void 0&&Ft(zt),Bt(!1)}Vt()},[$t.uiConfig.helpTextPath]),jsxRuntimeExports.jsx(Modal,{size:"70%",opened:xt,withCloseButton:!1,onClose:()=>Ct(kt()),children:jt||Mt?jsxRuntimeExports.jsx(ReactMarkdownWrapper,{text:Mt}):jsxRuntimeExports.jsx(ResourceNotFound,{path:$t.uiConfig.helpTextPath})})}function AlertModal(){const{alertModal:xt}=useStoreSelector(jt=>jt),{setAlertModal:$t}=useStoreActions(),Ct=useStoreDispatch(),[kt,Mt]=reactExports.useState(xt.show),Ft=reactExports.useCallback(()=>Ct($t({...xt,show:!1})),[xt,$t,Ct]);return reactExports.useEffect(()=>Mt(xt.show),[xt.show]),jsxRuntimeExports.jsx(Modal,{opened:kt,centered:!0,size:"lg",withCloseButton:!1,onClose:Ft,children:jsxRuntimeExports.jsxs(Alert,{color:"red",radius:"xs",title:"Alert",icon:jsxRuntimeExports.jsx(IconAlertCircle,{}),onClose:Ft,styles:{root:{backgroundColor:"unset"}},children:[jsxRuntimeExports.jsx(Text,{my:"md",children:xt.message}),jsxRuntimeExports.jsx(Group$1,{w:"100%",justify:"end",children:jsxRuntimeExports.jsx(Button,{onClick:Ft,color:"red",variant:"filled",m:"xs",children:"Continue Study"})})]})})}function StepRenderer(){const xt=reactExports.useRef([]),$t=useStudyConfig(),Ct=$t.uiConfig.windowEventDebounceTime??100,kt=useStoreSelector(qt=>qt.showStudyBrowser);reactExports.useEffect(()=>{const qt=debounce$2(ln=>{xt.current.push([Date.now(),"focus",ln.target instanceof HTMLElement?ln.target.tagName:""])},Ct,{maxWait:Ct}),Wt=debounce$2(ln=>{xt.current.push([Date.now(),"input",ln.data??""])},Ct,{maxWait:Ct}),Yt=debounce$2(ln=>{xt.current.push([Date.now(),"keypress",ln.key])},Ct,{maxWait:Ct}),Kt=debounce$2(ln=>{xt.current.push([Date.now(),"mousedown",[ln.clientX,ln.clientY]])},Ct,{maxWait:Ct}),Xt=debounce$2(ln=>{xt.current.push([Date.now(),"mouseup",[ln.clientX,ln.clientY]])},Ct,{maxWait:Ct}),Qt=debounce$2(()=>{xt.current.push([Date.now(),"resize",[window.innerWidth,window.innerHeight]])},Ct,{maxWait:Ct}),Jt=debounce$2(ln=>{xt.current.push([Date.now(),"mousemove",[ln.clientX,ln.clientY]])},Ct,{maxWait:Ct}),Zt=debounce$2(()=>{xt.current.push([Date.now(),"scroll",[window.scrollX,window.scrollY]])},Ct,{maxWait:Ct}),sn=debounce$2(()=>{xt.current.push([Date.now(),"visibility",document.visibilityState])},Ct,{maxWait:Ct});return window.addEventListener("focus",qt,!0),window.addEventListener("input",Wt),window.addEventListener("keypress",Yt),window.addEventListener("mousedown",Kt),window.addEventListener("mouseup",Xt),window.addEventListener("resize",Qt),window.addEventListener("mousemove",Jt),window.addEventListener("scroll",Zt),document.addEventListener("visibilitychange",sn),()=>{window.removeEventListener("focus",qt,!0),window.removeEventListener("input",Wt),window.removeEventListener("keypress",Yt),window.addEventListener("mousedown",Kt),window.addEventListener("mouseup",Xt),window.removeEventListener("resize",Qt),window.removeEventListener("mousemove",Jt),window.removeEventListener("scroll",Zt),document.removeEventListener("visibilitychange",sn)}},[]);const Mt=$t.uiConfig.sidebarWidth??300,{storageEngine:Ft}=useStorageEngine(),jt=useStudyId(),[Bt,Vt]=reactExports.useState(!1),[zt,Ht]=reactExports.useState(!1);reactExports.useEffect(()=>{(async()=>{if(Ft){const Wt=await Ft.getModes(jt);Vt(Wt.studyNavigatorEnabled),Ht(Wt.dataCollectionEnabled)}})()},[Ft,jt]);const Gt=reactExports.useMemo(()=>Bt&&kt,[Bt,kt]);return jsxRuntimeExports.jsx(WindowEventsContext.Provider,{value:xt,children:jsxRuntimeExports.jsxs(AppShell,{padding:"md",header:{height:70},navbar:{width:Mt,breakpoint:"xs",collapsed:{desktop:!$t.uiConfig.sidebar,mobile:!$t.uiConfig.sidebar}},aside:{width:360,breakpoint:"xs",collapsed:{desktop:!Gt,mobile:!Gt}},children:[jsxRuntimeExports.jsx(AppNavBar,{}),jsxRuntimeExports.jsx(AppAside,{}),jsxRuntimeExports.jsx(AppHeader$1,{studyNavigatorEnabled:Bt,dataCollectionEnabled:zt}),jsxRuntimeExports.jsx(HelpModal,{}),jsxRuntimeExports.jsx(AlertModal,{}),jsxRuntimeExports.jsx(AppShell.Main,{children:jsxRuntimeExports.jsx(Outlet,{})})]})})}function latinSquare(xt,$t=!1){return typeof xt=="number"?latinSquareBySize(xt,$t):latinSquareBySize(xt.length,$t).map(kt=>kt.map(Mt=>xt[Mt]))}function latinSquareBySize(xt,$t){if(xt<0)throw new Error("Latin square size must be > 0");if(xt==0)return[];if(xt==1)return[[0]];let Ct=new Array(xt);for(let Ft=0;Ft<xt;Ft++)Ft<2?Ct[Ft]=Ft:Ft%2==0?Ct[Ft]=xt-Ft/2:Ct[Ft]=Math.floor(Ft/2)+1;let kt=[Ct],Mt=Ct;for(let Ft=1;Ft<xt;Ft+=1){let jt=Mt.map(Bt=>(Bt+1)%xt);kt.push(jt),Mt=jt}if($t&&xt%2>0)for(let Ft=0;Ft<xt;Ft+=1)kt.push(kt[Ft].slice().reverse());return kt}function _componentBlockToSequence(xt,$t,Ct){let kt=xt.components;xt.order==="random"?kt=xt.components.sort(()=>.5-Math.random()):xt.order==="latinSquare"&&$t&&(kt=$t[Ct].pop().map(Mt=>Mt.startsWith("_componentBlock")?xt.components[+Mt.slice(15)]:Mt)),kt=kt.slice(0,xt.numSamples);for(let Mt=0;Mt<kt.length;Mt+=1){const Ft=kt[Mt];if(typeof Ft!="string"&&!Array.isArray(Ft)){const jt=xt.components.indexOf(Ft);kt[Mt]=_componentBlockToSequence(Ft,$t,`${Ct}-${jt}`)}}return xt.interruptions&&xt.interruptions.forEach(Mt=>{const Ft=[];if(Mt.spacing!=="random")for(let jt=0;jt<kt.length;jt+=1)(jt===Mt.firstLocation||jt>Mt.firstLocation&&jt%Mt.spacing===0)&&Ft.push(Mt.components),Ft.push(kt[jt]);if(Mt.spacing==="random"){const jt=new Set;if(Mt.numInterruptions>kt.length-1)throw new Error("Number of interruptions cannot be greater than the number of components");for(;jt.size<Mt.numInterruptions;){const zt=Math.floor(Math.random()*kt.length-1)+1;jt.add(zt)}const Bt=Array.from(jt).sort((zt,Ht)=>zt-Ht);let Vt=0;for(let zt=0;zt<kt.length;zt+=1)zt===Bt[Vt]&&(Ft.push(Mt.components),Vt+=1),Ft.push(kt[zt])}kt=Ft}),{id:xt.id,orderPath:Ct,components:kt.flat(),skip:xt.skip}}function componentBlockToSequence(xt,$t){const Ct=deepCopy(xt);return _componentBlockToSequence(Ct,$t,"root")}function _createRandomOrders(xt,$t,Ct,kt=0){const Mt=Ct.length>0?`${Ct}-${kt}`:"root";xt.order==="latinSquare"&&$t.push(Mt),xt.components.forEach((Ft,jt)=>{typeof Ft!="string"&&_createRandomOrders(Ft,$t,Mt,jt)})}function createRandomOrders(xt){const $t=[];return _createRandomOrders(xt,$t,"",0),$t}function generateLatinSquare(xt,$t){const Ct=$t.split("-");let kt={};Ct.forEach(jt=>{jt==="root"?kt=xt.sequence:kt=kt.components[+jt]});const Mt=kt.components.map((jt,Bt)=>typeof jt=="string"?jt:`_componentBlock${Bt}`);return latinSquare(Mt.sort(()=>.5-Math.random()),!0)}function generateSequenceArray(xt){const Ct=createRandomOrders(xt.sequence).map(Ft=>({[Ft]:generateLatinSquare(xt,Ft)})).reduce((Ft,jt)=>({...Ft,...jt}),{}),kt=xt.uiConfig.numSequences||1e3,Mt=[];return Array.from({length:kt}).forEach(()=>{const Ft=componentBlockToSequence(xt.sequence,Ct);Ft.components.push("end"),Mt.push(Ft),Object.entries(Ct).forEach(([jt,Bt])=>{Bt.length===0&&(Ct[jt]=generateLatinSquare(xt,jt))})}),Mt}var define_import_meta_env_default={VITE_BASE_PATH:"/SumSifter/",VITE_FIREBASE_CONFIG:`
{
  apiKey: "AIzaSyAt0JPT7QXK5N4Oc-n6gnEJEDtfUYQqpeU",
  authDomain: "sumsifterdemo.firebaseapp.com",
  projectId: "sumsifterdemo",
  storageBucket: "sumsifterdemo.appspot.com",
  messagingSenderId: "529083000336",
  appId: "1:529083000336:web:3af6cc2f15933822af0c95"
}
`,VITE_STORAGE_ENGINE:"firebase",VITE_RECAPTCHAV3TOKEN:"6LfZFvgpAAAAAASYVKyTVe7V0at6zdqBt8L1kI3I",VITE_SUMSIFTER_API_URL:"https://sumsifterchatbot.shrestha.club",BASE_URL:"/SumSifter/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};async function fetchStudyConfig(xt){const $t=await(await fetch(`${PREFIX$1}${xt}`)).text();return parseStudyConfig($t)}async function getStudyConfig(xt,$t){const Ct=$t.configsList.find(kt=>sanitizeStringForUrl(kt)===xt);if(Ct){const kt=$t.configs[Ct];return await fetchStudyConfig(`${kt.path}`)}return null}async function fetchStudyConfigs(xt){const $t={},Ct=xt.configsList.filter(Mt=>define_import_meta_env_default.VITE_CI==="true"?!0:!xt.configs[Mt].test).map(async Mt=>getStudyConfig(Mt,xt)),kt=await Promise.all(Ct);return xt.configsList.forEach((Mt,Ft)=>{$t[Mt]=kt[Ft]}),$t}function Shell({globalConfig:xt}){const $t=useStudyId(),[Ct,kt]=reactExports.useState(null),Mt=xt.configsList.includes($t);reactExports.useEffect(()=>{getStudyConfig($t,xt).then(Wt=>{kt(Wt)})},[xt,$t]);const[Ft,jt]=reactExports.useState([]),[Bt,Vt]=reactExports.useState(null),{storageEngine:zt}=useStorageEngine(),[Ht]=useSearchParams();reactExports.useEffect(()=>{async function Wt(){if(!zt||!Ct||!$t)return;await zt.initializeStudyDb($t,Ct),await zt.getSequenceArray()||await zt.setSequenceArray(await generateSequenceArray(Ct));const Kt=Ct.uiConfig.urlParticipantIdParam&&Ht.get(Ct.uiConfig.urlParticipantIdParam)||void 0,Xt=Object.fromEntries(Ht.entries()),Qt=await fetch("https://api.ipify.org?format=json").catch(dn=>""),Jt=Qt instanceof Response?await Qt.json():{ip:""},Zt={language:navigator.language,userAgent:navigator.userAgent,resolution:{width:window.screen.width,height:window.screen.height,availHeight:window.screen.availHeight,availWidth:window.screen.availWidth,colorDepth:window.screen.colorDepth,orientation:window.screen.orientation.type,pixelDepth:window.screen.pixelDepth},ip:Jt.ip},sn=await zt.initializeParticipantSession($t,Xt,Ct,Zt,Kt),ln=await studyStoreCreator($t,Ct,sn.sequence,Zt,sn.answers);Vt(ln),jt([{element:jsxRuntimeExports.jsx(StepRenderer,{}),children:[{path:"/",element:jsxRuntimeExports.jsx(NavigateWithParams,{to:"0",replace:!0})},{path:"/:index",element:Ct.errors.length>0?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Title,{order:2,mb:8,children:"Error loading config"}),jsxRuntimeExports.jsx(ErrorLoadingConfig,{issues:Ct.errors,type:"error"})]}):jsxRuntimeExports.jsx(ComponentController,{})}]}])}Wt()},[zt,Ct,$t,Ht]);const Gt=useRoutes(Ft);let qt=null;return Mt?Ft.length===0?qt=jsxRuntimeExports.jsx(LoadingOverlay,{visible:!0}):qt=Gt&&Bt?jsxRuntimeExports.jsx(StudyStoreContext.Provider,{value:Bt,children:jsxRuntimeExports.jsx(Provider_default,{store:Bt.store,children:Gt})}):jsxRuntimeExports.jsx(ResourceNotFound,{}):qt=jsxRuntimeExports.jsx(ResourceNotFound,{}),qt}var define_process_env_default$1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1=function(xt){const $t=[];let Ct=0;for(let kt=0;kt<xt.length;kt++){let Mt=xt.charCodeAt(kt);Mt<128?$t[Ct++]=Mt:Mt<2048?($t[Ct++]=Mt>>6|192,$t[Ct++]=Mt&63|128):(Mt&64512)===55296&&kt+1<xt.length&&(xt.charCodeAt(kt+1)&64512)===56320?(Mt=65536+((Mt&1023)<<10)+(xt.charCodeAt(++kt)&1023),$t[Ct++]=Mt>>18|240,$t[Ct++]=Mt>>12&63|128,$t[Ct++]=Mt>>6&63|128,$t[Ct++]=Mt&63|128):($t[Ct++]=Mt>>12|224,$t[Ct++]=Mt>>6&63|128,$t[Ct++]=Mt&63|128)}return $t},byteArrayToString=function(xt){const $t=[];let Ct=0,kt=0;for(;Ct<xt.length;){const Mt=xt[Ct++];if(Mt<128)$t[kt++]=String.fromCharCode(Mt);else if(Mt>191&&Mt<224){const Ft=xt[Ct++];$t[kt++]=String.fromCharCode((Mt&31)<<6|Ft&63)}else if(Mt>239&&Mt<365){const Ft=xt[Ct++],jt=xt[Ct++],Bt=xt[Ct++],Vt=((Mt&7)<<18|(Ft&63)<<12|(jt&63)<<6|Bt&63)-65536;$t[kt++]=String.fromCharCode(55296+(Vt>>10)),$t[kt++]=String.fromCharCode(56320+(Vt&1023))}else{const Ft=xt[Ct++],jt=xt[Ct++];$t[kt++]=String.fromCharCode((Mt&15)<<12|(Ft&63)<<6|jt&63)}}return $t.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(xt,$t){if(!Array.isArray(xt))throw Error("encodeByteArray takes an array as a parameter");this.init_();const Ct=$t?this.byteToCharMapWebSafe_:this.byteToCharMap_,kt=[];for(let Mt=0;Mt<xt.length;Mt+=3){const Ft=xt[Mt],jt=Mt+1<xt.length,Bt=jt?xt[Mt+1]:0,Vt=Mt+2<xt.length,zt=Vt?xt[Mt+2]:0,Ht=Ft>>2,Gt=(Ft&3)<<4|Bt>>4;let qt=(Bt&15)<<2|zt>>6,Wt=zt&63;Vt||(Wt=64,jt||(qt=64)),kt.push(Ct[Ht],Ct[Gt],Ct[qt],Ct[Wt])}return kt.join("")},encodeString(xt,$t){return this.HAS_NATIVE_SUPPORT&&!$t?btoa(xt):this.encodeByteArray(stringToByteArray$1(xt),$t)},decodeString(xt,$t){return this.HAS_NATIVE_SUPPORT&&!$t?atob(xt):byteArrayToString(this.decodeStringToByteArray(xt,$t))},decodeStringToByteArray(xt,$t){this.init_();const Ct=$t?this.charToByteMapWebSafe_:this.charToByteMap_,kt=[];for(let Mt=0;Mt<xt.length;){const Ft=Ct[xt.charAt(Mt++)],Bt=Mt<xt.length?Ct[xt.charAt(Mt)]:0;++Mt;const zt=Mt<xt.length?Ct[xt.charAt(Mt)]:64;++Mt;const Gt=Mt<xt.length?Ct[xt.charAt(Mt)]:64;if(++Mt,Ft==null||Bt==null||zt==null||Gt==null)throw new DecodeBase64StringError;const qt=Ft<<2|Bt>>4;if(kt.push(qt),zt!==64){const Wt=Bt<<4&240|zt>>2;if(kt.push(Wt),Gt!==64){const Yt=zt<<6&192|Gt;kt.push(Yt)}}}return kt},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let xt=0;xt<this.ENCODED_VALS.length;xt++)this.byteToCharMap_[xt]=this.ENCODED_VALS.charAt(xt),this.charToByteMap_[this.byteToCharMap_[xt]]=xt,this.byteToCharMapWebSafe_[xt]=this.ENCODED_VALS_WEBSAFE.charAt(xt),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[xt]]=xt,xt>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(xt)]=xt,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(xt)]=xt)}}};class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const base64Encode=function(xt){const $t=stringToByteArray$1(xt);return base64.encodeByteArray($t,!0)},base64urlEncodeWithoutPadding=function(xt){return base64Encode(xt).replace(/\./g,"")},base64Decode=function(xt){try{return base64.decodeString(xt,!0)}catch($t){console.error("base64Decode failed: ",$t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getGlobal(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const getDefaultsFromGlobal=()=>getGlobal().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(typeof process>"u"||typeof define_process_env_default$1>"u")return;const xt=define_process_env_default$1.__FIREBASE_DEFAULTS__;if(xt)return JSON.parse(xt)},getDefaultsFromCookie=()=>{if(typeof document>"u")return;let xt;try{xt=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const $t=xt&&base64Decode(xt[1]);return $t&&JSON.parse($t)},getDefaults=()=>{try{return getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(xt){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${xt}`);return}},getDefaultEmulatorHost=xt=>{var $t,Ct;return(Ct=($t=getDefaults())===null||$t===void 0?void 0:$t.emulatorHosts)===null||Ct===void 0?void 0:Ct[xt]},getDefaultEmulatorHostnameAndPort=xt=>{const $t=getDefaultEmulatorHost(xt);if(!$t)return;const Ct=$t.lastIndexOf(":");if(Ct<=0||Ct+1===$t.length)throw new Error(`Invalid host ${$t} with no separate hostname and port!`);const kt=parseInt($t.substring(Ct+1),10);return $t[0]==="["?[$t.substring(1,Ct-1),kt]:[$t.substring(0,Ct),kt]},getDefaultAppConfig=()=>{var xt;return(xt=getDefaults())===null||xt===void 0?void 0:xt.config},getExperimentalSetting=xt=>{var $t;return($t=getDefaults())===null||$t===void 0?void 0:$t[`_${xt}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(($t,Ct)=>{this.resolve=$t,this.reject=Ct})}wrapCallback($t){return(Ct,kt)=>{Ct?this.reject(Ct):this.resolve(kt),typeof $t=="function"&&(this.promise.catch(()=>{}),$t.length===1?$t(Ct):$t(Ct,kt))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createMockUserToken(xt,$t){if(xt.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const Ct={alg:"none",type:"JWT"},kt=$t||"demo-project",Mt=xt.iat||0,Ft=xt.sub||xt.user_id;if(!Ft)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const jt=Object.assign({iss:`https://securetoken.google.com/${kt}`,aud:kt,iat:Mt,exp:Mt+3600,auth_time:Mt,sub:Ft,user_id:Ft,firebase:{sign_in_provider:"custom",identities:{}}},xt);return[base64urlEncodeWithoutPadding(JSON.stringify(Ct)),base64urlEncodeWithoutPadding(JSON.stringify(jt)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isMobileCordova(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isNode(){var xt;const $t=(xt=getDefaults())===null||xt===void 0?void 0:xt.forceEnvironment;if($t==="node")return!0;if($t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function isBrowserExtension(){const xt=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof xt=="object"&&xt.id!==void 0}function isReactNative(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function isIE(){const xt=getUA();return xt.indexOf("MSIE ")>=0||xt.indexOf("Trident/")>=0}function isSafari(){return!isNode()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function isIndexedDBAvailable(){try{return typeof indexedDB=="object"}catch{return!1}}function validateIndexedDBOpenable(){return new Promise((xt,$t)=>{try{let Ct=!0;const kt="validate-browser-context-for-indexeddb-analytics-module",Mt=self.indexedDB.open(kt);Mt.onsuccess=()=>{Mt.result.close(),Ct||self.indexedDB.deleteDatabase(kt),xt(!0)},Mt.onupgradeneeded=()=>{Ct=!1},Mt.onerror=()=>{var Ft;$t(((Ft=Mt.error)===null||Ft===void 0?void 0:Ft.message)||"")}}catch(Ct){$t(Ct)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor($t,Ct,kt){super(Ct),this.code=$t,this.customData=kt,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor($t,Ct,kt){this.service=$t,this.serviceName=Ct,this.errors=kt}create($t,...Ct){const kt=Ct[0]||{},Mt=`${this.service}/${$t}`,Ft=this.errors[$t],jt=Ft?replaceTemplate(Ft,kt):"Error",Bt=`${this.serviceName}: ${jt} (${Mt}).`;return new FirebaseError(Mt,Bt,kt)}}function replaceTemplate(xt,$t){return xt.replace(PATTERN,(Ct,kt)=>{const Mt=$t[kt];return Mt!=null?String(Mt):`<${kt}?>`})}const PATTERN=/\{\$([^}]+)}/g;function isEmpty$2(xt){for(const $t in xt)if(Object.prototype.hasOwnProperty.call(xt,$t))return!1;return!0}function deepEqual$1(xt,$t){if(xt===$t)return!0;const Ct=Object.keys(xt),kt=Object.keys($t);for(const Mt of Ct){if(!kt.includes(Mt))return!1;const Ft=xt[Mt],jt=$t[Mt];if(isObject$1(Ft)&&isObject$1(jt)){if(!deepEqual$1(Ft,jt))return!1}else if(Ft!==jt)return!1}for(const Mt of kt)if(!Ct.includes(Mt))return!1;return!0}function isObject$1(xt){return xt!==null&&typeof xt=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function querystring(xt){const $t=[];for(const[Ct,kt]of Object.entries(xt))Array.isArray(kt)?kt.forEach(Mt=>{$t.push(encodeURIComponent(Ct)+"="+encodeURIComponent(Mt))}):$t.push(encodeURIComponent(Ct)+"="+encodeURIComponent(kt));return $t.length?"&"+$t.join("&"):""}function createSubscribe(xt,$t){const Ct=new ObserverProxy(xt,$t);return Ct.subscribe.bind(Ct)}class ObserverProxy{constructor($t,Ct){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=Ct,this.task.then(()=>{$t(this)}).catch(kt=>{this.error(kt)})}next($t){this.forEachObserver(Ct=>{Ct.next($t)})}error($t){this.forEachObserver(Ct=>{Ct.error($t)}),this.close($t)}complete(){this.forEachObserver($t=>{$t.complete()}),this.close()}subscribe($t,Ct,kt){let Mt;if($t===void 0&&Ct===void 0&&kt===void 0)throw new Error("Missing Observer.");implementsAnyMethods($t,["next","error","complete"])?Mt=$t:Mt={next:$t,error:Ct,complete:kt},Mt.next===void 0&&(Mt.next=noop$2),Mt.error===void 0&&(Mt.error=noop$2),Mt.complete===void 0&&(Mt.complete=noop$2);const Ft=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?Mt.error(this.finalError):Mt.complete()}catch{}}),this.observers.push(Mt),Ft}unsubscribeOne($t){this.observers===void 0||this.observers[$t]===void 0||(delete this.observers[$t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver($t){if(!this.finalized)for(let Ct=0;Ct<this.observers.length;Ct++)this.sendOne(Ct,$t)}sendOne($t,Ct){this.task.then(()=>{if(this.observers!==void 0&&this.observers[$t]!==void 0)try{Ct(this.observers[$t])}catch(kt){typeof console<"u"&&console.error&&console.error(kt)}})}close($t){this.finalized||(this.finalized=!0,$t!==void 0&&(this.finalError=$t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function implementsAnyMethods(xt,$t){if(typeof xt!="object"||xt===null)return!1;for(const Ct of $t)if(Ct in xt&&typeof xt[Ct]=="function")return!0;return!1}function noop$2(){}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,xt=>{const $t=Math.random()*16|0;return(xt==="x"?$t:$t&3|8).toString(16)})};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_INTERVAL_MILLIS=1e3,DEFAULT_BACKOFF_FACTOR=2,MAX_VALUE_MILLIS=4*60*60*1e3,RANDOM_FACTOR=.5;function calculateBackoffMillis(xt,$t=DEFAULT_INTERVAL_MILLIS,Ct=DEFAULT_BACKOFF_FACTOR){const kt=$t*Math.pow(Ct,xt),Mt=Math.round(RANDOM_FACTOR*kt*(Math.random()-.5)*2);return Math.min(MAX_VALUE_MILLIS,kt+Mt)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(xt){return xt&&xt._delegate?xt._delegate:xt}class Component{constructor($t,Ct,kt){this.name=$t,this.instanceFactory=Ct,this.type=kt,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode($t){return this.instantiationMode=$t,this}setMultipleInstances($t){return this.multipleInstances=$t,this}setServiceProps($t){return this.serviceProps=$t,this}setInstanceCreatedCallback($t){return this.onInstanceCreated=$t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME$1="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Provider{constructor($t,Ct){this.name=$t,this.container=Ct,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get($t){const Ct=this.normalizeInstanceIdentifier($t);if(!this.instancesDeferred.has(Ct)){const kt=new Deferred;if(this.instancesDeferred.set(Ct,kt),this.isInitialized(Ct)||this.shouldAutoInitialize())try{const Mt=this.getOrInitializeService({instanceIdentifier:Ct});Mt&&kt.resolve(Mt)}catch{}}return this.instancesDeferred.get(Ct).promise}getImmediate($t){var Ct;const kt=this.normalizeInstanceIdentifier($t==null?void 0:$t.identifier),Mt=(Ct=$t==null?void 0:$t.optional)!==null&&Ct!==void 0?Ct:!1;if(this.isInitialized(kt)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:kt})}catch(Ft){if(Mt)return null;throw Ft}else{if(Mt)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent($t){if($t.name!==this.name)throw Error(`Mismatching Component ${$t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=$t,!!this.shouldAutoInitialize()){if(isComponentEager($t))try{this.getOrInitializeService({instanceIdentifier:DEFAULT_ENTRY_NAME$1})}catch{}for(const[Ct,kt]of this.instancesDeferred.entries()){const Mt=this.normalizeInstanceIdentifier(Ct);try{const Ft=this.getOrInitializeService({instanceIdentifier:Mt});kt.resolve(Ft)}catch{}}}}clearInstance($t=DEFAULT_ENTRY_NAME$1){this.instancesDeferred.delete($t),this.instancesOptions.delete($t),this.instances.delete($t)}async delete(){const $t=Array.from(this.instances.values());await Promise.all([...$t.filter(Ct=>"INTERNAL"in Ct).map(Ct=>Ct.INTERNAL.delete()),...$t.filter(Ct=>"_delete"in Ct).map(Ct=>Ct._delete())])}isComponentSet(){return this.component!=null}isInitialized($t=DEFAULT_ENTRY_NAME$1){return this.instances.has($t)}getOptions($t=DEFAULT_ENTRY_NAME$1){return this.instancesOptions.get($t)||{}}initialize($t={}){const{options:Ct={}}=$t,kt=this.normalizeInstanceIdentifier($t.instanceIdentifier);if(this.isInitialized(kt))throw Error(`${this.name}(${kt}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Mt=this.getOrInitializeService({instanceIdentifier:kt,options:Ct});for(const[Ft,jt]of this.instancesDeferred.entries()){const Bt=this.normalizeInstanceIdentifier(Ft);kt===Bt&&jt.resolve(Mt)}return Mt}onInit($t,Ct){var kt;const Mt=this.normalizeInstanceIdentifier(Ct),Ft=(kt=this.onInitCallbacks.get(Mt))!==null&&kt!==void 0?kt:new Set;Ft.add($t),this.onInitCallbacks.set(Mt,Ft);const jt=this.instances.get(Mt);return jt&&$t(jt,Mt),()=>{Ft.delete($t)}}invokeOnInitCallbacks($t,Ct){const kt=this.onInitCallbacks.get(Ct);if(kt)for(const Mt of kt)try{Mt($t,Ct)}catch{}}getOrInitializeService({instanceIdentifier:$t,options:Ct={}}){let kt=this.instances.get($t);if(!kt&&this.component&&(kt=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory($t),options:Ct}),this.instances.set($t,kt),this.instancesOptions.set($t,Ct),this.invokeOnInitCallbacks(kt,$t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,$t,kt)}catch{}return kt||null}normalizeInstanceIdentifier($t=DEFAULT_ENTRY_NAME$1){return this.component?this.component.multipleInstances?$t:DEFAULT_ENTRY_NAME$1:$t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function normalizeIdentifierForFactory(xt){return xt===DEFAULT_ENTRY_NAME$1?void 0:xt}function isComponentEager(xt){return xt.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ComponentContainer{constructor($t){this.name=$t,this.providers=new Map}addComponent($t){const Ct=this.getProvider($t.name);if(Ct.isComponentSet())throw new Error(`Component ${$t.name} has already been registered with ${this.name}`);Ct.setComponent($t)}addOrOverwriteComponent($t){this.getProvider($t.name).isComponentSet()&&this.providers.delete($t.name),this.addComponent($t)}getProvider($t){if(this.providers.has($t))return this.providers.get($t);const Ct=new Provider($t,this);return this.providers.set($t,Ct),Ct}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LogLevel;(function(xt){xt[xt.DEBUG=0]="DEBUG",xt[xt.VERBOSE=1]="VERBOSE",xt[xt.INFO=2]="INFO",xt[xt.WARN=3]="WARN",xt[xt.ERROR=4]="ERROR",xt[xt.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(xt,$t,...Ct)=>{if($t<xt.logLevel)return;const kt=new Date().toISOString(),Mt=ConsoleMethod[$t];if(Mt)console[Mt](`[${kt}]  ${xt.name}:`,...Ct);else throw new Error(`Attempted to log a message with an invalid logType (value: ${$t})`)};class Logger{constructor($t){this.name=$t,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel($t){if(!($t in LogLevel))throw new TypeError(`Invalid value "${$t}" assigned to \`logLevel\``);this._logLevel=$t}setLogLevel($t){this._logLevel=typeof $t=="string"?levelStringToEnum[$t]:$t}get logHandler(){return this._logHandler}set logHandler($t){if(typeof $t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=$t}get userLogHandler(){return this._userLogHandler}set userLogHandler($t){this._userLogHandler=$t}debug(...$t){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,...$t),this._logHandler(this,LogLevel.DEBUG,...$t)}log(...$t){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,...$t),this._logHandler(this,LogLevel.VERBOSE,...$t)}info(...$t){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,...$t),this._logHandler(this,LogLevel.INFO,...$t)}warn(...$t){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,...$t),this._logHandler(this,LogLevel.WARN,...$t)}error(...$t){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,...$t),this._logHandler(this,LogLevel.ERROR,...$t)}}const instanceOfAny=(xt,$t)=>$t.some(Ct=>xt instanceof Ct);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(xt){const $t=new Promise((Ct,kt)=>{const Mt=()=>{xt.removeEventListener("success",Ft),xt.removeEventListener("error",jt)},Ft=()=>{Ct(wrap$1(xt.result)),Mt()},jt=()=>{kt(xt.error),Mt()};xt.addEventListener("success",Ft),xt.addEventListener("error",jt)});return $t.then(Ct=>{Ct instanceof IDBCursor&&cursorRequestMap.set(Ct,xt)}).catch(()=>{}),reverseTransformCache.set($t,xt),$t}function cacheDonePromiseForTransaction(xt){if(transactionDoneMap.has(xt))return;const $t=new Promise((Ct,kt)=>{const Mt=()=>{xt.removeEventListener("complete",Ft),xt.removeEventListener("error",jt),xt.removeEventListener("abort",jt)},Ft=()=>{Ct(),Mt()},jt=()=>{kt(xt.error||new DOMException("AbortError","AbortError")),Mt()};xt.addEventListener("complete",Ft),xt.addEventListener("error",jt),xt.addEventListener("abort",jt)});transactionDoneMap.set(xt,$t)}let idbProxyTraps={get(xt,$t,Ct){if(xt instanceof IDBTransaction){if($t==="done")return transactionDoneMap.get(xt);if($t==="objectStoreNames")return xt.objectStoreNames||transactionStoreNamesMap.get(xt);if($t==="store")return Ct.objectStoreNames[1]?void 0:Ct.objectStore(Ct.objectStoreNames[0])}return wrap$1(xt[$t])},set(xt,$t,Ct){return xt[$t]=Ct,!0},has(xt,$t){return xt instanceof IDBTransaction&&($t==="done"||$t==="store")?!0:$t in xt}};function replaceTraps(xt){idbProxyTraps=xt(idbProxyTraps)}function wrapFunction(xt){return xt===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function($t,...Ct){const kt=xt.call(unwrap(this),$t,...Ct);return transactionStoreNamesMap.set(kt,$t.sort?$t.sort():[$t]),wrap$1(kt)}:getCursorAdvanceMethods().includes(xt)?function(...$t){return xt.apply(unwrap(this),$t),wrap$1(cursorRequestMap.get(this))}:function(...$t){return wrap$1(xt.apply(unwrap(this),$t))}}function transformCachableValue(xt){return typeof xt=="function"?wrapFunction(xt):(xt instanceof IDBTransaction&&cacheDonePromiseForTransaction(xt),instanceOfAny(xt,getIdbProxyableTypes())?new Proxy(xt,idbProxyTraps):xt)}function wrap$1(xt){if(xt instanceof IDBRequest)return promisifyRequest(xt);if(transformCache.has(xt))return transformCache.get(xt);const $t=transformCachableValue(xt);return $t!==xt&&(transformCache.set(xt,$t),reverseTransformCache.set($t,xt)),$t}const unwrap=xt=>reverseTransformCache.get(xt);function openDB(xt,$t,{blocked:Ct,upgrade:kt,blocking:Mt,terminated:Ft}={}){const jt=indexedDB.open(xt,$t),Bt=wrap$1(jt);return kt&&jt.addEventListener("upgradeneeded",Vt=>{kt(wrap$1(jt.result),Vt.oldVersion,Vt.newVersion,wrap$1(jt.transaction),Vt)}),Ct&&jt.addEventListener("blocked",Vt=>Ct(Vt.oldVersion,Vt.newVersion,Vt)),Bt.then(Vt=>{Ft&&Vt.addEventListener("close",()=>Ft()),Mt&&Vt.addEventListener("versionchange",zt=>Mt(zt.oldVersion,zt.newVersion,zt))}).catch(()=>{}),Bt}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(xt,$t){if(!(xt instanceof IDBDatabase&&!($t in xt)&&typeof $t=="string"))return;if(cachedMethods.get($t))return cachedMethods.get($t);const Ct=$t.replace(/FromIndex$/,""),kt=$t!==Ct,Mt=writeMethods.includes(Ct);if(!(Ct in(kt?IDBIndex:IDBObjectStore).prototype)||!(Mt||readMethods.includes(Ct)))return;const Ft=async function(jt,...Bt){const Vt=this.transaction(jt,Mt?"readwrite":"readonly");let zt=Vt.store;return kt&&(zt=zt.index(Bt.shift())),(await Promise.all([zt[Ct](...Bt),Mt&&Vt.done]))[0]};return cachedMethods.set($t,Ft),Ft}replaceTraps(xt=>({...xt,get:($t,Ct,kt)=>getMethod($t,Ct)||xt.get($t,Ct,kt),has:($t,Ct)=>!!getMethod($t,Ct)||xt.has($t,Ct)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor($t){this.container=$t}getPlatformInfoString(){return this.container.getProviders().map(Ct=>{if(isVersionServiceProvider(Ct)){const kt=Ct.getImmediate();return`${kt.library}/${kt.version}`}else return null}).filter(Ct=>Ct).join(" ")}}function isVersionServiceProvider(xt){const $t=xt.getComponent();return($t==null?void 0:$t.type)==="VERSION"}const name$p="@firebase/app",version$1$1="0.10.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger$2=new Logger("@firebase/app"),name$o="@firebase/app-compat",name$n="@firebase/analytics-compat",name$m="@firebase/analytics",name$l="@firebase/app-check-compat",name$k="@firebase/app-check",name$j="@firebase/auth",name$i="@firebase/auth-compat",name$h="@firebase/database",name$g="@firebase/database-compat",name$f="@firebase/functions",name$e="@firebase/functions-compat",name$d="@firebase/installations",name$c="@firebase/installations-compat",name$b="@firebase/messaging",name$a="@firebase/messaging-compat",name$9="@firebase/performance",name$8="@firebase/performance-compat",name$7="@firebase/remote-config",name$6="@firebase/remote-config-compat",name$5$1="@firebase/storage",name$4$1="@firebase/storage-compat",name$3$1="@firebase/firestore",name$2$1="@firebase/vertexai-preview",name$1$1="@firebase/firestore-compat",name$q="firebase",version$9="10.12.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$p]:"fire-core",[name$o]:"fire-core-compat",[name$m]:"fire-analytics",[name$n]:"fire-analytics-compat",[name$k]:"fire-app-check",[name$l]:"fire-app-check-compat",[name$j]:"fire-auth",[name$i]:"fire-auth-compat",[name$h]:"fire-rtdb",[name$g]:"fire-rtdb-compat",[name$f]:"fire-fn",[name$e]:"fire-fn-compat",[name$d]:"fire-iid",[name$c]:"fire-iid-compat",[name$b]:"fire-fcm",[name$a]:"fire-fcm-compat",[name$9]:"fire-perf",[name$8]:"fire-perf-compat",[name$7]:"fire-rc",[name$6]:"fire-rc-compat",[name$5$1]:"fire-gcs",[name$4$1]:"fire-gcs-compat",[name$3$1]:"fire-fst",[name$1$1]:"fire-fst-compat",[name$2$1]:"fire-vertex","fire-js":"fire-js",[name$q]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_serverApps=new Map,_components=new Map;function _addComponent(xt,$t){try{xt.container.addComponent($t)}catch(Ct){logger$2.debug(`Component ${$t.name} failed to register with FirebaseApp ${xt.name}`,Ct)}}function _registerComponent(xt){const $t=xt.name;if(_components.has($t))return logger$2.debug(`There were multiple attempts to register component ${$t}.`),!1;_components.set($t,xt);for(const Ct of _apps.values())_addComponent(Ct,xt);for(const Ct of _serverApps.values())_addComponent(Ct,xt);return!0}function _getProvider(xt,$t){const Ct=xt.container.getProvider("heartbeat").getImmediate({optional:!0});return Ct&&Ct.triggerHeartbeat(),xt.container.getProvider($t)}function _isFirebaseServerApp(xt){return xt.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS$1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ERROR_FACTORY$1=new ErrorFactory("app","Firebase",ERRORS$1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAppImpl{constructor($t,Ct,kt){this._isDeleted=!1,this._options=Object.assign({},$t),this._config=Object.assign({},Ct),this._name=Ct.name,this._automaticDataCollectionEnabled=Ct.automaticDataCollectionEnabled,this._container=kt,this.container.addComponent(new Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled($t){this.checkDestroyed(),this._automaticDataCollectionEnabled=$t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted($t){this._isDeleted=$t}checkDestroyed(){if(this.isDeleted)throw ERROR_FACTORY$1.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION=version$9;function initializeApp(xt,$t={}){let Ct=xt;typeof $t!="object"&&($t={name:$t});const kt=Object.assign({name:DEFAULT_ENTRY_NAME,automaticDataCollectionEnabled:!1},$t),Mt=kt.name;if(typeof Mt!="string"||!Mt)throw ERROR_FACTORY$1.create("bad-app-name",{appName:String(Mt)});if(Ct||(Ct=getDefaultAppConfig()),!Ct)throw ERROR_FACTORY$1.create("no-options");const Ft=_apps.get(Mt);if(Ft){if(deepEqual$1(Ct,Ft.options)&&deepEqual$1(kt,Ft.config))return Ft;throw ERROR_FACTORY$1.create("duplicate-app",{appName:Mt})}const jt=new ComponentContainer(Mt);for(const Vt of _components.values())jt.addComponent(Vt);const Bt=new FirebaseAppImpl(Ct,kt,jt);return _apps.set(Mt,Bt),Bt}function getApp(xt=DEFAULT_ENTRY_NAME){const $t=_apps.get(xt);if(!$t&&xt===DEFAULT_ENTRY_NAME&&getDefaultAppConfig())return initializeApp();if(!$t)throw ERROR_FACTORY$1.create("no-app",{appName:xt});return $t}function registerVersion(xt,$t,Ct){var kt;let Mt=(kt=PLATFORM_LOG_STRING[xt])!==null&&kt!==void 0?kt:xt;Ct&&(Mt+=`-${Ct}`);const Ft=Mt.match(/\s|\//),jt=$t.match(/\s|\//);if(Ft||jt){const Bt=[`Unable to register library "${Mt}" with version "${$t}":`];Ft&&Bt.push(`library name "${Mt}" contains illegal characters (whitespace or "/")`),Ft&&jt&&Bt.push("and"),jt&&Bt.push(`version name "${$t}" contains illegal characters (whitespace or "/")`),logger$2.warn(Bt.join(" "));return}_registerComponent(new Component(`${Mt}-version`,()=>({library:Mt,version:$t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME$2="firebase-heartbeat-database",DB_VERSION$2=1,STORE_NAME$1="firebase-heartbeat-store";let dbPromise$1=null;function getDbPromise(){return dbPromise$1||(dbPromise$1=openDB(DB_NAME$2,DB_VERSION$2,{upgrade:(xt,$t)=>{switch($t){case 0:try{xt.createObjectStore(STORE_NAME$1)}catch(Ct){console.warn(Ct)}}}}).catch(xt=>{throw ERROR_FACTORY$1.create("idb-open",{originalErrorMessage:xt.message})})),dbPromise$1}async function readHeartbeatsFromIndexedDB(xt){try{const Ct=(await getDbPromise()).transaction(STORE_NAME$1),kt=await Ct.objectStore(STORE_NAME$1).get(computeKey$1(xt));return await Ct.done,kt}catch($t){if($t instanceof FirebaseError)logger$2.warn($t.message);else{const Ct=ERROR_FACTORY$1.create("idb-get",{originalErrorMessage:$t==null?void 0:$t.message});logger$2.warn(Ct.message)}}}async function writeHeartbeatsToIndexedDB(xt,$t){try{const kt=(await getDbPromise()).transaction(STORE_NAME$1,"readwrite");await kt.objectStore(STORE_NAME$1).put($t,computeKey$1(xt)),await kt.done}catch(Ct){if(Ct instanceof FirebaseError)logger$2.warn(Ct.message);else{const kt=ERROR_FACTORY$1.create("idb-set",{originalErrorMessage:Ct==null?void 0:Ct.message});logger$2.warn(kt.message)}}}function computeKey$1(xt){return`${xt.name}!${xt.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,STORED_HEARTBEAT_RETENTION_MAX_MILLIS=30*24*60*60*1e3;class HeartbeatServiceImpl{constructor($t){this.container=$t,this._heartbeatsCache=null;const Ct=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(Ct),this._heartbeatsCachePromise=this._storage.read().then(kt=>(this._heartbeatsCache=kt,kt))}async triggerHeartbeat(){var $t,Ct;const Mt=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),Ft=getUTCDateString();if(!((($t=this._heartbeatsCache)===null||$t===void 0?void 0:$t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((Ct=this._heartbeatsCache)===null||Ct===void 0?void 0:Ct.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===Ft||this._heartbeatsCache.heartbeats.some(jt=>jt.date===Ft)))return this._heartbeatsCache.heartbeats.push({date:Ft,agent:Mt}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(jt=>{const Bt=new Date(jt.date).valueOf();return Date.now()-Bt<=STORED_HEARTBEAT_RETENTION_MAX_MILLIS}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var $t;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,(($t=this._heartbeatsCache)===null||$t===void 0?void 0:$t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const Ct=getUTCDateString(),{heartbeatsToSend:kt,unsentEntries:Mt}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),Ft=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:kt}));return this._heartbeatsCache.lastSentHeartbeatDate=Ct,Mt.length>0?(this._heartbeatsCache.heartbeats=Mt,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),Ft}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(xt,$t=MAX_HEADER_BYTES){const Ct=[];let kt=xt.slice();for(const Mt of xt){const Ft=Ct.find(jt=>jt.agent===Mt.agent);if(Ft){if(Ft.dates.push(Mt.date),countBytes(Ct)>$t){Ft.dates.pop();break}}else if(Ct.push({agent:Mt.agent,dates:[Mt.date]}),countBytes(Ct)>$t){Ct.pop();break}kt=kt.slice(1)}return{heartbeatsToSend:Ct,unsentEntries:kt}}class HeartbeatStorageImpl{constructor($t){this.app=$t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const Ct=await readHeartbeatsFromIndexedDB(this.app);return Ct!=null&&Ct.heartbeats?Ct:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite($t){var Ct;if(await this._canUseIndexedDBPromise){const Mt=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(Ct=$t.lastSentHeartbeatDate)!==null&&Ct!==void 0?Ct:Mt.lastSentHeartbeatDate,heartbeats:$t.heartbeats})}else return}async add($t){var Ct;if(await this._canUseIndexedDBPromise){const Mt=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(Ct=$t.lastSentHeartbeatDate)!==null&&Ct!==void 0?Ct:Mt.lastSentHeartbeatDate,heartbeats:[...Mt.heartbeats,...$t.heartbeats]})}else return}}function countBytes(xt){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:xt})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(xt){_registerComponent(new Component("platform-logger",$t=>new PlatformLoggerServiceImpl($t),"PRIVATE")),_registerComponent(new Component("heartbeat",$t=>new HeartbeatServiceImpl($t),"PRIVATE")),registerVersion(name$p,version$1$1,xt),registerVersion(name$p,version$1$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents("");function _prodErrorMap(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const prodErrorMap=_prodErrorMap,_DEFAULT_AUTH_ERROR_FACTORY=new ErrorFactory("auth","Firebase",_prodErrorMap());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient=new Logger("@firebase/auth");function _logWarn(xt,...$t){logClient.logLevel<=LogLevel.WARN&&logClient.warn(`Auth (${SDK_VERSION}): ${xt}`,...$t)}function _logError(xt,...$t){logClient.logLevel<=LogLevel.ERROR&&logClient.error(`Auth (${SDK_VERSION}): ${xt}`,...$t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fail(xt,...$t){throw createErrorInternal(xt,...$t)}function _createError(xt,...$t){return createErrorInternal(xt,...$t)}function _errorWithCustomMessage(xt,$t,Ct){const kt=Object.assign(Object.assign({},prodErrorMap()),{[$t]:Ct});return new ErrorFactory("auth","Firebase",kt).create($t,{appName:xt.name})}function _serverAppCurrentUserOperationNotSupportedError(xt){return _errorWithCustomMessage(xt,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function _assertInstanceOf(xt,$t,Ct){const kt=Ct;if(!($t instanceof kt))throw kt.name!==$t.constructor.name&&_fail(xt,"argument-error"),_errorWithCustomMessage(xt,"argument-error",`Type of ${$t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function createErrorInternal(xt,...$t){if(typeof xt!="string"){const Ct=$t[0],kt=[...$t.slice(1)];return kt[0]&&(kt[0].appName=xt.name),xt._errorFactory.create(Ct,...kt)}return _DEFAULT_AUTH_ERROR_FACTORY.create(xt,...$t)}function _assert(xt,$t,...Ct){if(!xt)throw createErrorInternal($t,...Ct)}function debugFail(xt){const $t="INTERNAL ASSERTION FAILED: "+xt;throw _logError($t),new Error($t)}function debugAssert(xt,$t){xt||debugFail($t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getCurrentUrl(){var xt;return typeof self<"u"&&((xt=self.location)===null||xt===void 0?void 0:xt.href)||""}function _isHttpOrHttps(){return _getCurrentScheme()==="http:"||_getCurrentScheme()==="https:"}function _getCurrentScheme(){var xt;return typeof self<"u"&&((xt=self.location)===null||xt===void 0?void 0:xt.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isOnline(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_isHttpOrHttps()||isBrowserExtension()||"connection"in navigator)?navigator.onLine:!0}function _getUserLanguage(){if(typeof navigator>"u")return null;const xt=navigator;return xt.languages&&xt.languages[0]||xt.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Delay{constructor($t,Ct){this.shortDelay=$t,this.longDelay=Ct,debugAssert(Ct>$t,"Short delay should be less than long delay!"),this.isMobile=isMobileCordova()||isReactNative()}get(){return _isOnline()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _emulatorUrl(xt,$t){debugAssert(xt.emulator,"Emulator should always be set here");const{url:Ct}=xt.emulator;return $t?`${Ct}${$t.startsWith("/")?$t.slice(1):$t}`:Ct}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FetchProvider{static initialize($t,Ct,kt){this.fetchImpl=$t,Ct&&(this.headersImpl=Ct),kt&&(this.responseImpl=kt)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;debugFail("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;debugFail("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;debugFail("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SERVER_ERROR_MAP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_API_TIMEOUT_MS=new Delay(3e4,6e4);function _addTidIfNecessary(xt,$t){return xt.tenantId&&!$t.tenantId?Object.assign(Object.assign({},$t),{tenantId:xt.tenantId}):$t}async function _performApiRequest(xt,$t,Ct,kt,Mt={}){return _performFetchWithErrorHandling(xt,Mt,async()=>{let Ft={},jt={};kt&&($t==="GET"?jt=kt:Ft={body:JSON.stringify(kt)});const Bt=querystring(Object.assign({key:xt.config.apiKey},jt)).slice(1),Vt=await xt._getAdditionalHeaders();return Vt["Content-Type"]="application/json",xt.languageCode&&(Vt["X-Firebase-Locale"]=xt.languageCode),FetchProvider.fetch()(_getFinalTarget(xt,xt.config.apiHost,Ct,Bt),Object.assign({method:$t,headers:Vt,referrerPolicy:"no-referrer"},Ft))})}async function _performFetchWithErrorHandling(xt,$t,Ct){xt._canInitEmulator=!1;const kt=Object.assign(Object.assign({},SERVER_ERROR_MAP),$t);try{const Mt=new NetworkTimeout(xt),Ft=await Promise.race([Ct(),Mt.promise]);Mt.clearNetworkTimeout();const jt=await Ft.json();if("needConfirmation"in jt)throw _makeTaggedError(xt,"account-exists-with-different-credential",jt);if(Ft.ok&&!("errorMessage"in jt))return jt;{const Bt=Ft.ok?jt.errorMessage:jt.error.message,[Vt,zt]=Bt.split(" : ");if(Vt==="FEDERATED_USER_ID_ALREADY_LINKED")throw _makeTaggedError(xt,"credential-already-in-use",jt);if(Vt==="EMAIL_EXISTS")throw _makeTaggedError(xt,"email-already-in-use",jt);if(Vt==="USER_DISABLED")throw _makeTaggedError(xt,"user-disabled",jt);const Ht=kt[Vt]||Vt.toLowerCase().replace(/[_\s]+/g,"-");if(zt)throw _errorWithCustomMessage(xt,Ht,zt);_fail(xt,Ht)}}catch(Mt){if(Mt instanceof FirebaseError)throw Mt;_fail(xt,"network-request-failed",{message:String(Mt)})}}async function _performSignInRequest(xt,$t,Ct,kt,Mt={}){const Ft=await _performApiRequest(xt,$t,Ct,kt,Mt);return"mfaPendingCredential"in Ft&&_fail(xt,"multi-factor-auth-required",{_serverResponse:Ft}),Ft}function _getFinalTarget(xt,$t,Ct,kt){const Mt=`${$t}${Ct}?${kt}`;return xt.config.emulator?_emulatorUrl(xt.config,Mt):`${xt.config.apiScheme}://${Mt}`}class NetworkTimeout{constructor($t){this.auth=$t,this.timer=null,this.promise=new Promise((Ct,kt)=>{this.timer=setTimeout(()=>kt(_createError(this.auth,"network-request-failed")),DEFAULT_API_TIMEOUT_MS.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function _makeTaggedError(xt,$t,Ct){const kt={appName:xt.name};Ct.email&&(kt.email=Ct.email),Ct.phoneNumber&&(kt.phoneNumber=Ct.phoneNumber);const Mt=_createError(xt,$t,kt);return Mt.customData._tokenResponse=Ct,Mt}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function deleteAccount(xt,$t){return _performApiRequest(xt,"POST","/v1/accounts:delete",$t)}async function getAccountInfo(xt,$t){return _performApiRequest(xt,"POST","/v1/accounts:lookup",$t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function utcTimestampToDateString(xt){if(xt)try{const $t=new Date(Number(xt));if(!isNaN($t.getTime()))return $t.toUTCString()}catch{}}async function getIdTokenResult(xt,$t=!1){const Ct=getModularInstance(xt),kt=await Ct.getIdToken($t),Mt=_parseToken(kt);_assert(Mt&&Mt.exp&&Mt.auth_time&&Mt.iat,Ct.auth,"internal-error");const Ft=typeof Mt.firebase=="object"?Mt.firebase:void 0,jt=Ft==null?void 0:Ft.sign_in_provider;return{claims:Mt,token:kt,authTime:utcTimestampToDateString(secondsStringToMilliseconds(Mt.auth_time)),issuedAtTime:utcTimestampToDateString(secondsStringToMilliseconds(Mt.iat)),expirationTime:utcTimestampToDateString(secondsStringToMilliseconds(Mt.exp)),signInProvider:jt||null,signInSecondFactor:(Ft==null?void 0:Ft.sign_in_second_factor)||null}}function secondsStringToMilliseconds(xt){return Number(xt)*1e3}function _parseToken(xt){const[$t,Ct,kt]=xt.split(".");if($t===void 0||Ct===void 0||kt===void 0)return _logError("JWT malformed, contained fewer than 3 sections"),null;try{const Mt=base64Decode(Ct);return Mt?JSON.parse(Mt):(_logError("Failed to decode base64 JWT payload"),null)}catch(Mt){return _logError("Caught error parsing JWT payload as JSON",Mt==null?void 0:Mt.toString()),null}}function _tokenExpiresIn(xt){const $t=_parseToken(xt);return _assert($t,"internal-error"),_assert(typeof $t.exp<"u","internal-error"),_assert(typeof $t.iat<"u","internal-error"),Number($t.exp)-Number($t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _logoutIfInvalidated(xt,$t,Ct=!1){if(Ct)return $t;try{return await $t}catch(kt){throw kt instanceof FirebaseError&&isUserInvalidated(kt)&&xt.auth.currentUser===xt&&await xt.auth.signOut(),kt}}function isUserInvalidated({code:xt}){return xt==="auth/user-disabled"||xt==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ProactiveRefresh{constructor($t){this.user=$t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval($t){var Ct;if($t){const kt=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),kt}else{this.errorBackoff=3e4;const Mt=((Ct=this.user.stsTokenManager.expirationTime)!==null&&Ct!==void 0?Ct:0)-Date.now()-3e5;return Math.max(0,Mt)}}schedule($t=!1){if(!this.isRunning)return;const Ct=this.getInterval($t);this.timerId=setTimeout(async()=>{await this.iteration()},Ct)}async iteration(){try{await this.user.getIdToken(!0)}catch($t){($t==null?void 0:$t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserMetadata{constructor($t,Ct){this.createdAt=$t,this.lastLoginAt=Ct,this._initializeTime()}_initializeTime(){this.lastSignInTime=utcTimestampToDateString(this.lastLoginAt),this.creationTime=utcTimestampToDateString(this.createdAt)}_copy($t){this.createdAt=$t.createdAt,this.lastLoginAt=$t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reloadWithoutSaving(xt){var $t;const Ct=xt.auth,kt=await xt.getIdToken(),Mt=await _logoutIfInvalidated(xt,getAccountInfo(Ct,{idToken:kt}));_assert(Mt==null?void 0:Mt.users.length,Ct,"internal-error");const Ft=Mt.users[0];xt._notifyReloadListener(Ft);const jt=!(($t=Ft.providerUserInfo)===null||$t===void 0)&&$t.length?extractProviderData(Ft.providerUserInfo):[],Bt=mergeProviderData(xt.providerData,jt),Vt=xt.isAnonymous,zt=!(xt.email&&Ft.passwordHash)&&!(Bt!=null&&Bt.length),Ht=Vt?zt:!1,Gt={uid:Ft.localId,displayName:Ft.displayName||null,photoURL:Ft.photoUrl||null,email:Ft.email||null,emailVerified:Ft.emailVerified||!1,phoneNumber:Ft.phoneNumber||null,tenantId:Ft.tenantId||null,providerData:Bt,metadata:new UserMetadata(Ft.createdAt,Ft.lastLoginAt),isAnonymous:Ht};Object.assign(xt,Gt)}async function reload(xt){const $t=getModularInstance(xt);await _reloadWithoutSaving($t),await $t.auth._persistUserIfCurrent($t),$t.auth._notifyListenersIfCurrent($t)}function mergeProviderData(xt,$t){return[...xt.filter(kt=>!$t.some(Mt=>Mt.providerId===kt.providerId)),...$t]}function extractProviderData(xt){return xt.map($t=>{var{providerId:Ct}=$t,kt=__rest$1($t,["providerId"]);return{providerId:Ct,uid:kt.rawId||"",displayName:kt.displayName||null,email:kt.email||null,phoneNumber:kt.phoneNumber||null,photoURL:kt.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function requestStsToken(xt,$t){const Ct=await _performFetchWithErrorHandling(xt,{},async()=>{const kt=querystring({grant_type:"refresh_token",refresh_token:$t}).slice(1),{tokenApiHost:Mt,apiKey:Ft}=xt.config,jt=_getFinalTarget(xt,Mt,"/v1/token",`key=${Ft}`),Bt=await xt._getAdditionalHeaders();return Bt["Content-Type"]="application/x-www-form-urlencoded",FetchProvider.fetch()(jt,{method:"POST",headers:Bt,body:kt})});return{accessToken:Ct.access_token,expiresIn:Ct.expires_in,refreshToken:Ct.refresh_token}}async function revokeToken(xt,$t){return _performApiRequest(xt,"POST","/v2/accounts:revokeToken",_addTidIfNecessary(xt,$t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StsTokenManager{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse($t){_assert($t.idToken,"internal-error"),_assert(typeof $t.idToken<"u","internal-error"),_assert(typeof $t.refreshToken<"u","internal-error");const Ct="expiresIn"in $t&&typeof $t.expiresIn<"u"?Number($t.expiresIn):_tokenExpiresIn($t.idToken);this.updateTokensAndExpiration($t.idToken,$t.refreshToken,Ct)}updateFromIdToken($t){_assert($t.length!==0,"internal-error");const Ct=_tokenExpiresIn($t);this.updateTokensAndExpiration($t,null,Ct)}async getToken($t,Ct=!1){return!Ct&&this.accessToken&&!this.isExpired?this.accessToken:(_assert(this.refreshToken,$t,"user-token-expired"),this.refreshToken?(await this.refresh($t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh($t,Ct){const{accessToken:kt,refreshToken:Mt,expiresIn:Ft}=await requestStsToken($t,Ct);this.updateTokensAndExpiration(kt,Mt,Number(Ft))}updateTokensAndExpiration($t,Ct,kt){this.refreshToken=Ct||null,this.accessToken=$t||null,this.expirationTime=Date.now()+kt*1e3}static fromJSON($t,Ct){const{refreshToken:kt,accessToken:Mt,expirationTime:Ft}=Ct,jt=new StsTokenManager;return kt&&(_assert(typeof kt=="string","internal-error",{appName:$t}),jt.refreshToken=kt),Mt&&(_assert(typeof Mt=="string","internal-error",{appName:$t}),jt.accessToken=Mt),Ft&&(_assert(typeof Ft=="number","internal-error",{appName:$t}),jt.expirationTime=Ft),jt}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign($t){this.accessToken=$t.accessToken,this.refreshToken=$t.refreshToken,this.expirationTime=$t.expirationTime}_clone(){return Object.assign(new StsTokenManager,this.toJSON())}_performRefresh(){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function assertStringOrUndefined(xt,$t){_assert(typeof xt=="string"||typeof xt>"u","internal-error",{appName:$t})}class UserImpl{constructor($t){var{uid:Ct,auth:kt,stsTokenManager:Mt}=$t,Ft=__rest$1($t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ProactiveRefresh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=Ct,this.auth=kt,this.stsTokenManager=Mt,this.accessToken=Mt.accessToken,this.displayName=Ft.displayName||null,this.email=Ft.email||null,this.emailVerified=Ft.emailVerified||!1,this.phoneNumber=Ft.phoneNumber||null,this.photoURL=Ft.photoURL||null,this.isAnonymous=Ft.isAnonymous||!1,this.tenantId=Ft.tenantId||null,this.providerData=Ft.providerData?[...Ft.providerData]:[],this.metadata=new UserMetadata(Ft.createdAt||void 0,Ft.lastLoginAt||void 0)}async getIdToken($t){const Ct=await _logoutIfInvalidated(this,this.stsTokenManager.getToken(this.auth,$t));return _assert(Ct,this.auth,"internal-error"),this.accessToken!==Ct&&(this.accessToken=Ct,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),Ct}getIdTokenResult($t){return getIdTokenResult(this,$t)}reload(){return reload(this)}_assign($t){this!==$t&&(_assert(this.uid===$t.uid,this.auth,"internal-error"),this.displayName=$t.displayName,this.photoURL=$t.photoURL,this.email=$t.email,this.emailVerified=$t.emailVerified,this.phoneNumber=$t.phoneNumber,this.isAnonymous=$t.isAnonymous,this.tenantId=$t.tenantId,this.providerData=$t.providerData.map(Ct=>Object.assign({},Ct)),this.metadata._copy($t.metadata),this.stsTokenManager._assign($t.stsTokenManager))}_clone($t){const Ct=new UserImpl(Object.assign(Object.assign({},this),{auth:$t,stsTokenManager:this.stsTokenManager._clone()}));return Ct.metadata._copy(this.metadata),Ct}_onReload($t){_assert(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=$t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener($t){this.reloadListener?this.reloadListener($t):this.reloadUserInfo=$t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary($t,Ct=!1){let kt=!1;$t.idToken&&$t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse($t),kt=!0),Ct&&await _reloadWithoutSaving(this),await this.auth._persistUserIfCurrent(this),kt&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_isFirebaseServerApp(this.auth.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this.auth));const $t=await this.getIdToken();return await _logoutIfInvalidated(this,deleteAccount(this.auth,{idToken:$t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map($t=>Object.assign({},$t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON($t,Ct){var kt,Mt,Ft,jt,Bt,Vt,zt,Ht;const Gt=(kt=Ct.displayName)!==null&&kt!==void 0?kt:void 0,qt=(Mt=Ct.email)!==null&&Mt!==void 0?Mt:void 0,Wt=(Ft=Ct.phoneNumber)!==null&&Ft!==void 0?Ft:void 0,Yt=(jt=Ct.photoURL)!==null&&jt!==void 0?jt:void 0,Kt=(Bt=Ct.tenantId)!==null&&Bt!==void 0?Bt:void 0,Xt=(Vt=Ct._redirectEventId)!==null&&Vt!==void 0?Vt:void 0,Qt=(zt=Ct.createdAt)!==null&&zt!==void 0?zt:void 0,Jt=(Ht=Ct.lastLoginAt)!==null&&Ht!==void 0?Ht:void 0,{uid:Zt,emailVerified:sn,isAnonymous:ln,providerData:dn,stsTokenManager:hn}=Ct;_assert(Zt&&hn,$t,"internal-error");const cn=StsTokenManager.fromJSON(this.name,hn);_assert(typeof Zt=="string",$t,"internal-error"),assertStringOrUndefined(Gt,$t.name),assertStringOrUndefined(qt,$t.name),_assert(typeof sn=="boolean",$t,"internal-error"),_assert(typeof ln=="boolean",$t,"internal-error"),assertStringOrUndefined(Wt,$t.name),assertStringOrUndefined(Yt,$t.name),assertStringOrUndefined(Kt,$t.name),assertStringOrUndefined(Xt,$t.name),assertStringOrUndefined(Qt,$t.name),assertStringOrUndefined(Jt,$t.name);const pn=new UserImpl({uid:Zt,auth:$t,email:qt,emailVerified:sn,displayName:Gt,isAnonymous:ln,photoURL:Yt,phoneNumber:Wt,tenantId:Kt,stsTokenManager:cn,createdAt:Qt,lastLoginAt:Jt});return dn&&Array.isArray(dn)&&(pn.providerData=dn.map(yn=>Object.assign({},yn))),Xt&&(pn._redirectEventId=Xt),pn}static async _fromIdTokenResponse($t,Ct,kt=!1){const Mt=new StsTokenManager;Mt.updateFromServerResponse(Ct);const Ft=new UserImpl({uid:Ct.localId,auth:$t,stsTokenManager:Mt,isAnonymous:kt});return await _reloadWithoutSaving(Ft),Ft}static async _fromGetAccountInfoResponse($t,Ct,kt){const Mt=Ct.users[0];_assert(Mt.localId!==void 0,"internal-error");const Ft=Mt.providerUserInfo!==void 0?extractProviderData(Mt.providerUserInfo):[],jt=!(Mt.email&&Mt.passwordHash)&&!(Ft!=null&&Ft.length),Bt=new StsTokenManager;Bt.updateFromIdToken(kt);const Vt=new UserImpl({uid:Mt.localId,auth:$t,stsTokenManager:Bt,isAnonymous:jt}),zt={uid:Mt.localId,displayName:Mt.displayName||null,photoURL:Mt.photoUrl||null,email:Mt.email||null,emailVerified:Mt.emailVerified||!1,phoneNumber:Mt.phoneNumber||null,tenantId:Mt.tenantId||null,providerData:Ft,metadata:new UserMetadata(Mt.createdAt,Mt.lastLoginAt),isAnonymous:!(Mt.email&&Mt.passwordHash)&&!(Ft!=null&&Ft.length)};return Object.assign(Vt,zt),Vt}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const instanceCache=new Map;function _getInstance(xt){debugAssert(xt instanceof Function,"Expected a class definition");let $t=instanceCache.get(xt);return $t?(debugAssert($t instanceof xt,"Instance stored in cache mismatched with class"),$t):($t=new xt,instanceCache.set(xt,$t),$t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class InMemoryPersistence{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set($t,Ct){this.storage[$t]=Ct}async _get($t){const Ct=this.storage[$t];return Ct===void 0?null:Ct}async _remove($t){delete this.storage[$t]}_addListener($t,Ct){}_removeListener($t,Ct){}}InMemoryPersistence.type="NONE";const inMemoryPersistence=InMemoryPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _persistenceKeyName(xt,$t,Ct){return`firebase:${xt}:${$t}:${Ct}`}class PersistenceUserManager{constructor($t,Ct,kt){this.persistence=$t,this.auth=Ct,this.userKey=kt;const{config:Mt,name:Ft}=this.auth;this.fullUserKey=_persistenceKeyName(this.userKey,Mt.apiKey,Ft),this.fullPersistenceKey=_persistenceKeyName("persistence",Mt.apiKey,Ft),this.boundEventHandler=Ct._onStorageEvent.bind(Ct),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser($t){return this.persistence._set(this.fullUserKey,$t.toJSON())}async getCurrentUser(){const $t=await this.persistence._get(this.fullUserKey);return $t?UserImpl._fromJSON(this.auth,$t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence($t){if(this.persistence===$t)return;const Ct=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=$t,Ct)return this.setCurrentUser(Ct)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create($t,Ct,kt="authUser"){if(!Ct.length)return new PersistenceUserManager(_getInstance(inMemoryPersistence),$t,kt);const Mt=(await Promise.all(Ct.map(async zt=>{if(await zt._isAvailable())return zt}))).filter(zt=>zt);let Ft=Mt[0]||_getInstance(inMemoryPersistence);const jt=_persistenceKeyName(kt,$t.config.apiKey,$t.name);let Bt=null;for(const zt of Ct)try{const Ht=await zt._get(jt);if(Ht){const Gt=UserImpl._fromJSON($t,Ht);zt!==Ft&&(Bt=Gt),Ft=zt;break}}catch{}const Vt=Mt.filter(zt=>zt._shouldAllowMigration);return!Ft._shouldAllowMigration||!Vt.length?new PersistenceUserManager(Ft,$t,kt):(Ft=Vt[0],Bt&&await Ft._set(jt,Bt.toJSON()),await Promise.all(Ct.map(async zt=>{if(zt!==Ft)try{await zt._remove(jt)}catch{}})),new PersistenceUserManager(Ft,$t,kt))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getBrowserName(xt){const $t=xt.toLowerCase();if($t.includes("opera/")||$t.includes("opr/")||$t.includes("opios/"))return"Opera";if(_isIEMobile($t))return"IEMobile";if($t.includes("msie")||$t.includes("trident/"))return"IE";if($t.includes("edge/"))return"Edge";if(_isFirefox($t))return"Firefox";if($t.includes("silk/"))return"Silk";if(_isBlackBerry($t))return"Blackberry";if(_isWebOS($t))return"Webos";if(_isSafari($t))return"Safari";if(($t.includes("chrome/")||_isChromeIOS($t))&&!$t.includes("edge/"))return"Chrome";if(_isAndroid($t))return"Android";{const Ct=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,kt=xt.match(Ct);if((kt==null?void 0:kt.length)===2)return kt[1]}return"Other"}function _isFirefox(xt=getUA()){return/firefox\//i.test(xt)}function _isSafari(xt=getUA()){const $t=xt.toLowerCase();return $t.includes("safari/")&&!$t.includes("chrome/")&&!$t.includes("crios/")&&!$t.includes("android")}function _isChromeIOS(xt=getUA()){return/crios\//i.test(xt)}function _isIEMobile(xt=getUA()){return/iemobile/i.test(xt)}function _isAndroid(xt=getUA()){return/android/i.test(xt)}function _isBlackBerry(xt=getUA()){return/blackberry/i.test(xt)}function _isWebOS(xt=getUA()){return/webos/i.test(xt)}function _isIOS(xt=getUA()){return/iphone|ipad|ipod/i.test(xt)||/macintosh/i.test(xt)&&/mobile/i.test(xt)}function _isIOSStandalone(xt=getUA()){var $t;return _isIOS(xt)&&!!(!(($t=window.navigator)===null||$t===void 0)&&$t.standalone)}function _isIE10(){return isIE()&&document.documentMode===10}function _isMobileBrowser(xt=getUA()){return _isIOS(xt)||_isAndroid(xt)||_isWebOS(xt)||_isBlackBerry(xt)||/windows phone/i.test(xt)||_isIEMobile(xt)}function _isIframe(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getClientVersion(xt,$t=[]){let Ct;switch(xt){case"Browser":Ct=_getBrowserName(getUA());break;case"Worker":Ct=`${_getBrowserName(getUA())}-${xt}`;break;default:Ct=xt}const kt=$t.length?$t.join(","):"FirebaseCore-web";return`${Ct}/JsCore/${SDK_VERSION}/${kt}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthMiddlewareQueue{constructor($t){this.auth=$t,this.queue=[]}pushCallback($t,Ct){const kt=Ft=>new Promise((jt,Bt)=>{try{const Vt=$t(Ft);jt(Vt)}catch(Vt){Bt(Vt)}});kt.onAbort=Ct,this.queue.push(kt);const Mt=this.queue.length-1;return()=>{this.queue[Mt]=()=>Promise.resolve()}}async runMiddleware($t){if(this.auth.currentUser===$t)return;const Ct=[];try{for(const kt of this.queue)await kt($t),kt.onAbort&&Ct.push(kt.onAbort)}catch(kt){Ct.reverse();for(const Mt of Ct)try{Mt()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:kt==null?void 0:kt.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getPasswordPolicy(xt,$t={}){return _performApiRequest(xt,"GET","/v2/passwordPolicy",_addTidIfNecessary(xt,$t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MINIMUM_MIN_PASSWORD_LENGTH=6;class PasswordPolicyImpl{constructor($t){var Ct,kt,Mt,Ft;const jt=$t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(Ct=jt.minPasswordLength)!==null&&Ct!==void 0?Ct:MINIMUM_MIN_PASSWORD_LENGTH,jt.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=jt.maxPasswordLength),jt.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=jt.containsLowercaseCharacter),jt.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=jt.containsUppercaseCharacter),jt.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=jt.containsNumericCharacter),jt.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=jt.containsNonAlphanumericCharacter),this.enforcementState=$t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(Mt=(kt=$t.allowedNonAlphanumericCharacters)===null||kt===void 0?void 0:kt.join(""))!==null&&Mt!==void 0?Mt:"",this.forceUpgradeOnSignin=(Ft=$t.forceUpgradeOnSignin)!==null&&Ft!==void 0?Ft:!1,this.schemaVersion=$t.schemaVersion}validatePassword($t){var Ct,kt,Mt,Ft,jt,Bt;const Vt={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions($t,Vt),this.validatePasswordCharacterOptions($t,Vt),Vt.isValid&&(Vt.isValid=(Ct=Vt.meetsMinPasswordLength)!==null&&Ct!==void 0?Ct:!0),Vt.isValid&&(Vt.isValid=(kt=Vt.meetsMaxPasswordLength)!==null&&kt!==void 0?kt:!0),Vt.isValid&&(Vt.isValid=(Mt=Vt.containsLowercaseLetter)!==null&&Mt!==void 0?Mt:!0),Vt.isValid&&(Vt.isValid=(Ft=Vt.containsUppercaseLetter)!==null&&Ft!==void 0?Ft:!0),Vt.isValid&&(Vt.isValid=(jt=Vt.containsNumericCharacter)!==null&&jt!==void 0?jt:!0),Vt.isValid&&(Vt.isValid=(Bt=Vt.containsNonAlphanumericCharacter)!==null&&Bt!==void 0?Bt:!0),Vt}validatePasswordLengthOptions($t,Ct){const kt=this.customStrengthOptions.minPasswordLength,Mt=this.customStrengthOptions.maxPasswordLength;kt&&(Ct.meetsMinPasswordLength=$t.length>=kt),Mt&&(Ct.meetsMaxPasswordLength=$t.length<=Mt)}validatePasswordCharacterOptions($t,Ct){this.updatePasswordCharacterOptionsStatuses(Ct,!1,!1,!1,!1);let kt;for(let Mt=0;Mt<$t.length;Mt++)kt=$t.charAt(Mt),this.updatePasswordCharacterOptionsStatuses(Ct,kt>="a"&&kt<="z",kt>="A"&&kt<="Z",kt>="0"&&kt<="9",this.allowedNonAlphanumericCharacters.includes(kt))}updatePasswordCharacterOptionsStatuses($t,Ct,kt,Mt,Ft){this.customStrengthOptions.containsLowercaseLetter&&($t.containsLowercaseLetter||($t.containsLowercaseLetter=Ct)),this.customStrengthOptions.containsUppercaseLetter&&($t.containsUppercaseLetter||($t.containsUppercaseLetter=kt)),this.customStrengthOptions.containsNumericCharacter&&($t.containsNumericCharacter||($t.containsNumericCharacter=Mt)),this.customStrengthOptions.containsNonAlphanumericCharacter&&($t.containsNonAlphanumericCharacter||($t.containsNonAlphanumericCharacter=Ft))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthImpl{constructor($t,Ct,kt,Mt){this.app=$t,this.heartbeatServiceProvider=Ct,this.appCheckServiceProvider=kt,this.config=Mt,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Subscription(this),this.idTokenSubscription=new Subscription(this),this.beforeStateQueue=new AuthMiddlewareQueue(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_DEFAULT_AUTH_ERROR_FACTORY,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=$t.name,this.clientVersion=Mt.sdkClientVersion}_initializeWithPersistence($t,Ct){return Ct&&(this._popupRedirectResolver=_getInstance(Ct)),this._initializationPromise=this.queue(async()=>{var kt,Mt;if(!this._deleted&&(this.persistenceManager=await PersistenceUserManager.create(this,$t),!this._deleted)){if(!((kt=this._popupRedirectResolver)===null||kt===void 0)&&kt._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(Ct),this.lastNotifiedUid=((Mt=this.currentUser)===null||Mt===void 0?void 0:Mt.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const $t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!$t)){if(this.currentUser&&$t&&this.currentUser.uid===$t.uid){this._currentUser._assign($t),await this.currentUser.getIdToken();return}await this._updateCurrentUser($t,!0)}}async initializeCurrentUserFromIdToken($t){try{const Ct=await getAccountInfo(this,{idToken:$t}),kt=await UserImpl._fromGetAccountInfoResponse(this,Ct,$t);await this.directlySetCurrentUser(kt)}catch(Ct){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",Ct),await this.directlySetCurrentUser(null)}}async initializeCurrentUser($t){var Ct;if(_isFirebaseServerApp(this.app)){const jt=this.app.settings.authIdToken;return jt?new Promise(Bt=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(jt).then(Bt,Bt))}):this.directlySetCurrentUser(null)}const kt=await this.assertedPersistence.getCurrentUser();let Mt=kt,Ft=!1;if($t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const jt=(Ct=this.redirectUser)===null||Ct===void 0?void 0:Ct._redirectEventId,Bt=Mt==null?void 0:Mt._redirectEventId,Vt=await this.tryRedirectSignIn($t);(!jt||jt===Bt)&&(Vt!=null&&Vt.user)&&(Mt=Vt.user,Ft=!0)}if(!Mt)return this.directlySetCurrentUser(null);if(!Mt._redirectEventId){if(Ft)try{await this.beforeStateQueue.runMiddleware(Mt)}catch(jt){Mt=kt,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(jt))}return Mt?this.reloadAndSetCurrentUserOrClear(Mt):this.directlySetCurrentUser(null)}return _assert(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===Mt._redirectEventId?this.directlySetCurrentUser(Mt):this.reloadAndSetCurrentUserOrClear(Mt)}async tryRedirectSignIn($t){let Ct=null;try{Ct=await this._popupRedirectResolver._completeRedirectFn(this,$t,!0)}catch{await this._setRedirectUser(null)}return Ct}async reloadAndSetCurrentUserOrClear($t){try{await _reloadWithoutSaving($t)}catch(Ct){if((Ct==null?void 0:Ct.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser($t)}useDeviceLanguage(){this.languageCode=_getUserLanguage()}async _delete(){this._deleted=!0}async updateCurrentUser($t){if(_isFirebaseServerApp(this.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this));const Ct=$t?getModularInstance($t):null;return Ct&&_assert(Ct.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(Ct&&Ct._clone(this))}async _updateCurrentUser($t,Ct=!1){if(!this._deleted)return $t&&_assert(this.tenantId===$t.tenantId,this,"tenant-id-mismatch"),Ct||await this.beforeStateQueue.runMiddleware($t),this.queue(async()=>{await this.directlySetCurrentUser($t),this.notifyAuthListeners()})}async signOut(){return _isFirebaseServerApp(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence($t){return _isFirebaseServerApp(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_getInstance($t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword($t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const Ct=this._getPasswordPolicyInternal();return Ct.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):Ct.validatePassword($t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const $t=await _getPasswordPolicy(this),Ct=new PasswordPolicyImpl($t);this.tenantId===null?this._projectPasswordPolicy=Ct:this._tenantPasswordPolicies[this.tenantId]=Ct}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap($t){this._errorFactory=new ErrorFactory("auth","Firebase",$t())}onAuthStateChanged($t,Ct,kt){return this.registerStateListener(this.authStateSubscription,$t,Ct,kt)}beforeAuthStateChanged($t,Ct){return this.beforeStateQueue.pushCallback($t,Ct)}onIdTokenChanged($t,Ct,kt){return this.registerStateListener(this.idTokenSubscription,$t,Ct,kt)}authStateReady(){return new Promise(($t,Ct)=>{if(this.currentUser)$t();else{const kt=this.onAuthStateChanged(()=>{kt(),$t()},Ct)}})}async revokeAccessToken($t){if(this.currentUser){const Ct=await this.currentUser.getIdToken(),kt={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:$t,idToken:Ct};this.tenantId!=null&&(kt.tenantId=this.tenantId),await revokeToken(this,kt)}}toJSON(){var $t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:($t=this._currentUser)===null||$t===void 0?void 0:$t.toJSON()}}async _setRedirectUser($t,Ct){const kt=await this.getOrInitRedirectPersistenceManager(Ct);return $t===null?kt.removeCurrentUser():kt.setCurrentUser($t)}async getOrInitRedirectPersistenceManager($t){if(!this.redirectPersistenceManager){const Ct=$t&&_getInstance($t)||this._popupRedirectResolver;_assert(Ct,this,"argument-error"),this.redirectPersistenceManager=await PersistenceUserManager.create(this,[_getInstance(Ct._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId($t){var Ct,kt;return this._isInitialized&&await this.queue(async()=>{}),((Ct=this._currentUser)===null||Ct===void 0?void 0:Ct._redirectEventId)===$t?this._currentUser:((kt=this.redirectUser)===null||kt===void 0?void 0:kt._redirectEventId)===$t?this.redirectUser:null}async _persistUserIfCurrent($t){if($t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser($t))}_notifyListenersIfCurrent($t){$t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var $t,Ct;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const kt=(Ct=($t=this.currentUser)===null||$t===void 0?void 0:$t.uid)!==null&&Ct!==void 0?Ct:null;this.lastNotifiedUid!==kt&&(this.lastNotifiedUid=kt,this.authStateSubscription.next(this.currentUser))}registerStateListener($t,Ct,kt,Mt){if(this._deleted)return()=>{};const Ft=typeof Ct=="function"?Ct:Ct.next.bind(Ct);let jt=!1;const Bt=this._isInitialized?Promise.resolve():this._initializationPromise;if(_assert(Bt,this,"internal-error"),Bt.then(()=>{jt||Ft(this.currentUser)}),typeof Ct=="function"){const Vt=$t.addObserver(Ct,kt,Mt);return()=>{jt=!0,Vt()}}else{const Vt=$t.addObserver(Ct);return()=>{jt=!0,Vt()}}}async directlySetCurrentUser($t){this.currentUser&&this.currentUser!==$t&&this._currentUser._stopProactiveRefresh(),$t&&this.isProactiveRefreshEnabled&&$t._startProactiveRefresh(),this.currentUser=$t,$t?await this.assertedPersistence.setCurrentUser($t):await this.assertedPersistence.removeCurrentUser()}queue($t){return this.operations=this.operations.then($t,$t),this.operations}get assertedPersistence(){return _assert(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework($t){!$t||this.frameworks.includes($t)||(this.frameworks.push($t),this.frameworks.sort(),this.clientVersion=_getClientVersion(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var $t;const Ct={"X-Client-Version":this.clientVersion};this.app.options.appId&&(Ct["X-Firebase-gmpid"]=this.app.options.appId);const kt=await(($t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||$t===void 0?void 0:$t.getHeartbeatsHeader());kt&&(Ct["X-Firebase-Client"]=kt);const Mt=await this._getAppCheckToken();return Mt&&(Ct["X-Firebase-AppCheck"]=Mt),Ct}async _getAppCheckToken(){var $t;const Ct=await(($t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||$t===void 0?void 0:$t.getToken());return Ct!=null&&Ct.error&&_logWarn(`Error while retrieving App Check token: ${Ct.error}`),Ct==null?void 0:Ct.token}}function _castAuth(xt){return getModularInstance(xt)}class Subscription{constructor($t){this.auth=$t,this.observer=null,this.addObserver=createSubscribe(Ct=>this.observer=Ct)}get next(){return _assert(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let externalJSProvider={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _setExternalJSProvider(xt){externalJSProvider=xt}function _loadJS(xt){return externalJSProvider.loadJS(xt)}function _gapiScriptUrl(){return externalJSProvider.gapiScript}function _generateCallbackName(xt){return`__${xt}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function initializeAuth(xt,$t){const Ct=_getProvider(xt,"auth");if(Ct.isInitialized()){const Mt=Ct.getImmediate(),Ft=Ct.getOptions();if(deepEqual$1(Ft,$t??{}))return Mt;_fail(Mt,"already-initialized")}return Ct.initialize({options:$t})}function _initializeAuthInstance(xt,$t){const Ct=($t==null?void 0:$t.persistence)||[],kt=(Array.isArray(Ct)?Ct:[Ct]).map(_getInstance);$t!=null&&$t.errorMap&&xt._updateErrorMap($t.errorMap),xt._initializeWithPersistence(kt,$t==null?void 0:$t.popupRedirectResolver)}function connectAuthEmulator(xt,$t,Ct){const kt=_castAuth(xt);_assert(kt._canInitEmulator,kt,"emulator-config-failed"),_assert(/^https?:\/\//.test($t),kt,"invalid-emulator-scheme");const Mt=!1,Ft=extractProtocol($t),{host:jt,port:Bt}=extractHostAndPort($t),Vt=Bt===null?"":`:${Bt}`;kt.config.emulator={url:`${Ft}//${jt}${Vt}/`},kt.settings.appVerificationDisabledForTesting=!0,kt.emulatorConfig=Object.freeze({host:jt,port:Bt,protocol:Ft.replace(":",""),options:Object.freeze({disableWarnings:Mt})}),emitEmulatorWarning()}function extractProtocol(xt){const $t=xt.indexOf(":");return $t<0?"":xt.substr(0,$t+1)}function extractHostAndPort(xt){const $t=extractProtocol(xt),Ct=/(\/\/)?([^?#/]+)/.exec(xt.substr($t.length));if(!Ct)return{host:"",port:null};const kt=Ct[2].split("@").pop()||"",Mt=/^(\[[^\]]+\])(:|$)/.exec(kt);if(Mt){const Ft=Mt[1];return{host:Ft,port:parsePort(kt.substr(Ft.length+1))}}else{const[Ft,jt]=kt.split(":");return{host:Ft,port:parsePort(jt)}}}function parsePort(xt){if(!xt)return null;const $t=Number(xt);return isNaN($t)?null:$t}function emitEmulatorWarning(){function xt(){const $t=document.createElement("p"),Ct=$t.style;$t.innerText="Running in emulator mode. Do not use with production credentials.",Ct.position="fixed",Ct.width="100%",Ct.backgroundColor="#ffffff",Ct.border=".1em solid #000000",Ct.color="#b50000",Ct.bottom="0px",Ct.left="0px",Ct.margin="0px",Ct.zIndex="10000",Ct.textAlign="center",$t.classList.add("firebase-emulator-warning"),document.body.appendChild($t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",xt):xt())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthCredential{constructor($t,Ct){this.providerId=$t,this.signInMethod=Ct}toJSON(){return debugFail("not implemented")}_getIdTokenResponse($t){return debugFail("not implemented")}_linkToIdToken($t,Ct){return debugFail("not implemented")}_getReauthenticationResolver($t){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithIdp(xt,$t){return _performSignInRequest(xt,"POST","/v1/accounts:signInWithIdp",_addTidIfNecessary(xt,$t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IDP_REQUEST_URI$1="http://localhost";class OAuthCredential extends AuthCredential{constructor(){super(...arguments),this.pendingToken=null}static _fromParams($t){const Ct=new OAuthCredential($t.providerId,$t.signInMethod);return $t.idToken||$t.accessToken?($t.idToken&&(Ct.idToken=$t.idToken),$t.accessToken&&(Ct.accessToken=$t.accessToken),$t.nonce&&!$t.pendingToken&&(Ct.nonce=$t.nonce),$t.pendingToken&&(Ct.pendingToken=$t.pendingToken)):$t.oauthToken&&$t.oauthTokenSecret?(Ct.accessToken=$t.oauthToken,Ct.secret=$t.oauthTokenSecret):_fail("argument-error"),Ct}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON($t){const Ct=typeof $t=="string"?JSON.parse($t):$t,{providerId:kt,signInMethod:Mt}=Ct,Ft=__rest$1(Ct,["providerId","signInMethod"]);if(!kt||!Mt)return null;const jt=new OAuthCredential(kt,Mt);return jt.idToken=Ft.idToken||void 0,jt.accessToken=Ft.accessToken||void 0,jt.secret=Ft.secret,jt.nonce=Ft.nonce,jt.pendingToken=Ft.pendingToken||null,jt}_getIdTokenResponse($t){const Ct=this.buildRequest();return signInWithIdp($t,Ct)}_linkToIdToken($t,Ct){const kt=this.buildRequest();return kt.idToken=Ct,signInWithIdp($t,kt)}_getReauthenticationResolver($t){const Ct=this.buildRequest();return Ct.autoCreate=!1,signInWithIdp($t,Ct)}buildRequest(){const $t={requestUri:IDP_REQUEST_URI$1,returnSecureToken:!0};if(this.pendingToken)$t.pendingToken=this.pendingToken;else{const Ct={};this.idToken&&(Ct.id_token=this.idToken),this.accessToken&&(Ct.access_token=this.accessToken),this.secret&&(Ct.oauth_token_secret=this.secret),Ct.providerId=this.providerId,this.nonce&&!this.pendingToken&&(Ct.nonce=this.nonce),$t.postBody=querystring(Ct)}return $t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FederatedAuthProvider{constructor($t){this.providerId=$t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage($t){this.defaultLanguageCode=$t}setCustomParameters($t){return this.customParameters=$t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BaseOAuthProvider extends FederatedAuthProvider{constructor(){super(...arguments),this.scopes=[]}addScope($t){return this.scopes.includes($t)||this.scopes.push($t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FacebookAuthProvider extends BaseOAuthProvider{constructor(){super("facebook.com")}static credential($t){return OAuthCredential._fromParams({providerId:FacebookAuthProvider.PROVIDER_ID,signInMethod:FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD,accessToken:$t})}static credentialFromResult($t){return FacebookAuthProvider.credentialFromTaggedObject($t)}static credentialFromError($t){return FacebookAuthProvider.credentialFromTaggedObject($t.customData||{})}static credentialFromTaggedObject({_tokenResponse:$t}){if(!$t||!("oauthAccessToken"in $t)||!$t.oauthAccessToken)return null;try{return FacebookAuthProvider.credential($t.oauthAccessToken)}catch{return null}}}FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD="facebook.com";FacebookAuthProvider.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GoogleAuthProvider extends BaseOAuthProvider{constructor(){super("google.com"),this.addScope("profile")}static credential($t,Ct){return OAuthCredential._fromParams({providerId:GoogleAuthProvider.PROVIDER_ID,signInMethod:GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD,idToken:$t,accessToken:Ct})}static credentialFromResult($t){return GoogleAuthProvider.credentialFromTaggedObject($t)}static credentialFromError($t){return GoogleAuthProvider.credentialFromTaggedObject($t.customData||{})}static credentialFromTaggedObject({_tokenResponse:$t}){if(!$t)return null;const{oauthIdToken:Ct,oauthAccessToken:kt}=$t;if(!Ct&&!kt)return null;try{return GoogleAuthProvider.credential(Ct,kt)}catch{return null}}}GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD="google.com";GoogleAuthProvider.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GithubAuthProvider extends BaseOAuthProvider{constructor(){super("github.com")}static credential($t){return OAuthCredential._fromParams({providerId:GithubAuthProvider.PROVIDER_ID,signInMethod:GithubAuthProvider.GITHUB_SIGN_IN_METHOD,accessToken:$t})}static credentialFromResult($t){return GithubAuthProvider.credentialFromTaggedObject($t)}static credentialFromError($t){return GithubAuthProvider.credentialFromTaggedObject($t.customData||{})}static credentialFromTaggedObject({_tokenResponse:$t}){if(!$t||!("oauthAccessToken"in $t)||!$t.oauthAccessToken)return null;try{return GithubAuthProvider.credential($t.oauthAccessToken)}catch{return null}}}GithubAuthProvider.GITHUB_SIGN_IN_METHOD="github.com";GithubAuthProvider.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TwitterAuthProvider extends BaseOAuthProvider{constructor(){super("twitter.com")}static credential($t,Ct){return OAuthCredential._fromParams({providerId:TwitterAuthProvider.PROVIDER_ID,signInMethod:TwitterAuthProvider.TWITTER_SIGN_IN_METHOD,oauthToken:$t,oauthTokenSecret:Ct})}static credentialFromResult($t){return TwitterAuthProvider.credentialFromTaggedObject($t)}static credentialFromError($t){return TwitterAuthProvider.credentialFromTaggedObject($t.customData||{})}static credentialFromTaggedObject({_tokenResponse:$t}){if(!$t)return null;const{oauthAccessToken:Ct,oauthTokenSecret:kt}=$t;if(!Ct||!kt)return null;try{return TwitterAuthProvider.credential(Ct,kt)}catch{return null}}}TwitterAuthProvider.TWITTER_SIGN_IN_METHOD="twitter.com";TwitterAuthProvider.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signUp(xt,$t){return _performSignInRequest(xt,"POST","/v1/accounts:signUp",_addTidIfNecessary(xt,$t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserCredentialImpl{constructor($t){this.user=$t.user,this.providerId=$t.providerId,this._tokenResponse=$t._tokenResponse,this.operationType=$t.operationType}static async _fromIdTokenResponse($t,Ct,kt,Mt=!1){const Ft=await UserImpl._fromIdTokenResponse($t,kt,Mt),jt=providerIdForResponse(kt);return new UserCredentialImpl({user:Ft,providerId:jt,_tokenResponse:kt,operationType:Ct})}static async _forOperation($t,Ct,kt){await $t._updateTokensIfNecessary(kt,!0);const Mt=providerIdForResponse(kt);return new UserCredentialImpl({user:$t,providerId:Mt,_tokenResponse:kt,operationType:Ct})}}function providerIdForResponse(xt){return xt.providerId?xt.providerId:"phoneNumber"in xt?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInAnonymously(xt){var $t;if(_isFirebaseServerApp(xt.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(xt));const Ct=_castAuth(xt);if(await Ct._initializationPromise,!(($t=Ct.currentUser)===null||$t===void 0)&&$t.isAnonymous)return new UserCredentialImpl({user:Ct.currentUser,providerId:null,operationType:"signIn"});const kt=await signUp(Ct,{returnSecureToken:!0}),Mt=await UserCredentialImpl._fromIdTokenResponse(Ct,"signIn",kt,!0);return await Ct._updateCurrentUser(Mt.user),Mt}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorError extends FirebaseError{constructor($t,Ct,kt,Mt){var Ft;super(Ct.code,Ct.message),this.operationType=kt,this.user=Mt,Object.setPrototypeOf(this,MultiFactorError.prototype),this.customData={appName:$t.name,tenantId:(Ft=$t.tenantId)!==null&&Ft!==void 0?Ft:void 0,_serverResponse:Ct.customData._serverResponse,operationType:kt}}static _fromErrorAndOperation($t,Ct,kt,Mt){return new MultiFactorError($t,Ct,kt,Mt)}}function _processCredentialSavingMfaContextIfNecessary(xt,$t,Ct,kt){return($t==="reauthenticate"?Ct._getReauthenticationResolver(xt):Ct._getIdTokenResponse(xt)).catch(Ft=>{throw Ft.code==="auth/multi-factor-auth-required"?MultiFactorError._fromErrorAndOperation(xt,Ft,$t,kt):Ft})}async function _link$1(xt,$t,Ct=!1){const kt=await _logoutIfInvalidated(xt,$t._linkToIdToken(xt.auth,await xt.getIdToken()),Ct);return UserCredentialImpl._forOperation(xt,"link",kt)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reauthenticate(xt,$t,Ct=!1){const{auth:kt}=xt;if(_isFirebaseServerApp(kt.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(kt));const Mt="reauthenticate";try{const Ft=await _logoutIfInvalidated(xt,_processCredentialSavingMfaContextIfNecessary(kt,Mt,$t,xt),Ct);_assert(Ft.idToken,kt,"internal-error");const jt=_parseToken(Ft.idToken);_assert(jt,kt,"internal-error");const{sub:Bt}=jt;return _assert(xt.uid===Bt,kt,"user-mismatch"),UserCredentialImpl._forOperation(xt,Mt,Ft)}catch(Ft){throw(Ft==null?void 0:Ft.code)==="auth/user-not-found"&&_fail(kt,"user-mismatch"),Ft}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _signInWithCredential(xt,$t,Ct=!1){if(_isFirebaseServerApp(xt.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(xt));const kt="signIn",Mt=await _processCredentialSavingMfaContextIfNecessary(xt,kt,$t),Ft=await UserCredentialImpl._fromIdTokenResponse(xt,kt,Mt);return Ct||await xt._updateCurrentUser(Ft.user),Ft}function onIdTokenChanged(xt,$t,Ct,kt){return getModularInstance(xt).onIdTokenChanged($t,Ct,kt)}function beforeAuthStateChanged(xt,$t,Ct){return getModularInstance(xt).beforeAuthStateChanged($t,Ct)}function onAuthStateChanged(xt,$t,Ct,kt){return getModularInstance(xt).onAuthStateChanged($t,Ct,kt)}function signOut(xt){return getModularInstance(xt).signOut()}const STORAGE_AVAILABLE_KEY="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserPersistenceClass{constructor($t,Ct){this.storageRetriever=$t,this.type=Ct}_isAvailable(){try{return this.storage?(this.storage.setItem(STORAGE_AVAILABLE_KEY,"1"),this.storage.removeItem(STORAGE_AVAILABLE_KEY),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set($t,Ct){return this.storage.setItem($t,JSON.stringify(Ct)),Promise.resolve()}_get($t){const Ct=this.storage.getItem($t);return Promise.resolve(Ct?JSON.parse(Ct):null)}_remove($t){return this.storage.removeItem($t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _iframeCannotSyncWebStorage(){const xt=getUA();return _isSafari(xt)||_isIOS(xt)}const _POLLING_INTERVAL_MS$1=1e3,IE10_LOCAL_STORAGE_SYNC_DELAY=10;class BrowserLocalPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=($t,Ct)=>this.onStorageEvent($t,Ct),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=_iframeCannotSyncWebStorage()&&_isIframe(),this.fallbackToPolling=_isMobileBrowser(),this._shouldAllowMigration=!0}forAllChangedKeys($t){for(const Ct of Object.keys(this.listeners)){const kt=this.storage.getItem(Ct),Mt=this.localCache[Ct];kt!==Mt&&$t(Ct,Mt,kt)}}onStorageEvent($t,Ct=!1){if(!$t.key){this.forAllChangedKeys((jt,Bt,Vt)=>{this.notifyListeners(jt,Vt)});return}const kt=$t.key;if(Ct?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const jt=this.storage.getItem(kt);if($t.newValue!==jt)$t.newValue!==null?this.storage.setItem(kt,$t.newValue):this.storage.removeItem(kt);else if(this.localCache[kt]===$t.newValue&&!Ct)return}const Mt=()=>{const jt=this.storage.getItem(kt);!Ct&&this.localCache[kt]===jt||this.notifyListeners(kt,jt)},Ft=this.storage.getItem(kt);_isIE10()&&Ft!==$t.newValue&&$t.newValue!==$t.oldValue?setTimeout(Mt,IE10_LOCAL_STORAGE_SYNC_DELAY):Mt()}notifyListeners($t,Ct){this.localCache[$t]=Ct;const kt=this.listeners[$t];if(kt)for(const Mt of Array.from(kt))Mt(Ct&&JSON.parse(Ct))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys(($t,Ct,kt)=>{this.onStorageEvent(new StorageEvent("storage",{key:$t,oldValue:Ct,newValue:kt}),!0)})},_POLLING_INTERVAL_MS$1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener($t,Ct){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[$t]||(this.listeners[$t]=new Set,this.localCache[$t]=this.storage.getItem($t)),this.listeners[$t].add(Ct)}_removeListener($t,Ct){this.listeners[$t]&&(this.listeners[$t].delete(Ct),this.listeners[$t].size===0&&delete this.listeners[$t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set($t,Ct){await super._set($t,Ct),this.localCache[$t]=JSON.stringify(Ct)}async _get($t){const Ct=await super._get($t);return this.localCache[$t]=JSON.stringify(Ct),Ct}async _remove($t){await super._remove($t),delete this.localCache[$t]}}BrowserLocalPersistence.type="LOCAL";const browserLocalPersistence=BrowserLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserSessionPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener($t,Ct){}_removeListener($t,Ct){}}BrowserSessionPersistence.type="SESSION";const browserSessionPersistence=BrowserSessionPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _allSettled(xt){return Promise.all(xt.map(async $t=>{try{return{fulfilled:!0,value:await $t}}catch(Ct){return{fulfilled:!1,reason:Ct}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Receiver{constructor($t){this.eventTarget=$t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance($t){const Ct=this.receivers.find(Mt=>Mt.isListeningto($t));if(Ct)return Ct;const kt=new Receiver($t);return this.receivers.push(kt),kt}isListeningto($t){return this.eventTarget===$t}async handleEvent($t){const Ct=$t,{eventId:kt,eventType:Mt,data:Ft}=Ct.data,jt=this.handlersMap[Mt];if(!(jt!=null&&jt.size))return;Ct.ports[0].postMessage({status:"ack",eventId:kt,eventType:Mt});const Bt=Array.from(jt).map(async zt=>zt(Ct.origin,Ft)),Vt=await _allSettled(Bt);Ct.ports[0].postMessage({status:"done",eventId:kt,eventType:Mt,response:Vt})}_subscribe($t,Ct){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[$t]||(this.handlersMap[$t]=new Set),this.handlersMap[$t].add(Ct)}_unsubscribe($t,Ct){this.handlersMap[$t]&&Ct&&this.handlersMap[$t].delete(Ct),(!Ct||this.handlersMap[$t].size===0)&&delete this.handlersMap[$t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Receiver.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _generateEventId(xt="",$t=10){let Ct="";for(let kt=0;kt<$t;kt++)Ct+=Math.floor(Math.random()*10);return xt+Ct}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sender{constructor($t){this.target=$t,this.handlers=new Set}removeMessageHandler($t){$t.messageChannel&&($t.messageChannel.port1.removeEventListener("message",$t.onMessage),$t.messageChannel.port1.close()),this.handlers.delete($t)}async _send($t,Ct,kt=50){const Mt=typeof MessageChannel<"u"?new MessageChannel:null;if(!Mt)throw new Error("connection_unavailable");let Ft,jt;return new Promise((Bt,Vt)=>{const zt=_generateEventId("",20);Mt.port1.start();const Ht=setTimeout(()=>{Vt(new Error("unsupported_event"))},kt);jt={messageChannel:Mt,onMessage(Gt){const qt=Gt;if(qt.data.eventId===zt)switch(qt.data.status){case"ack":clearTimeout(Ht),Ft=setTimeout(()=>{Vt(new Error("timeout"))},3e3);break;case"done":clearTimeout(Ft),Bt(qt.data.response);break;default:clearTimeout(Ht),clearTimeout(Ft),Vt(new Error("invalid_response"));break}}},this.handlers.add(jt),Mt.port1.addEventListener("message",jt.onMessage),this.target.postMessage({eventType:$t,eventId:zt,data:Ct},[Mt.port2])}).finally(()=>{jt&&this.removeMessageHandler(jt)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _window$1(){return window}function _setWindowLocation(xt){_window$1().location.href=xt}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isWorker(){return typeof _window$1().WorkerGlobalScope<"u"&&typeof _window$1().importScripts=="function"}async function _getActiveServiceWorker(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _getServiceWorkerController(){var xt;return((xt=navigator==null?void 0:navigator.serviceWorker)===null||xt===void 0?void 0:xt.controller)||null}function _getWorkerGlobalScope(){return _isWorker()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME$1="firebaseLocalStorageDb",DB_VERSION$1=1,DB_OBJECTSTORE_NAME="firebaseLocalStorage",DB_DATA_KEYPATH="fbase_key";class DBPromise{constructor($t){this.request=$t}toPromise(){return new Promise(($t,Ct)=>{this.request.addEventListener("success",()=>{$t(this.request.result)}),this.request.addEventListener("error",()=>{Ct(this.request.error)})})}}function getObjectStore(xt,$t){return xt.transaction([DB_OBJECTSTORE_NAME],$t?"readwrite":"readonly").objectStore(DB_OBJECTSTORE_NAME)}function _deleteDatabase(){const xt=indexedDB.deleteDatabase(DB_NAME$1);return new DBPromise(xt).toPromise()}function _openDatabase(){const xt=indexedDB.open(DB_NAME$1,DB_VERSION$1);return new Promise(($t,Ct)=>{xt.addEventListener("error",()=>{Ct(xt.error)}),xt.addEventListener("upgradeneeded",()=>{const kt=xt.result;try{kt.createObjectStore(DB_OBJECTSTORE_NAME,{keyPath:DB_DATA_KEYPATH})}catch(Mt){Ct(Mt)}}),xt.addEventListener("success",async()=>{const kt=xt.result;kt.objectStoreNames.contains(DB_OBJECTSTORE_NAME)?$t(kt):(kt.close(),await _deleteDatabase(),$t(await _openDatabase()))})})}async function _putObject(xt,$t,Ct){const kt=getObjectStore(xt,!0).put({[DB_DATA_KEYPATH]:$t,value:Ct});return new DBPromise(kt).toPromise()}async function getObject(xt,$t){const Ct=getObjectStore(xt,!1).get($t),kt=await new DBPromise(Ct).toPromise();return kt===void 0?null:kt.value}function _deleteObject(xt,$t){const Ct=getObjectStore(xt,!0).delete($t);return new DBPromise(Ct).toPromise()}const _POLLING_INTERVAL_MS=800,_TRANSACTION_RETRY_COUNT=3;class IndexedDBLocalPersistence{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _openDatabase(),this.db)}async _withRetries($t){let Ct=0;for(;;)try{const kt=await this._openDb();return await $t(kt)}catch(kt){if(Ct++>_TRANSACTION_RETRY_COUNT)throw kt;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _isWorker()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Receiver._getInstance(_getWorkerGlobalScope()),this.receiver._subscribe("keyChanged",async($t,Ct)=>({keyProcessed:(await this._poll()).includes(Ct.key)})),this.receiver._subscribe("ping",async($t,Ct)=>["keyChanged"])}async initializeSender(){var $t,Ct;if(this.activeServiceWorker=await _getActiveServiceWorker(),!this.activeServiceWorker)return;this.sender=new Sender(this.activeServiceWorker);const kt=await this.sender._send("ping",{},800);kt&&!(($t=kt[0])===null||$t===void 0)&&$t.fulfilled&&!((Ct=kt[0])===null||Ct===void 0)&&Ct.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker($t){if(!(!this.sender||!this.activeServiceWorker||_getServiceWorkerController()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:$t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const $t=await _openDatabase();return await _putObject($t,STORAGE_AVAILABLE_KEY,"1"),await _deleteObject($t,STORAGE_AVAILABLE_KEY),!0}catch{}return!1}async _withPendingWrite($t){this.pendingWrites++;try{await $t()}finally{this.pendingWrites--}}async _set($t,Ct){return this._withPendingWrite(async()=>(await this._withRetries(kt=>_putObject(kt,$t,Ct)),this.localCache[$t]=Ct,this.notifyServiceWorker($t)))}async _get($t){const Ct=await this._withRetries(kt=>getObject(kt,$t));return this.localCache[$t]=Ct,Ct}async _remove($t){return this._withPendingWrite(async()=>(await this._withRetries(Ct=>_deleteObject(Ct,$t)),delete this.localCache[$t],this.notifyServiceWorker($t)))}async _poll(){const $t=await this._withRetries(Mt=>{const Ft=getObjectStore(Mt,!1).getAll();return new DBPromise(Ft).toPromise()});if(!$t)return[];if(this.pendingWrites!==0)return[];const Ct=[],kt=new Set;if($t.length!==0)for(const{fbase_key:Mt,value:Ft}of $t)kt.add(Mt),JSON.stringify(this.localCache[Mt])!==JSON.stringify(Ft)&&(this.notifyListeners(Mt,Ft),Ct.push(Mt));for(const Mt of Object.keys(this.localCache))this.localCache[Mt]&&!kt.has(Mt)&&(this.notifyListeners(Mt,null),Ct.push(Mt));return Ct}notifyListeners($t,Ct){this.localCache[$t]=Ct;const kt=this.listeners[$t];if(kt)for(const Mt of Array.from(kt))Mt(Ct)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_POLLING_INTERVAL_MS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener($t,Ct){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[$t]||(this.listeners[$t]=new Set,this._get($t)),this.listeners[$t].add(Ct)}_removeListener($t,Ct){this.listeners[$t]&&(this.listeners[$t].delete(Ct),this.listeners[$t].size===0&&delete this.listeners[$t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IndexedDBLocalPersistence.type="LOCAL";const indexedDBLocalPersistence=IndexedDBLocalPersistence;new Delay(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _withDefaultResolver(xt,$t){return $t?_getInstance($t):(_assert(xt._popupRedirectResolver,xt,"argument-error"),xt._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IdpCredential extends AuthCredential{constructor($t){super("custom","custom"),this.params=$t}_getIdTokenResponse($t){return signInWithIdp($t,this._buildIdpRequest())}_linkToIdToken($t,Ct){return signInWithIdp($t,this._buildIdpRequest(Ct))}_getReauthenticationResolver($t){return signInWithIdp($t,this._buildIdpRequest())}_buildIdpRequest($t){const Ct={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return $t&&(Ct.idToken=$t),Ct}}function _signIn(xt){return _signInWithCredential(xt.auth,new IdpCredential(xt),xt.bypassAuthState)}function _reauth(xt){const{auth:$t,user:Ct}=xt;return _assert(Ct,$t,"internal-error"),_reauthenticate(Ct,new IdpCredential(xt),xt.bypassAuthState)}async function _link(xt){const{auth:$t,user:Ct}=xt;return _assert(Ct,$t,"internal-error"),_link$1(Ct,new IdpCredential(xt),xt.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AbstractPopupRedirectOperation{constructor($t,Ct,kt,Mt,Ft=!1){this.auth=$t,this.resolver=kt,this.user=Mt,this.bypassAuthState=Ft,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(Ct)?Ct:[Ct]}execute(){return new Promise(async($t,Ct)=>{this.pendingPromise={resolve:$t,reject:Ct};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(kt){this.reject(kt)}})}async onAuthEvent($t){const{urlResponse:Ct,sessionId:kt,postBody:Mt,tenantId:Ft,error:jt,type:Bt}=$t;if(jt){this.reject(jt);return}const Vt={auth:this.auth,requestUri:Ct,sessionId:kt,tenantId:Ft||void 0,postBody:Mt||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(Bt)(Vt))}catch(zt){this.reject(zt)}}onError($t){this.reject($t)}getIdpTask($t){switch($t){case"signInViaPopup":case"signInViaRedirect":return _signIn;case"linkViaPopup":case"linkViaRedirect":return _link;case"reauthViaPopup":case"reauthViaRedirect":return _reauth;default:_fail(this.auth,"internal-error")}}resolve($t){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve($t),this.unregisterAndCleanUp()}reject($t){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject($t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLL_WINDOW_CLOSE_TIMEOUT=new Delay(2e3,1e4);async function signInWithPopup(xt,$t,Ct){if(_isFirebaseServerApp(xt.app))return Promise.reject(_createError(xt,"operation-not-supported-in-this-environment"));const kt=_castAuth(xt);_assertInstanceOf(xt,$t,FederatedAuthProvider);const Mt=_withDefaultResolver(kt,Ct);return new PopupOperation(kt,"signInViaPopup",$t,Mt).executeNotNull()}class PopupOperation extends AbstractPopupRedirectOperation{constructor($t,Ct,kt,Mt,Ft){super($t,Ct,Mt,Ft),this.provider=kt,this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction&&PopupOperation.currentPopupAction.cancel(),PopupOperation.currentPopupAction=this}async executeNotNull(){const $t=await this.execute();return _assert($t,this.auth,"internal-error"),$t}async onExecution(){debugAssert(this.filter.length===1,"Popup operations only handle one event");const $t=_generateEventId();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],$t),this.authWindow.associatedEvent=$t,this.resolver._originValidation(this.auth).catch(Ct=>{this.reject(Ct)}),this.resolver._isIframeWebStorageSupported(this.auth,Ct=>{Ct||this.reject(_createError(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var $t;return(($t=this.authWindow)===null||$t===void 0?void 0:$t.associatedEvent)||null}cancel(){this.reject(_createError(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction=null}pollUserCancellation(){const $t=()=>{var Ct,kt;if(!((kt=(Ct=this.authWindow)===null||Ct===void 0?void 0:Ct.window)===null||kt===void 0)&&kt.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_createError(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout($t,_POLL_WINDOW_CLOSE_TIMEOUT.get())};$t()}}PopupOperation.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PENDING_REDIRECT_KEY="pendingRedirect",redirectOutcomeMap=new Map;class RedirectAction extends AbstractPopupRedirectOperation{constructor($t,Ct,kt=!1){super($t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],Ct,void 0,kt),this.eventId=null}async execute(){let $t=redirectOutcomeMap.get(this.auth._key());if(!$t){try{const kt=await _getAndClearPendingRedirectStatus(this.resolver,this.auth)?await super.execute():null;$t=()=>Promise.resolve(kt)}catch(Ct){$t=()=>Promise.reject(Ct)}redirectOutcomeMap.set(this.auth._key(),$t)}return this.bypassAuthState||redirectOutcomeMap.set(this.auth._key(),()=>Promise.resolve(null)),$t()}async onAuthEvent($t){if($t.type==="signInViaRedirect")return super.onAuthEvent($t);if($t.type==="unknown"){this.resolve(null);return}if($t.eventId){const Ct=await this.auth._redirectUserForId($t.eventId);if(Ct)return this.user=Ct,super.onAuthEvent($t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _getAndClearPendingRedirectStatus(xt,$t){const Ct=pendingRedirectKey($t),kt=resolverPersistence(xt);if(!await kt._isAvailable())return!1;const Mt=await kt._get(Ct)==="true";return await kt._remove(Ct),Mt}function _overrideRedirectResult(xt,$t){redirectOutcomeMap.set(xt._key(),$t)}function resolverPersistence(xt){return _getInstance(xt._redirectPersistence)}function pendingRedirectKey(xt){return _persistenceKeyName(PENDING_REDIRECT_KEY,xt.config.apiKey,xt.name)}async function _getRedirectResult(xt,$t,Ct=!1){if(_isFirebaseServerApp(xt.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(xt));const kt=_castAuth(xt),Mt=_withDefaultResolver(kt,$t),jt=await new RedirectAction(kt,Mt,Ct).execute();return jt&&!Ct&&(delete jt.user._redirectEventId,await kt._persistUserIfCurrent(jt.user),await kt._setRedirectUser(null,$t)),jt}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EVENT_DUPLICATION_CACHE_DURATION_MS=10*60*1e3;class AuthEventManager{constructor($t){this.auth=$t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer($t){this.consumers.add($t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,$t)&&(this.sendToConsumer(this.queuedRedirectEvent,$t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer($t){this.consumers.delete($t)}onEvent($t){if(this.hasEventBeenHandled($t))return!1;let Ct=!1;return this.consumers.forEach(kt=>{this.isEventForConsumer($t,kt)&&(Ct=!0,this.sendToConsumer($t,kt),this.saveEventToCache($t))}),this.hasHandledPotentialRedirect||!isRedirectEvent($t)||(this.hasHandledPotentialRedirect=!0,Ct||(this.queuedRedirectEvent=$t,Ct=!0)),Ct}sendToConsumer($t,Ct){var kt;if($t.error&&!isNullRedirectEvent($t)){const Mt=((kt=$t.error.code)===null||kt===void 0?void 0:kt.split("auth/")[1])||"internal-error";Ct.onError(_createError(this.auth,Mt))}else Ct.onAuthEvent($t)}isEventForConsumer($t,Ct){const kt=Ct.eventId===null||!!$t.eventId&&$t.eventId===Ct.eventId;return Ct.filter.includes($t.type)&&kt}hasEventBeenHandled($t){return Date.now()-this.lastProcessedEventTime>=EVENT_DUPLICATION_CACHE_DURATION_MS&&this.cachedEventUids.clear(),this.cachedEventUids.has(eventUid($t))}saveEventToCache($t){this.cachedEventUids.add(eventUid($t)),this.lastProcessedEventTime=Date.now()}}function eventUid(xt){return[xt.type,xt.eventId,xt.sessionId,xt.tenantId].filter($t=>$t).join("-")}function isNullRedirectEvent({type:xt,error:$t}){return xt==="unknown"&&($t==null?void 0:$t.code)==="auth/no-auth-event"}function isRedirectEvent(xt){switch(xt.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return isNullRedirectEvent(xt);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getProjectConfig(xt,$t={}){return _performApiRequest(xt,"GET","/v1/projects",$t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP_ADDRESS_REGEX=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HTTP_REGEX=/^https?/;async function _validateOrigin(xt){if(xt.config.emulator)return;const{authorizedDomains:$t}=await _getProjectConfig(xt);for(const Ct of $t)try{if(matchDomain(Ct))return}catch{}_fail(xt,"unauthorized-domain")}function matchDomain(xt){const $t=_getCurrentUrl(),{protocol:Ct,hostname:kt}=new URL($t);if(xt.startsWith("chrome-extension://")){const jt=new URL(xt);return jt.hostname===""&&kt===""?Ct==="chrome-extension:"&&xt.replace("chrome-extension://","")===$t.replace("chrome-extension://",""):Ct==="chrome-extension:"&&jt.hostname===kt}if(!HTTP_REGEX.test(Ct))return!1;if(IP_ADDRESS_REGEX.test(xt))return kt===xt;const Mt=xt.replace(/\./g,"\\.");return new RegExp("^(.+\\."+Mt+"|"+Mt+")$","i").test(kt)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NETWORK_TIMEOUT=new Delay(3e4,6e4);function resetUnloadedGapiModules(){const xt=_window$1().___jsl;if(xt!=null&&xt.H){for(const $t of Object.keys(xt.H))if(xt.H[$t].r=xt.H[$t].r||[],xt.H[$t].L=xt.H[$t].L||[],xt.H[$t].r=[...xt.H[$t].L],xt.CP)for(let Ct=0;Ct<xt.CP.length;Ct++)xt.CP[Ct]=null}}function loadGapi(xt){return new Promise(($t,Ct)=>{var kt,Mt,Ft;function jt(){resetUnloadedGapiModules(),gapi.load("gapi.iframes",{callback:()=>{$t(gapi.iframes.getContext())},ontimeout:()=>{resetUnloadedGapiModules(),Ct(_createError(xt,"network-request-failed"))},timeout:NETWORK_TIMEOUT.get()})}if(!((Mt=(kt=_window$1().gapi)===null||kt===void 0?void 0:kt.iframes)===null||Mt===void 0)&&Mt.Iframe)$t(gapi.iframes.getContext());else if(!((Ft=_window$1().gapi)===null||Ft===void 0)&&Ft.load)jt();else{const Bt=_generateCallbackName("iframefcb");return _window$1()[Bt]=()=>{gapi.load?jt():Ct(_createError(xt,"network-request-failed"))},_loadJS(`${_gapiScriptUrl()}?onload=${Bt}`).catch(Vt=>Ct(Vt))}}).catch($t=>{throw cachedGApiLoader=null,$t})}let cachedGApiLoader=null;function _loadGapi(xt){return cachedGApiLoader=cachedGApiLoader||loadGapi(xt),cachedGApiLoader}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PING_TIMEOUT=new Delay(5e3,15e3),IFRAME_PATH="__/auth/iframe",EMULATED_IFRAME_PATH="emulator/auth/iframe",IFRAME_ATTRIBUTES={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},EID_FROM_APIHOST=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function getIframeUrl(xt){const $t=xt.config;_assert($t.authDomain,xt,"auth-domain-config-required");const Ct=$t.emulator?_emulatorUrl($t,EMULATED_IFRAME_PATH):`https://${xt.config.authDomain}/${IFRAME_PATH}`,kt={apiKey:$t.apiKey,appName:xt.name,v:SDK_VERSION},Mt=EID_FROM_APIHOST.get(xt.config.apiHost);Mt&&(kt.eid=Mt);const Ft=xt._getFrameworks();return Ft.length&&(kt.fw=Ft.join(",")),`${Ct}?${querystring(kt).slice(1)}`}async function _openIframe(xt){const $t=await _loadGapi(xt),Ct=_window$1().gapi;return _assert(Ct,xt,"internal-error"),$t.open({where:document.body,url:getIframeUrl(xt),messageHandlersFilter:Ct.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IFRAME_ATTRIBUTES,dontclear:!0},kt=>new Promise(async(Mt,Ft)=>{await kt.restyle({setHideOnLeave:!1});const jt=_createError(xt,"network-request-failed"),Bt=_window$1().setTimeout(()=>{Ft(jt)},PING_TIMEOUT.get());function Vt(){_window$1().clearTimeout(Bt),Mt(kt)}kt.ping(Vt).then(Vt,()=>{Ft(jt)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BASE_POPUP_OPTIONS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DEFAULT_WIDTH=500,DEFAULT_HEIGHT=600,TARGET_BLANK="_blank",FIREFOX_EMPTY_URL="http://localhost";class AuthPopup{constructor($t){this.window=$t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _open(xt,$t,Ct,kt=DEFAULT_WIDTH,Mt=DEFAULT_HEIGHT){const Ft=Math.max((window.screen.availHeight-Mt)/2,0).toString(),jt=Math.max((window.screen.availWidth-kt)/2,0).toString();let Bt="";const Vt=Object.assign(Object.assign({},BASE_POPUP_OPTIONS),{width:kt.toString(),height:Mt.toString(),top:Ft,left:jt}),zt=getUA().toLowerCase();Ct&&(Bt=_isChromeIOS(zt)?TARGET_BLANK:Ct),_isFirefox(zt)&&($t=$t||FIREFOX_EMPTY_URL,Vt.scrollbars="yes");const Ht=Object.entries(Vt).reduce((qt,[Wt,Yt])=>`${qt}${Wt}=${Yt},`,"");if(_isIOSStandalone(zt)&&Bt!=="_self")return openAsNewWindowIOS($t||"",Bt),new AuthPopup(null);const Gt=window.open($t||"",Bt,Ht);_assert(Gt,xt,"popup-blocked");try{Gt.focus()}catch{}return new AuthPopup(Gt)}function openAsNewWindowIOS(xt,$t){const Ct=document.createElement("a");Ct.href=xt,Ct.target=$t;const kt=document.createEvent("MouseEvent");kt.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),Ct.dispatchEvent(kt)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WIDGET_PATH="__/auth/handler",EMULATOR_WIDGET_PATH="emulator/auth/handler",FIREBASE_APP_CHECK_FRAGMENT_ID=encodeURIComponent("fac");async function _getRedirectUrl(xt,$t,Ct,kt,Mt,Ft){_assert(xt.config.authDomain,xt,"auth-domain-config-required"),_assert(xt.config.apiKey,xt,"invalid-api-key");const jt={apiKey:xt.config.apiKey,appName:xt.name,authType:Ct,redirectUrl:kt,v:SDK_VERSION,eventId:Mt};if($t instanceof FederatedAuthProvider){$t.setDefaultLanguage(xt.languageCode),jt.providerId=$t.providerId||"",isEmpty$2($t.getCustomParameters())||(jt.customParameters=JSON.stringify($t.getCustomParameters()));for(const[Ht,Gt]of Object.entries({}))jt[Ht]=Gt}if($t instanceof BaseOAuthProvider){const Ht=$t.getScopes().filter(Gt=>Gt!=="");Ht.length>0&&(jt.scopes=Ht.join(","))}xt.tenantId&&(jt.tid=xt.tenantId);const Bt=jt;for(const Ht of Object.keys(Bt))Bt[Ht]===void 0&&delete Bt[Ht];const Vt=await xt._getAppCheckToken(),zt=Vt?`#${FIREBASE_APP_CHECK_FRAGMENT_ID}=${encodeURIComponent(Vt)}`:"";return`${getHandlerBase(xt)}?${querystring(Bt).slice(1)}${zt}`}function getHandlerBase({config:xt}){return xt.emulator?_emulatorUrl(xt,EMULATOR_WIDGET_PATH):`https://${xt.authDomain}/${WIDGET_PATH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEB_STORAGE_SUPPORT_KEY="webStorageSupport";class BrowserPopupRedirectResolver{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=browserSessionPersistence,this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}async _openPopup($t,Ct,kt,Mt){var Ft;debugAssert((Ft=this.eventManagers[$t._key()])===null||Ft===void 0?void 0:Ft.manager,"_initialize() not called before _openPopup()");const jt=await _getRedirectUrl($t,Ct,kt,_getCurrentUrl(),Mt);return _open($t,jt,_generateEventId())}async _openRedirect($t,Ct,kt,Mt){await this._originValidation($t);const Ft=await _getRedirectUrl($t,Ct,kt,_getCurrentUrl(),Mt);return _setWindowLocation(Ft),new Promise(()=>{})}_initialize($t){const Ct=$t._key();if(this.eventManagers[Ct]){const{manager:Mt,promise:Ft}=this.eventManagers[Ct];return Mt?Promise.resolve(Mt):(debugAssert(Ft,"If manager is not set, promise should be"),Ft)}const kt=this.initAndGetManager($t);return this.eventManagers[Ct]={promise:kt},kt.catch(()=>{delete this.eventManagers[Ct]}),kt}async initAndGetManager($t){const Ct=await _openIframe($t),kt=new AuthEventManager($t);return Ct.register("authEvent",Mt=>(_assert(Mt==null?void 0:Mt.authEvent,$t,"invalid-auth-event"),{status:kt.onEvent(Mt.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[$t._key()]={manager:kt},this.iframes[$t._key()]=Ct,kt}_isIframeWebStorageSupported($t,Ct){this.iframes[$t._key()].send(WEB_STORAGE_SUPPORT_KEY,{type:WEB_STORAGE_SUPPORT_KEY},Mt=>{var Ft;const jt=(Ft=Mt==null?void 0:Mt[0])===null||Ft===void 0?void 0:Ft[WEB_STORAGE_SUPPORT_KEY];jt!==void 0&&Ct(!!jt),_fail($t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation($t){const Ct=$t._key();return this.originValidationPromises[Ct]||(this.originValidationPromises[Ct]=_validateOrigin($t)),this.originValidationPromises[Ct]}get _shouldInitProactively(){return _isMobileBrowser()||_isSafari()||_isIOS()}}const browserPopupRedirectResolver=BrowserPopupRedirectResolver;var name$5="@firebase/auth",version$8="1.7.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthInterop{constructor($t){this.auth=$t,this.internalListeners=new Map}getUid(){var $t;return this.assertAuthConfigured(),(($t=this.auth.currentUser)===null||$t===void 0?void 0:$t.uid)||null}async getToken($t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken($t)}:null}addAuthTokenListener($t){if(this.assertAuthConfigured(),this.internalListeners.has($t))return;const Ct=this.auth.onIdTokenChanged(kt=>{$t((kt==null?void 0:kt.stsTokenManager.accessToken)||null)});this.internalListeners.set($t,Ct),this.updateProactiveRefresh()}removeAuthTokenListener($t){this.assertAuthConfigured();const Ct=this.internalListeners.get($t);Ct&&(this.internalListeners.delete($t),Ct(),this.updateProactiveRefresh())}assertAuthConfigured(){_assert(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getVersionForPlatform(xt){switch(xt){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function registerAuth(xt){_registerComponent(new Component("auth",($t,{options:Ct})=>{const kt=$t.getProvider("app").getImmediate(),Mt=$t.getProvider("heartbeat"),Ft=$t.getProvider("app-check-internal"),{apiKey:jt,authDomain:Bt}=kt.options;_assert(jt&&!jt.includes(":"),"invalid-api-key",{appName:kt.name});const Vt={apiKey:jt,authDomain:Bt,clientPlatform:xt,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_getClientVersion(xt)},zt=new AuthImpl(kt,Mt,Ft,Vt);return _initializeAuthInstance(zt,Ct),zt},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(($t,Ct,kt)=>{$t.getProvider("auth-internal").initialize()})),_registerComponent(new Component("auth-internal",$t=>{const Ct=_castAuth($t.getProvider("auth").getImmediate());return(kt=>new AuthInterop(kt))(Ct)},"PRIVATE").setInstantiationMode("EXPLICIT")),registerVersion(name$5,version$8,getVersionForPlatform(xt)),registerVersion(name$5,version$8,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ID_TOKEN_MAX_AGE=5*60,authIdTokenMaxAge=getExperimentalSetting("authIdTokenMaxAge")||DEFAULT_ID_TOKEN_MAX_AGE;let lastPostedIdToken=null;const mintCookieFactory=xt=>async $t=>{const Ct=$t&&await $t.getIdTokenResult(),kt=Ct&&(new Date().getTime()-Date.parse(Ct.issuedAtTime))/1e3;if(kt&&kt>authIdTokenMaxAge)return;const Mt=Ct==null?void 0:Ct.token;lastPostedIdToken!==Mt&&(lastPostedIdToken=Mt,await fetch(xt,{method:Mt?"POST":"DELETE",headers:Mt?{Authorization:`Bearer ${Mt}`}:{}}))};function getAuth(xt=getApp()){const $t=_getProvider(xt,"auth");if($t.isInitialized())return $t.getImmediate();const Ct=initializeAuth(xt,{popupRedirectResolver:browserPopupRedirectResolver,persistence:[indexedDBLocalPersistence,browserLocalPersistence,browserSessionPersistence]}),kt=getExperimentalSetting("authTokenSyncURL");if(kt&&typeof isSecureContext=="boolean"&&isSecureContext){const Ft=new URL(kt,location.origin);if(location.origin===Ft.origin){const jt=mintCookieFactory(Ft.toString());beforeAuthStateChanged(Ct,jt,()=>jt(Ct.currentUser)),onIdTokenChanged(Ct,Bt=>jt(Bt))}}const Mt=getDefaultEmulatorHost("auth");return Mt&&connectAuthEmulator(Ct,`http://${Mt}`),Ct}function getScriptParentElement(){var xt,$t;return($t=(xt=document.getElementsByTagName("head"))===null||xt===void 0?void 0:xt[0])!==null&&$t!==void 0?$t:document}_setExternalJSProvider({loadJS(xt){return new Promise(($t,Ct)=>{const kt=document.createElement("script");kt.setAttribute("src",xt),kt.onload=$t,kt.onerror=Mt=>{const Ft=_createError("internal-error");Ft.customData=Mt,Ct(Ft)},kt.type="text/javascript",kt.charset="UTF-8",getScriptParentElement().appendChild(kt)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});registerAuth("Browser");var name$4="firebase",version$7="10.12.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */registerVersion(name$4,version$7,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_HOST="firebasestorage.googleapis.com",CONFIG_STORAGE_BUCKET_KEY="storageBucket",DEFAULT_MAX_OPERATION_RETRY_TIME=2*60*1e3,DEFAULT_MAX_UPLOAD_RETRY_TIME=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StorageError extends FirebaseError{constructor($t,Ct,kt=0){super(prependCode($t),`Firebase Storage: ${Ct} (${prependCode($t)})`),this.status_=kt,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,StorageError.prototype)}get status(){return this.status_}set status($t){this.status_=$t}_codeEquals($t){return prependCode($t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse($t){this.customData.serverResponse=$t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var StorageErrorCode;(function(xt){xt.UNKNOWN="unknown",xt.OBJECT_NOT_FOUND="object-not-found",xt.BUCKET_NOT_FOUND="bucket-not-found",xt.PROJECT_NOT_FOUND="project-not-found",xt.QUOTA_EXCEEDED="quota-exceeded",xt.UNAUTHENTICATED="unauthenticated",xt.UNAUTHORIZED="unauthorized",xt.UNAUTHORIZED_APP="unauthorized-app",xt.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",xt.INVALID_CHECKSUM="invalid-checksum",xt.CANCELED="canceled",xt.INVALID_EVENT_NAME="invalid-event-name",xt.INVALID_URL="invalid-url",xt.INVALID_DEFAULT_BUCKET="invalid-default-bucket",xt.NO_DEFAULT_BUCKET="no-default-bucket",xt.CANNOT_SLICE_BLOB="cannot-slice-blob",xt.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",xt.NO_DOWNLOAD_URL="no-download-url",xt.INVALID_ARGUMENT="invalid-argument",xt.INVALID_ARGUMENT_COUNT="invalid-argument-count",xt.APP_DELETED="app-deleted",xt.INVALID_ROOT_OPERATION="invalid-root-operation",xt.INVALID_FORMAT="invalid-format",xt.INTERNAL_ERROR="internal-error",xt.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(StorageErrorCode||(StorageErrorCode={}));function prependCode(xt){return"storage/"+xt}function unknown(){const xt="An unknown error occurred, please check the error payload for server response.";return new StorageError(StorageErrorCode.UNKNOWN,xt)}function objectNotFound(xt){return new StorageError(StorageErrorCode.OBJECT_NOT_FOUND,"Object '"+xt+"' does not exist.")}function quotaExceeded(xt){return new StorageError(StorageErrorCode.QUOTA_EXCEEDED,"Quota for bucket '"+xt+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function unauthenticated(){const xt="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new StorageError(StorageErrorCode.UNAUTHENTICATED,xt)}function unauthorizedApp(){return new StorageError(StorageErrorCode.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function unauthorized(xt){return new StorageError(StorageErrorCode.UNAUTHORIZED,"User does not have permission to access '"+xt+"'.")}function retryLimitExceeded(){return new StorageError(StorageErrorCode.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function canceled(){return new StorageError(StorageErrorCode.CANCELED,"User canceled the upload/download.")}function invalidUrl(xt){return new StorageError(StorageErrorCode.INVALID_URL,"Invalid URL '"+xt+"'.")}function invalidDefaultBucket(xt){return new StorageError(StorageErrorCode.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+xt+"'.")}function noDefaultBucket(){return new StorageError(StorageErrorCode.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+CONFIG_STORAGE_BUCKET_KEY+"' property when initializing the app?")}function cannotSliceBlob(){return new StorageError(StorageErrorCode.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function noDownloadURL(){return new StorageError(StorageErrorCode.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function missingPolyFill(xt){return new StorageError(StorageErrorCode.UNSUPPORTED_ENVIRONMENT,`${xt} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function invalidArgument(xt){return new StorageError(StorageErrorCode.INVALID_ARGUMENT,xt)}function appDeleted(){return new StorageError(StorageErrorCode.APP_DELETED,"The Firebase app was deleted.")}function invalidRootOperation(xt){return new StorageError(StorageErrorCode.INVALID_ROOT_OPERATION,"The operation '"+xt+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function invalidFormat(xt,$t){return new StorageError(StorageErrorCode.INVALID_FORMAT,"String does not match format '"+xt+"': "+$t)}function internalError(xt){throw new StorageError(StorageErrorCode.INTERNAL_ERROR,"Internal error: "+xt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Location{constructor($t,Ct){this.bucket=$t,this.path_=Ct}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const $t=encodeURIComponent;return"/b/"+$t(this.bucket)+"/o/"+$t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec($t,Ct){let kt;try{kt=Location.makeFromUrl($t,Ct)}catch{return new Location($t,"")}if(kt.path==="")return kt;throw invalidDefaultBucket($t)}static makeFromUrl($t,Ct){let kt=null;const Mt="([A-Za-z0-9.\\-_]+)";function Ft(sn){sn.path.charAt(sn.path.length-1)==="/"&&(sn.path_=sn.path_.slice(0,-1))}const jt="(/(.*))?$",Bt=new RegExp("^gs://"+Mt+jt,"i"),Vt={bucket:1,path:3};function zt(sn){sn.path_=decodeURIComponent(sn.path)}const Ht="v[A-Za-z0-9_]+",Gt=Ct.replace(/[.]/g,"\\."),qt="(/([^?#]*).*)?$",Wt=new RegExp(`^https?://${Gt}/${Ht}/b/${Mt}/o${qt}`,"i"),Yt={bucket:1,path:3},Kt=Ct===DEFAULT_HOST?"(?:storage.googleapis.com|storage.cloud.google.com)":Ct,Xt="([^?#]*)",Qt=new RegExp(`^https?://${Kt}/${Mt}/${Xt}`,"i"),Zt=[{regex:Bt,indices:Vt,postModify:Ft},{regex:Wt,indices:Yt,postModify:zt},{regex:Qt,indices:{bucket:1,path:2},postModify:zt}];for(let sn=0;sn<Zt.length;sn++){const ln=Zt[sn],dn=ln.regex.exec($t);if(dn){const hn=dn[ln.indices.bucket];let cn=dn[ln.indices.path];cn||(cn=""),kt=new Location(hn,cn),ln.postModify(kt);break}}if(kt==null)throw invalidUrl($t);return kt}}class FailRequest{constructor($t){this.promise_=Promise.reject($t)}getPromise(){return this.promise_}cancel($t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function start(xt,$t,Ct){let kt=1,Mt=null,Ft=null,jt=!1,Bt=0;function Vt(){return Bt===2}let zt=!1;function Ht(...Xt){zt||(zt=!0,$t.apply(null,Xt))}function Gt(Xt){Mt=setTimeout(()=>{Mt=null,xt(Wt,Vt())},Xt)}function qt(){Ft&&clearTimeout(Ft)}function Wt(Xt,...Qt){if(zt){qt();return}if(Xt){qt(),Ht.call(null,Xt,...Qt);return}if(Vt()||jt){qt(),Ht.call(null,Xt,...Qt);return}kt<64&&(kt*=2);let Zt;Bt===1?(Bt=2,Zt=0):Zt=(kt+Math.random())*1e3,Gt(Zt)}let Yt=!1;function Kt(Xt){Yt||(Yt=!0,qt(),!zt&&(Mt!==null?(Xt||(Bt=2),clearTimeout(Mt),Gt(0)):Xt||(Bt=1)))}return Gt(0),Ft=setTimeout(()=>{jt=!0,Kt(!0)},Ct),Kt}function stop$1(xt){xt(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isJustDef(xt){return xt!==void 0}function isNonArrayObject(xt){return typeof xt=="object"&&!Array.isArray(xt)}function isString$1(xt){return typeof xt=="string"||xt instanceof String}function isNativeBlob(xt){return isNativeBlobDefined()&&xt instanceof Blob}function isNativeBlobDefined(){return typeof Blob<"u"}function validateNumber(xt,$t,Ct,kt){if(kt<$t)throw invalidArgument(`Invalid value for '${xt}'. Expected ${$t} or greater.`);if(kt>Ct)throw invalidArgument(`Invalid value for '${xt}'. Expected ${Ct} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function makeUrl(xt,$t,Ct){let kt=$t;return Ct==null&&(kt=`https://${$t}`),`${Ct}://${kt}/v0${xt}`}function makeQueryString(xt){const $t=encodeURIComponent;let Ct="?";for(const kt in xt)if(xt.hasOwnProperty(kt)){const Mt=$t(kt)+"="+$t(xt[kt]);Ct=Ct+Mt+"&"}return Ct=Ct.slice(0,-1),Ct}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ErrorCode$1;(function(xt){xt[xt.NO_ERROR=0]="NO_ERROR",xt[xt.NETWORK_ERROR=1]="NETWORK_ERROR",xt[xt.ABORT=2]="ABORT"})(ErrorCode$1||(ErrorCode$1={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isRetryStatusCode(xt,$t){const Ct=xt>=500&&xt<600,Mt=[408,429].indexOf(xt)!==-1,Ft=$t.indexOf(xt)!==-1;return Ct||Mt||Ft}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NetworkRequest{constructor($t,Ct,kt,Mt,Ft,jt,Bt,Vt,zt,Ht,Gt,qt=!0){this.url_=$t,this.method_=Ct,this.headers_=kt,this.body_=Mt,this.successCodes_=Ft,this.additionalRetryCodes_=jt,this.callback_=Bt,this.errorCallback_=Vt,this.timeout_=zt,this.progressCallback_=Ht,this.connectionFactory_=Gt,this.retry=qt,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((Wt,Yt)=>{this.resolve_=Wt,this.reject_=Yt,this.start_()})}start_(){const $t=(kt,Mt)=>{if(Mt){kt(!1,new RequestEndStatus(!1,null,!0));return}const Ft=this.connectionFactory_();this.pendingConnection_=Ft;const jt=Bt=>{const Vt=Bt.loaded,zt=Bt.lengthComputable?Bt.total:-1;this.progressCallback_!==null&&this.progressCallback_(Vt,zt)};this.progressCallback_!==null&&Ft.addUploadProgressListener(jt),Ft.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&Ft.removeUploadProgressListener(jt),this.pendingConnection_=null;const Bt=Ft.getErrorCode()===ErrorCode$1.NO_ERROR,Vt=Ft.getStatus();if(!Bt||isRetryStatusCode(Vt,this.additionalRetryCodes_)&&this.retry){const Ht=Ft.getErrorCode()===ErrorCode$1.ABORT;kt(!1,new RequestEndStatus(!1,null,Ht));return}const zt=this.successCodes_.indexOf(Vt)!==-1;kt(!0,new RequestEndStatus(zt,Ft))})},Ct=(kt,Mt)=>{const Ft=this.resolve_,jt=this.reject_,Bt=Mt.connection;if(Mt.wasSuccessCode)try{const Vt=this.callback_(Bt,Bt.getResponse());isJustDef(Vt)?Ft(Vt):Ft()}catch(Vt){jt(Vt)}else if(Bt!==null){const Vt=unknown();Vt.serverResponse=Bt.getErrorText(),this.errorCallback_?jt(this.errorCallback_(Bt,Vt)):jt(Vt)}else if(Mt.canceled){const Vt=this.appDelete_?appDeleted():canceled();jt(Vt)}else{const Vt=retryLimitExceeded();jt(Vt)}};this.canceled_?Ct(!1,new RequestEndStatus(!1,null,!0)):this.backoffId_=start($t,Ct,this.timeout_)}getPromise(){return this.promise_}cancel($t){this.canceled_=!0,this.appDelete_=$t||!1,this.backoffId_!==null&&stop$1(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class RequestEndStatus{constructor($t,Ct,kt){this.wasSuccessCode=$t,this.connection=Ct,this.canceled=!!kt}}function addAuthHeader_(xt,$t){$t!==null&&$t.length>0&&(xt.Authorization="Firebase "+$t)}function addVersionHeader_(xt,$t){xt["X-Firebase-Storage-Version"]="webjs/"+($t??"AppManager")}function addGmpidHeader_(xt,$t){$t&&(xt["X-Firebase-GMPID"]=$t)}function addAppCheckHeader_(xt,$t){$t!==null&&(xt["X-Firebase-AppCheck"]=$t)}function makeRequest(xt,$t,Ct,kt,Mt,Ft,jt=!0){const Bt=makeQueryString(xt.urlParams),Vt=xt.url+Bt,zt=Object.assign({},xt.headers);return addGmpidHeader_(zt,$t),addAuthHeader_(zt,Ct),addVersionHeader_(zt,Ft),addAppCheckHeader_(zt,kt),new NetworkRequest(Vt,xt.method,zt,xt.body,xt.successCodes,xt.additionalRetryCodes,xt.handler,xt.errorHandler,xt.timeout,xt.progressCallback,Mt,jt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getBlobBuilder(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function getBlob$1(...xt){const $t=getBlobBuilder();if($t!==void 0){const Ct=new $t;for(let kt=0;kt<xt.length;kt++)Ct.append(xt[kt]);return Ct.getBlob()}else{if(isNativeBlobDefined())return new Blob(xt);throw new StorageError(StorageErrorCode.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function sliceBlob(xt,$t,Ct){return xt.webkitSlice?xt.webkitSlice($t,Ct):xt.mozSlice?xt.mozSlice($t,Ct):xt.slice?xt.slice($t,Ct):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function decodeBase64(xt){if(typeof atob>"u")throw missingPolyFill("base-64");return atob(xt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const StringFormat={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class StringData{constructor($t,Ct){this.data=$t,this.contentType=Ct||null}}function dataFromString(xt,$t){switch(xt){case StringFormat.RAW:return new StringData(utf8Bytes_($t));case StringFormat.BASE64:case StringFormat.BASE64URL:return new StringData(base64Bytes_(xt,$t));case StringFormat.DATA_URL:return new StringData(dataURLBytes_($t),dataURLContentType_($t))}throw unknown()}function utf8Bytes_(xt){const $t=[];for(let Ct=0;Ct<xt.length;Ct++){let kt=xt.charCodeAt(Ct);if(kt<=127)$t.push(kt);else if(kt<=2047)$t.push(192|kt>>6,128|kt&63);else if((kt&64512)===55296)if(!(Ct<xt.length-1&&(xt.charCodeAt(Ct+1)&64512)===56320))$t.push(239,191,189);else{const Ft=kt,jt=xt.charCodeAt(++Ct);kt=65536|(Ft&1023)<<10|jt&1023,$t.push(240|kt>>18,128|kt>>12&63,128|kt>>6&63,128|kt&63)}else(kt&64512)===56320?$t.push(239,191,189):$t.push(224|kt>>12,128|kt>>6&63,128|kt&63)}return new Uint8Array($t)}function percentEncodedBytes_(xt){let $t;try{$t=decodeURIComponent(xt)}catch{throw invalidFormat(StringFormat.DATA_URL,"Malformed data URL.")}return utf8Bytes_($t)}function base64Bytes_(xt,$t){switch(xt){case StringFormat.BASE64:{const Mt=$t.indexOf("-")!==-1,Ft=$t.indexOf("_")!==-1;if(Mt||Ft)throw invalidFormat(xt,"Invalid character '"+(Mt?"-":"_")+"' found: is it base64url encoded?");break}case StringFormat.BASE64URL:{const Mt=$t.indexOf("+")!==-1,Ft=$t.indexOf("/")!==-1;if(Mt||Ft)throw invalidFormat(xt,"Invalid character '"+(Mt?"+":"/")+"' found: is it base64 encoded?");$t=$t.replace(/-/g,"+").replace(/_/g,"/");break}}let Ct;try{Ct=decodeBase64($t)}catch(Mt){throw Mt.message.includes("polyfill")?Mt:invalidFormat(xt,"Invalid character found")}const kt=new Uint8Array(Ct.length);for(let Mt=0;Mt<Ct.length;Mt++)kt[Mt]=Ct.charCodeAt(Mt);return kt}class DataURLParts{constructor($t){this.base64=!1,this.contentType=null;const Ct=$t.match(/^data:([^,]+)?,/);if(Ct===null)throw invalidFormat(StringFormat.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const kt=Ct[1]||null;kt!=null&&(this.base64=endsWith(kt,";base64"),this.contentType=this.base64?kt.substring(0,kt.length-7):kt),this.rest=$t.substring($t.indexOf(",")+1)}}function dataURLBytes_(xt){const $t=new DataURLParts(xt);return $t.base64?base64Bytes_(StringFormat.BASE64,$t.rest):percentEncodedBytes_($t.rest)}function dataURLContentType_(xt){return new DataURLParts(xt).contentType}function endsWith(xt,$t){return xt.length>=$t.length?xt.substring(xt.length-$t.length)===$t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FbsBlob{constructor($t,Ct){let kt=0,Mt="";isNativeBlob($t)?(this.data_=$t,kt=$t.size,Mt=$t.type):$t instanceof ArrayBuffer?(Ct?this.data_=new Uint8Array($t):(this.data_=new Uint8Array($t.byteLength),this.data_.set(new Uint8Array($t))),kt=this.data_.length):$t instanceof Uint8Array&&(Ct?this.data_=$t:(this.data_=new Uint8Array($t.length),this.data_.set($t)),kt=$t.length),this.size_=kt,this.type_=Mt}size(){return this.size_}type(){return this.type_}slice($t,Ct){if(isNativeBlob(this.data_)){const kt=this.data_,Mt=sliceBlob(kt,$t,Ct);return Mt===null?null:new FbsBlob(Mt)}else{const kt=new Uint8Array(this.data_.buffer,$t,Ct-$t);return new FbsBlob(kt,!0)}}static getBlob(...$t){if(isNativeBlobDefined()){const Ct=$t.map(kt=>kt instanceof FbsBlob?kt.data_:kt);return new FbsBlob(getBlob$1.apply(null,Ct))}else{const Ct=$t.map(jt=>isString$1(jt)?dataFromString(StringFormat.RAW,jt).data:jt.data_);let kt=0;Ct.forEach(jt=>{kt+=jt.byteLength});const Mt=new Uint8Array(kt);let Ft=0;return Ct.forEach(jt=>{for(let Bt=0;Bt<jt.length;Bt++)Mt[Ft++]=jt[Bt]}),new FbsBlob(Mt,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jsonObjectOrNull(xt){let $t;try{$t=JSON.parse(xt)}catch{return null}return isNonArrayObject($t)?$t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function parent(xt){if(xt.length===0)return null;const $t=xt.lastIndexOf("/");return $t===-1?"":xt.slice(0,$t)}function child(xt,$t){const Ct=$t.split("/").filter(kt=>kt.length>0).join("/");return xt.length===0?Ct:xt+"/"+Ct}function lastComponent(xt){const $t=xt.lastIndexOf("/",xt.length-2);return $t===-1?xt:xt.slice($t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function noXform_(xt,$t){return $t}class Mapping{constructor($t,Ct,kt,Mt){this.server=$t,this.local=Ct||$t,this.writable=!!kt,this.xform=Mt||noXform_}}let mappings_=null;function xformPath(xt){return!isString$1(xt)||xt.length<2?xt:lastComponent(xt)}function getMappings(){if(mappings_)return mappings_;const xt=[];xt.push(new Mapping("bucket")),xt.push(new Mapping("generation")),xt.push(new Mapping("metageneration")),xt.push(new Mapping("name","fullPath",!0));function $t(Ft,jt){return xformPath(jt)}const Ct=new Mapping("name");Ct.xform=$t,xt.push(Ct);function kt(Ft,jt){return jt!==void 0?Number(jt):jt}const Mt=new Mapping("size");return Mt.xform=kt,xt.push(Mt),xt.push(new Mapping("timeCreated")),xt.push(new Mapping("updated")),xt.push(new Mapping("md5Hash",null,!0)),xt.push(new Mapping("cacheControl",null,!0)),xt.push(new Mapping("contentDisposition",null,!0)),xt.push(new Mapping("contentEncoding",null,!0)),xt.push(new Mapping("contentLanguage",null,!0)),xt.push(new Mapping("contentType",null,!0)),xt.push(new Mapping("metadata","customMetadata",!0)),mappings_=xt,mappings_}function addRef(xt,$t){function Ct(){const kt=xt.bucket,Mt=xt.fullPath,Ft=new Location(kt,Mt);return $t._makeStorageReference(Ft)}Object.defineProperty(xt,"ref",{get:Ct})}function fromResource(xt,$t,Ct){const kt={};kt.type="file";const Mt=Ct.length;for(let Ft=0;Ft<Mt;Ft++){const jt=Ct[Ft];kt[jt.local]=jt.xform(kt,$t[jt.server])}return addRef(kt,xt),kt}function fromResourceString(xt,$t,Ct){const kt=jsonObjectOrNull($t);return kt===null?null:fromResource(xt,kt,Ct)}function downloadUrlFromResourceString(xt,$t,Ct,kt){const Mt=jsonObjectOrNull($t);if(Mt===null||!isString$1(Mt.downloadTokens))return null;const Ft=Mt.downloadTokens;if(Ft.length===0)return null;const jt=encodeURIComponent;return Ft.split(",").map(zt=>{const Ht=xt.bucket,Gt=xt.fullPath,qt="/b/"+jt(Ht)+"/o/"+jt(Gt),Wt=makeUrl(qt,Ct,kt),Yt=makeQueryString({alt:"media",token:zt});return Wt+Yt})[0]}function toResourceString(xt,$t){const Ct={},kt=$t.length;for(let Mt=0;Mt<kt;Mt++){const Ft=$t[Mt];Ft.writable&&(Ct[Ft.server]=xt[Ft.local])}return JSON.stringify(Ct)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PREFIXES_KEY="prefixes",ITEMS_KEY="items";function fromBackendResponse(xt,$t,Ct){const kt={prefixes:[],items:[],nextPageToken:Ct.nextPageToken};if(Ct[PREFIXES_KEY])for(const Mt of Ct[PREFIXES_KEY]){const Ft=Mt.replace(/\/$/,""),jt=xt._makeStorageReference(new Location($t,Ft));kt.prefixes.push(jt)}if(Ct[ITEMS_KEY])for(const Mt of Ct[ITEMS_KEY]){const Ft=xt._makeStorageReference(new Location($t,Mt.name));kt.items.push(Ft)}return kt}function fromResponseString(xt,$t,Ct){const kt=jsonObjectOrNull(Ct);return kt===null?null:fromBackendResponse(xt,$t,kt)}class RequestInfo{constructor($t,Ct,kt,Mt){this.url=$t,this.method=Ct,this.handler=kt,this.timeout=Mt,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function handlerCheck(xt){if(!xt)throw unknown()}function metadataHandler(xt,$t){function Ct(kt,Mt){const Ft=fromResourceString(xt,Mt,$t);return handlerCheck(Ft!==null),Ft}return Ct}function listHandler(xt,$t){function Ct(kt,Mt){const Ft=fromResponseString(xt,$t,Mt);return handlerCheck(Ft!==null),Ft}return Ct}function downloadUrlHandler(xt,$t){function Ct(kt,Mt){const Ft=fromResourceString(xt,Mt,$t);return handlerCheck(Ft!==null),downloadUrlFromResourceString(Ft,Mt,xt.host,xt._protocol)}return Ct}function sharedErrorHandler(xt){function $t(Ct,kt){let Mt;return Ct.getStatus()===401?Ct.getErrorText().includes("Firebase App Check token is invalid")?Mt=unauthorizedApp():Mt=unauthenticated():Ct.getStatus()===402?Mt=quotaExceeded(xt.bucket):Ct.getStatus()===403?Mt=unauthorized(xt.path):Mt=kt,Mt.status=Ct.getStatus(),Mt.serverResponse=kt.serverResponse,Mt}return $t}function objectErrorHandler(xt){const $t=sharedErrorHandler(xt);function Ct(kt,Mt){let Ft=$t(kt,Mt);return kt.getStatus()===404&&(Ft=objectNotFound(xt.path)),Ft.serverResponse=Mt.serverResponse,Ft}return Ct}function list$2(xt,$t,Ct,kt,Mt){const Ft={};$t.isRoot?Ft.prefix="":Ft.prefix=$t.path+"/",Ct.length>0&&(Ft.delimiter=Ct),kt&&(Ft.pageToken=kt),Mt&&(Ft.maxResults=Mt);const jt=$t.bucketOnlyServerUrl(),Bt=makeUrl(jt,xt.host,xt._protocol),Vt="GET",zt=xt.maxOperationRetryTime,Ht=new RequestInfo(Bt,Vt,listHandler(xt,$t.bucket),zt);return Ht.urlParams=Ft,Ht.errorHandler=sharedErrorHandler($t),Ht}function getDownloadUrl(xt,$t,Ct){const kt=$t.fullServerUrl(),Mt=makeUrl(kt,xt.host,xt._protocol),Ft="GET",jt=xt.maxOperationRetryTime,Bt=new RequestInfo(Mt,Ft,downloadUrlHandler(xt,Ct),jt);return Bt.errorHandler=objectErrorHandler($t),Bt}function deleteObject$2(xt,$t){const Ct=$t.fullServerUrl(),kt=makeUrl(Ct,xt.host,xt._protocol),Mt="DELETE",Ft=xt.maxOperationRetryTime;function jt(Vt,zt){}const Bt=new RequestInfo(kt,Mt,jt,Ft);return Bt.successCodes=[200,204],Bt.errorHandler=objectErrorHandler($t),Bt}function determineContentType_(xt,$t){return xt&&xt.contentType||$t&&$t.type()||"application/octet-stream"}function metadataForUpload_(xt,$t,Ct){const kt=Object.assign({},Ct);return kt.fullPath=xt.path,kt.size=$t.size(),kt.contentType||(kt.contentType=determineContentType_(null,$t)),kt}function multipartUpload(xt,$t,Ct,kt,Mt){const Ft=$t.bucketOnlyServerUrl(),jt={"X-Goog-Upload-Protocol":"multipart"};function Bt(){let Zt="";for(let sn=0;sn<2;sn++)Zt=Zt+Math.random().toString().slice(2);return Zt}const Vt=Bt();jt["Content-Type"]="multipart/related; boundary="+Vt;const zt=metadataForUpload_($t,kt,Mt),Ht=toResourceString(zt,Ct),Gt="--"+Vt+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+Ht+`\r
--`+Vt+`\r
Content-Type: `+zt.contentType+`\r
\r
`,qt=`\r
--`+Vt+"--",Wt=FbsBlob.getBlob(Gt,kt,qt);if(Wt===null)throw cannotSliceBlob();const Yt={name:zt.fullPath},Kt=makeUrl(Ft,xt.host,xt._protocol),Xt="POST",Qt=xt.maxUploadRetryTime,Jt=new RequestInfo(Kt,Xt,metadataHandler(xt,Ct),Qt);return Jt.urlParams=Yt,Jt.headers=jt,Jt.body=Wt.uploadData(),Jt.errorHandler=sharedErrorHandler($t),Jt}class XhrConnection{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ErrorCode$1.NO_ERROR,this.sendPromise_=new Promise($t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ErrorCode$1.ABORT,$t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ErrorCode$1.NETWORK_ERROR,$t()}),this.xhr_.addEventListener("load",()=>{$t()})})}send($t,Ct,kt,Mt){if(this.sent_)throw internalError("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(Ct,$t,!0),Mt!==void 0)for(const Ft in Mt)Mt.hasOwnProperty(Ft)&&this.xhr_.setRequestHeader(Ft,Mt[Ft].toString());return kt!==void 0?this.xhr_.send(kt):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw internalError("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw internalError("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw internalError("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw internalError("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader($t){return this.xhr_.getResponseHeader($t)}addUploadProgressListener($t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",$t)}removeUploadProgressListener($t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",$t)}}class XhrTextConnection extends XhrConnection{initXhr(){this.xhr_.responseType="text"}}function newTextConnection(){return new XhrTextConnection}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Reference{constructor($t,Ct){this._service=$t,Ct instanceof Location?this._location=Ct:this._location=Location.makeFromUrl(Ct,$t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef($t,Ct){return new Reference($t,Ct)}get root(){const $t=new Location(this._location.bucket,"");return this._newRef(this._service,$t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return lastComponent(this._location.path)}get storage(){return this._service}get parent(){const $t=parent(this._location.path);if($t===null)return null;const Ct=new Location(this._location.bucket,$t);return new Reference(this._service,Ct)}_throwIfRoot($t){if(this._location.path==="")throw invalidRootOperation($t)}}function uploadBytes$1(xt,$t,Ct){xt._throwIfRoot("uploadBytes");const kt=multipartUpload(xt.storage,xt._location,getMappings(),new FbsBlob($t,!0),Ct);return xt.storage.makeRequestWithTokens(kt,newTextConnection).then(Mt=>({metadata:Mt,ref:xt}))}function listAll$1(xt){const $t={prefixes:[],items:[]};return listAllHelper(xt,$t).then(()=>$t)}async function listAllHelper(xt,$t,Ct){const Mt=await list$1(xt,{pageToken:Ct});$t.prefixes.push(...Mt.prefixes),$t.items.push(...Mt.items),Mt.nextPageToken!=null&&await listAllHelper(xt,$t,Mt.nextPageToken)}function list$1(xt,$t){$t!=null&&typeof $t.maxResults=="number"&&validateNumber("options.maxResults",1,1e3,$t.maxResults);const Ct=$t||{},kt=list$2(xt.storage,xt._location,"/",Ct.pageToken,Ct.maxResults);return xt.storage.makeRequestWithTokens(kt,newTextConnection)}function getDownloadURL$1(xt){xt._throwIfRoot("getDownloadURL");const $t=getDownloadUrl(xt.storage,xt._location,getMappings());return xt.storage.makeRequestWithTokens($t,newTextConnection).then(Ct=>{if(Ct===null)throw noDownloadURL();return Ct})}function deleteObject$1(xt){xt._throwIfRoot("deleteObject");const $t=deleteObject$2(xt.storage,xt._location);return xt.storage.makeRequestWithTokens($t,newTextConnection)}function _getChild$1(xt,$t){const Ct=child(xt._location.path,$t),kt=new Location(xt._location.bucket,Ct);return new Reference(xt.storage,kt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isUrl(xt){return/^[A-Za-z]+:\/\//.test(xt)}function refFromURL(xt,$t){return new Reference(xt,$t)}function refFromPath(xt,$t){if(xt instanceof FirebaseStorageImpl){const Ct=xt;if(Ct._bucket==null)throw noDefaultBucket();const kt=new Reference(Ct,Ct._bucket);return $t!=null?refFromPath(kt,$t):kt}else return $t!==void 0?_getChild$1(xt,$t):xt}function ref$1(xt,$t){if($t&&isUrl($t)){if(xt instanceof FirebaseStorageImpl)return refFromURL(xt,$t);throw invalidArgument("To use ref(service, url), the first argument must be a Storage instance.")}else return refFromPath(xt,$t)}function extractBucket(xt,$t){const Ct=$t==null?void 0:$t[CONFIG_STORAGE_BUCKET_KEY];return Ct==null?null:Location.makeFromBucketSpec(Ct,xt)}function connectStorageEmulator$1(xt,$t,Ct,kt={}){xt.host=`${$t}:${Ct}`,xt._protocol="http";const{mockUserToken:Mt}=kt;Mt&&(xt._overrideAuthToken=typeof Mt=="string"?Mt:createMockUserToken(Mt,xt.app.options.projectId))}class FirebaseStorageImpl{constructor($t,Ct,kt,Mt,Ft){this.app=$t,this._authProvider=Ct,this._appCheckProvider=kt,this._url=Mt,this._firebaseVersion=Ft,this._bucket=null,this._host=DEFAULT_HOST,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=DEFAULT_MAX_OPERATION_RETRY_TIME,this._maxUploadRetryTime=DEFAULT_MAX_UPLOAD_RETRY_TIME,this._requests=new Set,Mt!=null?this._bucket=Location.makeFromBucketSpec(Mt,this._host):this._bucket=extractBucket(this._host,this.app.options)}get host(){return this._host}set host($t){this._host=$t,this._url!=null?this._bucket=Location.makeFromBucketSpec(this._url,$t):this._bucket=extractBucket($t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime($t){validateNumber("time",0,Number.POSITIVE_INFINITY,$t),this._maxUploadRetryTime=$t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime($t){validateNumber("time",0,Number.POSITIVE_INFINITY,$t),this._maxOperationRetryTime=$t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const $t=this._authProvider.getImmediate({optional:!0});if($t){const Ct=await $t.getToken();if(Ct!==null)return Ct.accessToken}return null}async _getAppCheckToken(){const $t=this._appCheckProvider.getImmediate({optional:!0});return $t?(await $t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach($t=>$t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference($t){return new Reference(this,$t)}_makeRequest($t,Ct,kt,Mt,Ft=!0){if(this._deleted)return new FailRequest(appDeleted());{const jt=makeRequest($t,this._appId,kt,Mt,Ct,this._firebaseVersion,Ft);return this._requests.add(jt),jt.getPromise().then(()=>this._requests.delete(jt),()=>this._requests.delete(jt)),jt}}async makeRequestWithTokens($t,Ct){const[kt,Mt]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest($t,Ct,kt,Mt).getPromise()}}const name$3="@firebase/storage",version$6="0.12.5";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const STORAGE_TYPE="storage";function uploadBytes(xt,$t,Ct){return xt=getModularInstance(xt),uploadBytes$1(xt,$t,Ct)}function listAll(xt){return xt=getModularInstance(xt),listAll$1(xt)}function getDownloadURL(xt){return xt=getModularInstance(xt),getDownloadURL$1(xt)}function deleteObject(xt){return xt=getModularInstance(xt),deleteObject$1(xt)}function ref$2(xt,$t){return xt=getModularInstance(xt),ref$1(xt,$t)}function getStorage(xt=getApp(),$t){xt=getModularInstance(xt);const kt=_getProvider(xt,STORAGE_TYPE).getImmediate({identifier:$t}),Mt=getDefaultEmulatorHostnameAndPort("storage");return Mt&&connectStorageEmulator(kt,...Mt),kt}function connectStorageEmulator(xt,$t,Ct,kt={}){connectStorageEmulator$1(xt,$t,Ct,kt)}function factory$1(xt,{instanceIdentifier:$t}){const Ct=xt.getProvider("app").getImmediate(),kt=xt.getProvider("auth-internal"),Mt=xt.getProvider("app-check-internal");return new FirebaseStorageImpl(Ct,kt,Mt,$t,SDK_VERSION)}function registerStorage(){_registerComponent(new Component(STORAGE_TYPE,factory$1,"PUBLIC").setMultipleInstances(!0)),registerVersion(name$3,version$6,""),registerVersion(name$3,version$6,"esm2017")}registerStorage();var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Integer,Md5;(function(){var xt;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function $t(hn,cn){function pn(){}pn.prototype=cn.prototype,hn.D=cn.prototype,hn.prototype=new pn,hn.prototype.constructor=hn,hn.C=function(yn,gn,En){for(var bn=Array(arguments.length-2),xn=2;xn<arguments.length;xn++)bn[xn-2]=arguments[xn];return cn.prototype[gn].apply(yn,bn)}}function Ct(){this.blockSize=-1}function kt(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}$t(kt,Ct),kt.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function Mt(hn,cn,pn){pn||(pn=0);var yn=Array(16);if(typeof cn=="string")for(var gn=0;16>gn;++gn)yn[gn]=cn.charCodeAt(pn++)|cn.charCodeAt(pn++)<<8|cn.charCodeAt(pn++)<<16|cn.charCodeAt(pn++)<<24;else for(gn=0;16>gn;++gn)yn[gn]=cn[pn++]|cn[pn++]<<8|cn[pn++]<<16|cn[pn++]<<24;cn=hn.g[0],pn=hn.g[1],gn=hn.g[2];var En=hn.g[3],bn=cn+(En^pn&(gn^En))+yn[0]+3614090360&4294967295;cn=pn+(bn<<7&4294967295|bn>>>25),bn=En+(gn^cn&(pn^gn))+yn[1]+3905402710&4294967295,En=cn+(bn<<12&4294967295|bn>>>20),bn=gn+(pn^En&(cn^pn))+yn[2]+606105819&4294967295,gn=En+(bn<<17&4294967295|bn>>>15),bn=pn+(cn^gn&(En^cn))+yn[3]+3250441966&4294967295,pn=gn+(bn<<22&4294967295|bn>>>10),bn=cn+(En^pn&(gn^En))+yn[4]+4118548399&4294967295,cn=pn+(bn<<7&4294967295|bn>>>25),bn=En+(gn^cn&(pn^gn))+yn[5]+1200080426&4294967295,En=cn+(bn<<12&4294967295|bn>>>20),bn=gn+(pn^En&(cn^pn))+yn[6]+2821735955&4294967295,gn=En+(bn<<17&4294967295|bn>>>15),bn=pn+(cn^gn&(En^cn))+yn[7]+4249261313&4294967295,pn=gn+(bn<<22&4294967295|bn>>>10),bn=cn+(En^pn&(gn^En))+yn[8]+1770035416&4294967295,cn=pn+(bn<<7&4294967295|bn>>>25),bn=En+(gn^cn&(pn^gn))+yn[9]+2336552879&4294967295,En=cn+(bn<<12&4294967295|bn>>>20),bn=gn+(pn^En&(cn^pn))+yn[10]+4294925233&4294967295,gn=En+(bn<<17&4294967295|bn>>>15),bn=pn+(cn^gn&(En^cn))+yn[11]+2304563134&4294967295,pn=gn+(bn<<22&4294967295|bn>>>10),bn=cn+(En^pn&(gn^En))+yn[12]+1804603682&4294967295,cn=pn+(bn<<7&4294967295|bn>>>25),bn=En+(gn^cn&(pn^gn))+yn[13]+4254626195&4294967295,En=cn+(bn<<12&4294967295|bn>>>20),bn=gn+(pn^En&(cn^pn))+yn[14]+2792965006&4294967295,gn=En+(bn<<17&4294967295|bn>>>15),bn=pn+(cn^gn&(En^cn))+yn[15]+1236535329&4294967295,pn=gn+(bn<<22&4294967295|bn>>>10),bn=cn+(gn^En&(pn^gn))+yn[1]+4129170786&4294967295,cn=pn+(bn<<5&4294967295|bn>>>27),bn=En+(pn^gn&(cn^pn))+yn[6]+3225465664&4294967295,En=cn+(bn<<9&4294967295|bn>>>23),bn=gn+(cn^pn&(En^cn))+yn[11]+643717713&4294967295,gn=En+(bn<<14&4294967295|bn>>>18),bn=pn+(En^cn&(gn^En))+yn[0]+3921069994&4294967295,pn=gn+(bn<<20&4294967295|bn>>>12),bn=cn+(gn^En&(pn^gn))+yn[5]+3593408605&4294967295,cn=pn+(bn<<5&4294967295|bn>>>27),bn=En+(pn^gn&(cn^pn))+yn[10]+38016083&4294967295,En=cn+(bn<<9&4294967295|bn>>>23),bn=gn+(cn^pn&(En^cn))+yn[15]+3634488961&4294967295,gn=En+(bn<<14&4294967295|bn>>>18),bn=pn+(En^cn&(gn^En))+yn[4]+3889429448&4294967295,pn=gn+(bn<<20&4294967295|bn>>>12),bn=cn+(gn^En&(pn^gn))+yn[9]+568446438&4294967295,cn=pn+(bn<<5&4294967295|bn>>>27),bn=En+(pn^gn&(cn^pn))+yn[14]+3275163606&4294967295,En=cn+(bn<<9&4294967295|bn>>>23),bn=gn+(cn^pn&(En^cn))+yn[3]+4107603335&4294967295,gn=En+(bn<<14&4294967295|bn>>>18),bn=pn+(En^cn&(gn^En))+yn[8]+1163531501&4294967295,pn=gn+(bn<<20&4294967295|bn>>>12),bn=cn+(gn^En&(pn^gn))+yn[13]+2850285829&4294967295,cn=pn+(bn<<5&4294967295|bn>>>27),bn=En+(pn^gn&(cn^pn))+yn[2]+4243563512&4294967295,En=cn+(bn<<9&4294967295|bn>>>23),bn=gn+(cn^pn&(En^cn))+yn[7]+1735328473&4294967295,gn=En+(bn<<14&4294967295|bn>>>18),bn=pn+(En^cn&(gn^En))+yn[12]+2368359562&4294967295,pn=gn+(bn<<20&4294967295|bn>>>12),bn=cn+(pn^gn^En)+yn[5]+4294588738&4294967295,cn=pn+(bn<<4&4294967295|bn>>>28),bn=En+(cn^pn^gn)+yn[8]+2272392833&4294967295,En=cn+(bn<<11&4294967295|bn>>>21),bn=gn+(En^cn^pn)+yn[11]+1839030562&4294967295,gn=En+(bn<<16&4294967295|bn>>>16),bn=pn+(gn^En^cn)+yn[14]+4259657740&4294967295,pn=gn+(bn<<23&4294967295|bn>>>9),bn=cn+(pn^gn^En)+yn[1]+2763975236&4294967295,cn=pn+(bn<<4&4294967295|bn>>>28),bn=En+(cn^pn^gn)+yn[4]+1272893353&4294967295,En=cn+(bn<<11&4294967295|bn>>>21),bn=gn+(En^cn^pn)+yn[7]+4139469664&4294967295,gn=En+(bn<<16&4294967295|bn>>>16),bn=pn+(gn^En^cn)+yn[10]+3200236656&4294967295,pn=gn+(bn<<23&4294967295|bn>>>9),bn=cn+(pn^gn^En)+yn[13]+681279174&4294967295,cn=pn+(bn<<4&4294967295|bn>>>28),bn=En+(cn^pn^gn)+yn[0]+3936430074&4294967295,En=cn+(bn<<11&4294967295|bn>>>21),bn=gn+(En^cn^pn)+yn[3]+3572445317&4294967295,gn=En+(bn<<16&4294967295|bn>>>16),bn=pn+(gn^En^cn)+yn[6]+76029189&4294967295,pn=gn+(bn<<23&4294967295|bn>>>9),bn=cn+(pn^gn^En)+yn[9]+3654602809&4294967295,cn=pn+(bn<<4&4294967295|bn>>>28),bn=En+(cn^pn^gn)+yn[12]+3873151461&4294967295,En=cn+(bn<<11&4294967295|bn>>>21),bn=gn+(En^cn^pn)+yn[15]+530742520&4294967295,gn=En+(bn<<16&4294967295|bn>>>16),bn=pn+(gn^En^cn)+yn[2]+3299628645&4294967295,pn=gn+(bn<<23&4294967295|bn>>>9),bn=cn+(gn^(pn|~En))+yn[0]+4096336452&4294967295,cn=pn+(bn<<6&4294967295|bn>>>26),bn=En+(pn^(cn|~gn))+yn[7]+1126891415&4294967295,En=cn+(bn<<10&4294967295|bn>>>22),bn=gn+(cn^(En|~pn))+yn[14]+2878612391&4294967295,gn=En+(bn<<15&4294967295|bn>>>17),bn=pn+(En^(gn|~cn))+yn[5]+4237533241&4294967295,pn=gn+(bn<<21&4294967295|bn>>>11),bn=cn+(gn^(pn|~En))+yn[12]+1700485571&4294967295,cn=pn+(bn<<6&4294967295|bn>>>26),bn=En+(pn^(cn|~gn))+yn[3]+2399980690&4294967295,En=cn+(bn<<10&4294967295|bn>>>22),bn=gn+(cn^(En|~pn))+yn[10]+4293915773&4294967295,gn=En+(bn<<15&4294967295|bn>>>17),bn=pn+(En^(gn|~cn))+yn[1]+2240044497&4294967295,pn=gn+(bn<<21&4294967295|bn>>>11),bn=cn+(gn^(pn|~En))+yn[8]+1873313359&4294967295,cn=pn+(bn<<6&4294967295|bn>>>26),bn=En+(pn^(cn|~gn))+yn[15]+4264355552&4294967295,En=cn+(bn<<10&4294967295|bn>>>22),bn=gn+(cn^(En|~pn))+yn[6]+2734768916&4294967295,gn=En+(bn<<15&4294967295|bn>>>17),bn=pn+(En^(gn|~cn))+yn[13]+1309151649&4294967295,pn=gn+(bn<<21&4294967295|bn>>>11),bn=cn+(gn^(pn|~En))+yn[4]+4149444226&4294967295,cn=pn+(bn<<6&4294967295|bn>>>26),bn=En+(pn^(cn|~gn))+yn[11]+3174756917&4294967295,En=cn+(bn<<10&4294967295|bn>>>22),bn=gn+(cn^(En|~pn))+yn[2]+718787259&4294967295,gn=En+(bn<<15&4294967295|bn>>>17),bn=pn+(En^(gn|~cn))+yn[9]+3951481745&4294967295,hn.g[0]=hn.g[0]+cn&4294967295,hn.g[1]=hn.g[1]+(gn+(bn<<21&4294967295|bn>>>11))&4294967295,hn.g[2]=hn.g[2]+gn&4294967295,hn.g[3]=hn.g[3]+En&4294967295}kt.prototype.u=function(hn,cn){cn===void 0&&(cn=hn.length);for(var pn=cn-this.blockSize,yn=this.B,gn=this.h,En=0;En<cn;){if(gn==0)for(;En<=pn;)Mt(this,hn,En),En+=this.blockSize;if(typeof hn=="string"){for(;En<cn;)if(yn[gn++]=hn.charCodeAt(En++),gn==this.blockSize){Mt(this,yn),gn=0;break}}else for(;En<cn;)if(yn[gn++]=hn[En++],gn==this.blockSize){Mt(this,yn),gn=0;break}}this.h=gn,this.o+=cn},kt.prototype.v=function(){var hn=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);hn[0]=128;for(var cn=1;cn<hn.length-8;++cn)hn[cn]=0;var pn=8*this.o;for(cn=hn.length-8;cn<hn.length;++cn)hn[cn]=pn&255,pn/=256;for(this.u(hn),hn=Array(16),cn=pn=0;4>cn;++cn)for(var yn=0;32>yn;yn+=8)hn[pn++]=this.g[cn]>>>yn&255;return hn};function Ft(hn,cn){var pn=Bt;return Object.prototype.hasOwnProperty.call(pn,hn)?pn[hn]:pn[hn]=cn(hn)}function jt(hn,cn){this.h=cn;for(var pn=[],yn=!0,gn=hn.length-1;0<=gn;gn--){var En=hn[gn]|0;yn&&En==cn||(pn[gn]=En,yn=!1)}this.g=pn}var Bt={};function Vt(hn){return-128<=hn&&128>hn?Ft(hn,function(cn){return new jt([cn|0],0>cn?-1:0)}):new jt([hn|0],0>hn?-1:0)}function zt(hn){if(isNaN(hn)||!isFinite(hn))return Gt;if(0>hn)return Xt(zt(-hn));for(var cn=[],pn=1,yn=0;hn>=pn;yn++)cn[yn]=hn/pn|0,pn*=4294967296;return new jt(cn,0)}function Ht(hn,cn){if(hn.length==0)throw Error("number format error: empty string");if(cn=cn||10,2>cn||36<cn)throw Error("radix out of range: "+cn);if(hn.charAt(0)=="-")return Xt(Ht(hn.substring(1),cn));if(0<=hn.indexOf("-"))throw Error('number format error: interior "-" character');for(var pn=zt(Math.pow(cn,8)),yn=Gt,gn=0;gn<hn.length;gn+=8){var En=Math.min(8,hn.length-gn),bn=parseInt(hn.substring(gn,gn+En),cn);8>En?(En=zt(Math.pow(cn,En)),yn=yn.j(En).add(zt(bn))):(yn=yn.j(pn),yn=yn.add(zt(bn)))}return yn}var Gt=Vt(0),qt=Vt(1),Wt=Vt(16777216);xt=jt.prototype,xt.m=function(){if(Kt(this))return-Xt(this).m();for(var hn=0,cn=1,pn=0;pn<this.g.length;pn++){var yn=this.i(pn);hn+=(0<=yn?yn:4294967296+yn)*cn,cn*=4294967296}return hn},xt.toString=function(hn){if(hn=hn||10,2>hn||36<hn)throw Error("radix out of range: "+hn);if(Yt(this))return"0";if(Kt(this))return"-"+Xt(this).toString(hn);for(var cn=zt(Math.pow(hn,6)),pn=this,yn="";;){var gn=sn(pn,cn).g;pn=Qt(pn,gn.j(cn));var En=((0<pn.g.length?pn.g[0]:pn.h)>>>0).toString(hn);if(pn=gn,Yt(pn))return En+yn;for(;6>En.length;)En="0"+En;yn=En+yn}},xt.i=function(hn){return 0>hn?0:hn<this.g.length?this.g[hn]:this.h};function Yt(hn){if(hn.h!=0)return!1;for(var cn=0;cn<hn.g.length;cn++)if(hn.g[cn]!=0)return!1;return!0}function Kt(hn){return hn.h==-1}xt.l=function(hn){return hn=Qt(this,hn),Kt(hn)?-1:Yt(hn)?0:1};function Xt(hn){for(var cn=hn.g.length,pn=[],yn=0;yn<cn;yn++)pn[yn]=~hn.g[yn];return new jt(pn,~hn.h).add(qt)}xt.abs=function(){return Kt(this)?Xt(this):this},xt.add=function(hn){for(var cn=Math.max(this.g.length,hn.g.length),pn=[],yn=0,gn=0;gn<=cn;gn++){var En=yn+(this.i(gn)&65535)+(hn.i(gn)&65535),bn=(En>>>16)+(this.i(gn)>>>16)+(hn.i(gn)>>>16);yn=bn>>>16,En&=65535,bn&=65535,pn[gn]=bn<<16|En}return new jt(pn,pn[pn.length-1]&-2147483648?-1:0)};function Qt(hn,cn){return hn.add(Xt(cn))}xt.j=function(hn){if(Yt(this)||Yt(hn))return Gt;if(Kt(this))return Kt(hn)?Xt(this).j(Xt(hn)):Xt(Xt(this).j(hn));if(Kt(hn))return Xt(this.j(Xt(hn)));if(0>this.l(Wt)&&0>hn.l(Wt))return zt(this.m()*hn.m());for(var cn=this.g.length+hn.g.length,pn=[],yn=0;yn<2*cn;yn++)pn[yn]=0;for(yn=0;yn<this.g.length;yn++)for(var gn=0;gn<hn.g.length;gn++){var En=this.i(yn)>>>16,bn=this.i(yn)&65535,xn=hn.i(gn)>>>16,Cn=hn.i(gn)&65535;pn[2*yn+2*gn]+=bn*Cn,Jt(pn,2*yn+2*gn),pn[2*yn+2*gn+1]+=En*Cn,Jt(pn,2*yn+2*gn+1),pn[2*yn+2*gn+1]+=bn*xn,Jt(pn,2*yn+2*gn+1),pn[2*yn+2*gn+2]+=En*xn,Jt(pn,2*yn+2*gn+2)}for(yn=0;yn<cn;yn++)pn[yn]=pn[2*yn+1]<<16|pn[2*yn];for(yn=cn;yn<2*cn;yn++)pn[yn]=0;return new jt(pn,0)};function Jt(hn,cn){for(;(hn[cn]&65535)!=hn[cn];)hn[cn+1]+=hn[cn]>>>16,hn[cn]&=65535,cn++}function Zt(hn,cn){this.g=hn,this.h=cn}function sn(hn,cn){if(Yt(cn))throw Error("division by zero");if(Yt(hn))return new Zt(Gt,Gt);if(Kt(hn))return cn=sn(Xt(hn),cn),new Zt(Xt(cn.g),Xt(cn.h));if(Kt(cn))return cn=sn(hn,Xt(cn)),new Zt(Xt(cn.g),cn.h);if(30<hn.g.length){if(Kt(hn)||Kt(cn))throw Error("slowDivide_ only works with positive integers.");for(var pn=qt,yn=cn;0>=yn.l(hn);)pn=ln(pn),yn=ln(yn);var gn=dn(pn,1),En=dn(yn,1);for(yn=dn(yn,2),pn=dn(pn,2);!Yt(yn);){var bn=En.add(yn);0>=bn.l(hn)&&(gn=gn.add(pn),En=bn),yn=dn(yn,1),pn=dn(pn,1)}return cn=Qt(hn,gn.j(cn)),new Zt(gn,cn)}for(gn=Gt;0<=hn.l(cn);){for(pn=Math.max(1,Math.floor(hn.m()/cn.m())),yn=Math.ceil(Math.log(pn)/Math.LN2),yn=48>=yn?1:Math.pow(2,yn-48),En=zt(pn),bn=En.j(cn);Kt(bn)||0<bn.l(hn);)pn-=yn,En=zt(pn),bn=En.j(cn);Yt(En)&&(En=qt),gn=gn.add(En),hn=Qt(hn,bn)}return new Zt(gn,hn)}xt.A=function(hn){return sn(this,hn).h},xt.and=function(hn){for(var cn=Math.max(this.g.length,hn.g.length),pn=[],yn=0;yn<cn;yn++)pn[yn]=this.i(yn)&hn.i(yn);return new jt(pn,this.h&hn.h)},xt.or=function(hn){for(var cn=Math.max(this.g.length,hn.g.length),pn=[],yn=0;yn<cn;yn++)pn[yn]=this.i(yn)|hn.i(yn);return new jt(pn,this.h|hn.h)},xt.xor=function(hn){for(var cn=Math.max(this.g.length,hn.g.length),pn=[],yn=0;yn<cn;yn++)pn[yn]=this.i(yn)^hn.i(yn);return new jt(pn,this.h^hn.h)};function ln(hn){for(var cn=hn.g.length+1,pn=[],yn=0;yn<cn;yn++)pn[yn]=hn.i(yn)<<1|hn.i(yn-1)>>>31;return new jt(pn,hn.h)}function dn(hn,cn){var pn=cn>>5;cn%=32;for(var yn=hn.g.length-pn,gn=[],En=0;En<yn;En++)gn[En]=0<cn?hn.i(En+pn)>>>cn|hn.i(En+pn+1)<<32-cn:hn.i(En+pn);return new jt(gn,hn.h)}kt.prototype.digest=kt.prototype.v,kt.prototype.reset=kt.prototype.s,kt.prototype.update=kt.prototype.u,Md5=kt,jt.prototype.add=jt.prototype.add,jt.prototype.multiply=jt.prototype.j,jt.prototype.modulo=jt.prototype.A,jt.prototype.compare=jt.prototype.l,jt.prototype.toNumber=jt.prototype.m,jt.prototype.toString=jt.prototype.toString,jt.prototype.getBits=jt.prototype.i,jt.fromNumber=zt,jt.fromString=Ht,Integer=jt}).apply(typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{});var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var XhrIo,FetchXmlHttpFactory,WebChannel,EventType,ErrorCode,Stat,Event$1,getStatEventTarget,createWebChannelTransport;(function(){var xt,$t=typeof Object.defineProperties=="function"?Object.defineProperty:function(mn,In,On){return mn==Array.prototype||mn==Object.prototype||(mn[In]=On.value),mn};function Ct(mn){mn=[typeof globalThis=="object"&&globalThis,mn,typeof window=="object"&&window,typeof self=="object"&&self,typeof commonjsGlobal=="object"&&commonjsGlobal];for(var In=0;In<mn.length;++In){var On=mn[In];if(On&&On.Math==Math)return On}throw Error("Cannot find global object")}var kt=Ct(this);function Mt(mn,In){if(In)e:{var On=kt;mn=mn.split(".");for(var Gn=0;Gn<mn.length-1;Gn++){var Cr=mn[Gn];if(!(Cr in On))break e;On=On[Cr]}mn=mn[mn.length-1],Gn=On[mn],In=In(Gn),In!=Gn&&In!=null&&$t(On,mn,{configurable:!0,writable:!0,value:In})}}function Ft(mn,In){mn instanceof String&&(mn+="");var On=0,Gn=!1,Cr={next:function(){if(!Gn&&On<mn.length){var Br=On++;return{value:In(Br,mn[Br]),done:!1}}return Gn=!0,{done:!0,value:void 0}}};return Cr[Symbol.iterator]=function(){return Cr},Cr}Mt("Array.prototype.values",function(mn){return mn||function(){return Ft(this,function(In,On){return On})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var jt=jt||{},Bt=this||self;function Vt(mn){var In=typeof mn;return In=In!="object"?In:mn?Array.isArray(mn)?"array":In:"null",In=="array"||In=="object"&&typeof mn.length=="number"}function zt(mn){var In=typeof mn;return In=="object"&&mn!=null||In=="function"}function Ht(mn,In,On){return mn.call.apply(mn.bind,arguments)}function Gt(mn,In,On){if(!mn)throw Error();if(2<arguments.length){var Gn=Array.prototype.slice.call(arguments,2);return function(){var Cr=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Cr,Gn),mn.apply(In,Cr)}}return function(){return mn.apply(In,arguments)}}function qt(mn,In,On){return qt=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ht:Gt,qt.apply(null,arguments)}function Wt(mn,In){var On=Array.prototype.slice.call(arguments,1);return function(){var Gn=On.slice();return Gn.push.apply(Gn,arguments),mn.apply(this,Gn)}}function Yt(mn,In){function On(){}On.prototype=In.prototype,mn.aa=In.prototype,mn.prototype=new On,mn.prototype.constructor=mn,mn.Qb=function(Gn,Cr,Br){for(var rs=Array(arguments.length-2),Ms=2;Ms<arguments.length;Ms++)rs[Ms-2]=arguments[Ms];return In.prototype[Cr].apply(Gn,rs)}}function Kt(mn){const In=mn.length;if(0<In){const On=Array(In);for(let Gn=0;Gn<In;Gn++)On[Gn]=mn[Gn];return On}return[]}function Xt(mn,In){for(let On=1;On<arguments.length;On++){const Gn=arguments[On];if(Vt(Gn)){const Cr=mn.length||0,Br=Gn.length||0;mn.length=Cr+Br;for(let rs=0;rs<Br;rs++)mn[Cr+rs]=Gn[rs]}else mn.push(Gn)}}class Qt{constructor(In,On){this.i=In,this.j=On,this.h=0,this.g=null}get(){let In;return 0<this.h?(this.h--,In=this.g,this.g=In.next,In.next=null):In=this.i(),In}}function Jt(mn){return/^[\s\xa0]*$/.test(mn)}function Zt(){var mn=Bt.navigator;return mn&&(mn=mn.userAgent)?mn:""}function sn(mn){return sn[" "](mn),mn}sn[" "]=function(){};var ln=Zt().indexOf("Gecko")!=-1&&!(Zt().toLowerCase().indexOf("webkit")!=-1&&Zt().indexOf("Edge")==-1)&&!(Zt().indexOf("Trident")!=-1||Zt().indexOf("MSIE")!=-1)&&Zt().indexOf("Edge")==-1;function dn(mn,In,On){for(const Gn in mn)In.call(On,mn[Gn],Gn,mn)}function hn(mn,In){for(const On in mn)In.call(void 0,mn[On],On,mn)}function cn(mn){const In={};for(const On in mn)In[On]=mn[On];return In}const pn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function yn(mn,In){let On,Gn;for(let Cr=1;Cr<arguments.length;Cr++){Gn=arguments[Cr];for(On in Gn)mn[On]=Gn[On];for(let Br=0;Br<pn.length;Br++)On=pn[Br],Object.prototype.hasOwnProperty.call(Gn,On)&&(mn[On]=Gn[On])}}function gn(mn){var In=1;mn=mn.split(":");const On=[];for(;0<In&&mn.length;)On.push(mn.shift()),In--;return mn.length&&On.push(mn.join(":")),On}function En(mn){Bt.setTimeout(()=>{throw mn},0)}function bn(){var mn=Dn;let In=null;return mn.g&&(In=mn.g,mn.g=mn.g.next,mn.g||(mn.h=null),In.next=null),In}class xn{constructor(){this.h=this.g=null}add(In,On){const Gn=Cn.get();Gn.set(In,On),this.h?this.h.next=Gn:this.g=Gn,this.h=Gn}}var Cn=new Qt(()=>new $n,mn=>mn.reset());class $n{constructor(){this.next=this.g=this.h=null}set(In,On){this.h=In,this.g=On,this.next=null}reset(){this.next=this.g=this.h=null}}let wn,Rn=!1,Dn=new xn,An=()=>{const mn=Bt.Promise.resolve(void 0);wn=()=>{mn.then(Sn)}};var Sn=()=>{for(var mn;mn=bn();){try{mn.h.call(mn.g)}catch(On){En(On)}var In=Cn;In.j(mn),100>In.h&&(In.h++,mn.next=In.g,In.g=mn)}Rn=!1};function vn(){this.s=this.s,this.C=this.C}vn.prototype.s=!1,vn.prototype.ma=function(){this.s||(this.s=!0,this.N())},vn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _n(mn,In){this.type=mn,this.g=this.target=In,this.defaultPrevented=!1}_n.prototype.h=function(){this.defaultPrevented=!0};var Tn=function(){if(!Bt.addEventListener||!Object.defineProperty)return!1;var mn=!1,In=Object.defineProperty({},"passive",{get:function(){mn=!0}});try{const On=()=>{};Bt.addEventListener("test",On,In),Bt.removeEventListener("test",On,In)}catch{}return mn}();function Pn(mn,In){if(_n.call(this,mn?mn.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,mn){var On=this.type=mn.type,Gn=mn.changedTouches&&mn.changedTouches.length?mn.changedTouches[0]:null;if(this.target=mn.target||mn.srcElement,this.g=In,In=mn.relatedTarget){if(ln){e:{try{sn(In.nodeName);var Cr=!0;break e}catch{}Cr=!1}Cr||(In=null)}}else On=="mouseover"?In=mn.fromElement:On=="mouseout"&&(In=mn.toElement);this.relatedTarget=In,Gn?(this.clientX=Gn.clientX!==void 0?Gn.clientX:Gn.pageX,this.clientY=Gn.clientY!==void 0?Gn.clientY:Gn.pageY,this.screenX=Gn.screenX||0,this.screenY=Gn.screenY||0):(this.clientX=mn.clientX!==void 0?mn.clientX:mn.pageX,this.clientY=mn.clientY!==void 0?mn.clientY:mn.pageY,this.screenX=mn.screenX||0,this.screenY=mn.screenY||0),this.button=mn.button,this.key=mn.key||"",this.ctrlKey=mn.ctrlKey,this.altKey=mn.altKey,this.shiftKey=mn.shiftKey,this.metaKey=mn.metaKey,this.pointerId=mn.pointerId||0,this.pointerType=typeof mn.pointerType=="string"?mn.pointerType:Ln[mn.pointerType]||"",this.state=mn.state,this.i=mn,mn.defaultPrevented&&Pn.aa.h.call(this)}}Yt(Pn,_n);var Ln={2:"touch",3:"pen",4:"mouse"};Pn.prototype.h=function(){Pn.aa.h.call(this);var mn=this.i;mn.preventDefault?mn.preventDefault():mn.returnValue=!1};var Vn="closure_listenable_"+(1e6*Math.random()|0),Un=0;function Wn(mn,In,On,Gn,Cr){this.listener=mn,this.proxy=null,this.src=In,this.type=On,this.capture=!!Gn,this.ha=Cr,this.key=++Un,this.da=this.fa=!1}function rr(mn){mn.da=!0,mn.listener=null,mn.proxy=null,mn.src=null,mn.ha=null}function ar(mn){this.src=mn,this.g={},this.h=0}ar.prototype.add=function(mn,In,On,Gn,Cr){var Br=mn.toString();mn=this.g[Br],mn||(mn=this.g[Br]=[],this.h++);var rs=mr(mn,In,Gn,Cr);return-1<rs?(In=mn[rs],On||(In.fa=!1)):(In=new Wn(In,this.src,Br,!!Gn,Cr),In.fa=On,mn.push(In)),In};function nr(mn,In){var On=In.type;if(On in mn.g){var Gn=mn.g[On],Cr=Array.prototype.indexOf.call(Gn,In,void 0),Br;(Br=0<=Cr)&&Array.prototype.splice.call(Gn,Cr,1),Br&&(rr(In),mn.g[On].length==0&&(delete mn.g[On],mn.h--))}}function mr(mn,In,On,Gn){for(var Cr=0;Cr<mn.length;++Cr){var Br=mn[Cr];if(!Br.da&&Br.listener==In&&Br.capture==!!On&&Br.ha==Gn)return Cr}return-1}var kn="closure_lm_"+(1e6*Math.random()|0),Fn={};function Hn(mn,In,On,Gn,Cr){if(Array.isArray(In)){for(var Br=0;Br<In.length;Br++)Hn(mn,In[Br],On,Gn,Cr);return null}return On=Mr(On),mn&&mn[Vn]?mn.K(In,On,zt(Gn)?!!Gn.capture:!!Gn,Cr):Bn(mn,In,On,!1,Gn,Cr)}function Bn(mn,In,On,Gn,Cr,Br){if(!In)throw Error("Invalid event type");var rs=zt(Cr)?!!Cr.capture:!!Cr,Ms=Qn(mn);if(Ms||(mn[kn]=Ms=new ar(mn)),On=Ms.add(In,On,Gn,rs,Br),On.proxy)return On;if(Gn=jn(),On.proxy=Gn,Gn.src=mn,Gn.listener=On,mn.addEventListener)Tn||(Cr=rs),Cr===void 0&&(Cr=!1),mn.addEventListener(In.toString(),Gn,Cr);else if(mn.attachEvent)mn.attachEvent(Fr(In.toString()),Gn);else if(mn.addListener&&mn.removeListener)mn.addListener(Gn);else throw Error("addEventListener and attachEvent are unavailable.");return On}function jn(){function mn(On){return In.call(mn.src,mn.listener,On)}const In=Rr;return mn}function sr(mn,In,On,Gn,Cr){if(Array.isArray(In))for(var Br=0;Br<In.length;Br++)sr(mn,In[Br],On,Gn,Cr);else Gn=zt(Gn)?!!Gn.capture:!!Gn,On=Mr(On),mn&&mn[Vn]?(mn=mn.i,In=String(In).toString(),In in mn.g&&(Br=mn.g[In],On=mr(Br,On,Gn,Cr),-1<On&&(rr(Br[On]),Array.prototype.splice.call(Br,On,1),Br.length==0&&(delete mn.g[In],mn.h--)))):mn&&(mn=Qn(mn))&&(In=mn.g[In.toString()],mn=-1,In&&(mn=mr(In,On,Gn,Cr)),(On=-1<mn?In[mn]:null)&&Ar(On))}function Ar(mn){if(typeof mn!="number"&&mn&&!mn.da){var In=mn.src;if(In&&In[Vn])nr(In.i,mn);else{var On=mn.type,Gn=mn.proxy;In.removeEventListener?In.removeEventListener(On,Gn,mn.capture):In.detachEvent?In.detachEvent(Fr(On),Gn):In.addListener&&In.removeListener&&In.removeListener(Gn),(On=Qn(In))?(nr(On,mn),On.h==0&&(On.src=null,In[kn]=null)):rr(mn)}}}function Fr(mn){return mn in Fn?Fn[mn]:Fn[mn]="on"+mn}function Rr(mn,In){if(mn.da)mn=!0;else{In=new Pn(In,this);var On=mn.listener,Gn=mn.ha||mn.src;mn.fa&&Ar(mn),mn=On.call(Gn,In)}return mn}function Qn(mn){return mn=mn[kn],mn instanceof ar?mn:null}var jr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mr(mn){return typeof mn=="function"?mn:(mn[jr]||(mn[jr]=function(In){return mn.handleEvent(In)}),mn[jr])}function pr(){vn.call(this),this.i=new ar(this),this.M=this,this.F=null}Yt(pr,vn),pr.prototype[Vn]=!0,pr.prototype.removeEventListener=function(mn,In,On,Gn){sr(this,mn,In,On,Gn)};function Tr(mn,In){var On,Gn=mn.F;if(Gn)for(On=[];Gn;Gn=Gn.F)On.push(Gn);if(mn=mn.M,Gn=In.type||In,typeof In=="string")In=new _n(In,mn);else if(In instanceof _n)In.target=In.target||mn;else{var Cr=In;In=new _n(Gn,mn),yn(In,Cr)}if(Cr=!0,On)for(var Br=On.length-1;0<=Br;Br--){var rs=In.g=On[Br];Cr=Hr(rs,Gn,!0,In)&&Cr}if(rs=In.g=mn,Cr=Hr(rs,Gn,!0,In)&&Cr,Cr=Hr(rs,Gn,!1,In)&&Cr,On)for(Br=0;Br<On.length;Br++)rs=In.g=On[Br],Cr=Hr(rs,Gn,!1,In)&&Cr}pr.prototype.N=function(){if(pr.aa.N.call(this),this.i){var mn=this.i,In;for(In in mn.g){for(var On=mn.g[In],Gn=0;Gn<On.length;Gn++)rr(On[Gn]);delete mn.g[In],mn.h--}}this.F=null},pr.prototype.K=function(mn,In,On,Gn){return this.i.add(String(mn),In,!1,On,Gn)},pr.prototype.L=function(mn,In,On,Gn){return this.i.add(String(mn),In,!0,On,Gn)};function Hr(mn,In,On,Gn){if(In=mn.i.g[String(In)],!In)return!0;In=In.concat();for(var Cr=!0,Br=0;Br<In.length;++Br){var rs=In[Br];if(rs&&!rs.da&&rs.capture==On){var Ms=rs.listener,uo=rs.ha||rs.src;rs.fa&&nr(mn.i,rs),Cr=Ms.call(uo,Gn)!==!1&&Cr}}return Cr&&!Gn.defaultPrevented}function Xr(mn,In,On){if(typeof mn=="function")On&&(mn=qt(mn,On));else if(mn&&typeof mn.handleEvent=="function")mn=qt(mn.handleEvent,mn);else throw Error("Invalid listener argument");return 2147483647<Number(In)?-1:Bt.setTimeout(mn,In||0)}function Zr(mn){mn.g=Xr(()=>{mn.g=null,mn.i&&(mn.i=!1,Zr(mn))},mn.l);const In=mn.h;mn.h=null,mn.m.apply(null,In)}class ur extends vn{constructor(In,On){super(),this.m=In,this.l=On,this.h=null,this.i=!1,this.g=null}j(In){this.h=arguments,this.g?this.i=!0:Zr(this)}N(){super.N(),this.g&&(Bt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hr(mn){vn.call(this),this.h=mn,this.g={}}Yt(hr,vn);var gr=[];function qr(mn){dn(mn.g,function(In,On){this.g.hasOwnProperty(On)&&Ar(In)},mn),mn.g={}}hr.prototype.N=function(){hr.aa.N.call(this),qr(this)},hr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ds=Bt.JSON.stringify,ms=Bt.JSON.parse,wr=class{stringify(mn){return Bt.JSON.stringify(mn,void 0)}parse(mn){return Bt.JSON.parse(mn,void 0)}};function Wr(){}Wr.prototype.h=null;function ns(mn){return mn.h||(mn.h=mn.i())}function us(){}var ps={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ls(){_n.call(this,"d")}Yt(Ls,_n);function vs(){_n.call(this,"c")}Yt(vs,_n);var Ps={},Fs=null;function zs(){return Fs=Fs||new pr}Ps.La="serverreachability";function Eo(mn){_n.call(this,Ps.La,mn)}Yt(Eo,_n);function js(mn){const In=zs();Tr(In,new Eo(In))}Ps.STAT_EVENT="statevent";function Hs(mn,In){_n.call(this,Ps.STAT_EVENT,mn),this.stat=In}Yt(Hs,_n);function Us(mn){const In=zs();Tr(In,new Hs(In,mn))}Ps.Ma="timingevent";function Ks(mn,In){_n.call(this,Ps.Ma,mn),this.size=In}Yt(Ks,_n);function go(mn,In){if(typeof mn!="function")throw Error("Fn must not be null and must be a function");return Bt.setTimeout(function(){mn()},In)}function vo(){this.g=!0}vo.prototype.xa=function(){this.g=!1};function vr(mn,In,On,Gn,Cr,Br){mn.info(function(){if(mn.g)if(Br)for(var rs="",Ms=Br.split("&"),uo=0;uo<Ms.length;uo++){var Ws=Ms[uo].split("=");if(1<Ws.length){var Is=Ws[0];Ws=Ws[1];var ho=Is.split("_");rs=2<=ho.length&&ho[1]=="type"?rs+(Is+"="+Ws+"&"):rs+(Is+"=redacted&")}}else rs=null;else rs=Br;return"XMLHTTP REQ ("+Gn+") [attempt "+Cr+"]: "+In+`
`+On+`
`+rs})}function lr(mn,In,On,Gn,Cr,Br,rs){mn.info(function(){return"XMLHTTP RESP ("+Gn+") [ attempt "+Cr+"]: "+In+`
`+On+`
`+Br+" "+rs})}function $r(mn,In,On,Gn){mn.info(function(){return"XMLHTTP TEXT ("+In+"): "+zr(mn,On)+(Gn?" "+Gn:"")})}function Gr(mn,In){mn.info(function(){return"TIMEOUT: "+In})}vo.prototype.info=function(){};function zr(mn,In){if(!mn.g)return In;if(!In)return null;try{var On=JSON.parse(In);if(On){for(mn=0;mn<On.length;mn++)if(Array.isArray(On[mn])){var Gn=On[mn];if(!(2>Gn.length)){var Cr=Gn[1];if(Array.isArray(Cr)&&!(1>Cr.length)){var Br=Cr[0];if(Br!="noop"&&Br!="stop"&&Br!="close")for(var rs=1;rs<Cr.length;rs++)Cr[rs]=""}}}}return ds(On)}catch{return In}}var fs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ts={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Bs;function Xs(){}Yt(Xs,Wr),Xs.prototype.g=function(){return new XMLHttpRequest},Xs.prototype.i=function(){return{}},Bs=new Xs;function ro(mn,In,On,Gn){this.j=mn,this.i=In,this.l=On,this.R=Gn||1,this.U=new hr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ys}function Ys(){this.i=null,this.g="",this.h=!1}var co={},To={};function Vs(mn,In,On){mn.L=1,mn.v=eo(cs(In)),mn.m=On,mn.P=!0,fo(mn,null)}function fo(mn,In){mn.F=Date.now(),ko(mn),mn.A=cs(mn.v);var On=mn.A,Gn=mn.R;Array.isArray(Gn)||(Gn=[String(Gn)]),Vl(On.i,"t",Gn),mn.C=0,On=mn.j.J,mn.h=new Ys,mn.g=Xo(mn.j,On?In:null,!mn.m),0<mn.O&&(mn.M=new ur(qt(mn.Y,mn,mn.g),mn.O)),In=mn.U,On=mn.g,Gn=mn.ca;var Cr="readystatechange";Array.isArray(Cr)||(Cr&&(gr[0]=Cr.toString()),Cr=gr);for(var Br=0;Br<Cr.length;Br++){var rs=Hn(On,Cr[Br],Gn||In.handleEvent,!1,In.h||In);if(!rs)break;In.g[rs.key]=rs}In=mn.H?cn(mn.H):{},mn.m?(mn.u||(mn.u="POST"),In["Content-Type"]="application/x-www-form-urlencoded",mn.g.ea(mn.A,mn.u,mn.m,In)):(mn.u="GET",mn.g.ea(mn.A,mn.u,null,In)),js(),vr(mn.i,mn.u,mn.A,mn.l,mn.R,mn.m)}ro.prototype.ca=function(mn){mn=mn.target;const In=this.M;In&&$s(mn)==3?In.j():this.Y(mn)},ro.prototype.Y=function(mn){try{if(mn==this.g)e:{const ho=$s(this.g);var In=this.g.Ba();const po=this.g.Z();if(!(3>ho)&&(ho!=3||this.g&&(this.h.h||this.g.oa()||ys(this.g)))){this.J||ho!=4||In==7||(In==8||0>=po?js(3):js(2)),Co(this);var On=this.g.Z();this.X=On;t:if($o(this)){var Gn=ys(this.g);mn="";var Cr=Gn.length,Br=$s(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Lo(this),Go(this);var rs="";break t}this.h.i=new Bt.TextDecoder}for(In=0;In<Cr;In++)this.h.h=!0,mn+=this.h.i.decode(Gn[In],{stream:!(Br&&In==Cr-1)});Gn.length=0,this.h.g+=mn,this.C=0,rs=this.h.g}else rs=this.g.oa();if(this.o=On==200,lr(this.i,this.u,this.A,this.l,this.R,ho,On),this.o){if(this.T&&!this.K){t:{if(this.g){var Ms,uo=this.g;if((Ms=uo.g?uo.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Jt(Ms)){var Ws=Ms;break t}}Ws=null}if(On=Ws)$r(this.i,this.l,On,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fo(this,On);else{this.o=!1,this.s=3,Us(12),Lo(this),Go(this);break e}}if(this.P){On=!0;let no;for(;!this.J&&this.C<rs.length;)if(no=lo(this,rs),no==To){ho==4&&(this.s=4,Us(14),On=!1),$r(this.i,this.l,null,"[Incomplete Response]");break}else if(no==co){this.s=4,Us(15),$r(this.i,this.l,rs,"[Invalid Chunk]"),On=!1;break}else $r(this.i,this.l,no,null),Fo(this,no);if($o(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ho!=4||rs.length!=0||this.h.h||(this.s=1,Us(16),On=!1),this.o=this.o&&On,!On)$r(this.i,this.l,rs,"[Invalid Chunked Response]"),Lo(this),Go(this);else if(0<rs.length&&!this.W){this.W=!0;var Is=this.j;Is.g==this&&Is.ba&&!Is.M&&(Is.j.info("Great, no buffering proxy detected. Bytes received: "+rs.length),Ro(Is),Is.M=!0,Us(11))}}else $r(this.i,this.l,rs,null),Fo(this,rs);ho==4&&Lo(this),this.o&&!this.J&&(ho==4?Po(this.j,this):(this.o=!1,ko(this)))}else ws(this.g),On==400&&0<rs.indexOf("Unknown SID")?(this.s=3,Us(12)):(this.s=0,Us(13)),Lo(this),Go(this)}}}catch{}finally{}};function $o(mn){return mn.g?mn.u=="GET"&&mn.L!=2&&mn.j.Ca:!1}function lo(mn,In){var On=mn.C,Gn=In.indexOf(`
`,On);return Gn==-1?To:(On=Number(In.substring(On,Gn)),isNaN(On)?co:(Gn+=1,Gn+On>In.length?To:(In=In.slice(Gn,Gn+On),mn.C=Gn+On,In)))}ro.prototype.cancel=function(){this.J=!0,Lo(this)};function ko(mn){mn.S=Date.now()+mn.I,jo(mn,mn.I)}function jo(mn,In){if(mn.B!=null)throw Error("WatchDog timer not null");mn.B=go(qt(mn.ba,mn),In)}function Co(mn){mn.B&&(Bt.clearTimeout(mn.B),mn.B=null)}ro.prototype.ba=function(){this.B=null;const mn=Date.now();0<=mn-this.S?(Gr(this.i,this.A),this.L!=2&&(js(),Us(17)),Lo(this),this.s=2,Go(this)):jo(this,this.S-mn)};function Go(mn){mn.j.G==0||mn.J||Po(mn.j,mn)}function Lo(mn){Co(mn);var In=mn.M;In&&typeof In.ma=="function"&&In.ma(),mn.M=null,qr(mn.U),mn.g&&(In=mn.g,mn.g=null,In.abort(),In.ma())}function Fo(mn,In){try{var On=mn.j;if(On.G!=0&&(On.g==mn||ga(On.h,mn))){if(!mn.K&&ga(On.h,mn)&&On.G==3){try{var Gn=On.Da.g.parse(In)}catch{Gn=null}if(Array.isArray(Gn)&&Gn.length==3){var Cr=Gn;if(Cr[0]==0){e:if(!On.u){if(On.g)if(On.g.F+3e3<mn.F)Io(On),Ds(On);else break e;No(On),Us(18)}}else On.za=Cr[1],0<On.za-On.T&&37500>Cr[2]&&On.F&&On.v==0&&!On.C&&(On.C=go(qt(On.Za,On),6e3));if(1>=Jo(On.h)&&On.ca){try{On.ca()}catch{}On.ca=void 0}}else Yo(On,11)}else if((mn.K||On.g==mn)&&Io(On),!Jt(In))for(Cr=On.Da.g.parse(In),In=0;In<Cr.length;In++){let Ws=Cr[In];if(On.T=Ws[0],Ws=Ws[1],On.G==2)if(Ws[0]=="c"){On.K=Ws[1],On.ia=Ws[2];const Is=Ws[3];Is!=null&&(On.la=Is,On.j.info("VER="+On.la));const ho=Ws[4];ho!=null&&(On.Aa=ho,On.j.info("SVER="+On.Aa));const po=Ws[5];po!=null&&typeof po=="number"&&0<po&&(Gn=1.5*po,On.L=Gn,On.j.info("backChannelRequestTimeoutMs_="+Gn)),Gn=On;const no=mn.g;if(no){const Mo=no.g?no.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Mo){var Br=Gn.h;Br.g||Mo.indexOf("spdy")==-1&&Mo.indexOf("quic")==-1&&Mo.indexOf("h2")==-1||(Br.j=Br.l,Br.g=new Set,Br.h&&(Jn(Br,Br.h),Br.h=null))}if(Gn.D){const mo=no.g?no.g.getResponseHeader("X-HTTP-Session-Id"):null;mo&&(Gn.ya=mo,Os(Gn.I,Gn.D,mo))}}On.G=3,On.l&&On.l.ua(),On.ba&&(On.R=Date.now()-mn.F,On.j.info("Handshake RTT: "+On.R+"ms")),Gn=On;var rs=mn;if(Gn.qa=Vo(Gn,Gn.J?Gn.ia:null,Gn.W),rs.K){xr(Gn.h,rs);var Ms=rs,uo=Gn.L;uo&&(Ms.I=uo),Ms.B&&(Co(Ms),ko(Ms)),Gn.g=rs}else Ao(Gn);0<On.i.length&&Qs(On)}else Ws[0]!="stop"&&Ws[0]!="close"||Yo(On,7);else On.G==3&&(Ws[0]=="stop"||Ws[0]=="close"?Ws[0]=="stop"?Yo(On,7):Ns(On):Ws[0]!="noop"&&On.l&&On.l.ta(Ws),On.v=0)}}js(4)}catch{}}var Wo=class{constructor(mn,In){this.g=mn,this.map=In}};function Ko(mn){this.l=mn||10,Bt.PerformanceNavigationTiming?(mn=Bt.performance.getEntriesByType("navigation"),mn=0<mn.length&&(mn[0].nextHopProtocol=="hq"||mn[0].nextHopProtocol=="h2")):mn=!!(Bt.chrome&&Bt.chrome.loadTimes&&Bt.chrome.loadTimes()&&Bt.chrome.loadTimes().wasFetchedViaSpdy),this.j=mn?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Bo(mn){return mn.h?!0:mn.g?mn.g.size>=mn.j:!1}function Jo(mn){return mn.h?1:mn.g?mn.g.size:0}function ga(mn,In){return mn.h?mn.h==In:mn.g?mn.g.has(In):!1}function Jn(mn,In){mn.g?mn.g.add(In):mn.h=In}function xr(mn,In){mn.h&&mn.h==In?mn.h=null:mn.g&&mn.g.has(In)&&mn.g.delete(In)}Ko.prototype.cancel=function(){if(this.i=dr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const mn of this.g.values())mn.cancel();this.g.clear()}};function dr(mn){if(mn.h!=null)return mn.i.concat(mn.h.D);if(mn.g!=null&&mn.g.size!==0){let In=mn.i;for(const On of mn.g.values())In=In.concat(On.D);return In}return Kt(mn.i)}function kr(mn){if(mn.V&&typeof mn.V=="function")return mn.V();if(typeof Map<"u"&&mn instanceof Map||typeof Set<"u"&&mn instanceof Set)return Array.from(mn.values());if(typeof mn=="string")return mn.split("");if(Vt(mn)){for(var In=[],On=mn.length,Gn=0;Gn<On;Gn++)In.push(mn[Gn]);return In}In=[],On=0;for(Gn in mn)In[On++]=mn[Gn];return In}function Lr(mn){if(mn.na&&typeof mn.na=="function")return mn.na();if(!mn.V||typeof mn.V!="function"){if(typeof Map<"u"&&mn instanceof Map)return Array.from(mn.keys());if(!(typeof Set<"u"&&mn instanceof Set)){if(Vt(mn)||typeof mn=="string"){var In=[];mn=mn.length;for(var On=0;On<mn;On++)In.push(On);return In}In=[],On=0;for(const Gn in mn)In[On++]=Gn;return In}}}function Pr(mn,In){if(mn.forEach&&typeof mn.forEach=="function")mn.forEach(In,void 0);else if(Vt(mn)||typeof mn=="string")Array.prototype.forEach.call(mn,In,void 0);else for(var On=Lr(mn),Gn=kr(mn),Cr=Gn.length,Br=0;Br<Cr;Br++)In.call(void 0,Gn[Br],On&&On[Br],mn)}var Jr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ss(mn,In){if(mn){mn=mn.split("&");for(var On=0;On<mn.length;On++){var Gn=mn[On].indexOf("="),Cr=null;if(0<=Gn){var Br=mn[On].substring(0,Gn);Cr=mn[On].substring(Gn+1)}else Br=mn[On];In(Br,Cr?decodeURIComponent(Cr.replace(/\+/g," ")):"")}}}function ls(mn){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,mn instanceof ls){this.h=mn.h,hs(this,mn.j),this.o=mn.o,this.g=mn.g,As(this,mn.s),this.l=mn.l;var In=mn.i,On=new Zo;On.i=In.i,In.g&&(On.g=new Map(In.g),On.h=In.h),qs(this,On),this.m=mn.m}else mn&&(In=String(mn).match(Jr))?(this.h=!1,hs(this,In[1]||"",!0),this.o=xo(In[2]||""),this.g=xo(In[3]||"",!0),As(this,In[4]),this.l=xo(In[5]||"",!0),qs(this,In[6]||"",!0),this.m=xo(In[7]||"")):(this.h=!1,this.i=new Zo(null,this.h))}ls.prototype.toString=function(){var mn=[],In=this.j;In&&mn.push(So(In,$a,!0),":");var On=this.g;return(On||In=="file")&&(mn.push("//"),(In=this.o)&&mn.push(So(In,$a,!0),"@"),mn.push(encodeURIComponent(String(On)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),On=this.s,On!=null&&mn.push(":",String(On))),(On=this.l)&&(this.g&&On.charAt(0)!="/"&&mn.push("/"),mn.push(So(On,On.charAt(0)=="/"?yl:Sl,!0))),(On=this.i.toString())&&mn.push("?",On),(On=this.m)&&mn.push("#",So(On,Bl)),mn.join("")};function cs(mn){return new ls(mn)}function hs(mn,In,On){mn.j=On?xo(In,!0):In,mn.j&&(mn.j=mn.j.replace(/:$/,""))}function As(mn,In){if(In){if(In=Number(In),isNaN(In)||0>In)throw Error("Bad port number "+In);mn.s=In}else mn.s=null}function qs(mn,In,On){In instanceof Zo?(mn.i=In,Il(mn.i,mn.h)):(On||(In=So(In,Rl)),mn.i=new Zo(In,mn.h))}function Os(mn,In,On){mn.i.set(In,On)}function eo(mn){return Os(mn,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),mn}function xo(mn,In){return mn?In?decodeURI(mn.replace(/%25/g,"%2525")):decodeURIComponent(mn):""}function So(mn,In,On){return typeof mn=="string"?(mn=encodeURI(mn).replace(In,Uo),On&&(mn=mn.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),mn):null}function Uo(mn){return mn=mn.charCodeAt(0),"%"+(mn>>4&15).toString(16)+(mn&15).toString(16)}var $a=/[#\/\?@]/g,Sl=/[#\?:]/g,yl=/[#\?]/g,Rl=/[#\?@]/g,Bl=/#/g;function Zo(mn,In){this.h=this.g=null,this.i=mn||null,this.j=!!In}function qo(mn){mn.g||(mn.g=new Map,mn.h=0,mn.i&&ss(mn.i,function(In,On){mn.add(decodeURIComponent(In.replace(/\+/g," ")),On)}))}xt=Zo.prototype,xt.add=function(mn,In){qo(this),this.i=null,mn=El(this,mn);var On=this.g.get(mn);return On||this.g.set(mn,On=[]),On.push(In),this.h+=1,this};function ba(mn,In){qo(mn),In=El(mn,In),mn.g.has(In)&&(mn.i=null,mn.h-=mn.g.get(In).length,mn.g.delete(In))}function Dl(mn,In){return qo(mn),In=El(mn,In),mn.g.has(In)}xt.forEach=function(mn,In){qo(this),this.g.forEach(function(On,Gn){On.forEach(function(Cr){mn.call(In,Cr,Gn,this)},this)},this)},xt.na=function(){qo(this);const mn=Array.from(this.g.values()),In=Array.from(this.g.keys()),On=[];for(let Gn=0;Gn<In.length;Gn++){const Cr=mn[Gn];for(let Br=0;Br<Cr.length;Br++)On.push(In[Gn])}return On},xt.V=function(mn){qo(this);let In=[];if(typeof mn=="string")Dl(this,mn)&&(In=In.concat(this.g.get(El(this,mn))));else{mn=Array.from(this.g.values());for(let On=0;On<mn.length;On++)In=In.concat(mn[On])}return In},xt.set=function(mn,In){return qo(this),this.i=null,mn=El(this,mn),Dl(this,mn)&&(this.h-=this.g.get(mn).length),this.g.set(mn,[In]),this.h+=1,this},xt.get=function(mn,In){return mn?(mn=this.V(mn),0<mn.length?String(mn[0]):In):In};function Vl(mn,In,On){ba(mn,In),0<On.length&&(mn.i=null,mn.g.set(El(mn,In),Kt(On)),mn.h+=On.length)}xt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const mn=[],In=Array.from(this.g.keys());for(var On=0;On<In.length;On++){var Gn=In[On];const Br=encodeURIComponent(String(Gn)),rs=this.V(Gn);for(Gn=0;Gn<rs.length;Gn++){var Cr=Br;rs[Gn]!==""&&(Cr+="="+encodeURIComponent(String(rs[Gn]))),mn.push(Cr)}}return this.i=mn.join("&")};function El(mn,In){return In=String(In),mn.j&&(In=In.toLowerCase()),In}function Il(mn,In){In&&!mn.j&&(qo(mn),mn.i=null,mn.g.forEach(function(On,Gn){var Cr=Gn.toLowerCase();Gn!=Cr&&(ba(this,Gn),Vl(this,Cr,On))},mn)),mn.j=In}function Kl(mn,In){const On=new vo;if(Bt.Image){const Gn=new Image;Gn.onload=Wt(Qo,On,"TestLoadImage: loaded",!0,In,Gn),Gn.onerror=Wt(Qo,On,"TestLoadImage: error",!1,In,Gn),Gn.onabort=Wt(Qo,On,"TestLoadImage: abort",!1,In,Gn),Gn.ontimeout=Wt(Qo,On,"TestLoadImage: timeout",!1,In,Gn),Bt.setTimeout(function(){Gn.ontimeout&&Gn.ontimeout()},1e4),Gn.src=mn}else In(!1)}function Al(mn,In){const On=new vo,Gn=new AbortController,Cr=setTimeout(()=>{Gn.abort(),Qo(On,"TestPingServer: timeout",!1,In)},1e4);fetch(mn,{signal:Gn.signal}).then(Br=>{clearTimeout(Cr),Br.ok?Qo(On,"TestPingServer: ok",!0,In):Qo(On,"TestPingServer: server error",!1,In)}).catch(()=>{clearTimeout(Cr),Qo(On,"TestPingServer: error",!1,In)})}function Qo(mn,In,On,Gn,Cr){try{Cr&&(Cr.onload=null,Cr.onerror=null,Cr.onabort=null,Cr.ontimeout=null),Gn(On)}catch{}}function Nn(){this.g=new wr}function qn(mn,In,On){const Gn=On||"";try{Pr(mn,function(Cr,Br){let rs=Cr;zt(Cr)&&(rs=ds(Cr)),In.push(Gn+Br+"="+encodeURIComponent(rs))})}catch(Cr){throw In.push(Gn+"type="+encodeURIComponent("_badmap")),Cr}}function fr(mn){this.l=mn.Ub||null,this.j=mn.eb||!1}Yt(fr,Wr),fr.prototype.g=function(){return new yr(this.l,this.j)},fr.prototype.i=function(mn){return function(){return mn}}({});function yr(mn,In){pr.call(this),this.D=mn,this.o=In,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}Yt(yr,pr),xt=yr.prototype,xt.open=function(mn,In){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=mn,this.A=In,this.readyState=1,Dr(this)},xt.send=function(mn){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const In={headers:this.u,method:this.B,credentials:this.m,cache:void 0};mn&&(In.body=mn),(this.D||Bt).fetch(new Request(this.A,In)).then(this.Sa.bind(this),this.ga.bind(this))},xt.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Sr(this)),this.readyState=0},xt.Sa=function(mn){if(this.g&&(this.l=mn,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=mn.headers,this.readyState=2,Dr(this)),this.g&&(this.readyState=3,Dr(this),this.g)))if(this.responseType==="arraybuffer")mn.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof Bt.ReadableStream<"u"&&"body"in mn){if(this.j=mn.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Er(this)}else mn.text().then(this.Ra.bind(this),this.ga.bind(this))};function Er(mn){mn.j.read().then(mn.Pa.bind(mn)).catch(mn.ga.bind(mn))}xt.Pa=function(mn){if(this.g){if(this.o&&mn.value)this.response.push(mn.value);else if(!this.o){var In=mn.value?mn.value:new Uint8Array(0);(In=this.v.decode(In,{stream:!mn.done}))&&(this.response=this.responseText+=In)}mn.done?Sr(this):Dr(this),this.readyState==3&&Er(this)}},xt.Ra=function(mn){this.g&&(this.response=this.responseText=mn,Sr(this))},xt.Qa=function(mn){this.g&&(this.response=mn,Sr(this))},xt.ga=function(){this.g&&Sr(this)};function Sr(mn){mn.readyState=4,mn.l=null,mn.j=null,mn.v=null,Dr(mn)}xt.setRequestHeader=function(mn,In){this.u.append(mn,In)},xt.getResponseHeader=function(mn){return this.h&&this.h.get(mn.toLowerCase())||""},xt.getAllResponseHeaders=function(){if(!this.h)return"";const mn=[],In=this.h.entries();for(var On=In.next();!On.done;)On=On.value,mn.push(On[0]+": "+On[1]),On=In.next();return mn.join(`\r
`)};function Dr(mn){mn.onreadystatechange&&mn.onreadystatechange.call(mn)}Object.defineProperty(yr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(mn){this.m=mn?"include":"same-origin"}});function Ir(mn){let In="";return dn(mn,function(On,Gn){In+=Gn,In+=":",In+=On,In+=`\r
`}),In}function Mn(mn,In,On){e:{for(Gn in On){var Gn=!1;break e}Gn=!0}Gn||(On=Ir(On),typeof mn=="string"?On!=null&&encodeURIComponent(String(On)):Os(mn,In,On))}function zn(mn){pr.call(this),this.headers=new Map,this.o=mn||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}Yt(zn,pr);var er=/^https?$/i,Nr=["POST","PUT"];xt=zn.prototype,xt.Ha=function(mn){this.J=mn},xt.ea=function(mn,In,On,Gn){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+mn);In=In?In.toUpperCase():"GET",this.D=mn,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Bs.g(),this.v=this.o?ns(this.o):ns(Bs),this.g.onreadystatechange=qt(this.Ea,this);try{this.B=!0,this.g.open(In,String(mn),!0),this.B=!1}catch(Br){Vr(this,Br);return}if(mn=On||"",On=new Map(this.headers),Gn)if(Object.getPrototypeOf(Gn)===Object.prototype)for(var Cr in Gn)On.set(Cr,Gn[Cr]);else if(typeof Gn.keys=="function"&&typeof Gn.get=="function")for(const Br of Gn.keys())On.set(Br,Gn.get(Br));else throw Error("Unknown input type for opt_headers: "+String(Gn));Gn=Array.from(On.keys()).find(Br=>Br.toLowerCase()=="content-type"),Cr=Bt.FormData&&mn instanceof Bt.FormData,!(0<=Array.prototype.indexOf.call(Nr,In,void 0))||Gn||Cr||On.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Br,rs]of On)this.g.setRequestHeader(Br,rs);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Qr(this),this.u=!0,this.g.send(mn),this.u=!1}catch(Br){Vr(this,Br)}};function Vr(mn,In){mn.h=!1,mn.g&&(mn.j=!0,mn.g.abort(),mn.j=!1),mn.l=In,mn.m=5,Ur(mn),Kr(mn)}function Ur(mn){mn.A||(mn.A=!0,Tr(mn,"complete"),Tr(mn,"error"))}xt.abort=function(mn){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=mn||7,Tr(this,"complete"),Tr(this,"abort"),Kr(this))},xt.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Kr(this,!0)),zn.aa.N.call(this)},xt.Ea=function(){this.s||(this.B||this.u||this.j?_i(this):this.bb())},xt.bb=function(){_i(this)};function _i(mn){if(mn.h&&typeof jt<"u"&&(!mn.v[1]||$s(mn)!=4||mn.Z()!=2)){if(mn.u&&$s(mn)==4)Xr(mn.Ea,0,mn);else if(Tr(mn,"readystatechange"),$s(mn)==4){mn.h=!1;try{const rs=mn.Z();e:switch(rs){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var In=!0;break e;default:In=!1}var On;if(!(On=In)){var Gn;if(Gn=rs===0){var Cr=String(mn.D).match(Jr)[1]||null;!Cr&&Bt.self&&Bt.self.location&&(Cr=Bt.self.location.protocol.slice(0,-1)),Gn=!er.test(Cr?Cr.toLowerCase():"")}On=Gn}if(On)Tr(mn,"complete"),Tr(mn,"success");else{mn.m=6;try{var Br=2<$s(mn)?mn.g.statusText:""}catch{Br=""}mn.l=Br+" ["+mn.Z()+"]",Ur(mn)}}finally{Kr(mn)}}}}function Kr(mn,In){if(mn.g){Qr(mn);const On=mn.g,Gn=mn.v[0]?()=>{}:null;mn.g=null,mn.v=null,In||Tr(mn,"ready");try{On.onreadystatechange=Gn}catch{}}}function Qr(mn){mn.I&&(Bt.clearTimeout(mn.I),mn.I=null)}xt.isActive=function(){return!!this.g};function $s(mn){return mn.g?mn.g.readyState:0}xt.Z=function(){try{return 2<$s(this)?this.g.status:-1}catch{return-1}},xt.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},xt.Oa=function(mn){if(this.g){var In=this.g.responseText;return mn&&In.indexOf(mn)==0&&(In=In.substring(mn.length)),ms(In)}};function ys(mn){try{if(!mn.g)return null;if("response"in mn.g)return mn.g.response;switch(mn.H){case"":case"text":return mn.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in mn.g)return mn.g.mozResponseArrayBuffer}return null}catch{return null}}function ws(mn){const In={};mn=(mn.g&&2<=$s(mn)&&mn.g.getAllResponseHeaders()||"").split(`\r
`);for(let Gn=0;Gn<mn.length;Gn++){if(Jt(mn[Gn]))continue;var On=gn(mn[Gn]);const Cr=On[0];if(On=On[1],typeof On!="string")continue;On=On.trim();const Br=In[Cr]||[];In[Cr]=Br,Br.push(On)}hn(In,function(Gn){return Gn.join(", ")})}xt.Ba=function(){return this.m},xt.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Rs(mn,In,On){return On&&On.internalChannelParams&&On.internalChannelParams[mn]||In}function Es(mn){this.Aa=0,this.i=[],this.j=new vo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Rs("failFast",!1,mn),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Rs("baseRetryDelayMs",5e3,mn),this.cb=Rs("retryDelaySeedMs",1e4,mn),this.Wa=Rs("forwardChannelMaxRetries",2,mn),this.wa=Rs("forwardChannelRequestTimeoutMs",2e4,mn),this.pa=mn&&mn.xmlHttpFactory||void 0,this.Xa=mn&&mn.Tb||void 0,this.Ca=mn&&mn.useFetchStreams||!1,this.L=void 0,this.J=mn&&mn.supportsCrossDomainXhr||!1,this.K="",this.h=new Ko(mn&&mn.concurrentRequestLimit),this.Da=new Nn,this.P=mn&&mn.fastHandshake||!1,this.O=mn&&mn.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=mn&&mn.Rb||!1,mn&&mn.xa&&this.j.xa(),mn&&mn.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&mn&&mn.detectBufferingProxy||!1,this.ja=void 0,mn&&mn.longPollingTimeout&&0<mn.longPollingTimeout&&(this.ja=mn.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}xt=Es.prototype,xt.la=8,xt.G=1,xt.connect=function(mn,In,On,Gn){Us(0),this.W=mn,this.H=In||{},On&&Gn!==void 0&&(this.H.OSID=On,this.H.OAID=Gn),this.F=this.X,this.I=Vo(this,null,this.W),Qs(this)};function Ns(mn){if(io(mn),mn.G==3){var In=mn.U++,On=cs(mn.I);if(Os(On,"SID",mn.K),Os(On,"RID",In),Os(On,"TYPE","terminate"),to(mn,On),In=new ro(mn,mn.j,In),In.L=2,In.v=eo(cs(On)),On=!1,Bt.navigator&&Bt.navigator.sendBeacon)try{On=Bt.navigator.sendBeacon(In.v.toString(),"")}catch{}!On&&Bt.Image&&(new Image().src=In.v,On=!0),On||(In.g=Xo(In.j,null),In.g.ea(In.v)),In.F=Date.now(),ko(In)}na(mn)}function Ds(mn){mn.g&&(Ro(mn),mn.g.cancel(),mn.g=null)}function io(mn){Ds(mn),mn.u&&(Bt.clearTimeout(mn.u),mn.u=null),Io(mn),mn.h.cancel(),mn.s&&(typeof mn.s=="number"&&Bt.clearTimeout(mn.s),mn.s=null)}function Qs(mn){if(!Bo(mn.h)&&!mn.s){mn.s=!0;var In=mn.Ga;wn||An(),Rn||(wn(),Rn=!0),Dn.add(In,mn),mn.B=0}}function oo(mn,In){return Jo(mn.h)>=mn.h.j-(mn.s?1:0)?!1:mn.s?(mn.i=In.D.concat(mn.i),!0):mn.G==1||mn.G==2||mn.B>=(mn.Va?0:mn.Wa)?!1:(mn.s=go(qt(mn.Ga,mn,In),zo(mn,mn.B)),mn.B++,!0)}xt.Ga=function(mn){if(this.s)if(this.s=null,this.G==1){if(!mn){this.U=Math.floor(1e5*Math.random()),mn=this.U++;const Cr=new ro(this,this.j,mn);let Br=this.o;if(this.S&&(Br?(Br=cn(Br),yn(Br,this.S)):Br=this.S),this.m!==null||this.O||(Cr.H=Br,Br=null),this.P)e:{for(var In=0,On=0;On<this.i.length;On++){t:{var Gn=this.i[On];if("__data__"in Gn.map&&(Gn=Gn.map.__data__,typeof Gn=="string")){Gn=Gn.length;break t}Gn=void 0}if(Gn===void 0)break;if(In+=Gn,4096<In){In=On;break e}if(In===4096||On===this.i.length-1){In=On+1;break e}}In=1e3}else In=1e3;In=Oo(this,Cr,In),On=cs(this.I),Os(On,"RID",mn),Os(On,"CVER",22),this.D&&Os(On,"X-HTTP-Session-Id",this.D),to(this,On),Br&&(this.O?In="headers="+encodeURIComponent(String(Ir(Br)))+"&"+In:this.m&&Mn(On,this.m,Br)),Jn(this.h,Cr),this.Ua&&Os(On,"TYPE","init"),this.P?(Os(On,"$req",In),Os(On,"SID","null"),Cr.T=!0,Vs(Cr,On,null)):Vs(Cr,On,In),this.G=2}}else this.G==3&&(mn?ao(this,mn):this.i.length==0||Bo(this.h)||ao(this))};function ao(mn,In){var On;In?On=In.l:On=mn.U++;const Gn=cs(mn.I);Os(Gn,"SID",mn.K),Os(Gn,"RID",On),Os(Gn,"AID",mn.T),to(mn,Gn),mn.m&&mn.o&&Mn(Gn,mn.m,mn.o),On=new ro(mn,mn.j,On,mn.B+1),mn.m===null&&(On.H=mn.o),In&&(mn.i=In.D.concat(mn.i)),In=Oo(mn,On,1e3),On.I=Math.round(.5*mn.wa)+Math.round(.5*mn.wa*Math.random()),Jn(mn.h,On),Vs(On,Gn,In)}function to(mn,In){mn.H&&dn(mn.H,function(On,Gn){Os(In,Gn,On)}),mn.l&&Pr({},function(On,Gn){Os(In,Gn,On)})}function Oo(mn,In,On){On=Math.min(mn.i.length,On);var Gn=mn.l?qt(mn.l.Na,mn.l,mn):null;e:{var Cr=mn.i;let Br=-1;for(;;){const rs=["count="+On];Br==-1?0<On?(Br=Cr[0].g,rs.push("ofs="+Br)):Br=0:rs.push("ofs="+Br);let Ms=!0;for(let uo=0;uo<On;uo++){let Ws=Cr[uo].g;const Is=Cr[uo].map;if(Ws-=Br,0>Ws)Br=Math.max(0,Cr[uo].g-100),Ms=!1;else try{qn(Is,rs,"req"+Ws+"_")}catch{Gn&&Gn(Is)}}if(Ms){Gn=rs.join("&");break e}}}return mn=mn.i.splice(0,On),In.D=mn,Gn}function Ao(mn){if(!mn.g&&!mn.u){mn.Y=1;var In=mn.Fa;wn||An(),Rn||(wn(),Rn=!0),Dn.add(In,mn),mn.v=0}}function No(mn){return mn.g||mn.u||3<=mn.v?!1:(mn.Y++,mn.u=go(qt(mn.Fa,mn),zo(mn,mn.v)),mn.v++,!0)}xt.Fa=function(){if(this.u=null,Do(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var mn=2*this.R;this.j.info("BP detection timer enabled: "+mn),this.A=go(qt(this.ab,this),mn)}},xt.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Us(10),Ds(this),Do(this))};function Ro(mn){mn.A!=null&&(Bt.clearTimeout(mn.A),mn.A=null)}function Do(mn){mn.g=new ro(mn,mn.j,"rpc",mn.Y),mn.m===null&&(mn.g.H=mn.o),mn.g.O=0;var In=cs(mn.qa);Os(In,"RID","rpc"),Os(In,"SID",mn.K),Os(In,"AID",mn.T),Os(In,"CI",mn.F?"0":"1"),!mn.F&&mn.ja&&Os(In,"TO",mn.ja),Os(In,"TYPE","xmlhttp"),to(mn,In),mn.m&&mn.o&&Mn(In,mn.m,mn.o),mn.L&&(mn.g.I=mn.L);var On=mn.g;mn=mn.ia,On.L=1,On.v=eo(cs(In)),On.m=null,On.P=!0,fo(On,mn)}xt.Za=function(){this.C!=null&&(this.C=null,Ds(this),No(this),Us(19))};function Io(mn){mn.C!=null&&(Bt.clearTimeout(mn.C),mn.C=null)}function Po(mn,In){var On=null;if(mn.g==In){Io(mn),Ro(mn),mn.g=null;var Gn=2}else if(ga(mn.h,In))On=In.D,xr(mn.h,In),Gn=1;else return;if(mn.G!=0){if(In.o)if(Gn==1){On=In.m?In.m.length:0,In=Date.now()-In.F;var Cr=mn.B;Gn=zs(),Tr(Gn,new Ks(Gn,On)),Qs(mn)}else Ao(mn);else if(Cr=In.s,Cr==3||Cr==0&&0<In.X||!(Gn==1&&oo(mn,In)||Gn==2&&No(mn)))switch(On&&0<On.length&&(In=mn.h,In.i=In.i.concat(On)),Cr){case 1:Yo(mn,5);break;case 4:Yo(mn,10);break;case 3:Yo(mn,6);break;default:Yo(mn,2)}}}function zo(mn,In){let On=mn.Ta+Math.floor(Math.random()*mn.cb);return mn.isActive()||(On*=2),On*In}function Yo(mn,In){if(mn.j.info("Error code "+In),In==2){var On=qt(mn.fb,mn),Gn=mn.Xa;const Cr=!Gn;Gn=new ls(Gn||"//www.google.com/images/cleardot.gif"),Bt.location&&Bt.location.protocol=="http"||hs(Gn,"https"),eo(Gn),Cr?Kl(Gn.toString(),On):Al(Gn.toString(),On)}else Us(2);mn.G=0,mn.l&&mn.l.sa(In),na(mn),io(mn)}xt.fb=function(mn){mn?(this.j.info("Successfully pinged google.com"),Us(2)):(this.j.info("Failed to ping google.com"),Us(1))};function na(mn){if(mn.G=0,mn.ka=[],mn.l){const In=dr(mn.h);(In.length!=0||mn.i.length!=0)&&(Xt(mn.ka,In),Xt(mn.ka,mn.i),mn.h.i.length=0,Kt(mn.i),mn.i.length=0),mn.l.ra()}}function Vo(mn,In,On){var Gn=On instanceof ls?cs(On):new ls(On);if(Gn.g!="")In&&(Gn.g=In+"."+Gn.g),As(Gn,Gn.s);else{var Cr=Bt.location;Gn=Cr.protocol,In=In?In+"."+Cr.hostname:Cr.hostname,Cr=+Cr.port;var Br=new ls(null);Gn&&hs(Br,Gn),In&&(Br.g=In),Cr&&As(Br,Cr),On&&(Br.l=On),Gn=Br}return On=mn.D,In=mn.ya,On&&In&&Os(Gn,On,In),Os(Gn,"VER",mn.la),to(mn,Gn),Gn}function Xo(mn,In,On){if(In&&!mn.J)throw Error("Can't create secondary domain capable XhrIo object.");return In=mn.Ca&&!mn.pa?new zn(new fr({eb:On})):new zn(mn.pa),In.Ha(mn.J),In}xt.isActive=function(){return!!this.l&&this.l.isActive(this)};function xl(){}xt=xl.prototype,xt.ua=function(){},xt.ta=function(){},xt.sa=function(){},xt.ra=function(){},xt.isActive=function(){return!0},xt.Na=function(){};function ks(){}ks.prototype.g=function(mn,In){return new xs(mn,In)};function xs(mn,In){pr.call(this),this.g=new Es(In),this.l=mn,this.h=In&&In.messageUrlParams||null,mn=In&&In.messageHeaders||null,In&&In.clientProtocolHeaderRequired&&(mn?mn["X-Client-Protocol"]="webchannel":mn={"X-Client-Protocol":"webchannel"}),this.g.o=mn,mn=In&&In.initMessageHeaders||null,In&&In.messageContentType&&(mn?mn["X-WebChannel-Content-Type"]=In.messageContentType:mn={"X-WebChannel-Content-Type":In.messageContentType}),In&&In.va&&(mn?mn["X-WebChannel-Client-Profile"]=In.va:mn={"X-WebChannel-Client-Profile":In.va}),this.g.S=mn,(mn=In&&In.Sb)&&!Jt(mn)&&(this.g.m=mn),this.v=In&&In.supportsCrossDomainXhr||!1,this.u=In&&In.sendRawJson||!1,(In=In&&In.httpSessionIdParam)&&!Jt(In)&&(this.g.D=In,mn=this.h,mn!==null&&In in mn&&(mn=this.h,In in mn&&delete mn[In])),this.j=new bs(this)}Yt(xs,pr),xs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xs.prototype.close=function(){Ns(this.g)},xs.prototype.o=function(mn){var In=this.g;if(typeof mn=="string"){var On={};On.__data__=mn,mn=On}else this.u&&(On={},On.__data__=ds(mn),mn=On);In.i.push(new Wo(In.Ya++,mn)),In.G==3&&Qs(In)},xs.prototype.N=function(){this.g.l=null,delete this.j,Ns(this.g),delete this.g,xs.aa.N.call(this)};function Ss(mn){Ls.call(this),mn.__headers__&&(this.headers=mn.__headers__,this.statusCode=mn.__status__,delete mn.__headers__,delete mn.__status__);var In=mn.__sm__;if(In){e:{for(const On in In){mn=On;break e}mn=void 0}(this.i=mn)&&(mn=this.i,In=In!==null&&mn in In?In[mn]:void 0),this.data=In}else this.data=mn}Yt(Ss,Ls);function Cs(){vs.call(this),this.status=1}Yt(Cs,vs);function bs(mn){this.g=mn}Yt(bs,xl),bs.prototype.ua=function(){Tr(this.g,"a")},bs.prototype.ta=function(mn){Tr(this.g,new Ss(mn))},bs.prototype.sa=function(mn){Tr(this.g,new Cs)},bs.prototype.ra=function(){Tr(this.g,"b")},ks.prototype.createWebChannel=ks.prototype.g,xs.prototype.send=xs.prototype.o,xs.prototype.open=xs.prototype.m,xs.prototype.close=xs.prototype.close,createWebChannelTransport=function(){return new ks},getStatEventTarget=function(){return zs()},Event$1=Ps,Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},fs.NO_ERROR=0,fs.TIMEOUT=8,fs.HTTP_ERROR=6,ErrorCode=fs,Ts.COMPLETE="complete",EventType=Ts,us.EventType=ps,ps.OPEN="a",ps.CLOSE="b",ps.ERROR="c",ps.MESSAGE="d",pr.prototype.listen=pr.prototype.K,WebChannel=us,FetchXmlHttpFactory=fr,zn.prototype.listenOnce=zn.prototype.L,zn.prototype.getLastError=zn.prototype.Ka,zn.prototype.getLastErrorCode=zn.prototype.Ba,zn.prototype.getStatus=zn.prototype.Z,zn.prototype.getResponseJson=zn.prototype.Oa,zn.prototype.getResponseText=zn.prototype.oa,zn.prototype.send=zn.prototype.ea,zn.prototype.setWithCredentials=zn.prototype.Ha,XhrIo=zn}).apply(typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{});const S="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class User{constructor($t){this.uid=$t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual($t){return $t.uid===this.uid}}User.UNAUTHENTICATED=new User(null),User.GOOGLE_CREDENTIALS=new User("google-credentials-uid"),User.FIRST_PARTY=new User("first-party-uid"),User.MOCK_USER=new User("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let b$1="10.12.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D=new Logger("@firebase/firestore");function __PRIVATE_getLogLevel(){return D.logLevel}function __PRIVATE_logDebug(xt,...$t){if(D.logLevel<=LogLevel.DEBUG){const Ct=$t.map(__PRIVATE_argToString);D.debug(`Firestore (${b$1}): ${xt}`,...Ct)}}function __PRIVATE_logError(xt,...$t){if(D.logLevel<=LogLevel.ERROR){const Ct=$t.map(__PRIVATE_argToString);D.error(`Firestore (${b$1}): ${xt}`,...Ct)}}function __PRIVATE_logWarn(xt,...$t){if(D.logLevel<=LogLevel.WARN){const Ct=$t.map(__PRIVATE_argToString);D.warn(`Firestore (${b$1}): ${xt}`,...Ct)}}function __PRIVATE_argToString(xt){if(typeof xt=="string")return xt;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(Ct){return JSON.stringify(Ct)}(xt)}catch{return xt}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fail(xt="Unexpected state"){const $t=`FIRESTORE (${b$1}) INTERNAL ASSERTION FAILED: `+xt;throw __PRIVATE_logError($t),new Error($t)}function __PRIVATE_hardAssert(xt,$t){xt||fail()}function __PRIVATE_debugCast(xt,$t){return xt}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C$1={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class FirestoreError extends FirebaseError{constructor($t,Ct){super($t,Ct),this.code=$t,this.message=Ct,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_Deferred{constructor(){this.promise=new Promise(($t,Ct)=>{this.resolve=$t,this.reject=Ct})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_OAuthToken{constructor($t,Ct){this.user=Ct,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${$t}`)}}class __PRIVATE_EmptyAuthCredentialsProvider{getToken(){return Promise.resolve(null)}invalidateToken(){}start($t,Ct){$t.enqueueRetryable(()=>Ct(User.UNAUTHENTICATED))}shutdown(){}}class __PRIVATE_FirebaseAuthCredentialsProvider{constructor($t){this.t=$t,this.currentUser=User.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start($t,Ct){let kt=this.i;const Mt=Vt=>this.i!==kt?(kt=this.i,Ct(Vt)):Promise.resolve();let Ft=new __PRIVATE_Deferred;this.o=()=>{this.i++,this.currentUser=this.u(),Ft.resolve(),Ft=new __PRIVATE_Deferred,$t.enqueueRetryable(()=>Mt(this.currentUser))};const jt=()=>{const Vt=Ft;$t.enqueueRetryable(async()=>{await Vt.promise,await Mt(this.currentUser)})},Bt=Vt=>{__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=Vt,this.auth.addAuthTokenListener(this.o),jt()};this.t.onInit(Vt=>Bt(Vt)),setTimeout(()=>{if(!this.auth){const Vt=this.t.getImmediate({optional:!0});Vt?Bt(Vt):(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth not yet detected"),Ft.resolve(),Ft=new __PRIVATE_Deferred)}},0),jt()}getToken(){const $t=this.i,Ct=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(Ct).then(kt=>this.i!==$t?(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):kt?(__PRIVATE_hardAssert(typeof kt.accessToken=="string"),new __PRIVATE_OAuthToken(kt.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const $t=this.auth&&this.auth.getUid();return __PRIVATE_hardAssert($t===null||typeof $t=="string"),new User($t)}}class __PRIVATE_FirstPartyToken{constructor($t,Ct,kt){this.l=$t,this.h=Ct,this.P=kt,this.type="FirstParty",this.user=User.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const $t=this.T();return $t&&this.I.set("Authorization",$t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class __PRIVATE_FirstPartyAuthCredentialsProvider{constructor($t,Ct,kt){this.l=$t,this.h=Ct,this.P=kt}getToken(){return Promise.resolve(new __PRIVATE_FirstPartyToken(this.l,this.h,this.P))}start($t,Ct){$t.enqueueRetryable(()=>Ct(User.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AppCheckToken{constructor($t){this.value=$t,this.type="AppCheck",this.headers=new Map,$t&&$t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class __PRIVATE_FirebaseAppCheckTokenProvider{constructor($t){this.A=$t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start($t,Ct){const kt=Ft=>{Ft.error!=null&&__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${Ft.error.message}`);const jt=Ft.token!==this.R;return this.R=Ft.token,__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Received ${jt?"new":"existing"} token.`),jt?Ct(Ft.token):Promise.resolve()};this.o=Ft=>{$t.enqueueRetryable(()=>kt(Ft))};const Mt=Ft=>{__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=Ft,this.appCheck.addTokenListener(this.o)};this.A.onInit(Ft=>Mt(Ft)),setTimeout(()=>{if(!this.appCheck){const Ft=this.A.getImmediate({optional:!0});Ft?Mt(Ft):__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const $t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken($t).then(Ct=>Ct?(__PRIVATE_hardAssert(typeof Ct.token=="string"),this.R=Ct.token,new AppCheckToken(Ct.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_randomBytes(xt){const $t=typeof self<"u"&&(self.crypto||self.msCrypto),Ct=new Uint8Array(xt);if($t&&typeof $t.getRandomValues=="function")$t.getRandomValues(Ct);else for(let kt=0;kt<xt;kt++)Ct[kt]=Math.floor(256*Math.random());return Ct}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AutoId{static newId(){const $t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Ct=Math.floor(256/$t.length)*$t.length;let kt="";for(;kt.length<20;){const Mt=__PRIVATE_randomBytes(40);for(let Ft=0;Ft<Mt.length;++Ft)kt.length<20&&Mt[Ft]<Ct&&(kt+=$t.charAt(Mt[Ft]%$t.length))}return kt}}function __PRIVATE_primitiveComparator(xt,$t){return xt<$t?-1:xt>$t?1:0}function __PRIVATE_arrayEquals(xt,$t,Ct){return xt.length===$t.length&&xt.every((kt,Mt)=>Ct(kt,$t[Mt]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Timestamp{constructor($t,Ct){if(this.seconds=$t,this.nanoseconds=Ct,Ct<0)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+Ct);if(Ct>=1e9)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+Ct);if($t<-62135596800)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Timestamp seconds out of range: "+$t);if($t>=253402300800)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Timestamp seconds out of range: "+$t)}static now(){return Timestamp.fromMillis(Date.now())}static fromDate($t){return Timestamp.fromMillis($t.getTime())}static fromMillis($t){const Ct=Math.floor($t/1e3),kt=Math.floor(1e6*($t-1e3*Ct));return new Timestamp(Ct,kt)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo($t){return this.seconds===$t.seconds?__PRIVATE_primitiveComparator(this.nanoseconds,$t.nanoseconds):__PRIVATE_primitiveComparator(this.seconds,$t.seconds)}isEqual($t){return $t.seconds===this.seconds&&$t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const $t=this.seconds- -62135596800;return String($t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotVersion{constructor($t){this.timestamp=$t}static fromTimestamp($t){return new SnapshotVersion($t)}static min(){return new SnapshotVersion(new Timestamp(0,0))}static max(){return new SnapshotVersion(new Timestamp(253402300799,999999999))}compareTo($t){return this.timestamp._compareTo($t.timestamp)}isEqual($t){return this.timestamp.isEqual($t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BasePath{constructor($t,Ct,kt){Ct===void 0?Ct=0:Ct>$t.length&&fail(),kt===void 0?kt=$t.length-Ct:kt>$t.length-Ct&&fail(),this.segments=$t,this.offset=Ct,this.len=kt}get length(){return this.len}isEqual($t){return BasePath.comparator(this,$t)===0}child($t){const Ct=this.segments.slice(this.offset,this.limit());return $t instanceof BasePath?$t.forEach(kt=>{Ct.push(kt)}):Ct.push($t),this.construct(Ct)}limit(){return this.offset+this.length}popFirst($t){return $t=$t===void 0?1:$t,this.construct(this.segments,this.offset+$t,this.length-$t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get($t){return this.segments[this.offset+$t]}isEmpty(){return this.length===0}isPrefixOf($t){if($t.length<this.length)return!1;for(let Ct=0;Ct<this.length;Ct++)if(this.get(Ct)!==$t.get(Ct))return!1;return!0}isImmediateParentOf($t){if(this.length+1!==$t.length)return!1;for(let Ct=0;Ct<this.length;Ct++)if(this.get(Ct)!==$t.get(Ct))return!1;return!0}forEach($t){for(let Ct=this.offset,kt=this.limit();Ct<kt;Ct++)$t(this.segments[Ct])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator($t,Ct){const kt=Math.min($t.length,Ct.length);for(let Mt=0;Mt<kt;Mt++){const Ft=$t.get(Mt),jt=Ct.get(Mt);if(Ft<jt)return-1;if(Ft>jt)return 1}return $t.length<Ct.length?-1:$t.length>Ct.length?1:0}}class ResourcePath extends BasePath{construct($t,Ct,kt){return new ResourcePath($t,Ct,kt)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...$t){const Ct=[];for(const kt of $t){if(kt.indexOf("//")>=0)throw new FirestoreError(C$1.INVALID_ARGUMENT,`Invalid segment (${kt}). Paths must not contain // in them.`);Ct.push(...kt.split("/").filter(Mt=>Mt.length>0))}return new ResourcePath(Ct)}static emptyPath(){return new ResourcePath([])}}const v=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class FieldPath$1 extends BasePath{construct($t,Ct,kt){return new FieldPath$1($t,Ct,kt)}static isValidIdentifier($t){return v.test($t)}canonicalString(){return this.toArray().map($t=>($t=$t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),FieldPath$1.isValidIdentifier($t)||($t="`"+$t+"`"),$t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new FieldPath$1(["__name__"])}static fromServerFormat($t){const Ct=[];let kt="",Mt=0;const Ft=()=>{if(kt.length===0)throw new FirestoreError(C$1.INVALID_ARGUMENT,`Invalid field path (${$t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);Ct.push(kt),kt=""};let jt=!1;for(;Mt<$t.length;){const Bt=$t[Mt];if(Bt==="\\"){if(Mt+1===$t.length)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Path has trailing escape character: "+$t);const Vt=$t[Mt+1];if(Vt!=="\\"&&Vt!=="."&&Vt!=="`")throw new FirestoreError(C$1.INVALID_ARGUMENT,"Path has invalid escape sequence: "+$t);kt+=Vt,Mt+=2}else Bt==="`"?(jt=!jt,Mt++):Bt!=="."||jt?(kt+=Bt,Mt++):(Ft(),Mt++)}if(Ft(),jt)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Unterminated ` in path: "+$t);return new FieldPath$1(Ct)}static emptyPath(){return new FieldPath$1([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentKey{constructor($t){this.path=$t}static fromPath($t){return new DocumentKey(ResourcePath.fromString($t))}static fromName($t){return new DocumentKey(ResourcePath.fromString($t).popFirst(5))}static empty(){return new DocumentKey(ResourcePath.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId($t){return this.path.length>=2&&this.path.get(this.path.length-2)===$t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual($t){return $t!==null&&ResourcePath.comparator(this.path,$t.path)===0}toString(){return this.path.toString()}static comparator($t,Ct){return ResourcePath.comparator($t.path,Ct.path)}static isDocumentKey($t){return $t.length%2==0}static fromSegments($t){return new DocumentKey(new ResourcePath($t.slice()))}}function __PRIVATE_newIndexOffsetSuccessorFromReadTime(xt,$t){const Ct=xt.toTimestamp().seconds,kt=xt.toTimestamp().nanoseconds+1,Mt=SnapshotVersion.fromTimestamp(kt===1e9?new Timestamp(Ct+1,0):new Timestamp(Ct,kt));return new IndexOffset(Mt,DocumentKey.empty(),$t)}function __PRIVATE_newIndexOffsetFromDocument(xt){return new IndexOffset(xt.readTime,xt.key,-1)}class IndexOffset{constructor($t,Ct,kt){this.readTime=$t,this.documentKey=Ct,this.largestBatchId=kt}static min(){return new IndexOffset(SnapshotVersion.min(),DocumentKey.empty(),-1)}static max(){return new IndexOffset(SnapshotVersion.max(),DocumentKey.empty(),-1)}}function __PRIVATE_indexOffsetComparator(xt,$t){let Ct=xt.readTime.compareTo($t.readTime);return Ct!==0?Ct:(Ct=DocumentKey.comparator(xt.documentKey,$t.documentKey),Ct!==0?Ct:__PRIVATE_primitiveComparator(xt.largestBatchId,$t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class PersistenceTransaction{constructor(){this.onCommittedListeners=[]}addOnCommittedListener($t){this.onCommittedListeners.push($t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach($t=>$t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function __PRIVATE_ignoreIfPrimaryLeaseLoss(xt){if(xt.code!==C$1.FAILED_PRECONDITION||xt.message!==F)throw xt;__PRIVATE_logDebug("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PersistencePromise{constructor($t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,$t(Ct=>{this.isDone=!0,this.result=Ct,this.nextCallback&&this.nextCallback(Ct)},Ct=>{this.isDone=!0,this.error=Ct,this.catchCallback&&this.catchCallback(Ct)})}catch($t){return this.next(void 0,$t)}next($t,Ct){return this.callbackAttached&&fail(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(Ct,this.error):this.wrapSuccess($t,this.result):new PersistencePromise((kt,Mt)=>{this.nextCallback=Ft=>{this.wrapSuccess($t,Ft).next(kt,Mt)},this.catchCallback=Ft=>{this.wrapFailure(Ct,Ft).next(kt,Mt)}})}toPromise(){return new Promise(($t,Ct)=>{this.next($t,Ct)})}wrapUserFunction($t){try{const Ct=$t();return Ct instanceof PersistencePromise?Ct:PersistencePromise.resolve(Ct)}catch(Ct){return PersistencePromise.reject(Ct)}}wrapSuccess($t,Ct){return $t?this.wrapUserFunction(()=>$t(Ct)):PersistencePromise.resolve(Ct)}wrapFailure($t,Ct){return $t?this.wrapUserFunction(()=>$t(Ct)):PersistencePromise.reject(Ct)}static resolve($t){return new PersistencePromise((Ct,kt)=>{Ct($t)})}static reject($t){return new PersistencePromise((Ct,kt)=>{kt($t)})}static waitFor($t){return new PersistencePromise((Ct,kt)=>{let Mt=0,Ft=0,jt=!1;$t.forEach(Bt=>{++Mt,Bt.next(()=>{++Ft,jt&&Ft===Mt&&Ct()},Vt=>kt(Vt))}),jt=!0,Ft===Mt&&Ct()})}static or($t){let Ct=PersistencePromise.resolve(!1);for(const kt of $t)Ct=Ct.next(Mt=>Mt?PersistencePromise.resolve(Mt):kt());return Ct}static forEach($t,Ct){const kt=[];return $t.forEach((Mt,Ft)=>{kt.push(Ct.call(this,Mt,Ft))}),this.waitFor(kt)}static mapArray($t,Ct){return new PersistencePromise((kt,Mt)=>{const Ft=$t.length,jt=new Array(Ft);let Bt=0;for(let Vt=0;Vt<Ft;Vt++){const zt=Vt;Ct($t[zt]).next(Ht=>{jt[zt]=Ht,++Bt,Bt===Ft&&kt(jt)},Ht=>Mt(Ht))}})}static doWhile($t,Ct){return new PersistencePromise((kt,Mt)=>{const Ft=()=>{$t()===!0?Ct().next(()=>{Ft()},Mt):kt()};Ft()})}}function __PRIVATE_getAndroidVersion(xt){const $t=xt.match(/Android ([\d.]+)/i),Ct=$t?$t[1].split(".").slice(0,2).join("."):"-1";return Number(Ct)}function __PRIVATE_isIndexedDbTransactionError(xt){return xt.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ListenSequence{constructor($t,Ct){this.previousValue=$t,Ct&&(Ct.sequenceNumberHandler=kt=>this.ie(kt),this.se=kt=>Ct.writeSequenceNumber(kt))}ie($t){return this.previousValue=Math.max($t,this.previousValue),this.previousValue}next(){const $t=++this.previousValue;return this.se&&this.se($t),$t}}__PRIVATE_ListenSequence.oe=-1;function __PRIVATE_isNullOrUndefined(xt){return xt==null}function __PRIVATE_isNegativeZero(xt){return xt===0&&1/xt==-1/0}function isSafeInteger(xt){return typeof xt=="number"&&Number.isInteger(xt)&&!__PRIVATE_isNegativeZero(xt)&&xt<=Number.MAX_SAFE_INTEGER&&xt>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_objectSize(xt){let $t=0;for(const Ct in xt)Object.prototype.hasOwnProperty.call(xt,Ct)&&$t++;return $t}function forEach$1(xt,$t){for(const Ct in xt)Object.prototype.hasOwnProperty.call(xt,Ct)&&$t(Ct,xt[Ct])}function isEmpty$1(xt){for(const $t in xt)if(Object.prototype.hasOwnProperty.call(xt,$t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedMap{constructor($t,Ct){this.comparator=$t,this.root=Ct||LLRBNode.EMPTY}insert($t,Ct){return new SortedMap(this.comparator,this.root.insert($t,Ct,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}remove($t){return new SortedMap(this.comparator,this.root.remove($t,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}get($t){let Ct=this.root;for(;!Ct.isEmpty();){const kt=this.comparator($t,Ct.key);if(kt===0)return Ct.value;kt<0?Ct=Ct.left:kt>0&&(Ct=Ct.right)}return null}indexOf($t){let Ct=0,kt=this.root;for(;!kt.isEmpty();){const Mt=this.comparator($t,kt.key);if(Mt===0)return Ct+kt.left.size;Mt<0?kt=kt.left:(Ct+=kt.left.size+1,kt=kt.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal($t){return this.root.inorderTraversal($t)}forEach($t){this.inorderTraversal((Ct,kt)=>($t(Ct,kt),!1))}toString(){const $t=[];return this.inorderTraversal((Ct,kt)=>($t.push(`${Ct}:${kt}`),!1)),`{${$t.join(", ")}}`}reverseTraversal($t){return this.root.reverseTraversal($t)}getIterator(){return new SortedMapIterator(this.root,null,this.comparator,!1)}getIteratorFrom($t){return new SortedMapIterator(this.root,$t,this.comparator,!1)}getReverseIterator(){return new SortedMapIterator(this.root,null,this.comparator,!0)}getReverseIteratorFrom($t){return new SortedMapIterator(this.root,$t,this.comparator,!0)}}class SortedMapIterator{constructor($t,Ct,kt,Mt){this.isReverse=Mt,this.nodeStack=[];let Ft=1;for(;!$t.isEmpty();)if(Ft=Ct?kt($t.key,Ct):1,Ct&&Mt&&(Ft*=-1),Ft<0)$t=this.isReverse?$t.left:$t.right;else{if(Ft===0){this.nodeStack.push($t);break}this.nodeStack.push($t),$t=this.isReverse?$t.right:$t.left}}getNext(){let $t=this.nodeStack.pop();const Ct={key:$t.key,value:$t.value};if(this.isReverse)for($t=$t.left;!$t.isEmpty();)this.nodeStack.push($t),$t=$t.right;else for($t=$t.right;!$t.isEmpty();)this.nodeStack.push($t),$t=$t.left;return Ct}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const $t=this.nodeStack[this.nodeStack.length-1];return{key:$t.key,value:$t.value}}}class LLRBNode{constructor($t,Ct,kt,Mt,Ft){this.key=$t,this.value=Ct,this.color=kt??LLRBNode.RED,this.left=Mt??LLRBNode.EMPTY,this.right=Ft??LLRBNode.EMPTY,this.size=this.left.size+1+this.right.size}copy($t,Ct,kt,Mt,Ft){return new LLRBNode($t??this.key,Ct??this.value,kt??this.color,Mt??this.left,Ft??this.right)}isEmpty(){return!1}inorderTraversal($t){return this.left.inorderTraversal($t)||$t(this.key,this.value)||this.right.inorderTraversal($t)}reverseTraversal($t){return this.right.reverseTraversal($t)||$t(this.key,this.value)||this.left.reverseTraversal($t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert($t,Ct,kt){let Mt=this;const Ft=kt($t,Mt.key);return Mt=Ft<0?Mt.copy(null,null,null,Mt.left.insert($t,Ct,kt),null):Ft===0?Mt.copy(null,Ct,null,null,null):Mt.copy(null,null,null,null,Mt.right.insert($t,Ct,kt)),Mt.fixUp()}removeMin(){if(this.left.isEmpty())return LLRBNode.EMPTY;let $t=this;return $t.left.isRed()||$t.left.left.isRed()||($t=$t.moveRedLeft()),$t=$t.copy(null,null,null,$t.left.removeMin(),null),$t.fixUp()}remove($t,Ct){let kt,Mt=this;if(Ct($t,Mt.key)<0)Mt.left.isEmpty()||Mt.left.isRed()||Mt.left.left.isRed()||(Mt=Mt.moveRedLeft()),Mt=Mt.copy(null,null,null,Mt.left.remove($t,Ct),null);else{if(Mt.left.isRed()&&(Mt=Mt.rotateRight()),Mt.right.isEmpty()||Mt.right.isRed()||Mt.right.left.isRed()||(Mt=Mt.moveRedRight()),Ct($t,Mt.key)===0){if(Mt.right.isEmpty())return LLRBNode.EMPTY;kt=Mt.right.min(),Mt=Mt.copy(kt.key,kt.value,null,null,Mt.right.removeMin())}Mt=Mt.copy(null,null,null,null,Mt.right.remove($t,Ct))}return Mt.fixUp()}isRed(){return this.color}fixUp(){let $t=this;return $t.right.isRed()&&!$t.left.isRed()&&($t=$t.rotateLeft()),$t.left.isRed()&&$t.left.left.isRed()&&($t=$t.rotateRight()),$t.left.isRed()&&$t.right.isRed()&&($t=$t.colorFlip()),$t}moveRedLeft(){let $t=this.colorFlip();return $t.right.left.isRed()&&($t=$t.copy(null,null,null,null,$t.right.rotateRight()),$t=$t.rotateLeft(),$t=$t.colorFlip()),$t}moveRedRight(){let $t=this.colorFlip();return $t.left.left.isRed()&&($t=$t.rotateRight(),$t=$t.colorFlip()),$t}rotateLeft(){const $t=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,$t,null)}rotateRight(){const $t=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,$t)}colorFlip(){const $t=this.left.copy(null,null,!this.left.color,null,null),Ct=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,$t,Ct)}checkMaxDepth(){const $t=this.check();return Math.pow(2,$t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw fail();const $t=this.left.check();if($t!==this.right.check())throw fail();return $t+(this.isRed()?0:1)}}LLRBNode.EMPTY=null,LLRBNode.RED=!0,LLRBNode.BLACK=!1;LLRBNode.EMPTY=new class{constructor(){this.size=0}get key(){throw fail()}get value(){throw fail()}get color(){throw fail()}get left(){throw fail()}get right(){throw fail()}copy($t,Ct,kt,Mt,Ft){return this}insert($t,Ct,kt){return new LLRBNode($t,Ct)}remove($t,Ct){return this}isEmpty(){return!0}inorderTraversal($t){return!1}reverseTraversal($t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedSet{constructor($t){this.comparator=$t,this.data=new SortedMap(this.comparator)}has($t){return this.data.get($t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf($t){return this.data.indexOf($t)}forEach($t){this.data.inorderTraversal((Ct,kt)=>($t(Ct),!1))}forEachInRange($t,Ct){const kt=this.data.getIteratorFrom($t[0]);for(;kt.hasNext();){const Mt=kt.getNext();if(this.comparator(Mt.key,$t[1])>=0)return;Ct(Mt.key)}}forEachWhile($t,Ct){let kt;for(kt=Ct!==void 0?this.data.getIteratorFrom(Ct):this.data.getIterator();kt.hasNext();)if(!$t(kt.getNext().key))return}firstAfterOrEqual($t){const Ct=this.data.getIteratorFrom($t);return Ct.hasNext()?Ct.getNext().key:null}getIterator(){return new SortedSetIterator(this.data.getIterator())}getIteratorFrom($t){return new SortedSetIterator(this.data.getIteratorFrom($t))}add($t){return this.copy(this.data.remove($t).insert($t,!0))}delete($t){return this.has($t)?this.copy(this.data.remove($t)):this}isEmpty(){return this.data.isEmpty()}unionWith($t){let Ct=this;return Ct.size<$t.size&&(Ct=$t,$t=this),$t.forEach(kt=>{Ct=Ct.add(kt)}),Ct}isEqual($t){if(!($t instanceof SortedSet)||this.size!==$t.size)return!1;const Ct=this.data.getIterator(),kt=$t.data.getIterator();for(;Ct.hasNext();){const Mt=Ct.getNext().key,Ft=kt.getNext().key;if(this.comparator(Mt,Ft)!==0)return!1}return!0}toArray(){const $t=[];return this.forEach(Ct=>{$t.push(Ct)}),$t}toString(){const $t=[];return this.forEach(Ct=>$t.push(Ct)),"SortedSet("+$t.toString()+")"}copy($t){const Ct=new SortedSet(this.comparator);return Ct.data=$t,Ct}}class SortedSetIterator{constructor($t){this.iter=$t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldMask{constructor($t){this.fields=$t,$t.sort(FieldPath$1.comparator)}static empty(){return new FieldMask([])}unionWith($t){let Ct=new SortedSet(FieldPath$1.comparator);for(const kt of this.fields)Ct=Ct.add(kt);for(const kt of $t)Ct=Ct.add(kt);return new FieldMask(Ct.toArray())}covers($t){for(const Ct of this.fields)if(Ct.isPrefixOf($t))return!0;return!1}isEqual($t){return __PRIVATE_arrayEquals(this.fields,$t.fields,(Ct,kt)=>Ct.isEqual(kt))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_Base64DecodeError extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ByteString{constructor($t){this.binaryString=$t}static fromBase64String($t){const Ct=function(Mt){try{return atob(Mt)}catch(Ft){throw typeof DOMException<"u"&&Ft instanceof DOMException?new __PRIVATE_Base64DecodeError("Invalid base64 string: "+Ft):Ft}}($t);return new ByteString(Ct)}static fromUint8Array($t){const Ct=function(Mt){let Ft="";for(let jt=0;jt<Mt.length;++jt)Ft+=String.fromCharCode(Mt[jt]);return Ft}($t);return new ByteString(Ct)}[Symbol.iterator](){let $t=0;return{next:()=>$t<this.binaryString.length?{value:this.binaryString.charCodeAt($t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(Ct){return btoa(Ct)}(this.binaryString)}toUint8Array(){return function(Ct){const kt=new Uint8Array(Ct.length);for(let Mt=0;Mt<Ct.length;Mt++)kt[Mt]=Ct.charCodeAt(Mt);return kt}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo($t){return __PRIVATE_primitiveComparator(this.binaryString,$t.binaryString)}isEqual($t){return this.binaryString===$t.binaryString}}ByteString.EMPTY_BYTE_STRING=new ByteString("");const ne=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function __PRIVATE_normalizeTimestamp(xt){if(__PRIVATE_hardAssert(!!xt),typeof xt=="string"){let $t=0;const Ct=ne.exec(xt);if(__PRIVATE_hardAssert(!!Ct),Ct[1]){let Mt=Ct[1];Mt=(Mt+"000000000").substr(0,9),$t=Number(Mt)}const kt=new Date(xt);return{seconds:Math.floor(kt.getTime()/1e3),nanos:$t}}return{seconds:__PRIVATE_normalizeNumber(xt.seconds),nanos:__PRIVATE_normalizeNumber(xt.nanos)}}function __PRIVATE_normalizeNumber(xt){return typeof xt=="number"?xt:typeof xt=="string"?Number(xt):0}function __PRIVATE_normalizeByteString(xt){return typeof xt=="string"?ByteString.fromBase64String(xt):ByteString.fromUint8Array(xt)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_isServerTimestamp(xt){var $t,Ct;return((Ct=((($t=xt==null?void 0:xt.mapValue)===null||$t===void 0?void 0:$t.fields)||{}).__type__)===null||Ct===void 0?void 0:Ct.stringValue)==="server_timestamp"}function __PRIVATE_getPreviousValue(xt){const $t=xt.mapValue.fields.__previous_value__;return __PRIVATE_isServerTimestamp($t)?__PRIVATE_getPreviousValue($t):$t}function __PRIVATE_getLocalWriteTime(xt){const $t=__PRIVATE_normalizeTimestamp(xt.mapValue.fields.__local_write_time__.timestampValue);return new Timestamp($t.seconds,$t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DatabaseInfo{constructor($t,Ct,kt,Mt,Ft,jt,Bt,Vt,zt){this.databaseId=$t,this.appId=Ct,this.persistenceKey=kt,this.host=Mt,this.ssl=Ft,this.forceLongPolling=jt,this.autoDetectLongPolling=Bt,this.longPollingOptions=Vt,this.useFetchStreams=zt}}class DatabaseId{constructor($t,Ct){this.projectId=$t,this.database=Ct||"(default)"}static empty(){return new DatabaseId("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual($t){return $t instanceof DatabaseId&&$t.projectId===this.projectId&&$t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re$2={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function __PRIVATE_typeOrder(xt){return"nullValue"in xt?0:"booleanValue"in xt?1:"integerValue"in xt||"doubleValue"in xt?2:"timestampValue"in xt?3:"stringValue"in xt?5:"bytesValue"in xt?6:"referenceValue"in xt?7:"geoPointValue"in xt?8:"arrayValue"in xt?9:"mapValue"in xt?__PRIVATE_isServerTimestamp(xt)?4:__PRIVATE_isMaxValue(xt)?9007199254740991:10:fail()}function __PRIVATE_valueEquals(xt,$t){if(xt===$t)return!0;const Ct=__PRIVATE_typeOrder(xt);if(Ct!==__PRIVATE_typeOrder($t))return!1;switch(Ct){case 0:case 9007199254740991:return!0;case 1:return xt.booleanValue===$t.booleanValue;case 4:return __PRIVATE_getLocalWriteTime(xt).isEqual(__PRIVATE_getLocalWriteTime($t));case 3:return function(Mt,Ft){if(typeof Mt.timestampValue=="string"&&typeof Ft.timestampValue=="string"&&Mt.timestampValue.length===Ft.timestampValue.length)return Mt.timestampValue===Ft.timestampValue;const jt=__PRIVATE_normalizeTimestamp(Mt.timestampValue),Bt=__PRIVATE_normalizeTimestamp(Ft.timestampValue);return jt.seconds===Bt.seconds&&jt.nanos===Bt.nanos}(xt,$t);case 5:return xt.stringValue===$t.stringValue;case 6:return function(Mt,Ft){return __PRIVATE_normalizeByteString(Mt.bytesValue).isEqual(__PRIVATE_normalizeByteString(Ft.bytesValue))}(xt,$t);case 7:return xt.referenceValue===$t.referenceValue;case 8:return function(Mt,Ft){return __PRIVATE_normalizeNumber(Mt.geoPointValue.latitude)===__PRIVATE_normalizeNumber(Ft.geoPointValue.latitude)&&__PRIVATE_normalizeNumber(Mt.geoPointValue.longitude)===__PRIVATE_normalizeNumber(Ft.geoPointValue.longitude)}(xt,$t);case 2:return function(Mt,Ft){if("integerValue"in Mt&&"integerValue"in Ft)return __PRIVATE_normalizeNumber(Mt.integerValue)===__PRIVATE_normalizeNumber(Ft.integerValue);if("doubleValue"in Mt&&"doubleValue"in Ft){const jt=__PRIVATE_normalizeNumber(Mt.doubleValue),Bt=__PRIVATE_normalizeNumber(Ft.doubleValue);return jt===Bt?__PRIVATE_isNegativeZero(jt)===__PRIVATE_isNegativeZero(Bt):isNaN(jt)&&isNaN(Bt)}return!1}(xt,$t);case 9:return __PRIVATE_arrayEquals(xt.arrayValue.values||[],$t.arrayValue.values||[],__PRIVATE_valueEquals);case 10:return function(Mt,Ft){const jt=Mt.mapValue.fields||{},Bt=Ft.mapValue.fields||{};if(__PRIVATE_objectSize(jt)!==__PRIVATE_objectSize(Bt))return!1;for(const Vt in jt)if(jt.hasOwnProperty(Vt)&&(Bt[Vt]===void 0||!__PRIVATE_valueEquals(jt[Vt],Bt[Vt])))return!1;return!0}(xt,$t);default:return fail()}}function __PRIVATE_arrayValueContains(xt,$t){return(xt.values||[]).find(Ct=>__PRIVATE_valueEquals(Ct,$t))!==void 0}function __PRIVATE_valueCompare(xt,$t){if(xt===$t)return 0;const Ct=__PRIVATE_typeOrder(xt),kt=__PRIVATE_typeOrder($t);if(Ct!==kt)return __PRIVATE_primitiveComparator(Ct,kt);switch(Ct){case 0:case 9007199254740991:return 0;case 1:return __PRIVATE_primitiveComparator(xt.booleanValue,$t.booleanValue);case 2:return function(Ft,jt){const Bt=__PRIVATE_normalizeNumber(Ft.integerValue||Ft.doubleValue),Vt=__PRIVATE_normalizeNumber(jt.integerValue||jt.doubleValue);return Bt<Vt?-1:Bt>Vt?1:Bt===Vt?0:isNaN(Bt)?isNaN(Vt)?0:-1:1}(xt,$t);case 3:return __PRIVATE_compareTimestamps(xt.timestampValue,$t.timestampValue);case 4:return __PRIVATE_compareTimestamps(__PRIVATE_getLocalWriteTime(xt),__PRIVATE_getLocalWriteTime($t));case 5:return __PRIVATE_primitiveComparator(xt.stringValue,$t.stringValue);case 6:return function(Ft,jt){const Bt=__PRIVATE_normalizeByteString(Ft),Vt=__PRIVATE_normalizeByteString(jt);return Bt.compareTo(Vt)}(xt.bytesValue,$t.bytesValue);case 7:return function(Ft,jt){const Bt=Ft.split("/"),Vt=jt.split("/");for(let zt=0;zt<Bt.length&&zt<Vt.length;zt++){const Ht=__PRIVATE_primitiveComparator(Bt[zt],Vt[zt]);if(Ht!==0)return Ht}return __PRIVATE_primitiveComparator(Bt.length,Vt.length)}(xt.referenceValue,$t.referenceValue);case 8:return function(Ft,jt){const Bt=__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(Ft.latitude),__PRIVATE_normalizeNumber(jt.latitude));return Bt!==0?Bt:__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(Ft.longitude),__PRIVATE_normalizeNumber(jt.longitude))}(xt.geoPointValue,$t.geoPointValue);case 9:return function(Ft,jt){const Bt=Ft.values||[],Vt=jt.values||[];for(let zt=0;zt<Bt.length&&zt<Vt.length;++zt){const Ht=__PRIVATE_valueCompare(Bt[zt],Vt[zt]);if(Ht)return Ht}return __PRIVATE_primitiveComparator(Bt.length,Vt.length)}(xt.arrayValue,$t.arrayValue);case 10:return function(Ft,jt){if(Ft===re$2.mapValue&&jt===re$2.mapValue)return 0;if(Ft===re$2.mapValue)return 1;if(jt===re$2.mapValue)return-1;const Bt=Ft.fields||{},Vt=Object.keys(Bt),zt=jt.fields||{},Ht=Object.keys(zt);Vt.sort(),Ht.sort();for(let Gt=0;Gt<Vt.length&&Gt<Ht.length;++Gt){const qt=__PRIVATE_primitiveComparator(Vt[Gt],Ht[Gt]);if(qt!==0)return qt;const Wt=__PRIVATE_valueCompare(Bt[Vt[Gt]],zt[Ht[Gt]]);if(Wt!==0)return Wt}return __PRIVATE_primitiveComparator(Vt.length,Ht.length)}(xt.mapValue,$t.mapValue);default:throw fail()}}function __PRIVATE_compareTimestamps(xt,$t){if(typeof xt=="string"&&typeof $t=="string"&&xt.length===$t.length)return __PRIVATE_primitiveComparator(xt,$t);const Ct=__PRIVATE_normalizeTimestamp(xt),kt=__PRIVATE_normalizeTimestamp($t),Mt=__PRIVATE_primitiveComparator(Ct.seconds,kt.seconds);return Mt!==0?Mt:__PRIVATE_primitiveComparator(Ct.nanos,kt.nanos)}function canonicalId(xt){return __PRIVATE_canonifyValue(xt)}function __PRIVATE_canonifyValue(xt){return"nullValue"in xt?"null":"booleanValue"in xt?""+xt.booleanValue:"integerValue"in xt?""+xt.integerValue:"doubleValue"in xt?""+xt.doubleValue:"timestampValue"in xt?function(Ct){const kt=__PRIVATE_normalizeTimestamp(Ct);return`time(${kt.seconds},${kt.nanos})`}(xt.timestampValue):"stringValue"in xt?xt.stringValue:"bytesValue"in xt?function(Ct){return __PRIVATE_normalizeByteString(Ct).toBase64()}(xt.bytesValue):"referenceValue"in xt?function(Ct){return DocumentKey.fromName(Ct).toString()}(xt.referenceValue):"geoPointValue"in xt?function(Ct){return`geo(${Ct.latitude},${Ct.longitude})`}(xt.geoPointValue):"arrayValue"in xt?function(Ct){let kt="[",Mt=!0;for(const Ft of Ct.values||[])Mt?Mt=!1:kt+=",",kt+=__PRIVATE_canonifyValue(Ft);return kt+"]"}(xt.arrayValue):"mapValue"in xt?function(Ct){const kt=Object.keys(Ct.fields||{}).sort();let Mt="{",Ft=!0;for(const jt of kt)Ft?Ft=!1:Mt+=",",Mt+=`${jt}:${__PRIVATE_canonifyValue(Ct.fields[jt])}`;return Mt+"}"}(xt.mapValue):fail()}function __PRIVATE_refValue(xt,$t){return{referenceValue:`projects/${xt.projectId}/databases/${xt.database}/documents/${$t.path.canonicalString()}`}}function isInteger$2(xt){return!!xt&&"integerValue"in xt}function isArray$1(xt){return!!xt&&"arrayValue"in xt}function __PRIVATE_isNullValue(xt){return!!xt&&"nullValue"in xt}function __PRIVATE_isNanValue(xt){return!!xt&&"doubleValue"in xt&&isNaN(Number(xt.doubleValue))}function __PRIVATE_isMapValue(xt){return!!xt&&"mapValue"in xt}function __PRIVATE_deepClone(xt){if(xt.geoPointValue)return{geoPointValue:Object.assign({},xt.geoPointValue)};if(xt.timestampValue&&typeof xt.timestampValue=="object")return{timestampValue:Object.assign({},xt.timestampValue)};if(xt.mapValue){const $t={mapValue:{fields:{}}};return forEach$1(xt.mapValue.fields,(Ct,kt)=>$t.mapValue.fields[Ct]=__PRIVATE_deepClone(kt)),$t}if(xt.arrayValue){const $t={arrayValue:{values:[]}};for(let Ct=0;Ct<(xt.arrayValue.values||[]).length;++Ct)$t.arrayValue.values[Ct]=__PRIVATE_deepClone(xt.arrayValue.values[Ct]);return $t}return Object.assign({},xt)}function __PRIVATE_isMaxValue(xt){return(((xt.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ObjectValue{constructor($t){this.value=$t}static empty(){return new ObjectValue({mapValue:{}})}field($t){if($t.isEmpty())return this.value;{let Ct=this.value;for(let kt=0;kt<$t.length-1;++kt)if(Ct=(Ct.mapValue.fields||{})[$t.get(kt)],!__PRIVATE_isMapValue(Ct))return null;return Ct=(Ct.mapValue.fields||{})[$t.lastSegment()],Ct||null}}set($t,Ct){this.getFieldsMap($t.popLast())[$t.lastSegment()]=__PRIVATE_deepClone(Ct)}setAll($t){let Ct=FieldPath$1.emptyPath(),kt={},Mt=[];$t.forEach((jt,Bt)=>{if(!Ct.isImmediateParentOf(Bt)){const Vt=this.getFieldsMap(Ct);this.applyChanges(Vt,kt,Mt),kt={},Mt=[],Ct=Bt.popLast()}jt?kt[Bt.lastSegment()]=__PRIVATE_deepClone(jt):Mt.push(Bt.lastSegment())});const Ft=this.getFieldsMap(Ct);this.applyChanges(Ft,kt,Mt)}delete($t){const Ct=this.field($t.popLast());__PRIVATE_isMapValue(Ct)&&Ct.mapValue.fields&&delete Ct.mapValue.fields[$t.lastSegment()]}isEqual($t){return __PRIVATE_valueEquals(this.value,$t.value)}getFieldsMap($t){let Ct=this.value;Ct.mapValue.fields||(Ct.mapValue={fields:{}});for(let kt=0;kt<$t.length;++kt){let Mt=Ct.mapValue.fields[$t.get(kt)];__PRIVATE_isMapValue(Mt)&&Mt.mapValue.fields||(Mt={mapValue:{fields:{}}},Ct.mapValue.fields[$t.get(kt)]=Mt),Ct=Mt}return Ct.mapValue.fields}applyChanges($t,Ct,kt){forEach$1(Ct,(Mt,Ft)=>$t[Mt]=Ft);for(const Mt of kt)delete $t[Mt]}clone(){return new ObjectValue(__PRIVATE_deepClone(this.value))}}function __PRIVATE_extractFieldMask(xt){const $t=[];return forEach$1(xt.fields,(Ct,kt)=>{const Mt=new FieldPath$1([Ct]);if(__PRIVATE_isMapValue(kt)){const Ft=__PRIVATE_extractFieldMask(kt.mapValue).fields;if(Ft.length===0)$t.push(Mt);else for(const jt of Ft)$t.push(Mt.child(jt))}else $t.push(Mt)}),new FieldMask($t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MutableDocument{constructor($t,Ct,kt,Mt,Ft,jt,Bt){this.key=$t,this.documentType=Ct,this.version=kt,this.readTime=Mt,this.createTime=Ft,this.data=jt,this.documentState=Bt}static newInvalidDocument($t){return new MutableDocument($t,0,SnapshotVersion.min(),SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),0)}static newFoundDocument($t,Ct,kt,Mt){return new MutableDocument($t,1,Ct,SnapshotVersion.min(),kt,Mt,0)}static newNoDocument($t,Ct){return new MutableDocument($t,2,Ct,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),0)}static newUnknownDocument($t,Ct){return new MutableDocument($t,3,Ct,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),2)}convertToFoundDocument($t,Ct){return!this.createTime.isEqual(SnapshotVersion.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=$t),this.version=$t,this.documentType=1,this.data=Ct,this.documentState=0,this}convertToNoDocument($t){return this.version=$t,this.documentType=2,this.data=ObjectValue.empty(),this.documentState=0,this}convertToUnknownDocument($t){return this.version=$t,this.documentType=3,this.data=ObjectValue.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=SnapshotVersion.min(),this}setReadTime($t){return this.readTime=$t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual($t){return $t instanceof MutableDocument&&this.key.isEqual($t.key)&&this.version.isEqual($t.version)&&this.documentType===$t.documentType&&this.documentState===$t.documentState&&this.data.isEqual($t.data)}mutableCopy(){return new MutableDocument(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bound$2=class{constructor($t,Ct){this.position=$t,this.inclusive=Ct}};function __PRIVATE_boundCompareToDocument(xt,$t,Ct){let kt=0;for(let Mt=0;Mt<xt.position.length;Mt++){const Ft=$t[Mt],jt=xt.position[Mt];if(Ft.field.isKeyField()?kt=DocumentKey.comparator(DocumentKey.fromName(jt.referenceValue),Ct.key):kt=__PRIVATE_valueCompare(jt,Ct.data.field(Ft.field)),Ft.dir==="desc"&&(kt*=-1),kt!==0)break}return kt}function __PRIVATE_boundEquals(xt,$t){if(xt===null)return $t===null;if($t===null||xt.inclusive!==$t.inclusive||xt.position.length!==$t.position.length)return!1;for(let Ct=0;Ct<xt.position.length;Ct++)if(!__PRIVATE_valueEquals(xt.position[Ct],$t.position[Ct]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OrderBy{constructor($t,Ct="asc"){this.field=$t,this.dir=Ct}}function __PRIVATE_orderByEquals(xt,$t){return xt.dir===$t.dir&&xt.field.isEqual($t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Filter$1=class{};class FieldFilter extends Filter$1{constructor($t,Ct,kt){super(),this.field=$t,this.op=Ct,this.value=kt}static create($t,Ct,kt){return $t.isKeyField()?Ct==="in"||Ct==="not-in"?this.createKeyFieldInFilter($t,Ct,kt):new __PRIVATE_KeyFieldFilter($t,Ct,kt):Ct==="array-contains"?new __PRIVATE_ArrayContainsFilter($t,kt):Ct==="in"?new __PRIVATE_InFilter($t,kt):Ct==="not-in"?new __PRIVATE_NotInFilter($t,kt):Ct==="array-contains-any"?new __PRIVATE_ArrayContainsAnyFilter($t,kt):new FieldFilter($t,Ct,kt)}static createKeyFieldInFilter($t,Ct,kt){return Ct==="in"?new __PRIVATE_KeyFieldInFilter($t,kt):new __PRIVATE_KeyFieldNotInFilter($t,kt)}matches($t){const Ct=$t.data.field(this.field);return this.op==="!="?Ct!==null&&this.matchesComparison(__PRIVATE_valueCompare(Ct,this.value)):Ct!==null&&__PRIVATE_typeOrder(this.value)===__PRIVATE_typeOrder(Ct)&&this.matchesComparison(__PRIVATE_valueCompare(Ct,this.value))}matchesComparison($t){switch(this.op){case"<":return $t<0;case"<=":return $t<=0;case"==":return $t===0;case"!=":return $t!==0;case">":return $t>0;case">=":return $t>=0;default:return fail()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class CompositeFilter extends Filter$1{constructor($t,Ct){super(),this.filters=$t,this.op=Ct,this.ae=null}static create($t,Ct){return new CompositeFilter($t,Ct)}matches($t){return __PRIVATE_compositeFilterIsConjunction(this)?this.filters.find(Ct=>!Ct.matches($t))===void 0:this.filters.find(Ct=>Ct.matches($t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce(($t,Ct)=>$t.concat(Ct.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function __PRIVATE_compositeFilterIsConjunction(xt){return xt.op==="and"}function __PRIVATE_compositeFilterIsFlatConjunction(xt){return __PRIVATE_compositeFilterIsFlat(xt)&&__PRIVATE_compositeFilterIsConjunction(xt)}function __PRIVATE_compositeFilterIsFlat(xt){for(const $t of xt.filters)if($t instanceof CompositeFilter)return!1;return!0}function __PRIVATE_canonifyFilter(xt){if(xt instanceof FieldFilter)return xt.field.canonicalString()+xt.op.toString()+canonicalId(xt.value);if(__PRIVATE_compositeFilterIsFlatConjunction(xt))return xt.filters.map($t=>__PRIVATE_canonifyFilter($t)).join(",");{const $t=xt.filters.map(Ct=>__PRIVATE_canonifyFilter(Ct)).join(",");return`${xt.op}(${$t})`}}function __PRIVATE_filterEquals(xt,$t){return xt instanceof FieldFilter?function(kt,Mt){return Mt instanceof FieldFilter&&kt.op===Mt.op&&kt.field.isEqual(Mt.field)&&__PRIVATE_valueEquals(kt.value,Mt.value)}(xt,$t):xt instanceof CompositeFilter?function(kt,Mt){return Mt instanceof CompositeFilter&&kt.op===Mt.op&&kt.filters.length===Mt.filters.length?kt.filters.reduce((Ft,jt,Bt)=>Ft&&__PRIVATE_filterEquals(jt,Mt.filters[Bt]),!0):!1}(xt,$t):void fail()}function __PRIVATE_stringifyFilter(xt){return xt instanceof FieldFilter?function(Ct){return`${Ct.field.canonicalString()} ${Ct.op} ${canonicalId(Ct.value)}`}(xt):xt instanceof CompositeFilter?function(Ct){return Ct.op.toString()+" {"+Ct.getFilters().map(__PRIVATE_stringifyFilter).join(" ,")+"}"}(xt):"Filter"}class __PRIVATE_KeyFieldFilter extends FieldFilter{constructor($t,Ct,kt){super($t,Ct,kt),this.key=DocumentKey.fromName(kt.referenceValue)}matches($t){const Ct=DocumentKey.comparator($t.key,this.key);return this.matchesComparison(Ct)}}class __PRIVATE_KeyFieldInFilter extends FieldFilter{constructor($t,Ct){super($t,"in",Ct),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("in",Ct)}matches($t){return this.keys.some(Ct=>Ct.isEqual($t.key))}}class __PRIVATE_KeyFieldNotInFilter extends FieldFilter{constructor($t,Ct){super($t,"not-in",Ct),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("not-in",Ct)}matches($t){return!this.keys.some(Ct=>Ct.isEqual($t.key))}}function __PRIVATE_extractDocumentKeysFromArrayValue(xt,$t){var Ct;return(((Ct=$t.arrayValue)===null||Ct===void 0?void 0:Ct.values)||[]).map(kt=>DocumentKey.fromName(kt.referenceValue))}class __PRIVATE_ArrayContainsFilter extends FieldFilter{constructor($t,Ct){super($t,"array-contains",Ct)}matches($t){const Ct=$t.data.field(this.field);return isArray$1(Ct)&&__PRIVATE_arrayValueContains(Ct.arrayValue,this.value)}}class __PRIVATE_InFilter extends FieldFilter{constructor($t,Ct){super($t,"in",Ct)}matches($t){const Ct=$t.data.field(this.field);return Ct!==null&&__PRIVATE_arrayValueContains(this.value.arrayValue,Ct)}}class __PRIVATE_NotInFilter extends FieldFilter{constructor($t,Ct){super($t,"not-in",Ct)}matches($t){if(__PRIVATE_arrayValueContains(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const Ct=$t.data.field(this.field);return Ct!==null&&!__PRIVATE_arrayValueContains(this.value.arrayValue,Ct)}}class __PRIVATE_ArrayContainsAnyFilter extends FieldFilter{constructor($t,Ct){super($t,"array-contains-any",Ct)}matches($t){const Ct=$t.data.field(this.field);return!(!isArray$1(Ct)||!Ct.arrayValue.values)&&Ct.arrayValue.values.some(kt=>__PRIVATE_arrayValueContains(this.value.arrayValue,kt))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_TargetImpl{constructor($t,Ct=null,kt=[],Mt=[],Ft=null,jt=null,Bt=null){this.path=$t,this.collectionGroup=Ct,this.orderBy=kt,this.filters=Mt,this.limit=Ft,this.startAt=jt,this.endAt=Bt,this.ue=null}}function __PRIVATE_newTarget(xt,$t=null,Ct=[],kt=[],Mt=null,Ft=null,jt=null){return new __PRIVATE_TargetImpl(xt,$t,Ct,kt,Mt,Ft,jt)}function __PRIVATE_canonifyTarget(xt){const $t=__PRIVATE_debugCast(xt);if($t.ue===null){let Ct=$t.path.canonicalString();$t.collectionGroup!==null&&(Ct+="|cg:"+$t.collectionGroup),Ct+="|f:",Ct+=$t.filters.map(kt=>__PRIVATE_canonifyFilter(kt)).join(","),Ct+="|ob:",Ct+=$t.orderBy.map(kt=>function(Ft){return Ft.field.canonicalString()+Ft.dir}(kt)).join(","),__PRIVATE_isNullOrUndefined($t.limit)||(Ct+="|l:",Ct+=$t.limit),$t.startAt&&(Ct+="|lb:",Ct+=$t.startAt.inclusive?"b:":"a:",Ct+=$t.startAt.position.map(kt=>canonicalId(kt)).join(",")),$t.endAt&&(Ct+="|ub:",Ct+=$t.endAt.inclusive?"a:":"b:",Ct+=$t.endAt.position.map(kt=>canonicalId(kt)).join(",")),$t.ue=Ct}return $t.ue}function __PRIVATE_targetEquals(xt,$t){if(xt.limit!==$t.limit||xt.orderBy.length!==$t.orderBy.length)return!1;for(let Ct=0;Ct<xt.orderBy.length;Ct++)if(!__PRIVATE_orderByEquals(xt.orderBy[Ct],$t.orderBy[Ct]))return!1;if(xt.filters.length!==$t.filters.length)return!1;for(let Ct=0;Ct<xt.filters.length;Ct++)if(!__PRIVATE_filterEquals(xt.filters[Ct],$t.filters[Ct]))return!1;return xt.collectionGroup===$t.collectionGroup&&!!xt.path.isEqual($t.path)&&!!__PRIVATE_boundEquals(xt.startAt,$t.startAt)&&__PRIVATE_boundEquals(xt.endAt,$t.endAt)}function __PRIVATE_targetIsDocumentTarget(xt){return DocumentKey.isDocumentKey(xt.path)&&xt.collectionGroup===null&&xt.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryImpl{constructor($t,Ct=null,kt=[],Mt=[],Ft=null,jt="F",Bt=null,Vt=null){this.path=$t,this.collectionGroup=Ct,this.explicitOrderBy=kt,this.filters=Mt,this.limit=Ft,this.limitType=jt,this.startAt=Bt,this.endAt=Vt,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function __PRIVATE_newQuery(xt,$t,Ct,kt,Mt,Ft,jt,Bt){return new __PRIVATE_QueryImpl(xt,$t,Ct,kt,Mt,Ft,jt,Bt)}function __PRIVATE_newQueryForPath(xt){return new __PRIVATE_QueryImpl(xt)}function __PRIVATE_queryMatchesAllDocuments(xt){return xt.filters.length===0&&xt.limit===null&&xt.startAt==null&&xt.endAt==null&&(xt.explicitOrderBy.length===0||xt.explicitOrderBy.length===1&&xt.explicitOrderBy[0].field.isKeyField())}function __PRIVATE_isCollectionGroupQuery(xt){return xt.collectionGroup!==null}function __PRIVATE_queryNormalizedOrderBy(xt){const $t=__PRIVATE_debugCast(xt);if($t.ce===null){$t.ce=[];const Ct=new Set;for(const Ft of $t.explicitOrderBy)$t.ce.push(Ft),Ct.add(Ft.field.canonicalString());const kt=$t.explicitOrderBy.length>0?$t.explicitOrderBy[$t.explicitOrderBy.length-1].dir:"asc";(function(jt){let Bt=new SortedSet(FieldPath$1.comparator);return jt.filters.forEach(Vt=>{Vt.getFlattenedFilters().forEach(zt=>{zt.isInequality()&&(Bt=Bt.add(zt.field))})}),Bt})($t).forEach(Ft=>{Ct.has(Ft.canonicalString())||Ft.isKeyField()||$t.ce.push(new OrderBy(Ft,kt))}),Ct.has(FieldPath$1.keyField().canonicalString())||$t.ce.push(new OrderBy(FieldPath$1.keyField(),kt))}return $t.ce}function __PRIVATE_queryToTarget(xt){const $t=__PRIVATE_debugCast(xt);return $t.le||($t.le=__PRIVATE__queryToTarget($t,__PRIVATE_queryNormalizedOrderBy(xt))),$t.le}function __PRIVATE__queryToTarget(xt,$t){if(xt.limitType==="F")return __PRIVATE_newTarget(xt.path,xt.collectionGroup,$t,xt.filters,xt.limit,xt.startAt,xt.endAt);{$t=$t.map(Mt=>{const Ft=Mt.dir==="desc"?"asc":"desc";return new OrderBy(Mt.field,Ft)});const Ct=xt.endAt?new Bound$2(xt.endAt.position,xt.endAt.inclusive):null,kt=xt.startAt?new Bound$2(xt.startAt.position,xt.startAt.inclusive):null;return __PRIVATE_newTarget(xt.path,xt.collectionGroup,$t,xt.filters,xt.limit,Ct,kt)}}function __PRIVATE_queryWithAddedFilter(xt,$t){const Ct=xt.filters.concat([$t]);return new __PRIVATE_QueryImpl(xt.path,xt.collectionGroup,xt.explicitOrderBy.slice(),Ct,xt.limit,xt.limitType,xt.startAt,xt.endAt)}function __PRIVATE_queryWithLimit(xt,$t,Ct){return new __PRIVATE_QueryImpl(xt.path,xt.collectionGroup,xt.explicitOrderBy.slice(),xt.filters.slice(),$t,Ct,xt.startAt,xt.endAt)}function __PRIVATE_queryEquals(xt,$t){return __PRIVATE_targetEquals(__PRIVATE_queryToTarget(xt),__PRIVATE_queryToTarget($t))&&xt.limitType===$t.limitType}function __PRIVATE_canonifyQuery(xt){return`${__PRIVATE_canonifyTarget(__PRIVATE_queryToTarget(xt))}|lt:${xt.limitType}`}function __PRIVATE_stringifyQuery(xt){return`Query(target=${function(Ct){let kt=Ct.path.canonicalString();return Ct.collectionGroup!==null&&(kt+=" collectionGroup="+Ct.collectionGroup),Ct.filters.length>0&&(kt+=`, filters: [${Ct.filters.map(Mt=>__PRIVATE_stringifyFilter(Mt)).join(", ")}]`),__PRIVATE_isNullOrUndefined(Ct.limit)||(kt+=", limit: "+Ct.limit),Ct.orderBy.length>0&&(kt+=`, orderBy: [${Ct.orderBy.map(Mt=>function(jt){return`${jt.field.canonicalString()} (${jt.dir})`}(Mt)).join(", ")}]`),Ct.startAt&&(kt+=", startAt: ",kt+=Ct.startAt.inclusive?"b:":"a:",kt+=Ct.startAt.position.map(Mt=>canonicalId(Mt)).join(",")),Ct.endAt&&(kt+=", endAt: ",kt+=Ct.endAt.inclusive?"a:":"b:",kt+=Ct.endAt.position.map(Mt=>canonicalId(Mt)).join(",")),`Target(${kt})`}(__PRIVATE_queryToTarget(xt))}; limitType=${xt.limitType})`}function __PRIVATE_queryMatches(xt,$t){return $t.isFoundDocument()&&function(kt,Mt){const Ft=Mt.key.path;return kt.collectionGroup!==null?Mt.key.hasCollectionId(kt.collectionGroup)&&kt.path.isPrefixOf(Ft):DocumentKey.isDocumentKey(kt.path)?kt.path.isEqual(Ft):kt.path.isImmediateParentOf(Ft)}(xt,$t)&&function(kt,Mt){for(const Ft of __PRIVATE_queryNormalizedOrderBy(kt))if(!Ft.field.isKeyField()&&Mt.data.field(Ft.field)===null)return!1;return!0}(xt,$t)&&function(kt,Mt){for(const Ft of kt.filters)if(!Ft.matches(Mt))return!1;return!0}(xt,$t)&&function(kt,Mt){return!(kt.startAt&&!function(jt,Bt,Vt){const zt=__PRIVATE_boundCompareToDocument(jt,Bt,Vt);return jt.inclusive?zt<=0:zt<0}(kt.startAt,__PRIVATE_queryNormalizedOrderBy(kt),Mt)||kt.endAt&&!function(jt,Bt,Vt){const zt=__PRIVATE_boundCompareToDocument(jt,Bt,Vt);return jt.inclusive?zt>=0:zt>0}(kt.endAt,__PRIVATE_queryNormalizedOrderBy(kt),Mt))}(xt,$t)}function __PRIVATE_queryCollectionGroup(xt){return xt.collectionGroup||(xt.path.length%2==1?xt.path.lastSegment():xt.path.get(xt.path.length-2))}function __PRIVATE_newQueryComparator(xt){return($t,Ct)=>{let kt=!1;for(const Mt of __PRIVATE_queryNormalizedOrderBy(xt)){const Ft=__PRIVATE_compareDocs(Mt,$t,Ct);if(Ft!==0)return Ft;kt=kt||Mt.field.isKeyField()}return 0}}function __PRIVATE_compareDocs(xt,$t,Ct){const kt=xt.field.isKeyField()?DocumentKey.comparator($t.key,Ct.key):function(Ft,jt,Bt){const Vt=jt.data.field(Ft),zt=Bt.data.field(Ft);return Vt!==null&&zt!==null?__PRIVATE_valueCompare(Vt,zt):fail()}(xt.field,$t,Ct);switch(xt.dir){case"asc":return kt;case"desc":return-1*kt;default:return fail()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ObjectMap{constructor($t,Ct){this.mapKeyFn=$t,this.equalsFn=Ct,this.inner={},this.innerSize=0}get($t){const Ct=this.mapKeyFn($t),kt=this.inner[Ct];if(kt!==void 0){for(const[Mt,Ft]of kt)if(this.equalsFn(Mt,$t))return Ft}}has($t){return this.get($t)!==void 0}set($t,Ct){const kt=this.mapKeyFn($t),Mt=this.inner[kt];if(Mt===void 0)return this.inner[kt]=[[$t,Ct]],void this.innerSize++;for(let Ft=0;Ft<Mt.length;Ft++)if(this.equalsFn(Mt[Ft][0],$t))return void(Mt[Ft]=[$t,Ct]);Mt.push([$t,Ct]),this.innerSize++}delete($t){const Ct=this.mapKeyFn($t),kt=this.inner[Ct];if(kt===void 0)return!1;for(let Mt=0;Mt<kt.length;Mt++)if(this.equalsFn(kt[Mt][0],$t))return kt.length===1?delete this.inner[Ct]:kt.splice(Mt,1),this.innerSize--,!0;return!1}forEach($t){forEach$1(this.inner,(Ct,kt)=>{for(const[Mt,Ft]of kt)$t(Mt,Ft)})}isEmpty(){return isEmpty$1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se=new SortedMap(DocumentKey.comparator);function __PRIVATE_mutableDocumentMap(){return se}const oe=new SortedMap(DocumentKey.comparator);function documentMap(...xt){let $t=oe;for(const Ct of xt)$t=$t.insert(Ct.key,Ct);return $t}function __PRIVATE_convertOverlayedDocumentMapToDocumentMap(xt){let $t=oe;return xt.forEach((Ct,kt)=>$t=$t.insert(Ct,kt.overlayedDocument)),$t}function __PRIVATE_newOverlayMap(){return __PRIVATE_newDocumentKeyMap()}function __PRIVATE_newMutationMap(){return __PRIVATE_newDocumentKeyMap()}function __PRIVATE_newDocumentKeyMap(){return new ObjectMap(xt=>xt.toString(),(xt,$t)=>xt.isEqual($t))}const _e=new SortedMap(DocumentKey.comparator),ae=new SortedSet(DocumentKey.comparator);function __PRIVATE_documentKeySet(...xt){let $t=ae;for(const Ct of xt)$t=$t.add(Ct);return $t}const ue=new SortedSet(__PRIVATE_primitiveComparator);function __PRIVATE_targetIdSet(){return ue}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_toDouble(xt,$t){if(xt.useProto3Json){if(isNaN($t))return{doubleValue:"NaN"};if($t===1/0)return{doubleValue:"Infinity"};if($t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:__PRIVATE_isNegativeZero($t)?"-0":$t}}function __PRIVATE_toInteger(xt){return{integerValue:""+xt}}function toNumber$1(xt,$t){return isSafeInteger($t)?__PRIVATE_toInteger($t):__PRIVATE_toDouble(xt,$t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransformOperation{constructor(){this._=void 0}}function __PRIVATE_applyTransformOperationToLocalView(xt,$t,Ct){return xt instanceof __PRIVATE_ServerTimestampTransform?function(Mt,Ft){const jt={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:Mt.seconds,nanos:Mt.nanoseconds}}}};return Ft&&__PRIVATE_isServerTimestamp(Ft)&&(Ft=__PRIVATE_getPreviousValue(Ft)),Ft&&(jt.fields.__previous_value__=Ft),{mapValue:jt}}(Ct,$t):xt instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(xt,$t):xt instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(xt,$t):function(Mt,Ft){const jt=__PRIVATE_computeTransformOperationBaseValue(Mt,Ft),Bt=asNumber(jt)+asNumber(Mt.Pe);return isInteger$2(jt)&&isInteger$2(Mt.Pe)?__PRIVATE_toInteger(Bt):__PRIVATE_toDouble(Mt.serializer,Bt)}(xt,$t)}function __PRIVATE_applyTransformOperationToRemoteDocument(xt,$t,Ct){return xt instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(xt,$t):xt instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(xt,$t):Ct}function __PRIVATE_computeTransformOperationBaseValue(xt,$t){return xt instanceof __PRIVATE_NumericIncrementTransformOperation?function(kt){return isInteger$2(kt)||function(Ft){return!!Ft&&"doubleValue"in Ft}(kt)}($t)?$t:{integerValue:0}:null}class __PRIVATE_ServerTimestampTransform extends TransformOperation{}class __PRIVATE_ArrayUnionTransformOperation extends TransformOperation{constructor($t){super(),this.elements=$t}}function __PRIVATE_applyArrayUnionTransformOperation(xt,$t){const Ct=__PRIVATE_coercedFieldValuesArray($t);for(const kt of xt.elements)Ct.some(Mt=>__PRIVATE_valueEquals(Mt,kt))||Ct.push(kt);return{arrayValue:{values:Ct}}}class __PRIVATE_ArrayRemoveTransformOperation extends TransformOperation{constructor($t){super(),this.elements=$t}}function __PRIVATE_applyArrayRemoveTransformOperation(xt,$t){let Ct=__PRIVATE_coercedFieldValuesArray($t);for(const kt of xt.elements)Ct=Ct.filter(Mt=>!__PRIVATE_valueEquals(Mt,kt));return{arrayValue:{values:Ct}}}class __PRIVATE_NumericIncrementTransformOperation extends TransformOperation{constructor($t,Ct){super(),this.serializer=$t,this.Pe=Ct}}function asNumber(xt){return __PRIVATE_normalizeNumber(xt.integerValue||xt.doubleValue)}function __PRIVATE_coercedFieldValuesArray(xt){return isArray$1(xt)&&xt.arrayValue.values?xt.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldTransform{constructor($t,Ct){this.field=$t,this.transform=Ct}}function __PRIVATE_fieldTransformEquals(xt,$t){return xt.field.isEqual($t.field)&&function(kt,Mt){return kt instanceof __PRIVATE_ArrayUnionTransformOperation&&Mt instanceof __PRIVATE_ArrayUnionTransformOperation||kt instanceof __PRIVATE_ArrayRemoveTransformOperation&&Mt instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_arrayEquals(kt.elements,Mt.elements,__PRIVATE_valueEquals):kt instanceof __PRIVATE_NumericIncrementTransformOperation&&Mt instanceof __PRIVATE_NumericIncrementTransformOperation?__PRIVATE_valueEquals(kt.Pe,Mt.Pe):kt instanceof __PRIVATE_ServerTimestampTransform&&Mt instanceof __PRIVATE_ServerTimestampTransform}(xt.transform,$t.transform)}class MutationResult{constructor($t,Ct){this.version=$t,this.transformResults=Ct}}class Precondition{constructor($t,Ct){this.updateTime=$t,this.exists=Ct}static none(){return new Precondition}static exists($t){return new Precondition(void 0,$t)}static updateTime($t){return new Precondition($t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual($t){return this.exists===$t.exists&&(this.updateTime?!!$t.updateTime&&this.updateTime.isEqual($t.updateTime):!$t.updateTime)}}function __PRIVATE_preconditionIsValidForDocument(xt,$t){return xt.updateTime!==void 0?$t.isFoundDocument()&&$t.version.isEqual(xt.updateTime):xt.exists===void 0||xt.exists===$t.isFoundDocument()}class Mutation{}function __PRIVATE_calculateOverlayMutation(xt,$t){if(!xt.hasLocalMutations||$t&&$t.fields.length===0)return null;if($t===null)return xt.isNoDocument()?new __PRIVATE_DeleteMutation(xt.key,Precondition.none()):new __PRIVATE_SetMutation(xt.key,xt.data,Precondition.none());{const Ct=xt.data,kt=ObjectValue.empty();let Mt=new SortedSet(FieldPath$1.comparator);for(let Ft of $t.fields)if(!Mt.has(Ft)){let jt=Ct.field(Ft);jt===null&&Ft.length>1&&(Ft=Ft.popLast(),jt=Ct.field(Ft)),jt===null?kt.delete(Ft):kt.set(Ft,jt),Mt=Mt.add(Ft)}return new __PRIVATE_PatchMutation(xt.key,kt,new FieldMask(Mt.toArray()),Precondition.none())}}function __PRIVATE_mutationApplyToRemoteDocument(xt,$t,Ct){xt instanceof __PRIVATE_SetMutation?function(Mt,Ft,jt){const Bt=Mt.value.clone(),Vt=__PRIVATE_serverTransformResults(Mt.fieldTransforms,Ft,jt.transformResults);Bt.setAll(Vt),Ft.convertToFoundDocument(jt.version,Bt).setHasCommittedMutations()}(xt,$t,Ct):xt instanceof __PRIVATE_PatchMutation?function(Mt,Ft,jt){if(!__PRIVATE_preconditionIsValidForDocument(Mt.precondition,Ft))return void Ft.convertToUnknownDocument(jt.version);const Bt=__PRIVATE_serverTransformResults(Mt.fieldTransforms,Ft,jt.transformResults),Vt=Ft.data;Vt.setAll(__PRIVATE_getPatch(Mt)),Vt.setAll(Bt),Ft.convertToFoundDocument(jt.version,Vt).setHasCommittedMutations()}(xt,$t,Ct):function(Mt,Ft,jt){Ft.convertToNoDocument(jt.version).setHasCommittedMutations()}(0,$t,Ct)}function __PRIVATE_mutationApplyToLocalView(xt,$t,Ct,kt){return xt instanceof __PRIVATE_SetMutation?function(Ft,jt,Bt,Vt){if(!__PRIVATE_preconditionIsValidForDocument(Ft.precondition,jt))return Bt;const zt=Ft.value.clone(),Ht=__PRIVATE_localTransformResults(Ft.fieldTransforms,Vt,jt);return zt.setAll(Ht),jt.convertToFoundDocument(jt.version,zt).setHasLocalMutations(),null}(xt,$t,Ct,kt):xt instanceof __PRIVATE_PatchMutation?function(Ft,jt,Bt,Vt){if(!__PRIVATE_preconditionIsValidForDocument(Ft.precondition,jt))return Bt;const zt=__PRIVATE_localTransformResults(Ft.fieldTransforms,Vt,jt),Ht=jt.data;return Ht.setAll(__PRIVATE_getPatch(Ft)),Ht.setAll(zt),jt.convertToFoundDocument(jt.version,Ht).setHasLocalMutations(),Bt===null?null:Bt.unionWith(Ft.fieldMask.fields).unionWith(Ft.fieldTransforms.map(Gt=>Gt.field))}(xt,$t,Ct,kt):function(Ft,jt,Bt){return __PRIVATE_preconditionIsValidForDocument(Ft.precondition,jt)?(jt.convertToNoDocument(jt.version).setHasLocalMutations(),null):Bt}(xt,$t,Ct)}function __PRIVATE_mutationExtractBaseValue(xt,$t){let Ct=null;for(const kt of xt.fieldTransforms){const Mt=$t.data.field(kt.field),Ft=__PRIVATE_computeTransformOperationBaseValue(kt.transform,Mt||null);Ft!=null&&(Ct===null&&(Ct=ObjectValue.empty()),Ct.set(kt.field,Ft))}return Ct||null}function __PRIVATE_mutationEquals(xt,$t){return xt.type===$t.type&&!!xt.key.isEqual($t.key)&&!!xt.precondition.isEqual($t.precondition)&&!!function(kt,Mt){return kt===void 0&&Mt===void 0||!(!kt||!Mt)&&__PRIVATE_arrayEquals(kt,Mt,(Ft,jt)=>__PRIVATE_fieldTransformEquals(Ft,jt))}(xt.fieldTransforms,$t.fieldTransforms)&&(xt.type===0?xt.value.isEqual($t.value):xt.type!==1||xt.data.isEqual($t.data)&&xt.fieldMask.isEqual($t.fieldMask))}class __PRIVATE_SetMutation extends Mutation{constructor($t,Ct,kt,Mt=[]){super(),this.key=$t,this.value=Ct,this.precondition=kt,this.fieldTransforms=Mt,this.type=0}getFieldMask(){return null}}class __PRIVATE_PatchMutation extends Mutation{constructor($t,Ct,kt,Mt,Ft=[]){super(),this.key=$t,this.data=Ct,this.fieldMask=kt,this.precondition=Mt,this.fieldTransforms=Ft,this.type=1}getFieldMask(){return this.fieldMask}}function __PRIVATE_getPatch(xt){const $t=new Map;return xt.fieldMask.fields.forEach(Ct=>{if(!Ct.isEmpty()){const kt=xt.data.field(Ct);$t.set(Ct,kt)}}),$t}function __PRIVATE_serverTransformResults(xt,$t,Ct){const kt=new Map;__PRIVATE_hardAssert(xt.length===Ct.length);for(let Mt=0;Mt<Ct.length;Mt++){const Ft=xt[Mt],jt=Ft.transform,Bt=$t.data.field(Ft.field);kt.set(Ft.field,__PRIVATE_applyTransformOperationToRemoteDocument(jt,Bt,Ct[Mt]))}return kt}function __PRIVATE_localTransformResults(xt,$t,Ct){const kt=new Map;for(const Mt of xt){const Ft=Mt.transform,jt=Ct.data.field(Mt.field);kt.set(Mt.field,__PRIVATE_applyTransformOperationToLocalView(Ft,jt,$t))}return kt}class __PRIVATE_DeleteMutation extends Mutation{constructor($t,Ct){super(),this.key=$t,this.precondition=Ct,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class __PRIVATE_VerifyMutation extends Mutation{constructor($t,Ct){super(),this.key=$t,this.precondition=Ct,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MutationBatch{constructor($t,Ct,kt,Mt){this.batchId=$t,this.localWriteTime=Ct,this.baseMutations=kt,this.mutations=Mt}applyToRemoteDocument($t,Ct){const kt=Ct.mutationResults;for(let Mt=0;Mt<this.mutations.length;Mt++){const Ft=this.mutations[Mt];Ft.key.isEqual($t.key)&&__PRIVATE_mutationApplyToRemoteDocument(Ft,$t,kt[Mt])}}applyToLocalView($t,Ct){for(const kt of this.baseMutations)kt.key.isEqual($t.key)&&(Ct=__PRIVATE_mutationApplyToLocalView(kt,$t,Ct,this.localWriteTime));for(const kt of this.mutations)kt.key.isEqual($t.key)&&(Ct=__PRIVATE_mutationApplyToLocalView(kt,$t,Ct,this.localWriteTime));return Ct}applyToLocalDocumentSet($t,Ct){const kt=__PRIVATE_newMutationMap();return this.mutations.forEach(Mt=>{const Ft=$t.get(Mt.key),jt=Ft.overlayedDocument;let Bt=this.applyToLocalView(jt,Ft.mutatedFields);Bt=Ct.has(Mt.key)?null:Bt;const Vt=__PRIVATE_calculateOverlayMutation(jt,Bt);Vt!==null&&kt.set(Mt.key,Vt),jt.isValidDocument()||jt.convertToNoDocument(SnapshotVersion.min())}),kt}keys(){return this.mutations.reduce(($t,Ct)=>$t.add(Ct.key),__PRIVATE_documentKeySet())}isEqual($t){return this.batchId===$t.batchId&&__PRIVATE_arrayEquals(this.mutations,$t.mutations,(Ct,kt)=>__PRIVATE_mutationEquals(Ct,kt))&&__PRIVATE_arrayEquals(this.baseMutations,$t.baseMutations,(Ct,kt)=>__PRIVATE_mutationEquals(Ct,kt))}}class MutationBatchResult{constructor($t,Ct,kt,Mt){this.batch=$t,this.commitVersion=Ct,this.mutationResults=kt,this.docVersions=Mt}static from($t,Ct,kt){__PRIVATE_hardAssert($t.mutations.length===kt.length);let Mt=function(){return _e}();const Ft=$t.mutations;for(let jt=0;jt<Ft.length;jt++)Mt=Mt.insert(Ft[jt].key,kt[jt].version);return new MutationBatchResult($t,Ct,kt,Mt)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Overlay{constructor($t,Ct){this.largestBatchId=$t,this.mutation=Ct}getKey(){return this.mutation.key}isEqual($t){return $t!==null&&this.mutation===$t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ExistenceFilter{constructor($t,Ct){this.count=$t,this.unchangedNames=Ct}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ce,le;function __PRIVATE_isPermanentError(xt){switch(xt){default:return fail();case C$1.CANCELLED:case C$1.UNKNOWN:case C$1.DEADLINE_EXCEEDED:case C$1.RESOURCE_EXHAUSTED:case C$1.INTERNAL:case C$1.UNAVAILABLE:case C$1.UNAUTHENTICATED:return!1;case C$1.INVALID_ARGUMENT:case C$1.NOT_FOUND:case C$1.ALREADY_EXISTS:case C$1.PERMISSION_DENIED:case C$1.FAILED_PRECONDITION:case C$1.ABORTED:case C$1.OUT_OF_RANGE:case C$1.UNIMPLEMENTED:case C$1.DATA_LOSS:return!0}}function __PRIVATE_mapCodeFromRpcCode(xt){if(xt===void 0)return __PRIVATE_logError("GRPC error has no .code"),C$1.UNKNOWN;switch(xt){case ce.OK:return C$1.OK;case ce.CANCELLED:return C$1.CANCELLED;case ce.UNKNOWN:return C$1.UNKNOWN;case ce.DEADLINE_EXCEEDED:return C$1.DEADLINE_EXCEEDED;case ce.RESOURCE_EXHAUSTED:return C$1.RESOURCE_EXHAUSTED;case ce.INTERNAL:return C$1.INTERNAL;case ce.UNAVAILABLE:return C$1.UNAVAILABLE;case ce.UNAUTHENTICATED:return C$1.UNAUTHENTICATED;case ce.INVALID_ARGUMENT:return C$1.INVALID_ARGUMENT;case ce.NOT_FOUND:return C$1.NOT_FOUND;case ce.ALREADY_EXISTS:return C$1.ALREADY_EXISTS;case ce.PERMISSION_DENIED:return C$1.PERMISSION_DENIED;case ce.FAILED_PRECONDITION:return C$1.FAILED_PRECONDITION;case ce.ABORTED:return C$1.ABORTED;case ce.OUT_OF_RANGE:return C$1.OUT_OF_RANGE;case ce.UNIMPLEMENTED:return C$1.UNIMPLEMENTED;case ce.DATA_LOSS:return C$1.DATA_LOSS;default:return fail()}}(le=ce||(ce={}))[le.OK=0]="OK",le[le.CANCELLED=1]="CANCELLED",le[le.UNKNOWN=2]="UNKNOWN",le[le.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",le[le.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",le[le.NOT_FOUND=5]="NOT_FOUND",le[le.ALREADY_EXISTS=6]="ALREADY_EXISTS",le[le.PERMISSION_DENIED=7]="PERMISSION_DENIED",le[le.UNAUTHENTICATED=16]="UNAUTHENTICATED",le[le.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",le[le.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",le[le.ABORTED=10]="ABORTED",le[le.OUT_OF_RANGE=11]="OUT_OF_RANGE",le[le.UNIMPLEMENTED=12]="UNIMPLEMENTED",le[le.INTERNAL=13]="INTERNAL",le[le.UNAVAILABLE=14]="UNAVAILABLE",le[le.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newTextEncoder(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pe=new Integer([4294967295,4294967295],0);function __PRIVATE_getMd5HashValue(xt){const $t=__PRIVATE_newTextEncoder().encode(xt),Ct=new Md5;return Ct.update($t),new Uint8Array(Ct.digest())}function __PRIVATE_get64BitUints(xt){const $t=new DataView(xt.buffer),Ct=$t.getUint32(0,!0),kt=$t.getUint32(4,!0),Mt=$t.getUint32(8,!0),Ft=$t.getUint32(12,!0);return[new Integer([Ct,kt],0),new Integer([Mt,Ft],0)]}class BloomFilter{constructor($t,Ct,kt){if(this.bitmap=$t,this.padding=Ct,this.hashCount=kt,Ct<0||Ct>=8)throw new __PRIVATE_BloomFilterError(`Invalid padding: ${Ct}`);if(kt<0)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${kt}`);if($t.length>0&&this.hashCount===0)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${kt}`);if($t.length===0&&Ct!==0)throw new __PRIVATE_BloomFilterError(`Invalid padding when bitmap length is 0: ${Ct}`);this.Ie=8*$t.length-Ct,this.Te=Integer.fromNumber(this.Ie)}Ee($t,Ct,kt){let Mt=$t.add(Ct.multiply(Integer.fromNumber(kt)));return Mt.compare(Pe)===1&&(Mt=new Integer([Mt.getBits(0),Mt.getBits(1)],0)),Mt.modulo(this.Te).toNumber()}de($t){return(this.bitmap[Math.floor($t/8)]&1<<$t%8)!=0}mightContain($t){if(this.Ie===0)return!1;const Ct=__PRIVATE_getMd5HashValue($t),[kt,Mt]=__PRIVATE_get64BitUints(Ct);for(let Ft=0;Ft<this.hashCount;Ft++){const jt=this.Ee(kt,Mt,Ft);if(!this.de(jt))return!1}return!0}static create($t,Ct,kt){const Mt=$t%8==0?0:8-$t%8,Ft=new Uint8Array(Math.ceil($t/8)),jt=new BloomFilter(Ft,Mt,Ct);return kt.forEach(Bt=>jt.insert(Bt)),jt}insert($t){if(this.Ie===0)return;const Ct=__PRIVATE_getMd5HashValue($t),[kt,Mt]=__PRIVATE_get64BitUints(Ct);for(let Ft=0;Ft<this.hashCount;Ft++){const jt=this.Ee(kt,Mt,Ft);this.Ae(jt)}}Ae($t){const Ct=Math.floor($t/8),kt=$t%8;this.bitmap[Ct]|=1<<kt}}class __PRIVATE_BloomFilterError extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RemoteEvent{constructor($t,Ct,kt,Mt,Ft){this.snapshotVersion=$t,this.targetChanges=Ct,this.targetMismatches=kt,this.documentUpdates=Mt,this.resolvedLimboDocuments=Ft}static createSynthesizedRemoteEventForCurrentChange($t,Ct,kt){const Mt=new Map;return Mt.set($t,TargetChange.createSynthesizedTargetChangeForCurrentChange($t,Ct,kt)),new RemoteEvent(SnapshotVersion.min(),Mt,new SortedMap(__PRIVATE_primitiveComparator),__PRIVATE_mutableDocumentMap(),__PRIVATE_documentKeySet())}}class TargetChange{constructor($t,Ct,kt,Mt,Ft){this.resumeToken=$t,this.current=Ct,this.addedDocuments=kt,this.modifiedDocuments=Mt,this.removedDocuments=Ft}static createSynthesizedTargetChangeForCurrentChange($t,Ct,kt){return new TargetChange(kt,Ct,__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DocumentWatchChange{constructor($t,Ct,kt,Mt){this.Re=$t,this.removedTargetIds=Ct,this.key=kt,this.Ve=Mt}}class __PRIVATE_ExistenceFilterChange{constructor($t,Ct){this.targetId=$t,this.me=Ct}}class __PRIVATE_WatchTargetChange{constructor($t,Ct,kt=ByteString.EMPTY_BYTE_STRING,Mt=null){this.state=$t,this.targetIds=Ct,this.resumeToken=kt,this.cause=Mt}}class __PRIVATE_TargetState{constructor(){this.fe=0,this.ge=__PRIVATE_snapshotChangesMap(),this.pe=ByteString.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De($t){$t.approximateByteSize()>0&&(this.we=!0,this.pe=$t)}Ce(){let $t=__PRIVATE_documentKeySet(),Ct=__PRIVATE_documentKeySet(),kt=__PRIVATE_documentKeySet();return this.ge.forEach((Mt,Ft)=>{switch(Ft){case 0:$t=$t.add(Mt);break;case 2:Ct=Ct.add(Mt);break;case 1:kt=kt.add(Mt);break;default:fail()}}),new TargetChange(this.pe,this.ye,$t,Ct,kt)}ve(){this.we=!1,this.ge=__PRIVATE_snapshotChangesMap()}Fe($t,Ct){this.we=!0,this.ge=this.ge.insert($t,Ct)}Me($t){this.we=!0,this.ge=this.ge.remove($t)}xe(){this.fe+=1}Oe(){this.fe-=1,__PRIVATE_hardAssert(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class __PRIVATE_WatchChangeAggregator{constructor($t){this.Le=$t,this.Be=new Map,this.ke=__PRIVATE_mutableDocumentMap(),this.qe=__PRIVATE_documentTargetMap(),this.Qe=new SortedMap(__PRIVATE_primitiveComparator)}Ke($t){for(const Ct of $t.Re)$t.Ve&&$t.Ve.isFoundDocument()?this.$e(Ct,$t.Ve):this.Ue(Ct,$t.key,$t.Ve);for(const Ct of $t.removedTargetIds)this.Ue(Ct,$t.key,$t.Ve)}We($t){this.forEachTarget($t,Ct=>{const kt=this.Ge(Ct);switch($t.state){case 0:this.ze(Ct)&&kt.De($t.resumeToken);break;case 1:kt.Oe(),kt.Se||kt.ve(),kt.De($t.resumeToken);break;case 2:kt.Oe(),kt.Se||this.removeTarget(Ct);break;case 3:this.ze(Ct)&&(kt.Ne(),kt.De($t.resumeToken));break;case 4:this.ze(Ct)&&(this.je(Ct),kt.De($t.resumeToken));break;default:fail()}})}forEachTarget($t,Ct){$t.targetIds.length>0?$t.targetIds.forEach(Ct):this.Be.forEach((kt,Mt)=>{this.ze(Mt)&&Ct(Mt)})}He($t){const Ct=$t.targetId,kt=$t.me.count,Mt=this.Je(Ct);if(Mt){const Ft=Mt.target;if(__PRIVATE_targetIsDocumentTarget(Ft))if(kt===0){const jt=new DocumentKey(Ft.path);this.Ue(Ct,jt,MutableDocument.newNoDocument(jt,SnapshotVersion.min()))}else __PRIVATE_hardAssert(kt===1);else{const jt=this.Ye(Ct);if(jt!==kt){const Bt=this.Ze($t),Vt=Bt?this.Xe(Bt,$t,jt):1;if(Vt!==0){this.je(Ct);const zt=Vt===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(Ct,zt)}}}}}Ze($t){const Ct=$t.me.unchangedNames;if(!Ct||!Ct.bits)return null;const{bits:{bitmap:kt="",padding:Mt=0},hashCount:Ft=0}=Ct;let jt,Bt;try{jt=__PRIVATE_normalizeByteString(kt).toUint8Array()}catch(Vt){if(Vt instanceof __PRIVATE_Base64DecodeError)return __PRIVATE_logWarn("Decoding the base64 bloom filter in existence filter failed ("+Vt.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw Vt}try{Bt=new BloomFilter(jt,Mt,Ft)}catch(Vt){return __PRIVATE_logWarn(Vt instanceof __PRIVATE_BloomFilterError?"BloomFilter error: ":"Applying bloom filter failed: ",Vt),null}return Bt.Ie===0?null:Bt}Xe($t,Ct,kt){return Ct.me.count===kt-this.nt($t,Ct.targetId)?0:2}nt($t,Ct){const kt=this.Le.getRemoteKeysForTarget(Ct);let Mt=0;return kt.forEach(Ft=>{const jt=this.Le.tt(),Bt=`projects/${jt.projectId}/databases/${jt.database}/documents/${Ft.path.canonicalString()}`;$t.mightContain(Bt)||(this.Ue(Ct,Ft,null),Mt++)}),Mt}rt($t){const Ct=new Map;this.Be.forEach((Ft,jt)=>{const Bt=this.Je(jt);if(Bt){if(Ft.current&&__PRIVATE_targetIsDocumentTarget(Bt.target)){const Vt=new DocumentKey(Bt.target.path);this.ke.get(Vt)!==null||this.it(jt,Vt)||this.Ue(jt,Vt,MutableDocument.newNoDocument(Vt,$t))}Ft.be&&(Ct.set(jt,Ft.Ce()),Ft.ve())}});let kt=__PRIVATE_documentKeySet();this.qe.forEach((Ft,jt)=>{let Bt=!0;jt.forEachWhile(Vt=>{const zt=this.Je(Vt);return!zt||zt.purpose==="TargetPurposeLimboResolution"||(Bt=!1,!1)}),Bt&&(kt=kt.add(Ft))}),this.ke.forEach((Ft,jt)=>jt.setReadTime($t));const Mt=new RemoteEvent($t,Ct,this.Qe,this.ke,kt);return this.ke=__PRIVATE_mutableDocumentMap(),this.qe=__PRIVATE_documentTargetMap(),this.Qe=new SortedMap(__PRIVATE_primitiveComparator),Mt}$e($t,Ct){if(!this.ze($t))return;const kt=this.it($t,Ct.key)?2:0;this.Ge($t).Fe(Ct.key,kt),this.ke=this.ke.insert(Ct.key,Ct),this.qe=this.qe.insert(Ct.key,this.st(Ct.key).add($t))}Ue($t,Ct,kt){if(!this.ze($t))return;const Mt=this.Ge($t);this.it($t,Ct)?Mt.Fe(Ct,1):Mt.Me(Ct),this.qe=this.qe.insert(Ct,this.st(Ct).delete($t)),kt&&(this.ke=this.ke.insert(Ct,kt))}removeTarget($t){this.Be.delete($t)}Ye($t){const Ct=this.Ge($t).Ce();return this.Le.getRemoteKeysForTarget($t).size+Ct.addedDocuments.size-Ct.removedDocuments.size}xe($t){this.Ge($t).xe()}Ge($t){let Ct=this.Be.get($t);return Ct||(Ct=new __PRIVATE_TargetState,this.Be.set($t,Ct)),Ct}st($t){let Ct=this.qe.get($t);return Ct||(Ct=new SortedSet(__PRIVATE_primitiveComparator),this.qe=this.qe.insert($t,Ct)),Ct}ze($t){const Ct=this.Je($t)!==null;return Ct||__PRIVATE_logDebug("WatchChangeAggregator","Detected inactive target",$t),Ct}Je($t){const Ct=this.Be.get($t);return Ct&&Ct.Se?null:this.Le.ot($t)}je($t){this.Be.set($t,new __PRIVATE_TargetState),this.Le.getRemoteKeysForTarget($t).forEach(Ct=>{this.Ue($t,Ct,null)})}it($t,Ct){return this.Le.getRemoteKeysForTarget($t).has(Ct)}}function __PRIVATE_documentTargetMap(){return new SortedMap(DocumentKey.comparator)}function __PRIVATE_snapshotChangesMap(){return new SortedMap(DocumentKey.comparator)}const Ie={asc:"ASCENDING",desc:"DESCENDING"},Te={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ee={and:"AND",or:"OR"};class JsonProtoSerializer{constructor($t,Ct){this.databaseId=$t,this.useProto3Json=Ct}}function __PRIVATE_toInt32Proto(xt,$t){return xt.useProto3Json||__PRIVATE_isNullOrUndefined($t)?$t:{value:$t}}function toTimestamp(xt,$t){return xt.useProto3Json?`${new Date(1e3*$t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+$t.nanoseconds).slice(-9)}Z`:{seconds:""+$t.seconds,nanos:$t.nanoseconds}}function __PRIVATE_toBytes(xt,$t){return xt.useProto3Json?$t.toBase64():$t.toUint8Array()}function __PRIVATE_toVersion(xt,$t){return toTimestamp(xt,$t.toTimestamp())}function __PRIVATE_fromVersion(xt){return __PRIVATE_hardAssert(!!xt),SnapshotVersion.fromTimestamp(function(Ct){const kt=__PRIVATE_normalizeTimestamp(Ct);return new Timestamp(kt.seconds,kt.nanos)}(xt))}function __PRIVATE_toResourceName(xt,$t){return __PRIVATE_toResourcePath(xt,$t).canonicalString()}function __PRIVATE_toResourcePath(xt,$t){const Ct=function(Mt){return new ResourcePath(["projects",Mt.projectId,"databases",Mt.database])}(xt).child("documents");return $t===void 0?Ct:Ct.child($t)}function __PRIVATE_fromResourceName(xt){const $t=ResourcePath.fromString(xt);return __PRIVATE_hardAssert(__PRIVATE_isValidResourceName($t)),$t}function __PRIVATE_toName(xt,$t){return __PRIVATE_toResourceName(xt.databaseId,$t.path)}function fromName(xt,$t){const Ct=__PRIVATE_fromResourceName($t);if(Ct.get(1)!==xt.databaseId.projectId)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+Ct.get(1)+" vs "+xt.databaseId.projectId);if(Ct.get(3)!==xt.databaseId.database)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+Ct.get(3)+" vs "+xt.databaseId.database);return new DocumentKey(__PRIVATE_extractLocalPathFromResourceName(Ct))}function __PRIVATE_toQueryPath(xt,$t){return __PRIVATE_toResourceName(xt.databaseId,$t)}function __PRIVATE_fromQueryPath(xt){const $t=__PRIVATE_fromResourceName(xt);return $t.length===4?ResourcePath.emptyPath():__PRIVATE_extractLocalPathFromResourceName($t)}function __PRIVATE_getEncodedDatabaseId(xt){return new ResourcePath(["projects",xt.databaseId.projectId,"databases",xt.databaseId.database]).canonicalString()}function __PRIVATE_extractLocalPathFromResourceName(xt){return __PRIVATE_hardAssert(xt.length>4&&xt.get(4)==="documents"),xt.popFirst(5)}function __PRIVATE_toMutationDocument(xt,$t,Ct){return{name:__PRIVATE_toName(xt,$t),fields:Ct.value.mapValue.fields}}function __PRIVATE_fromWatchChange(xt,$t){let Ct;if("targetChange"in $t){$t.targetChange;const kt=function(zt){return zt==="NO_CHANGE"?0:zt==="ADD"?1:zt==="REMOVE"?2:zt==="CURRENT"?3:zt==="RESET"?4:fail()}($t.targetChange.targetChangeType||"NO_CHANGE"),Mt=$t.targetChange.targetIds||[],Ft=function(zt,Ht){return zt.useProto3Json?(__PRIVATE_hardAssert(Ht===void 0||typeof Ht=="string"),ByteString.fromBase64String(Ht||"")):(__PRIVATE_hardAssert(Ht===void 0||Ht instanceof Buffer||Ht instanceof Uint8Array),ByteString.fromUint8Array(Ht||new Uint8Array))}(xt,$t.targetChange.resumeToken),jt=$t.targetChange.cause,Bt=jt&&function(zt){const Ht=zt.code===void 0?C$1.UNKNOWN:__PRIVATE_mapCodeFromRpcCode(zt.code);return new FirestoreError(Ht,zt.message||"")}(jt);Ct=new __PRIVATE_WatchTargetChange(kt,Mt,Ft,Bt||null)}else if("documentChange"in $t){$t.documentChange;const kt=$t.documentChange;kt.document,kt.document.name,kt.document.updateTime;const Mt=fromName(xt,kt.document.name),Ft=__PRIVATE_fromVersion(kt.document.updateTime),jt=kt.document.createTime?__PRIVATE_fromVersion(kt.document.createTime):SnapshotVersion.min(),Bt=new ObjectValue({mapValue:{fields:kt.document.fields}}),Vt=MutableDocument.newFoundDocument(Mt,Ft,jt,Bt),zt=kt.targetIds||[],Ht=kt.removedTargetIds||[];Ct=new __PRIVATE_DocumentWatchChange(zt,Ht,Vt.key,Vt)}else if("documentDelete"in $t){$t.documentDelete;const kt=$t.documentDelete;kt.document;const Mt=fromName(xt,kt.document),Ft=kt.readTime?__PRIVATE_fromVersion(kt.readTime):SnapshotVersion.min(),jt=MutableDocument.newNoDocument(Mt,Ft),Bt=kt.removedTargetIds||[];Ct=new __PRIVATE_DocumentWatchChange([],Bt,jt.key,jt)}else if("documentRemove"in $t){$t.documentRemove;const kt=$t.documentRemove;kt.document;const Mt=fromName(xt,kt.document),Ft=kt.removedTargetIds||[];Ct=new __PRIVATE_DocumentWatchChange([],Ft,Mt,null)}else{if(!("filter"in $t))return fail();{$t.filter;const kt=$t.filter;kt.targetId;const{count:Mt=0,unchangedNames:Ft}=kt,jt=new ExistenceFilter(Mt,Ft),Bt=kt.targetId;Ct=new __PRIVATE_ExistenceFilterChange(Bt,jt)}}return Ct}function toMutation(xt,$t){let Ct;if($t instanceof __PRIVATE_SetMutation)Ct={update:__PRIVATE_toMutationDocument(xt,$t.key,$t.value)};else if($t instanceof __PRIVATE_DeleteMutation)Ct={delete:__PRIVATE_toName(xt,$t.key)};else if($t instanceof __PRIVATE_PatchMutation)Ct={update:__PRIVATE_toMutationDocument(xt,$t.key,$t.data),updateMask:__PRIVATE_toDocumentMask($t.fieldMask)};else{if(!($t instanceof __PRIVATE_VerifyMutation))return fail();Ct={verify:__PRIVATE_toName(xt,$t.key)}}return $t.fieldTransforms.length>0&&(Ct.updateTransforms=$t.fieldTransforms.map(kt=>function(Ft,jt){const Bt=jt.transform;if(Bt instanceof __PRIVATE_ServerTimestampTransform)return{fieldPath:jt.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(Bt instanceof __PRIVATE_ArrayUnionTransformOperation)return{fieldPath:jt.field.canonicalString(),appendMissingElements:{values:Bt.elements}};if(Bt instanceof __PRIVATE_ArrayRemoveTransformOperation)return{fieldPath:jt.field.canonicalString(),removeAllFromArray:{values:Bt.elements}};if(Bt instanceof __PRIVATE_NumericIncrementTransformOperation)return{fieldPath:jt.field.canonicalString(),increment:Bt.Pe};throw fail()}(0,kt))),$t.precondition.isNone||(Ct.currentDocument=function(Mt,Ft){return Ft.updateTime!==void 0?{updateTime:__PRIVATE_toVersion(Mt,Ft.updateTime)}:Ft.exists!==void 0?{exists:Ft.exists}:fail()}(xt,$t.precondition)),Ct}function __PRIVATE_fromWriteResults(xt,$t){return xt&&xt.length>0?(__PRIVATE_hardAssert($t!==void 0),xt.map(Ct=>function(Mt,Ft){let jt=Mt.updateTime?__PRIVATE_fromVersion(Mt.updateTime):__PRIVATE_fromVersion(Ft);return jt.isEqual(SnapshotVersion.min())&&(jt=__PRIVATE_fromVersion(Ft)),new MutationResult(jt,Mt.transformResults||[])}(Ct,$t))):[]}function __PRIVATE_toDocumentsTarget(xt,$t){return{documents:[__PRIVATE_toQueryPath(xt,$t.path)]}}function __PRIVATE_toQueryTarget(xt,$t){const Ct={structuredQuery:{}},kt=$t.path;let Mt;$t.collectionGroup!==null?(Mt=kt,Ct.structuredQuery.from=[{collectionId:$t.collectionGroup,allDescendants:!0}]):(Mt=kt.popLast(),Ct.structuredQuery.from=[{collectionId:kt.lastSegment()}]),Ct.parent=__PRIVATE_toQueryPath(xt,Mt);const Ft=function(zt){if(zt.length!==0)return __PRIVATE_toFilter(CompositeFilter.create(zt,"and"))}($t.filters);Ft&&(Ct.structuredQuery.where=Ft);const jt=function(zt){if(zt.length!==0)return zt.map(Ht=>function(qt){return{field:__PRIVATE_toFieldPathReference(qt.field),direction:__PRIVATE_toDirection(qt.dir)}}(Ht))}($t.orderBy);jt&&(Ct.structuredQuery.orderBy=jt);const Bt=__PRIVATE_toInt32Proto(xt,$t.limit);return Bt!==null&&(Ct.structuredQuery.limit=Bt),$t.startAt&&(Ct.structuredQuery.startAt=function(zt){return{before:zt.inclusive,values:zt.position}}($t.startAt)),$t.endAt&&(Ct.structuredQuery.endAt=function(zt){return{before:!zt.inclusive,values:zt.position}}($t.endAt)),{_t:Ct,parent:Mt}}function __PRIVATE_convertQueryTargetToQuery(xt){let $t=__PRIVATE_fromQueryPath(xt.parent);const Ct=xt.structuredQuery,kt=Ct.from?Ct.from.length:0;let Mt=null;if(kt>0){__PRIVATE_hardAssert(kt===1);const Ht=Ct.from[0];Ht.allDescendants?Mt=Ht.collectionId:$t=$t.child(Ht.collectionId)}let Ft=[];Ct.where&&(Ft=function(Gt){const qt=__PRIVATE_fromFilter(Gt);return qt instanceof CompositeFilter&&__PRIVATE_compositeFilterIsFlatConjunction(qt)?qt.getFilters():[qt]}(Ct.where));let jt=[];Ct.orderBy&&(jt=function(Gt){return Gt.map(qt=>function(Yt){return new OrderBy(__PRIVATE_fromFieldPathReference(Yt.field),function(Xt){switch(Xt){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(Yt.direction))}(qt))}(Ct.orderBy));let Bt=null;Ct.limit&&(Bt=function(Gt){let qt;return qt=typeof Gt=="object"?Gt.value:Gt,__PRIVATE_isNullOrUndefined(qt)?null:qt}(Ct.limit));let Vt=null;Ct.startAt&&(Vt=function(Gt){const qt=!!Gt.before,Wt=Gt.values||[];return new Bound$2(Wt,qt)}(Ct.startAt));let zt=null;return Ct.endAt&&(zt=function(Gt){const qt=!Gt.before,Wt=Gt.values||[];return new Bound$2(Wt,qt)}(Ct.endAt)),__PRIVATE_newQuery($t,Mt,jt,Ft,Bt,"F",Vt,zt)}function __PRIVATE_toListenRequestLabels(xt,$t){const Ct=function(Mt){switch(Mt){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fail()}}($t.purpose);return Ct==null?null:{"goog-listen-tags":Ct}}function __PRIVATE_fromFilter(xt){return xt.unaryFilter!==void 0?function(Ct){switch(Ct.unaryFilter.op){case"IS_NAN":const kt=__PRIVATE_fromFieldPathReference(Ct.unaryFilter.field);return FieldFilter.create(kt,"==",{doubleValue:NaN});case"IS_NULL":const Mt=__PRIVATE_fromFieldPathReference(Ct.unaryFilter.field);return FieldFilter.create(Mt,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const Ft=__PRIVATE_fromFieldPathReference(Ct.unaryFilter.field);return FieldFilter.create(Ft,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const jt=__PRIVATE_fromFieldPathReference(Ct.unaryFilter.field);return FieldFilter.create(jt,"!=",{nullValue:"NULL_VALUE"});default:return fail()}}(xt):xt.fieldFilter!==void 0?function(Ct){return FieldFilter.create(__PRIVATE_fromFieldPathReference(Ct.fieldFilter.field),function(Mt){switch(Mt){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return fail()}}(Ct.fieldFilter.op),Ct.fieldFilter.value)}(xt):xt.compositeFilter!==void 0?function(Ct){return CompositeFilter.create(Ct.compositeFilter.filters.map(kt=>__PRIVATE_fromFilter(kt)),function(Mt){switch(Mt){case"AND":return"and";case"OR":return"or";default:return fail()}}(Ct.compositeFilter.op))}(xt):fail()}function __PRIVATE_toDirection(xt){return Ie[xt]}function __PRIVATE_toOperatorName(xt){return Te[xt]}function __PRIVATE_toCompositeOperatorName(xt){return Ee[xt]}function __PRIVATE_toFieldPathReference(xt){return{fieldPath:xt.canonicalString()}}function __PRIVATE_fromFieldPathReference(xt){return FieldPath$1.fromServerFormat(xt.fieldPath)}function __PRIVATE_toFilter(xt){return xt instanceof FieldFilter?function(Ct){if(Ct.op==="=="){if(__PRIVATE_isNanValue(Ct.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(Ct.field),op:"IS_NAN"}};if(__PRIVATE_isNullValue(Ct.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(Ct.field),op:"IS_NULL"}}}else if(Ct.op==="!="){if(__PRIVATE_isNanValue(Ct.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(Ct.field),op:"IS_NOT_NAN"}};if(__PRIVATE_isNullValue(Ct.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(Ct.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:__PRIVATE_toFieldPathReference(Ct.field),op:__PRIVATE_toOperatorName(Ct.op),value:Ct.value}}}(xt):xt instanceof CompositeFilter?function(Ct){const kt=Ct.getFilters().map(Mt=>__PRIVATE_toFilter(Mt));return kt.length===1?kt[0]:{compositeFilter:{op:__PRIVATE_toCompositeOperatorName(Ct.op),filters:kt}}}(xt):fail()}function __PRIVATE_toDocumentMask(xt){const $t=[];return xt.fields.forEach(Ct=>$t.push(Ct.canonicalString())),{fieldPaths:$t}}function __PRIVATE_isValidResourceName(xt){return xt.length>=4&&xt.get(0)==="projects"&&xt.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TargetData{constructor($t,Ct,kt,Mt,Ft=SnapshotVersion.min(),jt=SnapshotVersion.min(),Bt=ByteString.EMPTY_BYTE_STRING,Vt=null){this.target=$t,this.targetId=Ct,this.purpose=kt,this.sequenceNumber=Mt,this.snapshotVersion=Ft,this.lastLimboFreeSnapshotVersion=jt,this.resumeToken=Bt,this.expectedCount=Vt}withSequenceNumber($t){return new TargetData(this.target,this.targetId,this.purpose,$t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken($t,Ct){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,Ct,this.lastLimboFreeSnapshotVersion,$t,null)}withExpectedCount($t){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,$t)}withLastLimboFreeSnapshotVersion($t){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,$t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalSerializer{constructor($t){this.ct=$t}}function __PRIVATE_fromBundledQuery(xt){const $t=__PRIVATE_convertQueryTargetToQuery({parent:xt.parent,structuredQuery:xt.structuredQuery});return xt.limitType==="LAST"?__PRIVATE_queryWithLimit($t,$t.limit,"L"):$t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryIndexManager{constructor(){this._n=new __PRIVATE_MemoryCollectionParentIndex}addToCollectionParentIndex($t,Ct){return this._n.add(Ct),PersistencePromise.resolve()}getCollectionParents($t,Ct){return PersistencePromise.resolve(this._n.getEntries(Ct))}addFieldIndex($t,Ct){return PersistencePromise.resolve()}deleteFieldIndex($t,Ct){return PersistencePromise.resolve()}deleteAllFieldIndexes($t){return PersistencePromise.resolve()}createTargetIndexes($t,Ct){return PersistencePromise.resolve()}getDocumentsMatchingTarget($t,Ct){return PersistencePromise.resolve(null)}getIndexType($t,Ct){return PersistencePromise.resolve(0)}getFieldIndexes($t,Ct){return PersistencePromise.resolve([])}getNextCollectionGroupToUpdate($t){return PersistencePromise.resolve(null)}getMinOffset($t,Ct){return PersistencePromise.resolve(IndexOffset.min())}getMinOffsetFromCollectionGroup($t,Ct){return PersistencePromise.resolve(IndexOffset.min())}updateCollectionGroup($t,Ct,kt){return PersistencePromise.resolve()}updateIndexEntries($t,Ct){return PersistencePromise.resolve()}}class __PRIVATE_MemoryCollectionParentIndex{constructor(){this.index={}}add($t){const Ct=$t.lastSegment(),kt=$t.popLast(),Mt=this.index[Ct]||new SortedSet(ResourcePath.comparator),Ft=!Mt.has(kt);return this.index[Ct]=Mt.add(kt),Ft}has($t){const Ct=$t.lastSegment(),kt=$t.popLast(),Mt=this.index[Ct];return Mt&&Mt.has(kt)}getEntries($t){return(this.index[$t]||new SortedSet(ResourcePath.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_TargetIdGenerator{constructor($t){this.On=$t}next(){return this.On+=2,this.On}static Nn(){return new __PRIVATE_TargetIdGenerator(0)}static Ln(){return new __PRIVATE_TargetIdGenerator(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RemoteDocumentChangeBuffer{constructor(){this.changes=new ObjectMap($t=>$t.toString(),($t,Ct)=>$t.isEqual(Ct)),this.changesApplied=!1}addEntry($t){this.assertNotApplied(),this.changes.set($t.key,$t)}removeEntry($t,Ct){this.assertNotApplied(),this.changes.set($t,MutableDocument.newInvalidDocument($t).setReadTime(Ct))}getEntry($t,Ct){this.assertNotApplied();const kt=this.changes.get(Ct);return kt!==void 0?PersistencePromise.resolve(kt):this.getFromCache($t,Ct)}getEntries($t,Ct){return this.getAllFromCache($t,Ct)}apply($t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges($t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OverlayedDocument{constructor($t,Ct){this.overlayedDocument=$t,this.mutatedFields=Ct}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LocalDocumentsView{constructor($t,Ct,kt,Mt){this.remoteDocumentCache=$t,this.mutationQueue=Ct,this.documentOverlayCache=kt,this.indexManager=Mt}getDocument($t,Ct){let kt=null;return this.documentOverlayCache.getOverlay($t,Ct).next(Mt=>(kt=Mt,this.remoteDocumentCache.getEntry($t,Ct))).next(Mt=>(kt!==null&&__PRIVATE_mutationApplyToLocalView(kt.mutation,Mt,FieldMask.empty(),Timestamp.now()),Mt))}getDocuments($t,Ct){return this.remoteDocumentCache.getEntries($t,Ct).next(kt=>this.getLocalViewOfDocuments($t,kt,__PRIVATE_documentKeySet()).next(()=>kt))}getLocalViewOfDocuments($t,Ct,kt=__PRIVATE_documentKeySet()){const Mt=__PRIVATE_newOverlayMap();return this.populateOverlays($t,Mt,Ct).next(()=>this.computeViews($t,Ct,Mt,kt).next(Ft=>{let jt=documentMap();return Ft.forEach((Bt,Vt)=>{jt=jt.insert(Bt,Vt.overlayedDocument)}),jt}))}getOverlayedDocuments($t,Ct){const kt=__PRIVATE_newOverlayMap();return this.populateOverlays($t,kt,Ct).next(()=>this.computeViews($t,Ct,kt,__PRIVATE_documentKeySet()))}populateOverlays($t,Ct,kt){const Mt=[];return kt.forEach(Ft=>{Ct.has(Ft)||Mt.push(Ft)}),this.documentOverlayCache.getOverlays($t,Mt).next(Ft=>{Ft.forEach((jt,Bt)=>{Ct.set(jt,Bt)})})}computeViews($t,Ct,kt,Mt){let Ft=__PRIVATE_mutableDocumentMap();const jt=__PRIVATE_newDocumentKeyMap(),Bt=function(){return __PRIVATE_newDocumentKeyMap()}();return Ct.forEach((Vt,zt)=>{const Ht=kt.get(zt.key);Mt.has(zt.key)&&(Ht===void 0||Ht.mutation instanceof __PRIVATE_PatchMutation)?Ft=Ft.insert(zt.key,zt):Ht!==void 0?(jt.set(zt.key,Ht.mutation.getFieldMask()),__PRIVATE_mutationApplyToLocalView(Ht.mutation,zt,Ht.mutation.getFieldMask(),Timestamp.now())):jt.set(zt.key,FieldMask.empty())}),this.recalculateAndSaveOverlays($t,Ft).next(Vt=>(Vt.forEach((zt,Ht)=>jt.set(zt,Ht)),Ct.forEach((zt,Ht)=>{var Gt;return Bt.set(zt,new OverlayedDocument(Ht,(Gt=jt.get(zt))!==null&&Gt!==void 0?Gt:null))}),Bt))}recalculateAndSaveOverlays($t,Ct){const kt=__PRIVATE_newDocumentKeyMap();let Mt=new SortedMap((jt,Bt)=>jt-Bt),Ft=__PRIVATE_documentKeySet();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys($t,Ct).next(jt=>{for(const Bt of jt)Bt.keys().forEach(Vt=>{const zt=Ct.get(Vt);if(zt===null)return;let Ht=kt.get(Vt)||FieldMask.empty();Ht=Bt.applyToLocalView(zt,Ht),kt.set(Vt,Ht);const Gt=(Mt.get(Bt.batchId)||__PRIVATE_documentKeySet()).add(Vt);Mt=Mt.insert(Bt.batchId,Gt)})}).next(()=>{const jt=[],Bt=Mt.getReverseIterator();for(;Bt.hasNext();){const Vt=Bt.getNext(),zt=Vt.key,Ht=Vt.value,Gt=__PRIVATE_newMutationMap();Ht.forEach(qt=>{if(!Ft.has(qt)){const Wt=__PRIVATE_calculateOverlayMutation(Ct.get(qt),kt.get(qt));Wt!==null&&Gt.set(qt,Wt),Ft=Ft.add(qt)}}),jt.push(this.documentOverlayCache.saveOverlays($t,zt,Gt))}return PersistencePromise.waitFor(jt)}).next(()=>kt)}recalculateAndSaveOverlaysForDocumentKeys($t,Ct){return this.remoteDocumentCache.getEntries($t,Ct).next(kt=>this.recalculateAndSaveOverlays($t,kt))}getDocumentsMatchingQuery($t,Ct,kt,Mt){return function(jt){return DocumentKey.isDocumentKey(jt.path)&&jt.collectionGroup===null&&jt.filters.length===0}(Ct)?this.getDocumentsMatchingDocumentQuery($t,Ct.path):__PRIVATE_isCollectionGroupQuery(Ct)?this.getDocumentsMatchingCollectionGroupQuery($t,Ct,kt,Mt):this.getDocumentsMatchingCollectionQuery($t,Ct,kt,Mt)}getNextDocuments($t,Ct,kt,Mt){return this.remoteDocumentCache.getAllFromCollectionGroup($t,Ct,kt,Mt).next(Ft=>{const jt=Mt-Ft.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup($t,Ct,kt.largestBatchId,Mt-Ft.size):PersistencePromise.resolve(__PRIVATE_newOverlayMap());let Bt=-1,Vt=Ft;return jt.next(zt=>PersistencePromise.forEach(zt,(Ht,Gt)=>(Bt<Gt.largestBatchId&&(Bt=Gt.largestBatchId),Ft.get(Ht)?PersistencePromise.resolve():this.remoteDocumentCache.getEntry($t,Ht).next(qt=>{Vt=Vt.insert(Ht,qt)}))).next(()=>this.populateOverlays($t,zt,Ft)).next(()=>this.computeViews($t,Vt,zt,__PRIVATE_documentKeySet())).next(Ht=>({batchId:Bt,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(Ht)})))})}getDocumentsMatchingDocumentQuery($t,Ct){return this.getDocument($t,new DocumentKey(Ct)).next(kt=>{let Mt=documentMap();return kt.isFoundDocument()&&(Mt=Mt.insert(kt.key,kt)),Mt})}getDocumentsMatchingCollectionGroupQuery($t,Ct,kt,Mt){const Ft=Ct.collectionGroup;let jt=documentMap();return this.indexManager.getCollectionParents($t,Ft).next(Bt=>PersistencePromise.forEach(Bt,Vt=>{const zt=function(Gt,qt){return new __PRIVATE_QueryImpl(qt,null,Gt.explicitOrderBy.slice(),Gt.filters.slice(),Gt.limit,Gt.limitType,Gt.startAt,Gt.endAt)}(Ct,Vt.child(Ft));return this.getDocumentsMatchingCollectionQuery($t,zt,kt,Mt).next(Ht=>{Ht.forEach((Gt,qt)=>{jt=jt.insert(Gt,qt)})})}).next(()=>jt))}getDocumentsMatchingCollectionQuery($t,Ct,kt,Mt){let Ft;return this.documentOverlayCache.getOverlaysForCollection($t,Ct.path,kt.largestBatchId).next(jt=>(Ft=jt,this.remoteDocumentCache.getDocumentsMatchingQuery($t,Ct,kt,Ft,Mt))).next(jt=>{Ft.forEach((Vt,zt)=>{const Ht=zt.getKey();jt.get(Ht)===null&&(jt=jt.insert(Ht,MutableDocument.newInvalidDocument(Ht)))});let Bt=documentMap();return jt.forEach((Vt,zt)=>{const Ht=Ft.get(Vt);Ht!==void 0&&__PRIVATE_mutationApplyToLocalView(Ht.mutation,zt,FieldMask.empty(),Timestamp.now()),__PRIVATE_queryMatches(Ct,zt)&&(Bt=Bt.insert(Vt,zt))}),Bt})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryBundleCache{constructor($t){this.serializer=$t,this.cr=new Map,this.lr=new Map}getBundleMetadata($t,Ct){return PersistencePromise.resolve(this.cr.get(Ct))}saveBundleMetadata($t,Ct){return this.cr.set(Ct.id,function(Mt){return{id:Mt.id,version:Mt.version,createTime:__PRIVATE_fromVersion(Mt.createTime)}}(Ct)),PersistencePromise.resolve()}getNamedQuery($t,Ct){return PersistencePromise.resolve(this.lr.get(Ct))}saveNamedQuery($t,Ct){return this.lr.set(Ct.name,function(Mt){return{name:Mt.name,query:__PRIVATE_fromBundledQuery(Mt.bundledQuery),readTime:__PRIVATE_fromVersion(Mt.readTime)}}(Ct)),PersistencePromise.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryDocumentOverlayCache{constructor(){this.overlays=new SortedMap(DocumentKey.comparator),this.hr=new Map}getOverlay($t,Ct){return PersistencePromise.resolve(this.overlays.get(Ct))}getOverlays($t,Ct){const kt=__PRIVATE_newOverlayMap();return PersistencePromise.forEach(Ct,Mt=>this.getOverlay($t,Mt).next(Ft=>{Ft!==null&&kt.set(Mt,Ft)})).next(()=>kt)}saveOverlays($t,Ct,kt){return kt.forEach((Mt,Ft)=>{this.ht($t,Ct,Ft)}),PersistencePromise.resolve()}removeOverlaysForBatchId($t,Ct,kt){const Mt=this.hr.get(kt);return Mt!==void 0&&(Mt.forEach(Ft=>this.overlays=this.overlays.remove(Ft)),this.hr.delete(kt)),PersistencePromise.resolve()}getOverlaysForCollection($t,Ct,kt){const Mt=__PRIVATE_newOverlayMap(),Ft=Ct.length+1,jt=new DocumentKey(Ct.child("")),Bt=this.overlays.getIteratorFrom(jt);for(;Bt.hasNext();){const Vt=Bt.getNext().value,zt=Vt.getKey();if(!Ct.isPrefixOf(zt.path))break;zt.path.length===Ft&&Vt.largestBatchId>kt&&Mt.set(Vt.getKey(),Vt)}return PersistencePromise.resolve(Mt)}getOverlaysForCollectionGroup($t,Ct,kt,Mt){let Ft=new SortedMap((zt,Ht)=>zt-Ht);const jt=this.overlays.getIterator();for(;jt.hasNext();){const zt=jt.getNext().value;if(zt.getKey().getCollectionGroup()===Ct&&zt.largestBatchId>kt){let Ht=Ft.get(zt.largestBatchId);Ht===null&&(Ht=__PRIVATE_newOverlayMap(),Ft=Ft.insert(zt.largestBatchId,Ht)),Ht.set(zt.getKey(),zt)}}const Bt=__PRIVATE_newOverlayMap(),Vt=Ft.getIterator();for(;Vt.hasNext()&&(Vt.getNext().value.forEach((zt,Ht)=>Bt.set(zt,Ht)),!(Bt.size()>=Mt)););return PersistencePromise.resolve(Bt)}ht($t,Ct,kt){const Mt=this.overlays.get(kt.key);if(Mt!==null){const jt=this.hr.get(Mt.largestBatchId).delete(kt.key);this.hr.set(Mt.largestBatchId,jt)}this.overlays=this.overlays.insert(kt.key,new Overlay(Ct,kt));let Ft=this.hr.get(Ct);Ft===void 0&&(Ft=__PRIVATE_documentKeySet(),this.hr.set(Ct,Ft)),this.hr.set(Ct,Ft.add(kt.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ReferenceSet{constructor(){this.Pr=new SortedSet(__PRIVATE_DocReference.Ir),this.Tr=new SortedSet(__PRIVATE_DocReference.Er)}isEmpty(){return this.Pr.isEmpty()}addReference($t,Ct){const kt=new __PRIVATE_DocReference($t,Ct);this.Pr=this.Pr.add(kt),this.Tr=this.Tr.add(kt)}dr($t,Ct){$t.forEach(kt=>this.addReference(kt,Ct))}removeReference($t,Ct){this.Ar(new __PRIVATE_DocReference($t,Ct))}Rr($t,Ct){$t.forEach(kt=>this.removeReference(kt,Ct))}Vr($t){const Ct=new DocumentKey(new ResourcePath([])),kt=new __PRIVATE_DocReference(Ct,$t),Mt=new __PRIVATE_DocReference(Ct,$t+1),Ft=[];return this.Tr.forEachInRange([kt,Mt],jt=>{this.Ar(jt),Ft.push(jt.key)}),Ft}mr(){this.Pr.forEach($t=>this.Ar($t))}Ar($t){this.Pr=this.Pr.delete($t),this.Tr=this.Tr.delete($t)}gr($t){const Ct=new DocumentKey(new ResourcePath([])),kt=new __PRIVATE_DocReference(Ct,$t),Mt=new __PRIVATE_DocReference(Ct,$t+1);let Ft=__PRIVATE_documentKeySet();return this.Tr.forEachInRange([kt,Mt],jt=>{Ft=Ft.add(jt.key)}),Ft}containsKey($t){const Ct=new __PRIVATE_DocReference($t,0),kt=this.Pr.firstAfterOrEqual(Ct);return kt!==null&&$t.isEqual(kt.key)}}class __PRIVATE_DocReference{constructor($t,Ct){this.key=$t,this.pr=Ct}static Ir($t,Ct){return DocumentKey.comparator($t.key,Ct.key)||__PRIVATE_primitiveComparator($t.pr,Ct.pr)}static Er($t,Ct){return __PRIVATE_primitiveComparator($t.pr,Ct.pr)||DocumentKey.comparator($t.key,Ct.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryMutationQueue{constructor($t,Ct){this.indexManager=$t,this.referenceDelegate=Ct,this.mutationQueue=[],this.yr=1,this.wr=new SortedSet(__PRIVATE_DocReference.Ir)}checkEmpty($t){return PersistencePromise.resolve(this.mutationQueue.length===0)}addMutationBatch($t,Ct,kt,Mt){const Ft=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const jt=new MutationBatch(Ft,Ct,kt,Mt);this.mutationQueue.push(jt);for(const Bt of Mt)this.wr=this.wr.add(new __PRIVATE_DocReference(Bt.key,Ft)),this.indexManager.addToCollectionParentIndex($t,Bt.key.path.popLast());return PersistencePromise.resolve(jt)}lookupMutationBatch($t,Ct){return PersistencePromise.resolve(this.Sr(Ct))}getNextMutationBatchAfterBatchId($t,Ct){const kt=Ct+1,Mt=this.br(kt),Ft=Mt<0?0:Mt;return PersistencePromise.resolve(this.mutationQueue.length>Ft?this.mutationQueue[Ft]:null)}getHighestUnacknowledgedBatchId(){return PersistencePromise.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches($t){return PersistencePromise.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey($t,Ct){const kt=new __PRIVATE_DocReference(Ct,0),Mt=new __PRIVATE_DocReference(Ct,Number.POSITIVE_INFINITY),Ft=[];return this.wr.forEachInRange([kt,Mt],jt=>{const Bt=this.Sr(jt.pr);Ft.push(Bt)}),PersistencePromise.resolve(Ft)}getAllMutationBatchesAffectingDocumentKeys($t,Ct){let kt=new SortedSet(__PRIVATE_primitiveComparator);return Ct.forEach(Mt=>{const Ft=new __PRIVATE_DocReference(Mt,0),jt=new __PRIVATE_DocReference(Mt,Number.POSITIVE_INFINITY);this.wr.forEachInRange([Ft,jt],Bt=>{kt=kt.add(Bt.pr)})}),PersistencePromise.resolve(this.Dr(kt))}getAllMutationBatchesAffectingQuery($t,Ct){const kt=Ct.path,Mt=kt.length+1;let Ft=kt;DocumentKey.isDocumentKey(Ft)||(Ft=Ft.child(""));const jt=new __PRIVATE_DocReference(new DocumentKey(Ft),0);let Bt=new SortedSet(__PRIVATE_primitiveComparator);return this.wr.forEachWhile(Vt=>{const zt=Vt.key.path;return!!kt.isPrefixOf(zt)&&(zt.length===Mt&&(Bt=Bt.add(Vt.pr)),!0)},jt),PersistencePromise.resolve(this.Dr(Bt))}Dr($t){const Ct=[];return $t.forEach(kt=>{const Mt=this.Sr(kt);Mt!==null&&Ct.push(Mt)}),Ct}removeMutationBatch($t,Ct){__PRIVATE_hardAssert(this.Cr(Ct.batchId,"removed")===0),this.mutationQueue.shift();let kt=this.wr;return PersistencePromise.forEach(Ct.mutations,Mt=>{const Ft=new __PRIVATE_DocReference(Mt.key,Ct.batchId);return kt=kt.delete(Ft),this.referenceDelegate.markPotentiallyOrphaned($t,Mt.key)}).next(()=>{this.wr=kt})}Mn($t){}containsKey($t,Ct){const kt=new __PRIVATE_DocReference(Ct,0),Mt=this.wr.firstAfterOrEqual(kt);return PersistencePromise.resolve(Ct.isEqual(Mt&&Mt.key))}performConsistencyCheck($t){return this.mutationQueue.length,PersistencePromise.resolve()}Cr($t,Ct){return this.br($t)}br($t){return this.mutationQueue.length===0?0:$t-this.mutationQueue[0].batchId}Sr($t){const Ct=this.br($t);return Ct<0||Ct>=this.mutationQueue.length?null:this.mutationQueue[Ct]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryRemoteDocumentCacheImpl{constructor($t){this.vr=$t,this.docs=function(){return new SortedMap(DocumentKey.comparator)}(),this.size=0}setIndexManager($t){this.indexManager=$t}addEntry($t,Ct){const kt=Ct.key,Mt=this.docs.get(kt),Ft=Mt?Mt.size:0,jt=this.vr(Ct);return this.docs=this.docs.insert(kt,{document:Ct.mutableCopy(),size:jt}),this.size+=jt-Ft,this.indexManager.addToCollectionParentIndex($t,kt.path.popLast())}removeEntry($t){const Ct=this.docs.get($t);Ct&&(this.docs=this.docs.remove($t),this.size-=Ct.size)}getEntry($t,Ct){const kt=this.docs.get(Ct);return PersistencePromise.resolve(kt?kt.document.mutableCopy():MutableDocument.newInvalidDocument(Ct))}getEntries($t,Ct){let kt=__PRIVATE_mutableDocumentMap();return Ct.forEach(Mt=>{const Ft=this.docs.get(Mt);kt=kt.insert(Mt,Ft?Ft.document.mutableCopy():MutableDocument.newInvalidDocument(Mt))}),PersistencePromise.resolve(kt)}getDocumentsMatchingQuery($t,Ct,kt,Mt){let Ft=__PRIVATE_mutableDocumentMap();const jt=Ct.path,Bt=new DocumentKey(jt.child("")),Vt=this.docs.getIteratorFrom(Bt);for(;Vt.hasNext();){const{key:zt,value:{document:Ht}}=Vt.getNext();if(!jt.isPrefixOf(zt.path))break;zt.path.length>jt.length+1||__PRIVATE_indexOffsetComparator(__PRIVATE_newIndexOffsetFromDocument(Ht),kt)<=0||(Mt.has(Ht.key)||__PRIVATE_queryMatches(Ct,Ht))&&(Ft=Ft.insert(Ht.key,Ht.mutableCopy()))}return PersistencePromise.resolve(Ft)}getAllFromCollectionGroup($t,Ct,kt,Mt){fail()}Fr($t,Ct){return PersistencePromise.forEach(this.docs,kt=>Ct(kt))}newChangeBuffer($t){return new __PRIVATE_MemoryRemoteDocumentChangeBuffer(this)}getSize($t){return PersistencePromise.resolve(this.size)}}class __PRIVATE_MemoryRemoteDocumentChangeBuffer extends RemoteDocumentChangeBuffer{constructor($t){super(),this.ar=$t}applyChanges($t){const Ct=[];return this.changes.forEach((kt,Mt)=>{Mt.isValidDocument()?Ct.push(this.ar.addEntry($t,Mt)):this.ar.removeEntry(kt)}),PersistencePromise.waitFor(Ct)}getFromCache($t,Ct){return this.ar.getEntry($t,Ct)}getAllFromCache($t,Ct){return this.ar.getEntries($t,Ct)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryTargetCache{constructor($t){this.persistence=$t,this.Mr=new ObjectMap(Ct=>__PRIVATE_canonifyTarget(Ct),__PRIVATE_targetEquals),this.lastRemoteSnapshotVersion=SnapshotVersion.min(),this.highestTargetId=0,this.Or=0,this.Nr=new __PRIVATE_ReferenceSet,this.targetCount=0,this.Lr=__PRIVATE_TargetIdGenerator.Nn()}forEachTarget($t,Ct){return this.Mr.forEach((kt,Mt)=>Ct(Mt)),PersistencePromise.resolve()}getLastRemoteSnapshotVersion($t){return PersistencePromise.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber($t){return PersistencePromise.resolve(this.Or)}allocateTargetId($t){return this.highestTargetId=this.Lr.next(),PersistencePromise.resolve(this.highestTargetId)}setTargetsMetadata($t,Ct,kt){return kt&&(this.lastRemoteSnapshotVersion=kt),Ct>this.Or&&(this.Or=Ct),PersistencePromise.resolve()}qn($t){this.Mr.set($t.target,$t);const Ct=$t.targetId;Ct>this.highestTargetId&&(this.Lr=new __PRIVATE_TargetIdGenerator(Ct),this.highestTargetId=Ct),$t.sequenceNumber>this.Or&&(this.Or=$t.sequenceNumber)}addTargetData($t,Ct){return this.qn(Ct),this.targetCount+=1,PersistencePromise.resolve()}updateTargetData($t,Ct){return this.qn(Ct),PersistencePromise.resolve()}removeTargetData($t,Ct){return this.Mr.delete(Ct.target),this.Nr.Vr(Ct.targetId),this.targetCount-=1,PersistencePromise.resolve()}removeTargets($t,Ct,kt){let Mt=0;const Ft=[];return this.Mr.forEach((jt,Bt)=>{Bt.sequenceNumber<=Ct&&kt.get(Bt.targetId)===null&&(this.Mr.delete(jt),Ft.push(this.removeMatchingKeysForTargetId($t,Bt.targetId)),Mt++)}),PersistencePromise.waitFor(Ft).next(()=>Mt)}getTargetCount($t){return PersistencePromise.resolve(this.targetCount)}getTargetData($t,Ct){const kt=this.Mr.get(Ct)||null;return PersistencePromise.resolve(kt)}addMatchingKeys($t,Ct,kt){return this.Nr.dr(Ct,kt),PersistencePromise.resolve()}removeMatchingKeys($t,Ct,kt){this.Nr.Rr(Ct,kt);const Mt=this.persistence.referenceDelegate,Ft=[];return Mt&&Ct.forEach(jt=>{Ft.push(Mt.markPotentiallyOrphaned($t,jt))}),PersistencePromise.waitFor(Ft)}removeMatchingKeysForTargetId($t,Ct){return this.Nr.Vr(Ct),PersistencePromise.resolve()}getMatchingKeysForTargetId($t,Ct){const kt=this.Nr.gr(Ct);return PersistencePromise.resolve(kt)}containsKey($t,Ct){return PersistencePromise.resolve(this.Nr.containsKey(Ct))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryPersistence{constructor($t,Ct){this.Br={},this.overlays={},this.kr=new __PRIVATE_ListenSequence(0),this.qr=!1,this.qr=!0,this.referenceDelegate=$t(this),this.Qr=new __PRIVATE_MemoryTargetCache(this),this.indexManager=new __PRIVATE_MemoryIndexManager,this.remoteDocumentCache=function(Mt){return new __PRIVATE_MemoryRemoteDocumentCacheImpl(Mt)}(kt=>this.referenceDelegate.Kr(kt)),this.serializer=new __PRIVATE_LocalSerializer(Ct),this.$r=new __PRIVATE_MemoryBundleCache(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager($t){return this.indexManager}getDocumentOverlayCache($t){let Ct=this.overlays[$t.toKey()];return Ct||(Ct=new __PRIVATE_MemoryDocumentOverlayCache,this.overlays[$t.toKey()]=Ct),Ct}getMutationQueue($t,Ct){let kt=this.Br[$t.toKey()];return kt||(kt=new __PRIVATE_MemoryMutationQueue(Ct,this.referenceDelegate),this.Br[$t.toKey()]=kt),kt}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction($t,Ct,kt){__PRIVATE_logDebug("MemoryPersistence","Starting transaction:",$t);const Mt=new __PRIVATE_MemoryTransaction(this.kr.next());return this.referenceDelegate.Ur(),kt(Mt).next(Ft=>this.referenceDelegate.Wr(Mt).next(()=>Ft)).toPromise().then(Ft=>(Mt.raiseOnCommittedEvent(),Ft))}Gr($t,Ct){return PersistencePromise.or(Object.values(this.Br).map(kt=>()=>kt.containsKey($t,Ct)))}}class __PRIVATE_MemoryTransaction extends PersistenceTransaction{constructor($t){super(),this.currentSequenceNumber=$t}}class __PRIVATE_MemoryEagerDelegate{constructor($t){this.persistence=$t,this.zr=new __PRIVATE_ReferenceSet,this.jr=null}static Hr($t){return new __PRIVATE_MemoryEagerDelegate($t)}get Jr(){if(this.jr)return this.jr;throw fail()}addReference($t,Ct,kt){return this.zr.addReference(kt,Ct),this.Jr.delete(kt.toString()),PersistencePromise.resolve()}removeReference($t,Ct,kt){return this.zr.removeReference(kt,Ct),this.Jr.add(kt.toString()),PersistencePromise.resolve()}markPotentiallyOrphaned($t,Ct){return this.Jr.add(Ct.toString()),PersistencePromise.resolve()}removeTarget($t,Ct){this.zr.Vr(Ct.targetId).forEach(Mt=>this.Jr.add(Mt.toString()));const kt=this.persistence.getTargetCache();return kt.getMatchingKeysForTargetId($t,Ct.targetId).next(Mt=>{Mt.forEach(Ft=>this.Jr.add(Ft.toString()))}).next(()=>kt.removeTargetData($t,Ct))}Ur(){this.jr=new Set}Wr($t){const Ct=this.persistence.getRemoteDocumentCache().newChangeBuffer();return PersistencePromise.forEach(this.Jr,kt=>{const Mt=DocumentKey.fromPath(kt);return this.Yr($t,Mt).next(Ft=>{Ft||Ct.removeEntry(Mt,SnapshotVersion.min())})}).next(()=>(this.jr=null,Ct.apply($t)))}updateLimboDocument($t,Ct){return this.Yr($t,Ct).next(kt=>{kt?this.Jr.delete(Ct.toString()):this.Jr.add(Ct.toString())})}Kr($t){return 0}Yr($t,Ct){return PersistencePromise.or([()=>PersistencePromise.resolve(this.zr.containsKey(Ct)),()=>this.persistence.getTargetCache().containsKey($t,Ct),()=>this.persistence.Gr($t,Ct)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalViewChanges{constructor($t,Ct,kt,Mt){this.targetId=$t,this.fromCache=Ct,this.qi=kt,this.Qi=Mt}static Ki($t,Ct){let kt=__PRIVATE_documentKeySet(),Mt=__PRIVATE_documentKeySet();for(const Ft of Ct.docChanges)switch(Ft.type){case 0:kt=kt.add(Ft.doc.key);break;case 1:Mt=Mt.add(Ft.doc.key)}return new __PRIVATE_LocalViewChanges($t,Ct.fromCache,kt,Mt)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryContext{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount($t){this._documentReadCount+=$t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryEngine{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return isSafari()?8:__PRIVATE_getAndroidVersion(getUA())>0?6:4}()}initialize($t,Ct){this.zi=$t,this.indexManager=Ct,this.$i=!0}getDocumentsMatchingQuery($t,Ct,kt,Mt){const Ft={result:null};return this.ji($t,Ct).next(jt=>{Ft.result=jt}).next(()=>{if(!Ft.result)return this.Hi($t,Ct,Mt,kt).next(jt=>{Ft.result=jt})}).next(()=>{if(Ft.result)return;const jt=new QueryContext;return this.Ji($t,Ct,jt).next(Bt=>{if(Ft.result=Bt,this.Ui)return this.Yi($t,Ct,jt,Bt.size)})}).next(()=>Ft.result)}Yi($t,Ct,kt,Mt){return kt.documentReadCount<this.Wi?(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","SDK will not create cache indexes for query:",__PRIVATE_stringifyQuery(Ct),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),PersistencePromise.resolve()):(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Query:",__PRIVATE_stringifyQuery(Ct),"scans",kt.documentReadCount,"local documents and returns",Mt,"documents as results."),kt.documentReadCount>this.Gi*Mt?(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","The SDK decides to create cache indexes for query:",__PRIVATE_stringifyQuery(Ct),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes($t,__PRIVATE_queryToTarget(Ct))):PersistencePromise.resolve())}ji($t,Ct){if(__PRIVATE_queryMatchesAllDocuments(Ct))return PersistencePromise.resolve(null);let kt=__PRIVATE_queryToTarget(Ct);return this.indexManager.getIndexType($t,kt).next(Mt=>Mt===0?null:(Ct.limit!==null&&Mt===1&&(Ct=__PRIVATE_queryWithLimit(Ct,null,"F"),kt=__PRIVATE_queryToTarget(Ct)),this.indexManager.getDocumentsMatchingTarget($t,kt).next(Ft=>{const jt=__PRIVATE_documentKeySet(...Ft);return this.zi.getDocuments($t,jt).next(Bt=>this.indexManager.getMinOffset($t,kt).next(Vt=>{const zt=this.Zi(Ct,Bt);return this.Xi(Ct,zt,jt,Vt.readTime)?this.ji($t,__PRIVATE_queryWithLimit(Ct,null,"F")):this.es($t,zt,Ct,Vt)}))})))}Hi($t,Ct,kt,Mt){return __PRIVATE_queryMatchesAllDocuments(Ct)||Mt.isEqual(SnapshotVersion.min())?PersistencePromise.resolve(null):this.zi.getDocuments($t,kt).next(Ft=>{const jt=this.Zi(Ct,Ft);return this.Xi(Ct,jt,kt,Mt)?PersistencePromise.resolve(null):(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Re-using previous result from %s to execute query: %s",Mt.toString(),__PRIVATE_stringifyQuery(Ct)),this.es($t,jt,Ct,__PRIVATE_newIndexOffsetSuccessorFromReadTime(Mt,-1)).next(Bt=>Bt))})}Zi($t,Ct){let kt=new SortedSet(__PRIVATE_newQueryComparator($t));return Ct.forEach((Mt,Ft)=>{__PRIVATE_queryMatches($t,Ft)&&(kt=kt.add(Ft))}),kt}Xi($t,Ct,kt,Mt){if($t.limit===null)return!1;if(kt.size!==Ct.size)return!0;const Ft=$t.limitType==="F"?Ct.last():Ct.first();return!!Ft&&(Ft.hasPendingWrites||Ft.version.compareTo(Mt)>0)}Ji($t,Ct,kt){return __PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Using full collection scan to execute query:",__PRIVATE_stringifyQuery(Ct)),this.zi.getDocumentsMatchingQuery($t,Ct,IndexOffset.min(),kt)}es($t,Ct,kt,Mt){return this.zi.getDocumentsMatchingQuery($t,kt,Mt).next(Ft=>(Ct.forEach(jt=>{Ft=Ft.insert(jt.key,jt)}),Ft))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalStoreImpl{constructor($t,Ct,kt,Mt){this.persistence=$t,this.ts=Ct,this.serializer=Mt,this.ns=new SortedMap(__PRIVATE_primitiveComparator),this.rs=new ObjectMap(Ft=>__PRIVATE_canonifyTarget(Ft),__PRIVATE_targetEquals),this.ss=new Map,this.os=$t.getRemoteDocumentCache(),this.Qr=$t.getTargetCache(),this.$r=$t.getBundleCache(),this._s(kt)}_s($t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache($t),this.indexManager=this.persistence.getIndexManager($t),this.mutationQueue=this.persistence.getMutationQueue($t,this.indexManager),this.localDocuments=new LocalDocumentsView(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage($t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",Ct=>$t.collect(Ct,this.ns))}}function __PRIVATE_newLocalStore(xt,$t,Ct,kt){return new __PRIVATE_LocalStoreImpl(xt,$t,Ct,kt)}async function __PRIVATE_localStoreHandleUserChange(xt,$t){const Ct=__PRIVATE_debugCast(xt);return await Ct.persistence.runTransaction("Handle user change","readonly",kt=>{let Mt;return Ct.mutationQueue.getAllMutationBatches(kt).next(Ft=>(Mt=Ft,Ct._s($t),Ct.mutationQueue.getAllMutationBatches(kt))).next(Ft=>{const jt=[],Bt=[];let Vt=__PRIVATE_documentKeySet();for(const zt of Mt){jt.push(zt.batchId);for(const Ht of zt.mutations)Vt=Vt.add(Ht.key)}for(const zt of Ft){Bt.push(zt.batchId);for(const Ht of zt.mutations)Vt=Vt.add(Ht.key)}return Ct.localDocuments.getDocuments(kt,Vt).next(zt=>({us:zt,removedBatchIds:jt,addedBatchIds:Bt}))})})}function __PRIVATE_localStoreAcknowledgeBatch(xt,$t){const Ct=__PRIVATE_debugCast(xt);return Ct.persistence.runTransaction("Acknowledge batch","readwrite-primary",kt=>{const Mt=$t.batch.keys(),Ft=Ct.os.newChangeBuffer({trackRemovals:!0});return function(Bt,Vt,zt,Ht){const Gt=zt.batch,qt=Gt.keys();let Wt=PersistencePromise.resolve();return qt.forEach(Yt=>{Wt=Wt.next(()=>Ht.getEntry(Vt,Yt)).next(Kt=>{const Xt=zt.docVersions.get(Yt);__PRIVATE_hardAssert(Xt!==null),Kt.version.compareTo(Xt)<0&&(Gt.applyToRemoteDocument(Kt,zt),Kt.isValidDocument()&&(Kt.setReadTime(zt.commitVersion),Ht.addEntry(Kt)))})}),Wt.next(()=>Bt.mutationQueue.removeMutationBatch(Vt,Gt))}(Ct,kt,$t,Ft).next(()=>Ft.apply(kt)).next(()=>Ct.mutationQueue.performConsistencyCheck(kt)).next(()=>Ct.documentOverlayCache.removeOverlaysForBatchId(kt,Mt,$t.batch.batchId)).next(()=>Ct.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(kt,function(Bt){let Vt=__PRIVATE_documentKeySet();for(let zt=0;zt<Bt.mutationResults.length;++zt)Bt.mutationResults[zt].transformResults.length>0&&(Vt=Vt.add(Bt.batch.mutations[zt].key));return Vt}($t))).next(()=>Ct.localDocuments.getDocuments(kt,Mt))})}function __PRIVATE_localStoreGetLastRemoteSnapshotVersion(xt){const $t=__PRIVATE_debugCast(xt);return $t.persistence.runTransaction("Get last remote snapshot version","readonly",Ct=>$t.Qr.getLastRemoteSnapshotVersion(Ct))}function __PRIVATE_localStoreApplyRemoteEventToLocalCache(xt,$t){const Ct=__PRIVATE_debugCast(xt),kt=$t.snapshotVersion;let Mt=Ct.ns;return Ct.persistence.runTransaction("Apply remote event","readwrite-primary",Ft=>{const jt=Ct.os.newChangeBuffer({trackRemovals:!0});Mt=Ct.ns;const Bt=[];$t.targetChanges.forEach((Ht,Gt)=>{const qt=Mt.get(Gt);if(!qt)return;Bt.push(Ct.Qr.removeMatchingKeys(Ft,Ht.removedDocuments,Gt).next(()=>Ct.Qr.addMatchingKeys(Ft,Ht.addedDocuments,Gt)));let Wt=qt.withSequenceNumber(Ft.currentSequenceNumber);$t.targetMismatches.get(Gt)!==null?Wt=Wt.withResumeToken(ByteString.EMPTY_BYTE_STRING,SnapshotVersion.min()).withLastLimboFreeSnapshotVersion(SnapshotVersion.min()):Ht.resumeToken.approximateByteSize()>0&&(Wt=Wt.withResumeToken(Ht.resumeToken,kt)),Mt=Mt.insert(Gt,Wt),function(Kt,Xt,Qt){return Kt.resumeToken.approximateByteSize()===0||Xt.snapshotVersion.toMicroseconds()-Kt.snapshotVersion.toMicroseconds()>=3e8?!0:Qt.addedDocuments.size+Qt.modifiedDocuments.size+Qt.removedDocuments.size>0}(qt,Wt,Ht)&&Bt.push(Ct.Qr.updateTargetData(Ft,Wt))});let Vt=__PRIVATE_mutableDocumentMap(),zt=__PRIVATE_documentKeySet();if($t.documentUpdates.forEach(Ht=>{$t.resolvedLimboDocuments.has(Ht)&&Bt.push(Ct.persistence.referenceDelegate.updateLimboDocument(Ft,Ht))}),Bt.push(__PRIVATE_populateDocumentChangeBuffer(Ft,jt,$t.documentUpdates).next(Ht=>{Vt=Ht.cs,zt=Ht.ls})),!kt.isEqual(SnapshotVersion.min())){const Ht=Ct.Qr.getLastRemoteSnapshotVersion(Ft).next(Gt=>Ct.Qr.setTargetsMetadata(Ft,Ft.currentSequenceNumber,kt));Bt.push(Ht)}return PersistencePromise.waitFor(Bt).next(()=>jt.apply(Ft)).next(()=>Ct.localDocuments.getLocalViewOfDocuments(Ft,Vt,zt)).next(()=>Vt)}).then(Ft=>(Ct.ns=Mt,Ft))}function __PRIVATE_populateDocumentChangeBuffer(xt,$t,Ct){let kt=__PRIVATE_documentKeySet(),Mt=__PRIVATE_documentKeySet();return Ct.forEach(Ft=>kt=kt.add(Ft)),$t.getEntries(xt,kt).next(Ft=>{let jt=__PRIVATE_mutableDocumentMap();return Ct.forEach((Bt,Vt)=>{const zt=Ft.get(Bt);Vt.isFoundDocument()!==zt.isFoundDocument()&&(Mt=Mt.add(Bt)),Vt.isNoDocument()&&Vt.version.isEqual(SnapshotVersion.min())?($t.removeEntry(Bt,Vt.readTime),jt=jt.insert(Bt,Vt)):!zt.isValidDocument()||Vt.version.compareTo(zt.version)>0||Vt.version.compareTo(zt.version)===0&&zt.hasPendingWrites?($t.addEntry(Vt),jt=jt.insert(Bt,Vt)):__PRIVATE_logDebug("LocalStore","Ignoring outdated watch update for ",Bt,". Current version:",zt.version," Watch version:",Vt.version)}),{cs:jt,ls:Mt}})}function __PRIVATE_localStoreGetNextMutationBatch(xt,$t){const Ct=__PRIVATE_debugCast(xt);return Ct.persistence.runTransaction("Get next mutation batch","readonly",kt=>($t===void 0&&($t=-1),Ct.mutationQueue.getNextMutationBatchAfterBatchId(kt,$t)))}function __PRIVATE_localStoreAllocateTarget(xt,$t){const Ct=__PRIVATE_debugCast(xt);return Ct.persistence.runTransaction("Allocate target","readwrite",kt=>{let Mt;return Ct.Qr.getTargetData(kt,$t).next(Ft=>Ft?(Mt=Ft,PersistencePromise.resolve(Mt)):Ct.Qr.allocateTargetId(kt).next(jt=>(Mt=new TargetData($t,jt,"TargetPurposeListen",kt.currentSequenceNumber),Ct.Qr.addTargetData(kt,Mt).next(()=>Mt))))}).then(kt=>{const Mt=Ct.ns.get(kt.targetId);return(Mt===null||kt.snapshotVersion.compareTo(Mt.snapshotVersion)>0)&&(Ct.ns=Ct.ns.insert(kt.targetId,kt),Ct.rs.set($t,kt.targetId)),kt})}async function __PRIVATE_localStoreReleaseTarget(xt,$t,Ct){const kt=__PRIVATE_debugCast(xt),Mt=kt.ns.get($t),Ft=Ct?"readwrite":"readwrite-primary";try{Ct||await kt.persistence.runTransaction("Release target",Ft,jt=>kt.persistence.referenceDelegate.removeTarget(jt,Mt))}catch(jt){if(!__PRIVATE_isIndexedDbTransactionError(jt))throw jt;__PRIVATE_logDebug("LocalStore",`Failed to update sequence numbers for target ${$t}: ${jt}`)}kt.ns=kt.ns.remove($t),kt.rs.delete(Mt.target)}function __PRIVATE_localStoreExecuteQuery(xt,$t,Ct){const kt=__PRIVATE_debugCast(xt);let Mt=SnapshotVersion.min(),Ft=__PRIVATE_documentKeySet();return kt.persistence.runTransaction("Execute query","readwrite",jt=>function(Vt,zt,Ht){const Gt=__PRIVATE_debugCast(Vt),qt=Gt.rs.get(Ht);return qt!==void 0?PersistencePromise.resolve(Gt.ns.get(qt)):Gt.Qr.getTargetData(zt,Ht)}(kt,jt,__PRIVATE_queryToTarget($t)).next(Bt=>{if(Bt)return Mt=Bt.lastLimboFreeSnapshotVersion,kt.Qr.getMatchingKeysForTargetId(jt,Bt.targetId).next(Vt=>{Ft=Vt})}).next(()=>kt.ts.getDocumentsMatchingQuery(jt,$t,Ct?Mt:SnapshotVersion.min(),Ct?Ft:__PRIVATE_documentKeySet())).next(Bt=>(__PRIVATE_setMaxReadTime(kt,__PRIVATE_queryCollectionGroup($t),Bt),{documents:Bt,hs:Ft})))}function __PRIVATE_setMaxReadTime(xt,$t,Ct){let kt=xt.ss.get($t)||SnapshotVersion.min();Ct.forEach((Mt,Ft)=>{Ft.readTime.compareTo(kt)>0&&(kt=Ft.readTime)}),xt.ss.set($t,kt)}class __PRIVATE_LocalClientState{constructor(){this.activeTargetIds=__PRIVATE_targetIdSet()}As($t){this.activeTargetIds=this.activeTargetIds.add($t)}Rs($t){this.activeTargetIds=this.activeTargetIds.delete($t)}ds(){const $t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify($t)}}class __PRIVATE_MemorySharedClientState{constructor(){this.no=new __PRIVATE_LocalClientState,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation($t){}updateMutationState($t,Ct,kt){}addLocalQueryTarget($t){return this.no.As($t),this.ro[$t]||"not-current"}updateQueryState($t,Ct,kt){this.ro[$t]=Ct}removeLocalQueryTarget($t){this.no.Rs($t)}isLocalQueryTarget($t){return this.no.activeTargetIds.has($t)}clearQueryState($t){delete this.ro[$t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget($t){return this.no.activeTargetIds.has($t)}start(){return this.no=new __PRIVATE_LocalClientState,Promise.resolve()}handleUserChange($t,Ct,kt){}setOnlineState($t){}shutdown(){}writeSequenceNumber($t){}notifyBundleLoaded($t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_NoopConnectivityMonitor{io($t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_BrowserConnectivityMonitor{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io($t){this.uo.push($t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){__PRIVATE_logDebug("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const $t of this.uo)$t(0)}ao(){__PRIVATE_logDebug("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const $t of this.uo)$t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ve=null;function __PRIVATE_generateUniqueDebugId(){return Ve===null?Ve=function(){return 268435456+Math.round(2147483648*Math.random())}():Ve++,"0x"+Ve.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const me={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_StreamBridge{constructor($t){this.lo=$t.lo,this.ho=$t.ho}Po($t){this.Io=$t}To($t){this.Eo=$t}Ao($t){this.Ro=$t}onMessage($t){this.Vo=$t}close(){this.ho()}send($t){this.lo($t)}mo(){this.Io()}fo(){this.Eo()}po($t){this.Ro($t)}yo($t){this.Vo($t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fe="WebChannelConnection";class __PRIVATE_WebChannelConnection extends class{constructor(Ct){this.databaseInfo=Ct,this.databaseId=Ct.databaseId;const kt=Ct.ssl?"https":"http",Mt=encodeURIComponent(this.databaseId.projectId),Ft=encodeURIComponent(this.databaseId.database);this.wo=kt+"://"+Ct.host,this.So=`projects/${Mt}/databases/${Ft}`,this.bo=this.databaseId.database==="(default)"?`project_id=${Mt}`:`project_id=${Mt}&database_id=${Ft}`}get Do(){return!1}Co(Ct,kt,Mt,Ft,jt){const Bt=__PRIVATE_generateUniqueDebugId(),Vt=this.vo(Ct,kt.toUriEncodedString());__PRIVATE_logDebug("RestConnection",`Sending RPC '${Ct}' ${Bt}:`,Vt,Mt);const zt={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(zt,Ft,jt),this.Mo(Ct,Vt,zt,Mt).then(Ht=>(__PRIVATE_logDebug("RestConnection",`Received RPC '${Ct}' ${Bt}: `,Ht),Ht),Ht=>{throw __PRIVATE_logWarn("RestConnection",`RPC '${Ct}' ${Bt} failed with error: `,Ht,"url: ",Vt,"request:",Mt),Ht})}xo(Ct,kt,Mt,Ft,jt,Bt){return this.Co(Ct,kt,Mt,Ft,jt)}Fo(Ct,kt,Mt){Ct["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+b$1}(),Ct["Content-Type"]="text/plain",this.databaseInfo.appId&&(Ct["X-Firebase-GMPID"]=this.databaseInfo.appId),kt&&kt.headers.forEach((Ft,jt)=>Ct[jt]=Ft),Mt&&Mt.headers.forEach((Ft,jt)=>Ct[jt]=Ft)}vo(Ct,kt){const Mt=me[Ct];return`${this.wo}/v1/${kt}:${Mt}`}terminate(){}}{constructor($t){super($t),this.forceLongPolling=$t.forceLongPolling,this.autoDetectLongPolling=$t.autoDetectLongPolling,this.useFetchStreams=$t.useFetchStreams,this.longPollingOptions=$t.longPollingOptions}Mo($t,Ct,kt,Mt){const Ft=__PRIVATE_generateUniqueDebugId();return new Promise((jt,Bt)=>{const Vt=new XhrIo;Vt.setWithCredentials(!0),Vt.listenOnce(EventType.COMPLETE,()=>{try{switch(Vt.getLastErrorCode()){case ErrorCode.NO_ERROR:const Ht=Vt.getResponseJson();__PRIVATE_logDebug(fe,`XHR for RPC '${$t}' ${Ft} received:`,JSON.stringify(Ht)),jt(Ht);break;case ErrorCode.TIMEOUT:__PRIVATE_logDebug(fe,`RPC '${$t}' ${Ft} timed out`),Bt(new FirestoreError(C$1.DEADLINE_EXCEEDED,"Request time out"));break;case ErrorCode.HTTP_ERROR:const Gt=Vt.getStatus();if(__PRIVATE_logDebug(fe,`RPC '${$t}' ${Ft} failed with status:`,Gt,"response text:",Vt.getResponseText()),Gt>0){let qt=Vt.getResponseJson();Array.isArray(qt)&&(qt=qt[0]);const Wt=qt==null?void 0:qt.error;if(Wt&&Wt.status&&Wt.message){const Yt=function(Xt){const Qt=Xt.toLowerCase().replace(/_/g,"-");return Object.values(C$1).indexOf(Qt)>=0?Qt:C$1.UNKNOWN}(Wt.status);Bt(new FirestoreError(Yt,Wt.message))}else Bt(new FirestoreError(C$1.UNKNOWN,"Server responded with status "+Vt.getStatus()))}else Bt(new FirestoreError(C$1.UNAVAILABLE,"Connection failed."));break;default:fail()}}finally{__PRIVATE_logDebug(fe,`RPC '${$t}' ${Ft} completed.`)}});const zt=JSON.stringify(Mt);__PRIVATE_logDebug(fe,`RPC '${$t}' ${Ft} sending request:`,Mt),Vt.send(Ct,"POST",zt,kt,15)})}Oo($t,Ct,kt){const Mt=__PRIVATE_generateUniqueDebugId(),Ft=[this.wo,"/","google.firestore.v1.Firestore","/",$t,"/channel"],jt=createWebChannelTransport(),Bt=getStatEventTarget(),Vt={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},zt=this.longPollingOptions.timeoutSeconds;zt!==void 0&&(Vt.longPollingTimeout=Math.round(1e3*zt)),this.useFetchStreams&&(Vt.xmlHttpFactory=new FetchXmlHttpFactory({})),this.Fo(Vt.initMessageHeaders,Ct,kt),Vt.encodeInitMessageHeaders=!0;const Ht=Ft.join("");__PRIVATE_logDebug(fe,`Creating RPC '${$t}' stream ${Mt}: ${Ht}`,Vt);const Gt=jt.createWebChannel(Ht,Vt);let qt=!1,Wt=!1;const Yt=new __PRIVATE_StreamBridge({lo:Xt=>{Wt?__PRIVATE_logDebug(fe,`Not sending because RPC '${$t}' stream ${Mt} is closed:`,Xt):(qt||(__PRIVATE_logDebug(fe,`Opening RPC '${$t}' stream ${Mt} transport.`),Gt.open(),qt=!0),__PRIVATE_logDebug(fe,`RPC '${$t}' stream ${Mt} sending:`,Xt),Gt.send(Xt))},ho:()=>Gt.close()}),Kt=(Xt,Qt,Jt)=>{Xt.listen(Qt,Zt=>{try{Jt(Zt)}catch(sn){setTimeout(()=>{throw sn},0)}})};return Kt(Gt,WebChannel.EventType.OPEN,()=>{Wt||(__PRIVATE_logDebug(fe,`RPC '${$t}' stream ${Mt} transport opened.`),Yt.mo())}),Kt(Gt,WebChannel.EventType.CLOSE,()=>{Wt||(Wt=!0,__PRIVATE_logDebug(fe,`RPC '${$t}' stream ${Mt} transport closed`),Yt.po())}),Kt(Gt,WebChannel.EventType.ERROR,Xt=>{Wt||(Wt=!0,__PRIVATE_logWarn(fe,`RPC '${$t}' stream ${Mt} transport errored:`,Xt),Yt.po(new FirestoreError(C$1.UNAVAILABLE,"The operation could not be completed")))}),Kt(Gt,WebChannel.EventType.MESSAGE,Xt=>{var Qt;if(!Wt){const Jt=Xt.data[0];__PRIVATE_hardAssert(!!Jt);const Zt=Jt,sn=Zt.error||((Qt=Zt[0])===null||Qt===void 0?void 0:Qt.error);if(sn){__PRIVATE_logDebug(fe,`RPC '${$t}' stream ${Mt} received error:`,sn);const ln=sn.status;let dn=function(pn){const yn=ce[pn];if(yn!==void 0)return __PRIVATE_mapCodeFromRpcCode(yn)}(ln),hn=sn.message;dn===void 0&&(dn=C$1.INTERNAL,hn="Unknown error status: "+ln+" with message "+sn.message),Wt=!0,Yt.po(new FirestoreError(dn,hn)),Gt.close()}else __PRIVATE_logDebug(fe,`RPC '${$t}' stream ${Mt} received:`,Jt),Yt.yo(Jt)}}),Kt(Bt,Event$1.STAT_EVENT,Xt=>{Xt.stat===Stat.PROXY?__PRIVATE_logDebug(fe,`RPC '${$t}' stream ${Mt} detected buffering proxy`):Xt.stat===Stat.NOPROXY&&__PRIVATE_logDebug(fe,`RPC '${$t}' stream ${Mt} detected no buffering proxy`)}),setTimeout(()=>{Yt.fo()},0),Yt}}function getDocument(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newSerializer(xt){return new JsonProtoSerializer(xt,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ExponentialBackoff{constructor($t,Ct,kt=1e3,Mt=1.5,Ft=6e4){this.oi=$t,this.timerId=Ct,this.No=kt,this.Lo=Mt,this.Bo=Ft,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o($t){this.cancel();const Ct=Math.floor(this.ko+this.Uo()),kt=Math.max(0,Date.now()-this.Qo),Mt=Math.max(0,Ct-kt);Mt>0&&__PRIVATE_logDebug("ExponentialBackoff",`Backing off for ${Mt} ms (base delay: ${this.ko} ms, delay with jitter: ${Ct} ms, last attempt: ${kt} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,Mt,()=>(this.Qo=Date.now(),$t())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_PersistentStream{constructor($t,Ct,kt,Mt,Ft,jt,Bt,Vt){this.oi=$t,this.Go=kt,this.zo=Mt,this.connection=Ft,this.authCredentialsProvider=jt,this.appCheckCredentialsProvider=Bt,this.listener=Vt,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new __PRIVATE_ExponentialBackoff($t,Ct)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}async stop(){this.Zo()&&await this.close(0)}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_($t){this.s_(),this.stream.send($t)}async r_(){if(this.Xo())return this.close(0)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}async close($t,Ct){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,$t!==4?this.Yo.reset():Ct&&Ct.code===C$1.RESOURCE_EXHAUSTED?(__PRIVATE_logError(Ct.toString()),__PRIVATE_logError("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):Ct&&Ct.code===C$1.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=$t,await this.listener.Ao(Ct)}__(){}auth(){this.state=1;const $t=this.a_(this.jo),Ct=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([kt,Mt])=>{this.jo===Ct&&this.u_(kt,Mt)},kt=>{$t(()=>{const Mt=new FirestoreError(C$1.UNKNOWN,"Fetching auth token failed: "+kt.message);return this.c_(Mt)})})}u_($t,Ct){const kt=this.a_(this.jo);this.stream=this.l_($t,Ct),this.stream.Po(()=>{kt(()=>this.listener.Po())}),this.stream.To(()=>{kt(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(Mt=>{kt(()=>this.c_(Mt))}),this.stream.onMessage(Mt=>{kt(()=>this.onMessage(Mt))})}e_(){this.state=5,this.Yo.$o(async()=>{this.state=0,this.start()})}c_($t){return __PRIVATE_logDebug("PersistentStream",`close with error: ${$t}`),this.stream=null,this.close(4,$t)}a_($t){return Ct=>{this.oi.enqueueAndForget(()=>this.jo===$t?Ct():(__PRIVATE_logDebug("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class __PRIVATE_PersistentListenStream extends __PRIVATE_PersistentStream{constructor($t,Ct,kt,Mt,Ft,jt){super($t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",Ct,kt,Mt,jt),this.serializer=Ft}l_($t,Ct){return this.connection.Oo("Listen",$t,Ct)}onMessage($t){this.Yo.reset();const Ct=__PRIVATE_fromWatchChange(this.serializer,$t),kt=function(Ft){if(!("targetChange"in Ft))return SnapshotVersion.min();const jt=Ft.targetChange;return jt.targetIds&&jt.targetIds.length?SnapshotVersion.min():jt.readTime?__PRIVATE_fromVersion(jt.readTime):SnapshotVersion.min()}($t);return this.listener.h_(Ct,kt)}P_($t){const Ct={};Ct.database=__PRIVATE_getEncodedDatabaseId(this.serializer),Ct.addTarget=function(Ft,jt){let Bt;const Vt=jt.target;if(Bt=__PRIVATE_targetIsDocumentTarget(Vt)?{documents:__PRIVATE_toDocumentsTarget(Ft,Vt)}:{query:__PRIVATE_toQueryTarget(Ft,Vt)._t},Bt.targetId=jt.targetId,jt.resumeToken.approximateByteSize()>0){Bt.resumeToken=__PRIVATE_toBytes(Ft,jt.resumeToken);const zt=__PRIVATE_toInt32Proto(Ft,jt.expectedCount);zt!==null&&(Bt.expectedCount=zt)}else if(jt.snapshotVersion.compareTo(SnapshotVersion.min())>0){Bt.readTime=toTimestamp(Ft,jt.snapshotVersion.toTimestamp());const zt=__PRIVATE_toInt32Proto(Ft,jt.expectedCount);zt!==null&&(Bt.expectedCount=zt)}return Bt}(this.serializer,$t);const kt=__PRIVATE_toListenRequestLabels(this.serializer,$t);kt&&(Ct.labels=kt),this.i_(Ct)}I_($t){const Ct={};Ct.database=__PRIVATE_getEncodedDatabaseId(this.serializer),Ct.removeTarget=$t,this.i_(Ct)}}class __PRIVATE_PersistentWriteStream extends __PRIVATE_PersistentStream{constructor($t,Ct,kt,Mt,Ft,jt){super($t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",Ct,kt,Mt,jt),this.serializer=Ft,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_($t,Ct){return this.connection.Oo("Write",$t,Ct)}onMessage($t){if(__PRIVATE_hardAssert(!!$t.streamToken),this.lastStreamToken=$t.streamToken,this.T_){this.Yo.reset();const Ct=__PRIVATE_fromWriteResults($t.writeResults,$t.commitTime),kt=__PRIVATE_fromVersion($t.commitTime);return this.listener.A_(kt,Ct)}return __PRIVATE_hardAssert(!$t.writeResults||$t.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){const $t={};$t.database=__PRIVATE_getEncodedDatabaseId(this.serializer),this.i_($t)}d_($t){const Ct={streamToken:this.lastStreamToken,writes:$t.map(kt=>toMutation(this.serializer,kt))};this.i_(Ct)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DatastoreImpl extends class{}{constructor($t,Ct,kt,Mt){super(),this.authCredentials=$t,this.appCheckCredentials=Ct,this.connection=kt,this.serializer=Mt,this.m_=!1}f_(){if(this.m_)throw new FirestoreError(C$1.FAILED_PRECONDITION,"The client has already been terminated.")}Co($t,Ct,kt,Mt){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([Ft,jt])=>this.connection.Co($t,__PRIVATE_toResourcePath(Ct,kt),Mt,Ft,jt)).catch(Ft=>{throw Ft.name==="FirebaseError"?(Ft.code===C$1.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),Ft):new FirestoreError(C$1.UNKNOWN,Ft.toString())})}xo($t,Ct,kt,Mt,Ft){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([jt,Bt])=>this.connection.xo($t,__PRIVATE_toResourcePath(Ct,kt),Mt,jt,Bt,Ft)).catch(jt=>{throw jt.name==="FirebaseError"?(jt.code===C$1.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),jt):new FirestoreError(C$1.UNKNOWN,jt.toString())})}terminate(){this.m_=!0,this.connection.terminate()}}class __PRIVATE_OnlineStateTracker{constructor($t,Ct){this.asyncQueue=$t,this.onlineStateHandler=Ct,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_($t){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${$t.toString()}`),this.S_("Offline")))}set($t){this.C_(),this.g_=0,$t==="Online"&&(this.y_=!1),this.S_($t)}S_($t){$t!==this.state&&(this.state=$t,this.onlineStateHandler($t))}b_($t){const Ct=`Could not reach Cloud Firestore backend. ${$t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(__PRIVATE_logError(Ct),this.y_=!1):__PRIVATE_logDebug("OnlineStateTracker",Ct)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_RemoteStoreImpl{constructor($t,Ct,kt,Mt,Ft){this.localStore=$t,this.datastore=Ct,this.asyncQueue=kt,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=Ft,this.O_.io(jt=>{kt.enqueueAndForget(async()=>{__PRIVATE_canUseNetwork(this)&&(__PRIVATE_logDebug("RemoteStore","Restarting streams for network reachability change."),await async function(Vt){const zt=__PRIVATE_debugCast(Vt);zt.M_.add(4),await __PRIVATE_disableNetworkInternal(zt),zt.N_.set("Unknown"),zt.M_.delete(4),await __PRIVATE_enableNetworkInternal(zt)}(this))})}),this.N_=new __PRIVATE_OnlineStateTracker(kt,Mt)}}async function __PRIVATE_enableNetworkInternal(xt){if(__PRIVATE_canUseNetwork(xt))for(const $t of xt.x_)await $t(!0)}async function __PRIVATE_disableNetworkInternal(xt){for(const $t of xt.x_)await $t(!1)}function __PRIVATE_remoteStoreListen(xt,$t){const Ct=__PRIVATE_debugCast(xt);Ct.F_.has($t.targetId)||(Ct.F_.set($t.targetId,$t),__PRIVATE_shouldStartWatchStream(Ct)?__PRIVATE_startWatchStream(Ct):__PRIVATE_ensureWatchStream(Ct).Xo()&&__PRIVATE_sendWatchRequest(Ct,$t))}function __PRIVATE_remoteStoreUnlisten(xt,$t){const Ct=__PRIVATE_debugCast(xt),kt=__PRIVATE_ensureWatchStream(Ct);Ct.F_.delete($t),kt.Xo()&&__PRIVATE_sendUnwatchRequest(Ct,$t),Ct.F_.size===0&&(kt.Xo()?kt.n_():__PRIVATE_canUseNetwork(Ct)&&Ct.N_.set("Unknown"))}function __PRIVATE_sendWatchRequest(xt,$t){if(xt.L_.xe($t.targetId),$t.resumeToken.approximateByteSize()>0||$t.snapshotVersion.compareTo(SnapshotVersion.min())>0){const Ct=xt.remoteSyncer.getRemoteKeysForTarget($t.targetId).size;$t=$t.withExpectedCount(Ct)}__PRIVATE_ensureWatchStream(xt).P_($t)}function __PRIVATE_sendUnwatchRequest(xt,$t){xt.L_.xe($t),__PRIVATE_ensureWatchStream(xt).I_($t)}function __PRIVATE_startWatchStream(xt){xt.L_=new __PRIVATE_WatchChangeAggregator({getRemoteKeysForTarget:$t=>xt.remoteSyncer.getRemoteKeysForTarget($t),ot:$t=>xt.F_.get($t)||null,tt:()=>xt.datastore.serializer.databaseId}),__PRIVATE_ensureWatchStream(xt).start(),xt.N_.w_()}function __PRIVATE_shouldStartWatchStream(xt){return __PRIVATE_canUseNetwork(xt)&&!__PRIVATE_ensureWatchStream(xt).Zo()&&xt.F_.size>0}function __PRIVATE_canUseNetwork(xt){return __PRIVATE_debugCast(xt).M_.size===0}function __PRIVATE_cleanUpWatchStreamState(xt){xt.L_=void 0}async function __PRIVATE_onWatchStreamConnected(xt){xt.N_.set("Online")}async function __PRIVATE_onWatchStreamOpen(xt){xt.F_.forEach(($t,Ct)=>{__PRIVATE_sendWatchRequest(xt,$t)})}async function __PRIVATE_onWatchStreamClose(xt,$t){__PRIVATE_cleanUpWatchStreamState(xt),__PRIVATE_shouldStartWatchStream(xt)?(xt.N_.D_($t),__PRIVATE_startWatchStream(xt)):xt.N_.set("Unknown")}async function __PRIVATE_onWatchStreamChange(xt,$t,Ct){if(xt.N_.set("Online"),$t instanceof __PRIVATE_WatchTargetChange&&$t.state===2&&$t.cause)try{await async function(Mt,Ft){const jt=Ft.cause;for(const Bt of Ft.targetIds)Mt.F_.has(Bt)&&(await Mt.remoteSyncer.rejectListen(Bt,jt),Mt.F_.delete(Bt),Mt.L_.removeTarget(Bt))}(xt,$t)}catch(kt){__PRIVATE_logDebug("RemoteStore","Failed to remove targets %s: %s ",$t.targetIds.join(","),kt),await __PRIVATE_disableNetworkUntilRecovery(xt,kt)}else if($t instanceof __PRIVATE_DocumentWatchChange?xt.L_.Ke($t):$t instanceof __PRIVATE_ExistenceFilterChange?xt.L_.He($t):xt.L_.We($t),!Ct.isEqual(SnapshotVersion.min()))try{const kt=await __PRIVATE_localStoreGetLastRemoteSnapshotVersion(xt.localStore);Ct.compareTo(kt)>=0&&await function(Ft,jt){const Bt=Ft.L_.rt(jt);return Bt.targetChanges.forEach((Vt,zt)=>{if(Vt.resumeToken.approximateByteSize()>0){const Ht=Ft.F_.get(zt);Ht&&Ft.F_.set(zt,Ht.withResumeToken(Vt.resumeToken,jt))}}),Bt.targetMismatches.forEach((Vt,zt)=>{const Ht=Ft.F_.get(Vt);if(!Ht)return;Ft.F_.set(Vt,Ht.withResumeToken(ByteString.EMPTY_BYTE_STRING,Ht.snapshotVersion)),__PRIVATE_sendUnwatchRequest(Ft,Vt);const Gt=new TargetData(Ht.target,Vt,zt,Ht.sequenceNumber);__PRIVATE_sendWatchRequest(Ft,Gt)}),Ft.remoteSyncer.applyRemoteEvent(Bt)}(xt,Ct)}catch(kt){__PRIVATE_logDebug("RemoteStore","Failed to raise snapshot:",kt),await __PRIVATE_disableNetworkUntilRecovery(xt,kt)}}async function __PRIVATE_disableNetworkUntilRecovery(xt,$t,Ct){if(!__PRIVATE_isIndexedDbTransactionError($t))throw $t;xt.M_.add(1),await __PRIVATE_disableNetworkInternal(xt),xt.N_.set("Offline"),Ct||(Ct=()=>__PRIVATE_localStoreGetLastRemoteSnapshotVersion(xt.localStore)),xt.asyncQueue.enqueueRetryable(async()=>{__PRIVATE_logDebug("RemoteStore","Retrying IndexedDB access"),await Ct(),xt.M_.delete(1),await __PRIVATE_enableNetworkInternal(xt)})}function __PRIVATE_executeWithRecovery(xt,$t){return $t().catch(Ct=>__PRIVATE_disableNetworkUntilRecovery(xt,Ct,$t))}async function __PRIVATE_fillWritePipeline(xt){const $t=__PRIVATE_debugCast(xt),Ct=__PRIVATE_ensureWriteStream($t);let kt=$t.v_.length>0?$t.v_[$t.v_.length-1].batchId:-1;for(;__PRIVATE_canAddToWritePipeline($t);)try{const Mt=await __PRIVATE_localStoreGetNextMutationBatch($t.localStore,kt);if(Mt===null){$t.v_.length===0&&Ct.n_();break}kt=Mt.batchId,__PRIVATE_addToWritePipeline($t,Mt)}catch(Mt){await __PRIVATE_disableNetworkUntilRecovery($t,Mt)}__PRIVATE_shouldStartWriteStream($t)&&__PRIVATE_startWriteStream($t)}function __PRIVATE_canAddToWritePipeline(xt){return __PRIVATE_canUseNetwork(xt)&&xt.v_.length<10}function __PRIVATE_addToWritePipeline(xt,$t){xt.v_.push($t);const Ct=__PRIVATE_ensureWriteStream(xt);Ct.Xo()&&Ct.E_&&Ct.d_($t.mutations)}function __PRIVATE_shouldStartWriteStream(xt){return __PRIVATE_canUseNetwork(xt)&&!__PRIVATE_ensureWriteStream(xt).Zo()&&xt.v_.length>0}function __PRIVATE_startWriteStream(xt){__PRIVATE_ensureWriteStream(xt).start()}async function __PRIVATE_onWriteStreamOpen(xt){__PRIVATE_ensureWriteStream(xt).V_()}async function __PRIVATE_onWriteHandshakeComplete(xt){const $t=__PRIVATE_ensureWriteStream(xt);for(const Ct of xt.v_)$t.d_(Ct.mutations)}async function __PRIVATE_onMutationResult(xt,$t,Ct){const kt=xt.v_.shift(),Mt=MutationBatchResult.from(kt,$t,Ct);await __PRIVATE_executeWithRecovery(xt,()=>xt.remoteSyncer.applySuccessfulWrite(Mt)),await __PRIVATE_fillWritePipeline(xt)}async function __PRIVATE_onWriteStreamClose(xt,$t){$t&&__PRIVATE_ensureWriteStream(xt).E_&&await async function(kt,Mt){if(function(jt){return __PRIVATE_isPermanentError(jt)&&jt!==C$1.ABORTED}(Mt.code)){const Ft=kt.v_.shift();__PRIVATE_ensureWriteStream(kt).t_(),await __PRIVATE_executeWithRecovery(kt,()=>kt.remoteSyncer.rejectFailedWrite(Ft.batchId,Mt)),await __PRIVATE_fillWritePipeline(kt)}}(xt,$t),__PRIVATE_shouldStartWriteStream(xt)&&__PRIVATE_startWriteStream(xt)}async function __PRIVATE_remoteStoreHandleCredentialChange(xt,$t){const Ct=__PRIVATE_debugCast(xt);Ct.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug("RemoteStore","RemoteStore received new credentials");const kt=__PRIVATE_canUseNetwork(Ct);Ct.M_.add(3),await __PRIVATE_disableNetworkInternal(Ct),kt&&Ct.N_.set("Unknown"),await Ct.remoteSyncer.handleCredentialChange($t),Ct.M_.delete(3),await __PRIVATE_enableNetworkInternal(Ct)}async function __PRIVATE_remoteStoreApplyPrimaryState(xt,$t){const Ct=__PRIVATE_debugCast(xt);$t?(Ct.M_.delete(2),await __PRIVATE_enableNetworkInternal(Ct)):$t||(Ct.M_.add(2),await __PRIVATE_disableNetworkInternal(Ct),Ct.N_.set("Unknown"))}function __PRIVATE_ensureWatchStream(xt){return xt.B_||(xt.B_=function(Ct,kt,Mt){const Ft=__PRIVATE_debugCast(Ct);return Ft.f_(),new __PRIVATE_PersistentListenStream(kt,Ft.connection,Ft.authCredentials,Ft.appCheckCredentials,Ft.serializer,Mt)}(xt.datastore,xt.asyncQueue,{Po:__PRIVATE_onWatchStreamConnected.bind(null,xt),To:__PRIVATE_onWatchStreamOpen.bind(null,xt),Ao:__PRIVATE_onWatchStreamClose.bind(null,xt),h_:__PRIVATE_onWatchStreamChange.bind(null,xt)}),xt.x_.push(async $t=>{$t?(xt.B_.t_(),__PRIVATE_shouldStartWatchStream(xt)?__PRIVATE_startWatchStream(xt):xt.N_.set("Unknown")):(await xt.B_.stop(),__PRIVATE_cleanUpWatchStreamState(xt))})),xt.B_}function __PRIVATE_ensureWriteStream(xt){return xt.k_||(xt.k_=function(Ct,kt,Mt){const Ft=__PRIVATE_debugCast(Ct);return Ft.f_(),new __PRIVATE_PersistentWriteStream(kt,Ft.connection,Ft.authCredentials,Ft.appCheckCredentials,Ft.serializer,Mt)}(xt.datastore,xt.asyncQueue,{Po:()=>Promise.resolve(),To:__PRIVATE_onWriteStreamOpen.bind(null,xt),Ao:__PRIVATE_onWriteStreamClose.bind(null,xt),R_:__PRIVATE_onWriteHandshakeComplete.bind(null,xt),A_:__PRIVATE_onMutationResult.bind(null,xt)}),xt.x_.push(async $t=>{$t?(xt.k_.t_(),await __PRIVATE_fillWritePipeline(xt)):(await xt.k_.stop(),xt.v_.length>0&&(__PRIVATE_logDebug("RemoteStore",`Stopping write stream with ${xt.v_.length} pending writes`),xt.v_=[]))})),xt.k_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DelayedOperation{constructor($t,Ct,kt,Mt,Ft){this.asyncQueue=$t,this.timerId=Ct,this.targetTimeMs=kt,this.op=Mt,this.removalCallback=Ft,this.deferred=new __PRIVATE_Deferred,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(jt=>{})}get promise(){return this.deferred.promise}static createAndSchedule($t,Ct,kt,Mt,Ft){const jt=Date.now()+kt,Bt=new DelayedOperation($t,Ct,jt,Mt,Ft);return Bt.start(kt),Bt}start($t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),$t)}skipDelay(){return this.handleDelayElapsed()}cancel($t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new FirestoreError(C$1.CANCELLED,"Operation cancelled"+($t?": "+$t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then($t=>this.deferred.resolve($t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function __PRIVATE_wrapInUserErrorIfRecoverable(xt,$t){if(__PRIVATE_logError("AsyncQueue",`${$t}: ${xt}`),__PRIVATE_isIndexedDbTransactionError(xt))return new FirestoreError(C$1.UNAVAILABLE,`${$t}: ${xt}`);throw xt}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentSet{constructor($t){this.comparator=$t?(Ct,kt)=>$t(Ct,kt)||DocumentKey.comparator(Ct.key,kt.key):(Ct,kt)=>DocumentKey.comparator(Ct.key,kt.key),this.keyedMap=documentMap(),this.sortedSet=new SortedMap(this.comparator)}static emptySet($t){return new DocumentSet($t.comparator)}has($t){return this.keyedMap.get($t)!=null}get($t){return this.keyedMap.get($t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf($t){const Ct=this.keyedMap.get($t);return Ct?this.sortedSet.indexOf(Ct):-1}get size(){return this.sortedSet.size}forEach($t){this.sortedSet.inorderTraversal((Ct,kt)=>($t(Ct),!1))}add($t){const Ct=this.delete($t.key);return Ct.copy(Ct.keyedMap.insert($t.key,$t),Ct.sortedSet.insert($t,null))}delete($t){const Ct=this.get($t);return Ct?this.copy(this.keyedMap.remove($t),this.sortedSet.remove(Ct)):this}isEqual($t){if(!($t instanceof DocumentSet)||this.size!==$t.size)return!1;const Ct=this.sortedSet.getIterator(),kt=$t.sortedSet.getIterator();for(;Ct.hasNext();){const Mt=Ct.getNext().key,Ft=kt.getNext().key;if(!Mt.isEqual(Ft))return!1}return!0}toString(){const $t=[];return this.forEach(Ct=>{$t.push(Ct.toString())}),$t.length===0?"DocumentSet ()":`DocumentSet (
  `+$t.join(`  
`)+`
)`}copy($t,Ct){const kt=new DocumentSet;return kt.comparator=this.comparator,kt.keyedMap=$t,kt.sortedSet=Ct,kt}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DocumentChangeSet{constructor(){this.q_=new SortedMap(DocumentKey.comparator)}track($t){const Ct=$t.doc.key,kt=this.q_.get(Ct);kt?$t.type!==0&&kt.type===3?this.q_=this.q_.insert(Ct,$t):$t.type===3&&kt.type!==1?this.q_=this.q_.insert(Ct,{type:kt.type,doc:$t.doc}):$t.type===2&&kt.type===2?this.q_=this.q_.insert(Ct,{type:2,doc:$t.doc}):$t.type===2&&kt.type===0?this.q_=this.q_.insert(Ct,{type:0,doc:$t.doc}):$t.type===1&&kt.type===0?this.q_=this.q_.remove(Ct):$t.type===1&&kt.type===2?this.q_=this.q_.insert(Ct,{type:1,doc:kt.doc}):$t.type===0&&kt.type===1?this.q_=this.q_.insert(Ct,{type:2,doc:$t.doc}):fail():this.q_=this.q_.insert(Ct,$t)}Q_(){const $t=[];return this.q_.inorderTraversal((Ct,kt)=>{$t.push(kt)}),$t}}class ViewSnapshot{constructor($t,Ct,kt,Mt,Ft,jt,Bt,Vt,zt){this.query=$t,this.docs=Ct,this.oldDocs=kt,this.docChanges=Mt,this.mutatedKeys=Ft,this.fromCache=jt,this.syncStateChanged=Bt,this.excludesMetadataChanges=Vt,this.hasCachedResults=zt}static fromInitialDocuments($t,Ct,kt,Mt,Ft){const jt=[];return Ct.forEach(Bt=>{jt.push({type:0,doc:Bt})}),new ViewSnapshot($t,Ct,DocumentSet.emptySet(Ct),jt,kt,Mt,!0,!1,Ft)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual($t){if(!(this.fromCache===$t.fromCache&&this.hasCachedResults===$t.hasCachedResults&&this.syncStateChanged===$t.syncStateChanged&&this.mutatedKeys.isEqual($t.mutatedKeys)&&__PRIVATE_queryEquals(this.query,$t.query)&&this.docs.isEqual($t.docs)&&this.oldDocs.isEqual($t.oldDocs)))return!1;const Ct=this.docChanges,kt=$t.docChanges;if(Ct.length!==kt.length)return!1;for(let Mt=0;Mt<Ct.length;Mt++)if(Ct[Mt].type!==kt[Mt].type||!Ct[Mt].doc.isEqual(kt[Mt].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryListenersInfo{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some($t=>$t.G_())}}class __PRIVATE_EventManagerImpl{constructor(){this.queries=new ObjectMap($t=>__PRIVATE_canonifyQuery($t),__PRIVATE_queryEquals),this.onlineState="Unknown",this.z_=new Set}}async function __PRIVATE_eventManagerListen(xt,$t){const Ct=__PRIVATE_debugCast(xt);let kt=3;const Mt=$t.query;let Ft=Ct.queries.get(Mt);Ft?!Ft.W_()&&$t.G_()&&(kt=2):(Ft=new __PRIVATE_QueryListenersInfo,kt=$t.G_()?0:1);try{switch(kt){case 0:Ft.K_=await Ct.onListen(Mt,!0);break;case 1:Ft.K_=await Ct.onListen(Mt,!1);break;case 2:await Ct.onFirstRemoteStoreListen(Mt)}}catch(jt){const Bt=__PRIVATE_wrapInUserErrorIfRecoverable(jt,`Initialization of query '${__PRIVATE_stringifyQuery($t.query)}' failed`);return void $t.onError(Bt)}Ct.queries.set(Mt,Ft),Ft.U_.push($t),$t.j_(Ct.onlineState),Ft.K_&&$t.H_(Ft.K_)&&__PRIVATE_raiseSnapshotsInSyncEvent(Ct)}async function __PRIVATE_eventManagerUnlisten(xt,$t){const Ct=__PRIVATE_debugCast(xt),kt=$t.query;let Mt=3;const Ft=Ct.queries.get(kt);if(Ft){const jt=Ft.U_.indexOf($t);jt>=0&&(Ft.U_.splice(jt,1),Ft.U_.length===0?Mt=$t.G_()?0:1:!Ft.W_()&&$t.G_()&&(Mt=2))}switch(Mt){case 0:return Ct.queries.delete(kt),Ct.onUnlisten(kt,!0);case 1:return Ct.queries.delete(kt),Ct.onUnlisten(kt,!1);case 2:return Ct.onLastRemoteStoreUnlisten(kt);default:return}}function __PRIVATE_eventManagerOnWatchChange(xt,$t){const Ct=__PRIVATE_debugCast(xt);let kt=!1;for(const Mt of $t){const Ft=Mt.query,jt=Ct.queries.get(Ft);if(jt){for(const Bt of jt.U_)Bt.H_(Mt)&&(kt=!0);jt.K_=Mt}}kt&&__PRIVATE_raiseSnapshotsInSyncEvent(Ct)}function __PRIVATE_eventManagerOnWatchError(xt,$t,Ct){const kt=__PRIVATE_debugCast(xt),Mt=kt.queries.get($t);if(Mt)for(const Ft of Mt.U_)Ft.onError(Ct);kt.queries.delete($t)}function __PRIVATE_raiseSnapshotsInSyncEvent(xt){xt.z_.forEach($t=>{$t.next()})}var ge,pe;(pe=ge||(ge={})).J_="default",pe.Cache="cache";class __PRIVATE_QueryListener{constructor($t,Ct,kt){this.query=$t,this.Y_=Ct,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=kt||{}}H_($t){if(!this.options.includeMetadataChanges){const kt=[];for(const Mt of $t.docChanges)Mt.type!==3&&kt.push(Mt);$t=new ViewSnapshot($t.query,$t.docs,$t.oldDocs,kt,$t.mutatedKeys,$t.fromCache,$t.syncStateChanged,!0,$t.hasCachedResults)}let Ct=!1;return this.Z_?this.ea($t)&&(this.Y_.next($t),Ct=!0):this.ta($t,this.onlineState)&&(this.na($t),Ct=!0),this.X_=$t,Ct}onError($t){this.Y_.error($t)}j_($t){this.onlineState=$t;let Ct=!1;return this.X_&&!this.Z_&&this.ta(this.X_,$t)&&(this.na(this.X_),Ct=!0),Ct}ta($t,Ct){if(!$t.fromCache||!this.G_())return!0;const kt=Ct!=="Offline";return(!this.options.ra||!kt)&&(!$t.docs.isEmpty()||$t.hasCachedResults||Ct==="Offline")}ea($t){if($t.docChanges.length>0)return!0;const Ct=this.X_&&this.X_.hasPendingWrites!==$t.hasPendingWrites;return!(!$t.syncStateChanged&&!Ct)&&this.options.includeMetadataChanges===!0}na($t){$t=ViewSnapshot.fromInitialDocuments($t.query,$t.docs,$t.mutatedKeys,$t.fromCache,$t.hasCachedResults),this.Z_=!0,this.Y_.next($t)}G_(){return this.options.source!==ge.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AddedLimboDocument{constructor($t){this.key=$t}}class __PRIVATE_RemovedLimboDocument{constructor($t){this.key=$t}}class __PRIVATE_View{constructor($t,Ct){this.query=$t,this.la=Ct,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=__PRIVATE_documentKeySet(),this.mutatedKeys=__PRIVATE_documentKeySet(),this.Ia=__PRIVATE_newQueryComparator($t),this.Ta=new DocumentSet(this.Ia)}get Ea(){return this.la}da($t,Ct){const kt=Ct?Ct.Aa:new __PRIVATE_DocumentChangeSet,Mt=Ct?Ct.Ta:this.Ta;let Ft=Ct?Ct.mutatedKeys:this.mutatedKeys,jt=Mt,Bt=!1;const Vt=this.query.limitType==="F"&&Mt.size===this.query.limit?Mt.last():null,zt=this.query.limitType==="L"&&Mt.size===this.query.limit?Mt.first():null;if($t.inorderTraversal((Ht,Gt)=>{const qt=Mt.get(Ht),Wt=__PRIVATE_queryMatches(this.query,Gt)?Gt:null,Yt=!!qt&&this.mutatedKeys.has(qt.key),Kt=!!Wt&&(Wt.hasLocalMutations||this.mutatedKeys.has(Wt.key)&&Wt.hasCommittedMutations);let Xt=!1;qt&&Wt?qt.data.isEqual(Wt.data)?Yt!==Kt&&(kt.track({type:3,doc:Wt}),Xt=!0):this.Ra(qt,Wt)||(kt.track({type:2,doc:Wt}),Xt=!0,(Vt&&this.Ia(Wt,Vt)>0||zt&&this.Ia(Wt,zt)<0)&&(Bt=!0)):!qt&&Wt?(kt.track({type:0,doc:Wt}),Xt=!0):qt&&!Wt&&(kt.track({type:1,doc:qt}),Xt=!0,(Vt||zt)&&(Bt=!0)),Xt&&(Wt?(jt=jt.add(Wt),Ft=Kt?Ft.add(Ht):Ft.delete(Ht)):(jt=jt.delete(Ht),Ft=Ft.delete(Ht)))}),this.query.limit!==null)for(;jt.size>this.query.limit;){const Ht=this.query.limitType==="F"?jt.last():jt.first();jt=jt.delete(Ht.key),Ft=Ft.delete(Ht.key),kt.track({type:1,doc:Ht})}return{Ta:jt,Aa:kt,Xi:Bt,mutatedKeys:Ft}}Ra($t,Ct){return $t.hasLocalMutations&&Ct.hasCommittedMutations&&!Ct.hasLocalMutations}applyChanges($t,Ct,kt,Mt){const Ft=this.Ta;this.Ta=$t.Ta,this.mutatedKeys=$t.mutatedKeys;const jt=$t.Aa.Q_();jt.sort((Ht,Gt)=>function(Wt,Yt){const Kt=Xt=>{switch(Xt){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fail()}};return Kt(Wt)-Kt(Yt)}(Ht.type,Gt.type)||this.Ia(Ht.doc,Gt.doc)),this.Va(kt),Mt=Mt!=null&&Mt;const Bt=Ct&&!Mt?this.ma():[],Vt=this.Pa.size===0&&this.current&&!Mt?1:0,zt=Vt!==this.ha;return this.ha=Vt,jt.length!==0||zt?{snapshot:new ViewSnapshot(this.query,$t.Ta,Ft,jt,$t.mutatedKeys,Vt===0,zt,!1,!!kt&&kt.resumeToken.approximateByteSize()>0),fa:Bt}:{fa:Bt}}j_($t){return this.current&&$t==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new __PRIVATE_DocumentChangeSet,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga($t){return!this.la.has($t)&&!!this.Ta.has($t)&&!this.Ta.get($t).hasLocalMutations}Va($t){$t&&($t.addedDocuments.forEach(Ct=>this.la=this.la.add(Ct)),$t.modifiedDocuments.forEach(Ct=>{}),$t.removedDocuments.forEach(Ct=>this.la=this.la.delete(Ct)),this.current=$t.current)}ma(){if(!this.current)return[];const $t=this.Pa;this.Pa=__PRIVATE_documentKeySet(),this.Ta.forEach(kt=>{this.ga(kt.key)&&(this.Pa=this.Pa.add(kt.key))});const Ct=[];return $t.forEach(kt=>{this.Pa.has(kt)||Ct.push(new __PRIVATE_RemovedLimboDocument(kt))}),this.Pa.forEach(kt=>{$t.has(kt)||Ct.push(new __PRIVATE_AddedLimboDocument(kt))}),Ct}pa($t){this.la=$t.hs,this.Pa=__PRIVATE_documentKeySet();const Ct=this.da($t.documents);return this.applyChanges(Ct,!0)}ya(){return ViewSnapshot.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}}class __PRIVATE_QueryView{constructor($t,Ct,kt){this.query=$t,this.targetId=Ct,this.view=kt}}class LimboResolution{constructor($t){this.key=$t,this.wa=!1}}class __PRIVATE_SyncEngineImpl{constructor($t,Ct,kt,Mt,Ft,jt){this.localStore=$t,this.remoteStore=Ct,this.eventManager=kt,this.sharedClientState=Mt,this.currentUser=Ft,this.maxConcurrentLimboResolutions=jt,this.Sa={},this.ba=new ObjectMap(Bt=>__PRIVATE_canonifyQuery(Bt),__PRIVATE_queryEquals),this.Da=new Map,this.Ca=new Set,this.va=new SortedMap(DocumentKey.comparator),this.Fa=new Map,this.Ma=new __PRIVATE_ReferenceSet,this.xa={},this.Oa=new Map,this.Na=__PRIVATE_TargetIdGenerator.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}}async function __PRIVATE_syncEngineListen(xt,$t,Ct=!0){const kt=__PRIVATE_ensureWatchCallbacks(xt);let Mt;const Ft=kt.ba.get($t);return Ft?(kt.sharedClientState.addLocalQueryTarget(Ft.targetId),Mt=Ft.view.ya()):Mt=await __PRIVATE_allocateTargetAndMaybeListen(kt,$t,Ct,!0),Mt}async function __PRIVATE_triggerRemoteStoreListen(xt,$t){const Ct=__PRIVATE_ensureWatchCallbacks(xt);await __PRIVATE_allocateTargetAndMaybeListen(Ct,$t,!0,!1)}async function __PRIVATE_allocateTargetAndMaybeListen(xt,$t,Ct,kt){const Mt=await __PRIVATE_localStoreAllocateTarget(xt.localStore,__PRIVATE_queryToTarget($t)),Ft=Mt.targetId,jt=Ct?xt.sharedClientState.addLocalQueryTarget(Ft):"not-current";let Bt;return kt&&(Bt=await __PRIVATE_initializeViewAndComputeSnapshot(xt,$t,Ft,jt==="current",Mt.resumeToken)),xt.isPrimaryClient&&Ct&&__PRIVATE_remoteStoreListen(xt.remoteStore,Mt),Bt}async function __PRIVATE_initializeViewAndComputeSnapshot(xt,$t,Ct,kt,Mt){xt.Ba=(Gt,qt,Wt)=>async function(Kt,Xt,Qt,Jt){let Zt=Xt.view.da(Qt);Zt.Xi&&(Zt=await __PRIVATE_localStoreExecuteQuery(Kt.localStore,Xt.query,!1).then(({documents:hn})=>Xt.view.da(hn,Zt)));const sn=Jt&&Jt.targetChanges.get(Xt.targetId),ln=Jt&&Jt.targetMismatches.get(Xt.targetId)!=null,dn=Xt.view.applyChanges(Zt,Kt.isPrimaryClient,sn,ln);return __PRIVATE_updateTrackedLimbos(Kt,Xt.targetId,dn.fa),dn.snapshot}(xt,Gt,qt,Wt);const Ft=await __PRIVATE_localStoreExecuteQuery(xt.localStore,$t,!0),jt=new __PRIVATE_View($t,Ft.hs),Bt=jt.da(Ft.documents),Vt=TargetChange.createSynthesizedTargetChangeForCurrentChange(Ct,kt&&xt.onlineState!=="Offline",Mt),zt=jt.applyChanges(Bt,xt.isPrimaryClient,Vt);__PRIVATE_updateTrackedLimbos(xt,Ct,zt.fa);const Ht=new __PRIVATE_QueryView($t,Ct,jt);return xt.ba.set($t,Ht),xt.Da.has(Ct)?xt.Da.get(Ct).push($t):xt.Da.set(Ct,[$t]),zt.snapshot}async function __PRIVATE_syncEngineUnlisten(xt,$t,Ct){const kt=__PRIVATE_debugCast(xt),Mt=kt.ba.get($t),Ft=kt.Da.get(Mt.targetId);if(Ft.length>1)return kt.Da.set(Mt.targetId,Ft.filter(jt=>!__PRIVATE_queryEquals(jt,$t))),void kt.ba.delete($t);kt.isPrimaryClient?(kt.sharedClientState.removeLocalQueryTarget(Mt.targetId),kt.sharedClientState.isActiveQueryTarget(Mt.targetId)||await __PRIVATE_localStoreReleaseTarget(kt.localStore,Mt.targetId,!1).then(()=>{kt.sharedClientState.clearQueryState(Mt.targetId),Ct&&__PRIVATE_remoteStoreUnlisten(kt.remoteStore,Mt.targetId),__PRIVATE_removeAndCleanupTarget(kt,Mt.targetId)}).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)):(__PRIVATE_removeAndCleanupTarget(kt,Mt.targetId),await __PRIVATE_localStoreReleaseTarget(kt.localStore,Mt.targetId,!0))}async function __PRIVATE_triggerRemoteStoreUnlisten(xt,$t){const Ct=__PRIVATE_debugCast(xt),kt=Ct.ba.get($t),Mt=Ct.Da.get(kt.targetId);Ct.isPrimaryClient&&Mt.length===1&&(Ct.sharedClientState.removeLocalQueryTarget(kt.targetId),__PRIVATE_remoteStoreUnlisten(Ct.remoteStore,kt.targetId))}async function __PRIVATE_syncEngineWrite(xt,$t,Ct){const kt=__PRIVATE_syncEngineEnsureWriteCallbacks(xt);try{const Mt=await function(jt,Bt){const Vt=__PRIVATE_debugCast(jt),zt=Timestamp.now(),Ht=Bt.reduce((Wt,Yt)=>Wt.add(Yt.key),__PRIVATE_documentKeySet());let Gt,qt;return Vt.persistence.runTransaction("Locally write mutations","readwrite",Wt=>{let Yt=__PRIVATE_mutableDocumentMap(),Kt=__PRIVATE_documentKeySet();return Vt.os.getEntries(Wt,Ht).next(Xt=>{Yt=Xt,Yt.forEach((Qt,Jt)=>{Jt.isValidDocument()||(Kt=Kt.add(Qt))})}).next(()=>Vt.localDocuments.getOverlayedDocuments(Wt,Yt)).next(Xt=>{Gt=Xt;const Qt=[];for(const Jt of Bt){const Zt=__PRIVATE_mutationExtractBaseValue(Jt,Gt.get(Jt.key).overlayedDocument);Zt!=null&&Qt.push(new __PRIVATE_PatchMutation(Jt.key,Zt,__PRIVATE_extractFieldMask(Zt.value.mapValue),Precondition.exists(!0)))}return Vt.mutationQueue.addMutationBatch(Wt,zt,Qt,Bt)}).next(Xt=>{qt=Xt;const Qt=Xt.applyToLocalDocumentSet(Gt,Kt);return Vt.documentOverlayCache.saveOverlays(Wt,Xt.batchId,Qt)})}).then(()=>({batchId:qt.batchId,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(Gt)}))}(kt.localStore,$t);kt.sharedClientState.addPendingMutation(Mt.batchId),function(jt,Bt,Vt){let zt=jt.xa[jt.currentUser.toKey()];zt||(zt=new SortedMap(__PRIVATE_primitiveComparator)),zt=zt.insert(Bt,Vt),jt.xa[jt.currentUser.toKey()]=zt}(kt,Mt.batchId,Ct),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(kt,Mt.changes),await __PRIVATE_fillWritePipeline(kt.remoteStore)}catch(Mt){const Ft=__PRIVATE_wrapInUserErrorIfRecoverable(Mt,"Failed to persist write");Ct.reject(Ft)}}async function __PRIVATE_syncEngineApplyRemoteEvent(xt,$t){const Ct=__PRIVATE_debugCast(xt);try{const kt=await __PRIVATE_localStoreApplyRemoteEventToLocalCache(Ct.localStore,$t);$t.targetChanges.forEach((Mt,Ft)=>{const jt=Ct.Fa.get(Ft);jt&&(__PRIVATE_hardAssert(Mt.addedDocuments.size+Mt.modifiedDocuments.size+Mt.removedDocuments.size<=1),Mt.addedDocuments.size>0?jt.wa=!0:Mt.modifiedDocuments.size>0?__PRIVATE_hardAssert(jt.wa):Mt.removedDocuments.size>0&&(__PRIVATE_hardAssert(jt.wa),jt.wa=!1))}),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(Ct,kt,$t)}catch(kt){await __PRIVATE_ignoreIfPrimaryLeaseLoss(kt)}}function __PRIVATE_syncEngineApplyOnlineStateChange(xt,$t,Ct){const kt=__PRIVATE_debugCast(xt);if(kt.isPrimaryClient&&Ct===0||!kt.isPrimaryClient&&Ct===1){const Mt=[];kt.ba.forEach((Ft,jt)=>{const Bt=jt.view.j_($t);Bt.snapshot&&Mt.push(Bt.snapshot)}),function(jt,Bt){const Vt=__PRIVATE_debugCast(jt);Vt.onlineState=Bt;let zt=!1;Vt.queries.forEach((Ht,Gt)=>{for(const qt of Gt.U_)qt.j_(Bt)&&(zt=!0)}),zt&&__PRIVATE_raiseSnapshotsInSyncEvent(Vt)}(kt.eventManager,$t),Mt.length&&kt.Sa.h_(Mt),kt.onlineState=$t,kt.isPrimaryClient&&kt.sharedClientState.setOnlineState($t)}}async function __PRIVATE_syncEngineRejectListen(xt,$t,Ct){const kt=__PRIVATE_debugCast(xt);kt.sharedClientState.updateQueryState($t,"rejected",Ct);const Mt=kt.Fa.get($t),Ft=Mt&&Mt.key;if(Ft){let jt=new SortedMap(DocumentKey.comparator);jt=jt.insert(Ft,MutableDocument.newNoDocument(Ft,SnapshotVersion.min()));const Bt=__PRIVATE_documentKeySet().add(Ft),Vt=new RemoteEvent(SnapshotVersion.min(),new Map,new SortedMap(__PRIVATE_primitiveComparator),jt,Bt);await __PRIVATE_syncEngineApplyRemoteEvent(kt,Vt),kt.va=kt.va.remove(Ft),kt.Fa.delete($t),__PRIVATE_pumpEnqueuedLimboResolutions(kt)}else await __PRIVATE_localStoreReleaseTarget(kt.localStore,$t,!1).then(()=>__PRIVATE_removeAndCleanupTarget(kt,$t,Ct)).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)}async function __PRIVATE_syncEngineApplySuccessfulWrite(xt,$t){const Ct=__PRIVATE_debugCast(xt),kt=$t.batch.batchId;try{const Mt=await __PRIVATE_localStoreAcknowledgeBatch(Ct.localStore,$t);__PRIVATE_processUserCallback(Ct,kt,null),__PRIVATE_triggerPendingWritesCallbacks(Ct,kt),Ct.sharedClientState.updateMutationState(kt,"acknowledged"),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(Ct,Mt)}catch(Mt){await __PRIVATE_ignoreIfPrimaryLeaseLoss(Mt)}}async function __PRIVATE_syncEngineRejectFailedWrite(xt,$t,Ct){const kt=__PRIVATE_debugCast(xt);try{const Mt=await function(jt,Bt){const Vt=__PRIVATE_debugCast(jt);return Vt.persistence.runTransaction("Reject batch","readwrite-primary",zt=>{let Ht;return Vt.mutationQueue.lookupMutationBatch(zt,Bt).next(Gt=>(__PRIVATE_hardAssert(Gt!==null),Ht=Gt.keys(),Vt.mutationQueue.removeMutationBatch(zt,Gt))).next(()=>Vt.mutationQueue.performConsistencyCheck(zt)).next(()=>Vt.documentOverlayCache.removeOverlaysForBatchId(zt,Ht,Bt)).next(()=>Vt.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(zt,Ht)).next(()=>Vt.localDocuments.getDocuments(zt,Ht))})}(kt.localStore,$t);__PRIVATE_processUserCallback(kt,$t,Ct),__PRIVATE_triggerPendingWritesCallbacks(kt,$t),kt.sharedClientState.updateMutationState($t,"rejected",Ct),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(kt,Mt)}catch(Mt){await __PRIVATE_ignoreIfPrimaryLeaseLoss(Mt)}}function __PRIVATE_triggerPendingWritesCallbacks(xt,$t){(xt.Oa.get($t)||[]).forEach(Ct=>{Ct.resolve()}),xt.Oa.delete($t)}function __PRIVATE_processUserCallback(xt,$t,Ct){const kt=__PRIVATE_debugCast(xt);let Mt=kt.xa[kt.currentUser.toKey()];if(Mt){const Ft=Mt.get($t);Ft&&(Ct?Ft.reject(Ct):Ft.resolve(),Mt=Mt.remove($t)),kt.xa[kt.currentUser.toKey()]=Mt}}function __PRIVATE_removeAndCleanupTarget(xt,$t,Ct=null){xt.sharedClientState.removeLocalQueryTarget($t);for(const kt of xt.Da.get($t))xt.ba.delete(kt),Ct&&xt.Sa.ka(kt,Ct);xt.Da.delete($t),xt.isPrimaryClient&&xt.Ma.Vr($t).forEach(kt=>{xt.Ma.containsKey(kt)||__PRIVATE_removeLimboTarget(xt,kt)})}function __PRIVATE_removeLimboTarget(xt,$t){xt.Ca.delete($t.path.canonicalString());const Ct=xt.va.get($t);Ct!==null&&(__PRIVATE_remoteStoreUnlisten(xt.remoteStore,Ct),xt.va=xt.va.remove($t),xt.Fa.delete(Ct),__PRIVATE_pumpEnqueuedLimboResolutions(xt))}function __PRIVATE_updateTrackedLimbos(xt,$t,Ct){for(const kt of Ct)kt instanceof __PRIVATE_AddedLimboDocument?(xt.Ma.addReference(kt.key,$t),__PRIVATE_trackLimboChange(xt,kt)):kt instanceof __PRIVATE_RemovedLimboDocument?(__PRIVATE_logDebug("SyncEngine","Document no longer in limbo: "+kt.key),xt.Ma.removeReference(kt.key,$t),xt.Ma.containsKey(kt.key)||__PRIVATE_removeLimboTarget(xt,kt.key)):fail()}function __PRIVATE_trackLimboChange(xt,$t){const Ct=$t.key,kt=Ct.path.canonicalString();xt.va.get(Ct)||xt.Ca.has(kt)||(__PRIVATE_logDebug("SyncEngine","New document in limbo: "+Ct),xt.Ca.add(kt),__PRIVATE_pumpEnqueuedLimboResolutions(xt))}function __PRIVATE_pumpEnqueuedLimboResolutions(xt){for(;xt.Ca.size>0&&xt.va.size<xt.maxConcurrentLimboResolutions;){const $t=xt.Ca.values().next().value;xt.Ca.delete($t);const Ct=new DocumentKey(ResourcePath.fromString($t)),kt=xt.Na.next();xt.Fa.set(kt,new LimboResolution(Ct)),xt.va=xt.va.insert(Ct,kt),__PRIVATE_remoteStoreListen(xt.remoteStore,new TargetData(__PRIVATE_queryToTarget(__PRIVATE_newQueryForPath(Ct.path)),kt,"TargetPurposeLimboResolution",__PRIVATE_ListenSequence.oe))}}async function __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(xt,$t,Ct){const kt=__PRIVATE_debugCast(xt),Mt=[],Ft=[],jt=[];kt.ba.isEmpty()||(kt.ba.forEach((Bt,Vt)=>{jt.push(kt.Ba(Vt,$t,Ct).then(zt=>{if((zt||Ct)&&kt.isPrimaryClient){const Ht=zt&&!zt.fromCache;kt.sharedClientState.updateQueryState(Vt.targetId,Ht?"current":"not-current")}if(zt){Mt.push(zt);const Ht=__PRIVATE_LocalViewChanges.Ki(Vt.targetId,zt);Ft.push(Ht)}}))}),await Promise.all(jt),kt.Sa.h_(Mt),await async function(Vt,zt){const Ht=__PRIVATE_debugCast(Vt);try{await Ht.persistence.runTransaction("notifyLocalViewChanges","readwrite",Gt=>PersistencePromise.forEach(zt,qt=>PersistencePromise.forEach(qt.qi,Wt=>Ht.persistence.referenceDelegate.addReference(Gt,qt.targetId,Wt)).next(()=>PersistencePromise.forEach(qt.Qi,Wt=>Ht.persistence.referenceDelegate.removeReference(Gt,qt.targetId,Wt)))))}catch(Gt){if(!__PRIVATE_isIndexedDbTransactionError(Gt))throw Gt;__PRIVATE_logDebug("LocalStore","Failed to update sequence numbers: "+Gt)}for(const Gt of zt){const qt=Gt.targetId;if(!Gt.fromCache){const Wt=Ht.ns.get(qt),Yt=Wt.snapshotVersion,Kt=Wt.withLastLimboFreeSnapshotVersion(Yt);Ht.ns=Ht.ns.insert(qt,Kt)}}}(kt.localStore,Ft))}async function __PRIVATE_syncEngineHandleCredentialChange(xt,$t){const Ct=__PRIVATE_debugCast(xt);if(!Ct.currentUser.isEqual($t)){__PRIVATE_logDebug("SyncEngine","User change. New user:",$t.toKey());const kt=await __PRIVATE_localStoreHandleUserChange(Ct.localStore,$t);Ct.currentUser=$t,function(Ft,jt){Ft.Oa.forEach(Bt=>{Bt.forEach(Vt=>{Vt.reject(new FirestoreError(C$1.CANCELLED,jt))})}),Ft.Oa.clear()}(Ct,"'waitForPendingWrites' promise is rejected due to a user change."),Ct.sharedClientState.handleUserChange($t,kt.removedBatchIds,kt.addedBatchIds),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(Ct,kt.us)}}function __PRIVATE_syncEngineGetRemoteKeysForTarget(xt,$t){const Ct=__PRIVATE_debugCast(xt),kt=Ct.Fa.get($t);if(kt&&kt.wa)return __PRIVATE_documentKeySet().add(kt.key);{let Mt=__PRIVATE_documentKeySet();const Ft=Ct.Da.get($t);if(!Ft)return Mt;for(const jt of Ft){const Bt=Ct.ba.get(jt);Mt=Mt.unionWith(Bt.view.Ea)}return Mt}}function __PRIVATE_ensureWatchCallbacks(xt){const $t=__PRIVATE_debugCast(xt);return $t.remoteStore.remoteSyncer.applyRemoteEvent=__PRIVATE_syncEngineApplyRemoteEvent.bind(null,$t),$t.remoteStore.remoteSyncer.getRemoteKeysForTarget=__PRIVATE_syncEngineGetRemoteKeysForTarget.bind(null,$t),$t.remoteStore.remoteSyncer.rejectListen=__PRIVATE_syncEngineRejectListen.bind(null,$t),$t.Sa.h_=__PRIVATE_eventManagerOnWatchChange.bind(null,$t.eventManager),$t.Sa.ka=__PRIVATE_eventManagerOnWatchError.bind(null,$t.eventManager),$t}function __PRIVATE_syncEngineEnsureWriteCallbacks(xt){const $t=__PRIVATE_debugCast(xt);return $t.remoteStore.remoteSyncer.applySuccessfulWrite=__PRIVATE_syncEngineApplySuccessfulWrite.bind(null,$t),$t.remoteStore.remoteSyncer.rejectFailedWrite=__PRIVATE_syncEngineRejectFailedWrite.bind(null,$t),$t}class MemoryOfflineComponentProvider{constructor(){this.synchronizeTabs=!1}async initialize($t){this.serializer=__PRIVATE_newSerializer($t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState($t),this.persistence=this.createPersistence($t),await this.persistence.start(),this.localStore=this.createLocalStore($t),this.gcScheduler=this.createGarbageCollectionScheduler($t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler($t,this.localStore)}createGarbageCollectionScheduler($t,Ct){return null}createIndexBackfillerScheduler($t,Ct){return null}createLocalStore($t){return __PRIVATE_newLocalStore(this.persistence,new __PRIVATE_QueryEngine,$t.initialUser,this.serializer)}createPersistence($t){return new __PRIVATE_MemoryPersistence(__PRIVATE_MemoryEagerDelegate.Hr,this.serializer)}createSharedClientState($t){return new __PRIVATE_MemorySharedClientState}async terminate(){var $t,Ct;($t=this.gcScheduler)===null||$t===void 0||$t.stop(),(Ct=this.indexBackfillerScheduler)===null||Ct===void 0||Ct.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class OnlineComponentProvider{async initialize($t,Ct){this.localStore||(this.localStore=$t.localStore,this.sharedClientState=$t.sharedClientState,this.datastore=this.createDatastore(Ct),this.remoteStore=this.createRemoteStore(Ct),this.eventManager=this.createEventManager(Ct),this.syncEngine=this.createSyncEngine(Ct,!$t.synchronizeTabs),this.sharedClientState.onlineStateHandler=kt=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,kt,1),this.remoteStore.remoteSyncer.handleCredentialChange=__PRIVATE_syncEngineHandleCredentialChange.bind(null,this.syncEngine),await __PRIVATE_remoteStoreApplyPrimaryState(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager($t){return function(){return new __PRIVATE_EventManagerImpl}()}createDatastore($t){const Ct=__PRIVATE_newSerializer($t.databaseInfo.databaseId),kt=function(Ft){return new __PRIVATE_WebChannelConnection(Ft)}($t.databaseInfo);return function(Ft,jt,Bt,Vt){return new __PRIVATE_DatastoreImpl(Ft,jt,Bt,Vt)}($t.authCredentials,$t.appCheckCredentials,kt,Ct)}createRemoteStore($t){return function(kt,Mt,Ft,jt,Bt){return new __PRIVATE_RemoteStoreImpl(kt,Mt,Ft,jt,Bt)}(this.localStore,this.datastore,$t.asyncQueue,Ct=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,Ct,0),function(){return __PRIVATE_BrowserConnectivityMonitor.D()?new __PRIVATE_BrowserConnectivityMonitor:new __PRIVATE_NoopConnectivityMonitor}())}createSyncEngine($t,Ct){return function(Mt,Ft,jt,Bt,Vt,zt,Ht){const Gt=new __PRIVATE_SyncEngineImpl(Mt,Ft,jt,Bt,Vt,zt);return Ht&&(Gt.La=!0),Gt}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,$t.initialUser,$t.maxConcurrentLimboResolutions,Ct)}async terminate(){var $t;await async function(kt){const Mt=__PRIVATE_debugCast(kt);__PRIVATE_logDebug("RemoteStore","RemoteStore shutting down."),Mt.M_.add(5),await __PRIVATE_disableNetworkInternal(Mt),Mt.O_.shutdown(),Mt.N_.set("Unknown")}(this.remoteStore),($t=this.datastore)===null||$t===void 0||$t.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AsyncObserver{constructor($t){this.observer=$t,this.muted=!1}next($t){this.observer.next&&this.Ka(this.observer.next,$t)}error($t){this.observer.error?this.Ka(this.observer.error,$t):__PRIVATE_logError("Uncaught Error in snapshot listener:",$t.toString())}$a(){this.muted=!0}Ka($t,Ct){this.muted||setTimeout(()=>{this.muted||$t(Ct)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirestoreClient{constructor($t,Ct,kt,Mt){this.authCredentials=$t,this.appCheckCredentials=Ct,this.asyncQueue=kt,this.databaseInfo=Mt,this.user=User.UNAUTHENTICATED,this.clientId=__PRIVATE_AutoId.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(kt,async Ft=>{__PRIVATE_logDebug("FirestoreClient","Received user=",Ft.uid),await this.authCredentialListener(Ft),this.user=Ft}),this.appCheckCredentials.start(kt,Ft=>(__PRIVATE_logDebug("FirestoreClient","Received new app check token=",Ft),this.appCheckCredentialListener(Ft,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener($t){this.authCredentialListener=$t}setAppCheckTokenChangeListener($t){this.appCheckCredentialListener=$t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new FirestoreError(C$1.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const $t=new __PRIVATE_Deferred;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),$t.resolve()}catch(Ct){const kt=__PRIVATE_wrapInUserErrorIfRecoverable(Ct,"Failed to shutdown persistence");$t.reject(kt)}}),$t.promise}}async function __PRIVATE_setOfflineComponentProvider(xt,$t){xt.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug("FirestoreClient","Initializing OfflineComponentProvider");const Ct=xt.configuration;await $t.initialize(Ct);let kt=Ct.initialUser;xt.setCredentialChangeListener(async Mt=>{kt.isEqual(Mt)||(await __PRIVATE_localStoreHandleUserChange($t.localStore,Mt),kt=Mt)}),$t.persistence.setDatabaseDeletedListener(()=>xt.terminate()),xt._offlineComponents=$t}async function __PRIVATE_setOnlineComponentProvider(xt,$t){xt.asyncQueue.verifyOperationInProgress();const Ct=await __PRIVATE_ensureOfflineComponents(xt);__PRIVATE_logDebug("FirestoreClient","Initializing OnlineComponentProvider"),await $t.initialize(Ct,xt.configuration),xt.setCredentialChangeListener(kt=>__PRIVATE_remoteStoreHandleCredentialChange($t.remoteStore,kt)),xt.setAppCheckTokenChangeListener((kt,Mt)=>__PRIVATE_remoteStoreHandleCredentialChange($t.remoteStore,Mt)),xt._onlineComponents=$t}function __PRIVATE_canFallbackFromIndexedDbError(xt){return xt.name==="FirebaseError"?xt.code===C$1.FAILED_PRECONDITION||xt.code===C$1.UNIMPLEMENTED:!(typeof DOMException<"u"&&xt instanceof DOMException)||xt.code===22||xt.code===20||xt.code===11}async function __PRIVATE_ensureOfflineComponents(xt){if(!xt._offlineComponents)if(xt._uninitializedComponentsProvider){__PRIVATE_logDebug("FirestoreClient","Using user provided OfflineComponentProvider");try{await __PRIVATE_setOfflineComponentProvider(xt,xt._uninitializedComponentsProvider._offline)}catch($t){const Ct=$t;if(!__PRIVATE_canFallbackFromIndexedDbError(Ct))throw Ct;__PRIVATE_logWarn("Error using user provided cache. Falling back to memory cache: "+Ct),await __PRIVATE_setOfflineComponentProvider(xt,new MemoryOfflineComponentProvider)}}else __PRIVATE_logDebug("FirestoreClient","Using default OfflineComponentProvider"),await __PRIVATE_setOfflineComponentProvider(xt,new MemoryOfflineComponentProvider);return xt._offlineComponents}async function __PRIVATE_ensureOnlineComponents(xt){return xt._onlineComponents||(xt._uninitializedComponentsProvider?(__PRIVATE_logDebug("FirestoreClient","Using user provided OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(xt,xt._uninitializedComponentsProvider._online)):(__PRIVATE_logDebug("FirestoreClient","Using default OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(xt,new OnlineComponentProvider))),xt._onlineComponents}function __PRIVATE_getPersistence(xt){return __PRIVATE_ensureOfflineComponents(xt).then($t=>$t.persistence)}function __PRIVATE_getRemoteStore(xt){return __PRIVATE_ensureOnlineComponents(xt).then($t=>$t.remoteStore)}function __PRIVATE_getSyncEngine(xt){return __PRIVATE_ensureOnlineComponents(xt).then($t=>$t.syncEngine)}async function __PRIVATE_getEventManager(xt){const $t=await __PRIVATE_ensureOnlineComponents(xt),Ct=$t.eventManager;return Ct.onListen=__PRIVATE_syncEngineListen.bind(null,$t.syncEngine),Ct.onUnlisten=__PRIVATE_syncEngineUnlisten.bind(null,$t.syncEngine),Ct.onFirstRemoteStoreListen=__PRIVATE_triggerRemoteStoreListen.bind(null,$t.syncEngine),Ct.onLastRemoteStoreUnlisten=__PRIVATE_triggerRemoteStoreUnlisten.bind(null,$t.syncEngine),Ct}function __PRIVATE_firestoreClientEnableNetwork(xt){return xt.asyncQueue.enqueue(async()=>{const $t=await __PRIVATE_getPersistence(xt),Ct=await __PRIVATE_getRemoteStore(xt);return $t.setNetworkEnabled(!0),function(Mt){const Ft=__PRIVATE_debugCast(Mt);return Ft.M_.delete(0),__PRIVATE_enableNetworkInternal(Ft)}(Ct)})}function __PRIVATE_firestoreClientGetDocumentViaSnapshotListener(xt,$t,Ct={}){const kt=new __PRIVATE_Deferred;return xt.asyncQueue.enqueueAndForget(async()=>function(Ft,jt,Bt,Vt,zt){const Ht=new __PRIVATE_AsyncObserver({next:qt=>{jt.enqueueAndForget(()=>__PRIVATE_eventManagerUnlisten(Ft,Gt));const Wt=qt.docs.has(Bt);!Wt&&qt.fromCache?zt.reject(new FirestoreError(C$1.UNAVAILABLE,"Failed to get document because the client is offline.")):Wt&&qt.fromCache&&Vt&&Vt.source==="server"?zt.reject(new FirestoreError(C$1.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):zt.resolve(qt)},error:qt=>zt.reject(qt)}),Gt=new __PRIVATE_QueryListener(__PRIVATE_newQueryForPath(Bt.path),Ht,{includeMetadataChanges:!0,ra:!0});return __PRIVATE_eventManagerListen(Ft,Gt)}(await __PRIVATE_getEventManager(xt),xt.asyncQueue,$t,Ct,kt)),kt.promise}function __PRIVATE_firestoreClientGetDocumentsViaSnapshotListener(xt,$t,Ct={}){const kt=new __PRIVATE_Deferred;return xt.asyncQueue.enqueueAndForget(async()=>function(Ft,jt,Bt,Vt,zt){const Ht=new __PRIVATE_AsyncObserver({next:qt=>{jt.enqueueAndForget(()=>__PRIVATE_eventManagerUnlisten(Ft,Gt)),qt.fromCache&&Vt.source==="server"?zt.reject(new FirestoreError(C$1.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):zt.resolve(qt)},error:qt=>zt.reject(qt)}),Gt=new __PRIVATE_QueryListener(Bt,Ht,{includeMetadataChanges:!0,ra:!0});return __PRIVATE_eventManagerListen(Ft,Gt)}(await __PRIVATE_getEventManager(xt),xt.asyncQueue,$t,Ct,kt)),kt.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_cloneLongPollingOptions(xt){const $t={};return xt.timeoutSeconds!==void 0&&($t.timeoutSeconds=xt.timeoutSeconds),$t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ye=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateNonEmptyArgument(xt,$t,Ct){if(!Ct)throw new FirestoreError(C$1.INVALID_ARGUMENT,`Function ${xt}() cannot be called with an empty ${$t}.`)}function __PRIVATE_validateIsNotUsedTogether(xt,$t,Ct,kt){if($t===!0&&kt===!0)throw new FirestoreError(C$1.INVALID_ARGUMENT,`${xt} and ${Ct} cannot be used together.`)}function __PRIVATE_validateDocumentPath(xt){if(!DocumentKey.isDocumentKey(xt))throw new FirestoreError(C$1.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${xt} has ${xt.length}.`)}function __PRIVATE_validateCollectionPath(xt){if(DocumentKey.isDocumentKey(xt))throw new FirestoreError(C$1.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${xt} has ${xt.length}.`)}function __PRIVATE_valueDescription(xt){if(xt===void 0)return"undefined";if(xt===null)return"null";if(typeof xt=="string")return xt.length>20&&(xt=`${xt.substring(0,20)}...`),JSON.stringify(xt);if(typeof xt=="number"||typeof xt=="boolean")return""+xt;if(typeof xt=="object"){if(xt instanceof Array)return"an array";{const $t=function(kt){return kt.constructor?kt.constructor.name:null}(xt);return $t?`a custom ${$t} object`:"an object"}}return typeof xt=="function"?"a function":fail()}function __PRIVATE_cast(xt,$t){if("_delegate"in xt&&(xt=xt._delegate),!(xt instanceof $t)){if($t.name===xt.constructor.name)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const Ct=__PRIVATE_valueDescription(xt);throw new FirestoreError(C$1.INVALID_ARGUMENT,`Expected type '${$t.name}', but it was: ${Ct}`)}}return xt}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirestoreSettingsImpl{constructor($t){var Ct,kt;if($t.host===void 0){if($t.ssl!==void 0)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=$t.host,this.ssl=(Ct=$t.ssl)===null||Ct===void 0||Ct;if(this.credentials=$t.credentials,this.ignoreUndefinedProperties=!!$t.ignoreUndefinedProperties,this.localCache=$t.localCache,$t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if($t.cacheSizeBytes!==-1&&$t.cacheSizeBytes<1048576)throw new FirestoreError(C$1.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=$t.cacheSizeBytes}__PRIVATE_validateIsNotUsedTogether("experimentalForceLongPolling",$t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",$t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!$t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:$t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!$t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=__PRIVATE_cloneLongPollingOptions((kt=$t.experimentalLongPollingOptions)!==null&&kt!==void 0?kt:{}),function(Ft){if(Ft.timeoutSeconds!==void 0){if(isNaN(Ft.timeoutSeconds))throw new FirestoreError(C$1.INVALID_ARGUMENT,`invalid long polling timeout: ${Ft.timeoutSeconds} (must not be NaN)`);if(Ft.timeoutSeconds<5)throw new FirestoreError(C$1.INVALID_ARGUMENT,`invalid long polling timeout: ${Ft.timeoutSeconds} (minimum allowed value is 5)`);if(Ft.timeoutSeconds>30)throw new FirestoreError(C$1.INVALID_ARGUMENT,`invalid long polling timeout: ${Ft.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!$t.useFetchStreams}isEqual($t){return this.host===$t.host&&this.ssl===$t.ssl&&this.credentials===$t.credentials&&this.cacheSizeBytes===$t.cacheSizeBytes&&this.experimentalForceLongPolling===$t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===$t.experimentalAutoDetectLongPolling&&function(kt,Mt){return kt.timeoutSeconds===Mt.timeoutSeconds}(this.experimentalLongPollingOptions,$t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===$t.ignoreUndefinedProperties&&this.useFetchStreams===$t.useFetchStreams}}class Firestore$1{constructor($t,Ct,kt,Mt){this._authCredentials=$t,this._appCheckCredentials=Ct,this._databaseId=kt,this._app=Mt,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FirestoreSettingsImpl({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new FirestoreError(C$1.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings($t){if(this._settingsFrozen)throw new FirestoreError(C$1.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FirestoreSettingsImpl($t),$t.credentials!==void 0&&(this._authCredentials=function(kt){if(!kt)return new __PRIVATE_EmptyAuthCredentialsProvider;switch(kt.type){case"firstParty":return new __PRIVATE_FirstPartyAuthCredentialsProvider(kt.sessionIndex||"0",kt.iamToken||null,kt.authTokenFactory||null);case"provider":return kt.client;default:throw new FirestoreError(C$1.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}($t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(Ct){const kt=ye.get(Ct);kt&&(__PRIVATE_logDebug("ComponentProvider","Removing Datastore"),ye.delete(Ct),kt.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Query{constructor($t,Ct,kt){this.converter=Ct,this._query=kt,this.type="query",this.firestore=$t}withConverter($t){return new Query(this.firestore,$t,this._query)}}class DocumentReference{constructor($t,Ct,kt){this.converter=Ct,this._key=kt,this.type="document",this.firestore=$t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new CollectionReference(this.firestore,this.converter,this._key.path.popLast())}withConverter($t){return new DocumentReference(this.firestore,$t,this._key)}}class CollectionReference extends Query{constructor($t,Ct,kt){super($t,Ct,__PRIVATE_newQueryForPath(kt)),this._path=kt,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const $t=this._path.popLast();return $t.isEmpty()?null:new DocumentReference(this.firestore,null,new DocumentKey($t))}withConverter($t){return new CollectionReference(this.firestore,$t,this._path)}}function collection(xt,$t,...Ct){if(xt=getModularInstance(xt),__PRIVATE_validateNonEmptyArgument("collection","path",$t),xt instanceof Firestore$1){const kt=ResourcePath.fromString($t,...Ct);return __PRIVATE_validateCollectionPath(kt),new CollectionReference(xt,null,kt)}{if(!(xt instanceof DocumentReference||xt instanceof CollectionReference))throw new FirestoreError(C$1.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const kt=xt._path.child(ResourcePath.fromString($t,...Ct));return __PRIVATE_validateCollectionPath(kt),new CollectionReference(xt.firestore,null,kt)}}function doc(xt,$t,...Ct){if(xt=getModularInstance(xt),arguments.length===1&&($t=__PRIVATE_AutoId.newId()),__PRIVATE_validateNonEmptyArgument("doc","path",$t),xt instanceof Firestore$1){const kt=ResourcePath.fromString($t,...Ct);return __PRIVATE_validateDocumentPath(kt),new DocumentReference(xt,null,new DocumentKey(kt))}{if(!(xt instanceof DocumentReference||xt instanceof CollectionReference))throw new FirestoreError(C$1.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const kt=xt._path.child(ResourcePath.fromString($t,...Ct));return __PRIVATE_validateDocumentPath(kt),new DocumentReference(xt.firestore,xt instanceof CollectionReference?xt.converter:null,new DocumentKey(kt))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AsyncQueueImpl{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new __PRIVATE_ExponentialBackoff(this,"async_queue_retry"),this.hu=()=>{const Ct=getDocument();Ct&&__PRIVATE_logDebug("AsyncQueue","Visibility state changed to "+Ct.visibilityState),this.Yo.Wo()};const $t=getDocument();$t&&typeof $t.addEventListener=="function"&&$t.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget($t){this.enqueue($t)}enqueueAndForgetEvenWhileRestricted($t){this.Pu(),this.Iu($t)}enterRestrictedMode($t){if(!this.ou){this.ou=!0,this.cu=$t||!1;const Ct=getDocument();Ct&&typeof Ct.removeEventListener=="function"&&Ct.removeEventListener("visibilitychange",this.hu)}}enqueue($t){if(this.Pu(),this.ou)return new Promise(()=>{});const Ct=new __PRIVATE_Deferred;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():($t().then(Ct.resolve,Ct.reject),Ct.promise)).then(()=>Ct.promise)}enqueueRetryable($t){this.enqueueAndForget(()=>(this.su.push($t),this.Tu()))}async Tu(){if(this.su.length!==0){try{await this.su[0](),this.su.shift(),this.Yo.reset()}catch($t){if(!__PRIVATE_isIndexedDbTransactionError($t))throw $t;__PRIVATE_logDebug("AsyncQueue","Operation failed with retryable error: "+$t)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}}Iu($t){const Ct=this.iu.then(()=>(this.uu=!0,$t().catch(kt=>{this.au=kt,this.uu=!1;const Mt=function(jt){let Bt=jt.message||"";return jt.stack&&(Bt=jt.stack.includes(jt.message)?jt.stack:jt.message+`
`+jt.stack),Bt}(kt);throw __PRIVATE_logError("INTERNAL UNHANDLED ERROR: ",Mt),kt}).then(kt=>(this.uu=!1,kt))));return this.iu=Ct,Ct}enqueueAfterDelay($t,Ct,kt){this.Pu(),this.lu.indexOf($t)>-1&&(Ct=0);const Mt=DelayedOperation.createAndSchedule(this,$t,Ct,kt,Ft=>this.Eu(Ft));return this._u.push(Mt),Mt}Pu(){this.au&&fail()}verifyOperationInProgress(){}async du(){let $t;do $t=this.iu,await $t;while($t!==this.iu)}Au($t){for(const Ct of this._u)if(Ct.timerId===$t)return!0;return!1}Ru($t){return this.du().then(()=>{this._u.sort((Ct,kt)=>Ct.targetTimeMs-kt.targetTimeMs);for(const Ct of this._u)if(Ct.skipDelay(),$t!=="all"&&Ct.timerId===$t)break;return this.du()})}Vu($t){this.lu.push($t)}Eu($t){const Ct=this._u.indexOf($t);this._u.splice(Ct,1)}}class Firestore extends Firestore$1{constructor($t,Ct,kt,Mt){super($t,Ct,kt,Mt),this.type="firestore",this._queue=function(){return new __PRIVATE_AsyncQueueImpl}(),this._persistenceKey=(Mt==null?void 0:Mt.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||__PRIVATE_configureFirestore(this),this._firestoreClient.terminate()}}function initializeFirestore(xt,$t,Ct){Ct||(Ct="(default)");const kt=_getProvider(xt,"firestore");if(kt.isInitialized(Ct)){const Mt=kt.getImmediate({identifier:Ct}),Ft=kt.getOptions(Ct);if(deepEqual$1(Ft,$t))return Mt;throw new FirestoreError(C$1.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if($t.cacheSizeBytes!==void 0&&$t.localCache!==void 0)throw new FirestoreError(C$1.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if($t.cacheSizeBytes!==void 0&&$t.cacheSizeBytes!==-1&&$t.cacheSizeBytes<1048576)throw new FirestoreError(C$1.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return kt.initialize({options:$t,instanceIdentifier:Ct})}function ensureFirestoreConfigured(xt){return xt._firestoreClient||__PRIVATE_configureFirestore(xt),xt._firestoreClient.verifyNotTerminated(),xt._firestoreClient}function __PRIVATE_configureFirestore(xt){var $t,Ct,kt;const Mt=xt._freezeSettings(),Ft=function(Bt,Vt,zt,Ht){return new DatabaseInfo(Bt,Vt,zt,Ht.host,Ht.ssl,Ht.experimentalForceLongPolling,Ht.experimentalAutoDetectLongPolling,__PRIVATE_cloneLongPollingOptions(Ht.experimentalLongPollingOptions),Ht.useFetchStreams)}(xt._databaseId,(($t=xt._app)===null||$t===void 0?void 0:$t.options.appId)||"",xt._persistenceKey,Mt);xt._firestoreClient=new FirestoreClient(xt._authCredentials,xt._appCheckCredentials,xt._queue,Ft),!((Ct=Mt.localCache)===null||Ct===void 0)&&Ct._offlineComponentProvider&&(!((kt=Mt.localCache)===null||kt===void 0)&&kt._onlineComponentProvider)&&(xt._firestoreClient._uninitializedComponentsProvider={_offlineKind:Mt.localCache.kind,_offline:Mt.localCache._offlineComponentProvider,_online:Mt.localCache._onlineComponentProvider})}function enableNetwork(xt){return __PRIVATE_firestoreClientEnableNetwork(ensureFirestoreConfigured(xt=__PRIVATE_cast(xt,Firestore)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bytes{constructor($t){this._byteString=$t}static fromBase64String($t){try{return new Bytes(ByteString.fromBase64String($t))}catch(Ct){throw new FirestoreError(C$1.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+Ct)}}static fromUint8Array($t){return new Bytes(ByteString.fromUint8Array($t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual($t){return this._byteString.isEqual($t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldPath{constructor(...$t){for(let Ct=0;Ct<$t.length;++Ct)if($t[Ct].length===0)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new FieldPath$1($t)}isEqual($t){return this._internalPath.isEqual($t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldValue{constructor($t){this._methodName=$t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GeoPoint$1=class{constructor($t,Ct){if(!isFinite($t)||$t<-90||$t>90)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+$t);if(!isFinite(Ct)||Ct<-180||Ct>180)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+Ct);this._lat=$t,this._long=Ct}get latitude(){return this._lat}get longitude(){return this._long}isEqual($t){return this._lat===$t._lat&&this._long===$t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo($t){return __PRIVATE_primitiveComparator(this._lat,$t._lat)||__PRIVATE_primitiveComparator(this._long,$t._long)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Se=/^__.*__$/;class ParsedSetData{constructor($t,Ct,kt){this.data=$t,this.fieldMask=Ct,this.fieldTransforms=kt}toMutation($t,Ct){return this.fieldMask!==null?new __PRIVATE_PatchMutation($t,this.data,this.fieldMask,Ct,this.fieldTransforms):new __PRIVATE_SetMutation($t,this.data,Ct,this.fieldTransforms)}}class ParsedUpdateData{constructor($t,Ct,kt){this.data=$t,this.fieldMask=Ct,this.fieldTransforms=kt}toMutation($t,Ct){return new __PRIVATE_PatchMutation($t,this.data,this.fieldMask,Ct,this.fieldTransforms)}}function __PRIVATE_isWrite(xt){switch(xt){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fail()}}class __PRIVATE_ParseContextImpl{constructor($t,Ct,kt,Mt,Ft,jt){this.settings=$t,this.databaseId=Ct,this.serializer=kt,this.ignoreUndefinedProperties=Mt,Ft===void 0&&this.mu(),this.fieldTransforms=Ft||[],this.fieldMask=jt||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu($t){return new __PRIVATE_ParseContextImpl(Object.assign(Object.assign({},this.settings),$t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu($t){var Ct;const kt=(Ct=this.path)===null||Ct===void 0?void 0:Ct.child($t),Mt=this.gu({path:kt,yu:!1});return Mt.wu($t),Mt}Su($t){var Ct;const kt=(Ct=this.path)===null||Ct===void 0?void 0:Ct.child($t),Mt=this.gu({path:kt,yu:!1});return Mt.mu(),Mt}bu($t){return this.gu({path:void 0,yu:!0})}Du($t){return __PRIVATE_createError($t,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains($t){return this.fieldMask.find(Ct=>$t.isPrefixOf(Ct))!==void 0||this.fieldTransforms.find(Ct=>$t.isPrefixOf(Ct.field))!==void 0}mu(){if(this.path)for(let $t=0;$t<this.path.length;$t++)this.wu(this.path.get($t))}wu($t){if($t.length===0)throw this.Du("Document fields must not be empty");if(__PRIVATE_isWrite(this.fu)&&Se.test($t))throw this.Du('Document fields cannot begin and end with "__"')}}class __PRIVATE_UserDataReader{constructor($t,Ct,kt){this.databaseId=$t,this.ignoreUndefinedProperties=Ct,this.serializer=kt||__PRIVATE_newSerializer($t)}Fu($t,Ct,kt,Mt=!1){return new __PRIVATE_ParseContextImpl({fu:$t,methodName:Ct,vu:kt,path:FieldPath$1.emptyPath(),yu:!1,Cu:Mt},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function __PRIVATE_newUserDataReader(xt){const $t=xt._freezeSettings(),Ct=__PRIVATE_newSerializer(xt._databaseId);return new __PRIVATE_UserDataReader(xt._databaseId,!!$t.ignoreUndefinedProperties,Ct)}function __PRIVATE_parseSetData(xt,$t,Ct,kt,Mt,Ft={}){const jt=xt.Fu(Ft.merge||Ft.mergeFields?2:0,$t,Ct,Mt);__PRIVATE_validatePlainObject("Data must be an object, but it was:",jt,kt);const Bt=__PRIVATE_parseObject(kt,jt);let Vt,zt;if(Ft.merge)Vt=new FieldMask(jt.fieldMask),zt=jt.fieldTransforms;else if(Ft.mergeFields){const Ht=[];for(const Gt of Ft.mergeFields){const qt=__PRIVATE_fieldPathFromArgument$1($t,Gt,Ct);if(!jt.contains(qt))throw new FirestoreError(C$1.INVALID_ARGUMENT,`Field '${qt}' is specified in your field mask but missing from your input data.`);__PRIVATE_fieldMaskContains(Ht,qt)||Ht.push(qt)}Vt=new FieldMask(Ht),zt=jt.fieldTransforms.filter(Gt=>Vt.covers(Gt.field))}else Vt=null,zt=jt.fieldTransforms;return new ParsedSetData(new ObjectValue(Bt),Vt,zt)}class __PRIVATE_DeleteFieldValueImpl extends FieldValue{_toFieldTransform($t){if($t.fu!==2)throw $t.fu===1?$t.Du(`${this._methodName}() can only appear at the top level of your update data`):$t.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return $t.fieldMask.push($t.path),null}isEqual($t){return $t instanceof __PRIVATE_DeleteFieldValueImpl}}class __PRIVATE_ServerTimestampFieldValueImpl extends FieldValue{_toFieldTransform($t){return new FieldTransform($t.path,new __PRIVATE_ServerTimestampTransform)}isEqual($t){return $t instanceof __PRIVATE_ServerTimestampFieldValueImpl}}function __PRIVATE_parseUpdateData(xt,$t,Ct,kt){const Mt=xt.Fu(1,$t,Ct);__PRIVATE_validatePlainObject("Data must be an object, but it was:",Mt,kt);const Ft=[],jt=ObjectValue.empty();forEach$1(kt,(Vt,zt)=>{const Ht=__PRIVATE_fieldPathFromDotSeparatedString($t,Vt,Ct);zt=getModularInstance(zt);const Gt=Mt.Su(Ht);if(zt instanceof __PRIVATE_DeleteFieldValueImpl)Ft.push(Ht);else{const qt=__PRIVATE_parseData(zt,Gt);qt!=null&&(Ft.push(Ht),jt.set(Ht,qt))}});const Bt=new FieldMask(Ft);return new ParsedUpdateData(jt,Bt,Mt.fieldTransforms)}function __PRIVATE_parseUpdateVarargs(xt,$t,Ct,kt,Mt,Ft){const jt=xt.Fu(1,$t,Ct),Bt=[__PRIVATE_fieldPathFromArgument$1($t,kt,Ct)],Vt=[Mt];if(Ft.length%2!=0)throw new FirestoreError(C$1.INVALID_ARGUMENT,`Function ${$t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let qt=0;qt<Ft.length;qt+=2)Bt.push(__PRIVATE_fieldPathFromArgument$1($t,Ft[qt])),Vt.push(Ft[qt+1]);const zt=[],Ht=ObjectValue.empty();for(let qt=Bt.length-1;qt>=0;--qt)if(!__PRIVATE_fieldMaskContains(zt,Bt[qt])){const Wt=Bt[qt];let Yt=Vt[qt];Yt=getModularInstance(Yt);const Kt=jt.Su(Wt);if(Yt instanceof __PRIVATE_DeleteFieldValueImpl)zt.push(Wt);else{const Xt=__PRIVATE_parseData(Yt,Kt);Xt!=null&&(zt.push(Wt),Ht.set(Wt,Xt))}}const Gt=new FieldMask(zt);return new ParsedUpdateData(Ht,Gt,jt.fieldTransforms)}function __PRIVATE_parseQueryValue(xt,$t,Ct,kt=!1){return __PRIVATE_parseData(Ct,xt.Fu(kt?4:3,$t))}function __PRIVATE_parseData(xt,$t){if(__PRIVATE_looksLikeJsonObject(xt=getModularInstance(xt)))return __PRIVATE_validatePlainObject("Unsupported field value:",$t,xt),__PRIVATE_parseObject(xt,$t);if(xt instanceof FieldValue)return function(kt,Mt){if(!__PRIVATE_isWrite(Mt.fu))throw Mt.Du(`${kt._methodName}() can only be used with update() and set()`);if(!Mt.path)throw Mt.Du(`${kt._methodName}() is not currently supported inside arrays`);const Ft=kt._toFieldTransform(Mt);Ft&&Mt.fieldTransforms.push(Ft)}(xt,$t),null;if(xt===void 0&&$t.ignoreUndefinedProperties)return null;if($t.path&&$t.fieldMask.push($t.path),xt instanceof Array){if($t.settings.yu&&$t.fu!==4)throw $t.Du("Nested arrays are not supported");return function(kt,Mt){const Ft=[];let jt=0;for(const Bt of kt){let Vt=__PRIVATE_parseData(Bt,Mt.bu(jt));Vt==null&&(Vt={nullValue:"NULL_VALUE"}),Ft.push(Vt),jt++}return{arrayValue:{values:Ft}}}(xt,$t)}return function(kt,Mt){if((kt=getModularInstance(kt))===null)return{nullValue:"NULL_VALUE"};if(typeof kt=="number")return toNumber$1(Mt.serializer,kt);if(typeof kt=="boolean")return{booleanValue:kt};if(typeof kt=="string")return{stringValue:kt};if(kt instanceof Date){const Ft=Timestamp.fromDate(kt);return{timestampValue:toTimestamp(Mt.serializer,Ft)}}if(kt instanceof Timestamp){const Ft=new Timestamp(kt.seconds,1e3*Math.floor(kt.nanoseconds/1e3));return{timestampValue:toTimestamp(Mt.serializer,Ft)}}if(kt instanceof GeoPoint$1)return{geoPointValue:{latitude:kt.latitude,longitude:kt.longitude}};if(kt instanceof Bytes)return{bytesValue:__PRIVATE_toBytes(Mt.serializer,kt._byteString)};if(kt instanceof DocumentReference){const Ft=Mt.databaseId,jt=kt.firestore._databaseId;if(!jt.isEqual(Ft))throw Mt.Du(`Document reference is for database ${jt.projectId}/${jt.database} but should be for database ${Ft.projectId}/${Ft.database}`);return{referenceValue:__PRIVATE_toResourceName(kt.firestore._databaseId||Mt.databaseId,kt._key.path)}}throw Mt.Du(`Unsupported field value: ${__PRIVATE_valueDescription(kt)}`)}(xt,$t)}function __PRIVATE_parseObject(xt,$t){const Ct={};return isEmpty$1(xt)?$t.path&&$t.path.length>0&&$t.fieldMask.push($t.path):forEach$1(xt,(kt,Mt)=>{const Ft=__PRIVATE_parseData(Mt,$t.pu(kt));Ft!=null&&(Ct[kt]=Ft)}),{mapValue:{fields:Ct}}}function __PRIVATE_looksLikeJsonObject(xt){return!(typeof xt!="object"||xt===null||xt instanceof Array||xt instanceof Date||xt instanceof Timestamp||xt instanceof GeoPoint$1||xt instanceof Bytes||xt instanceof DocumentReference||xt instanceof FieldValue)}function __PRIVATE_validatePlainObject(xt,$t,Ct){if(!__PRIVATE_looksLikeJsonObject(Ct)||!function(Mt){return typeof Mt=="object"&&Mt!==null&&(Object.getPrototypeOf(Mt)===Object.prototype||Object.getPrototypeOf(Mt)===null)}(Ct)){const kt=__PRIVATE_valueDescription(Ct);throw kt==="an object"?$t.Du(xt+" a custom object"):$t.Du(xt+" "+kt)}}function __PRIVATE_fieldPathFromArgument$1(xt,$t,Ct){if(($t=getModularInstance($t))instanceof FieldPath)return $t._internalPath;if(typeof $t=="string")return __PRIVATE_fieldPathFromDotSeparatedString(xt,$t);throw __PRIVATE_createError("Field path arguments must be of type string or ",xt,!1,void 0,Ct)}const be=new RegExp("[~\\*/\\[\\]]");function __PRIVATE_fieldPathFromDotSeparatedString(xt,$t,Ct){if($t.search(be)>=0)throw __PRIVATE_createError(`Invalid field path (${$t}). Paths must not contain '~', '*', '/', '[', or ']'`,xt,!1,void 0,Ct);try{return new FieldPath(...$t.split("."))._internalPath}catch{throw __PRIVATE_createError(`Invalid field path (${$t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,xt,!1,void 0,Ct)}}function __PRIVATE_createError(xt,$t,Ct,kt,Mt){const Ft=kt&&!kt.isEmpty(),jt=Mt!==void 0;let Bt=`Function ${$t}() called with invalid data`;Ct&&(Bt+=" (via `toFirestore()`)"),Bt+=". ";let Vt="";return(Ft||jt)&&(Vt+=" (found",Ft&&(Vt+=` in field ${kt}`),jt&&(Vt+=` in document ${Mt}`),Vt+=")"),new FirestoreError(C$1.INVALID_ARGUMENT,Bt+xt+Vt)}function __PRIVATE_fieldMaskContains(xt,$t){return xt.some(Ct=>Ct.isEqual($t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentSnapshot$1{constructor($t,Ct,kt,Mt,Ft){this._firestore=$t,this._userDataWriter=Ct,this._key=kt,this._document=Mt,this._converter=Ft}get id(){return this._key.path.lastSegment()}get ref(){return new DocumentReference(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const $t=new QueryDocumentSnapshot$1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore($t)}return this._userDataWriter.convertValue(this._document.data.value)}}get($t){if(this._document){const Ct=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",$t));if(Ct!==null)return this._userDataWriter.convertValue(Ct)}}}class QueryDocumentSnapshot$1 extends DocumentSnapshot$1{data(){return super.data()}}function __PRIVATE_fieldPathFromArgument(xt,$t){return typeof $t=="string"?__PRIVATE_fieldPathFromDotSeparatedString(xt,$t):$t instanceof FieldPath?$t._internalPath:$t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateHasExplicitOrderByForLimitToLast(xt){if(xt.limitType==="L"&&xt.explicitOrderBy.length===0)throw new FirestoreError(C$1.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AppliableConstraint{}class QueryConstraint extends AppliableConstraint{}function query(xt,$t,...Ct){let kt=[];$t instanceof AppliableConstraint&&kt.push($t),kt=kt.concat(Ct),function(Ft){const jt=Ft.filter(Vt=>Vt instanceof QueryCompositeFilterConstraint).length,Bt=Ft.filter(Vt=>Vt instanceof QueryFieldFilterConstraint).length;if(jt>1||jt>0&&Bt>0)throw new FirestoreError(C$1.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(kt);for(const Mt of kt)xt=Mt._apply(xt);return xt}class QueryFieldFilterConstraint extends QueryConstraint{constructor($t,Ct,kt){super(),this._field=$t,this._op=Ct,this._value=kt,this.type="where"}static _create($t,Ct,kt){return new QueryFieldFilterConstraint($t,Ct,kt)}_apply($t){const Ct=this._parse($t);return __PRIVATE_validateNewFieldFilter($t._query,Ct),new Query($t.firestore,$t.converter,__PRIVATE_queryWithAddedFilter($t._query,Ct))}_parse($t){const Ct=__PRIVATE_newUserDataReader($t.firestore);return function(Ft,jt,Bt,Vt,zt,Ht,Gt){let qt;if(zt.isKeyField()){if(Ht==="array-contains"||Ht==="array-contains-any")throw new FirestoreError(C$1.INVALID_ARGUMENT,`Invalid Query. You can't perform '${Ht}' queries on documentId().`);if(Ht==="in"||Ht==="not-in"){__PRIVATE_validateDisjunctiveFilterElements(Gt,Ht);const Wt=[];for(const Yt of Gt)Wt.push(__PRIVATE_parseDocumentIdValue(Vt,Ft,Yt));qt={arrayValue:{values:Wt}}}else qt=__PRIVATE_parseDocumentIdValue(Vt,Ft,Gt)}else Ht!=="in"&&Ht!=="not-in"&&Ht!=="array-contains-any"||__PRIVATE_validateDisjunctiveFilterElements(Gt,Ht),qt=__PRIVATE_parseQueryValue(Bt,jt,Gt,Ht==="in"||Ht==="not-in");return FieldFilter.create(zt,Ht,qt)}($t._query,"where",Ct,$t.firestore._databaseId,this._field,this._op,this._value)}}function where(xt,$t,Ct){const kt=$t,Mt=__PRIVATE_fieldPathFromArgument("where",xt);return QueryFieldFilterConstraint._create(Mt,kt,Ct)}class QueryCompositeFilterConstraint extends AppliableConstraint{constructor($t,Ct){super(),this.type=$t,this._queryConstraints=Ct}static _create($t,Ct){return new QueryCompositeFilterConstraint($t,Ct)}_parse($t){const Ct=this._queryConstraints.map(kt=>kt._parse($t)).filter(kt=>kt.getFilters().length>0);return Ct.length===1?Ct[0]:CompositeFilter.create(Ct,this._getOperator())}_apply($t){const Ct=this._parse($t);return Ct.getFilters().length===0?$t:(function(Mt,Ft){let jt=Mt;const Bt=Ft.getFlattenedFilters();for(const Vt of Bt)__PRIVATE_validateNewFieldFilter(jt,Vt),jt=__PRIVATE_queryWithAddedFilter(jt,Vt)}($t._query,Ct),new Query($t.firestore,$t.converter,__PRIVATE_queryWithAddedFilter($t._query,Ct)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class QueryOrderByConstraint extends QueryConstraint{constructor($t,Ct){super(),this._field=$t,this._direction=Ct,this.type="orderBy"}static _create($t,Ct){return new QueryOrderByConstraint($t,Ct)}_apply($t){const Ct=function(Mt,Ft,jt){if(Mt.startAt!==null)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(Mt.endAt!==null)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new OrderBy(Ft,jt)}($t._query,this._field,this._direction);return new Query($t.firestore,$t.converter,function(Mt,Ft){const jt=Mt.explicitOrderBy.concat([Ft]);return new __PRIVATE_QueryImpl(Mt.path,Mt.collectionGroup,jt,Mt.filters.slice(),Mt.limit,Mt.limitType,Mt.startAt,Mt.endAt)}($t._query,Ct))}}function orderBy(xt,$t="asc"){const Ct=$t,kt=__PRIVATE_fieldPathFromArgument("orderBy",xt);return QueryOrderByConstraint._create(kt,Ct)}function __PRIVATE_parseDocumentIdValue(xt,$t,Ct){if(typeof(Ct=getModularInstance(Ct))=="string"){if(Ct==="")throw new FirestoreError(C$1.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!__PRIVATE_isCollectionGroupQuery($t)&&Ct.indexOf("/")!==-1)throw new FirestoreError(C$1.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${Ct}' contains a '/' character.`);const kt=$t.path.child(ResourcePath.fromString(Ct));if(!DocumentKey.isDocumentKey(kt))throw new FirestoreError(C$1.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${kt}' is not because it has an odd number of segments (${kt.length}).`);return __PRIVATE_refValue(xt,new DocumentKey(kt))}if(Ct instanceof DocumentReference)return __PRIVATE_refValue(xt,Ct._key);throw new FirestoreError(C$1.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${__PRIVATE_valueDescription(Ct)}.`)}function __PRIVATE_validateDisjunctiveFilterElements(xt,$t){if(!Array.isArray(xt)||xt.length===0)throw new FirestoreError(C$1.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${$t.toString()}' filters.`)}function __PRIVATE_validateNewFieldFilter(xt,$t){const Ct=function(Mt,Ft){for(const jt of Mt)for(const Bt of jt.getFlattenedFilters())if(Ft.indexOf(Bt.op)>=0)return Bt.op;return null}(xt.filters,function(Mt){switch(Mt){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}($t.op));if(Ct!==null)throw Ct===$t.op?new FirestoreError(C$1.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${$t.op.toString()}' filter.`):new FirestoreError(C$1.INVALID_ARGUMENT,`Invalid query. You cannot use '${$t.op.toString()}' filters with '${Ct.toString()}' filters.`)}class AbstractUserDataWriter{convertValue($t,Ct="none"){switch(__PRIVATE_typeOrder($t)){case 0:return null;case 1:return $t.booleanValue;case 2:return __PRIVATE_normalizeNumber($t.integerValue||$t.doubleValue);case 3:return this.convertTimestamp($t.timestampValue);case 4:return this.convertServerTimestamp($t,Ct);case 5:return $t.stringValue;case 6:return this.convertBytes(__PRIVATE_normalizeByteString($t.bytesValue));case 7:return this.convertReference($t.referenceValue);case 8:return this.convertGeoPoint($t.geoPointValue);case 9:return this.convertArray($t.arrayValue,Ct);case 10:return this.convertObject($t.mapValue,Ct);default:throw fail()}}convertObject($t,Ct){return this.convertObjectMap($t.fields,Ct)}convertObjectMap($t,Ct="none"){const kt={};return forEach$1($t,(Mt,Ft)=>{kt[Mt]=this.convertValue(Ft,Ct)}),kt}convertGeoPoint($t){return new GeoPoint$1(__PRIVATE_normalizeNumber($t.latitude),__PRIVATE_normalizeNumber($t.longitude))}convertArray($t,Ct){return($t.values||[]).map(kt=>this.convertValue(kt,Ct))}convertServerTimestamp($t,Ct){switch(Ct){case"previous":const kt=__PRIVATE_getPreviousValue($t);return kt==null?null:this.convertValue(kt,Ct);case"estimate":return this.convertTimestamp(__PRIVATE_getLocalWriteTime($t));default:return null}}convertTimestamp($t){const Ct=__PRIVATE_normalizeTimestamp($t);return new Timestamp(Ct.seconds,Ct.nanos)}convertDocumentKey($t,Ct){const kt=ResourcePath.fromString($t);__PRIVATE_hardAssert(__PRIVATE_isValidResourceName(kt));const Mt=new DatabaseId(kt.get(1),kt.get(3)),Ft=new DocumentKey(kt.popFirst(5));return Mt.isEqual(Ct)||__PRIVATE_logError(`Document ${Ft} contains a document reference within a different database (${Mt.projectId}/${Mt.database}) which is not supported. It will be treated as a reference in the current database (${Ct.projectId}/${Ct.database}) instead.`),Ft}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_applyFirestoreDataConverter(xt,$t,Ct){let kt;return kt=xt?Ct&&(Ct.merge||Ct.mergeFields)?xt.toFirestore($t,Ct):xt.toFirestore($t):$t,kt}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotMetadata{constructor($t,Ct){this.hasPendingWrites=$t,this.fromCache=Ct}isEqual($t){return this.hasPendingWrites===$t.hasPendingWrites&&this.fromCache===$t.fromCache}}class DocumentSnapshot extends DocumentSnapshot$1{constructor($t,Ct,kt,Mt,Ft,jt){super($t,Ct,kt,Mt,jt),this._firestore=$t,this._firestoreImpl=$t,this.metadata=Ft}exists(){return super.exists()}data($t={}){if(this._document){if(this._converter){const Ct=new QueryDocumentSnapshot(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(Ct,$t)}return this._userDataWriter.convertValue(this._document.data.value,$t.serverTimestamps)}}get($t,Ct={}){if(this._document){const kt=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",$t));if(kt!==null)return this._userDataWriter.convertValue(kt,Ct.serverTimestamps)}}}class QueryDocumentSnapshot extends DocumentSnapshot{data($t={}){return super.data($t)}}class QuerySnapshot{constructor($t,Ct,kt,Mt){this._firestore=$t,this._userDataWriter=Ct,this._snapshot=Mt,this.metadata=new SnapshotMetadata(Mt.hasPendingWrites,Mt.fromCache),this.query=kt}get docs(){const $t=[];return this.forEach(Ct=>$t.push(Ct)),$t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach($t,Ct){this._snapshot.docs.forEach(kt=>{$t.call(Ct,new QueryDocumentSnapshot(this._firestore,this._userDataWriter,kt.key,kt,new SnapshotMetadata(this._snapshot.mutatedKeys.has(kt.key),this._snapshot.fromCache),this.query.converter))})}docChanges($t={}){const Ct=!!$t.includeMetadataChanges;if(Ct&&this._snapshot.excludesMetadataChanges)throw new FirestoreError(C$1.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===Ct||(this._cachedChanges=function(Mt,Ft){if(Mt._snapshot.oldDocs.isEmpty()){let jt=0;return Mt._snapshot.docChanges.map(Bt=>{const Vt=new QueryDocumentSnapshot(Mt._firestore,Mt._userDataWriter,Bt.doc.key,Bt.doc,new SnapshotMetadata(Mt._snapshot.mutatedKeys.has(Bt.doc.key),Mt._snapshot.fromCache),Mt.query.converter);return Bt.doc,{type:"added",doc:Vt,oldIndex:-1,newIndex:jt++}})}{let jt=Mt._snapshot.oldDocs;return Mt._snapshot.docChanges.filter(Bt=>Ft||Bt.type!==3).map(Bt=>{const Vt=new QueryDocumentSnapshot(Mt._firestore,Mt._userDataWriter,Bt.doc.key,Bt.doc,new SnapshotMetadata(Mt._snapshot.mutatedKeys.has(Bt.doc.key),Mt._snapshot.fromCache),Mt.query.converter);let zt=-1,Ht=-1;return Bt.type!==0&&(zt=jt.indexOf(Bt.doc.key),jt=jt.delete(Bt.doc.key)),Bt.type!==1&&(jt=jt.add(Bt.doc),Ht=jt.indexOf(Bt.doc.key)),{type:__PRIVATE_resultChangeType(Bt.type),doc:Vt,oldIndex:zt,newIndex:Ht}})}}(this,Ct),this._cachedChangesIncludeMetadataChanges=Ct),this._cachedChanges}}function __PRIVATE_resultChangeType(xt){switch(xt){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fail()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getDoc(xt){xt=__PRIVATE_cast(xt,DocumentReference);const $t=__PRIVATE_cast(xt.firestore,Firestore);return __PRIVATE_firestoreClientGetDocumentViaSnapshotListener(ensureFirestoreConfigured($t),xt._key).then(Ct=>__PRIVATE_convertToDocSnapshot($t,xt,Ct))}class __PRIVATE_ExpUserDataWriter extends AbstractUserDataWriter{constructor($t){super(),this.firestore=$t}convertBytes($t){return new Bytes($t)}convertReference($t){const Ct=this.convertDocumentKey($t,this.firestore._databaseId);return new DocumentReference(this.firestore,null,Ct)}}function getDocs(xt){xt=__PRIVATE_cast(xt,Query);const $t=__PRIVATE_cast(xt.firestore,Firestore),Ct=ensureFirestoreConfigured($t),kt=new __PRIVATE_ExpUserDataWriter($t);return __PRIVATE_validateHasExplicitOrderByForLimitToLast(xt._query),__PRIVATE_firestoreClientGetDocumentsViaSnapshotListener(Ct,xt._query).then(Mt=>new QuerySnapshot($t,kt,xt,Mt))}function setDoc(xt,$t,Ct){xt=__PRIVATE_cast(xt,DocumentReference);const kt=__PRIVATE_cast(xt.firestore,Firestore),Mt=__PRIVATE_applyFirestoreDataConverter(xt.converter,$t,Ct);return executeWrite(kt,[__PRIVATE_parseSetData(__PRIVATE_newUserDataReader(kt),"setDoc",xt._key,Mt,xt.converter!==null,Ct).toMutation(xt._key,Precondition.none())])}function updateDoc(xt,$t,Ct,...kt){xt=__PRIVATE_cast(xt,DocumentReference);const Mt=__PRIVATE_cast(xt.firestore,Firestore),Ft=__PRIVATE_newUserDataReader(Mt);let jt;return jt=typeof($t=getModularInstance($t))=="string"||$t instanceof FieldPath?__PRIVATE_parseUpdateVarargs(Ft,"updateDoc",xt._key,$t,Ct,kt):__PRIVATE_parseUpdateData(Ft,"updateDoc",xt._key,$t),executeWrite(Mt,[jt.toMutation(xt._key,Precondition.exists(!0))])}function deleteDoc(xt){return executeWrite(__PRIVATE_cast(xt.firestore,Firestore),[new __PRIVATE_DeleteMutation(xt._key,Precondition.none())])}function executeWrite(xt,$t){return function(kt,Mt){const Ft=new __PRIVATE_Deferred;return kt.asyncQueue.enqueueAndForget(async()=>__PRIVATE_syncEngineWrite(await __PRIVATE_getSyncEngine(kt),Mt,Ft)),Ft.promise}(ensureFirestoreConfigured(xt),$t)}function __PRIVATE_convertToDocSnapshot(xt,$t,Ct){const kt=Ct.docs.get($t._key),Mt=new __PRIVATE_ExpUserDataWriter(xt);return new DocumentSnapshot(xt,Mt,$t._key,kt,new SnapshotMetadata(Ct.hasPendingWrites,Ct.fromCache),$t.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WriteBatch{constructor($t,Ct){this._firestore=$t,this._commitHandler=Ct,this._mutations=[],this._committed=!1,this._dataReader=__PRIVATE_newUserDataReader($t)}set($t,Ct,kt){this._verifyNotCommitted();const Mt=__PRIVATE_validateReference($t,this._firestore),Ft=__PRIVATE_applyFirestoreDataConverter(Mt.converter,Ct,kt),jt=__PRIVATE_parseSetData(this._dataReader,"WriteBatch.set",Mt._key,Ft,Mt.converter!==null,kt);return this._mutations.push(jt.toMutation(Mt._key,Precondition.none())),this}update($t,Ct,kt,...Mt){this._verifyNotCommitted();const Ft=__PRIVATE_validateReference($t,this._firestore);let jt;return jt=typeof(Ct=getModularInstance(Ct))=="string"||Ct instanceof FieldPath?__PRIVATE_parseUpdateVarargs(this._dataReader,"WriteBatch.update",Ft._key,Ct,kt,Mt):__PRIVATE_parseUpdateData(this._dataReader,"WriteBatch.update",Ft._key,Ct),this._mutations.push(jt.toMutation(Ft._key,Precondition.exists(!0))),this}delete($t){this._verifyNotCommitted();const Ct=__PRIVATE_validateReference($t,this._firestore);return this._mutations=this._mutations.concat(new __PRIVATE_DeleteMutation(Ct._key,Precondition.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new FirestoreError(C$1.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function __PRIVATE_validateReference(xt,$t){if((xt=getModularInstance(xt)).firestore!==$t)throw new FirestoreError(C$1.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return xt}function serverTimestamp(){return new __PRIVATE_ServerTimestampFieldValueImpl("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function writeBatch(xt){return ensureFirestoreConfigured(xt=__PRIVATE_cast(xt,Firestore)),new WriteBatch(xt,$t=>executeWrite(xt,$t))}(function xt($t,Ct=!0){(function(Mt){b$1=Mt})(SDK_VERSION),_registerComponent(new Component("firestore",(kt,{instanceIdentifier:Mt,options:Ft})=>{const jt=kt.getProvider("app").getImmediate(),Bt=new Firestore(new __PRIVATE_FirebaseAuthCredentialsProvider(kt.getProvider("auth-internal")),new __PRIVATE_FirebaseAppCheckTokenProvider(kt.getProvider("app-check-internal")),function(zt,Ht){if(!Object.prototype.hasOwnProperty.apply(zt.options,["projectId"]))throw new FirestoreError(C$1.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new DatabaseId(zt.options.projectId,Ht)}(jt,Mt),jt);return Ft=Object.assign({useFetchStreams:Ct},Ft),Bt._setSettings(Ft),Bt},"PUBLIC").setMultipleInstances(!0)),registerVersion(S,"4.6.3",$t),registerVersion(S,"4.6.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const APP_CHECK_STATES=new Map,DEFAULT_STATE={activated:!1,tokenObservers:[]},DEBUG_STATE={initialized:!1,enabled:!1};function getStateReference(xt){return APP_CHECK_STATES.get(xt)||Object.assign({},DEFAULT_STATE)}function setInitialState(xt,$t){return APP_CHECK_STATES.set(xt,$t),APP_CHECK_STATES.get(xt)}function getDebugState(){return DEBUG_STATE}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BASE_ENDPOINT="https://content-firebaseappcheck.googleapis.com/v1",EXCHANGE_RECAPTCHA_TOKEN_METHOD="exchangeRecaptchaV3Token",EXCHANGE_DEBUG_TOKEN_METHOD="exchangeDebugToken",TOKEN_REFRESH_TIME={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},ONE_DAY=24*60*60*1e3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Refresher{constructor($t,Ct,kt,Mt,Ft){if(this.operation=$t,this.retryPolicy=Ct,this.getWaitDuration=kt,this.lowerBound=Mt,this.upperBound=Ft,this.pending=null,this.nextErrorWaitInterval=Mt,Mt>Ft)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process($t){this.stop();try{this.pending=new Deferred,this.pending.promise.catch(Ct=>{}),await sleep(this.getNextRun($t)),this.pending.resolve(),await this.pending.promise,this.pending=new Deferred,this.pending.promise.catch(Ct=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(Ct){this.retryPolicy(Ct)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun($t){if($t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const Ct=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),Ct}}}function sleep(xt){return new Promise($t=>{setTimeout($t,xt)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},ERROR_FACTORY=new ErrorFactory("appCheck","AppCheck",ERRORS);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getRecaptcha(xt=!1){var $t;return xt?($t=self.grecaptcha)===null||$t===void 0?void 0:$t.enterprise:self.grecaptcha}function ensureActivated(xt){if(!getStateReference(xt).activated)throw ERROR_FACTORY.create("use-before-activation",{appName:xt.name})}function getDurationString(xt){const $t=Math.round(xt/1e3),Ct=Math.floor($t/(3600*24)),kt=Math.floor(($t-Ct*3600*24)/3600),Mt=Math.floor(($t-Ct*3600*24-kt*3600)/60),Ft=$t-Ct*3600*24-kt*3600-Mt*60;let jt="";return Ct&&(jt+=pad$1(Ct)+"d:"),kt&&(jt+=pad$1(kt)+"h:"),jt+=pad$1(Mt)+"m:"+pad$1(Ft)+"s",jt}function pad$1(xt){return xt===0?"00":xt>=10?xt.toString():"0"+xt}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function exchangeToken({url:xt,body:$t},Ct){const kt={"Content-Type":"application/json"},Mt=Ct.getImmediate({optional:!0});if(Mt){const Gt=await Mt.getHeartbeatsHeader();Gt&&(kt["X-Firebase-Client"]=Gt)}const Ft={method:"POST",body:JSON.stringify($t),headers:kt};let jt;try{jt=await fetch(xt,Ft)}catch(Gt){throw ERROR_FACTORY.create("fetch-network-error",{originalErrorMessage:Gt==null?void 0:Gt.message})}if(jt.status!==200)throw ERROR_FACTORY.create("fetch-status-error",{httpStatus:jt.status});let Bt;try{Bt=await jt.json()}catch(Gt){throw ERROR_FACTORY.create("fetch-parse-error",{originalErrorMessage:Gt==null?void 0:Gt.message})}const Vt=Bt.ttl.match(/^([\d.]+)(s)$/);if(!Vt||!Vt[2]||isNaN(Number(Vt[1])))throw ERROR_FACTORY.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${Bt.ttl}`});const zt=Number(Vt[1])*1e3,Ht=Date.now();return{token:Bt.token,expireTimeMillis:Ht+zt,issuedAtTimeMillis:Ht}}function getExchangeRecaptchaV3TokenRequest(xt,$t){const{projectId:Ct,appId:kt,apiKey:Mt}=xt.options;return{url:`${BASE_ENDPOINT}/projects/${Ct}/apps/${kt}:${EXCHANGE_RECAPTCHA_TOKEN_METHOD}?key=${Mt}`,body:{recaptcha_v3_token:$t}}}function getExchangeDebugTokenRequest(xt,$t){const{projectId:Ct,appId:kt,apiKey:Mt}=xt.options;return{url:`${BASE_ENDPOINT}/projects/${Ct}/apps/${kt}:${EXCHANGE_DEBUG_TOKEN_METHOD}?key=${Mt}`,body:{debug_token:$t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebase-app-check-database",DB_VERSION=1,STORE_NAME="firebase-app-check-store",DEBUG_TOKEN_KEY="debug-token";let dbPromise=null;function getDBPromise(){return dbPromise||(dbPromise=new Promise((xt,$t)=>{try{const Ct=indexedDB.open(DB_NAME,DB_VERSION);Ct.onsuccess=kt=>{xt(kt.target.result)},Ct.onerror=kt=>{var Mt;$t(ERROR_FACTORY.create("storage-open",{originalErrorMessage:(Mt=kt.target.error)===null||Mt===void 0?void 0:Mt.message}))},Ct.onupgradeneeded=kt=>{const Mt=kt.target.result;switch(kt.oldVersion){case 0:Mt.createObjectStore(STORE_NAME,{keyPath:"compositeKey"})}}}catch(Ct){$t(ERROR_FACTORY.create("storage-open",{originalErrorMessage:Ct==null?void 0:Ct.message}))}}),dbPromise)}function readTokenFromIndexedDB(xt){return read$1(computeKey(xt))}function writeTokenToIndexedDB(xt,$t){return write(computeKey(xt),$t)}function writeDebugTokenToIndexedDB(xt){return write(DEBUG_TOKEN_KEY,xt)}function readDebugTokenFromIndexedDB(){return read$1(DEBUG_TOKEN_KEY)}async function write(xt,$t){const kt=(await getDBPromise()).transaction(STORE_NAME,"readwrite"),Ft=kt.objectStore(STORE_NAME).put({compositeKey:xt,value:$t});return new Promise((jt,Bt)=>{Ft.onsuccess=Vt=>{jt()},kt.onerror=Vt=>{var zt;Bt(ERROR_FACTORY.create("storage-set",{originalErrorMessage:(zt=Vt.target.error)===null||zt===void 0?void 0:zt.message}))}})}async function read$1(xt){const Ct=(await getDBPromise()).transaction(STORE_NAME,"readonly"),Mt=Ct.objectStore(STORE_NAME).get(xt);return new Promise((Ft,jt)=>{Mt.onsuccess=Bt=>{const Vt=Bt.target.result;Ft(Vt?Vt.value:void 0)},Ct.onerror=Bt=>{var Vt;jt(ERROR_FACTORY.create("storage-get",{originalErrorMessage:(Vt=Bt.target.error)===null||Vt===void 0?void 0:Vt.message}))}})}function computeKey(xt){return`${xt.options.appId}-${xt.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger$1=new Logger("@firebase/app-check");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function readTokenFromStorage(xt){if(isIndexedDBAvailable()){let $t;try{$t=await readTokenFromIndexedDB(xt)}catch(Ct){logger$1.warn(`Failed to read token from IndexedDB. Error: ${Ct}`)}return $t}}function writeTokenToStorage(xt,$t){return isIndexedDBAvailable()?writeTokenToIndexedDB(xt,$t).catch(Ct=>{logger$1.warn(`Failed to write token to IndexedDB. Error: ${Ct}`)}):Promise.resolve()}async function readOrCreateDebugTokenFromStorage(){let xt;try{xt=await readDebugTokenFromIndexedDB()}catch{}if(xt)return xt;{const $t=uuidv4();return writeDebugTokenToIndexedDB($t).catch(Ct=>logger$1.warn(`Failed to persist debug token to IndexedDB. Error: ${Ct}`)),$t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isDebugMode(){return getDebugState().enabled}async function getDebugToken(){const xt=getDebugState();if(xt.enabled&&xt.token)return xt.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}function initializeDebugMode(){const xt=getGlobal(),$t=getDebugState();if($t.initialized=!0,typeof xt.FIREBASE_APPCHECK_DEBUG_TOKEN!="string"&&xt.FIREBASE_APPCHECK_DEBUG_TOKEN!==!0)return;$t.enabled=!0;const Ct=new Deferred;$t.token=Ct,typeof xt.FIREBASE_APPCHECK_DEBUG_TOKEN=="string"?Ct.resolve(xt.FIREBASE_APPCHECK_DEBUG_TOKEN):Ct.resolve(readOrCreateDebugTokenFromStorage())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const defaultTokenErrorData={error:"UNKNOWN_ERROR"};function formatDummyToken(xt){return base64.encodeString(JSON.stringify(xt),!1)}async function getToken$2(xt,$t=!1){const Ct=xt.app;ensureActivated(Ct);const kt=getStateReference(Ct);let Mt=kt.token,Ft;if(Mt&&!isValid$1(Mt)&&(kt.token=void 0,Mt=void 0),!Mt){const Vt=await kt.cachedTokenPromise;Vt&&(isValid$1(Vt)?Mt=Vt:await writeTokenToStorage(Ct,void 0))}if(!$t&&Mt&&isValid$1(Mt))return{token:Mt.token};let jt=!1;if(isDebugMode()){kt.exchangeTokenPromise||(kt.exchangeTokenPromise=exchangeToken(getExchangeDebugTokenRequest(Ct,await getDebugToken()),xt.heartbeatServiceProvider).finally(()=>{kt.exchangeTokenPromise=void 0}),jt=!0);const Vt=await kt.exchangeTokenPromise;return await writeTokenToStorage(Ct,Vt),kt.token=Vt,{token:Vt.token}}try{kt.exchangeTokenPromise||(kt.exchangeTokenPromise=kt.provider.getToken().finally(()=>{kt.exchangeTokenPromise=void 0}),jt=!0),Mt=await getStateReference(Ct).exchangeTokenPromise}catch(Vt){Vt.code==="appCheck/throttled"?logger$1.warn(Vt.message):logger$1.error(Vt),Ft=Vt}let Bt;return Mt?Ft?isValid$1(Mt)?Bt={token:Mt.token,internalError:Ft}:Bt=makeDummyTokenResult(Ft):(Bt={token:Mt.token},kt.token=Mt,await writeTokenToStorage(Ct,Mt)):Bt=makeDummyTokenResult(Ft),jt&&notifyTokenListeners(Ct,Bt),Bt}async function getLimitedUseToken$1(xt){const $t=xt.app;ensureActivated($t);const{provider:Ct}=getStateReference($t);if(isDebugMode()){const kt=await getDebugToken(),{token:Mt}=await exchangeToken(getExchangeDebugTokenRequest($t,kt),xt.heartbeatServiceProvider);return{token:Mt}}else{const{token:kt}=await Ct.getToken();return{token:kt}}}function addTokenListener(xt,$t,Ct,kt){const{app:Mt}=xt,Ft=getStateReference(Mt),jt={next:Ct,error:kt,type:$t};if(Ft.tokenObservers=[...Ft.tokenObservers,jt],Ft.token&&isValid$1(Ft.token)){const Bt=Ft.token;Promise.resolve().then(()=>{Ct({token:Bt.token}),initTokenRefresher(xt)}).catch(()=>{})}Ft.cachedTokenPromise.then(()=>initTokenRefresher(xt))}function removeTokenListener(xt,$t){const Ct=getStateReference(xt),kt=Ct.tokenObservers.filter(Mt=>Mt.next!==$t);kt.length===0&&Ct.tokenRefresher&&Ct.tokenRefresher.isRunning()&&Ct.tokenRefresher.stop(),Ct.tokenObservers=kt}function initTokenRefresher(xt){const{app:$t}=xt,Ct=getStateReference($t);let kt=Ct.tokenRefresher;kt||(kt=createTokenRefresher(xt),Ct.tokenRefresher=kt),!kt.isRunning()&&Ct.isTokenAutoRefreshEnabled&&kt.start()}function createTokenRefresher(xt){const{app:$t}=xt;return new Refresher(async()=>{const Ct=getStateReference($t);let kt;if(Ct.token?kt=await getToken$2(xt,!0):kt=await getToken$2(xt),kt.error)throw kt.error;if(kt.internalError)throw kt.internalError},()=>!0,()=>{const Ct=getStateReference($t);if(Ct.token){let kt=Ct.token.issuedAtTimeMillis+(Ct.token.expireTimeMillis-Ct.token.issuedAtTimeMillis)*.5+3e5;const Mt=Ct.token.expireTimeMillis-5*60*1e3;return kt=Math.min(kt,Mt),Math.max(0,kt-Date.now())}else return 0},TOKEN_REFRESH_TIME.RETRIAL_MIN_WAIT,TOKEN_REFRESH_TIME.RETRIAL_MAX_WAIT)}function notifyTokenListeners(xt,$t){const Ct=getStateReference(xt).tokenObservers;for(const kt of Ct)try{kt.type==="EXTERNAL"&&$t.error!=null?kt.error($t.error):kt.next($t)}catch{}}function isValid$1(xt){return xt.expireTimeMillis-Date.now()>0}function makeDummyTokenResult(xt){return{token:formatDummyToken(defaultTokenErrorData),error:xt}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AppCheckService{constructor($t,Ct){this.app=$t,this.heartbeatServiceProvider=Ct}_delete(){const{tokenObservers:$t}=getStateReference(this.app);for(const Ct of $t)removeTokenListener(this.app,Ct.next);return Promise.resolve()}}function factory(xt,$t){return new AppCheckService(xt,$t)}function internalFactory(xt){return{getToken:$t=>getToken$2(xt,$t),getLimitedUseToken:()=>getLimitedUseToken$1(xt),addTokenListener:$t=>addTokenListener(xt,"INTERNAL",$t),removeTokenListener:$t=>removeTokenListener(xt.app,$t)}}const name$2="@firebase/app-check",version$5="0.8.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RECAPTCHA_URL="https://www.google.com/recaptcha/api.js";function initializeV3(xt,$t){const Ct=new Deferred,kt=getStateReference(xt);kt.reCAPTCHAState={initialized:Ct};const Mt=makeDiv(xt),Ft=getRecaptcha(!1);return Ft?queueWidgetRender(xt,$t,Ft,Mt,Ct):loadReCAPTCHAV3Script(()=>{const jt=getRecaptcha(!1);if(!jt)throw new Error("no recaptcha");queueWidgetRender(xt,$t,jt,Mt,Ct)}),Ct.promise}function queueWidgetRender(xt,$t,Ct,kt,Mt){Ct.ready(()=>{renderInvisibleWidget(xt,$t,Ct,kt),Mt.resolve(Ct)})}function makeDiv(xt){const $t=`fire_app_check_${xt.name}`,Ct=document.createElement("div");return Ct.id=$t,Ct.style.display="none",document.body.appendChild(Ct),$t}async function getToken$1(xt){ensureActivated(xt);const Ct=await getStateReference(xt).reCAPTCHAState.initialized.promise;return new Promise((kt,Mt)=>{const Ft=getStateReference(xt).reCAPTCHAState;Ct.ready(()=>{kt(Ct.execute(Ft.widgetId,{action:"fire_app_check"}))})})}function renderInvisibleWidget(xt,$t,Ct,kt){const Mt=Ct.render(kt,{sitekey:$t,size:"invisible",callback:()=>{getStateReference(xt).reCAPTCHAState.succeeded=!0},"error-callback":()=>{getStateReference(xt).reCAPTCHAState.succeeded=!1}}),Ft=getStateReference(xt);Ft.reCAPTCHAState=Object.assign(Object.assign({},Ft.reCAPTCHAState),{widgetId:Mt})}function loadReCAPTCHAV3Script(xt){const $t=document.createElement("script");$t.src=RECAPTCHA_URL,$t.onload=xt,document.head.appendChild($t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ReCaptchaV3Provider{constructor($t){this._siteKey=$t,this._throttleData=null}async getToken(){var $t,Ct,kt;throwIfThrottled(this._throttleData);const Mt=await getToken$1(this._app).catch(jt=>{throw ERROR_FACTORY.create("recaptcha-error")});if(!(!(($t=getStateReference(this._app).reCAPTCHAState)===null||$t===void 0)&&$t.succeeded))throw ERROR_FACTORY.create("recaptcha-error");let Ft;try{Ft=await exchangeToken(getExchangeRecaptchaV3TokenRequest(this._app,Mt),this._heartbeatServiceProvider)}catch(jt){throw!((Ct=jt.code)===null||Ct===void 0)&&Ct.includes("fetch-status-error")?(this._throttleData=setBackoff(Number((kt=jt.customData)===null||kt===void 0?void 0:kt.httpStatus),this._throttleData),ERROR_FACTORY.create("throttled",{time:getDurationString(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):jt}return this._throttleData=null,Ft}initialize($t){this._app=$t,this._heartbeatServiceProvider=_getProvider($t,"heartbeat"),initializeV3($t,this._siteKey).catch(()=>{})}isEqual($t){return $t instanceof ReCaptchaV3Provider?this._siteKey===$t._siteKey:!1}}function setBackoff(xt,$t){if(xt===404||xt===403)return{backoffCount:1,allowRequestsAfter:Date.now()+ONE_DAY,httpStatus:xt};{const Ct=$t?$t.backoffCount:0,kt=calculateBackoffMillis(Ct,1e3,2);return{backoffCount:Ct+1,allowRequestsAfter:Date.now()+kt,httpStatus:xt}}}function throwIfThrottled(xt){if(xt&&Date.now()-xt.allowRequestsAfter<=0)throw ERROR_FACTORY.create("throttled",{time:getDurationString(xt.allowRequestsAfter-Date.now()),httpStatus:xt.httpStatus})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function initializeAppCheck(xt=getApp(),$t){xt=getModularInstance(xt);const Ct=_getProvider(xt,"app-check");if(getDebugState().initialized||initializeDebugMode(),isDebugMode()&&getDebugToken().then(Mt=>console.log(`App Check debug token: ${Mt}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),Ct.isInitialized()){const Mt=Ct.getImmediate(),Ft=Ct.getOptions();if(Ft.isTokenAutoRefreshEnabled===$t.isTokenAutoRefreshEnabled&&Ft.provider.isEqual($t.provider))return Mt;throw ERROR_FACTORY.create("already-initialized",{appName:xt.name})}const kt=Ct.initialize({options:$t});return _activate(xt,$t.provider,$t.isTokenAutoRefreshEnabled),getStateReference(xt).isTokenAutoRefreshEnabled&&addTokenListener(kt,"INTERNAL",()=>{}),kt}function _activate(xt,$t,Ct){const kt=setInitialState(xt,Object.assign({},DEFAULT_STATE));kt.activated=!0,kt.provider=$t,kt.cachedTokenPromise=readTokenFromStorage(xt).then(Mt=>(Mt&&isValid$1(Mt)&&(kt.token=Mt,notifyTokenListeners(xt,{token:Mt.token})),Mt)),kt.isTokenAutoRefreshEnabled=Ct===void 0?xt.automaticDataCollectionEnabled:Ct,kt.provider.initialize(xt)}const APP_CHECK_NAME="app-check",APP_CHECK_NAME_INTERNAL="app-check-internal";function registerAppCheck(){_registerComponent(new Component(APP_CHECK_NAME,xt=>{const $t=xt.getProvider("app").getImmediate(),Ct=xt.getProvider("heartbeat");return factory($t,Ct)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((xt,$t,Ct)=>{xt.getProvider(APP_CHECK_NAME_INTERNAL).initialize()})),_registerComponent(new Component(APP_CHECK_NAME_INTERNAL,xt=>{const $t=xt.getProvider("app-check").getImmediate();return internalFactory($t)},"PUBLIC").setInstantiationMode("EXPLICIT")),registerVersion(name$2,version$5)}registerAppCheck();var localforage$1={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(xt,$t){(function(Ct){xt.exports=Ct()})(function(){return function Ct(kt,Mt,Ft){function jt(zt,Ht){if(!Mt[zt]){if(!kt[zt]){var Gt=typeof commonjsRequire=="function"&&commonjsRequire;if(!Ht&&Gt)return Gt(zt,!0);if(Bt)return Bt(zt,!0);var qt=new Error("Cannot find module '"+zt+"'");throw qt.code="MODULE_NOT_FOUND",qt}var Wt=Mt[zt]={exports:{}};kt[zt][0].call(Wt.exports,function(Yt){var Kt=kt[zt][1][Yt];return jt(Kt||Yt)},Wt,Wt.exports,Ct,kt,Mt,Ft)}return Mt[zt].exports}for(var Bt=typeof commonjsRequire=="function"&&commonjsRequire,Vt=0;Vt<Ft.length;Vt++)jt(Ft[Vt]);return jt}({1:[function(Ct,kt,Mt){(function(Ft){var jt=Ft.MutationObserver||Ft.WebKitMutationObserver,Bt;if(jt){var Vt=0,zt=new jt(Yt),Ht=Ft.document.createTextNode("");zt.observe(Ht,{characterData:!0}),Bt=function(){Ht.data=Vt=++Vt%2}}else if(!Ft.setImmediate&&typeof Ft.MessageChannel<"u"){var Gt=new Ft.MessageChannel;Gt.port1.onmessage=Yt,Bt=function(){Gt.port2.postMessage(0)}}else"document"in Ft&&"onreadystatechange"in Ft.document.createElement("script")?Bt=function(){var Xt=Ft.document.createElement("script");Xt.onreadystatechange=function(){Yt(),Xt.onreadystatechange=null,Xt.parentNode.removeChild(Xt),Xt=null},Ft.document.documentElement.appendChild(Xt)}:Bt=function(){setTimeout(Yt,0)};var qt,Wt=[];function Yt(){qt=!0;for(var Xt,Qt,Jt=Wt.length;Jt;){for(Qt=Wt,Wt=[],Xt=-1;++Xt<Jt;)Qt[Xt]();Jt=Wt.length}qt=!1}kt.exports=Kt;function Kt(Xt){Wt.push(Xt)===1&&!qt&&Bt()}}).call(this,typeof commonjsGlobal$2<"u"?commonjsGlobal$2:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(Ct,kt,Mt){var Ft=Ct(1);function jt(){}var Bt={},Vt=["REJECTED"],zt=["FULFILLED"],Ht=["PENDING"];kt.exports=Gt;function Gt(ln){if(typeof ln!="function")throw new TypeError("resolver must be a function");this.state=Ht,this.queue=[],this.outcome=void 0,ln!==jt&&Kt(this,ln)}Gt.prototype.catch=function(ln){return this.then(null,ln)},Gt.prototype.then=function(ln,dn){if(typeof ln!="function"&&this.state===zt||typeof dn!="function"&&this.state===Vt)return this;var hn=new this.constructor(jt);if(this.state!==Ht){var cn=this.state===zt?ln:dn;Wt(hn,cn,this.outcome)}else this.queue.push(new qt(hn,ln,dn));return hn};function qt(ln,dn,hn){this.promise=ln,typeof dn=="function"&&(this.onFulfilled=dn,this.callFulfilled=this.otherCallFulfilled),typeof hn=="function"&&(this.onRejected=hn,this.callRejected=this.otherCallRejected)}qt.prototype.callFulfilled=function(ln){Bt.resolve(this.promise,ln)},qt.prototype.otherCallFulfilled=function(ln){Wt(this.promise,this.onFulfilled,ln)},qt.prototype.callRejected=function(ln){Bt.reject(this.promise,ln)},qt.prototype.otherCallRejected=function(ln){Wt(this.promise,this.onRejected,ln)};function Wt(ln,dn,hn){Ft(function(){var cn;try{cn=dn(hn)}catch(pn){return Bt.reject(ln,pn)}cn===ln?Bt.reject(ln,new TypeError("Cannot resolve promise with itself")):Bt.resolve(ln,cn)})}Bt.resolve=function(ln,dn){var hn=Xt(Yt,dn);if(hn.status==="error")return Bt.reject(ln,hn.value);var cn=hn.value;if(cn)Kt(ln,cn);else{ln.state=zt,ln.outcome=dn;for(var pn=-1,yn=ln.queue.length;++pn<yn;)ln.queue[pn].callFulfilled(dn)}return ln},Bt.reject=function(ln,dn){ln.state=Vt,ln.outcome=dn;for(var hn=-1,cn=ln.queue.length;++hn<cn;)ln.queue[hn].callRejected(dn);return ln};function Yt(ln){var dn=ln&&ln.then;if(ln&&(typeof ln=="object"||typeof ln=="function")&&typeof dn=="function")return function(){dn.apply(ln,arguments)}}function Kt(ln,dn){var hn=!1;function cn(En){hn||(hn=!0,Bt.reject(ln,En))}function pn(En){hn||(hn=!0,Bt.resolve(ln,En))}function yn(){dn(pn,cn)}var gn=Xt(yn);gn.status==="error"&&cn(gn.value)}function Xt(ln,dn){var hn={};try{hn.value=ln(dn),hn.status="success"}catch(cn){hn.status="error",hn.value=cn}return hn}Gt.resolve=Qt;function Qt(ln){return ln instanceof this?ln:Bt.resolve(new this(jt),ln)}Gt.reject=Jt;function Jt(ln){var dn=new this(jt);return Bt.reject(dn,ln)}Gt.all=Zt;function Zt(ln){var dn=this;if(Object.prototype.toString.call(ln)!=="[object Array]")return this.reject(new TypeError("must be an array"));var hn=ln.length,cn=!1;if(!hn)return this.resolve([]);for(var pn=new Array(hn),yn=0,gn=-1,En=new this(jt);++gn<hn;)bn(ln[gn],gn);return En;function bn(xn,Cn){dn.resolve(xn).then($n,function(wn){cn||(cn=!0,Bt.reject(En,wn))});function $n(wn){pn[Cn]=wn,++yn===hn&&!cn&&(cn=!0,Bt.resolve(En,pn))}}}Gt.race=sn;function sn(ln){var dn=this;if(Object.prototype.toString.call(ln)!=="[object Array]")return this.reject(new TypeError("must be an array"));var hn=ln.length,cn=!1;if(!hn)return this.resolve([]);for(var pn=-1,yn=new this(jt);++pn<hn;)gn(ln[pn]);return yn;function gn(En){dn.resolve(En).then(function(bn){cn||(cn=!0,Bt.resolve(yn,bn))},function(bn){cn||(cn=!0,Bt.reject(yn,bn))})}}},{1:1}],3:[function(Ct,kt,Mt){(function(Ft){typeof Ft.Promise!="function"&&(Ft.Promise=Ct(2))}).call(this,typeof commonjsGlobal$2<"u"?commonjsGlobal$2:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(Ct,kt,Mt){var Ft=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Jn){return typeof Jn}:function(Jn){return Jn&&typeof Symbol=="function"&&Jn.constructor===Symbol&&Jn!==Symbol.prototype?"symbol":typeof Jn};function jt(Jn,xr){if(!(Jn instanceof xr))throw new TypeError("Cannot call a class as a function")}function Bt(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var Vt=Bt();function zt(){try{if(!Vt||!Vt.open)return!1;var Jn=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),xr=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!Jn||xr)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function Ht(Jn,xr){Jn=Jn||[],xr=xr||{};try{return new Blob(Jn,xr)}catch(Pr){if(Pr.name!=="TypeError")throw Pr;for(var dr=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,kr=new dr,Lr=0;Lr<Jn.length;Lr+=1)kr.append(Jn[Lr]);return kr.getBlob(xr.type)}}typeof Promise>"u"&&Ct(3);var Gt=Promise;function qt(Jn,xr){xr&&Jn.then(function(dr){xr(null,dr)},function(dr){xr(dr)})}function Wt(Jn,xr,dr){typeof xr=="function"&&Jn.then(xr),typeof dr=="function"&&Jn.catch(dr)}function Yt(Jn){return typeof Jn!="string"&&(console.warn(Jn+" used as a key, but it is not a string."),Jn=String(Jn)),Jn}function Kt(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var Xt="local-forage-detect-blob-support",Qt=void 0,Jt={},Zt=Object.prototype.toString,sn="readonly",ln="readwrite";function dn(Jn){for(var xr=Jn.length,dr=new ArrayBuffer(xr),kr=new Uint8Array(dr),Lr=0;Lr<xr;Lr++)kr[Lr]=Jn.charCodeAt(Lr);return dr}function hn(Jn){return new Gt(function(xr){var dr=Jn.transaction(Xt,ln),kr=Ht([""]);dr.objectStore(Xt).put(kr,"key"),dr.onabort=function(Lr){Lr.preventDefault(),Lr.stopPropagation(),xr(!1)},dr.oncomplete=function(){var Lr=navigator.userAgent.match(/Chrome\/(\d+)/),Pr=navigator.userAgent.match(/Edge\//);xr(Pr||!Lr||parseInt(Lr[1],10)>=43)}}).catch(function(){return!1})}function cn(Jn){return typeof Qt=="boolean"?Gt.resolve(Qt):hn(Jn).then(function(xr){return Qt=xr,Qt})}function pn(Jn){var xr=Jt[Jn.name],dr={};dr.promise=new Gt(function(kr,Lr){dr.resolve=kr,dr.reject=Lr}),xr.deferredOperations.push(dr),xr.dbReady?xr.dbReady=xr.dbReady.then(function(){return dr.promise}):xr.dbReady=dr.promise}function yn(Jn){var xr=Jt[Jn.name],dr=xr.deferredOperations.pop();if(dr)return dr.resolve(),dr.promise}function gn(Jn,xr){var dr=Jt[Jn.name],kr=dr.deferredOperations.pop();if(kr)return kr.reject(xr),kr.promise}function En(Jn,xr){return new Gt(function(dr,kr){if(Jt[Jn.name]=Jt[Jn.name]||vn(),Jn.db)if(xr)pn(Jn),Jn.db.close();else return dr(Jn.db);var Lr=[Jn.name];xr&&Lr.push(Jn.version);var Pr=Vt.open.apply(Vt,Lr);xr&&(Pr.onupgradeneeded=function(Jr){var ss=Pr.result;try{ss.createObjectStore(Jn.storeName),Jr.oldVersion<=1&&ss.createObjectStore(Xt)}catch(ls){if(ls.name==="ConstraintError")console.warn('The database "'+Jn.name+'" has been upgraded from version '+Jr.oldVersion+" to version "+Jr.newVersion+', but the storage "'+Jn.storeName+'" already exists.');else throw ls}}),Pr.onerror=function(Jr){Jr.preventDefault(),kr(Pr.error)},Pr.onsuccess=function(){var Jr=Pr.result;Jr.onversionchange=function(ss){ss.target.close()},dr(Jr),yn(Jn)}})}function bn(Jn){return En(Jn,!1)}function xn(Jn){return En(Jn,!0)}function Cn(Jn,xr){if(!Jn.db)return!0;var dr=!Jn.db.objectStoreNames.contains(Jn.storeName),kr=Jn.version<Jn.db.version,Lr=Jn.version>Jn.db.version;if(kr&&(Jn.version!==xr&&console.warn('The database "'+Jn.name+`" can't be downgraded from version `+Jn.db.version+" to version "+Jn.version+"."),Jn.version=Jn.db.version),Lr||dr){if(dr){var Pr=Jn.db.version+1;Pr>Jn.version&&(Jn.version=Pr)}return!0}return!1}function $n(Jn){return new Gt(function(xr,dr){var kr=new FileReader;kr.onerror=dr,kr.onloadend=function(Lr){var Pr=btoa(Lr.target.result||"");xr({__local_forage_encoded_blob:!0,data:Pr,type:Jn.type})},kr.readAsBinaryString(Jn)})}function wn(Jn){var xr=dn(atob(Jn.data));return Ht([xr],{type:Jn.type})}function Rn(Jn){return Jn&&Jn.__local_forage_encoded_blob}function Dn(Jn){var xr=this,dr=xr._initReady().then(function(){var kr=Jt[xr._dbInfo.name];if(kr&&kr.dbReady)return kr.dbReady});return Wt(dr,Jn,Jn),dr}function An(Jn){pn(Jn);for(var xr=Jt[Jn.name],dr=xr.forages,kr=0;kr<dr.length;kr++){var Lr=dr[kr];Lr._dbInfo.db&&(Lr._dbInfo.db.close(),Lr._dbInfo.db=null)}return Jn.db=null,bn(Jn).then(function(Pr){return Jn.db=Pr,Cn(Jn)?xn(Jn):Pr}).then(function(Pr){Jn.db=xr.db=Pr;for(var Jr=0;Jr<dr.length;Jr++)dr[Jr]._dbInfo.db=Pr}).catch(function(Pr){throw gn(Jn,Pr),Pr})}function Sn(Jn,xr,dr,kr){kr===void 0&&(kr=1);try{var Lr=Jn.db.transaction(Jn.storeName,xr);dr(null,Lr)}catch(Pr){if(kr>0&&(!Jn.db||Pr.name==="InvalidStateError"||Pr.name==="NotFoundError"))return Gt.resolve().then(function(){if(!Jn.db||Pr.name==="NotFoundError"&&!Jn.db.objectStoreNames.contains(Jn.storeName)&&Jn.version<=Jn.db.version)return Jn.db&&(Jn.version=Jn.db.version+1),xn(Jn)}).then(function(){return An(Jn).then(function(){Sn(Jn,xr,dr,kr-1)})}).catch(dr);dr(Pr)}}function vn(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function _n(Jn){var xr=this,dr={db:null};if(Jn)for(var kr in Jn)dr[kr]=Jn[kr];var Lr=Jt[dr.name];Lr||(Lr=vn(),Jt[dr.name]=Lr),Lr.forages.push(xr),xr._initReady||(xr._initReady=xr.ready,xr.ready=Dn);var Pr=[];function Jr(){return Gt.resolve()}for(var ss=0;ss<Lr.forages.length;ss++){var ls=Lr.forages[ss];ls!==xr&&Pr.push(ls._initReady().catch(Jr))}var cs=Lr.forages.slice(0);return Gt.all(Pr).then(function(){return dr.db=Lr.db,bn(dr)}).then(function(hs){return dr.db=hs,Cn(dr,xr._defaultConfig.version)?xn(dr):hs}).then(function(hs){dr.db=Lr.db=hs,xr._dbInfo=dr;for(var As=0;As<cs.length;As++){var qs=cs[As];qs!==xr&&(qs._dbInfo.db=dr.db,qs._dbInfo.version=dr.version)}})}function Tn(Jn,xr){var dr=this;Jn=Yt(Jn);var kr=new Gt(function(Lr,Pr){dr.ready().then(function(){Sn(dr._dbInfo,sn,function(Jr,ss){if(Jr)return Pr(Jr);try{var ls=ss.objectStore(dr._dbInfo.storeName),cs=ls.get(Jn);cs.onsuccess=function(){var hs=cs.result;hs===void 0&&(hs=null),Rn(hs)&&(hs=wn(hs)),Lr(hs)},cs.onerror=function(){Pr(cs.error)}}catch(hs){Pr(hs)}})}).catch(Pr)});return qt(kr,xr),kr}function Pn(Jn,xr){var dr=this,kr=new Gt(function(Lr,Pr){dr.ready().then(function(){Sn(dr._dbInfo,sn,function(Jr,ss){if(Jr)return Pr(Jr);try{var ls=ss.objectStore(dr._dbInfo.storeName),cs=ls.openCursor(),hs=1;cs.onsuccess=function(){var As=cs.result;if(As){var qs=As.value;Rn(qs)&&(qs=wn(qs));var Os=Jn(qs,As.key,hs++);Os!==void 0?Lr(Os):As.continue()}else Lr()},cs.onerror=function(){Pr(cs.error)}}catch(As){Pr(As)}})}).catch(Pr)});return qt(kr,xr),kr}function Ln(Jn,xr,dr){var kr=this;Jn=Yt(Jn);var Lr=new Gt(function(Pr,Jr){var ss;kr.ready().then(function(){return ss=kr._dbInfo,Zt.call(xr)==="[object Blob]"?cn(ss.db).then(function(ls){return ls?xr:$n(xr)}):xr}).then(function(ls){Sn(kr._dbInfo,ln,function(cs,hs){if(cs)return Jr(cs);try{var As=hs.objectStore(kr._dbInfo.storeName);ls===null&&(ls=void 0);var qs=As.put(ls,Jn);hs.oncomplete=function(){ls===void 0&&(ls=null),Pr(ls)},hs.onabort=hs.onerror=function(){var Os=qs.error?qs.error:qs.transaction.error;Jr(Os)}}catch(Os){Jr(Os)}})}).catch(Jr)});return qt(Lr,dr),Lr}function Vn(Jn,xr){var dr=this;Jn=Yt(Jn);var kr=new Gt(function(Lr,Pr){dr.ready().then(function(){Sn(dr._dbInfo,ln,function(Jr,ss){if(Jr)return Pr(Jr);try{var ls=ss.objectStore(dr._dbInfo.storeName),cs=ls.delete(Jn);ss.oncomplete=function(){Lr()},ss.onerror=function(){Pr(cs.error)},ss.onabort=function(){var hs=cs.error?cs.error:cs.transaction.error;Pr(hs)}}catch(hs){Pr(hs)}})}).catch(Pr)});return qt(kr,xr),kr}function Un(Jn){var xr=this,dr=new Gt(function(kr,Lr){xr.ready().then(function(){Sn(xr._dbInfo,ln,function(Pr,Jr){if(Pr)return Lr(Pr);try{var ss=Jr.objectStore(xr._dbInfo.storeName),ls=ss.clear();Jr.oncomplete=function(){kr()},Jr.onabort=Jr.onerror=function(){var cs=ls.error?ls.error:ls.transaction.error;Lr(cs)}}catch(cs){Lr(cs)}})}).catch(Lr)});return qt(dr,Jn),dr}function Wn(Jn){var xr=this,dr=new Gt(function(kr,Lr){xr.ready().then(function(){Sn(xr._dbInfo,sn,function(Pr,Jr){if(Pr)return Lr(Pr);try{var ss=Jr.objectStore(xr._dbInfo.storeName),ls=ss.count();ls.onsuccess=function(){kr(ls.result)},ls.onerror=function(){Lr(ls.error)}}catch(cs){Lr(cs)}})}).catch(Lr)});return qt(dr,Jn),dr}function rr(Jn,xr){var dr=this,kr=new Gt(function(Lr,Pr){if(Jn<0){Lr(null);return}dr.ready().then(function(){Sn(dr._dbInfo,sn,function(Jr,ss){if(Jr)return Pr(Jr);try{var ls=ss.objectStore(dr._dbInfo.storeName),cs=!1,hs=ls.openKeyCursor();hs.onsuccess=function(){var As=hs.result;if(!As){Lr(null);return}Jn===0||cs?Lr(As.key):(cs=!0,As.advance(Jn))},hs.onerror=function(){Pr(hs.error)}}catch(As){Pr(As)}})}).catch(Pr)});return qt(kr,xr),kr}function ar(Jn){var xr=this,dr=new Gt(function(kr,Lr){xr.ready().then(function(){Sn(xr._dbInfo,sn,function(Pr,Jr){if(Pr)return Lr(Pr);try{var ss=Jr.objectStore(xr._dbInfo.storeName),ls=ss.openKeyCursor(),cs=[];ls.onsuccess=function(){var hs=ls.result;if(!hs){kr(cs);return}cs.push(hs.key),hs.continue()},ls.onerror=function(){Lr(ls.error)}}catch(hs){Lr(hs)}})}).catch(Lr)});return qt(dr,Jn),dr}function nr(Jn,xr){xr=Kt.apply(this,arguments);var dr=this.config();Jn=typeof Jn!="function"&&Jn||{},Jn.name||(Jn.name=Jn.name||dr.name,Jn.storeName=Jn.storeName||dr.storeName);var kr=this,Lr;if(!Jn.name)Lr=Gt.reject("Invalid arguments");else{var Pr=Jn.name===dr.name&&kr._dbInfo.db,Jr=Pr?Gt.resolve(kr._dbInfo.db):bn(Jn).then(function(ss){var ls=Jt[Jn.name],cs=ls.forages;ls.db=ss;for(var hs=0;hs<cs.length;hs++)cs[hs]._dbInfo.db=ss;return ss});Jn.storeName?Lr=Jr.then(function(ss){if(ss.objectStoreNames.contains(Jn.storeName)){var ls=ss.version+1;pn(Jn);var cs=Jt[Jn.name],hs=cs.forages;ss.close();for(var As=0;As<hs.length;As++){var qs=hs[As];qs._dbInfo.db=null,qs._dbInfo.version=ls}var Os=new Gt(function(eo,xo){var So=Vt.open(Jn.name,ls);So.onerror=function(Uo){var $a=So.result;$a.close(),xo(Uo)},So.onupgradeneeded=function(){var Uo=So.result;Uo.deleteObjectStore(Jn.storeName)},So.onsuccess=function(){var Uo=So.result;Uo.close(),eo(Uo)}});return Os.then(function(eo){cs.db=eo;for(var xo=0;xo<hs.length;xo++){var So=hs[xo];So._dbInfo.db=eo,yn(So._dbInfo)}}).catch(function(eo){throw(gn(Jn,eo)||Gt.resolve()).catch(function(){}),eo})}}):Lr=Jr.then(function(ss){pn(Jn);var ls=Jt[Jn.name],cs=ls.forages;ss.close();for(var hs=0;hs<cs.length;hs++){var As=cs[hs];As._dbInfo.db=null}var qs=new Gt(function(Os,eo){var xo=Vt.deleteDatabase(Jn.name);xo.onerror=function(){var So=xo.result;So&&So.close(),eo(xo.error)},xo.onblocked=function(){console.warn('dropInstance blocked for database "'+Jn.name+'" until all open connections are closed')},xo.onsuccess=function(){var So=xo.result;So&&So.close(),Os(So)}});return qs.then(function(Os){ls.db=Os;for(var eo=0;eo<cs.length;eo++){var xo=cs[eo];yn(xo._dbInfo)}}).catch(function(Os){throw(gn(Jn,Os)||Gt.resolve()).catch(function(){}),Os})})}return qt(Lr,xr),Lr}var mr={_driver:"asyncStorage",_initStorage:_n,_support:zt(),iterate:Pn,getItem:Tn,setItem:Ln,removeItem:Vn,clear:Un,length:Wn,key:rr,keys:ar,dropInstance:nr};function kn(){return typeof openDatabase=="function"}var Fn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Hn="~~local_forage_type~",Bn=/^~~local_forage_type~([^~]+)~/,jn="__lfsc__:",sr=jn.length,Ar="arbf",Fr="blob",Rr="si08",Qn="ui08",jr="uic8",Mr="si16",pr="si32",Tr="ur16",Hr="ui32",Xr="fl32",Zr="fl64",ur=sr+Ar.length,hr=Object.prototype.toString;function gr(Jn){var xr=Jn.length*.75,dr=Jn.length,kr,Lr=0,Pr,Jr,ss,ls;Jn[Jn.length-1]==="="&&(xr--,Jn[Jn.length-2]==="="&&xr--);var cs=new ArrayBuffer(xr),hs=new Uint8Array(cs);for(kr=0;kr<dr;kr+=4)Pr=Fn.indexOf(Jn[kr]),Jr=Fn.indexOf(Jn[kr+1]),ss=Fn.indexOf(Jn[kr+2]),ls=Fn.indexOf(Jn[kr+3]),hs[Lr++]=Pr<<2|Jr>>4,hs[Lr++]=(Jr&15)<<4|ss>>2,hs[Lr++]=(ss&3)<<6|ls&63;return cs}function qr(Jn){var xr=new Uint8Array(Jn),dr="",kr;for(kr=0;kr<xr.length;kr+=3)dr+=Fn[xr[kr]>>2],dr+=Fn[(xr[kr]&3)<<4|xr[kr+1]>>4],dr+=Fn[(xr[kr+1]&15)<<2|xr[kr+2]>>6],dr+=Fn[xr[kr+2]&63];return xr.length%3===2?dr=dr.substring(0,dr.length-1)+"=":xr.length%3===1&&(dr=dr.substring(0,dr.length-2)+"=="),dr}function ds(Jn,xr){var dr="";if(Jn&&(dr=hr.call(Jn)),Jn&&(dr==="[object ArrayBuffer]"||Jn.buffer&&hr.call(Jn.buffer)==="[object ArrayBuffer]")){var kr,Lr=jn;Jn instanceof ArrayBuffer?(kr=Jn,Lr+=Ar):(kr=Jn.buffer,dr==="[object Int8Array]"?Lr+=Rr:dr==="[object Uint8Array]"?Lr+=Qn:dr==="[object Uint8ClampedArray]"?Lr+=jr:dr==="[object Int16Array]"?Lr+=Mr:dr==="[object Uint16Array]"?Lr+=Tr:dr==="[object Int32Array]"?Lr+=pr:dr==="[object Uint32Array]"?Lr+=Hr:dr==="[object Float32Array]"?Lr+=Xr:dr==="[object Float64Array]"?Lr+=Zr:xr(new Error("Failed to get type for BinaryArray"))),xr(Lr+qr(kr))}else if(dr==="[object Blob]"){var Pr=new FileReader;Pr.onload=function(){var Jr=Hn+Jn.type+"~"+qr(this.result);xr(jn+Fr+Jr)},Pr.readAsArrayBuffer(Jn)}else try{xr(JSON.stringify(Jn))}catch(Jr){console.error("Couldn't convert value into a JSON string: ",Jn),xr(null,Jr)}}function ms(Jn){if(Jn.substring(0,sr)!==jn)return JSON.parse(Jn);var xr=Jn.substring(ur),dr=Jn.substring(sr,ur),kr;if(dr===Fr&&Bn.test(xr)){var Lr=xr.match(Bn);kr=Lr[1],xr=xr.substring(Lr[0].length)}var Pr=gr(xr);switch(dr){case Ar:return Pr;case Fr:return Ht([Pr],{type:kr});case Rr:return new Int8Array(Pr);case Qn:return new Uint8Array(Pr);case jr:return new Uint8ClampedArray(Pr);case Mr:return new Int16Array(Pr);case Tr:return new Uint16Array(Pr);case pr:return new Int32Array(Pr);case Hr:return new Uint32Array(Pr);case Xr:return new Float32Array(Pr);case Zr:return new Float64Array(Pr);default:throw new Error("Unkown type: "+dr)}}var wr={serialize:ds,deserialize:ms,stringToBuffer:gr,bufferToString:qr};function Wr(Jn,xr,dr,kr){Jn.executeSql("CREATE TABLE IF NOT EXISTS "+xr.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],dr,kr)}function ns(Jn){var xr=this,dr={db:null};if(Jn)for(var kr in Jn)dr[kr]=typeof Jn[kr]!="string"?Jn[kr].toString():Jn[kr];var Lr=new Gt(function(Pr,Jr){try{dr.db=openDatabase(dr.name,String(dr.version),dr.description,dr.size)}catch(ss){return Jr(ss)}dr.db.transaction(function(ss){Wr(ss,dr,function(){xr._dbInfo=dr,Pr()},function(ls,cs){Jr(cs)})},Jr)});return dr.serializer=wr,Lr}function us(Jn,xr,dr,kr,Lr,Pr){Jn.executeSql(dr,kr,Lr,function(Jr,ss){ss.code===ss.SYNTAX_ERR?Jr.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[xr.storeName],function(ls,cs){cs.rows.length?Pr(ls,ss):Wr(ls,xr,function(){ls.executeSql(dr,kr,Lr,Pr)},Pr)},Pr):Pr(Jr,ss)},Pr)}function ps(Jn,xr){var dr=this;Jn=Yt(Jn);var kr=new Gt(function(Lr,Pr){dr.ready().then(function(){var Jr=dr._dbInfo;Jr.db.transaction(function(ss){us(ss,Jr,"SELECT * FROM "+Jr.storeName+" WHERE key = ? LIMIT 1",[Jn],function(ls,cs){var hs=cs.rows.length?cs.rows.item(0).value:null;hs&&(hs=Jr.serializer.deserialize(hs)),Lr(hs)},function(ls,cs){Pr(cs)})})}).catch(Pr)});return qt(kr,xr),kr}function Ls(Jn,xr){var dr=this,kr=new Gt(function(Lr,Pr){dr.ready().then(function(){var Jr=dr._dbInfo;Jr.db.transaction(function(ss){us(ss,Jr,"SELECT * FROM "+Jr.storeName,[],function(ls,cs){for(var hs=cs.rows,As=hs.length,qs=0;qs<As;qs++){var Os=hs.item(qs),eo=Os.value;if(eo&&(eo=Jr.serializer.deserialize(eo)),eo=Jn(eo,Os.key,qs+1),eo!==void 0){Lr(eo);return}}Lr()},function(ls,cs){Pr(cs)})})}).catch(Pr)});return qt(kr,xr),kr}function vs(Jn,xr,dr,kr){var Lr=this;Jn=Yt(Jn);var Pr=new Gt(function(Jr,ss){Lr.ready().then(function(){xr===void 0&&(xr=null);var ls=xr,cs=Lr._dbInfo;cs.serializer.serialize(xr,function(hs,As){As?ss(As):cs.db.transaction(function(qs){us(qs,cs,"INSERT OR REPLACE INTO "+cs.storeName+" (key, value) VALUES (?, ?)",[Jn,hs],function(){Jr(ls)},function(Os,eo){ss(eo)})},function(qs){if(qs.code===qs.QUOTA_ERR){if(kr>0){Jr(vs.apply(Lr,[Jn,ls,dr,kr-1]));return}ss(qs)}})})}).catch(ss)});return qt(Pr,dr),Pr}function Ps(Jn,xr,dr){return vs.apply(this,[Jn,xr,dr,1])}function Fs(Jn,xr){var dr=this;Jn=Yt(Jn);var kr=new Gt(function(Lr,Pr){dr.ready().then(function(){var Jr=dr._dbInfo;Jr.db.transaction(function(ss){us(ss,Jr,"DELETE FROM "+Jr.storeName+" WHERE key = ?",[Jn],function(){Lr()},function(ls,cs){Pr(cs)})})}).catch(Pr)});return qt(kr,xr),kr}function zs(Jn){var xr=this,dr=new Gt(function(kr,Lr){xr.ready().then(function(){var Pr=xr._dbInfo;Pr.db.transaction(function(Jr){us(Jr,Pr,"DELETE FROM "+Pr.storeName,[],function(){kr()},function(ss,ls){Lr(ls)})})}).catch(Lr)});return qt(dr,Jn),dr}function Eo(Jn){var xr=this,dr=new Gt(function(kr,Lr){xr.ready().then(function(){var Pr=xr._dbInfo;Pr.db.transaction(function(Jr){us(Jr,Pr,"SELECT COUNT(key) as c FROM "+Pr.storeName,[],function(ss,ls){var cs=ls.rows.item(0).c;kr(cs)},function(ss,ls){Lr(ls)})})}).catch(Lr)});return qt(dr,Jn),dr}function js(Jn,xr){var dr=this,kr=new Gt(function(Lr,Pr){dr.ready().then(function(){var Jr=dr._dbInfo;Jr.db.transaction(function(ss){us(ss,Jr,"SELECT key FROM "+Jr.storeName+" WHERE id = ? LIMIT 1",[Jn+1],function(ls,cs){var hs=cs.rows.length?cs.rows.item(0).key:null;Lr(hs)},function(ls,cs){Pr(cs)})})}).catch(Pr)});return qt(kr,xr),kr}function Hs(Jn){var xr=this,dr=new Gt(function(kr,Lr){xr.ready().then(function(){var Pr=xr._dbInfo;Pr.db.transaction(function(Jr){us(Jr,Pr,"SELECT key FROM "+Pr.storeName,[],function(ss,ls){for(var cs=[],hs=0;hs<ls.rows.length;hs++)cs.push(ls.rows.item(hs).key);kr(cs)},function(ss,ls){Lr(ls)})})}).catch(Lr)});return qt(dr,Jn),dr}function Us(Jn){return new Gt(function(xr,dr){Jn.transaction(function(kr){kr.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(Lr,Pr){for(var Jr=[],ss=0;ss<Pr.rows.length;ss++)Jr.push(Pr.rows.item(ss).name);xr({db:Jn,storeNames:Jr})},function(Lr,Pr){dr(Pr)})},function(kr){dr(kr)})})}function Ks(Jn,xr){xr=Kt.apply(this,arguments);var dr=this.config();Jn=typeof Jn!="function"&&Jn||{},Jn.name||(Jn.name=Jn.name||dr.name,Jn.storeName=Jn.storeName||dr.storeName);var kr=this,Lr;return Jn.name?Lr=new Gt(function(Pr){var Jr;Jn.name===dr.name?Jr=kr._dbInfo.db:Jr=openDatabase(Jn.name,"","",0),Jn.storeName?Pr({db:Jr,storeNames:[Jn.storeName]}):Pr(Us(Jr))}).then(function(Pr){return new Gt(function(Jr,ss){Pr.db.transaction(function(ls){function cs(Os){return new Gt(function(eo,xo){ls.executeSql("DROP TABLE IF EXISTS "+Os,[],function(){eo()},function(So,Uo){xo(Uo)})})}for(var hs=[],As=0,qs=Pr.storeNames.length;As<qs;As++)hs.push(cs(Pr.storeNames[As]));Gt.all(hs).then(function(){Jr()}).catch(function(Os){ss(Os)})},function(ls){ss(ls)})})}):Lr=Gt.reject("Invalid arguments"),qt(Lr,xr),Lr}var go={_driver:"webSQLStorage",_initStorage:ns,_support:kn(),iterate:Ls,getItem:ps,setItem:Ps,removeItem:Fs,clear:zs,length:Eo,key:js,keys:Hs,dropInstance:Ks};function vo(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function vr(Jn,xr){var dr=Jn.name+"/";return Jn.storeName!==xr.storeName&&(dr+=Jn.storeName+"/"),dr}function lr(){var Jn="_localforage_support_test";try{return localStorage.setItem(Jn,!0),localStorage.removeItem(Jn),!1}catch{return!0}}function $r(){return!lr()||localStorage.length>0}function Gr(Jn){var xr=this,dr={};if(Jn)for(var kr in Jn)dr[kr]=Jn[kr];return dr.keyPrefix=vr(Jn,xr._defaultConfig),$r()?(xr._dbInfo=dr,dr.serializer=wr,Gt.resolve()):Gt.reject()}function zr(Jn){var xr=this,dr=xr.ready().then(function(){for(var kr=xr._dbInfo.keyPrefix,Lr=localStorage.length-1;Lr>=0;Lr--){var Pr=localStorage.key(Lr);Pr.indexOf(kr)===0&&localStorage.removeItem(Pr)}});return qt(dr,Jn),dr}function fs(Jn,xr){var dr=this;Jn=Yt(Jn);var kr=dr.ready().then(function(){var Lr=dr._dbInfo,Pr=localStorage.getItem(Lr.keyPrefix+Jn);return Pr&&(Pr=Lr.serializer.deserialize(Pr)),Pr});return qt(kr,xr),kr}function Ts(Jn,xr){var dr=this,kr=dr.ready().then(function(){for(var Lr=dr._dbInfo,Pr=Lr.keyPrefix,Jr=Pr.length,ss=localStorage.length,ls=1,cs=0;cs<ss;cs++){var hs=localStorage.key(cs);if(hs.indexOf(Pr)===0){var As=localStorage.getItem(hs);if(As&&(As=Lr.serializer.deserialize(As)),As=Jn(As,hs.substring(Jr),ls++),As!==void 0)return As}}});return qt(kr,xr),kr}function Bs(Jn,xr){var dr=this,kr=dr.ready().then(function(){var Lr=dr._dbInfo,Pr;try{Pr=localStorage.key(Jn)}catch{Pr=null}return Pr&&(Pr=Pr.substring(Lr.keyPrefix.length)),Pr});return qt(kr,xr),kr}function Xs(Jn){var xr=this,dr=xr.ready().then(function(){for(var kr=xr._dbInfo,Lr=localStorage.length,Pr=[],Jr=0;Jr<Lr;Jr++){var ss=localStorage.key(Jr);ss.indexOf(kr.keyPrefix)===0&&Pr.push(ss.substring(kr.keyPrefix.length))}return Pr});return qt(dr,Jn),dr}function ro(Jn){var xr=this,dr=xr.keys().then(function(kr){return kr.length});return qt(dr,Jn),dr}function Ys(Jn,xr){var dr=this;Jn=Yt(Jn);var kr=dr.ready().then(function(){var Lr=dr._dbInfo;localStorage.removeItem(Lr.keyPrefix+Jn)});return qt(kr,xr),kr}function co(Jn,xr,dr){var kr=this;Jn=Yt(Jn);var Lr=kr.ready().then(function(){xr===void 0&&(xr=null);var Pr=xr;return new Gt(function(Jr,ss){var ls=kr._dbInfo;ls.serializer.serialize(xr,function(cs,hs){if(hs)ss(hs);else try{localStorage.setItem(ls.keyPrefix+Jn,cs),Jr(Pr)}catch(As){(As.name==="QuotaExceededError"||As.name==="NS_ERROR_DOM_QUOTA_REACHED")&&ss(As),ss(As)}})})});return qt(Lr,dr),Lr}function To(Jn,xr){if(xr=Kt.apply(this,arguments),Jn=typeof Jn!="function"&&Jn||{},!Jn.name){var dr=this.config();Jn.name=Jn.name||dr.name,Jn.storeName=Jn.storeName||dr.storeName}var kr=this,Lr;return Jn.name?Lr=new Gt(function(Pr){Jn.storeName?Pr(vr(Jn,kr._defaultConfig)):Pr(Jn.name+"/")}).then(function(Pr){for(var Jr=localStorage.length-1;Jr>=0;Jr--){var ss=localStorage.key(Jr);ss.indexOf(Pr)===0&&localStorage.removeItem(ss)}}):Lr=Gt.reject("Invalid arguments"),qt(Lr,xr),Lr}var Vs={_driver:"localStorageWrapper",_initStorage:Gr,_support:vo(),iterate:Ts,getItem:fs,setItem:co,removeItem:Ys,clear:zr,length:ro,key:Bs,keys:Xs,dropInstance:To},fo=function(xr,dr){return xr===dr||typeof xr=="number"&&typeof dr=="number"&&isNaN(xr)&&isNaN(dr)},$o=function(xr,dr){for(var kr=xr.length,Lr=0;Lr<kr;){if(fo(xr[Lr],dr))return!0;Lr++}return!1},lo=Array.isArray||function(Jn){return Object.prototype.toString.call(Jn)==="[object Array]"},ko={},jo={},Co={INDEXEDDB:mr,WEBSQL:go,LOCALSTORAGE:Vs},Go=[Co.INDEXEDDB._driver,Co.WEBSQL._driver,Co.LOCALSTORAGE._driver],Lo=["dropInstance"],Fo=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Lo),Wo={description:"",driver:Go.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Ko(Jn,xr){Jn[xr]=function(){var dr=arguments;return Jn.ready().then(function(){return Jn[xr].apply(Jn,dr)})}}function Bo(){for(var Jn=1;Jn<arguments.length;Jn++){var xr=arguments[Jn];if(xr)for(var dr in xr)xr.hasOwnProperty(dr)&&(lo(xr[dr])?arguments[0][dr]=xr[dr].slice():arguments[0][dr]=xr[dr])}return arguments[0]}var Jo=function(){function Jn(xr){jt(this,Jn);for(var dr in Co)if(Co.hasOwnProperty(dr)){var kr=Co[dr],Lr=kr._driver;this[dr]=Lr,ko[Lr]||this.defineDriver(kr)}this._defaultConfig=Bo({},Wo),this._config=Bo({},this._defaultConfig,xr),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return Jn.prototype.config=function(dr){if((typeof dr>"u"?"undefined":Ft(dr))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var kr in dr){if(kr==="storeName"&&(dr[kr]=dr[kr].replace(/\W/g,"_")),kr==="version"&&typeof dr[kr]!="number")return new Error("Database version must be a number.");this._config[kr]=dr[kr]}return"driver"in dr&&dr.driver?this.setDriver(this._config.driver):!0}else return typeof dr=="string"?this._config[dr]:this._config},Jn.prototype.defineDriver=function(dr,kr,Lr){var Pr=new Gt(function(Jr,ss){try{var ls=dr._driver,cs=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!dr._driver){ss(cs);return}for(var hs=Fo.concat("_initStorage"),As=0,qs=hs.length;As<qs;As++){var Os=hs[As],eo=!$o(Lo,Os);if((eo||dr[Os])&&typeof dr[Os]!="function"){ss(cs);return}}var xo=function(){for(var $a=function(Zo){return function(){var qo=new Error("Method "+Zo+" is not implemented by the current driver"),ba=Gt.reject(qo);return qt(ba,arguments[arguments.length-1]),ba}},Sl=0,yl=Lo.length;Sl<yl;Sl++){var Rl=Lo[Sl];dr[Rl]||(dr[Rl]=$a(Rl))}};xo();var So=function($a){ko[ls]&&console.info("Redefining LocalForage driver: "+ls),ko[ls]=dr,jo[ls]=$a,Jr()};"_support"in dr?dr._support&&typeof dr._support=="function"?dr._support().then(So,ss):So(!!dr._support):So(!0)}catch(Uo){ss(Uo)}});return Wt(Pr,kr,Lr),Pr},Jn.prototype.driver=function(){return this._driver||null},Jn.prototype.getDriver=function(dr,kr,Lr){var Pr=ko[dr]?Gt.resolve(ko[dr]):Gt.reject(new Error("Driver not found."));return Wt(Pr,kr,Lr),Pr},Jn.prototype.getSerializer=function(dr){var kr=Gt.resolve(wr);return Wt(kr,dr),kr},Jn.prototype.ready=function(dr){var kr=this,Lr=kr._driverSet.then(function(){return kr._ready===null&&(kr._ready=kr._initDriver()),kr._ready});return Wt(Lr,dr,dr),Lr},Jn.prototype.setDriver=function(dr,kr,Lr){var Pr=this;lo(dr)||(dr=[dr]);var Jr=this._getSupportedDrivers(dr);function ss(){Pr._config.driver=Pr.driver()}function ls(As){return Pr._extend(As),ss(),Pr._ready=Pr._initStorage(Pr._config),Pr._ready}function cs(As){return function(){var qs=0;function Os(){for(;qs<As.length;){var eo=As[qs];return qs++,Pr._dbInfo=null,Pr._ready=null,Pr.getDriver(eo).then(ls).catch(Os)}ss();var xo=new Error("No available storage method found.");return Pr._driverSet=Gt.reject(xo),Pr._driverSet}return Os()}}var hs=this._driverSet!==null?this._driverSet.catch(function(){return Gt.resolve()}):Gt.resolve();return this._driverSet=hs.then(function(){var As=Jr[0];return Pr._dbInfo=null,Pr._ready=null,Pr.getDriver(As).then(function(qs){Pr._driver=qs._driver,ss(),Pr._wrapLibraryMethodsWithReady(),Pr._initDriver=cs(Jr)})}).catch(function(){ss();var As=new Error("No available storage method found.");return Pr._driverSet=Gt.reject(As),Pr._driverSet}),Wt(this._driverSet,kr,Lr),this._driverSet},Jn.prototype.supports=function(dr){return!!jo[dr]},Jn.prototype._extend=function(dr){Bo(this,dr)},Jn.prototype._getSupportedDrivers=function(dr){for(var kr=[],Lr=0,Pr=dr.length;Lr<Pr;Lr++){var Jr=dr[Lr];this.supports(Jr)&&kr.push(Jr)}return kr},Jn.prototype._wrapLibraryMethodsWithReady=function(){for(var dr=0,kr=Fo.length;dr<kr;dr++)Ko(this,Fo[dr])},Jn.prototype.createInstance=function(dr){return new Jn(dr)},Jn}(),ga=new Jo;kt.exports=ga},{3:3}]},{},[4])(4)})})(localforage$1);var localforageExports=localforage$1.exports;const localforage=getDefaultExportFromCjs$1(localforageExports);var byteToHex=[];for(var i=0;i<256;++i)byteToHex.push((i+256).toString(16).slice(1));function unsafeStringify(xt,$t=0){return(byteToHex[xt[$t+0]]+byteToHex[xt[$t+1]]+byteToHex[xt[$t+2]]+byteToHex[xt[$t+3]]+"-"+byteToHex[xt[$t+4]]+byteToHex[xt[$t+5]]+"-"+byteToHex[xt[$t+6]]+byteToHex[xt[$t+7]]+"-"+byteToHex[xt[$t+8]]+byteToHex[xt[$t+9]]+"-"+byteToHex[xt[$t+10]]+byteToHex[xt[$t+11]]+byteToHex[xt[$t+12]]+byteToHex[xt[$t+13]]+byteToHex[xt[$t+14]]+byteToHex[xt[$t+15]]).toLowerCase()}var getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}var randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const native={randomUUID};function v4(xt,$t,Ct){if(native.randomUUID&&!$t&&!xt)return native.randomUUID();xt=xt||{};var kt=xt.random||(xt.rng||rng)();return kt[6]=kt[6]&15|64,kt[8]=kt[8]&63|128,unsafeStringify(kt)}class StorageEngine{constructor($t){so(this,"engine");so(this,"connected",!1);so(this,"currentParticipantId",null);this.engine=$t}isConnected(){return this.connected}getEngine(){return this.engine}}async function hash$1(xt){const $t=new TextEncoder().encode(xt),Ct=await crypto.subtle.digest("SHA-256",$t);return Array.from(new Uint8Array(Ct)).map(Ft=>Ft.toString(16).padStart(2,"0")).join("")}function isParticipantData(xt){return xt.participantId!==void 0}class FirebaseStorageEngine extends StorageEngine{constructor(){super("firebase");so(this,"RECAPTCHAV3TOKEN","6LfZFvgpAAAAAASYVKyTVe7V0at6zdqBt8L1kI3I");so(this,"firestore");so(this,"collectionPrefix","prod-");so(this,"studyCollection");so(this,"storage");so(this,"studyId","");so(this,"localForage",localforage.createInstance({name:"currentParticipantId"}));so(this,"participantData",null);const Ct=hjson.parse(`
{
  apiKey: "AIzaSyAt0JPT7QXK5N4Oc-n6gnEJEDtfUYQqpeU",
  authDomain: "sumsifterdemo.firebaseapp.com",
  projectId: "sumsifterdemo",
  storageBucket: "sumsifterdemo.appspot.com",
  messagingSenderId: "529083000336",
  appId: "1:529083000336:web:3af6cc2f15933822af0c95"
}
`),kt=initializeApp(Ct);this.firestore=initializeFirestore(kt,{}),this.storage=getStorage();try{initializeAppCheck(kt,{provider:new ReCaptchaV3Provider(this.RECAPTCHAV3TOKEN),isTokenAutoRefreshEnabled:!1})}catch{console.warn("Failed to initialize Firebase App Check")}}async connect(){try{await enableNetwork(this.firestore),this.connected=!0}catch{console.warn("Failed to connect to Firebase")}}async initializeStudyDb(Ct,kt){try{const Mt=getAuth();if(!Mt.currentUser&&(await signInAnonymously(Mt),!Mt.currentUser))throw new Error("Login failed with firebase");const Ft=await this.getCurrentConfigHash(),jt=await hash$1(JSON.stringify(kt));if(this.studyCollection=collection(this.firestore,`${this.collectionPrefix}${Ct}`),this.studyId=Ct,await this._pushToFirebaseStorage(`configs/${jt}`,"config",kt),Ft&&Ft!==jt){try{await this._deleteFromFirebaseStorage("","sequenceArray")}catch{}await this.clearCurrentParticipantId()}return await this.localForage.setItem("currentConfigHash",jt),Promise.resolve()}catch(Mt){return console.warn("Failed to connect to Firebase."),Promise.reject(Mt)}}async initializeParticipantSession(Ct,kt,Mt,Ft,jt){if(!this._verifyStudyDatabase(this.studyCollection))throw new Error("Study database not initialized");if(await this.getCurrentParticipantId(jt),!this.currentParticipantId)throw new Error("Participant not initialized");const Bt=await this._getFromFirebaseStorage(`participants/${this.currentParticipantId}`,"participantData"),Vt=await this.getModes(Ct);if(isParticipantData(Bt))return this.participantData=Bt,Bt;const zt=await hash$1(JSON.stringify(Mt));return this.participantData={participantId:this.currentParticipantId,participantConfigHash:zt,sequence:await this.getSequence(),answers:{},searchParams:kt,metadata:Ft,completed:!1,rejected:!1},Vt.dataCollectionEnabled&&await this._pushToFirebaseStorage(`participants/${this.currentParticipantId}`,"participantData",this.participantData),this.participantData}async getCurrentConfigHash(){return await this.localForage.getItem("currentConfigHash")}async getAllConfigsFromHash(Ct,kt){const Mt=Ct.map(Bt=>{const Vt=ref$2(this.storage,`${this.collectionPrefix}${kt}/configs/${Bt}_config`);return this._getFromFirebaseStorageByRef(Vt,"config")}),Ft=await Promise.all(Mt),jt={};return Ct.forEach((Bt,Vt)=>jt[Bt]=Ft[Vt]),jt}async getCurrentParticipantId(Ct){const kt=await this.localForage.getItem("currentParticipantId");if(Ct)return this.currentParticipantId=Ct,await this.localForage.setItem("currentParticipantId",Ct),Ct;if(kt)return this.currentParticipantId=kt,kt;if(!this._verifyStudyDatabase(this.studyCollection))throw new Error("Study database not initialized");return this.currentParticipantId=v4(),await this.localForage.setItem("currentParticipantId",this.currentParticipantId),this.currentParticipantId}async clearCurrentParticipantId(){return await this.localForage.removeItem("currentParticipantId")}async saveAnswers(Ct){if(!this._verifyStudyDatabase(this.studyCollection))throw new Error("Study database not initialized");if(!this.currentParticipantId||this.participantData===null)throw new Error("Participant not initialized");this.participantData={...this.participantData,answers:Ct},await this._pushToFirebaseStorage(`participants/${this.currentParticipantId}`,"participantData",this.participantData)}async setSequenceArray(Ct){if(!this._verifyStudyDatabase(this.studyCollection))throw new Error("Study database not initialized");await this._pushToFirebaseStorage("","sequenceArray",Ct)}async getSequenceArray(){if(!this._verifyStudyDatabase(this.studyCollection))throw new Error("Study database not initialized");const Ct=await this._getFromFirebaseStorage("","sequenceArray");return Array.isArray(Ct)?Ct:null}async getSequence(){if(!this._verifyStudyDatabase(this.studyCollection))throw new Error("Study database not initialized");if(!this.currentParticipantId)throw new Error("Participant not initialized");const Ct=await this.getSequenceArray();if(!Ct)throw new Error("Latin square not initialized");const kt=await this.getModes(this.studyId),Mt=doc(this.studyCollection,"sequenceAssignment");await setDoc(Mt,{});const Ft=collection(Mt,"sequenceAssignment"),jt=doc(Ft,this.currentParticipantId),Bt=query(Ft,where("participantId","==","")),Vt=await getDocs(Bt);if(Vt.docs.length>0){const Kt=Vt.docs[0],Xt=Kt.data().timestamp;kt.dataCollectionEnabled&&(await deleteDoc(Kt.ref),await setDoc(jt,{participantId:this.currentParticipantId,timestamp:Xt}))}else kt.dataCollectionEnabled&&await setDoc(jt,{participantId:this.currentParticipantId,timestamp:serverTimestamp()});const zt=query(Ft,orderBy("timestamp","asc")),qt=(await getDocs(zt)).docs.map(Kt=>Kt.data()).findIndex(Kt=>Kt.participantId===this.currentParticipantId)%Ct.length,Wt=qt===-1?Math.floor(Math.random()*Ct.length-1):qt,Yt=Ct[Wt];if(!Yt)throw new Error("Latin square is empty");return Yt}async getAllParticipantsData(){if(!this._verifyStudyDatabase(this.studyCollection))throw new Error("Study database not initialized");const Ct=ref$2(this.storage,`${this.collectionPrefix}${this.studyId}/participants`),kt=await listAll(Ct),Mt=[],Ft=kt.items.map(async jt=>{const Bt=await this._getFromFirebaseStorageByRef(jt,"participantData");isParticipantData(Bt)&&Mt.push(Bt)});return await Promise.all(Ft),Mt}async getParticipantData(){if(!this._verifyStudyDatabase(this.studyCollection))throw new Error("Study database not initialized");if(this.currentParticipantId===null)throw new Error("Participant not initialized");const Ct=await this._getFromFirebaseStorage(`participants/${this.currentParticipantId}`,"participantData");return isParticipantData(Ct)?Ct:null}async nextParticipant(){if(!this._verifyStudyDatabase(this.studyCollection))throw new Error("Study database not initialized");const Ct=v4();await this.localForage.setItem("currentParticipantId",Ct)}async verifyCompletion(){if(!this._verifyStudyDatabase(this.studyCollection))throw new Error("Study database not initialized");if(!this.currentParticipantId)throw new Error("Participant not initialized");if(await this.getParticipantData(),!this.participantData)throw new Error("Participant not initialized");const Ct=await this.getModes(this.studyId);return this.participantData.completed=!0,Ct.dataCollectionEnabled&&await this._pushToFirebaseStorage(`participants/${this.currentParticipantId}`,"participantData",this.participantData),!0}async getUserManagementData(Ct){const kt=collection(this.firestore,"user-management"),Mt=await getDocs(kt),Ft=Object.fromEntries(Mt.docs.map(jt=>[jt.id,jt.data()]));return Ct in Ft?Ft[Ct]:null}async validateUser(Ct){if(Ct!=null&&Ct.user){const kt=await this.getUserManagementData("authentication");if(kt!=null&&kt.isEnabled){const Mt=await this.getUserManagementData("adminUsers");if(Mt&&Mt.adminUsersList){const Ft=Object.fromEntries(Mt.adminUsersList.map(Bt=>[Bt.email,Bt.uid]));if(Ct.user.email&&(Ft[Ct.user.email]===Ct.user.uid||Ft[Ct.user.email]===null)){if(Ct.user.email&&Ft[Ct.user.email]===null){const Bt=Mt.adminUsersList.find(Vt=>Vt.email===Ct.user.email);Bt&&(Bt.uid=Ct.user.uid),await setDoc(doc(this.firestore,"user-management","adminUsers"),{adminUsersList:Mt.adminUsersList})}return!0}return!1}}return!0}return!1}async changeAuth(Ct){await setDoc(doc(this.firestore,"user-management","authentication"),{isEnabled:Ct})}async addAdminUser(Ct){const kt=await this.getUserManagementData("adminUsers");if(kt!=null&&kt.adminUsersList){const Mt=kt.adminUsersList;Mt.find(jt=>jt.email===Ct.email)||(Mt.push({email:Ct.email,uid:Ct.uid}),await setDoc(doc(this.firestore,"user-management","adminUsers"),{adminUsersList:Mt}))}else await setDoc(doc(this.firestore,"user-management","adminUsers"),{adminUsersList:[{email:Ct.email,uid:Ct.uid}]})}async removeAdminUser(Ct){const kt=await this.getUserManagementData("adminUsers");kt!=null&&kt.adminUsersList&&kt.adminUsersList.length>1&&kt.adminUsersList.find(Mt=>Mt.email===Ct)&&(kt.adminUsersList=kt==null?void 0:kt.adminUsersList.filter(Mt=>Mt.email!==Ct),await setDoc(doc(this.firestore,"user-management","adminUsers"),{adminUsersList:kt==null?void 0:kt.adminUsersList}))}async getAllParticipantsDataByStudy(Ct){const kt=ref$2(this.storage,`${this.collectionPrefix}${Ct}/participants`),Mt=await listAll(kt),Ft=[],jt=Mt.items.map(async Bt=>{const Vt=await this._getFromFirebaseStorageByRef(Bt,"participantData");isParticipantData(Vt)&&Ft.push(Vt)});return await Promise.all(jt),Ft}async rejectParticipant(Ct,kt){const Mt=collection(this.firestore,`${this.collectionPrefix}${Ct}`),Ft=ref$2(this.storage,`${this.collectionPrefix}${Ct}/participants/${kt}`),jt=await this._getFromFirebaseStorageByRef(Ft,"participantData");try{if(!jt||!isParticipantData(jt)||jt.rejected)return;jt.rejected=!0,await this._pushToFirebaseStorageByRef(Ft,"participantData",jt);const Bt=doc(Mt,"sequenceAssignment"),Vt=collection(Bt,"sequenceAssignment"),zt=doc(Vt,kt);await updateDoc(zt,{participantId:""})}catch{console.warn("Failed to reject the participant.")}}async setMode(Ct,kt,Mt){const Ft=doc(this.firestore,"metadata",`${this.collectionPrefix}${Ct}`);return await setDoc(Ft,{[kt]:Mt},{merge:!0})}async getModes(Ct){const kt=doc(this.firestore,"metadata",`${this.collectionPrefix}${Ct}`),Mt=await getDoc(kt);if(Mt.exists())return Mt.data();const Ft={dataCollectionEnabled:!0,studyNavigatorEnabled:!0,analyticsInterfacePubliclyAccessible:!0};return await setDoc(kt,Ft),Ft}async createSnapshot(Ct,kt){const Mt=`${this.collectionPrefix}${Ct}`;if(!await this._directoryExists(Mt))return console.warn(`Source directory ${Mt} does not exist.`),!1;const Ft=new Date,jt=Ft.getUTCFullYear(),Bt=(Ft.getUTCMonth()+1).toString().padStart(2,"0"),Vt=Ft.getUTCDate().toString().padStart(2,"0"),zt=Ft.getUTCHours().toString().padStart(2,"0"),Ht=Ft.getUTCMinutes().toString().padStart(2,"0"),Gt=Ft.getUTCSeconds().toString().padStart(2,"0"),qt=`${jt}-${Bt}-${Vt}T${zt}:${Ht}:${Gt}`,Wt=`${this.collectionPrefix}${Ct}-snapshot-${qt}`;return await this._copyDirectory(`${Mt}/configs`,`${Wt}/configs`),await this._copyDirectory(`${Mt}/participants`,`${Wt}/participants`),await this._copyDirectory(Mt,Wt),await this._copyCollection(Mt,Wt),await this._addDirectoryNameToMetadata(Wt),kt&&await this.removeSnapshotOrLive(Mt,!1),!0}async removeSnapshotOrLive(Ct,kt){const Mt=Ct.startsWith(this.collectionPrefix)?Ct:`${this.collectionPrefix}${Ct}`;await this._deleteDirectory(`${Mt}/configs`),await this._deleteDirectory(`${Mt}/participants`),await this._deleteDirectory(Mt),await this._deleteCollection(Mt),kt&&await this._removeNameFromMetadata(Mt)}async getSnapshots(Ct){try{const kt=doc(this.firestore,"metadata","collections"),Mt=await getDoc(kt);if(Mt.exists()){const Ft=Mt.data();return Object.keys(Ft).filter(Bt=>Bt.startsWith(`${this.collectionPrefix}${Ct}-snapshot`)).sort().reverse()}return[]}catch(kt){throw console.error("Error listing collections with prefix:",kt),kt}}async restoreSnapshot(Ct,kt){const Mt=`${this.collectionPrefix}${Ct}`;await this.createSnapshot(Ct,!0),await this._copyDirectory(`${kt}/configs`,`${Mt}/configs`),await this._copyDirectory(`${kt}/participants`,`${Mt}/participants`),await this._copyDirectory(kt,Mt),await this._copyCollection(kt,Mt)}async _addDirectoryNameToMetadata(Ct){try{const kt=doc(this.firestore,"metadata","collections");await setDoc(kt,{[Ct]:!0},{merge:!0})}catch(kt){console.error("Error adding collection to metadata:",kt)}}async _removeNameFromMetadata(Ct){try{const kt=doc(this.firestore,"metadata","collections"),Mt=await getDoc(kt);if(Mt.exists()){const Ft=Mt.data();Ft[Ct]?(delete Ft[Ct],await setDoc(kt,Ft)):console.warn(`${Ct} does not exist in metadata.`)}else console.warn("No metadata found.")}catch(kt){throw console.error("Error removing collection from metadata:",kt),kt}}async _deleteDirectory(Ct){try{const kt=ref$2(this.storage,Ct),Ft=(await listAll(kt)).items.map(jt=>deleteObject(jt));await Promise.all(Ft)}catch(kt){console.error("Error deleting files in directory:",kt)}}async _copyDirectory(Ct,kt){try{const Mt=ref$2(this.storage,Ct),jt=(await listAll(Mt)).items.map(Bt=>{const Vt=Bt.fullPath,zt=Vt.replace(Ct,kt);return this._copyFile(Vt,zt)});await Promise.all(jt)}catch(Mt){console.error("Error copying file:",Mt)}}async _copyFile(Ct,kt){try{const Mt=ref$2(this.storage,Ct),Ft=ref$2(this.storage,kt),jt=await getDownloadURL(Mt),Vt=await(await fetch(jt)).blob();await uploadBytes(Ft,Vt)}catch(Mt){console.error("Error copying file:",Mt)}}async _copyCollection(Ct,kt){const Mt=collection(this.firestore,Ct),Ft=doc(Mt,"sequenceAssignment"),jt=collection(Ft,"sequenceAssignment"),Bt=collection(this.firestore,kt),Vt=doc(Bt,"sequenceAssignment");await setDoc(Vt,{});const zt=collection(Vt,"sequenceAssignment"),Ht=await getDocs(jt),Gt=writeBatch(this.firestore);Ht.docs.forEach(qt=>{const Wt=doc(zt,qt.id);Gt.set(Wt,qt.data())}),await Gt.commit()}async _deleteCollection(Ct){const kt=collection(this.firestore,Ct),Mt=doc(kt,"sequenceAssignment"),Ft=collection(Mt,"sequenceAssignment"),jt=await getDocs(Ft),Bt=writeBatch(this.firestore);jt.forEach(Vt=>{const zt=doc(Ft,Vt.id);Bt.delete(zt)}),Bt.delete(Mt),await Bt.commit()}async _directoryExists(Ct){try{const kt=ref$2(this.storage,Ct);return(await listAll(kt)).items.length>0}catch(kt){if(kt.code==="storage/object-not-found")return!1;throw console.error("Error checking if directory exists:",kt),kt}}_verifyStudyDatabase(Ct){return Ct!==void 0}async _getFromFirebaseStorage(Ct,kt){const Mt=ref$2(this.storage,`${this.collectionPrefix}${this.studyId}/${Ct}_${kt}`);let Ft={};try{const jt=await getDownloadURL(Mt),Vt=await(await fetch(jt)).text();Ft=JSON.parse(Vt)}catch{console.warn(`${Ct} does not have ${kt} for ${this.collectionPrefix}${this.studyId}.`)}return Ft}async _getFromFirebaseStorageByRef(Ct,kt){let Mt={};try{const Ft=await getDownloadURL(Ct),Bt=await(await fetch(Ft)).text();Mt=JSON.parse(Bt)}catch{console.warn(`${Ct} with type ${kt} not found.`)}return Mt}async _pushToFirebaseStorage(Ct,kt,Mt){if(Object.keys(Mt).length>0){const Ft=ref$2(this.storage,`${this.collectionPrefix}${this.studyId}/${Ct}_${kt}`),jt=new Blob([JSON.stringify(Mt)],{type:"application/json"});await uploadBytes(Ft,jt)}}async _pushToFirebaseStorageByRef(Ct,kt,Mt){if(Object.keys(Mt).length>0){const Ft=new Blob([JSON.stringify(Mt)],{type:"application/json"});await uploadBytes(Ct,Ft)}}async _deleteFromFirebaseStorage(Ct,kt){const Mt=ref$2(this.storage,`${this.collectionPrefix}${this.studyId}/${Ct}_${kt}`);await deleteObject(Mt)}}const AuthContext=reactExports.createContext({user:{user:null,determiningStatus:!1,isAdmin:!1,adminVerification:!1},logout:async()=>{},triggerAuth:()=>{},verifyAdminStatus:()=>Promise.resolve(!1)}),useAuth=()=>reactExports.useContext(AuthContext);function AuthProvider({children:xt}){const $t={user:null,determiningStatus:!0,isAdmin:!1,adminVerification:!1},Ct={user:null,determiningStatus:!1,isAdmin:!1,adminVerification:!1},kt={user:{name:"fakeName",email:"fakeEmail@fake.com",uid:"fakeUid"},determiningStatus:!1,isAdmin:!0,adminVerification:!0},[Mt,Ft]=reactExports.useState($t),[jt,Bt]=reactExports.useState(!1),{storageEngine:Vt}=useStorageEngine(),zt=async()=>{const Wt=getAuth();try{await signOut(Wt)}catch(Yt){console.error(`There was an issue signing-out the user: ${Yt.message}`)}finally{Ft(Ct)}},Ht=()=>{Bt(!0)},Gt=async Wt=>Vt?await Vt.validateUser(Wt):!1;reactExports.useEffect(()=>{Ft($t);let Wt;if(Vt instanceof FirebaseStorageEngine)try{Wt=getAuth()}catch{console.warn("No firebase store.")}const Yt=async Qt=>{if(Ft(Jt=>({user:Jt.user,isAdmin:Jt.isAdmin,determiningStatus:!0,adminVerification:!1})),Qt){const Jt={user:Qt,determiningStatus:!1,isAdmin:!1,adminVerification:!0},Zt=await Gt(Jt);Jt.isAdmin=!!Zt,Ft(Jt)}else zt()},Xt=(async()=>{if(Vt instanceof FirebaseStorageEngine){const Qt=await(Vt==null?void 0:Vt.getUserManagementData("authentication"));if(Qt!=null&&Qt.isEnabled){const Jt=onAuthStateChanged(Wt,async Zt=>await Yt(Zt));return()=>Jt()}Ft(kt)}else Vt&&Ft(kt);return()=>{}})();return()=>{Xt.then(Qt=>Qt())}},[Vt,jt]);const qt=reactExports.useMemo(()=>({user:Mt,triggerAuth:Ht,logout:zt,verifyAdminStatus:Gt}),[Mt]);return jsxRuntimeExports.jsx(AuthContext.Provider,{value:qt,children:Mt.determiningStatus?jsxRuntimeExports.jsx(LoadingOverlay,{visible:!0}):xt})}function AppHeader({studyIds:xt}){const $t=useNavigate(),{studyId:Ct}=useParams(),kt=useLocation(),Mt=xt.map(qt=>({value:qt,label:qt})),{storageEngine:Ft}=useStorageEngine(),{user:jt,logout:Bt}=useAuth(),[Vt,zt]=reactExports.useState(!1),Ht=kt.pathname.includes("analysis"),Gt=[{name:"Studies",leftIcon:jsxRuntimeExports.jsx(IconFileLambda,{}),href:"/",needAdmin:!1},{name:"Analysis",leftIcon:jsxRuntimeExports.jsx(IconChartBar,{}),href:"/analysis/dashboard",needAdmin:!1},{name:"Settings",leftIcon:jsxRuntimeExports.jsx(IconSettings,{}),href:"/settings",needAdmin:!0}];return jsxRuntimeExports.jsx(AppShell.Header,{p:"md",children:jsxRuntimeExports.jsxs(Grid,{mt:-7,align:"center",children:[jsxRuntimeExports.jsx(Grid.Col,{span:6,children:jsxRuntimeExports.jsxs(Flex,{align:"center",onClick:()=>$t(Ht?"/analysis/dashboard":"/"),style:{cursor:"pointer"},children:[jsxRuntimeExports.jsx(Image$1,{w:40,src:`${PREFIX$1}revisitAssets/revisitLogoSquare.svg`,alt:"Revisit Logo"}),jsxRuntimeExports.jsx(Space,{w:"md"}),jsxRuntimeExports.jsx(Title,{order:4,style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:Ht?"ReVISit Analytics Platform":"ReVISit Studies"})]})}),jsxRuntimeExports.jsx(Grid.Col,{span:6,children:jsxRuntimeExports.jsxs(Flex,{justify:"flex-end",direction:"row",children:[Ht&&jsxRuntimeExports.jsx(Select,{allowDeselect:!1,placeholder:"Select Study",data:Mt,value:Ct,onChange:qt=>$t(`/analysis/stats/${qt}`),mr:16}),jsxRuntimeExports.jsx(Burger,{opened:!1,onClick:()=>zt(!0),style:{visibility:Vt?"hidden":void 0}}),jsxRuntimeExports.jsx(Drawer,{opened:Vt,onClose:()=>zt(!1),position:"right",withCloseButton:!1,children:jsxRuntimeExports.jsxs(Flex,{direction:"column",mt:20,children:[jsxRuntimeExports.jsx(Text,{ml:15,mb:20,fw:700,size:"lg",children:"Navigation"}),Gt.map(qt=>qt.needAdmin?jt.isAdmin?jsxRuntimeExports.jsx(Button,{leftSection:qt.leftIcon,variant:"default",style:{border:"none",display:"flex",justifyContent:"flex-start"},onClick:()=>{$t(qt.href),zt(!1)},children:qt.name},`menu-item-${qt.name}`):null:jsxRuntimeExports.jsx(Button,{leftSection:qt.leftIcon,variant:"default",style:{border:"none",display:"flex",justifyContent:"flex-start"},onClick:()=>{$t(qt.href),zt(!1)},children:qt.name},`menu-item-${qt.name}`)),jsxRuntimeExports.jsxs(Box,{ml:10,children:[jsxRuntimeExports.jsx(Divider,{my:"sm"}),(Ft==null?void 0:Ft.getEngine())==="firebase"?jt.isAdmin?jsxRuntimeExports.jsx(Text,{size:"sm",ml:10,style:{cursor:"pointer"},onClick:()=>{Bt(),$t("/login"),zt(!1)},children:"Logout"}):jsxRuntimeExports.jsx(Text,{size:"sm",ml:10,style:{cursor:"pointer"},onClick:()=>{$t("/login"),zt(!1)},children:"Login"}):null]})]})})]})})]})})}function DownloadButtons({allParticipants:xt,studyId:$t}){const[Ct,{close:kt,open:Mt}]=useDisclosure(!1),[Ft,{close:jt,open:Bt}]=useDisclosure(!1),[Vt,{open:zt,close:Ht}]=useDisclosure(!1);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Group$1,{children:[jsxRuntimeExports.jsxs(Popover,{opened:Ct,children:[jsxRuntimeExports.jsx(Popover.Target,{children:jsxRuntimeExports.jsx(Button,{variant:"light",disabled:xt.length===0,onClick:()=>{download(JSON.stringify(xt,null,2),`${$t}_all.json`)},onMouseEnter:Mt,onMouseLeave:kt,px:4,children:jsxRuntimeExports.jsx(IconDatabaseExport,{})})}),jsxRuntimeExports.jsx(Popover.Dropdown,{children:jsxRuntimeExports.jsx(Text,{children:"Download all participants data as JSON"})})]}),jsxRuntimeExports.jsxs(Popover,{opened:Ft,children:[jsxRuntimeExports.jsx(Popover.Target,{children:jsxRuntimeExports.jsx(Button,{variant:"light",disabled:xt.length===0,onClick:zt,onMouseEnter:Bt,onMouseLeave:jt,px:4,children:jsxRuntimeExports.jsx(IconTableExport,{})})}),jsxRuntimeExports.jsx(Popover.Dropdown,{children:jsxRuntimeExports.jsx(Text,{children:"Download all participants data as a tidy CSV"})})]})]}),Vt&&jsxRuntimeExports.jsx(DownloadTidy,{opened:Vt,close:Ht,filename:`${$t}_all_tidy.csv`,data:xt,studyId:$t})]})}function AnswerCell({cellData:xt}){return jsxRuntimeExports.jsx(Table$2.Td,{children:jsxRuntimeExports.jsx(Stack$1,{miw:100,children:Object.entries(xt.answer).map(([$t,Ct])=>jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsxs(Text,{fw:700,span:!0,children:[" ",`${$t}: `]}),jsxRuntimeExports.jsx(Text,{span:!0,children:`${Ct}`})]},`cell-${$t}`))})})}function DurationCell({cellData:xt}){const $t=(xt.endTime-xt.startTime)/1e3;return jsxRuntimeExports.jsxs(Table$2.Td,{children:[$t.toFixed(1)," ","s"]})}function MetaCell(xt){const{metaData:$t}=xt;return jsxRuntimeExports.jsx(Table$2.Td,{children:jsxRuntimeExports.jsx(Spoiler,{w:200,hideLabel:"hide",maxHeight:50,showLabel:"more",children:jsxRuntimeExports.jsxs(Stack$1,{gap:"xs",children:[jsxRuntimeExports.jsxs(Box,{children:["IP:"," ",$t.ip]}),jsxRuntimeExports.jsxs(Box,{children:["Language:"," ",$t.language]}),jsxRuntimeExports.jsxs(Box,{children:["Resolution:"," ",JSON.stringify($t.resolution)]}),jsxRuntimeExports.jsxs(Box,{children:["User Agent:"," ",$t.userAgent]})]})})})}function TableView({completed:xt,inProgress:$t,studyConfig:Ct,refresh:kt}){const{storageEngine:Mt}=useStorageEngine(),{studyId:Ft}=useParams(),{user:jt}=useAuth(),Bt=async Qt=>{Mt&&Ft&&(jt.isAdmin?(await Mt.rejectParticipant(Ft,Qt),await kt()):console.warn("You are not authorized to perform this action."))},[Vt,zt]=reactExports.useState([]),[Ht,Gt]=reactExports.useState(!1),qt=()=>openConfirmModal({title:"Confirm rejecting participants",children:jsxRuntimeExports.jsxs(Text,{size:"sm",children:["Are you sure you want to reject the selected participants? This action is"," ",jsxRuntimeExports.jsx(Text,{span:!0,fw:700,td:"underline",inherit:!0,children:"irreversible"}),", and will return the participants' sequences to the beginning of the sequence array."]}),labels:{confirm:"Reject Participants",cancel:"Cancel"},confirmProps:{color:"red"},cancelProps:{variant:"subtle",color:"dark"},onCancel:()=>{},onConfirm:async()=>{Gt(!0);const Qt=Vt.map(async Jt=>await Bt(Jt));await Promise.all(Qt),zt([]),await kt(),Gt(!1)}});function Wt(Qt){Qt==="all"?Vt.length===[...xt,...$t].length?zt([]):zt([...xt,...$t].map(Jt=>Jt.participantId)):Vt.includes(Qt)?zt(Vt.filter(Jt=>Jt!==Qt)):zt([...Vt,Qt])}const Yt=configSequenceToUniqueTrials(Ct.sequence),Kt=[jsxRuntimeExports.jsx(Table$2.Th,{children:jsxRuntimeExports.jsx(Flex,{justify:"center",children:jsxRuntimeExports.jsx(Checkbox,{mb:-4,checked:Vt.length===[...xt,...$t].length,onChange:()=>Wt("all")})})},"action"),jsxRuntimeExports.jsx(Table$2.Th,{children:"ID"},"ID"),jsxRuntimeExports.jsx(Table$2.Th,{children:"Status"},"status"),jsxRuntimeExports.jsx(Table$2.Th,{children:"Meta"},"meta"),...Yt.flatMap(Qt=>[jsxRuntimeExports.jsx(Table$2.Th,{children:Qt.componentName},`header-${Qt.componentName}-${Qt.timesSeenInBlock}`),jsxRuntimeExports.jsxs(Table$2.Th,{children:[Qt.componentName," ","Duration"]},`header-${Qt.componentName}-${Qt.timesSeenInBlock}-duration`)]),jsxRuntimeExports.jsx(Table$2.Th,{children:"Total Duration"},"total-duration")],Xt=[...xt,...$t].map(Qt=>jsxRuntimeExports.jsxs(Table$2.Tr,{children:[jsxRuntimeExports.jsx(Table$2.Td,{children:jsxRuntimeExports.jsx(Flex,{justify:"center",children:jsxRuntimeExports.jsx(Checkbox,{mb:-4,checked:Vt.includes(Qt.participantId),onChange:()=>Wt(Qt.participantId)})})}),jsxRuntimeExports.jsx(Table$2.Td,{style:{whiteSpace:"nowrap"},children:Qt.participantId}),jsxRuntimeExports.jsx(Table$2.Td,{children:jsxRuntimeExports.jsxs(Flex,{direction:"row",align:"center",children:[Qt.rejected?jsxRuntimeExports.jsx(Tooltip,{label:"Rejected",children:jsxRuntimeExports.jsx(IconX,{size:16,color:"red",style:{marginBottom:-3}})}):Qt.completed?jsxRuntimeExports.jsx(Tooltip,{label:"Completed",children:jsxRuntimeExports.jsx(IconCheck,{size:16,color:"teal",style:{marginBottom:-3}})}):jsxRuntimeExports.jsx(Tooltip,{label:"In Progress",children:jsxRuntimeExports.jsx(IconProgress,{size:16,color:"orange",style:{marginBottom:-3}})}),!Qt.completed&&jsxRuntimeExports.jsxs(Text,{size:"sm",mb:-1,ml:4,children:[(Object.entries(Qt.answers).filter(([Jt,Zt])=>Zt.endTime!==void 0).length/(getSequenceFlatMap(Qt.sequence).length-1)*100).toFixed(2),"%"]})]})}),Qt.metadata?jsxRuntimeExports.jsx(MetaCell,{metaData:Qt.metadata}):jsxRuntimeExports.jsx(Table$2.Td,{children:"N/A"}),Yt.map(Jt=>{const Zt=findBlockForStep(Qt.sequence,Jt.orderPath),sn=Zt&&Object.entries(Qt.answers).sort((ln,dn)=>{const hn=parseInt(ln[0].slice(ln[0].lastIndexOf("_")+1),10),cn=parseInt(dn[0].slice(dn[0].lastIndexOf("_")+1),10);return hn-cn}).filter(([ln])=>{const dn=ln.slice(0,ln.lastIndexOf("_")),hn=parseInt(ln.slice(ln.lastIndexOf("_")+1),10);return dn===Jt.componentName&&hn<=Zt[0].lastIndex&&hn>=Zt[0].firstIndex});return sn!==null&&sn.length>=Jt.timesSeenInBlock+1?jsxRuntimeExports.jsxs(React$1.Fragment,{children:[jsxRuntimeExports.jsx(AnswerCell,{cellData:sn[Jt.timesSeenInBlock][1]}),jsxRuntimeExports.jsx(DurationCell,{cellData:sn[Jt.timesSeenInBlock][1]})]},`cellgroup-${Qt.participantId}-${Jt.componentName}-${Jt.timesSeenInBlock}`):jsxRuntimeExports.jsxs(React$1.Fragment,{children:[jsxRuntimeExports.jsx(Table$2.Td,{children:"N/A"}),jsxRuntimeExports.jsx(Table$2.Td,{children:"N/A"})]},`cellgroup-${Qt.participantId}-${Jt.componentName}-${Jt.timesSeenInBlock}`)}),jsxRuntimeExports.jsx(DurationCell,{cellData:{startTime:Math.min(...Object.values(Qt.answers).map(Jt=>Jt.startTime)),endTime:Math.max(...Object.values(Qt.answers).map(Jt=>Jt.endTime)),answer:{},windowEvents:[]}},`cell-${Qt.participantId}-total-duration`)]},Qt.participantId));return[...xt,...$t].length>0?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(LoadingOverlay,{visible:Ht,overlayProps:{blur:2}}),jsxRuntimeExports.jsxs(Flex,{justify:"space-between",mb:8,p:8,children:[jsxRuntimeExports.jsx(Group$1,{children:jsxRuntimeExports.jsx(Select,{w:350,variant:"filled",placeholder:"Search for a participant ID",data:[...xt,...$t].map(Qt=>({value:Qt.participantId,label:Qt.participantId})),searchable:!0,value:null,leftSection:jsxRuntimeExports.jsx(IconSearch,{size:14}),onChange:Qt=>Qt&&Wt(Qt)})}),jsxRuntimeExports.jsxs(Group$1,{children:[jsxRuntimeExports.jsx(DownloadButtons,{allParticipants:[...xt,...$t],studyId:Ft||""}),jsxRuntimeExports.jsx(Button,{disabled:Vt.length===0||!jt.isAdmin,onClick:qt,color:"red",children:"Reject Participants"})]})]}),jsxRuntimeExports.jsx(Flex,{direction:"column",style:{width:"100%",overflow:"auto"},children:jsxRuntimeExports.jsxs(Table$2,{striped:!0,withTableBorder:!0,children:[jsxRuntimeExports.jsx(Table$2.Thead,{children:jsxRuntimeExports.jsx(Table$2.Tr,{children:Kt})}),jsxRuntimeExports.jsx(Table$2.Tbody,{children:Xt})]})})]}):jsxRuntimeExports.jsx(Flex,{justify:"center",align:"center",style:{height:"100%"},children:jsxRuntimeExports.jsx(Text,{children:"No data available"})})}const ICON_SIZE=14;function ParticipantStatusBadges({completed:xt,inProgress:$t,rejected:Ct,filteredCompleted:kt}){return jsxRuntimeExports.jsxs(Flex,{ml:4,gap:4,children:[jsxRuntimeExports.jsx(Tooltip,{label:"Completed",children:jsxRuntimeExports.jsx(Badge,{variant:"light",color:"green",leftSection:jsxRuntimeExports.jsx(IconCheck,{width:ICON_SIZE,height:ICON_SIZE,style:{paddingTop:1}}),pb:1,children:kt&&kt!==xt?`${kt}/${xt}`:xt})}),jsxRuntimeExports.jsx(Tooltip,{label:"In Progress",children:jsxRuntimeExports.jsx(Badge,{variant:"light",color:"orange",leftSection:jsxRuntimeExports.jsx(IconProgress,{width:ICON_SIZE,height:ICON_SIZE,style:{paddingTop:1}}),pb:1,children:$t})}),jsxRuntimeExports.jsx(Tooltip,{label:"Rejected",children:jsxRuntimeExports.jsx(Badge,{variant:"light",color:"red",leftSection:jsxRuntimeExports.jsx(IconX,{width:ICON_SIZE,height:ICON_SIZE,style:{paddingTop:1}}),pb:1,children:Ct})})]})}function DataManagementAccordionItem({studyId:xt,refresh:$t}){const[Ct,kt]=reactExports.useState(!1),[Mt,Ft]=reactExports.useState(!1),[jt,Bt]=reactExports.useState(!1),[Vt,zt]=reactExports.useState(""),[Ht,Gt]=reactExports.useState([]),[qt,Wt]=reactExports.useState(""),[Yt,Kt]=reactExports.useState(!1),[Xt,Qt]=reactExports.useState(!1),{storageEngine:Jt}=useStorageEngine(),Zt=Jt,sn=reactExports.useCallback(async()=>{Qt(!0);const En=await Zt.getSnapshots(xt);Gt(En),Qt(!1)},[Zt,xt]);reactExports.useEffect(()=>{sn()},[sn]);const ln=async()=>{Kt(!0),await Zt.createSnapshot(xt,!1),sn(),Kt(!1),await $t()},dn=async()=>{Kt(!0),Wt(""),kt(!1),await Zt.createSnapshot(xt,!0),sn(),Kt(!1),await $t()},hn=async En=>{Kt(!0),await Zt.restoreSnapshot(xt,En),sn(),Kt(!1),await $t()},cn=async()=>{Kt(!0),Wt(""),Ft(!1),await Zt.removeSnapshotOrLive(Vt,!0),sn(),Kt(!1),await $t()},pn=async()=>{Kt(!0),Wt(""),Bt(!1),await Zt.removeSnapshotOrLive(xt,!0),sn(),Kt(!1),await $t()},yn=()=>openConfirmModal({title:"Create a Snapshot",children:jsxRuntimeExports.jsx(Text,{mb:30,children:"This will create a snapshot of the live database without impacting the live data."}),labels:{confirm:"Create",cancel:"Cancel"},cancelProps:{variant:"subtle",color:"dark"},onCancel:()=>{},onConfirm:()=>ln()}),gn=En=>openConfirmModal({title:"Restore Snapshot",children:jsxRuntimeExports.jsx(Text,{mb:30,children:"Restoring this snapshot will perform 2 actions. First, we will create a snapshot of the current live database, then we will restore the selected snapshot into the live database."}),labels:{confirm:"Restore",cancel:"Cancel"},confirmProps:{color:"red"},cancelProps:{variant:"subtle",color:"dark"},onCancel:()=>{},onConfirm:()=>hn(En)});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(LoadingOverlay,{visible:Yt}),jsxRuntimeExports.jsxs(Flex,{justify:"space-between",align:"center",children:[jsxRuntimeExports.jsxs(Box,{style:{width:"70%"},children:[jsxRuntimeExports.jsx(Title,{order:5,children:"Create a Snapshot"}),jsxRuntimeExports.jsxs(Text,{children:["This will create a snapshot of the live"," ",jsxRuntimeExports.jsx(Text,{span:!0,fw:700,children:xt})," ","database. It will"," ",jsxRuntimeExports.jsx(Text,{span:!0,fw:700,fs:"italic",children:"not"})," ","remove this data from the live database. The current study data can be restored from a snapshot at any time."]})]}),jsxRuntimeExports.jsx(Tooltip,{label:"Create a snapshot",children:jsxRuntimeExports.jsx(Button,{onClick:yn,children:"Snapshot"})})]}),jsxRuntimeExports.jsx(Space,{h:"lg"}),jsxRuntimeExports.jsxs(Flex,{justify:"space-between",align:"center",children:[jsxRuntimeExports.jsxs(Box,{style:{width:"70%"},children:[jsxRuntimeExports.jsx(Title,{order:5,children:"Archive Data"}),jsxRuntimeExports.jsxs(Text,{children:["This will create a snapshot of the live"," ",jsxRuntimeExports.jsx(Text,{span:!0,fw:700,children:xt})," ","database. It will then remove this data from the live database. The current study data can be restored from a snapshot at any time."]})]}),jsxRuntimeExports.jsx(Tooltip,{label:"Snapshot and Delete Data",children:jsxRuntimeExports.jsx(Button,{color:"red",onClick:()=>kt(!0),children:"Archive"})})]}),jsxRuntimeExports.jsx(Space,{h:"lg"}),jsxRuntimeExports.jsxs(Flex,{justify:"space-between",align:"center",children:[jsxRuntimeExports.jsxs(Box,{style:{width:"70%"},children:[jsxRuntimeExports.jsx(Title,{order:5,children:"Delete Data"}),jsxRuntimeExports.jsxs(Text,{children:["This will delete the live"," ",jsxRuntimeExports.jsx(Text,{span:!0,fw:700,children:xt})," ","database. Since this does not create a snapshot the data will be permanently deleted and cannot be restored."]})]}),jsxRuntimeExports.jsx(Tooltip,{label:"Delete Data",children:jsxRuntimeExports.jsx(Button,{color:"red",onClick:()=>Bt(!0),children:"Delete"})})]}),jsxRuntimeExports.jsx(Space,{h:"xl"}),jsxRuntimeExports.jsxs(Flex,{direction:"column",children:[jsxRuntimeExports.jsx(Flex,{style:{borderBottom:"1px solid #dedede"},direction:"row",justify:"space-between",mb:"xs",pb:"sm",children:jsxRuntimeExports.jsx(Title,{order:5,children:"Snapshots"})}),jsxRuntimeExports.jsxs(Box,{style:{position:"relative"},children:[jsxRuntimeExports.jsx(LoadingOverlay,{visible:Xt}),Ht.length>0?Ht.map(En=>jsxRuntimeExports.jsxs(Flex,{justify:"space-between",mb:"xs",children:[jsxRuntimeExports.jsx(Text,{children:En}),jsxRuntimeExports.jsxs(Flex,{direction:"row",gap:"xs",children:[jsxRuntimeExports.jsx(Tooltip,{label:"Restore Snapshot",children:jsxRuntimeExports.jsx(ActionIcon,{color:"blue",variant:"subtle",onClick:()=>{gn(En)},children:jsxRuntimeExports.jsx(IconRefresh,{})})}),jsxRuntimeExports.jsx(Tooltip,{label:"Delete Snapshot",children:jsxRuntimeExports.jsx(ActionIcon,{color:"red",variant:"subtle",onClick:()=>{Ft(!0),zt(En)},children:jsxRuntimeExports.jsx(IconTrashX,{})})})]})]},En)):jsxRuntimeExports.jsx(Text,{children:"No snapshots."})]})]}),jsxRuntimeExports.jsxs(Modal,{opened:Ct,onClose:()=>{kt(!1),Wt("")},title:jsxRuntimeExports.jsx(Text,{children:"Archive Data"}),children:[jsxRuntimeExports.jsx(Text,{mb:"sm",children:"This will create a snapshot of the live database and remove the data from the live database."}),jsxRuntimeExports.jsx(TextInput,{label:"To archive this data, please enter the name of the study.",placeholder:xt,onChange:En=>Wt(En.target.value)}),jsxRuntimeExports.jsxs(Flex,{mt:"sm",justify:"right",children:[jsxRuntimeExports.jsx(Button,{mr:5,variant:"subtle",color:"dark",onClick:()=>{kt(!1),Wt("")},children:"Cancel"}),jsxRuntimeExports.jsx(Button,{color:"red",onClick:dn,disabled:qt!==xt,children:"Archive"})]})]}),jsxRuntimeExports.jsxs(Modal,{opened:Mt,onClose:()=>{Ft(!1),Wt("")},title:jsxRuntimeExports.jsx(Text,{children:"Delete Snapshot"}),children:[jsxRuntimeExports.jsxs(Text,{mb:"sm",children:["This will permanently remove this snapshot. This action is"," ",jsxRuntimeExports.jsx(Text,{span:!0,fw:700,children:"irreversible"}),"."]}),jsxRuntimeExports.jsx(TextInput,{label:"To delete this snapshot, please enter the name of the study.",placeholder:xt,onChange:En=>Wt(En.target.value)}),jsxRuntimeExports.jsxs(Flex,{mt:"sm",justify:"right",children:[jsxRuntimeExports.jsx(Button,{mr:5,variant:"subtle",color:"dark",onClick:()=>{Ft(!1),Wt("")},children:"Cancel"}),jsxRuntimeExports.jsx(Button,{color:"red",onClick:cn,disabled:qt!==xt,children:"Delete"})]})]}),jsxRuntimeExports.jsxs(Modal,{opened:jt,onClose:()=>{Bt(!1),Wt("")},title:jsxRuntimeExports.jsx(Text,{children:"Delete Live Data"}),children:[jsxRuntimeExports.jsxs(Text,{mb:"sm",children:["This will permanently delete the live"," ",jsxRuntimeExports.jsx(Text,{span:!0,fw:700,children:xt})," ","data. This action is"," ",jsxRuntimeExports.jsx(Text,{span:!0,fw:700,children:"irreversible"}),". Please consider using archive data to create a snapshot of the live data before deleting."]}),jsxRuntimeExports.jsx(TextInput,{label:"To delete this live data, please enter the name of the study.",placeholder:xt,onChange:En=>Wt(En.target.value)}),jsxRuntimeExports.jsxs(Flex,{mt:"sm",justify:"right",children:[jsxRuntimeExports.jsx(Button,{mr:5,variant:"subtle",color:"dark",onClick:()=>{Bt(!1),Wt("")},children:"Cancel"}),jsxRuntimeExports.jsx(Button,{color:"red",onClick:pn,disabled:qt!==xt,children:"Delete"})]})]})]})}function RevisitModesAccordionItem({studyId:xt}){const{storageEngine:$t}=useStorageEngine(),[Ct,kt]=reactExports.useState(!1),[Mt,Ft]=reactExports.useState(!1),[jt,Bt]=reactExports.useState(!1),[Vt,zt]=reactExports.useState(!1);reactExports.useEffect(()=>{(async()=>{if($t){const qt=await $t.getModes(xt);Ft(qt.dataCollectionEnabled),Bt(qt.studyNavigatorEnabled),zt(qt.analyticsInterfacePubliclyAccessible),kt(!0)}})()},[$t,xt]);const Ht=async(Gt,qt)=>{$t&&(await $t.setMode(xt,Gt,qt),Gt==="dataCollectionEnabled"?Ft(qt):Gt==="studyNavigatorEnabled"?Bt(qt):Gt==="analyticsInterfacePubliclyAccessible"&&zt(qt))};return Ct&&jsxRuntimeExports.jsxs(Stack$1,{children:[jsxRuntimeExports.jsx(Switch,{label:"Data Collection Enabled",checked:Mt,onChange:Gt=>Ht("dataCollectionEnabled",Gt.currentTarget.checked)}),jsxRuntimeExports.jsx(Switch,{label:"Study Navigator Enabled",checked:jt,onChange:Gt=>Ht("studyNavigatorEnabled",Gt.currentTarget.checked)}),jsxRuntimeExports.jsx(Switch,{label:"Analytics Interface Publicly Accessible",checked:Vt,onChange:Gt=>Ht("analyticsInterfacePubliclyAccessible",Gt.currentTarget.checked)})]})}function ManageAccordion({studyId:xt,refresh:$t}){const{storageEngine:Ct}=useStorageEngine();return jsxRuntimeExports.jsx(Container,{children:jsxRuntimeExports.jsxs(Accordion,{multiple:!0,variant:"contained",children:[jsxRuntimeExports.jsxs(Accordion.Item,{value:"ReVISit Modes",children:[jsxRuntimeExports.jsx(Accordion.Control,{children:jsxRuntimeExports.jsx(Title,{order:5,children:"ReVISit Modes"})}),jsxRuntimeExports.jsx(Accordion.Panel,{children:jsxRuntimeExports.jsx(RevisitModesAccordionItem,{studyId:xt})})]},"modes"),jsxRuntimeExports.jsxs(Accordion.Item,{value:"Data Management",children:[jsxRuntimeExports.jsx(Accordion.Control,{disabled:(Ct==null?void 0:Ct.getEngine())==="localStorage",children:jsxRuntimeExports.jsx(Title,{order:5,children:"Data Management"})}),jsxRuntimeExports.jsx(Accordion.Panel,{children:(Ct==null?void 0:Ct.getEngine())!=="localStorage"&&jsxRuntimeExports.jsx(DataManagementAccordionItem,{studyId:xt,refresh:$t})})]},"dataManagement")]})})}function AnalysisInterface(xt){const{globalConfig:$t}=xt,{studyId:Ct}=useParams(),[kt,Mt]=reactExports.useState([]),[Ft,jt]=reactExports.useState(void 0),[Bt,Vt]=reactExports.useState(!1),{storageEngine:zt}=useStorageEngine(),Ht=useNavigate(),{tab:Gt}=useParams(),{user:qt}=useAuth(),Wt=reactExports.useCallback(async()=>{if(Vt(!0),Ct){const Qt=await getStudyConfig(Ct,$t);if(!Qt||!zt)return;await zt.initializeStudyDb(Ct,Qt);const Jt=await zt.getAllParticipantsData();Mt(Jt),jt(Qt),Vt(!1)}},[$t,zt,Ct]);reactExports.useEffect(()=>{Wt()},[$t,zt,Ct,Wt]);const[Yt,Kt,Xt]=reactExports.useMemo(()=>{const Qt=kt.filter(sn=>!sn.rejected&&sn.completed),Jt=kt.filter(sn=>!sn.rejected&&!sn.completed),Zt=kt.filter(sn=>sn.rejected);return[Qt,Jt,Zt]},[kt]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AppHeader,{studyIds:xt.globalConfig.configsList}),jsxRuntimeExports.jsx(AppShell.Main,{children:jsxRuntimeExports.jsxs(Container,{fluid:!0,style:{height:"100%"},children:[jsxRuntimeExports.jsx(LoadingOverlay,{visible:Bt}),jsxRuntimeExports.jsxs(Flex,{direction:"row",align:"center",children:[jsxRuntimeExports.jsx(Title,{order:5,children:Ct}),jsxRuntimeExports.jsx(ParticipantStatusBadges,{completed:Yt.length,inProgress:Kt.length,rejected:Xt.length})]}),jsxRuntimeExports.jsx(Space,{h:"xs"}),jsxRuntimeExports.jsxs(Tabs,{variant:"outline",value:Gt,onChange:Qt=>Ht(`./../${Qt}`),style:{height:"100%"},children:[jsxRuntimeExports.jsxs(Tabs.List,{children:[jsxRuntimeExports.jsx(Tabs.Tab,{value:"table",leftSection:jsxRuntimeExports.jsx(IconTable,{size:16}),children:"Table View"}),jsxRuntimeExports.jsx(Tooltip,{label:"Coming soon",position:"bottom",children:jsxRuntimeExports.jsx(Tabs.Tab,{value:"stats",leftSection:jsxRuntimeExports.jsx(IconChartDonut2,{size:16}),disabled:!0,children:"Trial Stats"})}),jsxRuntimeExports.jsx(Tooltip,{label:"Coming soon",position:"bottom",children:jsxRuntimeExports.jsx(Tabs.Tab,{value:"replay",leftSection:jsxRuntimeExports.jsx(IconPlayerPlay,{size:16}),disabled:!0,children:"Participant Replay"})}),jsxRuntimeExports.jsx(Tabs.Tab,{value:"manage",leftSection:jsxRuntimeExports.jsx(IconSettings,{size:16}),disabled:!qt.isAdmin,children:"Manage"})]}),jsxRuntimeExports.jsx(Tabs.Panel,{value:"table",pt:"xs",children:Ft&&jsxRuntimeExports.jsx(TableView,{completed:Yt,inProgress:Kt,studyConfig:Ft,refresh:Wt})}),jsxRuntimeExports.jsx(Tabs.Panel,{value:"stats",pt:"xs",children:"statsboard"}),jsxRuntimeExports.jsx(Tabs.Panel,{value:"replay",pt:"xs",children:"Replay Tab Content"}),jsxRuntimeExports.jsx(Tabs.Panel,{value:"manage",pt:"xs",children:Ct&&qt.isAdmin?jsxRuntimeExports.jsx(ManageAccordion,{studyId:Ct,refresh:Wt}):jsxRuntimeExports.jsx(Container,{mt:20,children:jsxRuntimeExports.jsx(Alert,{title:"Unauthorized Access",variant:"light",color:"red",icon:jsxRuntimeExports.jsx(IconInfoCircle,{}),children:"You are not authorized to manage the data for this study."})})})]})]})})]})}function ProtectedRoute({children:xt,paramToCheck:$t,paramCallback:Ct}){const{user:kt,verifyAdminStatus:Mt,logout:Ft}=useAuth(),{storageEngine:jt}=useStorageEngine(),[Bt,Vt]=reactExports.useState(!1),zt=useParams();return reactExports.useEffect(()=>{(async()=>{if(Bt===!1)if($t&&Ct&&zt[$t]){const Gt=await Ct(zt[$t]);Gt&&Vt(Gt)}else Vt(!0);if(Bt)try{kt&&await Mt(kt)||Ft()}catch(Gt){Ft(),console.warn(Gt)}})()},[kt.isAdmin,Bt]),kt.determiningStatus||!jt?jsxRuntimeExports.jsx(LoadingOverlay,{visible:kt.determiningStatus||!(jt!=null&&jt.getEngine())}):Bt&&!kt.isAdmin&&!kt.determiningStatus?jsxRuntimeExports.jsx(Navigate,{to:"/login"}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:xt})}async function signInWithGoogle(xt,$t,Ct){if(xt instanceof FirebaseStorageEngine){$t(!0);const kt=new GoogleAuthProvider,Mt=getAuth();try{await signInWithPopup(Mt,kt,browserPopupRedirectResolver)}catch(Ft){Ct&&Ct(Ft.message)}finally{$t(!1)}return Mt.currentUser}return null}function Login(){const{user:xt}=useAuth(),[$t,Ct]=reactExports.useState(null),[kt,Mt]=reactExports.useState(!1),{storageEngine:Ft}=useStorageEngine();return reactExports.useEffect(()=>{!xt.determiningStatus&&!xt.isAdmin&&xt.adminVerification&&Ct("You are not authorized to use this application.")},[xt.adminVerification]),!xt.determiningStatus&&xt.isAdmin?jsxRuntimeExports.jsx(Navigate,{to:"/"}):jsxRuntimeExports.jsx(Container,{children:jsxRuntimeExports.jsx(Card,{padding:"lg",children:jsxRuntimeExports.jsxs(Flex,{align:"center",direction:"column",justify:"center",children:[jsxRuntimeExports.jsx(Image$1,{maw:200,mt:50,mb:100,src:`${PREFIX$1}revisitAssets/revisitLogoSquare.svg`,alt:"Revisit Logo"}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Text,{mb:20,children:"To access admin settings, please sign in using your Google account."}),jsxRuntimeExports.jsx(Button,{onClick:()=>signInWithGoogle(Ft,Mt,Ct),leftSection:jsxRuntimeExports.jsx(IconBrandGoogleFilled,{}),variant:"filled",children:"Sign In With Google"})]}),$t?jsxRuntimeExports.jsx(Badge,{size:"lg",color:"red",mt:30,children:$t}):null,jsxRuntimeExports.jsx(LoadingOverlay,{visible:kt})]})})})}var dayjs_min={exports:{}};(function(xt,$t){(function(Ct,kt){xt.exports=kt()})(commonjsGlobal$2,function(){var Ct=1e3,kt=6e4,Mt=36e5,Ft="millisecond",jt="second",Bt="minute",Vt="hour",zt="day",Ht="week",Gt="month",qt="quarter",Wt="year",Yt="date",Kt="Invalid Date",Xt=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Qt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Jt={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(xn){var Cn=["th","st","nd","rd"],$n=xn%100;return"["+xn+(Cn[($n-20)%10]||Cn[$n]||Cn[0])+"]"}},Zt=function(xn,Cn,$n){var wn=String(xn);return!wn||wn.length>=Cn?xn:""+Array(Cn+1-wn.length).join($n)+xn},sn={s:Zt,z:function(xn){var Cn=-xn.utcOffset(),$n=Math.abs(Cn),wn=Math.floor($n/60),Rn=$n%60;return(Cn<=0?"+":"-")+Zt(wn,2,"0")+":"+Zt(Rn,2,"0")},m:function xn(Cn,$n){if(Cn.date()<$n.date())return-xn($n,Cn);var wn=12*($n.year()-Cn.year())+($n.month()-Cn.month()),Rn=Cn.clone().add(wn,Gt),Dn=$n-Rn<0,An=Cn.clone().add(wn+(Dn?-1:1),Gt);return+(-(wn+($n-Rn)/(Dn?Rn-An:An-Rn))||0)},a:function(xn){return xn<0?Math.ceil(xn)||0:Math.floor(xn)},p:function(xn){return{M:Gt,y:Wt,w:Ht,d:zt,D:Yt,h:Vt,m:Bt,s:jt,ms:Ft,Q:qt}[xn]||String(xn||"").toLowerCase().replace(/s$/,"")},u:function(xn){return xn===void 0}},ln="en",dn={};dn[ln]=Jt;var hn="$isDayjsObject",cn=function(xn){return xn instanceof En||!(!xn||!xn[hn])},pn=function xn(Cn,$n,wn){var Rn;if(!Cn)return ln;if(typeof Cn=="string"){var Dn=Cn.toLowerCase();dn[Dn]&&(Rn=Dn),$n&&(dn[Dn]=$n,Rn=Dn);var An=Cn.split("-");if(!Rn&&An.length>1)return xn(An[0])}else{var Sn=Cn.name;dn[Sn]=Cn,Rn=Sn}return!wn&&Rn&&(ln=Rn),Rn||!wn&&ln},yn=function(xn,Cn){if(cn(xn))return xn.clone();var $n=typeof Cn=="object"?Cn:{};return $n.date=xn,$n.args=arguments,new En($n)},gn=sn;gn.l=pn,gn.i=cn,gn.w=function(xn,Cn){return yn(xn,{locale:Cn.$L,utc:Cn.$u,x:Cn.$x,$offset:Cn.$offset})};var En=function(){function xn($n){this.$L=pn($n.locale,null,!0),this.parse($n),this.$x=this.$x||$n.x||{},this[hn]=!0}var Cn=xn.prototype;return Cn.parse=function($n){this.$d=function(wn){var Rn=wn.date,Dn=wn.utc;if(Rn===null)return new Date(NaN);if(gn.u(Rn))return new Date;if(Rn instanceof Date)return new Date(Rn);if(typeof Rn=="string"&&!/Z$/i.test(Rn)){var An=Rn.match(Xt);if(An){var Sn=An[2]-1||0,vn=(An[7]||"0").substring(0,3);return Dn?new Date(Date.UTC(An[1],Sn,An[3]||1,An[4]||0,An[5]||0,An[6]||0,vn)):new Date(An[1],Sn,An[3]||1,An[4]||0,An[5]||0,An[6]||0,vn)}}return new Date(Rn)}($n),this.init()},Cn.init=function(){var $n=this.$d;this.$y=$n.getFullYear(),this.$M=$n.getMonth(),this.$D=$n.getDate(),this.$W=$n.getDay(),this.$H=$n.getHours(),this.$m=$n.getMinutes(),this.$s=$n.getSeconds(),this.$ms=$n.getMilliseconds()},Cn.$utils=function(){return gn},Cn.isValid=function(){return this.$d.toString()!==Kt},Cn.isSame=function($n,wn){var Rn=yn($n);return this.startOf(wn)<=Rn&&Rn<=this.endOf(wn)},Cn.isAfter=function($n,wn){return yn($n)<this.startOf(wn)},Cn.isBefore=function($n,wn){return this.endOf(wn)<yn($n)},Cn.$g=function($n,wn,Rn){return gn.u($n)?this[wn]:this.set(Rn,$n)},Cn.unix=function(){return Math.floor(this.valueOf()/1e3)},Cn.valueOf=function(){return this.$d.getTime()},Cn.startOf=function($n,wn){var Rn=this,Dn=!!gn.u(wn)||wn,An=gn.p($n),Sn=function(Wn,rr){var ar=gn.w(Rn.$u?Date.UTC(Rn.$y,rr,Wn):new Date(Rn.$y,rr,Wn),Rn);return Dn?ar:ar.endOf(zt)},vn=function(Wn,rr){return gn.w(Rn.toDate()[Wn].apply(Rn.toDate("s"),(Dn?[0,0,0,0]:[23,59,59,999]).slice(rr)),Rn)},_n=this.$W,Tn=this.$M,Pn=this.$D,Ln="set"+(this.$u?"UTC":"");switch(An){case Wt:return Dn?Sn(1,0):Sn(31,11);case Gt:return Dn?Sn(1,Tn):Sn(0,Tn+1);case Ht:var Vn=this.$locale().weekStart||0,Un=(_n<Vn?_n+7:_n)-Vn;return Sn(Dn?Pn-Un:Pn+(6-Un),Tn);case zt:case Yt:return vn(Ln+"Hours",0);case Vt:return vn(Ln+"Minutes",1);case Bt:return vn(Ln+"Seconds",2);case jt:return vn(Ln+"Milliseconds",3);default:return this.clone()}},Cn.endOf=function($n){return this.startOf($n,!1)},Cn.$set=function($n,wn){var Rn,Dn=gn.p($n),An="set"+(this.$u?"UTC":""),Sn=(Rn={},Rn[zt]=An+"Date",Rn[Yt]=An+"Date",Rn[Gt]=An+"Month",Rn[Wt]=An+"FullYear",Rn[Vt]=An+"Hours",Rn[Bt]=An+"Minutes",Rn[jt]=An+"Seconds",Rn[Ft]=An+"Milliseconds",Rn)[Dn],vn=Dn===zt?this.$D+(wn-this.$W):wn;if(Dn===Gt||Dn===Wt){var _n=this.clone().set(Yt,1);_n.$d[Sn](vn),_n.init(),this.$d=_n.set(Yt,Math.min(this.$D,_n.daysInMonth())).$d}else Sn&&this.$d[Sn](vn);return this.init(),this},Cn.set=function($n,wn){return this.clone().$set($n,wn)},Cn.get=function($n){return this[gn.p($n)]()},Cn.add=function($n,wn){var Rn,Dn=this;$n=Number($n);var An=gn.p(wn),Sn=function(Tn){var Pn=yn(Dn);return gn.w(Pn.date(Pn.date()+Math.round(Tn*$n)),Dn)};if(An===Gt)return this.set(Gt,this.$M+$n);if(An===Wt)return this.set(Wt,this.$y+$n);if(An===zt)return Sn(1);if(An===Ht)return Sn(7);var vn=(Rn={},Rn[Bt]=kt,Rn[Vt]=Mt,Rn[jt]=Ct,Rn)[An]||1,_n=this.$d.getTime()+$n*vn;return gn.w(_n,this)},Cn.subtract=function($n,wn){return this.add(-1*$n,wn)},Cn.format=function($n){var wn=this,Rn=this.$locale();if(!this.isValid())return Rn.invalidDate||Kt;var Dn=$n||"YYYY-MM-DDTHH:mm:ssZ",An=gn.z(this),Sn=this.$H,vn=this.$m,_n=this.$M,Tn=Rn.weekdays,Pn=Rn.months,Ln=Rn.meridiem,Vn=function(rr,ar,nr,mr){return rr&&(rr[ar]||rr(wn,Dn))||nr[ar].slice(0,mr)},Un=function(rr){return gn.s(Sn%12||12,rr,"0")},Wn=Ln||function(rr,ar,nr){var mr=rr<12?"AM":"PM";return nr?mr.toLowerCase():mr};return Dn.replace(Qt,function(rr,ar){return ar||function(nr){switch(nr){case"YY":return String(wn.$y).slice(-2);case"YYYY":return gn.s(wn.$y,4,"0");case"M":return _n+1;case"MM":return gn.s(_n+1,2,"0");case"MMM":return Vn(Rn.monthsShort,_n,Pn,3);case"MMMM":return Vn(Pn,_n);case"D":return wn.$D;case"DD":return gn.s(wn.$D,2,"0");case"d":return String(wn.$W);case"dd":return Vn(Rn.weekdaysMin,wn.$W,Tn,2);case"ddd":return Vn(Rn.weekdaysShort,wn.$W,Tn,3);case"dddd":return Tn[wn.$W];case"H":return String(Sn);case"HH":return gn.s(Sn,2,"0");case"h":return Un(1);case"hh":return Un(2);case"a":return Wn(Sn,vn,!0);case"A":return Wn(Sn,vn,!1);case"m":return String(vn);case"mm":return gn.s(vn,2,"0");case"s":return String(wn.$s);case"ss":return gn.s(wn.$s,2,"0");case"SSS":return gn.s(wn.$ms,3,"0");case"Z":return An}return null}(rr)||An.replace(":","")})},Cn.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Cn.diff=function($n,wn,Rn){var Dn,An=this,Sn=gn.p(wn),vn=yn($n),_n=(vn.utcOffset()-this.utcOffset())*kt,Tn=this-vn,Pn=function(){return gn.m(An,vn)};switch(Sn){case Wt:Dn=Pn()/12;break;case Gt:Dn=Pn();break;case qt:Dn=Pn()/3;break;case Ht:Dn=(Tn-_n)/6048e5;break;case zt:Dn=(Tn-_n)/864e5;break;case Vt:Dn=Tn/Mt;break;case Bt:Dn=Tn/kt;break;case jt:Dn=Tn/Ct;break;default:Dn=Tn}return Rn?Dn:gn.a(Dn)},Cn.daysInMonth=function(){return this.endOf(Gt).$D},Cn.$locale=function(){return dn[this.$L]},Cn.locale=function($n,wn){if(!$n)return this.$L;var Rn=this.clone(),Dn=pn($n,wn,!0);return Dn&&(Rn.$L=Dn),Rn},Cn.clone=function(){return gn.w(this.$d,this)},Cn.toDate=function(){return new Date(this.valueOf())},Cn.toJSON=function(){return this.isValid()?this.toISOString():null},Cn.toISOString=function(){return this.$d.toISOString()},Cn.toString=function(){return this.$d.toUTCString()},xn}(),bn=En.prototype;return yn.prototype=bn,[["$ms",Ft],["$s",jt],["$m",Bt],["$H",Vt],["$W",zt],["$M",Gt],["$y",Wt],["$D",Yt]].forEach(function(xn){bn[xn[1]]=function(Cn){return this.$g(Cn,xn[0],xn[1])}}),yn.extend=function(xn,Cn){return xn.$i||(xn(Cn,En,yn),xn.$i=!0),yn},yn.locale=pn,yn.isDayjs=cn,yn.unix=function(xn){return yn(1e3*xn)},yn.en=dn[ln],yn.Ls=dn,yn.p={},yn})})(dayjs_min);var dayjs_minExports=dayjs_min.exports;const dayjs=getDefaultExportFromCjs$1(dayjs_minExports);function defaultDateFormatter({type:xt,date:$t,locale:Ct,format:kt,labelSeparator:Mt}){const Ft=jt=>dayjs(jt).locale(Ct).format(kt);return xt==="default"?$t===null?"":Ft($t):xt==="multiple"?$t.map(Ft).join(", "):xt==="range"&&Array.isArray($t)?$t[0]&&$t[1]?`${Ft($t[0])} ${Mt} ${Ft($t[1])}`:$t[0]?`${Ft($t[0])} ${Mt} `:"":""}function getFormattedDate({formatter:xt,...$t}){return(xt||defaultDateFormatter)($t)}function getNextIndex({direction:xt,levelIndex:$t,rowIndex:Ct,cellIndex:kt,size:Mt}){switch(xt){case"up":return $t===0&&Ct===0?null:Ct===0?{levelIndex:$t-1,rowIndex:kt<=Mt[$t-1][Mt[$t-1].length-1]-1?Mt[$t-1].length-1:Mt[$t-1].length-2,cellIndex:kt}:{levelIndex:$t,rowIndex:Ct-1,cellIndex:kt};case"down":return Ct===Mt[$t].length-1?{levelIndex:$t+1,rowIndex:0,cellIndex:kt}:Ct===Mt[$t].length-2&&kt>=Mt[$t][Mt[$t].length-1]?{levelIndex:$t+1,rowIndex:0,cellIndex:kt}:{levelIndex:$t,rowIndex:Ct+1,cellIndex:kt};case"left":return $t===0&&Ct===0&&kt===0?null:Ct===0&&kt===0?{levelIndex:$t-1,rowIndex:Mt[$t-1].length-1,cellIndex:Mt[$t-1][Mt[$t-1].length-1]-1}:kt===0?{levelIndex:$t,rowIndex:Ct-1,cellIndex:Mt[$t][Ct-1]-1}:{levelIndex:$t,rowIndex:Ct,cellIndex:kt-1};case"right":return Ct===Mt[$t].length-1&&kt===Mt[$t][Ct]-1?{levelIndex:$t+1,rowIndex:0,cellIndex:0}:kt===Mt[$t][Ct]-1?{levelIndex:$t,rowIndex:Ct+1,cellIndex:0}:{levelIndex:$t,rowIndex:Ct,cellIndex:kt+1};default:return{levelIndex:$t,rowIndex:Ct,cellIndex:kt}}}function focusOnNextFocusableControl({controlsRef:xt,direction:$t,levelIndex:Ct,rowIndex:kt,cellIndex:Mt,size:Ft}){var Vt,zt,Ht;const jt=getNextIndex({direction:$t,size:Ft,rowIndex:kt,cellIndex:Mt,levelIndex:Ct});if(!jt)return;const Bt=(Ht=(zt=(Vt=xt.current)==null?void 0:Vt[jt.levelIndex])==null?void 0:zt[jt.rowIndex])==null?void 0:Ht[jt.cellIndex];Bt&&(Bt.disabled||Bt.getAttribute("data-hidden")||Bt.getAttribute("data-outside")?focusOnNextFocusableControl({controlsRef:xt,direction:$t,levelIndex:jt.levelIndex,cellIndex:jt.cellIndex,rowIndex:jt.rowIndex,size:Ft}):Bt.focus())}function getDirection$1(xt){switch(xt){case"ArrowDown":return"down";case"ArrowUp":return"up";case"ArrowRight":return"right";case"ArrowLeft":return"left";default:return null}}function getControlsSize(xt){var $t;return($t=xt.current)==null?void 0:$t.map(Ct=>Ct.map(kt=>kt.length))}function handleControlKeyDown({controlsRef:xt,levelIndex:$t,rowIndex:Ct,cellIndex:kt,event:Mt}){const Ft=getDirection$1(Mt.key);if(Ft){Mt.preventDefault();const jt=getControlsSize(xt);focusOnNextFocusableControl({controlsRef:xt,direction:Ft,levelIndex:$t,rowIndex:Ct,cellIndex:kt,size:jt})}}var timezone={exports:{}};(function(xt,$t){(function(Ct,kt){xt.exports=kt()})(commonjsGlobal$2,function(){var Ct={year:0,month:1,day:2,hour:3,minute:4,second:5},kt={};return function(Mt,Ft,jt){var Bt,Vt=function(qt,Wt,Yt){Yt===void 0&&(Yt={});var Kt=new Date(qt),Xt=function(Qt,Jt){Jt===void 0&&(Jt={});var Zt=Jt.timeZoneName||"short",sn=Qt+"|"+Zt,ln=kt[sn];return ln||(ln=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:Qt,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:Zt}),kt[sn]=ln),ln}(Wt,Yt);return Xt.formatToParts(Kt)},zt=function(qt,Wt){for(var Yt=Vt(qt,Wt),Kt=[],Xt=0;Xt<Yt.length;Xt+=1){var Qt=Yt[Xt],Jt=Qt.type,Zt=Qt.value,sn=Ct[Jt];sn>=0&&(Kt[sn]=parseInt(Zt,10))}var ln=Kt[3],dn=ln===24?0:ln,hn=Kt[0]+"-"+Kt[1]+"-"+Kt[2]+" "+dn+":"+Kt[4]+":"+Kt[5]+":000",cn=+qt;return(jt.utc(hn).valueOf()-(cn-=cn%1e3))/6e4},Ht=Ft.prototype;Ht.tz=function(qt,Wt){qt===void 0&&(qt=Bt);var Yt=this.utcOffset(),Kt=this.toDate(),Xt=Kt.toLocaleString("en-US",{timeZone:qt}),Qt=Math.round((Kt-new Date(Xt))/1e3/60),Jt=jt(Xt,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(Kt.getTimezoneOffset()/15)-Qt,!0);if(Wt){var Zt=Jt.utcOffset();Jt=Jt.add(Yt-Zt,"minute")}return Jt.$x.$timezone=qt,Jt},Ht.offsetName=function(qt){var Wt=this.$x.$timezone||jt.tz.guess(),Yt=Vt(this.valueOf(),Wt,{timeZoneName:qt}).find(function(Kt){return Kt.type.toLowerCase()==="timezonename"});return Yt&&Yt.value};var Gt=Ht.startOf;Ht.startOf=function(qt,Wt){if(!this.$x||!this.$x.$timezone)return Gt.call(this,qt,Wt);var Yt=jt(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return Gt.call(Yt,qt,Wt).tz(this.$x.$timezone,!0)},jt.tz=function(qt,Wt,Yt){var Kt=Yt&&Wt,Xt=Yt||Wt||Bt,Qt=zt(+jt(),Xt);if(typeof qt!="string")return jt(qt).tz(Xt);var Jt=function(dn,hn,cn){var pn=dn-60*hn*1e3,yn=zt(pn,cn);if(hn===yn)return[pn,hn];var gn=zt(pn-=60*(yn-hn)*1e3,cn);return yn===gn?[pn,yn]:[dn-60*Math.min(yn,gn)*1e3,Math.max(yn,gn)]}(jt.utc(qt,Kt).valueOf(),Qt,Xt),Zt=Jt[0],sn=Jt[1],ln=jt(Zt).utcOffset(sn);return ln.$x.$timezone=Xt,ln},jt.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},jt.tz.setDefault=function(qt){Bt=qt}}})})(timezone);var timezoneExports=timezone.exports;const timezonePlugin=getDefaultExportFromCjs$1(timezoneExports);var utc={exports:{}};(function(xt,$t){(function(Ct,kt){xt.exports=kt()})(commonjsGlobal$2,function(){var Ct="minute",kt=/[+-]\d\d(?::?\d\d)?/g,Mt=/([+-]|\d\d)/g;return function(Ft,jt,Bt){var Vt=jt.prototype;Bt.utc=function(Kt){var Xt={date:Kt,utc:!0,args:arguments};return new jt(Xt)},Vt.utc=function(Kt){var Xt=Bt(this.toDate(),{locale:this.$L,utc:!0});return Kt?Xt.add(this.utcOffset(),Ct):Xt},Vt.local=function(){return Bt(this.toDate(),{locale:this.$L,utc:!1})};var zt=Vt.parse;Vt.parse=function(Kt){Kt.utc&&(this.$u=!0),this.$utils().u(Kt.$offset)||(this.$offset=Kt.$offset),zt.call(this,Kt)};var Ht=Vt.init;Vt.init=function(){if(this.$u){var Kt=this.$d;this.$y=Kt.getUTCFullYear(),this.$M=Kt.getUTCMonth(),this.$D=Kt.getUTCDate(),this.$W=Kt.getUTCDay(),this.$H=Kt.getUTCHours(),this.$m=Kt.getUTCMinutes(),this.$s=Kt.getUTCSeconds(),this.$ms=Kt.getUTCMilliseconds()}else Ht.call(this)};var Gt=Vt.utcOffset;Vt.utcOffset=function(Kt,Xt){var Qt=this.$utils().u;if(Qt(Kt))return this.$u?0:Qt(this.$offset)?Gt.call(this):this.$offset;if(typeof Kt=="string"&&(Kt=function(ln){ln===void 0&&(ln="");var dn=ln.match(kt);if(!dn)return null;var hn=(""+dn[0]).match(Mt)||["-",0,0],cn=hn[0],pn=60*+hn[1]+ +hn[2];return pn===0?0:cn==="+"?pn:-pn}(Kt),Kt===null))return this;var Jt=Math.abs(Kt)<=16?60*Kt:Kt,Zt=this;if(Xt)return Zt.$offset=Jt,Zt.$u=Kt===0,Zt;if(Kt!==0){var sn=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(Zt=this.local().add(Jt+sn,Ct)).$offset=Jt,Zt.$x.$localOffset=sn}else Zt=this.utc();return Zt};var qt=Vt.format;Vt.format=function(Kt){var Xt=Kt||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return qt.call(this,Xt)},Vt.valueOf=function(){var Kt=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*Kt},Vt.isUTC=function(){return!!this.$u},Vt.toISOString=function(){return this.toDate().toISOString()},Vt.toString=function(){return this.toDate().toUTCString()};var Wt=Vt.toDate;Vt.toDate=function(Kt){return Kt==="s"&&this.$offset?Bt(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():Wt.call(this)};var Yt=Vt.diff;Vt.diff=function(Kt,Xt,Qt){if(Kt&&this.$u===Kt.$u)return Yt.call(this,Kt,Xt,Qt);var Jt=this.local(),Zt=Bt(Kt).local();return Yt.call(Jt,Zt,Xt,Qt)}}})})(utc);var utcExports=utc.exports;const utcPlugin=getDefaultExportFromCjs$1(utcExports);dayjs.extend(utcPlugin);dayjs.extend(timezonePlugin);function getTimezoneOffset(xt,$t){return $t?dayjs(xt).tz($t).utcOffset()+xt.getTimezoneOffset():0}const updateTimezone=(xt,$t,Ct)=>{if(!xt)return null;if(!$t)return xt;let kt=getTimezoneOffset(xt,$t);return Ct==="remove"&&(kt*=-1),dayjs(xt).add(kt,"minutes").toDate()};function shiftTimezone(xt,$t,Ct,kt){return kt||!$t?$t:Array.isArray($t)?$t.map(Mt=>updateTimezone(Mt,Ct,xt)):updateTimezone($t,Ct,xt)}function getDefaultClampedDate({minDate:xt,maxDate:$t,timezone:Ct}){const kt=shiftTimezone("add",new Date,Ct);return!xt&&!$t?kt:xt&&dayjs(kt).isBefore(xt)?xt:$t&&dayjs(kt).isAfter($t)?$t:kt}const DATES_PROVIDER_DEFAULT_SETTINGS={locale:"en",timezone:null,firstDayOfWeek:1,weekendDays:[0,6],labelSeparator:"",consistentWeeks:!1},DatesProviderContext=reactExports.createContext(DATES_PROVIDER_DEFAULT_SETTINGS);function useDatesContext(){const xt=reactExports.useContext(DatesProviderContext),$t=reactExports.useCallback(jt=>jt||xt.locale,[xt.locale]),Ct=reactExports.useCallback(jt=>jt||xt.timezone||void 0,[xt.timezone]),kt=reactExports.useCallback(jt=>typeof jt=="number"?jt:xt.firstDayOfWeek,[xt.firstDayOfWeek]),Mt=reactExports.useCallback(jt=>Array.isArray(jt)?jt:xt.weekendDays,[xt.weekendDays]),Ft=reactExports.useCallback(jt=>typeof jt=="string"?jt:xt.labelSeparator,[xt.labelSeparator]);return{...xt,getLocale:$t,getTimezone:Ct,getFirstDayOfWeek:kt,getWeekendDays:Mt,getLabelSeparator:Ft}}function formatValue$3(xt,$t){if($t==="range"&&Array.isArray(xt)){const[Ct,kt]=xt;return Ct?kt?`${Ct.toISOString()}  ${kt.toISOString()}`:`${Ct.toISOString()} `:""}return $t==="multiple"&&Array.isArray(xt)?xt.map(Ct=>Ct==null?void 0:Ct.toISOString()).filter(Boolean).join(", "):!Array.isArray(xt)&&xt?xt.toISOString():""}function HiddenDatesInput({value:xt,type:$t,name:Ct,form:kt}){return jsxRuntimeExports.jsx("input",{type:"hidden",value:formatValue$3(xt,$t),name:Ct,form:kt})}HiddenDatesInput.displayName="@mantine/dates/HiddenDatesInput";var classes$8={day:"m_396ce5cb"};const defaultProps$h={},varsResolver$3=(xt,{size:$t})=>({day:{"--day-size":getSize($t,"day-size")}}),Day$1=factory$2((xt,$t)=>{const Ct=useProps("Day",defaultProps$h,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,date:zt,disabled:Ht,__staticSelector:Gt,weekend:qt,outside:Wt,selected:Yt,renderDay:Kt,inRange:Xt,firstInRange:Qt,lastInRange:Jt,hidden:Zt,static:sn,...ln}=Ct,dn=useStyles({name:Gt||"Day",classes:classes$8,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$3,rootSelector:"day"}),hn=useDatesContext();return jsxRuntimeExports.jsx(UnstyledButton,{...dn("day",{style:Zt?{display:"none"}:void 0}),component:sn?"div":"button",ref:$t,disabled:Ht,"data-today":dayjs(zt).isSame(shiftTimezone("add",new Date,hn.getTimezone()),"day")||void 0,"data-hidden":Zt||void 0,"data-disabled":Ht||void 0,"data-weekend":!Ht&&!Wt&&qt||void 0,"data-outside":!Ht&&Wt||void 0,"data-selected":!Ht&&Yt||void 0,"data-in-range":Xt&&!Ht||void 0,"data-first-in-range":Qt&&!Ht||void 0,"data-last-in-range":Jt&&!Ht||void 0,"data-static":sn||void 0,unstyled:Bt,...ln,children:(Kt==null?void 0:Kt(zt))||zt.getDate()})});Day$1.classes=classes$8;Day$1.displayName="@mantine/dates/Day";function getWeekdayNames({locale:xt,format:$t="dd",firstDayOfWeek:Ct=1}){const kt=dayjs().day(Ct),Mt=[];for(let Ft=0;Ft<7;Ft+=1)typeof $t=="string"?Mt.push(dayjs(kt).add(Ft,"days").locale(xt).format($t)):Mt.push($t(dayjs(kt).add(Ft,"days").toDate()));return Mt}var classes$7={weekday:"m_18a3eca"};const defaultProps$g={},varsResolver$2=(xt,{size:$t})=>({weekdaysRow:{"--wr-fz":getFontSize$1($t),"--wr-spacing":getSpacing($t)}}),WeekdaysRow=factory$2((xt,$t)=>{const Ct=useProps("WeekdaysRow",defaultProps$g,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,locale:zt,firstDayOfWeek:Ht,weekdayFormat:Gt,cellComponent:qt="th",__staticSelector:Wt,...Yt}=Ct,Kt=useStyles({name:Wt||"WeekdaysRow",classes:classes$7,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$2,rootSelector:"weekdaysRow"}),Xt=useDatesContext(),Qt=getWeekdayNames({locale:Xt.getLocale(zt),format:Gt,firstDayOfWeek:Xt.getFirstDayOfWeek(Ht)}).map((Jt,Zt)=>jsxRuntimeExports.jsx(qt,{...Kt("weekday"),children:Jt},Zt));return jsxRuntimeExports.jsx(Box,{component:"tr",ref:$t,...Kt("weekdaysRow"),...Yt,children:Qt})});WeekdaysRow.classes=classes$7;WeekdaysRow.displayName="@mantine/dates/WeekdaysRow";function getEndOfWeek(xt,$t=1){const Ct=new Date(xt),kt=$t===0?6:$t-1;for(;Ct.getDay()!==kt;)Ct.setDate(Ct.getDate()+1);return Ct}function getStartOfWeek(xt,$t=1){const Ct=new Date(xt);for(;Ct.getDay()!==$t;)Ct.setDate(Ct.getDate()-1);return Ct}function getMonthDays({month:xt,firstDayOfWeek:$t=1,consistentWeeks:Ct}){const kt=xt.getMonth(),Mt=new Date(xt.getFullYear(),kt,1),Ft=new Date(xt.getFullYear(),xt.getMonth()+1,0),jt=getEndOfWeek(Ft,$t),Bt=getStartOfWeek(Mt,$t),Vt=[];for(;Bt<=jt;){const zt=[];for(let Ht=0;Ht<7;Ht+=1)zt.push(new Date(Bt)),Bt.setDate(Bt.getDate()+1);Vt.push(zt)}if(Ct&&Vt.length<6){const zt=Vt[Vt.length-1],Ht=zt[zt.length-1],Gt=new Date(Ht);for(Gt.setDate(Gt.getDate()+1);Vt.length<6;){const qt=[];for(let Wt=0;Wt<7;Wt+=1)qt.push(new Date(Gt)),Gt.setDate(Gt.getDate()+1);Vt.push(qt)}}return Vt}function isSameMonth(xt,$t){return xt.getFullYear()===$t.getFullYear()&&xt.getMonth()===$t.getMonth()}function isAfterMinDate(xt,$t){return $t instanceof Date?dayjs(xt).isAfter(dayjs($t).subtract(1,"day"),"day"):!0}function isBeforeMaxDate(xt,$t){return $t instanceof Date?dayjs(xt).isBefore(dayjs($t).add(1,"day"),"day"):!0}function getDateInTabOrder(xt,$t,Ct,kt,Mt,Ft,jt){const Bt=xt.flat().filter(Ht=>{var Gt;return isBeforeMaxDate(Ht,Ct)&&isAfterMinDate(Ht,$t)&&!(Mt!=null&&Mt(Ht))&&!((Gt=kt==null?void 0:kt(Ht))!=null&&Gt.disabled)&&(!Ft||isSameMonth(Ht,jt))}),Vt=Bt.find(Ht=>{var Gt;return(Gt=kt==null?void 0:kt(Ht))==null?void 0:Gt.selected});if(Vt)return Vt;const zt=Bt.find(Ht=>dayjs().isSame(Ht,"date"));return zt||Bt[0]}var classes$6={month:"m_cc9820d3",monthCell:"m_8f457cd5"};const defaultProps$f={withCellSpacing:!0},Month$1=factory$2((xt,$t)=>{const Ct=useProps("Month",defaultProps$f,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,__staticSelector:zt,locale:Ht,firstDayOfWeek:Gt,weekdayFormat:qt,month:Wt,weekendDays:Yt,getDayProps:Kt,excludeDate:Xt,minDate:Qt,maxDate:Jt,renderDay:Zt,hideOutsideDates:sn,hideWeekdays:ln,getDayAriaLabel:dn,static:hn,__getDayRef:cn,__onDayKeyDown:pn,__onDayClick:yn,__onDayMouseEnter:gn,__preventFocus:En,__stopPropagation:bn,withCellSpacing:xn,size:Cn,...$n}=Ct,wn=useStyles({name:zt||"Month",classes:classes$6,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,rootSelector:"month"}),Rn=useDatesContext(),Dn=getMonthDays({month:Wt,firstDayOfWeek:Rn.getFirstDayOfWeek(Gt),consistentWeeks:Rn.consistentWeeks}),An=getDateInTabOrder(Dn,Qt,Jt,Kt,Xt,sn,Wt),{resolvedClassNames:Sn,resolvedStyles:vn}=useResolvedStylesApi({classNames:kt,styles:jt,props:Ct}),_n=Dn.map((Tn,Pn)=>{const Ln=Tn.map((Vn,Un)=>{const Wn=!isSameMonth(Vn,Wt),rr=(dn==null?void 0:dn(Vn))||dayjs(Vn).locale(Ht||Rn.locale).format("D MMMM YYYY"),ar=Kt==null?void 0:Kt(Vn),nr=dayjs(Vn).isSame(An,"date");return jsxRuntimeExports.jsx("td",{...wn("monthCell"),"data-with-spacing":xn||void 0,children:jsxRuntimeExports.jsx(Day$1,{__staticSelector:zt||"Month",classNames:Sn,styles:vn,unstyled:Bt,"data-mantine-stop-propagation":bn||void 0,renderDay:Zt,date:Vn,size:Cn,weekend:Rn.getWeekendDays(Yt).includes(Vn.getDay()),outside:Wn,hidden:sn?Wn:!1,"aria-label":rr,static:hn,disabled:(Xt==null?void 0:Xt(Vn))||!isBeforeMaxDate(Vn,Jt)||!isAfterMinDate(Vn,Qt),ref:mr=>cn==null?void 0:cn(Pn,Un,mr),...ar,onKeyDown:mr=>{var kn;(kn=ar==null?void 0:ar.onKeyDown)==null||kn.call(ar,mr),pn==null||pn(mr,{rowIndex:Pn,cellIndex:Un,date:Vn})},onMouseEnter:mr=>{var kn;(kn=ar==null?void 0:ar.onMouseEnter)==null||kn.call(ar,mr),gn==null||gn(mr,Vn)},onClick:mr=>{var kn;(kn=ar==null?void 0:ar.onClick)==null||kn.call(ar,mr),yn==null||yn(mr,Vn)},onMouseDown:mr=>{var kn;(kn=ar==null?void 0:ar.onMouseDown)==null||kn.call(ar,mr),En&&mr.preventDefault()},tabIndex:En||!nr?-1:0})},Vn.toString())});return jsxRuntimeExports.jsx("tr",{...wn("monthRow"),children:Ln},Pn)});return jsxRuntimeExports.jsxs(Box,{component:"table",...wn("month"),size:Cn,ref:$t,...$n,children:[!ln&&jsxRuntimeExports.jsx("thead",{...wn("monthThead"),children:jsxRuntimeExports.jsx(WeekdaysRow,{__staticSelector:zt||"Month",locale:Ht,firstDayOfWeek:Gt,weekdayFormat:qt,size:Cn,classNames:Sn,styles:vn,unstyled:Bt})}),jsxRuntimeExports.jsx("tbody",{...wn("monthTbody"),children:_n})]})});Month$1.classes=classes$6;Month$1.displayName="@mantine/dates/Month";var classes$5={pickerControl:"m_dc6a3c71"};const defaultProps$e={},varsResolver$1=(xt,{size:$t})=>({pickerControl:{"--dpc-fz":getFontSize$1($t),"--dpc-size":getSize($t,"dpc-size")}}),PickerControl=factory$2((xt,$t)=>{const Ct=useProps("PickerControl",defaultProps$e,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,firstInRange:zt,lastInRange:Ht,inRange:Gt,__staticSelector:qt,selected:Wt,disabled:Yt,...Kt}=Ct,Xt=useStyles({name:qt||"PickerControl",classes:classes$5,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver:varsResolver$1,rootSelector:"pickerControl"});return jsxRuntimeExports.jsx(UnstyledButton,{...Xt("pickerControl"),ref:$t,unstyled:Bt,"data-picker-control":!0,"data-selected":Wt&&!Yt||void 0,"data-disabled":Yt||void 0,"data-in-range":Gt&&!Yt&&!Wt||void 0,"data-first-in-range":zt&&!Yt||void 0,"data-last-in-range":Ht&&!Yt||void 0,disabled:Yt,...Kt})});PickerControl.classes=classes$5;PickerControl.displayName="@mantine/dates/PickerControl";function isYearDisabled(xt,$t,Ct){return!$t&&!Ct?!1:!!($t&&dayjs(xt).isBefore($t,"year")||Ct&&dayjs(xt).isAfter(Ct,"year"))}function getYearInTabOrder(xt,$t,Ct,kt){const Mt=xt.flat().filter(Bt=>{var Vt;return!isYearDisabled(Bt,$t,Ct)&&!((Vt=kt==null?void 0:kt(Bt))!=null&&Vt.disabled)}),Ft=Mt.find(Bt=>{var Vt;return(Vt=kt==null?void 0:kt(Bt))==null?void 0:Vt.selected});if(Ft)return Ft;const jt=Mt.find(Bt=>dayjs().isSame(Bt,"year"));return jt||Mt[0]}function getYearsData(xt){const $t=xt.getFullYear(),Ct=$t-$t%10;let kt=0;const Mt=[[],[],[],[]];for(let Ft=0;Ft<4;Ft+=1){const jt=Ft===3?1:3;for(let Bt=0;Bt<jt;Bt+=1)Mt[Ft].push(new Date(Ct+kt,0)),kt+=1}return Mt}var classes$4={yearsList:"m_9206547b",yearsListCell:"m_c5a19c7d"};const defaultProps$d={yearsListFormat:"YYYY",withCellSpacing:!0},YearsList=factory$2((xt,$t)=>{const Ct=useProps("YearsList",defaultProps$d,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,decade:zt,yearsListFormat:Ht,locale:Gt,minDate:qt,maxDate:Wt,getYearControlProps:Yt,__staticSelector:Kt,__getControlRef:Xt,__onControlKeyDown:Qt,__onControlClick:Jt,__onControlMouseEnter:Zt,__preventFocus:sn,__stopPropagation:ln,withCellSpacing:dn,size:hn,...cn}=Ct,pn=useStyles({name:Kt||"YearsList",classes:classes$4,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,rootSelector:"yearsList"}),yn=useDatesContext(),gn=getYearsData(zt),En=getYearInTabOrder(gn,qt,Wt,Yt),bn=gn.map((xn,Cn)=>{const $n=xn.map((wn,Rn)=>{const Dn=Yt==null?void 0:Yt(wn),An=dayjs(wn).isSame(En,"year");return jsxRuntimeExports.jsx("td",{...pn("yearsListCell"),"data-with-spacing":dn||void 0,children:jsxRuntimeExports.jsx(PickerControl,{...pn("yearsListControl"),size:hn,unstyled:Bt,"data-mantine-stop-propagation":ln||void 0,disabled:isYearDisabled(wn,qt,Wt),ref:Sn=>Xt==null?void 0:Xt(Cn,Rn,Sn),...Dn,onKeyDown:Sn=>{var vn;(vn=Dn==null?void 0:Dn.onKeyDown)==null||vn.call(Dn,Sn),Qt==null||Qt(Sn,{rowIndex:Cn,cellIndex:Rn,date:wn})},onClick:Sn=>{var vn;(vn=Dn==null?void 0:Dn.onClick)==null||vn.call(Dn,Sn),Jt==null||Jt(Sn,wn)},onMouseEnter:Sn=>{var vn;(vn=Dn==null?void 0:Dn.onMouseEnter)==null||vn.call(Dn,Sn),Zt==null||Zt(Sn,wn)},onMouseDown:Sn=>{var vn;(vn=Dn==null?void 0:Dn.onMouseDown)==null||vn.call(Dn,Sn),sn&&Sn.preventDefault()},tabIndex:sn||!An?-1:0,children:dayjs(wn).locale(yn.getLocale(Gt)).format(Ht)})},Rn)});return jsxRuntimeExports.jsx("tr",{...pn("yearsListRow"),children:$n},Cn)});return jsxRuntimeExports.jsx(Box,{component:"table",ref:$t,size:hn,...pn("yearsList"),...cn,children:jsxRuntimeExports.jsx("tbody",{children:bn})})});YearsList.classes=classes$4;YearsList.displayName="@mantine/dates/YearsList";function isMonthDisabled(xt,$t,Ct){return!$t&&!Ct?!1:!!($t&&dayjs(xt).isBefore($t,"month")||Ct&&dayjs(xt).isAfter(Ct,"month"))}function getMonthInTabOrder(xt,$t,Ct,kt){const Mt=xt.flat().filter(Bt=>{var Vt;return!isMonthDisabled(Bt,$t,Ct)&&!((Vt=kt==null?void 0:kt(Bt))!=null&&Vt.disabled)}),Ft=Mt.find(Bt=>{var Vt;return(Vt=kt==null?void 0:kt(Bt))==null?void 0:Vt.selected});if(Ft)return Ft;const jt=Mt.find(Bt=>dayjs().isSame(Bt,"month"));return jt||Mt[0]}function getMonthsData(xt){const $t=dayjs(xt).startOf("year").toDate(),Ct=[[],[],[],[]];let kt=0;for(let Mt=0;Mt<4;Mt+=1)for(let Ft=0;Ft<3;Ft+=1)Ct[Mt].push(dayjs($t).add(kt,"months").toDate()),kt+=1;return Ct}var classes$3={monthsList:"m_2a6c32d",monthsListCell:"m_fe27622f"};const defaultProps$c={monthsListFormat:"MMM",withCellSpacing:!0},MonthsList=factory$2((xt,$t)=>{const Ct=useProps("MonthsList",defaultProps$c,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,__staticSelector:zt,year:Ht,monthsListFormat:Gt,locale:qt,minDate:Wt,maxDate:Yt,getMonthControlProps:Kt,__getControlRef:Xt,__onControlKeyDown:Qt,__onControlClick:Jt,__onControlMouseEnter:Zt,__preventFocus:sn,__stopPropagation:ln,withCellSpacing:dn,size:hn,...cn}=Ct,pn=useStyles({name:zt||"MonthsList",classes:classes$3,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,rootSelector:"monthsList"}),yn=useDatesContext(),gn=getMonthsData(Ht),En=getMonthInTabOrder(gn,Wt,Yt,Kt),bn=gn.map((xn,Cn)=>{const $n=xn.map((wn,Rn)=>{const Dn=Kt==null?void 0:Kt(wn),An=dayjs(wn).isSame(En,"month");return jsxRuntimeExports.jsx("td",{...pn("monthsListCell"),"data-with-spacing":dn||void 0,children:jsxRuntimeExports.jsx(PickerControl,{...pn("monthsListControl"),size:hn,unstyled:Bt,__staticSelector:zt||"MonthsList","data-mantine-stop-propagation":ln||void 0,disabled:isMonthDisabled(wn,Wt,Yt),ref:Sn=>Xt==null?void 0:Xt(Cn,Rn,Sn),...Dn,onKeyDown:Sn=>{var vn;(vn=Dn==null?void 0:Dn.onKeyDown)==null||vn.call(Dn,Sn),Qt==null||Qt(Sn,{rowIndex:Cn,cellIndex:Rn,date:wn})},onClick:Sn=>{var vn;(vn=Dn==null?void 0:Dn.onClick)==null||vn.call(Dn,Sn),Jt==null||Jt(Sn,wn)},onMouseEnter:Sn=>{var vn;(vn=Dn==null?void 0:Dn.onMouseEnter)==null||vn.call(Dn,Sn),Zt==null||Zt(Sn,wn)},onMouseDown:Sn=>{var vn;(vn=Dn==null?void 0:Dn.onMouseDown)==null||vn.call(Dn,Sn),sn&&Sn.preventDefault()},tabIndex:sn||!An?-1:0,children:dayjs(wn).locale(yn.getLocale(qt)).format(Gt)})},Rn)});return jsxRuntimeExports.jsx("tr",{...pn("monthsListRow"),children:$n},Cn)});return jsxRuntimeExports.jsx(Box,{component:"table",ref:$t,size:hn,...pn("monthsList"),...cn,children:jsxRuntimeExports.jsx("tbody",{children:bn})})});MonthsList.classes=classes$3;MonthsList.displayName="@mantine/dates/MonthsList";var classes$2={calendarHeader:"m_730a79ed",calendarHeaderLevel:"m_f6645d97",calendarHeaderControl:"m_2351eeb0",calendarHeaderControlIcon:"m_367dc749"};const defaultProps$b={nextDisabled:!1,previousDisabled:!1,hasNextLevel:!0,withNext:!0,withPrevious:!0},varsResolver=(xt,{size:$t})=>({calendarHeader:{"--dch-control-size":getSize($t,"dch-control-size"),"--dch-fz":getFontSize$1($t)}}),CalendarHeader=factory$2((xt,$t)=>{const Ct=useProps("CalendarHeader",defaultProps$b,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,nextIcon:zt,previousIcon:Ht,nextLabel:Gt,previousLabel:qt,onNext:Wt,onPrevious:Yt,onLevelClick:Kt,label:Xt,nextDisabled:Qt,previousDisabled:Jt,hasNextLevel:Zt,levelControlAriaLabel:sn,withNext:ln,withPrevious:dn,__staticSelector:hn,__preventFocus:cn,__stopPropagation:pn,...yn}=Ct,gn=useStyles({name:hn||"CalendarHeader",classes:classes$2,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,varsResolver,rootSelector:"calendarHeader"}),En=cn?bn=>bn.preventDefault():void 0;return jsxRuntimeExports.jsxs(Box,{...gn("calendarHeader"),ref:$t,...yn,children:[dn&&jsxRuntimeExports.jsx(UnstyledButton,{...gn("calendarHeaderControl"),"data-direction":"previous","aria-label":qt,onClick:Yt,unstyled:Bt,onMouseDown:En,disabled:Jt,"data-disabled":Jt||void 0,tabIndex:cn||Jt?-1:0,"data-mantine-stop-propagation":pn||void 0,children:Ht||jsxRuntimeExports.jsx(AccordionChevron,{...gn("calendarHeaderControlIcon"),"data-direction":"previous",size:"45%"})}),jsxRuntimeExports.jsx(UnstyledButton,{component:Zt?"button":"div",...gn("calendarHeaderLevel"),onClick:Zt?Kt:void 0,unstyled:Bt,onMouseDown:Zt?En:void 0,disabled:!Zt,"data-static":!Zt||void 0,"aria-label":sn,tabIndex:cn||!Zt?-1:0,"data-mantine-stop-propagation":pn||void 0,children:Xt}),ln&&jsxRuntimeExports.jsx(UnstyledButton,{...gn("calendarHeaderControl"),"data-direction":"next","aria-label":Gt,onClick:Wt,unstyled:Bt,onMouseDown:En,disabled:Qt,"data-disabled":Qt||void 0,tabIndex:cn||Qt?-1:0,"data-mantine-stop-propagation":pn||void 0,children:zt||jsxRuntimeExports.jsx(AccordionChevron,{...gn("calendarHeaderControlIcon"),"data-direction":"next",size:"45%"})})]})});CalendarHeader.classes=classes$2;CalendarHeader.displayName="@mantine/dates/CalendarHeader";function getDecadeRange(xt){const $t=getYearsData(xt);return[$t[0][0],$t[3][0]]}const defaultProps$a={decadeLabelFormat:"YYYY"},DecadeLevel=factory$2((xt,$t)=>{const Ct=useProps("DecadeLevel",defaultProps$a,xt),{decade:kt,locale:Mt,minDate:Ft,maxDate:jt,yearsListFormat:Bt,getYearControlProps:Vt,__getControlRef:zt,__onControlKeyDown:Ht,__onControlClick:Gt,__onControlMouseEnter:qt,withCellSpacing:Wt,__preventFocus:Yt,nextIcon:Kt,previousIcon:Xt,nextLabel:Qt,previousLabel:Jt,onNext:Zt,onPrevious:sn,nextDisabled:ln,previousDisabled:dn,levelControlAriaLabel:hn,withNext:cn,withPrevious:pn,decadeLabelFormat:yn,classNames:gn,styles:En,unstyled:bn,__staticSelector:xn,__stopPropagation:Cn,size:$n,...wn}=Ct,Rn=useDatesContext(),[Dn,An]=getDecadeRange(kt),Sn={__staticSelector:xn||"DecadeLevel",classNames:gn,styles:En,unstyled:bn,size:$n},vn=typeof ln=="boolean"?ln:jt?!dayjs(An).endOf("year").isBefore(jt):!1,_n=typeof dn=="boolean"?dn:Ft?!dayjs(Dn).startOf("year").isAfter(Ft):!1,Tn=(Pn,Ln)=>dayjs(Pn).locale(Mt||Rn.locale).format(Ln);return jsxRuntimeExports.jsxs(Box,{"data-decade-level":!0,size:$n,ref:$t,...wn,children:[jsxRuntimeExports.jsx(CalendarHeader,{label:typeof yn=="function"?yn(Dn,An):`${Tn(Dn,yn)}  ${Tn(An,yn)}`,__preventFocus:Yt,__stopPropagation:Cn,nextIcon:Kt,previousIcon:Xt,nextLabel:Qt,previousLabel:Jt,onNext:Zt,onPrevious:sn,nextDisabled:vn,previousDisabled:_n,hasNextLevel:!1,levelControlAriaLabel:hn,withNext:cn,withPrevious:pn,...Sn}),jsxRuntimeExports.jsx(YearsList,{decade:kt,locale:Mt,minDate:Ft,maxDate:jt,yearsListFormat:Bt,getYearControlProps:Vt,__getControlRef:zt,__onControlKeyDown:Ht,__onControlClick:Gt,__onControlMouseEnter:qt,__preventFocus:Yt,__stopPropagation:Cn,withCellSpacing:Wt,...Sn})]})});DecadeLevel.classes={...YearsList.classes,...CalendarHeader.classes};DecadeLevel.displayName="@mantine/dates/DecadeLevel";const defaultProps$9={yearLabelFormat:"YYYY"},YearLevel=factory$2((xt,$t)=>{const Ct=useProps("YearLevel",defaultProps$9,xt),{year:kt,locale:Mt,minDate:Ft,maxDate:jt,monthsListFormat:Bt,getMonthControlProps:Vt,__getControlRef:zt,__onControlKeyDown:Ht,__onControlClick:Gt,__onControlMouseEnter:qt,withCellSpacing:Wt,__preventFocus:Yt,nextIcon:Kt,previousIcon:Xt,nextLabel:Qt,previousLabel:Jt,onNext:Zt,onPrevious:sn,onLevelClick:ln,nextDisabled:dn,previousDisabled:hn,hasNextLevel:cn,levelControlAriaLabel:pn,withNext:yn,withPrevious:gn,yearLabelFormat:En,__staticSelector:bn,__stopPropagation:xn,size:Cn,classNames:$n,styles:wn,unstyled:Rn,...Dn}=Ct,An=useDatesContext(),Sn={__staticSelector:bn||"YearLevel",classNames:$n,styles:wn,unstyled:Rn,size:Cn},vn=typeof dn=="boolean"?dn:jt?!dayjs(kt).endOf("year").isBefore(jt):!1,_n=typeof hn=="boolean"?hn:Ft?!dayjs(kt).startOf("year").isAfter(Ft):!1;return jsxRuntimeExports.jsxs(Box,{"data-year-level":!0,size:Cn,ref:$t,...Dn,children:[jsxRuntimeExports.jsx(CalendarHeader,{label:typeof En=="function"?En(kt):dayjs(kt).locale(Mt||An.locale).format(En),__preventFocus:Yt,__stopPropagation:xn,nextIcon:Kt,previousIcon:Xt,nextLabel:Qt,previousLabel:Jt,onNext:Zt,onPrevious:sn,onLevelClick:ln,nextDisabled:vn,previousDisabled:_n,hasNextLevel:cn,levelControlAriaLabel:pn,withNext:yn,withPrevious:gn,...Sn}),jsxRuntimeExports.jsx(MonthsList,{year:kt,locale:Mt,minDate:Ft,maxDate:jt,monthsListFormat:Bt,getMonthControlProps:Vt,__getControlRef:zt,__onControlKeyDown:Ht,__onControlClick:Gt,__onControlMouseEnter:qt,__preventFocus:Yt,__stopPropagation:xn,withCellSpacing:Wt,...Sn})]})});YearLevel.classes={...CalendarHeader.classes,...MonthsList.classes};YearLevel.displayName="@mantine/dates/YearLevel";const defaultProps$8={monthLabelFormat:"MMMM YYYY"},MonthLevel=factory$2((xt,$t)=>{const Ct=useProps("MonthLevel",defaultProps$8,xt),{month:kt,locale:Mt,firstDayOfWeek:Ft,weekdayFormat:jt,weekendDays:Bt,getDayProps:Vt,excludeDate:zt,minDate:Ht,maxDate:Gt,renderDay:qt,hideOutsideDates:Wt,hideWeekdays:Yt,getDayAriaLabel:Kt,__getDayRef:Xt,__onDayKeyDown:Qt,__onDayClick:Jt,__onDayMouseEnter:Zt,withCellSpacing:sn,__preventFocus:ln,__stopPropagation:dn,nextIcon:hn,previousIcon:cn,nextLabel:pn,previousLabel:yn,onNext:gn,onPrevious:En,onLevelClick:bn,nextDisabled:xn,previousDisabled:Cn,hasNextLevel:$n,levelControlAriaLabel:wn,withNext:Rn,withPrevious:Dn,monthLabelFormat:An,classNames:Sn,styles:vn,unstyled:_n,__staticSelector:Tn,size:Pn,static:Ln,...Vn}=Ct,Un=useDatesContext(),Wn={__staticSelector:Tn||"MonthLevel",classNames:Sn,styles:vn,unstyled:_n,size:Pn},rr=typeof xn=="boolean"?xn:Gt?!dayjs(kt).endOf("month").isBefore(Gt):!1,ar=typeof Cn=="boolean"?Cn:Ht?!dayjs(kt).startOf("month").isAfter(Ht):!1;return jsxRuntimeExports.jsxs(Box,{"data-month-level":!0,size:Pn,ref:$t,...Vn,children:[jsxRuntimeExports.jsx(CalendarHeader,{label:typeof An=="function"?An(kt):dayjs(kt).locale(Mt||Un.locale).format(An),__preventFocus:ln,__stopPropagation:dn,nextIcon:hn,previousIcon:cn,nextLabel:pn,previousLabel:yn,onNext:gn,onPrevious:En,onLevelClick:bn,nextDisabled:rr,previousDisabled:ar,hasNextLevel:$n,levelControlAriaLabel:wn,withNext:Rn,withPrevious:Dn,...Wn}),jsxRuntimeExports.jsx(Month$1,{month:kt,locale:Mt,firstDayOfWeek:Ft,weekdayFormat:jt,weekendDays:Bt,getDayProps:Vt,excludeDate:zt,minDate:Ht,maxDate:Gt,renderDay:qt,hideOutsideDates:Wt,hideWeekdays:Yt,getDayAriaLabel:Kt,__getDayRef:Xt,__onDayKeyDown:Qt,__onDayClick:Jt,__onDayMouseEnter:Zt,__preventFocus:ln,__stopPropagation:dn,static:Ln,withCellSpacing:sn,...Wn})]})});MonthLevel.classes={...Month$1.classes,...CalendarHeader.classes};MonthLevel.displayName="@mantine/dates/MonthLevel";var classes$1={levelsGroup:"m_30b26e33"};const defaultProps$7={},LevelsGroup=factory$2((xt,$t)=>{const Ct=useProps("LevelsGroup",defaultProps$7,xt),{classNames:kt,className:Mt,style:Ft,styles:jt,unstyled:Bt,vars:Vt,__staticSelector:zt,...Ht}=Ct,Gt=useStyles({name:zt||"LevelsGroup",classes:classes$1,props:Ct,className:Mt,style:Ft,classNames:kt,styles:jt,unstyled:Bt,vars:Vt,rootSelector:"levelsGroup"});return jsxRuntimeExports.jsx(Box,{ref:$t,...Gt("levelsGroup"),...Ht})});LevelsGroup.classes=classes$1;LevelsGroup.displayName="@mantine/dates/LevelsGroup";const defaultProps$6={numberOfColumns:1},DecadeLevelGroup=factory$2((xt,$t)=>{const Ct=useProps("DecadeLevelGroup",defaultProps$6,xt),{decade:kt,locale:Mt,minDate:Ft,maxDate:jt,yearsListFormat:Bt,getYearControlProps:Vt,__onControlClick:zt,__onControlMouseEnter:Ht,withCellSpacing:Gt,__preventFocus:qt,nextIcon:Wt,previousIcon:Yt,nextLabel:Kt,previousLabel:Xt,onNext:Qt,onPrevious:Jt,nextDisabled:Zt,previousDisabled:sn,classNames:ln,styles:dn,unstyled:hn,__staticSelector:cn,__stopPropagation:pn,numberOfColumns:yn,levelControlAriaLabel:gn,decadeLabelFormat:En,size:bn,vars:xn,...Cn}=Ct,$n=reactExports.useRef([]),wn=Array(yn).fill(0).map((Rn,Dn)=>{const An=dayjs(kt).add(Dn*10,"years").toDate();return jsxRuntimeExports.jsx(DecadeLevel,{size:bn,yearsListFormat:Bt,decade:An,withNext:Dn===yn-1,withPrevious:Dn===0,decadeLabelFormat:En,__onControlClick:zt,__onControlMouseEnter:Ht,__onControlKeyDown:(Sn,vn)=>handleControlKeyDown({levelIndex:Dn,rowIndex:vn.rowIndex,cellIndex:vn.cellIndex,event:Sn,controlsRef:$n}),__getControlRef:(Sn,vn,_n)=>{Array.isArray($n.current[Dn])||($n.current[Dn]=[]),Array.isArray($n.current[Dn][Sn])||($n.current[Dn][Sn]=[]),$n.current[Dn][Sn][vn]=_n},levelControlAriaLabel:typeof gn=="function"?gn(An):gn,locale:Mt,minDate:Ft,maxDate:jt,__preventFocus:qt,__stopPropagation:pn,nextIcon:Wt,previousIcon:Yt,nextLabel:Kt,previousLabel:Xt,onNext:Qt,onPrevious:Jt,nextDisabled:Zt,previousDisabled:sn,getYearControlProps:Vt,__staticSelector:cn||"DecadeLevelGroup",classNames:ln,styles:dn,unstyled:hn,withCellSpacing:Gt},Dn)});return jsxRuntimeExports.jsx(LevelsGroup,{classNames:ln,styles:dn,__staticSelector:cn||"DecadeLevelGroup",ref:$t,size:bn,unstyled:hn,...Cn,children:wn})});DecadeLevelGroup.classes={...LevelsGroup.classes,...DecadeLevel.classes};DecadeLevelGroup.displayName="@mantine/dates/DecadeLevelGroup";const defaultProps$5={numberOfColumns:1},YearLevelGroup=factory$2((xt,$t)=>{const Ct=useProps("YearLevelGroup",defaultProps$5,xt),{year:kt,locale:Mt,minDate:Ft,maxDate:jt,monthsListFormat:Bt,getMonthControlProps:Vt,__onControlClick:zt,__onControlMouseEnter:Ht,withCellSpacing:Gt,__preventFocus:qt,nextIcon:Wt,previousIcon:Yt,nextLabel:Kt,previousLabel:Xt,onNext:Qt,onPrevious:Jt,onLevelClick:Zt,nextDisabled:sn,previousDisabled:ln,hasNextLevel:dn,classNames:hn,styles:cn,unstyled:pn,__staticSelector:yn,__stopPropagation:gn,numberOfColumns:En,levelControlAriaLabel:bn,yearLabelFormat:xn,size:Cn,vars:$n,...wn}=Ct,Rn=reactExports.useRef([]),Dn=Array(En).fill(0).map((An,Sn)=>{const vn=dayjs(kt).add(Sn,"years").toDate();return jsxRuntimeExports.jsx(YearLevel,{size:Cn,monthsListFormat:Bt,year:vn,withNext:Sn===En-1,withPrevious:Sn===0,yearLabelFormat:xn,__stopPropagation:gn,__onControlClick:zt,__onControlMouseEnter:Ht,__onControlKeyDown:(_n,Tn)=>handleControlKeyDown({levelIndex:Sn,rowIndex:Tn.rowIndex,cellIndex:Tn.cellIndex,event:_n,controlsRef:Rn}),__getControlRef:(_n,Tn,Pn)=>{Array.isArray(Rn.current[Sn])||(Rn.current[Sn]=[]),Array.isArray(Rn.current[Sn][_n])||(Rn.current[Sn][_n]=[]),Rn.current[Sn][_n][Tn]=Pn},levelControlAriaLabel:typeof bn=="function"?bn(vn):bn,locale:Mt,minDate:Ft,maxDate:jt,__preventFocus:qt,nextIcon:Wt,previousIcon:Yt,nextLabel:Kt,previousLabel:Xt,onNext:Qt,onPrevious:Jt,onLevelClick:Zt,nextDisabled:sn,previousDisabled:ln,hasNextLevel:dn,getMonthControlProps:Vt,classNames:hn,styles:cn,unstyled:pn,__staticSelector:yn||"YearLevelGroup",withCellSpacing:Gt},Sn)});return jsxRuntimeExports.jsx(LevelsGroup,{classNames:hn,styles:cn,__staticSelector:yn||"YearLevelGroup",ref:$t,size:Cn,unstyled:pn,...wn,children:Dn})});YearLevelGroup.classes={...YearLevel.classes,...LevelsGroup.classes};YearLevelGroup.displayName="@mantine/dates/YearLevelGroup";const defaultProps$4={numberOfColumns:1},MonthLevelGroup=factory$2((xt,$t)=>{const Ct=useProps("MonthLevelGroup",defaultProps$4,xt),{month:kt,locale:Mt,firstDayOfWeek:Ft,weekdayFormat:jt,weekendDays:Bt,getDayProps:Vt,excludeDate:zt,minDate:Ht,maxDate:Gt,renderDay:qt,hideOutsideDates:Wt,hideWeekdays:Yt,getDayAriaLabel:Kt,__onDayClick:Xt,__onDayMouseEnter:Qt,withCellSpacing:Jt,__preventFocus:Zt,nextIcon:sn,previousIcon:ln,nextLabel:dn,previousLabel:hn,onNext:cn,onPrevious:pn,onLevelClick:yn,nextDisabled:gn,previousDisabled:En,hasNextLevel:bn,classNames:xn,styles:Cn,unstyled:$n,numberOfColumns:wn,levelControlAriaLabel:Rn,monthLabelFormat:Dn,__staticSelector:An,__stopPropagation:Sn,size:vn,static:_n,vars:Tn,...Pn}=Ct,Ln=reactExports.useRef([]),Vn=Array(wn).fill(0).map((Un,Wn)=>{const rr=dayjs(kt).add(Wn,"months").toDate();return jsxRuntimeExports.jsx(MonthLevel,{month:rr,withNext:Wn===wn-1,withPrevious:Wn===0,monthLabelFormat:Dn,__stopPropagation:Sn,__onDayClick:Xt,__onDayMouseEnter:Qt,__onDayKeyDown:(ar,nr)=>handleControlKeyDown({levelIndex:Wn,rowIndex:nr.rowIndex,cellIndex:nr.cellIndex,event:ar,controlsRef:Ln}),__getDayRef:(ar,nr,mr)=>{Array.isArray(Ln.current[Wn])||(Ln.current[Wn]=[]),Array.isArray(Ln.current[Wn][ar])||(Ln.current[Wn][ar]=[]),Ln.current[Wn][ar][nr]=mr},levelControlAriaLabel:typeof Rn=="function"?Rn(rr):Rn,locale:Mt,firstDayOfWeek:Ft,weekdayFormat:jt,weekendDays:Bt,getDayProps:Vt,excludeDate:zt,minDate:Ht,maxDate:Gt,renderDay:qt,hideOutsideDates:Wt,hideWeekdays:Yt,getDayAriaLabel:Kt,__preventFocus:Zt,nextIcon:sn,previousIcon:ln,nextLabel:dn,previousLabel:hn,onNext:cn,onPrevious:pn,onLevelClick:yn,nextDisabled:gn,previousDisabled:En,hasNextLevel:bn,classNames:xn,styles:Cn,unstyled:$n,__staticSelector:An||"MonthLevelGroup",size:vn,static:_n,withCellSpacing:Jt},Wn)});return jsxRuntimeExports.jsx(LevelsGroup,{classNames:xn,styles:Cn,__staticSelector:An||"MonthLevelGroup",ref:$t,size:vn,...Pn,children:Vn})});MonthLevelGroup.classes={...LevelsGroup.classes,...MonthLevel.classes};MonthLevelGroup.displayName="@mantine/dates/MonthLevelGroup";var classes={input:"m_6fa5e2aa"};const defaultProps$3={},PickerInputBase=factory$2((xt,$t)=>{const{inputProps:Ct,wrapperProps:kt,placeholder:Mt,classNames:Ft,styles:jt,unstyled:Bt,popoverProps:Vt,modalProps:zt,dropdownType:Ht,children:Gt,formattedValue:qt,dropdownHandlers:Wt,dropdownOpened:Yt,onClick:Kt,clearable:Xt,onClear:Qt,clearButtonProps:Jt,rightSection:Zt,shouldClear:sn,readOnly:ln,disabled:dn,value:hn,name:cn,form:pn,type:yn,...gn}=useInputProps("PickerInputBase",defaultProps$3,xt),En=Zt||(Xt&&sn&&!ln&&!dn?jsxRuntimeExports.jsx(CloseButton,{variant:"transparent",onClick:Qt,unstyled:Bt,size:Ct.size||"sm",...Jt}):null),bn=()=>{yn==="range"&&Array.isArray(hn)&&hn[0]&&!hn[1]&&Qt(),Wt.close()};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Ht==="modal"&&!ln&&jsxRuntimeExports.jsx(Modal,{opened:Yt,onClose:bn,withCloseButton:!1,size:"auto","data-dates-modal":!0,unstyled:Bt,...zt,children:Gt}),jsxRuntimeExports.jsx(Input.Wrapper,{...kt,children:jsxRuntimeExports.jsxs(Popover,{position:"bottom-start",opened:Yt,trapFocus:!0,returnFocus:!0,unstyled:Bt,...Vt,disabled:(Vt==null?void 0:Vt.disabled)||Ht==="modal"||ln,onClose:()=>{var xn;(xn=Vt==null?void 0:Vt.onClose)==null||xn.call(Vt),bn()},children:[jsxRuntimeExports.jsx(Popover.Target,{children:jsxRuntimeExports.jsx(Input,{"aria-label":qt||Mt,"data-dates-input":!0,"data-read-only":ln||void 0,disabled:dn,component:"button",type:"button",multiline:!0,onClick:xn=>{Kt==null||Kt(xn),Wt.toggle()},rightSection:En,...Ct,ref:$t,classNames:{...Ft,input:clsx(classes.input,Ft==null?void 0:Ft.input)},...gn,children:qt||jsxRuntimeExports.jsx(Input.Placeholder,{error:Ct.error,unstyled:Bt,className:Ft==null?void 0:Ft.placeholder,style:jt==null?void 0:jt.placeholder,children:Mt})})}),jsxRuntimeExports.jsx(Popover.Dropdown,{"data-dates-dropdown":!0,children:Gt})]})}),jsxRuntimeExports.jsx(HiddenDatesInput,{value:hn,name:cn,form:pn,type:yn})]})});PickerInputBase.classes=classes;PickerInputBase.displayName="@mantine/dates/PickerInputBase";const getEmptyValue=xt=>xt==="range"?[null,null]:xt==="multiple"?[]:null;function useUncontrolledDates({type:xt,value:$t,defaultValue:Ct,onChange:kt,applyTimezone:Mt=!0}){const Ft=reactExports.useRef(xt),jt=useDatesContext(),[Bt,Vt,zt]=useUncontrolled({value:shiftTimezone("add",$t,jt.getTimezone(),!Mt),defaultValue:shiftTimezone("add",Ct,jt.getTimezone(),!Mt),finalValue:getEmptyValue(xt),onChange:Gt=>{kt==null||kt(shiftTimezone("remove",Gt,jt.getTimezone(),!Mt))}});let Ht=Bt;return Ft.current!==xt&&(Ft.current=xt,$t===void 0&&(Ht=Ct!==void 0?Ct:getEmptyValue(xt),Vt(Ht))),[Ht,Vt,zt]}function levelToNumber(xt,$t){return xt?xt==="month"?0:xt==="year"?1:2:$t||0}function levelNumberToLevel(xt){return xt===0?"month":xt===1?"year":"decade"}function clampLevel(xt,$t,Ct){return levelNumberToLevel(clamp$4(levelToNumber(xt,0),levelToNumber($t,0),levelToNumber(Ct,2)))}const defaultProps$2={maxLevel:"decade",minLevel:"month",__updateDateOnYearSelect:!0,__updateDateOnMonthSelect:!0},Calendar=factory$2((xt,$t)=>{const Ct=useProps("Calendar",defaultProps$2,xt),{vars:kt,maxLevel:Mt,minLevel:Ft,defaultLevel:jt,level:Bt,onLevelChange:Vt,date:zt,defaultDate:Ht,onDateChange:Gt,numberOfColumns:qt,columnsToScroll:Wt,ariaLabels:Yt,onYearSelect:Kt,onMonthSelect:Xt,onYearMouseEnter:Qt,onMonthMouseEnter:Jt,__updateDateOnYearSelect:Zt,__updateDateOnMonthSelect:sn,firstDayOfWeek:ln,weekdayFormat:dn,weekendDays:hn,getDayProps:cn,excludeDate:pn,renderDay:yn,hideOutsideDates:gn,hideWeekdays:En,getDayAriaLabel:bn,monthLabelFormat:xn,nextIcon:Cn,previousIcon:$n,__onDayClick:wn,__onDayMouseEnter:Rn,withCellSpacing:Dn,monthsListFormat:An,getMonthControlProps:Sn,yearLabelFormat:vn,yearsListFormat:_n,getYearControlProps:Tn,decadeLabelFormat:Pn,classNames:Ln,styles:Vn,unstyled:Un,minDate:Wn,maxDate:rr,locale:ar,__staticSelector:nr,size:mr,__preventFocus:kn,__stopPropagation:Fn,onNextDecade:Hn,onPreviousDecade:Bn,onNextYear:jn,onPreviousYear:sr,onNextMonth:Ar,onPreviousMonth:Fr,static:Rr,__timezoneApplied:Qn,...jr}=Ct,{resolvedClassNames:Mr,resolvedStyles:pr}=useResolvedStylesApi({classNames:Ln,styles:Vn,props:Ct}),[Tr,Hr]=useUncontrolled({value:Bt?clampLevel(Bt,Ft,Mt):void 0,defaultValue:jt?clampLevel(jt,Ft,Mt):void 0,finalValue:clampLevel(void 0,Ft,Mt),onChange:Vt}),[Xr,Zr]=useUncontrolledDates({type:"default",value:zt,defaultValue:Ht,onChange:Gt,applyTimezone:!Qn}),ur={__staticSelector:nr||"Calendar",styles:pr,classNames:Mr,unstyled:Un,size:mr},hr=useDatesContext(),gr=Wt||qt||1,qr=Xr||shiftTimezone("add",new Date,hr.getTimezone()),ds=()=>{const ps=dayjs(qr).add(gr,"month").toDate();Ar==null||Ar(ps),Zr(ps)},ms=()=>{const ps=dayjs(qr).subtract(gr,"month").toDate();Fr==null||Fr(ps),Zr(ps)},wr=()=>{const ps=dayjs(qr).add(gr,"year").toDate();jn==null||jn(ps),Zr(ps)},Wr=()=>{const ps=dayjs(qr).subtract(gr,"year").toDate();sr==null||sr(ps),Zr(ps)},ns=()=>{const ps=dayjs(qr).add(10*gr,"year").toDate();Hn==null||Hn(ps),Zr(ps)},us=()=>{const ps=dayjs(qr).subtract(10*gr,"year").toDate();Bn==null||Bn(ps),Zr(ps)};return jsxRuntimeExports.jsxs(Box,{ref:$t,size:mr,"data-calendar":!0,...jr,children:[Tr==="month"&&jsxRuntimeExports.jsx(MonthLevelGroup,{month:qr,minDate:Wn,maxDate:rr,firstDayOfWeek:ln,weekdayFormat:dn,weekendDays:hn,getDayProps:cn,excludeDate:pn,renderDay:yn,hideOutsideDates:gn,hideWeekdays:En,getDayAriaLabel:bn,onNext:ds,onPrevious:ms,hasNextLevel:Mt!=="month",onLevelClick:()=>Hr("year"),numberOfColumns:qt,locale:ar,levelControlAriaLabel:Yt==null?void 0:Yt.monthLevelControl,nextLabel:Yt==null?void 0:Yt.nextMonth,nextIcon:Cn,previousLabel:Yt==null?void 0:Yt.previousMonth,previousIcon:$n,monthLabelFormat:xn,__onDayClick:wn,__onDayMouseEnter:Rn,__preventFocus:kn,__stopPropagation:Fn,static:Rr,withCellSpacing:Dn,...ur}),Tr==="year"&&jsxRuntimeExports.jsx(YearLevelGroup,{year:qr,numberOfColumns:qt,minDate:Wn,maxDate:rr,monthsListFormat:An,getMonthControlProps:Sn,locale:ar,onNext:wr,onPrevious:Wr,hasNextLevel:Mt!=="month"&&Mt!=="year",onLevelClick:()=>Hr("decade"),levelControlAriaLabel:Yt==null?void 0:Yt.yearLevelControl,nextLabel:Yt==null?void 0:Yt.nextYear,nextIcon:Cn,previousLabel:Yt==null?void 0:Yt.previousYear,previousIcon:$n,yearLabelFormat:vn,__onControlMouseEnter:Jt,__onControlClick:(ps,Ls)=>{sn&&Zr(Ls),Hr(clampLevel("month",Ft,Mt)),Xt==null||Xt(Ls)},__preventFocus:kn,__stopPropagation:Fn,withCellSpacing:Dn,...ur}),Tr==="decade"&&jsxRuntimeExports.jsx(DecadeLevelGroup,{decade:qr,minDate:Wn,maxDate:rr,yearsListFormat:_n,getYearControlProps:Tn,locale:ar,onNext:ns,onPrevious:us,numberOfColumns:qt,nextLabel:Yt==null?void 0:Yt.nextDecade,nextIcon:Cn,previousLabel:Yt==null?void 0:Yt.previousDecade,previousIcon:$n,decadeLabelFormat:Pn,__onControlMouseEnter:Qt,__onControlClick:(ps,Ls)=>{Zt&&Zr(Ls),Hr(clampLevel("year",Ft,Mt)),Kt==null||Kt(Ls)},__preventFocus:kn,__stopPropagation:Fn,withCellSpacing:Dn,...ur})]})});Calendar.classes={...DecadeLevelGroup.classes,...YearLevelGroup.classes,...MonthLevelGroup.classes};Calendar.displayName="@mantine/dates/Calendar";function pickCalendarProps(xt){const{maxLevel:$t,minLevel:Ct,defaultLevel:kt,level:Mt,onLevelChange:Ft,nextIcon:jt,previousIcon:Bt,date:Vt,defaultDate:zt,onDateChange:Ht,numberOfColumns:Gt,columnsToScroll:qt,ariaLabels:Wt,onYearSelect:Yt,onMonthSelect:Kt,onYearMouseEnter:Xt,onMonthMouseEnter:Qt,onNextMonth:Jt,onPreviousMonth:Zt,onNextYear:sn,onPreviousYear:ln,onNextDecade:dn,onPreviousDecade:hn,withCellSpacing:cn,__updateDateOnYearSelect:pn,__updateDateOnMonthSelect:yn,firstDayOfWeek:gn,weekdayFormat:En,weekendDays:bn,getDayProps:xn,excludeDate:Cn,renderDay:$n,hideOutsideDates:wn,hideWeekdays:Rn,getDayAriaLabel:Dn,monthLabelFormat:An,monthsListFormat:Sn,getMonthControlProps:vn,yearLabelFormat:_n,yearsListFormat:Tn,getYearControlProps:Pn,decadeLabelFormat:Ln,allowSingleDateInRange:Vn,allowDeselect:Un,minDate:Wn,maxDate:rr,locale:ar,...nr}=xt;return{calendarProps:{maxLevel:$t,minLevel:Ct,defaultLevel:kt,level:Mt,onLevelChange:Ft,nextIcon:jt,previousIcon:Bt,date:Vt,defaultDate:zt,onDateChange:Ht,numberOfColumns:Gt,columnsToScroll:qt,ariaLabels:Wt,onYearSelect:Yt,onMonthSelect:Kt,onYearMouseEnter:Xt,onMonthMouseEnter:Qt,onNextMonth:Jt,onPreviousMonth:Zt,onNextYear:sn,onPreviousYear:ln,onNextDecade:dn,onPreviousDecade:hn,withCellSpacing:cn,__updateDateOnYearSelect:pn,__updateDateOnMonthSelect:yn,firstDayOfWeek:gn,weekdayFormat:En,weekendDays:bn,getDayProps:xn,excludeDate:Cn,renderDay:$n,hideOutsideDates:wn,hideWeekdays:Rn,getDayAriaLabel:Dn,monthLabelFormat:An,monthsListFormat:Sn,getMonthControlProps:vn,yearLabelFormat:_n,yearsListFormat:Tn,getYearControlProps:Pn,decadeLabelFormat:Ln,allowSingleDateInRange:Vn,allowDeselect:Un,minDate:Wn,maxDate:rr,locale:ar},others:nr}}function isInRange(xt,$t){const Ct=[...$t].sort((kt,Mt)=>kt.getTime()-Mt.getTime());return dayjs(Ct[0]).startOf("day").subtract(1,"ms").isBefore(xt)&&dayjs(Ct[1]).endOf("day").add(1,"ms").isAfter(xt)}function useDatesState({type:xt,level:$t,value:Ct,defaultValue:kt,onChange:Mt,allowSingleDateInRange:Ft,allowDeselect:jt,onMouseLeave:Bt,applyTimezone:Vt=!0}){const[zt,Ht]=useUncontrolledDates({type:xt,value:Ct,defaultValue:kt,onChange:Mt,applyTimezone:Vt}),[Gt,qt]=reactExports.useState(xt==="range"&&zt[0]&&!zt[1]?zt[0]:null),[Wt,Yt]=reactExports.useState(null),Kt=dn=>{if(xt==="range"){if(Gt instanceof Date&&!zt[1]){if(dayjs(dn).isSame(Gt,$t)&&!Ft){qt(null),Yt(null),Ht([null,null]);return}const hn=[dn,Gt];hn.sort((cn,pn)=>cn.getTime()-pn.getTime()),Ht(hn),Yt(null),qt(null);return}if(zt[0]&&!zt[1]&&dayjs(dn).isSame(zt[0],$t)&&!Ft){qt(null),Yt(null),Ht([null,null]);return}Ht([dn,null]),Yt(null),qt(dn);return}if(xt==="multiple"){zt.some(hn=>dayjs(hn).isSame(dn,$t))?Ht(zt.filter(hn=>!dayjs(hn).isSame(dn,$t))):Ht([...zt,dn]);return}zt&&jt&&dayjs(dn).isSame(zt,$t)?Ht(null):Ht(dn)},Xt=dn=>Gt instanceof Date&&Wt instanceof Date?isInRange(dn,[Wt,Gt]):zt[0]instanceof Date&&zt[1]instanceof Date?isInRange(dn,zt):!1,Qt=xt==="range"?dn=>{Bt==null||Bt(dn),Yt(null)}:Bt,Jt=dn=>zt[0]instanceof Date&&dayjs(dn).isSame(zt[0],$t)?!(Wt&&dayjs(Wt).isBefore(zt[0])):!1,Zt=dn=>zt[1]instanceof Date?dayjs(dn).isSame(zt[1],$t):!(zt[0]instanceof Date)||!Wt?!1:dayjs(Wt).isBefore(zt[0])&&dayjs(dn).isSame(zt[0],$t),sn=dn=>{if(xt==="range")return{selected:zt.some(cn=>cn&&dayjs(cn).isSame(dn,$t)),inRange:Xt(dn),firstInRange:Jt(dn),lastInRange:Zt(dn),"data-autofocus":!!zt[0]&&dayjs(zt[0]).isSame(dn,$t)||void 0};if(xt==="multiple")return{selected:zt.some(cn=>cn&&dayjs(cn).isSame(dn,$t)),"data-autofocus":!!zt[0]&&dayjs(zt[0]).isSame(dn,$t)||void 0};const hn=dayjs(zt).isSame(dn,$t);return{selected:hn,"data-autofocus":hn||void 0}},ln=xt==="range"&&Gt?Yt:()=>{};return reactExports.useEffect(()=>{xt==="range"&&!zt[0]&&!zt[1]&&qt(null)},[Ct]),{onDateChange:Kt,onRootMouseLeave:Qt,onHoveredDateChange:ln,getControlProps:sn,_value:zt,setValue:Ht}}const defaultProps$1={type:"default",defaultLevel:"month",numberOfColumns:1},DatePicker=factory$2((xt,$t)=>{const Ct=useProps("DatePicker",defaultProps$1,xt),{classNames:kt,styles:Mt,vars:Ft,type:jt,defaultValue:Bt,value:Vt,onChange:zt,__staticSelector:Ht,getDayProps:Gt,allowSingleDateInRange:qt,allowDeselect:Wt,onMouseLeave:Yt,numberOfColumns:Kt,hideOutsideDates:Xt,__onDayMouseEnter:Qt,__onDayClick:Jt,__timezoneApplied:Zt,...sn}=Ct,{onDateChange:ln,onRootMouseLeave:dn,onHoveredDateChange:hn,getControlProps:cn}=useDatesState({type:jt,level:"day",allowDeselect:Wt,allowSingleDateInRange:qt,value:Vt,defaultValue:Bt,onChange:zt,onMouseLeave:Yt,applyTimezone:!Zt}),{resolvedClassNames:pn,resolvedStyles:yn}=useResolvedStylesApi({classNames:kt,styles:Mt,props:Ct}),gn=useDatesContext();return jsxRuntimeExports.jsx(Calendar,{ref:$t,minLevel:"month",classNames:pn,styles:yn,__staticSelector:Ht||"DatePicker",onMouseLeave:dn,numberOfColumns:Kt,hideOutsideDates:Xt??Kt!==1,__onDayMouseEnter:(En,bn)=>{hn(bn),Qt==null||Qt(En,bn)},__onDayClick:(En,bn)=>{ln(bn),Jt==null||Jt(En,bn)},getDayProps:En=>({...cn(En),...Gt==null?void 0:Gt(En)}),...sn,date:shiftTimezone("add",sn.date,gn.getTimezone(),Zt),__timezoneApplied:!0})});DatePicker.classes=Calendar.classes;DatePicker.displayName="@mantine/dates/DatePicker";function useDatesInput({type:xt,value:$t,defaultValue:Ct,onChange:kt,locale:Mt,format:Ft,closeOnChange:jt,sortDates:Bt,labelSeparator:Vt,valueFormatter:zt}){const Ht=useDatesContext(),[Gt,qt]=useDisclosure(!1),[Wt,Yt]=useUncontrolledDates({type:xt,value:$t,defaultValue:Ct,onChange:kt}),Kt=getFormattedDate({type:xt,date:Wt,locale:Ht.getLocale(Mt),format:Ft,labelSeparator:Ht.getLabelSeparator(Vt),formatter:zt}),Xt=Zt=>{jt&&(xt==="default"&&qt.close(),xt==="range"&&Zt[0]&&Zt[1]&&qt.close()),Yt(Bt&&xt==="multiple"?[...Zt].sort((sn,ln)=>sn.getTime()-ln.getTime()):Zt)},Qt=()=>Xt(xt==="range"?[null,null]:xt==="multiple"?[]:null),Jt=xt==="range"?!!Wt[0]:xt==="multiple"?Wt.length>0:Wt!==null;return{_value:Wt,setValue:Xt,onClear:Qt,shouldClear:Jt,formattedValue:Kt,dropdownOpened:Gt,dropdownHandlers:qt}}const defaultProps={type:"default",valueFormat:"MMMM D, YYYY",closeOnChange:!0,sortDates:!0,dropdownType:"popover"},DatePickerInput=factory$2((xt,$t)=>{const Ct=useProps("DatePickerInput",defaultProps,xt),{type:kt,value:Mt,defaultValue:Ft,onChange:jt,valueFormat:Bt,labelSeparator:Vt,locale:zt,classNames:Ht,styles:Gt,unstyled:qt,closeOnChange:Wt,size:Yt,variant:Kt,dropdownType:Xt,sortDates:Qt,minDate:Jt,maxDate:Zt,vars:sn,defaultDate:ln,valueFormatter:dn,...hn}=Ct,{resolvedClassNames:cn,resolvedStyles:pn}=useResolvedStylesApi({classNames:Ht,styles:Gt,props:Ct}),{calendarProps:yn,others:gn}=pickCalendarProps(hn),{_value:En,setValue:bn,formattedValue:xn,dropdownHandlers:Cn,dropdownOpened:$n,onClear:wn,shouldClear:Rn}=useDatesInput({type:kt,value:Mt,defaultValue:Ft,onChange:jt,locale:zt,format:Bt,labelSeparator:Vt,closeOnChange:Wt,sortDates:Qt,valueFormatter:dn}),Dn=Array.isArray(En)?En[0]||ln:En||ln,An=useDatesContext();return jsxRuntimeExports.jsx(PickerInputBase,{formattedValue:xn,dropdownOpened:$n,dropdownHandlers:Cn,classNames:cn,styles:pn,unstyled:qt,ref:$t,onClear:wn,shouldClear:Rn,value:En,size:Yt,variant:Kt,dropdownType:Xt,...gn,type:kt,__staticSelector:"DatePickerInput",children:jsxRuntimeExports.jsx(DatePicker,{...yn,size:Yt,variant:Kt,type:kt,value:En,defaultDate:Dn||getDefaultClampedDate({maxDate:Zt,minDate:Jt,timezone:An.getTimezone()}),onChange:bn,locale:zt,classNames:cn,styles:pn,unstyled:qt,__staticSelector:"DatePickerInput",__stopPropagation:Xt==="popover",minDate:Jt,maxDate:Zt,date:shiftTimezone("add",yn.date,An.getTimezone()),__timezoneApplied:!0})})});DatePickerInput.classes={...PickerInputBase.classes,...DatePicker.classes};DatePickerInput.displayName="@mantine/dates/DatePickerInput";var propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function xt(kt,Mt,Ft,jt,Bt,Vt){if(Vt!==ReactPropTypesSecret){var zt=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw zt.name="Invariant Violation",zt}}xt.isRequired=xt;function $t(){return xt}var Ct={array:xt,bigint:xt,bool:xt,func:xt,number:xt,object:xt,string:xt,symbol:xt,any:xt,arrayOf:$t,element:xt,elementType:xt,instanceOf:$t,node:xt,objectOf:$t,oneOf:$t,oneOfType:$t,shape:$t,exact:$t,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return Ct.PropTypes=Ct,Ct};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const _pt=getDefaultExportFromCjs$1(propTypesExports),EMPTY$1={};function shallowEqual(xt,$t){xt===void 0&&(xt=EMPTY$1),$t===void 0&&($t=EMPTY$1);const Ct=Object.keys(xt),kt=Object.keys($t);return xt===$t||Ct.length===kt.length&&Ct.every(Mt=>xt[Mt]===$t[Mt])}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var __extends=function(){var xt=function($t,Ct){return xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(kt,Mt){kt.__proto__=Mt}||function(kt,Mt){for(var Ft in Mt)Mt.hasOwnProperty(Ft)&&(kt[Ft]=Mt[Ft])},xt($t,Ct)};return function($t,Ct){xt($t,Ct);function kt(){this.constructor=$t}$t.prototype=Ct===null?Object.create(Ct):(kt.prototype=Ct.prototype,new kt)}}(),_hasOwnProperty=Object.prototype.hasOwnProperty;function hasOwnProperty(xt,$t){return _hasOwnProperty.call(xt,$t)}function _objectKeys(xt){if(Array.isArray(xt)){for(var $t=new Array(xt.length),Ct=0;Ct<$t.length;Ct++)$t[Ct]=""+Ct;return $t}if(Object.keys)return Object.keys(xt);var kt=[];for(var Mt in xt)hasOwnProperty(xt,Mt)&&kt.push(Mt);return kt}function _deepClone(xt){switch(typeof xt){case"object":return JSON.parse(JSON.stringify(xt));case"undefined":return null;default:return xt}}function isInteger$1(xt){for(var $t=0,Ct=xt.length,kt;$t<Ct;){if(kt=xt.charCodeAt($t),kt>=48&&kt<=57){$t++;continue}return!1}return!0}function escapePathComponent(xt){return xt.indexOf("/")===-1&&xt.indexOf("~")===-1?xt:xt.replace(/~/g,"~0").replace(/\//g,"~1")}function unescapePathComponent(xt){return xt.replace(/~1/g,"/").replace(/~0/g,"~")}function hasUndefined(xt){if(xt===void 0)return!0;if(xt){if(Array.isArray(xt)){for(var $t=0,Ct=xt.length;$t<Ct;$t++)if(hasUndefined(xt[$t]))return!0}else if(typeof xt=="object"){for(var kt=_objectKeys(xt),Mt=kt.length,Ft=0;Ft<Mt;Ft++)if(hasUndefined(xt[kt[Ft]]))return!0}}return!1}function patchErrorMessageFormatter(xt,$t){var Ct=[xt];for(var kt in $t){var Mt=typeof $t[kt]=="object"?JSON.stringify($t[kt],null,2):$t[kt];typeof Mt<"u"&&Ct.push(kt+": "+Mt)}return Ct.join(`
`)}var PatchError=function(xt){__extends($t,xt);function $t(Ct,kt,Mt,Ft,jt){var Bt=this.constructor,Vt=xt.call(this,patchErrorMessageFormatter(Ct,{name:kt,index:Mt,operation:Ft,tree:jt}))||this;return Vt.name=kt,Vt.index=Mt,Vt.operation=Ft,Vt.tree=jt,Object.setPrototypeOf(Vt,Bt.prototype),Vt.message=patchErrorMessageFormatter(Ct,{name:kt,index:Mt,operation:Ft,tree:jt}),Vt}return $t}(Error),JsonPatchError=PatchError,deepClone=_deepClone,objOps={add:function(xt,$t,Ct){return xt[$t]=this.value,{newDocument:Ct}},remove:function(xt,$t,Ct){var kt=xt[$t];return delete xt[$t],{newDocument:Ct,removed:kt}},replace:function(xt,$t,Ct){var kt=xt[$t];return xt[$t]=this.value,{newDocument:Ct,removed:kt}},move:function(xt,$t,Ct){var kt=getValueByPointer(Ct,this.path);kt&&(kt=_deepClone(kt));var Mt=applyOperation(Ct,{op:"remove",path:this.from}).removed;return applyOperation(Ct,{op:"add",path:this.path,value:Mt}),{newDocument:Ct,removed:kt}},copy:function(xt,$t,Ct){var kt=getValueByPointer(Ct,this.from);return applyOperation(Ct,{op:"add",path:this.path,value:_deepClone(kt)}),{newDocument:Ct}},test:function(xt,$t,Ct){return{newDocument:Ct,test:_areEquals(xt[$t],this.value)}},_get:function(xt,$t,Ct){return this.value=xt[$t],{newDocument:Ct}}},arrOps={add:function(xt,$t,Ct){return isInteger$1($t)?xt.splice($t,0,this.value):xt[$t]=this.value,{newDocument:Ct,index:$t}},remove:function(xt,$t,Ct){var kt=xt.splice($t,1);return{newDocument:Ct,removed:kt[0]}},replace:function(xt,$t,Ct){var kt=xt[$t];return xt[$t]=this.value,{newDocument:Ct,removed:kt}},move:objOps.move,copy:objOps.copy,test:objOps.test,_get:objOps._get};function getValueByPointer(xt,$t){if($t=="")return xt;var Ct={op:"_get",path:$t};return applyOperation(xt,Ct),Ct.value}function applyOperation(xt,$t,Ct,kt,Mt,Ft){if(Ct===void 0&&(Ct=!1),kt===void 0&&(kt=!0),Mt===void 0&&(Mt=!0),Ft===void 0&&(Ft=0),Ct&&(typeof Ct=="function"?Ct($t,0,xt,$t.path):validator($t,0)),$t.path===""){var jt={newDocument:xt};if($t.op==="add")return jt.newDocument=$t.value,jt;if($t.op==="replace")return jt.newDocument=$t.value,jt.removed=xt,jt;if($t.op==="move"||$t.op==="copy")return jt.newDocument=getValueByPointer(xt,$t.from),$t.op==="move"&&(jt.removed=xt),jt;if($t.op==="test"){if(jt.test=_areEquals(xt,$t.value),jt.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",Ft,$t,xt);return jt.newDocument=xt,jt}else{if($t.op==="remove")return jt.removed=xt,jt.newDocument=null,jt;if($t.op==="_get")return $t.value=xt,jt;if(Ct)throw new JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",Ft,$t,xt);return jt}}else{kt||(xt=_deepClone(xt));var Bt=$t.path||"",Vt=Bt.split("/"),zt=xt,Ht=1,Gt=Vt.length,qt=void 0,Wt=void 0,Yt=void 0;for(typeof Ct=="function"?Yt=Ct:Yt=validator;;){if(Wt=Vt[Ht],Wt&&Wt.indexOf("~")!=-1&&(Wt=unescapePathComponent(Wt)),Mt&&(Wt=="__proto__"||Wt=="prototype"&&Ht>0&&Vt[Ht-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(Ct&&qt===void 0&&(zt[Wt]===void 0?qt=Vt.slice(0,Ht).join("/"):Ht==Gt-1&&(qt=$t.path),qt!==void 0&&Yt($t,0,xt,qt)),Ht++,Array.isArray(zt)){if(Wt==="-")Wt=zt.length;else{if(Ct&&!isInteger$1(Wt))throw new JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",Ft,$t,xt);isInteger$1(Wt)&&(Wt=~~Wt)}if(Ht>=Gt){if(Ct&&$t.op==="add"&&Wt>zt.length)throw new JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",Ft,$t,xt);var jt=arrOps[$t.op].call($t,zt,Wt,xt);if(jt.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",Ft,$t,xt);return jt}}else if(Ht>=Gt){var jt=objOps[$t.op].call($t,zt,Wt,xt);if(jt.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",Ft,$t,xt);return jt}if(zt=zt[Wt],Ct&&Ht<Gt&&(!zt||typeof zt!="object"))throw new JsonPatchError("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",Ft,$t,xt)}}}function applyPatch(xt,$t,Ct,kt,Mt){if(kt===void 0&&(kt=!0),Mt===void 0&&(Mt=!0),Ct&&!Array.isArray($t))throw new JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");kt||(xt=_deepClone(xt));for(var Ft=new Array($t.length),jt=0,Bt=$t.length;jt<Bt;jt++)Ft[jt]=applyOperation(xt,$t[jt],Ct,!0,Mt,jt),xt=Ft[jt].newDocument;return Ft.newDocument=xt,Ft}function applyReducer(xt,$t,Ct){var kt=applyOperation(xt,$t);if(kt.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",Ct,$t,xt);return kt.newDocument}function validator(xt,$t,Ct,kt){if(typeof xt!="object"||xt===null||Array.isArray(xt))throw new JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",$t,xt,Ct);if(objOps[xt.op]){if(typeof xt.path!="string")throw new JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",$t,xt,Ct);if(xt.path.indexOf("/")!==0&&xt.path.length>0)throw new JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",$t,xt,Ct);if((xt.op==="move"||xt.op==="copy")&&typeof xt.from!="string")throw new JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",$t,xt,Ct);if((xt.op==="add"||xt.op==="replace"||xt.op==="test")&&xt.value===void 0)throw new JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",$t,xt,Ct);if((xt.op==="add"||xt.op==="replace"||xt.op==="test")&&hasUndefined(xt.value))throw new JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",$t,xt,Ct);if(Ct){if(xt.op=="add"){var Mt=xt.path.split("/").length,Ft=kt.split("/").length;if(Mt!==Ft+1&&Mt!==Ft)throw new JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",$t,xt,Ct)}else if(xt.op==="replace"||xt.op==="remove"||xt.op==="_get"){if(xt.path!==kt)throw new JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",$t,xt,Ct)}else if(xt.op==="move"||xt.op==="copy"){var jt={op:"_get",path:xt.from,value:void 0},Bt=validate([jt],Ct);if(Bt&&Bt.name==="OPERATION_PATH_UNRESOLVABLE")throw new JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",$t,xt,Ct)}}}else throw new JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",$t,xt,Ct)}function validate(xt,$t,Ct){try{if(!Array.isArray(xt))throw new JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if($t)applyPatch(_deepClone($t),_deepClone(xt),Ct||!0);else{Ct=Ct||validator;for(var kt=0;kt<xt.length;kt++)Ct(xt[kt],kt,$t,void 0)}}catch(Mt){if(Mt instanceof JsonPatchError)return Mt;throw Mt}}function _areEquals(xt,$t){if(xt===$t)return!0;if(xt&&$t&&typeof xt=="object"&&typeof $t=="object"){var Ct=Array.isArray(xt),kt=Array.isArray($t),Mt,Ft,jt;if(Ct&&kt){if(Ft=xt.length,Ft!=$t.length)return!1;for(Mt=Ft;Mt--!==0;)if(!_areEquals(xt[Mt],$t[Mt]))return!1;return!0}if(Ct!=kt)return!1;var Bt=Object.keys(xt);if(Ft=Bt.length,Ft!==Object.keys($t).length)return!1;for(Mt=Ft;Mt--!==0;)if(!$t.hasOwnProperty(Bt[Mt]))return!1;for(Mt=Ft;Mt--!==0;)if(jt=Bt[Mt],!_areEquals(xt[jt],$t[jt]))return!1;return!0}return xt!==xt&&$t!==$t}const core=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError,_areEquals,applyOperation,applyPatch,applyReducer,deepClone,getValueByPointer,validate,validator},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var beforeDict=new WeakMap,Mirror=function(){function xt($t){this.observers=new Map,this.obj=$t}return xt}(),ObserverInfo=function(){function xt($t,Ct){this.callback=$t,this.observer=Ct}return xt}();function getMirror(xt){return beforeDict.get(xt)}function getObserverFromMirror(xt,$t){return xt.observers.get($t)}function removeObserverFromMirror(xt,$t){xt.observers.delete($t.callback)}function unobserve(xt,$t){$t.unobserve()}function observe(xt,$t){var Ct=[],kt,Mt=getMirror(xt);if(!Mt)Mt=new Mirror(xt),beforeDict.set(xt,Mt);else{var Ft=getObserverFromMirror(Mt,$t);kt=Ft&&Ft.observer}if(kt)return kt;if(kt={},Mt.value=_deepClone(xt),$t){kt.callback=$t,kt.next=null;var jt=function(){generate$1(kt)},Bt=function(){clearTimeout(kt.next),kt.next=setTimeout(jt)};typeof window<"u"&&(window.addEventListener("mouseup",Bt),window.addEventListener("keyup",Bt),window.addEventListener("mousedown",Bt),window.addEventListener("keydown",Bt),window.addEventListener("change",Bt))}return kt.patches=Ct,kt.object=xt,kt.unobserve=function(){generate$1(kt),clearTimeout(kt.next),removeObserverFromMirror(Mt,kt),typeof window<"u"&&(window.removeEventListener("mouseup",Bt),window.removeEventListener("keyup",Bt),window.removeEventListener("mousedown",Bt),window.removeEventListener("keydown",Bt),window.removeEventListener("change",Bt))},Mt.observers.set($t,new ObserverInfo($t,kt)),kt}function generate$1(xt,$t){$t===void 0&&($t=!1);var Ct=beforeDict.get(xt.object);_generate(Ct.value,xt.object,xt.patches,"",$t),xt.patches.length&&applyPatch(Ct.value,xt.patches);var kt=xt.patches;return kt.length>0&&(xt.patches=[],xt.callback&&xt.callback(kt)),kt}function _generate(xt,$t,Ct,kt,Mt){if($t!==xt){typeof $t.toJSON=="function"&&($t=$t.toJSON());for(var Ft=_objectKeys($t),jt=_objectKeys(xt),Bt=!1,Vt=jt.length-1;Vt>=0;Vt--){var zt=jt[Vt],Ht=xt[zt];if(hasOwnProperty($t,zt)&&!($t[zt]===void 0&&Ht!==void 0&&Array.isArray($t)===!1)){var Gt=$t[zt];typeof Ht=="object"&&Ht!=null&&typeof Gt=="object"&&Gt!=null&&Array.isArray(Ht)===Array.isArray(Gt)?_generate(Ht,Gt,Ct,kt+"/"+escapePathComponent(zt),Mt):Ht!==Gt&&(Mt&&Ct.push({op:"test",path:kt+"/"+escapePathComponent(zt),value:_deepClone(Ht)}),Ct.push({op:"replace",path:kt+"/"+escapePathComponent(zt),value:_deepClone(Gt)}))}else Array.isArray(xt)===Array.isArray($t)?(Mt&&Ct.push({op:"test",path:kt+"/"+escapePathComponent(zt),value:_deepClone(Ht)}),Ct.push({op:"remove",path:kt+"/"+escapePathComponent(zt)}),Bt=!0):(Mt&&Ct.push({op:"test",path:kt,value:xt}),Ct.push({op:"replace",path:kt,value:$t}))}if(!(!Bt&&Ft.length==jt.length))for(var Vt=0;Vt<Ft.length;Vt++){var zt=Ft[Vt];!hasOwnProperty(xt,zt)&&$t[zt]!==void 0&&Ct.push({op:"add",path:kt+"/"+escapePathComponent(zt),value:_deepClone($t[zt])})}}}function compare$9(xt,$t,Ct){Ct===void 0&&(Ct=!1);var kt=[];return _generate(xt,$t,kt,"",Ct),kt}const duplex=Object.freeze(Object.defineProperty({__proto__:null,compare:compare$9,generate:generate$1,observe,unobserve},Symbol.toStringTag,{value:"Module"}));Object.assign({},core,duplex,{JsonPatchError:PatchError,deepClone:_deepClone,escapePathComponent,unescapePathComponent});var stringOrChar=/("(?:[^\\"]|\\.)*")|[:,]/g,jsonStringifyPrettyCompact=function xt($t,Ct){var kt,Mt,Ft;return Ct=Ct||{},kt=JSON.stringify([1],void 0,Ct.indent===void 0?2:Ct.indent).slice(2,-3),Mt=kt===""?1/0:Ct.maxLength===void 0?80:Ct.maxLength,Ft=Ct.replacer,function jt(Bt,Vt,zt){var Ht,Gt,qt,Wt,Yt,Kt,Xt,Qt,Jt,Zt,sn,ln;if(Bt&&typeof Bt.toJSON=="function"&&(Bt=Bt.toJSON()),sn=JSON.stringify(Bt,Ft),sn===void 0)return sn;if(Xt=Mt-Vt.length-zt,sn.length<=Xt&&(Jt=sn.replace(stringOrChar,function(dn,hn){return hn||dn+" "}),Jt.length<=Xt))return Jt;if(Ft!=null&&(Bt=JSON.parse(sn),Ft=void 0),typeof Bt=="object"&&Bt!==null){if(Qt=Vt+kt,qt=[],Gt=0,Array.isArray(Bt))for(Zt="[",Ht="]",Xt=Bt.length;Gt<Xt;Gt++)qt.push(jt(Bt[Gt],Qt,Gt===Xt-1?0:1)||"null");else for(Zt="{",Ht="}",Kt=Object.keys(Bt),Xt=Kt.length;Gt<Xt;Gt++)Wt=Kt[Gt],Yt=JSON.stringify(Wt)+": ",ln=jt(Bt[Wt],Qt,Yt.length+(Gt===Xt-1?0:1)),ln!==void 0&&qt.push(Yt+ln);if(qt.length>0)return[Zt,kt+qt.join(`,
`+Qt),Ht].join(`
`+Vt)}return sn}($t,"",0)};const stringify$2=getDefaultExportFromCjs$1(jsonStringifyPrettyCompact);function accessor(xt,$t,Ct){return xt.fields=$t||[],xt.fname=Ct,xt}function accessorName(xt){return xt==null?null:xt.fname}function accessorFields(xt){return xt==null?null:xt.fields}function getter$1(xt){return xt.length===1?get1(xt[0]):getN(xt)}const get1=xt=>function($t){return $t[xt]},getN=xt=>{const $t=xt.length;return function(Ct){for(let kt=0;kt<$t;++kt)Ct=Ct[xt[kt]];return Ct}};function error(xt){throw Error(xt)}function splitAccessPath(xt){const $t=[],Ct=xt.length;let kt=null,Mt=0,Ft="",jt,Bt,Vt;xt=xt+"";function zt(){$t.push(Ft+xt.substring(jt,Bt)),Ft="",jt=Bt+1}for(jt=Bt=0;Bt<Ct;++Bt)if(Vt=xt[Bt],Vt==="\\")Ft+=xt.substring(jt,Bt++),jt=Bt;else if(Vt===kt)zt(),kt=null,Mt=-1;else{if(kt)continue;jt===Mt&&Vt==='"'||jt===Mt&&Vt==="'"?(jt=Bt+1,kt=Vt):Vt==="."&&!Mt?Bt>jt?zt():jt=Bt+1:Vt==="["?(Bt>jt&&zt(),Mt=jt=Bt+1):Vt==="]"&&(Mt||error("Access path missing open bracket: "+xt),Mt>0&&zt(),Mt=0,jt=Bt+1)}return Mt&&error("Access path missing closing bracket: "+xt),kt&&error("Access path missing closing quote: "+xt),Bt>jt&&(Bt++,zt()),$t}function field$1(xt,$t,Ct){const kt=splitAccessPath(xt);return xt=kt.length===1?kt[0]:xt,accessor((Ct&&Ct.get||getter$1)(kt),[xt],$t||xt)}const id=field$1("id"),identity$1=accessor(xt=>xt,[],"identity"),zero$2=accessor(()=>0,[],"zero"),one$1=accessor(()=>1,[],"one"),truthy=accessor(()=>!0,[],"true"),falsy=accessor(()=>!1,[],"false");function log$1$1(xt,$t,Ct){const kt=[$t].concat([].slice.call(Ct));console[xt].apply(console,kt)}const None$2=0,Error$1=1,Warn=2,Info=3,Debug=4;function logger(xt,$t){let Ct=arguments.length>2&&arguments[2]!==void 0?arguments[2]:log$1$1,kt=xt||None$2;return{level(Mt){return arguments.length?(kt=+Mt,this):kt},error(){return kt>=Error$1&&Ct($t||"error","ERROR",arguments),this},warn(){return kt>=Warn&&Ct($t||"warn","WARN",arguments),this},info(){return kt>=Info&&Ct($t||"log","INFO",arguments),this},debug(){return kt>=Debug&&Ct($t||"log","DEBUG",arguments),this}}}var isArray=Array.isArray;function isObject(xt){return xt===Object(xt)}const isLegalKey=xt=>xt!=="__proto__";function mergeConfig(){for(var xt=arguments.length,$t=new Array(xt),Ct=0;Ct<xt;Ct++)$t[Ct]=arguments[Ct];return $t.reduce((kt,Mt)=>{for(const Ft in Mt)if(Ft==="signals")kt.signals=mergeNamed(kt.signals,Mt.signals);else{const jt=Ft==="legend"?{layout:1}:Ft==="style"?!0:null;writeConfig(kt,Ft,Mt[Ft],jt)}return kt},{})}function writeConfig(xt,$t,Ct,kt){if(!isLegalKey($t))return;let Mt,Ft;if(isObject(Ct)&&!isArray(Ct)){Ft=isObject(xt[$t])?xt[$t]:xt[$t]={};for(Mt in Ct)kt&&(kt===!0||kt[Mt])?writeConfig(Ft,Mt,Ct[Mt]):isLegalKey(Mt)&&(Ft[Mt]=Ct[Mt])}else xt[$t]=Ct}function mergeNamed(xt,$t){if(xt==null)return $t;const Ct={},kt=[];function Mt(Ft){Ct[Ft.name]||(Ct[Ft.name]=1,kt.push(Ft))}return $t.forEach(Mt),xt.forEach(Mt),kt}function peek$1(xt){return xt[xt.length-1]}function toNumber(xt){return xt==null||xt===""?null:+xt}const exp$1=xt=>$t=>xt*Math.exp($t),log$2=xt=>$t=>Math.log(xt*$t),symlog=xt=>$t=>Math.sign($t)*Math.log1p(Math.abs($t/xt)),symexp=xt=>$t=>Math.sign($t)*Math.expm1(Math.abs($t))*xt,pow$1=xt=>$t=>$t<0?-Math.pow(-$t,xt):Math.pow($t,xt);function pan(xt,$t,Ct,kt){const Mt=Ct(xt[0]),Ft=Ct(peek$1(xt)),jt=(Ft-Mt)*$t;return[kt(Mt-jt),kt(Ft-jt)]}function panLinear(xt,$t){return pan(xt,$t,toNumber,identity$1)}function panLog(xt,$t){var Ct=Math.sign(xt[0]);return pan(xt,$t,log$2(Ct),exp$1(Ct))}function panPow(xt,$t,Ct){return pan(xt,$t,pow$1(Ct),pow$1(1/Ct))}function panSymlog(xt,$t,Ct){return pan(xt,$t,symlog(Ct),symexp(Ct))}function zoom$1(xt,$t,Ct,kt,Mt){const Ft=kt(xt[0]),jt=kt(peek$1(xt)),Bt=$t!=null?kt($t):(Ft+jt)/2;return[Mt(Bt+(Ft-Bt)*Ct),Mt(Bt+(jt-Bt)*Ct)]}function zoomLinear(xt,$t,Ct){return zoom$1(xt,$t,Ct,toNumber,identity$1)}function zoomLog(xt,$t,Ct){const kt=Math.sign(xt[0]);return zoom$1(xt,$t,Ct,log$2(kt),exp$1(kt))}function zoomPow(xt,$t,Ct,kt){return zoom$1(xt,$t,Ct,pow$1(kt),pow$1(1/kt))}function zoomSymlog(xt,$t,Ct,kt){return zoom$1(xt,$t,Ct,symlog(kt),symexp(kt))}function quarter(xt){return 1+~~(new Date(xt).getMonth()/3)}function utcquarter(xt){return 1+~~(new Date(xt).getUTCMonth()/3)}function array$2(xt){return xt!=null?isArray(xt)?xt:[xt]:[]}function clampRange(xt,$t,Ct){let kt=xt[0],Mt=xt[1],Ft;return Mt<kt&&(Ft=Mt,Mt=kt,kt=Ft),Ft=Mt-kt,Ft>=Ct-$t?[$t,Ct]:[kt=Math.min(Math.max(kt,$t),Ct-Ft),kt+Ft]}function isFunction$1(xt){return typeof xt=="function"}const DESCENDING="descending";function compare$8(xt,$t,Ct){Ct=Ct||{},$t=array$2($t)||[];const kt=[],Mt=[],Ft={},jt=Ct.comparator||comparator$1;return array$2(xt).forEach((Bt,Vt)=>{Bt!=null&&(kt.push($t[Vt]===DESCENDING?-1:1),Mt.push(Bt=isFunction$1(Bt)?Bt:field$1(Bt,null,Ct)),(accessorFields(Bt)||[]).forEach(zt=>Ft[zt]=1))}),Mt.length===0?null:accessor(jt(Mt,kt),Object.keys(Ft))}const ascending$1=(xt,$t)=>(xt<$t||xt==null)&&$t!=null?-1:(xt>$t||$t==null)&&xt!=null?1:($t=$t instanceof Date?+$t:$t,(xt=xt instanceof Date?+xt:xt)!==xt&&$t===$t?-1:$t!==$t&&xt===xt?1:0),comparator$1=(xt,$t)=>xt.length===1?compare1(xt[0],$t[0]):compareN(xt,$t,xt.length),compare1=(xt,$t)=>function(Ct,kt){return ascending$1(xt(Ct),xt(kt))*$t},compareN=(xt,$t,Ct)=>($t.push(0),function(kt,Mt){let Ft,jt=0,Bt=-1;for(;jt===0&&++Bt<Ct;)Ft=xt[Bt],jt=ascending$1(Ft(kt),Ft(Mt));return jt*$t[Bt]});function constant$1(xt){return isFunction$1(xt)?xt:()=>xt}function debounce(xt,$t){let Ct;return kt=>{Ct&&clearTimeout(Ct),Ct=setTimeout(()=>($t(kt),Ct=null),xt)}}function extend(xt){for(let $t,Ct,kt=1,Mt=arguments.length;kt<Mt;++kt){$t=arguments[kt];for(Ct in $t)xt[Ct]=$t[Ct]}return xt}function extent(xt,$t){let Ct=0,kt,Mt,Ft,jt;if(xt&&(kt=xt.length))if($t==null){for(Mt=xt[Ct];Ct<kt&&(Mt==null||Mt!==Mt);Mt=xt[++Ct]);for(Ft=jt=Mt;Ct<kt;++Ct)Mt=xt[Ct],Mt!=null&&(Mt<Ft&&(Ft=Mt),Mt>jt&&(jt=Mt))}else{for(Mt=$t(xt[Ct]);Ct<kt&&(Mt==null||Mt!==Mt);Mt=$t(xt[++Ct]));for(Ft=jt=Mt;Ct<kt;++Ct)Mt=$t(xt[Ct]),Mt!=null&&(Mt<Ft&&(Ft=Mt),Mt>jt&&(jt=Mt))}return[Ft,jt]}function extentIndex(xt,$t){const Ct=xt.length;let kt=-1,Mt,Ft,jt,Bt,Vt;if($t==null){for(;++kt<Ct;)if(Ft=xt[kt],Ft!=null&&Ft>=Ft){Mt=jt=Ft;break}if(kt===Ct)return[-1,-1];for(Bt=Vt=kt;++kt<Ct;)Ft=xt[kt],Ft!=null&&(Mt>Ft&&(Mt=Ft,Bt=kt),jt<Ft&&(jt=Ft,Vt=kt))}else{for(;++kt<Ct;)if(Ft=$t(xt[kt],kt,xt),Ft!=null&&Ft>=Ft){Mt=jt=Ft;break}if(kt===Ct)return[-1,-1];for(Bt=Vt=kt;++kt<Ct;)Ft=$t(xt[kt],kt,xt),Ft!=null&&(Mt>Ft&&(Mt=Ft,Bt=kt),jt<Ft&&(jt=Ft,Vt=kt))}return[Bt,Vt]}const hop=Object.prototype.hasOwnProperty;function has$1(xt,$t){return hop.call(xt,$t)}const NULL={};function fastmap(xt){let $t={},Ct;function kt(Ft){return has$1($t,Ft)&&$t[Ft]!==NULL}const Mt={size:0,empty:0,object:$t,has:kt,get(Ft){return kt(Ft)?$t[Ft]:void 0},set(Ft,jt){return kt(Ft)||(++Mt.size,$t[Ft]===NULL&&--Mt.empty),$t[Ft]=jt,this},delete(Ft){return kt(Ft)&&(--Mt.size,++Mt.empty,$t[Ft]=NULL),this},clear(){Mt.size=Mt.empty=0,Mt.object=$t={}},test(Ft){return arguments.length?(Ct=Ft,Mt):Ct},clean(){const Ft={};let jt=0;for(const Bt in $t){const Vt=$t[Bt];Vt!==NULL&&(!Ct||!Ct(Vt))&&(Ft[Bt]=Vt,++jt)}Mt.size=jt,Mt.empty=0,Mt.object=$t=Ft}};return xt&&Object.keys(xt).forEach(Ft=>{Mt.set(Ft,xt[Ft])}),Mt}function flush(xt,$t,Ct,kt,Mt,Ft){if(!Ct&&Ct!==0)return Ft;const jt=+Ct;let Bt=xt[0],Vt=peek$1(xt),zt;Vt<Bt&&(zt=Bt,Bt=Vt,Vt=zt),zt=Math.abs($t-Bt);const Ht=Math.abs(Vt-$t);return zt<Ht&&zt<=jt?kt:Ht<=jt?Mt:Ft}function inherits(xt,$t,Ct){const kt=xt.prototype=Object.create($t.prototype);return Object.defineProperty(kt,"constructor",{value:xt,writable:!0,enumerable:!0,configurable:!0}),extend(kt,Ct)}function inrange(xt,$t,Ct,kt){let Mt=$t[0],Ft=$t[$t.length-1],jt;return Mt>Ft&&(jt=Mt,Mt=Ft,Ft=jt),Ct=Ct===void 0||Ct,kt=kt===void 0||kt,(Ct?Mt<=xt:Mt<xt)&&(kt?xt<=Ft:xt<Ft)}function isBoolean$2(xt){return typeof xt=="boolean"}function isDate$1(xt){return Object.prototype.toString.call(xt)==="[object Date]"}function isIterable(xt){return xt&&isFunction$1(xt[Symbol.iterator])}function isNumber$1(xt){return typeof xt=="number"}function isRegExp(xt){return Object.prototype.toString.call(xt)==="[object RegExp]"}function isString(xt){return typeof xt=="string"}function key(xt,$t,Ct){xt&&(xt=$t?array$2(xt).map(Bt=>Bt.replace(/\\(.)/g,"$1")):array$2(xt));const kt=xt&&xt.length,Mt=Ct&&Ct.get||getter$1,Ft=Bt=>Mt($t?[Bt]:splitAccessPath(Bt));let jt;if(!kt)jt=function(){return""};else if(kt===1){const Bt=Ft(xt[0]);jt=function(Vt){return""+Bt(Vt)}}else{const Bt=xt.map(Ft);jt=function(Vt){let zt=""+Bt[0](Vt),Ht=0;for(;++Ht<kt;)zt+="|"+Bt[Ht](Vt);return zt}}return accessor(jt,xt,"key")}function lerp(xt,$t){const Ct=xt[0],kt=peek$1(xt),Mt=+$t;return Mt?Mt===1?kt:Ct+Mt*(kt-Ct):Ct}const DEFAULT_MAX_SIZE=1e4;function lruCache$1(xt){xt=+xt||DEFAULT_MAX_SIZE;let $t,Ct,kt;const Mt=()=>{$t={},Ct={},kt=0},Ft=(jt,Bt)=>(++kt>xt&&(Ct=$t,$t={},kt=1),$t[jt]=Bt);return Mt(),{clear:Mt,has:jt=>has$1($t,jt)||has$1(Ct,jt),get:jt=>has$1($t,jt)?$t[jt]:has$1(Ct,jt)?Ft(jt,Ct[jt]):void 0,set:(jt,Bt)=>has$1($t,jt)?$t[jt]=Bt:Ft(jt,Bt)}}function merge$2(xt,$t,Ct,kt){const Mt=$t.length,Ft=Ct.length;if(!Ft)return $t;if(!Mt)return Ct;const jt=kt||new $t.constructor(Mt+Ft);let Bt=0,Vt=0,zt=0;for(;Bt<Mt&&Vt<Ft;++zt)jt[zt]=xt($t[Bt],Ct[Vt])>0?Ct[Vt++]:$t[Bt++];for(;Bt<Mt;++Bt,++zt)jt[zt]=$t[Bt];for(;Vt<Ft;++Vt,++zt)jt[zt]=Ct[Vt];return jt}function repeat(xt,$t){let Ct="";for(;--$t>=0;)Ct+=xt;return Ct}function pad(xt,$t,Ct,kt){const Mt=Ct||" ",Ft=xt+"",jt=$t-Ft.length;return jt<=0?Ft:kt==="left"?repeat(Mt,jt)+Ft:kt==="center"?repeat(Mt,~~(jt/2))+Ft+repeat(Mt,Math.ceil(jt/2)):Ft+repeat(Mt,jt)}function span(xt){return xt&&peek$1(xt)-xt[0]||0}function $(xt){return isArray(xt)?"["+xt.map($)+"]":isObject(xt)||isString(xt)?JSON.stringify(xt).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):xt}function toBoolean(xt){return xt==null||xt===""?null:!xt||xt==="false"||xt==="0"?!1:!!xt}const defaultParser=xt=>isNumber$1(xt)||isDate$1(xt)?xt:Date.parse(xt);function toDate(xt,$t){return $t=$t||defaultParser,xt==null||xt===""?null:$t(xt)}function toString(xt){return xt==null||xt===""?null:xt+""}function toSet(xt){const $t={},Ct=xt.length;for(let kt=0;kt<Ct;++kt)$t[xt[kt]]=!0;return $t}function truncate$1(xt,$t,Ct,kt){const Mt=kt??"",Ft=xt+"",jt=Ft.length,Bt=Math.max(0,$t-Mt.length);return jt<=$t?Ft:Ct==="left"?Mt+Ft.slice(jt-Bt):Ct==="center"?Ft.slice(0,Math.ceil(Bt/2))+Mt+Ft.slice(jt-~~(Bt/2)):Ft.slice(0,Bt)+Mt}function visitArray(xt,$t,Ct){if(xt)if($t){const kt=xt.length;for(let Mt=0;Mt<kt;++Mt){const Ft=$t(xt[Mt]);Ft&&Ct(Ft,Mt,xt)}}else xt.forEach(Ct)}function identity(xt){return xt}function transform$3(xt){if(xt==null)return identity;var $t,Ct,kt=xt.scale[0],Mt=xt.scale[1],Ft=xt.translate[0],jt=xt.translate[1];return function(Bt,Vt){Vt||($t=Ct=0);var zt=2,Ht=Bt.length,Gt=new Array(Ht);for(Gt[0]=($t+=Bt[0])*kt+Ft,Gt[1]=(Ct+=Bt[1])*Mt+jt;zt<Ht;)Gt[zt]=Bt[zt],++zt;return Gt}}function reverse$2(xt,$t){for(var Ct,kt=xt.length,Mt=kt-$t;Mt<--kt;)Ct=xt[Mt],xt[Mt++]=xt[kt],xt[kt]=Ct}function feature(xt,$t){return typeof $t=="string"&&($t=xt.objects[$t]),$t.type==="GeometryCollection"?{type:"FeatureCollection",features:$t.geometries.map(function(Ct){return feature$1(xt,Ct)})}:feature$1(xt,$t)}function feature$1(xt,$t){var Ct=$t.id,kt=$t.bbox,Mt=$t.properties==null?{}:$t.properties,Ft=object(xt,$t);return Ct==null&&kt==null?{type:"Feature",properties:Mt,geometry:Ft}:kt==null?{type:"Feature",id:Ct,properties:Mt,geometry:Ft}:{type:"Feature",id:Ct,bbox:kt,properties:Mt,geometry:Ft}}function object(xt,$t){var Ct=transform$3(xt.transform),kt=xt.arcs;function Mt(Ht,Gt){Gt.length&&Gt.pop();for(var qt=kt[Ht<0?~Ht:Ht],Wt=0,Yt=qt.length;Wt<Yt;++Wt)Gt.push(Ct(qt[Wt],Wt));Ht<0&&reverse$2(Gt,Yt)}function Ft(Ht){return Ct(Ht)}function jt(Ht){for(var Gt=[],qt=0,Wt=Ht.length;qt<Wt;++qt)Mt(Ht[qt],Gt);return Gt.length<2&&Gt.push(Gt[0]),Gt}function Bt(Ht){for(var Gt=jt(Ht);Gt.length<4;)Gt.push(Gt[0]);return Gt}function Vt(Ht){return Ht.map(Bt)}function zt(Ht){var Gt=Ht.type,qt;switch(Gt){case"GeometryCollection":return{type:Gt,geometries:Ht.geometries.map(zt)};case"Point":qt=Ft(Ht.coordinates);break;case"MultiPoint":qt=Ht.coordinates.map(Ft);break;case"LineString":qt=jt(Ht.arcs);break;case"MultiLineString":qt=Ht.arcs.map(jt);break;case"Polygon":qt=Vt(Ht.arcs);break;case"MultiPolygon":qt=Ht.arcs.map(Vt);break;default:return null}return{type:Gt,coordinates:qt}}return zt($t)}function stitch(xt,$t){var Ct={},kt={},Mt={},Ft=[],jt=-1;$t.forEach(function(zt,Ht){var Gt=xt.arcs[zt<0?~zt:zt],qt;Gt.length<3&&!Gt[1][0]&&!Gt[1][1]&&(qt=$t[++jt],$t[jt]=zt,$t[Ht]=qt)}),$t.forEach(function(zt){var Ht=Bt(zt),Gt=Ht[0],qt=Ht[1],Wt,Yt;if(Wt=Mt[Gt])if(delete Mt[Wt.end],Wt.push(zt),Wt.end=qt,Yt=kt[qt]){delete kt[Yt.start];var Kt=Yt===Wt?Wt:Wt.concat(Yt);kt[Kt.start=Wt.start]=Mt[Kt.end=Yt.end]=Kt}else kt[Wt.start]=Mt[Wt.end]=Wt;else if(Wt=kt[qt])if(delete kt[Wt.start],Wt.unshift(zt),Wt.start=Gt,Yt=Mt[Gt]){delete Mt[Yt.end];var Xt=Yt===Wt?Wt:Yt.concat(Wt);kt[Xt.start=Yt.start]=Mt[Xt.end=Wt.end]=Xt}else kt[Wt.start]=Mt[Wt.end]=Wt;else Wt=[zt],kt[Wt.start=Gt]=Mt[Wt.end=qt]=Wt});function Bt(zt){var Ht=xt.arcs[zt<0?~zt:zt],Gt=Ht[0],qt;return xt.transform?(qt=[0,0],Ht.forEach(function(Wt){qt[0]+=Wt[0],qt[1]+=Wt[1]})):qt=Ht[Ht.length-1],zt<0?[qt,Gt]:[Gt,qt]}function Vt(zt,Ht){for(var Gt in zt){var qt=zt[Gt];delete Ht[qt.start],delete qt.start,delete qt.end,qt.forEach(function(Wt){Ct[Wt<0?~Wt:Wt]=1}),Ft.push(qt)}}return Vt(Mt,kt),Vt(kt,Mt),$t.forEach(function(zt){Ct[zt<0?~zt:zt]||Ft.push([zt])}),Ft}function mesh(xt){return object(xt,meshArcs.apply(this,arguments))}function meshArcs(xt,$t,Ct){var kt,Mt,Ft;if(arguments.length>1)kt=extractArcs(xt,$t,Ct);else for(Mt=0,kt=new Array(Ft=xt.arcs.length);Mt<Ft;++Mt)kt[Mt]=Mt;return{type:"MultiLineString",arcs:stitch(xt,kt)}}function extractArcs(xt,$t,Ct){var kt=[],Mt=[],Ft;function jt(Gt){var qt=Gt<0?~Gt:Gt;(Mt[qt]||(Mt[qt]=[])).push({i:Gt,g:Ft})}function Bt(Gt){Gt.forEach(jt)}function Vt(Gt){Gt.forEach(Bt)}function zt(Gt){Gt.forEach(Vt)}function Ht(Gt){switch(Ft=Gt,Gt.type){case"GeometryCollection":Gt.geometries.forEach(Ht);break;case"LineString":Bt(Gt.arcs);break;case"MultiLineString":case"Polygon":Vt(Gt.arcs);break;case"MultiPolygon":zt(Gt.arcs);break}}return Ht($t),Mt.forEach(Ct==null?function(Gt){kt.push(Gt[0].i)}:function(Gt){Ct(Gt[0].g,Gt[Gt.length-1].g)&&kt.push(Gt[0].i)}),kt}const YEAR="year",QUARTER="quarter",MONTH="month",WEEK="week",DATE="date",DAY="day",DAYOFYEAR="dayofyear",HOURS="hours",MINUTES="minutes",SECONDS="seconds",MILLISECONDS="milliseconds",TIME_UNITS=[YEAR,QUARTER,MONTH,WEEK,DATE,DAY,DAYOFYEAR,HOURS,MINUTES,SECONDS,MILLISECONDS],UNITS=TIME_UNITS.reduce((xt,$t,Ct)=>(xt[$t]=1+Ct,xt),{});function timeUnits(xt){const $t=array$2(xt).slice(),Ct={};return $t.length||error("Missing time unit."),$t.forEach(Mt=>{has$1(UNITS,Mt)?Ct[Mt]=1:error(`Invalid time unit: ${Mt}.`)}),(Ct[WEEK]||Ct[DAY]?1:0)+(Ct[QUARTER]||Ct[MONTH]||Ct[DATE]?1:0)+(Ct[DAYOFYEAR]?1:0)>1&&error(`Incompatible time units: ${xt}`),$t.sort((Mt,Ft)=>UNITS[Mt]-UNITS[Ft]),$t}const defaultSpecifiers={[YEAR]:"%Y ",[QUARTER]:"Q%q ",[MONTH]:"%b ",[DATE]:"%d ",[WEEK]:"W%U ",[DAY]:"%a ",[DAYOFYEAR]:"%j ",[HOURS]:"%H:00",[MINUTES]:"00:%M",[SECONDS]:":%S",[MILLISECONDS]:".%L",[`${YEAR}-${MONTH}`]:"%Y-%m ",[`${YEAR}-${MONTH}-${DATE}`]:"%Y-%m-%d ",[`${HOURS}-${MINUTES}`]:"%H:%M"};function timeUnitSpecifier(xt,$t){const Ct=extend({},defaultSpecifiers,$t),kt=timeUnits(xt),Mt=kt.length;let Ft="",jt=0,Bt,Vt;for(jt=0;jt<Mt;)for(Bt=kt.length;Bt>jt;--Bt)if(Vt=kt.slice(jt,Bt).join("-"),Ct[Vt]!=null){Ft+=Ct[Vt],jt=Bt;break}return Ft.trim()}const t0=new Date;function localYear(xt){return t0.setFullYear(xt),t0.setMonth(0),t0.setDate(1),t0.setHours(0,0,0,0),t0}function dayofyear(xt){return localDayOfYear(new Date(xt))}function week(xt){return localWeekNum(new Date(xt))}function localDayOfYear(xt){return timeDay.count(localYear(xt.getFullYear())-1,xt)}function localWeekNum(xt){return timeSunday.count(localYear(xt.getFullYear())-1,xt)}function localFirst(xt){return localYear(xt).getDay()}function localDate(xt,$t,Ct,kt,Mt,Ft,jt){if(0<=xt&&xt<100){const Bt=new Date(-1,$t,Ct,kt,Mt,Ft,jt);return Bt.setFullYear(xt),Bt}return new Date(xt,$t,Ct,kt,Mt,Ft,jt)}function utcdayofyear(xt){return utcDayOfYear(new Date(xt))}function utcweek(xt){return utcWeekNum(new Date(xt))}function utcDayOfYear(xt){const $t=Date.UTC(xt.getUTCFullYear(),0,1);return utcDay.count($t-1,xt)}function utcWeekNum(xt){const $t=Date.UTC(xt.getUTCFullYear(),0,1);return utcSunday.count($t-1,xt)}function utcFirst(xt){return t0.setTime(Date.UTC(xt,0,1)),t0.getUTCDay()}function utcDate(xt,$t,Ct,kt,Mt,Ft,jt){if(0<=xt&&xt<100){const Bt=new Date(Date.UTC(-1,$t,Ct,kt,Mt,Ft,jt));return Bt.setUTCFullYear(Ct.y),Bt}return new Date(Date.UTC(xt,$t,Ct,kt,Mt,Ft,jt))}function floor(xt,$t,Ct,kt,Mt){const Ft=$t||1,jt=peek$1(xt),Bt=(Qt,Jt,Zt)=>(Zt=Zt||Qt,getUnit(Ct[Zt],kt[Zt],Qt===jt&&Ft,Jt)),Vt=new Date,zt=toSet(xt),Ht=zt[YEAR]?Bt(YEAR):constant$1(2012),Gt=zt[MONTH]?Bt(MONTH):zt[QUARTER]?Bt(QUARTER):zero$2,qt=zt[WEEK]&&zt[DAY]?Bt(DAY,1,WEEK+DAY):zt[WEEK]?Bt(WEEK,1):zt[DAY]?Bt(DAY,1):zt[DATE]?Bt(DATE,1):zt[DAYOFYEAR]?Bt(DAYOFYEAR,1):one$1,Wt=zt[HOURS]?Bt(HOURS):zero$2,Yt=zt[MINUTES]?Bt(MINUTES):zero$2,Kt=zt[SECONDS]?Bt(SECONDS):zero$2,Xt=zt[MILLISECONDS]?Bt(MILLISECONDS):zero$2;return function(Qt){Vt.setTime(+Qt);const Jt=Ht(Vt);return Mt(Jt,Gt(Vt),qt(Vt,Jt),Wt(Vt),Yt(Vt),Kt(Vt),Xt(Vt))}}function getUnit(xt,$t,Ct,kt){const Mt=Ct<=1?xt:kt?(Ft,jt)=>kt+Ct*Math.floor((xt(Ft,jt)-kt)/Ct):(Ft,jt)=>Ct*Math.floor(xt(Ft,jt)/Ct);return $t?(Ft,jt)=>$t(Mt(Ft,jt),jt):Mt}function weekday(xt,$t,Ct){return $t+xt*7-(Ct+6)%7}const localGet={[YEAR]:xt=>xt.getFullYear(),[QUARTER]:xt=>Math.floor(xt.getMonth()/3),[MONTH]:xt=>xt.getMonth(),[DATE]:xt=>xt.getDate(),[HOURS]:xt=>xt.getHours(),[MINUTES]:xt=>xt.getMinutes(),[SECONDS]:xt=>xt.getSeconds(),[MILLISECONDS]:xt=>xt.getMilliseconds(),[DAYOFYEAR]:xt=>localDayOfYear(xt),[WEEK]:xt=>localWeekNum(xt),[WEEK+DAY]:(xt,$t)=>weekday(localWeekNum(xt),xt.getDay(),localFirst($t)),[DAY]:(xt,$t)=>weekday(1,xt.getDay(),localFirst($t))},localInv={[QUARTER]:xt=>3*xt,[WEEK]:(xt,$t)=>weekday(xt,0,localFirst($t))};function timeFloor(xt,$t){return floor(xt,$t||1,localGet,localInv,localDate)}const utcGet={[YEAR]:xt=>xt.getUTCFullYear(),[QUARTER]:xt=>Math.floor(xt.getUTCMonth()/3),[MONTH]:xt=>xt.getUTCMonth(),[DATE]:xt=>xt.getUTCDate(),[HOURS]:xt=>xt.getUTCHours(),[MINUTES]:xt=>xt.getUTCMinutes(),[SECONDS]:xt=>xt.getUTCSeconds(),[MILLISECONDS]:xt=>xt.getUTCMilliseconds(),[DAYOFYEAR]:xt=>utcDayOfYear(xt),[WEEK]:xt=>utcWeekNum(xt),[DAY]:(xt,$t)=>weekday(1,xt.getUTCDay(),utcFirst($t)),[WEEK+DAY]:(xt,$t)=>weekday(utcWeekNum(xt),xt.getUTCDay(),utcFirst($t))},utcInv={[QUARTER]:xt=>3*xt,[WEEK]:(xt,$t)=>weekday(xt,0,utcFirst($t))};function utcFloor(xt,$t){return floor(xt,$t||1,utcGet,utcInv,utcDate)}const timeIntervals={[YEAR]:timeYear,[QUARTER]:timeMonth.every(3),[MONTH]:timeMonth,[WEEK]:timeSunday,[DATE]:timeDay,[DAY]:timeDay,[DAYOFYEAR]:timeDay,[HOURS]:timeHour,[MINUTES]:timeMinute,[SECONDS]:second,[MILLISECONDS]:millisecond},utcIntervals={[YEAR]:utcYear,[QUARTER]:utcMonth.every(3),[MONTH]:utcMonth,[WEEK]:utcSunday,[DATE]:utcDay,[DAY]:utcDay,[DAYOFYEAR]:utcDay,[HOURS]:utcHour,[MINUTES]:utcMinute,[SECONDS]:second,[MILLISECONDS]:millisecond};function timeInterval(xt){return timeIntervals[xt]}function utcInterval(xt){return utcIntervals[xt]}function offset$3(xt,$t,Ct){return xt?xt.offset($t,Ct):void 0}function timeOffset(xt,$t,Ct){return offset$3(timeInterval(xt),$t,Ct)}function utcOffset(xt,$t,Ct){return offset$3(utcInterval(xt),$t,Ct)}function sequence$1(xt,$t,Ct,kt){return xt?xt.range($t,Ct,kt):void 0}function timeSequence(xt,$t,Ct,kt){return sequence$1(timeInterval(xt),$t,Ct,kt)}function utcSequence(xt,$t,Ct,kt){return sequence$1(utcInterval(xt),$t,Ct,kt)}const durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,Milli=[YEAR,MONTH,DATE,HOURS,MINUTES,SECONDS,MILLISECONDS],Seconds=Milli.slice(0,-1),Minutes=Seconds.slice(0,-1),Hours=Minutes.slice(0,-1),Day=Hours.slice(0,-1),Week=[YEAR,WEEK],Month=[YEAR,MONTH],Year=[YEAR],intervals=[[Seconds,1,durationSecond],[Seconds,5,5*durationSecond],[Seconds,15,15*durationSecond],[Seconds,30,30*durationSecond],[Minutes,1,durationMinute],[Minutes,5,5*durationMinute],[Minutes,15,15*durationMinute],[Minutes,30,30*durationMinute],[Hours,1,durationHour],[Hours,3,3*durationHour],[Hours,6,6*durationHour],[Hours,12,12*durationHour],[Day,1,durationDay],[Week,1,durationWeek],[Month,1,durationMonth],[Month,3,3*durationMonth],[Year,1,durationYear]];function bin$2(xt){const $t=xt.extent,Ct=xt.maxbins||40,kt=Math.abs(span($t))/Ct;let Mt=bisector$1(Bt=>Bt[2]).right(intervals,kt),Ft,jt;return Mt===intervals.length?(Ft=Year,jt=tickStep($t[0]/durationYear,$t[1]/durationYear,Ct)):Mt?(Mt=intervals[kt/intervals[Mt-1][2]<intervals[Mt][2]/kt?Mt-1:Mt],Ft=Mt[0],jt=Mt[1]):(Ft=Milli,jt=Math.max(tickStep($t[0],$t[1],Ct),1)),{units:Ft,step:jt}}function memoize(xt){const $t={};return Ct=>$t[Ct]||($t[Ct]=xt(Ct))}function trimZeroes(xt,$t){return Ct=>{const kt=xt(Ct),Mt=kt.indexOf($t);if(Mt<0)return kt;let Ft=rightmostDigit(kt,Mt);const jt=Ft<kt.length?kt.slice(Ft):"";for(;--Ft>Mt;)if(kt[Ft]!=="0"){++Ft;break}return kt.slice(0,Ft)+jt}}function rightmostDigit(xt,$t){let Ct=xt.lastIndexOf("e"),kt;if(Ct>0)return Ct;for(Ct=xt.length;--Ct>$t;)if(kt=xt.charCodeAt(Ct),kt>=48&&kt<=57)return Ct+1}function numberLocale(xt){const $t=memoize(xt.format),Ct=xt.formatPrefix;return{format:$t,formatPrefix:Ct,formatFloat(kt){const Mt=formatSpecifier(kt||",");if(Mt.precision==null){switch(Mt.precision=12,Mt.type){case"%":Mt.precision-=2;break;case"e":Mt.precision-=1;break}return trimZeroes($t(Mt),$t(".1f")(1)[1])}else return $t(Mt)},formatSpan(kt,Mt,Ft,jt){jt=formatSpecifier(jt??",f");const Bt=tickStep(kt,Mt,Ft),Vt=Math.max(Math.abs(kt),Math.abs(Mt));let zt;if(jt.precision==null)switch(jt.type){case"s":return isNaN(zt=precisionPrefix(Bt,Vt))||(jt.precision=zt),Ct(jt,Vt);case"":case"e":case"g":case"p":case"r":{isNaN(zt=precisionRound(Bt,Vt))||(jt.precision=zt-(jt.type==="e"));break}case"f":case"%":{isNaN(zt=precisionFixed(Bt))||(jt.precision=zt-(jt.type==="%")*2);break}}return $t(jt)}}}let defaultNumberLocale;resetNumberFormatDefaultLocale();function resetNumberFormatDefaultLocale(){return defaultNumberLocale=numberLocale({format:format$6,formatPrefix})}function numberFormatLocale(xt){return numberLocale(formatLocale$1(xt))}function numberFormatDefaultLocale(xt){return arguments.length?defaultNumberLocale=numberFormatLocale(xt):defaultNumberLocale}function timeMultiFormat(xt,$t,Ct){Ct=Ct||{},isObject(Ct)||error(`Invalid time multi-format specifier: ${Ct}`);const kt=$t(SECONDS),Mt=$t(MINUTES),Ft=$t(HOURS),jt=$t(DATE),Bt=$t(WEEK),Vt=$t(MONTH),zt=$t(QUARTER),Ht=$t(YEAR),Gt=xt(Ct[MILLISECONDS]||".%L"),qt=xt(Ct[SECONDS]||":%S"),Wt=xt(Ct[MINUTES]||"%I:%M"),Yt=xt(Ct[HOURS]||"%I %p"),Kt=xt(Ct[DATE]||Ct[DAY]||"%a %d"),Xt=xt(Ct[WEEK]||"%b %d"),Qt=xt(Ct[MONTH]||"%B"),Jt=xt(Ct[QUARTER]||"%B"),Zt=xt(Ct[YEAR]||"%Y");return sn=>(kt(sn)<sn?Gt:Mt(sn)<sn?qt:Ft(sn)<sn?Wt:jt(sn)<sn?Yt:Vt(sn)<sn?Bt(sn)<sn?Kt:Xt:Ht(sn)<sn?zt(sn)<sn?Qt:Jt:Zt)(sn)}function timeLocale(xt){const $t=memoize(xt.format),Ct=memoize(xt.utcFormat);return{timeFormat:kt=>isString(kt)?$t(kt):timeMultiFormat($t,timeInterval,kt),utcFormat:kt=>isString(kt)?Ct(kt):timeMultiFormat(Ct,utcInterval,kt),timeParse:memoize(xt.parse),utcParse:memoize(xt.utcParse)}}let defaultTimeLocale;resetTimeFormatDefaultLocale();function resetTimeFormatDefaultLocale(){return defaultTimeLocale=timeLocale({format:timeFormat$2,parse:timeParse$1,utcFormat:utcFormat$1,utcParse:utcParse$1})}function timeFormatLocale(xt){return timeLocale(formatLocale(xt))}function timeFormatDefaultLocale(xt){return arguments.length?defaultTimeLocale=timeFormatLocale(xt):defaultTimeLocale}const createLocale=(xt,$t)=>extend({},xt,$t);function locale(xt,$t){const Ct=xt?numberFormatLocale(xt):numberFormatDefaultLocale(),kt=$t?timeFormatLocale($t):timeFormatDefaultLocale();return createLocale(Ct,kt)}function defaultLocale(xt,$t){const Ct=arguments.length;return Ct&&Ct!==2&&error("defaultLocale expects either zero or two arguments."),Ct?createLocale(numberFormatDefaultLocale(xt),timeFormatDefaultLocale($t)):createLocale(numberFormatDefaultLocale(),timeFormatDefaultLocale())}function resetDefaultLocale(){return resetNumberFormatDefaultLocale(),resetTimeFormatDefaultLocale(),defaultLocale()}const protocol_re=/^(data:|([A-Za-z]+:)?\/\/)/,allowed_re=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,whitespace_re=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,fileProtocol="file://";function loaderFactory(xt,$t){return Ct=>({options:Ct||{},sanitize,load:load$1,fileAccess:!!$t,file:fileLoader($t),http:httpLoader(xt)})}async function load$1(xt,$t){const Ct=await this.sanitize(xt,$t),kt=Ct.href;return Ct.localFile?this.file(kt):this.http(kt,$t)}async function sanitize(xt,$t){$t=extend({},this.options,$t);const Ct=this.fileAccess,kt={href:null};let Mt,Ft,jt;const Bt=allowed_re.test(xt.replace(whitespace_re,""));(xt==null||typeof xt!="string"||!Bt)&&error("Sanitize failure, invalid URI: "+$(xt));const Vt=protocol_re.test(xt);return(jt=$t.baseURL)&&!Vt&&(!xt.startsWith("/")&&!jt.endsWith("/")&&(xt="/"+xt),xt=jt+xt),Ft=(Mt=xt.startsWith(fileProtocol))||$t.mode==="file"||$t.mode!=="http"&&!Vt&&Ct,Mt?xt=xt.slice(fileProtocol.length):xt.startsWith("//")&&($t.defaultProtocol==="file"?(xt=xt.slice(2),Ft=!0):xt=($t.defaultProtocol||"http")+":"+xt),Object.defineProperty(kt,"localFile",{value:!!Ft}),kt.href=xt,$t.target&&(kt.target=$t.target+""),$t.rel&&(kt.rel=$t.rel+""),$t.context==="image"&&$t.crossOrigin&&(kt.crossOrigin=$t.crossOrigin+""),kt}function fileLoader(xt){return xt?$t=>new Promise((Ct,kt)=>{xt.readFile($t,(Mt,Ft)=>{Mt?kt(Mt):Ct(Ft)})}):fileReject}async function fileReject(){error("No file system access.")}function httpLoader(xt){return xt?async function($t,Ct){const kt=extend({},this.options.http,Ct),Mt=Ct&&Ct.response,Ft=await xt($t,kt);return Ft.ok?isFunction$1(Ft[Mt])?Ft[Mt]():Ft.text():error(Ft.status+""+Ft.statusText)}:httpReject}async function httpReject(){error("No HTTP fetch method available.")}const isValid=xt=>xt!=null&&xt===xt,isBoolean$1=xt=>xt==="true"||xt==="false"||xt===!0||xt===!1,isDate=xt=>!Number.isNaN(Date.parse(xt)),isNumber=xt=>!Number.isNaN(+xt)&&!(xt instanceof Date),isInteger=xt=>isNumber(xt)&&Number.isInteger(+xt),typeParsers={boolean:toBoolean,integer:toNumber,number:toNumber,date:toDate,string:toString,unknown:identity$1},typeTests=[isBoolean$1,isInteger,isNumber,isDate],typeList=["boolean","integer","number","date"];function inferType(xt,$t){if(!xt||!xt.length)return"unknown";const Ct=xt.length,kt=typeTests.length,Mt=typeTests.map((Ft,jt)=>jt+1);for(let Ft=0,jt=0,Bt,Vt;Ft<Ct;++Ft)for(Vt=$t?xt[Ft][$t]:xt[Ft],Bt=0;Bt<kt;++Bt)if(Mt[Bt]&&isValid(Vt)&&!typeTests[Bt](Vt)&&(Mt[Bt]=0,++jt,jt===typeTests.length))return"string";return typeList[Mt.reduce((Ft,jt)=>Ft===0?jt:Ft,0)-1]}function inferTypes(xt,$t){return $t.reduce((Ct,kt)=>(Ct[kt]=inferType(xt,kt),Ct),{})}function delimitedFormat(xt){const $t=function(Ct,kt){const Mt={delimiter:xt};return dsv(Ct,kt?extend(kt,Mt):Mt)};return $t.responseType="text",$t}function dsv(xt,$t){return $t.header&&(xt=$t.header.map($).join($t.delimiter)+`
`+xt),dsvFormat($t.delimiter).parse(xt+"")}dsv.responseType="text";function isBuffer(xt){return typeof Buffer=="function"&&isFunction$1(Buffer.isBuffer)?Buffer.isBuffer(xt):!1}function json(xt,$t){const Ct=$t&&$t.property?field$1($t.property):identity$1;return isObject(xt)&&!isBuffer(xt)?parseJSON(Ct(xt),$t):Ct(JSON.parse(xt))}json.responseType="json";function parseJSON(xt,$t){return!isArray(xt)&&isIterable(xt)&&(xt=[...xt]),$t&&$t.copy?JSON.parse(JSON.stringify(xt)):xt}const filters={interior:(xt,$t)=>xt!==$t,exterior:(xt,$t)=>xt===$t};function topojson(xt,$t){let Ct,kt,Mt,Ft;return xt=json(xt,$t),$t&&$t.feature?(Ct=feature,Mt=$t.feature):$t&&$t.mesh?(Ct=mesh,Mt=$t.mesh,Ft=filters[$t.filter]):error("Missing TopoJSON feature or mesh parameter."),kt=(kt=xt.objects[Mt])?Ct(xt,kt,Ft):error("Invalid TopoJSON object: "+Mt),kt&&kt.features||[kt]}topojson.responseType="json";const format$2={dsv,csv:delimitedFormat(","),tsv:delimitedFormat("	"),json,topojson};function formats$1(xt,$t){return arguments.length>1?(format$2[xt]=$t,this):has$1(format$2,xt)?format$2[xt]:null}function responseType(xt){const $t=formats$1(xt);return $t&&$t.responseType||"text"}function read(xt,$t,Ct,kt){$t=$t||{};const Mt=formats$1($t.type||"json");return Mt||error("Unknown data format type: "+$t.type),xt=Mt(xt,$t),$t.parse&&parse$6(xt,$t.parse,Ct,kt),has$1(xt,"columns")&&delete xt.columns,xt}function parse$6(xt,$t,Ct,kt){if(!xt.length)return;const Mt=timeFormatDefaultLocale();Ct=Ct||Mt.timeParse,kt=kt||Mt.utcParse;let Ft=xt.columns||Object.keys(xt[0]),jt,Bt,Vt,zt,Ht,Gt;$t==="auto"&&($t=inferTypes(xt,Ft)),Ft=Object.keys($t);const qt=Ft.map(Wt=>{const Yt=$t[Wt];let Kt,Xt;if(Yt&&(Yt.startsWith("date:")||Yt.startsWith("utc:")))return Kt=Yt.split(/:(.+)?/,2),Xt=Kt[1],(Xt[0]==="'"&&Xt[Xt.length-1]==="'"||Xt[0]==='"'&&Xt[Xt.length-1]==='"')&&(Xt=Xt.slice(1,-1)),(Kt[0]==="utc"?kt:Ct)(Xt);if(!typeParsers[Yt])throw Error("Illegal format pattern: "+Wt+":"+Yt);return typeParsers[Yt]});for(Vt=0,Ht=xt.length,Gt=Ft.length;Vt<Ht;++Vt)for(jt=xt[Vt],zt=0;zt<Gt;++zt)Bt=Ft[zt],jt[Bt]=qt[zt](jt[Bt])}const loader=loaderFactory(typeof fetch<"u"&&fetch,null);function UniqueList(xt){const $t=xt||identity$1,Ct=[],kt={};return Ct.add=Mt=>{const Ft=$t(Mt);return kt[Ft]||(kt[Ft]=1,Ct.push(Mt)),Ct},Ct.remove=Mt=>{const Ft=$t(Mt);if(kt[Ft]){kt[Ft]=0;const jt=Ct.indexOf(Mt);jt>=0&&Ct.splice(jt,1)}return Ct},Ct}async function asyncCallback(xt,$t){try{await $t(xt)}catch(Ct){xt.error(Ct)}}const TUPLE_ID_KEY=Symbol("vega_id");let TUPLE_ID=1;function isTuple(xt){return!!(xt&&tupleid(xt))}function tupleid(xt){return xt[TUPLE_ID_KEY]}function setid(xt,$t){return xt[TUPLE_ID_KEY]=$t,xt}function ingest$1(xt){const $t=xt===Object(xt)?xt:{data:xt};return tupleid($t)?$t:setid($t,TUPLE_ID++)}function derive(xt){return rederive(xt,ingest$1({}))}function rederive(xt,$t){for(const Ct in xt)$t[Ct]=xt[Ct];return $t}function replace$1(xt,$t){return setid($t,tupleid(xt))}function stableCompare(xt,$t){return xt?$t?(Ct,kt)=>xt(Ct,kt)||tupleid($t(Ct))-tupleid($t(kt)):(Ct,kt)=>xt(Ct,kt)||tupleid(Ct)-tupleid(kt):null}function isChangeSet(xt){return xt&&xt.constructor===changeset}function changeset(){const xt=[],$t=[],Ct=[],kt=[],Mt=[];let Ft=null,jt=!1;return{constructor:changeset,insert(Bt){const Vt=array$2(Bt),zt=Vt.length;for(let Ht=0;Ht<zt;++Ht)xt.push(Vt[Ht]);return this},remove(Bt){const Vt=isFunction$1(Bt)?kt:$t,zt=array$2(Bt),Ht=zt.length;for(let Gt=0;Gt<Ht;++Gt)Vt.push(zt[Gt]);return this},modify(Bt,Vt,zt){const Ht={field:Vt,value:constant$1(zt)};return isFunction$1(Bt)?(Ht.filter=Bt,Mt.push(Ht)):(Ht.tuple=Bt,Ct.push(Ht)),this},encode(Bt,Vt){return isFunction$1(Bt)?Mt.push({filter:Bt,field:Vt}):Ct.push({tuple:Bt,field:Vt}),this},clean(Bt){return Ft=Bt,this},reflow(){return jt=!0,this},pulse(Bt,Vt){const zt={},Ht={};let Gt,qt,Wt,Yt,Kt,Xt;for(Gt=0,qt=Vt.length;Gt<qt;++Gt)zt[tupleid(Vt[Gt])]=1;for(Gt=0,qt=$t.length;Gt<qt;++Gt)Kt=$t[Gt],zt[tupleid(Kt)]=-1;for(Gt=0,qt=kt.length;Gt<qt;++Gt)Yt=kt[Gt],Vt.forEach(Jt=>{Yt(Jt)&&(zt[tupleid(Jt)]=-1)});for(Gt=0,qt=xt.length;Gt<qt;++Gt)Kt=xt[Gt],Xt=tupleid(Kt),zt[Xt]?zt[Xt]=1:Bt.add.push(ingest$1(xt[Gt]));for(Gt=0,qt=Vt.length;Gt<qt;++Gt)Kt=Vt[Gt],zt[tupleid(Kt)]<0&&Bt.rem.push(Kt);function Qt(Jt,Zt,sn){sn?Jt[Zt]=sn(Jt):Bt.encode=Zt,jt||(Ht[tupleid(Jt)]=Jt)}for(Gt=0,qt=Ct.length;Gt<qt;++Gt)Wt=Ct[Gt],Kt=Wt.tuple,Yt=Wt.field,Xt=zt[tupleid(Kt)],Xt>0&&(Qt(Kt,Yt,Wt.value),Bt.modifies(Yt));for(Gt=0,qt=Mt.length;Gt<qt;++Gt)Wt=Mt[Gt],Yt=Wt.filter,Vt.forEach(Jt=>{Yt(Jt)&&zt[tupleid(Jt)]>0&&Qt(Jt,Wt.field,Wt.value)}),Bt.modifies(Wt.field);if(jt)Bt.mod=$t.length||kt.length?Vt.filter(Jt=>zt[tupleid(Jt)]>0):Vt.slice();else for(Xt in Ht)Bt.mod.push(Ht[Xt]);return(Ft||Ft==null&&($t.length||kt.length))&&Bt.clean(!0),Bt}}}const CACHE$1="_:mod:_";function Parameters(){Object.defineProperty(this,CACHE$1,{writable:!0,value:{}})}Parameters.prototype={set(xt,$t,Ct,kt){const Mt=this,Ft=Mt[xt],jt=Mt[CACHE$1];return $t!=null&&$t>=0?(Ft[$t]!==Ct||kt)&&(Ft[$t]=Ct,jt[$t+":"+xt]=-1,jt[xt]=-1):(Ft!==Ct||kt)&&(Mt[xt]=Ct,jt[xt]=isArray(Ct)?1+Ct.length:-1),Mt},modified(xt,$t){const Ct=this[CACHE$1];if(arguments.length){if(isArray(xt)){for(let kt=0;kt<xt.length;++kt)if(Ct[xt[kt]])return!0;return!1}}else{for(const kt in Ct)if(Ct[kt])return!0;return!1}return $t!=null&&$t>=0?$t+1<Ct[xt]||!!Ct[$t+":"+xt]:!!Ct[xt]},clear(){return this[CACHE$1]={},this}};let OP_ID=0;const PULSE="pulse",NO_PARAMS=new Parameters,SKIP$1$1=1,MODIFIED=2;function Operator(xt,$t,Ct,kt){this.id=++OP_ID,this.value=xt,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,$t&&(this._update=$t),Ct&&this.parameters(Ct,kt)}function flag(xt){return function($t){const Ct=this.flags;return arguments.length===0?!!(Ct&xt):(this.flags=$t?Ct|xt:Ct&~xt,this)}}Operator.prototype={targets(){return this._targets||(this._targets=UniqueList(id))},set(xt){return this.value!==xt?(this.value=xt,1):0},skip:flag(SKIP$1$1),modified:flag(MODIFIED),parameters(xt,$t,Ct){$t=$t!==!1;const kt=this._argval=this._argval||new Parameters,Mt=this._argops=this._argops||[],Ft=[];let jt,Bt,Vt,zt;const Ht=(Gt,qt,Wt)=>{Wt instanceof Operator?(Wt!==this&&($t&&Wt.targets().add(this),Ft.push(Wt)),Mt.push({op:Wt,name:Gt,index:qt})):kt.set(Gt,qt,Wt)};for(jt in xt)if(Bt=xt[jt],jt===PULSE)array$2(Bt).forEach(Gt=>{Gt instanceof Operator?Gt!==this&&(Gt.targets().add(this),Ft.push(Gt)):error("Pulse parameters must be operator instances.")}),this.source=Bt;else if(isArray(Bt))for(kt.set(jt,-1,Array(Vt=Bt.length)),zt=0;zt<Vt;++zt)Ht(jt,zt,Bt[zt]);else Ht(jt,-1,Bt);return this.marshall().clear(),Ct&&(Mt.initonly=!0),Ft},marshall(xt){const $t=this._argval||NO_PARAMS,Ct=this._argops;let kt,Mt,Ft,jt;if(Ct){const Bt=Ct.length;for(Mt=0;Mt<Bt;++Mt)kt=Ct[Mt],Ft=kt.op,jt=Ft.modified()&&Ft.stamp===xt,$t.set(kt.name,kt.index,Ft.value,jt);if(Ct.initonly){for(Mt=0;Mt<Bt;++Mt)kt=Ct[Mt],kt.op.targets().remove(this);this._argops=null,this._update=null}}return $t},detach(){const xt=this._argops;let $t,Ct,kt,Mt;if(xt)for($t=0,Ct=xt.length;$t<Ct;++$t)kt=xt[$t],Mt=kt.op,Mt._targets&&Mt._targets.remove(this);this.pulse=null,this.source=null},evaluate(xt){const $t=this._update;if($t){const Ct=this.marshall(xt.stamp),kt=$t.call(this,Ct,xt);if(Ct.clear(),kt!==this.value)this.value=kt;else if(!this.modified())return xt.StopPropagation}},run(xt){if(xt.stamp<this.stamp)return xt.StopPropagation;let $t;return this.skip()?(this.skip(!1),$t=0):$t=this.evaluate(xt),this.pulse=$t||xt}};function add$3(xt,$t,Ct,kt){let Mt=1,Ft;return xt instanceof Operator?Ft=xt:xt&&xt.prototype instanceof Operator?Ft=new xt:isFunction$1(xt)?Ft=new Operator(null,xt):(Mt=0,Ft=new Operator(xt,$t)),this.rank(Ft),Mt&&(kt=Ct,Ct=$t),Ct&&this.connect(Ft,Ft.parameters(Ct,kt)),this.touch(Ft),Ft}function connect(xt,$t){const Ct=xt.rank,kt=$t.length;for(let Mt=0;Mt<kt;++Mt)if(Ct<$t[Mt].rank){this.rerank(xt);return}}let STREAM_ID=0;function EventStream(xt,$t,Ct){this.id=++STREAM_ID,this.value=null,Ct&&(this.receive=Ct),xt&&(this._filter=xt),$t&&(this._apply=$t)}function stream(xt,$t,Ct){return new EventStream(xt,$t,Ct)}EventStream.prototype={_filter:truthy,_apply:identity$1,targets(){return this._targets||(this._targets=UniqueList(id))},consume(xt){return arguments.length?(this._consume=!!xt,this):!!this._consume},receive(xt){if(this._filter(xt)){const $t=this.value=this._apply(xt),Ct=this._targets,kt=Ct?Ct.length:0;for(let Mt=0;Mt<kt;++Mt)Ct[Mt].receive($t);this._consume&&(xt.preventDefault(),xt.stopPropagation())}},filter(xt){const $t=stream(xt);return this.targets().add($t),$t},apply(xt){const $t=stream(null,xt);return this.targets().add($t),$t},merge(){const xt=stream();this.targets().add(xt);for(let $t=0,Ct=arguments.length;$t<Ct;++$t)arguments[$t].targets().add(xt);return xt},throttle(xt){let $t=-1;return this.filter(()=>{const Ct=Date.now();return Ct-$t>xt?($t=Ct,1):0})},debounce(xt){const $t=stream();return this.targets().add(stream(null,null,debounce(xt,Ct=>{const kt=Ct.dataflow;$t.receive(Ct),kt&&kt.run&&kt.run()}))),$t},between(xt,$t){let Ct=!1;return xt.targets().add(stream(null,null,()=>Ct=!0)),$t.targets().add(stream(null,null,()=>Ct=!1)),this.filter(()=>Ct)},detach(){this._filter=truthy,this._targets=null}};function events$1(xt,$t,Ct,kt){const Mt=this,Ft=stream(Ct,kt),jt=function(zt){zt.dataflow=Mt;try{Ft.receive(zt)}catch(Ht){Mt.error(Ht)}finally{Mt.run()}};let Bt;typeof xt=="string"&&typeof document<"u"?Bt=document.querySelectorAll(xt):Bt=array$2(xt);const Vt=Bt.length;for(let zt=0;zt<Vt;++zt)Bt[zt].addEventListener($t,jt);return Ft}function parse$5(xt,$t){const Ct=this.locale();return read(xt,$t,Ct.timeParse,Ct.utcParse)}function ingest(xt,$t,Ct){return $t=this.parse($t,Ct),this.pulse(xt,this.changeset().insert($t))}async function request(xt,$t){const Ct=this;let kt=0,Mt;try{Mt=await Ct.loader().load(xt,{context:"dataflow",response:responseType($t&&$t.type)});try{Mt=Ct.parse(Mt,$t)}catch(Ft){kt=-2,Ct.warn("Data ingestion failed",xt,Ft)}}catch(Ft){kt=-1,Ct.warn("Loading failed",xt,Ft)}return{data:Mt,status:kt}}async function preload(xt,$t,Ct){const kt=this,Mt=kt._pending||loadPending(kt);Mt.requests+=1;const Ft=await kt.request($t,Ct);return kt.pulse(xt,kt.changeset().remove(truthy).insert(Ft.data||[])),Mt.done(),Ft}function loadPending(xt){let $t;const Ct=new Promise(kt=>$t=kt);return Ct.requests=0,Ct.done=()=>{--Ct.requests===0&&(xt._pending=null,$t(xt))},xt._pending=Ct}const SKIP$2={skip:!0};function on(xt,$t,Ct,kt,Mt){return(xt instanceof Operator?onOperator:onStream)(this,xt,$t,Ct,kt,Mt),this}function onStream(xt,$t,Ct,kt,Mt,Ft){const jt=extend({},Ft,SKIP$2);let Bt,Vt;isFunction$1(Ct)||(Ct=constant$1(Ct)),kt===void 0?Bt=zt=>xt.touch(Ct(zt)):isFunction$1(kt)?(Vt=new Operator(null,kt,Mt,!1),Bt=zt=>{Vt.evaluate(zt);const Ht=Ct(zt),Gt=Vt.value;isChangeSet(Gt)?xt.pulse(Ht,Gt,Ft):xt.update(Ht,Gt,jt)}):Bt=zt=>xt.update(Ct(zt),kt,jt),$t.apply(Bt)}function onOperator(xt,$t,Ct,kt,Mt,Ft){if(kt===void 0)$t.targets().add(Ct);else{const jt=Ft||{},Bt=new Operator(null,updater(Ct,kt),Mt,!1);Bt.modified(jt.force),Bt.rank=$t.rank,$t.targets().add(Bt),Ct&&(Bt.skip(!0),Bt.value=Ct.value,Bt.targets().add(Ct),xt.connect(Ct,[Bt]))}}function updater(xt,$t){return $t=isFunction$1($t)?$t:constant$1($t),xt?function(Ct,kt){const Mt=$t(Ct,kt);return xt.skip()||(xt.skip(Mt!==this.value).value=Mt),Mt}:$t}function rank(xt){xt.rank=++this._rank}function rerank(xt){const $t=[xt];let Ct,kt,Mt;for(;$t.length;)if(this.rank(Ct=$t.pop()),kt=Ct._targets)for(Mt=kt.length;--Mt>=0;)$t.push(Ct=kt[Mt]),Ct===xt&&error("Cycle detected in dataflow graph.")}const StopPropagation={},ADD=1,REM=2,MOD$1=4,ADD_REM=ADD|REM,ADD_MOD=ADD|MOD$1,ALL=ADD|REM|MOD$1,REFLOW=8,SOURCE=16,NO_SOURCE=32,NO_FIELDS=64;function Pulse(xt,$t,Ct){this.dataflow=xt,this.stamp=$t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=Ct||null}function materialize(xt,$t){const Ct=[];return visitArray(xt,$t,kt=>Ct.push(kt)),Ct}function filter$1(xt,$t){const Ct={};return xt.visit($t,kt=>{Ct[tupleid(kt)]=1}),kt=>Ct[tupleid(kt)]?null:kt}function addFilter(xt,$t){return xt?(Ct,kt)=>xt(Ct,kt)&&$t(Ct,kt):$t}Pulse.prototype={StopPropagation,ADD,REM,MOD:MOD$1,ADD_REM,ADD_MOD,ALL,REFLOW,SOURCE,NO_SOURCE,NO_FIELDS,fork(xt){return new Pulse(this.dataflow).init(this,xt)},clone(){const xt=this.fork(ALL);return xt.add=xt.add.slice(),xt.rem=xt.rem.slice(),xt.mod=xt.mod.slice(),xt.source&&(xt.source=xt.source.slice()),xt.materialize(ALL|SOURCE)},addAll(){let xt=this;return!xt.source||xt.add===xt.rem||!xt.rem.length&&xt.source.length===xt.add.length||(xt=new Pulse(this.dataflow).init(this),xt.add=xt.source,xt.rem=[]),xt},init(xt,$t){const Ct=this;return Ct.stamp=xt.stamp,Ct.encode=xt.encode,xt.fields&&!($t&NO_FIELDS)&&(Ct.fields=xt.fields),$t&ADD?(Ct.addF=xt.addF,Ct.add=xt.add):(Ct.addF=null,Ct.add=[]),$t&REM?(Ct.remF=xt.remF,Ct.rem=xt.rem):(Ct.remF=null,Ct.rem=[]),$t&MOD$1?(Ct.modF=xt.modF,Ct.mod=xt.mod):(Ct.modF=null,Ct.mod=[]),$t&NO_SOURCE?(Ct.srcF=null,Ct.source=null):(Ct.srcF=xt.srcF,Ct.source=xt.source,xt.cleans&&(Ct.cleans=xt.cleans)),Ct},runAfter(xt){this.dataflow.runAfter(xt)},changed(xt){const $t=xt||ALL;return $t&ADD&&this.add.length||$t&REM&&this.rem.length||$t&MOD$1&&this.mod.length},reflow(xt){if(xt)return this.fork(ALL).reflow();const $t=this.add.length,Ct=this.source&&this.source.length;return Ct&&Ct!==$t&&(this.mod=this.source,$t&&this.filter(MOD$1,filter$1(this,ADD))),this},clean(xt){return arguments.length?(this.cleans=!!xt,this):this.cleans},modifies(xt){const $t=this.fields||(this.fields={});return isArray(xt)?xt.forEach(Ct=>$t[Ct]=!0):$t[xt]=!0,this},modified(xt,$t){const Ct=this.fields;return($t||this.mod.length)&&Ct?arguments.length?isArray(xt)?xt.some(kt=>Ct[kt]):Ct[xt]:!!Ct:!1},filter(xt,$t){const Ct=this;return xt&ADD&&(Ct.addF=addFilter(Ct.addF,$t)),xt&REM&&(Ct.remF=addFilter(Ct.remF,$t)),xt&MOD$1&&(Ct.modF=addFilter(Ct.modF,$t)),xt&SOURCE&&(Ct.srcF=addFilter(Ct.srcF,$t)),Ct},materialize(xt){xt=xt||ALL;const $t=this;return xt&ADD&&$t.addF&&($t.add=materialize($t.add,$t.addF),$t.addF=null),xt&REM&&$t.remF&&($t.rem=materialize($t.rem,$t.remF),$t.remF=null),xt&MOD$1&&$t.modF&&($t.mod=materialize($t.mod,$t.modF),$t.modF=null),xt&SOURCE&&$t.srcF&&($t.source=$t.source.filter($t.srcF),$t.srcF=null),$t},visit(xt,$t){const Ct=this,kt=$t;if(xt&SOURCE)return visitArray(Ct.source,Ct.srcF,kt),Ct;xt&ADD&&visitArray(Ct.add,Ct.addF,kt),xt&REM&&visitArray(Ct.rem,Ct.remF,kt),xt&MOD$1&&visitArray(Ct.mod,Ct.modF,kt);const Mt=Ct.source;if(xt&REFLOW&&Mt){const Ft=Ct.add.length+Ct.mod.length;Ft===Mt.length||(Ft?visitArray(Mt,filter$1(Ct,ADD_MOD),kt):visitArray(Mt,Ct.srcF,kt))}return Ct}};function MultiPulse(xt,$t,Ct,kt){const Mt=this;let Ft=0;this.dataflow=xt,this.stamp=$t,this.fields=null,this.encode=kt||null,this.pulses=Ct;for(const jt of Ct)if(jt.stamp===$t){if(jt.fields){const Bt=Mt.fields||(Mt.fields={});for(const Vt in jt.fields)Bt[Vt]=1}jt.changed(Mt.ADD)&&(Ft|=Mt.ADD),jt.changed(Mt.REM)&&(Ft|=Mt.REM),jt.changed(Mt.MOD)&&(Ft|=Mt.MOD)}this.changes=Ft}inherits(MultiPulse,Pulse,{fork(xt){const $t=new Pulse(this.dataflow).init(this,xt&this.NO_FIELDS);return xt!==void 0&&(xt&$t.ADD&&this.visit($t.ADD,Ct=>$t.add.push(Ct)),xt&$t.REM&&this.visit($t.REM,Ct=>$t.rem.push(Ct)),xt&$t.MOD&&this.visit($t.MOD,Ct=>$t.mod.push(Ct))),$t},changed(xt){return this.changes&xt},modified(xt){const $t=this,Ct=$t.fields;return Ct&&$t.changes&$t.MOD?isArray(xt)?xt.some(kt=>Ct[kt]):Ct[xt]:0},filter(){error("MultiPulse does not support filtering.")},materialize(){error("MultiPulse does not support materialization.")},visit(xt,$t){const Ct=this,kt=Ct.pulses,Mt=kt.length;let Ft=0;if(xt&Ct.SOURCE)for(;Ft<Mt;++Ft)kt[Ft].visit(xt,$t);else for(;Ft<Mt;++Ft)kt[Ft].stamp===Ct.stamp&&kt[Ft].visit(xt,$t);return Ct}});async function evaluate(xt,$t,Ct){const kt=this,Mt=[];if(kt._pulse)return reentrant(kt);if(kt._pending&&await kt._pending,$t&&await asyncCallback(kt,$t),!kt._touched.length)return kt.debug("Dataflow invoked, but nothing to do."),kt;const Ft=++kt._clock;kt._pulse=new Pulse(kt,Ft,xt),kt._touched.forEach(Ht=>kt._enqueue(Ht,!0)),kt._touched=UniqueList(id);let jt=0,Bt,Vt,zt;try{for(;kt._heap.size()>0;){if(Bt=kt._heap.pop(),Bt.rank!==Bt.qrank){kt._enqueue(Bt,!0);continue}Vt=Bt.run(kt._getPulse(Bt,xt)),Vt.then?Vt=await Vt:Vt.async&&(Mt.push(Vt.async),Vt=StopPropagation),Vt!==StopPropagation&&Bt._targets&&Bt._targets.forEach(Ht=>kt._enqueue(Ht)),++jt}}catch(Ht){kt._heap.clear(),zt=Ht}if(kt._input={},kt._pulse=null,kt.debug(`Pulse ${Ft}: ${jt} operators`),zt&&(kt._postrun=[],kt.error(zt)),kt._postrun.length){const Ht=kt._postrun.sort((Gt,qt)=>qt.priority-Gt.priority);kt._postrun=[];for(let Gt=0;Gt<Ht.length;++Gt)await asyncCallback(kt,Ht[Gt].callback)}return Ct&&await asyncCallback(kt,Ct),Mt.length&&Promise.all(Mt).then(Ht=>kt.runAsync(null,()=>{Ht.forEach(Gt=>{try{Gt(kt)}catch(qt){kt.error(qt)}})})),kt}async function runAsync(xt,$t,Ct){for(;this._running;)await this._running;const kt=()=>this._running=null;return(this._running=this.evaluate(xt,$t,Ct)).then(kt,kt),this._running}function run(xt,$t,Ct){return this._pulse?reentrant(this):(this.evaluate(xt,$t,Ct),this)}function runAfter(xt,$t,Ct){if(this._pulse||$t)this._postrun.push({priority:Ct||0,callback:xt});else try{xt(this)}catch(kt){this.error(kt)}}function reentrant(xt){return xt.error("Dataflow already running. Use runAsync() to chain invocations."),xt}function enqueue(xt,$t){const Ct=xt.stamp<this._clock;Ct&&(xt.stamp=this._clock),(Ct||$t)&&(xt.qrank=xt.rank,this._heap.push(xt))}function getPulse(xt,$t){const Ct=xt.source,kt=this._clock;return Ct&&isArray(Ct)?new MultiPulse(this,kt,Ct.map(Mt=>Mt.pulse),$t):this._input[xt.id]||singlePulse(this._pulse,Ct&&Ct.pulse)}function singlePulse(xt,$t){return $t&&$t.stamp===xt.stamp?$t:(xt=xt.fork(),$t&&$t!==StopPropagation&&(xt.source=$t.source),xt)}const NO_OPT={skip:!1,force:!1};function touch(xt,$t){const Ct=$t||NO_OPT;return this._pulse?this._enqueue(xt):this._touched.add(xt),Ct.skip&&xt.skip(!0),this}function update$6(xt,$t,Ct){const kt=Ct||NO_OPT;return(xt.set($t)||kt.force)&&this.touch(xt,kt),this}function pulse(xt,$t,Ct){this.touch(xt,Ct||NO_OPT);const kt=new Pulse(this,this._clock+(this._pulse?0:1)),Mt=xt.pulse&&xt.pulse.source||[];return kt.target=xt,this._input[xt.id]=$t.pulse(kt,Mt),this}function Heap(xt){let $t=[];return{clear:()=>$t=[],size:()=>$t.length,peek:()=>$t[0],push:Ct=>($t.push(Ct),siftdown($t,0,$t.length-1,xt)),pop:()=>{const Ct=$t.pop();let kt;return $t.length?(kt=$t[0],$t[0]=Ct,siftup($t,0,xt)):kt=Ct,kt}}}function siftdown(xt,$t,Ct,kt){let Mt,Ft;const jt=xt[Ct];for(;Ct>$t;){if(Ft=Ct-1>>1,Mt=xt[Ft],kt(jt,Mt)<0){xt[Ct]=Mt,Ct=Ft;continue}break}return xt[Ct]=jt}function siftup(xt,$t,Ct){const kt=$t,Mt=xt.length,Ft=xt[$t];let jt=($t<<1)+1,Bt;for(;jt<Mt;)Bt=jt+1,Bt<Mt&&Ct(xt[jt],xt[Bt])>=0&&(jt=Bt),xt[$t]=xt[jt],$t=jt,jt=($t<<1)+1;return xt[$t]=Ft,siftdown(xt,kt,$t,Ct)}function Dataflow(){this.logger(logger()),this.logLevel(Error$1),this._clock=0,this._rank=0,this._locale=defaultLocale();try{this._loader=loader()}catch{}this._touched=UniqueList(id),this._input={},this._pulse=null,this._heap=Heap((xt,$t)=>xt.qrank-$t.qrank),this._postrun=[]}function logMethod(xt){return function(){return this._log[xt].apply(this,arguments)}}Dataflow.prototype={stamp(){return this._clock},loader(xt){return arguments.length?(this._loader=xt,this):this._loader},locale(xt){return arguments.length?(this._locale=xt,this):this._locale},logger(xt){return arguments.length?(this._log=xt,this):this._log},error:logMethod("error"),warn:logMethod("warn"),info:logMethod("info"),debug:logMethod("debug"),logLevel:logMethod("level"),cleanThreshold:1e4,add:add$3,connect,rank,rerank,pulse,touch,update:update$6,changeset,ingest,parse:parse$5,preload,request,events:events$1,on,evaluate,run,runAsync,runAfter,_enqueue:enqueue,_getPulse:getPulse};function Transform(xt,$t){Operator.call(this,xt,null,$t)}inherits(Transform,Operator,{run(xt){if(xt.stamp<this.stamp)return xt.StopPropagation;let $t;return this.skip()?this.skip(!1):$t=this.evaluate(xt),$t=$t||xt,$t.then?$t=$t.then(Ct=>this.pulse=Ct):$t!==xt.StopPropagation&&(this.pulse=$t),$t},evaluate(xt){const $t=this.marshall(xt.stamp),Ct=this.transform($t,xt);return $t.clear(),Ct},transform(){}});const transforms={};function definition$1(xt){const $t=transform$2(xt);return $t&&$t.Definition||null}function transform$2(xt){return xt=xt&&xt.toLowerCase(),has$1(transforms,xt)?transforms[xt]:null}function*numbers$1(xt,$t){if($t==null)for(let Ct of xt)Ct!=null&&Ct!==""&&(Ct=+Ct)>=Ct&&(yield Ct);else{let Ct=-1;for(let kt of xt)kt=$t(kt,++Ct,xt),kt!=null&&kt!==""&&(kt=+kt)>=kt&&(yield kt)}}function quantiles(xt,$t,Ct){const kt=Float64Array.from(numbers$1(xt,Ct));return kt.sort(ascending$4),$t.map(Mt=>quantileSorted(kt,Mt))}function quartiles(xt,$t){return quantiles(xt,[.25,.5,.75],$t)}function estimateBandwidth(xt,$t){const Ct=xt.length,kt=deviation(xt,$t),Mt=quartiles(xt,$t),Ft=(Mt[2]-Mt[0])/1.34;return 1.06*(Math.min(kt,Ft)||kt||Math.abs(Mt[0])||1)*Math.pow(Ct,-.2)}function bin$1(xt){const $t=xt.maxbins||20,Ct=xt.base||10,kt=Math.log(Ct),Mt=xt.divide||[5,2];let Ft=xt.extent[0],jt=xt.extent[1],Bt,Vt,zt,Ht,Gt,qt;const Wt=xt.span||jt-Ft||Math.abs(Ft)||1;if(xt.step)Bt=xt.step;else if(xt.steps){for(Ht=Wt/$t,Gt=0,qt=xt.steps.length;Gt<qt&&xt.steps[Gt]<Ht;++Gt);Bt=xt.steps[Math.max(0,Gt-1)]}else{for(Vt=Math.ceil(Math.log($t)/kt),zt=xt.minstep||0,Bt=Math.max(zt,Math.pow(Ct,Math.round(Math.log(Wt)/kt)-Vt));Math.ceil(Wt/Bt)>$t;)Bt*=Ct;for(Gt=0,qt=Mt.length;Gt<qt;++Gt)Ht=Bt/Mt[Gt],Ht>=zt&&Wt/Ht<=$t&&(Bt=Ht)}Ht=Math.log(Bt);const Yt=Ht>=0?0:~~(-Ht/kt)+1,Kt=Math.pow(Ct,-Yt-1);return(xt.nice||xt.nice===void 0)&&(Ht=Math.floor(Ft/Bt+Kt)*Bt,Ft=Ft<Ht?Ht-Bt:Ht,jt=Math.ceil(jt/Bt)*Bt),{start:Ft,stop:jt===Ft?Ft+Bt:jt,step:Bt}}var random=Math.random;function setRandom(xt){random=xt}function bootstrapCI(xt,$t,Ct,kt){if(!xt.length)return[void 0,void 0];const Mt=Float64Array.from(numbers$1(xt,kt)),Ft=Mt.length,jt=$t;let Bt,Vt,zt,Ht;for(zt=0,Ht=Array(jt);zt<jt;++zt){for(Bt=0,Vt=0;Vt<Ft;++Vt)Bt+=Mt[~~(random()*Ft)];Ht[zt]=Bt/Ft}return Ht.sort(ascending$4),[quantile$2(Ht,Ct/2),quantile$2(Ht,1-Ct/2)]}function dotbin(xt,$t,Ct,kt){kt=kt||(qt=>qt);const Mt=xt.length,Ft=new Float64Array(Mt);let jt=0,Bt=1,Vt=kt(xt[0]),zt=Vt,Ht=Vt+$t,Gt;for(;Bt<Mt;++Bt){if(Gt=kt(xt[Bt]),Gt>=Ht){for(zt=(Vt+zt)/2;jt<Bt;++jt)Ft[jt]=zt;Ht=Gt+$t,Vt=Gt}zt=Gt}for(zt=(Vt+zt)/2;jt<Bt;++jt)Ft[jt]=zt;return Ct?smoothing(Ft,$t+$t/4):Ft}function smoothing(xt,$t){const Ct=xt.length;let kt=0,Mt=1,Ft,jt;for(;xt[kt]===xt[Mt];)++Mt;for(;Mt<Ct;){for(Ft=Mt+1;xt[Mt]===xt[Ft];)++Ft;if(xt[Mt]-xt[Mt-1]<$t){for(jt=Mt+(kt+Ft-Mt-Mt>>1);jt<Mt;)xt[jt++]=xt[Mt];for(;jt>Mt;)xt[jt--]=xt[kt]}kt=Mt,Mt=Ft}return xt}function lcg(xt){return function(){return xt=(1103515245*xt+12345)%2147483647,xt/2147483647}}function integer(xt,$t){$t==null&&($t=xt,xt=0);let Ct,kt,Mt;const Ft={min(jt){return arguments.length?(Ct=jt||0,Mt=kt-Ct,Ft):Ct},max(jt){return arguments.length?(kt=jt||0,Mt=kt-Ct,Ft):kt},sample(){return Ct+Math.floor(Mt*random())},pdf(jt){return jt===Math.floor(jt)&&jt>=Ct&&jt<kt?1/Mt:0},cdf(jt){const Bt=Math.floor(jt);return Bt<Ct?0:Bt>=kt?1:(Bt-Ct+1)/Mt},icdf(jt){return jt>=0&&jt<=1?Ct-1+Math.floor(jt*Mt):NaN}};return Ft.min(xt).max($t)}const SQRT2PI=Math.sqrt(2*Math.PI),SQRT2=Math.SQRT2;let nextSample=NaN;function sampleNormal(xt,$t){xt=xt||0,$t=$t??1;let Ct=0,kt=0,Mt,Ft;if(nextSample===nextSample)Ct=nextSample,nextSample=NaN;else{do Ct=random()*2-1,kt=random()*2-1,Mt=Ct*Ct+kt*kt;while(Mt===0||Mt>1);Ft=Math.sqrt(-2*Math.log(Mt)/Mt),Ct*=Ft,nextSample=kt*Ft}return xt+Ct*$t}function densityNormal(xt,$t,Ct){Ct=Ct??1;const kt=(xt-($t||0))/Ct;return Math.exp(-.5*kt*kt)/(Ct*SQRT2PI)}function cumulativeNormal(xt,$t,Ct){$t=$t||0,Ct=Ct??1;const kt=(xt-$t)/Ct,Mt=Math.abs(kt);let Ft;if(Mt>37)Ft=0;else{const jt=Math.exp(-Mt*Mt/2);let Bt;Mt<7.07106781186547?(Bt=.0352624965998911*Mt+.700383064443688,Bt=Bt*Mt+6.37396220353165,Bt=Bt*Mt+33.912866078383,Bt=Bt*Mt+112.079291497871,Bt=Bt*Mt+221.213596169931,Bt=Bt*Mt+220.206867912376,Ft=jt*Bt,Bt=.0883883476483184*Mt+1.75566716318264,Bt=Bt*Mt+16.064177579207,Bt=Bt*Mt+86.7807322029461,Bt=Bt*Mt+296.564248779674,Bt=Bt*Mt+637.333633378831,Bt=Bt*Mt+793.826512519948,Bt=Bt*Mt+440.413735824752,Ft=Ft/Bt):(Bt=Mt+.65,Bt=Mt+4/Bt,Bt=Mt+3/Bt,Bt=Mt+2/Bt,Bt=Mt+1/Bt,Ft=jt/Bt/2.506628274631)}return kt>0?1-Ft:Ft}function quantileNormal(xt,$t,Ct){return xt<0||xt>1?NaN:($t||0)+(Ct??1)*SQRT2*erfinv(2*xt-1)}function erfinv(xt){let $t=-Math.log((1-xt)*(1+xt)),Ct;return $t<6.25?($t-=3.125,Ct=-364441206401782e-35,Ct=-16850591381820166e-35+Ct*$t,Ct=128584807152564e-32+Ct*$t,Ct=11157877678025181e-33+Ct*$t,Ct=-1333171662854621e-31+Ct*$t,Ct=20972767875968562e-33+Ct*$t,Ct=6637638134358324e-30+Ct*$t,Ct=-4054566272975207e-29+Ct*$t,Ct=-8151934197605472e-29+Ct*$t,Ct=26335093153082323e-28+Ct*$t,Ct=-12975133253453532e-27+Ct*$t,Ct=-5415412054294628e-26+Ct*$t,Ct=10512122733215323e-25+Ct*$t,Ct=-4112633980346984e-24+Ct*$t,Ct=-29070369957882005e-24+Ct*$t,Ct=42347877827932404e-23+Ct*$t,Ct=-13654692000834679e-22+Ct*$t,Ct=-13882523362786469e-21+Ct*$t,Ct=.00018673420803405714+Ct*$t,Ct=-.000740702534166267+Ct*$t,Ct=-.006033670871430149+Ct*$t,Ct=.24015818242558962+Ct*$t,Ct=1.6536545626831027+Ct*$t):$t<16?($t=Math.sqrt($t)-3.25,Ct=22137376921775787e-25,Ct=9075656193888539e-23+Ct*$t,Ct=-27517406297064545e-23+Ct*$t,Ct=18239629214389228e-24+Ct*$t,Ct=15027403968909828e-22+Ct*$t,Ct=-4013867526981546e-21+Ct*$t,Ct=29234449089955446e-22+Ct*$t,Ct=12475304481671779e-21+Ct*$t,Ct=-47318229009055734e-21+Ct*$t,Ct=6828485145957318e-20+Ct*$t,Ct=24031110387097894e-21+Ct*$t,Ct=-.0003550375203628475+Ct*$t,Ct=.0009532893797373805+Ct*$t,Ct=-.0016882755560235047+Ct*$t,Ct=.002491442096107851+Ct*$t,Ct=-.003751208507569241+Ct*$t,Ct=.005370914553590064+Ct*$t,Ct=1.0052589676941592+Ct*$t,Ct=3.0838856104922208+Ct*$t):Number.isFinite($t)?($t=Math.sqrt($t)-5,Ct=-27109920616438573e-27,Ct=-2555641816996525e-25+Ct*$t,Ct=15076572693500548e-25+Ct*$t,Ct=-3789465440126737e-24+Ct*$t,Ct=761570120807834e-23+Ct*$t,Ct=-1496002662714924e-23+Ct*$t,Ct=2914795345090108e-23+Ct*$t,Ct=-6771199775845234e-23+Ct*$t,Ct=22900482228026655e-23+Ct*$t,Ct=-99298272942317e-20+Ct*$t,Ct=4526062597223154e-21+Ct*$t,Ct=-1968177810553167e-20+Ct*$t,Ct=7599527703001776e-20+Ct*$t,Ct=-.00021503011930044477+Ct*$t,Ct=-.00013871931833623122+Ct*$t,Ct=1.0103004648645344+Ct*$t,Ct=4.849906401408584+Ct*$t):Ct=1/0,Ct*xt}function gaussian(xt,$t){let Ct,kt;const Mt={mean(Ft){return arguments.length?(Ct=Ft||0,Mt):Ct},stdev(Ft){return arguments.length?(kt=Ft??1,Mt):kt},sample:()=>sampleNormal(Ct,kt),pdf:Ft=>densityNormal(Ft,Ct,kt),cdf:Ft=>cumulativeNormal(Ft,Ct,kt),icdf:Ft=>quantileNormal(Ft,Ct,kt)};return Mt.mean(xt).stdev($t)}function kde(xt,$t){const Ct=gaussian();let kt=0;const Mt={data(Ft){return arguments.length?(xt=Ft,kt=Ft?Ft.length:0,Mt.bandwidth($t)):xt},bandwidth(Ft){return arguments.length?($t=Ft,!$t&&xt&&($t=estimateBandwidth(xt)),Mt):$t},sample(){return xt[~~(random()*kt)]+$t*Ct.sample()},pdf(Ft){let jt=0,Bt=0;for(;Bt<kt;++Bt)jt+=Ct.pdf((Ft-xt[Bt])/$t);return jt/$t/kt},cdf(Ft){let jt=0,Bt=0;for(;Bt<kt;++Bt)jt+=Ct.cdf((Ft-xt[Bt])/$t);return jt/kt},icdf(){throw Error("KDE icdf not supported.")}};return Mt.data(xt)}function sampleLogNormal(xt,$t){return xt=xt||0,$t=$t??1,Math.exp(xt+sampleNormal()*$t)}function densityLogNormal(xt,$t,Ct){if(xt<=0)return 0;$t=$t||0,Ct=Ct??1;const kt=(Math.log(xt)-$t)/Ct;return Math.exp(-.5*kt*kt)/(Ct*SQRT2PI*xt)}function cumulativeLogNormal(xt,$t,Ct){return cumulativeNormal(Math.log(xt),$t,Ct)}function quantileLogNormal(xt,$t,Ct){return Math.exp(quantileNormal(xt,$t,Ct))}function lognormal(xt,$t){let Ct,kt;const Mt={mean(Ft){return arguments.length?(Ct=Ft||0,Mt):Ct},stdev(Ft){return arguments.length?(kt=Ft??1,Mt):kt},sample:()=>sampleLogNormal(Ct,kt),pdf:Ft=>densityLogNormal(Ft,Ct,kt),cdf:Ft=>cumulativeLogNormal(Ft,Ct,kt),icdf:Ft=>quantileLogNormal(Ft,Ct,kt)};return Mt.mean(xt).stdev($t)}function mixture$1(xt,$t){let Ct=0,kt;function Mt(jt){const Bt=[];let Vt=0,zt;for(zt=0;zt<Ct;++zt)Vt+=Bt[zt]=jt[zt]==null?1:+jt[zt];for(zt=0;zt<Ct;++zt)Bt[zt]/=Vt;return Bt}const Ft={weights(jt){return arguments.length?(kt=Mt($t=jt||[]),Ft):$t},distributions(jt){return arguments.length?(jt?(Ct=jt.length,xt=jt):(Ct=0,xt=[]),Ft.weights($t)):xt},sample(){const jt=random();let Bt=xt[Ct-1],Vt=kt[0],zt=0;for(;zt<Ct-1;Vt+=kt[++zt])if(jt<Vt){Bt=xt[zt];break}return Bt.sample()},pdf(jt){let Bt=0,Vt=0;for(;Vt<Ct;++Vt)Bt+=kt[Vt]*xt[Vt].pdf(jt);return Bt},cdf(jt){let Bt=0,Vt=0;for(;Vt<Ct;++Vt)Bt+=kt[Vt]*xt[Vt].cdf(jt);return Bt},icdf(){throw Error("Mixture icdf not supported.")}};return Ft.distributions(xt).weights($t)}function sampleUniform(xt,$t){return $t==null&&($t=xt??1,xt=0),xt+($t-xt)*random()}function densityUniform(xt,$t,Ct){return Ct==null&&(Ct=$t??1,$t=0),xt>=$t&&xt<=Ct?1/(Ct-$t):0}function cumulativeUniform(xt,$t,Ct){return Ct==null&&(Ct=$t??1,$t=0),xt<$t?0:xt>Ct?1:(xt-$t)/(Ct-$t)}function quantileUniform(xt,$t,Ct){return Ct==null&&(Ct=$t??1,$t=0),xt>=0&&xt<=1?$t+xt*(Ct-$t):NaN}function uniform(xt,$t){let Ct,kt;const Mt={min(Ft){return arguments.length?(Ct=Ft||0,Mt):Ct},max(Ft){return arguments.length?(kt=Ft??1,Mt):kt},sample:()=>sampleUniform(Ct,kt),pdf:Ft=>densityUniform(Ft,Ct,kt),cdf:Ft=>cumulativeUniform(Ft,Ct,kt),icdf:Ft=>quantileUniform(Ft,Ct,kt)};return $t==null&&($t=xt??1,xt=0),Mt.min(xt).max($t)}function constant(xt,$t,Ct){let kt=0,Mt=0;for(const Ft of xt){const jt=Ct(Ft);$t(Ft)==null||jt==null||isNaN(jt)||(kt+=(jt-kt)/++Mt)}return{coef:[kt],predict:()=>kt,rSquared:0}}function ols(xt,$t,Ct,kt){const Mt=kt-xt*xt,Ft=Math.abs(Mt)<1e-24?0:(Ct-xt*$t)/Mt;return[$t-Ft*xt,Ft]}function points(xt,$t,Ct,kt){xt=xt.filter(Wt=>{let Yt=$t(Wt),Kt=Ct(Wt);return Yt!=null&&(Yt=+Yt)>=Yt&&Kt!=null&&(Kt=+Kt)>=Kt}),kt&&xt.sort((Wt,Yt)=>$t(Wt)-$t(Yt));const Mt=xt.length,Ft=new Float64Array(Mt),jt=new Float64Array(Mt);let Bt=0,Vt=0,zt=0,Ht,Gt,qt;for(qt of xt)Ft[Bt]=Ht=+$t(qt),jt[Bt]=Gt=+Ct(qt),++Bt,Vt+=(Ht-Vt)/Bt,zt+=(Gt-zt)/Bt;for(Bt=0;Bt<Mt;++Bt)Ft[Bt]-=Vt,jt[Bt]-=zt;return[Ft,jt,Vt,zt]}function visitPoints(xt,$t,Ct,kt){let Mt=-1,Ft,jt;for(const Bt of xt)Ft=$t(Bt),jt=Ct(Bt),Ft!=null&&(Ft=+Ft)>=Ft&&jt!=null&&(jt=+jt)>=jt&&kt(Ft,jt,++Mt)}function rSquared(xt,$t,Ct,kt,Mt){let Ft=0,jt=0;return visitPoints(xt,$t,Ct,(Bt,Vt)=>{const zt=Vt-Mt(Bt),Ht=Vt-kt;Ft+=zt*zt,jt+=Ht*Ht}),1-Ft/jt}function linear(xt,$t,Ct){let kt=0,Mt=0,Ft=0,jt=0,Bt=0;visitPoints(xt,$t,Ct,(Ht,Gt)=>{++Bt,kt+=(Ht-kt)/Bt,Mt+=(Gt-Mt)/Bt,Ft+=(Ht*Gt-Ft)/Bt,jt+=(Ht*Ht-jt)/Bt});const Vt=ols(kt,Mt,Ft,jt),zt=Ht=>Vt[0]+Vt[1]*Ht;return{coef:Vt,predict:zt,rSquared:rSquared(xt,$t,Ct,Mt,zt)}}function log$1(xt,$t,Ct){let kt=0,Mt=0,Ft=0,jt=0,Bt=0;visitPoints(xt,$t,Ct,(Ht,Gt)=>{++Bt,Ht=Math.log(Ht),kt+=(Ht-kt)/Bt,Mt+=(Gt-Mt)/Bt,Ft+=(Ht*Gt-Ft)/Bt,jt+=(Ht*Ht-jt)/Bt});const Vt=ols(kt,Mt,Ft,jt),zt=Ht=>Vt[0]+Vt[1]*Math.log(Ht);return{coef:Vt,predict:zt,rSquared:rSquared(xt,$t,Ct,Mt,zt)}}function exp(xt,$t,Ct){const[kt,Mt,Ft,jt]=points(xt,$t,Ct);let Bt=0,Vt=0,zt=0,Ht=0,Gt=0,qt,Wt,Yt;visitPoints(xt,$t,Ct,(Jt,Zt)=>{qt=kt[Gt++],Wt=Math.log(Zt),Yt=qt*Zt,Bt+=(Zt*Wt-Bt)/Gt,Vt+=(Yt-Vt)/Gt,zt+=(Yt*Wt-zt)/Gt,Ht+=(qt*Yt-Ht)/Gt});const[Kt,Xt]=ols(Vt/jt,Bt/jt,zt/jt,Ht/jt),Qt=Jt=>Math.exp(Kt+Xt*(Jt-Ft));return{coef:[Math.exp(Kt-Xt*Ft),Xt],predict:Qt,rSquared:rSquared(xt,$t,Ct,jt,Qt)}}function pow(xt,$t,Ct){let kt=0,Mt=0,Ft=0,jt=0,Bt=0,Vt=0;visitPoints(xt,$t,Ct,(Gt,qt)=>{const Wt=Math.log(Gt),Yt=Math.log(qt);++Vt,kt+=(Wt-kt)/Vt,Mt+=(Yt-Mt)/Vt,Ft+=(Wt*Yt-Ft)/Vt,jt+=(Wt*Wt-jt)/Vt,Bt+=(qt-Bt)/Vt});const zt=ols(kt,Mt,Ft,jt),Ht=Gt=>zt[0]*Math.pow(Gt,zt[1]);return zt[0]=Math.exp(zt[0]),{coef:zt,predict:Ht,rSquared:rSquared(xt,$t,Ct,Bt,Ht)}}function quad(xt,$t,Ct){const[kt,Mt,Ft,jt]=points(xt,$t,Ct),Bt=kt.length;let Vt=0,zt=0,Ht=0,Gt=0,qt=0,Wt,Yt,Kt,Xt;for(Wt=0;Wt<Bt;)Yt=kt[Wt],Kt=Mt[Wt++],Xt=Yt*Yt,Vt+=(Xt-Vt)/Wt,zt+=(Xt*Yt-zt)/Wt,Ht+=(Xt*Xt-Ht)/Wt,Gt+=(Yt*Kt-Gt)/Wt,qt+=(Xt*Kt-qt)/Wt;const Qt=Ht-Vt*Vt,Jt=Vt*Qt-zt*zt,Zt=(qt*Vt-Gt*zt)/Jt,sn=(Gt*Qt-qt*zt)/Jt,ln=-Zt*Vt,dn=hn=>(hn=hn-Ft,Zt*hn*hn+sn*hn+ln+jt);return{coef:[ln-sn*Ft+Zt*Ft*Ft+jt,sn-2*Zt*Ft,Zt],predict:dn,rSquared:rSquared(xt,$t,Ct,jt,dn)}}function poly(xt,$t,Ct,kt){if(kt===0)return constant(xt,$t,Ct);if(kt===1)return linear(xt,$t,Ct);if(kt===2)return quad(xt,$t,Ct);const[Mt,Ft,jt,Bt]=points(xt,$t,Ct),Vt=Mt.length,zt=[],Ht=[],Gt=kt+1;let qt,Wt,Yt,Kt,Xt;for(qt=0;qt<Gt;++qt){for(Yt=0,Kt=0;Yt<Vt;++Yt)Kt+=Math.pow(Mt[Yt],qt)*Ft[Yt];for(zt.push(Kt),Xt=new Float64Array(Gt),Wt=0;Wt<Gt;++Wt){for(Yt=0,Kt=0;Yt<Vt;++Yt)Kt+=Math.pow(Mt[Yt],qt+Wt);Xt[Wt]=Kt}Ht.push(Xt)}Ht.push(zt);const Qt=gaussianElimination(Ht),Jt=Zt=>{Zt-=jt;let sn=Bt+Qt[0]+Qt[1]*Zt+Qt[2]*Zt*Zt;for(qt=3;qt<Gt;++qt)sn+=Qt[qt]*Math.pow(Zt,qt);return sn};return{coef:uncenter(Gt,Qt,-jt,Bt),predict:Jt,rSquared:rSquared(xt,$t,Ct,Bt,Jt)}}function uncenter(xt,$t,Ct,kt){const Mt=Array(xt);let Ft,jt,Bt,Vt;for(Ft=0;Ft<xt;++Ft)Mt[Ft]=0;for(Ft=xt-1;Ft>=0;--Ft)for(Bt=$t[Ft],Vt=1,Mt[Ft]+=Bt,jt=1;jt<=Ft;++jt)Vt*=(Ft+1-jt)/jt,Mt[Ft-jt]+=Bt*Math.pow(Ct,jt)*Vt;return Mt[0]+=kt,Mt}function gaussianElimination(xt){const $t=xt.length-1,Ct=[];let kt,Mt,Ft,jt,Bt;for(kt=0;kt<$t;++kt){for(jt=kt,Mt=kt+1;Mt<$t;++Mt)Math.abs(xt[kt][Mt])>Math.abs(xt[kt][jt])&&(jt=Mt);for(Ft=kt;Ft<$t+1;++Ft)Bt=xt[Ft][kt],xt[Ft][kt]=xt[Ft][jt],xt[Ft][jt]=Bt;for(Mt=kt+1;Mt<$t;++Mt)for(Ft=$t;Ft>=kt;Ft--)xt[Ft][Mt]-=xt[Ft][kt]*xt[kt][Mt]/xt[kt][kt]}for(Mt=$t-1;Mt>=0;--Mt){for(Bt=0,Ft=Mt+1;Ft<$t;++Ft)Bt+=xt[Ft][Mt]*Ct[Ft];Ct[Mt]=(xt[$t][Mt]-Bt)/xt[Mt][Mt]}return Ct}const maxiters=2,epsilon$1=1e-12;function loess(xt,$t,Ct,kt){const[Mt,Ft,jt,Bt]=points(xt,$t,Ct,!0),Vt=Mt.length,zt=Math.max(2,~~(kt*Vt)),Ht=new Float64Array(Vt),Gt=new Float64Array(Vt),qt=new Float64Array(Vt).fill(1);for(let Wt=-1;++Wt<=maxiters;){const Yt=[0,zt-1];for(let Xt=0;Xt<Vt;++Xt){const Qt=Mt[Xt],Jt=Yt[0],Zt=Yt[1],sn=Qt-Mt[Jt]>Mt[Zt]-Qt?Jt:Zt;let ln=0,dn=0,hn=0,cn=0,pn=0;const yn=1/Math.abs(Mt[sn]-Qt||1);for(let bn=Jt;bn<=Zt;++bn){const xn=Mt[bn],Cn=Ft[bn],$n=tricube(Math.abs(Qt-xn)*yn)*qt[bn],wn=xn*$n;ln+=$n,dn+=wn,hn+=Cn*$n,cn+=Cn*wn,pn+=xn*wn}const[gn,En]=ols(dn/ln,hn/ln,cn/ln,pn/ln);Ht[Xt]=gn+En*Qt,Gt[Xt]=Math.abs(Ft[Xt]-Ht[Xt]),updateInterval(Mt,Xt+1,Yt)}if(Wt===maxiters)break;const Kt=median(Gt);if(Math.abs(Kt)<epsilon$1)break;for(let Xt=0,Qt,Jt;Xt<Vt;++Xt)Qt=Gt[Xt]/(6*Kt),qt[Xt]=Qt>=1?epsilon$1:(Jt=1-Qt*Qt)*Jt}return output$1(Mt,Ht,jt,Bt)}function tricube(xt){return(xt=1-xt*xt*xt)*xt*xt}function updateInterval(xt,$t,Ct){const kt=xt[$t];let Mt=Ct[0],Ft=Ct[1]+1;if(!(Ft>=xt.length))for(;$t>Mt&&xt[Ft]-kt<=kt-xt[Mt];)Ct[0]=++Mt,Ct[1]=Ft,++Ft}function output$1(xt,$t,Ct,kt){const Mt=xt.length,Ft=[];let jt=0,Bt=0,Vt=[],zt;for(;jt<Mt;++jt)zt=xt[jt]+Ct,Vt[0]===zt?Vt[1]+=($t[jt]-Vt[1])/++Bt:(Bt=0,Vt[1]+=kt,Vt=[zt,$t[jt]],Ft.push(Vt));return Vt[1]+=kt,Ft}const MIN_RADIANS=.5*Math.PI/180;function sampleCurve(xt,$t,Ct,kt){Ct=Ct||25,kt=Math.max(Ct,kt||200);const Mt=Kt=>[Kt,xt(Kt)],Ft=$t[0],jt=$t[1],Bt=jt-Ft,Vt=Bt/kt,zt=[Mt(Ft)],Ht=[];if(Ct===kt){for(let Kt=1;Kt<kt;++Kt)zt.push(Mt(Ft+Kt/Ct*Bt));return zt.push(Mt(jt)),zt}else{Ht.push(Mt(jt));for(let Kt=Ct;--Kt>0;)Ht.push(Mt(Ft+Kt/Ct*Bt))}let Gt=zt[0],qt=Ht[Ht.length-1];const Wt=1/Bt,Yt=scaleY(Gt[1],Ht);for(;qt;){const Kt=Mt((Gt[0]+qt[0])/2);Kt[0]-Gt[0]>=Vt&&angleDelta(Gt,Kt,qt,Wt,Yt)>MIN_RADIANS?Ht.push(Kt):(Gt=qt,zt.push(qt),Ht.pop()),qt=Ht[Ht.length-1]}return zt}function scaleY(xt,$t){let Ct=xt,kt=xt;const Mt=$t.length;for(let Ft=0;Ft<Mt;++Ft){const jt=$t[Ft][1];jt<Ct&&(Ct=jt),jt>kt&&(kt=jt)}return 1/(kt-Ct)}function angleDelta(xt,$t,Ct,kt,Mt){const Ft=Math.atan2(Mt*(Ct[1]-xt[1]),kt*(Ct[0]-xt[0])),jt=Math.atan2(Mt*($t[1]-xt[1]),kt*($t[0]-xt[0]));return Math.abs(Ft-jt)}function multikey(xt){return $t=>{const Ct=xt.length;let kt=1,Mt=String(xt[0]($t));for(;kt<Ct;++kt)Mt+="|"+xt[kt]($t);return Mt}}function groupkey(xt){return!xt||!xt.length?function(){return""}:xt.length===1?xt[0]:multikey(xt)}function measureName(xt,$t,Ct){return Ct||xt+($t?"_"+$t:"")}const noop$1=()=>{},base_op={init:noop$1,add:noop$1,rem:noop$1,idx:0},AggregateOps={values:{init:xt=>xt.cell.store=!0,value:xt=>xt.cell.data.values(),idx:-1},count:{value:xt=>xt.cell.num},__count__:{value:xt=>xt.missing+xt.valid},missing:{value:xt=>xt.missing},valid:{value:xt=>xt.valid},sum:{init:xt=>xt.sum=0,value:xt=>xt.valid?xt.sum:void 0,add:(xt,$t)=>xt.sum+=+$t,rem:(xt,$t)=>xt.sum-=$t},product:{init:xt=>xt.product=1,value:xt=>xt.valid?xt.product:void 0,add:(xt,$t)=>xt.product*=$t,rem:(xt,$t)=>xt.product/=$t},mean:{init:xt=>xt.mean=0,value:xt=>xt.valid?xt.mean:void 0,add:(xt,$t)=>(xt.mean_d=$t-xt.mean,xt.mean+=xt.mean_d/xt.valid),rem:(xt,$t)=>(xt.mean_d=$t-xt.mean,xt.mean-=xt.valid?xt.mean_d/xt.valid:xt.mean)},average:{value:xt=>xt.valid?xt.mean:void 0,req:["mean"],idx:1},variance:{init:xt=>xt.dev=0,value:xt=>xt.valid>1?xt.dev/(xt.valid-1):void 0,add:(xt,$t)=>xt.dev+=xt.mean_d*($t-xt.mean),rem:(xt,$t)=>xt.dev-=xt.mean_d*($t-xt.mean),req:["mean"],idx:1},variancep:{value:xt=>xt.valid>1?xt.dev/xt.valid:void 0,req:["variance"],idx:2},stdev:{value:xt=>xt.valid>1?Math.sqrt(xt.dev/(xt.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:xt=>xt.valid>1?Math.sqrt(xt.dev/xt.valid):void 0,req:["variance"],idx:2},stderr:{value:xt=>xt.valid>1?Math.sqrt(xt.dev/(xt.valid*(xt.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:xt=>xt.cell.data.distinct(xt.get),req:["values"],idx:3},ci0:{value:xt=>xt.cell.data.ci0(xt.get),req:["values"],idx:3},ci1:{value:xt=>xt.cell.data.ci1(xt.get),req:["values"],idx:3},median:{value:xt=>xt.cell.data.q2(xt.get),req:["values"],idx:3},q1:{value:xt=>xt.cell.data.q1(xt.get),req:["values"],idx:3},q3:{value:xt=>xt.cell.data.q3(xt.get),req:["values"],idx:3},min:{init:xt=>xt.min=void 0,value:xt=>xt.min=Number.isNaN(xt.min)?xt.cell.data.min(xt.get):xt.min,add:(xt,$t)=>{($t<xt.min||xt.min===void 0)&&(xt.min=$t)},rem:(xt,$t)=>{$t<=xt.min&&(xt.min=NaN)},req:["values"],idx:4},max:{init:xt=>xt.max=void 0,value:xt=>xt.max=Number.isNaN(xt.max)?xt.cell.data.max(xt.get):xt.max,add:(xt,$t)=>{($t>xt.max||xt.max===void 0)&&(xt.max=$t)},rem:(xt,$t)=>{$t>=xt.max&&(xt.max=NaN)},req:["values"],idx:4},argmin:{init:xt=>xt.argmin=void 0,value:xt=>xt.argmin||xt.cell.data.argmin(xt.get),add:(xt,$t,Ct)=>{$t<xt.min&&(xt.argmin=Ct)},rem:(xt,$t)=>{$t<=xt.min&&(xt.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:xt=>xt.argmax=void 0,value:xt=>xt.argmax||xt.cell.data.argmax(xt.get),add:(xt,$t,Ct)=>{$t>xt.max&&(xt.argmax=Ct)},rem:(xt,$t)=>{$t>=xt.max&&(xt.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(xt,$t)=>{xt.exp=0,xt.exp_r=$t},value:xt=>xt.valid?xt.exp*(1-xt.exp_r)/(1-xt.exp_r**xt.valid):void 0,add:(xt,$t)=>xt.exp=xt.exp_r*xt.exp+$t,rem:(xt,$t)=>xt.exp=(xt.exp-$t/xt.exp_r**(xt.valid-1))/xt.exp_r},exponentialb:{value:xt=>xt.valid?xt.exp*(1-xt.exp_r):void 0,req:["exponential"],idx:1}},ValidAggregateOps=Object.keys(AggregateOps).filter(xt=>xt!=="__count__");function measure(xt,$t){return(Ct,kt)=>extend({name:xt,aggregate_param:kt,out:Ct||xt},base_op,$t)}[...ValidAggregateOps,"__count__"].forEach(xt=>{AggregateOps[xt]=measure(xt,AggregateOps[xt])});function createMeasure(xt,$t,Ct){return AggregateOps[xt](Ct,$t)}function compareIndex(xt,$t){return xt.idx-$t.idx}function resolve(xt){const $t={};xt.forEach(kt=>$t[kt.name]=kt);const Ct=kt=>{kt.req&&kt.req.forEach(Mt=>{$t[Mt]||Ct($t[Mt]=AggregateOps[Mt]())})};return xt.forEach(Ct),Object.values($t).sort(compareIndex)}function init(){this.valid=0,this.missing=0,this._ops.forEach(xt=>xt.aggregate_param==null?xt.init(this):xt.init(this,xt.aggregate_param))}function add$2(xt,$t){if(xt==null||xt===""){++this.missing;return}xt===xt&&(++this.valid,this._ops.forEach(Ct=>Ct.add(this,xt,$t)))}function rem(xt,$t){if(xt==null||xt===""){--this.missing;return}xt===xt&&(--this.valid,this._ops.forEach(Ct=>Ct.rem(this,xt,$t)))}function set$3(xt){return this._out.forEach($t=>xt[$t.out]=$t.value(this)),xt}function compileMeasures(xt,$t){const Ct=$t||identity$1,kt=resolve(xt),Mt=xt.slice().sort(compareIndex);function Ft(jt){this._ops=kt,this._out=Mt,this.cell=jt,this.init()}return Ft.prototype.init=init,Ft.prototype.add=add$2,Ft.prototype.rem=rem,Ft.prototype.set=set$3,Ft.prototype.get=Ct,Ft.fields=xt.map(jt=>jt.out),Ft}function TupleStore(xt){this._key=xt?field$1(xt):tupleid,this.reset()}const prototype$1=TupleStore.prototype;prototype$1.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};prototype$1.add=function(xt){this._add.push(xt)};prototype$1.rem=function(xt){this._rem.push(xt)};prototype$1.values=function(){if(this._get=null,this._rem.length===0)return this._add;const xt=this._add,$t=this._rem,Ct=this._key,kt=xt.length,Mt=$t.length,Ft=Array(kt-Mt),jt={};let Bt,Vt,zt;for(Bt=0;Bt<Mt;++Bt)jt[Ct($t[Bt])]=1;for(Bt=0,Vt=0;Bt<kt;++Bt)jt[Ct(zt=xt[Bt])]?jt[Ct(zt)]=0:Ft[Vt++]=zt;return this._rem=[],this._add=Ft};prototype$1.distinct=function(xt){const $t=this.values(),Ct={};let kt=$t.length,Mt=0,Ft;for(;--kt>=0;)Ft=xt($t[kt])+"",has$1(Ct,Ft)||(Ct[Ft]=1,++Mt);return Mt};prototype$1.extent=function(xt){if(this._get!==xt||!this._ext){const $t=this.values(),Ct=extentIndex($t,xt);this._ext=[$t[Ct[0]],$t[Ct[1]]],this._get=xt}return this._ext};prototype$1.argmin=function(xt){return this.extent(xt)[0]||{}};prototype$1.argmax=function(xt){return this.extent(xt)[1]||{}};prototype$1.min=function(xt){const $t=this.extent(xt)[0];return $t!=null?xt($t):void 0};prototype$1.max=function(xt){const $t=this.extent(xt)[1];return $t!=null?xt($t):void 0};prototype$1.quartile=function(xt){return(this._get!==xt||!this._q)&&(this._q=quartiles(this.values(),xt),this._get=xt),this._q};prototype$1.q1=function(xt){return this.quartile(xt)[0]};prototype$1.q2=function(xt){return this.quartile(xt)[1]};prototype$1.q3=function(xt){return this.quartile(xt)[2]};prototype$1.ci=function(xt){return(this._get!==xt||!this._ci)&&(this._ci=bootstrapCI(this.values(),1e3,.05,xt),this._get=xt),this._ci};prototype$1.ci0=function(xt){return this.ci(xt)[0]};prototype$1.ci1=function(xt){return this.ci(xt)[1]};function Aggregate$1(xt){Transform.call(this,null,xt),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Aggregate$1.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ValidAggregateOps},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};inherits(Aggregate$1,Transform,{transform(xt,$t){const Ct=this,kt=$t.fork($t.NO_SOURCE|$t.NO_FIELDS),Mt=xt.modified();return Ct.stamp=kt.stamp,Ct.value&&(Mt||$t.modified(Ct._inputs,!0))?(Ct._prev=Ct.value,Ct.value=Mt?Ct.init(xt):Object.create(null),$t.visit($t.SOURCE,Ft=>Ct.add(Ft))):(Ct.value=Ct.value||Ct.init(xt),$t.visit($t.REM,Ft=>Ct.rem(Ft)),$t.visit($t.ADD,Ft=>Ct.add(Ft))),kt.modifies(Ct._outputs),Ct._drop=xt.drop!==!1,xt.cross&&Ct._dims.length>1&&(Ct._drop=!1,Ct.cross()),$t.clean()&&Ct._drop&&kt.clean(!0).runAfter(()=>this.clean()),Ct.changes(kt)},cross(){const xt=this,$t=xt.value,Ct=xt._dnames,kt=Ct.map(()=>({})),Mt=Ct.length;function Ft(Bt){let Vt,zt,Ht,Gt;for(Vt in Bt)for(Ht=Bt[Vt].tuple,zt=0;zt<Mt;++zt)kt[zt][Gt=Ht[Ct[zt]]]=Gt}Ft(xt._prev),Ft($t);function jt(Bt,Vt,zt){const Ht=Ct[zt],Gt=kt[zt++];for(const qt in Gt){const Wt=Bt?Bt+"|"+qt:qt;Vt[Ht]=Gt[qt],zt<Mt?jt(Wt,Vt,zt):$t[Wt]||xt.cell(Wt,Vt)}}jt("",{},0)},init(xt){const $t=this._inputs=[],Ct=this._outputs=[],kt={};function Mt(Jt){const Zt=array$2(accessorFields(Jt)),sn=Zt.length;let ln=0,dn;for(;ln<sn;++ln)kt[dn=Zt[ln]]||(kt[dn]=1,$t.push(dn))}this._dims=array$2(xt.groupby),this._dnames=this._dims.map(Jt=>{const Zt=accessorName(Jt);return Mt(Jt),Ct.push(Zt),Zt}),this.cellkey=xt.key?xt.key:groupkey(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const Ft=xt.fields||[null],jt=xt.ops||["count"],Bt=xt.aggregate_params||[null],Vt=xt.as||[],zt=Ft.length,Ht={};let Gt,qt,Wt,Yt,Kt,Xt,Qt;for(zt!==jt.length&&error("Unmatched number of fields and aggregate ops."),Qt=0;Qt<zt;++Qt){if(Gt=Ft[Qt],qt=jt[Qt],Wt=Bt[Qt]||null,Gt==null&&qt!=="count"&&error("Null aggregate field specified."),Kt=accessorName(Gt),Xt=measureName(qt,Kt,Vt[Qt]),Ct.push(Xt),qt==="count"){this._counts.push(Xt);continue}Yt=Ht[Kt],Yt||(Mt(Gt),Yt=Ht[Kt]=[],Yt.field=Gt,this._measures.push(Yt)),qt!=="count"&&(this._countOnly=!1),Yt.push(createMeasure(qt,Wt,Xt))}return this._measures=this._measures.map(Jt=>compileMeasures(Jt,Jt.field)),Object.create(null)},cellkey:groupkey(),cell(xt,$t){let Ct=this.value[xt];return Ct?Ct.num===0&&this._drop&&Ct.stamp<this.stamp?(Ct.stamp=this.stamp,this._adds[this._alen++]=Ct):Ct.stamp<this.stamp&&(Ct.stamp=this.stamp,this._mods[this._mlen++]=Ct):(Ct=this.value[xt]=this.newcell(xt,$t),this._adds[this._alen++]=Ct),Ct},newcell(xt,$t){const Ct={key:xt,num:0,agg:null,tuple:this.newtuple($t,this._prev&&this._prev[xt]),stamp:this.stamp,store:!1};if(!this._countOnly){const kt=this._measures,Mt=kt.length;Ct.agg=Array(Mt);for(let Ft=0;Ft<Mt;++Ft)Ct.agg[Ft]=new kt[Ft](Ct)}return Ct.store&&(Ct.data=new TupleStore),Ct},newtuple(xt,$t){const Ct=this._dnames,kt=this._dims,Mt=kt.length,Ft={};for(let jt=0;jt<Mt;++jt)Ft[Ct[jt]]=kt[jt](xt);return $t?replace$1($t.tuple,Ft):ingest$1(Ft)},clean(){const xt=this.value;for(const $t in xt)xt[$t].num===0&&delete xt[$t]},add(xt){const $t=this.cellkey(xt),Ct=this.cell($t,xt);if(Ct.num+=1,this._countOnly)return;Ct.store&&Ct.data.add(xt);const kt=Ct.agg;for(let Mt=0,Ft=kt.length;Mt<Ft;++Mt)kt[Mt].add(kt[Mt].get(xt),xt)},rem(xt){const $t=this.cellkey(xt),Ct=this.cell($t,xt);if(Ct.num-=1,this._countOnly)return;Ct.store&&Ct.data.rem(xt);const kt=Ct.agg;for(let Mt=0,Ft=kt.length;Mt<Ft;++Mt)kt[Mt].rem(kt[Mt].get(xt),xt)},celltuple(xt){const $t=xt.tuple,Ct=this._counts;xt.store&&xt.data.values();for(let kt=0,Mt=Ct.length;kt<Mt;++kt)$t[Ct[kt]]=xt.num;if(!this._countOnly){const kt=xt.agg;for(let Mt=0,Ft=kt.length;Mt<Ft;++Mt)kt[Mt].set($t)}return $t},changes(xt){const $t=this._adds,Ct=this._mods,kt=this._prev,Mt=this._drop,Ft=xt.add,jt=xt.rem,Bt=xt.mod;let Vt,zt,Ht,Gt;if(kt)for(zt in kt)Vt=kt[zt],(!Mt||Vt.num)&&jt.push(Vt.tuple);for(Ht=0,Gt=this._alen;Ht<Gt;++Ht)Ft.push(this.celltuple($t[Ht])),$t[Ht]=null;for(Ht=0,Gt=this._mlen;Ht<Gt;++Ht)Vt=Ct[Ht],(Vt.num===0&&Mt?jt:Bt).push(this.celltuple(Vt)),Ct[Ht]=null;return this._alen=this._mlen=0,this._prev=null,xt}});const EPSILON$1=1e-14;function Bin(xt){Transform.call(this,null,xt)}Bin.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};inherits(Bin,Transform,{transform(xt,$t){const Ct=xt.interval!==!1,kt=this._bins(xt),Mt=kt.start,Ft=kt.step,jt=xt.as||["bin0","bin1"],Bt=jt[0],Vt=jt[1];let zt;return xt.modified()?($t=$t.reflow(!0),zt=$t.SOURCE):zt=$t.modified(accessorFields(xt.field))?$t.ADD_MOD:$t.ADD,$t.visit(zt,Ct?Ht=>{const Gt=kt(Ht);Ht[Bt]=Gt,Ht[Vt]=Gt==null?null:Mt+Ft*(1+(Gt-Mt)/Ft)}:Ht=>Ht[Bt]=kt(Ht)),$t.modifies(Ct?jt:Bt)},_bins(xt){if(this.value&&!xt.modified())return this.value;const $t=xt.field,Ct=bin$1(xt),kt=Ct.step;let Mt=Ct.start,Ft=Mt+Math.ceil((Ct.stop-Mt)/kt)*kt,jt,Bt;(jt=xt.anchor)!=null&&(Bt=jt-(Mt+kt*Math.floor((jt-Mt)/kt)),Mt+=Bt,Ft+=Bt);const Vt=function(zt){let Ht=toNumber($t(zt));return Ht==null?null:Ht<Mt?-1/0:Ht>Ft?1/0:(Ht=Math.max(Mt,Math.min(Ht,Ft-kt)),Mt+kt*Math.floor(EPSILON$1+(Ht-Mt)/kt))};return Vt.start=Mt,Vt.stop=Ct.stop,Vt.step=kt,this.value=accessor(Vt,accessorFields($t),xt.name||"bin_"+accessorName($t))}});function SortedList(xt,$t,Ct){const kt=xt;let Mt=$t||[],Ft=Ct||[],jt={},Bt=0;return{add:Vt=>Ft.push(Vt),remove:Vt=>jt[kt(Vt)]=++Bt,size:()=>Mt.length,data:(Vt,zt)=>(Bt&&(Mt=Mt.filter(Ht=>!jt[kt(Ht)]),jt={},Bt=0),zt&&Vt&&Mt.sort(Vt),Ft.length&&(Mt=Vt?merge$2(Vt,Mt,Ft.sort(Vt)):Mt.concat(Ft),Ft=[]),Mt)}}function Collect$1(xt){Transform.call(this,[],xt)}Collect$1.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};inherits(Collect$1,Transform,{transform(xt,$t){const Ct=$t.fork($t.ALL),kt=SortedList(tupleid,this.value,Ct.materialize(Ct.ADD).add),Mt=xt.sort,Ft=$t.changed()||Mt&&(xt.modified("sort")||$t.modified(Mt.fields));return Ct.visit(Ct.REM,kt.remove),this.modified(Ft),this.value=Ct.source=kt.data(stableCompare(Mt),Ft),$t.source&&$t.source.root&&(this.value.root=$t.source.root),Ct}});function Compare$1(xt){Operator.call(this,null,update$5,xt)}inherits(Compare$1,Operator);function update$5(xt){return this.value&&!xt.modified()?this.value:compare$8(xt.fields,xt.orders)}function CountPattern(xt){Transform.call(this,null,xt)}CountPattern.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function tokenize(xt,$t,Ct){switch($t){case"upper":xt=xt.toUpperCase();break;case"lower":xt=xt.toLowerCase();break}return xt.match(Ct)}inherits(CountPattern,Transform,{transform(xt,$t){const Ct=Gt=>qt=>{for(var Wt=tokenize(Bt(qt),xt.case,Ft)||[],Yt,Kt=0,Xt=Wt.length;Kt<Xt;++Kt)jt.test(Yt=Wt[Kt])||Gt(Yt)},kt=this._parameterCheck(xt,$t),Mt=this._counts,Ft=this._match,jt=this._stop,Bt=xt.field,Vt=xt.as||["text","count"],zt=Ct(Gt=>Mt[Gt]=1+(Mt[Gt]||0)),Ht=Ct(Gt=>Mt[Gt]-=1);return kt?$t.visit($t.SOURCE,zt):($t.visit($t.ADD,zt),$t.visit($t.REM,Ht)),this._finish($t,Vt)},_parameterCheck(xt,$t){let Ct=!1;return(xt.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(xt.stopwords||"")+"$","i"),Ct=!0),(xt.modified("pattern")||!this._match)&&(this._match=new RegExp(xt.pattern||"[\\w']+","g"),Ct=!0),(xt.modified("field")||$t.modified(xt.field.fields))&&(Ct=!0),Ct&&(this._counts={}),Ct},_finish(xt,$t){const Ct=this._counts,kt=this._tuples||(this._tuples={}),Mt=$t[0],Ft=$t[1],jt=xt.fork(xt.NO_SOURCE|xt.NO_FIELDS);let Bt,Vt,zt;for(Bt in Ct)Vt=kt[Bt],zt=Ct[Bt]||0,!Vt&&zt?(kt[Bt]=Vt=ingest$1({}),Vt[Mt]=Bt,Vt[Ft]=zt,jt.add.push(Vt)):zt===0?(Vt&&jt.rem.push(Vt),Ct[Bt]=null,kt[Bt]=null):Vt[Ft]!==zt&&(Vt[Ft]=zt,jt.mod.push(Vt));return jt.modifies($t)}});function Cross(xt){Transform.call(this,null,xt)}Cross.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};inherits(Cross,Transform,{transform(xt,$t){const Ct=$t.fork($t.NO_SOURCE),kt=xt.as||["a","b"],Mt=kt[0],Ft=kt[1],jt=!this.value||$t.changed($t.ADD_REM)||xt.modified("as")||xt.modified("filter");let Bt=this.value;return jt?(Bt&&(Ct.rem=Bt),Bt=$t.materialize($t.SOURCE).source,Ct.add=this.value=cross(Bt,Mt,Ft,xt.filter||truthy)):Ct.mod=Bt,Ct.source=this.value,Ct.modifies(kt)}});function cross(xt,$t,Ct,kt){for(var Mt=[],Ft={},jt=xt.length,Bt=0,Vt,zt;Bt<jt;++Bt)for(Ft[$t]=zt=xt[Bt],Vt=0;Vt<jt;++Vt)Ft[Ct]=xt[Vt],kt(Ft)&&(Mt.push(ingest$1(Ft)),Ft={},Ft[$t]=zt);return Mt}const Distributions={kde,mixture:mixture$1,normal:gaussian,lognormal,uniform},DISTRIBUTIONS="distributions",FUNCTION="function",FIELD="field";function parse$4(xt,$t){const Ct=xt[FUNCTION];has$1(Distributions,Ct)||error("Unknown distribution function: "+Ct);const kt=Distributions[Ct]();for(const Mt in xt)Mt===FIELD?kt.data((xt.from||$t()).map(xt[Mt])):Mt===DISTRIBUTIONS?kt[Mt](xt[Mt].map(Ft=>parse$4(Ft,$t))):typeof kt[Mt]===FUNCTION&&kt[Mt](xt[Mt]);return kt}function Density(xt){Transform.call(this,null,xt)}const distributions=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],mixture={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:distributions},{name:"weights",type:"number",array:!0}]};Density.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:distributions.concat(mixture)},{name:"as",type:"string",array:!0,default:["value","density"]}]};inherits(Density,Transform,{transform(xt,$t){const Ct=$t.fork($t.NO_SOURCE|$t.NO_FIELDS);if(!this.value||$t.changed()||xt.modified()){const kt=parse$4(xt.distribution,source$1($t)),Mt=xt.steps||xt.minsteps||25,Ft=xt.steps||xt.maxsteps||200;let jt=xt.method||"pdf";jt!=="pdf"&&jt!=="cdf"&&error("Invalid density method: "+jt),!xt.extent&&!kt.data&&error("Missing density extent parameter."),jt=kt[jt];const Bt=xt.as||["value","density"],Vt=xt.extent||extent(kt.data()),zt=sampleCurve(jt,Vt,Mt,Ft).map(Ht=>{const Gt={};return Gt[Bt[0]]=Ht[0],Gt[Bt[1]]=Ht[1],ingest$1(Gt)});this.value&&(Ct.rem=this.value),this.value=Ct.add=Ct.source=zt}return Ct}});function source$1(xt){return()=>xt.materialize(xt.SOURCE).source}function fieldNames(xt,$t){return xt?xt.map((Ct,kt)=>$t[kt]||accessorName(Ct)):null}function partition$1$1(xt,$t,Ct){const kt=[],Mt=Gt=>Gt(Vt);let Ft,jt,Bt,Vt,zt,Ht;if($t==null)kt.push(xt.map(Ct));else for(Ft={},jt=0,Bt=xt.length;jt<Bt;++jt)Vt=xt[jt],zt=$t.map(Mt),Ht=Ft[zt],Ht||(Ft[zt]=Ht=[],Ht.dims=zt,kt.push(Ht)),Ht.push(Ct(Vt));return kt}const Output$5="bin";function DotBin(xt){Transform.call(this,null,xt)}DotBin.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:Output$5}]};const autostep=(xt,$t)=>span(extent(xt,$t))/30;inherits(DotBin,Transform,{transform(xt,$t){if(this.value&&!(xt.modified()||$t.changed()))return $t;const Ct=$t.materialize($t.SOURCE).source,kt=partition$1$1($t.source,xt.groupby,identity$1),Mt=xt.smooth||!1,Ft=xt.field,jt=xt.step||autostep(Ct,Ft),Bt=stableCompare((Yt,Kt)=>Ft(Yt)-Ft(Kt)),Vt=xt.as||Output$5,zt=kt.length;let Ht=1/0,Gt=-1/0,qt=0,Wt;for(;qt<zt;++qt){const Yt=kt[qt].sort(Bt);Wt=-1;for(const Kt of dotbin(Yt,jt,Mt,Ft))Kt<Ht&&(Ht=Kt),Kt>Gt&&(Gt=Kt),Yt[++Wt][Vt]=Kt}return this.value={start:Ht,stop:Gt,step:jt},$t.reflow(!0).modifies(Vt)}});function Expression$1(xt){Operator.call(this,null,update$4,xt),this.modified(!0)}inherits(Expression$1,Operator);function update$4(xt){const $t=xt.expr;return this.value&&!xt.modified("expr")?this.value:accessor(Ct=>$t(Ct,xt),accessorFields($t),accessorName($t))}function Extent(xt){Transform.call(this,[void 0,void 0],xt)}Extent.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};inherits(Extent,Transform,{transform(xt,$t){const Ct=this.value,kt=xt.field,Mt=$t.changed()||$t.modified(kt.fields)||xt.modified("field");let Ft=Ct[0],jt=Ct[1];if((Mt||Ft==null)&&(Ft=1/0,jt=-1/0),$t.visit(Mt?$t.SOURCE:$t.ADD,Bt=>{const Vt=toNumber(kt(Bt));Vt!=null&&(Vt<Ft&&(Ft=Vt),Vt>jt&&(jt=Vt))}),!Number.isFinite(Ft)||!Number.isFinite(jt)){let Bt=accessorName(kt);Bt&&(Bt=` for field "${Bt}"`),$t.dataflow.warn(`Infinite extent${Bt}: [${Ft}, ${jt}]`),Ft=jt=void 0}this.value=[Ft,jt]}});function Subflow(xt,$t){Operator.call(this,xt),this.parent=$t,this.count=0}inherits(Subflow,Operator,{connect(xt){return this.detachSubflow=xt.detachSubflow,this.targets().add(xt),xt.source=this},add(xt){this.count+=1,this.value.add.push(xt)},rem(xt){this.count-=1,this.value.rem.push(xt)},mod(xt){this.value.mod.push(xt)},init(xt){this.value.init(xt,xt.NO_SOURCE)},evaluate(){return this.value}});function Facet$1(xt){Transform.call(this,{},xt),this._keys=fastmap();const $t=this._targets=[];$t.active=0,$t.forEach=Ct=>{for(let kt=0,Mt=$t.active;kt<Mt;++kt)Ct($t[kt],kt,$t)}}inherits(Facet$1,Transform,{activate(xt){this._targets[this._targets.active++]=xt},subflow(xt,$t,Ct,kt){const Mt=this.value;let Ft=has$1(Mt,xt)&&Mt[xt],jt,Bt;return Ft?Ft.value.stamp<Ct.stamp&&(Ft.init(Ct),this.activate(Ft)):(Bt=kt||(Bt=this._group[xt])&&Bt.tuple,jt=Ct.dataflow,Ft=new Subflow(Ct.fork(Ct.NO_SOURCE),this),jt.add(Ft).connect($t(jt,xt,Bt)),Mt[xt]=Ft,this.activate(Ft)),Ft},clean(){const xt=this.value;let $t=0;for(const Ct in xt)if(xt[Ct].count===0){const kt=xt[Ct].detachSubflow;kt&&kt(),delete xt[Ct],++$t}if($t){const Ct=this._targets.filter(kt=>kt&&kt.count>0);this.initTargets(Ct)}},initTargets(xt){const $t=this._targets,Ct=$t.length,kt=xt?xt.length:0;let Mt=0;for(;Mt<kt;++Mt)$t[Mt]=xt[Mt];for(;Mt<Ct&&$t[Mt]!=null;++Mt)$t[Mt]=null;$t.active=kt},transform(xt,$t){const Ct=$t.dataflow,kt=xt.key,Mt=xt.subflow,Ft=this._keys,jt=xt.modified("key"),Bt=Vt=>this.subflow(Vt,Mt,$t);return this._group=xt.group||{},this.initTargets(),$t.visit($t.REM,Vt=>{const zt=tupleid(Vt),Ht=Ft.get(zt);Ht!==void 0&&(Ft.delete(zt),Bt(Ht).rem(Vt))}),$t.visit($t.ADD,Vt=>{const zt=kt(Vt);Ft.set(tupleid(Vt),zt),Bt(zt).add(Vt)}),jt||$t.modified(kt.fields)?$t.visit($t.MOD,Vt=>{const zt=tupleid(Vt),Ht=Ft.get(zt),Gt=kt(Vt);Ht===Gt?Bt(Gt).mod(Vt):(Ft.set(zt,Gt),Bt(Ht).rem(Vt),Bt(Gt).add(Vt))}):$t.changed($t.MOD)&&$t.visit($t.MOD,Vt=>{Bt(Ft.get(tupleid(Vt))).mod(Vt)}),jt&&$t.visit($t.REFLOW,Vt=>{const zt=tupleid(Vt),Ht=Ft.get(zt),Gt=kt(Vt);Ht!==Gt&&(Ft.set(zt,Gt),Bt(Ht).rem(Vt),Bt(Gt).add(Vt))}),$t.clean()?Ct.runAfter(()=>{this.clean(),Ft.clean()}):Ft.empty>Ct.cleanThreshold&&Ct.runAfter(Ft.clean),$t}});function Field$1(xt){Operator.call(this,null,update$3,xt)}inherits(Field$1,Operator);function update$3(xt){return this.value&&!xt.modified()?this.value:isArray(xt.name)?array$2(xt.name).map($t=>field$1($t)):field$1(xt.name,xt.as)}function Filter(xt){Transform.call(this,fastmap(),xt)}Filter.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};inherits(Filter,Transform,{transform(xt,$t){const Ct=$t.dataflow,kt=this.value,Mt=$t.fork(),Ft=Mt.add,jt=Mt.rem,Bt=Mt.mod,Vt=xt.expr;let zt=!0;$t.visit($t.REM,Gt=>{const qt=tupleid(Gt);kt.has(qt)?kt.delete(qt):jt.push(Gt)}),$t.visit($t.ADD,Gt=>{Vt(Gt,xt)?Ft.push(Gt):kt.set(tupleid(Gt),1)});function Ht(Gt){const qt=tupleid(Gt),Wt=Vt(Gt,xt),Yt=kt.get(qt);Wt&&Yt?(kt.delete(qt),Ft.push(Gt)):!Wt&&!Yt?(kt.set(qt,1),jt.push(Gt)):zt&&Wt&&!Yt&&Bt.push(Gt)}return $t.visit($t.MOD,Ht),xt.modified()&&(zt=!1,$t.visit($t.REFLOW,Ht)),kt.empty>Ct.cleanThreshold&&Ct.runAfter(kt.clean),Mt}});function Flatten(xt){Transform.call(this,[],xt)}Flatten.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};inherits(Flatten,Transform,{transform(xt,$t){const Ct=$t.fork($t.NO_SOURCE),kt=xt.fields,Mt=fieldNames(kt,xt.as||[]),Ft=xt.index||null,jt=Mt.length;return Ct.rem=this.value,$t.visit($t.SOURCE,Bt=>{const Vt=kt.map(Yt=>Yt(Bt)),zt=Vt.reduce((Yt,Kt)=>Math.max(Yt,Kt.length),0);let Ht=0,Gt,qt,Wt;for(;Ht<zt;++Ht){for(qt=derive(Bt),Gt=0;Gt<jt;++Gt)qt[Mt[Gt]]=(Wt=Vt[Gt][Ht])==null?null:Wt;Ft&&(qt[Ft]=Ht),Ct.add.push(qt)}}),this.value=Ct.source=Ct.add,Ft&&Ct.modifies(Ft),Ct.modifies(Mt)}});function Fold(xt){Transform.call(this,[],xt)}Fold.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};inherits(Fold,Transform,{transform(xt,$t){const Ct=$t.fork($t.NO_SOURCE),kt=xt.fields,Mt=kt.map(accessorName),Ft=xt.as||["key","value"],jt=Ft[0],Bt=Ft[1],Vt=kt.length;return Ct.rem=this.value,$t.visit($t.SOURCE,zt=>{for(let Ht=0,Gt;Ht<Vt;++Ht)Gt=derive(zt),Gt[jt]=Mt[Ht],Gt[Bt]=kt[Ht](zt),Ct.add.push(Gt)}),this.value=Ct.source=Ct.add,Ct.modifies(Ft)}});function Formula(xt){Transform.call(this,null,xt)}Formula.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};inherits(Formula,Transform,{transform(xt,$t){const Ct=xt.expr,kt=xt.as,Mt=xt.modified(),Ft=xt.initonly?$t.ADD:Mt?$t.SOURCE:$t.modified(Ct.fields)||$t.modified(kt)?$t.ADD_MOD:$t.ADD;return Mt&&($t=$t.materialize().reflow(!0)),xt.initonly||$t.modifies(kt),$t.visit(Ft,jt=>jt[kt]=Ct(jt,xt))}});function Generate(xt){Transform.call(this,[],xt)}inherits(Generate,Transform,{transform(xt,$t){const Ct=$t.fork($t.ALL),kt=xt.generator;let Mt=this.value,Ft=xt.size-Mt.length,jt,Bt,Vt;if(Ft>0){for(jt=[];--Ft>=0;)jt.push(Vt=ingest$1(kt(xt))),Mt.push(Vt);Ct.add=Ct.add.length?Ct.materialize(Ct.ADD).add.concat(jt):jt}else Bt=Mt.slice(0,-Ft),Ct.rem=Ct.rem.length?Ct.materialize(Ct.REM).rem.concat(Bt):Bt,Mt=Mt.slice(-Ft);return Ct.source=this.value=Mt,Ct}});const Methods$1={value:"value",median,mean,min:min$4,max:max$4},Empty$1=[];function Impute(xt){Transform.call(this,[],xt)}Impute.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function getValue(xt){var $t=xt.method||Methods$1.value,Ct;if(Methods$1[$t]==null)error("Unrecognized imputation method: "+$t);else return $t===Methods$1.value?(Ct=xt.value!==void 0?xt.value:0,()=>Ct):Methods$1[$t]}function getField$1(xt){const $t=xt.field;return Ct=>Ct?$t(Ct):NaN}inherits(Impute,Transform,{transform(xt,$t){var Ct=$t.fork($t.ALL),kt=getValue(xt),Mt=getField$1(xt),Ft=accessorName(xt.field),jt=accessorName(xt.key),Bt=(xt.groupby||[]).map(accessorName),Vt=partition$3($t.source,xt.groupby,xt.key,xt.keyvals),zt=[],Ht=this.value,Gt=Vt.domain.length,qt,Wt,Yt,Kt,Xt,Qt,Jt,Zt,sn,ln;for(Xt=0,Zt=Vt.length;Xt<Zt;++Xt)for(qt=Vt[Xt],Yt=qt.values,Wt=NaN,Jt=0;Jt<Gt;++Jt)if(qt[Jt]==null){for(Kt=Vt.domain[Jt],ln={_impute:!0},Qt=0,sn=Yt.length;Qt<sn;++Qt)ln[Bt[Qt]]=Yt[Qt];ln[jt]=Kt,ln[Ft]=Number.isNaN(Wt)?Wt=kt(qt,Mt):Wt,zt.push(ingest$1(ln))}return zt.length&&(Ct.add=Ct.materialize(Ct.ADD).add.concat(zt)),Ht.length&&(Ct.rem=Ct.materialize(Ct.REM).rem.concat(Ht)),this.value=zt,Ct}});function partition$3(xt,$t,Ct,kt){var Mt=Qt=>Qt(Xt),Ft=[],jt=kt?kt.slice():[],Bt={},Vt={},zt,Ht,Gt,qt,Wt,Yt,Kt,Xt;for(jt.forEach((Qt,Jt)=>Bt[Qt]=Jt+1),qt=0,Kt=xt.length;qt<Kt;++qt)Xt=xt[qt],Yt=Ct(Xt),Wt=Bt[Yt]||(Bt[Yt]=jt.push(Yt)),Ht=(zt=$t?$t.map(Mt):Empty$1)+"",(Gt=Vt[Ht])||(Gt=Vt[Ht]=[],Ft.push(Gt),Gt.values=zt),Gt[Wt-1]=Xt;return Ft.domain=jt,Ft}function JoinAggregate(xt){Aggregate$1.call(this,xt)}JoinAggregate.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:ValidAggregateOps},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};inherits(JoinAggregate,Aggregate$1,{transform(xt,$t){const Ct=this,kt=xt.modified();let Mt;return Ct.value&&(kt||$t.modified(Ct._inputs,!0))?(Mt=Ct.value=kt?Ct.init(xt):{},$t.visit($t.SOURCE,Ft=>Ct.add(Ft))):(Mt=Ct.value=Ct.value||this.init(xt),$t.visit($t.REM,Ft=>Ct.rem(Ft)),$t.visit($t.ADD,Ft=>Ct.add(Ft))),Ct.changes(),$t.visit($t.SOURCE,Ft=>{extend(Ft,Mt[Ct.cellkey(Ft)].tuple)}),$t.reflow(kt).modifies(this._outputs)},changes(){const xt=this._adds,$t=this._mods;let Ct,kt;for(Ct=0,kt=this._alen;Ct<kt;++Ct)this.celltuple(xt[Ct]),xt[Ct]=null;for(Ct=0,kt=this._mlen;Ct<kt;++Ct)this.celltuple($t[Ct]),$t[Ct]=null;this._alen=this._mlen=0}});function KDE(xt){Transform.call(this,null,xt)}KDE.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};inherits(KDE,Transform,{transform(xt,$t){const Ct=$t.fork($t.NO_SOURCE|$t.NO_FIELDS);if(!this.value||$t.changed()||xt.modified()){const kt=$t.materialize($t.SOURCE).source,Mt=partition$1$1(kt,xt.groupby,xt.field),Ft=(xt.groupby||[]).map(accessorName),jt=xt.bandwidth,Bt=xt.cumulative?"cdf":"pdf",Vt=xt.as||["value","density"],zt=[];let Ht=xt.extent,Gt=xt.steps||xt.minsteps||25,qt=xt.steps||xt.maxsteps||200;Bt!=="pdf"&&Bt!=="cdf"&&error("Invalid density method: "+Bt),xt.resolve==="shared"&&(Ht||(Ht=extent(kt,xt.field)),Gt=qt=xt.steps||qt),Mt.forEach(Wt=>{const Yt=kde(Wt,jt)[Bt],Kt=xt.counts?Wt.length:1,Xt=Ht||extent(Wt);sampleCurve(Yt,Xt,Gt,qt).forEach(Qt=>{const Jt={};for(let Zt=0;Zt<Ft.length;++Zt)Jt[Ft[Zt]]=Wt.dims[Zt];Jt[Vt[0]]=Qt[0],Jt[Vt[1]]=Qt[1]*Kt,zt.push(ingest$1(Jt))})}),this.value&&(Ct.rem=this.value),this.value=Ct.add=Ct.source=zt}return Ct}});function Key$1(xt){Operator.call(this,null,update$2,xt)}inherits(Key$1,Operator);function update$2(xt){return this.value&&!xt.modified()?this.value:key(xt.fields,xt.flat)}function Load$1(xt){Transform.call(this,[],xt),this._pending=null}inherits(Load$1,Transform,{transform(xt,$t){const Ct=$t.dataflow;return this._pending?output(this,$t,this._pending):stop(xt)?$t.StopPropagation:xt.values?output(this,$t,Ct.parse(xt.values,xt.format)):xt.async?{async:Ct.request(xt.url,xt.format).then(Mt=>(this._pending=array$2(Mt.data),Ft=>Ft.touch(this)))}:Ct.request(xt.url,xt.format).then(kt=>output(this,$t,array$2(kt.data)))}});function stop(xt){return xt.modified("async")&&!(xt.modified("values")||xt.modified("url")||xt.modified("format"))}function output(xt,$t,Ct){Ct.forEach(ingest$1);const kt=$t.fork($t.NO_FIELDS&$t.NO_SOURCE);return kt.rem=xt.value,xt.value=kt.source=kt.add=Ct,xt._pending=null,kt.rem.length&&kt.clean(!0),kt}function Lookup(xt){Transform.call(this,{},xt)}Lookup.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};inherits(Lookup,Transform,{transform(xt,$t){const Ct=xt.fields,kt=xt.index,Mt=xt.values,Ft=xt.default==null?null:xt.default,jt=xt.modified(),Bt=Ct.length;let Vt=jt?$t.SOURCE:$t.ADD,zt=$t,Ht=xt.as,Gt,qt,Wt;return Mt?(qt=Mt.length,Bt>1&&!Ht&&error('Multi-field lookup requires explicit "as" parameter.'),Ht&&Ht.length!==Bt*qt&&error('The "as" parameter has too few output field names.'),Ht=Ht||Mt.map(accessorName),Gt=function(Yt){for(var Kt=0,Xt=0,Qt,Jt;Kt<Bt;++Kt)if(Jt=kt.get(Ct[Kt](Yt)),Jt==null)for(Qt=0;Qt<qt;++Qt,++Xt)Yt[Ht[Xt]]=Ft;else for(Qt=0;Qt<qt;++Qt,++Xt)Yt[Ht[Xt]]=Mt[Qt](Jt)}):(Ht||error("Missing output field names."),Gt=function(Yt){for(var Kt=0,Xt;Kt<Bt;++Kt)Xt=kt.get(Ct[Kt](Yt)),Yt[Ht[Kt]]=Xt??Ft}),jt?zt=$t.reflow(!0):(Wt=Ct.some(Yt=>$t.modified(Yt.fields)),Vt|=Wt?$t.MOD:0),$t.visit(Vt,Gt),zt.modifies(Ht)}});function MultiExtent$1(xt){Operator.call(this,null,update$1,xt)}inherits(MultiExtent$1,Operator);function update$1(xt){if(this.value&&!xt.modified())return this.value;const $t=xt.extents,Ct=$t.length;let kt=1/0,Mt=-1/0,Ft,jt;for(Ft=0;Ft<Ct;++Ft)jt=$t[Ft],jt[0]<kt&&(kt=jt[0]),jt[1]>Mt&&(Mt=jt[1]);return[kt,Mt]}function MultiValues$1(xt){Operator.call(this,null,update,xt)}inherits(MultiValues$1,Operator);function update(xt){return this.value&&!xt.modified()?this.value:xt.values.reduce(($t,Ct)=>$t.concat(Ct),[])}function Params$2(xt){Transform.call(this,null,xt)}inherits(Params$2,Transform,{transform(xt,$t){return this.modified(xt.modified()),this.value=xt,$t.fork($t.NO_SOURCE|$t.NO_FIELDS)}});function Pivot(xt){Aggregate$1.call(this,xt)}Pivot.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:ValidAggregateOps,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};inherits(Pivot,Aggregate$1,{_transform:Aggregate$1.prototype.transform,transform(xt,$t){return this._transform(aggregateParams(xt,$t),$t)}});function aggregateParams(xt,$t){const Ct=xt.field,kt=xt.value,Mt=(xt.op==="count"?"__count__":xt.op)||"sum",Ft=accessorFields(Ct).concat(accessorFields(kt)),jt=pivotKeys(Ct,xt.limit||0,$t);return $t.changed()&&xt.set("__pivot__",null,null,!0),{key:xt.key,groupby:xt.groupby,ops:jt.map(()=>Mt),fields:jt.map(Bt=>get$4(Bt,Ct,kt,Ft)),as:jt.map(Bt=>Bt+""),modified:xt.modified.bind(xt)}}function get$4(xt,$t,Ct,kt){return accessor(Mt=>$t(Mt)===xt?Ct(Mt):NaN,kt,xt+"")}function pivotKeys(xt,$t,Ct){const kt={},Mt=[];return Ct.visit(Ct.SOURCE,Ft=>{const jt=xt(Ft);kt[jt]||(kt[jt]=1,Mt.push(jt))}),Mt.sort(ascending$1),$t?Mt.slice(0,$t):Mt}function PreFacet$1(xt){Facet$1.call(this,xt)}inherits(PreFacet$1,Facet$1,{transform(xt,$t){const Ct=xt.subflow,kt=xt.field,Mt=Ft=>this.subflow(tupleid(Ft),Ct,$t,Ft);return(xt.modified("field")||kt&&$t.modified(accessorFields(kt)))&&error("PreFacet does not support field modification."),this.initTargets(),kt?($t.visit($t.MOD,Ft=>{const jt=Mt(Ft);kt(Ft).forEach(Bt=>jt.mod(Bt))}),$t.visit($t.ADD,Ft=>{const jt=Mt(Ft);kt(Ft).forEach(Bt=>jt.add(ingest$1(Bt)))}),$t.visit($t.REM,Ft=>{const jt=Mt(Ft);kt(Ft).forEach(Bt=>jt.rem(Bt))})):($t.visit($t.MOD,Ft=>Mt(Ft).mod(Ft)),$t.visit($t.ADD,Ft=>Mt(Ft).add(Ft)),$t.visit($t.REM,Ft=>Mt(Ft).rem(Ft))),$t.clean()&&$t.runAfter(()=>this.clean()),$t}});function Project(xt){Transform.call(this,null,xt)}Project.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};inherits(Project,Transform,{transform(xt,$t){const Ct=$t.fork($t.NO_SOURCE),kt=xt.fields,Mt=fieldNames(xt.fields,xt.as||[]),Ft=kt?(Bt,Vt)=>project$1(Bt,Vt,kt,Mt):rederive;let jt;return this.value?jt=this.value:($t=$t.addAll(),jt=this.value={}),$t.visit($t.REM,Bt=>{const Vt=tupleid(Bt);Ct.rem.push(jt[Vt]),jt[Vt]=null}),$t.visit($t.ADD,Bt=>{const Vt=Ft(Bt,ingest$1({}));jt[tupleid(Bt)]=Vt,Ct.add.push(Vt)}),$t.visit($t.MOD,Bt=>{Ct.mod.push(Ft(Bt,jt[tupleid(Bt)]))}),Ct}});function project$1(xt,$t,Ct,kt){for(let Mt=0,Ft=Ct.length;Mt<Ft;++Mt)$t[kt[Mt]]=Ct[Mt](xt);return $t}function Proxy$2(xt){Transform.call(this,null,xt)}inherits(Proxy$2,Transform,{transform(xt,$t){return this.value=xt.value,xt.modified("value")?$t.fork($t.NO_SOURCE|$t.NO_FIELDS):$t.StopPropagation}});function Quantile$1(xt){Transform.call(this,null,xt)}Quantile$1.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const EPSILON=1e-14;inherits(Quantile$1,Transform,{transform(xt,$t){const Ct=$t.fork($t.NO_SOURCE|$t.NO_FIELDS),kt=xt.as||["prob","value"];if(this.value&&!xt.modified()&&!$t.changed())return Ct.source=this.value,Ct;const Mt=$t.materialize($t.SOURCE).source,Ft=partition$1$1(Mt,xt.groupby,xt.field),jt=(xt.groupby||[]).map(accessorName),Bt=[],Vt=xt.step||.01,zt=xt.probs||range$6(Vt/2,1-EPSILON,Vt),Ht=zt.length;return Ft.forEach(Gt=>{const qt=quantiles(Gt,zt);for(let Wt=0;Wt<Ht;++Wt){const Yt={};for(let Kt=0;Kt<jt.length;++Kt)Yt[jt[Kt]]=Gt.dims[Kt];Yt[kt[0]]=zt[Wt],Yt[kt[1]]=qt[Wt],Bt.push(ingest$1(Yt))}}),this.value&&(Ct.rem=this.value),this.value=Ct.add=Ct.source=Bt,Ct}});function Relay$1(xt){Transform.call(this,null,xt)}inherits(Relay$1,Transform,{transform(xt,$t){let Ct,kt;return this.value?kt=this.value:(Ct=$t=$t.addAll(),kt=this.value={}),xt.derive&&(Ct=$t.fork($t.NO_SOURCE),$t.visit($t.REM,Mt=>{const Ft=tupleid(Mt);Ct.rem.push(kt[Ft]),kt[Ft]=null}),$t.visit($t.ADD,Mt=>{const Ft=derive(Mt);kt[tupleid(Mt)]=Ft,Ct.add.push(Ft)}),$t.visit($t.MOD,Mt=>{const Ft=kt[tupleid(Mt)];for(const jt in Mt)Ft[jt]=Mt[jt],Ct.modifies(jt);Ct.mod.push(Ft)})),Ct}});function Sample(xt){Transform.call(this,[],xt),this.count=0}Sample.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};inherits(Sample,Transform,{transform(xt,$t){const Ct=$t.fork($t.NO_SOURCE),kt=xt.modified("size"),Mt=xt.size,Ft=this.value.reduce((Ht,Gt)=>(Ht[tupleid(Gt)]=1,Ht),{});let jt=this.value,Bt=this.count,Vt=0;function zt(Ht){let Gt,qt;jt.length<Mt?jt.push(Ht):(qt=~~((Bt+1)*random()),qt<jt.length&&qt>=Vt&&(Gt=jt[qt],Ft[tupleid(Gt)]&&Ct.rem.push(Gt),jt[qt]=Ht)),++Bt}if($t.rem.length&&($t.visit($t.REM,Ht=>{const Gt=tupleid(Ht);Ft[Gt]&&(Ft[Gt]=-1,Ct.rem.push(Ht)),--Bt}),jt=jt.filter(Ht=>Ft[tupleid(Ht)]!==-1)),($t.rem.length||kt)&&jt.length<Mt&&$t.source&&(Vt=Bt=jt.length,$t.visit($t.SOURCE,Ht=>{Ft[tupleid(Ht)]||zt(Ht)}),Vt=-1),kt&&jt.length>Mt){const Ht=jt.length-Mt;for(let Gt=0;Gt<Ht;++Gt)Ft[tupleid(jt[Gt])]=-1,Ct.rem.push(jt[Gt]);jt=jt.slice(Ht)}return $t.mod.length&&$t.visit($t.MOD,Ht=>{Ft[tupleid(Ht)]&&Ct.mod.push(Ht)}),$t.add.length&&$t.visit($t.ADD,zt),($t.add.length||Vt<0)&&(Ct.add=jt.filter(Ht=>!Ft[tupleid(Ht)])),this.count=Bt,this.value=Ct.source=jt,Ct}});function Sequence(xt){Transform.call(this,null,xt)}Sequence.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};inherits(Sequence,Transform,{transform(xt,$t){if(this.value&&!xt.modified())return;const Ct=$t.materialize().fork($t.MOD),kt=xt.as||"data";return Ct.rem=this.value?$t.rem.concat(this.value):$t.rem,this.value=range$6(xt.start,xt.stop,xt.step||1).map(Mt=>{const Ft={};return Ft[kt]=Mt,ingest$1(Ft)}),Ct.add=$t.add.concat(this.value),Ct}});function Sieve$1(xt){Transform.call(this,null,xt),this.modified(!0)}inherits(Sieve$1,Transform,{transform(xt,$t){return this.value=$t.source,$t.changed()?$t.fork($t.NO_SOURCE|$t.NO_FIELDS):$t.StopPropagation}});function TimeUnit(xt){Transform.call(this,null,xt)}const OUTPUT=["unit0","unit1"];TimeUnit.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:TIME_UNITS,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:OUTPUT}]};inherits(TimeUnit,Transform,{transform(xt,$t){const Ct=xt.field,kt=xt.interval!==!1,Mt=xt.timezone==="utc",Ft=this._floor(xt,$t),jt=(Mt?utcInterval:timeInterval)(Ft.unit).offset,Bt=xt.as||OUTPUT,Vt=Bt[0],zt=Bt[1],Ht=Ft.step;let Gt=Ft.start||1/0,qt=Ft.stop||-1/0,Wt=$t.ADD;return(xt.modified()||$t.changed($t.REM)||$t.modified(accessorFields(Ct)))&&($t=$t.reflow(!0),Wt=$t.SOURCE,Gt=1/0,qt=-1/0),$t.visit(Wt,Yt=>{const Kt=Ct(Yt);let Xt,Qt;Kt==null?(Yt[Vt]=null,kt&&(Yt[zt]=null)):(Yt[Vt]=Xt=Qt=Ft(Kt),kt&&(Yt[zt]=Qt=jt(Xt,Ht)),Xt<Gt&&(Gt=Xt),Qt>qt&&(qt=Qt))}),Ft.start=Gt,Ft.stop=qt,$t.modifies(kt?Bt:Vt)},_floor(xt,$t){const Ct=xt.timezone==="utc",{units:kt,step:Mt}=xt.units?{units:xt.units,step:xt.step||1}:bin$2({extent:xt.extent||extent($t.materialize($t.SOURCE).source,xt.field),maxbins:xt.maxbins}),Ft=timeUnits(kt),jt=this.value||{},Bt=(Ct?utcFloor:timeFloor)(Ft,Mt);return Bt.unit=peek$1(Ft),Bt.units=Ft,Bt.step=Mt,Bt.start=jt.start,Bt.stop=jt.stop,this.value=Bt}});function TupleIndex(xt){Transform.call(this,fastmap(),xt)}inherits(TupleIndex,Transform,{transform(xt,$t){const Ct=$t.dataflow,kt=xt.field,Mt=this.value,Ft=Bt=>Mt.set(kt(Bt),Bt);let jt=!0;return xt.modified("field")||$t.modified(kt.fields)?(Mt.clear(),$t.visit($t.SOURCE,Ft)):$t.changed()?($t.visit($t.REM,Bt=>Mt.delete(kt(Bt))),$t.visit($t.ADD,Ft)):jt=!1,this.modified(jt),Mt.empty>Ct.cleanThreshold&&Ct.runAfter(Mt.clean),$t.fork()}});function Values$1(xt){Transform.call(this,null,xt)}inherits(Values$1,Transform,{transform(xt,$t){(!this.value||xt.modified("field")||xt.modified("sort")||$t.changed()||xt.sort&&$t.modified(xt.sort.fields))&&(this.value=(xt.sort?$t.source.slice().sort(stableCompare(xt.sort)):$t.source).map(xt.field))}});function WindowOp(xt,$t,Ct,kt){const Mt=WindowOps[xt]($t,Ct);return{init:Mt.init||zero$2,update:function(Ft,jt){jt[kt]=Mt.next(Ft)}}}const WindowOps={row_number:function(){return{next:xt=>xt.index+1}},rank:function(){let xt;return{init:()=>xt=1,next:$t=>{const Ct=$t.index,kt=$t.data;return Ct&&$t.compare(kt[Ct-1],kt[Ct])?xt=Ct+1:xt}}},dense_rank:function(){let xt;return{init:()=>xt=1,next:$t=>{const Ct=$t.index,kt=$t.data;return Ct&&$t.compare(kt[Ct-1],kt[Ct])?++xt:xt}}},percent_rank:function(){const xt=WindowOps.rank(),$t=xt.next;return{init:xt.init,next:Ct=>($t(Ct)-1)/(Ct.data.length-1)}},cume_dist:function(){let xt;return{init:()=>xt=0,next:$t=>{const Ct=$t.data,kt=$t.compare;let Mt=$t.index;if(xt<Mt){for(;Mt+1<Ct.length&&!kt(Ct[Mt],Ct[Mt+1]);)++Mt;xt=Mt}return(1+xt)/Ct.length}}},ntile:function(xt,$t){$t=+$t,$t>0||error("ntile num must be greater than zero.");const Ct=WindowOps.cume_dist(),kt=Ct.next;return{init:Ct.init,next:Mt=>Math.ceil($t*kt(Mt))}},lag:function(xt,$t){return $t=+$t||1,{next:Ct=>{const kt=Ct.index-$t;return kt>=0?xt(Ct.data[kt]):null}}},lead:function(xt,$t){return $t=+$t||1,{next:Ct=>{const kt=Ct.index+$t,Mt=Ct.data;return kt<Mt.length?xt(Mt[kt]):null}}},first_value:function(xt){return{next:$t=>xt($t.data[$t.i0])}},last_value:function(xt){return{next:$t=>xt($t.data[$t.i1-1])}},nth_value:function(xt,$t){return $t=+$t,$t>0||error("nth_value nth must be greater than zero."),{next:Ct=>{const kt=Ct.i0+($t-1);return kt<Ct.i1?xt(Ct.data[kt]):null}}},prev_value:function(xt){let $t;return{init:()=>$t=null,next:Ct=>{const kt=xt(Ct.data[Ct.index]);return kt!=null?$t=kt:$t}}},next_value:function(xt){let $t,Ct;return{init:()=>($t=null,Ct=-1),next:kt=>{const Mt=kt.data;return kt.index<=Ct?$t:(Ct=find$1(xt,Mt,kt.index))<0?(Ct=Mt.length,$t=null):$t=xt(Mt[Ct])}}}};function find$1(xt,$t,Ct){for(let kt=$t.length;Ct<kt;++Ct)if(xt($t[Ct])!=null)return Ct;return-1}const ValidWindowOps=Object.keys(WindowOps);function WindowState(xt){const $t=array$2(xt.ops),Ct=array$2(xt.fields),kt=array$2(xt.params),Mt=array$2(xt.aggregate_params),Ft=array$2(xt.as),jt=this.outputs=[],Bt=this.windows=[],Vt={},zt={},Ht=[],Gt=[];let qt=!0;function Wt(Yt){array$2(accessorFields(Yt)).forEach(Kt=>Vt[Kt]=1)}Wt(xt.sort),$t.forEach((Yt,Kt)=>{const Xt=Ct[Kt],Qt=kt[Kt],Jt=Mt[Kt]||null,Zt=accessorName(Xt),sn=measureName(Yt,Zt,Ft[Kt]);if(Wt(Xt),jt.push(sn),has$1(WindowOps,Yt))Bt.push(WindowOp(Yt,Xt,Qt,sn));else{if(Xt==null&&Yt!=="count"&&error("Null aggregate field specified."),Yt==="count"){Ht.push(sn);return}qt=!1;let ln=zt[Zt];ln||(ln=zt[Zt]=[],ln.field=Xt,Gt.push(ln)),ln.push(createMeasure(Yt,Jt,sn))}}),(Ht.length||Gt.length)&&(this.cell=cell(Gt,Ht,qt)),this.inputs=Object.keys(Vt)}const prototype=WindowState.prototype;prototype.init=function(){this.windows.forEach(xt=>xt.init()),this.cell&&this.cell.init()};prototype.update=function(xt,$t){const Ct=this.cell,kt=this.windows,Mt=xt.data,Ft=kt&&kt.length;let jt;if(Ct){for(jt=xt.p0;jt<xt.i0;++jt)Ct.rem(Mt[jt]);for(jt=xt.p1;jt<xt.i1;++jt)Ct.add(Mt[jt]);Ct.set($t)}for(jt=0;jt<Ft;++jt)kt[jt].update(xt,$t)};function cell(xt,$t,Ct){xt=xt.map(Vt=>compileMeasures(Vt,Vt.field));const kt={num:0,agg:null,store:!1,count:$t};if(!Ct)for(var Mt=xt.length,Ft=kt.agg=Array(Mt),jt=0;jt<Mt;++jt)Ft[jt]=new xt[jt](kt);if(kt.store)var Bt=kt.data=new TupleStore;return kt.add=function(Vt){if(kt.num+=1,!Ct){Bt&&Bt.add(Vt);for(let zt=0;zt<Mt;++zt)Ft[zt].add(Ft[zt].get(Vt),Vt)}},kt.rem=function(Vt){if(kt.num-=1,!Ct){Bt&&Bt.rem(Vt);for(let zt=0;zt<Mt;++zt)Ft[zt].rem(Ft[zt].get(Vt),Vt)}},kt.set=function(Vt){let zt,Ht;for(Bt&&Bt.values(),zt=0,Ht=$t.length;zt<Ht;++zt)Vt[$t[zt]]=kt.num;if(!Ct)for(zt=0,Ht=Ft.length;zt<Ht;++zt)Ft[zt].set(Vt)},kt.init=function(){kt.num=0,Bt&&Bt.reset();for(let Vt=0;Vt<Mt;++Vt)Ft[Vt].init()},kt}function Window(xt){Transform.call(this,{},xt),this._mlen=0,this._mods=[]}Window.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ValidWindowOps.concat(ValidAggregateOps)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};inherits(Window,Transform,{transform(xt,$t){this.stamp=$t.stamp;const Ct=xt.modified(),kt=stableCompare(xt.sort),Mt=groupkey(xt.groupby),Ft=Bt=>this.group(Mt(Bt));let jt=this.state;(!jt||Ct)&&(jt=this.state=new WindowState(xt)),Ct||$t.modified(jt.inputs)?(this.value={},$t.visit($t.SOURCE,Bt=>Ft(Bt).add(Bt))):($t.visit($t.REM,Bt=>Ft(Bt).remove(Bt)),$t.visit($t.ADD,Bt=>Ft(Bt).add(Bt)));for(let Bt=0,Vt=this._mlen;Bt<Vt;++Bt)processPartition(this._mods[Bt],jt,kt,xt);return this._mlen=0,this._mods=[],$t.reflow(Ct).modifies(jt.outputs)},group(xt){let $t=this.value[xt];return $t||($t=this.value[xt]=SortedList(tupleid),$t.stamp=-1),$t.stamp<this.stamp&&($t.stamp=this.stamp,this._mods[this._mlen++]=$t),$t}});function processPartition(xt,$t,Ct,kt){const Mt=kt.sort,Ft=Mt&&!kt.ignorePeers,jt=kt.frame||[null,0],Bt=xt.data(Ct),Vt=Bt.length,zt=Ft?bisector$1(Mt):null,Ht={i0:0,i1:0,p0:0,p1:0,index:0,data:Bt,compare:Mt||constant$1(-1)};$t.init();for(let Gt=0;Gt<Vt;++Gt)setWindow(Ht,jt,Gt,Vt),Ft&&adjustRange(Ht,zt),$t.update(Ht,Bt[Gt])}function setWindow(xt,$t,Ct,kt){xt.p0=xt.i0,xt.p1=xt.i1,xt.i0=$t[0]==null?0:Math.max(0,Ct-Math.abs($t[0])),xt.i1=$t[1]==null?kt:Math.min(kt,Ct+Math.abs($t[1])+1),xt.index=Ct}function adjustRange(xt,$t){const Ct=xt.i0,kt=xt.i1-1,Mt=xt.compare,Ft=xt.data,jt=Ft.length-1;Ct>0&&!Mt(Ft[Ct],Ft[Ct-1])&&(xt.i0=$t.left(Ft,Ft[Ct])),kt<jt&&!Mt(Ft[kt],Ft[kt+1])&&(xt.i1=$t.right(Ft,Ft[kt]))}const tx=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Aggregate$1,bin:Bin,collect:Collect$1,compare:Compare$1,countpattern:CountPattern,cross:Cross,density:Density,dotbin:DotBin,expression:Expression$1,extent:Extent,facet:Facet$1,field:Field$1,filter:Filter,flatten:Flatten,fold:Fold,formula:Formula,generate:Generate,impute:Impute,joinaggregate:JoinAggregate,kde:KDE,key:Key$1,load:Load$1,lookup:Lookup,multiextent:MultiExtent$1,multivalues:MultiValues$1,params:Params$2,pivot:Pivot,prefacet:PreFacet$1,project:Project,proxy:Proxy$2,quantile:Quantile$1,relay:Relay$1,sample:Sample,sequence:Sequence,sieve:Sieve$1,subflow:Subflow,timeunit:TimeUnit,tupleindex:TupleIndex,values:Values$1,window:Window},Symbol.toStringTag,{value:"Module"}));function domCanvas(xt,$t){if(typeof document<"u"&&document.createElement){const Ct=document.createElement("canvas");if(Ct&&Ct.getContext)return Ct.width=xt,Ct.height=$t,Ct}return null}const domImage=()=>typeof Image<"u"?Image:null;function bandSpace(xt,$t,Ct){const kt=xt-$t+Ct*2;return xt?kt>0?kt:1:0}const Identity="identity",Linear="linear",Log="log",Pow="pow",Sqrt="sqrt",Symlog="symlog",Time="time",UTC="utc",Sequential="sequential",Diverging="diverging",Quantile="quantile",Quantize="quantize",Threshold="threshold",Ordinal="ordinal",Point="point",Band="band",BinOrdinal="bin-ordinal",Continuous="continuous",Discrete$1="discrete",Discretizing="discretizing",Interpolating="interpolating",Temporal="temporal";function invertRange(xt){return function($t){let Ct=$t[0],kt=$t[1],Mt;return kt<Ct&&(Mt=Ct,Ct=kt,kt=Mt),[xt.invert(Ct),xt.invert(kt)]}}function invertRangeExtent(xt){return function($t){const Ct=xt.range();let kt=$t[0],Mt=$t[1],Ft=-1,jt,Bt,Vt,zt;for(Mt<kt&&(Bt=kt,kt=Mt,Mt=Bt),Vt=0,zt=Ct.length;Vt<zt;++Vt)Ct[Vt]>=kt&&Ct[Vt]<=Mt&&(Ft<0&&(Ft=Vt),jt=Vt);if(!(Ft<0))return kt=xt.invertExtent(Ct[Ft]),Mt=xt.invertExtent(Ct[jt]),[kt[0]===void 0?kt[1]:kt[0],Mt[1]===void 0?Mt[0]:Mt[1]]}}function band(){const xt=ordinal().unknown(void 0),$t=xt.domain,Ct=xt.range;let kt=[0,1],Mt,Ft,jt=!1,Bt=0,Vt=0,zt=.5;delete xt.unknown;function Ht(){const Gt=$t().length,qt=kt[1]<kt[0],Wt=kt[1-qt],Yt=bandSpace(Gt,Bt,Vt);let Kt=kt[qt-0];Mt=(Wt-Kt)/(Yt||1),jt&&(Mt=Math.floor(Mt)),Kt+=(Wt-Kt-Mt*(Gt-Bt))*zt,Ft=Mt*(1-Bt),jt&&(Kt=Math.round(Kt),Ft=Math.round(Ft));const Xt=range$6(Gt).map(Qt=>Kt+Mt*Qt);return Ct(qt?Xt.reverse():Xt)}return xt.domain=function(Gt){return arguments.length?($t(Gt),Ht()):$t()},xt.range=function(Gt){return arguments.length?(kt=[+Gt[0],+Gt[1]],Ht()):kt.slice()},xt.rangeRound=function(Gt){return kt=[+Gt[0],+Gt[1]],jt=!0,Ht()},xt.bandwidth=function(){return Ft},xt.step=function(){return Mt},xt.round=function(Gt){return arguments.length?(jt=!!Gt,Ht()):jt},xt.padding=function(Gt){return arguments.length?(Vt=Math.max(0,Math.min(1,Gt)),Bt=Vt,Ht()):Bt},xt.paddingInner=function(Gt){return arguments.length?(Bt=Math.max(0,Math.min(1,Gt)),Ht()):Bt},xt.paddingOuter=function(Gt){return arguments.length?(Vt=Math.max(0,Math.min(1,Gt)),Ht()):Vt},xt.align=function(Gt){return arguments.length?(zt=Math.max(0,Math.min(1,Gt)),Ht()):zt},xt.invertRange=function(Gt){if(Gt[0]==null||Gt[1]==null)return;const qt=kt[1]<kt[0],Wt=qt?Ct().reverse():Ct(),Yt=Wt.length-1;let Kt=+Gt[0],Xt=+Gt[1],Qt,Jt,Zt;if(!(Kt!==Kt||Xt!==Xt)&&(Xt<Kt&&(Zt=Kt,Kt=Xt,Xt=Zt),!(Xt<Wt[0]||Kt>kt[1-qt])))return Qt=Math.max(0,bisectRight$1(Wt,Kt)-1),Jt=Kt===Xt?Qt:bisectRight$1(Wt,Xt)-1,Kt-Wt[Qt]>Ft+1e-10&&++Qt,qt&&(Zt=Qt,Qt=Yt-Jt,Jt=Yt-Zt),Qt>Jt?void 0:$t().slice(Qt,Jt+1)},xt.invert=function(Gt){const qt=xt.invertRange([Gt,Gt]);return qt&&qt[0]},xt.copy=function(){return band().domain($t()).range(kt).round(jt).paddingInner(Bt).paddingOuter(Vt).align(zt)},Ht()}function pointish(xt){const $t=xt.copy;return xt.padding=xt.paddingOuter,delete xt.paddingInner,xt.copy=function(){return pointish($t())},xt}function point$3(){return pointish(band().paddingInner(1))}var map=Array.prototype.map;function numbers(xt){return map.call(xt,toNumber)}const slice$2=Array.prototype.slice;function scaleBinOrdinal(){let xt=[],$t=[];function Ct(kt){return kt==null||kt!==kt?void 0:$t[(bisectRight$1(xt,kt)-1)%$t.length]}return Ct.domain=function(kt){return arguments.length?(xt=numbers(kt),Ct):xt.slice()},Ct.range=function(kt){return arguments.length?($t=slice$2.call(kt),Ct):$t.slice()},Ct.tickFormat=function(kt,Mt){return tickFormat$1(xt[0],peek$1(xt),kt??10,Mt)},Ct.copy=function(){return scaleBinOrdinal().domain(Ct.domain()).range(Ct.range())},Ct}const scales=new Map,VEGA_SCALE=Symbol("vega_scale");function registerScale(xt){return xt[VEGA_SCALE]=!0,xt}function isRegisteredScale(xt){return xt&&xt[VEGA_SCALE]===!0}function create$2(xt,$t,Ct){const kt=function(){const Ft=$t();return Ft.invertRange||(Ft.invertRange=Ft.invert?invertRange(Ft):Ft.invertExtent?invertRangeExtent(Ft):void 0),Ft.type=xt,registerScale(Ft)};return kt.metadata=toSet(array$2(Ct)),kt}function scale$4(xt,$t,Ct){return arguments.length>1?(scales.set(xt,create$2(xt,$t,Ct)),this):isValidScaleType(xt)?scales.get(xt):void 0}scale$4(Identity,identity$3);scale$4(Linear,linear$1,Continuous);scale$4(Log,log$3,[Continuous,Log]);scale$4(Pow,pow$2,Continuous);scale$4(Sqrt,sqrt$2,Continuous);scale$4(Symlog,symlog$1,Continuous);scale$4(Time,time$1,[Continuous,Temporal]);scale$4(UTC,utcTime,[Continuous,Temporal]);scale$4(Sequential,sequential,[Continuous,Interpolating]);scale$4(`${Sequential}-${Linear}`,sequential,[Continuous,Interpolating]);scale$4(`${Sequential}-${Log}`,sequentialLog,[Continuous,Interpolating,Log]);scale$4(`${Sequential}-${Pow}`,sequentialPow,[Continuous,Interpolating]);scale$4(`${Sequential}-${Sqrt}`,sequentialSqrt,[Continuous,Interpolating]);scale$4(`${Sequential}-${Symlog}`,sequentialSymlog,[Continuous,Interpolating]);scale$4(`${Diverging}-${Linear}`,diverging,[Continuous,Interpolating]);scale$4(`${Diverging}-${Log}`,divergingLog,[Continuous,Interpolating,Log]);scale$4(`${Diverging}-${Pow}`,divergingPow,[Continuous,Interpolating]);scale$4(`${Diverging}-${Sqrt}`,divergingSqrt,[Continuous,Interpolating]);scale$4(`${Diverging}-${Symlog}`,divergingSymlog,[Continuous,Interpolating]);scale$4(Quantile,quantile$1,[Discretizing,Quantile]);scale$4(Quantize,quantize$1,Discretizing);scale$4(Threshold,threshold,Discretizing);scale$4(BinOrdinal,scaleBinOrdinal,[Discrete$1,Discretizing]);scale$4(Ordinal,ordinal,Discrete$1);scale$4(Band,band,Discrete$1);scale$4(Point,point$3,Discrete$1);function isValidScaleType(xt){return scales.has(xt)}function hasType(xt,$t){const Ct=scales.get(xt);return Ct&&Ct.metadata[$t]}function isContinuous$1(xt){return hasType(xt,Continuous)}function isDiscrete$2(xt){return hasType(xt,Discrete$1)}function isDiscretizing$1(xt){return hasType(xt,Discretizing)}function isLogarithmic(xt){return hasType(xt,Log)}function isTemporal(xt){return hasType(xt,Temporal)}function isInterpolating(xt){return hasType(xt,Interpolating)}function isQuantile$1(xt){return hasType(xt,Quantile)}const scaleProps=["clamp","base","constant","exponent"];function interpolateRange$1(xt,$t){const Ct=$t[0],kt=peek$1($t)-Ct;return function(Mt){return xt(Ct+Mt*kt)}}function interpolateColors(xt,$t,Ct){return piecewise(interpolate$1($t||"rgb",Ct),xt)}function quantizeInterpolator(xt,$t){const Ct=new Array($t),kt=$t+1;for(let Mt=0;Mt<$t;)Ct[Mt]=xt(++Mt/kt);return Ct}function scaleFraction(xt,$t,Ct){const kt=Ct-$t;let Mt,Ft,jt;return!kt||!Number.isFinite(kt)?constant$1(.5):(Mt=(Ft=xt.type).indexOf("-"),Ft=Mt<0?Ft:Ft.slice(Mt+1),jt=scale$4(Ft)().domain([$t,Ct]).range([0,1]),scaleProps.forEach(Bt=>xt[Bt]?jt[Bt](xt[Bt]()):0),jt)}function interpolate$1(xt,$t){const Ct=$$1$1[method(xt)];return $t!=null&&Ct&&Ct.gamma?Ct.gamma($t):Ct}function method(xt){return"interpolate"+xt.toLowerCase().split("-").map($t=>$t[0].toUpperCase()+$t.slice(1)).join("")}const continuous={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},discrete={accent:schemeAccent,category10:schemeCategory10,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:schemeDark2,observable10:schemeObservable10,paired:schemePaired,pastel1:schemePastel1,pastel2:schemePastel2,set1:schemeSet1,set2:schemeSet2,set3:schemeSet3,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function colors(xt){if(isArray(xt))return xt;const $t=xt.length/6|0,Ct=new Array($t);for(let kt=0;kt<$t;)Ct[kt]="#"+xt.slice(kt*6,++kt*6);return Ct}function apply$1(xt,$t){for(const Ct in xt)scheme$1(Ct,$t(xt[Ct]))}const schemes={};apply$1(discrete,colors);apply$1(continuous,xt=>interpolateColors(colors(xt)));function scheme$1(xt,$t){return xt=xt&&xt.toLowerCase(),arguments.length>1?(schemes[xt]=$t,this):schemes[xt]}const SymbolLegend="symbol",DiscreteLegend="discrete",GradientLegend="gradient",defaultFormatter=xt=>isArray(xt)?xt.map($t=>String($t)):String(xt),ascending=(xt,$t)=>xt[1]-$t[1],descending=(xt,$t)=>$t[1]-xt[1];function tickCount(xt,$t,Ct){let kt;return isNumber$1($t)&&(xt.bins&&($t=Math.max($t,xt.bins.length)),Ct!=null&&($t=Math.min($t,Math.floor(span(xt.domain())/Ct||1)+1))),isObject($t)&&(kt=$t.step,$t=$t.interval),isString($t)&&($t=xt.type===Time?timeInterval($t):xt.type==UTC?utcInterval($t):error("Only time and utc scales accept interval strings."),kt&&($t=$t.every(kt))),$t}function validTicks(xt,$t,Ct){let kt=xt.range(),Mt=kt[0],Ft=peek$1(kt),jt=ascending;if(Mt>Ft&&(kt=Ft,Ft=Mt,Mt=kt,jt=descending),Mt=Math.floor(Mt),Ft=Math.ceil(Ft),$t=$t.map(Bt=>[Bt,xt(Bt)]).filter(Bt=>Mt<=Bt[1]&&Bt[1]<=Ft).sort(jt).map(Bt=>Bt[0]),Ct>0&&$t.length>1){const Bt=[$t[0],peek$1($t)];for(;$t.length>Ct&&$t.length>=3;)$t=$t.filter((Vt,zt)=>!(zt%2));$t.length<3&&($t=Bt)}return $t}function tickValues(xt,$t){return xt.bins?validTicks(xt,xt.bins,$t):xt.ticks?xt.ticks($t):xt.domain()}function tickFormat(xt,$t,Ct,kt,Mt,Ft){const jt=$t.type;let Bt=defaultFormatter;if(jt===Time||Mt===Time)Bt=xt.timeFormat(kt);else if(jt===UTC||Mt===UTC)Bt=xt.utcFormat(kt);else if(isLogarithmic(jt)){const Vt=xt.formatFloat(kt);if(Ft||$t.bins)Bt=Vt;else{const zt=tickLog($t,Ct,!1);Bt=Ht=>zt(Ht)?Vt(Ht):""}}else if($t.tickFormat){const Vt=$t.domain();Bt=xt.formatSpan(Vt[0],Vt[Vt.length-1],Ct,kt)}else kt&&(Bt=xt.format(kt));return Bt}function tickLog(xt,$t,Ct){const kt=tickValues(xt,$t),Mt=xt.base(),Ft=Math.log(Mt),jt=Math.max(1,Mt*$t/kt.length),Bt=Vt=>{let zt=Vt/Math.pow(Mt,Math.round(Math.log(Vt)/Ft));return zt*Mt<Mt-.5&&(zt*=Mt),zt<=jt};return Ct?kt.filter(Bt):Bt}const symbols$2={[Quantile]:"quantiles",[Quantize]:"thresholds",[Threshold]:"domain"},formats={[Quantile]:"quantiles",[Quantize]:"domain"};function labelValues(xt,$t){return xt.bins?binValues(xt.bins):xt.type===Log?tickLog(xt,$t,!0):symbols$2[xt.type]?thresholdValues(xt[symbols$2[xt.type]]()):tickValues(xt,$t)}function thresholdFormat(xt,$t,Ct){const kt=$t[formats[$t.type]](),Mt=kt.length;let Ft=Mt>1?kt[1]-kt[0]:kt[0],jt;for(jt=1;jt<Mt;++jt)Ft=Math.min(Ft,kt[jt]-kt[jt-1]);return xt.formatSpan(0,Ft,3*10,Ct)}function thresholdValues(xt){const $t=[-1/0].concat(xt);return $t.max=1/0,$t}function binValues(xt){const $t=xt.slice(0,-1);return $t.max=peek$1(xt),$t}const isDiscreteRange=xt=>symbols$2[xt.type]||xt.bins;function labelFormat(xt,$t,Ct,kt,Mt,Ft,jt){const Bt=formats[$t.type]&&Ft!==Time&&Ft!==UTC?thresholdFormat(xt,$t,Mt):tickFormat(xt,$t,Ct,Mt,Ft,jt);return kt===SymbolLegend&&isDiscreteRange($t)?formatRange(Bt):kt===DiscreteLegend?formatDiscrete(Bt):formatPoint(Bt)}const formatRange=xt=>($t,Ct,kt)=>{const Mt=get$3(kt[Ct+1],get$3(kt.max,1/0)),Ft=formatValue$2($t,xt),jt=formatValue$2(Mt,xt);return Ft&&jt?Ft+"  "+jt:jt?"< "+jt:" "+Ft},get$3=(xt,$t)=>xt??$t,formatDiscrete=xt=>($t,Ct)=>Ct?xt($t):null,formatPoint=xt=>$t=>xt($t),formatValue$2=(xt,$t)=>Number.isFinite(xt)?$t(xt):null;function labelFraction(xt){const $t=xt.domain(),Ct=$t.length-1;let kt=+$t[0],Mt=+peek$1($t),Ft=Mt-kt;if(xt.type===Threshold){const jt=Ct?Ft/Ct:.1;kt-=jt,Mt+=jt,Ft=Mt-kt}return jt=>(jt-kt)/Ft}function format$1(xt,$t,Ct,kt){const Mt=kt||$t.type;return isString(Ct)&&isTemporal(Mt)&&(Ct=Ct.replace(/%a/g,"%A").replace(/%b/g,"%B")),!Ct&&Mt===Time?xt.timeFormat("%A, %d %B %Y, %X"):!Ct&&Mt===UTC?xt.utcFormat("%A, %d %B %Y, %X UTC"):labelFormat(xt,$t,5,null,Ct,kt,!0)}function domainCaption(xt,$t,Ct){Ct=Ct||{};const kt=Math.max(3,Ct.maxlen||7),Mt=format$1(xt,$t,Ct.format,Ct.formatType);if(isDiscretizing$1($t.type)){const Ft=labelValues($t).slice(1).map(Mt),jt=Ft.length;return`${jt} boundar${jt===1?"y":"ies"}: ${Ft.join(", ")}`}else if(isDiscrete$2($t.type)){const Ft=$t.domain(),jt=Ft.length,Bt=jt>kt?Ft.slice(0,kt-2).map(Mt).join(", ")+", ending with "+Ft.slice(-1).map(Mt):Ft.map(Mt).join(", ");return`${jt} value${jt===1?"":"s"}: ${Bt}`}else{const Ft=$t.domain();return`values from ${Mt(Ft[0])} to ${Mt(peek$1(Ft))}`}}let gradient_id=0;function resetSVGGradientId(){gradient_id=0}const patternPrefix="p_";function isGradient(xt){return xt&&xt.gradient}function gradientRef(xt,$t,Ct){const kt=xt.gradient;let Mt=xt.id,Ft=kt==="radial"?patternPrefix:"";return Mt||(Mt=xt.id="gradient_"+gradient_id++,kt==="radial"?(xt.x1=get$2(xt.x1,.5),xt.y1=get$2(xt.y1,.5),xt.r1=get$2(xt.r1,0),xt.x2=get$2(xt.x2,.5),xt.y2=get$2(xt.y2,.5),xt.r2=get$2(xt.r2,.5),Ft=patternPrefix):(xt.x1=get$2(xt.x1,0),xt.y1=get$2(xt.y1,0),xt.x2=get$2(xt.x2,1),xt.y2=get$2(xt.y2,0))),$t[Mt]=xt,"url("+(Ct||"")+"#"+Ft+Mt+")"}function get$2(xt,$t){return xt??$t}function Gradient$1(xt,$t){var Ct=[],kt;return kt={gradient:"linear",x1:xt?xt[0]:0,y1:xt?xt[1]:0,x2:$t?$t[0]:1,y2:$t?$t[1]:0,stops:Ct,stop:function(Mt,Ft){return Ct.push({offset:Mt,color:Ft}),kt}}}const lookup$4={basis:{curve:curveBasis},"basis-closed":{curve:curveBasisClosed},"basis-open":{curve:curveBasisOpen},bundle:{curve:curveBundle,tension:"beta",value:.85},cardinal:{curve:curveCardinal,tension:"tension",value:0},"cardinal-open":{curve:curveCardinalOpen,tension:"tension",value:0},"cardinal-closed":{curve:curveCardinalClosed,tension:"tension",value:0},"catmull-rom":{curve:curveCatmullRom,tension:"alpha",value:.5},"catmull-rom-closed":{curve:curveCatmullRomClosed,tension:"alpha",value:.5},"catmull-rom-open":{curve:curveCatmullRomOpen,tension:"alpha",value:.5},linear:{curve:curveLinear},"linear-closed":{curve:curveLinearClosed},monotone:{horizontal:monotoneY,vertical:monotoneX},natural:{curve:curveNatural},step:{curve:curveStep},"step-after":{curve:stepAfter},"step-before":{curve:stepBefore}};function curves(xt,$t,Ct){var kt=has$1(lookup$4,xt)&&lookup$4[xt],Mt=null;return kt&&(Mt=kt.curve||kt[$t||"vertical"],kt.tension&&Ct!=null&&(Mt=Mt[kt.tension](Ct))),Mt}const paramCounts={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},commandPattern=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,numberPattern=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,spacePattern=/^((\s+,?\s*)|(,\s*))/,flagPattern=/^[01]/;function parse$3(xt){const $t=[];return(xt.match(commandPattern)||[]).forEach(kt=>{let Mt=kt[0];const Ft=Mt.toLowerCase(),jt=paramCounts[Ft],Bt=parseParams(Ft,jt,kt.slice(1).trim()),Vt=Bt.length;if(Vt<jt||Vt&&Vt%jt!==0)throw Error("Invalid SVG path, incorrect parameter count");if($t.push([Mt,...Bt.slice(0,jt)]),Vt!==jt){Ft==="m"&&(Mt=Mt==="M"?"L":"l");for(let zt=jt;zt<Vt;zt+=jt)$t.push([Mt,...Bt.slice(zt,zt+jt)])}}),$t}function parseParams(xt,$t,Ct){const kt=[];for(let Mt=0;$t&&Mt<Ct.length;)for(let Ft=0;Ft<$t;++Ft){const jt=xt==="a"&&(Ft===3||Ft===4)?flagPattern:numberPattern,Bt=Ct.slice(Mt).match(jt);if(Bt===null)throw Error("Invalid SVG path, incorrect parameter type");Mt+=Bt[0].length,kt.push(+Bt[0]);const Vt=Ct.slice(Mt).match(spacePattern);Vt!==null&&(Mt+=Vt[0].length)}return kt}const DegToRad=Math.PI/180,Epsilon=1e-14,HalfPi=Math.PI/2,Tau=Math.PI*2,HalfSqrt3=Math.sqrt(3)/2;var segmentCache={},bezierCache={},join$1=[].join;function segments(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt){const zt=join$1.call(arguments);if(segmentCache[zt])return segmentCache[zt];const Ht=jt*DegToRad,Gt=Math.sin(Ht),qt=Math.cos(Ht);Ct=Math.abs(Ct),kt=Math.abs(kt);const Wt=qt*(Bt-xt)*.5+Gt*(Vt-$t)*.5,Yt=qt*(Vt-$t)*.5-Gt*(Bt-xt)*.5;let Kt=Wt*Wt/(Ct*Ct)+Yt*Yt/(kt*kt);Kt>1&&(Kt=Math.sqrt(Kt),Ct*=Kt,kt*=Kt);const Xt=qt/Ct,Qt=Gt/Ct,Jt=-Gt/kt,Zt=qt/kt,sn=Xt*Bt+Qt*Vt,ln=Jt*Bt+Zt*Vt,dn=Xt*xt+Qt*$t,hn=Jt*xt+Zt*$t;let pn=1/((dn-sn)*(dn-sn)+(hn-ln)*(hn-ln))-.25;pn<0&&(pn=0);let yn=Math.sqrt(pn);Ft==Mt&&(yn=-yn);const gn=.5*(sn+dn)-yn*(hn-ln),En=.5*(ln+hn)+yn*(dn-sn),bn=Math.atan2(ln-En,sn-gn);let Cn=Math.atan2(hn-En,dn-gn)-bn;Cn<0&&Ft===1?Cn+=Tau:Cn>0&&Ft===0&&(Cn-=Tau);const $n=Math.ceil(Math.abs(Cn/(HalfPi+.001))),wn=[];for(let Rn=0;Rn<$n;++Rn){const Dn=bn+Rn*Cn/$n,An=bn+(Rn+1)*Cn/$n;wn[Rn]=[gn,En,Dn,An,Ct,kt,Gt,qt]}return segmentCache[zt]=wn}function bezier(xt){const $t=join$1.call(xt);if(bezierCache[$t])return bezierCache[$t];var Ct=xt[0],kt=xt[1],Mt=xt[2],Ft=xt[3],jt=xt[4],Bt=xt[5],Vt=xt[6],zt=xt[7];const Ht=zt*jt,Gt=-Vt*Bt,qt=Vt*jt,Wt=zt*Bt,Yt=Math.cos(Mt),Kt=Math.sin(Mt),Xt=Math.cos(Ft),Qt=Math.sin(Ft),Jt=.5*(Ft-Mt),Zt=Math.sin(Jt*.5),sn=8/3*Zt*Zt/Math.sin(Jt),ln=Ct+Yt-sn*Kt,dn=kt+Kt+sn*Yt,hn=Ct+Xt,cn=kt+Qt,pn=hn+sn*Qt,yn=cn-sn*Xt;return bezierCache[$t]=[Ht*ln+Gt*dn,qt*ln+Wt*dn,Ht*pn+Gt*yn,qt*pn+Wt*yn,Ht*hn+Gt*cn,qt*hn+Wt*cn]}const temp=["l",0,0,0,0,0,0,0];function scale$1$1(xt,$t,Ct){const kt=temp[0]=xt[0];if(kt==="a"||kt==="A")temp[1]=$t*xt[1],temp[2]=Ct*xt[2],temp[3]=xt[3],temp[4]=xt[4],temp[5]=xt[5],temp[6]=$t*xt[6],temp[7]=Ct*xt[7];else if(kt==="h"||kt==="H")temp[1]=$t*xt[1];else if(kt==="v"||kt==="V")temp[1]=Ct*xt[1];else for(var Mt=1,Ft=xt.length;Mt<Ft;++Mt)temp[Mt]=(Mt%2==1?$t:Ct)*xt[Mt];return temp}function pathRender(xt,$t,Ct,kt,Mt,Ft){var jt,Bt=null,Vt=0,zt=0,Ht=0,Gt=0,qt,Wt,Yt,Kt,Xt=0,Qt=0;Ct==null&&(Ct=0),kt==null&&(kt=0),Mt==null&&(Mt=1),Ft==null&&(Ft=Mt),xt.beginPath&&xt.beginPath();for(var Jt=0,Zt=$t.length;Jt<Zt;++Jt){switch(jt=$t[Jt],(Mt!==1||Ft!==1)&&(jt=scale$1$1(jt,Mt,Ft)),jt[0]){case"l":Vt+=jt[1],zt+=jt[2],xt.lineTo(Vt+Ct,zt+kt);break;case"L":Vt=jt[1],zt=jt[2],xt.lineTo(Vt+Ct,zt+kt);break;case"h":Vt+=jt[1],xt.lineTo(Vt+Ct,zt+kt);break;case"H":Vt=jt[1],xt.lineTo(Vt+Ct,zt+kt);break;case"v":zt+=jt[1],xt.lineTo(Vt+Ct,zt+kt);break;case"V":zt=jt[1],xt.lineTo(Vt+Ct,zt+kt);break;case"m":Vt+=jt[1],zt+=jt[2],Xt=Vt,Qt=zt,xt.moveTo(Vt+Ct,zt+kt);break;case"M":Vt=jt[1],zt=jt[2],Xt=Vt,Qt=zt,xt.moveTo(Vt+Ct,zt+kt);break;case"c":qt=Vt+jt[5],Wt=zt+jt[6],Ht=Vt+jt[3],Gt=zt+jt[4],xt.bezierCurveTo(Vt+jt[1]+Ct,zt+jt[2]+kt,Ht+Ct,Gt+kt,qt+Ct,Wt+kt),Vt=qt,zt=Wt;break;case"C":Vt=jt[5],zt=jt[6],Ht=jt[3],Gt=jt[4],xt.bezierCurveTo(jt[1]+Ct,jt[2]+kt,Ht+Ct,Gt+kt,Vt+Ct,zt+kt);break;case"s":qt=Vt+jt[3],Wt=zt+jt[4],Ht=2*Vt-Ht,Gt=2*zt-Gt,xt.bezierCurveTo(Ht+Ct,Gt+kt,Vt+jt[1]+Ct,zt+jt[2]+kt,qt+Ct,Wt+kt),Ht=Vt+jt[1],Gt=zt+jt[2],Vt=qt,zt=Wt;break;case"S":qt=jt[3],Wt=jt[4],Ht=2*Vt-Ht,Gt=2*zt-Gt,xt.bezierCurveTo(Ht+Ct,Gt+kt,jt[1]+Ct,jt[2]+kt,qt+Ct,Wt+kt),Vt=qt,zt=Wt,Ht=jt[1],Gt=jt[2];break;case"q":qt=Vt+jt[3],Wt=zt+jt[4],Ht=Vt+jt[1],Gt=zt+jt[2],xt.quadraticCurveTo(Ht+Ct,Gt+kt,qt+Ct,Wt+kt),Vt=qt,zt=Wt;break;case"Q":qt=jt[3],Wt=jt[4],xt.quadraticCurveTo(jt[1]+Ct,jt[2]+kt,qt+Ct,Wt+kt),Vt=qt,zt=Wt,Ht=jt[1],Gt=jt[2];break;case"t":qt=Vt+jt[1],Wt=zt+jt[2],Bt[0].match(/[QqTt]/)===null?(Ht=Vt,Gt=zt):Bt[0]==="t"?(Ht=2*Vt-Yt,Gt=2*zt-Kt):Bt[0]==="q"&&(Ht=2*Vt-Ht,Gt=2*zt-Gt),Yt=Ht,Kt=Gt,xt.quadraticCurveTo(Ht+Ct,Gt+kt,qt+Ct,Wt+kt),Vt=qt,zt=Wt,Ht=Vt+jt[1],Gt=zt+jt[2];break;case"T":qt=jt[1],Wt=jt[2],Ht=2*Vt-Ht,Gt=2*zt-Gt,xt.quadraticCurveTo(Ht+Ct,Gt+kt,qt+Ct,Wt+kt),Vt=qt,zt=Wt;break;case"a":drawArc(xt,Vt+Ct,zt+kt,[jt[1],jt[2],jt[3],jt[4],jt[5],jt[6]+Vt+Ct,jt[7]+zt+kt]),Vt+=jt[6],zt+=jt[7];break;case"A":drawArc(xt,Vt+Ct,zt+kt,[jt[1],jt[2],jt[3],jt[4],jt[5],jt[6]+Ct,jt[7]+kt]),Vt=jt[6],zt=jt[7];break;case"z":case"Z":Vt=Xt,zt=Qt,xt.closePath();break}Bt=jt}}function drawArc(xt,$t,Ct,kt){const Mt=segments(kt[5],kt[6],kt[0],kt[1],kt[3],kt[4],kt[2],$t,Ct);for(let Ft=0;Ft<Mt.length;++Ft){const jt=bezier(Mt[Ft]);xt.bezierCurveTo(jt[0],jt[1],jt[2],jt[3],jt[4],jt[5])}}const Tan30=.5773502691896257,builtins={circle:{draw:function(xt,$t){const Ct=Math.sqrt($t)/2;xt.moveTo(Ct,0),xt.arc(0,0,Ct,0,Tau)}},cross:{draw:function(xt,$t){var Ct=Math.sqrt($t)/2,kt=Ct/2.5;xt.moveTo(-Ct,-kt),xt.lineTo(-Ct,kt),xt.lineTo(-kt,kt),xt.lineTo(-kt,Ct),xt.lineTo(kt,Ct),xt.lineTo(kt,kt),xt.lineTo(Ct,kt),xt.lineTo(Ct,-kt),xt.lineTo(kt,-kt),xt.lineTo(kt,-Ct),xt.lineTo(-kt,-Ct),xt.lineTo(-kt,-kt),xt.closePath()}},diamond:{draw:function(xt,$t){const Ct=Math.sqrt($t)/2;xt.moveTo(-Ct,0),xt.lineTo(0,-Ct),xt.lineTo(Ct,0),xt.lineTo(0,Ct),xt.closePath()}},square:{draw:function(xt,$t){var Ct=Math.sqrt($t),kt=-Ct/2;xt.rect(kt,kt,Ct,Ct)}},arrow:{draw:function(xt,$t){var Ct=Math.sqrt($t)/2,kt=Ct/7,Mt=Ct/2.5,Ft=Ct/8;xt.moveTo(-kt,Ct),xt.lineTo(kt,Ct),xt.lineTo(kt,-Ft),xt.lineTo(Mt,-Ft),xt.lineTo(0,-Ct),xt.lineTo(-Mt,-Ft),xt.lineTo(-kt,-Ft),xt.closePath()}},wedge:{draw:function(xt,$t){var Ct=Math.sqrt($t)/2,kt=HalfSqrt3*Ct,Mt=kt-Ct*Tan30,Ft=Ct/4;xt.moveTo(0,-kt-Mt),xt.lineTo(-Ft,kt-Mt),xt.lineTo(Ft,kt-Mt),xt.closePath()}},triangle:{draw:function(xt,$t){var Ct=Math.sqrt($t)/2,kt=HalfSqrt3*Ct,Mt=kt-Ct*Tan30;xt.moveTo(0,-kt-Mt),xt.lineTo(-Ct,kt-Mt),xt.lineTo(Ct,kt-Mt),xt.closePath()}},"triangle-up":{draw:function(xt,$t){var Ct=Math.sqrt($t)/2,kt=HalfSqrt3*Ct;xt.moveTo(0,-kt),xt.lineTo(-Ct,kt),xt.lineTo(Ct,kt),xt.closePath()}},"triangle-down":{draw:function(xt,$t){var Ct=Math.sqrt($t)/2,kt=HalfSqrt3*Ct;xt.moveTo(0,kt),xt.lineTo(-Ct,-kt),xt.lineTo(Ct,-kt),xt.closePath()}},"triangle-right":{draw:function(xt,$t){var Ct=Math.sqrt($t)/2,kt=HalfSqrt3*Ct;xt.moveTo(kt,0),xt.lineTo(-kt,-Ct),xt.lineTo(-kt,Ct),xt.closePath()}},"triangle-left":{draw:function(xt,$t){var Ct=Math.sqrt($t)/2,kt=HalfSqrt3*Ct;xt.moveTo(-kt,0),xt.lineTo(kt,-Ct),xt.lineTo(kt,Ct),xt.closePath()}},stroke:{draw:function(xt,$t){const Ct=Math.sqrt($t)/2;xt.moveTo(-Ct,0),xt.lineTo(Ct,0)}}};function symbols$1(xt){return has$1(builtins,xt)?builtins[xt]:customSymbol(xt)}var custom={};function customSymbol(xt){if(!has$1(custom,xt)){const $t=parse$3(xt);custom[xt]={draw:function(Ct,kt){pathRender(Ct,$t,0,0,Math.sqrt(kt)/2)}}}return custom[xt]}const C=.448084975506;function rectangleX(xt){return xt.x}function rectangleY(xt){return xt.y}function rectangleWidth(xt){return xt.width}function rectangleHeight(xt){return xt.height}function number$3(xt){return typeof xt=="function"?xt:()=>+xt}function clamp(xt,$t,Ct){return Math.max($t,Math.min(xt,Ct))}function vg_rect(){var xt=rectangleX,$t=rectangleY,Ct=rectangleWidth,kt=rectangleHeight,Mt=number$3(0),Ft=Mt,jt=Mt,Bt=Mt,Vt=null;function zt(Ht,Gt,qt){var Wt,Yt=Gt??+xt.call(this,Ht),Kt=qt??+$t.call(this,Ht),Xt=+Ct.call(this,Ht),Qt=+kt.call(this,Ht),Jt=Math.min(Xt,Qt)/2,Zt=clamp(+Mt.call(this,Ht),0,Jt),sn=clamp(+Ft.call(this,Ht),0,Jt),ln=clamp(+jt.call(this,Ht),0,Jt),dn=clamp(+Bt.call(this,Ht),0,Jt);if(Vt||(Vt=Wt=path$3()),Zt<=0&&sn<=0&&ln<=0&&dn<=0)Vt.rect(Yt,Kt,Xt,Qt);else{var hn=Yt+Xt,cn=Kt+Qt;Vt.moveTo(Yt+Zt,Kt),Vt.lineTo(hn-sn,Kt),Vt.bezierCurveTo(hn-C*sn,Kt,hn,Kt+C*sn,hn,Kt+sn),Vt.lineTo(hn,cn-dn),Vt.bezierCurveTo(hn,cn-C*dn,hn-C*dn,cn,hn-dn,cn),Vt.lineTo(Yt+ln,cn),Vt.bezierCurveTo(Yt+C*ln,cn,Yt,cn-C*ln,Yt,cn-ln),Vt.lineTo(Yt,Kt+Zt),Vt.bezierCurveTo(Yt,Kt+C*Zt,Yt+C*Zt,Kt,Yt+Zt,Kt),Vt.closePath()}if(Wt)return Vt=null,Wt+""||null}return zt.x=function(Ht){return arguments.length?(xt=number$3(Ht),zt):xt},zt.y=function(Ht){return arguments.length?($t=number$3(Ht),zt):$t},zt.width=function(Ht){return arguments.length?(Ct=number$3(Ht),zt):Ct},zt.height=function(Ht){return arguments.length?(kt=number$3(Ht),zt):kt},zt.cornerRadius=function(Ht,Gt,qt,Wt){return arguments.length?(Mt=number$3(Ht),Ft=Gt!=null?number$3(Gt):Mt,Bt=qt!=null?number$3(qt):Mt,jt=Wt!=null?number$3(Wt):Ft,zt):Mt},zt.context=function(Ht){return arguments.length?(Vt=Ht??null,zt):Vt},zt}function vg_trail(){var xt,$t,Ct,kt,Mt=null,Ft,jt,Bt,Vt;function zt(Gt,qt,Wt){const Yt=Wt/2;if(Ft){var Kt=Bt-qt,Xt=Gt-jt;if(Kt||Xt){var Qt=Math.hypot(Kt,Xt),Jt=(Kt/=Qt)*Vt,Zt=(Xt/=Qt)*Vt,sn=Math.atan2(Xt,Kt);Mt.moveTo(jt-Jt,Bt-Zt),Mt.lineTo(Gt-Kt*Yt,qt-Xt*Yt),Mt.arc(Gt,qt,Yt,sn-Math.PI,sn),Mt.lineTo(jt+Jt,Bt+Zt),Mt.arc(jt,Bt,Vt,sn,sn+Math.PI)}else Mt.arc(Gt,qt,Yt,0,Tau);Mt.closePath()}else Ft=1;jt=Gt,Bt=qt,Vt=Yt}function Ht(Gt){var qt,Wt=Gt.length,Yt,Kt=!1,Xt;for(Mt==null&&(Mt=Xt=path$3()),qt=0;qt<=Wt;++qt)!(qt<Wt&&kt(Yt=Gt[qt],qt,Gt))===Kt&&(Kt=!Kt)&&(Ft=0),Kt&&zt(+xt(Yt,qt,Gt),+$t(Yt,qt,Gt),+Ct(Yt,qt,Gt));if(Xt)return Mt=null,Xt+""||null}return Ht.x=function(Gt){return arguments.length?(xt=Gt,Ht):xt},Ht.y=function(Gt){return arguments.length?($t=Gt,Ht):$t},Ht.size=function(Gt){return arguments.length?(Ct=Gt,Ht):Ct},Ht.defined=function(Gt){return arguments.length?(kt=Gt,Ht):kt},Ht.context=function(Gt){return arguments.length?(Gt==null?Mt=null:Mt=Gt,Ht):Mt},Ht}function value$1(xt,$t){return xt??$t}const x=xt=>xt.x||0,y=xt=>xt.y||0,w$1=xt=>xt.width||0,h=xt=>xt.height||0,xw=xt=>(xt.x||0)+(xt.width||0),yh=xt=>(xt.y||0)+(xt.height||0),sa=xt=>xt.startAngle||0,ea=xt=>xt.endAngle||0,pa=xt=>xt.padAngle||0,ir=xt=>xt.innerRadius||0,or=xt=>xt.outerRadius||0,cr=xt=>xt.cornerRadius||0,tl=xt=>value$1(xt.cornerRadiusTopLeft,xt.cornerRadius)||0,tr=xt=>value$1(xt.cornerRadiusTopRight,xt.cornerRadius)||0,br=xt=>value$1(xt.cornerRadiusBottomRight,xt.cornerRadius)||0,bl=xt=>value$1(xt.cornerRadiusBottomLeft,xt.cornerRadius)||0,sz=xt=>value$1(xt.size,64),ts=xt=>xt.size||1,def=xt=>xt.defined!==!1,type$1=xt=>symbols$1(xt.shape||"circle"),arcShape=arc$2$1().startAngle(sa).endAngle(ea).padAngle(pa).innerRadius(ir).outerRadius(or).cornerRadius(cr),areavShape=area$2$1().x(x).y1(y).y0(yh).defined(def),areahShape=area$2$1().y(y).x1(x).x0(xw).defined(def),lineShape=line$2$1().x(x).y(y).defined(def),rectShape=vg_rect().x(x).y(y).width(w$1).height(h).cornerRadius(tl,tr,br,bl),symbolShape=Symbol$1().type(type$1).size(sz),trailShape=vg_trail().x(x).y(y).defined(def).size(ts);function hasCornerRadius(xt){return xt.cornerRadius||xt.cornerRadiusTopLeft||xt.cornerRadiusTopRight||xt.cornerRadiusBottomRight||xt.cornerRadiusBottomLeft}function arc$1$1(xt,$t){return arcShape.context(xt)($t)}function area$1$1(xt,$t){const Ct=$t[0],kt=Ct.interpolate||"linear";return(Ct.orient==="horizontal"?areahShape:areavShape).curve(curves(kt,Ct.orient,Ct.tension)).context(xt)($t)}function line$1$1(xt,$t){const Ct=$t[0],kt=Ct.interpolate||"linear";return lineShape.curve(curves(kt,Ct.orient,Ct.tension)).context(xt)($t)}function rectangle(xt,$t,Ct,kt){return rectShape.context(xt)($t,Ct,kt)}function shape$1(xt,$t){return($t.mark.shape||$t.shape).context(xt)($t)}function symbol$1(xt,$t){return symbolShape.context(xt)($t)}function trail$1(xt,$t){return trailShape.context(xt)($t)}var clip_id=1;function resetSVGClipId(){clip_id=1}function clip$1(xt,$t,Ct){var kt=$t.clip,Mt=xt._defs,Ft=$t.clip_id||($t.clip_id="clip"+clip_id++),jt=Mt.clipping[Ft]||(Mt.clipping[Ft]={id:Ft});return isFunction$1(kt)?jt.path=kt(null):hasCornerRadius(Ct)?jt.path=rectangle(null,Ct,0,0):(jt.width=Ct.width||0,jt.height=Ct.height||0),"url(#"+Ft+")"}function Bounds(xt){this.clear(),xt&&this.union(xt)}Bounds.prototype={clone(){return new Bounds(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(xt){return this.x1===xt.x1&&this.y1===xt.y1&&this.x2===xt.x2&&this.y2===xt.y2},set(xt,$t,Ct,kt){return Ct<xt?(this.x2=xt,this.x1=Ct):(this.x1=xt,this.x2=Ct),kt<$t?(this.y2=$t,this.y1=kt):(this.y1=$t,this.y2=kt),this},add(xt,$t){return xt<this.x1&&(this.x1=xt),$t<this.y1&&(this.y1=$t),xt>this.x2&&(this.x2=xt),$t>this.y2&&(this.y2=$t),this},expand(xt){return this.x1-=xt,this.y1-=xt,this.x2+=xt,this.y2+=xt,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(xt){return this.x1*=xt,this.y1*=xt,this.x2*=xt,this.y2*=xt,this},translate(xt,$t){return this.x1+=xt,this.x2+=xt,this.y1+=$t,this.y2+=$t,this},rotate(xt,$t,Ct){const kt=this.rotatedPoints(xt,$t,Ct);return this.clear().add(kt[0],kt[1]).add(kt[2],kt[3]).add(kt[4],kt[5]).add(kt[6],kt[7])},rotatedPoints(xt,$t,Ct){var{x1:kt,y1:Mt,x2:Ft,y2:jt}=this,Bt=Math.cos(xt),Vt=Math.sin(xt),zt=$t-$t*Bt+Ct*Vt,Ht=Ct-$t*Vt-Ct*Bt;return[Bt*kt-Vt*Mt+zt,Vt*kt+Bt*Mt+Ht,Bt*kt-Vt*jt+zt,Vt*kt+Bt*jt+Ht,Bt*Ft-Vt*Mt+zt,Vt*Ft+Bt*Mt+Ht,Bt*Ft-Vt*jt+zt,Vt*Ft+Bt*jt+Ht]},union(xt){return xt.x1<this.x1&&(this.x1=xt.x1),xt.y1<this.y1&&(this.y1=xt.y1),xt.x2>this.x2&&(this.x2=xt.x2),xt.y2>this.y2&&(this.y2=xt.y2),this},intersect(xt){return xt.x1>this.x1&&(this.x1=xt.x1),xt.y1>this.y1&&(this.y1=xt.y1),xt.x2<this.x2&&(this.x2=xt.x2),xt.y2<this.y2&&(this.y2=xt.y2),this},encloses(xt){return xt&&this.x1<=xt.x1&&this.x2>=xt.x2&&this.y1<=xt.y1&&this.y2>=xt.y2},alignsWith(xt){return xt&&(this.x1==xt.x1||this.x2==xt.x2||this.y1==xt.y1||this.y2==xt.y2)},intersects(xt){return xt&&!(this.x2<xt.x1||this.x1>xt.x2||this.y2<xt.y1||this.y1>xt.y2)},contains(xt,$t){return!(xt<this.x1||xt>this.x2||$t<this.y1||$t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Item(xt){this.mark=xt,this.bounds=this.bounds||new Bounds}function GroupItem(xt){Item.call(this,xt),this.items=this.items||[]}inherits(GroupItem,Item);class ResourceLoader{constructor($t){this._pending=0,this._loader=$t||loader()}pending(){return this._pending}sanitizeURL($t){const Ct=this;return increment(Ct),Ct._loader.sanitize($t,{context:"href"}).then(kt=>(decrement(Ct),kt)).catch(()=>(decrement(Ct),null))}loadImage($t){const Ct=this,kt=domImage();return increment(Ct),Ct._loader.sanitize($t,{context:"image"}).then(Mt=>{const Ft=Mt.href;if(!Ft||!kt)throw{url:Ft};const jt=new kt,Bt=has$1(Mt,"crossOrigin")?Mt.crossOrigin:"anonymous";return Bt!=null&&(jt.crossOrigin=Bt),jt.onload=()=>decrement(Ct),jt.onerror=()=>decrement(Ct),jt.src=Ft,jt}).catch(Mt=>(decrement(Ct),{complete:!1,width:0,height:0,src:Mt&&Mt.url||""}))}ready(){const $t=this;return new Promise(Ct=>{function kt(Mt){$t.pending()?setTimeout(()=>{kt(!0)},10):Ct(Mt)}kt(!1)})}}function increment(xt){xt._pending+=1}function decrement(xt){xt._pending-=1}function boundStroke(xt,$t,Ct){if($t.stroke&&$t.opacity!==0&&$t.strokeOpacity!==0){const kt=$t.strokeWidth!=null?+$t.strokeWidth:1;xt.expand(kt+(Ct?miterAdjustment($t,kt):0))}return xt}function miterAdjustment(xt,$t){return xt.strokeJoin&&xt.strokeJoin!=="miter"?0:$t}const circleThreshold=Tau-1e-8;let bounds,lx,ly,rot,ma,mb,mc,md;const add$1=(xt,$t)=>bounds.add(xt,$t),addL=(xt,$t)=>add$1(lx=xt,ly=$t),addX=xt=>add$1(xt,bounds.y1),addY=xt=>add$1(bounds.x1,xt),px=(xt,$t)=>ma*xt+mc*$t,py=(xt,$t)=>mb*xt+md*$t,addp=(xt,$t)=>add$1(px(xt,$t),py(xt,$t)),addpL=(xt,$t)=>addL(px(xt,$t),py(xt,$t));function boundContext(xt,$t){return bounds=xt,$t?(rot=$t*DegToRad,ma=md=Math.cos(rot),mb=Math.sin(rot),mc=-mb):(ma=md=1,rot=mb=mc=0),context$1}const context$1={beginPath(){},closePath(){},moveTo:addpL,lineTo:addpL,rect(xt,$t,Ct,kt){rot?(addp(xt+Ct,$t),addp(xt+Ct,$t+kt),addp(xt,$t+kt),addpL(xt,$t)):(add$1(xt+Ct,$t+kt),addL(xt,$t))},quadraticCurveTo(xt,$t,Ct,kt){const Mt=px(xt,$t),Ft=py(xt,$t),jt=px(Ct,kt),Bt=py(Ct,kt);quadExtrema(lx,Mt,jt,addX),quadExtrema(ly,Ft,Bt,addY),addL(jt,Bt)},bezierCurveTo(xt,$t,Ct,kt,Mt,Ft){const jt=px(xt,$t),Bt=py(xt,$t),Vt=px(Ct,kt),zt=py(Ct,kt),Ht=px(Mt,Ft),Gt=py(Mt,Ft);cubicExtrema(lx,jt,Vt,Ht,addX),cubicExtrema(ly,Bt,zt,Gt,addY),addL(Ht,Gt)},arc(xt,$t,Ct,kt,Mt,Ft){if(kt+=rot,Mt+=rot,lx=Ct*Math.cos(Mt)+xt,ly=Ct*Math.sin(Mt)+$t,Math.abs(Mt-kt)>circleThreshold)add$1(xt-Ct,$t-Ct),add$1(xt+Ct,$t+Ct);else{const jt=zt=>add$1(Ct*Math.cos(zt)+xt,Ct*Math.sin(zt)+$t);let Bt,Vt;if(jt(kt),jt(Mt),Mt!==kt)if(kt=kt%Tau,kt<0&&(kt+=Tau),Mt=Mt%Tau,Mt<0&&(Mt+=Tau),Mt<kt&&(Ft=!Ft,Bt=kt,kt=Mt,Mt=Bt),Ft)for(Mt-=Tau,Bt=kt-kt%HalfPi,Vt=0;Vt<4&&Bt>Mt;++Vt,Bt-=HalfPi)jt(Bt);else for(Bt=kt-kt%HalfPi+HalfPi,Vt=0;Vt<4&&Bt<Mt;++Vt,Bt=Bt+HalfPi)jt(Bt)}}};function quadExtrema(xt,$t,Ct,kt){const Mt=(xt-$t)/(xt+Ct-2*$t);0<Mt&&Mt<1&&kt(xt+($t-xt)*Mt)}function cubicExtrema(xt,$t,Ct,kt,Mt){const Ft=kt-xt+3*$t-3*Ct,jt=xt+Ct-2*$t,Bt=xt-$t;let Vt=0,zt=0,Ht;Math.abs(Ft)>Epsilon?(Ht=jt*jt+Bt*Ft,Ht>=0&&(Ht=Math.sqrt(Ht),Vt=(-jt+Ht)/Ft,zt=(-jt-Ht)/Ft)):Vt=.5*Bt/jt,0<Vt&&Vt<1&&Mt(cubic(Vt,xt,$t,Ct,kt)),0<zt&&zt<1&&Mt(cubic(zt,xt,$t,Ct,kt))}function cubic(xt,$t,Ct,kt,Mt){const Ft=1-xt,jt=Ft*Ft,Bt=xt*xt;return jt*Ft*$t+3*jt*xt*Ct+3*Ft*Bt*kt+Bt*xt*Mt}var context$2=(context$2=domCanvas(1,1))?context$2.getContext("2d"):null;const b=new Bounds;function intersectPath(xt){return function($t,Ct){if(!context$2)return!0;xt(context$2,$t),b.clear().union($t.bounds).intersect(Ct).round();const{x1:kt,y1:Mt,x2:Ft,y2:jt}=b;for(let Bt=Mt;Bt<=jt;++Bt)for(let Vt=kt;Vt<=Ft;++Vt)if(context$2.isPointInPath(Vt,Bt))return!0;return!1}}function intersectPoint(xt,$t){return $t.contains(xt.x||0,xt.y||0)}function intersectRect(xt,$t){const Ct=xt.x||0,kt=xt.y||0,Mt=xt.width||0,Ft=xt.height||0;return $t.intersects(b.set(Ct,kt,Ct+Mt,kt+Ft))}function intersectRule(xt,$t){const Ct=xt.x||0,kt=xt.y||0,Mt=xt.x2!=null?xt.x2:Ct,Ft=xt.y2!=null?xt.y2:kt;return intersectBoxLine($t,Ct,kt,Mt,Ft)}function intersectBoxLine(xt,$t,Ct,kt,Mt){const{x1:Ft,y1:jt,x2:Bt,y2:Vt}=xt,zt=kt-$t,Ht=Mt-Ct;let Gt=0,qt=1,Wt,Yt,Kt,Xt;for(Xt=0;Xt<4;++Xt){if(Xt===0&&(Wt=-zt,Yt=-(Ft-$t)),Xt===1&&(Wt=zt,Yt=Bt-$t),Xt===2&&(Wt=-Ht,Yt=-(jt-Ct)),Xt===3&&(Wt=Ht,Yt=Vt-Ct),Math.abs(Wt)<1e-10&&Yt<0)return!1;if(Kt=Yt/Wt,Wt<0){if(Kt>qt)return!1;Kt>Gt&&(Gt=Kt)}else if(Wt>0){if(Kt<Gt)return!1;Kt<qt&&(qt=Kt)}}return!0}function blend(xt,$t){xt.globalCompositeOperation=$t.blend||"source-over"}function value$2(xt,$t){return xt??$t}function addStops(xt,$t){const Ct=$t.length;for(let kt=0;kt<Ct;++kt)xt.addColorStop($t[kt].offset,$t[kt].color);return xt}function gradient$2(xt,$t,Ct){const kt=Ct.width(),Mt=Ct.height();let Ft;if($t.gradient==="radial")Ft=xt.createRadialGradient(Ct.x1+value$2($t.x1,.5)*kt,Ct.y1+value$2($t.y1,.5)*Mt,Math.max(kt,Mt)*value$2($t.r1,0),Ct.x1+value$2($t.x2,.5)*kt,Ct.y1+value$2($t.y2,.5)*Mt,Math.max(kt,Mt)*value$2($t.r2,.5));else{const jt=value$2($t.x1,0),Bt=value$2($t.y1,0),Vt=value$2($t.x2,1),zt=value$2($t.y2,0);if(jt===Vt||Bt===zt||kt===Mt)Ft=xt.createLinearGradient(Ct.x1+jt*kt,Ct.y1+Bt*Mt,Ct.x1+Vt*kt,Ct.y1+zt*Mt);else{const Ht=domCanvas(Math.ceil(kt),Math.ceil(Mt)),Gt=Ht.getContext("2d");return Gt.scale(kt,Mt),Gt.fillStyle=addStops(Gt.createLinearGradient(jt,Bt,Vt,zt),$t.stops),Gt.fillRect(0,0,kt,Mt),xt.createPattern(Ht,"no-repeat")}}return addStops(Ft,$t.stops)}function color$2(xt,$t,Ct){return isGradient(Ct)?gradient$2(xt,Ct,$t.bounds):Ct}function fill(xt,$t,Ct){return Ct*=$t.fillOpacity==null?1:$t.fillOpacity,Ct>0?(xt.globalAlpha=Ct,xt.fillStyle=color$2(xt,$t,$t.fill),!0):!1}var Empty=[];function stroke(xt,$t,Ct){var kt=(kt=$t.strokeWidth)!=null?kt:1;return kt<=0?!1:(Ct*=$t.strokeOpacity==null?1:$t.strokeOpacity,Ct>0?(xt.globalAlpha=Ct,xt.strokeStyle=color$2(xt,$t,$t.stroke),xt.lineWidth=kt,xt.lineCap=$t.strokeCap||"butt",xt.lineJoin=$t.strokeJoin||"miter",xt.miterLimit=$t.strokeMiterLimit||10,xt.setLineDash&&(xt.setLineDash($t.strokeDash||Empty),xt.lineDashOffset=$t.strokeDashOffset||0),!0):!1)}function compare$7(xt,$t){return xt.zindex-$t.zindex||xt.index-$t.index}function zorder(xt){if(!xt.zdirty)return xt.zitems;var $t=xt.items,Ct=[],kt,Mt,Ft;for(Mt=0,Ft=$t.length;Mt<Ft;++Mt)kt=$t[Mt],kt.index=Mt,kt.zindex&&Ct.push(kt);return xt.zdirty=!1,xt.zitems=Ct.sort(compare$7)}function visit(xt,$t){var Ct=xt.items,kt,Mt;if(!Ct||!Ct.length)return;const Ft=zorder(xt);if(Ft&&Ft.length){for(kt=0,Mt=Ct.length;kt<Mt;++kt)Ct[kt].zindex||$t(Ct[kt]);Ct=Ft}for(kt=0,Mt=Ct.length;kt<Mt;++kt)$t(Ct[kt])}function pickVisit(xt,$t){var Ct=xt.items,kt,Mt;if(!Ct||!Ct.length)return null;const Ft=zorder(xt);for(Ft&&Ft.length&&(Ct=Ft),Mt=Ct.length;--Mt>=0;)if(kt=$t(Ct[Mt]))return kt;if(Ct===Ft){for(Ct=xt.items,Mt=Ct.length;--Mt>=0;)if(!Ct[Mt].zindex&&(kt=$t(Ct[Mt])))return kt}return null}function drawAll(xt){return function($t,Ct,kt){visit(Ct,Mt=>{(!kt||kt.intersects(Mt.bounds))&&drawPath(xt,$t,Mt,Mt)})}}function drawOne(xt){return function($t,Ct,kt){Ct.items.length&&(!kt||kt.intersects(Ct.bounds))&&drawPath(xt,$t,Ct.items[0],Ct.items)}}function drawPath(xt,$t,Ct,kt){var Mt=Ct.opacity==null?1:Ct.opacity;Mt!==0&&(xt($t,kt)||(blend($t,Ct),Ct.fill&&fill($t,Ct,Mt)&&$t.fill(),Ct.stroke&&stroke($t,Ct,Mt)&&$t.stroke()))}function pick$1(xt){return xt=xt||truthy,function($t,Ct,kt,Mt,Ft,jt){return kt*=$t.pixelRatio,Mt*=$t.pixelRatio,pickVisit(Ct,Bt=>{const Vt=Bt.bounds;if(!(Vt&&!Vt.contains(Ft,jt)||!Vt)&&xt($t,Bt,kt,Mt,Ft,jt))return Bt})}}function hitPath(xt,$t){return function(Ct,kt,Mt,Ft){var jt=Array.isArray(kt)?kt[0]:kt,Bt=$t??jt.fill,Vt=jt.stroke&&Ct.isPointInStroke,zt,Ht;return Vt&&(zt=jt.strokeWidth,Ht=jt.strokeCap,Ct.lineWidth=zt??1,Ct.lineCap=Ht??"butt"),xt(Ct,kt)?!1:Bt&&Ct.isPointInPath(Mt,Ft)||Vt&&Ct.isPointInStroke(Mt,Ft)}}function pickPath(xt){return pick$1(hitPath(xt))}function translate$2(xt,$t){return"translate("+xt+","+$t+")"}function rotate(xt){return"rotate("+xt+")"}function scale$3(xt,$t){return"scale("+xt+","+$t+")"}function translateItem(xt){return translate$2(xt.x||0,xt.y||0)}function rotateItem(xt){return translate$2(xt.x||0,xt.y||0)+(xt.angle?" "+rotate(xt.angle):"")}function transformItem(xt){return translate$2(xt.x||0,xt.y||0)+(xt.angle?" "+rotate(xt.angle):"")+(xt.scaleX||xt.scaleY?" "+scale$3(xt.scaleX||1,xt.scaleY||1):"")}function markItemPath(xt,$t,Ct){function kt(jt,Bt){jt("transform",rotateItem(Bt)),jt("d",$t(null,Bt))}function Mt(jt,Bt){return $t(boundContext(jt,Bt.angle),Bt),boundStroke(jt,Bt).translate(Bt.x||0,Bt.y||0)}function Ft(jt,Bt){var Vt=Bt.x||0,zt=Bt.y||0,Ht=Bt.angle||0;jt.translate(Vt,zt),Ht&&jt.rotate(Ht*=DegToRad),jt.beginPath(),$t(jt,Bt),Ht&&jt.rotate(-Ht),jt.translate(-Vt,-zt)}return{type:xt,tag:"path",nested:!1,attr:kt,bound:Mt,draw:drawAll(Ft),pick:pickPath(Ft),isect:Ct||intersectPath(Ft)}}var arc$2=markItemPath("arc",arc$1$1);function pickArea(xt,$t){for(var Ct=xt[0].orient==="horizontal"?$t[1]:$t[0],kt=xt[0].orient==="horizontal"?"y":"x",Mt=xt.length,Ft=1/0,jt,Bt;--Mt>=0;)xt[Mt].defined!==!1&&(Bt=Math.abs(xt[Mt][kt]-Ct),Bt<Ft&&(Ft=Bt,jt=xt[Mt]));return jt}function pickLine(xt,$t){for(var Ct=Math.pow(xt[0].strokeWidth||1,2),kt=xt.length,Mt,Ft,jt;--kt>=0;)if(xt[kt].defined!==!1&&(Mt=xt[kt].x-$t[0],Ft=xt[kt].y-$t[1],jt=Mt*Mt+Ft*Ft,jt<Ct))return xt[kt];return null}function pickTrail(xt,$t){for(var Ct=xt.length,kt,Mt,Ft;--Ct>=0;)if(xt[Ct].defined!==!1&&(kt=xt[Ct].x-$t[0],Mt=xt[Ct].y-$t[1],Ft=kt*kt+Mt*Mt,kt=xt[Ct].size||1,Ft<kt*kt))return xt[Ct];return null}function markMultiItemPath(xt,$t,Ct){function kt(Vt,zt){var Ht=zt.mark.items;Ht.length&&Vt("d",$t(null,Ht))}function Mt(Vt,zt){var Ht=zt.items;return Ht.length===0?Vt:($t(boundContext(Vt),Ht),boundStroke(Vt,Ht[0]))}function Ft(Vt,zt){Vt.beginPath(),$t(Vt,zt)}const jt=hitPath(Ft);function Bt(Vt,zt,Ht,Gt,qt,Wt){var Yt=zt.items,Kt=zt.bounds;return!Yt||!Yt.length||Kt&&!Kt.contains(qt,Wt)?null:(Ht*=Vt.pixelRatio,Gt*=Vt.pixelRatio,jt(Vt,Yt,Ht,Gt)?Yt[0]:null)}return{type:xt,tag:"path",nested:!0,attr:kt,bound:Mt,draw:drawOne(Ft),pick:Bt,isect:intersectPoint,tip:Ct}}var area$2=markMultiItemPath("area",area$1$1,pickArea);function clip$2(xt,$t){var Ct=$t.clip;xt.save(),isFunction$1(Ct)?(xt.beginPath(),Ct(xt),xt.clip()):clipGroup(xt,$t.group)}function clipGroup(xt,$t){xt.beginPath(),hasCornerRadius($t)?rectangle(xt,$t,0,0):xt.rect(0,0,$t.width||0,$t.height||0),xt.clip()}function offset$1(xt){const $t=value$2(xt.strokeWidth,1);return xt.strokeOffset!=null?xt.strokeOffset:xt.stroke&&$t>.5&&$t<1.5?.5-Math.abs($t-1):0}function attr$5(xt,$t){xt("transform",translateItem($t))}function emitRectangle(xt,$t){const Ct=offset$1($t);xt("d",rectangle(null,$t,Ct,Ct))}function background$1(xt,$t){xt("class","background"),xt("aria-hidden",!0),emitRectangle(xt,$t)}function foreground(xt,$t){xt("class","foreground"),xt("aria-hidden",!0),$t.strokeForeground?emitRectangle(xt,$t):xt("d","")}function content(xt,$t,Ct){const kt=$t.clip?clip$1(Ct,$t,$t):null;xt("clip-path",kt)}function bound$5(xt,$t){if(!$t.clip&&$t.items){const Ct=$t.items,kt=Ct.length;for(let Mt=0;Mt<kt;++Mt)xt.union(Ct[Mt].bounds)}return($t.clip||$t.width||$t.height)&&!$t.noBound&&xt.add(0,0).add($t.width||0,$t.height||0),boundStroke(xt,$t),xt.translate($t.x||0,$t.y||0)}function rectanglePath(xt,$t,Ct,kt){const Mt=offset$1($t);xt.beginPath(),rectangle(xt,$t,(Ct||0)+Mt,(kt||0)+Mt)}const hitBackground=hitPath(rectanglePath),hitForeground=hitPath(rectanglePath,!1),hitCorner=hitPath(rectanglePath,!0);function draw$4(xt,$t,Ct,kt){visit($t,Mt=>{const Ft=Mt.x||0,jt=Mt.y||0,Bt=Mt.strokeForeground,Vt=Mt.opacity==null?1:Mt.opacity;(Mt.stroke||Mt.fill)&&Vt&&(rectanglePath(xt,Mt,Ft,jt),blend(xt,Mt),Mt.fill&&fill(xt,Mt,Vt)&&xt.fill(),Mt.stroke&&!Bt&&stroke(xt,Mt,Vt)&&xt.stroke()),xt.save(),xt.translate(Ft,jt),Mt.clip&&clipGroup(xt,Mt),Ct&&Ct.translate(-Ft,-jt),visit(Mt,zt=>{(zt.marktype==="group"||kt==null||kt.includes(zt.marktype))&&this.draw(xt,zt,Ct,kt)}),Ct&&Ct.translate(Ft,jt),xt.restore(),Bt&&Mt.stroke&&Vt&&(rectanglePath(xt,Mt,Ft,jt),blend(xt,Mt),stroke(xt,Mt,Vt)&&xt.stroke())})}function pick$2(xt,$t,Ct,kt,Mt,Ft){if($t.bounds&&!$t.bounds.contains(Mt,Ft)||!$t.items)return null;const jt=Ct*xt.pixelRatio,Bt=kt*xt.pixelRatio;return pickVisit($t,Vt=>{let zt,Ht,Gt;const qt=Vt.bounds;if(qt&&!qt.contains(Mt,Ft))return;Ht=Vt.x||0,Gt=Vt.y||0;const Wt=Ht+(Vt.width||0),Yt=Gt+(Vt.height||0),Kt=Vt.clip;if(Kt&&(Mt<Ht||Mt>Wt||Ft<Gt||Ft>Yt))return;if(xt.save(),xt.translate(Ht,Gt),Ht=Mt-Ht,Gt=Ft-Gt,Kt&&hasCornerRadius(Vt)&&!hitCorner(xt,Vt,jt,Bt))return xt.restore(),null;const Xt=Vt.strokeForeground,Qt=$t.interactive!==!1;return Qt&&Xt&&Vt.stroke&&hitForeground(xt,Vt,jt,Bt)?(xt.restore(),Vt):(zt=pickVisit(Vt,Jt=>pickMark(Jt,Ht,Gt)?this.pick(Jt,Ct,kt,Ht,Gt):null),!zt&&Qt&&(Vt.fill||!Xt&&Vt.stroke)&&hitBackground(xt,Vt,jt,Bt)&&(zt=Vt),xt.restore(),zt||null)})}function pickMark(xt,$t,Ct){return(xt.interactive!==!1||xt.marktype==="group")&&xt.bounds&&xt.bounds.contains($t,Ct)}var group={type:"group",tag:"g",nested:!1,attr:attr$5,bound:bound$5,draw:draw$4,pick:pick$2,isect:intersectRect,content,background:background$1,foreground},metadata={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function getImage(xt,$t){var Ct=xt.image;return(!Ct||xt.url&&xt.url!==Ct.url)&&(Ct={complete:!1,width:0,height:0},$t.loadImage(xt.url).then(kt=>{xt.image=kt,xt.image.url=xt.url})),Ct}function imageWidth(xt,$t){return xt.width!=null?xt.width:!$t||!$t.width?0:xt.aspect!==!1&&xt.height?xt.height*$t.width/$t.height:$t.width}function imageHeight(xt,$t){return xt.height!=null?xt.height:!$t||!$t.height?0:xt.aspect!==!1&&xt.width?xt.width*$t.height/$t.width:$t.height}function imageXOffset(xt,$t){return xt==="center"?$t/2:xt==="right"?$t:0}function imageYOffset(xt,$t){return xt==="middle"?$t/2:xt==="bottom"?$t:0}function attr$4(xt,$t,Ct){const kt=getImage($t,Ct),Mt=imageWidth($t,kt),Ft=imageHeight($t,kt),jt=($t.x||0)-imageXOffset($t.align,Mt),Bt=($t.y||0)-imageYOffset($t.baseline,Ft),Vt=!kt.src&&kt.toDataURL?kt.toDataURL():kt.src||"";xt("href",Vt,metadata["xmlns:xlink"],"xlink:href"),xt("transform",translate$2(jt,Bt)),xt("width",Mt),xt("height",Ft),xt("preserveAspectRatio",$t.aspect===!1?"none":"xMidYMid")}function bound$4(xt,$t){const Ct=$t.image,kt=imageWidth($t,Ct),Mt=imageHeight($t,Ct),Ft=($t.x||0)-imageXOffset($t.align,kt),jt=($t.y||0)-imageYOffset($t.baseline,Mt);return xt.set(Ft,jt,Ft+kt,jt+Mt)}function draw$3(xt,$t,Ct){visit($t,kt=>{if(Ct&&!Ct.intersects(kt.bounds))return;const Mt=getImage(kt,this);let Ft=imageWidth(kt,Mt),jt=imageHeight(kt,Mt);if(Ft===0||jt===0)return;let Bt=(kt.x||0)-imageXOffset(kt.align,Ft),Vt=(kt.y||0)-imageYOffset(kt.baseline,jt),zt,Ht,Gt,qt;kt.aspect!==!1&&(Ht=Mt.width/Mt.height,Gt=kt.width/kt.height,Ht===Ht&&Gt===Gt&&Ht!==Gt&&(Gt<Ht?(qt=Ft/Ht,Vt+=(jt-qt)/2,jt=qt):(qt=jt*Ht,Bt+=(Ft-qt)/2,Ft=qt))),(Mt.complete||Mt.toDataURL)&&(blend(xt,kt),xt.globalAlpha=(zt=kt.opacity)!=null?zt:1,xt.imageSmoothingEnabled=kt.smooth!==!1,xt.drawImage(Mt,Bt,Vt,Ft,jt))})}var image$1={type:"image",tag:"image",nested:!1,attr:attr$4,bound:bound$4,draw:draw$3,pick:pick$1(),isect:truthy,get:getImage,xOffset:imageXOffset,yOffset:imageYOffset},line$2=markMultiItemPath("line",line$1$1,pickLine);function attr$3(xt,$t){var Ct=$t.scaleX||1,kt=$t.scaleY||1;(Ct!==1||kt!==1)&&xt("vector-effect","non-scaling-stroke"),xt("transform",transformItem($t)),xt("d",$t.path)}function path$1(xt,$t){var Ct=$t.path;if(Ct==null)return!0;var kt=$t.x||0,Mt=$t.y||0,Ft=$t.scaleX||1,jt=$t.scaleY||1,Bt=($t.angle||0)*DegToRad,Vt=$t.pathCache;(!Vt||Vt.path!==Ct)&&(($t.pathCache=Vt=parse$3(Ct)).path=Ct),Bt&&xt.rotate&&xt.translate?(xt.translate(kt,Mt),xt.rotate(Bt),pathRender(xt,Vt,0,0,Ft,jt),xt.rotate(-Bt),xt.translate(-kt,-Mt)):pathRender(xt,Vt,kt,Mt,Ft,jt)}function bound$3(xt,$t){return path$1(boundContext(xt,$t.angle),$t)?xt.set(0,0,0,0):boundStroke(xt,$t,!0)}var path$2={type:"path",tag:"path",nested:!1,attr:attr$3,bound:bound$3,draw:drawAll(path$1),pick:pickPath(path$1),isect:intersectPath(path$1)};function attr$2(xt,$t){xt("d",rectangle(null,$t))}function bound$2(xt,$t){var Ct,kt;return boundStroke(xt.set(Ct=$t.x||0,kt=$t.y||0,Ct+$t.width||0,kt+$t.height||0),$t)}function draw$2(xt,$t){xt.beginPath(),rectangle(xt,$t)}var rect$1={type:"rect",tag:"path",nested:!1,attr:attr$2,bound:bound$2,draw:drawAll(draw$2),pick:pickPath(draw$2),isect:intersectRect};function attr$1(xt,$t){xt("transform",translateItem($t)),xt("x2",$t.x2!=null?$t.x2-($t.x||0):0),xt("y2",$t.y2!=null?$t.y2-($t.y||0):0)}function bound$1(xt,$t){var Ct,kt;return boundStroke(xt.set(Ct=$t.x||0,kt=$t.y||0,$t.x2!=null?$t.x2:Ct,$t.y2!=null?$t.y2:kt),$t)}function path(xt,$t,Ct){var kt,Mt,Ft,jt;return $t.stroke&&stroke(xt,$t,Ct)?(kt=$t.x||0,Mt=$t.y||0,Ft=$t.x2!=null?$t.x2:kt,jt=$t.y2!=null?$t.y2:Mt,xt.beginPath(),xt.moveTo(kt,Mt),xt.lineTo(Ft,jt),!0):!1}function draw$1(xt,$t,Ct){visit($t,kt=>{if(!(Ct&&!Ct.intersects(kt.bounds))){var Mt=kt.opacity==null?1:kt.opacity;Mt&&path(xt,kt,Mt)&&(blend(xt,kt),xt.stroke())}})}function hit$1(xt,$t,Ct,kt){return xt.isPointInStroke?path(xt,$t,1)&&xt.isPointInStroke(Ct,kt):!1}var rule$2={type:"rule",tag:"line",nested:!1,attr:attr$1,bound:bound$1,draw:draw$1,pick:pick$1(hit$1),isect:intersectRule},shape=markItemPath("shape",shape$1),symbol=markItemPath("symbol",symbol$1,intersectPoint);const widthCache=lruCache$1();var textMetrics={height:fontSize,measureWidth,estimateWidth,width:estimateWidth,canvas:useCanvas};useCanvas(!0);function useCanvas(xt){textMetrics.width=xt&&context$2?measureWidth:estimateWidth}function estimateWidth(xt,$t){return _estimateWidth(textValue(xt,$t),fontSize(xt))}function _estimateWidth(xt,$t){return~~(.8*xt.length*$t)}function measureWidth(xt,$t){return fontSize(xt)<=0||!($t=textValue(xt,$t))?0:_measureWidth($t,font$1(xt))}function _measureWidth(xt,$t){const Ct=`(${$t}) ${xt}`;let kt=widthCache.get(Ct);return kt===void 0&&(context$2.font=$t,kt=context$2.measureText(xt).width,widthCache.set(Ct,kt)),kt}function fontSize(xt){return xt.fontSize!=null?+xt.fontSize||0:11}function lineHeight(xt){return xt.lineHeight!=null?xt.lineHeight:fontSize(xt)+2}function lineArray(xt){return isArray(xt)?xt.length>1?xt:xt[0]:xt}function textLines(xt){return lineArray(xt.lineBreak&&xt.text&&!isArray(xt.text)?xt.text.split(xt.lineBreak):xt.text)}function multiLineOffset(xt){const $t=textLines(xt);return(isArray($t)?$t.length-1:0)*lineHeight(xt)}function textValue(xt,$t){const Ct=$t==null?"":($t+"").trim();return xt.limit>0&&Ct.length?truncate(xt,Ct):Ct}function widthGetter(xt){if(textMetrics.width===measureWidth){const $t=font$1(xt);return Ct=>_measureWidth(Ct,$t)}else if(textMetrics.width===estimateWidth){const $t=fontSize(xt);return Ct=>_estimateWidth(Ct,$t)}else return $t=>textMetrics.width(xt,$t)}function truncate(xt,$t){var Ct=+xt.limit,kt=widthGetter(xt);if(kt($t)<Ct)return $t;var Mt=xt.ellipsis||"",Ft=xt.dir==="rtl",jt=0,Bt=$t.length,Vt;if(Ct-=kt(Mt),Ft){for(;jt<Bt;)Vt=jt+Bt>>>1,kt($t.slice(Vt))>Ct?jt=Vt+1:Bt=Vt;return Mt+$t.slice(jt)}else{for(;jt<Bt;)Vt=1+(jt+Bt>>>1),kt($t.slice(0,Vt))<Ct?jt=Vt:Bt=Vt-1;return $t.slice(0,jt)+Mt}}function fontFamily(xt,$t){var Ct=xt.font;return($t&&Ct?String(Ct).replace(/"/g,"'"):Ct)||"sans-serif"}function font$1(xt,$t){return(xt.fontStyle?xt.fontStyle+" ":"")+(xt.fontVariant?xt.fontVariant+" ":"")+(xt.fontWeight?xt.fontWeight+" ":"")+fontSize(xt)+"px "+fontFamily(xt,$t)}function offset$2(xt){var $t=xt.baseline,Ct=fontSize(xt);return Math.round($t==="top"?.79*Ct:$t==="middle"?.3*Ct:$t==="bottom"?-.21*Ct:$t==="line-top"?.29*Ct+.5*lineHeight(xt):$t==="line-bottom"?.29*Ct-.5*lineHeight(xt):0)}const textAlign={left:"start",center:"middle",right:"end"},tempBounds$1=new Bounds;function anchorPoint(xt){var $t=xt.x||0,Ct=xt.y||0,kt=xt.radius||0,Mt;return kt&&(Mt=(xt.theta||0)-HalfPi,$t+=kt*Math.cos(Mt),Ct+=kt*Math.sin(Mt)),tempBounds$1.x1=$t,tempBounds$1.y1=Ct,tempBounds$1}function attr(xt,$t){var Ct=$t.dx||0,kt=($t.dy||0)+offset$2($t),Mt=anchorPoint($t),Ft=Mt.x1,jt=Mt.y1,Bt=$t.angle||0,Vt;xt("text-anchor",textAlign[$t.align]||"start"),Bt?(Vt=translate$2(Ft,jt)+" "+rotate(Bt),(Ct||kt)&&(Vt+=" "+translate$2(Ct,kt))):Vt=translate$2(Ft+Ct,jt+kt),xt("transform",Vt)}function bound(xt,$t,Ct){var kt=textMetrics.height($t),Mt=$t.align,Ft=anchorPoint($t),jt=Ft.x1,Bt=Ft.y1,Vt=$t.dx||0,zt=($t.dy||0)+offset$2($t)-Math.round(.8*kt),Ht=textLines($t),Gt;if(isArray(Ht)?(kt+=lineHeight($t)*(Ht.length-1),Gt=Ht.reduce((qt,Wt)=>Math.max(qt,textMetrics.width($t,Wt)),0)):Gt=textMetrics.width($t,Ht),Mt==="center"?Vt-=Gt/2:Mt==="right"&&(Vt-=Gt),xt.set(Vt+=jt,zt+=Bt,Vt+Gt,zt+kt),$t.angle&&!Ct)xt.rotate($t.angle*DegToRad,jt,Bt);else if(Ct===2)return xt.rotatedPoints($t.angle*DegToRad,jt,Bt);return xt}function draw$5(xt,$t,Ct){visit($t,kt=>{var Mt=kt.opacity==null?1:kt.opacity,Ft,jt,Bt,Vt,zt,Ht,Gt;if(!(Ct&&!Ct.intersects(kt.bounds)||Mt===0||kt.fontSize<=0||kt.text==null||kt.text.length===0)){if(xt.font=font$1(kt),xt.textAlign=kt.align||"left",Ft=anchorPoint(kt),jt=Ft.x1,Bt=Ft.y1,kt.angle&&(xt.save(),xt.translate(jt,Bt),xt.rotate(kt.angle*DegToRad),jt=Bt=0),jt+=kt.dx||0,Bt+=(kt.dy||0)+offset$2(kt),Ht=textLines(kt),blend(xt,kt),isArray(Ht))for(zt=lineHeight(kt),Vt=0;Vt<Ht.length;++Vt)Gt=textValue(kt,Ht[Vt]),kt.fill&&fill(xt,kt,Mt)&&xt.fillText(Gt,jt,Bt),kt.stroke&&stroke(xt,kt,Mt)&&xt.strokeText(Gt,jt,Bt),Bt+=zt;else Gt=textValue(kt,Ht),kt.fill&&fill(xt,kt,Mt)&&xt.fillText(Gt,jt,Bt),kt.stroke&&stroke(xt,kt,Mt)&&xt.strokeText(Gt,jt,Bt);kt.angle&&xt.restore()}})}function hit(xt,$t,Ct,kt,Mt,Ft){if($t.fontSize<=0)return!1;if(!$t.angle)return!0;var jt=anchorPoint($t),Bt=jt.x1,Vt=jt.y1,zt=bound(tempBounds$1,$t,1),Ht=-$t.angle*DegToRad,Gt=Math.cos(Ht),qt=Math.sin(Ht),Wt=Gt*Mt-qt*Ft+(Bt-Gt*Bt+qt*Vt),Yt=qt*Mt+Gt*Ft+(Vt-qt*Bt-Gt*Vt);return zt.contains(Wt,Yt)}function intersectText(xt,$t){const Ct=bound(tempBounds$1,xt,2);return intersectBoxLine($t,Ct[0],Ct[1],Ct[2],Ct[3])||intersectBoxLine($t,Ct[0],Ct[1],Ct[4],Ct[5])||intersectBoxLine($t,Ct[4],Ct[5],Ct[6],Ct[7])||intersectBoxLine($t,Ct[2],Ct[3],Ct[6],Ct[7])}var text$2={type:"text",tag:"text",nested:!1,attr,bound,draw:draw$5,pick:pick$1(hit),isect:intersectText},trail$2=markMultiItemPath("trail",trail$1,pickTrail),Marks={arc:arc$2,area:area$2,group,image:image$1,line:line$2,path:path$2,rect:rect$1,rule:rule$2,shape,symbol,text:text$2,trail:trail$2};function boundItem$1(xt,$t,Ct){var kt=Marks[xt.mark.marktype],Mt=$t||kt.bound;return kt.nested&&(xt=xt.mark),Mt(xt.bounds||(xt.bounds=new Bounds),xt,Ct)}var DUMMY={mark:null};function boundMark(xt,$t,Ct){var kt=Marks[xt.marktype],Mt=kt.bound,Ft=xt.items,jt=Ft&&Ft.length,Bt,Vt,zt,Ht;if(kt.nested)return jt?zt=Ft[0]:(DUMMY.mark=xt,zt=DUMMY),Ht=boundItem$1(zt,Mt,Ct),$t=$t&&$t.union(Ht)||Ht,$t;if($t=$t||xt.bounds&&xt.bounds.clear()||new Bounds,jt)for(Bt=0,Vt=Ft.length;Bt<Vt;++Bt)$t.union(boundItem$1(Ft[Bt],Mt,Ct));return xt.bounds=$t}const keys$2=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function sceneToJSON(xt,$t){return JSON.stringify(xt,keys$2,$t)}function sceneFromJSON(xt){const $t=typeof xt=="string"?JSON.parse(xt):xt;return initialize$1($t)}function initialize$1(xt){var $t=xt.marktype,Ct=xt.items,kt,Mt,Ft;if(Ct)for(Mt=0,Ft=Ct.length;Mt<Ft;++Mt)kt=$t?"mark":"group",Ct[Mt][kt]=xt,Ct[Mt].zindex&&(Ct[Mt][kt].zdirty=!0),($t||kt)==="group"&&initialize$1(Ct[Mt]);return $t&&boundMark(xt),xt}class Scenegraph{constructor($t){arguments.length?this.root=sceneFromJSON($t):(this.root=createMark({marktype:"group",name:"root",role:"frame"}),this.root.items=[new GroupItem(this.root)])}toJSON($t){return sceneToJSON(this.root,$t||0)}mark($t,Ct,kt){Ct=Ct||this.root.items[0];const Mt=createMark($t,Ct);return Ct.items[kt]=Mt,Mt.zindex&&(Mt.group.zdirty=!0),Mt}}function createMark(xt,$t){const Ct={bounds:new Bounds,clip:!!xt.clip,group:$t,interactive:xt.interactive!==!1,items:[],marktype:xt.marktype,name:xt.name||void 0,role:xt.role||void 0,zindex:xt.zindex||0};return xt.aria!=null&&(Ct.aria=xt.aria),xt.description&&(Ct.description=xt.description),Ct}function domCreate(xt,$t,Ct){return!xt&&typeof document<"u"&&document.createElement&&(xt=document),xt?Ct?xt.createElementNS(Ct,$t):xt.createElement($t):null}function domFind(xt,$t){$t=$t.toLowerCase();for(var Ct=xt.childNodes,kt=0,Mt=Ct.length;kt<Mt;++kt)if(Ct[kt].tagName.toLowerCase()===$t)return Ct[kt]}function domChild(xt,$t,Ct,kt){var Mt=xt.childNodes[$t],Ft;return(!Mt||Mt.tagName.toLowerCase()!==Ct.toLowerCase())&&(Ft=Mt||null,Mt=domCreate(xt.ownerDocument,Ct,kt),xt.insertBefore(Mt,Ft)),Mt}function domClear(xt,$t){for(var Ct=xt.childNodes,kt=Ct.length;kt>$t;)xt.removeChild(Ct[--kt]);return xt}function cssClass(xt){return"mark-"+xt.marktype+(xt.role?" role-"+xt.role:"")+(xt.name?" "+xt.name:"")}function point$2(xt,$t){const Ct=$t.getBoundingClientRect();return[xt.clientX-Ct.left-($t.clientLeft||0),xt.clientY-Ct.top-($t.clientTop||0)]}function resolveItem(xt,$t,Ct,kt){var Mt=xt&&xt.mark,Ft,jt;if(Mt&&(Ft=Marks[Mt.marktype]).tip){for(jt=point$2($t,Ct),jt[0]-=kt[0],jt[1]-=kt[1];xt=xt.mark.group;)jt[0]-=xt.x||0,jt[1]-=xt.y||0;xt=Ft.tip(Mt.items,jt)}return xt}let Handler$1=class{constructor($t,Ct){this._active=null,this._handlers={},this._loader=$t||loader(),this._tooltip=Ct||defaultTooltip$1}initialize($t,Ct,kt){return this._el=$t,this._obj=kt||null,this.origin(Ct)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin($t){return arguments.length?(this._origin=$t||[0,0],this):this._origin.slice()}scene($t){return arguments.length?(this._scene=$t,this):this._scene}on(){}off(){}_handlerIndex($t,Ct,kt){for(let Mt=$t?$t.length:0;--Mt>=0;)if($t[Mt].type===Ct&&(!kt||$t[Mt].handler===kt))return Mt;return-1}handlers($t){const Ct=this._handlers,kt=[];if($t)kt.push(...Ct[this.eventName($t)]);else for(const Mt in Ct)kt.push(...Ct[Mt]);return kt}eventName($t){const Ct=$t.indexOf(".");return Ct<0?$t:$t.slice(0,Ct)}handleHref($t,Ct,kt){this._loader.sanitize(kt,{context:"href"}).then(Mt=>{const Ft=new MouseEvent($t.type,$t),jt=domCreate(null,"a");for(const Bt in Mt)jt.setAttribute(Bt,Mt[Bt]);jt.dispatchEvent(Ft)}).catch(()=>{})}handleTooltip($t,Ct,kt){if(Ct&&Ct.tooltip!=null){Ct=resolveItem(Ct,$t,this.canvas(),this._origin);const Mt=kt&&Ct&&Ct.tooltip||null;this._tooltip.call(this._obj,this,$t,Ct,Mt)}}getItemBoundingClientRect($t){const Ct=this.canvas();if(!Ct)return;const kt=Ct.getBoundingClientRect(),Mt=this._origin,Ft=$t.bounds,jt=Ft.width(),Bt=Ft.height();let Vt=Ft.x1+Mt[0]+kt.left,zt=Ft.y1+Mt[1]+kt.top;for(;$t.mark&&($t=$t.mark.group);)Vt+=$t.x||0,zt+=$t.y||0;return{x:Vt,y:zt,width:jt,height:Bt,left:Vt,top:zt,right:Vt+jt,bottom:zt+Bt}}};function defaultTooltip$1(xt,$t,Ct,kt){xt.element().setAttribute("title",kt||"")}class Renderer{constructor($t){this._el=null,this._bgcolor=null,this._loader=new ResourceLoader($t)}initialize($t,Ct,kt,Mt,Ft){return this._el=$t,this.resize(Ct,kt,Mt,Ft)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background($t){return arguments.length===0?this._bgcolor:(this._bgcolor=$t,this)}resize($t,Ct,kt,Mt){return this._width=$t,this._height=Ct,this._origin=kt||[0,0],this._scale=Mt||1,this}dirty(){}render($t,Ct){const kt=this;return kt._call=function(){kt._render($t,Ct)},kt._call(),kt._call=null,kt}_render(){}renderAsync($t,Ct){const kt=this.render($t,Ct);return this._ready?this._ready.then(()=>kt):Promise.resolve(kt)}_load($t,Ct){var kt=this,Mt=kt._loader[$t](Ct);if(!kt._ready){const Ft=kt._call;kt._ready=kt._loader.ready().then(jt=>{jt&&Ft(),kt._ready=null})}return Mt}sanitizeURL($t){return this._load("sanitizeURL",$t)}loadImage($t){return this._load("loadImage",$t)}}const KeyDownEvent="keydown",KeyPressEvent="keypress",KeyUpEvent="keyup",DragEnterEvent="dragenter",DragLeaveEvent="dragleave",DragOverEvent="dragover",PointerDownEvent="pointerdown",PointerUpEvent="pointerup",PointerMoveEvent="pointermove",PointerOutEvent="pointerout",PointerOverEvent="pointerover",MouseDownEvent="mousedown",MouseUpEvent="mouseup",MouseMoveEvent="mousemove",MouseOutEvent="mouseout",MouseOverEvent="mouseover",ClickEvent="click",DoubleClickEvent="dblclick",WheelEvent="wheel",MouseWheelEvent="mousewheel",TouchStartEvent="touchstart",TouchMoveEvent="touchmove",TouchEndEvent="touchend",Events=[KeyDownEvent,KeyPressEvent,KeyUpEvent,DragEnterEvent,DragLeaveEvent,DragOverEvent,PointerDownEvent,PointerUpEvent,PointerMoveEvent,PointerOutEvent,PointerOverEvent,MouseDownEvent,MouseUpEvent,MouseMoveEvent,MouseOutEvent,MouseOverEvent,ClickEvent,DoubleClickEvent,WheelEvent,MouseWheelEvent,TouchStartEvent,TouchMoveEvent,TouchEndEvent],TooltipShowEvent=PointerMoveEvent,TooltipHideEvent=MouseOutEvent,HrefEvent=ClickEvent;class CanvasHandler extends Handler$1{constructor($t,Ct){super($t,Ct),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=Events,this.pointermove=move([PointerMoveEvent,MouseMoveEvent],[PointerOverEvent,MouseOverEvent],[PointerOutEvent,MouseOutEvent]),this.dragover=move([DragOverEvent],[DragEnterEvent],[DragLeaveEvent]),this.pointerout=inactive([PointerOutEvent,MouseOutEvent]),this.dragleave=inactive([DragLeaveEvent])}initialize($t,Ct,kt){return this._canvas=$t&&domFind($t,"canvas"),[ClickEvent,MouseDownEvent,PointerDownEvent,PointerMoveEvent,PointerOutEvent,DragLeaveEvent].forEach(Mt=>eventListenerCheck(this,Mt)),super.initialize($t,Ct,kt)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll($t){this.fire(MouseWheelEvent,$t)}pointerdown($t){this._down=this._active,this.fire(PointerDownEvent,$t)}mousedown($t){this._down=this._active,this.fire(MouseDownEvent,$t)}click($t){this._down===this._active&&(this.fire(ClickEvent,$t),this._down=null)}touchstart($t){this._touch=this.pickEvent($t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(TouchStartEvent,$t,!0)}touchmove($t){this.fire(TouchMoveEvent,$t,!0)}touchend($t){this.fire(TouchEndEvent,$t,!0),this._touch=null}fire($t,Ct,kt){const Mt=kt?this._touch:this._active,Ft=this._handlers[$t];if(Ct.vegaType=$t,$t===HrefEvent&&Mt&&Mt.href?this.handleHref(Ct,Mt,Mt.href):($t===TooltipShowEvent||$t===TooltipHideEvent)&&this.handleTooltip(Ct,Mt,$t!==TooltipHideEvent),Ft)for(let jt=0,Bt=Ft.length;jt<Bt;++jt)Ft[jt].handler.call(this._obj,Ct,Mt)}on($t,Ct){const kt=this.eventName($t),Mt=this._handlers;return this._handlerIndex(Mt[kt],$t,Ct)<0&&(eventListenerCheck(this,$t),(Mt[kt]||(Mt[kt]=[])).push({type:$t,handler:Ct})),this}off($t,Ct){const kt=this.eventName($t),Mt=this._handlers[kt],Ft=this._handlerIndex(Mt,$t,Ct);return Ft>=0&&Mt.splice(Ft,1),this}pickEvent($t){const Ct=point$2($t,this._canvas),kt=this._origin;return this.pick(this._scene,Ct[0],Ct[1],Ct[0]-kt[0],Ct[1]-kt[1])}pick($t,Ct,kt,Mt,Ft){const jt=this.context();return Marks[$t.marktype].pick.call(this,jt,$t,Ct,kt,Mt,Ft)}}const eventBundle=xt=>xt===TouchStartEvent||xt===TouchMoveEvent||xt===TouchEndEvent?[TouchStartEvent,TouchMoveEvent,TouchEndEvent]:[xt];function eventListenerCheck(xt,$t){eventBundle($t).forEach(Ct=>addEventListener(xt,Ct))}function addEventListener(xt,$t){const Ct=xt.canvas();Ct&&!xt._events[$t]&&(xt._events[$t]=1,Ct.addEventListener($t,xt[$t]?kt=>xt[$t](kt):kt=>xt.fire($t,kt)))}function fireAll(xt,$t,Ct){$t.forEach(kt=>xt.fire(kt,Ct))}function move(xt,$t,Ct){return function(kt){const Mt=this._active,Ft=this.pickEvent(kt);Ft===Mt?fireAll(this,xt,kt):((!Mt||!Mt.exit)&&fireAll(this,Ct,kt),this._active=Ft,fireAll(this,$t,kt),fireAll(this,xt,kt))}}function inactive(xt){return function($t){fireAll(this,xt,$t),this._active=null}}function devicePixelRatio(){return typeof window<"u"&&window.devicePixelRatio||1}function resize(xt,$t,Ct,kt,Mt,Ft){const jt=typeof HTMLElement<"u"&&xt instanceof HTMLElement&&xt.parentNode!=null,Bt=xt.getContext("2d"),Vt=jt?devicePixelRatio():Mt;xt.width=$t*Vt,xt.height=Ct*Vt;for(const zt in Ft)Bt[zt]=Ft[zt];return jt&&Vt!==1&&(xt.style.width=$t+"px",xt.style.height=Ct+"px"),Bt.pixelRatio=Vt,Bt.setTransform(Vt,0,0,Vt,Vt*kt[0],Vt*kt[1]),xt}class CanvasRenderer extends Renderer{constructor($t){super($t),this._options={},this._redraw=!1,this._dirty=new Bounds,this._tempb=new Bounds}initialize($t,Ct,kt,Mt,Ft,jt){return this._options=jt||{},this._canvas=this._options.externalContext?null:domCanvas(1,1,this._options.type),$t&&this._canvas&&(domClear($t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize($t,Ct,kt,Mt,Ft)}resize($t,Ct,kt,Mt){if(super.resize($t,Ct,kt,Mt),this._canvas)resize(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const Ft=this._options.externalContext;Ft||error("CanvasRenderer is missing a valid canvas or context"),Ft.scale(this._scale,this._scale),Ft.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty($t){const Ct=this._tempb.clear().union($t.bounds);let kt=$t.mark.group;for(;kt;)Ct.translate(kt.x||0,kt.y||0),kt=kt.mark.group;this._dirty.union(Ct)}_render($t,Ct){const kt=this.context(),Mt=this._origin,Ft=this._width,jt=this._height,Bt=this._dirty,Vt=viewBounds(Mt,Ft,jt);kt.save();const zt=this._redraw||Bt.empty()?(this._redraw=!1,Vt.expand(1)):clipToBounds(kt,Vt.intersect(Bt),Mt);return this.clear(-Mt[0],-Mt[1],Ft,jt),this.draw(kt,$t,zt,Ct),kt.restore(),Bt.clear(),this}draw($t,Ct,kt,Mt){if(Ct.marktype!=="group"&&Mt!=null&&!Mt.includes(Ct.marktype))return;const Ft=Marks[Ct.marktype];Ct.clip&&clip$2($t,Ct),Ft.draw.call(this,$t,Ct,kt,Mt),Ct.clip&&$t.restore()}clear($t,Ct,kt,Mt){const Ft=this._options,jt=this.context();Ft.type!=="pdf"&&!Ft.externalContext&&jt.clearRect($t,Ct,kt,Mt),this._bgcolor!=null&&(jt.fillStyle=this._bgcolor,jt.fillRect($t,Ct,kt,Mt))}}const viewBounds=(xt,$t,Ct)=>new Bounds().set(0,0,$t,Ct).translate(-xt[0],-xt[1]);function clipToBounds(xt,$t,Ct){return $t.expand(1).round(),xt.pixelRatio%1&&$t.scale(xt.pixelRatio).round().scale(1/xt.pixelRatio),$t.translate(-(Ct[0]%1),-(Ct[1]%1)),xt.beginPath(),xt.rect($t.x1,$t.y1,$t.width(),$t.height()),xt.clip(),$t}class SVGHandler extends Handler$1{constructor($t,Ct){super($t,Ct);const kt=this;kt._hrefHandler=listener(kt,(Mt,Ft)=>{Ft&&Ft.href&&kt.handleHref(Mt,Ft,Ft.href)}),kt._tooltipHandler=listener(kt,(Mt,Ft)=>{kt.handleTooltip(Mt,Ft,Mt.type!==TooltipHideEvent)})}initialize($t,Ct,kt){let Mt=this._svg;return Mt&&(Mt.removeEventListener(HrefEvent,this._hrefHandler),Mt.removeEventListener(TooltipShowEvent,this._tooltipHandler),Mt.removeEventListener(TooltipHideEvent,this._tooltipHandler)),this._svg=Mt=$t&&domFind($t,"svg"),Mt&&(Mt.addEventListener(HrefEvent,this._hrefHandler),Mt.addEventListener(TooltipShowEvent,this._tooltipHandler),Mt.addEventListener(TooltipHideEvent,this._tooltipHandler)),super.initialize($t,Ct,kt)}canvas(){return this._svg}on($t,Ct){const kt=this.eventName($t),Mt=this._handlers;if(this._handlerIndex(Mt[kt],$t,Ct)<0){const jt={type:$t,handler:Ct,listener:listener(this,Ct)};(Mt[kt]||(Mt[kt]=[])).push(jt),this._svg&&this._svg.addEventListener(kt,jt.listener)}return this}off($t,Ct){const kt=this.eventName($t),Mt=this._handlers[kt],Ft=this._handlerIndex(Mt,$t,Ct);return Ft>=0&&(this._svg&&this._svg.removeEventListener(kt,Mt[Ft].listener),Mt.splice(Ft,1)),this}}const listener=(xt,$t)=>Ct=>{let kt=Ct.target.__data__;kt=Array.isArray(kt)?kt[0]:kt,Ct.vegaType=Ct.type,$t.call(xt._obj,Ct,kt)},ARIA_HIDDEN="aria-hidden",ARIA_LABEL="aria-label",ARIA_ROLE="role",ARIA_ROLEDESCRIPTION="aria-roledescription",GRAPHICS_OBJECT="graphics-object",GRAPHICS_SYMBOL="graphics-symbol",bundle=(xt,$t,Ct)=>({[ARIA_ROLE]:xt,[ARIA_ROLEDESCRIPTION]:$t,[ARIA_LABEL]:Ct||void 0}),AriaIgnore=toSet(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),AriaGuides={axis:{desc:"axis",caption:axisCaption},legend:{desc:"legend",caption:legendCaption},"title-text":{desc:"title",caption:xt=>`Title text '${titleCaption(xt)}'`},"title-subtitle":{desc:"subtitle",caption:xt=>`Subtitle text '${titleCaption(xt)}'`}},AriaEncode={ariaRole:ARIA_ROLE,ariaRoleDescription:ARIA_ROLEDESCRIPTION,description:ARIA_LABEL};function ariaItemAttributes(xt,$t){const Ct=$t.aria===!1;if(xt(ARIA_HIDDEN,Ct||void 0),Ct||$t.description==null)for(const kt in AriaEncode)xt(AriaEncode[kt],void 0);else{const kt=$t.mark.marktype;xt(ARIA_LABEL,$t.description),xt(ARIA_ROLE,$t.ariaRole||(kt==="group"?GRAPHICS_OBJECT:GRAPHICS_SYMBOL)),xt(ARIA_ROLEDESCRIPTION,$t.ariaRoleDescription||`${kt} mark`)}}function ariaMarkAttributes(xt){return xt.aria===!1?{[ARIA_HIDDEN]:!0}:AriaIgnore[xt.role]?null:AriaGuides[xt.role]?ariaGuide(xt,AriaGuides[xt.role]):ariaMark(xt)}function ariaMark(xt){const $t=xt.marktype,Ct=$t==="group"||$t==="text"||xt.items.some(kt=>kt.description!=null&&kt.aria!==!1);return bundle(Ct?GRAPHICS_OBJECT:GRAPHICS_SYMBOL,`${$t} mark container`,xt.description)}function ariaGuide(xt,$t){try{const Ct=xt.items[0],kt=$t.caption||(()=>"");return bundle($t.role||GRAPHICS_SYMBOL,$t.desc,Ct.description||kt(Ct))}catch{return null}}function titleCaption(xt){return array$2(xt.text).join(" ")}function axisCaption(xt){const $t=xt.datum,Ct=xt.orient,kt=$t.title?extractTitle(xt):null,Mt=xt.context,Ft=Mt.scales[$t.scale].value,jt=Mt.dataflow.locale(),Bt=Ft.type;return`${Ct==="left"||Ct==="right"?"Y":"X"}-axis`+(kt?` titled '${kt}'`:"")+` for a ${isDiscrete$2(Bt)?"discrete":Bt} scale with ${domainCaption(jt,Ft,xt)}`}function legendCaption(xt){const $t=xt.datum,Ct=$t.title?extractTitle(xt):null,kt=`${$t.type||""} legend`.trim(),Mt=$t.scales,Ft=Object.keys(Mt),jt=xt.context,Bt=jt.scales[Mt[Ft[0]]].value,Vt=jt.dataflow.locale();return capitalize(kt)+(Ct?` titled '${Ct}'`:"")+` for ${channelCaption(Ft)} with ${domainCaption(Vt,Bt,xt)}`}function extractTitle(xt){try{return array$2(peek$1(xt.items).items[0].text).join(" ")}catch{return null}}function channelCaption(xt){return xt=xt.map($t=>$t+($t==="fill"||$t==="stroke"?" color":"")),xt.length<2?xt[0]:xt.slice(0,-1).join(", ")+" and "+peek$1(xt)}function capitalize(xt){return xt.length?xt[0].toUpperCase()+xt.slice(1):xt}const innerText=xt=>(xt+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),attrText=xt=>innerText(xt).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function markup(){let xt="",$t="",Ct="";const kt=[],Mt=()=>$t=Ct="",Ft=Vt=>{$t&&(xt+=`${$t}>${Ct}`,Mt()),kt.push(Vt)},jt=(Vt,zt)=>(zt!=null&&($t+=` ${Vt}="${attrText(zt)}"`),Bt),Bt={open(Vt){Ft(Vt),$t="<"+Vt;for(var zt=arguments.length,Ht=new Array(zt>1?zt-1:0),Gt=1;Gt<zt;Gt++)Ht[Gt-1]=arguments[Gt];for(const qt of Ht)for(const Wt in qt)jt(Wt,qt[Wt]);return Bt},close(){const Vt=kt.pop();return $t?xt+=$t+(Ct?`>${Ct}</${Vt}>`:"/>"):xt+=`</${Vt}>`,Mt(),Bt},attr:jt,text:Vt=>(Ct+=innerText(Vt),Bt),toString:()=>xt};return Bt}const serializeXML=xt=>_serialize(markup(),xt)+"";function _serialize(xt,$t){if(xt.open($t.tagName),$t.hasAttributes()){const Ct=$t.attributes,kt=Ct.length;for(let Mt=0;Mt<kt;++Mt)xt.attr(Ct[Mt].name,Ct[Mt].value)}if($t.hasChildNodes()){const Ct=$t.childNodes;for(const kt of Ct)kt.nodeType===3?xt.text(kt.nodeValue):_serialize(xt,kt)}return xt.close()}const stylesAttr={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},stylesCss={blend:"mix-blend-mode"},rootAttributes={fill:"none","stroke-miterlimit":10},RootIndex=0,xmlns="http://www.w3.org/2000/xmlns/",svgns=metadata.xmlns;class SVGRenderer extends Renderer{constructor($t){super($t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize($t,Ct,kt,Mt,Ft){return this._defs={},this._clearDefs(),$t&&(this._svg=domChild($t,0,"svg",svgns),this._svg.setAttributeNS(xmlns,"xmlns",svgns),this._svg.setAttributeNS(xmlns,"xmlns:xlink",metadata["xmlns:xlink"]),this._svg.setAttribute("version",metadata.version),this._svg.setAttribute("class","marks"),domClear($t,1),this._root=domChild(this._svg,RootIndex,"g",svgns),setAttributes(this._root,rootAttributes),domClear(this._svg,RootIndex+1)),this.background(this._bgcolor),super.initialize($t,Ct,kt,Mt,Ft)}background($t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",$t),super.background(...arguments)}resize($t,Ct,kt,Mt){return super.resize($t,Ct,kt,Mt),this._svg&&(setAttributes(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){const $t=this._svg,Ct=this._bgcolor;if(!$t)return null;let kt;Ct&&($t.removeAttribute("style"),kt=domChild($t,RootIndex,"rect",svgns),setAttributes(kt,{width:this._width,height:this._height,fill:Ct}));const Mt=serializeXML($t);return Ct&&($t.removeChild(kt),this._svg.style.setProperty("background-color",Ct)),Mt}_render($t,Ct){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,$t,void 0,Ct),domClear(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty($t){$t.dirty!==this._dirtyID&&($t.dirty=this._dirtyID,this._dirty.push($t))}isDirty($t){return this._dirtyAll||!$t._svg||!$t._svg.ownerSVGElement||$t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;const $t=this._dirty;if(!$t.length||!this._dirtyID)return!0;const Ct=++this._dirtyID;let kt,Mt,Ft,jt,Bt,Vt,zt;for(Bt=0,Vt=$t.length;Bt<Vt;++Bt)if(kt=$t[Bt],Mt=kt.mark,Mt.marktype!==Ft&&(Ft=Mt.marktype,jt=Marks[Ft]),Mt.zdirty&&Mt.dirty!==Ct&&(this._dirtyAll=!1,dirtyParents(kt,Ct),Mt.items.forEach(Ht=>{Ht.dirty=Ct})),!Mt.zdirty){if(kt.exit){jt.nested&&Mt.items.length?(zt=Mt.items[0],zt._svg&&this._update(jt,zt._svg,zt)):kt._svg&&(zt=kt._svg.parentNode,zt&&zt.removeChild(kt._svg)),kt._svg=null;continue}kt=jt.nested?Mt.items[0]:kt,kt._update!==Ct&&(!kt._svg||!kt._svg.ownerSVGElement?(this._dirtyAll=!1,dirtyParents(kt,Ct)):this._update(jt,kt._svg,kt),kt._update=Ct)}return!this._dirtyAll}mark($t,Ct,kt,Mt){if(!this.isDirty(Ct))return Ct._svg;const Ft=this._svg,jt=Ct.marktype,Bt=Marks[jt],Vt=Ct.interactive===!1?"none":null,zt=Bt.tag==="g",Ht=bind$1(Ct,$t,kt,"g",Ft);if(jt!=="group"&&Mt!=null&&!Mt.includes(jt))return domClear(Ht,0),Ct._svg;Ht.setAttribute("class",cssClass(Ct));const Gt=ariaMarkAttributes(Ct);for(const Kt in Gt)setAttribute(Ht,Kt,Gt[Kt]);zt||setAttribute(Ht,"pointer-events",Vt),setAttribute(Ht,"clip-path",Ct.clip?clip$1(this,Ct,Ct.group):null);let qt=null,Wt=0;const Yt=Kt=>{const Xt=this.isDirty(Kt),Qt=bind$1(Kt,Ht,qt,Bt.tag,Ft);Xt&&(this._update(Bt,Qt,Kt),zt&&recurse(this,Qt,Kt,Mt)),qt=Qt,++Wt};return Bt.nested?Ct.items.length&&Yt(Ct.items[0]):visit(Ct,Yt),domClear(Ht,Wt),Ht}_update($t,Ct,kt){element$1=Ct,values$2=Ct.__values__,ariaItemAttributes(emit,kt),$t.attr(emit,kt,this);const Mt=mark_extras[$t.type];Mt&&Mt.call(this,$t,Ct,kt),element$1&&this.style(element$1,kt)}style($t,Ct){if(Ct!=null){for(const kt in stylesAttr){let Mt=kt==="font"?fontFamily(Ct):Ct[kt];if(Mt===values$2[kt])continue;const Ft=stylesAttr[kt];Mt==null?$t.removeAttribute(Ft):(isGradient(Mt)&&(Mt=gradientRef(Mt,this._defs.gradient,href())),$t.setAttribute(Ft,Mt+"")),values$2[kt]=Mt}for(const kt in stylesCss)setStyle($t,stylesCss[kt],Ct[kt])}}defs(){const $t=this._svg,Ct=this._defs;let kt=Ct.el,Mt=0;for(const Ft in Ct.gradient)kt||(Ct.el=kt=domChild($t,RootIndex+1,"defs",svgns)),Mt=updateGradient(kt,Ct.gradient[Ft],Mt);for(const Ft in Ct.clipping)kt||(Ct.el=kt=domChild($t,RootIndex+1,"defs",svgns)),Mt=updateClipping(kt,Ct.clipping[Ft],Mt);kt&&(Mt===0?($t.removeChild(kt),Ct.el=null):domClear(kt,Mt))}_clearDefs(){const $t=this._defs;$t.gradient={},$t.clipping={}}}function dirtyParents(xt,$t){for(;xt&&xt.dirty!==$t;xt=xt.mark.group)if(xt.dirty=$t,xt.mark&&xt.mark.dirty!==$t)xt.mark.dirty=$t;else return}function updateGradient(xt,$t,Ct){let kt,Mt,Ft;if($t.gradient==="radial"){let jt=domChild(xt,Ct++,"pattern",svgns);setAttributes(jt,{id:patternPrefix+$t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),jt=domChild(jt,0,"rect",svgns),setAttributes(jt,{width:1,height:1,fill:`url(${href()}#${$t.id})`}),xt=domChild(xt,Ct++,"radialGradient",svgns),setAttributes(xt,{id:$t.id,fx:$t.x1,fy:$t.y1,fr:$t.r1,cx:$t.x2,cy:$t.y2,r:$t.r2})}else xt=domChild(xt,Ct++,"linearGradient",svgns),setAttributes(xt,{id:$t.id,x1:$t.x1,x2:$t.x2,y1:$t.y1,y2:$t.y2});for(kt=0,Mt=$t.stops.length;kt<Mt;++kt)Ft=domChild(xt,kt,"stop",svgns),Ft.setAttribute("offset",$t.stops[kt].offset),Ft.setAttribute("stop-color",$t.stops[kt].color);return domClear(xt,kt),Ct}function updateClipping(xt,$t,Ct){let kt;return xt=domChild(xt,Ct,"clipPath",svgns),xt.setAttribute("id",$t.id),$t.path?(kt=domChild(xt,0,"path",svgns),kt.setAttribute("d",$t.path)):(kt=domChild(xt,0,"rect",svgns),setAttributes(kt,{x:0,y:0,width:$t.width,height:$t.height})),domClear(xt,1),Ct+1}function recurse(xt,$t,Ct,kt){$t=$t.lastChild.previousSibling;let Mt,Ft=0;visit(Ct,jt=>{Mt=xt.mark($t,jt,Mt,kt),++Ft}),domClear($t,1+Ft)}function bind$1(xt,$t,Ct,kt,Mt){let Ft=xt._svg,jt;if(!Ft&&(jt=$t.ownerDocument,Ft=domCreate(jt,kt,svgns),xt._svg=Ft,xt.mark&&(Ft.__data__=xt,Ft.__values__={fill:"default"},kt==="g"))){const Bt=domCreate(jt,"path",svgns);Ft.appendChild(Bt),Bt.__data__=xt;const Vt=domCreate(jt,"g",svgns);Ft.appendChild(Vt),Vt.__data__=xt;const zt=domCreate(jt,"path",svgns);Ft.appendChild(zt),zt.__data__=xt,zt.__values__={fill:"default"}}return(Ft.ownerSVGElement!==Mt||siblingCheck(Ft,Ct))&&$t.insertBefore(Ft,Ct?Ct.nextSibling:$t.firstChild),Ft}function siblingCheck(xt,$t){return xt.parentNode&&xt.parentNode.childNodes.length>1&&xt.previousSibling!=$t}let element$1=null,values$2=null;const mark_extras={group(xt,$t,Ct){const kt=element$1=$t.childNodes[2];values$2=kt.__values__,xt.foreground(emit,Ct,this),values$2=$t.__values__,element$1=$t.childNodes[1],xt.content(emit,Ct,this);const Mt=element$1=$t.childNodes[0];xt.background(emit,Ct,this);const Ft=Ct.mark.interactive===!1?"none":null;if(Ft!==values$2.events&&(setAttribute(kt,"pointer-events",Ft),setAttribute(Mt,"pointer-events",Ft),values$2.events=Ft),Ct.strokeForeground&&Ct.stroke){const jt=Ct.fill;setAttribute(kt,"display",null),this.style(Mt,Ct),setAttribute(Mt,"stroke",null),jt&&(Ct.fill=null),values$2=kt.__values__,this.style(kt,Ct),jt&&(Ct.fill=jt),element$1=null}else setAttribute(kt,"display","none")},image(xt,$t,Ct){Ct.smooth===!1?(setStyle($t,"image-rendering","optimizeSpeed"),setStyle($t,"image-rendering","pixelated")):setStyle($t,"image-rendering",null)},text(xt,$t,Ct){const kt=textLines(Ct);let Mt,Ft,jt,Bt;isArray(kt)?(Ft=kt.map(Vt=>textValue(Ct,Vt)),Mt=Ft.join(`
`),Mt!==values$2.text&&(domClear($t,0),jt=$t.ownerDocument,Bt=lineHeight(Ct),Ft.forEach((Vt,zt)=>{const Ht=domCreate(jt,"tspan",svgns);Ht.__data__=Ct,Ht.textContent=Vt,zt&&(Ht.setAttribute("x",0),Ht.setAttribute("dy",Bt)),$t.appendChild(Ht)}),values$2.text=Mt)):(Ft=textValue(Ct,kt),Ft!==values$2.text&&($t.textContent=Ft,values$2.text=Ft)),setAttribute($t,"font-family",fontFamily(Ct)),setAttribute($t,"font-size",fontSize(Ct)+"px"),setAttribute($t,"font-style",Ct.fontStyle),setAttribute($t,"font-variant",Ct.fontVariant),setAttribute($t,"font-weight",Ct.fontWeight)}};function emit(xt,$t,Ct){$t!==values$2[xt]&&(Ct?setAttributeNS(element$1,xt,$t,Ct):setAttribute(element$1,xt,$t),values$2[xt]=$t)}function setStyle(xt,$t,Ct){Ct!==values$2[$t]&&(Ct==null?xt.style.removeProperty($t):xt.style.setProperty($t,Ct+""),values$2[$t]=Ct)}function setAttributes(xt,$t){for(const Ct in $t)setAttribute(xt,Ct,$t[Ct])}function setAttribute(xt,$t,Ct){Ct!=null?xt.setAttribute($t,Ct):xt.removeAttribute($t)}function setAttributeNS(xt,$t,Ct,kt){Ct!=null?xt.setAttributeNS(kt,$t,Ct):xt.removeAttributeNS(kt,$t)}function href(){let xt;return typeof window>"u"?"":(xt=window.location).hash?xt.href.slice(0,-xt.hash.length):xt.href}class SVGStringRenderer extends Renderer{constructor($t){super($t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render($t){const Ct=markup();Ct.open("svg",extend({},metadata,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const kt=this._bgcolor;return kt&&kt!=="transparent"&&kt!=="none"&&Ct.open("rect",{width:this._width,height:this._height,fill:kt}).close(),Ct.open("g",rootAttributes,{transform:"translate("+this._origin+")"}),this.mark(Ct,$t),Ct.close(),this.defs(Ct),this._text=Ct.close()+"",this}mark($t,Ct){const kt=Marks[Ct.marktype],Mt=kt.tag,Ft=[ariaItemAttributes,kt.attr];$t.open("g",{class:cssClass(Ct),"clip-path":Ct.clip?clip$1(this,Ct,Ct.group):null},ariaMarkAttributes(Ct),{"pointer-events":Mt!=="g"&&Ct.interactive===!1?"none":null});const jt=Bt=>{const Vt=this.href(Bt);if(Vt&&$t.open("a",Vt),$t.open(Mt,this.attr(Ct,Bt,Ft,Mt!=="g"?Mt:null)),Mt==="text"){const zt=textLines(Bt);if(isArray(zt)){const Ht={x:0,dy:lineHeight(Bt)};for(let Gt=0;Gt<zt.length;++Gt)$t.open("tspan",Gt?Ht:null).text(textValue(Bt,zt[Gt])).close()}else $t.text(textValue(Bt,zt))}else if(Mt==="g"){const zt=Bt.strokeForeground,Ht=Bt.fill,Gt=Bt.stroke;zt&&Gt&&(Bt.stroke=null),$t.open("path",this.attr(Ct,Bt,kt.background,"bgrect")).close(),$t.open("g",this.attr(Ct,Bt,kt.content)),visit(Bt,qt=>this.mark($t,qt)),$t.close(),zt&&Gt?(Ht&&(Bt.fill=null),Bt.stroke=Gt,$t.open("path",this.attr(Ct,Bt,kt.foreground,"bgrect")).close(),Ht&&(Bt.fill=Ht)):$t.open("path",this.attr(Ct,Bt,kt.foreground,"bgfore")).close()}$t.close(),Vt&&$t.close()};return kt.nested?Ct.items&&Ct.items.length&&jt(Ct.items[0]):visit(Ct,jt),$t.close()}href($t){const Ct=$t.href;let kt;if(Ct){if(kt=this._hrefs&&this._hrefs[Ct])return kt;this.sanitizeURL(Ct).then(Mt=>{Mt["xlink:href"]=Mt.href,Mt.href=null,(this._hrefs||(this._hrefs={}))[Ct]=Mt})}return null}attr($t,Ct,kt,Mt){const Ft={},jt=(Bt,Vt,zt,Ht)=>{Ft[Ht||Bt]=Vt};return Array.isArray(kt)?kt.forEach(Bt=>Bt(jt,Ct,this)):kt(jt,Ct,this),Mt&&style(Ft,Ct,$t,Mt,this._defs),Ft}defs($t){const Ct=this._defs.gradient,kt=this._defs.clipping;if(Object.keys(Ct).length+Object.keys(kt).length!==0){$t.open("defs");for(const Ft in Ct){const jt=Ct[Ft],Bt=jt.stops;jt.gradient==="radial"?($t.open("pattern",{id:patternPrefix+Ft,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),$t.open("rect",{width:"1",height:"1",fill:"url(#"+Ft+")"}).close(),$t.close(),$t.open("radialGradient",{id:Ft,fx:jt.x1,fy:jt.y1,fr:jt.r1,cx:jt.x2,cy:jt.y2,r:jt.r2})):$t.open("linearGradient",{id:Ft,x1:jt.x1,x2:jt.x2,y1:jt.y1,y2:jt.y2});for(let Vt=0;Vt<Bt.length;++Vt)$t.open("stop",{offset:Bt[Vt].offset,"stop-color":Bt[Vt].color}).close();$t.close()}for(const Ft in kt){const jt=kt[Ft];$t.open("clipPath",{id:Ft}),jt.path?$t.open("path",{d:jt.path}).close():$t.open("rect",{x:0,y:0,width:jt.width,height:jt.height}).close(),$t.close()}$t.close()}}}function style(xt,$t,Ct,kt,Mt){let Ft;if($t==null||(kt==="bgrect"&&Ct.interactive===!1&&(xt["pointer-events"]="none"),kt==="bgfore"&&(Ct.interactive===!1&&(xt["pointer-events"]="none"),xt.display="none",$t.fill!==null)))return xt;kt==="image"&&$t.smooth===!1&&(Ft=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),kt==="text"&&(xt["font-family"]=fontFamily($t),xt["font-size"]=fontSize($t)+"px",xt["font-style"]=$t.fontStyle,xt["font-variant"]=$t.fontVariant,xt["font-weight"]=$t.fontWeight);for(const jt in stylesAttr){let Bt=$t[jt];const Vt=stylesAttr[jt];Bt==="transparent"&&(Vt==="fill"||Vt==="stroke")||Bt!=null&&(isGradient(Bt)&&(Bt=gradientRef(Bt,Mt.gradient,"")),xt[Vt]=Bt)}for(const jt in stylesCss){const Bt=$t[jt];Bt!=null&&(Ft=Ft||[],Ft.push(`${stylesCss[jt]}: ${Bt};`))}return Ft&&(xt.style=Ft.join(" ")),xt}const OPTS={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function setHybridRendererOptions(xt){OPTS.svgMarkTypes=xt.svgMarkTypes??["text"],OPTS.svgOnTop=xt.svgOnTop??!0,OPTS.debug=xt.debug??!1}class HybridRenderer extends Renderer{constructor($t){super($t),this._svgRenderer=new SVGRenderer($t),this._canvasRenderer=new CanvasRenderer($t)}initialize($t,Ct,kt,Mt,Ft){this._root_el=domChild($t,0,"div");const jt=domChild(this._root_el,0,"div"),Bt=domChild(this._root_el,1,"div");return this._root_el.style.position="relative",OPTS.debug||(jt.style.height="100%",Bt.style.position="absolute",Bt.style.top="0",Bt.style.left="0",Bt.style.height="100%",Bt.style.width="100%"),this._svgEl=OPTS.svgOnTop?Bt:jt,this._canvasEl=OPTS.svgOnTop?jt:Bt,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,Ct,kt,Mt,Ft),this._svgRenderer.initialize(this._svgEl,Ct,kt,Mt,Ft),super.initialize($t,Ct,kt,Mt,Ft)}dirty($t){return OPTS.svgMarkTypes.includes($t.mark.marktype)?this._svgRenderer.dirty($t):this._canvasRenderer.dirty($t),this}_render($t,Ct){const Mt=(Ct??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(Ft=>!OPTS.svgMarkTypes.includes(Ft));this._svgRenderer.render($t,OPTS.svgMarkTypes),this._canvasRenderer.render($t,Mt)}resize($t,Ct,kt,Mt){return super.resize($t,Ct,kt,Mt),this._svgRenderer.resize($t,Ct,kt,Mt),this._canvasRenderer.resize($t,Ct,kt,Mt),this}background($t){return OPTS.svgOnTop?this._canvasRenderer.background($t):this._svgRenderer.background($t),this}}class HybridHandler extends CanvasHandler{constructor($t,Ct){super($t,Ct)}initialize($t,Ct,kt){const Mt=domChild(domChild($t,0,"div"),OPTS.svgOnTop?0:1,"div");return super.initialize(Mt,Ct,kt)}}const Canvas="canvas",Hybrid="hybrid",PNG="png",SVG="svg",None$1="none",RenderType={Canvas,PNG,SVG,Hybrid,None:None$1},modules={};modules[Canvas]=modules[PNG]={renderer:CanvasRenderer,headless:CanvasRenderer,handler:CanvasHandler};modules[SVG]={renderer:SVGRenderer,headless:SVGStringRenderer,handler:SVGHandler};modules[Hybrid]={renderer:HybridRenderer,headless:HybridRenderer,handler:HybridHandler};modules[None$1]={};function renderModule(xt,$t){return xt=String(xt||"").toLowerCase(),arguments.length>1?(modules[xt]=$t,this):modules[xt]}function intersect$2(xt,$t,Ct){const kt=[],Mt=new Bounds().union($t),Ft=xt.marktype;return Ft?intersectMark(xt,Mt,Ct,kt):Ft==="group"?intersectGroup(xt,Mt,Ct,kt):error("Intersect scene must be mark node or group item.")}function intersectMark(xt,$t,Ct,kt){if(visitMark(xt,$t,Ct)){const Mt=xt.items,Ft=xt.marktype,jt=Mt.length;let Bt=0;if(Ft==="group")for(;Bt<jt;++Bt)intersectGroup(Mt[Bt],$t,Ct,kt);else for(const Vt=Marks[Ft].isect;Bt<jt;++Bt){const zt=Mt[Bt];intersectItem(zt,$t,Vt)&&kt.push(zt)}}return kt}function visitMark(xt,$t,Ct){return xt.bounds&&$t.intersects(xt.bounds)&&(xt.marktype==="group"||xt.interactive!==!1&&(!Ct||Ct(xt)))}function intersectGroup(xt,$t,Ct,kt){Ct&&Ct(xt.mark)&&intersectItem(xt,$t,Marks.group.isect)&&kt.push(xt);const Mt=xt.items,Ft=Mt&&Mt.length;if(Ft){const jt=xt.x||0,Bt=xt.y||0;$t.translate(-jt,-Bt);for(let Vt=0;Vt<Ft;++Vt)intersectMark(Mt[Vt],$t,Ct,kt);$t.translate(jt,Bt)}return kt}function intersectItem(xt,$t,Ct){const kt=xt.bounds;return $t.encloses(kt)||$t.intersects(kt)&&Ct(xt,$t)}const clipBounds=new Bounds;function boundClip(xt){const $t=xt.clip;if(isFunction$1($t))$t(boundContext(clipBounds.clear()));else if($t)clipBounds.set(0,0,xt.group.width,xt.group.height);else return;xt.bounds.intersect(clipBounds)}const TOLERANCE=1e-9;function sceneEqual(xt,$t,Ct){return xt===$t?!0:Ct==="path"?pathEqual(xt,$t):xt instanceof Date&&$t instanceof Date?+xt==+$t:isNumber$1(xt)&&isNumber$1($t)?Math.abs(xt-$t)<=TOLERANCE:!xt||!$t||!isObject(xt)&&!isObject($t)?xt==$t:objectEqual(xt,$t)}function pathEqual(xt,$t){return sceneEqual(parse$3(xt),parse$3($t))}function objectEqual(xt,$t){var Ct=Object.keys(xt),kt=Object.keys($t),Mt,Ft;if(Ct.length!==kt.length)return!1;for(Ct.sort(),kt.sort(),Ft=Ct.length-1;Ft>=0;Ft--)if(Ct[Ft]!=kt[Ft])return!1;for(Ft=Ct.length-1;Ft>=0;Ft--)if(Mt=Ct[Ft],!sceneEqual(xt[Mt],$t[Mt],Mt))return!1;return typeof xt==typeof $t}function resetSVGDefIds(){resetSVGClipId(),resetSVGGradientId()}const Top$1="top",Left$1="left",Right$1="right",Bottom$1="bottom",TopLeft="top-left",TopRight="top-right",BottomLeft="bottom-left",BottomRight="bottom-right",Start$1="start",Middle$1="middle",End$1="end",X$1="x",Y$1="y",Group="group",AxisRole$1="axis",TitleRole$1="title",FrameRole$1="frame",ScopeRole$1="scope",LegendRole$1="legend",RowHeader="row-header",RowFooter="row-footer",RowTitle="row-title",ColHeader="column-header",ColFooter="column-footer",ColTitle="column-title",Padding$1="padding",Symbols$1="symbol",Fit="fit",FitX="fit-x",FitY="fit-y",Pad="pad",None="none",All="all",Each="each",Flush="flush",Column="column",Row="row";function Bound$1(xt){Transform.call(this,null,xt)}inherits(Bound$1,Transform,{transform(xt,$t){const Ct=$t.dataflow,kt=xt.mark,Mt=kt.marktype,Ft=Marks[Mt],jt=Ft.bound;let Bt=kt.bounds,Vt;if(Ft.nested)kt.items.length&&Ct.dirty(kt.items[0]),Bt=boundItem(kt,jt),kt.items.forEach(zt=>{zt.bounds.clear().union(Bt)});else if(Mt===Group||xt.modified())switch($t.visit($t.MOD,zt=>Ct.dirty(zt)),Bt.clear(),kt.items.forEach(zt=>Bt.union(boundItem(zt,jt))),kt.role){case AxisRole$1:case LegendRole$1:case TitleRole$1:$t.reflow()}else Vt=$t.changed($t.REM),$t.visit($t.ADD,zt=>{Bt.union(boundItem(zt,jt))}),$t.visit($t.MOD,zt=>{Vt=Vt||Bt.alignsWith(zt.bounds),Ct.dirty(zt),Bt.union(boundItem(zt,jt))}),Vt&&(Bt.clear(),kt.items.forEach(zt=>Bt.union(zt.bounds)));return boundClip(kt),$t.modifies("bounds")}});function boundItem(xt,$t,Ct){return $t(xt.bounds.clear(),xt,Ct)}const COUNTER_NAME=":vega_identifier:";function Identifier$1(xt){Transform.call(this,0,xt)}Identifier$1.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};inherits(Identifier$1,Transform,{transform(xt,$t){const Ct=getCounter($t.dataflow),kt=xt.as;let Mt=Ct.value;return $t.visit($t.ADD,Ft=>Ft[kt]=Ft[kt]||++Mt),Ct.set(this.value=Mt),$t}});function getCounter(xt){return xt._signals[COUNTER_NAME]||(xt._signals[COUNTER_NAME]=xt.add(0))}function Mark$2(xt){Transform.call(this,null,xt)}inherits(Mark$2,Transform,{transform(xt,$t){let Ct=this.value;Ct||(Ct=$t.dataflow.scenegraph().mark(xt.markdef,lookup$1$1(xt),xt.index),Ct.group.context=xt.context,xt.context.group||(xt.context.group=Ct.group),Ct.source=this.source,Ct.clip=xt.clip,Ct.interactive=xt.interactive,this.value=Ct);const kt=Ct.marktype===Group?GroupItem:Item;return $t.visit($t.ADD,Mt=>kt.call(Mt,Ct)),(xt.modified("clip")||xt.modified("interactive"))&&(Ct.clip=xt.clip,Ct.interactive=!!xt.interactive,Ct.zdirty=!0,$t.reflow()),Ct.items=$t.source,$t}});function lookup$1$1(xt){const $t=xt.groups,Ct=xt.parent;return $t&&$t.size===1?$t.get(Object.keys($t.object)[0]):$t&&Ct?$t.lookup(Ct):null}function Overlap$1(xt){Transform.call(this,null,xt)}const methods={parity:xt=>xt.filter(($t,Ct)=>Ct%2?$t.opacity=0:1),greedy:(xt,$t)=>{let Ct;return xt.filter((kt,Mt)=>!Mt||!intersect$1(Ct.bounds,kt.bounds,$t)?(Ct=kt,1):kt.opacity=0)}},intersect$1=(xt,$t,Ct)=>Ct>Math.max($t.x1-xt.x2,xt.x1-$t.x2,$t.y1-xt.y2,xt.y1-$t.y2),hasOverlap=(xt,$t)=>{for(var Ct=1,kt=xt.length,Mt=xt[0].bounds,Ft;Ct<kt;Mt=Ft,++Ct)if(intersect$1(Mt,Ft=xt[Ct].bounds,$t))return!0},hasBounds=xt=>{const $t=xt.bounds;return $t.width()>1&&$t.height()>1},boundTest=(xt,$t,Ct)=>{var kt=xt.range(),Mt=new Bounds;return $t===Top$1||$t===Bottom$1?Mt.set(kt[0],-1/0,kt[1],1/0):Mt.set(-1/0,kt[0],1/0,kt[1]),Mt.expand(Ct||1),Ft=>Mt.encloses(Ft.bounds)},reset$1=xt=>(xt.forEach($t=>$t.opacity=1),xt),reflow=(xt,$t)=>xt.reflow($t.modified()).modifies("opacity");inherits(Overlap$1,Transform,{transform(xt,$t){const Ct=methods[xt.method]||methods.parity,kt=xt.separation||0;let Mt=$t.materialize($t.SOURCE).source,Ft,jt;if(!Mt||!Mt.length)return;if(!xt.method)return xt.modified("method")&&(reset$1(Mt),$t=reflow($t,xt)),$t;if(Mt=Mt.filter(hasBounds),!Mt.length)return;if(xt.sort&&(Mt=Mt.slice().sort(xt.sort)),Ft=reset$1(Mt),$t=reflow($t,xt),Ft.length>=3&&hasOverlap(Ft,kt)){do Ft=Ct(Ft,kt);while(Ft.length>=3&&hasOverlap(Ft,kt));Ft.length<3&&!peek$1(Mt).opacity&&(Ft.length>1&&(peek$1(Ft).opacity=0),peek$1(Mt).opacity=1)}xt.boundScale&&xt.boundTolerance>=0&&(jt=boundTest(xt.boundScale,xt.boundOrient,+xt.boundTolerance),Mt.forEach(Vt=>{jt(Vt)||(Vt.opacity=0)}));const Bt=Ft[0].mark.bounds.clear();return Mt.forEach(Vt=>{Vt.opacity&&Bt.union(Vt.bounds)}),$t}});function Render$1(xt){Transform.call(this,null,xt)}inherits(Render$1,Transform,{transform(xt,$t){const Ct=$t.dataflow;if($t.visit($t.ALL,kt=>Ct.dirty(kt)),$t.fields&&$t.fields.zindex){const kt=$t.source&&$t.source[0];kt&&(kt.mark.zdirty=!0)}}});const tempBounds=new Bounds;function set$2(xt,$t,Ct){return xt[$t]===Ct?0:(xt[$t]=Ct,1)}function isYAxis(xt){var $t=xt.items[0].orient;return $t===Left$1||$t===Right$1}function axisIndices(xt){let $t=+xt.grid;return[xt.ticks?$t++:-1,xt.labels?$t++:-1,$t+ +xt.domain]}function axisLayout(xt,$t,Ct,kt){var Mt=$t.items[0],Ft=Mt.datum,jt=Mt.translate!=null?Mt.translate:.5,Bt=Mt.orient,Vt=axisIndices(Ft),zt=Mt.range,Ht=Mt.offset,Gt=Mt.position,qt=Mt.minExtent,Wt=Mt.maxExtent,Yt=Ft.title&&Mt.items[Vt[2]].items[0],Kt=Mt.titlePadding,Xt=Mt.bounds,Qt=Yt&&multiLineOffset(Yt),Jt=0,Zt=0,sn,ln;switch(tempBounds.clear().union(Xt),Xt.clear(),(sn=Vt[0])>-1&&Xt.union(Mt.items[sn].bounds),(sn=Vt[1])>-1&&Xt.union(Mt.items[sn].bounds),Bt){case Top$1:Jt=Gt||0,Zt=-Ht,ln=Math.max(qt,Math.min(Wt,-Xt.y1)),Xt.add(0,-ln).add(zt,0),Yt&&axisTitleLayout(xt,Yt,ln,Kt,Qt,0,-1,Xt);break;case Left$1:Jt=-Ht,Zt=Gt||0,ln=Math.max(qt,Math.min(Wt,-Xt.x1)),Xt.add(-ln,0).add(0,zt),Yt&&axisTitleLayout(xt,Yt,ln,Kt,Qt,1,-1,Xt);break;case Right$1:Jt=Ct+Ht,Zt=Gt||0,ln=Math.max(qt,Math.min(Wt,Xt.x2)),Xt.add(0,0).add(ln,zt),Yt&&axisTitleLayout(xt,Yt,ln,Kt,Qt,1,1,Xt);break;case Bottom$1:Jt=Gt||0,Zt=kt+Ht,ln=Math.max(qt,Math.min(Wt,Xt.y2)),Xt.add(0,0).add(zt,ln),Yt&&axisTitleLayout(xt,Yt,ln,Kt,0,0,1,Xt);break;default:Jt=Mt.x,Zt=Mt.y}return boundStroke(Xt.translate(Jt,Zt),Mt),set$2(Mt,"x",Jt+jt)|set$2(Mt,"y",Zt+jt)&&(Mt.bounds=tempBounds,xt.dirty(Mt),Mt.bounds=Xt,xt.dirty(Mt)),Mt.mark.bounds.clear().union(Xt)}function axisTitleLayout(xt,$t,Ct,kt,Mt,Ft,jt,Bt){const Vt=$t.bounds;if($t.auto){const zt=jt*(Ct+Mt+kt);let Ht=0,Gt=0;xt.dirty($t),Ft?Ht=($t.x||0)-($t.x=zt):Gt=($t.y||0)-($t.y=zt),$t.mark.bounds.clear().union(Vt.translate(-Ht,-Gt)),xt.dirty($t)}Bt.union(Vt)}const min=(xt,$t)=>Math.floor(Math.min(xt,$t)),max=(xt,$t)=>Math.ceil(Math.max(xt,$t));function gridLayoutGroups(xt){var $t=xt.items,Ct=$t.length,kt=0,Mt,Ft;const jt={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;kt<Ct;++kt)if(Mt=$t[kt],Ft=Mt.items,Mt.marktype===Group)switch(Mt.role){case AxisRole$1:case LegendRole$1:case TitleRole$1:break;case RowHeader:jt.rowheaders.push(...Ft);break;case RowFooter:jt.rowfooters.push(...Ft);break;case ColHeader:jt.colheaders.push(...Ft);break;case ColFooter:jt.colfooters.push(...Ft);break;case RowTitle:jt.rowtitle=Ft[0];break;case ColTitle:jt.coltitle=Ft[0];break;default:jt.marks.push(...Ft)}return jt}function bboxFlush(xt){return new Bounds().set(0,0,xt.width||0,xt.height||0)}function bboxFull(xt){const $t=xt.bounds.clone();return $t.empty()?$t.set(0,0,0,0):$t.translate(-(xt.x||0),-(xt.y||0))}function get$1(xt,$t,Ct){const kt=isObject(xt)?xt[$t]:xt;return kt??(Ct!==void 0?Ct:0)}function offsetValue$1(xt){return xt<0?Math.ceil(-xt):0}function gridLayout(xt,$t,Ct){var kt=!Ct.nodirty,Mt=Ct.bounds===Flush?bboxFlush:bboxFull,Ft=tempBounds.set(0,0,0,0),jt=get$1(Ct.align,Column),Bt=get$1(Ct.align,Row),Vt=get$1(Ct.padding,Column),zt=get$1(Ct.padding,Row),Ht=Ct.columns||$t.length,Gt=Ht<=0?1:Math.ceil($t.length/Ht),qt=$t.length,Wt=Array(qt),Yt=Array(Ht),Kt=0,Xt=Array(qt),Qt=Array(Gt),Jt=0,Zt=Array(qt),sn=Array(qt),ln=Array(qt),dn,hn,cn,pn,yn,gn,En,bn,xn,Cn,$n;for(hn=0;hn<Ht;++hn)Yt[hn]=0;for(hn=0;hn<Gt;++hn)Qt[hn]=0;for(hn=0;hn<qt;++hn)gn=$t[hn],yn=ln[hn]=Mt(gn),gn.x=gn.x||0,Zt[hn]=0,gn.y=gn.y||0,sn[hn]=0,cn=hn%Ht,pn=~~(hn/Ht),Kt=Math.max(Kt,En=Math.ceil(yn.x2)),Jt=Math.max(Jt,bn=Math.ceil(yn.y2)),Yt[cn]=Math.max(Yt[cn],En),Qt[pn]=Math.max(Qt[pn],bn),Wt[hn]=Vt+offsetValue$1(yn.x1),Xt[hn]=zt+offsetValue$1(yn.y1),kt&&xt.dirty($t[hn]);for(hn=0;hn<qt;++hn)hn%Ht===0&&(Wt[hn]=0),hn<Ht&&(Xt[hn]=0);if(jt===Each)for(cn=1;cn<Ht;++cn){for($n=0,hn=cn;hn<qt;hn+=Ht)$n<Wt[hn]&&($n=Wt[hn]);for(hn=cn;hn<qt;hn+=Ht)Wt[hn]=$n+Yt[cn-1]}else if(jt===All){for($n=0,hn=0;hn<qt;++hn)hn%Ht&&$n<Wt[hn]&&($n=Wt[hn]);for(hn=0;hn<qt;++hn)hn%Ht&&(Wt[hn]=$n+Kt)}else for(jt=!1,cn=1;cn<Ht;++cn)for(hn=cn;hn<qt;hn+=Ht)Wt[hn]+=Yt[cn-1];if(Bt===Each)for(pn=1;pn<Gt;++pn){for($n=0,hn=pn*Ht,dn=hn+Ht;hn<dn;++hn)$n<Xt[hn]&&($n=Xt[hn]);for(hn=pn*Ht;hn<dn;++hn)Xt[hn]=$n+Qt[pn-1]}else if(Bt===All){for($n=0,hn=Ht;hn<qt;++hn)$n<Xt[hn]&&($n=Xt[hn]);for(hn=Ht;hn<qt;++hn)Xt[hn]=$n+Jt}else for(Bt=!1,pn=1;pn<Gt;++pn)for(hn=pn*Ht,dn=hn+Ht;hn<dn;++hn)Xt[hn]+=Qt[pn-1];for(xn=0,hn=0;hn<qt;++hn)xn=Wt[hn]+(hn%Ht?xn:0),Zt[hn]+=xn-$t[hn].x;for(cn=0;cn<Ht;++cn)for(Cn=0,hn=cn;hn<qt;hn+=Ht)Cn+=Xt[hn],sn[hn]+=Cn-$t[hn].y;if(jt&&get$1(Ct.center,Column)&&Gt>1)for(hn=0;hn<qt;++hn)yn=jt===All?Kt:Yt[hn%Ht],xn=yn-ln[hn].x2-$t[hn].x-Zt[hn],xn>0&&(Zt[hn]+=xn/2);if(Bt&&get$1(Ct.center,Row)&&Ht!==1)for(hn=0;hn<qt;++hn)yn=Bt===All?Jt:Qt[~~(hn/Ht)],Cn=yn-ln[hn].y2-$t[hn].y-sn[hn],Cn>0&&(sn[hn]+=Cn/2);for(hn=0;hn<qt;++hn)Ft.union(ln[hn].translate(Zt[hn],sn[hn]));switch(xn=get$1(Ct.anchor,X$1),Cn=get$1(Ct.anchor,Y$1),get$1(Ct.anchor,Column)){case End$1:xn-=Ft.width();break;case Middle$1:xn-=Ft.width()/2}switch(get$1(Ct.anchor,Row)){case End$1:Cn-=Ft.height();break;case Middle$1:Cn-=Ft.height()/2}for(xn=Math.round(xn),Cn=Math.round(Cn),Ft.clear(),hn=0;hn<qt;++hn)$t[hn].mark.bounds.clear();for(hn=0;hn<qt;++hn)gn=$t[hn],gn.x+=Zt[hn]+=xn,gn.y+=sn[hn]+=Cn,Ft.union(gn.mark.bounds.union(gn.bounds.translate(Zt[hn],sn[hn]))),kt&&xt.dirty(gn);return Ft}function trellisLayout(xt,$t,Ct){var kt=gridLayoutGroups($t),Mt=kt.marks,Ft=Ct.bounds===Flush?boundFlush:boundFull,jt=Ct.offset,Bt=Ct.columns||Mt.length,Vt=Bt<=0?1:Math.ceil(Mt.length/Bt),zt=Vt*Bt,Ht,Gt,qt,Wt,Yt,Kt,Xt;const Qt=gridLayout(xt,Mt,Ct);Qt.empty()&&Qt.set(0,0,0,0),kt.rowheaders&&(Kt=get$1(Ct.headerBand,Row,null),Ht=layoutHeaders(xt,kt.rowheaders,Mt,Bt,Vt,-get$1(jt,"rowHeader"),min,0,Ft,"x1",0,Bt,1,Kt)),kt.colheaders&&(Kt=get$1(Ct.headerBand,Column,null),Gt=layoutHeaders(xt,kt.colheaders,Mt,Bt,Bt,-get$1(jt,"columnHeader"),min,1,Ft,"y1",0,1,Bt,Kt)),kt.rowfooters&&(Kt=get$1(Ct.footerBand,Row,null),qt=layoutHeaders(xt,kt.rowfooters,Mt,Bt,Vt,get$1(jt,"rowFooter"),max,0,Ft,"x2",Bt-1,Bt,1,Kt)),kt.colfooters&&(Kt=get$1(Ct.footerBand,Column,null),Wt=layoutHeaders(xt,kt.colfooters,Mt,Bt,Bt,get$1(jt,"columnFooter"),max,1,Ft,"y2",zt-Bt,1,Bt,Kt)),kt.rowtitle&&(Yt=get$1(Ct.titleAnchor,Row),Xt=get$1(jt,"rowTitle"),Xt=Yt===End$1?qt+Xt:Ht-Xt,Kt=get$1(Ct.titleBand,Row,.5),layoutTitle(xt,kt.rowtitle,Xt,0,Qt,Kt)),kt.coltitle&&(Yt=get$1(Ct.titleAnchor,Column),Xt=get$1(jt,"columnTitle"),Xt=Yt===End$1?Wt+Xt:Gt-Xt,Kt=get$1(Ct.titleBand,Column,.5),layoutTitle(xt,kt.coltitle,Xt,1,Qt,Kt))}function boundFlush(xt,$t){return $t==="x1"?xt.x||0:$t==="y1"?xt.y||0:$t==="x2"?(xt.x||0)+(xt.width||0):$t==="y2"?(xt.y||0)+(xt.height||0):void 0}function boundFull(xt,$t){return xt.bounds[$t]}function layoutHeaders(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt,zt,Ht,Gt,qt,Wt){var Yt=Ct.length,Kt=0,Xt=0,Qt,Jt,Zt,sn,ln,dn,hn,cn,pn;if(!Yt)return Kt;for(Qt=Ht;Qt<Yt;Qt+=Gt)Ct[Qt]&&(Kt=jt(Kt,Vt(Ct[Qt],zt)));if(!$t.length)return Kt;for($t.length>Mt&&(xt.warn("Grid headers exceed limit: "+Mt),$t=$t.slice(0,Mt)),Kt+=Ft,Jt=0,sn=$t.length;Jt<sn;++Jt)xt.dirty($t[Jt]),$t[Jt].mark.bounds.clear();for(Qt=Ht,Jt=0,sn=$t.length;Jt<sn;++Jt,Qt+=Gt){for(dn=$t[Jt],ln=dn.mark.bounds,Zt=Qt;Zt>=0&&(hn=Ct[Zt])==null;Zt-=qt);Bt?(cn=Wt==null?hn.x:Math.round(hn.bounds.x1+Wt*hn.bounds.width()),pn=Kt):(cn=Kt,pn=Wt==null?hn.y:Math.round(hn.bounds.y1+Wt*hn.bounds.height())),ln.union(dn.bounds.translate(cn-(dn.x||0),pn-(dn.y||0))),dn.x=cn,dn.y=pn,xt.dirty(dn),Xt=jt(Xt,ln[zt])}return Xt}function layoutTitle(xt,$t,Ct,kt,Mt,Ft){if($t){xt.dirty($t);var jt=Ct,Bt=Ct;kt?jt=Math.round(Mt.x1+Ft*Mt.width()):Bt=Math.round(Mt.y1+Ft*Mt.height()),$t.bounds.translate(jt-($t.x||0),Bt-($t.y||0)),$t.mark.bounds.clear().union($t.bounds),$t.x=jt,$t.y=Bt,xt.dirty($t)}}function lookup$3(xt,$t){const Ct=xt[$t]||{};return(kt,Mt)=>Ct[kt]!=null?Ct[kt]:xt[kt]!=null?xt[kt]:Mt}function offsets(xt,$t){let Ct=-1/0;return xt.forEach(kt=>{kt.offset!=null&&(Ct=Math.max(Ct,kt.offset))}),Ct>-1/0?Ct:$t}function legendParams(xt,$t,Ct,kt,Mt,Ft,jt){const Bt=lookup$3(Ct,$t),Vt=offsets(xt,Bt("offset",0)),zt=Bt("anchor",Start$1),Ht=zt===End$1?1:zt===Middle$1?.5:0,Gt={align:Each,bounds:Bt("bounds",Flush),columns:Bt("direction")==="vertical"?1:xt.length,padding:Bt("margin",8),center:Bt("center"),nodirty:!0};switch($t){case Left$1:Gt.anchor={x:Math.floor(kt.x1)-Vt,column:End$1,y:Ht*(jt||kt.height()+2*kt.y1),row:zt};break;case Right$1:Gt.anchor={x:Math.ceil(kt.x2)+Vt,y:Ht*(jt||kt.height()+2*kt.y1),row:zt};break;case Top$1:Gt.anchor={y:Math.floor(Mt.y1)-Vt,row:End$1,x:Ht*(Ft||Mt.width()+2*Mt.x1),column:zt};break;case Bottom$1:Gt.anchor={y:Math.ceil(Mt.y2)+Vt,x:Ht*(Ft||Mt.width()+2*Mt.x1),column:zt};break;case TopLeft:Gt.anchor={x:Vt,y:Vt};break;case TopRight:Gt.anchor={x:Ft-Vt,y:Vt,column:End$1};break;case BottomLeft:Gt.anchor={x:Vt,y:jt-Vt,row:End$1};break;case BottomRight:Gt.anchor={x:Ft-Vt,y:jt-Vt,column:End$1,row:End$1};break}return Gt}function legendLayout(xt,$t){var Ct=$t.items[0],kt=Ct.datum,Mt=Ct.orient,Ft=Ct.bounds,jt=Ct.x,Bt=Ct.y,Vt,zt;return Ct._bounds?Ct._bounds.clear().union(Ft):Ct._bounds=Ft.clone(),Ft.clear(),legendGroupLayout(xt,Ct,Ct.items[0].items[0]),Ft=legendBounds(Ct,Ft),Vt=2*Ct.padding,zt=2*Ct.padding,Ft.empty()||(Vt=Math.ceil(Ft.width()+Vt),zt=Math.ceil(Ft.height()+zt)),kt.type===Symbols$1&&legendEntryLayout(Ct.items[0].items[0].items[0].items),Mt!==None&&(Ct.x=jt=0,Ct.y=Bt=0),Ct.width=Vt,Ct.height=zt,boundStroke(Ft.set(jt,Bt,jt+Vt,Bt+zt),Ct),Ct.mark.bounds.clear().union(Ft),Ct}function legendBounds(xt,$t){return xt.items.forEach(Ct=>$t.union(Ct.bounds)),$t.x1=xt.padding,$t.y1=xt.padding,$t}function legendGroupLayout(xt,$t,Ct){var kt=$t.padding,Mt=kt-Ct.x,Ft=kt-Ct.y;if(!$t.datum.title)(Mt||Ft)&&translate$1(xt,Ct,Mt,Ft);else{var jt=$t.items[1].items[0],Bt=jt.anchor,Vt=$t.titlePadding||0,zt=kt-jt.x,Ht=kt-jt.y;switch(jt.orient){case Left$1:Mt+=Math.ceil(jt.bounds.width())+Vt;break;case Right$1:case Bottom$1:break;default:Ft+=jt.bounds.height()+Vt}switch((Mt||Ft)&&translate$1(xt,Ct,Mt,Ft),jt.orient){case Left$1:Ht+=legendTitleOffset($t,Ct,jt,Bt,1,1);break;case Right$1:zt+=legendTitleOffset($t,Ct,jt,End$1,0,0)+Vt,Ht+=legendTitleOffset($t,Ct,jt,Bt,1,1);break;case Bottom$1:zt+=legendTitleOffset($t,Ct,jt,Bt,0,0),Ht+=legendTitleOffset($t,Ct,jt,End$1,-1,0,1)+Vt;break;default:zt+=legendTitleOffset($t,Ct,jt,Bt,0,0)}(zt||Ht)&&translate$1(xt,jt,zt,Ht),(zt=Math.round(jt.bounds.x1-kt))<0&&(translate$1(xt,Ct,-zt,0),translate$1(xt,jt,-zt,0))}}function legendTitleOffset(xt,$t,Ct,kt,Mt,Ft,jt){const Bt=xt.datum.type!=="symbol",Vt=Ct.datum.vgrad,zt=Bt&&(Ft||!Vt)&&!jt?$t.items[0]:$t,Ht=zt.bounds[Mt?"y2":"x2"]-xt.padding,Gt=Vt&&Ft?Ht:0,qt=Vt&&Ft?0:Ht,Wt=Mt<=0?0:multiLineOffset(Ct);return Math.round(kt===Start$1?Gt:kt===End$1?qt-Wt:.5*(Ht-Wt))}function translate$1(xt,$t,Ct,kt){$t.x+=Ct,$t.y+=kt,$t.bounds.translate(Ct,kt),$t.mark.bounds.translate(Ct,kt),xt.dirty($t)}function legendEntryLayout(xt){const $t=xt.reduce((Ct,kt)=>(Ct[kt.column]=Math.max(kt.bounds.x2-kt.x,Ct[kt.column]||0),Ct),{});xt.forEach(Ct=>{Ct.width=$t[Ct.column],Ct.height=Ct.bounds.y2-Ct.y})}function titleLayout(xt,$t,Ct,kt,Mt){var Ft=$t.items[0],jt=Ft.frame,Bt=Ft.orient,Vt=Ft.anchor,zt=Ft.offset,Ht=Ft.padding,Gt=Ft.items[0].items[0],qt=Ft.items[1]&&Ft.items[1].items[0],Wt=Bt===Left$1||Bt===Right$1?kt:Ct,Yt=0,Kt=0,Xt=0,Qt=0,Jt=0,Zt;if(jt!==Group?Bt===Left$1?(Yt=Mt.y2,Wt=Mt.y1):Bt===Right$1?(Yt=Mt.y1,Wt=Mt.y2):(Yt=Mt.x1,Wt=Mt.x2):Bt===Left$1&&(Yt=kt,Wt=0),Zt=Vt===Start$1?Yt:Vt===End$1?Wt:(Yt+Wt)/2,qt&&qt.text){switch(Bt){case Top$1:case Bottom$1:Jt=Gt.bounds.height()+Ht;break;case Left$1:Qt=Gt.bounds.width()+Ht;break;case Right$1:Qt=-Gt.bounds.width()-Ht;break}tempBounds.clear().union(qt.bounds),tempBounds.translate(Qt-(qt.x||0),Jt-(qt.y||0)),set$2(qt,"x",Qt)|set$2(qt,"y",Jt)&&(xt.dirty(qt),qt.bounds.clear().union(tempBounds),qt.mark.bounds.clear().union(tempBounds),xt.dirty(qt)),tempBounds.clear().union(qt.bounds)}else tempBounds.clear();switch(tempBounds.union(Gt.bounds),Bt){case Top$1:Kt=Zt,Xt=Mt.y1-tempBounds.height()-zt;break;case Left$1:Kt=Mt.x1-tempBounds.width()-zt,Xt=Zt;break;case Right$1:Kt=Mt.x2+tempBounds.width()+zt,Xt=Zt;break;case Bottom$1:Kt=Zt,Xt=Mt.y2+zt;break;default:Kt=Ft.x,Xt=Ft.y}return set$2(Ft,"x",Kt)|set$2(Ft,"y",Xt)&&(tempBounds.translate(Kt,Xt),xt.dirty(Ft),Ft.bounds.clear().union(tempBounds),$t.bounds.clear().union(tempBounds),xt.dirty(Ft)),Ft.bounds}function ViewLayout$1(xt){Transform.call(this,null,xt)}inherits(ViewLayout$1,Transform,{transform(xt,$t){const Ct=$t.dataflow;return xt.mark.items.forEach(kt=>{xt.layout&&trellisLayout(Ct,kt,xt.layout),layoutGroup(Ct,kt,xt)}),shouldReflow(xt.mark.group)?$t.reflow():$t}});function shouldReflow(xt){return xt&&xt.mark.role!=="legend-entry"}function layoutGroup(xt,$t,Ct){var kt=$t.items,Mt=Math.max(0,$t.width||0),Ft=Math.max(0,$t.height||0),jt=new Bounds().set(0,0,Mt,Ft),Bt=jt.clone(),Vt=jt.clone(),zt=[],Ht,Gt,qt,Wt,Yt,Kt;for(Yt=0,Kt=kt.length;Yt<Kt;++Yt)switch(Gt=kt[Yt],Gt.role){case AxisRole$1:Wt=isYAxis(Gt)?Bt:Vt,Wt.union(axisLayout(xt,Gt,Mt,Ft));break;case TitleRole$1:Ht=Gt;break;case LegendRole$1:zt.push(legendLayout(xt,Gt));break;case FrameRole$1:case ScopeRole$1:case RowHeader:case RowFooter:case RowTitle:case ColHeader:case ColFooter:case ColTitle:Bt.union(Gt.bounds),Vt.union(Gt.bounds);break;default:jt.union(Gt.bounds)}if(zt.length){const Xt={};zt.forEach(Qt=>{qt=Qt.orient||Right$1,qt!==None&&(Xt[qt]||(Xt[qt]=[])).push(Qt)});for(const Qt in Xt){const Jt=Xt[Qt];gridLayout(xt,Jt,legendParams(Jt,Qt,Ct.legends,Bt,Vt,Mt,Ft))}zt.forEach(Qt=>{const Jt=Qt.bounds;if(Jt.equals(Qt._bounds)||(Qt.bounds=Qt._bounds,xt.dirty(Qt),Qt.bounds=Jt,xt.dirty(Qt)),Ct.autosize&&(Ct.autosize.type===Fit||Ct.autosize.type===FitX||Ct.autosize.type===FitY))switch(Qt.orient){case Left$1:case Right$1:jt.add(Jt.x1,0).add(Jt.x2,0);break;case Top$1:case Bottom$1:jt.add(0,Jt.y1).add(0,Jt.y2)}else jt.union(Jt)})}jt.union(Bt).union(Vt),Ht&&jt.union(titleLayout(xt,Ht,Mt,Ft,jt)),$t.clip&&jt.set(0,0,$t.width||0,$t.height||0),viewSizeLayout(xt,$t,jt,Ct)}function viewSizeLayout(xt,$t,Ct,kt){const Mt=kt.autosize||{},Ft=Mt.type;if(xt._autosize<1||!Ft)return;let jt=xt._width,Bt=xt._height,Vt=Math.max(0,$t.width||0),zt=Math.max(0,Math.ceil(-Ct.x1)),Ht=Math.max(0,$t.height||0),Gt=Math.max(0,Math.ceil(-Ct.y1));const qt=Math.max(0,Math.ceil(Ct.x2-Vt)),Wt=Math.max(0,Math.ceil(Ct.y2-Ht));if(Mt.contains===Padding$1){const Yt=xt.padding();jt-=Yt.left+Yt.right,Bt-=Yt.top+Yt.bottom}Ft===None?(zt=0,Gt=0,Vt=jt,Ht=Bt):Ft===Fit?(Vt=Math.max(0,jt-zt-qt),Ht=Math.max(0,Bt-Gt-Wt)):Ft===FitX?(Vt=Math.max(0,jt-zt-qt),Bt=Ht+Gt+Wt):Ft===FitY?(jt=Vt+zt+qt,Ht=Math.max(0,Bt-Gt-Wt)):Ft===Pad&&(jt=Vt+zt+qt,Bt=Ht+Gt+Wt),xt._resizeView(jt,Bt,Vt,Ht,[zt,Gt],Mt.resize)}const vtx=Object.freeze(Object.defineProperty({__proto__:null,bound:Bound$1,identifier:Identifier$1,mark:Mark$2,overlap:Overlap$1,render:Render$1,viewlayout:ViewLayout$1},Symbol.toStringTag,{value:"Module"}));function AxisTicks$1(xt){Transform.call(this,null,xt)}inherits(AxisTicks$1,Transform,{transform(xt,$t){if(this.value&&!xt.modified())return $t.StopPropagation;var Ct=$t.dataflow.locale(),kt=$t.fork($t.NO_SOURCE|$t.NO_FIELDS),Mt=this.value,Ft=xt.scale,jt=xt.count==null?xt.values?xt.values.length:10:xt.count,Bt=tickCount(Ft,jt,xt.minstep),Vt=xt.format||tickFormat(Ct,Ft,Bt,xt.formatSpecifier,xt.formatType,!!xt.values),zt=xt.values?validTicks(Ft,xt.values,Bt):tickValues(Ft,Bt);return Mt&&(kt.rem=Mt),Mt=zt.map((Ht,Gt)=>ingest$1({index:Gt/(zt.length-1||1),value:Ht,label:Vt(Ht)})),xt.extra&&Mt.length&&Mt.push(ingest$1({index:-1,extra:{value:Mt[0].value},label:""})),kt.source=Mt,kt.add=Mt,this.value=Mt,kt}});function DataJoin$1(xt){Transform.call(this,null,xt)}function defaultItemCreate(){return ingest$1({})}function newMap(xt){const $t=fastmap().test(Ct=>Ct.exit);return $t.lookup=Ct=>$t.get(xt(Ct)),$t}inherits(DataJoin$1,Transform,{transform(xt,$t){var Ct=$t.dataflow,kt=$t.fork($t.NO_SOURCE|$t.NO_FIELDS),Mt=xt.item||defaultItemCreate,Ft=xt.key||tupleid,jt=this.value;return isArray(kt.encode)&&(kt.encode=null),jt&&(xt.modified("key")||$t.modified(Ft))&&error("DataJoin does not support modified key function or fields."),jt||($t=$t.addAll(),this.value=jt=newMap(Ft)),$t.visit($t.ADD,Bt=>{const Vt=Ft(Bt);let zt=jt.get(Vt);zt?zt.exit?(jt.empty--,kt.add.push(zt)):kt.mod.push(zt):(zt=Mt(Bt),jt.set(Vt,zt),kt.add.push(zt)),zt.datum=Bt,zt.exit=!1}),$t.visit($t.MOD,Bt=>{const Vt=Ft(Bt),zt=jt.get(Vt);zt&&(zt.datum=Bt,kt.mod.push(zt))}),$t.visit($t.REM,Bt=>{const Vt=Ft(Bt),zt=jt.get(Vt);Bt===zt.datum&&!zt.exit&&(kt.rem.push(zt),zt.exit=!0,++jt.empty)}),$t.changed($t.ADD_MOD)&&kt.modifies("datum"),($t.clean()||xt.clean&&jt.empty>Ct.cleanThreshold)&&Ct.runAfter(jt.clean),kt}});function Encode$1(xt){Transform.call(this,null,xt)}inherits(Encode$1,Transform,{transform(xt,$t){var Ct=$t.fork($t.ADD_REM),kt=xt.mod||!1,Mt=xt.encoders,Ft=$t.encode;if(isArray(Ft))if(Ct.changed()||Ft.every(Gt=>Mt[Gt]))Ft=Ft[0],Ct.encode=null;else return $t.StopPropagation;var jt=Ft==="enter",Bt=Mt.update||falsy,Vt=Mt.enter||falsy,zt=Mt.exit||falsy,Ht=(Ft&&!jt?Mt[Ft]:Bt)||falsy;if($t.changed($t.ADD)&&($t.visit($t.ADD,Gt=>{Vt(Gt,xt),Bt(Gt,xt)}),Ct.modifies(Vt.output),Ct.modifies(Bt.output),Ht!==falsy&&Ht!==Bt&&($t.visit($t.ADD,Gt=>{Ht(Gt,xt)}),Ct.modifies(Ht.output))),$t.changed($t.REM)&&zt!==falsy&&($t.visit($t.REM,Gt=>{zt(Gt,xt)}),Ct.modifies(zt.output)),jt||Ht!==falsy){const Gt=$t.MOD|(xt.modified()?$t.REFLOW:0);jt?($t.visit(Gt,qt=>{const Wt=Vt(qt,xt)||kt;(Ht(qt,xt)||Wt)&&Ct.mod.push(qt)}),Ct.mod.length&&Ct.modifies(Vt.output)):$t.visit(Gt,qt=>{(Ht(qt,xt)||kt)&&Ct.mod.push(qt)}),Ct.mod.length&&Ct.modifies(Ht.output)}return Ct.changed()?Ct:$t.StopPropagation}});function LegendEntries$1(xt){Transform.call(this,[],xt)}inherits(LegendEntries$1,Transform,{transform(xt,$t){if(this.value!=null&&!xt.modified())return $t.StopPropagation;var Ct=$t.dataflow.locale(),kt=$t.fork($t.NO_SOURCE|$t.NO_FIELDS),Mt=this.value,Ft=xt.type||SymbolLegend,jt=xt.scale,Bt=+xt.limit,Vt=tickCount(jt,xt.count==null?5:xt.count,xt.minstep),zt=!!xt.values||Ft===SymbolLegend,Ht=xt.format||labelFormat(Ct,jt,Vt,Ft,xt.formatSpecifier,xt.formatType,zt),Gt=xt.values||labelValues(jt,Vt),qt,Wt,Yt,Kt,Xt;return Mt&&(kt.rem=Mt),Ft===SymbolLegend?(Bt&&Gt.length>Bt?($t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),Mt=Gt.slice(0,Bt-1),Xt=!0):Mt=Gt,isFunction$1(Yt=xt.size)?(!xt.values&&jt(Mt[0])===0&&(Mt=Mt.slice(1)),Kt=Mt.reduce((Qt,Jt)=>Math.max(Qt,Yt(Jt,xt)),0)):Yt=constant$1(Kt=Yt||8),Mt=Mt.map((Qt,Jt)=>ingest$1({index:Jt,label:Ht(Qt,Jt,Mt),value:Qt,offset:Kt,size:Yt(Qt,xt)})),Xt&&(Xt=Gt[Mt.length],Mt.push(ingest$1({index:Mt.length,label:`${Gt.length-Mt.length} entries`,value:Xt,offset:Kt,size:Yt(Xt,xt)})))):Ft===GradientLegend?(qt=jt.domain(),Wt=scaleFraction(jt,qt[0],peek$1(qt)),Gt.length<3&&!xt.values&&qt[0]!==peek$1(qt)&&(Gt=[qt[0],peek$1(qt)]),Mt=Gt.map((Qt,Jt)=>ingest$1({index:Jt,label:Ht(Qt,Jt,Gt),value:Qt,perc:Wt(Qt)}))):(Yt=Gt.length-1,Wt=labelFraction(jt),Mt=Gt.map((Qt,Jt)=>ingest$1({index:Jt,label:Ht(Qt,Jt,Gt),value:Qt,perc:Jt?Wt(Qt):0,perc2:Jt===Yt?1:Wt(Gt[Jt+1])}))),kt.source=Mt,kt.add=Mt,this.value=Mt,kt}});const sourceX=xt=>xt.source.x,sourceY=xt=>xt.source.y,targetX=xt=>xt.target.x,targetY=xt=>xt.target.y;function LinkPath(xt){Transform.call(this,{},xt)}LinkPath.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};inherits(LinkPath,Transform,{transform(xt,$t){var Ct=xt.sourceX||sourceX,kt=xt.sourceY||sourceY,Mt=xt.targetX||targetX,Ft=xt.targetY||targetY,jt=xt.as||"path",Bt=xt.orient||"vertical",Vt=xt.shape||"line",zt=Paths.get(Vt+"-"+Bt)||Paths.get(Vt);return zt||error("LinkPath unsupported type: "+xt.shape+(xt.orient?"-"+xt.orient:"")),$t.visit($t.SOURCE,Ht=>{Ht[jt]=zt(Ct(Ht),kt(Ht),Mt(Ht),Ft(Ht))}),$t.reflow(xt.modified()).modifies(jt)}});const line$1=(xt,$t,Ct,kt)=>"M"+xt+","+$t+"L"+Ct+","+kt,lineR=(xt,$t,Ct,kt)=>line$1($t*Math.cos(xt),$t*Math.sin(xt),kt*Math.cos(Ct),kt*Math.sin(Ct)),arc$1=(xt,$t,Ct,kt)=>{var Mt=Ct-xt,Ft=kt-$t,jt=Math.hypot(Mt,Ft)/2,Bt=180*Math.atan2(Ft,Mt)/Math.PI;return"M"+xt+","+$t+"A"+jt+","+jt+" "+Bt+" 0 1 "+Ct+","+kt},arcR=(xt,$t,Ct,kt)=>arc$1($t*Math.cos(xt),$t*Math.sin(xt),kt*Math.cos(Ct),kt*Math.sin(Ct)),curve=(xt,$t,Ct,kt)=>{const Mt=Ct-xt,Ft=kt-$t,jt=.2*(Mt+Ft),Bt=.2*(Ft-Mt);return"M"+xt+","+$t+"C"+(xt+jt)+","+($t+Bt)+" "+(Ct+Bt)+","+(kt-jt)+" "+Ct+","+kt},curveR=(xt,$t,Ct,kt)=>curve($t*Math.cos(xt),$t*Math.sin(xt),kt*Math.cos(Ct),kt*Math.sin(Ct)),orthoX=(xt,$t,Ct,kt)=>"M"+xt+","+$t+"V"+kt+"H"+Ct,orthoY=(xt,$t,Ct,kt)=>"M"+xt+","+$t+"H"+Ct+"V"+kt,orthoR=(xt,$t,Ct,kt)=>{const Mt=Math.cos(xt),Ft=Math.sin(xt),jt=Math.cos(Ct),Bt=Math.sin(Ct),Vt=Math.abs(Ct-xt)>Math.PI?Ct<=xt:Ct>xt;return"M"+$t*Mt+","+$t*Ft+"A"+$t+","+$t+" 0 0,"+(Vt?1:0)+" "+$t*jt+","+$t*Bt+"L"+kt*jt+","+kt*Bt},diagonalX=(xt,$t,Ct,kt)=>{const Mt=(xt+Ct)/2;return"M"+xt+","+$t+"C"+Mt+","+$t+" "+Mt+","+kt+" "+Ct+","+kt},diagonalY=(xt,$t,Ct,kt)=>{const Mt=($t+kt)/2;return"M"+xt+","+$t+"C"+xt+","+Mt+" "+Ct+","+Mt+" "+Ct+","+kt},diagonalR=(xt,$t,Ct,kt)=>{const Mt=Math.cos(xt),Ft=Math.sin(xt),jt=Math.cos(Ct),Bt=Math.sin(Ct),Vt=($t+kt)/2;return"M"+$t*Mt+","+$t*Ft+"C"+Vt*Mt+","+Vt*Ft+" "+Vt*jt+","+Vt*Bt+" "+kt*jt+","+kt*Bt},Paths=fastmap({line:line$1,"line-radial":lineR,arc:arc$1,"arc-radial":arcR,curve,"curve-radial":curveR,"orthogonal-horizontal":orthoX,"orthogonal-vertical":orthoY,"orthogonal-radial":orthoR,"diagonal-horizontal":diagonalX,"diagonal-vertical":diagonalY,"diagonal-radial":diagonalR});function Pie(xt){Transform.call(this,null,xt)}Pie.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};inherits(Pie,Transform,{transform(xt,$t){var Ct=xt.as||["startAngle","endAngle"],kt=Ct[0],Mt=Ct[1],Ft=xt.field||one$1,jt=xt.startAngle||0,Bt=xt.endAngle!=null?xt.endAngle:2*Math.PI,Vt=$t.source,zt=Vt.map(Ft),Ht=zt.length,Gt=jt,qt=(Bt-jt)/sum$2(zt),Wt=range$6(Ht),Yt,Kt,Xt;for(xt.sort&&Wt.sort((Qt,Jt)=>zt[Qt]-zt[Jt]),Yt=0;Yt<Ht;++Yt)Xt=zt[Wt[Yt]],Kt=Vt[Wt[Yt]],Kt[kt]=Gt,Kt[Mt]=Gt+=Xt*qt;return this.value=zt,$t.reflow(xt.modified()).modifies(Ct)}});const DEFAULT_COUNT=5;function includeZero(xt){const $t=xt.type;return!xt.bins&&($t===Linear||$t===Pow||$t===Sqrt)}function includePad(xt){return isContinuous$1(xt)&&xt!==Sequential}const SKIP$1=toSet(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function Scale$1(xt){Transform.call(this,null,xt),this.modified(!0)}inherits(Scale$1,Transform,{transform(xt,$t){var Ct=$t.dataflow,kt=this.value,Mt=scaleKey(xt);(!kt||Mt!==kt.type)&&(this.value=kt=scale$4(Mt)());for(Mt in xt)if(!SKIP$1[Mt]){if(Mt==="padding"&&includePad(kt.type))continue;isFunction$1(kt[Mt])?kt[Mt](xt[Mt]):Ct.warn("Unsupported scale property: "+Mt)}return configureRange(kt,xt,configureBins(kt,xt,configureDomain(kt,xt,Ct))),$t.fork($t.NO_SOURCE|$t.NO_FIELDS)}});function scaleKey(xt){var $t=xt.type,Ct="",kt;return $t===Sequential?Sequential+"-"+Linear:(isContinuousColor(xt)&&(kt=xt.rawDomain?xt.rawDomain.length:xt.domain?xt.domain.length+ +(xt.domainMid!=null):0,Ct=kt===2?Sequential+"-":kt===3?Diverging+"-":""),(Ct+$t||Linear).toLowerCase())}function isContinuousColor(xt){const $t=xt.type;return isContinuous$1($t)&&$t!==Time&&$t!==UTC&&(xt.scheme||xt.range&&xt.range.length&&xt.range.every(isString))}function configureDomain(xt,$t,Ct){const kt=rawDomain(xt,$t.domainRaw,Ct);if(kt>-1)return kt;var Mt=$t.domain,Ft=xt.type,jt=$t.zero||$t.zero===void 0&&includeZero(xt),Bt,Vt;if(!Mt)return 0;if((jt||$t.domainMin!=null||$t.domainMax!=null||$t.domainMid!=null)&&(Bt=(Mt=Mt.slice()).length-1||1,jt&&(Mt[0]>0&&(Mt[0]=0),Mt[Bt]<0&&(Mt[Bt]=0)),$t.domainMin!=null&&(Mt[0]=$t.domainMin),$t.domainMax!=null&&(Mt[Bt]=$t.domainMax),$t.domainMid!=null)){Vt=$t.domainMid;const zt=Vt>Mt[Bt]?Bt+1:Vt<Mt[0]?0:Bt;zt!==Bt&&Ct.warn("Scale domainMid exceeds domain min or max.",Vt),Mt.splice(zt,0,Vt)}return includePad(Ft)&&$t.padding&&Mt[0]!==peek$1(Mt)&&(Mt=padDomain(Ft,Mt,$t.range,$t.padding,$t.exponent,$t.constant)),xt.domain(domainCheck(Ft,Mt,Ct)),Ft===Ordinal&&xt.unknown($t.domainImplicit?implicit:void 0),$t.nice&&xt.nice&&xt.nice($t.nice!==!0&&tickCount(xt,$t.nice)||null),Mt.length}function rawDomain(xt,$t,Ct){return $t?(xt.domain(domainCheck(xt.type,$t,Ct)),$t.length):-1}function padDomain(xt,$t,Ct,kt,Mt,Ft){var jt=Math.abs(peek$1(Ct)-Ct[0]),Bt=jt/(jt-2*kt),Vt=xt===Log?zoomLog($t,null,Bt):xt===Sqrt?zoomPow($t,null,Bt,.5):xt===Pow?zoomPow($t,null,Bt,Mt||1):xt===Symlog?zoomSymlog($t,null,Bt,Ft||1):zoomLinear($t,null,Bt);return $t=$t.slice(),$t[0]=Vt[0],$t[$t.length-1]=Vt[1],$t}function domainCheck(xt,$t,Ct){if(isLogarithmic(xt)){var kt=Math.abs($t.reduce((Mt,Ft)=>Mt+(Ft<0?-1:Ft>0?1:0),0));kt!==$t.length&&Ct.warn("Log scale domain includes zero: "+$($t))}return $t}function configureBins(xt,$t,Ct){let kt=$t.bins;if(kt&&!isArray(kt)){const Mt=xt.domain(),Ft=Mt[0],jt=peek$1(Mt),Bt=kt.step;let Vt=kt.start==null?Ft:kt.start,zt=kt.stop==null?jt:kt.stop;Bt||error("Scale bins parameter missing step property."),Vt<Ft&&(Vt=Bt*Math.ceil(Ft/Bt)),zt>jt&&(zt=Bt*Math.floor(jt/Bt)),kt=range$6(Vt,zt+Bt/2,Bt)}return kt?xt.bins=kt:xt.bins&&delete xt.bins,xt.type===BinOrdinal&&(kt?!$t.domain&&!$t.domainRaw&&(xt.domain(kt),Ct=kt.length):xt.bins=xt.domain()),Ct}function configureRange(xt,$t,Ct){var kt=xt.type,Mt=$t.round||!1,Ft=$t.range;if($t.rangeStep!=null)Ft=configureRangeStep(kt,$t,Ct);else if($t.scheme&&(Ft=configureScheme(kt,$t,Ct),isFunction$1(Ft))){if(xt.interpolator)return xt.interpolator(Ft);error(`Scale type ${kt} does not support interpolating color schemes.`)}if(Ft&&isInterpolating(kt))return xt.interpolator(interpolateColors(flip(Ft,$t.reverse),$t.interpolate,$t.interpolateGamma));Ft&&$t.interpolate&&xt.interpolate?xt.interpolate(interpolate$1($t.interpolate,$t.interpolateGamma)):isFunction$1(xt.round)?xt.round(Mt):isFunction$1(xt.rangeRound)&&xt.interpolate(Mt?interpolateRound:interpolate$1$1),Ft&&xt.range(flip(Ft,$t.reverse))}function configureRangeStep(xt,$t,Ct){xt!==Band&&xt!==Point&&error("Only band and point scales support rangeStep.");var kt=($t.paddingOuter!=null?$t.paddingOuter:$t.padding)||0,Mt=xt===Point?1:($t.paddingInner!=null?$t.paddingInner:$t.padding)||0;return[0,$t.rangeStep*bandSpace(Ct,Mt,kt)]}function configureScheme(xt,$t,Ct){var kt=$t.schemeExtent,Mt,Ft;return isArray($t.scheme)?Ft=interpolateColors($t.scheme,$t.interpolate,$t.interpolateGamma):(Mt=$t.scheme.toLowerCase(),Ft=scheme$1(Mt),Ft||error(`Unrecognized scheme name: ${$t.scheme}`)),Ct=xt===Threshold?Ct+1:xt===BinOrdinal?Ct-1:xt===Quantile||xt===Quantize?+$t.schemeCount||DEFAULT_COUNT:Ct,isInterpolating(xt)?adjustScheme(Ft,kt,$t.reverse):isFunction$1(Ft)?quantizeInterpolator(adjustScheme(Ft,kt),Ct):xt===Ordinal?Ft:Ft.slice(0,Ct)}function adjustScheme(xt,$t,Ct){return isFunction$1(xt)&&($t||Ct)?interpolateRange$1(xt,flip($t||[0,1],Ct)):xt}function flip(xt,$t){return $t?xt.slice().reverse():xt}function SortItems$1(xt){Transform.call(this,null,xt)}inherits(SortItems$1,Transform,{transform(xt,$t){const Ct=xt.modified("sort")||$t.changed($t.ADD)||$t.modified(xt.sort.fields)||$t.modified("datum");return Ct&&$t.source.sort(stableCompare(xt.sort)),this.modified(Ct),$t}});const Zero="zero",Center$1="center",Normalize="normalize",DefOutput=["y0","y1"];function Stack(xt){Transform.call(this,null,xt)}Stack.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:Zero,values:[Zero,Center$1,Normalize]},{name:"as",type:"string",array:!0,length:2,default:DefOutput}]};inherits(Stack,Transform,{transform(xt,$t){var Ct=xt.as||DefOutput,kt=Ct[0],Mt=Ct[1],Ft=stableCompare(xt.sort),jt=xt.field||one$1,Bt=xt.offset===Center$1?stackCenter:xt.offset===Normalize?stackNormalize:stackZero,Vt,zt,Ht,Gt;for(Vt=partition$2($t.source,xt.groupby,Ft,jt),zt=0,Ht=Vt.length,Gt=Vt.max;zt<Ht;++zt)Bt(Vt[zt],Gt,jt,kt,Mt);return $t.reflow(xt.modified()).modifies(Ct)}});function stackCenter(xt,$t,Ct,kt,Mt){for(var Ft=($t-xt.sum)/2,jt=xt.length,Bt=0,Vt;Bt<jt;++Bt)Vt=xt[Bt],Vt[kt]=Ft,Vt[Mt]=Ft+=Math.abs(Ct(Vt))}function stackNormalize(xt,$t,Ct,kt,Mt){for(var Ft=1/xt.sum,jt=0,Bt=xt.length,Vt=0,zt=0,Ht;Vt<Bt;++Vt)Ht=xt[Vt],Ht[kt]=jt,Ht[Mt]=jt=Ft*(zt+=Math.abs(Ct(Ht)))}function stackZero(xt,$t,Ct,kt,Mt){for(var Ft=0,jt=0,Bt=xt.length,Vt=0,zt,Ht;Vt<Bt;++Vt)Ht=xt[Vt],zt=+Ct(Ht),zt<0?(Ht[kt]=jt,Ht[Mt]=jt+=zt):(Ht[kt]=Ft,Ht[Mt]=Ft+=zt)}function partition$2(xt,$t,Ct,kt){var Mt=[],Ft=Kt=>Kt(Ht),jt,Bt,Vt,zt,Ht,Gt,qt,Wt,Yt;if($t==null)Mt.push(xt.slice());else for(jt={},Bt=0,Vt=xt.length;Bt<Vt;++Bt)Ht=xt[Bt],Gt=$t.map(Ft),qt=jt[Gt],qt||(jt[Gt]=qt=[],Mt.push(qt)),qt.push(Ht);for(Gt=0,Yt=0,zt=Mt.length;Gt<zt;++Gt){for(qt=Mt[Gt],Bt=0,Wt=0,Vt=qt.length;Bt<Vt;++Bt)Wt+=Math.abs(kt(qt[Bt]));qt.sum=Wt,Wt>Yt&&(Yt=Wt),Ct&&qt.sort(Ct)}return Mt.max=Yt,Mt}const encode$1=Object.freeze(Object.defineProperty({__proto__:null,axisticks:AxisTicks$1,datajoin:DataJoin$1,encode:Encode$1,legendentries:LegendEntries$1,linkpath:LinkPath,pie:Pie,scale:Scale$1,sortitems:SortItems$1,stack:Stack},Symbol.toStringTag,{value:"Module"}));var abs=Math.abs,cos=Math.cos,sin=Math.sin,epsilon=1e-6,pi=Math.PI,halfPi=pi/2,sqrt2=sqrt(2);function asin(xt){return xt>1?halfPi:xt<-1?-halfPi:Math.asin(xt)}function sqrt(xt){return xt>0?Math.sqrt(xt):0}function mollweideBromleyTheta(xt,$t){var Ct=xt*sin($t),kt=30,Mt;do $t-=Mt=($t+sin($t)-Ct)/(1+cos($t));while(abs(Mt)>epsilon&&--kt>0);return $t/2}function mollweideBromleyRaw(xt,$t,Ct){function kt(Mt,Ft){return[xt*Mt*cos(Ft=mollweideBromleyTheta(Ct,Ft)),$t*sin(Ft)]}return kt.invert=function(Mt,Ft){return Ft=asin(Ft/$t),[Mt/(xt*cos(Ft)),asin((2*Ft+sin(2*Ft))/Ct)]},kt}var mollweideRaw=mollweideBromleyRaw(sqrt2/halfPi,sqrt2,pi);function geoMollweide(){return projection$1(mollweideRaw).scale(169.529)}const defaultPath=geoPath(),projectionProperties=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function create$1(xt,$t){return function Ct(){const kt=$t();return kt.type=xt,kt.path=geoPath().projection(kt),kt.copy=kt.copy||function(){const Mt=Ct();return projectionProperties.forEach(Ft=>{kt[Ft]&&Mt[Ft](kt[Ft]())}),Mt.path.pointRadius(kt.path.pointRadius()),Mt},registerScale(kt)}}function projection(xt,$t){if(!xt||typeof xt!="string")throw new Error("Projection type must be a name string.");return xt=xt.toLowerCase(),arguments.length>1?(projections[xt]=create$1(xt,$t),this):projections[xt]||null}function getProjectionPath(xt){return xt&&xt.path||defaultPath}const projections={albers:geoAlbers,albersusa:geoAlbersUsa,azimuthalequalarea:geoAzimuthalEqualArea,azimuthalequidistant:geoAzimuthalEquidistant,conicconformal:geoConicConformal,conicequalarea:geoConicEqualArea,conicequidistant:geoConicEquidistant,equalEarth:geoEqualEarth,equirectangular:geoEquirectangular,gnomonic:geoGnomonic,identity:geoIdentity,mercator:geoMercator,mollweide:geoMollweide,naturalEarth1:geoNaturalEarth1,orthographic:geoOrthographic,stereographic:geoStereographic,transversemercator:geoTransverseMercator};for(const xt in projections)projection(xt,projections[xt]);function noop(){}const cases=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function contours(){var xt=1,$t=1,Ct=Bt;function kt(Vt,zt){return zt.map(Ht=>Mt(Vt,Ht))}function Mt(Vt,zt){var Ht=[],Gt=[];return Ft(Vt,zt,qt=>{Ct(qt,Vt,zt),area$1(qt)>0?Ht.push([qt]):Gt.push(qt)}),Gt.forEach(qt=>{for(var Wt=0,Yt=Ht.length,Kt;Wt<Yt;++Wt)if(contains$1((Kt=Ht[Wt])[0],qt)!==-1){Kt.push(qt);return}}),{type:"MultiPolygon",value:zt,coordinates:Ht}}function Ft(Vt,zt,Ht){var Gt=new Array,qt=new Array,Wt,Yt,Kt,Xt,Qt,Jt;for(Wt=Yt=-1,Xt=Vt[0]>=zt,cases[Xt<<1].forEach(Zt);++Wt<xt-1;)Kt=Xt,Xt=Vt[Wt+1]>=zt,cases[Kt|Xt<<1].forEach(Zt);for(cases[Xt<<0].forEach(Zt);++Yt<$t-1;){for(Wt=-1,Xt=Vt[Yt*xt+xt]>=zt,Qt=Vt[Yt*xt]>=zt,cases[Xt<<1|Qt<<2].forEach(Zt);++Wt<xt-1;)Kt=Xt,Xt=Vt[Yt*xt+xt+Wt+1]>=zt,Jt=Qt,Qt=Vt[Yt*xt+Wt+1]>=zt,cases[Kt|Xt<<1|Qt<<2|Jt<<3].forEach(Zt);cases[Xt|Qt<<3].forEach(Zt)}for(Wt=-1,Qt=Vt[Yt*xt]>=zt,cases[Qt<<2].forEach(Zt);++Wt<xt-1;)Jt=Qt,Qt=Vt[Yt*xt+Wt+1]>=zt,cases[Qt<<2|Jt<<3].forEach(Zt);cases[Qt<<3].forEach(Zt);function Zt(sn){var ln=[sn[0][0]+Wt,sn[0][1]+Yt],dn=[sn[1][0]+Wt,sn[1][1]+Yt],hn=jt(ln),cn=jt(dn),pn,yn;(pn=qt[hn])?(yn=Gt[cn])?(delete qt[pn.end],delete Gt[yn.start],pn===yn?(pn.ring.push(dn),Ht(pn.ring)):Gt[pn.start]=qt[yn.end]={start:pn.start,end:yn.end,ring:pn.ring.concat(yn.ring)}):(delete qt[pn.end],pn.ring.push(dn),qt[pn.end=cn]=pn):(pn=Gt[cn])?(yn=qt[hn])?(delete Gt[pn.start],delete qt[yn.end],pn===yn?(pn.ring.push(dn),Ht(pn.ring)):Gt[yn.start]=qt[pn.end]={start:yn.start,end:pn.end,ring:yn.ring.concat(pn.ring)}):(delete Gt[pn.start],pn.ring.unshift(ln),Gt[pn.start=hn]=pn):Gt[hn]=qt[cn]={start:hn,end:cn,ring:[ln,dn]}}}function jt(Vt){return Vt[0]*2+Vt[1]*(xt+1)*4}function Bt(Vt,zt,Ht){Vt.forEach(Gt=>{var qt=Gt[0],Wt=Gt[1],Yt=qt|0,Kt=Wt|0,Xt,Qt=zt[Kt*xt+Yt];qt>0&&qt<xt&&Yt===qt&&(Xt=zt[Kt*xt+Yt-1],Gt[0]=qt+(Ht-Xt)/(Qt-Xt)-.5),Wt>0&&Wt<$t&&Kt===Wt&&(Xt=zt[(Kt-1)*xt+Yt],Gt[1]=Wt+(Ht-Xt)/(Qt-Xt)-.5)})}return kt.contour=Mt,kt.size=function(Vt){if(!arguments.length)return[xt,$t];var zt=Math.floor(Vt[0]),Ht=Math.floor(Vt[1]);return zt>=0&&Ht>=0||error("invalid size"),xt=zt,$t=Ht,kt},kt.smooth=function(Vt){return arguments.length?(Ct=Vt?Bt:noop,kt):Ct===Bt},kt}function area$1(xt){for(var $t=0,Ct=xt.length,kt=xt[Ct-1][1]*xt[0][0]-xt[Ct-1][0]*xt[0][1];++$t<Ct;)kt+=xt[$t-1][1]*xt[$t][0]-xt[$t-1][0]*xt[$t][1];return kt}function contains$1(xt,$t){for(var Ct=-1,kt=$t.length,Mt;++Ct<kt;)if(Mt=ringContains(xt,$t[Ct]))return Mt;return 0}function ringContains(xt,$t){for(var Ct=$t[0],kt=$t[1],Mt=-1,Ft=0,jt=xt.length,Bt=jt-1;Ft<jt;Bt=Ft++){var Vt=xt[Ft],zt=Vt[0],Ht=Vt[1],Gt=xt[Bt],qt=Gt[0],Wt=Gt[1];if(segmentContains(Vt,Gt,$t))return 0;Ht>kt!=Wt>kt&&Ct<(qt-zt)*(kt-Ht)/(Wt-Ht)+zt&&(Mt=-Mt)}return Mt}function segmentContains(xt,$t,Ct){var kt;return collinear(xt,$t,Ct)&&within(xt[kt=+(xt[0]===$t[0])],Ct[kt],$t[kt])}function collinear(xt,$t,Ct){return($t[0]-xt[0])*(Ct[1]-xt[1])===(Ct[0]-xt[0])*($t[1]-xt[1])}function within(xt,$t,Ct){return xt<=$t&&$t<=Ct||Ct<=$t&&$t<=xt}function quantize(xt,$t,Ct){return function(kt){var Mt=extent(kt),Ft=Ct?Math.min(Mt[0],0):Mt[0],jt=Mt[1],Bt=jt-Ft,Vt=$t?tickStep(Ft,jt,xt):Bt/(xt+1);return range$6(Ft+Vt,jt,Vt)}}function Isocontour(xt){Transform.call(this,null,xt)}Isocontour.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};inherits(Isocontour,Transform,{transform(xt,$t){if(this.value&&!$t.changed()&&!xt.modified())return $t.StopPropagation;var Ct=$t.fork($t.NO_SOURCE|$t.NO_FIELDS),kt=$t.materialize($t.SOURCE).source,Mt=xt.field||identity$1,Ft=contours().smooth(xt.smooth!==!1),jt=xt.thresholds||levels(kt,Mt,xt),Bt=xt.as===null?null:xt.as||"contour",Vt=[];return kt.forEach(zt=>{const Ht=Mt(zt),Gt=Ft.size([Ht.width,Ht.height])(Ht.values,isArray(jt)?jt:jt(Ht.values));transformPaths(Gt,Ht,zt,xt),Gt.forEach(qt=>{Vt.push(rederive(zt,ingest$1(Bt!=null?{[Bt]:qt}:qt)))})}),this.value&&(Ct.rem=this.value),this.value=Ct.source=Ct.add=Vt,Ct}});function levels(xt,$t,Ct){const kt=quantize(Ct.levels||10,Ct.nice,Ct.zero!==!1);return Ct.resolve!=="shared"?kt:kt(xt.map(Mt=>max$4($t(Mt).values)))}function transformPaths(xt,$t,Ct,kt){let Mt=kt.scale||$t.scale,Ft=kt.translate||$t.translate;if(isFunction$1(Mt)&&(Mt=Mt(Ct,kt)),isFunction$1(Ft)&&(Ft=Ft(Ct,kt)),(Mt===1||Mt==null)&&!Ft)return;const jt=(isNumber$1(Mt)?Mt:Mt[0])||1,Bt=(isNumber$1(Mt)?Mt:Mt[1])||1,Vt=Ft&&Ft[0]||0,zt=Ft&&Ft[1]||0;xt.forEach(transform$1($t,jt,Bt,Vt,zt))}function transform$1(xt,$t,Ct,kt,Mt){const Ft=xt.x1||0,jt=xt.y1||0,Bt=$t*Ct<0;function Vt(Gt){Gt.forEach(zt)}function zt(Gt){Bt&&Gt.reverse(),Gt.forEach(Ht)}function Ht(Gt){Gt[0]=(Gt[0]-Ft)*$t+kt,Gt[1]=(Gt[1]-jt)*Ct+Mt}return function(Gt){return Gt.coordinates.forEach(Vt),Gt}}function radius(xt,$t,Ct){const kt=xt>=0?xt:estimateBandwidth($t,Ct);return Math.round((Math.sqrt(4*kt*kt+1)-1)/2)}function number$2(xt){return isFunction$1(xt)?xt:constant$1(+xt)}function density2D(){var xt=Vt=>Vt[0],$t=Vt=>Vt[1],Ct=one$1,kt=[-1,-1],Mt=960,Ft=500,jt=2;function Bt(Vt,zt){const Ht=radius(kt[0],Vt,xt)>>jt,Gt=radius(kt[1],Vt,$t)>>jt,qt=Ht?Ht+2:0,Wt=Gt?Gt+2:0,Yt=2*qt+(Mt>>jt),Kt=2*Wt+(Ft>>jt),Xt=new Float32Array(Yt*Kt),Qt=new Float32Array(Yt*Kt);let Jt=Xt;Vt.forEach(sn=>{const ln=qt+(+xt(sn)>>jt),dn=Wt+(+$t(sn)>>jt);ln>=0&&ln<Yt&&dn>=0&&dn<Kt&&(Xt[ln+dn*Yt]+=+Ct(sn))}),Ht>0&&Gt>0?(blurX(Yt,Kt,Xt,Qt,Ht),blurY(Yt,Kt,Qt,Xt,Gt),blurX(Yt,Kt,Xt,Qt,Ht),blurY(Yt,Kt,Qt,Xt,Gt),blurX(Yt,Kt,Xt,Qt,Ht),blurY(Yt,Kt,Qt,Xt,Gt)):Ht>0?(blurX(Yt,Kt,Xt,Qt,Ht),blurX(Yt,Kt,Qt,Xt,Ht),blurX(Yt,Kt,Xt,Qt,Ht),Jt=Qt):Gt>0&&(blurY(Yt,Kt,Xt,Qt,Gt),blurY(Yt,Kt,Qt,Xt,Gt),blurY(Yt,Kt,Xt,Qt,Gt),Jt=Qt);const Zt=zt?Math.pow(2,-2*jt):1/sum$2(Jt);for(let sn=0,ln=Yt*Kt;sn<ln;++sn)Jt[sn]*=Zt;return{values:Jt,scale:1<<jt,width:Yt,height:Kt,x1:qt,y1:Wt,x2:qt+(Mt>>jt),y2:Wt+(Ft>>jt)}}return Bt.x=function(Vt){return arguments.length?(xt=number$2(Vt),Bt):xt},Bt.y=function(Vt){return arguments.length?($t=number$2(Vt),Bt):$t},Bt.weight=function(Vt){return arguments.length?(Ct=number$2(Vt),Bt):Ct},Bt.size=function(Vt){if(!arguments.length)return[Mt,Ft];var zt=+Vt[0],Ht=+Vt[1];return zt>=0&&Ht>=0||error("invalid size"),Mt=zt,Ft=Ht,Bt},Bt.cellSize=function(Vt){return arguments.length?((Vt=+Vt)>=1||error("invalid cell size"),jt=Math.floor(Math.log(Vt)/Math.LN2),Bt):1<<jt},Bt.bandwidth=function(Vt){return arguments.length?(Vt=array$2(Vt),Vt.length===1&&(Vt=[+Vt[0],+Vt[0]]),Vt.length!==2&&error("invalid bandwidth"),kt=Vt,Bt):kt},Bt}function blurX(xt,$t,Ct,kt,Mt){const Ft=(Mt<<1)+1;for(let jt=0;jt<$t;++jt)for(let Bt=0,Vt=0;Bt<xt+Mt;++Bt)Bt<xt&&(Vt+=Ct[Bt+jt*xt]),Bt>=Mt&&(Bt>=Ft&&(Vt-=Ct[Bt-Ft+jt*xt]),kt[Bt-Mt+jt*xt]=Vt/Math.min(Bt+1,xt-1+Ft-Bt,Ft))}function blurY(xt,$t,Ct,kt,Mt){const Ft=(Mt<<1)+1;for(let jt=0;jt<xt;++jt)for(let Bt=0,Vt=0;Bt<$t+Mt;++Bt)Bt<$t&&(Vt+=Ct[jt+Bt*xt]),Bt>=Mt&&(Bt>=Ft&&(Vt-=Ct[jt+(Bt-Ft)*xt]),kt[jt+(Bt-Mt)*xt]=Vt/Math.min(Bt+1,$t-1+Ft-Bt,Ft))}function KDE2D(xt){Transform.call(this,null,xt)}KDE2D.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const PARAMS=["x","y","weight","size","cellSize","bandwidth"];function params(xt,$t){return PARAMS.forEach(Ct=>$t[Ct]!=null?xt[Ct]($t[Ct]):0),xt}inherits(KDE2D,Transform,{transform(xt,$t){if(this.value&&!$t.changed()&&!xt.modified())return $t.StopPropagation;var Ct=$t.fork($t.NO_SOURCE|$t.NO_FIELDS),kt=$t.materialize($t.SOURCE).source,Mt=partition$1(kt,xt.groupby),Ft=(xt.groupby||[]).map(accessorName),jt=params(density2D(),xt),Bt=xt.as||"grid",Vt=[];function zt(Ht,Gt){for(let qt=0;qt<Ft.length;++qt)Ht[Ft[qt]]=Gt[qt];return Ht}return Vt=Mt.map(Ht=>ingest$1(zt({[Bt]:jt(Ht,xt.counts)},Ht.dims))),this.value&&(Ct.rem=this.value),this.value=Ct.source=Ct.add=Vt,Ct}});function partition$1(xt,$t){var Ct=[],kt=Ht=>Ht(Bt),Mt,Ft,jt,Bt,Vt,zt;if($t==null)Ct.push(xt);else for(Mt={},Ft=0,jt=xt.length;Ft<jt;++Ft)Bt=xt[Ft],Vt=$t.map(kt),zt=Mt[Vt],zt||(Mt[Vt]=zt=[],zt.dims=Vt,Ct.push(zt)),zt.push(Bt);return Ct}function Contour(xt){Transform.call(this,null,xt)}Contour.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};inherits(Contour,Transform,{transform(xt,$t){if(this.value&&!$t.changed()&&!xt.modified())return $t.StopPropagation;var Ct=$t.fork($t.NO_SOURCE|$t.NO_FIELDS),kt=contours().smooth(xt.smooth!==!1),Mt=xt.values,Ft=xt.thresholds||quantize(xt.count||10,xt.nice,!!Mt),jt=xt.size,Bt,Vt;return Mt||(Mt=$t.materialize($t.SOURCE).source,Bt=params(density2D(),xt)(Mt,!0),Vt=transform$1(Bt,Bt.scale||1,Bt.scale||1,0,0),jt=[Bt.width,Bt.height],Mt=Bt.values),Ft=isArray(Ft)?Ft:Ft(Mt),Mt=kt.size(jt)(Mt,Ft),Vt&&Mt.forEach(Vt),this.value&&(Ct.rem=this.value),this.value=Ct.source=Ct.add=(Mt||[]).map(ingest$1),Ct}});const Feature="Feature",FeatureCollection="FeatureCollection",MultiPoint="MultiPoint";function GeoJSON(xt){Transform.call(this,null,xt)}GeoJSON.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};inherits(GeoJSON,Transform,{transform(xt,$t){var Ct=this._features,kt=this._points,Mt=xt.fields,Ft=Mt&&Mt[0],jt=Mt&&Mt[1],Bt=xt.geojson||!Mt&&identity$1,Vt=$t.ADD,zt;zt=xt.modified()||$t.changed($t.REM)||$t.modified(accessorFields(Bt))||Ft&&$t.modified(accessorFields(Ft))||jt&&$t.modified(accessorFields(jt)),(!this.value||zt)&&(Vt=$t.SOURCE,this._features=Ct=[],this._points=kt=[]),Bt&&$t.visit(Vt,Ht=>Ct.push(Bt(Ht))),Ft&&jt&&($t.visit(Vt,Ht=>{var Gt=Ft(Ht),qt=jt(Ht);Gt!=null&&qt!=null&&(Gt=+Gt)===Gt&&(qt=+qt)===qt&&kt.push([Gt,qt])}),Ct=Ct.concat({type:Feature,geometry:{type:MultiPoint,coordinates:kt}})),this.value={type:FeatureCollection,features:Ct}}});function GeoPath(xt){Transform.call(this,null,xt)}GeoPath.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};inherits(GeoPath,Transform,{transform(xt,$t){var Ct=$t.fork($t.ALL),kt=this.value,Mt=xt.field||identity$1,Ft=xt.as||"path",jt=Ct.SOURCE;!kt||xt.modified()?(this.value=kt=getProjectionPath(xt.projection),Ct.materialize().reflow()):jt=Mt===identity$1||$t.modified(Mt.fields)?Ct.ADD_MOD:Ct.ADD;const Bt=initPath(kt,xt.pointRadius);return Ct.visit(jt,Vt=>Vt[Ft]=kt(Mt(Vt))),kt.pointRadius(Bt),Ct.modifies(Ft)}});function initPath(xt,$t){const Ct=xt.pointRadius();return xt.context(null),$t!=null&&xt.pointRadius($t),Ct}function GeoPoint(xt){Transform.call(this,null,xt)}GeoPoint.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};inherits(GeoPoint,Transform,{transform(xt,$t){var Ct=xt.projection,kt=xt.fields[0],Mt=xt.fields[1],Ft=xt.as||["x","y"],jt=Ft[0],Bt=Ft[1],Vt;function zt(Ht){const Gt=Ct([kt(Ht),Mt(Ht)]);Gt?(Ht[jt]=Gt[0],Ht[Bt]=Gt[1]):(Ht[jt]=void 0,Ht[Bt]=void 0)}return xt.modified()?$t=$t.materialize().reflow(!0).visit($t.SOURCE,zt):(Vt=$t.modified(kt.fields)||$t.modified(Mt.fields),$t.visit(Vt?$t.ADD_MOD:$t.ADD,zt)),$t.modifies(Ft)}});function GeoShape(xt){Transform.call(this,null,xt)}GeoShape.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};inherits(GeoShape,Transform,{transform(xt,$t){var Ct=$t.fork($t.ALL),kt=this.value,Mt=xt.as||"shape",Ft=Ct.ADD;return(!kt||xt.modified())&&(this.value=kt=shapeGenerator(getProjectionPath(xt.projection),xt.field||field$1("datum"),xt.pointRadius),Ct.materialize().reflow(),Ft=Ct.SOURCE),Ct.visit(Ft,jt=>jt[Mt]=kt),Ct.modifies(Mt)}});function shapeGenerator(xt,$t,Ct){const kt=Ct==null?Mt=>xt($t(Mt)):Mt=>{var Ft=xt.pointRadius(),jt=xt.pointRadius(Ct)($t(Mt));return xt.pointRadius(Ft),jt};return kt.context=Mt=>(xt.context(Mt),kt),kt}function Graticule(xt){Transform.call(this,[],xt),this.generator=graticule()}Graticule.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};inherits(Graticule,Transform,{transform(xt,$t){var Ct=this.value,kt=this.generator,Mt;if(!Ct.length||xt.modified())for(const Ft in xt)isFunction$1(kt[Ft])&&kt[Ft](xt[Ft]);return Mt=kt(),Ct.length?$t.mod.push(replace$1(Ct[0],Mt)):$t.add.push(ingest$1(Mt)),Ct[0]=Mt,$t}});function Heatmap(xt){Transform.call(this,null,xt)}Heatmap.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};inherits(Heatmap,Transform,{transform(xt,$t){if(!$t.changed()&&!xt.modified())return $t.StopPropagation;var Ct=$t.materialize($t.SOURCE).source,kt=xt.resolve==="shared",Mt=xt.field||identity$1,Ft=opacity_(xt.opacity,xt),jt=color_(xt.color,xt),Bt=xt.as||"image",Vt={$x:0,$y:0,$value:0,$max:kt?max$4(Ct.map(zt=>max$4(Mt(zt).values))):0};return Ct.forEach(zt=>{const Ht=Mt(zt),Gt=extend({},zt,Vt);kt||(Gt.$max=max$4(Ht.values||[])),zt[Bt]=toCanvas(Ht,Gt,jt.dep?jt:constant$1(jt(Gt)),Ft.dep?Ft:constant$1(Ft(Gt)))}),$t.reflow(!0).modifies(Bt)}});function color_(xt,$t){let Ct;return isFunction$1(xt)?(Ct=kt=>rgb(xt(kt,$t)),Ct.dep=dependency(xt)):Ct=constant$1(rgb(xt||"#888")),Ct}function opacity_(xt,$t){let Ct;return isFunction$1(xt)?(Ct=kt=>xt(kt,$t),Ct.dep=dependency(xt)):xt?Ct=constant$1(xt):(Ct=kt=>kt.$value/kt.$max||0,Ct.dep=!0),Ct}function dependency(xt){if(!isFunction$1(xt))return!1;const $t=toSet(accessorFields(xt));return $t.$x||$t.$y||$t.$value||$t.$max}function toCanvas(xt,$t,Ct,kt){const Mt=xt.width,Ft=xt.height,jt=xt.x1||0,Bt=xt.y1||0,Vt=xt.x2||Mt,zt=xt.y2||Ft,Ht=xt.values,Gt=Ht?Xt=>Ht[Xt]:zero$2,qt=domCanvas(Vt-jt,zt-Bt),Wt=qt.getContext("2d"),Yt=Wt.getImageData(0,0,Vt-jt,zt-Bt),Kt=Yt.data;for(let Xt=Bt,Qt=0;Xt<zt;++Xt){$t.$y=Xt-Bt;for(let Jt=jt,Zt=Xt*Mt;Jt<Vt;++Jt,Qt+=4){$t.$x=Jt-jt,$t.$value=Gt(Jt+Zt);const sn=Ct($t);Kt[Qt+0]=sn.r,Kt[Qt+1]=sn.g,Kt[Qt+2]=sn.b,Kt[Qt+3]=~~(255*kt($t))}}return Wt.putImageData(Yt,0,0),qt}function Projection$1(xt){Transform.call(this,null,xt),this.modified(!0)}inherits(Projection$1,Transform,{transform(xt,$t){let Ct=this.value;return!Ct||xt.modified("type")?(this.value=Ct=create(xt.type),projectionProperties.forEach(kt=>{xt[kt]!=null&&set$1(Ct,kt,xt[kt])})):projectionProperties.forEach(kt=>{xt.modified(kt)&&set$1(Ct,kt,xt[kt])}),xt.pointRadius!=null&&Ct.path.pointRadius(xt.pointRadius),xt.fit&&fit(Ct,xt),$t.fork($t.NO_SOURCE|$t.NO_FIELDS)}});function fit(xt,$t){const Ct=collectGeoJSON($t.fit);$t.extent?xt.fitExtent($t.extent,Ct):$t.size&&xt.fitSize($t.size,Ct)}function create(xt){const $t=projection((xt||"mercator").toLowerCase());return $t||error("Unrecognized projection type: "+xt),$t()}function set$1(xt,$t,Ct){isFunction$1(xt[$t])&&xt[$t](Ct)}function collectGeoJSON(xt){return xt=array$2(xt),xt.length===1?xt[0]:{type:FeatureCollection,features:xt.reduce(($t,Ct)=>$t.concat(featurize(Ct)),[])}}function featurize(xt){return xt.type===FeatureCollection?xt.features:array$2(xt).filter($t=>$t!=null).map($t=>$t.type===Feature?$t:{type:Feature,geometry:$t})}const geo=Object.freeze(Object.defineProperty({__proto__:null,contour:Contour,geojson:GeoJSON,geopath:GeoPath,geopoint:GeoPoint,geoshape:GeoShape,graticule:Graticule,heatmap:Heatmap,isocontour:Isocontour,kde2d:KDE2D,projection:Projection$1},Symbol.toStringTag,{value:"Module"})),ForceMap={center:forceCenter,collide:forceCollide,nbody:forceManyBody,link:forceLink,x:forceX,y:forceY},Forces="forces",ForceParams=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],ForceConfig=["static","iterations"],ForceOutput=["x","y","vx","vy"];function Force(xt){Transform.call(this,null,xt)}Force.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:ForceOutput}]};inherits(Force,Transform,{transform(xt,$t){var Ct=this.value,kt=$t.changed($t.ADD_REM),Mt=xt.modified(ForceParams),Ft=xt.iterations||300;if(Ct?(kt&&($t.modifies("index"),Ct.nodes($t.source)),(Mt||$t.changed($t.MOD))&&setup(Ct,xt,0,$t)):(this.value=Ct=simulation($t.source,xt),Ct.on("tick",rerun($t.dataflow,this)),xt.static||(kt=!0,Ct.tick()),$t.modifies("index")),Mt||kt||xt.modified(ForceConfig)||$t.changed()&&xt.restart){if(Ct.alpha(Math.max(Ct.alpha(),xt.alpha||1)).alphaDecay(1-Math.pow(Ct.alphaMin(),1/Ft)),xt.static)for(Ct.stop();--Ft>=0;)Ct.tick();else if(Ct.stopped()&&Ct.restart(),!kt)return $t.StopPropagation}return this.finish(xt,$t)},finish(xt,$t){const Ct=$t.dataflow;for(let Bt=this._argops,Vt=0,zt=Bt.length,Ht;Vt<zt;++Vt)if(Ht=Bt[Vt],!(Ht.name!==Forces||Ht.op._argval.force!=="link")){for(var kt=Ht.op._argops,Mt=0,Ft=kt.length,jt;Mt<Ft;++Mt)if(kt[Mt].name==="links"&&(jt=kt[Mt].op.source)){Ct.pulse(jt,Ct.changeset().reflow());break}}return $t.reflow(xt.modified()).modifies(ForceOutput)}});function rerun(xt,$t){return()=>xt.touch($t).run()}function simulation(xt,$t){const Ct=forceSimulation(xt),kt=Ct.stop,Mt=Ct.restart;let Ft=!1;return Ct.stopped=()=>Ft,Ct.restart=()=>(Ft=!1,Mt()),Ct.stop=()=>(Ft=!0,kt()),setup(Ct,$t,!0).on("end",()=>Ft=!0)}function setup(xt,$t,Ct,kt){var Mt=array$2($t.forces),Ft,jt,Bt,Vt;for(Ft=0,jt=ForceParams.length;Ft<jt;++Ft)Bt=ForceParams[Ft],Bt!==Forces&&$t.modified(Bt)&&xt[Bt]($t[Bt]);for(Ft=0,jt=Mt.length;Ft<jt;++Ft)Vt=Forces+Ft,Bt=Ct||$t.modified(Forces,Ft)?getForce(Mt[Ft]):kt&&modified(Mt[Ft],kt)?xt.force(Vt):null,Bt&&xt.force(Vt,Bt);for(jt=xt.numForces||0;Ft<jt;++Ft)xt.force(Forces+Ft,null);return xt.numForces=Mt.length,xt}function modified(xt,$t){var Ct,kt;for(Ct in xt)if(isFunction$1(kt=xt[Ct])&&$t.modified(accessorFields(kt)))return 1;return 0}function getForce(xt){var $t,Ct;has$1(ForceMap,xt.force)||error("Unrecognized force: "+xt.force),$t=ForceMap[xt.force]();for(Ct in xt)isFunction$1($t[Ct])&&setForceParam($t[Ct],xt[Ct],xt);return $t}function setForceParam(xt,$t,Ct){xt(isFunction$1($t)?kt=>$t(kt,Ct):$t)}const force=Object.freeze(Object.defineProperty({__proto__:null,force:Force},Symbol.toStringTag,{value:"Module"}));function lookup$2(xt,$t,Ct){const kt={};return xt.each(Mt=>{const Ft=Mt.data;Ct(Ft)&&(kt[$t(Ft)]=Mt)}),xt.lookup=kt,xt}function Nest(xt){Transform.call(this,null,xt)}Nest.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const children$1=xt=>xt.values;inherits(Nest,Transform,{transform(xt,$t){$t.source||error("Nest transform requires an upstream data source.");var Ct=xt.generate,kt=xt.modified(),Mt=$t.clone(),Ft=this.value;return(!Ft||kt||$t.changed())&&(Ft&&Ft.each(jt=>{jt.children&&isTuple(jt.data)&&Mt.rem.push(jt.data)}),this.value=Ft=hierarchy({values:array$2(xt.keys).reduce((jt,Bt)=>(jt.key(Bt),jt),nest()).entries(Mt.source)},children$1),Ct&&Ft.each(jt=>{jt.children&&(jt=ingest$1(jt.data),Mt.add.push(jt),Mt.source.push(jt))}),lookup$2(Ft,tupleid,tupleid)),Mt.source.root=Ft,Mt}});function nest(){const xt=[],$t={entries:Mt=>kt(Ct(Mt,0),0),key:Mt=>(xt.push(Mt),$t)};function Ct(Mt,Ft){if(Ft>=xt.length)return Mt;const jt=Mt.length,Bt=xt[Ft++],Vt={},zt={};let Ht=-1,Gt,qt,Wt;for(;++Ht<jt;)Gt=Bt(qt=Mt[Ht])+"",(Wt=Vt[Gt])?Wt.push(qt):Vt[Gt]=[qt];for(Gt in Vt)zt[Gt]=Ct(Vt[Gt],Ft);return zt}function kt(Mt,Ft){if(++Ft>xt.length)return Mt;const jt=[];for(const Bt in Mt)jt.push({key:Bt,values:kt(Mt[Bt],Ft)});return jt}return $t}function HierarchyLayout(xt){Transform.call(this,null,xt)}const defaultSeparation=(xt,$t)=>xt.parent===$t.parent?1:2;inherits(HierarchyLayout,Transform,{transform(xt,$t){(!$t.source||!$t.source.root)&&error(this.constructor.name+" transform requires a backing tree data source.");const Ct=this.layout(xt.method),kt=this.fields,Mt=$t.source.root,Ft=xt.as||kt;xt.field?Mt.sum(xt.field):Mt.count(),xt.sort&&Mt.sort(stableCompare(xt.sort,jt=>jt.data)),setParams(Ct,this.params,xt),Ct.separation&&Ct.separation(xt.separation!==!1?defaultSeparation:one$1);try{this.value=Ct(Mt)}catch(jt){error(jt)}return Mt.each(jt=>setFields(jt,kt,Ft)),$t.reflow(xt.modified()).modifies(Ft).modifies("leaf")}});function setParams(xt,$t,Ct){for(let kt,Mt=0,Ft=$t.length;Mt<Ft;++Mt)kt=$t[Mt],kt in Ct&&xt[kt](Ct[kt])}function setFields(xt,$t,Ct){const kt=xt.data,Mt=$t.length-1;for(let Ft=0;Ft<Mt;++Ft)kt[Ct[Ft]]=xt[$t[Ft]];kt[Ct[Mt]]=xt.children?xt.children.length:0}const Output$3=["x","y","r","depth","children"];function Pack(xt){HierarchyLayout.call(this,xt)}Pack.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Output$3.length,default:Output$3}]};inherits(Pack,HierarchyLayout,{layout:pack,params:["radius","size","padding"],fields:Output$3});const Output$2=["x0","y0","x1","y1","depth","children"];function Partition(xt){HierarchyLayout.call(this,xt)}Partition.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Output$2.length,default:Output$2}]};inherits(Partition,HierarchyLayout,{layout:partition$4,params:["size","round","padding"],fields:Output$2});function Stratify(xt){Transform.call(this,null,xt)}Stratify.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};inherits(Stratify,Transform,{transform(xt,$t){$t.source||error("Stratify transform requires an upstream data source.");let Ct=this.value;const kt=xt.modified(),Mt=$t.fork($t.ALL).materialize($t.SOURCE),Ft=!Ct||kt||$t.changed($t.ADD_REM)||$t.modified(xt.key.fields)||$t.modified(xt.parentKey.fields);return Mt.source=Mt.source.slice(),Ft&&(Ct=Mt.source.length?lookup$2(stratify().id(xt.key).parentId(xt.parentKey)(Mt.source),xt.key,truthy):lookup$2(stratify()([{}]),xt.key,xt.key)),Mt.source.root=this.value=Ct,Mt}});const Layouts={tidy:tree$1,cluster},Output$1$1=["x","y","depth","children"];function Tree(xt){HierarchyLayout.call(this,xt)}Tree.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:Output$1$1.length,default:Output$1$1}]};inherits(Tree,HierarchyLayout,{layout(xt){const $t=xt||"tidy";if(has$1(Layouts,$t))return Layouts[$t]();error("Unrecognized Tree layout method: "+$t)},params:["size","nodeSize"],fields:Output$1$1});function TreeLinks(xt){Transform.call(this,[],xt)}TreeLinks.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};inherits(TreeLinks,Transform,{transform(xt,$t){const Ct=this.value,kt=$t.source&&$t.source.root,Mt=$t.fork($t.NO_SOURCE),Ft={};return kt||error("TreeLinks transform requires a tree data source."),$t.changed($t.ADD_REM)?(Mt.rem=Ct,$t.visit($t.SOURCE,jt=>Ft[tupleid(jt)]=1),kt.each(jt=>{const Bt=jt.data,Vt=jt.parent&&jt.parent.data;Vt&&Ft[tupleid(Bt)]&&Ft[tupleid(Vt)]&&Mt.add.push(ingest$1({source:Vt,target:Bt}))}),this.value=Mt.add):$t.changed($t.MOD)&&($t.visit($t.MOD,jt=>Ft[tupleid(jt)]=1),Ct.forEach(jt=>{(Ft[tupleid(jt.source)]||Ft[tupleid(jt.target)])&&Mt.mod.push(jt)})),Mt}});const Tiles={binary:treemapBinary,dice:treemapDice,slice:treemapSlice,slicedice:treemapSliceDice,squarify:treemapSquarify,resquarify:treemapResquarify},Output$4=["x0","y0","x1","y1","depth","children"];function Treemap(xt){HierarchyLayout.call(this,xt)}Treemap.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Output$4.length,default:Output$4}]};inherits(Treemap,HierarchyLayout,{layout(){const xt=treemap();return xt.ratio=$t=>{const Ct=xt.tile();Ct.ratio&&xt.tile(Ct.ratio($t))},xt.method=$t=>{has$1(Tiles,$t)?xt.tile(Tiles[$t]):error("Unrecognized Treemap layout method: "+$t)},xt},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:Output$4});const tree=Object.freeze(Object.defineProperty({__proto__:null,nest:Nest,pack:Pack,partition:Partition,stratify:Stratify,tree:Tree,treelinks:TreeLinks,treemap:Treemap},Symbol.toStringTag,{value:"Module"})),ALPHA_MASK=4278190080;function baseBitmaps(xt,$t){const Ct=xt.bitmap();return($t||[]).forEach(kt=>Ct.set(xt(kt.boundary[0]),xt(kt.boundary[3]))),[Ct,void 0]}function markBitmaps(xt,$t,Ct,kt,Mt){const Ft=xt.width,jt=xt.height,Bt=kt||Mt,Vt=domCanvas(Ft,jt).getContext("2d"),zt=domCanvas(Ft,jt).getContext("2d"),Ht=Bt&&domCanvas(Ft,jt).getContext("2d");Ct.forEach(cn=>draw(Vt,cn,!1)),draw(zt,$t,!1),Bt&&draw(Ht,$t,!0);const Gt=getBuffer(Vt,Ft,jt),qt=getBuffer(zt,Ft,jt),Wt=Bt&&getBuffer(Ht,Ft,jt),Yt=xt.bitmap(),Kt=Bt&&xt.bitmap();let Xt,Qt,Jt,Zt,sn,ln,dn,hn;for(Qt=0;Qt<jt;++Qt)for(Xt=0;Xt<Ft;++Xt)sn=Qt*Ft+Xt,ln=Gt[sn]&ALPHA_MASK,hn=qt[sn]&ALPHA_MASK,dn=Bt&&Wt[sn]&ALPHA_MASK,(ln||dn||hn)&&(Jt=xt(Xt),Zt=xt(Qt),!Mt&&(ln||hn)&&Yt.set(Jt,Zt),Bt&&(ln||dn)&&Kt.set(Jt,Zt));return[Yt,Kt]}function getBuffer(xt,$t,Ct){return new Uint32Array(xt.getImageData(0,0,$t,Ct).data.buffer)}function draw(xt,$t,Ct){if(!$t.length)return;const kt=$t[0].mark.marktype;kt==="group"?$t.forEach(Mt=>{Mt.items.forEach(Ft=>draw(xt,Ft.items,Ct))}):Marks[kt].draw(xt,{items:Ct?$t.map(prepare):$t})}function prepare(xt){const $t=rederive(xt,{});return $t.stroke&&$t.strokeOpacity!==0||$t.fill&&$t.fillOpacity!==0?{...$t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:$t}const DIV=5,MOD=31,SIZE$1=32,RIGHT0=new Uint32Array(SIZE$1+1),RIGHT1=new Uint32Array(SIZE$1+1);RIGHT1[0]=0;RIGHT0[0]=~RIGHT1[0];for(let xt=1;xt<=SIZE$1;++xt)RIGHT1[xt]=RIGHT1[xt-1]<<1|1,RIGHT0[xt]=~RIGHT1[xt];function Bitmap(xt,$t){const Ct=new Uint32Array(~~((xt*$t+SIZE$1)/SIZE$1));function kt(Ft,jt){Ct[Ft]|=jt}function Mt(Ft,jt){Ct[Ft]&=jt}return{array:Ct,get:(Ft,jt)=>{const Bt=jt*xt+Ft;return Ct[Bt>>>DIV]&1<<(Bt&MOD)},set:(Ft,jt)=>{const Bt=jt*xt+Ft;kt(Bt>>>DIV,1<<(Bt&MOD))},clear:(Ft,jt)=>{const Bt=jt*xt+Ft;Mt(Bt>>>DIV,~(1<<(Bt&MOD)))},getRange:(Ft,jt,Bt,Vt)=>{let zt=Vt,Ht,Gt,qt,Wt;for(;zt>=jt;--zt)if(Ht=zt*xt+Ft,Gt=zt*xt+Bt,qt=Ht>>>DIV,Wt=Gt>>>DIV,qt===Wt){if(Ct[qt]&RIGHT0[Ht&MOD]&RIGHT1[(Gt&MOD)+1])return!0}else{if(Ct[qt]&RIGHT0[Ht&MOD]||Ct[Wt]&RIGHT1[(Gt&MOD)+1])return!0;for(let Yt=qt+1;Yt<Wt;++Yt)if(Ct[Yt])return!0}return!1},setRange:(Ft,jt,Bt,Vt)=>{let zt,Ht,Gt,qt,Wt;for(;jt<=Vt;++jt)if(zt=jt*xt+Ft,Ht=jt*xt+Bt,Gt=zt>>>DIV,qt=Ht>>>DIV,Gt===qt)kt(Gt,RIGHT0[zt&MOD]&RIGHT1[(Ht&MOD)+1]);else for(kt(Gt,RIGHT0[zt&MOD]),kt(qt,RIGHT1[(Ht&MOD)+1]),Wt=Gt+1;Wt<qt;++Wt)kt(Wt,4294967295)},clearRange:(Ft,jt,Bt,Vt)=>{let zt,Ht,Gt,qt,Wt;for(;jt<=Vt;++jt)if(zt=jt*xt+Ft,Ht=jt*xt+Bt,Gt=zt>>>DIV,qt=Ht>>>DIV,Gt===qt)Mt(Gt,RIGHT1[zt&MOD]|RIGHT0[(Ht&MOD)+1]);else for(Mt(Gt,RIGHT1[zt&MOD]),Mt(qt,RIGHT0[(Ht&MOD)+1]),Wt=Gt+1;Wt<qt;++Wt)Mt(Wt,0)},outOfBounds:(Ft,jt,Bt,Vt)=>Ft<0||jt<0||Vt>=$t||Bt>=xt}}function scaler(xt,$t,Ct){const kt=Math.max(1,Math.sqrt(xt*$t/1e6)),Mt=~~((xt+2*Ct+kt)/kt),Ft=~~(($t+2*Ct+kt)/kt),jt=Bt=>~~((Bt+Ct)/kt);return jt.invert=Bt=>Bt*kt-Ct,jt.bitmap=()=>Bitmap(Mt,Ft),jt.ratio=kt,jt.padding=Ct,jt.width=xt,jt.height=$t,jt}function placeAreaLabelNaive(xt,$t,Ct,kt){const Mt=xt.width,Ft=xt.height;return function(jt){const Bt=jt.datum.datum.items[kt].items,Vt=Bt.length,zt=jt.datum.fontSize,Ht=textMetrics.width(jt.datum,jt.datum.text);let Gt=0,qt,Wt,Yt,Kt,Xt,Qt,Jt;for(let Zt=0;Zt<Vt;++Zt)qt=Bt[Zt].x,Yt=Bt[Zt].y,Wt=Bt[Zt].x2===void 0?qt:Bt[Zt].x2,Kt=Bt[Zt].y2===void 0?Yt:Bt[Zt].y2,Xt=(qt+Wt)/2,Qt=(Yt+Kt)/2,Jt=Math.abs(Wt-qt+Kt-Yt),Jt>=Gt&&(Gt=Jt,jt.x=Xt,jt.y=Qt);return Xt=Ht/2,Qt=zt/2,qt=jt.x-Xt,Wt=jt.x+Xt,Yt=jt.y-Qt,Kt=jt.y+Qt,jt.align="center",qt<0&&Wt<=Mt?jt.align="left":0<=qt&&Mt<Wt&&(jt.align="right"),jt.baseline="middle",Yt<0&&Kt<=Ft?jt.baseline="top":0<=Yt&&Ft<Kt&&(jt.baseline="bottom"),!0}}function outOfBounds(xt,$t,Ct,kt,Mt,Ft){let jt=Ct/2;return xt-jt<0||xt+jt>Mt||$t-(jt=kt/2)<0||$t+jt>Ft}function collision(xt,$t,Ct,kt,Mt,Ft,jt,Bt){const Vt=Mt*Ft/(kt*2),zt=xt($t-Vt),Ht=xt($t+Vt),Gt=xt(Ct-(Ft=Ft/2)),qt=xt(Ct+Ft);return jt.outOfBounds(zt,Gt,Ht,qt)||jt.getRange(zt,Gt,Ht,qt)||Bt&&Bt.getRange(zt,Gt,Ht,qt)}function placeAreaLabelReducedSearch(xt,$t,Ct,kt){const Mt=xt.width,Ft=xt.height,jt=$t[0],Bt=$t[1];function Vt(zt,Ht,Gt,qt,Wt){const Yt=xt.invert(zt),Kt=xt.invert(Ht);let Xt=Gt,Qt=Ft,Jt;if(!outOfBounds(Yt,Kt,qt,Wt,Mt,Ft)&&!collision(xt,Yt,Kt,Wt,qt,Xt,jt,Bt)&&!collision(xt,Yt,Kt,Wt,qt,Wt,jt,null)){for(;Qt-Xt>=1;)Jt=(Xt+Qt)/2,collision(xt,Yt,Kt,Wt,qt,Jt,jt,Bt)?Qt=Jt:Xt=Jt;if(Xt>Gt)return[Yt,Kt,Xt,!0]}}return function(zt){const Ht=zt.datum.datum.items[kt].items,Gt=Ht.length,qt=zt.datum.fontSize,Wt=textMetrics.width(zt.datum,zt.datum.text);let Yt=Ct?qt:0,Kt=!1,Xt=!1,Qt=0,Jt,Zt,sn,ln,dn,hn,cn,pn,yn,gn,En,bn,xn,Cn,$n,wn,Rn;for(let Dn=0;Dn<Gt;++Dn){for(Jt=Ht[Dn].x,sn=Ht[Dn].y,Zt=Ht[Dn].x2===void 0?Jt:Ht[Dn].x2,ln=Ht[Dn].y2===void 0?sn:Ht[Dn].y2,Jt>Zt&&(Rn=Jt,Jt=Zt,Zt=Rn),sn>ln&&(Rn=sn,sn=ln,ln=Rn),yn=xt(Jt),En=xt(Zt),gn=~~((yn+En)/2),bn=xt(sn),Cn=xt(ln),xn=~~((bn+Cn)/2),cn=gn;cn>=yn;--cn)for(pn=xn;pn>=bn;--pn)wn=Vt(cn,pn,Yt,Wt,qt),wn&&([zt.x,zt.y,Yt,Kt]=wn);for(cn=gn;cn<=En;++cn)for(pn=xn;pn<=Cn;++pn)wn=Vt(cn,pn,Yt,Wt,qt),wn&&([zt.x,zt.y,Yt,Kt]=wn);!Kt&&!Ct&&($n=Math.abs(Zt-Jt+ln-sn),dn=(Jt+Zt)/2,hn=(sn+ln)/2,$n>=Qt&&!outOfBounds(dn,hn,Wt,qt,Mt,Ft)&&!collision(xt,dn,hn,qt,Wt,qt,jt,null)&&(Qt=$n,zt.x=dn,zt.y=hn,Xt=!0))}return Kt||Xt?(dn=Wt/2,hn=qt/2,jt.setRange(xt(zt.x-dn),xt(zt.y-hn),xt(zt.x+dn),xt(zt.y+hn)),zt.align="center",zt.baseline="middle",!0):!1}}const X_DIR=[-1,-1,1,1],Y_DIR=[-1,1,-1,1];function placeAreaLabelFloodFill(xt,$t,Ct,kt){const Mt=xt.width,Ft=xt.height,jt=$t[0],Bt=$t[1],Vt=xt.bitmap();return function(zt){const Ht=zt.datum.datum.items[kt].items,Gt=Ht.length,qt=zt.datum.fontSize,Wt=textMetrics.width(zt.datum,zt.datum.text),Yt=[];let Kt=Ct?qt:0,Xt=!1,Qt=!1,Jt=0,Zt,sn,ln,dn,hn,cn,pn,yn,gn,En,bn,xn;for(let Cn=0;Cn<Gt;++Cn){for(Zt=Ht[Cn].x,ln=Ht[Cn].y,sn=Ht[Cn].x2===void 0?Zt:Ht[Cn].x2,dn=Ht[Cn].y2===void 0?ln:Ht[Cn].y2,Yt.push([xt((Zt+sn)/2),xt((ln+dn)/2)]);Yt.length;)if([pn,yn]=Yt.pop(),!(jt.get(pn,yn)||Bt.get(pn,yn)||Vt.get(pn,yn))){Vt.set(pn,yn);for(let $n=0;$n<4;++$n)hn=pn+X_DIR[$n],cn=yn+Y_DIR[$n],Vt.outOfBounds(hn,cn,hn,cn)||Yt.push([hn,cn]);if(hn=xt.invert(pn),cn=xt.invert(yn),gn=Kt,En=Ft,!outOfBounds(hn,cn,Wt,qt,Mt,Ft)&&!collision(xt,hn,cn,qt,Wt,gn,jt,Bt)&&!collision(xt,hn,cn,qt,Wt,qt,jt,null)){for(;En-gn>=1;)bn=(gn+En)/2,collision(xt,hn,cn,qt,Wt,bn,jt,Bt)?En=bn:gn=bn;gn>Kt&&(zt.x=hn,zt.y=cn,Kt=gn,Xt=!0)}}!Xt&&!Ct&&(xn=Math.abs(sn-Zt+dn-ln),hn=(Zt+sn)/2,cn=(ln+dn)/2,xn>=Jt&&!outOfBounds(hn,cn,Wt,qt,Mt,Ft)&&!collision(xt,hn,cn,qt,Wt,qt,jt,null)&&(Jt=xn,zt.x=hn,zt.y=cn,Qt=!0))}return Xt||Qt?(hn=Wt/2,cn=qt/2,jt.setRange(xt(zt.x-hn),xt(zt.y-cn),xt(zt.x+hn),xt(zt.y+cn)),zt.align="center",zt.baseline="middle",!0):!1}}const Aligns=["right","center","left"],Baselines=["bottom","middle","top"];function placeMarkLabel(xt,$t,Ct,kt){const Mt=xt.width,Ft=xt.height,jt=$t[0],Bt=$t[1],Vt=kt.length;return function(zt){const Ht=zt.boundary,Gt=zt.datum.fontSize;if(Ht[2]<0||Ht[5]<0||Ht[0]>Mt||Ht[3]>Ft)return!1;let qt=zt.textWidth??0,Wt,Yt,Kt,Xt,Qt,Jt,Zt,sn,ln,dn,hn,cn,pn,yn,gn;for(let En=0;En<Vt;++En){if(Wt=(Ct[En]&3)-1,Yt=(Ct[En]>>>2&3)-1,Kt=Wt===0&&Yt===0||kt[En]<0,Xt=Wt&&Yt?Math.SQRT1_2:1,Qt=kt[En]<0?-1:1,Jt=Ht[1+Wt]+kt[En]*Wt*Xt,hn=Ht[4+Yt]+Qt*Gt*Yt/2+kt[En]*Yt*Xt,sn=hn-Gt/2,ln=hn+Gt/2,cn=xt(Jt),yn=xt(sn),gn=xt(ln),!qt)if(test(cn,cn,yn,gn,jt,Bt,Jt,Jt,sn,ln,Ht,Kt))qt=textMetrics.width(zt.datum,zt.datum.text);else continue;if(dn=Jt+Qt*qt*Wt/2,Jt=dn-qt/2,Zt=dn+qt/2,cn=xt(Jt),pn=xt(Zt),test(cn,pn,yn,gn,jt,Bt,Jt,Zt,sn,ln,Ht,Kt))return zt.x=Wt?Wt*Qt<0?Zt:Jt:dn,zt.y=Yt?Yt*Qt<0?ln:sn:hn,zt.align=Aligns[Wt*Qt+1],zt.baseline=Baselines[Yt*Qt+1],jt.setRange(cn,yn,pn,gn),!0}return!1}}function test(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt,zt,Ht,Gt){return!(Mt.outOfBounds(xt,Ct,$t,kt)||(Gt&&Ft||Mt).getRange(xt,Ct,$t,kt))}const TOP=0,MIDDLE=4,BOTTOM=8,LEFT=0,CENTER$1=1,RIGHT=2,anchorCode={"top-left":TOP+LEFT,top:TOP+CENTER$1,"top-right":TOP+RIGHT,left:MIDDLE+LEFT,middle:MIDDLE+CENTER$1,right:MIDDLE+RIGHT,"bottom-left":BOTTOM+LEFT,bottom:BOTTOM+CENTER$1,"bottom-right":BOTTOM+RIGHT},placeAreaLabel={naive:placeAreaLabelNaive,"reduced-search":placeAreaLabelReducedSearch,floodfill:placeAreaLabelFloodFill};function labelLayout(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt,zt,Ht){if(!xt.length)return xt;const Gt=Math.max(kt.length,Mt.length),qt=getOffsets(kt,Gt),Wt=getAnchors(Mt,Gt),Yt=markType(xt[0].datum),Kt=Yt==="group"&&xt[0].datum.items[Vt].marktype,Xt=Kt==="area",Qt=markBoundary(Yt,Kt,Bt,Vt),Jt=zt===null||zt===1/0,Zt=Xt&&Ht==="naive";let sn=-1,ln=-1;const dn=xt.map(yn=>{const gn=Jt?textMetrics.width(yn,yn.text):void 0;return sn=Math.max(sn,gn),ln=Math.max(ln,yn.fontSize),{datum:yn,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:Qt(yn),textWidth:gn}});zt=zt===null||zt===1/0?Math.max(sn,ln)+Math.max(...kt):zt;const hn=scaler($t[0],$t[1],zt);let cn;if(!Zt){Ct&&dn.sort((En,bn)=>Ct(En.datum,bn.datum));let yn=!1;for(let En=0;En<Wt.length&&!yn;++En)yn=Wt[En]===5||qt[En]<0;const gn=(Yt&&jt||Xt)&&xt.map(En=>En.datum);cn=Ft.length||gn?markBitmaps(hn,gn||[],Ft,yn,Xt):baseBitmaps(hn,jt&&dn)}const pn=Xt?placeAreaLabel[Ht](hn,cn,jt,Vt):placeMarkLabel(hn,cn,Wt,qt);return dn.forEach(yn=>yn.opacity=+pn(yn)),dn}function getOffsets(xt,$t){const Ct=new Float64Array($t),kt=xt.length;for(let Mt=0;Mt<kt;++Mt)Ct[Mt]=xt[Mt]||0;for(let Mt=kt;Mt<$t;++Mt)Ct[Mt]=Ct[kt-1];return Ct}function getAnchors(xt,$t){const Ct=new Int8Array($t),kt=xt.length;for(let Mt=0;Mt<kt;++Mt)Ct[Mt]|=anchorCode[xt[Mt]];for(let Mt=kt;Mt<$t;++Mt)Ct[Mt]=Ct[kt-1];return Ct}function markType(xt){return xt&&xt.mark&&xt.mark.marktype}function markBoundary(xt,$t,Ct,kt){const Mt=Ft=>[Ft.x,Ft.x,Ft.x,Ft.y,Ft.y,Ft.y];return xt?xt==="line"||xt==="area"?Ft=>Mt(Ft.datum):$t==="line"?Ft=>{const jt=Ft.datum.items[kt].items;return Mt(jt.length?jt[Ct==="start"?0:jt.length-1]:{x:NaN,y:NaN})}:Ft=>{const jt=Ft.datum.bounds;return[jt.x1,(jt.x1+jt.x2)/2,jt.x2,jt.y1,(jt.y1+jt.y2)/2,jt.y2]}:Mt}const Output$1=["x","y","opacity","align","baseline"],Anchors=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function Label$1(xt){Transform.call(this,null,xt)}Label$1.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:Anchors},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:Output$1.length,default:Output$1}]};inherits(Label$1,Transform,{transform(xt,$t){function Ct(Ft){const jt=xt[Ft];return isFunction$1(jt)&&$t.modified(jt.fields)}const kt=xt.modified();if(!(kt||$t.changed($t.ADD_REM)||Ct("sort")))return;(!xt.size||xt.size.length!==2)&&error("Size parameter should be specified as a [width, height] array.");const Mt=xt.as||Output$1;return labelLayout($t.materialize($t.SOURCE).source||[],xt.size,xt.sort,array$2(xt.offset==null?1:xt.offset),array$2(xt.anchor||Anchors),xt.avoidMarks||[],xt.avoidBaseMark!==!1,xt.lineAnchor||"end",xt.markIndex||0,xt.padding===void 0?0:xt.padding,xt.method||"naive").forEach(Ft=>{const jt=Ft.datum;jt[Mt[0]]=Ft.x,jt[Mt[1]]=Ft.y,jt[Mt[2]]=Ft.opacity,jt[Mt[3]]=Ft.align,jt[Mt[4]]=Ft.baseline}),$t.reflow(kt).modifies(Mt)}});const label=Object.freeze(Object.defineProperty({__proto__:null,label:Label$1},Symbol.toStringTag,{value:"Module"}));function partition(xt,$t){var Ct=[],kt=function(Ht){return Ht(Bt)},Mt,Ft,jt,Bt,Vt,zt;if($t==null)Ct.push(xt);else for(Mt={},Ft=0,jt=xt.length;Ft<jt;++Ft)Bt=xt[Ft],Vt=$t.map(kt),zt=Mt[Vt],zt||(Mt[Vt]=zt=[],zt.dims=Vt,Ct.push(zt)),zt.push(Bt);return Ct}function Loess(xt){Transform.call(this,null,xt)}Loess.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};inherits(Loess,Transform,{transform(xt,$t){const Ct=$t.fork($t.NO_SOURCE|$t.NO_FIELDS);if(!this.value||$t.changed()||xt.modified()){const kt=$t.materialize($t.SOURCE).source,Mt=partition(kt,xt.groupby),Ft=(xt.groupby||[]).map(accessorName),jt=Ft.length,Bt=xt.as||[accessorName(xt.x),accessorName(xt.y)],Vt=[];Mt.forEach(zt=>{loess(zt,xt.x,xt.y,xt.bandwidth||.3).forEach(Ht=>{const Gt={};for(let qt=0;qt<jt;++qt)Gt[Ft[qt]]=zt.dims[qt];Gt[Bt[0]]=Ht[0],Gt[Bt[1]]=Ht[1],Vt.push(ingest$1(Gt))})}),this.value&&(Ct.rem=this.value),this.value=Ct.add=Ct.source=Vt}return Ct}});const Methods={constant,linear,log:log$1,exp,pow,quad,poly},degreesOfFreedom=(xt,$t)=>xt==="poly"?$t:xt==="quad"?2:1;function Regression(xt){Transform.call(this,null,xt)}Regression.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(Methods)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};inherits(Regression,Transform,{transform(xt,$t){const Ct=$t.fork($t.NO_SOURCE|$t.NO_FIELDS);if(!this.value||$t.changed()||xt.modified()){const kt=$t.materialize($t.SOURCE).source,Mt=partition(kt,xt.groupby),Ft=(xt.groupby||[]).map(accessorName),jt=xt.method||"linear",Bt=xt.order==null?3:xt.order,Vt=degreesOfFreedom(jt,Bt),zt=xt.as||[accessorName(xt.x),accessorName(xt.y)],Ht=Methods[jt],Gt=[];let qt=xt.extent;has$1(Methods,jt)||error("Invalid regression method: "+jt),qt!=null&&jt==="log"&&qt[0]<=0&&($t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),qt=null),Mt.forEach(Wt=>{if(Wt.length<=Vt){$t.dataflow.warn("Skipping regression with more parameters than data points.");return}const Kt=Ht(Wt,xt.x,xt.y,Bt);if(xt.params){Gt.push(ingest$1({keys:Wt.dims,coef:Kt.coef,rSquared:Kt.rSquared}));return}const Xt=qt||extent(Wt,xt.x),Qt=Jt=>{const Zt={};for(let sn=0;sn<Ft.length;++sn)Zt[Ft[sn]]=Wt.dims[sn];Zt[zt[0]]=Jt[0],Zt[zt[1]]=Jt[1],Gt.push(ingest$1(Zt))};jt==="linear"||jt==="constant"?Xt.forEach(Jt=>Qt([Jt,Kt.predict(Jt)])):sampleCurve(Kt.predict,Xt,25,200).forEach(Qt)}),this.value&&(Ct.rem=this.value),this.value=Ct.add=Ct.source=Gt}return Ct}});const reg=Object.freeze(Object.defineProperty({__proto__:null,loess:Loess,regression:Regression},Symbol.toStringTag,{value:"Module"}));function Voronoi(xt){Transform.call(this,null,xt)}Voronoi.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const defaultExtent=[-1e5,-1e5,1e5,1e5];inherits(Voronoi,Transform,{transform(xt,$t){const Ct=xt.as||"path",kt=$t.source;if(!kt||!kt.length)return $t;let Mt=xt.size;Mt=Mt?[0,0,Mt[0],Mt[1]]:(Mt=xt.extent)?[Mt[0][0],Mt[0][1],Mt[1][0],Mt[1][1]]:defaultExtent;const Ft=this.value=Delaunay.from(kt,xt.x,xt.y).voronoi(Mt);for(let jt=0,Bt=kt.length;jt<Bt;++jt){const Vt=Ft.cellPolygon(jt);kt[jt][Ct]=Vt&&!isPoint(Vt)?toPathString(Vt):null}return $t.reflow(xt.modified()).modifies(Ct)}});function toPathString(xt){const $t=xt[0][0],Ct=xt[0][1];let kt=xt.length-1;for(;xt[kt][0]===$t&&xt[kt][1]===Ct;--kt);return"M"+xt.slice(0,kt+1).join("L")+"Z"}function isPoint(xt){return xt.length===2&&xt[0][0]===xt[1][0]&&xt[0][1]===xt[1][1]}const voronoi=Object.freeze(Object.defineProperty({__proto__:null,voronoi:Voronoi},Symbol.toStringTag,{value:"Module"}));var cloudRadians=Math.PI/180,cw=64,ch=2048;function cloud(){var xt=[256,256],$t,Ct,kt,Mt,Ft,jt,Bt,Vt=archimedeanSpiral,zt=[],Ht=Math.random,Gt={};Gt.layout=function(){for(var Yt=qt(domCanvas()),Kt=zeroArray((xt[0]>>5)*xt[1]),Xt=null,Qt=zt.length,Jt=-1,Zt=[],sn=zt.map(dn=>({text:$t(dn),font:Ct(dn),style:Mt(dn),weight:Ft(dn),rotate:jt(dn),size:~~(kt(dn)+1e-14),padding:Bt(dn),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:dn})).sort((dn,hn)=>hn.size-dn.size);++Jt<Qt;){var ln=sn[Jt];ln.x=xt[0]*(Ht()+.5)>>1,ln.y=xt[1]*(Ht()+.5)>>1,cloudSprite(Yt,ln,sn,Jt),ln.hasText&&Wt(Kt,ln,Xt)&&(Zt.push(ln),Xt?cloudBounds(Xt,ln):Xt=[{x:ln.x+ln.x0,y:ln.y+ln.y0},{x:ln.x+ln.x1,y:ln.y+ln.y1}],ln.x-=xt[0]>>1,ln.y-=xt[1]>>1)}return Zt};function qt(Yt){Yt.width=Yt.height=1;var Kt=Math.sqrt(Yt.getContext("2d").getImageData(0,0,1,1).data.length>>2);Yt.width=(cw<<5)/Kt,Yt.height=ch/Kt;var Xt=Yt.getContext("2d");return Xt.fillStyle=Xt.strokeStyle="red",Xt.textAlign="center",{context:Xt,ratio:Kt}}function Wt(Yt,Kt,Xt){for(var Qt=Kt.x,Jt=Kt.y,Zt=Math.sqrt(xt[0]*xt[0]+xt[1]*xt[1]),sn=Vt(xt),ln=Ht()<.5?1:-1,dn=-ln,hn,cn,pn;(hn=sn(dn+=ln))&&(cn=~~hn[0],pn=~~hn[1],!(Math.min(Math.abs(cn),Math.abs(pn))>=Zt));)if(Kt.x=Qt+cn,Kt.y=Jt+pn,!(Kt.x+Kt.x0<0||Kt.y+Kt.y0<0||Kt.x+Kt.x1>xt[0]||Kt.y+Kt.y1>xt[1])&&(!Xt||!cloudCollide(Kt,Yt,xt[0]))&&(!Xt||collideRects(Kt,Xt))){for(var yn=Kt.sprite,gn=Kt.width>>5,En=xt[0]>>5,bn=Kt.x-(gn<<4),xn=bn&127,Cn=32-xn,$n=Kt.y1-Kt.y0,wn=(Kt.y+Kt.y0)*En+(bn>>5),Rn,Dn=0;Dn<$n;Dn++){Rn=0;for(var An=0;An<=gn;An++)Yt[wn+An]|=Rn<<Cn|(An<gn?(Rn=yn[Dn*gn+An])>>>xn:0);wn+=En}return Kt.sprite=null,!0}return!1}return Gt.words=function(Yt){return arguments.length?(zt=Yt,Gt):zt},Gt.size=function(Yt){return arguments.length?(xt=[+Yt[0],+Yt[1]],Gt):xt},Gt.font=function(Yt){return arguments.length?(Ct=functor(Yt),Gt):Ct},Gt.fontStyle=function(Yt){return arguments.length?(Mt=functor(Yt),Gt):Mt},Gt.fontWeight=function(Yt){return arguments.length?(Ft=functor(Yt),Gt):Ft},Gt.rotate=function(Yt){return arguments.length?(jt=functor(Yt),Gt):jt},Gt.text=function(Yt){return arguments.length?($t=functor(Yt),Gt):$t},Gt.spiral=function(Yt){return arguments.length?(Vt=spirals[Yt]||Yt,Gt):Vt},Gt.fontSize=function(Yt){return arguments.length?(kt=functor(Yt),Gt):kt},Gt.padding=function(Yt){return arguments.length?(Bt=functor(Yt),Gt):Bt},Gt.random=function(Yt){return arguments.length?(Ht=Yt,Gt):Ht},Gt}function cloudSprite(xt,$t,Ct,kt){if(!$t.sprite){var Mt=xt.context,Ft=xt.ratio;Mt.clearRect(0,0,(cw<<5)/Ft,ch/Ft);var jt=0,Bt=0,Vt=0,zt=Ct.length,Ht,Gt,qt,Wt,Yt;for(--kt;++kt<zt;){if($t=Ct[kt],Mt.save(),Mt.font=$t.style+" "+$t.weight+" "+~~(($t.size+1)/Ft)+"px "+$t.font,Ht=Mt.measureText($t.text+"m").width*Ft,qt=$t.size<<1,$t.rotate){var Kt=Math.sin($t.rotate*cloudRadians),Xt=Math.cos($t.rotate*cloudRadians),Qt=Ht*Xt,Jt=Ht*Kt,Zt=qt*Xt,sn=qt*Kt;Ht=Math.max(Math.abs(Qt+sn),Math.abs(Qt-sn))+31>>5<<5,qt=~~Math.max(Math.abs(Jt+Zt),Math.abs(Jt-Zt))}else Ht=Ht+31>>5<<5;if(qt>Vt&&(Vt=qt),jt+Ht>=cw<<5&&(jt=0,Bt+=Vt,Vt=0),Bt+qt>=ch)break;Mt.translate((jt+(Ht>>1))/Ft,(Bt+(qt>>1))/Ft),$t.rotate&&Mt.rotate($t.rotate*cloudRadians),Mt.fillText($t.text,0,0),$t.padding&&(Mt.lineWidth=2*$t.padding,Mt.strokeText($t.text,0,0)),Mt.restore(),$t.width=Ht,$t.height=qt,$t.xoff=jt,$t.yoff=Bt,$t.x1=Ht>>1,$t.y1=qt>>1,$t.x0=-$t.x1,$t.y0=-$t.y1,$t.hasText=!0,jt+=Ht}for(var ln=Mt.getImageData(0,0,(cw<<5)/Ft,ch/Ft).data,dn=[];--kt>=0;)if($t=Ct[kt],!!$t.hasText){for(Ht=$t.width,Gt=Ht>>5,qt=$t.y1-$t.y0,Wt=0;Wt<qt*Gt;Wt++)dn[Wt]=0;if(jt=$t.xoff,jt==null)return;Bt=$t.yoff;var hn=0,cn=-1;for(Yt=0;Yt<qt;Yt++){for(Wt=0;Wt<Ht;Wt++){var pn=Gt*Yt+(Wt>>5),yn=ln[(Bt+Yt)*(cw<<5)+(jt+Wt)<<2]?1<<31-Wt%32:0;dn[pn]|=yn,hn|=yn}hn?cn=Yt:($t.y0++,qt--,Yt--,Bt++)}$t.y1=$t.y0+cn,$t.sprite=dn.slice(0,($t.y1-$t.y0)*Gt)}}}function cloudCollide(xt,$t,Ct){Ct>>=5;for(var kt=xt.sprite,Mt=xt.width>>5,Ft=xt.x-(Mt<<4),jt=Ft&127,Bt=32-jt,Vt=xt.y1-xt.y0,zt=(xt.y+xt.y0)*Ct+(Ft>>5),Ht,Gt=0;Gt<Vt;Gt++){Ht=0;for(var qt=0;qt<=Mt;qt++)if((Ht<<Bt|(qt<Mt?(Ht=kt[Gt*Mt+qt])>>>jt:0))&$t[zt+qt])return!0;zt+=Ct}return!1}function cloudBounds(xt,$t){var Ct=xt[0],kt=xt[1];$t.x+$t.x0<Ct.x&&(Ct.x=$t.x+$t.x0),$t.y+$t.y0<Ct.y&&(Ct.y=$t.y+$t.y0),$t.x+$t.x1>kt.x&&(kt.x=$t.x+$t.x1),$t.y+$t.y1>kt.y&&(kt.y=$t.y+$t.y1)}function collideRects(xt,$t){return xt.x+xt.x1>$t[0].x&&xt.x+xt.x0<$t[1].x&&xt.y+xt.y1>$t[0].y&&xt.y+xt.y0<$t[1].y}function archimedeanSpiral(xt){var $t=xt[0]/xt[1];return function(Ct){return[$t*(Ct*=.1)*Math.cos(Ct),Ct*Math.sin(Ct)]}}function rectangularSpiral(xt){var $t=4,Ct=$t*xt[0]/xt[1],kt=0,Mt=0;return function(Ft){var jt=Ft<0?-1:1;switch(Math.sqrt(1+4*jt*Ft)-jt&3){case 0:kt+=Ct;break;case 1:Mt+=$t;break;case 2:kt-=Ct;break;default:Mt-=$t;break}return[kt,Mt]}}function zeroArray(xt){for(var $t=[],Ct=-1;++Ct<xt;)$t[Ct]=0;return $t}function functor(xt){return typeof xt=="function"?xt:function(){return xt}}var spirals={archimedean:archimedeanSpiral,rectangular:rectangularSpiral};const Output=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Params$1=["text","font","rotate","fontSize","fontStyle","fontWeight"];function Wordcloud(xt){Transform.call(this,cloud(),xt)}Wordcloud.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:Output}]};inherits(Wordcloud,Transform,{transform(xt,$t){xt.size&&!(xt.size[0]&&xt.size[1])&&error("Wordcloud size dimensions must be non-zero.");function Ct(Yt){const Kt=xt[Yt];return isFunction$1(Kt)&&$t.modified(Kt.fields)}const kt=xt.modified();if(!(kt||$t.changed($t.ADD_REM)||Params$1.some(Ct)))return;const Mt=$t.materialize($t.SOURCE).source,Ft=this.value,jt=xt.as||Output;let Bt=xt.fontSize||14,Vt;if(isFunction$1(Bt)?Vt=xt.fontSizeRange:Bt=constant$1(Bt),Vt){const Yt=Bt,Kt=scale$4("sqrt")().domain(extent(Mt,Yt)).range(Vt);Bt=Xt=>Kt(Yt(Xt))}Mt.forEach(Yt=>{Yt[jt[0]]=NaN,Yt[jt[1]]=NaN,Yt[jt[3]]=0});const zt=Ft.words(Mt).text(xt.text).size(xt.size||[500,500]).padding(xt.padding||1).spiral(xt.spiral||"archimedean").rotate(xt.rotate||0).font(xt.font||"sans-serif").fontStyle(xt.fontStyle||"normal").fontWeight(xt.fontWeight||"normal").fontSize(Bt).random(random).layout(),Ht=Ft.size(),Gt=Ht[0]>>1,qt=Ht[1]>>1,Wt=zt.length;for(let Yt=0,Kt,Xt;Yt<Wt;++Yt)Kt=zt[Yt],Xt=Kt.datum,Xt[jt[0]]=Kt.x+Gt,Xt[jt[1]]=Kt.y+qt,Xt[jt[2]]=Kt.font,Xt[jt[3]]=Kt.size,Xt[jt[4]]=Kt.style,Xt[jt[5]]=Kt.weight,Xt[jt[6]]=Kt.rotate;return $t.reflow(kt).modifies(jt)}});const wordcloud=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:Wordcloud},Symbol.toStringTag,{value:"Module"})),array8=xt=>new Uint8Array(xt),array16=xt=>new Uint16Array(xt),array32=xt=>new Uint32Array(xt);function Bitmaps(){let xt=8,$t=[],Ct=array32(0),kt=array$1(0,xt),Mt=array$1(0,xt);return{data:()=>$t,seen:()=>Ct=lengthen(Ct,$t.length),add(Ft){for(let jt=0,Bt=$t.length,Vt=Ft.length,zt;jt<Vt;++jt)zt=Ft[jt],zt._index=Bt++,$t.push(zt)},remove(Ft,jt){const Bt=$t.length,Vt=Array(Bt-Ft),zt=$t;let Ht,Gt,qt;for(Gt=0;!jt[Gt]&&Gt<Bt;++Gt)Vt[Gt]=$t[Gt],zt[Gt]=Gt;for(qt=Gt;Gt<Bt;++Gt)Ht=$t[Gt],jt[Gt]?zt[Gt]=-1:(zt[Gt]=qt,kt[qt]=kt[Gt],Mt[qt]=Mt[Gt],Vt[qt]=Ht,Ht._index=qt++),kt[Gt]=0;return $t=Vt,zt},size:()=>$t.length,curr:()=>kt,prev:()=>Mt,reset:Ft=>Mt[Ft]=kt[Ft],all:()=>xt<257?255:xt<65537?65535:4294967295,set(Ft,jt){kt[Ft]|=jt},clear(Ft,jt){kt[Ft]&=~jt},resize(Ft,jt){const Bt=kt.length;(Ft>Bt||jt>xt)&&(xt=Math.max(jt,xt),kt=array$1(Ft,xt,kt),Mt=array$1(Ft,xt))}}}function lengthen(xt,$t,Ct){return xt.length>=$t?xt:(Ct=Ct||new xt.constructor($t),Ct.set(xt),Ct)}function array$1(xt,$t,Ct){const kt=($t<257?array8:$t<65537?array16:array32)(xt);return Ct&&kt.set(Ct),kt}function Dimension(xt,$t,Ct){const kt=1<<$t;return{one:kt,zero:~kt,range:Ct.slice(),bisect:xt.bisect,index:xt.index,size:xt.size,onAdd(Mt,Ft){const jt=this,Bt=jt.bisect(jt.range,Mt.value),Vt=Mt.index,zt=Bt[0],Ht=Bt[1],Gt=Vt.length;let qt;for(qt=0;qt<zt;++qt)Ft[Vt[qt]]|=kt;for(qt=Ht;qt<Gt;++qt)Ft[Vt[qt]]|=kt;return jt}}}function SortedIndex(){let xt=array32(0),$t=[],Ct=0;function kt(Bt,Vt,zt){if(!Vt.length)return[];const Ht=Ct,Gt=Vt.length,qt=array32(Gt);let Wt=Array(Gt),Yt,Kt,Xt;for(Xt=0;Xt<Gt;++Xt)Wt[Xt]=Bt(Vt[Xt]),qt[Xt]=Xt;if(Wt=sort(Wt,qt),Ht)Yt=$t,Kt=xt,$t=Array(Ht+Gt),xt=array32(Ht+Gt),merge$1(zt,Yt,Kt,Ht,Wt,qt,Gt,$t,xt);else{if(zt>0)for(Xt=0;Xt<Gt;++Xt)qt[Xt]+=zt;$t=Wt,xt=qt}return Ct=Ht+Gt,{index:qt,value:Wt}}function Mt(Bt,Vt){const zt=Ct;let Ht,Gt,qt;for(Gt=0;!Vt[xt[Gt]]&&Gt<zt;++Gt);for(qt=Gt;Gt<zt;++Gt)Vt[Ht=xt[Gt]]||(xt[qt]=Ht,$t[qt]=$t[Gt],++qt);Ct=zt-Bt}function Ft(Bt){for(let Vt=0,zt=Ct;Vt<zt;++Vt)xt[Vt]=Bt[xt[Vt]]}function jt(Bt,Vt){let zt;return Vt?zt=Vt.length:(Vt=$t,zt=Ct),[bisectLeft$1(Vt,Bt[0],0,zt),bisectRight$1(Vt,Bt[1],0,zt)]}return{insert:kt,remove:Mt,bisect:jt,reindex:Ft,index:()=>xt,size:()=>Ct}}function sort(xt,$t){return xt.sort.call($t,(Ct,kt)=>{const Mt=xt[Ct],Ft=xt[kt];return Mt<Ft?-1:Mt>Ft?1:0}),permute(xt,$t)}function merge$1(xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt){let zt=0,Ht=0,Gt;for(Gt=0;zt<kt&&Ht<jt;++Gt)$t[zt]<Mt[Ht]?(Bt[Gt]=$t[zt],Vt[Gt]=Ct[zt++]):(Bt[Gt]=Mt[Ht],Vt[Gt]=Ft[Ht++]+xt);for(;zt<kt;++zt,++Gt)Bt[Gt]=$t[zt],Vt[Gt]=Ct[zt];for(;Ht<jt;++Ht,++Gt)Bt[Gt]=Mt[Ht],Vt[Gt]=Ft[Ht]+xt}function CrossFilter(xt){Transform.call(this,Bitmaps(),xt),this._indices=null,this._dims=null}CrossFilter.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};inherits(CrossFilter,Transform,{transform(xt,$t){if(this._dims){var Ct=xt.modified("fields")||xt.fields.some(kt=>$t.modified(kt.fields));return Ct?this.reinit(xt,$t):this.eval(xt,$t)}else return this.init(xt,$t)},init(xt,$t){const Ct=xt.fields,kt=xt.query,Mt=this._indices={},Ft=this._dims=[],jt=kt.length;let Bt=0,Vt,zt;for(;Bt<jt;++Bt)Vt=Ct[Bt].fname,zt=Mt[Vt]||(Mt[Vt]=SortedIndex()),Ft.push(Dimension(zt,Bt,kt[Bt]));return this.eval(xt,$t)},reinit(xt,$t){const Ct=$t.materialize().fork(),kt=xt.fields,Mt=xt.query,Ft=this._indices,jt=this._dims,Bt=this.value,Vt=Bt.curr(),zt=Bt.prev(),Ht=Bt.all(),Gt=Ct.rem=Ct.add,qt=Ct.mod,Wt=Mt.length,Yt={};let Kt,Xt,Qt,Jt,Zt,sn,ln,dn,hn;if(zt.set(Vt),$t.rem.length&&(Zt=this.remove(xt,$t,Ct)),$t.add.length&&Bt.add($t.add),$t.mod.length)for(sn={},Jt=$t.mod,ln=0,dn=Jt.length;ln<dn;++ln)sn[Jt[ln]._index]=1;for(ln=0;ln<Wt;++ln)hn=kt[ln],(!jt[ln]||xt.modified("fields",ln)||$t.modified(hn.fields))&&(Qt=hn.fname,(Kt=Yt[Qt])||(Ft[Qt]=Xt=SortedIndex(),Yt[Qt]=Kt=Xt.insert(hn,$t.source,0)),jt[ln]=Dimension(Xt,ln,Mt[ln]).onAdd(Kt,Vt));for(ln=0,dn=Bt.data().length;ln<dn;++ln)Zt[ln]||(zt[ln]!==Vt[ln]?Gt.push(ln):sn[ln]&&Vt[ln]!==Ht&&qt.push(ln));return Bt.mask=(1<<Wt)-1,Ct},eval(xt,$t){const Ct=$t.materialize().fork(),kt=this._dims.length;let Mt=0;return $t.rem.length&&(this.remove(xt,$t,Ct),Mt|=(1<<kt)-1),xt.modified("query")&&!xt.modified("fields")&&(Mt|=this.update(xt,$t,Ct)),$t.add.length&&(this.insert(xt,$t,Ct),Mt|=(1<<kt)-1),$t.mod.length&&(this.modify($t,Ct),Mt|=(1<<kt)-1),this.value.mask=Mt,Ct},insert(xt,$t,Ct){const kt=$t.add,Mt=this.value,Ft=this._dims,jt=this._indices,Bt=xt.fields,Vt={},zt=Ct.add,Ht=Mt.size()+kt.length,Gt=Ft.length;let qt=Mt.size(),Wt,Yt,Kt;Mt.resize(Ht,Gt),Mt.add(kt);const Xt=Mt.curr(),Qt=Mt.prev(),Jt=Mt.all();for(Wt=0;Wt<Gt;++Wt)Yt=Bt[Wt].fname,Kt=Vt[Yt]||(Vt[Yt]=jt[Yt].insert(Bt[Wt],kt,qt)),Ft[Wt].onAdd(Kt,Xt);for(;qt<Ht;++qt)Qt[qt]=Jt,Xt[qt]!==Jt&&zt.push(qt)},modify(xt,$t){const Ct=$t.mod,kt=this.value,Mt=kt.curr(),Ft=kt.all(),jt=xt.mod;let Bt,Vt,zt;for(Bt=0,Vt=jt.length;Bt<Vt;++Bt)zt=jt[Bt]._index,Mt[zt]!==Ft&&Ct.push(zt)},remove(xt,$t,Ct){const kt=this._indices,Mt=this.value,Ft=Mt.curr(),jt=Mt.prev(),Bt=Mt.all(),Vt={},zt=Ct.rem,Ht=$t.rem;let Gt,qt,Wt,Yt;for(Gt=0,qt=Ht.length;Gt<qt;++Gt)Wt=Ht[Gt]._index,Vt[Wt]=1,jt[Wt]=Yt=Ft[Wt],Ft[Wt]=Bt,Yt!==Bt&&zt.push(Wt);for(Wt in kt)kt[Wt].remove(qt,Vt);return this.reindex($t,qt,Vt),Vt},reindex(xt,$t,Ct){const kt=this._indices,Mt=this.value;xt.runAfter(()=>{const Ft=Mt.remove($t,Ct);for(const jt in kt)kt[jt].reindex(Ft)})},update(xt,$t,Ct){const kt=this._dims,Mt=xt.query,Ft=$t.stamp,jt=kt.length;let Bt=0,Vt,zt;for(Ct.filters=0,zt=0;zt<jt;++zt)xt.modified("query",zt)&&(Vt=zt,++Bt);if(Bt===1)Bt=kt[Vt].one,this.incrementOne(kt[Vt],Mt[Vt],Ct.add,Ct.rem);else for(zt=0,Bt=0;zt<jt;++zt)xt.modified("query",zt)&&(Bt|=kt[zt].one,this.incrementAll(kt[zt],Mt[zt],Ft,Ct.add),Ct.rem=Ct.add);return Bt},incrementAll(xt,$t,Ct,kt){const Mt=this.value,Ft=Mt.seen(),jt=Mt.curr(),Bt=Mt.prev(),Vt=xt.index(),zt=xt.bisect(xt.range),Ht=xt.bisect($t),Gt=Ht[0],qt=Ht[1],Wt=zt[0],Yt=zt[1],Kt=xt.one;let Xt,Qt,Jt;if(Gt<Wt)for(Xt=Gt,Qt=Math.min(Wt,qt);Xt<Qt;++Xt)Jt=Vt[Xt],Ft[Jt]!==Ct&&(Bt[Jt]=jt[Jt],Ft[Jt]=Ct,kt.push(Jt)),jt[Jt]^=Kt;else if(Gt>Wt)for(Xt=Wt,Qt=Math.min(Gt,Yt);Xt<Qt;++Xt)Jt=Vt[Xt],Ft[Jt]!==Ct&&(Bt[Jt]=jt[Jt],Ft[Jt]=Ct,kt.push(Jt)),jt[Jt]^=Kt;if(qt>Yt)for(Xt=Math.max(Gt,Yt),Qt=qt;Xt<Qt;++Xt)Jt=Vt[Xt],Ft[Jt]!==Ct&&(Bt[Jt]=jt[Jt],Ft[Jt]=Ct,kt.push(Jt)),jt[Jt]^=Kt;else if(qt<Yt)for(Xt=Math.max(Wt,qt),Qt=Yt;Xt<Qt;++Xt)Jt=Vt[Xt],Ft[Jt]!==Ct&&(Bt[Jt]=jt[Jt],Ft[Jt]=Ct,kt.push(Jt)),jt[Jt]^=Kt;xt.range=$t.slice()},incrementOne(xt,$t,Ct,kt){const Mt=this.value,Ft=Mt.curr(),jt=xt.index(),Bt=xt.bisect(xt.range),Vt=xt.bisect($t),zt=Vt[0],Ht=Vt[1],Gt=Bt[0],qt=Bt[1],Wt=xt.one;let Yt,Kt,Xt;if(zt<Gt)for(Yt=zt,Kt=Math.min(Gt,Ht);Yt<Kt;++Yt)Xt=jt[Yt],Ft[Xt]^=Wt,Ct.push(Xt);else if(zt>Gt)for(Yt=Gt,Kt=Math.min(zt,qt);Yt<Kt;++Yt)Xt=jt[Yt],Ft[Xt]^=Wt,kt.push(Xt);if(Ht>qt)for(Yt=Math.max(zt,qt),Kt=Ht;Yt<Kt;++Yt)Xt=jt[Yt],Ft[Xt]^=Wt,Ct.push(Xt);else if(Ht<qt)for(Yt=Math.max(Gt,Ht),Kt=qt;Yt<Kt;++Yt)Xt=jt[Yt],Ft[Xt]^=Wt,kt.push(Xt);xt.range=$t.slice()}});function ResolveFilter(xt){Transform.call(this,null,xt)}ResolveFilter.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};inherits(ResolveFilter,Transform,{transform(xt,$t){const Ct=~(xt.ignore||0),kt=xt.filter,Mt=kt.mask;if(!(Mt&Ct))return $t.StopPropagation;const Ft=$t.fork($t.ALL),jt=kt.data(),Bt=kt.curr(),Vt=kt.prev(),zt=Ht=>Bt[Ht]&Ct?null:jt[Ht];return Ft.filter(Ft.MOD,zt),Mt&Mt-1?(Ft.filter(Ft.ADD,Ht=>{const Gt=Bt[Ht]&Ct;return!Gt&&Gt^Vt[Ht]&Ct?jt[Ht]:null}),Ft.filter(Ft.REM,Ht=>{const Gt=Bt[Ht]&Ct;return Gt&&!(Gt^(Gt^Vt[Ht]&Ct))?jt[Ht]:null})):(Ft.filter(Ft.ADD,zt),Ft.filter(Ft.REM,Ht=>(Bt[Ht]&Ct)===Mt?jt[Ht]:null)),Ft.filter(Ft.SOURCE,Ht=>zt(Ht._index))}});const xf=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:CrossFilter,resolvefilter:ResolveFilter},Symbol.toStringTag,{value:"Module"})),RawCode="RawCode",Literal="Literal",Property="Property",Identifier="Identifier",ArrayExpression="ArrayExpression",BinaryExpression="BinaryExpression",CallExpression="CallExpression",ConditionalExpression="ConditionalExpression",LogicalExpression="LogicalExpression",MemberExpression="MemberExpression",ObjectExpression="ObjectExpression",UnaryExpression="UnaryExpression";function ASTNode(xt){this.type=xt}ASTNode.prototype.visit=function(xt){let $t,Ct,kt;if(xt(this))return 1;for($t=children(this),Ct=0,kt=$t.length;Ct<kt;++Ct)if($t[Ct].visit(xt))return 1};function children(xt){switch(xt.type){case ArrayExpression:return xt.elements;case BinaryExpression:case LogicalExpression:return[xt.left,xt.right];case CallExpression:return[xt.callee].concat(xt.arguments);case ConditionalExpression:return[xt.test,xt.consequent,xt.alternate];case MemberExpression:return[xt.object,xt.property];case ObjectExpression:return xt.properties;case Property:return[xt.key,xt.value];case UnaryExpression:return[xt.argument];case Identifier:case Literal:case RawCode:default:return[]}}var TokenName,source,index,length,lookahead,TokenBooleanLiteral=1,TokenEOF=2,TokenIdentifier=3,TokenKeyword=4,TokenNullLiteral=5,TokenNumericLiteral=6,TokenPunctuator=7,TokenStringLiteral=8,TokenRegularExpression=9;TokenName={};TokenName[TokenBooleanLiteral]="Boolean";TokenName[TokenEOF]="<end>";TokenName[TokenIdentifier]="Identifier";TokenName[TokenKeyword]="Keyword";TokenName[TokenNullLiteral]="Null";TokenName[TokenNumericLiteral]="Numeric";TokenName[TokenPunctuator]="Punctuator";TokenName[TokenStringLiteral]="String";TokenName[TokenRegularExpression]="RegularExpression";var SyntaxArrayExpression="ArrayExpression",SyntaxBinaryExpression="BinaryExpression",SyntaxCallExpression="CallExpression",SyntaxConditionalExpression="ConditionalExpression",SyntaxIdentifier="Identifier",SyntaxLiteral="Literal",SyntaxLogicalExpression="LogicalExpression",SyntaxMemberExpression="MemberExpression",SyntaxObjectExpression="ObjectExpression",SyntaxProperty="Property",SyntaxUnaryExpression="UnaryExpression",MessageUnexpectedToken="Unexpected token %0",MessageUnexpectedNumber="Unexpected number",MessageUnexpectedString="Unexpected string",MessageUnexpectedIdentifier="Unexpected identifier",MessageUnexpectedReserved="Unexpected reserved word",MessageUnexpectedEOS="Unexpected end of input",MessageInvalidRegExp="Invalid regular expression",MessageUnterminatedRegExp="Invalid regular expression: missing /",MessageStrictOctalLiteral="Octal literals are not allowed in strict mode.",MessageStrictDuplicateProperty="Duplicate data property in object literal not allowed in strict mode",ILLEGAL$1="ILLEGAL",DISABLED="Disabled.",RegexNonAsciiIdentifierStart=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),RegexNonAsciiIdentifierPart=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function assert(xt,$t){if(!xt)throw new Error("ASSERT: "+$t)}function isDecimalDigit(xt){return xt>=48&&xt<=57}function isHexDigit(xt){return"0123456789abcdefABCDEF".indexOf(xt)>=0}function isOctalDigit(xt){return"01234567".indexOf(xt)>=0}function isWhiteSpace(xt){return xt===32||xt===9||xt===11||xt===12||xt===160||xt>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(xt)>=0}function isLineTerminator(xt){return xt===10||xt===13||xt===8232||xt===8233}function isIdentifierStart(xt){return xt===36||xt===95||xt>=65&&xt<=90||xt>=97&&xt<=122||xt===92||xt>=128&&RegexNonAsciiIdentifierStart.test(String.fromCharCode(xt))}function isIdentifierPart(xt){return xt===36||xt===95||xt>=65&&xt<=90||xt>=97&&xt<=122||xt>=48&&xt<=57||xt===92||xt>=128&&RegexNonAsciiIdentifierPart.test(String.fromCharCode(xt))}const keywords$2={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function skipComment(){for(;index<length;){const xt=source.charCodeAt(index);if(isWhiteSpace(xt)||isLineTerminator(xt))++index;else break}}function scanHexEscape(xt){var $t,Ct,kt,Mt=0;for(Ct=xt==="u"?4:2,$t=0;$t<Ct;++$t)index<length&&isHexDigit(source[index])?(kt=source[index++],Mt=Mt*16+"0123456789abcdef".indexOf(kt.toLowerCase())):throwError({},MessageUnexpectedToken,ILLEGAL$1);return String.fromCharCode(Mt)}function scanUnicodeCodePointEscape(){var xt,$t,Ct,kt;for(xt=source[index],$t=0,xt==="}"&&throwError({},MessageUnexpectedToken,ILLEGAL$1);index<length&&(xt=source[index++],!!isHexDigit(xt));)$t=$t*16+"0123456789abcdef".indexOf(xt.toLowerCase());return($t>1114111||xt!=="}")&&throwError({},MessageUnexpectedToken,ILLEGAL$1),$t<=65535?String.fromCharCode($t):(Ct=($t-65536>>10)+55296,kt=($t-65536&1023)+56320,String.fromCharCode(Ct,kt))}function getEscapedIdentifier(){var xt,$t;for(xt=source.charCodeAt(index++),$t=String.fromCharCode(xt),xt===92&&(source.charCodeAt(index)!==117&&throwError({},MessageUnexpectedToken,ILLEGAL$1),++index,xt=scanHexEscape("u"),(!xt||xt==="\\"||!isIdentifierStart(xt.charCodeAt(0)))&&throwError({},MessageUnexpectedToken,ILLEGAL$1),$t=xt);index<length&&(xt=source.charCodeAt(index),!!isIdentifierPart(xt));)++index,$t+=String.fromCharCode(xt),xt===92&&($t=$t.substr(0,$t.length-1),source.charCodeAt(index)!==117&&throwError({},MessageUnexpectedToken,ILLEGAL$1),++index,xt=scanHexEscape("u"),(!xt||xt==="\\"||!isIdentifierPart(xt.charCodeAt(0)))&&throwError({},MessageUnexpectedToken,ILLEGAL$1),$t+=xt);return $t}function getIdentifier(){var xt,$t;for(xt=index++;index<length;){if($t=source.charCodeAt(index),$t===92)return index=xt,getEscapedIdentifier();if(isIdentifierPart($t))++index;else break}return source.slice(xt,index)}function scanIdentifier(){var xt,$t,Ct;return xt=index,$t=source.charCodeAt(index)===92?getEscapedIdentifier():getIdentifier(),$t.length===1?Ct=TokenIdentifier:keywords$2.hasOwnProperty($t)?Ct=TokenKeyword:$t==="null"?Ct=TokenNullLiteral:$t==="true"||$t==="false"?Ct=TokenBooleanLiteral:Ct=TokenIdentifier,{type:Ct,value:$t,start:xt,end:index}}function scanPunctuator(){var xt=index,$t=source.charCodeAt(index),Ct,kt=source[index],Mt,Ft,jt;switch($t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++index,{type:TokenPunctuator,value:String.fromCharCode($t),start:xt,end:index};default:if(Ct=source.charCodeAt(index+1),Ct===61)switch($t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return index+=2,{type:TokenPunctuator,value:String.fromCharCode($t)+String.fromCharCode(Ct),start:xt,end:index};case 33:case 61:return index+=2,source.charCodeAt(index)===61&&++index,{type:TokenPunctuator,value:source.slice(xt,index),start:xt,end:index}}}if(jt=source.substr(index,4),jt===">>>=")return index+=4,{type:TokenPunctuator,value:jt,start:xt,end:index};if(Ft=jt.substr(0,3),Ft===">>>"||Ft==="<<="||Ft===">>=")return index+=3,{type:TokenPunctuator,value:Ft,start:xt,end:index};if(Mt=Ft.substr(0,2),kt===Mt[1]&&"+-<>&|".indexOf(kt)>=0||Mt==="=>")return index+=2,{type:TokenPunctuator,value:Mt,start:xt,end:index};if(Mt==="//"&&throwError({},MessageUnexpectedToken,ILLEGAL$1),"<>=!+-*%&|^/".indexOf(kt)>=0)return++index,{type:TokenPunctuator,value:kt,start:xt,end:index};throwError({},MessageUnexpectedToken,ILLEGAL$1)}function scanHexLiteral(xt){let $t="";for(;index<length&&isHexDigit(source[index]);)$t+=source[index++];return $t.length===0&&throwError({},MessageUnexpectedToken,ILLEGAL$1),isIdentifierStart(source.charCodeAt(index))&&throwError({},MessageUnexpectedToken,ILLEGAL$1),{type:TokenNumericLiteral,value:parseInt("0x"+$t,16),start:xt,end:index}}function scanOctalLiteral(xt){let $t="0"+source[index++];for(;index<length&&isOctalDigit(source[index]);)$t+=source[index++];return(isIdentifierStart(source.charCodeAt(index))||isDecimalDigit(source.charCodeAt(index)))&&throwError({},MessageUnexpectedToken,ILLEGAL$1),{type:TokenNumericLiteral,value:parseInt($t,8),octal:!0,start:xt,end:index}}function scanNumericLiteral(){var xt,$t,Ct;if(Ct=source[index],assert(isDecimalDigit(Ct.charCodeAt(0))||Ct===".","Numeric literal must start with a decimal digit or a decimal point"),$t=index,xt="",Ct!=="."){if(xt=source[index++],Ct=source[index],xt==="0"){if(Ct==="x"||Ct==="X")return++index,scanHexLiteral($t);if(isOctalDigit(Ct))return scanOctalLiteral($t);Ct&&isDecimalDigit(Ct.charCodeAt(0))&&throwError({},MessageUnexpectedToken,ILLEGAL$1)}for(;isDecimalDigit(source.charCodeAt(index));)xt+=source[index++];Ct=source[index]}if(Ct==="."){for(xt+=source[index++];isDecimalDigit(source.charCodeAt(index));)xt+=source[index++];Ct=source[index]}if(Ct==="e"||Ct==="E")if(xt+=source[index++],Ct=source[index],(Ct==="+"||Ct==="-")&&(xt+=source[index++]),isDecimalDigit(source.charCodeAt(index)))for(;isDecimalDigit(source.charCodeAt(index));)xt+=source[index++];else throwError({},MessageUnexpectedToken,ILLEGAL$1);return isIdentifierStart(source.charCodeAt(index))&&throwError({},MessageUnexpectedToken,ILLEGAL$1),{type:TokenNumericLiteral,value:parseFloat(xt),start:$t,end:index}}function scanStringLiteral(){var xt="",$t,Ct,kt,Mt,Ft=!1;for($t=source[index],assert($t==="'"||$t==='"',"String literal must starts with a quote"),Ct=index,++index;index<length;)if(kt=source[index++],kt===$t){$t="";break}else if(kt==="\\")if(kt=source[index++],!kt||!isLineTerminator(kt.charCodeAt(0)))switch(kt){case"u":case"x":source[index]==="{"?(++index,xt+=scanUnicodeCodePointEscape()):xt+=scanHexEscape(kt);break;case"n":xt+=`
`;break;case"r":xt+="\r";break;case"t":xt+="	";break;case"b":xt+="\b";break;case"f":xt+="\f";break;case"v":xt+="\v";break;default:isOctalDigit(kt)?(Mt="01234567".indexOf(kt),Mt!==0&&(Ft=!0),index<length&&isOctalDigit(source[index])&&(Ft=!0,Mt=Mt*8+"01234567".indexOf(source[index++]),"0123".indexOf(kt)>=0&&index<length&&isOctalDigit(source[index])&&(Mt=Mt*8+"01234567".indexOf(source[index++]))),xt+=String.fromCharCode(Mt)):xt+=kt;break}else kt==="\r"&&source[index]===`
`&&++index;else{if(isLineTerminator(kt.charCodeAt(0)))break;xt+=kt}return $t!==""&&throwError({},MessageUnexpectedToken,ILLEGAL$1),{type:TokenStringLiteral,value:xt,octal:Ft,start:Ct,end:index}}function testRegExp(xt,$t){let Ct=xt;$t.indexOf("u")>=0&&(Ct=Ct.replace(/\\u\{([0-9a-fA-F]+)\}/g,(kt,Mt)=>{if(parseInt(Mt,16)<=1114111)return"x";throwError({},MessageInvalidRegExp)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(Ct)}catch{throwError({},MessageInvalidRegExp)}try{return new RegExp(xt,$t)}catch{return null}}function scanRegExpBody(){var xt,$t,Ct,kt,Mt;for(xt=source[index],assert(xt==="/","Regular expression literal must start with a slash"),$t=source[index++],Ct=!1,kt=!1;index<length;)if(xt=source[index++],$t+=xt,xt==="\\")xt=source[index++],isLineTerminator(xt.charCodeAt(0))&&throwError({},MessageUnterminatedRegExp),$t+=xt;else if(isLineTerminator(xt.charCodeAt(0)))throwError({},MessageUnterminatedRegExp);else if(Ct)xt==="]"&&(Ct=!1);else if(xt==="/"){kt=!0;break}else xt==="["&&(Ct=!0);return kt||throwError({},MessageUnterminatedRegExp),Mt=$t.substr(1,$t.length-2),{value:Mt,literal:$t}}function scanRegExpFlags(){var xt,$t,Ct;for($t="",Ct="";index<length&&(xt=source[index],!!isIdentifierPart(xt.charCodeAt(0)));)++index,xt==="\\"&&index<length?throwError({},MessageUnexpectedToken,ILLEGAL$1):(Ct+=xt,$t+=xt);return Ct.search(/[^gimuy]/g)>=0&&throwError({},MessageInvalidRegExp,Ct),{value:Ct,literal:$t}}function scanRegExp(){var xt,$t,Ct,kt;return lookahead=null,skipComment(),xt=index,$t=scanRegExpBody(),Ct=scanRegExpFlags(),kt=testRegExp($t.value,Ct.value),{literal:$t.literal+Ct.literal,value:kt,regex:{pattern:$t.value,flags:Ct.value},start:xt,end:index}}function isIdentifierName(xt){return xt.type===TokenIdentifier||xt.type===TokenKeyword||xt.type===TokenBooleanLiteral||xt.type===TokenNullLiteral}function advance(){if(skipComment(),index>=length)return{type:TokenEOF,start:index,end:index};const xt=source.charCodeAt(index);return isIdentifierStart(xt)?scanIdentifier():xt===40||xt===41||xt===59?scanPunctuator():xt===39||xt===34?scanStringLiteral():xt===46?isDecimalDigit(source.charCodeAt(index+1))?scanNumericLiteral():scanPunctuator():isDecimalDigit(xt)?scanNumericLiteral():scanPunctuator()}function lex(){const xt=lookahead;return index=xt.end,lookahead=advance(),index=xt.end,xt}function peek(){const xt=index;lookahead=advance(),index=xt}function finishArrayExpression(xt){const $t=new ASTNode(SyntaxArrayExpression);return $t.elements=xt,$t}function finishBinaryExpression(xt,$t,Ct){const kt=new ASTNode(xt==="||"||xt==="&&"?SyntaxLogicalExpression:SyntaxBinaryExpression);return kt.operator=xt,kt.left=$t,kt.right=Ct,kt}function finishCallExpression(xt,$t){const Ct=new ASTNode(SyntaxCallExpression);return Ct.callee=xt,Ct.arguments=$t,Ct}function finishConditionalExpression(xt,$t,Ct){const kt=new ASTNode(SyntaxConditionalExpression);return kt.test=xt,kt.consequent=$t,kt.alternate=Ct,kt}function finishIdentifier(xt){const $t=new ASTNode(SyntaxIdentifier);return $t.name=xt,$t}function finishLiteral(xt){const $t=new ASTNode(SyntaxLiteral);return $t.value=xt.value,$t.raw=source.slice(xt.start,xt.end),xt.regex&&($t.raw==="//"&&($t.raw="/(?:)/"),$t.regex=xt.regex),$t}function finishMemberExpression(xt,$t,Ct){const kt=new ASTNode(SyntaxMemberExpression);return kt.computed=xt==="[",kt.object=$t,kt.property=Ct,kt.computed||(Ct.member=!0),kt}function finishObjectExpression(xt){const $t=new ASTNode(SyntaxObjectExpression);return $t.properties=xt,$t}function finishProperty(xt,$t,Ct){const kt=new ASTNode(SyntaxProperty);return kt.key=$t,kt.value=Ct,kt.kind=xt,kt}function finishUnaryExpression(xt,$t){const Ct=new ASTNode(SyntaxUnaryExpression);return Ct.operator=xt,Ct.argument=$t,Ct.prefix=!0,Ct}function throwError(xt,$t){var Ct,kt=Array.prototype.slice.call(arguments,2),Mt=$t.replace(/%(\d)/g,(Ft,jt)=>(assert(jt<kt.length,"Message reference must be in range"),kt[jt]));throw Ct=new Error(Mt),Ct.index=index,Ct.description=Mt,Ct}function throwUnexpected(xt){xt.type===TokenEOF&&throwError(xt,MessageUnexpectedEOS),xt.type===TokenNumericLiteral&&throwError(xt,MessageUnexpectedNumber),xt.type===TokenStringLiteral&&throwError(xt,MessageUnexpectedString),xt.type===TokenIdentifier&&throwError(xt,MessageUnexpectedIdentifier),xt.type===TokenKeyword&&throwError(xt,MessageUnexpectedReserved),throwError(xt,MessageUnexpectedToken,xt.value)}function expect(xt){const $t=lex();($t.type!==TokenPunctuator||$t.value!==xt)&&throwUnexpected($t)}function match(xt){return lookahead.type===TokenPunctuator&&lookahead.value===xt}function matchKeyword(xt){return lookahead.type===TokenKeyword&&lookahead.value===xt}function parseArrayInitialiser(){const xt=[];for(index=lookahead.start,expect("[");!match("]");)match(",")?(lex(),xt.push(null)):(xt.push(parseConditionalExpression()),match("]")||expect(","));return lex(),finishArrayExpression(xt)}function parseObjectPropertyKey(){index=lookahead.start;const xt=lex();return xt.type===TokenStringLiteral||xt.type===TokenNumericLiteral?(xt.octal&&throwError(xt,MessageStrictOctalLiteral),finishLiteral(xt)):finishIdentifier(xt.value)}function parseObjectProperty(){var xt,$t,Ct,kt;if(index=lookahead.start,xt=lookahead,xt.type===TokenIdentifier)return Ct=parseObjectPropertyKey(),expect(":"),kt=parseConditionalExpression(),finishProperty("init",Ct,kt);if(xt.type===TokenEOF||xt.type===TokenPunctuator)throwUnexpected(xt);else return $t=parseObjectPropertyKey(),expect(":"),kt=parseConditionalExpression(),finishProperty("init",$t,kt)}function parseObjectInitialiser(){var xt=[],$t,Ct,kt,Mt={},Ft=String;for(index=lookahead.start,expect("{");!match("}");)$t=parseObjectProperty(),$t.key.type===SyntaxIdentifier?Ct=$t.key.name:Ct=Ft($t.key.value),kt="$"+Ct,Object.prototype.hasOwnProperty.call(Mt,kt)?throwError({},MessageStrictDuplicateProperty):Mt[kt]=!0,xt.push($t),match("}")||expect(",");return expect("}"),finishObjectExpression(xt)}function parseGroupExpression(){expect("(");const xt=parseExpression$1();return expect(")"),xt}const legalKeywords={if:1};function parsePrimaryExpression(){var xt,$t,Ct;if(match("("))return parseGroupExpression();if(match("["))return parseArrayInitialiser();if(match("{"))return parseObjectInitialiser();if(xt=lookahead.type,index=lookahead.start,xt===TokenIdentifier||legalKeywords[lookahead.value])Ct=finishIdentifier(lex().value);else if(xt===TokenStringLiteral||xt===TokenNumericLiteral)lookahead.octal&&throwError(lookahead,MessageStrictOctalLiteral),Ct=finishLiteral(lex());else{if(xt===TokenKeyword)throw new Error(DISABLED);xt===TokenBooleanLiteral?($t=lex(),$t.value=$t.value==="true",Ct=finishLiteral($t)):xt===TokenNullLiteral?($t=lex(),$t.value=null,Ct=finishLiteral($t)):match("/")||match("/=")?(Ct=finishLiteral(scanRegExp()),peek()):throwUnexpected(lex())}return Ct}function parseArguments(){const xt=[];if(expect("("),!match(")"))for(;index<length&&(xt.push(parseConditionalExpression()),!match(")"));)expect(",");return expect(")"),xt}function parseNonComputedProperty(){index=lookahead.start;const xt=lex();return isIdentifierName(xt)||throwUnexpected(xt),finishIdentifier(xt.value)}function parseNonComputedMember(){return expect("."),parseNonComputedProperty()}function parseComputedMember(){expect("[");const xt=parseExpression$1();return expect("]"),xt}function parseLeftHandSideExpressionAllowCall(){var xt,$t,Ct;for(xt=parsePrimaryExpression();;)if(match("."))Ct=parseNonComputedMember(),xt=finishMemberExpression(".",xt,Ct);else if(match("("))$t=parseArguments(),xt=finishCallExpression(xt,$t);else if(match("["))Ct=parseComputedMember(),xt=finishMemberExpression("[",xt,Ct);else break;return xt}function parsePostfixExpression(){const xt=parseLeftHandSideExpressionAllowCall();if(lookahead.type===TokenPunctuator&&(match("++")||match("--")))throw new Error(DISABLED);return xt}function parseUnaryExpression(){var xt,$t;if(lookahead.type!==TokenPunctuator&&lookahead.type!==TokenKeyword)$t=parsePostfixExpression();else{if(match("++")||match("--"))throw new Error(DISABLED);if(match("+")||match("-")||match("~")||match("!"))xt=lex(),$t=parseUnaryExpression(),$t=finishUnaryExpression(xt.value,$t);else{if(matchKeyword("delete")||matchKeyword("void")||matchKeyword("typeof"))throw new Error(DISABLED);$t=parsePostfixExpression()}}return $t}function binaryPrecedence(xt){let $t=0;if(xt.type!==TokenPunctuator&&xt.type!==TokenKeyword)return 0;switch(xt.value){case"||":$t=1;break;case"&&":$t=2;break;case"|":$t=3;break;case"^":$t=4;break;case"&":$t=5;break;case"==":case"!=":case"===":case"!==":$t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":$t=7;break;case"<<":case">>":case">>>":$t=8;break;case"+":case"-":$t=9;break;case"*":case"/":case"%":$t=11;break}return $t}function parseBinaryExpression(){var xt,$t,Ct,kt,Mt,Ft,jt,Bt,Vt,zt;if(xt=lookahead,Vt=parseUnaryExpression(),kt=lookahead,Mt=binaryPrecedence(kt),Mt===0)return Vt;for(kt.prec=Mt,lex(),$t=[xt,lookahead],jt=parseUnaryExpression(),Ft=[Vt,kt,jt];(Mt=binaryPrecedence(lookahead))>0;){for(;Ft.length>2&&Mt<=Ft[Ft.length-2].prec;)jt=Ft.pop(),Bt=Ft.pop().value,Vt=Ft.pop(),$t.pop(),Ct=finishBinaryExpression(Bt,Vt,jt),Ft.push(Ct);kt=lex(),kt.prec=Mt,Ft.push(kt),$t.push(lookahead),Ct=parseUnaryExpression(),Ft.push(Ct)}for(zt=Ft.length-1,Ct=Ft[zt],$t.pop();zt>1;)$t.pop(),Ct=finishBinaryExpression(Ft[zt-1].value,Ft[zt-2],Ct),zt-=2;return Ct}function parseConditionalExpression(){var xt,$t,Ct;return xt=parseBinaryExpression(),match("?")&&(lex(),$t=parseConditionalExpression(),expect(":"),Ct=parseConditionalExpression(),xt=finishConditionalExpression(xt,$t,Ct)),xt}function parseExpression$1(){const xt=parseConditionalExpression();if(match(","))throw new Error(DISABLED);return xt}function parser$1(xt){source=xt,index=0,length=source.length,lookahead=null,peek();const $t=parseExpression$1();if(lookahead.type!==TokenEOF)throw new Error("Unexpect token after expression.");return $t}var Constants$1={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Functions$1(xt){function $t(jt,Bt,Vt,zt){let Ht=xt(Bt[0]);return Vt&&(Ht=Vt+"("+Ht+")",Vt.lastIndexOf("new ",0)===0&&(Ht="("+Ht+")")),Ht+"."+jt+(zt<0?"":zt===0?"()":"("+Bt.slice(1).map(xt).join(",")+")")}function Ct(jt,Bt,Vt){return zt=>$t(jt,zt,Bt,Vt)}const kt="new Date",Mt="String",Ft="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(jt){jt.length<3&&error("Missing arguments to clamp function."),jt.length>3&&error("Too many arguments to clamp function.");const Bt=jt.map(xt);return"Math.max("+Bt[1]+", Math.min("+Bt[2]+","+Bt[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:kt,date:Ct("getDate",kt,0),day:Ct("getDay",kt,0),year:Ct("getFullYear",kt,0),month:Ct("getMonth",kt,0),hours:Ct("getHours",kt,0),minutes:Ct("getMinutes",kt,0),seconds:Ct("getSeconds",kt,0),milliseconds:Ct("getMilliseconds",kt,0),time:Ct("getTime",kt,0),timezoneoffset:Ct("getTimezoneOffset",kt,0),utcdate:Ct("getUTCDate",kt,0),utcday:Ct("getUTCDay",kt,0),utcyear:Ct("getUTCFullYear",kt,0),utcmonth:Ct("getUTCMonth",kt,0),utchours:Ct("getUTCHours",kt,0),utcminutes:Ct("getUTCMinutes",kt,0),utcseconds:Ct("getUTCSeconds",kt,0),utcmilliseconds:Ct("getUTCMilliseconds",kt,0),length:Ct("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:Ct("toUpperCase",Mt,0),lower:Ct("toLowerCase",Mt,0),substring:Ct("substring",Mt),split:Ct("split",Mt),trim:Ct("trim",Mt,0),regexp:Ft,test:Ct("test",Ft),if:function(jt){jt.length<3&&error("Missing arguments to if function."),jt.length>3&&error("Too many arguments to if function.");const Bt=jt.map(xt);return"("+Bt[0]+"?"+Bt[1]+":"+Bt[2]+")"}}}function stripQuotes(xt){const $t=xt&&xt.length-1;return $t&&(xt[0]==='"'&&xt[$t]==='"'||xt[0]==="'"&&xt[$t]==="'")?xt.slice(1,-1):xt}function codegen(xt){xt=xt||{};const $t=xt.allowed?toSet(xt.allowed):{},Ct=xt.forbidden?toSet(xt.forbidden):{},kt=xt.constants||Constants$1,Mt=(xt.functions||Functions$1)(Gt),Ft=xt.globalvar,jt=xt.fieldvar,Bt=isFunction$1(Ft)?Ft:Yt=>`${Ft}["${Yt}"]`;let Vt={},zt={},Ht=0;function Gt(Yt){if(isString(Yt))return Yt;const Kt=qt[Yt.type];return Kt==null&&error("Unsupported type: "+Yt.type),Kt(Yt)}const qt={Literal:Yt=>Yt.raw,Identifier:Yt=>{const Kt=Yt.name;return Ht>0?Kt:has$1(Ct,Kt)?error("Illegal identifier: "+Kt):has$1(kt,Kt)?kt[Kt]:has$1($t,Kt)?Kt:(Vt[Kt]=1,Bt(Kt))},MemberExpression:Yt=>{const Kt=!Yt.computed,Xt=Gt(Yt.object);Kt&&(Ht+=1);const Qt=Gt(Yt.property);return Xt===jt&&(zt[stripQuotes(Qt)]=1),Kt&&(Ht-=1),Xt+(Kt?"."+Qt:"["+Qt+"]")},CallExpression:Yt=>{Yt.callee.type!=="Identifier"&&error("Illegal callee type: "+Yt.callee.type);const Kt=Yt.callee.name,Xt=Yt.arguments,Qt=has$1(Mt,Kt)&&Mt[Kt];return Qt||error("Unrecognized function: "+Kt),isFunction$1(Qt)?Qt(Xt):Qt+"("+Xt.map(Gt).join(",")+")"},ArrayExpression:Yt=>"["+Yt.elements.map(Gt).join(",")+"]",BinaryExpression:Yt=>"("+Gt(Yt.left)+" "+Yt.operator+" "+Gt(Yt.right)+")",UnaryExpression:Yt=>"("+Yt.operator+Gt(Yt.argument)+")",ConditionalExpression:Yt=>"("+Gt(Yt.test)+"?"+Gt(Yt.consequent)+":"+Gt(Yt.alternate)+")",LogicalExpression:Yt=>"("+Gt(Yt.left)+Yt.operator+Gt(Yt.right)+")",ObjectExpression:Yt=>"{"+Yt.properties.map(Gt).join(",")+"}",Property:Yt=>{Ht+=1;const Kt=Gt(Yt.key);return Ht-=1,Kt+":"+Gt(Yt.value)}};function Wt(Yt){const Kt={code:Gt(Yt),globals:Object.keys(Vt),fields:Object.keys(zt)};return Vt={},zt={},Kt}return Wt.functions=Mt,Wt.constants=kt,Wt}const SELECTION_GETTER=Symbol("vega_selection_getter");function getter(xt){return(!xt.getter||!xt.getter[SELECTION_GETTER])&&(xt.getter=field$1(xt.field),xt.getter[SELECTION_GETTER]=!0),xt.getter}const Intersect="intersect",Union="union",VlMulti="vlMulti",VlPoint="vlPoint",Or="or",And="and",SelectionId="_vgsid_",$selectionId=field$1(SelectionId),TYPE_ENUM="E",TYPE_RANGE_INC="R",TYPE_RANGE_EXC="R-E",TYPE_RANGE_LE="R-LE",TYPE_RANGE_RE="R-RE",UNIT_INDEX="index:unit";function testPoint(xt,$t){for(var Ct=$t.fields,kt=$t.values,Mt=Ct.length,Ft=0,jt,Bt;Ft<Mt;++Ft)if(Bt=Ct[Ft],jt=getter(Bt)(xt),isDate$1(jt)&&(jt=toNumber(jt)),isDate$1(kt[Ft])&&(kt[Ft]=toNumber(kt[Ft])),isArray(kt[Ft])&&isDate$1(kt[Ft][0])&&(kt[Ft]=kt[Ft].map(toNumber)),Bt.type===TYPE_ENUM){if(isArray(kt[Ft])?kt[Ft].indexOf(jt)<0:jt!==kt[Ft])return!1}else if(Bt.type===TYPE_RANGE_INC){if(!inrange(jt,kt[Ft]))return!1}else if(Bt.type===TYPE_RANGE_RE){if(!inrange(jt,kt[Ft],!0,!1))return!1}else if(Bt.type===TYPE_RANGE_EXC){if(!inrange(jt,kt[Ft],!1,!1))return!1}else if(Bt.type===TYPE_RANGE_LE&&!inrange(jt,kt[Ft],!1,!0))return!1;return!0}function selectionTest(xt,$t,Ct){for(var kt=this.context.data[xt],Mt=kt?kt.values.value:[],Ft=kt?kt[UNIT_INDEX]&&kt[UNIT_INDEX].value:void 0,jt=Ct===Intersect,Bt=Mt.length,Vt=0,zt,Ht,Gt,qt,Wt;Vt<Bt;++Vt)if(zt=Mt[Vt],Ft&&jt){if(Ht=Ht||{},Gt=Ht[qt=zt.unit]||0,Gt===-1)continue;if(Wt=testPoint($t,zt),Ht[qt]=Wt?-1:++Gt,Wt&&Ft.size===1)return!0;if(!Wt&&Gt===Ft.get(qt).count)return!1}else if(Wt=testPoint($t,zt),jt^Wt)return Wt;return Bt&&jt}const bisect=bisector$1($selectionId),bisectLeft=bisect.left,bisectRight=bisect.right;function selectionIdTest(xt,$t,Ct){const kt=this.context.data[xt],Mt=kt?kt.values.value:[],Ft=kt?kt[UNIT_INDEX]&&kt[UNIT_INDEX].value:void 0,jt=Ct===Intersect,Bt=$selectionId($t),Vt=bisectLeft(Mt,Bt);if(Vt===Mt.length||$selectionId(Mt[Vt])!==Bt)return!1;if(Ft&&jt){if(Ft.size===1)return!0;if(bisectRight(Mt,Bt)-Vt<Ft.size)return!1}return!0}function selectionTuples(xt,$t){return xt.map(Ct=>extend($t.fields?{values:$t.fields.map(kt=>getter(kt)(Ct.datum))}:{[SelectionId]:$selectionId(Ct.datum)},$t))}function selectionResolve(xt,$t,Ct,kt){for(var Mt=this.context.data[xt],Ft=Mt?Mt.values.value:[],jt={},Bt={},Vt={},zt,Ht,Gt,qt,Wt,Yt,Kt,Xt,Qt,Jt,Zt=Ft.length,sn=0,ln,dn;sn<Zt;++sn)if(zt=Ft[sn],qt=zt.unit,Ht=zt.fields,Gt=zt.values,Ht&&Gt){for(ln=0,dn=Ht.length;ln<dn;++ln)Wt=Ht[ln],Kt=jt[Wt.field]||(jt[Wt.field]={}),Xt=Kt[qt]||(Kt[qt]=[]),Vt[Wt.field]=Qt=Wt.type.charAt(0),Jt=ops[`${Qt}_union`],Kt[qt]=Jt(Xt,array$2(Gt[ln]));Ct&&(Xt=Bt[qt]||(Bt[qt]=[]),Xt.push(array$2(Gt).reduce((hn,cn,pn)=>(hn[Ht[pn].field]=cn,hn),{})))}else Wt=SelectionId,Yt=$selectionId(zt),Kt=jt[Wt]||(jt[Wt]={}),Xt=Kt[qt]||(Kt[qt]=[]),Xt.push(Yt),Ct&&(Xt=Bt[qt]||(Bt[qt]=[]),Xt.push({[SelectionId]:Yt}));if($t=$t||Union,jt[SelectionId]?jt[SelectionId]=ops[`${SelectionId}_${$t}`](...Object.values(jt[SelectionId])):Object.keys(jt).forEach(hn=>{jt[hn]=Object.keys(jt[hn]).map(cn=>jt[hn][cn]).reduce((cn,pn)=>cn===void 0?pn:ops[`${Vt[hn]}_${$t}`](cn,pn))}),Ft=Object.keys(Bt),Ct&&Ft.length){const hn=kt?VlPoint:VlMulti;jt[hn]=$t===Union?{[Or]:Ft.reduce((cn,pn)=>(cn.push(...Bt[pn]),cn),[])}:{[And]:Ft.map(cn=>({[Or]:Bt[cn]}))}}return jt}var ops={[`${SelectionId}_union`]:union,[`${SelectionId}_intersect`]:intersection,E_union:function(xt,$t){if(!xt.length)return $t;for(var Ct=0,kt=$t.length;Ct<kt;++Ct)xt.indexOf($t[Ct])<0&&xt.push($t[Ct]);return xt},E_intersect:function(xt,$t){return xt.length?xt.filter(Ct=>$t.indexOf(Ct)>=0):$t},R_union:function(xt,$t){var Ct=toNumber($t[0]),kt=toNumber($t[1]);return Ct>kt&&(Ct=$t[1],kt=$t[0]),xt.length?(xt[0]>Ct&&(xt[0]=Ct),xt[1]<kt&&(xt[1]=kt),xt):[Ct,kt]},R_intersect:function(xt,$t){var Ct=toNumber($t[0]),kt=toNumber($t[1]);return Ct>kt&&(Ct=$t[1],kt=$t[0]),xt.length?kt<xt[0]||xt[1]<Ct?[]:(xt[0]<Ct&&(xt[0]=Ct),xt[1]>kt&&(xt[1]=kt),xt):[Ct,kt]}};const DataPrefix$1=":",IndexPrefix$1="@";function selectionVisitor(xt,$t,Ct,kt){$t[0].type!==Literal&&error("First argument to selection functions must be a string literal.");const Mt=$t[0].value,Ft=$t.length>=2&&peek$1($t).value,jt="unit",Bt=IndexPrefix$1+jt,Vt=DataPrefix$1+Mt;Ft===Intersect&&!has$1(kt,Bt)&&(kt[Bt]=Ct.getData(Mt).indataRef(Ct,jt)),has$1(kt,Vt)||(kt[Vt]=Ct.getData(Mt).tuplesRef())}function data$1(xt){const $t=this.context.data[xt];return $t?$t.values.value:[]}function indata(xt,$t,Ct){const kt=this.context.data[xt]["index:"+$t],Mt=kt?kt.value.get(Ct):void 0;return Mt&&Mt.count}function setdata(xt,$t){const Ct=this.context.dataflow,kt=this.context.data[xt],Mt=kt.input;return Ct.pulse(Mt,Ct.changeset().remove(truthy).insert($t)),1}function encode(xt,$t,Ct){if(xt){const kt=this.context.dataflow,Mt=xt.mark.source;kt.pulse(Mt,kt.changeset().encode(xt,$t))}return Ct!==void 0?Ct:xt}const wrap=xt=>function($t,Ct){return this.context.dataflow.locale()[xt](Ct)($t)},format=wrap("format"),timeFormat$1=wrap("timeFormat"),utcFormat=wrap("utcFormat"),timeParse=wrap("timeParse"),utcParse=wrap("utcParse"),dateObj=new Date(2e3,0,1);function time(xt,$t,Ct){return!Number.isInteger(xt)||!Number.isInteger($t)?"":(dateObj.setYear(2e3),dateObj.setMonth(xt),dateObj.setDate($t),timeFormat$1.call(this,dateObj,Ct))}function monthFormat(xt){return time.call(this,xt,1,"%B")}function monthAbbrevFormat(xt){return time.call(this,xt,1,"%b")}function dayFormat(xt){return time.call(this,0,2+xt,"%A")}function dayAbbrevFormat(xt){return time.call(this,0,2+xt,"%a")}const DataPrefix=":",IndexPrefix="@",ScalePrefix="%",SignalPrefix="$";function dataVisitor(xt,$t,Ct,kt){$t[0].type!==Literal&&error("First argument to data functions must be a string literal.");const Mt=$t[0].value,Ft=DataPrefix+Mt;if(!has$1(Ft,kt))try{kt[Ft]=Ct.getData(Mt).tuplesRef()}catch{}}function indataVisitor(xt,$t,Ct,kt){$t[0].type!==Literal&&error("First argument to indata must be a string literal."),$t[1].type!==Literal&&error("Second argument to indata must be a string literal.");const Mt=$t[0].value,Ft=$t[1].value,jt=IndexPrefix+Ft;has$1(jt,kt)||(kt[jt]=Ct.getData(Mt).indataRef(Ct,Ft))}function scaleVisitor(xt,$t,Ct,kt){if($t[0].type===Literal)addScaleDependency(Ct,kt,$t[0].value);else for(xt in Ct.scales)addScaleDependency(Ct,kt,xt)}function addScaleDependency(xt,$t,Ct){const kt=ScalePrefix+Ct;if(!has$1($t,kt))try{$t[kt]=xt.scaleRef(Ct)}catch{}}function getScale(xt,$t){if(isFunction$1(xt))return xt;if(isString(xt)){const Ct=$t.scales[xt];return Ct&&isRegisteredScale(Ct.value)?Ct.value:void 0}}function internalScaleFunctions(xt,$t,Ct){$t.__bandwidth=Mt=>Mt&&Mt.bandwidth?Mt.bandwidth():0,Ct._bandwidth=scaleVisitor,Ct._range=scaleVisitor,Ct._scale=scaleVisitor;const kt=Mt=>"_["+(Mt.type===Literal?$(ScalePrefix+Mt.value):$(ScalePrefix)+"+"+xt(Mt))+"]";return{_bandwidth:Mt=>`this.__bandwidth(${kt(Mt[0])})`,_range:Mt=>`${kt(Mt[0])}.range()`,_scale:Mt=>`${kt(Mt[0])}(${xt(Mt[1])})`}}function geoMethod(xt,$t){return function(Ct,kt,Mt){if(Ct){const Ft=getScale(Ct,(Mt||this).context);return Ft&&Ft.path[xt](kt)}else return $t(kt)}}const geoArea=geoMethod("area",geoArea$1),geoBounds=geoMethod("bounds",geoBounds$1),geoCentroid=geoMethod("centroid",geoCentroid$1);function geoScale(xt,$t){const Ct=getScale(xt,($t||this).context);return Ct&&Ct.scale()}function inScope(xt){const $t=this.context.group;let Ct=!1;if($t)for(;xt;){if(xt===$t){Ct=!0;break}xt=xt.mark.group}return Ct}function log(xt,$t,Ct){try{xt[$t].apply(xt,["EXPRESSION"].concat([].slice.call(Ct)))}catch(kt){xt.warn(kt)}return Ct[Ct.length-1]}function warn$1(){return log(this.context.dataflow,"warn",arguments)}function info(){return log(this.context.dataflow,"info",arguments)}function debug$3(){return log(this.context.dataflow,"debug",arguments)}function channel_luminance_value(xt){const $t=xt/255;return $t<=.03928?$t/12.92:Math.pow(($t+.055)/1.055,2.4)}function luminance(xt){const $t=rgb(xt),Ct=channel_luminance_value($t.r),kt=channel_luminance_value($t.g),Mt=channel_luminance_value($t.b);return .2126*Ct+.7152*kt+.0722*Mt}function contrast(xt,$t){const Ct=luminance(xt),kt=luminance($t),Mt=Math.max(Ct,kt),Ft=Math.min(Ct,kt);return(Mt+.05)/(Ft+.05)}function merge(){const xt=[].slice.call(arguments);return xt.unshift({}),extend(...xt)}function equal(xt,$t){return xt===$t||xt!==xt&&$t!==$t?!0:isArray(xt)?isArray($t)&&xt.length===$t.length?equalArray(xt,$t):!1:isObject(xt)&&isObject($t)?equalObject(xt,$t):!1}function equalArray(xt,$t){for(let Ct=0,kt=xt.length;Ct<kt;++Ct)if(!equal(xt[Ct],$t[Ct]))return!1;return!0}function equalObject(xt,$t){for(const Ct in xt)if(!equal(xt[Ct],$t[Ct]))return!1;return!0}function removePredicate(xt){return $t=>equalObject(xt,$t)}function modify(xt,$t,Ct,kt,Mt,Ft){const jt=this.context.dataflow,Bt=this.context.data[xt],Vt=Bt.input,zt=jt.stamp();let Ht=Bt.changes,Gt,qt;if(jt._trigger===!1||!(Vt.value.length||$t||kt))return 0;if((!Ht||Ht.stamp<zt)&&(Bt.changes=Ht=jt.changeset(),Ht.stamp=zt,jt.runAfter(()=>{Bt.modified=!0,jt.pulse(Vt,Ht).run()},!0,1)),Ct&&(Gt=Ct===!0?truthy:isArray(Ct)||isTuple(Ct)?Ct:removePredicate(Ct),Ht.remove(Gt)),$t&&Ht.insert($t),kt&&(Gt=removePredicate(kt),Vt.value.some(Gt)?Ht.remove(Gt):Ht.insert(kt)),Mt)for(qt in Ft)Ht.modify(Mt,qt,Ft[qt]);return 1}function pinchDistance(xt){const $t=xt.touches,Ct=$t[0].clientX-$t[1].clientX,kt=$t[0].clientY-$t[1].clientY;return Math.hypot(Ct,kt)}function pinchAngle(xt){const $t=xt.touches;return Math.atan2($t[0].clientY-$t[1].clientY,$t[0].clientX-$t[1].clientX)}const accessors={};function pluck(xt,$t){const Ct=accessors[$t]||(accessors[$t]=field$1($t));return isArray(xt)?xt.map(Ct):Ct(xt)}function array(xt){return isArray(xt)||ArrayBuffer.isView(xt)?xt:null}function sequence(xt){return array(xt)||(isString(xt)?xt:null)}function join(xt){for(var $t=arguments.length,Ct=new Array($t>1?$t-1:0),kt=1;kt<$t;kt++)Ct[kt-1]=arguments[kt];return array(xt).join(...Ct)}function indexof(xt){for(var $t=arguments.length,Ct=new Array($t>1?$t-1:0),kt=1;kt<$t;kt++)Ct[kt-1]=arguments[kt];return sequence(xt).indexOf(...Ct)}function lastindexof(xt){for(var $t=arguments.length,Ct=new Array($t>1?$t-1:0),kt=1;kt<$t;kt++)Ct[kt-1]=arguments[kt];return sequence(xt).lastIndexOf(...Ct)}function slice$1(xt){for(var $t=arguments.length,Ct=new Array($t>1?$t-1:0),kt=1;kt<$t;kt++)Ct[kt-1]=arguments[kt];return sequence(xt).slice(...Ct)}function replace(xt,$t,Ct){return isFunction$1(Ct)&&error("Function argument passed to replace."),String(xt).replace($t,Ct)}function reverse$1(xt){return array(xt).slice().reverse()}function bandspace(xt,$t,Ct){return bandSpace(xt||0,$t||0,Ct||0)}function bandwidth(xt,$t){const Ct=getScale(xt,($t||this).context);return Ct&&Ct.bandwidth?Ct.bandwidth():0}function copy(xt,$t){const Ct=getScale(xt,($t||this).context);return Ct?Ct.copy():void 0}function domain$2(xt,$t){const Ct=getScale(xt,($t||this).context);return Ct?Ct.domain():[]}function invert(xt,$t,Ct){const kt=getScale(xt,(Ct||this).context);return kt?isArray($t)?(kt.invertRange||kt.invert)($t):(kt.invert||kt.invertExtent)($t):void 0}function range$3(xt,$t){const Ct=getScale(xt,($t||this).context);return Ct&&Ct.range?Ct.range():[]}function scale$2(xt,$t,Ct){const kt=getScale(xt,(Ct||this).context);return kt?kt($t):void 0}function scaleGradient(xt,$t,Ct,kt,Mt){xt=getScale(xt,(Mt||this).context);const Ft=Gradient$1($t,Ct);let jt=xt.domain(),Bt=jt[0],Vt=peek$1(jt),zt=identity$1;return Vt-Bt?zt=scaleFraction(xt,Bt,Vt):xt=(xt.interpolator?scale$4("sequential")().interpolator(xt.interpolator()):scale$4("linear")().interpolate(xt.interpolate()).range(xt.range())).domain([Bt=0,Vt=1]),xt.ticks&&(jt=xt.ticks(+kt||15),Bt!==jt[0]&&jt.unshift(Bt),Vt!==peek$1(jt)&&jt.push(Vt)),jt.forEach(Ht=>Ft.stop(zt(Ht),xt(Ht))),Ft}function geoShape(xt,$t,Ct){const kt=getScale(xt,(Ct||this).context);return function(Mt){return kt?kt.path.context(Mt)($t):""}}function pathShape(xt){let $t=null;return function(Ct){return Ct?pathRender(Ct,$t=$t||parse$3(xt)):xt}}const datum=xt=>xt.data;function treeNodes(xt,$t){const Ct=data$1.call($t,xt);return Ct.root&&Ct.root.lookup||{}}function treePath(xt,$t,Ct){const kt=treeNodes(xt,this),Mt=kt[$t],Ft=kt[Ct];return Mt&&Ft?Mt.path(Ft).map(datum):void 0}function treeAncestors(xt,$t){const Ct=treeNodes(xt,this)[$t];return Ct?Ct.ancestors().map(datum):void 0}const _window=()=>typeof window<"u"&&window||null;function screen(){const xt=_window();return xt?xt.screen:{}}function windowSize(){const xt=_window();return xt?[xt.innerWidth,xt.innerHeight]:[void 0,void 0]}function containerSize(){const xt=this.context.dataflow,$t=xt.container&&xt.container();return $t?[$t.clientWidth,$t.clientHeight]:[void 0,void 0]}function intersect(xt,$t,Ct){if(!xt)return[];const[kt,Mt]=xt,Ft=new Bounds().set(kt[0],kt[1],Mt[0],Mt[1]),jt=Ct||this.context.dataflow.scenegraph().root;return intersect$2(jt,Ft,filter($t))}function filter(xt){let $t=null;if(xt){const Ct=array$2(xt.marktype),kt=array$2(xt.markname);$t=Mt=>(!Ct.length||Ct.some(Ft=>Mt.marktype===Ft))&&(!kt.length||kt.some(Ft=>Mt.name===Ft))}return $t}function lassoAppend(xt,$t,Ct){let kt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;xt=array$2(xt);const Mt=xt[xt.length-1];return Mt===void 0||Math.hypot(Mt[0]-$t,Mt[1]-Ct)>kt?[...xt,[$t,Ct]]:xt}function lassoPath(xt){return array$2(xt).reduce(($t,Ct,kt)=>{let[Mt,Ft]=Ct;return $t+=kt==0?`M ${Mt},${Ft} `:kt===xt.length-1?" Z":`L ${Mt},${Ft} `},"")}function intersectLasso(xt,$t,Ct){const{x:kt,y:Mt,mark:Ft}=Ct,jt=new Bounds().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[Vt,zt]of $t)Vt<jt.x1&&(jt.x1=Vt),Vt>jt.x2&&(jt.x2=Vt),zt<jt.y1&&(jt.y1=zt),zt>jt.y2&&(jt.y2=zt);return jt.translate(kt,Mt),intersect([[jt.x1,jt.y1],[jt.x2,jt.y2]],xt,Ft).filter(Vt=>pointInPolygon(Vt.x,Vt.y,$t))}function pointInPolygon(xt,$t,Ct){let kt=0;for(let Mt=0,Ft=Ct.length-1;Mt<Ct.length;Ft=Mt++){const[jt,Bt]=Ct[Ft],[Vt,zt]=Ct[Mt];zt>$t!=Bt>$t&&xt<(jt-Vt)*($t-zt)/(Bt-zt)+Vt&&kt++}return kt&1}const functionContext={random(){return random()},cumulativeNormal,cumulativeLogNormal,cumulativeUniform,densityNormal,densityLogNormal,densityUniform,quantileNormal,quantileLogNormal,quantileUniform,sampleNormal,sampleLogNormal,sampleUniform,isArray,isBoolean:isBoolean$2,isDate:isDate$1,isDefined(xt){return xt!==void 0},isNumber:isNumber$1,isObject,isRegExp,isString,isTuple,isValid(xt){return xt!=null&&xt===xt},toBoolean,toDate(xt){return toDate(xt)},toNumber,toString,indexof,join,lastindexof,replace,reverse:reverse$1,slice:slice$1,flush,lerp,merge,pad,peek:peek$1,pluck,span,inrange,truncate:truncate$1,rgb,lab:lab$1,hcl:hcl$2,hsl:hsl$2,luminance,contrast,sequence:range$6,format,utcFormat,utcParse,utcOffset,utcSequence,timeFormat:timeFormat$1,timeParse,timeOffset,timeSequence,timeUnitSpecifier,monthFormat,monthAbbrevFormat,dayFormat,dayAbbrevFormat,quarter,utcquarter,week,utcweek,dayofyear,utcdayofyear,warn:warn$1,info,debug:debug$3,extent(xt){return extent(xt)},inScope,intersect,clampRange,pinchDistance,pinchAngle,screen,containerSize,windowSize,bandspace,setdata,pathShape,panLinear,panLog,panPow,panSymlog,zoomLinear,zoomLog,zoomPow,zoomSymlog,encode,modify,lassoAppend,lassoPath,intersectLasso},eventFunctions=["view","item","group","xy","x","y"],eventPrefix="event.vega.",thisPrefix="this.",astVisitors={},codegenParams={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:xt=>`_[${$(SignalPrefix+xt)}]`,functions:buildFunctions,constants:Constants$1,visitors:astVisitors},codeGenerator=codegen(codegenParams);function buildFunctions(xt){const $t=Functions$1(xt);eventFunctions.forEach(Ct=>$t[Ct]=eventPrefix+Ct);for(const Ct in functionContext)$t[Ct]=thisPrefix+Ct;return extend($t,internalScaleFunctions(xt,functionContext,astVisitors)),$t}function expressionFunction(xt,$t,Ct){return arguments.length===1?functionContext[xt]:(functionContext[xt]=$t,Ct&&(astVisitors[xt]=Ct),codeGenerator&&(codeGenerator.functions[xt]=thisPrefix+xt),this)}expressionFunction("bandwidth",bandwidth,scaleVisitor);expressionFunction("copy",copy,scaleVisitor);expressionFunction("domain",domain$2,scaleVisitor);expressionFunction("range",range$3,scaleVisitor);expressionFunction("invert",invert,scaleVisitor);expressionFunction("scale",scale$2,scaleVisitor);expressionFunction("gradient",scaleGradient,scaleVisitor);expressionFunction("geoArea",geoArea,scaleVisitor);expressionFunction("geoBounds",geoBounds,scaleVisitor);expressionFunction("geoCentroid",geoCentroid,scaleVisitor);expressionFunction("geoShape",geoShape,scaleVisitor);expressionFunction("geoScale",geoScale,scaleVisitor);expressionFunction("indata",indata,indataVisitor);expressionFunction("data",data$1,dataVisitor);expressionFunction("treePath",treePath,dataVisitor);expressionFunction("treeAncestors",treeAncestors,dataVisitor);expressionFunction("vlSelectionTest",selectionTest,selectionVisitor);expressionFunction("vlSelectionIdTest",selectionIdTest,selectionVisitor);expressionFunction("vlSelectionResolve",selectionResolve,selectionVisitor);expressionFunction("vlSelectionTuples",selectionTuples);function parser(xt,$t){const Ct={};let kt;try{xt=isString(xt)?xt:$(xt)+"",kt=parser$1(xt)}catch{error("Expression parse error: "+xt)}kt.visit(Ft=>{if(Ft.type!==CallExpression)return;const jt=Ft.callee.name,Bt=codegenParams.visitors[jt];Bt&&Bt(jt,Ft.arguments,$t,Ct)});const Mt=codeGenerator(kt);return Mt.globals.forEach(Ft=>{const jt=SignalPrefix+Ft;!has$1(Ct,jt)&&$t.getSignal(Ft)&&(Ct[jt]=$t.signalRef(Ft))}),{$expr:extend({code:Mt.code},$t.options.ast?{ast:kt}:null),$fields:Mt.fields,$params:Ct}}function parse$2(xt){const $t=this,Ct=xt.operators||[];return xt.background&&($t.background=xt.background),xt.eventConfig&&($t.eventConfig=xt.eventConfig),xt.locale&&($t.locale=xt.locale),Ct.forEach(kt=>$t.parseOperator(kt)),Ct.forEach(kt=>$t.parseOperatorParameters(kt)),(xt.streams||[]).forEach(kt=>$t.parseStream(kt)),(xt.updates||[]).forEach(kt=>$t.parseUpdate(kt)),$t.resolve()}const Skip$2=toSet(["rule"]),Swap=toSet(["group","image","rect"]);function adjustSpatial$1(xt,$t){let Ct="";return Skip$2[$t]||(xt.x2&&(xt.x?(Swap[$t]&&(Ct+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),Ct+="o.width=o.x2-o.x;"):Ct+="o.x=o.x2-(o.width||0);"),xt.xc&&(Ct+="o.x=o.xc-(o.width||0)/2;"),xt.y2&&(xt.y?(Swap[$t]&&(Ct+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),Ct+="o.height=o.y2-o.y;"):Ct+="o.y=o.y2-(o.height||0);"),xt.yc&&(Ct+="o.y=o.yc-(o.height||0)/2;")),Ct}function canonicalType(xt){return(xt+"").toLowerCase()}function isOperator(xt){return canonicalType(xt)==="operator"}function isCollect(xt){return canonicalType(xt)==="collect"}function expression$2(xt,$t,Ct){Ct.endsWith(";")||(Ct="return("+Ct+");");const kt=Function(...$t.concat(Ct));return xt&&xt.functions?kt.bind(xt.functions):kt}function _compare(xt,$t,Ct,kt){return`((u = ${xt}) < (v = ${$t}) || u == null) && v != null ? ${Ct}
  : (u > v || v == null) && u != null ? ${kt}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${Ct}
  : v !== v && u === u ? ${kt} : `}var expressionCodegen={operator:(xt,$t)=>expression$2(xt,["_"],$t.code),parameter:(xt,$t)=>expression$2(xt,["datum","_"],$t.code),event:(xt,$t)=>expression$2(xt,["event"],$t.code),handler:(xt,$t)=>{const Ct=`var datum=event.item&&event.item.datum;return ${$t.code};`;return expression$2(xt,["_","event"],Ct)},encode:(xt,$t)=>{const{marktype:Ct,channels:kt}=$t;let Mt="var o=item,datum=o.datum,m=0,$;";for(const Ft in kt){const jt="o["+$(Ft)+"]";Mt+=`$=${kt[Ft].code};if(${jt}!==$)${jt}=$,m=1;`}return Mt+=adjustSpatial$1(kt,Ct),Mt+="return m;",expression$2(xt,["item","_"],Mt)},codegen:{get(xt){const $t=`[${xt.map($).join("][")}]`,Ct=Function("_",`return _${$t};`);return Ct.path=$t,Ct},comparator(xt,$t){let Ct;const kt=(Ft,jt)=>{const Bt=$t[jt];let Vt,zt;return Ft.path?(Vt=`a${Ft.path}`,zt=`b${Ft.path}`):((Ct=Ct||{})["f"+jt]=Ft,Vt=`this.f${jt}(a)`,zt=`this.f${jt}(b)`),_compare(Vt,zt,-Bt,Bt)},Mt=Function("a","b","var u, v; return "+xt.map(kt).join("")+"0;");return Ct?Mt.bind(Ct):Mt}}};function parseOperator(xt){const $t=this;isOperator(xt.type)||!xt.type?$t.operator(xt,xt.update?$t.operatorExpression(xt.update):null):$t.transform(xt,xt.type)}function parseOperatorParameters(xt){const $t=this;if(xt.params){const Ct=$t.get(xt.id);Ct||error("Invalid operator id: "+xt.id),$t.dataflow.connect(Ct,Ct.parameters($t.parseParameters(xt.params),xt.react,xt.initonly))}}function parseParameters$1(xt,$t){$t=$t||{};const Ct=this;for(const kt in xt){const Mt=xt[kt];$t[kt]=isArray(Mt)?Mt.map(Ft=>parseParameter$2(Ft,Ct,$t)):parseParameter$2(Mt,Ct,$t)}return $t}function parseParameter$2(xt,$t,Ct){if(!xt||!isObject(xt))return xt;for(let kt=0,Mt=PARSERS.length,Ft;kt<Mt;++kt)if(Ft=PARSERS[kt],has$1(xt,Ft.key))return Ft.parse(xt,$t,Ct);return xt}var PARSERS=[{key:"$ref",parse:getOperator},{key:"$key",parse:getKey},{key:"$expr",parse:getExpression},{key:"$field",parse:getField},{key:"$encode",parse:getEncode},{key:"$compare",parse:getCompare},{key:"$context",parse:getContext},{key:"$subflow",parse:getSubflow},{key:"$tupleid",parse:getTupleId}];function getOperator(xt,$t){return $t.get(xt.$ref)||error("Operator not defined: "+xt.$ref)}function getExpression(xt,$t,Ct){xt.$params&&$t.parseParameters(xt.$params,Ct);const kt="e:"+xt.$expr.code;return $t.fn[kt]||($t.fn[kt]=accessor($t.parameterExpression(xt.$expr),xt.$fields))}function getKey(xt,$t){const Ct="k:"+xt.$key+"_"+!!xt.$flat;return $t.fn[Ct]||($t.fn[Ct]=key(xt.$key,xt.$flat,$t.expr.codegen))}function getField(xt,$t){if(!xt.$field)return null;const Ct="f:"+xt.$field+"_"+xt.$name;return $t.fn[Ct]||($t.fn[Ct]=field$1(xt.$field,xt.$name,$t.expr.codegen))}function getCompare(xt,$t){const Ct="c:"+xt.$compare+"_"+xt.$order,kt=array$2(xt.$compare).map(Mt=>Mt&&Mt.$tupleid?tupleid:Mt);return $t.fn[Ct]||($t.fn[Ct]=compare$8(kt,xt.$order,$t.expr.codegen))}function getEncode(xt,$t){const Ct=xt.$encode,kt={};for(const Mt in Ct){const Ft=Ct[Mt];kt[Mt]=accessor($t.encodeExpression(Ft.$expr),Ft.$fields),kt[Mt].output=Ft.$output}return kt}function getContext(xt,$t){return $t}function getSubflow(xt,$t){const Ct=xt.$subflow;return function(kt,Mt,Ft){const jt=$t.fork().parse(Ct),Bt=jt.get(Ct.operators[0].id),Vt=jt.signals.parent;return Vt&&Vt.set(Ft),Bt.detachSubflow=()=>$t.detach(jt),Bt}}function getTupleId(){return tupleid}function parseStream$2(xt){var $t=this,Ct=xt.filter!=null?$t.eventExpression(xt.filter):void 0,kt=xt.stream!=null?$t.get(xt.stream):void 0,Mt;xt.source?kt=$t.events(xt.source,xt.type,Ct):xt.merge&&(Mt=xt.merge.map(Ft=>$t.get(Ft)),kt=Mt[0].merge.apply(Mt[0],Mt.slice(1))),xt.between&&(Mt=xt.between.map(Ft=>$t.get(Ft)),kt=kt.between(Mt[0],Mt[1])),xt.filter&&(kt=kt.filter(Ct)),xt.throttle!=null&&(kt=kt.throttle(+xt.throttle)),xt.debounce!=null&&(kt=kt.debounce(+xt.debounce)),kt==null&&error("Invalid stream definition: "+JSON.stringify(xt)),xt.consume&&kt.consume(!0),$t.stream(xt,kt)}function parseUpdate$1(xt){var $t=this,Ct=isObject(Ct=xt.source)?Ct.$ref:Ct,kt=$t.get(Ct),Mt=null,Ft=xt.update,jt=void 0;kt||error("Source not defined: "+xt.source),Mt=xt.target&&xt.target.$expr?$t.eventExpression(xt.target.$expr):$t.get(xt.target),Ft&&Ft.$expr&&(Ft.$params&&(jt=$t.parseParameters(Ft.$params)),Ft=$t.handlerExpression(Ft.$expr)),$t.update(xt,kt,Mt,Ft,jt)}const SKIP={skip:!0};function getState$1(xt){var $t=this,Ct={};if(xt.signals){var kt=Ct.signals={};Object.keys($t.signals).forEach(Ft=>{const jt=$t.signals[Ft];xt.signals(Ft,jt)&&(kt[Ft]=jt.value)})}if(xt.data){var Mt=Ct.data={};Object.keys($t.data).forEach(Ft=>{const jt=$t.data[Ft];xt.data(Ft,jt)&&(Mt[Ft]=jt.input.value)})}return $t.subcontext&&xt.recurse!==!1&&(Ct.subcontext=$t.subcontext.map(Ft=>Ft.getState(xt))),Ct}function setState$1(xt){var $t=this,Ct=$t.dataflow,kt=xt.data,Mt=xt.signals;Object.keys(Mt||{}).forEach(Ft=>{Ct.update($t.signals[Ft],Mt[Ft],SKIP)}),Object.keys(kt||{}).forEach(Ft=>{Ct.pulse($t.data[Ft].input,Ct.changeset().remove(truthy).insert(kt[Ft]))}),(xt.subcontext||[]).forEach((Ft,jt)=>{const Bt=$t.subcontext[jt];Bt&&Bt.setState(Ft)})}function context(xt,$t,Ct,kt){return new Context(xt,$t,Ct,kt)}function Context(xt,$t,Ct,kt){this.dataflow=xt,this.transforms=$t,this.events=xt.events.bind(xt),this.expr=kt||expressionCodegen,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},Ct&&(this.functions=Object.create(Ct),this.functions.context=this)}function Subcontext(xt){this.dataflow=xt.dataflow,this.transforms=xt.transforms,this.events=xt.events,this.expr=xt.expr,this.signals=Object.create(xt.signals),this.scales=Object.create(xt.scales),this.nodes=Object.create(xt.nodes),this.data=Object.create(xt.data),this.fn=Object.create(xt.fn),xt.functions&&(this.functions=Object.create(xt.functions),this.functions.context=this)}Context.prototype=Subcontext.prototype={fork(){const xt=new Subcontext(this);return(this.subcontext||(this.subcontext=[])).push(xt),xt},detach(xt){this.subcontext=this.subcontext.filter(Ct=>Ct!==xt);const $t=Object.keys(xt.nodes);for(const Ct of $t)xt.nodes[Ct]._targets=null;for(const Ct of $t)xt.nodes[Ct].detach();xt.nodes=null},get(xt){return this.nodes[xt]},set(xt,$t){return this.nodes[xt]=$t},add(xt,$t){const Ct=this,kt=Ct.dataflow,Mt=xt.value;if(Ct.set(xt.id,$t),isCollect(xt.type)&&Mt&&(Mt.$ingest?kt.ingest($t,Mt.$ingest,Mt.$format):Mt.$request?kt.preload($t,Mt.$request,Mt.$format):kt.pulse($t,kt.changeset().insert(Mt))),xt.root&&(Ct.root=$t),xt.parent){let Ft=Ct.get(xt.parent.$ref);Ft?(kt.connect(Ft,[$t]),$t.targets().add(Ft)):(Ct.unresolved=Ct.unresolved||[]).push(()=>{Ft=Ct.get(xt.parent.$ref),kt.connect(Ft,[$t]),$t.targets().add(Ft)})}if(xt.signal&&(Ct.signals[xt.signal]=$t),xt.scale&&(Ct.scales[xt.scale]=$t),xt.data)for(const Ft in xt.data){const jt=Ct.data[Ft]||(Ct.data[Ft]={});xt.data[Ft].forEach(Bt=>jt[Bt]=$t)}},resolve(){return(this.unresolved||[]).forEach(xt=>xt()),delete this.unresolved,this},operator(xt,$t){this.add(xt,this.dataflow.add(xt.value,$t))},transform(xt,$t){this.add(xt,this.dataflow.add(this.transforms[canonicalType($t)]))},stream(xt,$t){this.set(xt.id,$t)},update(xt,$t,Ct,kt,Mt){this.dataflow.on($t,Ct,kt,Mt,xt.options)},operatorExpression(xt){return this.expr.operator(this,xt)},parameterExpression(xt){return this.expr.parameter(this,xt)},eventExpression(xt){return this.expr.event(this,xt)},handlerExpression(xt){return this.expr.handler(this,xt)},encodeExpression(xt){return this.expr.encode(this,xt)},parse:parse$2,parseOperator,parseOperatorParameters,parseParameters:parseParameters$1,parseStream:parseStream$2,parseUpdate:parseUpdate$1,getState:getState$1,setState:setState$1};function initializeAria(xt){const $t=xt.container();$t&&($t.setAttribute("role","graphics-document"),$t.setAttribute("aria-roleDescription","visualization"),ariaLabel($t,xt.description()))}function ariaLabel(xt,$t){xt&&($t==null?xt.removeAttribute("aria-label"):xt.setAttribute("aria-label",$t))}function background(xt){xt.add(null,$t=>(xt._background=$t.bg,xt._resize=1,$t.bg),{bg:xt._signals.background})}const Default="default";function cursor$1(xt){const $t=xt._signals.cursor||(xt._signals.cursor=xt.add({user:Default,item:null}));xt.on(xt.events("view","pointermove"),$t,(Ct,kt)=>{const Mt=$t.value,Ft=Mt?isString(Mt)?Mt:Mt.user:Default,jt=kt.item&&kt.item.cursor||null;return Mt&&Ft===Mt.user&&jt==Mt.item?Mt:{user:Ft,item:jt}}),xt.add(null,function(Ct){let kt=Ct.cursor,Mt=this.value;return isString(kt)||(Mt=kt.item,kt=kt.user),setCursor(xt,kt&&kt!==Default?kt:Mt||kt),Mt},{cursor:$t})}function setCursor(xt,$t){const Ct=xt.globalCursor()?typeof document<"u"&&document.body:xt.container();if(Ct)return $t==null?Ct.style.removeProperty("cursor"):Ct.style.cursor=$t}function dataref(xt,$t){var Ct=xt._runtime.data;return has$1(Ct,$t)||error("Unrecognized data set: "+$t),Ct[$t]}function data(xt,$t){return arguments.length<2?dataref(this,xt).values.value:change.call(this,xt,changeset().remove(truthy).insert($t))}function change(xt,$t){isChangeSet($t)||error("Second argument to changes must be a changeset.");const Ct=dataref(this,xt);return Ct.modified=!0,this.pulse(Ct.input,$t)}function insert$1(xt,$t){return change.call(this,xt,changeset().insert($t))}function remove(xt,$t){return change.call(this,xt,changeset().remove($t))}function width(xt){var $t=xt.padding();return Math.max(0,xt._viewWidth+$t.left+$t.right)}function height(xt){var $t=xt.padding();return Math.max(0,xt._viewHeight+$t.top+$t.bottom)}function offset(xt){var $t=xt.padding(),Ct=xt._origin;return[$t.left+Ct[0],$t.top+Ct[1]]}function resizeRenderer(xt){var $t=offset(xt),Ct=width(xt),kt=height(xt);xt._renderer.background(xt.background()),xt._renderer.resize(Ct,kt,$t),xt._handler.origin($t),xt._resizeListeners.forEach(Mt=>{try{Mt(Ct,kt)}catch(Ft){xt.error(Ft)}})}function eventExtend(xt,$t,Ct){var kt=xt._renderer,Mt=kt&&kt.canvas(),Ft,jt,Bt;return Mt&&(Bt=offset(xt),jt=$t.changedTouches?$t.changedTouches[0]:$t,Ft=point$2(jt,Mt),Ft[0]-=Bt[0],Ft[1]-=Bt[1]),$t.dataflow=xt,$t.item=Ct,$t.vega=extension(xt,Ct,Ft),$t}function extension(xt,$t,Ct){const kt=$t?$t.mark.marktype==="group"?$t:$t.mark.group:null;function Mt(jt){var Bt=kt,Vt;if(jt){for(Vt=$t;Vt;Vt=Vt.mark.group)if(Vt.mark.name===jt){Bt=Vt;break}}return Bt&&Bt.mark&&Bt.mark.interactive?Bt:{}}function Ft(jt){if(!jt)return Ct;isString(jt)&&(jt=Mt(jt));const Bt=Ct.slice();for(;jt;)Bt[0]-=jt.x||0,Bt[1]-=jt.y||0,jt=jt.mark&&jt.mark.group;return Bt}return{view:constant$1(xt),item:constant$1($t||{}),group:Mt,xy:Ft,x:jt=>Ft(jt)[0],y:jt=>Ft(jt)[1]}}const VIEW$1="view",TIMER="timer",WINDOW="window",NO_TRAP={trap:!1};function initializeEventConfig(xt){const $t=extend({defaults:{}},xt),Ct=(kt,Mt)=>{Mt.forEach(Ft=>{isArray(kt[Ft])&&(kt[Ft]=toSet(kt[Ft]))})};return Ct($t.defaults,["prevent","allow"]),Ct($t,["view","window","selector"]),$t}function trackEventListener(xt,$t,Ct,kt){xt._eventListeners.push({type:Ct,sources:array$2($t),handler:kt})}function prevent(xt,$t){var Ct=xt._eventConfig.defaults,kt=Ct.prevent,Mt=Ct.allow;return kt===!1||Mt===!0?!1:kt===!0||Mt===!1?!0:kt?kt[$t]:Mt?!Mt[$t]:xt.preventDefault()}function permit(xt,$t,Ct){const kt=xt._eventConfig&&xt._eventConfig[$t];return kt===!1||isObject(kt)&&!kt[Ct]?(xt.warn(`Blocked ${$t} ${Ct} event listener.`),!1):!0}function events(xt,$t,Ct){var kt=this,Mt=new EventStream(Ct),Ft=function(zt,Ht){kt.runAsync(null,()=>{xt===VIEW$1&&prevent(kt,$t)&&zt.preventDefault(),Mt.receive(eventExtend(kt,zt,Ht))})},jt;if(xt===TIMER)permit(kt,"timer",$t)&&kt.timer(Ft,$t);else if(xt===VIEW$1)permit(kt,"view",$t)&&kt.addEventListener($t,Ft,NO_TRAP);else if(xt===WINDOW?permit(kt,"window",$t)&&typeof window<"u"&&(jt=[window]):typeof document<"u"&&permit(kt,"selector",$t)&&(jt=Array.from(document.querySelectorAll(xt))),!jt)kt.warn("Can not resolve event source: "+xt);else{for(var Bt=0,Vt=jt.length;Bt<Vt;++Bt)jt[Bt].addEventListener($t,Ft);trackEventListener(kt,jt,$t,Ft)}return Mt}function itemFilter(xt){return xt.item}function markTarget(xt){return xt.item.mark.source}function invoke(xt){return function($t,Ct){return Ct.vega.view().changeset().encode(Ct.item,xt)}}function hover(xt,$t){return xt=[xt||"hover"],$t=[$t||"update",xt[0]],this.on(this.events("view","pointerover",itemFilter),markTarget,invoke(xt)),this.on(this.events("view","pointerout",itemFilter),markTarget,invoke($t)),this}function finalize(){var xt=this._tooltip,$t=this._timers,Ct=this._handler.handlers(),kt=this._eventListeners,Mt,Ft,jt,Bt,Vt;for(Mt=$t.length;--Mt>=0;)$t[Mt].stop();for(Mt=kt.length;--Mt>=0;)for(jt=kt[Mt],Ft=jt.sources.length;--Ft>=0;)jt.sources[Ft].removeEventListener(jt.type,jt.handler);for(xt&&xt.call(this,this._handler,null,null,null),Mt=Ct.length;--Mt>=0;)Vt=Ct[Mt].type,Bt=Ct[Mt].handler,this._handler.off(Vt,Bt);return this}function element(xt,$t,Ct){const kt=document.createElement(xt);for(const Mt in $t)kt.setAttribute(Mt,$t[Mt]);return Ct!=null&&(kt.textContent=Ct),kt}const BindClass="vega-bind",NameClass="vega-bind-name",RadioClass="vega-bind-radio";function bind(xt,$t,Ct){if(!$t)return;const kt=Ct.param;let Mt=Ct.state;return Mt||(Mt=Ct.state={elements:null,active:!1,set:null,update:jt=>{jt!=xt.signal(kt.signal)&&xt.runAsync(null,()=>{Mt.source=!0,xt.signal(kt.signal,jt)})}},kt.debounce&&(Mt.update=debounce(kt.debounce,Mt.update))),(kt.input==null&&kt.element?target:generate)(Mt,$t,kt,xt),Mt.active||(xt.on(xt._signals[kt.signal],null,()=>{Mt.source?Mt.source=!1:Mt.set(xt.signal(kt.signal))}),Mt.active=!0),Mt}function target(xt,$t,Ct,kt){const Mt=Ct.event||"input",Ft=()=>xt.update($t.value);kt.signal(Ct.signal,$t.value),$t.addEventListener(Mt,Ft),trackEventListener(kt,$t,Mt,Ft),xt.set=jt=>{$t.value=jt,$t.dispatchEvent(event(Mt))}}function event(xt){return typeof Event<"u"?new Event(xt):{type:xt}}function generate(xt,$t,Ct,kt){const Mt=kt.signal(Ct.signal),Ft=element("div",{class:BindClass}),jt=Ct.input==="radio"?Ft:Ft.appendChild(element("label"));jt.appendChild(element("span",{class:NameClass},Ct.name||Ct.signal)),$t.appendChild(Ft);let Bt=form;switch(Ct.input){case"checkbox":Bt=checkbox;break;case"select":Bt=select;break;case"radio":Bt=radio;break;case"range":Bt=range$2;break}Bt(xt,jt,Ct,Mt)}function form(xt,$t,Ct,kt){const Mt=element("input");for(const Ft in Ct)Ft!=="signal"&&Ft!=="element"&&Mt.setAttribute(Ft==="input"?"type":Ft,Ct[Ft]);Mt.setAttribute("name",Ct.signal),Mt.value=kt,$t.appendChild(Mt),Mt.addEventListener("input",()=>xt.update(Mt.value)),xt.elements=[Mt],xt.set=Ft=>Mt.value=Ft}function checkbox(xt,$t,Ct,kt){const Mt={type:"checkbox",name:Ct.signal};kt&&(Mt.checked=!0);const Ft=element("input",Mt);$t.appendChild(Ft),Ft.addEventListener("change",()=>xt.update(Ft.checked)),xt.elements=[Ft],xt.set=jt=>Ft.checked=!!jt||null}function select(xt,$t,Ct,kt){const Mt=element("select",{name:Ct.signal}),Ft=Ct.labels||[];Ct.options.forEach((jt,Bt)=>{const Vt={value:jt};valuesEqual(jt,kt)&&(Vt.selected=!0),Mt.appendChild(element("option",Vt,(Ft[Bt]||jt)+""))}),$t.appendChild(Mt),Mt.addEventListener("change",()=>{xt.update(Ct.options[Mt.selectedIndex])}),xt.elements=[Mt],xt.set=jt=>{for(let Bt=0,Vt=Ct.options.length;Bt<Vt;++Bt)if(valuesEqual(Ct.options[Bt],jt)){Mt.selectedIndex=Bt;return}}}function radio(xt,$t,Ct,kt){const Mt=element("span",{class:RadioClass}),Ft=Ct.labels||[];$t.appendChild(Mt),xt.elements=Ct.options.map((jt,Bt)=>{const Vt={type:"radio",name:Ct.signal,value:jt};valuesEqual(jt,kt)&&(Vt.checked=!0);const zt=element("input",Vt);zt.addEventListener("change",()=>xt.update(jt));const Ht=element("label",{},(Ft[Bt]||jt)+"");return Ht.prepend(zt),Mt.appendChild(Ht),zt}),xt.set=jt=>{const Bt=xt.elements,Vt=Bt.length;for(let zt=0;zt<Vt;++zt)valuesEqual(Bt[zt].value,jt)&&(Bt[zt].checked=!0)}}function range$2(xt,$t,Ct,kt){kt=kt!==void 0?kt:(+Ct.max+ +Ct.min)/2;const Mt=Ct.max!=null?Ct.max:Math.max(100,+kt)||100,Ft=Ct.min||Math.min(0,Mt,+kt)||0,jt=Ct.step||tickStep(Ft,Mt,100),Bt=element("input",{type:"range",name:Ct.signal,min:Ft,max:Mt,step:jt});Bt.value=kt;const Vt=element("span",{},+kt);$t.appendChild(Bt),$t.appendChild(Vt);const zt=()=>{Vt.textContent=Bt.value,xt.update(+Bt.value)};Bt.addEventListener("input",zt),Bt.addEventListener("change",zt),xt.elements=[Bt],xt.set=Ht=>{Bt.value=Ht,Vt.textContent=Ht}}function valuesEqual(xt,$t){return xt===$t||xt+""==$t+""}function initializeRenderer(xt,$t,Ct,kt,Mt,Ft){return $t=$t||new kt(xt.loader()),$t.initialize(Ct,width(xt),height(xt),offset(xt),Mt,Ft).background(xt.background())}function trap(xt,$t){return $t?function(){try{$t.apply(this,arguments)}catch(Ct){xt.error(Ct)}}:null}function initializeHandler(xt,$t,Ct,kt){const Mt=new kt(xt.loader(),trap(xt,xt.tooltip())).scene(xt.scenegraph().root).initialize(Ct,offset(xt),xt);return $t&&$t.handlers().forEach(Ft=>{Mt.on(Ft.type,Ft.handler)}),Mt}function initialize(xt,$t){const Ct=this,kt=Ct._renderType,Mt=Ct._eventConfig.bind,Ft=renderModule(kt);xt=Ct._el=xt?lookup$1(Ct,xt,!0):null,initializeAria(Ct),Ft||Ct.error("Unrecognized renderer type: "+kt);const jt=Ft.handler||CanvasHandler,Bt=xt?Ft.renderer:Ft.headless;return Ct._renderer=Bt?initializeRenderer(Ct,Ct._renderer,xt,Bt):null,Ct._handler=initializeHandler(Ct,Ct._handler,xt,jt),Ct._redraw=!0,xt&&Mt!=="none"&&($t=$t?Ct._elBind=lookup$1(Ct,$t,!0):xt.appendChild(element("form",{class:"vega-bindings"})),Ct._bind.forEach(Vt=>{Vt.param.element&&Mt!=="container"&&(Vt.element=lookup$1(Ct,Vt.param.element,!!Vt.param.input))}),Ct._bind.forEach(Vt=>{bind(Ct,Vt.element||$t,Vt)})),Ct}function lookup$1(xt,$t,Ct){if(typeof $t=="string")if(typeof document<"u"){if($t=document.querySelector($t),!$t)return xt.error("Signal bind element not found: "+$t),null}else return xt.error("DOM document instance not found."),null;if($t&&Ct)try{$t.textContent=""}catch(kt){$t=null,xt.error(kt)}return $t}const number$1=xt=>+xt||0,paddingObject$1=xt=>({top:xt,bottom:xt,left:xt,right:xt});function padding$1(xt){return isObject(xt)?{top:number$1(xt.top),bottom:number$1(xt.bottom),left:number$1(xt.left),right:number$1(xt.right)}:paddingObject$1(number$1(xt))}async function renderHeadless(xt,$t,Ct,kt){const Mt=renderModule($t),Ft=Mt&&Mt.headless;return Ft||error("Unrecognized renderer type: "+$t),await xt.runAsync(),initializeRenderer(xt,null,null,Ft,Ct,kt).renderAsync(xt._scenegraph.root)}async function renderToImageURL(xt,$t){xt!==RenderType.Canvas&&xt!==RenderType.SVG&&xt!==RenderType.PNG&&error("Unrecognized image type: "+xt);const Ct=await renderHeadless(this,xt,$t);return xt===RenderType.SVG?toBlobURL(Ct.svg(),"image/svg+xml"):Ct.canvas().toDataURL("image/png")}function toBlobURL(xt,$t){const Ct=new Blob([xt],{type:$t});return window.URL.createObjectURL(Ct)}async function renderToCanvas(xt,$t){return(await renderHeadless(this,RenderType.Canvas,xt,$t)).canvas()}async function renderToSVG(xt){return(await renderHeadless(this,RenderType.SVG,xt)).svg()}function runtime(xt,$t,Ct){return context(xt,transforms,functionContext,Ct).parse($t)}function scale$1(xt){var $t=this._runtime.scales;return has$1($t,xt)||error("Unrecognized scale or projection: "+xt),$t[xt].value}var Width="width",Height="height",Padding="padding",Skip$1={skip:!0};function viewWidth(xt,$t){var Ct=xt.autosize(),kt=xt.padding();return $t-(Ct&&Ct.contains===Padding?kt.left+kt.right:0)}function viewHeight(xt,$t){var Ct=xt.autosize(),kt=xt.padding();return $t-(Ct&&Ct.contains===Padding?kt.top+kt.bottom:0)}function initializeResize(xt){var $t=xt._signals,Ct=$t[Width],kt=$t[Height],Mt=$t[Padding];function Ft(){xt._autosize=xt._resize=1}xt._resizeWidth=xt.add(null,Bt=>{xt._width=Bt.size,xt._viewWidth=viewWidth(xt,Bt.size),Ft()},{size:Ct}),xt._resizeHeight=xt.add(null,Bt=>{xt._height=Bt.size,xt._viewHeight=viewHeight(xt,Bt.size),Ft()},{size:kt});const jt=xt.add(null,Ft,{pad:Mt});xt._resizeWidth.rank=Ct.rank+1,xt._resizeHeight.rank=kt.rank+1,jt.rank=Mt.rank+1}function resizeView(xt,$t,Ct,kt,Mt,Ft){this.runAfter(jt=>{let Bt=0;jt._autosize=0,jt.width()!==Ct&&(Bt=1,jt.signal(Width,Ct,Skip$1),jt._resizeWidth.skip(!0)),jt.height()!==kt&&(Bt=1,jt.signal(Height,kt,Skip$1),jt._resizeHeight.skip(!0)),jt._viewWidth!==xt&&(jt._resize=1,jt._viewWidth=xt),jt._viewHeight!==$t&&(jt._resize=1,jt._viewHeight=$t),(jt._origin[0]!==Mt[0]||jt._origin[1]!==Mt[1])&&(jt._resize=1,jt._origin=Mt),Bt&&jt.run("enter"),Ft&&jt.runAfter(Vt=>Vt.resize())},!1,1)}function getState(xt){return this._runtime.getState(xt||{data:dataTest,signals:signalTest,recurse:!0})}function dataTest(xt,$t){return $t.modified&&isArray($t.input.value)&&!xt.startsWith("_:vega:_")}function signalTest(xt,$t){return!(xt==="parent"||$t instanceof transforms.proxy)}function setState(xt){return this.runAsync(null,$t=>{$t._trigger=!1,$t._runtime.setState(xt)},$t=>{$t._trigger=!0}),this}function timer(xt,$t){function Ct(kt){xt({timestamp:Date.now(),elapsed:kt})}this._timers.push(interval$1(Ct,$t))}function defaultTooltip(xt,$t,Ct,kt){const Mt=xt.element();Mt&&Mt.setAttribute("title",formatTooltip(kt))}function formatTooltip(xt){return xt==null?"":isArray(xt)?formatArray(xt):isObject(xt)&&!isDate$1(xt)?formatObject(xt):xt+""}function formatObject(xt){return Object.keys(xt).map($t=>{const Ct=xt[$t];return $t+": "+(isArray(Ct)?formatArray(Ct):formatValue$1(Ct))}).join(`
`)}function formatArray(xt){return"["+xt.map(formatValue$1).join(", ")+"]"}function formatValue$1(xt){return isArray(xt)?"[]":isObject(xt)&&!isDate$1(xt)?"{}":xt}function watchPixelRatio(){if(this.renderer()==="canvas"&&this._renderer._canvas){let xt=null;const $t=()=>{xt!=null&&xt();const Ct=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);Ct.addEventListener("change",$t),xt=()=>{Ct.removeEventListener("change",$t)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};$t()}}function View$1(xt,$t){const Ct=this;if($t=$t||{},Dataflow.call(Ct),$t.loader&&Ct.loader($t.loader),$t.logger&&Ct.logger($t.logger),$t.logLevel!=null&&Ct.logLevel($t.logLevel),$t.locale||xt.locale){const Ft=extend({},xt.locale,$t.locale);Ct.locale(locale(Ft.number,Ft.time))}Ct._el=null,Ct._elBind=null,Ct._renderType=$t.renderer||RenderType.Canvas,Ct._scenegraph=new Scenegraph;const kt=Ct._scenegraph.root;Ct._renderer=null,Ct._tooltip=$t.tooltip||defaultTooltip,Ct._redraw=!0,Ct._handler=new CanvasHandler().scene(kt),Ct._globalCursor=!1,Ct._preventDefault=!1,Ct._timers=[],Ct._eventListeners=[],Ct._resizeListeners=[],Ct._eventConfig=initializeEventConfig(xt.eventConfig),Ct.globalCursor(Ct._eventConfig.globalCursor);const Mt=runtime(Ct,xt,$t.expr);Ct._runtime=Mt,Ct._signals=Mt.signals,Ct._bind=(xt.bindings||[]).map(Ft=>({state:null,param:extend({},Ft)})),Mt.root&&Mt.root.set(kt),kt.source=Mt.data.root.input,Ct.pulse(Mt.data.root.input,Ct.changeset().insert(kt.items)),Ct._width=Ct.width(),Ct._height=Ct.height(),Ct._viewWidth=viewWidth(Ct,Ct._width),Ct._viewHeight=viewHeight(Ct,Ct._height),Ct._origin=[0,0],Ct._resize=0,Ct._autosize=1,initializeResize(Ct),background(Ct),cursor$1(Ct),Ct.description(xt.description),$t.hover&&Ct.hover(),$t.container&&Ct.initialize($t.container,$t.bind),$t.watchPixelRatio&&Ct._watchPixelRatio()}function lookupSignal(xt,$t){return has$1(xt._signals,$t)?xt._signals[$t]:error("Unrecognized signal name: "+$($t))}function findOperatorHandler(xt,$t){const Ct=(xt._targets||[]).filter(kt=>kt._update&&kt._update.handler===$t);return Ct.length?Ct[0]:null}function addOperatorListener(xt,$t,Ct,kt){let Mt=findOperatorHandler(Ct,kt);return Mt||(Mt=trap(xt,()=>kt($t,Ct.value)),Mt.handler=kt,xt.on(Ct,null,Mt)),xt}function removeOperatorListener(xt,$t,Ct){const kt=findOperatorHandler($t,Ct);return kt&&$t._targets.remove(kt),xt}inherits(View$1,Dataflow,{async evaluate(xt,$t,Ct){if(await Dataflow.prototype.evaluate.call(this,xt,$t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,resizeRenderer(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(kt){this.error(kt)}return Ct&&asyncCallback(this,Ct),this},dirty(xt){this._redraw=!0,this._renderer&&this._renderer.dirty(xt)},description(xt){if(arguments.length){const $t=xt!=null?xt+"":null;return $t!==this._desc&&ariaLabel(this._el,this._desc=$t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(xt,$t,Ct){const kt=lookupSignal(this,xt);return arguments.length===1?kt.value:this.update(kt,$t,Ct)},width(xt){return arguments.length?this.signal("width",xt):this.signal("width")},height(xt){return arguments.length?this.signal("height",xt):this.signal("height")},padding(xt){return arguments.length?this.signal("padding",padding$1(xt)):padding$1(this.signal("padding"))},autosize(xt){return arguments.length?this.signal("autosize",xt):this.signal("autosize")},background(xt){return arguments.length?this.signal("background",xt):this.signal("background")},renderer(xt){return arguments.length?(renderModule(xt)||error("Unrecognized renderer type: "+xt),xt!==this._renderType&&(this._renderType=xt,this._resetRenderer()),this):this._renderType},tooltip(xt){return arguments.length?(xt!==this._tooltip&&(this._tooltip=xt,this._resetRenderer()),this):this._tooltip},loader(xt){return arguments.length?(xt!==this._loader&&(Dataflow.prototype.loader.call(this,xt),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(lookupSignal(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:resizeView,addEventListener(xt,$t,Ct){let kt=$t;return Ct&&Ct.trap===!1||(kt=trap(this,$t),kt.raw=$t),this._handler.on(xt,kt),this},removeEventListener(xt,$t){for(var Ct=this._handler.handlers(xt),kt=Ct.length,Mt,Ft;--kt>=0;)if(Ft=Ct[kt].type,Mt=Ct[kt].handler,xt===Ft&&($t===Mt||$t===Mt.raw)){this._handler.off(Ft,Mt);break}return this},addResizeListener(xt){const $t=this._resizeListeners;return $t.includes(xt)||$t.push(xt),this},removeResizeListener(xt){var $t=this._resizeListeners,Ct=$t.indexOf(xt);return Ct>=0&&$t.splice(Ct,1),this},addSignalListener(xt,$t){return addOperatorListener(this,xt,lookupSignal(this,xt),$t)},removeSignalListener(xt,$t){return removeOperatorListener(this,lookupSignal(this,xt),$t)},addDataListener(xt,$t){return addOperatorListener(this,xt,dataref(this,xt).values,$t)},removeDataListener(xt,$t){return removeOperatorListener(this,dataref(this,xt).values,$t)},globalCursor(xt){if(arguments.length){if(this._globalCursor!==!!xt){const $t=setCursor(this,null);this._globalCursor=!!xt,$t&&setCursor(this,$t)}return this}else return this._globalCursor},preventDefault(xt){return arguments.length?(this._preventDefault=xt,this):this._preventDefault},timer,events,finalize,hover,data,change,insert:insert$1,remove,scale:scale$1,initialize,toImageURL:renderToImageURL,toCanvas:renderToCanvas,toSVG:renderToSVG,getState,setState,_watchPixelRatio:watchPixelRatio});const VIEW="view",LBRACK="[",RBRACK="]",LBRACE="{",RBRACE="}",COLON=":",COMMA=",",NAME="@",GT=">",ILLEGAL=/[[\]{}]/,DEFAULT_MARKS={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let DEFAULT_SOURCE,MARKS;function eventSelector(xt,$t,Ct){return DEFAULT_SOURCE=$t||VIEW,MARKS=Ct||DEFAULT_MARKS,parseMerge(xt.trim()).map(parseSelector)}function isMarkType(xt){return MARKS[xt]}function find(xt,$t,Ct,kt,Mt){const Ft=xt.length;let jt=0,Bt;for(;$t<Ft;++$t){if(Bt=xt[$t],!jt&&Bt===Ct)return $t;Mt&&Mt.indexOf(Bt)>=0?--jt:kt&&kt.indexOf(Bt)>=0&&++jt}return $t}function parseMerge(xt){const $t=[],Ct=xt.length;let kt=0,Mt=0;for(;Mt<Ct;)Mt=find(xt,Mt,COMMA,LBRACK+LBRACE,RBRACK+RBRACE),$t.push(xt.substring(kt,Mt).trim()),kt=++Mt;if($t.length===0)throw"Empty event selector: "+xt;return $t}function parseSelector(xt){return xt[0]==="["?parseBetween(xt):parseStream$1(xt)}function parseBetween(xt){const $t=xt.length;let Ct=1,kt;if(Ct=find(xt,Ct,RBRACK,LBRACK,RBRACK),Ct===$t)throw"Empty between selector: "+xt;if(kt=parseMerge(xt.substring(1,Ct)),kt.length!==2)throw"Between selector must have two elements: "+xt;if(xt=xt.slice(Ct+1).trim(),xt[0]!==GT)throw"Expected '>' after between selector: "+xt;kt=kt.map(parseSelector);const Mt=parseSelector(xt.slice(1).trim());return Mt.between?{between:kt,stream:Mt}:(Mt.between=kt,Mt)}function parseStream$1(xt){const $t={source:DEFAULT_SOURCE},Ct=[];let kt=[0,0],Mt=0,Ft=0,jt=xt.length,Bt=0,Vt,zt;if(xt[jt-1]===RBRACE){if(Bt=xt.lastIndexOf(LBRACE),Bt>=0){try{kt=parseThrottle(xt.substring(Bt+1,jt-1))}catch{throw"Invalid throttle specification: "+xt}xt=xt.slice(0,Bt).trim(),jt=xt.length}else throw"Unmatched right brace: "+xt;Bt=0}if(!jt)throw xt;if(xt[0]===NAME&&(Mt=++Bt),Vt=find(xt,Bt,COLON),Vt<jt&&(Ct.push(xt.substring(Ft,Vt).trim()),Ft=Bt=++Vt),Bt=find(xt,Bt,LBRACK),Bt===jt)Ct.push(xt.substring(Ft,jt).trim());else if(Ct.push(xt.substring(Ft,Bt).trim()),zt=[],Ft=++Bt,Ft===jt)throw"Unmatched left bracket: "+xt;for(;Bt<jt;){if(Bt=find(xt,Bt,RBRACK),Bt===jt)throw"Unmatched left bracket: "+xt;if(zt.push(xt.substring(Ft,Bt).trim()),Bt<jt-1&&xt[++Bt]!==LBRACK)throw"Expected left bracket: "+xt;Ft=++Bt}if(!(jt=Ct.length)||ILLEGAL.test(Ct[jt-1]))throw"Invalid event selector: "+xt;return jt>1?($t.type=Ct[1],Mt?$t.markname=Ct[0].slice(1):isMarkType(Ct[0])?$t.marktype=Ct[0]:$t.source=Ct[0]):$t.type=Ct[0],$t.type.slice(-1)==="!"&&($t.consume=!0,$t.type=$t.type.slice(0,-1)),zt!=null&&($t.filter=zt),kt[0]&&($t.throttle=kt[0]),kt[1]&&($t.debounce=kt[1]),$t}function parseThrottle(xt){const $t=xt.split(COMMA);if(!xt.length||$t.length>2)throw xt;return $t.map(Ct=>{const kt=+Ct;if(kt!==kt)throw xt;return kt})}function parseAutosize(xt){return isObject(xt)?xt:{type:xt||"pad"}}const number=xt=>+xt||0,paddingObject=xt=>({top:xt,bottom:xt,left:xt,right:xt});function parsePadding(xt){return isObject(xt)?xt.signal?xt:{top:number(xt.top),bottom:number(xt.bottom),left:number(xt.left),right:number(xt.right)}:paddingObject(number(xt))}const encoder=xt=>isObject(xt)&&!isArray(xt)?extend({},xt):{value:xt};function addEncode(xt,$t,Ct,kt){return Ct!=null?(isObject(Ct)&&!isArray(Ct)||isArray(Ct)&&Ct.length&&isObject(Ct[0])?xt.update[$t]=Ct:xt[kt||"enter"][$t]={value:Ct},1):0}function addEncoders(xt,$t,Ct){for(const kt in $t)addEncode(xt,kt,$t[kt]);for(const kt in Ct)addEncode(xt,kt,Ct[kt],"update")}function extendEncode(xt,$t,Ct){for(const kt in $t)Ct&&has$1(Ct,kt)||(xt[kt]=extend(xt[kt]||{},$t[kt]));return xt}function has(xt,$t){return $t&&($t.enter&&$t.enter[xt]||$t.update&&$t.update[xt])}const MarkRole="mark",FrameRole="frame",ScopeRole="scope",AxisRole="axis",AxisDomainRole="axis-domain",AxisGridRole="axis-grid",AxisLabelRole="axis-label",AxisTickRole="axis-tick",AxisTitleRole="axis-title",LegendRole="legend",LegendBandRole="legend-band",LegendEntryRole="legend-entry",LegendGradientRole="legend-gradient",LegendLabelRole="legend-label",LegendSymbolRole="legend-symbol",LegendTitleRole="legend-title",TitleRole="title",TitleTextRole="title-text",TitleSubtitleRole="title-subtitle";function applyDefaults(xt,$t,Ct,kt,Mt){const Ft={},jt={};let Bt,Vt,zt,Ht;Vt="lineBreak",$t==="text"&&Mt[Vt]!=null&&!has(Vt,xt)&&applyDefault(Ft,Vt,Mt[Vt]),(Ct=="legend"||String(Ct).startsWith("axis"))&&(Ct=null),Ht=Ct===FrameRole?Mt.group:Ct===MarkRole?extend({},Mt.mark,Mt[$t]):null;for(Vt in Ht)zt=has(Vt,xt)||(Vt==="fill"||Vt==="stroke")&&(has("fill",xt)||has("stroke",xt)),zt||applyDefault(Ft,Vt,Ht[Vt]);array$2(kt).forEach(Gt=>{const qt=Mt.style&&Mt.style[Gt];for(const Wt in qt)has(Wt,xt)||applyDefault(Ft,Wt,qt[Wt])}),xt=extend({},xt);for(Vt in Ft)Ht=Ft[Vt],Ht.signal?(Bt=Bt||{})[Vt]=Ht:jt[Vt]=Ht;return xt.enter=extend(jt,xt.enter),Bt&&(xt.update=extend(Bt,xt.update)),xt}function applyDefault(xt,$t,Ct){xt[$t]=Ct&&Ct.signal?{signal:Ct.signal}:{value:Ct}}const scaleRef=xt=>isString(xt)?$(xt):xt.signal?`(${xt.signal})`:field(xt);function entry$1(xt){if(xt.gradient!=null)return gradient$1(xt);let $t=xt.signal?`(${xt.signal})`:xt.color?color$1(xt.color):xt.field!=null?field(xt.field):xt.value!==void 0?$(xt.value):void 0;return xt.scale!=null&&($t=scale(xt,$t)),$t===void 0&&($t=null),xt.exponent!=null&&($t=`pow(${$t},${property(xt.exponent)})`),xt.mult!=null&&($t+=`*${property(xt.mult)}`),xt.offset!=null&&($t+=`+${property(xt.offset)}`),xt.round&&($t=`round(${$t})`),$t}const _color=(xt,$t,Ct,kt)=>`(${xt}(${[$t,Ct,kt].map(entry$1).join(",")})+'')`;function color$1(xt){return xt.c?_color("hcl",xt.h,xt.c,xt.l):xt.h||xt.s?_color("hsl",xt.h,xt.s,xt.l):xt.l||xt.a?_color("lab",xt.l,xt.a,xt.b):xt.r||xt.g||xt.b?_color("rgb",xt.r,xt.g,xt.b):null}function gradient$1(xt){const $t=[xt.start,xt.stop,xt.count].map(Ct=>Ct==null?null:$(Ct));for(;$t.length&&peek$1($t)==null;)$t.pop();return $t.unshift(scaleRef(xt.gradient)),`gradient(${$t.join(",")})`}function property(xt){return isObject(xt)?"("+entry$1(xt)+")":xt}function field(xt){return resolveField(isObject(xt)?xt:{datum:xt})}function resolveField(xt){let $t,Ct,kt;if(xt.signal)$t="datum",kt=xt.signal;else if(xt.group||xt.parent){for(Ct=Math.max(1,xt.level||1),$t="item";Ct-- >0;)$t+=".mark.group";xt.parent?(kt=xt.parent,$t+=".datum"):kt=xt.group}else xt.datum?($t="datum",kt=xt.datum):error("Invalid field reference: "+$(xt));return xt.signal||(kt=isString(kt)?splitAccessPath(kt).map($).join("]["):resolveField(kt)),$t+"["+kt+"]"}function scale(xt,$t){const Ct=scaleRef(xt.scale);return xt.range!=null?$t=`lerp(_range(${Ct}), ${+xt.range})`:($t!==void 0&&($t=`_scale(${Ct}, ${$t})`),xt.band&&($t=($t?$t+"+":"")+`_bandwidth(${Ct})`+(+xt.band==1?"":"*"+property(xt.band)),xt.extra&&($t=`(datum.extra ? _scale(${Ct}, datum.extra.value) : ${$t})`)),$t==null&&($t="0")),$t}function rule$1(xt){let $t="";return xt.forEach(Ct=>{const kt=entry$1(Ct);$t+=Ct.test?`(${Ct.test})?${kt}:`:kt}),peek$1($t)===":"&&($t+="null"),$t}function parseEncode(xt,$t,Ct,kt,Mt,Ft){const jt={};Ft=Ft||{},Ft.encoders={$encode:jt},xt=applyDefaults(xt,$t,Ct,kt,Mt.config);for(const Bt in xt)jt[Bt]=parseBlock(xt[Bt],$t,Ft,Mt);return Ft}function parseBlock(xt,$t,Ct,kt){const Mt={},Ft={};for(const jt in xt)xt[jt]!=null&&(Mt[jt]=parse$1(expr(xt[jt]),kt,Ct,Ft));return{$expr:{marktype:$t,channels:Mt},$fields:Object.keys(Ft),$output:Object.keys(xt)}}function expr(xt){return isArray(xt)?rule$1(xt):entry$1(xt)}function parse$1(xt,$t,Ct,kt){const Mt=parser(xt,$t);return Mt.$fields.forEach(Ft=>kt[Ft]=1),extend(Ct,Mt.$params),Mt.$expr}const OUTER="outer",OUTER_INVALID=["value","update","init","react","bind"];function outerError(xt,$t){error(xt+' for "outer" push: '+$($t))}function parseSignal(xt,$t){const Ct=xt.name;if(xt.push===OUTER)$t.signals[Ct]||outerError("No prior signal definition",Ct),OUTER_INVALID.forEach(kt=>{xt[kt]!==void 0&&outerError("Invalid property ",kt)});else{const kt=$t.addSignal(Ct,xt.value);xt.react===!1&&(kt.react=!1),xt.bind&&$t.addBinding(Ct,xt.bind)}}function Entry$1(xt,$t,Ct,kt){this.id=-1,this.type=xt,this.value=$t,this.params=Ct,kt&&(this.parent=kt)}function entry(xt,$t,Ct,kt){return new Entry$1(xt,$t,Ct,kt)}function operator(xt,$t){return entry("operator",xt,$t)}function ref(xt){const $t={$ref:xt.id};return xt.id<0&&(xt.refs=xt.refs||[]).push($t),$t}function fieldRef$1(xt,$t){return $t?{$field:xt,$name:$t}:{$field:xt}}const keyFieldRef=fieldRef$1("key");function compareRef(xt,$t){return{$compare:xt,$order:$t}}function keyRef(xt,$t){const Ct={$key:xt};return $t&&(Ct.$flat=!0),Ct}const Ascending="ascending",Descending="descending";function sortKey(xt){return isObject(xt)?(xt.order===Descending?"-":"+")+aggrField(xt.op,xt.field):""}function aggrField(xt,$t){return(xt&&xt.signal?"$"+xt.signal:xt||"")+(xt&&$t?"_":"")+($t&&$t.signal?"$"+$t.signal:$t||"")}const Scope$1="scope",View="view";function isSignal(xt){return xt&&xt.signal}function isExpr$1(xt){return xt&&xt.expr}function hasSignal(xt){if(isSignal(xt))return!0;if(isObject(xt)){for(const $t in xt)if(hasSignal(xt[$t]))return!0}return!1}function value(xt,$t){return xt??$t}function deref(xt){return xt&&xt.signal||xt}const Timer="timer";function parseStream(xt,$t){return(xt.merge?mergeStream:xt.stream?nestedStream:xt.type?eventStream:error("Invalid stream specification: "+$(xt)))(xt,$t)}function eventSource(xt){return xt===Scope$1?View:xt||View}function mergeStream(xt,$t){const Ct=xt.merge.map(Mt=>parseStream(Mt,$t)),kt=streamParameters({merge:Ct},xt,$t);return $t.addStream(kt).id}function nestedStream(xt,$t){const Ct=parseStream(xt.stream,$t),kt=streamParameters({stream:Ct},xt,$t);return $t.addStream(kt).id}function eventStream(xt,$t){let Ct;xt.type===Timer?(Ct=$t.event(Timer,xt.throttle),xt={between:xt.between,filter:xt.filter}):Ct=$t.event(eventSource(xt.source),xt.type);const kt=streamParameters({stream:Ct},xt,$t);return Object.keys(kt).length===1?Ct:$t.addStream(kt).id}function streamParameters(xt,$t,Ct){let kt=$t.between;return kt&&(kt.length!==2&&error('Stream "between" parameter must have 2 entries: '+$($t)),xt.between=[parseStream(kt[0],Ct),parseStream(kt[1],Ct)]),kt=$t.filter?[].concat($t.filter):[],($t.marktype||$t.markname||$t.markrole)&&kt.push(filterMark($t.marktype,$t.markname,$t.markrole)),$t.source===Scope$1&&kt.push("inScope(event.item)"),kt.length&&(xt.filter=parser("("+kt.join(")&&(")+")",Ct).$expr),(kt=$t.throttle)!=null&&(xt.throttle=+kt),(kt=$t.debounce)!=null&&(xt.debounce=+kt),$t.consume&&(xt.consume=!0),xt}function filterMark(xt,$t,Ct){const kt="event.item";return kt+(xt&&xt!=="*"?"&&"+kt+".mark.marktype==='"+xt+"'":"")+(Ct?"&&"+kt+".mark.role==='"+Ct+"'":"")+($t?"&&"+kt+".mark.name==='"+$t+"'":"")}const OP_VALUE_EXPR={code:"_.$value",ast:{type:"Identifier",value:"value"}};function parseUpdate(xt,$t,Ct){const kt=xt.encode,Mt={target:Ct};let Ft=xt.events,jt=xt.update,Bt=[];Ft||error("Signal update missing events specification."),isString(Ft)&&(Ft=eventSelector(Ft,$t.isSubscope()?Scope$1:View)),Ft=array$2(Ft).filter(Vt=>Vt.signal||Vt.scale?(Bt.push(Vt),0):1),Bt.length>1&&(Bt=[mergeSources(Bt)]),Ft.length&&Bt.push(Ft.length>1?{merge:Ft}:Ft[0]),kt!=null&&(jt&&error("Signal encode and update are mutually exclusive."),jt="encode(item(),"+$(kt)+")"),Mt.update=isString(jt)?parser(jt,$t):jt.expr!=null?parser(jt.expr,$t):jt.value!=null?jt.value:jt.signal!=null?{$expr:OP_VALUE_EXPR,$params:{$value:$t.signalRef(jt.signal)}}:error("Invalid signal update specification."),xt.force&&(Mt.options={force:!0}),Bt.forEach(Vt=>$t.addUpdate(extend(streamSource(Vt,$t),Mt)))}function streamSource(xt,$t){return{source:xt.signal?$t.signalRef(xt.signal):xt.scale?$t.scaleRef(xt.scale):parseStream(xt,$t)}}function mergeSources(xt){return{signal:"["+xt.map($t=>$t.scale?'scale("'+$t.scale+'")':$t.signal)+"]"}}function parseSignalUpdates(xt,$t){const Ct=$t.getSignal(xt.name);let kt=xt.update;xt.init&&(kt?error("Signals can not include both init and update expressions."):(kt=xt.init,Ct.initonly=!0)),kt&&(kt=parser(kt,$t),Ct.update=kt.$expr,Ct.params=kt.$params),xt.on&&xt.on.forEach(Mt=>parseUpdate(Mt,$t,Ct.id))}const transform=xt=>($t,Ct,kt)=>entry(xt,Ct,$t||void 0,kt),Aggregate=transform("aggregate"),AxisTicks=transform("axisticks"),Bound=transform("bound"),Collect=transform("collect"),Compare=transform("compare"),DataJoin=transform("datajoin"),Encode=transform("encode"),Expression=transform("expression"),Facet=transform("facet"),Field=transform("field"),Key=transform("key"),LegendEntries=transform("legendentries"),Load=transform("load"),Mark$1=transform("mark"),MultiExtent=transform("multiextent"),MultiValues=transform("multivalues"),Overlap=transform("overlap"),Params=transform("params"),PreFacet=transform("prefacet"),Projection=transform("projection"),Proxy$1=transform("proxy"),Relay=transform("relay"),Render=transform("render"),Scale=transform("scale"),Sieve=transform("sieve"),SortItems=transform("sortitems"),ViewLayout=transform("viewlayout"),Values=transform("values");let FIELD_REF_ID=0;const MULTIDOMAIN_SORT_OPS={min:"min",max:"max",count:"sum"};function initScale(xt,$t){const Ct=xt.type||"linear";isValidScaleType(Ct)||error("Unrecognized scale type: "+$(Ct)),$t.addScale(xt.name,{type:Ct,domain:void 0})}function parseScale(xt,$t){const Ct=$t.getScale(xt.name).params;let kt;Ct.domain=parseScaleDomain$1(xt.domain,xt,$t),xt.range!=null&&(Ct.range=parseScaleRange$1(xt,$t,Ct)),xt.interpolate!=null&&parseScaleInterpolate(xt.interpolate,Ct),xt.nice!=null&&(Ct.nice=parseScaleNice(xt.nice,$t)),xt.bins!=null&&(Ct.bins=parseScaleBins(xt.bins,$t));for(kt in xt)has$1(Ct,kt)||kt==="name"||(Ct[kt]=parseLiteral(xt[kt],$t))}function parseLiteral(xt,$t){return isObject(xt)?xt.signal?$t.signalRef(xt.signal):error("Unsupported object: "+$(xt)):xt}function parseArray(xt,$t){return xt.signal?$t.signalRef(xt.signal):xt.map(Ct=>parseLiteral(Ct,$t))}function dataLookupError(xt){error("Can not find data set: "+$(xt))}function parseScaleDomain$1(xt,$t,Ct){if(!xt){($t.domainMin!=null||$t.domainMax!=null)&&error("No scale domain defined for domainMin/domainMax to override.");return}return xt.signal?Ct.signalRef(xt.signal):(isArray(xt)?explicitDomain:xt.fields?multipleDomain:singularDomain)(xt,$t,Ct)}function explicitDomain(xt,$t,Ct){return xt.map(kt=>parseLiteral(kt,Ct))}function singularDomain(xt,$t,Ct){const kt=Ct.getData(xt.data);return kt||dataLookupError(xt.data),isDiscrete$2($t.type)?kt.valuesRef(Ct,xt.field,parseSort(xt.sort,!1)):isQuantile$1($t.type)?kt.domainRef(Ct,xt.field):kt.extentRef(Ct,xt.field)}function multipleDomain(xt,$t,Ct){const kt=xt.data,Mt=xt.fields.reduce((Ft,jt)=>(jt=isString(jt)?{data:kt,field:jt}:isArray(jt)||jt.signal?fieldRef(jt,Ct):jt,Ft.push(jt),Ft),[]);return(isDiscrete$2($t.type)?ordinalMultipleDomain:isQuantile$1($t.type)?quantileMultipleDomain:numericMultipleDomain)(xt,Ct,Mt)}function fieldRef(xt,$t){const Ct="_:vega:_"+FIELD_REF_ID++,kt=Collect({});if(isArray(xt))kt.value={$ingest:xt};else if(xt.signal){const Mt="setdata("+$(Ct)+","+xt.signal+")";kt.params.input=$t.signalRef(Mt)}return $t.addDataPipeline(Ct,[kt,Sieve({})]),{data:Ct,field:"data"}}function ordinalMultipleDomain(xt,$t,Ct){const kt=parseSort(xt.sort,!0);let Mt,Ft;const jt=Ct.map(zt=>{const Ht=$t.getData(zt.data);return Ht||dataLookupError(zt.data),Ht.countsRef($t,zt.field,kt)}),Bt={groupby:keyFieldRef,pulse:jt};kt&&(Mt=kt.op||"count",Ft=kt.field?aggrField(Mt,kt.field):"count",Bt.ops=[MULTIDOMAIN_SORT_OPS[Mt]],Bt.fields=[$t.fieldRef(Ft)],Bt.as=[Ft]),Mt=$t.add(Aggregate(Bt));const Vt=$t.add(Collect({pulse:ref(Mt)}));return Ft=$t.add(Values({field:keyFieldRef,sort:$t.sortRef(kt),pulse:ref(Vt)})),ref(Ft)}function parseSort(xt,$t){return xt&&(!xt.field&&!xt.op?isObject(xt)?xt.field="key":xt={field:"key"}:!xt.field&&xt.op!=="count"?error("No field provided for sort aggregate op: "+xt.op):$t&&xt.field&&xt.op&&!MULTIDOMAIN_SORT_OPS[xt.op]&&error("Multiple domain scales can not be sorted using "+xt.op)),xt}function quantileMultipleDomain(xt,$t,Ct){const kt=Ct.map(Mt=>{const Ft=$t.getData(Mt.data);return Ft||dataLookupError(Mt.data),Ft.domainRef($t,Mt.field)});return ref($t.add(MultiValues({values:kt})))}function numericMultipleDomain(xt,$t,Ct){const kt=Ct.map(Mt=>{const Ft=$t.getData(Mt.data);return Ft||dataLookupError(Mt.data),Ft.extentRef($t,Mt.field)});return ref($t.add(MultiExtent({extents:kt})))}function parseScaleBins(xt,$t){return xt.signal||isArray(xt)?parseArray(xt,$t):$t.objectProperty(xt)}function parseScaleNice(xt,$t){return xt.signal?$t.signalRef(xt.signal):isObject(xt)?{interval:parseLiteral(xt.interval),step:parseLiteral(xt.step)}:parseLiteral(xt)}function parseScaleInterpolate(xt,$t){$t.interpolate=parseLiteral(xt.type||xt),xt.gamma!=null&&($t.interpolateGamma=parseLiteral(xt.gamma))}function parseScaleRange$1(xt,$t,Ct){const kt=$t.config.range;let Mt=xt.range;if(Mt.signal)return $t.signalRef(Mt.signal);if(isString(Mt)){if(kt&&has$1(kt,Mt))return xt=extend({},xt,{range:kt[Mt]}),parseScaleRange$1(xt,$t,Ct);Mt==="width"?Mt=[0,{signal:"width"}]:Mt==="height"?Mt=isDiscrete$2(xt.type)?[0,{signal:"height"}]:[{signal:"height"},0]:error("Unrecognized scale range value: "+$(Mt))}else if(Mt.scheme){Ct.scheme=isArray(Mt.scheme)?parseArray(Mt.scheme,$t):parseLiteral(Mt.scheme,$t),Mt.extent&&(Ct.schemeExtent=parseArray(Mt.extent,$t)),Mt.count&&(Ct.schemeCount=parseLiteral(Mt.count,$t));return}else if(Mt.step){Ct.rangeStep=parseLiteral(Mt.step,$t);return}else{if(isDiscrete$2(xt.type)&&!isArray(Mt))return parseScaleDomain$1(Mt,xt,$t);isArray(Mt)||error("Unsupported range type: "+$(Mt))}return Mt.map(Ft=>(isArray(Ft)?parseArray:parseLiteral)(Ft,$t))}function parseProjection$1(xt,$t){const Ct=$t.config.projection||{},kt={};for(const Mt in xt)Mt!=="name"&&(kt[Mt]=parseParameter$1(xt[Mt],Mt,$t));for(const Mt in Ct)kt[Mt]==null&&(kt[Mt]=parseParameter$1(Ct[Mt],Mt,$t));$t.addProjection(xt.name,kt)}function parseParameter$1(xt,$t,Ct){return isArray(xt)?xt.map(kt=>parseParameter$1(kt,$t,Ct)):isObject(xt)?xt.signal?Ct.signalRef(xt.signal):$t==="fit"?xt:error("Unsupported parameter object: "+$(xt)):xt}const Top="top",Left="left",Right="right",Bottom="bottom",Center="center",Vertical="vertical",Start="start",Middle="middle",End="end",Index="index",Label="label",Offset="offset",Perc="perc",Perc2="perc2",Value="value",GuideLabelStyle="guide-label",GuideTitleStyle="guide-title",GroupTitleStyle="group-title",GroupSubtitleStyle="group-subtitle",Symbols="symbol",Gradient="gradient",Discrete="discrete",Size="size",Shape="shape",Fill="fill",Stroke="stroke",StrokeWidth="strokeWidth",StrokeDash="strokeDash",Opacity="opacity",LegendScales=[Size,Shape,Fill,Stroke,StrokeWidth,StrokeDash,Opacity],Skip={name:1,style:1,interactive:1},zero$1={value:0},one={value:1},GroupMark="group",RectMark="rect",RuleMark="rule",SymbolMark="symbol",TextMark="text";function guideGroup(xt){return xt.type=GroupMark,xt.interactive=xt.interactive||!1,xt}function lookup(xt,$t){const Ct=(kt,Mt)=>value(xt[kt],value($t[kt],Mt));return Ct.isVertical=kt=>Vertical===value(xt.direction,$t.direction||(kt?$t.symbolDirection:$t.gradientDirection)),Ct.gradientLength=()=>value(xt.gradientLength,$t.gradientLength||$t.gradientWidth),Ct.gradientThickness=()=>value(xt.gradientThickness,$t.gradientThickness||$t.gradientHeight),Ct.entryColumns=()=>value(xt.columns,value($t.columns,+Ct.isVertical(!0))),Ct}function getEncoding(xt,$t){const Ct=$t&&($t.update&&$t.update[xt]||$t.enter&&$t.enter[xt]);return Ct&&Ct.signal?Ct:Ct?Ct.value:null}function getStyle(xt,$t,Ct){const kt=$t.config.style[Ct];return kt&&kt[xt]}function anchorExpr(xt,$t,Ct){return`item.anchor === '${Start}' ? ${xt} : item.anchor === '${End}' ? ${$t} : ${Ct}`}const alignExpr$1=anchorExpr($(Left),$(Right),$(Center));function tickBand(xt){const $t=xt("tickBand");let Ct=xt("tickOffset"),kt,Mt;return $t?$t.signal?(kt={signal:`(${$t.signal}) === 'extent' ? 1 : 0.5`},Mt={signal:`(${$t.signal}) === 'extent'`},isObject(Ct)||(Ct={signal:`(${$t.signal}) === 'extent' ? 0 : ${Ct}`})):$t==="extent"?(kt=1,Mt=!0,Ct=0):(kt=.5,Mt=!1):(kt=xt("bandPosition"),Mt=xt("tickExtra")),{extra:Mt,band:kt,offset:Ct}}function extendOffset(xt,$t){return $t?xt?isObject(xt)?Object.assign({},xt,{offset:extendOffset(xt.offset,$t)}):{value:xt,offset:$t}:$t:xt}function guideMark(xt,$t){return $t?(xt.name=$t.name,xt.style=$t.style||xt.style,xt.interactive=!!$t.interactive,xt.encode=extendEncode(xt.encode,$t,Skip)):xt.interactive=!1,xt}function legendGradient(xt,$t,Ct,kt){const Mt=lookup(xt,Ct),Ft=Mt.isVertical(),jt=Mt.gradientThickness(),Bt=Mt.gradientLength();let Vt,zt,Ht,Gt,qt;Ft?(zt=[0,1],Ht=[0,0],Gt=jt,qt=Bt):(zt=[0,0],Ht=[1,0],Gt=Bt,qt=jt);const Wt={enter:Vt={opacity:zero$1,x:zero$1,y:zero$1,width:encoder(Gt),height:encoder(qt)},update:extend({},Vt,{opacity:one,fill:{gradient:$t,start:zt,stop:Ht}}),exit:{opacity:zero$1}};return addEncoders(Wt,{stroke:Mt("gradientStrokeColor"),strokeWidth:Mt("gradientStrokeWidth")},{opacity:Mt("gradientOpacity")}),guideMark({type:RectMark,role:LegendGradientRole,encode:Wt},kt)}function legendGradientDiscrete(xt,$t,Ct,kt,Mt){const Ft=lookup(xt,Ct),jt=Ft.isVertical(),Bt=Ft.gradientThickness(),Vt=Ft.gradientLength();let zt,Ht,Gt,qt,Wt="";jt?(zt="y",Gt="y2",Ht="x",qt="width",Wt="1-"):(zt="x",Gt="x2",Ht="y",qt="height");const Yt={opacity:zero$1,fill:{scale:$t,field:Value}};Yt[zt]={signal:Wt+"datum."+Perc,mult:Vt},Yt[Ht]=zero$1,Yt[Gt]={signal:Wt+"datum."+Perc2,mult:Vt},Yt[qt]=encoder(Bt);const Kt={enter:Yt,update:extend({},Yt,{opacity:one}),exit:{opacity:zero$1}};return addEncoders(Kt,{stroke:Ft("gradientStrokeColor"),strokeWidth:Ft("gradientStrokeWidth")},{opacity:Ft("gradientOpacity")}),guideMark({type:RectMark,role:LegendBandRole,key:Value,from:Mt,encode:Kt},kt)}const alignExpr=`datum.${Perc}<=0?"${Left}":datum.${Perc}>=1?"${Right}":"${Center}"`,baselineExpr=`datum.${Perc}<=0?"${Bottom}":datum.${Perc}>=1?"${Top}":"${Middle}"`;function legendGradientLabels(xt,$t,Ct,kt){const Mt=lookup(xt,$t),Ft=Mt.isVertical(),jt=encoder(Mt.gradientThickness()),Bt=Mt.gradientLength();let Vt=Mt("labelOverlap"),zt,Ht,Gt,qt,Wt="";const Yt={enter:zt={opacity:zero$1},update:Ht={opacity:one,text:{field:Label}},exit:{opacity:zero$1}};return addEncoders(Yt,{fill:Mt("labelColor"),fillOpacity:Mt("labelOpacity"),font:Mt("labelFont"),fontSize:Mt("labelFontSize"),fontStyle:Mt("labelFontStyle"),fontWeight:Mt("labelFontWeight"),limit:value(xt.labelLimit,$t.gradientLabelLimit)}),Ft?(zt.align={value:"left"},zt.baseline=Ht.baseline={signal:baselineExpr},Gt="y",qt="x",Wt="1-"):(zt.align=Ht.align={signal:alignExpr},zt.baseline={value:"top"},Gt="x",qt="y"),zt[Gt]=Ht[Gt]={signal:Wt+"datum."+Perc,mult:Bt},zt[qt]=Ht[qt]=jt,jt.offset=value(xt.labelOffset,$t.gradientLabelOffset)||0,Vt=Vt?{separation:Mt("labelSeparation"),method:Vt,order:"datum."+Index}:void 0,guideMark({type:TextMark,role:LegendLabelRole,style:GuideLabelStyle,key:Value,from:kt,encode:Yt,overlap:Vt},Ct)}function legendSymbolGroups(xt,$t,Ct,kt,Mt){const Ft=lookup(xt,$t),jt=Ct.entries,Bt=!!(jt&&jt.interactive),Vt=jt?jt.name:void 0,zt=Ft("clipHeight"),Ht=Ft("symbolOffset"),Gt={data:"value"},qt=`(${Mt}) ? datum.${Offset} : datum.${Size}`,Wt=zt?encoder(zt):{field:Size},Yt=`datum.${Index}`,Kt=`max(1, ${Mt})`;let Xt,Qt,Jt,Zt,sn;Wt.mult=.5,Xt={enter:Qt={opacity:zero$1,x:{signal:qt,mult:.5,offset:Ht},y:Wt},update:Jt={opacity:one,x:Qt.x,y:Qt.y},exit:{opacity:zero$1}};let ln=null,dn=null;xt.fill||(ln=$t.symbolBaseFillColor,dn=$t.symbolBaseStrokeColor),addEncoders(Xt,{fill:Ft("symbolFillColor",ln),shape:Ft("symbolType"),size:Ft("symbolSize"),stroke:Ft("symbolStrokeColor",dn),strokeDash:Ft("symbolDash"),strokeDashOffset:Ft("symbolDashOffset"),strokeWidth:Ft("symbolStrokeWidth")},{opacity:Ft("symbolOpacity")}),LegendScales.forEach(yn=>{xt[yn]&&(Jt[yn]=Qt[yn]={scale:xt[yn],field:Value})});const hn=guideMark({type:SymbolMark,role:LegendSymbolRole,key:Value,from:Gt,clip:zt?!0:void 0,encode:Xt},Ct.symbols),cn=encoder(Ht);cn.offset=Ft("labelOffset"),Xt={enter:Qt={opacity:zero$1,x:{signal:qt,offset:cn},y:Wt},update:Jt={opacity:one,text:{field:Label},x:Qt.x,y:Qt.y},exit:{opacity:zero$1}},addEncoders(Xt,{align:Ft("labelAlign"),baseline:Ft("labelBaseline"),fill:Ft("labelColor"),fillOpacity:Ft("labelOpacity"),font:Ft("labelFont"),fontSize:Ft("labelFontSize"),fontStyle:Ft("labelFontStyle"),fontWeight:Ft("labelFontWeight"),limit:Ft("labelLimit")});const pn=guideMark({type:TextMark,role:LegendLabelRole,style:GuideLabelStyle,key:Value,from:Gt,encode:Xt},Ct.labels);return Xt={enter:{noBound:{value:!zt},width:zero$1,height:zt?encoder(zt):zero$1,opacity:zero$1},exit:{opacity:zero$1},update:Jt={opacity:one,row:{signal:null},column:{signal:null}}},Ft.isVertical(!0)?(Zt=`ceil(item.mark.items.length / ${Kt})`,Jt.row.signal=`${Yt}%${Zt}`,Jt.column.signal=`floor(${Yt} / ${Zt})`,sn={field:["row",Yt]}):(Jt.row.signal=`floor(${Yt} / ${Kt})`,Jt.column.signal=`${Yt} % ${Kt}`,sn={field:Yt}),Jt.column.signal=`(${Mt})?${Jt.column.signal}:${Yt}`,kt={facet:{data:kt,name:"value",groupby:Index}},guideGroup({role:ScopeRole,from:kt,encode:extendEncode(Xt,jt,Skip),marks:[hn,pn],name:Vt,interactive:Bt,sort:sn})}function legendSymbolLayout(xt,$t){const Ct=lookup(xt,$t);return{align:Ct("gridAlign"),columns:Ct.entryColumns(),center:{row:!0,column:!1},padding:{row:Ct("rowPadding"),column:Ct("columnPadding")}}}const isL='item.orient === "left"',isR='item.orient === "right"',isLR=`(${isL} || ${isR})`,isVG=`datum.vgrad && ${isLR}`,baseline$1=anchorExpr('"top"','"bottom"','"middle"'),alignFlip=anchorExpr('"right"','"left"','"center"'),exprAlign=`datum.vgrad && ${isR} ? (${alignFlip}) : (${isLR} && !(datum.vgrad && ${isL})) ? "left" : ${alignExpr$1}`,exprAnchor=`item._anchor || (${isLR} ? "middle" : "start")`,exprAngle=`${isVG} ? (${isL} ? -90 : 90) : 0`,exprBaseline=`${isLR} ? (datum.vgrad ? (${isR} ? "bottom" : "top") : ${baseline$1}) : "top"`;function legendTitle(xt,$t,Ct,kt){const Mt=lookup(xt,$t),Ft={enter:{opacity:zero$1},update:{opacity:one,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:zero$1}};return addEncoders(Ft,{orient:Mt("titleOrient"),_anchor:Mt("titleAnchor"),anchor:{signal:exprAnchor},angle:{signal:exprAngle},align:{signal:exprAlign},baseline:{signal:exprBaseline},text:xt.title,fill:Mt("titleColor"),fillOpacity:Mt("titleOpacity"),font:Mt("titleFont"),fontSize:Mt("titleFontSize"),fontStyle:Mt("titleFontStyle"),fontWeight:Mt("titleFontWeight"),limit:Mt("titleLimit"),lineHeight:Mt("titleLineHeight")},{align:Mt("titleAlign"),baseline:Mt("titleBaseline")}),guideMark({type:TextMark,role:LegendTitleRole,style:GuideTitleStyle,from:kt,encode:Ft},Ct)}function clip(xt,$t){let Ct;return isObject(xt)&&(xt.signal?Ct=xt.signal:xt.path?Ct="pathShape("+param(xt.path)+")":xt.sphere&&(Ct="geoShape("+param(xt.sphere)+', {type: "Sphere"})')),Ct?$t.signalRef(Ct):!!xt}function param(xt){return isObject(xt)&&xt.signal?xt.signal:$(xt)}function getRole(xt){const $t=xt.role||"";return $t.startsWith("axis")||$t.startsWith("legend")||$t.startsWith("title")?$t:xt.type===GroupMark?ScopeRole:$t||MarkRole}function definition(xt){return{marktype:xt.type,name:xt.name||void 0,role:xt.role||getRole(xt),zindex:+xt.zindex||void 0,aria:xt.aria,description:xt.description}}function interactive(xt,$t){return xt&&xt.signal?$t.signalRef(xt.signal):xt!==!1}function parseTransform(xt,$t){const Ct=definition$1(xt.type);Ct||error("Unrecognized transform type: "+$(xt.type));const kt=entry(Ct.type.toLowerCase(),null,parseParameters(Ct,xt,$t));return xt.signal&&$t.addSignal(xt.signal,$t.proxy(kt)),kt.metadata=Ct.metadata||{},kt}function parseParameters(xt,$t,Ct){const kt={},Mt=xt.params.length;for(let Ft=0;Ft<Mt;++Ft){const jt=xt.params[Ft];kt[jt.name]=parseParameter(jt,$t,Ct)}return kt}function parseParameter(xt,$t,Ct){const kt=xt.type,Mt=$t[xt.name];if(kt==="index")return parseIndexParameter(xt,$t,Ct);if(Mt===void 0){xt.required&&error("Missing required "+$($t.type)+" parameter: "+$(xt.name));return}else{if(kt==="param")return parseSubParameters(xt,$t,Ct);if(kt==="projection")return Ct.projectionRef($t[xt.name])}return xt.array&&!isSignal(Mt)?Mt.map(Ft=>parameterValue(xt,Ft,Ct)):parameterValue(xt,Mt,Ct)}function parameterValue(xt,$t,Ct){const kt=xt.type;if(isSignal($t))return isExpr(kt)?error("Expression references can not be signals."):isField(kt)?Ct.fieldRef($t):isCompare(kt)?Ct.compareRef($t):Ct.signalRef($t.signal);{const Mt=xt.expr||isField(kt);return Mt&&outerExpr($t)?Ct.exprRef($t.expr,$t.as):Mt&&outerField($t)?fieldRef$1($t.field,$t.as):isExpr(kt)?parser($t,Ct):isData(kt)?ref(Ct.getData($t).values):isField(kt)?fieldRef$1($t):isCompare(kt)?Ct.compareRef($t):$t}}function parseIndexParameter(xt,$t,Ct){return isString($t.from)||error('Lookup "from" parameter must be a string literal.'),Ct.getData($t.from).lookupRef(Ct,$t.key)}function parseSubParameters(xt,$t,Ct){const kt=$t[xt.name];return xt.array?(isArray(kt)||error("Expected an array of sub-parameters. Instead: "+$(kt)),kt.map(Mt=>parseSubParameter(xt,Mt,Ct))):parseSubParameter(xt,kt,Ct)}function parseSubParameter(xt,$t,Ct){const kt=xt.params.length;let Mt;for(let jt=0;jt<kt;++jt){Mt=xt.params[jt];for(const Bt in Mt.key)if(Mt.key[Bt]!==$t[Bt]){Mt=null;break}if(Mt)break}Mt||error("Unsupported parameter: "+$($t));const Ft=extend(parseParameters(Mt,$t,Ct),Mt.key);return ref(Ct.add(Params(Ft)))}const outerExpr=xt=>xt&&xt.expr,outerField=xt=>xt&&xt.field,isData=xt=>xt==="data",isExpr=xt=>xt==="expr",isField=xt=>xt==="field",isCompare=xt=>xt==="compare";function parseData$1(xt,$t,Ct){let kt,Mt,Ft,jt,Bt;return xt?(kt=xt.facet)&&($t||error("Only group marks can be faceted."),kt.field!=null?jt=Bt=getDataRef(kt,Ct):(xt.data?Bt=ref(Ct.getData(xt.data).aggregate):(Ft=parseTransform(extend({type:"aggregate",groupby:array$2(kt.groupby)},kt.aggregate),Ct),Ft.params.key=Ct.keyRef(kt.groupby),Ft.params.pulse=getDataRef(kt,Ct),jt=Bt=ref(Ct.add(Ft))),Mt=Ct.keyRef(kt.groupby,!0))):jt=ref(Ct.add(Collect(null,[{}]))),jt||(jt=getDataRef(xt,Ct)),{key:Mt,pulse:jt,parent:Bt}}function getDataRef(xt,$t){return xt.$ref?xt:xt.data&&xt.data.$ref?xt.data:ref($t.getData(xt.data).output)}function DataScope(xt,$t,Ct,kt,Mt){this.scope=xt,this.input=$t,this.output=Ct,this.values=kt,this.aggregate=Mt,this.index={}}DataScope.fromEntries=function(xt,$t){const Ct=$t.length,kt=$t[Ct-1],Mt=$t[Ct-2];let Ft=$t[0],jt=null,Bt=1;for(Ft&&Ft.type==="load"&&(Ft=$t[1]),xt.add($t[0]);Bt<Ct;++Bt)$t[Bt].params.pulse=ref($t[Bt-1]),xt.add($t[Bt]),$t[Bt].type==="aggregate"&&(jt=$t[Bt]);return new DataScope(xt,Ft,Mt,kt,jt)};function fieldKey(xt){return isString(xt)?xt:null}function addSortField(xt,$t,Ct){const kt=aggrField(Ct.op,Ct.field);let Mt;if($t.ops){for(let Ft=0,jt=$t.as.length;Ft<jt;++Ft)if($t.as[Ft]===kt)return}else $t.ops=["count"],$t.fields=[null],$t.as=["count"];Ct.op&&($t.ops.push((Mt=Ct.op.signal)?xt.signalRef(Mt):Ct.op),$t.fields.push(xt.fieldRef(Ct.field)),$t.as.push(kt))}function cache(xt,$t,Ct,kt,Mt,Ft,jt){const Bt=$t[Ct]||($t[Ct]={}),Vt=sortKey(Ft);let zt=fieldKey(Mt),Ht,Gt;if(zt!=null&&(xt=$t.scope,zt=zt+(Vt?"|"+Vt:""),Ht=Bt[zt]),!Ht){const qt=Ft?{field:keyFieldRef,pulse:$t.countsRef(xt,Mt,Ft)}:{field:xt.fieldRef(Mt),pulse:ref($t.output)};Vt&&(qt.sort=xt.sortRef(Ft)),Gt=xt.add(entry(kt,void 0,qt)),jt&&($t.index[Mt]=Gt),Ht=ref(Gt),zt!=null&&(Bt[zt]=Ht)}return Ht}DataScope.prototype={countsRef(xt,$t,Ct){const kt=this,Mt=kt.counts||(kt.counts={}),Ft=fieldKey($t);let jt,Bt,Vt;return Ft!=null&&(xt=kt.scope,jt=Mt[Ft]),jt?Ct&&Ct.field&&addSortField(xt,jt.agg.params,Ct):(Vt={groupby:xt.fieldRef($t,"key"),pulse:ref(kt.output)},Ct&&Ct.field&&addSortField(xt,Vt,Ct),Bt=xt.add(Aggregate(Vt)),jt=xt.add(Collect({pulse:ref(Bt)})),jt={agg:Bt,ref:ref(jt)},Ft!=null&&(Mt[Ft]=jt)),jt.ref},tuplesRef(){return ref(this.values)},extentRef(xt,$t){return cache(xt,this,"extent","extent",$t,!1)},domainRef(xt,$t){return cache(xt,this,"domain","values",$t,!1)},valuesRef(xt,$t,Ct){return cache(xt,this,"vals","values",$t,Ct||!0)},lookupRef(xt,$t){return cache(xt,this,"lookup","tupleindex",$t,!1)},indataRef(xt,$t){return cache(xt,this,"indata","tupleindex",$t,!0,!0)}};function parseFacet(xt,$t,Ct){const kt=xt.from.facet,Mt=kt.name,Ft=getDataRef(kt,$t);let jt;kt.name||error("Facet must have a name: "+$(kt)),kt.data||error("Facet must reference a data set: "+$(kt)),kt.field?jt=$t.add(PreFacet({field:$t.fieldRef(kt.field),pulse:Ft})):kt.groupby?jt=$t.add(Facet({key:$t.keyRef(kt.groupby),group:ref($t.proxy(Ct.parent)),pulse:Ft})):error("Facet must specify groupby or field: "+$(kt));const Bt=$t.fork(),Vt=Bt.add(Collect()),zt=Bt.add(Sieve({pulse:ref(Vt)}));Bt.addData(Mt,new DataScope(Bt,Vt,Vt,zt)),Bt.addSignal("parent",null),jt.params.subflow={$subflow:Bt.parse(xt).toRuntime()}}function parseSubflow(xt,$t,Ct){const kt=$t.add(PreFacet({pulse:Ct.pulse})),Mt=$t.fork();Mt.add(Sieve()),Mt.addSignal("parent",null),kt.params.subflow={$subflow:Mt.parse(xt).toRuntime()}}function parseTrigger(xt,$t,Ct){const kt=xt.remove,Mt=xt.insert,Ft=xt.toggle,jt=xt.modify,Bt=xt.values,Vt=$t.add(operator()),zt="if("+xt.trigger+',modify("'+Ct+'",'+[Mt,kt,Ft,jt,Bt].map(Gt=>Gt??"null").join(",")+"),0)",Ht=parser(zt,$t);Vt.update=Ht.$expr,Vt.params=Ht.$params}function parseMark(xt,$t){const Ct=getRole(xt),kt=xt.type===GroupMark,Mt=xt.from&&xt.from.facet,Ft=xt.overlap;let jt=xt.layout||Ct===ScopeRole||Ct===FrameRole,Bt,Vt,zt,Ht,Gt,qt,Wt;const Yt=Ct===MarkRole||jt||Mt,Kt=parseData$1(xt.from,kt,$t);Vt=$t.add(DataJoin({key:Kt.key||(xt.key?fieldRef$1(xt.key):void 0),pulse:Kt.pulse,clean:!kt}));const Xt=ref(Vt);Vt=zt=$t.add(Collect({pulse:Xt})),Vt=$t.add(Mark$1({markdef:definition(xt),interactive:interactive(xt.interactive,$t),clip:clip(xt.clip,$t),context:{$context:!0},groups:$t.lookup(),parent:$t.signals.parent?$t.signalRef("parent"):null,index:$t.markpath(),pulse:ref(Vt)}));const Qt=ref(Vt);Vt=Ht=$t.add(Encode(parseEncode(xt.encode,xt.type,Ct,xt.style,$t,{mod:!1,pulse:Qt}))),Vt.params.parent=$t.encode(),xt.transform&&xt.transform.forEach(dn=>{const hn=parseTransform(dn,$t),cn=hn.metadata;(cn.generates||cn.changes)&&error("Mark transforms should not generate new data."),cn.nomod||(Ht.params.mod=!0),hn.params.pulse=ref(Vt),$t.add(Vt=hn)}),xt.sort&&(Vt=$t.add(SortItems({sort:$t.compareRef(xt.sort),pulse:ref(Vt)})));const Jt=ref(Vt);(Mt||jt)&&(jt=$t.add(ViewLayout({layout:$t.objectProperty(xt.layout),legends:$t.legends,mark:Qt,pulse:Jt})),qt=ref(jt));const Zt=$t.add(Bound({mark:Qt,pulse:qt||Jt}));Wt=ref(Zt),kt&&(Yt&&(Bt=$t.operators,Bt.pop(),jt&&Bt.pop()),$t.pushState(Jt,qt||Wt,Xt),Mt?parseFacet(xt,$t,Kt):Yt?parseSubflow(xt,$t,Kt):$t.parse(xt),$t.popState(),Yt&&(jt&&Bt.push(jt),Bt.push(Zt))),Ft&&(Wt=parseOverlap(Ft,Wt,$t));const sn=$t.add(Render({pulse:Wt})),ln=$t.add(Sieve({pulse:ref(sn)},void 0,$t.parent()));xt.name!=null&&(Gt=xt.name,$t.addData(Gt,new DataScope($t,zt,sn,ln)),xt.on&&xt.on.forEach(dn=>{(dn.insert||dn.remove||dn.toggle)&&error("Marks only support modify triggers."),parseTrigger(dn,$t,Gt)}))}function parseOverlap(xt,$t,Ct){const kt=xt.method,Mt=xt.bound,Ft=xt.separation,jt={separation:isSignal(Ft)?Ct.signalRef(Ft.signal):Ft,method:isSignal(kt)?Ct.signalRef(kt.signal):kt,pulse:$t};if(xt.order&&(jt.sort=Ct.compareRef({field:xt.order})),Mt){const Bt=Mt.tolerance;jt.boundTolerance=isSignal(Bt)?Ct.signalRef(Bt.signal):+Bt,jt.boundScale=Ct.scaleRef(Mt.scale),jt.boundOrient=Mt.orient}return ref(Ct.add(Overlap(jt)))}function parseLegend$1(xt,$t){const Ct=$t.config.legend,kt=xt.encode||{},Mt=lookup(xt,Ct),Ft=kt.legend||{},jt=Ft.name||void 0,Bt=Ft.interactive,Vt=Ft.style,zt={};let Ht=0,Gt,qt,Wt;LegendScales.forEach(Zt=>xt[Zt]?(zt[Zt]=xt[Zt],Ht=Ht||xt[Zt]):0),Ht||error("Missing valid scale for legend.");const Yt=legendType(xt,$t.scaleType(Ht)),Kt={title:xt.title!=null,scales:zt,type:Yt,vgrad:Yt!=="symbol"&&Mt.isVertical()},Xt=ref($t.add(Collect(null,[Kt]))),Qt={enter:{x:{value:0},y:{value:0}}},Jt=ref($t.add(LegendEntries(qt={type:Yt,scale:$t.scaleRef(Ht),count:$t.objectProperty(Mt("tickCount")),limit:$t.property(Mt("symbolLimit")),values:$t.objectProperty(xt.values),minstep:$t.property(xt.tickMinStep),formatType:$t.property(xt.formatType),formatSpecifier:$t.property(xt.format)})));return Yt===Gradient?(Wt=[legendGradient(xt,Ht,Ct,kt.gradient),legendGradientLabels(xt,Ct,kt.labels,Jt)],qt.count=qt.count||$t.signalRef(`max(2,2*floor((${deref(Mt.gradientLength())})/100))`)):Yt===Discrete?Wt=[legendGradientDiscrete(xt,Ht,Ct,kt.gradient,Jt),legendGradientLabels(xt,Ct,kt.labels,Jt)]:(Gt=legendSymbolLayout(xt,Ct),Wt=[legendSymbolGroups(xt,Ct,kt,Jt,deref(Gt.columns))],qt.size=sizeExpression(xt,$t,Wt[0].marks)),Wt=[guideGroup({role:LegendEntryRole,from:Xt,encode:Qt,marks:Wt,layout:Gt,interactive:Bt})],Kt.title&&Wt.push(legendTitle(xt,Ct,kt.title,Xt)),parseMark(guideGroup({role:LegendRole,from:Xt,encode:extendEncode(buildLegendEncode(Mt,xt,Ct),Ft,Skip),marks:Wt,aria:Mt("aria"),description:Mt("description"),zindex:Mt("zindex"),name:jt,interactive:Bt,style:Vt}),$t)}function legendType(xt,$t){let Ct=xt.type||Symbols;return!xt.type&&scaleCount(xt)===1&&(xt.fill||xt.stroke)&&(Ct=isContinuous$1($t)?Gradient:isDiscretizing$1($t)?Discrete:Symbols),Ct!==Gradient?Ct:isDiscretizing$1($t)?Discrete:Gradient}function scaleCount(xt){return LegendScales.reduce(($t,Ct)=>$t+(xt[Ct]?1:0),0)}function buildLegendEncode(xt,$t,Ct){const kt={enter:{},update:{}};return addEncoders(kt,{orient:xt("orient"),offset:xt("offset"),padding:xt("padding"),titlePadding:xt("titlePadding"),cornerRadius:xt("cornerRadius"),fill:xt("fillColor"),stroke:xt("strokeColor"),strokeWidth:Ct.strokeWidth,strokeDash:Ct.strokeDash,x:xt("legendX"),y:xt("legendY"),format:$t.format,formatType:$t.formatType}),kt}function sizeExpression(xt,$t,Ct){const kt=deref(getChannel("size",xt,Ct)),Mt=deref(getChannel("strokeWidth",xt,Ct)),Ft=deref(getFontSize(Ct[1].encode,$t,GuideLabelStyle));return parser(`max(ceil(sqrt(${kt})+${Mt}),${Ft})`,$t)}function getChannel(xt,$t,Ct){return $t[xt]?`scale("${$t[xt]}",datum)`:getEncoding(xt,Ct[0].encode)}function getFontSize(xt,$t,Ct){return getEncoding("fontSize",xt)||getStyle("fontSize",$t,Ct)}const angleExpr=`item.orient==="${Left}"?-90:item.orient==="${Right}"?90:0`;function parseTitle(xt,$t){xt=isString(xt)?{text:xt}:xt;const Ct=lookup(xt,$t.config.title),kt=xt.encode||{},Mt=kt.group||{},Ft=Mt.name||void 0,jt=Mt.interactive,Bt=Mt.style,Vt=[],zt={},Ht=ref($t.add(Collect(null,[zt])));return Vt.push(buildTitle(xt,Ct,titleEncode(xt),Ht)),xt.subtitle&&Vt.push(buildSubTitle(xt,Ct,kt.subtitle,Ht)),parseMark(guideGroup({role:TitleRole,from:Ht,encode:groupEncode(Ct,Mt),marks:Vt,aria:Ct("aria"),description:Ct("description"),zindex:Ct("zindex"),name:Ft,interactive:jt,style:Bt}),$t)}function titleEncode(xt){const $t=xt.encode;return $t&&$t.title||extend({name:xt.name,interactive:xt.interactive,style:xt.style},$t)}function groupEncode(xt,$t){const Ct={enter:{},update:{}};return addEncoders(Ct,{orient:xt("orient"),anchor:xt("anchor"),align:{signal:alignExpr$1},angle:{signal:angleExpr},limit:xt("limit"),frame:xt("frame"),offset:xt("offset")||0,padding:xt("subtitlePadding")}),extendEncode(Ct,$t,Skip)}function buildTitle(xt,$t,Ct,kt){const Mt={value:0},Ft=xt.text,jt={enter:{opacity:Mt},update:{opacity:{value:1}},exit:{opacity:Mt}};return addEncoders(jt,{text:Ft,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:$t("dx"),dy:$t("dy"),fill:$t("color"),font:$t("font"),fontSize:$t("fontSize"),fontStyle:$t("fontStyle"),fontWeight:$t("fontWeight"),lineHeight:$t("lineHeight")},{align:$t("align"),angle:$t("angle"),baseline:$t("baseline")}),guideMark({type:TextMark,role:TitleTextRole,style:GroupTitleStyle,from:kt,encode:jt},Ct)}function buildSubTitle(xt,$t,Ct,kt){const Mt={value:0},Ft=xt.subtitle,jt={enter:{opacity:Mt},update:{opacity:{value:1}},exit:{opacity:Mt}};return addEncoders(jt,{text:Ft,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:$t("dx"),dy:$t("dy"),fill:$t("subtitleColor"),font:$t("subtitleFont"),fontSize:$t("subtitleFontSize"),fontStyle:$t("subtitleFontStyle"),fontWeight:$t("subtitleFontWeight"),lineHeight:$t("subtitleLineHeight")},{align:$t("align"),angle:$t("angle"),baseline:$t("baseline")}),guideMark({type:TextMark,role:TitleSubtitleRole,style:GroupSubtitleStyle,from:kt,encode:jt},Ct)}function parseData$2(xt,$t){const Ct=[];xt.transform&&xt.transform.forEach(kt=>{Ct.push(parseTransform(kt,$t))}),xt.on&&xt.on.forEach(kt=>{parseTrigger(kt,$t,xt.name)}),$t.addDataPipeline(xt.name,analyze(xt,$t,Ct))}function analyze(xt,$t,Ct){const kt=[];let Mt=null,Ft=!1,jt=!1,Bt,Vt,zt,Ht,Gt;for(xt.values?isSignal(xt.values)||hasSignal(xt.format)?(kt.push(load($t,xt)),kt.push(Mt=collect())):kt.push(Mt=collect({$ingest:xt.values,$format:xt.format})):xt.url?hasSignal(xt.url)||hasSignal(xt.format)?(kt.push(load($t,xt)),kt.push(Mt=collect())):kt.push(Mt=collect({$request:xt.url,$format:xt.format})):xt.source&&(Mt=Bt=array$2(xt.source).map(qt=>ref($t.getData(qt).output)),kt.push(null)),Vt=0,zt=Ct.length;Vt<zt;++Vt)Ht=Ct[Vt],Gt=Ht.metadata,!Mt&&!Gt.source&&kt.push(Mt=collect()),kt.push(Ht),Gt.generates&&(jt=!0),Gt.modifies&&!jt&&(Ft=!0),Gt.source?Mt=Ht:Gt.changes&&(Mt=null);return Bt&&(zt=Bt.length-1,kt[0]=Relay({derive:Ft,pulse:zt?Bt:Bt[0]}),(Ft||zt)&&kt.splice(1,0,collect())),Mt||kt.push(collect()),kt.push(Sieve({})),kt}function collect(xt){const $t=Collect({},xt);return $t.metadata={source:!0},$t}function load(xt,$t){return Load({url:$t.url?xt.property($t.url):void 0,async:$t.async?xt.property($t.async):void 0,values:$t.values?xt.property($t.values):void 0,format:xt.objectProperty($t.format)})}const isX=xt=>xt===Bottom||xt===Top,getSign=(xt,$t,Ct)=>isSignal(xt)?ifLeftTopExpr(xt.signal,$t,Ct):xt===Left||xt===Top?$t:Ct,ifX=(xt,$t,Ct)=>isSignal(xt)?ifXEnc(xt.signal,$t,Ct):isX(xt)?$t:Ct,ifY=(xt,$t,Ct)=>isSignal(xt)?ifYEnc(xt.signal,$t,Ct):isX(xt)?Ct:$t,ifTop=(xt,$t,Ct)=>isSignal(xt)?ifTopExpr(xt.signal,$t,Ct):xt===Top?{value:$t}:{value:Ct},ifRight=(xt,$t,Ct)=>isSignal(xt)?ifRightExpr(xt.signal,$t,Ct):xt===Right?{value:$t}:{value:Ct},ifXEnc=(xt,$t,Ct)=>ifEnc(`${xt} === '${Top}' || ${xt} === '${Bottom}'`,$t,Ct),ifYEnc=(xt,$t,Ct)=>ifEnc(`${xt} !== '${Top}' && ${xt} !== '${Bottom}'`,$t,Ct),ifLeftTopExpr=(xt,$t,Ct)=>ifExpr(`${xt} === '${Left}' || ${xt} === '${Top}'`,$t,Ct),ifTopExpr=(xt,$t,Ct)=>ifExpr(`${xt} === '${Top}'`,$t,Ct),ifRightExpr=(xt,$t,Ct)=>ifExpr(`${xt} === '${Right}'`,$t,Ct),ifEnc=(xt,$t,Ct)=>($t=$t!=null?encoder($t):$t,Ct=Ct!=null?encoder(Ct):Ct,isSimple($t)&&isSimple(Ct)?($t=$t?$t.signal||$($t.value):null,Ct=Ct?Ct.signal||$(Ct.value):null,{signal:`${xt} ? (${$t}) : (${Ct})`}):[extend({test:xt},$t)].concat(Ct||[])),isSimple=xt=>xt==null||Object.keys(xt).length===1,ifExpr=(xt,$t,Ct)=>({signal:`${xt} ? (${toExpr($t)}) : (${toExpr(Ct)})`}),ifOrient=(xt,$t,Ct,kt,Mt)=>({signal:(kt!=null?`${xt} === '${Left}' ? (${toExpr(kt)}) : `:"")+(Ct!=null?`${xt} === '${Bottom}' ? (${toExpr(Ct)}) : `:"")+(Mt!=null?`${xt} === '${Right}' ? (${toExpr(Mt)}) : `:"")+($t!=null?`${xt} === '${Top}' ? (${toExpr($t)}) : `:"")+"(null)"}),toExpr=xt=>isSignal(xt)?xt.signal:xt==null?null:$(xt),mult=(xt,$t)=>$t===0?0:isSignal(xt)?{signal:`(${xt.signal}) * ${$t}`}:{value:xt*$t},patch=(xt,$t)=>{const Ct=xt.signal;return Ct&&Ct.endsWith("(null)")?{signal:Ct.slice(0,-6)+$t.signal}:xt};function fallback(xt,$t,Ct,kt){let Mt;if($t&&has$1($t,xt))return $t[xt];if(has$1(Ct,xt))return Ct[xt];if(xt.startsWith("title")){switch(xt){case"titleColor":Mt="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":Mt=xt[5].toLowerCase()+xt.slice(6)}return kt[GuideTitleStyle][Mt]}else if(xt.startsWith("label")){switch(xt){case"labelColor":Mt="fill";break;case"labelFont":case"labelFontSize":Mt=xt[5].toLowerCase()+xt.slice(6)}return kt[GuideLabelStyle][Mt]}return null}function keys$1(xt){const $t={};for(const Ct of xt)if(Ct)for(const kt in Ct)$t[kt]=1;return Object.keys($t)}function axisConfig(xt,$t){var Ct=$t.config,kt=Ct.style,Mt=Ct.axis,Ft=$t.scaleType(xt.scale)==="band"&&Ct.axisBand,jt=xt.orient,Bt,Vt,zt;if(isSignal(jt)){const Gt=keys$1([Ct.axisX,Ct.axisY]),qt=keys$1([Ct.axisTop,Ct.axisBottom,Ct.axisLeft,Ct.axisRight]);Bt={};for(zt of Gt)Bt[zt]=ifX(jt,fallback(zt,Ct.axisX,Mt,kt),fallback(zt,Ct.axisY,Mt,kt));Vt={};for(zt of qt)Vt[zt]=ifOrient(jt.signal,fallback(zt,Ct.axisTop,Mt,kt),fallback(zt,Ct.axisBottom,Mt,kt),fallback(zt,Ct.axisLeft,Mt,kt),fallback(zt,Ct.axisRight,Mt,kt))}else Bt=jt===Top||jt===Bottom?Ct.axisX:Ct.axisY,Vt=Ct["axis"+jt[0].toUpperCase()+jt.slice(1)];return Bt||Vt||Ft?extend({},Mt,Bt,Vt,Ft):Mt}function axisDomain(xt,$t,Ct,kt){const Mt=lookup(xt,$t),Ft=xt.orient;let jt,Bt;const Vt={enter:jt={opacity:zero$1},update:Bt={opacity:one},exit:{opacity:zero$1}};addEncoders(Vt,{stroke:Mt("domainColor"),strokeCap:Mt("domainCap"),strokeDash:Mt("domainDash"),strokeDashOffset:Mt("domainDashOffset"),strokeWidth:Mt("domainWidth"),strokeOpacity:Mt("domainOpacity")});const zt=position(xt,0),Ht=position(xt,1);return jt.x=Bt.x=ifX(Ft,zt,zero$1),jt.x2=Bt.x2=ifX(Ft,Ht),jt.y=Bt.y=ifY(Ft,zt,zero$1),jt.y2=Bt.y2=ifY(Ft,Ht),guideMark({type:RuleMark,role:AxisDomainRole,from:kt,encode:Vt},Ct)}function position(xt,$t){return{scale:xt.scale,range:$t}}function axisGrid(xt,$t,Ct,kt,Mt){const Ft=lookup(xt,$t),jt=xt.orient,Bt=xt.gridScale,Vt=getSign(jt,1,-1),zt=offsetValue(xt.offset,Vt);let Ht,Gt,qt;const Wt={enter:Ht={opacity:zero$1},update:qt={opacity:one},exit:Gt={opacity:zero$1}};addEncoders(Wt,{stroke:Ft("gridColor"),strokeCap:Ft("gridCap"),strokeDash:Ft("gridDash"),strokeDashOffset:Ft("gridDashOffset"),strokeOpacity:Ft("gridOpacity"),strokeWidth:Ft("gridWidth")});const Yt={scale:xt.scale,field:Value,band:Mt.band,extra:Mt.extra,offset:Mt.offset,round:Ft("tickRound")},Kt=ifX(jt,{signal:"height"},{signal:"width"}),Xt=Bt?{scale:Bt,range:0,mult:Vt,offset:zt}:{value:0,offset:zt},Qt=Bt?{scale:Bt,range:1,mult:Vt,offset:zt}:extend(Kt,{mult:Vt,offset:zt});return Ht.x=qt.x=ifX(jt,Yt,Xt),Ht.y=qt.y=ifY(jt,Yt,Xt),Ht.x2=qt.x2=ifY(jt,Qt),Ht.y2=qt.y2=ifX(jt,Qt),Gt.x=ifX(jt,Yt),Gt.y=ifY(jt,Yt),guideMark({type:RuleMark,role:AxisGridRole,key:Value,from:kt,encode:Wt},Ct)}function offsetValue(xt,$t){if($t!==1)if(!isObject(xt))xt=isSignal($t)?{signal:`(${$t.signal}) * (${xt||0})`}:$t*(xt||0);else{let Ct=xt=extend({},xt);for(;Ct.mult!=null;)if(isObject(Ct.mult))Ct=Ct.mult=extend({},Ct.mult);else return Ct.mult=isSignal($t)?{signal:`(${Ct.mult}) * (${$t.signal})`}:Ct.mult*$t,xt;Ct.mult=$t}return xt}function axisTicks(xt,$t,Ct,kt,Mt,Ft){const jt=lookup(xt,$t),Bt=xt.orient,Vt=getSign(Bt,-1,1);let zt,Ht,Gt;const qt={enter:zt={opacity:zero$1},update:Gt={opacity:one},exit:Ht={opacity:zero$1}};addEncoders(qt,{stroke:jt("tickColor"),strokeCap:jt("tickCap"),strokeDash:jt("tickDash"),strokeDashOffset:jt("tickDashOffset"),strokeOpacity:jt("tickOpacity"),strokeWidth:jt("tickWidth")});const Wt=encoder(Mt);Wt.mult=Vt;const Yt={scale:xt.scale,field:Value,band:Ft.band,extra:Ft.extra,offset:Ft.offset,round:jt("tickRound")};return Gt.y=zt.y=ifX(Bt,zero$1,Yt),Gt.y2=zt.y2=ifX(Bt,Wt),Ht.x=ifX(Bt,Yt),Gt.x=zt.x=ifY(Bt,zero$1,Yt),Gt.x2=zt.x2=ifY(Bt,Wt),Ht.y=ifY(Bt,Yt),guideMark({type:RuleMark,role:AxisTickRole,key:Value,from:kt,encode:qt},Ct)}function flushExpr(xt,$t,Ct,kt,Mt){return{signal:'flush(range("'+xt+'"), scale("'+xt+'", datum.value), '+$t+","+Ct+","+kt+","+Mt+")"}}function axisLabels(xt,$t,Ct,kt,Mt,Ft){const jt=lookup(xt,$t),Bt=xt.orient,Vt=xt.scale,zt=getSign(Bt,-1,1),Ht=deref(jt("labelFlush")),Gt=deref(jt("labelFlushOffset")),qt=jt("labelAlign"),Wt=jt("labelBaseline");let Yt=Ht===0||!!Ht,Kt;const Xt=encoder(Mt);Xt.mult=zt,Xt.offset=encoder(jt("labelPadding")||0),Xt.offset.mult=zt;const Qt={scale:Vt,field:Value,band:.5,offset:extendOffset(Ft.offset,jt("labelOffset"))},Jt=ifX(Bt,Yt?flushExpr(Vt,Ht,'"left"','"right"','"center"'):{value:"center"},ifRight(Bt,"left","right")),Zt=ifX(Bt,ifTop(Bt,"bottom","top"),Yt?flushExpr(Vt,Ht,'"top"','"bottom"','"middle"'):{value:"middle"}),sn=flushExpr(Vt,Ht,`-(${Gt})`,Gt,0);Yt=Yt&&Gt;const ln={opacity:zero$1,x:ifX(Bt,Qt,Xt),y:ifY(Bt,Qt,Xt)},dn={enter:ln,update:Kt={opacity:one,text:{field:Label},x:ln.x,y:ln.y,align:Jt,baseline:Zt},exit:{opacity:zero$1,x:ln.x,y:ln.y}};addEncoders(dn,{dx:!qt&&Yt?ifX(Bt,sn):null,dy:!Wt&&Yt?ifY(Bt,sn):null}),addEncoders(dn,{angle:jt("labelAngle"),fill:jt("labelColor"),fillOpacity:jt("labelOpacity"),font:jt("labelFont"),fontSize:jt("labelFontSize"),fontWeight:jt("labelFontWeight"),fontStyle:jt("labelFontStyle"),limit:jt("labelLimit"),lineHeight:jt("labelLineHeight")},{align:qt,baseline:Wt});const hn=jt("labelBound");let cn=jt("labelOverlap");return cn=cn||hn?{separation:jt("labelSeparation"),method:cn,order:"datum.index",bound:hn?{scale:Vt,orient:Bt,tolerance:hn}:null}:void 0,Kt.align!==Jt&&(Kt.align=patch(Kt.align,Jt)),Kt.baseline!==Zt&&(Kt.baseline=patch(Kt.baseline,Zt)),guideMark({type:TextMark,role:AxisLabelRole,style:GuideLabelStyle,key:Value,from:kt,encode:dn,overlap:cn},Ct)}function axisTitle(xt,$t,Ct,kt){const Mt=lookup(xt,$t),Ft=xt.orient,jt=getSign(Ft,-1,1);let Bt,Vt;const zt={enter:Bt={opacity:zero$1,anchor:encoder(Mt("titleAnchor",null)),align:{signal:alignExpr$1}},update:Vt=extend({},Bt,{opacity:one,text:encoder(xt.title)}),exit:{opacity:zero$1}},Ht={signal:`lerp(range("${xt.scale}"), ${anchorExpr(0,1,.5)})`};return Vt.x=ifX(Ft,Ht),Vt.y=ifY(Ft,Ht),Bt.angle=ifX(Ft,zero$1,mult(jt,90)),Bt.baseline=ifX(Ft,ifTop(Ft,Bottom,Top),{value:Bottom}),Vt.angle=Bt.angle,Vt.baseline=Bt.baseline,addEncoders(zt,{fill:Mt("titleColor"),fillOpacity:Mt("titleOpacity"),font:Mt("titleFont"),fontSize:Mt("titleFontSize"),fontStyle:Mt("titleFontStyle"),fontWeight:Mt("titleFontWeight"),limit:Mt("titleLimit"),lineHeight:Mt("titleLineHeight")},{align:Mt("titleAlign"),angle:Mt("titleAngle"),baseline:Mt("titleBaseline")}),autoLayout(Mt,Ft,zt,Ct),zt.update.align=patch(zt.update.align,Bt.align),zt.update.angle=patch(zt.update.angle,Bt.angle),zt.update.baseline=patch(zt.update.baseline,Bt.baseline),guideMark({type:TextMark,role:AxisTitleRole,style:GuideTitleStyle,from:kt,encode:zt},Ct)}function autoLayout(xt,$t,Ct,kt){const Mt=(Bt,Vt)=>Bt!=null?(Ct.update[Vt]=patch(encoder(Bt),Ct.update[Vt]),!1):!has(Vt,kt),Ft=Mt(xt("titleX"),"x"),jt=Mt(xt("titleY"),"y");Ct.enter.auto=jt===Ft?encoder(jt):ifX($t,encoder(jt),encoder(Ft))}function parseAxis$1(xt,$t){const Ct=axisConfig(xt,$t),kt=xt.encode||{},Mt=kt.axis||{},Ft=Mt.name||void 0,jt=Mt.interactive,Bt=Mt.style,Vt=lookup(xt,Ct),zt=tickBand(Vt),Ht={scale:xt.scale,ticks:!!Vt("ticks"),labels:!!Vt("labels"),grid:!!Vt("grid"),domain:!!Vt("domain"),title:xt.title!=null},Gt=ref($t.add(Collect({},[Ht]))),qt=ref($t.add(AxisTicks({scale:$t.scaleRef(xt.scale),extra:$t.property(zt.extra),count:$t.objectProperty(xt.tickCount),values:$t.objectProperty(xt.values),minstep:$t.property(xt.tickMinStep),formatType:$t.property(xt.formatType),formatSpecifier:$t.property(xt.format)}))),Wt=[];let Yt;return Ht.grid&&Wt.push(axisGrid(xt,Ct,kt.grid,qt,zt)),Ht.ticks&&(Yt=Vt("tickSize"),Wt.push(axisTicks(xt,Ct,kt.ticks,qt,Yt,zt))),Ht.labels&&(Yt=Ht.ticks?Yt:0,Wt.push(axisLabels(xt,Ct,kt.labels,qt,Yt,zt))),Ht.domain&&Wt.push(axisDomain(xt,Ct,kt.domain,Gt)),Ht.title&&Wt.push(axisTitle(xt,Ct,kt.title,Gt)),parseMark(guideGroup({role:AxisRole,from:Gt,encode:extendEncode(buildAxisEncode(Vt,xt),Mt,Skip),marks:Wt,aria:Vt("aria"),description:Vt("description"),zindex:Vt("zindex"),name:Ft,interactive:jt,style:Bt}),$t)}function buildAxisEncode(xt,$t){const Ct={enter:{},update:{}};return addEncoders(Ct,{orient:xt("orient"),offset:xt("offset")||0,position:value($t.position,0),titlePadding:xt("titlePadding"),minExtent:xt("minExtent"),maxExtent:xt("maxExtent"),range:{signal:`abs(span(range("${$t.scale}")))`},translate:xt("translate"),format:$t.format,formatType:$t.formatType}),Ct}function parseScope(xt,$t,Ct){const kt=array$2(xt.signals),Mt=array$2(xt.scales);return Ct||kt.forEach(Ft=>parseSignal(Ft,$t)),array$2(xt.projections).forEach(Ft=>parseProjection$1(Ft,$t)),Mt.forEach(Ft=>initScale(Ft,$t)),array$2(xt.data).forEach(Ft=>parseData$2(Ft,$t)),Mt.forEach(Ft=>parseScale(Ft,$t)),(Ct||kt).forEach(Ft=>parseSignalUpdates(Ft,$t)),array$2(xt.axes).forEach(Ft=>parseAxis$1(Ft,$t)),array$2(xt.marks).forEach(Ft=>parseMark(Ft,$t)),array$2(xt.legends).forEach(Ft=>parseLegend$1(Ft,$t)),xt.title&&parseTitle(xt.title,$t),$t.parseLambdas(),$t}const rootEncode=xt=>extendEncode({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},xt);function parseView(xt,$t){const Ct=$t.config,kt=ref($t.root=$t.add(operator())),Mt=collectSignals(xt,Ct);Mt.forEach(zt=>parseSignal(zt,$t)),$t.description=xt.description||Ct.description,$t.eventConfig=Ct.events,$t.legends=$t.objectProperty(Ct.legend&&Ct.legend.layout),$t.locale=Ct.locale;const Ft=$t.add(Collect()),jt=$t.add(Encode(parseEncode(rootEncode(xt.encode),GroupMark,FrameRole,xt.style,$t,{pulse:ref(Ft)}))),Bt=$t.add(ViewLayout({layout:$t.objectProperty(xt.layout),legends:$t.legends,autosize:$t.signalRef("autosize"),mark:kt,pulse:ref(jt)}));$t.operators.pop(),$t.pushState(ref(jt),ref(Bt),null),parseScope(xt,$t,Mt),$t.operators.push(Bt);let Vt=$t.add(Bound({mark:kt,pulse:ref(Bt)}));return Vt=$t.add(Render({pulse:ref(Vt)})),Vt=$t.add(Sieve({pulse:ref(Vt)})),$t.addData("root",new DataScope($t,Ft,Ft,Vt)),$t}function signalObject(xt,$t){return $t&&$t.signal?{name:xt,update:$t.signal}:{name:xt,value:$t}}function collectSignals(xt,$t){const Ct=jt=>value(xt[jt],$t[jt]),kt=[signalObject("background",Ct("background")),signalObject("autosize",parseAutosize(Ct("autosize"))),signalObject("padding",parsePadding(Ct("padding"))),signalObject("width",Ct("width")||0),signalObject("height",Ct("height")||0)],Mt=kt.reduce((jt,Bt)=>(jt[Bt.name]=Bt,jt),{}),Ft={};return array$2(xt.signals).forEach(jt=>{has$1(Mt,jt.name)?jt=extend(Mt[jt.name],jt):kt.push(jt),Ft[jt.name]=jt}),array$2($t.signals).forEach(jt=>{!has$1(Ft,jt.name)&&!has$1(Mt,jt.name)&&kt.push(jt)}),kt}function Scope(xt,$t){this.config=xt||{},this.options=$t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Subscope(xt){this.config=xt.config,this.options=xt.options,this.legends=xt.legends,this.field=Object.create(xt.field),this.signals=Object.create(xt.signals),this.lambdas=Object.create(xt.lambdas),this.scales=Object.create(xt.scales),this.events=Object.create(xt.events),this.data=Object.create(xt.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++xt._nextsub[0],this._nextsub=xt._nextsub,this._parent=xt._parent.slice(),this._encode=xt._encode.slice(),this._lookup=xt._lookup.slice(),this._markpath=xt._markpath}Scope.prototype=Subscope.prototype={parse(xt){return parseScope(xt,this)},fork(){return new Subscope(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(xt){return this.operators.push(xt),xt.id=this.id(),xt.refs&&(xt.refs.forEach($t=>{$t.$ref=xt.id}),xt.refs=null),xt},proxy(xt){const $t=xt instanceof Entry$1?ref(xt):xt;return this.add(Proxy$1({value:$t}))},addStream(xt){return this.streams.push(xt),xt.id=this.id(),xt},addUpdate(xt){return this.updates.push(xt),xt},finish(){let xt,$t;this.root&&(this.root.root=!0);for(xt in this.signals)this.signals[xt].signal=xt;for(xt in this.scales)this.scales[xt].scale=xt;function Ct(kt,Mt,Ft){let jt,Bt;kt&&(jt=kt.data||(kt.data={}),Bt=jt[Mt]||(jt[Mt]=[]),Bt.push(Ft))}for(xt in this.data){$t=this.data[xt],Ct($t.input,xt,"input"),Ct($t.output,xt,"output"),Ct($t.values,xt,"values");for(const kt in $t.index)Ct($t.index[kt],xt,"index:"+kt)}return this},pushState(xt,$t,Ct){this._encode.push(ref(this.add(Sieve({pulse:xt})))),this._parent.push($t),this._lookup.push(Ct?ref(this.proxy(Ct)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return peek$1(this._parent)},encode(){return peek$1(this._encode)},lookup(){return peek$1(this._lookup)},markpath(){const xt=this._markpath;return++xt[xt.length-1]},fieldRef(xt,$t){if(isString(xt))return fieldRef$1(xt,$t);xt.signal||error("Unsupported field reference: "+$(xt));const Ct=xt.signal;let kt=this.field[Ct];if(!kt){const Mt={name:this.signalRef(Ct)};$t&&(Mt.as=$t),this.field[Ct]=kt=ref(this.add(Field(Mt)))}return kt},compareRef(xt){let $t=!1;const Ct=Ft=>isSignal(Ft)?($t=!0,this.signalRef(Ft.signal)):isExpr$1(Ft)?($t=!0,this.exprRef(Ft.expr)):Ft,kt=array$2(xt.field).map(Ct),Mt=array$2(xt.order).map(Ct);return $t?ref(this.add(Compare({fields:kt,orders:Mt}))):compareRef(kt,Mt)},keyRef(xt,$t){let Ct=!1;const kt=Ft=>isSignal(Ft)?(Ct=!0,ref(Mt[Ft.signal])):Ft,Mt=this.signals;return xt=array$2(xt).map(kt),Ct?ref(this.add(Key({fields:xt,flat:$t}))):keyRef(xt,$t)},sortRef(xt){if(!xt)return xt;const $t=aggrField(xt.op,xt.field),Ct=xt.order||Ascending;return Ct.signal?ref(this.add(Compare({fields:$t,orders:this.signalRef(Ct.signal)}))):compareRef($t,Ct)},event(xt,$t){const Ct=xt+":"+$t;if(!this.events[Ct]){const kt=this.id();this.streams.push({id:kt,source:xt,type:$t}),this.events[Ct]=kt}return this.events[Ct]},hasOwnSignal(xt){return has$1(this.signals,xt)},addSignal(xt,$t){this.hasOwnSignal(xt)&&error("Duplicate signal name: "+$(xt));const Ct=$t instanceof Entry$1?$t:this.add(operator($t));return this.signals[xt]=Ct},getSignal(xt){return this.signals[xt]||error("Unrecognized signal name: "+$(xt)),this.signals[xt]},signalRef(xt){return this.signals[xt]?ref(this.signals[xt]):(has$1(this.lambdas,xt)||(this.lambdas[xt]=this.add(operator(null))),ref(this.lambdas[xt]))},parseLambdas(){const xt=Object.keys(this.lambdas);for(let $t=0,Ct=xt.length;$t<Ct;++$t){const kt=xt[$t],Mt=parser(kt,this),Ft=this.lambdas[kt];Ft.params=Mt.$params,Ft.update=Mt.$expr}},property(xt){return xt&&xt.signal?this.signalRef(xt.signal):xt},objectProperty(xt){return!xt||!isObject(xt)?xt:this.signalRef(xt.signal||propertyLambda(xt))},exprRef(xt,$t){const Ct={expr:parser(xt,this)};return $t&&(Ct.expr.$name=$t),ref(this.add(Expression(Ct)))},addBinding(xt,$t){this.bindings||error("Nested signals do not support binding: "+$(xt)),this.bindings.push(extend({signal:xt},$t))},addScaleProj(xt,$t){has$1(this.scales,xt)&&error("Duplicate scale or projection name: "+$(xt)),this.scales[xt]=this.add($t)},addScale(xt,$t){this.addScaleProj(xt,Scale($t))},addProjection(xt,$t){this.addScaleProj(xt,Projection($t))},getScale(xt){return this.scales[xt]||error("Unrecognized scale name: "+$(xt)),this.scales[xt]},scaleRef(xt){return ref(this.getScale(xt))},scaleType(xt){return this.getScale(xt).params.type},projectionRef(xt){return this.scaleRef(xt)},projectionType(xt){return this.scaleType(xt)},addData(xt,$t){return has$1(this.data,xt)&&error("Duplicate data set name: "+$(xt)),this.data[xt]=$t},getData(xt){return this.data[xt]||error("Undefined data set name: "+$(xt)),this.data[xt]},addDataPipeline(xt,$t){return has$1(this.data,xt)&&error("Duplicate data set name: "+$(xt)),this.addData(xt,DataScope.fromEntries(this,$t))}};function propertyLambda(xt){return(isArray(xt)?arrayLambda:objectLambda)(xt)}function arrayLambda(xt){const $t=xt.length;let Ct="[";for(let kt=0;kt<$t;++kt){const Mt=xt[kt];Ct+=(kt>0?",":"")+(isObject(Mt)?Mt.signal||propertyLambda(Mt):$(Mt))}return Ct+"]"}function objectLambda(xt){let $t="{",Ct=0,kt,Mt;for(kt in xt)Mt=xt[kt],$t+=(++Ct>1?",":"")+$(kt)+":"+(isObject(Mt)?Mt.signal||propertyLambda(Mt):$(Mt));return $t+"}"}function defaults(){const xt="sans-serif",kt="#4c78a8",Mt="#000",Ft="#888",jt="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:kt},area:{fill:kt},image:null,line:{stroke:kt,strokeWidth:2},path:{stroke:kt},rect:{fill:kt},rule:{stroke:Mt},shape:{stroke:kt},symbol:{fill:kt,size:64},text:{fill:Mt,font:xt,fontSize:11},trail:{fill:kt,size:2},style:{"guide-label":{fill:Mt,font:xt,fontSize:10},"guide-title":{fill:Mt,font:xt,fontSize:11,fontWeight:"bold"},"group-title":{fill:Mt,font:xt,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:Mt,font:xt,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:jt},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:Ft,grid:!1,gridWidth:1,gridColor:jt,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:Ft,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:jt,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:Ft,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function parse(xt,$t,Ct){return isObject(xt)||error("Input Vega specification must be an object."),$t=mergeConfig(defaults(),$t,xt.config),parseView(xt,new Scope($t,Ct)).toRuntime()}var version$4="5.29.0";extend(transforms,tx,vtx,encode$1,geo,force,label,tree,reg,voronoi,wordcloud,xf);const vegaImport=Object.freeze(Object.defineProperty({__proto__:null,Bounds,CanvasHandler,CanvasRenderer,DATE,DAY,DAYOFYEAR,Dataflow,Debug,Error:Error$1,EventStream,Gradient:Gradient$1,GroupItem,HOURS,Handler:Handler$1,HybridHandler,HybridRenderer,Info,Item,MILLISECONDS,MINUTES,MONTH,Marks,MultiPulse,None:None$2,Operator,Parameters,Pulse,QUARTER,RenderType,Renderer,ResourceLoader,SECONDS,SVGHandler,SVGRenderer,SVGStringRenderer,Scenegraph,TIME_UNITS,Transform,View:View$1,WEEK,Warn,YEAR,accessor,accessorFields,accessorName,array:array$2,ascending:ascending$1,bandwidthNRD:estimateBandwidth,bin:bin$1,bootstrapCI,boundClip,boundContext,boundItem:boundItem$1,boundMark,boundStroke,changeset,clampRange,codegenExpression:codegen,compare:compare$8,constant:constant$1,cumulativeLogNormal,cumulativeNormal,cumulativeUniform,dayofyear,debounce,defaultLocale,definition:definition$1,densityLogNormal,densityNormal,densityUniform,domChild,domClear,domCreate,domFind,dotbin,error,expressionFunction,extend,extent,extentIndex,falsy,fastmap,field:field$1,flush,font:font$1,fontFamily,fontSize,format:format$2,formatLocale:numberFormatDefaultLocale,formats:formats$1,hasOwnProperty:has$1,id,identity:identity$1,inferType,inferTypes,ingest:ingest$1,inherits,inrange,interpolate:interpolate$1,interpolateColors,interpolateRange:interpolateRange$1,intersect:intersect$2,intersectBoxLine,intersectPath,intersectPoint,intersectRule,isArray,isBoolean:isBoolean$2,isDate:isDate$1,isFunction:isFunction$1,isIterable,isNumber:isNumber$1,isObject,isRegExp,isString,isTuple,key,lerp,lineHeight,loader,locale,logger,lruCache:lruCache$1,markup,merge:merge$2,mergeConfig,multiLineOffset,one:one$1,pad,panLinear,panLog,panPow,panSymlog,parse,parseExpression:parser$1,parseSelector:eventSelector,path:path$3,pathCurves:curves,pathEqual,pathParse:parse$3,pathRectangle:vg_rect,pathRender,pathSymbols:symbols$1,pathTrail:vg_trail,peek:peek$1,point:point$2,projection,quantileLogNormal,quantileNormal,quantileUniform,quantiles,quantizeInterpolator,quarter,quartiles,get random(){return random},randomInteger:integer,randomKDE:kde,randomLCG:lcg,randomLogNormal:lognormal,randomMixture:mixture$1,randomNormal:gaussian,randomUniform:uniform,read,regressionConstant:constant,regressionExp:exp,regressionLinear:linear,regressionLoess:loess,regressionLog:log$1,regressionPoly:poly,regressionPow:pow,regressionQuad:quad,renderModule,repeat,resetDefaultLocale,resetSVGClipId,resetSVGDefIds,responseType,runtimeContext:context,sampleCurve,sampleLogNormal,sampleNormal,sampleUniform,scale:scale$4,sceneEqual,sceneFromJSON,scenePickVisit:pickVisit,sceneToJSON,sceneVisit:visit,sceneZOrder:zorder,scheme:scheme$1,serializeXML,setHybridRendererOptions,setRandom,span,splitAccessPath,stringValue:$,textMetrics,timeBin:bin$2,timeFloor,timeFormatLocale:timeFormatDefaultLocale,timeInterval,timeOffset,timeSequence,timeUnitSpecifier,timeUnits,toBoolean,toDate,toNumber,toSet,toString,transform:transform$2,transforms,truncate:truncate$1,truthy,tupleid,typeParsers,utcFloor,utcInterval,utcOffset,utcSequence,utcdayofyear,utcquarter,utcweek,version:version$4,visitArray,week,writeConfig,zero:zero$2,zoomLinear,zoomLog,zoomPow,zoomSymlog},Symbol.toStringTag,{value:"Module"}));function adjustSpatial(xt,$t,Ct){let kt;$t.x2&&($t.x?(Ct&&xt.x>xt.x2&&(kt=xt.x,xt.x=xt.x2,xt.x2=kt),xt.width=xt.x2-xt.x):xt.x=xt.x2-(xt.width||0)),$t.xc&&(xt.x=xt.xc-(xt.width||0)/2),$t.y2&&($t.y?(Ct&&xt.y>xt.y2&&(kt=xt.y,xt.y=xt.y2,xt.y2=kt),xt.height=xt.y2-xt.y):xt.y=xt.y2-(xt.height||0)),$t.yc&&(xt.y=xt.yc-(xt.height||0)/2)}var Constants={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},Ops={"*":(xt,$t)=>xt*$t,"+":(xt,$t)=>xt+$t,"-":(xt,$t)=>xt-$t,"/":(xt,$t)=>xt/$t,"%":(xt,$t)=>xt%$t,">":(xt,$t)=>xt>$t,"<":(xt,$t)=>xt<$t,"<=":(xt,$t)=>xt<=$t,">=":(xt,$t)=>xt>=$t,"==":(xt,$t)=>xt==$t,"!=":(xt,$t)=>xt!=$t,"===":(xt,$t)=>xt===$t,"!==":(xt,$t)=>xt!==$t,"&":(xt,$t)=>xt&$t,"|":(xt,$t)=>xt|$t,"^":(xt,$t)=>xt^$t,"<<":(xt,$t)=>xt<<$t,">>":(xt,$t)=>xt>>$t,">>>":(xt,$t)=>xt>>>$t},Unary={"+":xt=>+xt,"-":xt=>-xt,"~":xt=>~xt,"!":xt=>!xt};const slice=Array.prototype.slice,apply=(xt,$t,Ct)=>{const kt=Ct?Ct($t[0]):$t[0];return kt[xt].apply(kt,slice.call($t,1))},datetime=(xt,$t,Ct,kt,Mt,Ft,jt)=>new Date(xt,$t||0,Ct??1,kt||0,Mt||0,Ft||0,jt||0);var Functions={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(xt,$t,Ct)=>Math.max($t,Math.min(Ct,xt)),now:Date.now,utc:Date.UTC,datetime,date:xt=>new Date(xt).getDate(),day:xt=>new Date(xt).getDay(),year:xt=>new Date(xt).getFullYear(),month:xt=>new Date(xt).getMonth(),hours:xt=>new Date(xt).getHours(),minutes:xt=>new Date(xt).getMinutes(),seconds:xt=>new Date(xt).getSeconds(),milliseconds:xt=>new Date(xt).getMilliseconds(),time:xt=>new Date(xt).getTime(),timezoneoffset:xt=>new Date(xt).getTimezoneOffset(),utcdate:xt=>new Date(xt).getUTCDate(),utcday:xt=>new Date(xt).getUTCDay(),utcyear:xt=>new Date(xt).getUTCFullYear(),utcmonth:xt=>new Date(xt).getUTCMonth(),utchours:xt=>new Date(xt).getUTCHours(),utcminutes:xt=>new Date(xt).getUTCMinutes(),utcseconds:xt=>new Date(xt).getUTCSeconds(),utcmilliseconds:xt=>new Date(xt).getUTCMilliseconds(),length:xt=>xt.length,join:function(){return apply("join",arguments)},indexof:function(){return apply("indexOf",arguments)},lastindexof:function(){return apply("lastIndexOf",arguments)},slice:function(){return apply("slice",arguments)},reverse:xt=>xt.slice().reverse(),parseFloat,parseInt,upper:xt=>String(xt).toUpperCase(),lower:xt=>String(xt).toLowerCase(),substring:function(){return apply("substring",arguments,String)},split:function(){return apply("split",arguments,String)},replace:function(){return apply("replace",arguments,String)},trim:xt=>String(xt).trim(),regexp:RegExp,test:(xt,$t)=>RegExp(xt).test($t)};const EventFunctions=["view","item","group","xy","x","y"],DisallowedMethods=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&DisallowedMethods.add(setImmediate);const Visitors={Literal:(xt,$t)=>$t.value,Identifier:(xt,$t)=>{const Ct=$t.name;return xt.memberDepth>0?Ct:Ct==="datum"?xt.datum:Ct==="event"?xt.event:Ct==="item"?xt.item:Constants[Ct]||xt.params["$"+Ct]},MemberExpression:(xt,$t)=>{const Ct=!$t.computed,kt=xt($t.object);Ct&&(xt.memberDepth+=1);const Mt=xt($t.property);if(Ct&&(xt.memberDepth-=1),DisallowedMethods.has(kt[Mt])){console.error(`Prevented interpretation of member "${Mt}" which could lead to insecure code execution`);return}return kt[Mt]},CallExpression:(xt,$t)=>{const Ct=$t.arguments;let kt=$t.callee.name;return kt.startsWith("_")&&(kt=kt.slice(1)),kt==="if"?xt(Ct[0])?xt(Ct[1]):xt(Ct[2]):(xt.fn[kt]||Functions[kt]).apply(xt.fn,Ct.map(xt))},ArrayExpression:(xt,$t)=>$t.elements.map(xt),BinaryExpression:(xt,$t)=>Ops[$t.operator](xt($t.left),xt($t.right)),UnaryExpression:(xt,$t)=>Unary[$t.operator](xt($t.argument)),ConditionalExpression:(xt,$t)=>xt($t.test)?xt($t.consequent):xt($t.alternate),LogicalExpression:(xt,$t)=>$t.operator==="&&"?xt($t.left)&&xt($t.right):xt($t.left)||xt($t.right),ObjectExpression:(xt,$t)=>$t.properties.reduce((Ct,kt)=>{xt.memberDepth+=1;const Mt=xt(kt.key);return xt.memberDepth-=1,DisallowedMethods.has(xt(kt.value))?console.error(`Prevented interpretation of property "${Mt}" which could lead to insecure code execution`):Ct[Mt]=xt(kt.value),Ct},{})};function interpret(xt,$t,Ct,kt,Mt,Ft){const jt=Bt=>Visitors[Bt.type](jt,Bt);return jt.memberDepth=0,jt.fn=Object.create($t),jt.params=Ct,jt.datum=kt,jt.event=Mt,jt.item=Ft,EventFunctions.forEach(Bt=>jt.fn[Bt]=function(){return Mt.vega[Bt](...arguments)}),jt(xt)}var expression$1={operator(xt,$t){const Ct=$t.ast,kt=xt.functions;return Mt=>interpret(Ct,kt,Mt)},parameter(xt,$t){const Ct=$t.ast,kt=xt.functions;return(Mt,Ft)=>interpret(Ct,kt,Ft,Mt)},event(xt,$t){const Ct=$t.ast,kt=xt.functions;return Mt=>interpret(Ct,kt,void 0,void 0,Mt)},handler(xt,$t){const Ct=$t.ast,kt=xt.functions;return(Mt,Ft)=>{const jt=Ft.item&&Ft.item.datum;return interpret(Ct,kt,Mt,jt,Ft)}},encode(xt,$t){const{marktype:Ct,channels:kt}=$t,Mt=xt.functions,Ft=Ct==="group"||Ct==="image"||Ct==="rect";return(jt,Bt)=>{const Vt=jt.datum;let zt=0,Ht;for(const Gt in kt)Ht=interpret(kt[Gt].ast,Mt,Bt,Vt,void 0,jt),jt[Gt]!==Ht&&(jt[Gt]=Ht,zt=1);return Ct!=="rule"&&adjustSpatial(jt,kt,Ft),zt}}};const name$1="vega-lite",author$1='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',version$3="5.18.1",collaborators=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],homepage="https://vega.github.io/vega-lite/",description$2="Vega-Lite is a concise high-level language for interactive visualization.",keywords$1=["vega","chart","visualization"],main$2="build/vega-lite.js",unpkg$1="build/vega-lite.min.js",jsdelivr$1="build/vega-lite.min.js",module$1="build/src/index",types$1="build/src/index.d.ts",bin={vl2pdf:"./bin/vl2pdf",vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},files$1=["bin","build","src","vega-lite*","tsconfig.json"],scripts$1={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.mjs","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json",data:"rsync -r node_modules/vega-datasets/data/* site/data","build-editor-preview":"scripts/build-editor-preview.sh",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",format:"eslint . --fix && yarn prettierbase --write",lint:"eslint . && yarn prettierbase --check",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/","watch:test:runtime":"TZ=America/Los_Angeles npx jest --watch test-runtime/ --config test-runtime/jest-config.json",release:"release-it"},repository$1={type:"git",url:"https://github.com/vega/vega-lite.git"},license$1="BSD-3-Clause",bugs={url:"https://github.com/vega/vega-lite/issues"},devDependencies$1={"@babel/core":"^7.24.5","@babel/preset-env":"^7.24.5","@babel/preset-typescript":"^7.24.1","@release-it/conventional-changelog":"^8.0.1","@rollup/plugin-alias":"^5.1.0","@rollup/plugin-babel":"^6.0.4","@rollup/plugin-commonjs":"^25.0.7","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4","@types/d3":"^7.4.3","@types/jest":"^29.5.12","@types/pako":"^2.0.3","@typescript-eslint/eslint-plugin":"^7.8.0","@typescript-eslint/parser":"^7.8.0",ajv:"^8.13.0","ajv-formats":"^2.1.1",cheerio:"^1.0.0-rc.12","conventional-changelog-cli":"^4.1.0",d3:"^7.9.0","del-cli":"^5.1.0",eslint:"^8.57.0","eslint-config-prettier":"^9.1.0","eslint-plugin-jest":"^27.9.0","eslint-plugin-prettier":"^5.1.3","fast-json-stable-stringify":"~2.1.0","highlight.js":"^11.9.0",jest:"^29.7.0","jest-dev-server":"^10.0.0",mkdirp:"^3.0.1",pako:"^2.1.0",prettier:"^3.2.5",puppeteer:"^15.0.0","release-it":"^17.2.1",rollup:"^4.17.2","rollup-plugin-bundle-size":"^1.0.3",serve:"^14.2.3",terser:"^5.31.0","ts-jest":"^29.1.2","ts-json-schema-generator":"^1.5.0",typescript:"~5.4.5","vega-cli":"^5.28.0","vega-datasets":"^2.8.1","vega-embed":"^6.25.0","vega-tooltip":"^0.34.0","yaml-front-matter":"^4.1.1"},dependencies$1={"json-stringify-pretty-compact":"~3.0.0",tslib:"~2.6.2","vega-event-selector":"~3.0.1","vega-expression":"~5.1.0","vega-util":"~1.17.2",yargs:"~17.7.2"},peerDependencies$1={vega:"^5.24.0"},engines={node:">=18"},packageManager="yarn@1.22.19",pkg$1={name:name$1,author:author$1,version:version$3,collaborators,homepage,description:description$2,keywords:keywords$1,main:main$2,unpkg:unpkg$1,jsdelivr:jsdelivr$1,module:module$1,types:types$1,bin,files:files$1,scripts:scripts$1,repository:repository$1,license:license$1,bugs,devDependencies:devDependencies$1,dependencies:dependencies$1,peerDependencies:peerDependencies$1,engines,packageManager};function isLogicalOr(xt){return!!xt.or}function isLogicalAnd(xt){return!!xt.and}function isLogicalNot(xt){return!!xt.not}function forEachLeaf(xt,$t){if(isLogicalNot(xt))forEachLeaf(xt.not,$t);else if(isLogicalAnd(xt))for(const Ct of xt.and)forEachLeaf(Ct,$t);else if(isLogicalOr(xt))for(const Ct of xt.or)forEachLeaf(Ct,$t);else $t(xt)}function normalizeLogicalComposition(xt,$t){return isLogicalNot(xt)?{not:normalizeLogicalComposition(xt.not,$t)}:isLogicalAnd(xt)?{and:xt.and.map(Ct=>normalizeLogicalComposition(Ct,$t))}:isLogicalOr(xt)?{or:xt.or.map(Ct=>normalizeLogicalComposition(Ct,$t))}:$t(xt)}const duplicate=structuredClone;function never(xt){throw new Error(xt)}function pick(xt,$t){const Ct={};for(const kt of $t)has$1(xt,kt)&&(Ct[kt]=xt[kt]);return Ct}function omit(xt,$t){const Ct={...xt};for(const kt of $t)delete Ct[kt];return Ct}Set.prototype.toJSON=function(){return`Set(${[...this].map(xt=>stringify$1(xt)).join(",")})`};function hash(xt){if(isNumber$1(xt))return xt;const $t=isString(xt)?xt:stringify$1(xt);if($t.length<250)return $t;let Ct=0;for(let kt=0;kt<$t.length;kt++){const Mt=$t.charCodeAt(kt);Ct=(Ct<<5)-Ct+Mt,Ct=Ct&Ct}return Ct}function isNullOrFalse(xt){return xt===!1||xt===null}function contains(xt,$t){return xt.includes($t)}function some(xt,$t){let Ct=0;for(const[kt,Mt]of xt.entries())if($t(Mt,kt,Ct++))return!0;return!1}function every(xt,$t){let Ct=0;for(const[kt,Mt]of xt.entries())if(!$t(Mt,kt,Ct++))return!1;return!0}function mergeDeep$1(xt,...$t){for(const Ct of $t)deepMerge_$1(xt,Ct??{});return xt}function deepMerge_$1(xt,$t){for(const Ct of keys($t))writeConfig(xt,Ct,$t[Ct],!0)}function unique(xt,$t){const Ct=[],kt={};let Mt;for(const Ft of xt)Mt=$t(Ft),!(Mt in kt)&&(kt[Mt]=1,Ct.push(Ft));return Ct}function isEqual(xt,$t){const Ct=keys(xt),kt=keys($t);if(Ct.length!==kt.length)return!1;for(const Mt of Ct)if(xt[Mt]!==$t[Mt])return!1;return!0}function setEqual(xt,$t){if(xt.size!==$t.size)return!1;for(const Ct of xt)if(!$t.has(Ct))return!1;return!0}function hasIntersection(xt,$t){for(const Ct of xt)if($t.has(Ct))return!0;return!1}function prefixGenerator(xt){const $t=new Set;for(const Ct of xt){const Mt=splitAccessPath(Ct).map((jt,Bt)=>Bt===0?jt:`[${jt}]`),Ft=Mt.map((jt,Bt)=>Mt.slice(0,Bt+1).join(""));for(const jt of Ft)$t.add(jt)}return $t}function fieldIntersection(xt,$t){return xt===void 0||$t===void 0?!0:hasIntersection(prefixGenerator(xt),prefixGenerator($t))}function isEmpty(xt){return keys(xt).length===0}const keys=Object.keys,vals=Object.values,entries$1=Object.entries;function isBoolean(xt){return xt===!0||xt===!1}function varName(xt){const $t=xt.replace(/\W/g,"_");return(xt.match(/^\d+/)?"_":"")+$t}function logicalExpr(xt,$t){return isLogicalNot(xt)?`!(${logicalExpr(xt.not,$t)})`:isLogicalAnd(xt)?`(${xt.and.map(Ct=>logicalExpr(Ct,$t)).join(") && (")})`:isLogicalOr(xt)?`(${xt.or.map(Ct=>logicalExpr(Ct,$t)).join(") || (")})`:$t(xt)}function deleteNestedProperty(xt,$t){if($t.length===0)return!0;const Ct=$t.shift();return Ct in xt&&deleteNestedProperty(xt[Ct],$t)&&delete xt[Ct],isEmpty(xt)}function titleCase(xt){return xt.charAt(0).toUpperCase()+xt.substr(1)}function accessPathWithDatum(xt,$t="datum"){const Ct=splitAccessPath(xt),kt=[];for(let Mt=1;Mt<=Ct.length;Mt++){const Ft=`[${Ct.slice(0,Mt).map($).join("][")}]`;kt.push(`${$t}${Ft}`)}return kt.join(" && ")}function flatAccessWithDatum(xt,$t="datum"){return`${$t}[${$(splitAccessPath(xt).join("."))}]`}function escapePathAccess(xt){return xt.replace(/(\[|\]|\.|'|")/g,"\\$1")}function replacePathInField(xt){return`${splitAccessPath(xt).map(escapePathAccess).join("\\.")}`}function replaceAll(xt,$t,Ct){return xt.replace(new RegExp($t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),Ct)}function removePathFromField(xt){return`${splitAccessPath(xt).join(".")}`}function accessPathDepth(xt){return xt?splitAccessPath(xt).length:0}function getFirstDefined(...xt){for(const $t of xt)if($t!==void 0)return $t}let idCounter=42;function uniqueId(xt){const $t=++idCounter;return xt?String(xt)+$t:$t}function resetIdCounter(){idCounter=42}function internalField(xt){return isInternalField(xt)?xt:`__${xt}`}function isInternalField(xt){return xt.startsWith("__")}function normalizeAngle(xt){if(xt!==void 0)return(xt%360+360)%360}function isNumeric(xt){return isNumber$1(xt)?!0:!isNaN(xt)&&!isNaN(parseFloat(xt))}const clonedProto=Object.getPrototypeOf(structuredClone({}));function deepEqual(xt,$t){if(xt===$t)return!0;if(xt&&$t&&typeof xt=="object"&&typeof $t=="object"){if(xt.constructor.name!==$t.constructor.name)return!1;let Ct,kt;if(Array.isArray(xt)){if(Ct=xt.length,Ct!=$t.length)return!1;for(kt=Ct;kt--!==0;)if(!deepEqual(xt[kt],$t[kt]))return!1;return!0}if(xt instanceof Map&&$t instanceof Map){if(xt.size!==$t.size)return!1;for(kt of xt.entries())if(!$t.has(kt[0]))return!1;for(kt of xt.entries())if(!deepEqual(kt[1],$t.get(kt[0])))return!1;return!0}if(xt instanceof Set&&$t instanceof Set){if(xt.size!==$t.size)return!1;for(kt of xt.entries())if(!$t.has(kt[0]))return!1;return!0}if(ArrayBuffer.isView(xt)&&ArrayBuffer.isView($t)){if(Ct=xt.length,Ct!=$t.length)return!1;for(kt=Ct;kt--!==0;)if(xt[kt]!==$t[kt])return!1;return!0}if(xt.constructor===RegExp)return xt.source===$t.source&&xt.flags===$t.flags;if(xt.valueOf!==Object.prototype.valueOf&&xt.valueOf!==clonedProto.valueOf)return xt.valueOf()===$t.valueOf();if(xt.toString!==Object.prototype.toString&&xt.toString!==clonedProto.toString)return xt.toString()===$t.toString();const Mt=Object.keys(xt);if(Ct=Mt.length,Ct!==Object.keys($t).length)return!1;for(kt=Ct;kt--!==0;)if(!Object.prototype.hasOwnProperty.call($t,Mt[kt]))return!1;for(kt=Ct;kt--!==0;){const Ft=Mt[kt];if(!deepEqual(xt[Ft],$t[Ft]))return!1}return!0}return xt!==xt&&$t!==$t}function stringify$1(xt){const $t=[];return function Ct(kt){if(kt&&kt.toJSON&&typeof kt.toJSON=="function"&&(kt=kt.toJSON()),kt===void 0)return;if(typeof kt=="number")return isFinite(kt)?""+kt:"null";if(typeof kt!="object")return JSON.stringify(kt);let Mt,Ft;if(Array.isArray(kt)){for(Ft="[",Mt=0;Mt<kt.length;Mt++)Mt&&(Ft+=","),Ft+=Ct(kt[Mt])||"null";return Ft+"]"}if(kt===null)return"null";if($t.includes(kt))throw new TypeError("Converting circular structure to JSON");const jt=$t.push(kt)-1,Bt=Object.keys(kt).sort();for(Ft="",Mt=0;Mt<Bt.length;Mt++){const Vt=Bt[Mt],zt=Ct(kt[Vt]);zt&&(Ft&&(Ft+=","),Ft+=JSON.stringify(Vt)+":"+zt)}return $t.splice(jt,1),`{${Ft}}`}(xt)}const ROW="row",COLUMN="column",FACET="facet",X="x",Y="y",X2="x2",Y2="y2",XOFFSET="xOffset",YOFFSET="yOffset",RADIUS="radius",RADIUS2="radius2",THETA="theta",THETA2="theta2",LATITUDE="latitude",LONGITUDE="longitude",LATITUDE2="latitude2",LONGITUDE2="longitude2",COLOR="color",FILL="fill",STROKE="stroke",SHAPE="shape",SIZE="size",ANGLE="angle",OPACITY="opacity",FILLOPACITY="fillOpacity",STROKEOPACITY="strokeOpacity",STROKEWIDTH="strokeWidth",STROKEDASH="strokeDash",TEXT$1="text",ORDER="order",DETAIL="detail",KEY="key",TOOLTIP="tooltip",HREF="href",URL$1="url",DESCRIPTION="description",POSITION_CHANNEL_INDEX={x:1,y:1,x2:1,y2:1},POLAR_POSITION_CHANNEL_INDEX={theta:1,theta2:1,radius:1,radius2:1};function isPolarPositionChannel(xt){return xt in POLAR_POSITION_CHANNEL_INDEX}const GEO_POSIITON_CHANNEL_INDEX={longitude:1,longitude2:1,latitude:1,latitude2:1};function getPositionChannelFromLatLong(xt){switch(xt){case LATITUDE:return"y";case LATITUDE2:return"y2";case LONGITUDE:return"x";case LONGITUDE2:return"x2"}}function isGeoPositionChannel(xt){return xt in GEO_POSIITON_CHANNEL_INDEX}const GEOPOSITION_CHANNELS=keys(GEO_POSIITON_CHANNEL_INDEX),UNIT_CHANNEL_INDEX={...POSITION_CHANNEL_INDEX,...POLAR_POSITION_CHANNEL_INDEX,...GEO_POSIITON_CHANNEL_INDEX,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function isColorChannel(xt){return xt===COLOR||xt===FILL||xt===STROKE}const FACET_CHANNEL_INDEX={row:1,column:1,facet:1},FACET_CHANNELS=keys(FACET_CHANNEL_INDEX),CHANNEL_INDEX={...UNIT_CHANNEL_INDEX,...FACET_CHANNEL_INDEX},CHANNELS=keys(CHANNEL_INDEX),{order:_o,detail:_d,tooltip:_tt1,...SINGLE_DEF_CHANNEL_INDEX}=CHANNEL_INDEX,{row:_r,column:_c,facet:_f,...SINGLE_DEF_UNIT_CHANNEL_INDEX}=SINGLE_DEF_CHANNEL_INDEX;function isSingleDefUnitChannel(xt){return!!SINGLE_DEF_UNIT_CHANNEL_INDEX[xt]}function isChannel(xt){return!!CHANNEL_INDEX[xt]}const SECONDARY_RANGE_CHANNEL=[X2,Y2,LATITUDE2,LONGITUDE2,THETA2,RADIUS2];function isSecondaryRangeChannel(xt){return getMainRangeChannel(xt)!==xt}function getMainRangeChannel(xt){switch(xt){case X2:return X;case Y2:return Y;case LATITUDE2:return LATITUDE;case LONGITUDE2:return LONGITUDE;case THETA2:return THETA;case RADIUS2:return RADIUS}return xt}function getVgPositionChannel(xt){if(isPolarPositionChannel(xt))switch(xt){case THETA:return"startAngle";case THETA2:return"endAngle";case RADIUS:return"outerRadius";case RADIUS2:return"innerRadius"}return xt}function getSecondaryRangeChannel(xt){switch(xt){case X:return X2;case Y:return Y2;case LATITUDE:return LATITUDE2;case LONGITUDE:return LONGITUDE2;case THETA:return THETA2;case RADIUS:return RADIUS2}}function getSizeChannel(xt){switch(xt){case X:case X2:return"width";case Y:case Y2:return"height"}}function getOffsetChannel(xt){switch(xt){case X:return"xOffset";case Y:return"yOffset";case X2:return"x2Offset";case Y2:return"y2Offset";case THETA:return"thetaOffset";case RADIUS:return"radiusOffset";case THETA2:return"theta2Offset";case RADIUS2:return"radius2Offset"}}function getOffsetScaleChannel(xt){switch(xt){case X:return"xOffset";case Y:return"yOffset"}}function getMainChannelFromOffsetChannel(xt){switch(xt){case"xOffset":return"x";case"yOffset":return"y"}}const UNIT_CHANNELS=keys(UNIT_CHANNEL_INDEX),{x:_x,y:_y,x2:_x2,y2:_y2,xOffset:_xo,yOffset:_yo,latitude:_latitude,longitude:_longitude,latitude2:_latitude2,longitude2:_longitude2,theta:_theta,theta2:_theta2,radius:_radius,radius2:_radius2,...NONPOSITION_CHANNEL_INDEX}=UNIT_CHANNEL_INDEX,NONPOSITION_CHANNELS=keys(NONPOSITION_CHANNEL_INDEX),POSITION_SCALE_CHANNEL_INDEX={x:1,y:1},POSITION_SCALE_CHANNELS=keys(POSITION_SCALE_CHANNEL_INDEX);function isXorY(xt){return xt in POSITION_SCALE_CHANNEL_INDEX}const POLAR_POSITION_SCALE_CHANNEL_INDEX={theta:1,radius:1},POLAR_POSITION_SCALE_CHANNELS=keys(POLAR_POSITION_SCALE_CHANNEL_INDEX);function getPositionScaleChannel(xt){return xt==="width"?X:Y}const OFFSET_SCALE_CHANNEL_INDEX={xOffset:1,yOffset:1};function isXorYOffset(xt){return xt in OFFSET_SCALE_CHANNEL_INDEX}const{text:_t,tooltip:_tt,href:_hr,url:_u,description:_al,detail:_dd,key:_k,order:_oo,...NONPOSITION_SCALE_CHANNEL_INDEX}=NONPOSITION_CHANNEL_INDEX,NONPOSITION_SCALE_CHANNELS=keys(NONPOSITION_SCALE_CHANNEL_INDEX);function isNonPositionScaleChannel(xt){return!!NONPOSITION_CHANNEL_INDEX[xt]}function supportLegend(xt){switch(xt){case COLOR:case FILL:case STROKE:case SIZE:case SHAPE:case OPACITY:case STROKEWIDTH:case STROKEDASH:return!0;case FILLOPACITY:case STROKEOPACITY:case ANGLE:return!1}}const SCALE_CHANNEL_INDEX={...POSITION_SCALE_CHANNEL_INDEX,...POLAR_POSITION_SCALE_CHANNEL_INDEX,...OFFSET_SCALE_CHANNEL_INDEX,...NONPOSITION_SCALE_CHANNEL_INDEX},SCALE_CHANNELS=keys(SCALE_CHANNEL_INDEX);function isScaleChannel(xt){return!!SCALE_CHANNEL_INDEX[xt]}function supportMark(xt,$t){return getSupportedMark(xt)[$t]}const ALL_MARKS={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:_g,...ALL_MARKS_EXCEPT_GEOSHAPE}=ALL_MARKS;function getSupportedMark(xt){switch(xt){case COLOR:case FILL:case STROKE:case DESCRIPTION:case DETAIL:case KEY:case TOOLTIP:case HREF:case ORDER:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case STROKEWIDTH:case FACET:case ROW:case COLUMN:return ALL_MARKS;case X:case Y:case XOFFSET:case YOFFSET:case LATITUDE:case LONGITUDE:return ALL_MARKS_EXCEPT_GEOSHAPE;case X2:case Y2:case LATITUDE2:case LONGITUDE2:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case SIZE:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case STROKEDASH:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case SHAPE:return{point:"always",geoshape:"always"};case TEXT$1:return{text:"always"};case ANGLE:return{point:"always",square:"always",text:"always"};case URL$1:return{image:"always"};case THETA:return{text:"always",arc:"always"};case RADIUS:return{text:"always",arc:"always"};case THETA2:case RADIUS2:return{arc:"always"}}}function rangeType(xt){switch(xt){case X:case Y:case THETA:case RADIUS:case XOFFSET:case YOFFSET:case SIZE:case ANGLE:case STROKEWIDTH:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case X2:case Y2:case THETA2:case RADIUS2:return;case FACET:case ROW:case COLUMN:case SHAPE:case STROKEDASH:case TEXT$1:case TOOLTIP:case HREF:case URL$1:case DESCRIPTION:return"discrete";case COLOR:case FILL:case STROKE:return"flexible";case LATITUDE:case LONGITUDE:case LATITUDE2:case LONGITUDE2:case DETAIL:case KEY:case ORDER:return}}const AGGREGATE_OP_INDEX={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},MULTIDOMAIN_SORT_OP_INDEX={count:1,min:1,max:1};function isArgminDef(xt){return!!xt&&!!xt.argmin}function isArgmaxDef(xt){return!!xt&&!!xt.argmax}function isAggregateOp(xt){return isString(xt)&&!!AGGREGATE_OP_INDEX[xt]}const COUNTING_OPS=new Set(["count","valid","missing","distinct"]);function isCountingAggregateOp(xt){return isString(xt)&&COUNTING_OPS.has(xt)}function isMinMaxOp(xt){return isString(xt)&&contains(["min","max"],xt)}const SUM_OPS=new Set(["count","sum","distinct","valid","missing"]),SHARED_DOMAIN_OPS=new Set(["mean","average","median","q1","q3","min","max"]);function binToString(xt){return isBoolean$2(xt)&&(xt=normalizeBin(xt,void 0)),"bin"+keys(xt).map($t=>isParameterExtent(xt[$t])?varName(`_${$t}_${entries$1(xt[$t])}`):varName(`_${$t}_${xt[$t]}`)).join("")}function isBinning(xt){return xt===!0||isBinParams(xt)&&!xt.binned}function isBinned(xt){return xt==="binned"||isBinParams(xt)&&xt.binned===!0}function isBinParams(xt){return isObject(xt)}function isParameterExtent(xt){return xt==null?void 0:xt.param}function autoMaxBins(xt){switch(xt){case ROW:case COLUMN:case SIZE:case COLOR:case FILL:case STROKE:case STROKEWIDTH:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case SHAPE:return 6;case STROKEDASH:return 4;default:return 10}}function isExprRef(xt){return!!(xt!=null&&xt.expr)}function replaceExprRef(xt){const $t=keys(xt||{}),Ct={};for(const kt of $t)Ct[kt]=signalRefOrValue(xt[kt]);return Ct}function extractTitleConfig(xt){const{anchor:$t,frame:Ct,offset:kt,orient:Mt,angle:Ft,limit:jt,color:Bt,subtitleColor:Vt,subtitleFont:zt,subtitleFontSize:Ht,subtitleFontStyle:Gt,subtitleFontWeight:qt,subtitleLineHeight:Wt,subtitlePadding:Yt,...Kt}=xt,Xt={...Kt,...Bt?{fill:Bt}:{}},Qt={...$t?{anchor:$t}:{},...Ct?{frame:Ct}:{},...kt?{offset:kt}:{},...Mt?{orient:Mt}:{},...Ft!==void 0?{angle:Ft}:{},...jt!==void 0?{limit:jt}:{}},Jt={...Vt?{subtitleColor:Vt}:{},...zt?{subtitleFont:zt}:{},...Ht?{subtitleFontSize:Ht}:{},...Gt?{subtitleFontStyle:Gt}:{},...qt?{subtitleFontWeight:qt}:{},...Wt?{subtitleLineHeight:Wt}:{},...Yt?{subtitlePadding:Yt}:{}},Zt=pick(xt,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:Xt,subtitleMarkConfig:Zt,nonMarkTitleProperties:Qt,subtitle:Jt}}function isText(xt){return isString(xt)||isArray(xt)&&isString(xt[0])}function isSignalRef(xt){return!!(xt!=null&&xt.signal)}function isVgRangeStep(xt){return!!xt.step}function isDataRefUnionedDomain(xt){return isArray(xt)?!1:"fields"in xt&&!("data"in xt)}function isFieldRefUnionDomain(xt){return isArray(xt)?!1:"fields"in xt&&"data"in xt}function isDataRefDomain(xt){return isArray(xt)?!1:"field"in xt&&"data"in xt}const VG_MARK_CONFIG_INDEX={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},VG_MARK_CONFIGS=keys(VG_MARK_CONFIG_INDEX),VG_MARK_INDEX={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},VG_CORNERRADIUS_CHANNELS=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function signalOrValueRefWithCondition(xt){const $t=isArray(xt.condition)?xt.condition.map(conditionalSignalRefOrValue):conditionalSignalRefOrValue(xt.condition);return{...signalRefOrValue(xt),condition:$t}}function signalRefOrValue(xt){if(isExprRef(xt)){const{expr:$t,...Ct}=xt;return{signal:$t,...Ct}}return xt}function conditionalSignalRefOrValue(xt){if(isExprRef(xt)){const{expr:$t,...Ct}=xt;return{signal:$t,...Ct}}return xt}function signalOrValueRef(xt){if(isExprRef(xt)){const{expr:$t,...Ct}=xt;return{signal:$t,...Ct}}return isSignalRef(xt)?xt:xt!==void 0?{value:xt}:void 0}function exprFromSignalRefOrValue(xt){return isSignalRef(xt)?xt.signal:$(xt)}function exprFromValueRefOrSignalRef(xt){return isSignalRef(xt)?xt.signal:$(xt.value)}function signalOrStringValue(xt){return isSignalRef(xt)?xt.signal:xt==null?null:$(xt)}function applyMarkConfig(xt,$t,Ct){for(const kt of Ct){const Mt=getMarkConfig(kt,$t.markDef,$t.config);Mt!==void 0&&(xt[kt]=signalOrValueRef(Mt))}return xt}function getStyles(xt){return[].concat(xt.type,xt.style??[])}function getMarkPropOrConfig(xt,$t,Ct,kt={}){const{vgChannel:Mt,ignoreVgConfig:Ft}=kt;return Mt&&$t[Mt]!==void 0?$t[Mt]:$t[xt]!==void 0?$t[xt]:Ft&&(!Mt||Mt===xt)?void 0:getMarkConfig(xt,$t,Ct,kt)}function getMarkConfig(xt,$t,Ct,{vgChannel:kt}={}){return getFirstDefined(kt?getMarkStyleConfig(xt,$t,Ct.style):void 0,getMarkStyleConfig(xt,$t,Ct.style),kt?Ct[$t.type][kt]:void 0,Ct[$t.type][xt],kt?Ct.mark[kt]:Ct.mark[xt])}function getMarkStyleConfig(xt,$t,Ct){return getStyleConfig(xt,getStyles($t),Ct)}function getStyleConfig(xt,$t,Ct){$t=array$2($t);let kt;for(const Mt of $t){const Ft=Ct[Mt];Ft&&Ft[xt]!==void 0&&(kt=Ft[xt])}return kt}function sortParams(xt,$t){return array$2(xt).reduce((Ct,kt)=>(Ct.field.push(vgField(kt,$t)),Ct.order.push(kt.sort??"ascending"),Ct),{field:[],order:[]})}function mergeTitleFieldDefs(xt,$t){const Ct=[...xt];return $t.forEach(kt=>{for(const Mt of Ct)if(deepEqual(Mt,kt))return;Ct.push(kt)}),Ct}function mergeTitle(xt,$t){return deepEqual(xt,$t)||!$t?xt:xt?[...array$2(xt),...array$2($t)].join(", "):$t}function mergeTitleComponent(xt,$t){const Ct=xt.value,kt=$t.value;if(Ct==null||kt===null)return{explicit:xt.explicit,value:null};if((isText(Ct)||isSignalRef(Ct))&&(isText(kt)||isSignalRef(kt)))return{explicit:xt.explicit,value:mergeTitle(Ct,kt)};if(isText(Ct)||isSignalRef(Ct))return{explicit:xt.explicit,value:Ct};if(isText(kt)||isSignalRef(kt))return{explicit:xt.explicit,value:kt};if(!isText(Ct)&&!isSignalRef(Ct)&&!isText(kt)&&!isSignalRef(kt))return{explicit:xt.explicit,value:mergeTitleFieldDefs(Ct,kt)};throw new Error("It should never reach here")}function invalidSpec(xt){return`Invalid specification ${stringify$1(xt)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const FIT_NON_SINGLE='Autosize "fit" only works for single views and layered views.';function containerSizeNonSingle(xt){return`${xt=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function containerSizeNotCompatibleWithAutosize(xt){const $t=xt=="width"?"Width":"Height",Ct=xt=="width"?"x":"y";return`${$t} "container" only works well with autosize "fit" or "fit-${Ct}".`}function droppingFit(xt){return xt?`Dropping "fit-${xt}" because spec has discrete ${getSizeChannel(xt)}.`:'Dropping "fit" because spec has discrete size.'}function unknownField(xt){return`Unknown field for ${xt}. Cannot calculate view size.`}function cannotProjectOnChannelWithoutField(xt){return`Cannot project a selection on encoding channel "${xt}", which has no field.`}function cannotProjectAggregate(xt,$t){return`Cannot project a selection on encoding channel "${xt}" as it uses an aggregate function ("${$t}").`}function nearestNotSupportForContinuous(xt){return`The "nearest" transform is not supported for ${xt} marks.`}function selectionNotSupported(xt){return`Selection not supported for ${xt} yet.`}function selectionNotFound(xt){return`Cannot find a selection named "${xt}".`}const SCALE_BINDINGS_CONTINUOUS="Scale bindings are currently only supported for scales with unbinned, continuous domains.",SEQUENTIAL_SCALE_DEPRECATED="Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc",LEGEND_BINDINGS_MUST_HAVE_PROJECTION="Legend bindings are only supported for selections over an individual field or encoding channel.";function cannotLookupVariableParameter(xt){return`Lookups can only be performed on selection parameters. "${xt}" is a variable parameter.`}function noSameUnitLookup(xt){return`Cannot define and lookup the "${xt}" selection in the same view. Try moving the lookup into a second, layered view?`}const NEEDS_SAME_SELECTION="The same selection must be used to override scale domains in a layered view.",INTERVAL_INITIALIZED_WITH_POS='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function noSuchRepeatedValue(xt){return`Unknown repeated value "${xt}".`}function columnsNotSupportByRowCol(xt){return`The "columns" property cannot be used when "${xt}" has nested row/column.`}const CONCAT_CANNOT_SHARE_AXIS="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function unrecognizedParse(xt){return`Unrecognized parse "${xt}".`}function differentParse(xt,$t,Ct){return`An ancestor parsed field "${xt}" as ${Ct} but a child wants to parse the field as ${$t}.`}const ADD_SAME_CHILD_TWICE="Attempt to add the same child twice.";function invalidTransformIgnored(xt){return`Ignoring an invalid transform: ${stringify$1(xt)}.`}const NO_FIELDS_NEEDS_AS='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function customFormatTypeNotAllowed(xt){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${xt} are dropped.`}function projectionOverridden(xt){const{parentProjection:$t,projection:Ct}=xt;return`Layer's shared projection ${stringify$1($t)} is overridden by a child projection ${stringify$1(Ct)}.`}const REPLACE_ANGLE_WITH_THETA="Arc marks uses theta channel rather than angle, replacing angle with theta.";function offsetNestedInsideContinuousPositionScaleDropped(xt){return`${xt}Offset dropped because ${xt} is continuous`}function primitiveChannelDef(xt,$t,Ct){return`Channel ${xt} is a ${$t}. Converted to {value: ${stringify$1(Ct)}}.`}function invalidFieldType(xt){return`Invalid field type "${xt}".`}function invalidFieldTypeForCountAggregate(xt,$t){return`Invalid field type "${xt}" for aggregate: "${$t}", using "quantitative" instead.`}function invalidAggregate(xt){return`Invalid aggregation operator "${xt}".`}function droppingColor(xt,$t){const{fill:Ct,stroke:kt}=$t;return`Dropping color ${xt} as the plot also has ${Ct&&kt?"fill and stroke":Ct?"fill":"stroke"}.`}function relativeBandSizeNotSupported(xt){return`Position range does not support relative band size for ${xt}.`}function emptyFieldDef(xt,$t){return`Dropping ${stringify$1(xt)} from channel "${$t}" since it does not contain any data field, datum, value, or signal.`}const LINE_WITH_VARYING_SIZE="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function incompatibleChannel(xt,$t,Ct){return`${xt} dropped as it is incompatible with "${$t}".`}function invalidEncodingChannel(xt){return`${xt}-encoding is dropped as ${xt} is not a valid encoding channel.`}function channelShouldBeDiscrete(xt){return`${xt} encoding should be discrete (ordinal / nominal / binned).`}function channelShouldBeDiscreteOrDiscretizing(xt){return`${xt} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function facetChannelDropped(xt){return`Facet encoding dropped as ${xt.join(" and ")} ${xt.length>1?"are":"is"} also specified.`}function discreteChannelCannotEncode(xt,$t){return`Using discrete channel "${xt}" to encode "${$t}" field can be misleading as it does not encode ${$t==="ordinal"?"order":"magnitude"}.`}function rangeMarkAlignmentCannotBeExpression(xt){return`The ${xt} for range marks cannot be an expression`}function lineWithRange(xt,$t){return`Line mark is for continuous lines and thus cannot be used with ${xt&&$t?"x2 and y2":xt?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function orientOverridden(xt,$t){return`Specified orient "${xt}" overridden with "${$t}".`}function cannotUseScalePropertyWithNonColor(xt){return`Cannot use the scale property "${xt}" with non-color channel.`}function cannotUseRelativeBandSizeWithNonBandScale(xt){return`Cannot use the relative band size with ${xt} scale.`}function unaggregateDomainHasNoEffectForRawField(xt){return`Using unaggregated domain with raw field has no effect (${stringify$1(xt)}).`}function unaggregateDomainWithNonSharedDomainOp(xt){return`Unaggregated domain not applicable for "${xt}" since it produces values outside the origin domain of the source data.`}function unaggregatedDomainWithLogScale(xt){return`Unaggregated domain is currently unsupported for log scale (${stringify$1(xt)}).`}function cannotApplySizeToNonOrientedMark(xt){return`Cannot apply size to non-oriented mark "${xt}".`}function scaleTypeNotWorkWithChannel(xt,$t,Ct){return`Channel "${xt}" does not work with "${$t}" scale. We are using "${Ct}" scale instead.`}function scaleTypeNotWorkWithFieldDef(xt,$t){return`FieldDef does not work with "${xt}" scale. We are using "${$t}" scale instead.`}function scalePropertyNotWorkWithScaleType(xt,$t,Ct){return`${Ct}-scale's "${$t}" is dropped as it does not work with ${xt} scale.`}function stepDropped(xt){return`The step for "${xt}" is dropped because the ${xt==="width"?"x":"y"} is continuous.`}function mergeConflictingProperty(xt,$t,Ct,kt){return`Conflicting ${$t.toString()} property "${xt.toString()}" (${stringify$1(Ct)} and ${stringify$1(kt)}). Using ${stringify$1(Ct)}.`}function mergeConflictingDomainProperty(xt,$t,Ct,kt){return`Conflicting ${$t.toString()} property "${xt.toString()}" (${stringify$1(Ct)} and ${stringify$1(kt)}). Using the union of the two domains.`}function independentScaleMeansIndependentGuide(xt){return`Setting the scale to be independent for "${xt}" means we also have to set the guide (axis or legend) to be independent.`}function domainSortDropped(xt){return`Dropping sort property ${stringify$1(xt)} as unioned domains only support boolean or op "count", "min", and "max".`}const MORE_THAN_ONE_SORT="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",FACETED_INDEPENDENT_DIFFERENT_SOURCES="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",FACETED_INDEPENDENT_SAME_SOURCE="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function cannotStackRangedMark(xt){return`Cannot stack "${xt}" if there is already "${xt}2".`}function stackNonLinearScale(xt){return`Stack is applied to a non-linear scale (${xt}).`}function stackNonSummativeAggregate(xt){return`Stacking is applied even though the aggregate function is non-summative ("${xt}").`}function invalidTimeUnit(xt,$t){return`Invalid ${xt}: ${stringify$1($t)}.`}function droppedDay(xt){return`Dropping day from datetime ${stringify$1(xt)} as day cannot be combined with other units.`}function errorBarCenterAndExtentAreNotNeeded(xt,$t){return`${$t?"extent ":""}${$t&&xt?"and ":""}${xt?"center ":""}${$t&&xt?"are ":"is "}not needed when data are aggregated.`}function errorBarCenterIsUsedWithWrongExtent(xt,$t,Ct){return`${xt} is not usually used with ${$t} for ${Ct}.`}function errorBarContinuousAxisHasCustomizedAggregate(xt,$t){return`Continuous axis should not have customized aggregation function ${xt}; ${$t} already agregates the axis.`}function errorBand1DNotSupport(xt){return`1D error band does not support ${xt}.`}function channelRequiredForBinned(xt){return`Channel ${xt} is required for "binned" bin.`}function channelShouldNotBeUsedForBinned(xt){return`Channel ${xt} should not be used with "binned" bin.`}function domainRequiredForThresholdScale(xt){return`Domain for ${xt} is required for threshold scale.`}const main$1=logger(Warn);let current=main$1;function set(xt){return current=xt,current}function reset(){return current=main$1,current}function warn(...xt){current.warn(...xt)}function debug$2(...xt){current.debug(...xt)}function isDateTime(xt){if(xt&&isObject(xt)){for(const $t of TIMEUNIT_PARTS)if($t in xt)return!0}return!1}const MONTHS=["january","february","march","april","may","june","july","august","september","october","november","december"],SHORT_MONTHS=MONTHS.map(xt=>xt.substr(0,3)),DAYS=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],SHORT_DAYS=DAYS.map(xt=>xt.substr(0,3));function normalizeQuarter(xt){if(isNumeric(xt)&&(xt=+xt),isNumber$1(xt))return xt>4&&warn(invalidTimeUnit("quarter",xt)),xt-1;throw new Error(invalidTimeUnit("quarter",xt))}function normalizeMonth(xt){if(isNumeric(xt)&&(xt=+xt),isNumber$1(xt))return xt-1;{const $t=xt.toLowerCase(),Ct=MONTHS.indexOf($t);if(Ct!==-1)return Ct;const kt=$t.substr(0,3),Mt=SHORT_MONTHS.indexOf(kt);if(Mt!==-1)return Mt;throw new Error(invalidTimeUnit("month",xt))}}function normalizeDay(xt){if(isNumeric(xt)&&(xt=+xt),isNumber$1(xt))return xt%7;{const $t=xt.toLowerCase(),Ct=DAYS.indexOf($t);if(Ct!==-1)return Ct;const kt=$t.substr(0,3),Mt=SHORT_DAYS.indexOf(kt);if(Mt!==-1)return Mt;throw new Error(invalidTimeUnit("day",xt))}}function dateTimeParts(xt,$t){const Ct=[];if($t&&xt.day!==void 0&&keys(xt).length>1&&(warn(droppedDay(xt)),xt=duplicate(xt),delete xt.day),xt.year!==void 0?Ct.push(xt.year):Ct.push(2012),xt.month!==void 0){const kt=$t?normalizeMonth(xt.month):xt.month;Ct.push(kt)}else if(xt.quarter!==void 0){const kt=$t?normalizeQuarter(xt.quarter):xt.quarter;Ct.push(isNumber$1(kt)?kt*3:`${kt}*3`)}else Ct.push(0);if(xt.date!==void 0)Ct.push(xt.date);else if(xt.day!==void 0){const kt=$t?normalizeDay(xt.day):xt.day;Ct.push(isNumber$1(kt)?kt+1:`${kt}+1`)}else Ct.push(1);for(const kt of["hours","minutes","seconds","milliseconds"]){const Mt=xt[kt];Ct.push(typeof Mt>"u"?0:Mt)}return Ct}function dateTimeToExpr(xt){const Ct=dateTimeParts(xt,!0).join(", ");return xt.utc?`utc(${Ct})`:`datetime(${Ct})`}function dateTimeExprToExpr(xt){const Ct=dateTimeParts(xt,!1).join(", ");return xt.utc?`utc(${Ct})`:`datetime(${Ct})`}function dateTimeToTimestamp(xt){const $t=dateTimeParts(xt,!0);return xt.utc?+new Date(Date.UTC(...$t)):+new Date(...$t)}const LOCAL_SINGLE_TIMEUNIT_INDEX={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},TIMEUNIT_PARTS=keys(LOCAL_SINGLE_TIMEUNIT_INDEX);function isLocalSingleTimeUnit(xt){return!!LOCAL_SINGLE_TIMEUNIT_INDEX[xt]}function isBinnedTimeUnit(xt){return isObject(xt)?xt.binned:isBinnedTimeUnitString(xt)}function isBinnedTimeUnitString(xt){return xt&&xt.startsWith("binned")}function isUTCTimeUnit(xt){return xt.startsWith("utc")}function getLocalTimeUnitFromUTCTimeUnit(xt){return xt.substring(3)}const VEGALITE_TIMEFORMAT={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function getTimeUnitParts(xt){return TIMEUNIT_PARTS.filter($t=>containsTimeUnit(xt,$t))}function getSmallestTimeUnitPart(xt){const $t=getTimeUnitParts(xt);return $t[$t.length-1]}function containsTimeUnit(xt,$t){const Ct=xt.indexOf($t);return!(Ct<0||Ct>0&&$t==="seconds"&&xt.charAt(Ct-1)==="i"||xt.length>Ct+3&&$t==="day"&&xt.charAt(Ct+3)==="o"||Ct>0&&$t==="year"&&xt.charAt(Ct-1)==="f")}function fieldExpr(xt,$t,{end:Ct}={end:!1}){const kt=accessPathWithDatum($t),Mt=isUTCTimeUnit(xt)?"utc":"";function Ft(Vt){return Vt==="quarter"?`(${Mt}quarter(${kt})-1)`:`${Mt}${Vt}(${kt})`}let jt;const Bt={};for(const Vt of TIMEUNIT_PARTS)containsTimeUnit(xt,Vt)&&(Bt[Vt]=Ft(Vt),jt=Vt);return Ct&&(Bt[jt]+="+1"),dateTimeExprToExpr(Bt)}function timeUnitSpecifierExpression(xt){if(!xt)return;const $t=getTimeUnitParts(xt);return`timeUnitSpecifier(${stringify$1($t)}, ${stringify$1(VEGALITE_TIMEFORMAT)})`}function formatExpression(xt,$t,Ct){if(!xt)return;const kt=timeUnitSpecifierExpression(xt);return`${Ct||isUTCTimeUnit(xt)?"utc":"time"}Format(${$t}, ${kt})`}function normalizeTimeUnit(xt){if(!xt)return;let $t;return isString(xt)?isBinnedTimeUnitString(xt)?$t={unit:xt.substring(6),binned:!0}:$t={unit:xt}:isObject(xt)&&($t={...xt,...xt.unit?{unit:xt.unit}:{}}),isUTCTimeUnit($t.unit)&&($t.utc=!0,$t.unit=getLocalTimeUnitFromUTCTimeUnit($t.unit)),$t}function timeUnitToString(xt){const{utc:$t,...Ct}=normalizeTimeUnit(xt);return Ct.unit?($t?"utc":"")+keys(Ct).map(kt=>varName(`${kt==="unit"?"":`_${kt}_`}${Ct[kt]}`)).join(""):($t?"utc":"")+"timeunit"+keys(Ct).map(kt=>varName(`_${kt}_${Ct[kt]}`)).join("")}function durationExpr(xt,$t=Ct=>Ct){const Ct=normalizeTimeUnit(xt),kt=getSmallestTimeUnitPart(Ct.unit);if(kt&&kt!=="day"){const Mt={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:Ft,part:jt}=getDateTimePartAndStep(kt,Ct.step),Bt={...Mt,[jt]:+Mt[jt]+Ft};return`${$t(dateTimeToExpr(Bt))} - ${$t(dateTimeToExpr(Mt))}`}}const DATE_PARTS={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function isDatePart(xt){return!!DATE_PARTS[xt]}function getDateTimePartAndStep(xt,$t=1){if(isDatePart(xt))return{part:xt,step:$t};switch(xt){case"day":case"dayofyear":return{part:"date",step:$t};case"quarter":return{part:"month",step:$t*3};case"week":return{part:"date",step:$t*7}}}function isSelectionPredicate(xt){return xt==null?void 0:xt.param}function isFieldEqualPredicate(xt){return!!(xt!=null&&xt.field)&&xt.equal!==void 0}function isFieldLTPredicate(xt){return!!(xt!=null&&xt.field)&&xt.lt!==void 0}function isFieldLTEPredicate(xt){return!!(xt!=null&&xt.field)&&xt.lte!==void 0}function isFieldGTPredicate(xt){return!!(xt!=null&&xt.field)&&xt.gt!==void 0}function isFieldGTEPredicate(xt){return!!(xt!=null&&xt.field)&&xt.gte!==void 0}function isFieldRangePredicate(xt){if(xt!=null&&xt.field){if(isArray(xt.range)&&xt.range.length===2)return!0;if(isSignalRef(xt.range))return!0}return!1}function isFieldOneOfPredicate(xt){return!!(xt!=null&&xt.field)&&(isArray(xt.oneOf)||isArray(xt.in))}function isFieldValidPredicate(xt){return!!(xt!=null&&xt.field)&&xt.valid!==void 0}function isFieldPredicate(xt){return isFieldOneOfPredicate(xt)||isFieldEqualPredicate(xt)||isFieldRangePredicate(xt)||isFieldLTPredicate(xt)||isFieldGTPredicate(xt)||isFieldLTEPredicate(xt)||isFieldGTEPredicate(xt)}function predicateValueExpr(xt,$t){return valueExpr(xt,{timeUnit:$t,wrapTime:!0})}function predicateValuesExpr(xt,$t){return xt.map(Ct=>predicateValueExpr(Ct,$t))}function fieldFilterExpression(xt,$t=!0){const{field:Ct}=xt,kt=normalizeTimeUnit(xt.timeUnit),{unit:Mt,binned:Ft}=kt||{},jt=vgField(xt,{expr:"datum"}),Bt=Mt?`time(${Ft?jt:fieldExpr(Mt,Ct)})`:jt;if(isFieldEqualPredicate(xt))return`${Bt}===${predicateValueExpr(xt.equal,Mt)}`;if(isFieldLTPredicate(xt)){const Vt=xt.lt;return`${Bt}<${predicateValueExpr(Vt,Mt)}`}else if(isFieldGTPredicate(xt)){const Vt=xt.gt;return`${Bt}>${predicateValueExpr(Vt,Mt)}`}else if(isFieldLTEPredicate(xt)){const Vt=xt.lte;return`${Bt}<=${predicateValueExpr(Vt,Mt)}`}else if(isFieldGTEPredicate(xt)){const Vt=xt.gte;return`${Bt}>=${predicateValueExpr(Vt,Mt)}`}else{if(isFieldOneOfPredicate(xt))return`indexof([${predicateValuesExpr(xt.oneOf,Mt).join(",")}], ${Bt}) !== -1`;if(isFieldValidPredicate(xt))return fieldValidPredicate(Bt,xt.valid);if(isFieldRangePredicate(xt)){const{range:Vt}=xt,zt=isSignalRef(Vt)?{signal:`${Vt.signal}[0]`}:Vt[0],Ht=isSignalRef(Vt)?{signal:`${Vt.signal}[1]`}:Vt[1];if(zt!==null&&Ht!==null&&$t)return"inrange("+Bt+", ["+predicateValueExpr(zt,Mt)+", "+predicateValueExpr(Ht,Mt)+"])";const Gt=[];return zt!==null&&Gt.push(`${Bt} >= ${predicateValueExpr(zt,Mt)}`),Ht!==null&&Gt.push(`${Bt} <= ${predicateValueExpr(Ht,Mt)}`),Gt.length>0?Gt.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${stringify$1(xt)}`)}function fieldValidPredicate(xt,$t=!0){return $t?`isValid(${xt}) && isFinite(+${xt})`:`!isValid(${xt}) || !isFinite(+${xt})`}function normalizePredicate$1(xt){return isFieldPredicate(xt)&&xt.timeUnit?{...xt,timeUnit:normalizeTimeUnit(xt.timeUnit)}:xt}const Type={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function isContinuous(xt){return xt==="quantitative"||xt==="temporal"}function isDiscrete$1(xt){return xt==="ordinal"||xt==="nominal"}const QUANTITATIVE=Type.quantitative,ORDINAL=Type.ordinal,TEMPORAL=Type.temporal,NOMINAL=Type.nominal,GEOJSON=Type.geojson;function getFullName(xt){if(xt)switch(xt=xt.toLowerCase(),xt){case"q":case QUANTITATIVE:return"quantitative";case"t":case TEMPORAL:return"temporal";case"o":case ORDINAL:return"ordinal";case"n":case NOMINAL:return"nominal";case GEOJSON:return"geojson"}}const ScaleType={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},SCALE_CATEGORY_INDEX={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function scaleCompatible(xt,$t){const Ct=SCALE_CATEGORY_INDEX[xt],kt=SCALE_CATEGORY_INDEX[$t];return Ct===kt||Ct==="ordinal-position"&&kt==="time"||kt==="ordinal-position"&&Ct==="time"}const SCALE_PRECEDENCE_INDEX={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function scaleTypePrecedence(xt){return SCALE_PRECEDENCE_INDEX[xt]}const QUANTITATIVE_SCALES=new Set(["linear","log","pow","sqrt","symlog"]),CONTINUOUS_TO_CONTINUOUS_SCALES=new Set([...QUANTITATIVE_SCALES,"time","utc"]);function isQuantitative(xt){return QUANTITATIVE_SCALES.has(xt)}const CONTINUOUS_TO_DISCRETE_SCALES=new Set(["quantile","quantize","threshold"]),CONTINUOUS_DOMAIN_SCALES=new Set([...CONTINUOUS_TO_CONTINUOUS_SCALES,...CONTINUOUS_TO_DISCRETE_SCALES,"sequential","identity"]),DISCRETE_DOMAIN_SCALES=new Set(["ordinal","bin-ordinal","point","band"]);function hasDiscreteDomain(xt){return DISCRETE_DOMAIN_SCALES.has(xt)}function hasContinuousDomain(xt){return CONTINUOUS_DOMAIN_SCALES.has(xt)}function isContinuousToContinuous(xt){return CONTINUOUS_TO_CONTINUOUS_SCALES.has(xt)}function isContinuousToDiscrete(xt){return CONTINUOUS_TO_DISCRETE_SCALES.has(xt)}const defaultScaleConfig={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0};function isExtendedScheme(xt){return!isString(xt)&&!!xt.name}function isParameterDomain(xt){return xt==null?void 0:xt.param}function isDomainUnionWith(xt){return xt==null?void 0:xt.unionWith}function isFieldRange(xt){return isObject(xt)&&"field"in xt}const SCALE_PROPERTY_INDEX={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type,domain:domain$1,range:range$1,rangeMax,rangeMin,scheme,...NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTY_INDEX}=SCALE_PROPERTY_INDEX,NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES=keys(NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTY_INDEX);function scaleTypeSupportProperty(xt,$t){switch($t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(xt);case"bins":return!["point","band","identity","ordinal"].includes(xt);case"round":return isContinuousToContinuous(xt)||xt==="band"||xt==="point";case"padding":case"rangeMin":case"rangeMax":return isContinuousToContinuous(xt)||["point","band"].includes(xt);case"paddingOuter":case"align":return["point","band"].includes(xt);case"paddingInner":return xt==="band";case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return isContinuousToContinuous(xt);case"nice":return isContinuousToContinuous(xt)||xt==="quantize"||xt==="threshold";case"exponent":return xt==="pow";case"base":return xt==="log";case"constant":return xt==="symlog";case"zero":return hasContinuousDomain(xt)&&!contains(["log","time","utc","threshold","quantile"],xt)}}function channelScalePropertyIncompatability(xt,$t){switch($t){case"interpolate":case"scheme":case"domainMid":return isColorChannel(xt)?void 0:cannotUseScalePropertyWithNonColor($t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function scaleTypeSupportDataType(xt,$t){return contains([ORDINAL,NOMINAL],$t)?xt===void 0||hasDiscreteDomain(xt):$t===TEMPORAL?contains([ScaleType.TIME,ScaleType.UTC,void 0],xt):$t===QUANTITATIVE?isQuantitative(xt)||isContinuousToDiscrete(xt)||xt===void 0:!0}function channelSupportScaleType(xt,$t,Ct=!1){if(!isScaleChannel(xt))return!1;switch(xt){case X:case Y:case XOFFSET:case YOFFSET:case THETA:case RADIUS:return isContinuousToContinuous($t)||$t==="band"?!0:$t==="point"?!Ct:!1;case SIZE:case STROKEWIDTH:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case ANGLE:return isContinuousToContinuous($t)||isContinuousToDiscrete($t)||contains(["band","point","ordinal"],$t);case COLOR:case FILL:case STROKE:return $t!=="band";case STROKEDASH:case SHAPE:return $t==="ordinal"||isContinuousToDiscrete($t)}}function midPointRefWithPositionInvalidTest(xt){const{channel:$t,channelDef:Ct,markDef:kt,scale:Mt,config:Ft}=xt,jt=midPoint(xt);return isFieldDef(Ct)&&!isCountingAggregateOp(Ct.aggregate)&&Mt&&isContinuousToContinuous(Mt.get("type"))?wrapPositionInvalidTest({fieldDef:Ct,channel:$t,markDef:kt,ref:jt,config:Ft}):jt}function wrapPositionInvalidTest({fieldDef:xt,channel:$t,markDef:Ct,ref:kt,config:Mt}){return getMarkPropOrConfig("invalid",Ct,Mt)===null?[fieldInvalidTestValueRef(xt,$t),kt]:kt}function fieldInvalidTestValueRef(xt,$t){const Ct=fieldInvalidPredicate(xt,!0),Mt=getMainRangeChannel($t)==="y"?{field:{group:"height"}}:{value:0};return{test:Ct,...Mt}}function fieldInvalidPredicate(xt,$t=!0){return fieldValidPredicate(isString(xt)?xt:vgField(xt,{expr:"datum"}),!$t)}function datumDefToExpr(xt){const{datum:$t}=xt;return isDateTime($t)?dateTimeToExpr($t):`${stringify$1($t)}`}function valueRefForFieldOrDatumDef(xt,$t,Ct,kt){const Mt={};if($t&&(Mt.scale=$t),isDatumDef(xt)){const{datum:Ft}=xt;isDateTime(Ft)?Mt.signal=dateTimeToExpr(Ft):isSignalRef(Ft)?Mt.signal=Ft.signal:isExprRef(Ft)?Mt.signal=Ft.expr:Mt.value=Ft}else Mt.field=vgField(xt,Ct);if(kt){const{offset:Ft,band:jt}=kt;Ft&&(Mt.offset=Ft),jt&&(Mt.band=jt)}return Mt}function interpolatedSignalRef({scaleName:xt,fieldOrDatumDef:$t,fieldOrDatumDef2:Ct,offset:kt,startSuffix:Mt,endSuffix:Ft="end",bandPosition:jt=.5}){const Bt=!isSignalRef(jt)&&0<jt&&jt<1?"datum":void 0,Vt=vgField($t,{expr:Bt,suffix:Mt}),zt=Ct!==void 0?vgField(Ct,{expr:Bt}):vgField($t,{suffix:Ft,expr:Bt}),Ht={};if(jt===0||jt===1){Ht.scale=xt;const Gt=jt===0?Vt:zt;Ht.field=Gt}else{const Gt=isSignalRef(jt)?`(1-${jt.signal}) * ${Vt} + ${jt.signal} * ${zt}`:`${1-jt} * ${Vt} + ${jt} * ${zt}`;Ht.signal=`scale("${xt}", ${Gt})`}return kt&&(Ht.offset=kt),Ht}function binSizeExpr({scaleName:xt,fieldDef:$t}){const Ct=vgField($t,{expr:"datum"}),kt=vgField($t,{expr:"datum",suffix:"end"});return`abs(scale("${xt}", ${kt}) - scale("${xt}", ${Ct}))`}function midPoint({channel:xt,channelDef:$t,channel2Def:Ct,markDef:kt,config:Mt,scaleName:Ft,scale:jt,stack:Bt,offset:Vt,defaultRef:zt,bandPosition:Ht}){if($t){if(isFieldOrDatumDef($t)){const Gt=jt==null?void 0:jt.get("type");if(isTypedFieldDef($t)){Ht??(Ht=getBandPosition({fieldDef:$t,fieldDef2:Ct,markDef:kt,config:Mt}));const{bin:qt,timeUnit:Wt,type:Yt}=$t;if(isBinning(qt)||Ht&&Wt&&Yt===TEMPORAL)return Bt!=null&&Bt.impute?valueRefForFieldOrDatumDef($t,Ft,{binSuffix:"mid"},{offset:Vt}):Ht&&!hasDiscreteDomain(Gt)?interpolatedSignalRef({scaleName:Ft,fieldOrDatumDef:$t,bandPosition:Ht,offset:Vt}):valueRefForFieldOrDatumDef($t,Ft,binRequiresRange($t,xt)?{binSuffix:"range"}:{},{offset:Vt});if(isBinned(qt)){if(isFieldDef(Ct))return interpolatedSignalRef({scaleName:Ft,fieldOrDatumDef:$t,fieldOrDatumDef2:Ct,bandPosition:Ht,offset:Vt});warn(channelRequiredForBinned(xt===X?X2:Y2))}}return valueRefForFieldOrDatumDef($t,Ft,hasDiscreteDomain(Gt)?{binSuffix:"range"}:{},{offset:Vt,band:Gt==="band"?Ht??$t.bandPosition??.5:void 0})}else if(isValueDef($t)){const Gt=$t.value,qt=Vt?{offset:Vt}:{};return{...widthHeightValueOrSignalRef(xt,Gt),...qt}}}return isFunction$1(zt)&&(zt=zt()),zt&&{...zt,...Vt?{offset:Vt}:{}}}function widthHeightValueOrSignalRef(xt,$t){return contains(["x","x2"],xt)&&$t==="width"?{field:{group:"width"}}:contains(["y","y2"],xt)&&$t==="height"?{field:{group:"height"}}:signalOrValueRef($t)}function isCustomFormatType(xt){return xt&&xt!=="number"&&xt!=="time"}function customFormatExpr(xt,$t,Ct){return`${xt}(${$t}${Ct?`, ${stringify$1(Ct)}`:""})`}const BIN_RANGE_DELIMITER="  ";function formatSignalRef({fieldOrDatumDef:xt,format:$t,formatType:Ct,expr:kt,normalizeStack:Mt,config:Ft}){var Vt,zt;if(isCustomFormatType(Ct))return formatCustomType({fieldOrDatumDef:xt,format:$t,formatType:Ct,expr:kt,config:Ft});const jt=fieldToFormat(xt,kt,Mt),Bt=channelDefType(xt);if($t===void 0&&Ct===void 0&&Ft.customFormatTypes){if(Bt==="quantitative"){if(Mt&&Ft.normalizedNumberFormatType)return formatCustomType({fieldOrDatumDef:xt,format:Ft.normalizedNumberFormat,formatType:Ft.normalizedNumberFormatType,expr:kt,config:Ft});if(Ft.numberFormatType)return formatCustomType({fieldOrDatumDef:xt,format:Ft.numberFormat,formatType:Ft.numberFormatType,expr:kt,config:Ft})}if(Bt==="temporal"&&Ft.timeFormatType&&isFieldDef(xt)&&xt.timeUnit===void 0)return formatCustomType({fieldOrDatumDef:xt,format:Ft.timeFormat,formatType:Ft.timeFormatType,expr:kt,config:Ft})}if(isFieldOrDatumDefForTimeFormat(xt)){const Ht=timeFormatExpression({field:jt,timeUnit:isFieldDef(xt)?(Vt=normalizeTimeUnit(xt.timeUnit))==null?void 0:Vt.unit:void 0,format:$t,formatType:Ft.timeFormatType,rawTimeFormat:Ft.timeFormat,isUTCScale:isScaleFieldDef(xt)&&((zt=xt.scale)==null?void 0:zt.type)===ScaleType.UTC});return Ht?{signal:Ht}:void 0}if($t=numberFormat({type:Bt,specifiedFormat:$t,config:Ft,normalizeStack:Mt}),isFieldDef(xt)&&isBinning(xt.bin)){const Ht=vgField(xt,{expr:kt,binSuffix:"end"});return{signal:binFormatExpression(jt,Ht,$t,Ct,Ft)}}else return $t||channelDefType(xt)==="quantitative"?{signal:`${formatExpr(jt,$t)}`}:{signal:`isValid(${jt}) ? ${jt} : ""+${jt}`}}function fieldToFormat(xt,$t,Ct){return isFieldDef(xt)?Ct?`${vgField(xt,{expr:$t,suffix:"end"})}-${vgField(xt,{expr:$t,suffix:"start"})}`:vgField(xt,{expr:$t}):datumDefToExpr(xt)}function formatCustomType({fieldOrDatumDef:xt,format:$t,formatType:Ct,expr:kt,normalizeStack:Mt,config:Ft,field:jt}){if(jt??(jt=fieldToFormat(xt,kt,Mt)),jt!=="datum.value"&&isFieldDef(xt)&&isBinning(xt.bin)){const Bt=vgField(xt,{expr:kt,binSuffix:"end"});return{signal:binFormatExpression(jt,Bt,$t,Ct,Ft)}}return{signal:customFormatExpr(Ct,jt,$t)}}function guideFormat(xt,$t,Ct,kt,Mt,Ft){var jt;if(!(isString(kt)&&isCustomFormatType(kt))&&!(Ct===void 0&&kt===void 0&&Mt.customFormatTypes&&channelDefType(xt)==="quantitative"&&(Mt.normalizedNumberFormatType&&isPositionFieldOrDatumDef(xt)&&xt.stack==="normalize"||Mt.numberFormatType))){if(isPositionFieldOrDatumDef(xt)&&xt.stack==="normalize"&&Mt.normalizedNumberFormat)return numberFormat({type:"quantitative",config:Mt,normalizeStack:!0});if(isFieldOrDatumDefForTimeFormat(xt)){const Bt=isFieldDef(xt)?(jt=normalizeTimeUnit(xt.timeUnit))==null?void 0:jt.unit:void 0;return Bt===void 0&&Mt.customFormatTypes&&Mt.timeFormatType?void 0:timeFormat({specifiedFormat:Ct,timeUnit:Bt,config:Mt,omitTimeFormatConfig:Ft})}return numberFormat({type:$t,specifiedFormat:Ct,config:Mt})}}function guideFormatType(xt,$t,Ct){var kt;if(xt&&(isSignalRef(xt)||xt==="number"||xt==="time"))return xt;if(isFieldOrDatumDefForTimeFormat($t)&&Ct!=="time"&&Ct!=="utc")return isFieldDef($t)&&((kt=normalizeTimeUnit($t==null?void 0:$t.timeUnit))!=null&&kt.utc)?"utc":"time"}function numberFormat({type:xt,specifiedFormat:$t,config:Ct,normalizeStack:kt}){if(isString($t))return $t;if(xt===QUANTITATIVE)return kt?Ct.normalizedNumberFormat:Ct.numberFormat}function timeFormat({specifiedFormat:xt,timeUnit:$t,config:Ct,omitTimeFormatConfig:kt}){return xt||($t?{signal:timeUnitSpecifierExpression($t)}:kt?void 0:Ct.timeFormat)}function formatExpr(xt,$t){return`format(${xt}, "${$t||""}")`}function binNumberFormatExpr(xt,$t,Ct,kt){return isCustomFormatType(Ct)?customFormatExpr(Ct,xt,$t):formatExpr(xt,(isString($t)?$t:void 0)??kt.numberFormat)}function binFormatExpression(xt,$t,Ct,kt,Mt){if(Ct===void 0&&kt===void 0&&Mt.customFormatTypes&&Mt.numberFormatType)return binFormatExpression(xt,$t,Mt.numberFormat,Mt.numberFormatType,Mt);const Ft=binNumberFormatExpr(xt,Ct,kt,Mt),jt=binNumberFormatExpr($t,Ct,kt,Mt);return`${fieldValidPredicate(xt,!1)} ? "null" : ${Ft} + "${BIN_RANGE_DELIMITER}" + ${jt}`}function timeFormatExpression({field:xt,timeUnit:$t,format:Ct,formatType:kt,rawTimeFormat:Mt,isUTCScale:Ft}){return!$t||Ct?!$t&&kt?`${kt}(${xt}, '${Ct}')`:(Ct=isString(Ct)?Ct:Mt,`${Ft?"utc":"time"}Format(${xt}, '${Ct}')`):formatExpression($t,xt,Ft)}const Mark={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},ARC=Mark.arc,AREA=Mark.area,BAR=Mark.bar,IMAGE=Mark.image,LINE=Mark.line,POINT=Mark.point,RECT=Mark.rect,RULE=Mark.rule,TEXT=Mark.text,TICK=Mark.tick,TRAIL=Mark.trail,CIRCLE=Mark.circle,SQUARE=Mark.square,GEOSHAPE=Mark.geoshape;function isPathMark(xt){return["line","area","trail"].includes(xt)}function isRectBasedMark(xt){return["rect","bar","image","arc"].includes(xt)}const PRIMITIVE_MARKS=new Set(keys(Mark));function isMarkDef(xt){return xt.type}const STROKE_CONFIG=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],FILL_CONFIG=["fill","fillOpacity"],FILL_STROKE_CONFIG=[...STROKE_CONFIG,...FILL_CONFIG],VL_ONLY_MARK_CONFIG_INDEX={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},VL_ONLY_MARK_CONFIG_PROPERTIES=keys(VL_ONLY_MARK_CONFIG_INDEX),VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],line:["point"],tick:["bandSize","thickness"]},defaultMarkConfig={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},MARK_CONFIG_INDEX={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},MARK_CONFIGS=keys(MARK_CONFIG_INDEX);function isRelativeBandSize(xt){return xt&&xt.band!=null}const BAR_CORNER_RADIUS_INDEX={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},DEFAULT_RECT_BAND_SIZE=5,defaultBarConfig={binSpacing:1,continuousBandSize:DEFAULT_RECT_BAND_SIZE,minBandSize:.25,timeUnitBandPosition:.5},defaultRectConfig={binSpacing:0,continuousBandSize:DEFAULT_RECT_BAND_SIZE,minBandSize:.25,timeUnitBandPosition:.5},defaultTickConfig={thickness:1};function getMarkType(xt){return isMarkDef(xt)?xt.type:xt}const DEFAULT_SORT_OP="min",SORT_BY_CHANNEL_INDEX={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function isSortByChannel(xt){return xt in SORT_BY_CHANNEL_INDEX}function isSortByEncoding(xt){return!!(xt!=null&&xt.encoding)}function isSortField(xt){return xt&&(xt.op==="count"||!!xt.field)}function isSortArray(xt){return xt&&isArray(xt)}function isFacetMapping(xt){return"row"in xt||"column"in xt}function isFacetFieldDef(xt){return!!xt&&"header"in xt}function isFacetSpec(xt){return"facet"in xt}function isConditionalParameter(xt){return xt.param}function isRepeatRef(xt){return xt&&!isString(xt)&&"repeat"in xt}function toFieldDefBase(xt){const{field:$t,timeUnit:Ct,bin:kt,aggregate:Mt}=xt;return{...Ct?{timeUnit:Ct}:{},...kt?{bin:kt}:{},...Mt?{aggregate:Mt}:{},field:$t}}function isSortableFieldDef(xt){return"sort"in xt}function getBandPosition({fieldDef:xt,fieldDef2:$t,markDef:Ct,config:kt}){if(isFieldOrDatumDef(xt)&&xt.bandPosition!==void 0)return xt.bandPosition;if(isFieldDef(xt)){const{timeUnit:Mt,bin:Ft}=xt;if(Mt&&!$t)return getMarkConfig("timeUnitBandPosition",Ct,kt);if(isBinning(Ft))return .5}}function getBandSize({channel:xt,fieldDef:$t,fieldDef2:Ct,markDef:kt,config:Mt,scaleType:Ft,useVlSizeChannel:jt}){var zt,Ht,Gt;const Bt=getSizeChannel(xt),Vt=getMarkPropOrConfig(jt?"size":Bt,kt,Mt,{vgChannel:Bt});if(Vt!==void 0)return Vt;if(isFieldDef($t)){const{timeUnit:qt,bin:Wt}=$t;if(qt&&!Ct)return{band:getMarkConfig("timeUnitBandSize",kt,Mt)};if(isBinning(Wt)&&!hasDiscreteDomain(Ft))return{band:1}}if(isRectBasedMark(kt.type))return Ft?hasDiscreteDomain(Ft)?((zt=Mt[kt.type])==null?void 0:zt.discreteBandSize)||{band:1}:(Ht=Mt[kt.type])==null?void 0:Ht.continuousBandSize:(Gt=Mt[kt.type])==null?void 0:Gt.discreteBandSize}function hasBandEnd(xt,$t,Ct,kt){return isBinning(xt.bin)||xt.timeUnit&&isTypedFieldDef(xt)&&xt.type==="temporal"?getBandPosition({fieldDef:xt,fieldDef2:$t,markDef:Ct,config:kt})!==void 0:!1}function isOrderOnlyDef(xt){return xt&&!!xt.sort&&!xt.field}function isConditionalDef(xt){return xt&&"condition"in xt}function hasConditionalFieldDef(xt){const $t=xt==null?void 0:xt.condition;return!!$t&&!isArray($t)&&isFieldDef($t)}function hasConditionalFieldOrDatumDef(xt){const $t=xt==null?void 0:xt.condition;return!!$t&&!isArray($t)&&isFieldOrDatumDef($t)}function hasConditionalValueDef(xt){const $t=xt==null?void 0:xt.condition;return!!$t&&(isArray($t)||isValueDef($t))}function isFieldDef(xt){return xt&&(!!xt.field||xt.aggregate==="count")}function channelDefType(xt){return xt==null?void 0:xt.type}function isDatumDef(xt){return xt&&"datum"in xt}function isContinuousFieldOrDatumDef(xt){return isTypedFieldDef(xt)&&!isDiscrete(xt)||isNumericDataDef(xt)}function isUnbinnedQuantitativeFieldOrDatumDef(xt){return isTypedFieldDef(xt)&&xt.type==="quantitative"&&!xt.bin||isNumericDataDef(xt)}function isNumericDataDef(xt){return isDatumDef(xt)&&isNumber$1(xt.datum)}function isFieldOrDatumDef(xt){return isFieldDef(xt)||isDatumDef(xt)}function isTypedFieldDef(xt){return xt&&("field"in xt||xt.aggregate==="count")&&"type"in xt}function isValueDef(xt){return xt&&"value"in xt&&"value"in xt}function isScaleFieldDef(xt){return xt&&("scale"in xt||"sort"in xt)}function isPositionFieldOrDatumDef(xt){return xt&&("axis"in xt||"stack"in xt||"impute"in xt)}function isMarkPropFieldOrDatumDef(xt){return xt&&"legend"in xt}function isStringFieldOrDatumDef(xt){return xt&&("format"in xt||"formatType"in xt)}function toStringFieldDef(xt){return omit(xt,["legend","axis","header","scale"])}function isOpFieldDef(xt){return"op"in xt}function vgField(xt,$t={}){let Ct=xt.field;const kt=$t.prefix;let Mt=$t.suffix,Ft="";if(isCount(xt))Ct=internalField("count");else{let jt;if(!$t.nofn)if(isOpFieldDef(xt))jt=xt.op;else{const{bin:Bt,aggregate:Vt,timeUnit:zt}=xt;isBinning(Bt)?(jt=binToString(Bt),Mt=($t.binSuffix??"")+($t.suffix??"")):Vt?isArgmaxDef(Vt)?(Ft=`["${Ct}"]`,Ct=`argmax_${Vt.argmax}`):isArgminDef(Vt)?(Ft=`["${Ct}"]`,Ct=`argmin_${Vt.argmin}`):jt=String(Vt):zt&&!isBinnedTimeUnit(zt)&&(jt=timeUnitToString(zt),Mt=(!["range","mid"].includes($t.binSuffix)&&$t.binSuffix||"")+($t.suffix??""))}jt&&(Ct=Ct?`${jt}_${Ct}`:jt)}return Mt&&(Ct=`${Ct}_${Mt}`),kt&&(Ct=`${kt}_${Ct}`),$t.forAs?removePathFromField(Ct):$t.expr?flatAccessWithDatum(Ct,$t.expr)+Ft:replacePathInField(Ct)+Ft}function isDiscrete(xt){switch(xt.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return isFieldDef(xt)&&!!xt.bin;case"temporal":return!1}throw new Error(invalidFieldType(xt.type))}function isDiscretizing(xt){var $t;return isScaleFieldDef(xt)&&isContinuousToDiscrete(($t=xt.scale)==null?void 0:$t.type)}function isCount(xt){return xt.aggregate==="count"}function verbalTitleFormatter(xt,$t){var jt;const{field:Ct,bin:kt,timeUnit:Mt,aggregate:Ft}=xt;if(Ft==="count")return $t.countTitle;if(isBinning(kt))return`${Ct} (binned)`;if(Mt&&!isBinnedTimeUnit(Mt)){const Bt=(jt=normalizeTimeUnit(Mt))==null?void 0:jt.unit;if(Bt)return`${Ct} (${getTimeUnitParts(Bt).join("-")})`}else if(Ft)return isArgmaxDef(Ft)?`${Ct} for max ${Ft.argmax}`:isArgminDef(Ft)?`${Ct} for min ${Ft.argmin}`:`${titleCase(Ft)} of ${Ct}`;return Ct}function functionalTitleFormatter(xt){const{aggregate:$t,bin:Ct,timeUnit:kt,field:Mt}=xt;if(isArgmaxDef($t))return`${Mt} for argmax(${$t.argmax})`;if(isArgminDef($t))return`${Mt} for argmin(${$t.argmin})`;const Ft=kt&&!isBinnedTimeUnit(kt)?normalizeTimeUnit(kt):void 0,jt=$t||(Ft==null?void 0:Ft.unit)||(Ft==null?void 0:Ft.maxbins)&&"timeunit"||isBinning(Ct)&&"bin";return jt?`${jt.toUpperCase()}(${Mt})`:Mt}const defaultTitleFormatter=(xt,$t)=>{switch($t.fieldTitle){case"plain":return xt.field;case"functional":return functionalTitleFormatter(xt);default:return verbalTitleFormatter(xt,$t)}};let titleFormatter=defaultTitleFormatter;function setTitleFormatter(xt){titleFormatter=xt}function resetTitleFormatter(){setTitleFormatter(defaultTitleFormatter)}function title(xt,$t,{allowDisabling:Ct,includeDefault:kt=!0}){var Bt;const Mt=(Bt=getGuide(xt))==null?void 0:Bt.title;if(!isFieldDef(xt))return Mt??xt.title;const Ft=xt,jt=kt?defaultTitle(Ft,$t):void 0;return Ct?getFirstDefined(Mt,Ft.title,jt):Mt??Ft.title??jt}function getGuide(xt){if(isPositionFieldOrDatumDef(xt)&&xt.axis)return xt.axis;if(isMarkPropFieldOrDatumDef(xt)&&xt.legend)return xt.legend;if(isFacetFieldDef(xt)&&xt.header)return xt.header}function defaultTitle(xt,$t){return titleFormatter(xt,$t)}function getFormatMixins(xt){if(isStringFieldOrDatumDef(xt)){const{format:$t,formatType:Ct}=xt;return{format:$t,formatType:Ct}}else{const $t=getGuide(xt)??{},{format:Ct,formatType:kt}=$t;return{format:Ct,formatType:kt}}}function defaultType$2(xt,$t){var Ft;switch($t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(isSortableFieldDef(xt)&&isArray(xt.sort))return"ordinal";const{aggregate:Ct,bin:kt,timeUnit:Mt}=xt;if(Mt)return"temporal";if(kt||Ct&&!isArgmaxDef(Ct)&&!isArgminDef(Ct))return"quantitative";if(isScaleFieldDef(xt)&&((Ft=xt.scale)!=null&&Ft.type))switch(SCALE_CATEGORY_INDEX[xt.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function getFieldDef(xt){if(isFieldDef(xt))return xt;if(hasConditionalFieldDef(xt))return xt.condition}function getFieldOrDatumDef(xt){if(isFieldOrDatumDef(xt))return xt;if(hasConditionalFieldOrDatumDef(xt))return xt.condition}function initChannelDef(xt,$t,Ct,kt={}){if(isString(xt)||isNumber$1(xt)||isBoolean$2(xt)){const Mt=isString(xt)?"string":isNumber$1(xt)?"number":"boolean";return warn(primitiveChannelDef($t,Mt,xt)),{value:xt}}return isFieldOrDatumDef(xt)?initFieldOrDatumDef(xt,$t,Ct,kt):hasConditionalFieldOrDatumDef(xt)?{...xt,condition:initFieldOrDatumDef(xt.condition,$t,Ct,kt)}:xt}function initFieldOrDatumDef(xt,$t,Ct,kt){if(isStringFieldOrDatumDef(xt)){const{format:Mt,formatType:Ft,...jt}=xt;if(isCustomFormatType(Ft)&&!Ct.customFormatTypes)return warn(customFormatTypeNotAllowed($t)),initFieldOrDatumDef(jt,$t,Ct,kt)}else{const Mt=isPositionFieldOrDatumDef(xt)?"axis":isMarkPropFieldOrDatumDef(xt)?"legend":isFacetFieldDef(xt)?"header":null;if(Mt&&xt[Mt]){const{format:Ft,formatType:jt,...Bt}=xt[Mt];if(isCustomFormatType(jt)&&!Ct.customFormatTypes)return warn(customFormatTypeNotAllowed($t)),initFieldOrDatumDef({...xt,[Mt]:Bt},$t,Ct,kt)}}return isFieldDef(xt)?initFieldDef(xt,$t,kt):initDatumDef(xt)}function initDatumDef(xt){let $t=xt.type;if($t)return xt;const{datum:Ct}=xt;return $t=isNumber$1(Ct)?"quantitative":isString(Ct)?"nominal":isDateTime(Ct)?"temporal":void 0,{...xt,type:$t}}function initFieldDef(xt,$t,{compositeMark:Ct=!1}={}){const{aggregate:kt,timeUnit:Mt,bin:Ft,field:jt}=xt,Bt={...xt};if(!Ct&&kt&&!isAggregateOp(kt)&&!isArgmaxDef(kt)&&!isArgminDef(kt)&&(warn(invalidAggregate(kt)),delete Bt.aggregate),Mt&&(Bt.timeUnit=normalizeTimeUnit(Mt)),jt&&(Bt.field=`${jt}`),isBinning(Ft)&&(Bt.bin=normalizeBin(Ft,$t)),isBinned(Ft)&&!isXorY($t)&&warn(channelShouldNotBeUsedForBinned($t)),isTypedFieldDef(Bt)){const{type:Vt}=Bt,zt=getFullName(Vt);Vt!==zt&&(Bt.type=zt),Vt!=="quantitative"&&isCountingAggregateOp(kt)&&(warn(invalidFieldTypeForCountAggregate(Vt,kt)),Bt.type="quantitative")}else if(!isSecondaryRangeChannel($t)){const Vt=defaultType$2(Bt,$t);Bt.type=Vt}if(isTypedFieldDef(Bt)){const{compatible:Vt,warning:zt}=channelCompatibility(Bt,$t)||{};Vt===!1&&warn(zt)}if(isSortableFieldDef(Bt)&&isString(Bt.sort)){const{sort:Vt}=Bt;if(isSortByChannel(Vt))return{...Bt,sort:{encoding:Vt}};const zt=Vt.substr(1);if(Vt.charAt(0)==="-"&&isSortByChannel(zt))return{...Bt,sort:{encoding:zt,order:"descending"}}}if(isFacetFieldDef(Bt)){const{header:Vt}=Bt;if(Vt){const{orient:zt,...Ht}=Vt;if(zt)return{...Bt,header:{...Ht,labelOrient:Vt.labelOrient||zt,titleOrient:Vt.titleOrient||zt}}}}return Bt}function normalizeBin(xt,$t){return isBoolean$2(xt)?{maxbins:autoMaxBins($t)}:xt==="binned"?{binned:!0}:!xt.maxbins&&!xt.step?{...xt,maxbins:autoMaxBins($t)}:xt}const COMPATIBLE={compatible:!0};function channelCompatibility(xt,$t){const Ct=xt.type;if(Ct==="geojson"&&$t!=="shape")return{compatible:!1,warning:`Channel ${$t} should not be used with a geojson data.`};switch($t){case ROW:case COLUMN:case FACET:return isDiscrete(xt)?COMPATIBLE:{compatible:!1,warning:channelShouldBeDiscrete($t)};case X:case Y:case XOFFSET:case YOFFSET:case COLOR:case FILL:case STROKE:case TEXT$1:case DETAIL:case KEY:case TOOLTIP:case HREF:case URL$1:case ANGLE:case THETA:case RADIUS:case DESCRIPTION:return COMPATIBLE;case LONGITUDE:case LONGITUDE2:case LATITUDE:case LATITUDE2:return Ct!==QUANTITATIVE?{compatible:!1,warning:`Channel ${$t} should be used with a quantitative field only, not ${xt.type} field.`}:COMPATIBLE;case OPACITY:case FILLOPACITY:case STROKEOPACITY:case STROKEWIDTH:case SIZE:case THETA2:case RADIUS2:case X2:case Y2:return Ct==="nominal"&&!xt.sort?{compatible:!1,warning:`Channel ${$t} should not be used with an unsorted discrete field.`}:COMPATIBLE;case SHAPE:case STROKEDASH:return!isDiscrete(xt)&&!isDiscretizing(xt)?{compatible:!1,warning:channelShouldBeDiscreteOrDiscretizing($t)}:COMPATIBLE;case ORDER:return xt.type==="nominal"&&!("sort"in xt)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:COMPATIBLE}}function isFieldOrDatumDefForTimeFormat(xt){const{formatType:$t}=getFormatMixins(xt);return $t==="time"||!$t&&isTimeFieldDef(xt)}function isTimeFieldDef(xt){return xt&&(xt.type==="temporal"||isFieldDef(xt)&&!!xt.timeUnit)}function valueExpr(xt,{timeUnit:$t,type:Ct,wrapTime:kt,undefinedIfExprNotRequired:Mt}){var Vt;const Ft=$t&&((Vt=normalizeTimeUnit($t))==null?void 0:Vt.unit);let jt=Ft||Ct==="temporal",Bt;return isExprRef(xt)?Bt=xt.expr:isSignalRef(xt)?Bt=xt.signal:isDateTime(xt)?(jt=!0,Bt=dateTimeToExpr(xt)):(isString(xt)||isNumber$1(xt))&&jt&&(Bt=`datetime(${stringify$1(xt)})`,isLocalSingleTimeUnit(Ft)&&(isNumber$1(xt)&&xt<1e4||isString(xt)&&isNaN(Date.parse(xt)))&&(Bt=dateTimeToExpr({[Ft]:xt}))),Bt?kt&&jt?`time(${Bt})`:Bt:Mt?void 0:stringify$1(xt)}function valueArray(xt,$t){const{type:Ct}=xt;return $t.map(kt=>{const Mt=isFieldDef(xt)&&!isBinnedTimeUnit(xt.timeUnit)?xt.timeUnit:void 0,Ft=valueExpr(kt,{timeUnit:Mt,type:Ct,undefinedIfExprNotRequired:!0});return Ft!==void 0?{signal:Ft}:kt})}function binRequiresRange(xt,$t){return isBinning(xt.bin)?isScaleChannel($t)&&["ordinal","nominal"].includes(xt.type):(console.warn("Only call this method for binned field defs."),!1)}const CONDITIONAL_AXIS_PROP_INDEX={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function isConditionalAxisValue(xt){return xt==null?void 0:xt.condition}const AXIS_PARTS=["domain","grid","labels","ticks","title"],AXIS_PROPERTY_TYPE={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},COMMON_AXIS_PROPERTIES_INDEX={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},AXIS_PROPERTIES_INDEX={...COMMON_AXIS_PROPERTIES_INDEX,style:1,labelExpr:1,encoding:1};function isAxisProperty(xt){return!!AXIS_PROPERTIES_INDEX[xt]}const AXIS_CONFIGS_INDEX={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},AXIS_CONFIGS=keys(AXIS_CONFIGS_INDEX);function isUnitSpec(xt){return"mark"in xt}class CompositeMarkNormalizer{constructor($t,Ct){this.name=$t,this.run=Ct}hasMatchingType($t){return isUnitSpec($t)?getMarkType($t.mark)===this.name:!1}}function channelHasField(xt,$t){const Ct=xt&&xt[$t];return Ct?isArray(Ct)?some(Ct,kt=>!!kt.field):isFieldDef(Ct)||hasConditionalFieldDef(Ct):!1}function channelHasFieldOrDatum(xt,$t){const Ct=xt&&xt[$t];return Ct?isArray(Ct)?some(Ct,kt=>!!kt.field):isFieldDef(Ct)||isDatumDef(Ct)||hasConditionalFieldOrDatumDef(Ct):!1}function channelHasNestedOffsetScale(xt,$t){if(isXorY($t)){const Ct=xt[$t];if((isFieldDef(Ct)||isDatumDef(Ct))&&(isDiscrete$1(Ct.type)||isFieldDef(Ct)&&Ct.timeUnit)){const kt=getOffsetScaleChannel($t);return channelHasFieldOrDatum(xt,kt)}}return!1}function isAggregate$1(xt){return some(CHANNELS,$t=>{if(channelHasField(xt,$t)){const Ct=xt[$t];if(isArray(Ct))return some(Ct,kt=>!!kt.aggregate);{const kt=getFieldDef(Ct);return kt&&!!kt.aggregate}}return!1})}function extractTransformsFromEncoding(xt,$t){const Ct=[],kt=[],Mt=[],Ft=[],jt={};return forEach(xt,(Bt,Vt)=>{if(isFieldDef(Bt)){const{field:zt,aggregate:Ht,bin:Gt,timeUnit:qt,...Wt}=Bt;if(Ht||qt||Gt){const Yt=getGuide(Bt),Kt=Yt==null?void 0:Yt.title;let Xt=vgField(Bt,{forAs:!0});const Qt={...Kt?[]:{title:title(Bt,$t,{allowDisabling:!0})},...Wt,field:Xt};if(Ht){let Jt;if(isArgmaxDef(Ht)?(Jt="argmax",Xt=vgField({op:"argmax",field:Ht.argmax},{forAs:!0}),Qt.field=`${Xt}.${zt}`):isArgminDef(Ht)?(Jt="argmin",Xt=vgField({op:"argmin",field:Ht.argmin},{forAs:!0}),Qt.field=`${Xt}.${zt}`):Ht!=="boxplot"&&Ht!=="errorbar"&&Ht!=="errorband"&&(Jt=Ht),Jt){const Zt={op:Jt,as:Xt};zt&&(Zt.field=zt),Ft.push(Zt)}}else if(Ct.push(Xt),isTypedFieldDef(Bt)&&isBinning(Gt)){if(kt.push({bin:Gt,field:zt,as:Xt}),Ct.push(vgField(Bt,{binSuffix:"end"})),binRequiresRange(Bt,Vt)&&Ct.push(vgField(Bt,{binSuffix:"range"})),isXorY(Vt)){const Jt={field:`${Xt}_end`};jt[`${Vt}2`]=Jt}Qt.bin="binned",isSecondaryRangeChannel(Vt)||(Qt.type=QUANTITATIVE)}else if(qt&&!isBinnedTimeUnit(qt)){Mt.push({timeUnit:qt,field:zt,as:Xt});const Jt=isTypedFieldDef(Bt)&&Bt.type!==TEMPORAL&&"time";Jt&&(Vt===TEXT$1||Vt===TOOLTIP?Qt.formatType=Jt:isNonPositionScaleChannel(Vt)?Qt.legend={formatType:Jt,...Qt.legend}:isXorY(Vt)&&(Qt.axis={formatType:Jt,...Qt.axis}))}jt[Vt]=Qt}else Ct.push(zt),jt[Vt]=xt[Vt]}else jt[Vt]=xt[Vt]}),{bins:kt,timeUnits:Mt,aggregate:Ft,groupby:Ct,encoding:jt}}function markChannelCompatible(xt,$t,Ct){const kt=supportMark($t,Ct);if(kt){if(kt==="binned"){const Mt=xt[$t===X2?X:Y];return!!(isFieldDef(Mt)&&isFieldDef(xt[$t])&&isBinned(Mt.bin))}}else return!1;return!0}function initEncoding(xt,$t,Ct,kt){const Mt={};for(const Ft of keys(xt))isChannel(Ft)||warn(invalidEncodingChannel(Ft));for(let Ft of UNIT_CHANNELS){if(!xt[Ft])continue;const jt=xt[Ft];if(isXorYOffset(Ft)){const Bt=getMainChannelFromOffsetChannel(Ft),Vt=Mt[Bt];if(isFieldDef(Vt)&&isContinuous(Vt.type)&&isFieldDef(jt)&&!Vt.timeUnit){warn(offsetNestedInsideContinuousPositionScaleDropped(Bt));continue}}if(Ft==="angle"&&$t==="arc"&&!xt.theta&&(warn(REPLACE_ANGLE_WITH_THETA),Ft=THETA),!markChannelCompatible(xt,Ft,$t)){warn(incompatibleChannel(Ft,$t));continue}if(Ft===SIZE&&$t==="line"){const Bt=getFieldDef(xt[Ft]);if(Bt!=null&&Bt.aggregate){warn(LINE_WITH_VARYING_SIZE);continue}}if(Ft===COLOR&&(Ct?"fill"in xt:"stroke"in xt)){warn(droppingColor("encoding",{fill:"fill"in xt,stroke:"stroke"in xt}));continue}if(Ft===DETAIL||Ft===ORDER&&!isArray(jt)&&!isValueDef(jt)||Ft===TOOLTIP&&isArray(jt)){if(jt){if(Ft===ORDER){const Bt=xt[Ft];if(isOrderOnlyDef(Bt)){Mt[Ft]=Bt;continue}}Mt[Ft]=array$2(jt).reduce((Bt,Vt)=>(isFieldDef(Vt)?Bt.push(initFieldDef(Vt,Ft)):warn(emptyFieldDef(Vt,Ft)),Bt),[])}}else{if(Ft===TOOLTIP&&jt===null)Mt[Ft]=null;else if(!isFieldDef(jt)&&!isDatumDef(jt)&&!isValueDef(jt)&&!isConditionalDef(jt)&&!isSignalRef(jt)){warn(emptyFieldDef(jt,Ft));continue}Mt[Ft]=initChannelDef(jt,Ft,kt)}}return Mt}function normalizeEncoding(xt,$t){const Ct={};for(const kt of keys(xt)){const Mt=initChannelDef(xt[kt],kt,$t,{compositeMark:!0});Ct[kt]=Mt}return Ct}function fieldDefs(xt){const $t=[];for(const Ct of keys(xt))if(channelHasField(xt,Ct)){const kt=xt[Ct],Mt=array$2(kt);for(const Ft of Mt)isFieldDef(Ft)?$t.push(Ft):hasConditionalFieldDef(Ft)&&$t.push(Ft.condition)}return $t}function forEach(xt,$t,Ct){if(xt)for(const kt of keys(xt)){const Mt=xt[kt];if(isArray(Mt))for(const Ft of Mt)$t.call(Ct,Ft,kt);else $t.call(Ct,Mt,kt)}}function reduce(xt,$t,Ct,kt){return xt?keys(xt).reduce((Mt,Ft)=>{const jt=xt[Ft];return isArray(jt)?jt.reduce((Bt,Vt)=>$t.call(kt,Bt,Vt,Ft),Mt):$t.call(kt,Mt,jt,Ft)},Ct):Ct}function pathGroupingFields(xt,$t){return keys($t).reduce((Ct,kt)=>{switch(kt){case X:case Y:case HREF:case DESCRIPTION:case URL$1:case X2:case Y2:case XOFFSET:case YOFFSET:case THETA:case THETA2:case RADIUS:case RADIUS2:case LATITUDE:case LONGITUDE:case LATITUDE2:case LONGITUDE2:case TEXT$1:case SHAPE:case ANGLE:case TOOLTIP:return Ct;case ORDER:if(xt==="line"||xt==="trail")return Ct;case DETAIL:case KEY:{const Mt=$t[kt];if(isArray(Mt)||isFieldDef(Mt))for(const Ft of array$2(Mt))Ft.aggregate||Ct.push(vgField(Ft,{}));return Ct}case SIZE:if(xt==="trail")return Ct;case COLOR:case FILL:case STROKE:case OPACITY:case FILLOPACITY:case STROKEOPACITY:case STROKEDASH:case STROKEWIDTH:{const Mt=getFieldDef($t[kt]);return Mt&&!Mt.aggregate&&Ct.push(vgField(Mt,{})),Ct}}},[])}function filterTooltipWithAggregatedField(xt){const{tooltip:$t,...Ct}=xt;if(!$t)return{filteredEncoding:Ct};let kt,Mt;if(isArray($t)){for(const Ft of $t)Ft.aggregate?(kt||(kt=[]),kt.push(Ft)):(Mt||(Mt=[]),Mt.push(Ft));kt&&(Ct.tooltip=kt)}else $t.aggregate?Ct.tooltip=$t:Mt=$t;return isArray(Mt)&&Mt.length===1&&(Mt=Mt[0]),{customTooltipWithoutAggregatedField:Mt,filteredEncoding:Ct}}function getCompositeMarkTooltip(xt,$t,Ct,kt=!0){if("tooltip"in Ct)return{tooltip:Ct.tooltip};const Mt=xt.map(({fieldPrefix:jt,titlePrefix:Bt})=>{const Vt=kt?` of ${getTitle($t)}`:"";return{field:jt+$t.field,type:$t.type,title:isSignalRef(Bt)?{signal:`${Bt}"${escape(Vt)}"`}:Bt+Vt}}),Ft=fieldDefs(Ct).map(toStringFieldDef);return{tooltip:[...Mt,...unique(Ft,hash)]}}function getTitle(xt){const{title:$t,field:Ct}=xt;return getFirstDefined($t,Ct)}function makeCompositeAggregatePartFactory(xt,$t,Ct,kt,Mt){const{scale:Ft,axis:jt}=Ct;return({partName:Bt,mark:Vt,positionPrefix:zt,endPositionPrefix:Ht=void 0,extraEncoding:Gt={}})=>{const qt=getTitle(Ct);return partLayerMixins(xt,Bt,Mt,{mark:Vt,encoding:{[$t]:{field:`${zt}_${Ct.field}`,type:Ct.type,...qt!==void 0?{title:qt}:{},...Ft!==void 0?{scale:Ft}:{},...jt!==void 0?{axis:jt}:{}},...isString(Ht)?{[`${$t}2`]:{field:`${Ht}_${Ct.field}`}}:{},...kt,...Gt}})}}function partLayerMixins(xt,$t,Ct,kt){const{clip:Mt,color:Ft,opacity:jt}=xt,Bt=xt.type;return xt[$t]||xt[$t]===void 0&&Ct[$t]?[{...kt,mark:{...Ct[$t],...Mt?{clip:Mt}:{},...Ft?{color:Ft}:{},...jt?{opacity:jt}:{},...isMarkDef(kt.mark)?kt.mark:{type:kt.mark},style:`${Bt}-${String($t)}`,...isBoolean$2(xt[$t])?{}:xt[$t]}}]:[]}function compositeMarkContinuousAxis(xt,$t,Ct){const{encoding:kt}=xt,Mt=$t==="vertical"?"y":"x",Ft=kt[Mt],jt=kt[`${Mt}2`],Bt=kt[`${Mt}Error`],Vt=kt[`${Mt}Error2`];return{continuousAxisChannelDef:filterAggregateFromChannelDef(Ft,Ct),continuousAxisChannelDef2:filterAggregateFromChannelDef(jt,Ct),continuousAxisChannelDefError:filterAggregateFromChannelDef(Bt,Ct),continuousAxisChannelDefError2:filterAggregateFromChannelDef(Vt,Ct),continuousAxis:Mt}}function filterAggregateFromChannelDef(xt,$t){if(xt!=null&&xt.aggregate){const{aggregate:Ct,...kt}=xt;return Ct!==$t&&warn(errorBarContinuousAxisHasCustomizedAggregate(Ct,$t)),kt}else return xt}function compositeMarkOrient(xt,$t){const{mark:Ct,encoding:kt}=xt,{x:Mt,y:Ft}=kt;if(isMarkDef(Ct)&&Ct.orient)return Ct.orient;if(isContinuousFieldOrDatumDef(Mt)){if(isContinuousFieldOrDatumDef(Ft)){const jt=isFieldDef(Mt)&&Mt.aggregate,Bt=isFieldDef(Ft)&&Ft.aggregate;if(!jt&&Bt===$t)return"vertical";if(!Bt&&jt===$t)return"horizontal";if(jt===$t&&Bt===$t)throw new Error("Both x and y cannot have aggregate");return isFieldOrDatumDefForTimeFormat(Ft)&&!isFieldOrDatumDefForTimeFormat(Mt)?"horizontal":"vertical"}return"horizontal"}else{if(isContinuousFieldOrDatumDef(Ft))return"vertical";throw new Error(`Need a valid continuous axis for ${$t}s`)}}const BOXPLOT="boxplot",BOXPLOT_PARTS=["box","median","outliers","rule","ticks"],boxPlotNormalizer=new CompositeMarkNormalizer(BOXPLOT,normalizeBoxPlot);function getBoxPlotType(xt){return isNumber$1(xt)?"tukey":xt}function normalizeBoxPlot(xt,{config:$t}){xt={...xt,encoding:normalizeEncoding(xt.encoding,$t)};const{mark:Ct,encoding:kt,params:Mt,projection:Ft,...jt}=xt,Bt=isMarkDef(Ct)?Ct:{type:Ct};Mt&&warn(selectionNotSupported("boxplot"));const Vt=Bt.extent??$t.boxplot.extent,zt=getMarkPropOrConfig("size",Bt,$t),Ht=Bt.invalid,Gt=getBoxPlotType(Vt),{bins:qt,timeUnits:Wt,transform:Yt,continuousAxisChannelDef:Kt,continuousAxis:Xt,groupby:Qt,aggregate:Jt,encodingWithoutContinuousAxis:Zt,ticksOrient:sn,boxOrient:ln,customTooltipWithoutAggregatedField:dn}=boxParams(xt,Vt,$t),hn=removePathFromField(Kt.field),{color:cn,size:pn,...yn}=Zt,gn=jn=>makeCompositeAggregatePartFactory(Bt,Xt,Kt,jn,$t.boxplot),En=gn(yn),bn=gn(Zt),xn=(isObject($t.boxplot.box)?$t.boxplot.box.color:$t.mark.color)||"#4c78a8",Cn=gn({...yn,...pn?{size:pn}:{},color:{condition:{test:`datum['lower_box_${Kt.field}'] >= datum['upper_box_${Kt.field}']`,...cn||{value:xn}}}}),$n=getCompositeMarkTooltip([{fieldPrefix:Gt==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:Gt==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],Kt,Zt),wn={type:"tick",color:"black",opacity:1,orient:sn,invalid:Ht,aria:!1},Rn=Gt==="min-max"?$n:getCompositeMarkTooltip([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],Kt,Zt),Dn=[...En({partName:"rule",mark:{type:"rule",invalid:Ht,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:Rn}),...En({partName:"rule",mark:{type:"rule",invalid:Ht,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:Rn}),...En({partName:"ticks",mark:wn,positionPrefix:"lower_whisker",extraEncoding:Rn}),...En({partName:"ticks",mark:wn,positionPrefix:"upper_whisker",extraEncoding:Rn})],An=[...Gt!=="tukey"?Dn:[],...bn({partName:"box",mark:{type:"bar",...zt?{size:zt}:{},orient:ln,invalid:Ht,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:$n}),...Cn({partName:"median",mark:{type:"tick",invalid:Ht,...isObject($t.boxplot.median)&&$t.boxplot.median.color?{color:$t.boxplot.median.color}:{},...zt?{size:zt}:{},orient:sn,aria:!1},positionPrefix:"mid_box",extraEncoding:$n})];if(Gt==="min-max")return{...jt,transform:(jt.transform??[]).concat(Yt),layer:An};const Sn=`datum["lower_box_${Kt.field}"]`,vn=`datum["upper_box_${Kt.field}"]`,_n=`(${vn} - ${Sn})`,Tn=`${Sn} - ${Vt} * ${_n}`,Pn=`${vn} + ${Vt} * ${_n}`,Ln=`datum["${Kt.field}"]`,Vn={joinaggregate:boxParamsQuartiles(Kt.field),groupby:Qt},Un={transform:[{filter:`(${Tn} <= ${Ln}) && (${Ln} <= ${Pn})`},{aggregate:[{op:"min",field:Kt.field,as:`lower_whisker_${hn}`},{op:"max",field:Kt.field,as:`upper_whisker_${hn}`},{op:"min",field:`lower_box_${Kt.field}`,as:`lower_box_${hn}`},{op:"max",field:`upper_box_${Kt.field}`,as:`upper_box_${hn}`},...Jt],groupby:Qt}],layer:Dn},{tooltip:Wn,...rr}=yn,{scale:ar,axis:nr}=Kt,mr=getTitle(Kt),kn=omit(nr,["title"]),Fn=partLayerMixins(Bt,"outliers",$t.boxplot,{transform:[{filter:`(${Ln} < ${Tn}) || (${Ln} > ${Pn})`}],mark:"point",encoding:{[Xt]:{field:Kt.field,type:Kt.type,...mr!==void 0?{title:mr}:{},...ar!==void 0?{scale:ar}:{},...isEmpty(kn)?{}:{axis:kn}},...rr,...cn?{color:cn}:{},...dn?{tooltip:dn}:{}}})[0];let Hn;const Bn=[...qt,...Wt,Vn];return Fn?Hn={transform:Bn,layer:[Fn,Un]}:(Hn=Un,Hn.transform.unshift(...Bn)),{...jt,layer:[Hn,{transform:Yt,layer:An}]}}function boxParamsQuartiles(xt){const $t=removePathFromField(xt);return[{op:"q1",field:xt,as:`lower_box_${$t}`},{op:"q3",field:xt,as:`upper_box_${$t}`}]}function boxParams(xt,$t,Ct){const kt=compositeMarkOrient(xt,BOXPLOT),{continuousAxisChannelDef:Mt,continuousAxis:Ft}=compositeMarkContinuousAxis(xt,kt,BOXPLOT),jt=Mt.field,Bt=removePathFromField(jt),Vt=getBoxPlotType($t),zt=[...boxParamsQuartiles(jt),{op:"median",field:jt,as:`mid_box_${Bt}`},{op:"min",field:jt,as:(Vt==="min-max"?"lower_whisker_":"min_")+Bt},{op:"max",field:jt,as:(Vt==="min-max"?"upper_whisker_":"max_")+Bt}],Ht=Vt==="min-max"||Vt==="tukey"?[]:[{calculate:`datum["upper_box_${Bt}"] - datum["lower_box_${Bt}"]`,as:`iqr_${Bt}`},{calculate:`min(datum["upper_box_${Bt}"] + datum["iqr_${Bt}"] * ${$t}, datum["max_${Bt}"])`,as:`upper_whisker_${Bt}`},{calculate:`max(datum["lower_box_${Bt}"] - datum["iqr_${Bt}"] * ${$t}, datum["min_${Bt}"])`,as:`lower_whisker_${Bt}`}],{[Ft]:Gt,...qt}=xt.encoding,{customTooltipWithoutAggregatedField:Wt,filteredEncoding:Yt}=filterTooltipWithAggregatedField(qt),{bins:Kt,timeUnits:Xt,aggregate:Qt,groupby:Jt,encoding:Zt}=extractTransformsFromEncoding(Yt,Ct),sn=kt==="vertical"?"horizontal":"vertical",ln=kt,dn=[...Kt,...Xt,{aggregate:[...Qt,...zt],groupby:Jt},...Ht];return{bins:Kt,timeUnits:Xt,transform:dn,groupby:Jt,aggregate:Qt,continuousAxisChannelDef:Mt,continuousAxis:Ft,encodingWithoutContinuousAxis:Zt,ticksOrient:sn,boxOrient:ln,customTooltipWithoutAggregatedField:Wt}}const ERRORBAR="errorbar",ERRORBAR_PARTS=["ticks","rule"],errorBarNormalizer=new CompositeMarkNormalizer(ERRORBAR,normalizeErrorBar);function normalizeErrorBar(xt,{config:$t}){xt={...xt,encoding:normalizeEncoding(xt.encoding,$t)};const{transform:Ct,continuousAxisChannelDef:kt,continuousAxis:Mt,encodingWithoutContinuousAxis:Ft,ticksOrient:jt,markDef:Bt,outerSpec:Vt,tooltipEncoding:zt}=errorBarParams(xt,ERRORBAR,$t);delete Ft.size;const Ht=makeCompositeAggregatePartFactory(Bt,Mt,kt,Ft,$t.errorbar),Gt=Bt.thickness,qt=Bt.size,Wt={type:"tick",orient:jt,aria:!1,...Gt!==void 0?{thickness:Gt}:{},...qt!==void 0?{size:qt}:{}},Yt=[...Ht({partName:"ticks",mark:Wt,positionPrefix:"lower",extraEncoding:zt}),...Ht({partName:"ticks",mark:Wt,positionPrefix:"upper",extraEncoding:zt}),...Ht({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...Gt!==void 0?{size:Gt}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:zt})];return{...Vt,transform:Ct,...Yt.length>1?{layer:Yt}:{...Yt[0]}}}function errorBarOrientAndInputType(xt,$t){const{encoding:Ct}=xt;if(errorBarIsInputTypeRaw(Ct))return{orient:compositeMarkOrient(xt,$t),inputType:"raw"};const kt=errorBarIsInputTypeAggregatedUpperLower(Ct),Mt=errorBarIsInputTypeAggregatedError(Ct),Ft=Ct.x,jt=Ct.y;if(kt){if(Mt)throw new Error(`${$t} cannot be both type aggregated-upper-lower and aggregated-error`);const Bt=Ct.x2,Vt=Ct.y2;if(isFieldOrDatumDef(Bt)&&isFieldOrDatumDef(Vt))throw new Error(`${$t} cannot have both x2 and y2`);if(isFieldOrDatumDef(Bt)){if(isContinuousFieldOrDatumDef(Ft))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${$t}`)}else if(isFieldOrDatumDef(Vt)){if(isContinuousFieldOrDatumDef(jt))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${$t}`)}throw new Error("No ranged axis")}else{const Bt=Ct.xError,Vt=Ct.xError2,zt=Ct.yError,Ht=Ct.yError2;if(isFieldOrDatumDef(Vt)&&!isFieldOrDatumDef(Bt))throw new Error(`${$t} cannot have xError2 without xError`);if(isFieldOrDatumDef(Ht)&&!isFieldOrDatumDef(zt))throw new Error(`${$t} cannot have yError2 without yError`);if(isFieldOrDatumDef(Bt)&&isFieldOrDatumDef(zt))throw new Error(`${$t} cannot have both xError and yError with both are quantiative`);if(isFieldOrDatumDef(Bt)){if(isContinuousFieldOrDatumDef(Ft))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(isFieldOrDatumDef(zt)){if(isContinuousFieldOrDatumDef(jt))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function errorBarIsInputTypeRaw(xt){return(isFieldOrDatumDef(xt.x)||isFieldOrDatumDef(xt.y))&&!isFieldOrDatumDef(xt.x2)&&!isFieldOrDatumDef(xt.y2)&&!isFieldOrDatumDef(xt.xError)&&!isFieldOrDatumDef(xt.xError2)&&!isFieldOrDatumDef(xt.yError)&&!isFieldOrDatumDef(xt.yError2)}function errorBarIsInputTypeAggregatedUpperLower(xt){return isFieldOrDatumDef(xt.x2)||isFieldOrDatumDef(xt.y2)}function errorBarIsInputTypeAggregatedError(xt){return isFieldOrDatumDef(xt.xError)||isFieldOrDatumDef(xt.xError2)||isFieldOrDatumDef(xt.yError)||isFieldOrDatumDef(xt.yError2)}function errorBarParams(xt,$t,Ct){const{mark:kt,encoding:Mt,params:Ft,projection:jt,...Bt}=xt,Vt=isMarkDef(kt)?kt:{type:kt};Ft&&warn(selectionNotSupported($t));const{orient:zt,inputType:Ht}=errorBarOrientAndInputType(xt,$t),{continuousAxisChannelDef:Gt,continuousAxisChannelDef2:qt,continuousAxisChannelDefError:Wt,continuousAxisChannelDefError2:Yt,continuousAxis:Kt}=compositeMarkContinuousAxis(xt,zt,$t),{errorBarSpecificAggregate:Xt,postAggregateCalculates:Qt,tooltipSummary:Jt,tooltipTitleWithFieldName:Zt}=errorBarAggregationAndCalculation(Vt,Gt,qt,Wt,Yt,Ht,$t,Ct),{[Kt]:sn,[Kt==="x"?"x2":"y2"]:ln,[Kt==="x"?"xError":"yError"]:dn,[Kt==="x"?"xError2":"yError2"]:hn,...cn}=Mt,{bins:pn,timeUnits:yn,aggregate:gn,groupby:En,encoding:bn}=extractTransformsFromEncoding(cn,Ct),xn=[...gn,...Xt],Cn=Ht!=="raw"?[]:En,$n=getCompositeMarkTooltip(Jt,Gt,bn,Zt);return{transform:[...Bt.transform??[],...pn,...yn,...xn.length===0?[]:[{aggregate:xn,groupby:Cn}],...Qt],groupby:Cn,continuousAxisChannelDef:Gt,continuousAxis:Kt,encodingWithoutContinuousAxis:bn,ticksOrient:zt==="vertical"?"horizontal":"vertical",markDef:Vt,outerSpec:Bt,tooltipEncoding:$n}}function errorBarAggregationAndCalculation(xt,$t,Ct,kt,Mt,Ft,jt,Bt){let Vt=[],zt=[];const Ht=$t.field;let Gt,qt=!1;if(Ft==="raw"){const Wt=xt.center?xt.center:xt.extent?xt.extent==="iqr"?"median":"mean":Bt.errorbar.center,Yt=xt.extent?xt.extent:Wt==="mean"?"stderr":"iqr";if(Wt==="median"!=(Yt==="iqr")&&warn(errorBarCenterIsUsedWithWrongExtent(Wt,Yt,jt)),Yt==="stderr"||Yt==="stdev")Vt=[{op:Yt,field:Ht,as:`extent_${Ht}`},{op:Wt,field:Ht,as:`center_${Ht}`}],zt=[{calculate:`datum["center_${Ht}"] + datum["extent_${Ht}"]`,as:`upper_${Ht}`},{calculate:`datum["center_${Ht}"] - datum["extent_${Ht}"]`,as:`lower_${Ht}`}],Gt=[{fieldPrefix:"center_",titlePrefix:titleCase(Wt)},{fieldPrefix:"upper_",titlePrefix:getTitlePrefix(Wt,Yt,"+")},{fieldPrefix:"lower_",titlePrefix:getTitlePrefix(Wt,Yt,"-")}],qt=!0;else{let Kt,Xt,Qt;Yt==="ci"?(Kt="mean",Xt="ci0",Qt="ci1"):(Kt="median",Xt="q1",Qt="q3"),Vt=[{op:Xt,field:Ht,as:`lower_${Ht}`},{op:Qt,field:Ht,as:`upper_${Ht}`},{op:Kt,field:Ht,as:`center_${Ht}`}],Gt=[{fieldPrefix:"upper_",titlePrefix:title({field:Ht,aggregate:Qt,type:"quantitative"},Bt,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:title({field:Ht,aggregate:Xt,type:"quantitative"},Bt,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:title({field:Ht,aggregate:Kt,type:"quantitative"},Bt,{allowDisabling:!1})}]}}else{(xt.center||xt.extent)&&warn(errorBarCenterAndExtentAreNotNeeded(xt.center,xt.extent)),Ft==="aggregated-upper-lower"?(Gt=[],zt=[{calculate:`datum["${Ct.field}"]`,as:`upper_${Ht}`},{calculate:`datum["${Ht}"]`,as:`lower_${Ht}`}]):Ft==="aggregated-error"&&(Gt=[{fieldPrefix:"",titlePrefix:Ht}],zt=[{calculate:`datum["${Ht}"] + datum["${kt.field}"]`,as:`upper_${Ht}`}],Mt?zt.push({calculate:`datum["${Ht}"] + datum["${Mt.field}"]`,as:`lower_${Ht}`}):zt.push({calculate:`datum["${Ht}"] - datum["${kt.field}"]`,as:`lower_${Ht}`}));for(const Wt of zt)Gt.push({fieldPrefix:Wt.as.substring(0,6),titlePrefix:replaceAll(replaceAll(Wt.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:zt,errorBarSpecificAggregate:Vt,tooltipSummary:Gt,tooltipTitleWithFieldName:qt}}function getTitlePrefix(xt,$t,Ct){return`${titleCase(xt)} ${Ct} ${$t}`}const ERRORBAND="errorband",ERRORBAND_PARTS=["band","borders"],errorBandNormalizer=new CompositeMarkNormalizer(ERRORBAND,normalizeErrorBand);function normalizeErrorBand(xt,{config:$t}){xt={...xt,encoding:normalizeEncoding(xt.encoding,$t)};const{transform:Ct,continuousAxisChannelDef:kt,continuousAxis:Mt,encodingWithoutContinuousAxis:Ft,markDef:jt,outerSpec:Bt,tooltipEncoding:Vt}=errorBarParams(xt,ERRORBAND,$t),zt=jt,Ht=makeCompositeAggregatePartFactory(zt,Mt,kt,Ft,$t.errorband),Gt=xt.encoding.x!==void 0&&xt.encoding.y!==void 0;let qt={type:Gt?"area":"rect"},Wt={type:Gt?"line":"rule"};const Yt={...zt.interpolate?{interpolate:zt.interpolate}:{},...zt.tension&&zt.interpolate?{tension:zt.tension}:{}};return Gt?(qt={...qt,...Yt,ariaRoleDescription:"errorband"},Wt={...Wt,...Yt,aria:!1}):zt.interpolate?warn(errorBand1DNotSupport("interpolate")):zt.tension&&warn(errorBand1DNotSupport("tension")),{...Bt,transform:Ct,layer:[...Ht({partName:"band",mark:qt,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:Vt}),...Ht({partName:"borders",mark:Wt,positionPrefix:"lower",extraEncoding:Vt}),...Ht({partName:"borders",mark:Wt,positionPrefix:"upper",extraEncoding:Vt})]}}const compositeMarkRegistry={};function add(xt,$t,Ct){const kt=new CompositeMarkNormalizer(xt,$t);compositeMarkRegistry[xt]={normalizer:kt,parts:Ct}}function getAllCompositeMarks(){return keys(compositeMarkRegistry)}add(BOXPLOT,normalizeBoxPlot,BOXPLOT_PARTS);add(ERRORBAR,normalizeErrorBar,ERRORBAR_PARTS);add(ERRORBAND,normalizeErrorBand,ERRORBAND_PARTS);const VL_ONLY_LEGEND_CONFIG=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],HEADER_TITLE_PROPERTIES_MAP={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},HEADER_LABEL_PROPERTIES_MAP={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},HEADER_TITLE_PROPERTIES=keys(HEADER_TITLE_PROPERTIES_MAP),HEADER_LABEL_PROPERTIES=keys(HEADER_LABEL_PROPERTIES_MAP),HEADER_CONFIGS_INDEX={header:1,headerRow:1,headerColumn:1,headerFacet:1},HEADER_CONFIGS=keys(HEADER_CONFIGS_INDEX),LEGEND_SCALE_CHANNELS=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],defaultLegendConfig={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},COMMON_LEGEND_PROPERTY_INDEX={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},SELECTION_ID="_vgsid_",defaultConfig$1={point:{on:"click",fields:[SELECTION_ID],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function isLegendBinding(xt){return xt==="legend"||!!(xt!=null&&xt.legend)}function isLegendStreamBinding(xt){return isLegendBinding(xt)&&isObject(xt)}function isSelectionParameter(xt){return!!(xt!=null&&xt.select)}function assembleParameterSignals(xt){const $t=[];for(const Ct of xt||[]){if(isSelectionParameter(Ct))continue;const{expr:kt,bind:Mt,...Ft}=Ct;if(Mt&&kt){const jt={...Ft,bind:Mt,init:kt};$t.push(jt)}else{const jt={...Ft,...kt?{update:kt}:{},...Mt?{bind:Mt}:{}};$t.push(jt)}}return $t}function isAnyConcatSpec(xt){return isVConcatSpec(xt)||isHConcatSpec(xt)||isConcatSpec(xt)}function isConcatSpec(xt){return"concat"in xt}function isVConcatSpec(xt){return"vconcat"in xt}function isHConcatSpec(xt){return"hconcat"in xt}function getStepFor({step:xt,offsetIsDiscrete:$t}){return $t?xt.for??"offset":"position"}function isStep(xt){return isObject(xt)&&xt.step!==void 0}function isFrameMixins(xt){return xt.view||xt.width||xt.height}const DEFAULT_SPACING=20,COMPOSITION_LAYOUT_INDEX={align:1,bounds:1,center:1,columns:1,spacing:1},COMPOSITION_LAYOUT_PROPERTIES=keys(COMPOSITION_LAYOUT_INDEX);function extractCompositionLayout(xt,$t,Ct){const kt=Ct[$t],Mt={},{spacing:Ft,columns:jt}=kt;Ft!==void 0&&(Mt.spacing=Ft),jt!==void 0&&(isFacetSpec(xt)&&!isFacetMapping(xt.facet)||isConcatSpec(xt))&&(Mt.columns=jt),isVConcatSpec(xt)&&(Mt.columns=1);for(const Bt of COMPOSITION_LAYOUT_PROPERTIES)if(xt[Bt]!==void 0)if(Bt==="spacing"){const Vt=xt[Bt];Mt[Bt]=isNumber$1(Vt)?Vt:{row:Vt.row??Ft,column:Vt.column??Ft}}else Mt[Bt]=xt[Bt];return Mt}function getViewConfigContinuousSize(xt,$t){return xt[$t]??xt[$t==="width"?"continuousWidth":"continuousHeight"]}function getViewConfigDiscreteStep(xt,$t){const Ct=getViewConfigDiscreteSize(xt,$t);return isStep(Ct)?Ct.step:DEFAULT_STEP}function getViewConfigDiscreteSize(xt,$t){const Ct=xt[$t]??xt[$t==="width"?"discreteWidth":"discreteHeight"];return getFirstDefined(Ct,{step:xt.step})}const DEFAULT_STEP=20,defaultViewConfig={continuousWidth:200,continuousHeight:200,step:DEFAULT_STEP},defaultConfig={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:defaultViewConfig,mark:defaultMarkConfig,arc:{},area:{},bar:defaultBarConfig,circle:{},geoshape:{},image:{},line:{},point:{},rect:defaultRectConfig,rule:{color:"black"},square:{},text:{color:"black"},tick:defaultTickConfig,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:defaultScaleConfig,projection:{},legend:defaultLegendConfig,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:defaultConfig$1,style:{},title:{},facet:{spacing:DEFAULT_SPACING},concat:{spacing:DEFAULT_SPACING},normalizedNumberFormat:".0%"},tab10=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],DEFAULT_FONT_SIZE={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},DEFAULT_COLOR={blue:tab10[0],orange:tab10[1],red:tab10[2],teal:tab10[3],green:tab10[4],yellow:tab10[5],purple:tab10[6],pink:tab10[7],brown:tab10[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function colorSignalConfig(xt={}){return{signals:[{name:"color",value:isObject(xt)?{...DEFAULT_COLOR,...xt}:DEFAULT_COLOR}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function fontSizeSignalConfig(xt){return{signals:[{name:"fontSize",value:isObject(xt)?{...DEFAULT_FONT_SIZE,...xt}:DEFAULT_FONT_SIZE}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function fontConfig(xt){return{text:{font:xt},style:{"guide-label":{font:xt},"guide-title":{font:xt},"group-title":{font:xt},"group-subtitle":{font:xt}}}}function getAxisConfigInternal(xt){const $t=keys(xt||{}),Ct={};for(const kt of $t){const Mt=xt[kt];Ct[kt]=isConditionalAxisValue(Mt)?signalOrValueRefWithCondition(Mt):signalRefOrValue(Mt)}return Ct}function getStyleConfigInternal(xt){const $t=keys(xt),Ct={};for(const kt of $t)Ct[kt]=getAxisConfigInternal(xt[kt]);return Ct}const configPropsWithExpr=[...MARK_CONFIGS,...AXIS_CONFIGS,...HEADER_CONFIGS,"background","padding","legend","lineBreak","scale","style","title","view"];function initConfig(xt={}){const{color:$t,font:Ct,fontSize:kt,selection:Mt,...Ft}=xt,jt=mergeConfig({},duplicate(defaultConfig),Ct?fontConfig(Ct):{},$t?colorSignalConfig($t):{},kt?fontSizeSignalConfig(kt):{},Ft||{});Mt&&writeConfig(jt,"selection",Mt,!0);const Bt=omit(jt,configPropsWithExpr);for(const Vt of["background","lineBreak","padding"])jt[Vt]&&(Bt[Vt]=signalRefOrValue(jt[Vt]));for(const Vt of MARK_CONFIGS)jt[Vt]&&(Bt[Vt]=replaceExprRef(jt[Vt]));for(const Vt of AXIS_CONFIGS)jt[Vt]&&(Bt[Vt]=getAxisConfigInternal(jt[Vt]));for(const Vt of HEADER_CONFIGS)jt[Vt]&&(Bt[Vt]=replaceExprRef(jt[Vt]));return jt.legend&&(Bt.legend=replaceExprRef(jt.legend)),jt.scale&&(Bt.scale=replaceExprRef(jt.scale)),jt.style&&(Bt.style=getStyleConfigInternal(jt.style)),jt.title&&(Bt.title=replaceExprRef(jt.title)),jt.view&&(Bt.view=replaceExprRef(jt.view)),Bt}const MARK_STYLES=new Set(["view",...PRIMITIVE_MARKS]),VL_ONLY_CONFIG_PROPERTIES=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],VL_ONLY_ALL_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX};function stripAndRedirectConfig(xt){xt=duplicate(xt);for(const $t of VL_ONLY_CONFIG_PROPERTIES)delete xt[$t];if(xt.axis)for(const $t in xt.axis)isConditionalAxisValue(xt.axis[$t])&&delete xt.axis[$t];if(xt.legend)for(const $t of VL_ONLY_LEGEND_CONFIG)delete xt.legend[$t];if(xt.mark){for(const $t of VL_ONLY_MARK_CONFIG_PROPERTIES)delete xt.mark[$t];xt.mark.tooltip&&isObject(xt.mark.tooltip)&&delete xt.mark.tooltip}xt.params&&(xt.signals=(xt.signals||[]).concat(assembleParameterSignals(xt.params)),delete xt.params);for(const $t of MARK_STYLES){for(const kt of VL_ONLY_MARK_CONFIG_PROPERTIES)delete xt[$t][kt];const Ct=VL_ONLY_ALL_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX[$t];if(Ct)for(const kt of Ct)delete xt[$t][kt];redirectConfigToStyleConfig(xt,$t)}for(const $t of getAllCompositeMarks())delete xt[$t];redirectTitleConfig(xt);for(const $t in xt)isObject(xt[$t])&&isEmpty(xt[$t])&&delete xt[$t];return isEmpty(xt)?void 0:xt}function redirectTitleConfig(xt){const{titleMarkConfig:$t,subtitleMarkConfig:Ct,subtitle:kt}=extractTitleConfig(xt.title);isEmpty($t)||(xt.style["group-title"]={...xt.style["group-title"],...$t}),isEmpty(Ct)||(xt.style["group-subtitle"]={...xt.style["group-subtitle"],...Ct}),isEmpty(kt)?delete xt.title:xt.title=kt}function redirectConfigToStyleConfig(xt,$t,Ct,kt){const Mt=xt[$t];$t==="view"&&(Ct="cell");const Ft={...Mt,...xt.style[Ct??$t]};isEmpty(Ft)||(xt.style[Ct??$t]=Ft),delete xt[$t]}function isLayerSpec(xt){return"layer"in xt}function isRepeatSpec(xt){return"repeat"in xt}function isLayerRepeatSpec(xt){return!isArray(xt.repeat)&&xt.repeat.layer}class SpecMapper{map($t,Ct){return isFacetSpec($t)?this.mapFacet($t,Ct):isRepeatSpec($t)?this.mapRepeat($t,Ct):isHConcatSpec($t)?this.mapHConcat($t,Ct):isVConcatSpec($t)?this.mapVConcat($t,Ct):isConcatSpec($t)?this.mapConcat($t,Ct):this.mapLayerOrUnit($t,Ct)}mapLayerOrUnit($t,Ct){if(isLayerSpec($t))return this.mapLayer($t,Ct);if(isUnitSpec($t))return this.mapUnit($t,Ct);throw new Error(invalidSpec($t))}mapLayer($t,Ct){return{...$t,layer:$t.layer.map(kt=>this.mapLayerOrUnit(kt,Ct))}}mapHConcat($t,Ct){return{...$t,hconcat:$t.hconcat.map(kt=>this.map(kt,Ct))}}mapVConcat($t,Ct){return{...$t,vconcat:$t.vconcat.map(kt=>this.map(kt,Ct))}}mapConcat($t,Ct){const{concat:kt,...Mt}=$t;return{...Mt,concat:kt.map(Ft=>this.map(Ft,Ct))}}mapFacet($t,Ct){return{...$t,spec:this.map($t.spec,Ct)}}mapRepeat($t,Ct){return{...$t,spec:this.map($t.spec,Ct)}}}const STACK_OFFSET_INDEX={zero:1,center:1,normalize:1};function isStackOffset(xt){return xt in STACK_OFFSET_INDEX}const STACKABLE_MARKS=new Set([ARC,BAR,AREA,RULE,POINT,CIRCLE,SQUARE,LINE,TEXT,TICK]),STACK_BY_DEFAULT_MARKS=new Set([BAR,AREA,ARC]);function isUnbinnedQuantitative(xt){return isFieldDef(xt)&&channelDefType(xt)==="quantitative"&&!xt.bin}function potentialStackedChannel(xt,$t,{orient:Ct,type:kt}){const Mt=$t==="x"?"y":"radius",Ft=$t==="x"&&["bar","area"].includes(kt),jt=xt[$t],Bt=xt[Mt];if(isFieldDef(jt)&&isFieldDef(Bt))if(isUnbinnedQuantitative(jt)&&isUnbinnedQuantitative(Bt)){if(jt.stack)return $t;if(Bt.stack)return Mt;const Vt=isFieldDef(jt)&&!!jt.aggregate,zt=isFieldDef(Bt)&&!!Bt.aggregate;if(Vt!==zt)return Vt?$t:Mt;if(Ft){if(Ct==="vertical")return Mt;if(Ct==="horizontal")return $t}}else{if(isUnbinnedQuantitative(jt))return $t;if(isUnbinnedQuantitative(Bt))return Mt}else{if(isUnbinnedQuantitative(jt))return Ft&&Ct==="vertical"?void 0:$t;if(isUnbinnedQuantitative(Bt))return Ft&&Ct==="horizontal"?void 0:Mt}}function getDimensionChannel(xt){switch(xt){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function stack(xt,$t){var Kt,Xt;const Ct=isMarkDef(xt)?xt:{type:xt},kt=Ct.type;if(!STACKABLE_MARKS.has(kt))return null;const Mt=potentialStackedChannel($t,"x",Ct)||potentialStackedChannel($t,"theta",Ct);if(!Mt)return null;const Ft=$t[Mt],jt=isFieldDef(Ft)?vgField(Ft,{}):void 0,Bt=getDimensionChannel(Mt),Vt=[],zt=new Set;if($t[Bt]){const Qt=$t[Bt],Jt=isFieldDef(Qt)?vgField(Qt,{}):void 0;Jt&&Jt!==jt&&(Vt.push(Bt),zt.add(Jt))}const Ht=Bt==="x"?"xOffset":"yOffset",Gt=$t[Ht],qt=isFieldDef(Gt)?vgField(Gt,{}):void 0;qt&&qt!==jt&&(Vt.push(Ht),zt.add(qt));const Wt=NONPOSITION_CHANNELS.reduce((Qt,Jt)=>{if(Jt!=="tooltip"&&channelHasField($t,Jt)){const Zt=$t[Jt];for(const sn of array$2(Zt)){const ln=getFieldDef(sn);if(ln.aggregate)continue;const dn=vgField(ln,{});(!dn||!zt.has(dn))&&Qt.push({channel:Jt,fieldDef:ln})}}return Qt},[]);let Yt;return Ft.stack!==void 0?isBoolean$2(Ft.stack)?Yt=Ft.stack?"zero":null:Yt=Ft.stack:STACK_BY_DEFAULT_MARKS.has(kt)&&(Yt="zero"),!Yt||!isStackOffset(Yt)||isAggregate$1($t)&&Wt.length===0?null:((Kt=Ft==null?void 0:Ft.scale)!=null&&Kt.type&&((Xt=Ft==null?void 0:Ft.scale)==null?void 0:Xt.type)!==ScaleType.LINEAR&&Ft!=null&&Ft.stack&&warn(stackNonLinearScale(Ft.scale.type)),isFieldOrDatumDef($t[getSecondaryRangeChannel(Mt)])?(Ft.stack!==void 0&&warn(cannotStackRangedMark(Mt)),null):(isFieldDef(Ft)&&Ft.aggregate&&!SUM_OPS.has(Ft.aggregate)&&warn(stackNonSummativeAggregate(Ft.aggregate)),{groupbyChannels:Vt,groupbyFields:zt,fieldChannel:Mt,impute:Ft.impute===null?!1:isPathMark(kt),stackBy:Wt,offset:Yt}))}function initMarkdef(xt,$t,Ct){const kt=replaceExprRef(xt),Mt=getMarkPropOrConfig("orient",kt,Ct);if(kt.orient=orient(kt.type,$t,Mt),Mt!==void 0&&Mt!==kt.orient&&warn(orientOverridden(kt.orient,Mt)),kt.type==="bar"&&kt.orient){const Vt=getMarkPropOrConfig("cornerRadiusEnd",kt,Ct);if(Vt!==void 0){const zt=kt.orient==="horizontal"&&$t.x2||kt.orient==="vertical"&&$t.y2?["cornerRadius"]:BAR_CORNER_RADIUS_INDEX[kt.orient];for(const Ht of zt)kt[Ht]=Vt;kt.cornerRadiusEnd!==void 0&&delete kt.cornerRadiusEnd}}const Ft=getMarkPropOrConfig("opacity",kt,Ct),jt=getMarkPropOrConfig("fillOpacity",kt,Ct);return Ft===void 0&&jt===void 0&&(kt.opacity=opacity(kt.type,$t)),getMarkPropOrConfig("cursor",kt,Ct)===void 0&&(kt.cursor=cursor(kt,$t,Ct)),kt}function cursor(xt,$t,Ct){return $t.href||xt.href||getMarkPropOrConfig("href",xt,Ct)?"pointer":xt.cursor}function opacity(xt,$t){if(contains([POINT,TICK,CIRCLE,SQUARE],xt)&&!isAggregate$1($t))return .7}function defaultFilled(xt,$t,{graticule:Ct}){if(Ct)return!1;const kt=getMarkConfig("filled",xt,$t),Mt=xt.type;return getFirstDefined(kt,Mt!==POINT&&Mt!==LINE&&Mt!==RULE)}function orient(xt,$t,Ct){switch(xt){case POINT:case CIRCLE:case SQUARE:case TEXT:case RECT:case IMAGE:return}const{x:kt,y:Mt,x2:Ft,y2:jt}=$t;switch(xt){case BAR:if(isFieldDef(kt)&&(isBinned(kt.bin)||isFieldDef(Mt)&&Mt.aggregate&&!kt.aggregate))return"vertical";if(isFieldDef(Mt)&&(isBinned(Mt.bin)||isFieldDef(kt)&&kt.aggregate&&!Mt.aggregate))return"horizontal";if(jt||Ft){if(Ct)return Ct;if(!Ft)return(isFieldDef(kt)&&kt.type===QUANTITATIVE&&!isBinning(kt.bin)||isNumericDataDef(kt))&&isFieldDef(Mt)&&isBinned(Mt.bin)?"horizontal":"vertical";if(!jt)return(isFieldDef(Mt)&&Mt.type===QUANTITATIVE&&!isBinning(Mt.bin)||isNumericDataDef(Mt))&&isFieldDef(kt)&&isBinned(kt.bin)?"vertical":"horizontal"}case RULE:if(Ft&&!(isFieldDef(kt)&&isBinned(kt.bin))&&jt&&!(isFieldDef(Mt)&&isBinned(Mt.bin)))return;case AREA:if(jt)return isFieldDef(Mt)&&isBinned(Mt.bin)?"horizontal":"vertical";if(Ft)return isFieldDef(kt)&&isBinned(kt.bin)?"vertical":"horizontal";if(xt===RULE){if(kt&&!Mt)return"vertical";if(Mt&&!kt)return"horizontal"}case LINE:case TICK:{const Bt=isUnbinnedQuantitativeFieldOrDatumDef(kt),Vt=isUnbinnedQuantitativeFieldOrDatumDef(Mt);if(Ct)return Ct;if(Bt&&!Vt)return xt!=="tick"?"horizontal":"vertical";if(!Bt&&Vt)return xt!=="tick"?"vertical":"horizontal";if(Bt&&Vt)return"vertical";{const zt=isTypedFieldDef(kt)&&kt.type===TEMPORAL,Ht=isTypedFieldDef(Mt)&&Mt.type===TEMPORAL;if(zt&&!Ht)return"vertical";if(!zt&&Ht)return"horizontal"}return}}return"vertical"}function dropLineAndPoint(xt){const{point:$t,line:Ct,...kt}=xt;return keys(kt).length>1?kt:kt.type}function dropLineAndPointFromConfig(xt){for(const $t of["line","area","rule","trail"])xt[$t]&&(xt={...xt,[$t]:omit(xt[$t],["point","line"])});return xt}function getPointOverlay(xt,$t={},Ct){return xt.point==="transparent"?{opacity:0}:xt.point?isObject(xt.point)?xt.point:{}:xt.point!==void 0?null:$t.point||Ct.shape?isObject($t.point)?$t.point:{}:void 0}function getLineOverlay(xt,$t={}){return xt.line?xt.line===!0?{}:xt.line:xt.line!==void 0?null:$t.line?$t.line===!0?{}:$t.line:void 0}class PathOverlayNormalizer{constructor(){this.name="path-overlay"}hasMatchingType($t,Ct){if(isUnitSpec($t)){const{mark:kt,encoding:Mt}=$t,Ft=isMarkDef(kt)?kt:{type:kt};switch(Ft.type){case"line":case"rule":case"trail":return!!getPointOverlay(Ft,Ct[Ft.type],Mt);case"area":return!!getPointOverlay(Ft,Ct[Ft.type],Mt)||!!getLineOverlay(Ft,Ct[Ft.type])}}return!1}run($t,Ct,kt){const{config:Mt}=Ct,{params:Ft,projection:jt,mark:Bt,name:Vt,encoding:zt,...Ht}=$t,Gt=normalizeEncoding(zt,Mt),qt=isMarkDef(Bt)?Bt:{type:Bt},Wt=getPointOverlay(qt,Mt[qt.type],Gt),Yt=qt.type==="area"&&getLineOverlay(qt,Mt[qt.type]),Kt=[{name:Vt,...Ft?{params:Ft}:{},mark:dropLineAndPoint({...qt.type==="area"&&qt.opacity===void 0&&qt.fillOpacity===void 0?{opacity:.7}:{},...qt}),encoding:omit(Gt,["shape"])}],Xt=stack(initMarkdef(qt,Gt,Mt),Gt);let Qt=Gt;if(Xt){const{fieldChannel:Jt,offset:Zt}=Xt;Qt={...Gt,[Jt]:{...Gt[Jt],...Zt?{stack:Zt}:{}}}}return Qt=omit(Qt,["y2","x2"]),Yt&&Kt.push({...jt?{projection:jt}:{},mark:{type:"line",...pick(qt,["clip","interpolate","tension","tooltip"]),...Yt},encoding:Qt}),Wt&&Kt.push({...jt?{projection:jt}:{},mark:{type:"point",opacity:1,filled:!0,...pick(qt,["clip","tooltip"]),...Wt},encoding:Qt}),kt({...Ht,layer:Kt},{...Ct,config:dropLineAndPointFromConfig(Mt)})}}function replaceRepeaterInFacet(xt,$t){return $t?isFacetMapping(xt)?replaceRepeaterInMapping(xt,$t):replaceRepeaterInFieldDef(xt,$t):xt}function replaceRepeaterInEncoding(xt,$t){return $t?replaceRepeaterInMapping(xt,$t):xt}function replaceRepeatInProp(xt,$t,Ct){const kt=$t[xt];if(isRepeatRef(kt)){if(kt.repeat in Ct)return{...$t,[xt]:Ct[kt.repeat]};warn(noSuchRepeatedValue(kt.repeat));return}return $t}function replaceRepeaterInFieldDef(xt,$t){if(xt=replaceRepeatInProp("field",xt,$t),xt!==void 0){if(xt===null)return null;if(isSortableFieldDef(xt)&&isSortField(xt.sort)){const Ct=replaceRepeatInProp("field",xt.sort,$t);xt={...xt,...Ct?{sort:Ct}:{}}}return xt}}function replaceRepeaterInFieldOrDatumDef(xt,$t){if(isFieldDef(xt))return replaceRepeaterInFieldDef(xt,$t);{const Ct=replaceRepeatInProp("datum",xt,$t);return Ct!==xt&&!Ct.type&&(Ct.type="nominal"),Ct}}function replaceRepeaterInChannelDef(xt,$t){if(isFieldOrDatumDef(xt)){const Ct=replaceRepeaterInFieldOrDatumDef(xt,$t);if(Ct)return Ct;if(isConditionalDef(xt))return{condition:xt.condition}}else{if(hasConditionalFieldOrDatumDef(xt)){const Ct=replaceRepeaterInFieldOrDatumDef(xt.condition,$t);if(Ct)return{...xt,condition:Ct};{const{condition:kt,...Mt}=xt;return Mt}}return xt}}function replaceRepeaterInMapping(xt,$t){const Ct={};for(const kt in xt)if(has$1(xt,kt)){const Mt=xt[kt];if(isArray(Mt))Ct[kt]=Mt.map(Ft=>replaceRepeaterInChannelDef(Ft,$t)).filter(Ft=>Ft);else{const Ft=replaceRepeaterInChannelDef(Mt,$t);Ft!==void 0&&(Ct[kt]=Ft)}}return Ct}class RuleForRangedLineNormalizer{constructor(){this.name="RuleForRangedLine"}hasMatchingType($t){if(isUnitSpec($t)){const{encoding:Ct,mark:kt}=$t;if(kt==="line"||isMarkDef(kt)&&kt.type==="line")for(const Mt of SECONDARY_RANGE_CHANNEL){const Ft=getMainRangeChannel(Mt),jt=Ct[Ft];if(Ct[Mt]&&(isFieldDef(jt)&&!isBinned(jt.bin)||isDatumDef(jt)))return!0}}return!1}run($t,Ct,kt){const{encoding:Mt,mark:Ft}=$t;return warn(lineWithRange(!!Mt.x2,!!Mt.y2)),kt({...$t,mark:isObject(Ft)?{...Ft,type:"rule"}:"rule"},Ct)}}class CoreNormalizer extends SpecMapper{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[boxPlotNormalizer,errorBarNormalizer,errorBandNormalizer,new PathOverlayNormalizer,new RuleForRangedLineNormalizer]}map($t,Ct){if(isUnitSpec($t)){const kt=channelHasField($t.encoding,ROW),Mt=channelHasField($t.encoding,COLUMN),Ft=channelHasField($t.encoding,FACET);if(kt||Mt||Ft)return this.mapFacetedUnit($t,Ct)}return super.map($t,Ct)}mapUnit($t,Ct){const{parentEncoding:kt,parentProjection:Mt}=Ct,Ft=replaceRepeaterInEncoding($t.encoding,Ct.repeater),jt={...$t,...$t.name?{name:[Ct.repeaterPrefix,$t.name].filter(Vt=>Vt).join("_")}:{},...Ft?{encoding:Ft}:{}};if(kt||Mt)return this.mapUnitWithParentEncodingOrProjection(jt,Ct);const Bt=this.mapLayerOrUnit.bind(this);for(const Vt of this.nonFacetUnitNormalizers)if(Vt.hasMatchingType(jt,Ct.config))return Vt.run(jt,Ct,Bt);return jt}mapRepeat($t,Ct){return isLayerRepeatSpec($t)?this.mapLayerRepeat($t,Ct):this.mapNonLayerRepeat($t,Ct)}mapLayerRepeat($t,Ct){const{repeat:kt,spec:Mt,...Ft}=$t,{row:jt,column:Bt,layer:Vt}=kt,{repeater:zt={},repeaterPrefix:Ht=""}=Ct;return jt||Bt?this.mapRepeat({...$t,repeat:{...jt?{row:jt}:{},...Bt?{column:Bt}:{}},spec:{repeat:{layer:Vt},spec:Mt}},Ct):{...Ft,layer:Vt.map(Gt=>{const qt={...zt,layer:Gt},Wt=`${(Mt.name?`${Mt.name}_`:"")+Ht}child__layer_${varName(Gt)}`,Yt=this.mapLayerOrUnit(Mt,{...Ct,repeater:qt,repeaterPrefix:Wt});return Yt.name=Wt,Yt})}}mapNonLayerRepeat($t,Ct){const{repeat:kt,spec:Mt,data:Ft,...jt}=$t;!isArray(kt)&&$t.columns&&($t=omit($t,["columns"]),warn(columnsNotSupportByRowCol("repeat")));const Bt=[],{repeater:Vt={},repeaterPrefix:zt=""}=Ct,Ht=!isArray(kt)&&kt.row||[Vt?Vt.row:null],Gt=!isArray(kt)&&kt.column||[Vt?Vt.column:null],qt=isArray(kt)&&kt||[Vt?Vt.repeat:null];for(const Yt of qt)for(const Kt of Ht)for(const Xt of Gt){const Qt={repeat:Yt,row:Kt,column:Xt,layer:Vt.layer},Jt=(Mt.name?`${Mt.name}_`:"")+zt+"child__"+(isArray(kt)?`${varName(Yt)}`:(kt.row?`row_${varName(Kt)}`:"")+(kt.column?`column_${varName(Xt)}`:"")),Zt=this.map(Mt,{...Ct,repeater:Qt,repeaterPrefix:Jt});Zt.name=Jt,Bt.push(omit(Zt,["data"]))}const Wt=isArray(kt)?$t.columns:kt.column?kt.column.length:1;return{data:Mt.data??Ft,align:"all",...jt,columns:Wt,concat:Bt}}mapFacet($t,Ct){const{facet:kt}=$t;return isFacetMapping(kt)&&$t.columns&&($t=omit($t,["columns"]),warn(columnsNotSupportByRowCol("facet"))),super.mapFacet($t,Ct)}mapUnitWithParentEncodingOrProjection($t,Ct){const{encoding:kt,projection:Mt}=$t,{parentEncoding:Ft,parentProjection:jt,config:Bt}=Ct,Vt=mergeProjection({parentProjection:jt,projection:Mt}),zt=mergeEncoding({parentEncoding:Ft,encoding:replaceRepeaterInEncoding(kt,Ct.repeater)});return this.mapUnit({...$t,...Vt?{projection:Vt}:{},...zt?{encoding:zt}:{}},{config:Bt})}mapFacetedUnit($t,Ct){const{row:kt,column:Mt,facet:Ft,...jt}=$t.encoding,{mark:Bt,width:Vt,projection:zt,height:Ht,view:Gt,params:qt,encoding:Wt,...Yt}=$t,{facetMapping:Kt,layout:Xt}=this.getFacetMappingAndLayout({row:kt,column:Mt,facet:Ft},Ct),Qt=replaceRepeaterInEncoding(jt,Ct.repeater);return this.mapFacet({...Yt,...Xt,facet:Kt,spec:{...Vt?{width:Vt}:{},...Ht?{height:Ht}:{},...Gt?{view:Gt}:{},...zt?{projection:zt}:{},mark:Bt,encoding:Qt,...qt?{params:qt}:{}}},Ct)}getFacetMappingAndLayout($t,Ct){const{row:kt,column:Mt,facet:Ft}=$t;if(kt||Mt){Ft&&warn(facetChannelDropped([...kt?[ROW]:[],...Mt?[COLUMN]:[]]));const jt={},Bt={};for(const Vt of[ROW,COLUMN]){const zt=$t[Vt];if(zt){const{align:Ht,center:Gt,spacing:qt,columns:Wt,...Yt}=zt;jt[Vt]=Yt;for(const Kt of["align","center","spacing"])zt[Kt]!==void 0&&(Bt[Kt]??(Bt[Kt]={}),Bt[Kt][Vt]=zt[Kt])}}return{facetMapping:jt,layout:Bt}}else{const{align:jt,center:Bt,spacing:Vt,columns:zt,...Ht}=Ft;return{facetMapping:replaceRepeaterInFacet(Ht,Ct.repeater),layout:{...jt?{align:jt}:{},...Bt?{center:Bt}:{},...Vt?{spacing:Vt}:{},...zt?{columns:zt}:{}}}}}mapLayer($t,{parentEncoding:Ct,parentProjection:kt,...Mt}){const{encoding:Ft,projection:jt,...Bt}=$t,Vt={...Mt,parentEncoding:mergeEncoding({parentEncoding:Ct,encoding:Ft,layer:!0}),parentProjection:mergeProjection({parentProjection:kt,projection:jt})};return super.mapLayer({...Bt,...$t.name?{name:[Vt.repeaterPrefix,$t.name].filter(zt=>zt).join("_")}:{}},Vt)}}function mergeEncoding({parentEncoding:xt,encoding:$t={},layer:Ct}){let kt={};if(xt){const Mt=new Set([...keys(xt),...keys($t)]);for(const Ft of Mt){const jt=$t[Ft],Bt=xt[Ft];if(isFieldOrDatumDef(jt)){const Vt={...Bt,...jt};kt[Ft]=Vt}else hasConditionalFieldOrDatumDef(jt)?kt[Ft]={...jt,condition:{...Bt,...jt.condition}}:jt||jt===null?kt[Ft]=jt:(Ct||isValueDef(Bt)||isSignalRef(Bt)||isFieldOrDatumDef(Bt)||isArray(Bt))&&(kt[Ft]=Bt)}}else kt=$t;return!kt||isEmpty(kt)?void 0:kt}function mergeProjection(xt){const{parentProjection:$t,projection:Ct}=xt;return $t&&Ct&&warn(projectionOverridden({parentProjection:$t,projection:Ct})),Ct??$t}function isFilter(xt){return"filter"in xt}function isImputeSequence(xt){return(xt==null?void 0:xt.stop)!==void 0}function isLookup(xt){return"lookup"in xt}function isLookupData(xt){return"data"in xt}function isLookupSelection(xt){return"param"in xt}function isPivot(xt){return"pivot"in xt}function isDensity(xt){return"density"in xt}function isQuantile(xt){return"quantile"in xt}function isRegression(xt){return"regression"in xt}function isLoess(xt){return"loess"in xt}function isSample(xt){return"sample"in xt}function isWindow(xt){return"window"in xt}function isJoinAggregate(xt){return"joinaggregate"in xt}function isFlatten(xt){return"flatten"in xt}function isCalculate(xt){return"calculate"in xt}function isBin(xt){return"bin"in xt}function isImpute(xt){return"impute"in xt}function isTimeUnit(xt){return"timeUnit"in xt}function isAggregate(xt){return"aggregate"in xt}function isStack(xt){return"stack"in xt}function isFold(xt){return"fold"in xt}function isExtent(xt){return"extent"in xt&&!("density"in xt)&&!("regression"in xt)}function normalizeTransform(xt){return xt.map($t=>isFilter($t)?{filter:normalizeLogicalComposition($t.filter,normalizePredicate$1)}:$t)}class SelectionCompatibilityNormalizer extends SpecMapper{map($t,Ct){return Ct.emptySelections??(Ct.emptySelections={}),Ct.selectionPredicates??(Ct.selectionPredicates={}),$t=normalizeTransforms($t,Ct),super.map($t,Ct)}mapLayerOrUnit($t,Ct){if($t=normalizeTransforms($t,Ct),$t.encoding){const kt={};for(const[Mt,Ft]of entries$1($t.encoding))kt[Mt]=normalizeChannelDef(Ft,Ct);$t={...$t,encoding:kt}}return super.mapLayerOrUnit($t,Ct)}mapUnit($t,Ct){const{selection:kt,...Mt}=$t;return kt?{...Mt,params:entries$1(kt).map(([Ft,jt])=>{const{init:Bt,bind:Vt,empty:zt,...Ht}=jt;Ht.type==="single"?(Ht.type="point",Ht.toggle=!1):Ht.type==="multi"&&(Ht.type="point"),Ct.emptySelections[Ft]=zt!=="none";for(const Gt of vals(Ct.selectionPredicates[Ft]??{}))Gt.empty=zt!=="none";return{name:Ft,value:Bt,select:Ht,bind:Vt}})}:$t}}function normalizeTransforms(xt,$t){const{transform:Ct,...kt}=xt;if(Ct){const Mt=Ct.map(Ft=>{if(isFilter(Ft))return{filter:normalizePredicate(Ft,$t)};if(isBin(Ft)&&isBinParams(Ft.bin))return{...Ft,bin:normalizeBinExtent(Ft.bin)};if(isLookup(Ft)){const{selection:jt,...Bt}=Ft.from;return jt?{...Ft,from:{param:jt,...Bt}}:Ft}return Ft});return{...kt,transform:Mt}}return xt}function normalizeChannelDef(xt,$t){var kt,Mt;const Ct=duplicate(xt);if(isFieldDef(Ct)&&isBinParams(Ct.bin)&&(Ct.bin=normalizeBinExtent(Ct.bin)),isScaleFieldDef(Ct)&&((Mt=(kt=Ct.scale)==null?void 0:kt.domain)!=null&&Mt.selection)){const{selection:Ft,...jt}=Ct.scale.domain;Ct.scale.domain={...jt,...Ft?{param:Ft}:{}}}if(isConditionalDef(Ct))if(isArray(Ct.condition))Ct.condition=Ct.condition.map(Ft=>{const{selection:jt,param:Bt,test:Vt,...zt}=Ft;return Bt?Ft:{...zt,test:normalizePredicate(Ft,$t)}});else{const{selection:Ft,param:jt,test:Bt,...Vt}=normalizeChannelDef(Ct.condition,$t);Ct.condition=jt?Ct.condition:{...Vt,test:normalizePredicate(Ct.condition,$t)}}return Ct}function normalizeBinExtent(xt){const $t=xt.extent;if($t!=null&&$t.selection){const{selection:Ct,...kt}=$t;return{...xt,extent:{...kt,param:Ct}}}return xt}function normalizePredicate(xt,$t){const Ct=kt=>normalizeLogicalComposition(kt,Mt=>{var Ft;const jt=$t.emptySelections[Mt]??!0,Bt={param:Mt,empty:jt};return(Ft=$t.selectionPredicates)[Mt]??(Ft[Mt]=[]),$t.selectionPredicates[Mt].push(Bt),Bt});return xt.selection?Ct(xt.selection):normalizeLogicalComposition(xt.test||xt.filter,kt=>kt.selection?Ct(kt.selection):kt)}class TopLevelSelectionsNormalizer extends SpecMapper{map($t,Ct){const kt=Ct.selections??[];if($t.params&&!isUnitSpec($t)){const Mt=[];for(const Ft of $t.params)isSelectionParameter(Ft)?kt.push(Ft):Mt.push(Ft);$t.params=Mt}return Ct.selections=kt,super.map($t,Ct)}mapUnit($t,Ct){const kt=Ct.selections;if(!kt||!kt.length)return $t;const Mt=(Ct.path??[]).concat($t.name),Ft=[];for(const jt of kt)if(!jt.views||!jt.views.length)Ft.push(jt);else for(const Bt of jt.views)(isString(Bt)&&(Bt===$t.name||Mt.includes(Bt))||isArray(Bt)&&Bt.map(Vt=>Mt.indexOf(Vt)).every((Vt,zt,Ht)=>Vt!==-1&&(zt===0||Vt>Ht[zt-1])))&&Ft.push(jt);return Ft.length&&($t.params=Ft),$t}}for(const xt of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const $t=TopLevelSelectionsNormalizer.prototype[xt];TopLevelSelectionsNormalizer.prototype[xt]=function(Ct,kt){return $t.call(this,Ct,addSpecNameToParams(Ct,kt))}}function addSpecNameToParams(xt,$t){return xt.name?{...$t,path:($t.path??[]).concat(xt.name)}:$t}function normalize(xt,$t){$t===void 0&&($t=initConfig(xt.config));const Ct=normalizeGenericSpec(xt,$t),{width:kt,height:Mt}=xt,Ft=normalizeAutoSize(Ct,{width:kt,height:Mt,autosize:xt.autosize},$t);return{...Ct,...Ft?{autosize:Ft}:{}}}const coreNormalizer=new CoreNormalizer,selectionCompatNormalizer=new SelectionCompatibilityNormalizer,topLevelSelectionNormalizer=new TopLevelSelectionsNormalizer;function normalizeGenericSpec(xt,$t={}){const Ct={config:$t};return topLevelSelectionNormalizer.map(coreNormalizer.map(selectionCompatNormalizer.map(xt,Ct),Ct),Ct)}function _normalizeAutoSize(xt){return isString(xt)?{type:xt}:xt??{}}function normalizeAutoSize(xt,$t,Ct){let{width:kt,height:Mt}=$t;const Ft=isUnitSpec(xt)||isLayerSpec(xt),jt={};Ft?kt=="container"&&Mt=="container"?(jt.type="fit",jt.contains="padding"):kt=="container"?(jt.type="fit-x",jt.contains="padding"):Mt=="container"&&(jt.type="fit-y",jt.contains="padding"):(kt=="container"&&(warn(containerSizeNonSingle("width")),kt=void 0),Mt=="container"&&(warn(containerSizeNonSingle("height")),Mt=void 0));const Bt={type:"pad",...jt,...Ct?_normalizeAutoSize(Ct.autosize):{},..._normalizeAutoSize(xt.autosize)};if(Bt.type==="fit"&&!Ft&&(warn(FIT_NON_SINGLE),Bt.type="pad"),kt=="container"&&!(Bt.type=="fit"||Bt.type=="fit-x")&&warn(containerSizeNotCompatibleWithAutosize("width")),Mt=="container"&&!(Bt.type=="fit"||Bt.type=="fit-y")&&warn(containerSizeNotCompatibleWithAutosize("height")),!deepEqual(Bt,{type:"pad"}))return Bt}function isFitType(xt){return xt==="fit"||xt==="fit-x"||xt==="fit-y"}function getFitType(xt){return xt?`fit-${getPositionScaleChannel(xt)}`:"fit"}const TOP_LEVEL_PROPERTIES=["background","padding"];function extractTopLevelProperties(xt,$t){const Ct={};for(const kt of TOP_LEVEL_PROPERTIES)xt&&xt[kt]!==void 0&&(Ct[kt]=signalRefOrValue(xt[kt]));return $t&&(Ct.params=xt.params),Ct}class Split{constructor($t={},Ct={}){this.explicit=$t,this.implicit=Ct}clone(){return new Split(duplicate(this.explicit),duplicate(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get($t){return getFirstDefined(this.explicit[$t],this.implicit[$t])}getWithExplicit($t){return this.explicit[$t]!==void 0?{explicit:!0,value:this.explicit[$t]}:this.implicit[$t]!==void 0?{explicit:!1,value:this.implicit[$t]}:{explicit:!1,value:void 0}}setWithExplicit($t,{value:Ct,explicit:kt}){Ct!==void 0&&this.set($t,Ct,kt)}set($t,Ct,kt){return delete this[kt?"implicit":"explicit"][$t],this[kt?"explicit":"implicit"][$t]=Ct,this}copyKeyFromSplit($t,{explicit:Ct,implicit:kt}){Ct[$t]!==void 0?this.set($t,Ct[$t],!0):kt[$t]!==void 0&&this.set($t,kt[$t],!1)}copyKeyFromObject($t,Ct){Ct[$t]!==void 0&&this.set($t,Ct[$t],!0)}copyAll($t){for(const Ct of keys($t.combine())){const kt=$t.getWithExplicit(Ct);this.setWithExplicit(Ct,kt)}}}function makeExplicit(xt){return{explicit:!0,value:xt}}function makeImplicit(xt){return{explicit:!1,value:xt}}function tieBreakByComparing(xt){return($t,Ct,kt,Mt)=>{const Ft=xt($t.value,Ct.value);return Ft>0?$t:Ft<0?Ct:defaultTieBreaker($t,Ct,kt,Mt)}}function defaultTieBreaker(xt,$t,Ct,kt){return xt.explicit&&$t.explicit&&warn(mergeConflictingProperty(Ct,kt,xt.value,$t.value)),xt}function mergeValuesWithExplicit(xt,$t,Ct,kt,Mt=defaultTieBreaker){return xt===void 0||xt.value===void 0?$t:xt.explicit&&!$t.explicit?xt:$t.explicit&&!xt.explicit?$t:deepEqual(xt.value,$t.value)?xt:Mt(xt,$t,Ct,kt)}class AncestorParse extends Split{constructor($t={},Ct={},kt=!1){super($t,Ct),this.explicit=$t,this.implicit=Ct,this.parseNothing=kt}clone(){const $t=super.clone();return $t.parseNothing=this.parseNothing,$t}}function isUrlData(xt){return"url"in xt}function isInlineData(xt){return"values"in xt}function isNamedData(xt){return"name"in xt&&!isUrlData(xt)&&!isInlineData(xt)&&!isGenerator(xt)}function isGenerator(xt){return xt&&(isSequenceGenerator(xt)||isSphereGenerator(xt)||isGraticuleGenerator(xt))}function isSequenceGenerator(xt){return"sequence"in xt}function isSphereGenerator(xt){return"sphere"in xt}function isGraticuleGenerator(xt){return"graticule"in xt}var DataSourceType;(function(xt){xt[xt.Raw=0]="Raw",xt[xt.Main=1]="Main",xt[xt.Row=2]="Row",xt[xt.Column=3]="Column",xt[xt.Lookup=4]="Lookup"})(DataSourceType||(DataSourceType={}));function assembleProjection(xt){const{signals:$t,hasLegend:Ct,index:kt,...Mt}=xt;return Mt.field=replacePathInField(Mt.field),Mt}function assembleInit(xt,$t=!0,Ct=identity$1){if(isArray(xt)){const kt=xt.map(Mt=>assembleInit(Mt,$t,Ct));return $t?`[${kt.join(", ")}]`:kt}else if(isDateTime(xt))return Ct($t?dateTimeToExpr(xt):dateTimeToTimestamp(xt));return $t?Ct(stringify$1(xt)):xt}function assembleUnitSelectionSignals(xt,$t){for(const Ct of vals(xt.component.selection??{})){const kt=Ct.name;let Mt=`${kt}${TUPLE}, ${Ct.resolve==="global"?"true":`{unit: ${unitName(xt)}}`}`;for(const Ft of selectionCompilers)Ft.defined(Ct)&&(Ft.signals&&($t=Ft.signals(xt,Ct,$t)),Ft.modifyExpr&&(Mt=Ft.modifyExpr(xt,Ct,Mt)));$t.push({name:kt+MODIFY,on:[{events:{signal:Ct.name+TUPLE},update:`modify(${$(Ct.name+STORE)}, ${Mt})`}]})}return cleanupEmptyOnArray($t)}function assembleFacetSignals(xt,$t){if(xt.component.selection&&keys(xt.component.selection).length){const Ct=$(xt.getName("cell"));$t.unshift({name:"facet",value:{},on:[{events:eventSelector("pointermove","scope"),update:`isTuple(facet) ? facet : group(${Ct}).datum`}]})}return cleanupEmptyOnArray($t)}function assembleTopLevelSignals(xt,$t){let Ct=!1;for(const kt of vals(xt.component.selection??{})){const Mt=kt.name,Ft=$(Mt+STORE);if($t.filter(Bt=>Bt.name===Mt).length===0){const Bt=kt.resolve==="global"?"union":kt.resolve,Vt=kt.type==="point"?", true, true)":")";$t.push({name:kt.name,update:`${VL_SELECTION_RESOLVE}(${Ft}, ${$(Bt)}${Vt}`})}Ct=!0;for(const Bt of selectionCompilers)Bt.defined(kt)&&Bt.topLevelSignals&&($t=Bt.topLevelSignals(xt,kt,$t))}return Ct&&$t.filter(Mt=>Mt.name==="unit").length===0&&$t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]}),cleanupEmptyOnArray($t)}function assembleUnitSelectionData(xt,$t){const Ct=[...$t],kt=unitName(xt,{escape:!1});for(const Mt of vals(xt.component.selection??{})){const Ft={name:Mt.name+STORE};if(Mt.project.hasSelectionId&&(Ft.transform=[{type:"collect",sort:{field:SELECTION_ID}}]),Mt.init){const Bt=Mt.project.items.map(assembleProjection);Ft.values=Mt.project.hasSelectionId?Mt.init.map(Vt=>({unit:kt,[SELECTION_ID]:assembleInit(Vt,!1)[0]})):Mt.init.map(Vt=>({unit:kt,fields:Bt,values:assembleInit(Vt,!1)}))}Ct.filter(Bt=>Bt.name===Mt.name+STORE).length||Ct.push(Ft)}return Ct}function assembleUnitSelectionMarks(xt,$t){for(const Ct of vals(xt.component.selection??{}))for(const kt of selectionCompilers)kt.defined(Ct)&&kt.marks&&($t=kt.marks(xt,Ct,$t));return $t}function assembleLayerSelectionMarks(xt,$t){for(const Ct of xt.children)isUnitModel(Ct)&&($t=assembleUnitSelectionMarks(Ct,$t));return $t}function assembleSelectionScaleDomain(xt,$t,Ct,kt){const Mt=parseSelectionExtent(xt,$t.param,$t);return{signal:hasContinuousDomain(Ct.get("type"))&&isArray(kt)&&kt[0]>kt[1]?`isValid(${Mt}) && reverse(${Mt})`:Mt}}function cleanupEmptyOnArray(xt){return xt.map($t=>($t.on&&!$t.on.length&&delete $t.on,$t))}class DataFlowNode{constructor($t,Ct){this.debugName=Ct,this._children=[],this._parent=null,$t&&(this.parent=$t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent($t){this._parent=$t,$t&&$t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild($t,Ct){if(this._children.includes($t)){warn(ADD_SAME_CHILD_TWICE);return}Ct!==void 0?this._children.splice(Ct,0,$t):this._children.push($t)}removeChild($t){const Ct=this._children.indexOf($t);return this._children.splice(Ct,1),Ct}remove(){let $t=this._parent.removeChild(this);for(const Ct of this._children)Ct._parent=this._parent,this._parent.addChild(Ct,$t++)}insertAsParentOf($t){const Ct=$t.parent;Ct.removeChild(this),this.parent=Ct,$t.parent=this}swapWithParent(){const $t=this._parent,Ct=$t.parent;for(const Mt of this._children)Mt.parent=$t;this._children=[],$t.removeChild(this);const kt=$t.parent.removeChild($t);this._parent=Ct,Ct.addChild(this,kt),$t.parent=this}}class OutputNode extends DataFlowNode{clone(){const $t=new this.constructor;return $t.debugName=`clone_${this.debugName}`,$t._source=this._source,$t._name=`clone_${this._name}`,$t.type=this.type,$t.refCounts=this.refCounts,$t.refCounts[$t._name]=0,$t}constructor($t,Ct,kt,Mt){super($t,Ct),this.type=kt,this.refCounts=Mt,this._source=this._name=Ct,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${uniqueId()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource($t){this._source=$t}}function isTimeUnitTransformComponent(xt){return xt.as!==void 0}function offsetAs(xt){return`${xt}_end`}class TimeUnitNode extends DataFlowNode{clone(){return new TimeUnitNode(null,duplicate(this.timeUnits))}constructor($t,Ct){super($t),this.timeUnits=Ct}static makeFromEncoding($t,Ct){const kt=Ct.reduceFieldDef((Mt,Ft,jt)=>{const{field:Bt,timeUnit:Vt}=Ft;if(Vt){let zt;if(isBinnedTimeUnit(Vt)){if(isUnitModel(Ct)){const{mark:Ht,markDef:Gt,config:qt}=Ct,Wt=getBandPosition({fieldDef:Ft,markDef:Gt,config:qt});(isRectBasedMark(Ht)||Wt)&&(zt={timeUnit:normalizeTimeUnit(Vt),field:Bt})}}else zt={as:vgField(Ft,{forAs:!0}),field:Bt,timeUnit:Vt};if(isUnitModel(Ct)){const{mark:Ht,markDef:Gt,config:qt}=Ct,Wt=getBandPosition({fieldDef:Ft,markDef:Gt,config:qt});isRectBasedMark(Ht)&&isXorY(jt)&&Wt!==.5&&(zt.rectBandPosition=Wt)}zt&&(Mt[hash(zt)]=zt)}return Mt},{});return isEmpty(kt)?null:new TimeUnitNode($t,kt)}static makeFromTransform($t,Ct){const{timeUnit:kt,...Mt}={...Ct},Ft=normalizeTimeUnit(kt),jt={...Mt,timeUnit:Ft};return new TimeUnitNode($t,{[hash(jt)]:jt})}merge($t){this.timeUnits={...this.timeUnits};for(const Ct in $t.timeUnits)this.timeUnits[Ct]||(this.timeUnits[Ct]=$t.timeUnits[Ct]);for(const Ct of $t.children)$t.removeChild(Ct),Ct.parent=this;$t.remove()}removeFormulas($t){const Ct={};for(const[kt,Mt]of entries$1(this.timeUnits)){const Ft=isTimeUnitTransformComponent(Mt)?Mt.as:`${Mt.field}_end`;$t.has(Ft)||(Ct[kt]=Mt)}this.timeUnits=Ct}producedFields(){return new Set(vals(this.timeUnits).map($t=>isTimeUnitTransformComponent($t)?$t.as:offsetAs($t.field)))}dependentFields(){return new Set(vals(this.timeUnits).map($t=>$t.field))}hash(){return`TimeUnit ${hash(this.timeUnits)}`}assemble(){const $t=[];for(const Ct of vals(this.timeUnits)){const{rectBandPosition:kt}=Ct,Mt=normalizeTimeUnit(Ct.timeUnit);if(isTimeUnitTransformComponent(Ct)){const{field:Ft,as:jt}=Ct,{unit:Bt,utc:Vt,...zt}=Mt,Ht=[jt,`${jt}_end`];$t.push({field:replacePathInField(Ft),type:"timeunit",...Bt?{units:getTimeUnitParts(Bt)}:{},...Vt?{timezone:"utc"}:{},...zt,as:Ht}),$t.push(...offsetedRectFormulas(Ht,kt,Mt))}else if(Ct){const{field:Ft}=Ct,jt=Ft.replaceAll("\\.","."),Bt=offsetExpr({timeUnit:Mt,field:jt}),Vt=offsetAs(jt);$t.push({type:"formula",expr:Bt,as:Vt}),$t.push(...offsetedRectFormulas([jt,Vt],kt,Mt))}}return $t}}const OFFSETTED_RECT_START_SUFFIX="offsetted_rect_start",OFFSETTED_RECT_END_SUFFIX="offsetted_rect_end";function offsetExpr({timeUnit:xt,field:$t,reverse:Ct}){const{unit:kt,utc:Mt}=xt,Ft=getSmallestTimeUnitPart(kt),{part:jt,step:Bt}=getDateTimePartAndStep(Ft,xt.step);return`${Mt?"utcOffset":"timeOffset"}('${jt}', datum['${$t}'], ${Ct?-Bt:Bt})`}function offsetedRectFormulas([xt,$t],Ct,kt){if(Ct!==void 0&&Ct!==.5){const Mt=`datum['${xt}']`,Ft=`datum['${$t}']`;return[{type:"formula",expr:interpolateExpr([offsetExpr({timeUnit:kt,field:xt,reverse:!0}),Mt],Ct+.5),as:`${xt}_${OFFSETTED_RECT_START_SUFFIX}`},{type:"formula",expr:interpolateExpr([Mt,Ft],Ct+.5),as:`${xt}_${OFFSETTED_RECT_END_SUFFIX}`}]}return[]}function interpolateExpr([xt,$t],Ct){return`${1-Ct} * ${xt} + ${Ct} * ${$t}`}const TUPLE_FIELDS="_tuple_fields";class SelectionProjectionComponent{constructor(...$t){this.items=$t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const project={defined:()=>!0,parse:(xt,$t,Ct)=>{const kt=$t.name,Mt=$t.project??($t.project=new SelectionProjectionComponent),Ft={},jt={},Bt=new Set,Vt=(Yt,Kt)=>{const Xt=Kt==="visual"?Yt.channel:Yt.field;let Qt=varName(`${kt}_${Xt}`);for(let Jt=1;Bt.has(Qt);Jt++)Qt=varName(`${kt}_${Xt}_${Jt}`);return Bt.add(Qt),{[Kt]:Qt}},zt=$t.type,Ht=xt.config.selection[zt],Gt=Ct.value!==void 0?array$2(Ct.value):null;let{fields:qt,encodings:Wt}=isObject(Ct.select)?Ct.select:{};if(!qt&&!Wt&&Gt){for(const Yt of Gt)if(isObject(Yt))for(const Kt of keys(Yt))isSingleDefUnitChannel(Kt)?(Wt||(Wt=[])).push(Kt):zt==="interval"?(warn(INTERVAL_INITIALIZED_WITH_POS),Wt=Ht.encodings):(qt??(qt=[])).push(Kt)}!qt&&!Wt&&(Wt=Ht.encodings,"fields"in Ht&&(qt=Ht.fields));for(const Yt of Wt??[]){const Kt=xt.fieldDef(Yt);if(Kt){let Xt=Kt.field;if(Kt.aggregate){warn(cannotProjectAggregate(Yt,Kt.aggregate));continue}else if(!Xt){warn(cannotProjectOnChannelWithoutField(Yt));continue}if(Kt.timeUnit&&!isBinnedTimeUnit(Kt.timeUnit)){Xt=xt.vgField(Yt);const Qt={timeUnit:Kt.timeUnit,as:Xt,field:Kt.field};jt[hash(Qt)]=Qt}if(!Ft[Xt]){const Qt=zt==="interval"&&isScaleChannel(Yt)&&hasContinuousDomain(xt.getScaleComponent(Yt).get("type"))?"R":Kt.bin?"R-RE":"E",Jt={field:Xt,channel:Yt,type:Qt,index:Mt.items.length};Jt.signals={...Vt(Jt,"data"),...Vt(Jt,"visual")},Mt.items.push(Ft[Xt]=Jt),Mt.hasField[Xt]=Ft[Xt],Mt.hasSelectionId=Mt.hasSelectionId||Xt===SELECTION_ID,isGeoPositionChannel(Yt)?(Jt.geoChannel=Yt,Jt.channel=getPositionChannelFromLatLong(Yt),Mt.hasChannel[Jt.channel]=Ft[Xt]):Mt.hasChannel[Yt]=Ft[Xt]}}else warn(cannotProjectOnChannelWithoutField(Yt))}for(const Yt of qt??[]){if(Mt.hasField[Yt])continue;const Kt={type:"E",field:Yt,index:Mt.items.length};Kt.signals={...Vt(Kt,"data")},Mt.items.push(Kt),Mt.hasField[Yt]=Kt,Mt.hasSelectionId=Mt.hasSelectionId||Yt===SELECTION_ID}Gt&&($t.init=Gt.map(Yt=>Mt.items.map(Kt=>isObject(Yt)?Yt[Kt.geoChannel||Kt.channel]!==void 0?Yt[Kt.geoChannel||Kt.channel]:Yt[Kt.field]:Yt))),isEmpty(jt)||(Mt.timeUnit=new TimeUnitNode(null,jt))},signals:(xt,$t,Ct)=>{const kt=$t.name+TUPLE_FIELDS;return Ct.filter(Ft=>Ft.name===kt).length>0||$t.project.hasSelectionId?Ct:Ct.concat({name:kt,value:$t.project.items.map(assembleProjection)})}},scaleBindings={defined:xt=>xt.type==="interval"&&xt.resolve==="global"&&xt.bind&&xt.bind==="scales",parse:(xt,$t)=>{const Ct=$t.scales=[];for(const kt of $t.project.items){const Mt=kt.channel;if(!isScaleChannel(Mt))continue;const Ft=xt.getScaleComponent(Mt),jt=Ft?Ft.get("type"):void 0;if(jt=="sequential"&&warn(SEQUENTIAL_SCALE_DEPRECATED),!Ft||!hasContinuousDomain(jt)){warn(SCALE_BINDINGS_CONTINUOUS);continue}Ft.set("selectionExtent",{param:$t.name,field:kt.field},!0),Ct.push(kt)}},topLevelSignals:(xt,$t,Ct)=>{const kt=$t.scales.filter(jt=>Ct.filter(Bt=>Bt.name===jt.signals.data).length===0);if(!xt.parent||isTopLevelLayer(xt)||kt.length===0)return Ct;const Mt=Ct.filter(jt=>jt.name===$t.name)[0];let Ft=Mt.update;if(Ft.indexOf(VL_SELECTION_RESOLVE)>=0)Mt.update=`{${kt.map(jt=>`${$(replacePathInField(jt.field))}: ${jt.signals.data}`).join(", ")}}`;else{for(const jt of kt){const Bt=`${$(replacePathInField(jt.field))}: ${jt.signals.data}`;Ft.includes(Bt)||(Ft=`${Ft.substring(0,Ft.length-1)}, ${Bt}}`)}Mt.update=Ft}return Ct.concat(kt.map(jt=>({name:jt.signals.data})))},signals:(xt,$t,Ct)=>{if(xt.parent&&!isTopLevelLayer(xt))for(const kt of $t.scales){const Mt=Ct.find(Ft=>Ft.name===kt.signals.data);Mt.push="outer",delete Mt.value,delete Mt.update}return Ct}};function domain(xt,$t){return`domain(${$(xt.scaleName($t))})`}function isTopLevelLayer(xt){return xt.parent&&isLayerModel(xt.parent)&&!xt.parent.parent}const BRUSH="_brush",SCALE_TRIGGER="_scale_trigger",GEO_INIT_TICK="geo_interval_init_tick",INIT="_init",CENTER="_center",interval={defined:xt=>xt.type==="interval",parse:(xt,$t,Ct)=>{var kt;if(xt.hasProjection){const Mt={...isObject(Ct.select)?Ct.select:{}};Mt.fields=[SELECTION_ID],Mt.encodings||(Mt.encodings=Ct.value?keys(Ct.value):[LONGITUDE,LATITUDE]),Ct.select={type:"interval",...Mt}}if($t.translate&&!scaleBindings.defined($t)){const Mt=`!event.item || event.item.mark.name !== ${$($t.name+BRUSH)}`;for(const Ft of $t.events){if(!Ft.between){warn(`${Ft} is not an ordered event stream for interval selections.`);continue}const jt=array$2((kt=Ft.between[0]).filter??(kt.filter=[]));jt.indexOf(Mt)<0&&jt.push(Mt)}}},signals:(xt,$t,Ct)=>{const kt=$t.name,Mt=kt+TUPLE,Ft=vals($t.project.hasChannel).filter(Bt=>Bt.channel===X||Bt.channel===Y),jt=$t.init?$t.init[0]:null;if(Ct.push(...Ft.reduce((Bt,Vt)=>Bt.concat(channelSignals(xt,$t,Vt,jt&&jt[Vt.index])),[])),xt.hasProjection){const Bt=$(xt.projectionName()),Vt=xt.projectionName()+CENTER,{x:zt,y:Ht}=$t.project.hasChannel,Gt=zt&&zt.signals.visual,qt=Ht&&Ht.signals.visual,Wt=zt?jt&&jt[zt.index]:`${Vt}[0]`,Yt=Ht?jt&&jt[Ht.index]:`${Vt}[1]`,Kt=ln=>xt.getSizeSignalRef(ln).signal,Xt=`[[${Gt?Gt+"[0]":"0"}, ${qt?qt+"[0]":"0"}],[${Gt?Gt+"[1]":Kt("width")}, ${qt?qt+"[1]":Kt("height")}]]`;jt&&(Ct.unshift({name:kt+INIT,init:`[scale(${Bt}, [${zt?Wt[0]:Wt}, ${Ht?Yt[0]:Yt}]), scale(${Bt}, [${zt?Wt[1]:Wt}, ${Ht?Yt[1]:Yt}])]`}),(!zt||!Ht)&&(Ct.find(dn=>dn.name===Vt)||Ct.unshift({name:Vt,update:`invert(${Bt}, [${Kt("width")}/2, ${Kt("height")}/2])`})));const Qt=`intersect(${Xt}, {markname: ${$(xt.getName("marks"))}}, unit.mark)`,Jt=`{unit: ${unitName(xt)}}`,Zt=`vlSelectionTuples(${Qt}, ${Jt})`,sn=Ft.map(ln=>ln.signals.visual);return Ct.concat({name:Mt,on:[{events:[...sn.length?[{signal:sn.join(" || ")}]:[],...jt?[{signal:GEO_INIT_TICK}]:[]],update:Zt}]})}else{if(!scaleBindings.defined($t)){const zt=kt+SCALE_TRIGGER,Ht=Ft.map(Gt=>{const qt=Gt.channel,{data:Wt,visual:Yt}=Gt.signals,Kt=$(xt.scaleName(qt)),Xt=xt.getScaleComponent(qt).get("type"),Qt=hasContinuousDomain(Xt)?"+":"";return`(!isArray(${Wt}) || (${Qt}invert(${Kt}, ${Yt})[0] === ${Qt}${Wt}[0] && ${Qt}invert(${Kt}, ${Yt})[1] === ${Qt}${Wt}[1]))`});Ht.length&&Ct.push({name:zt,value:{},on:[{events:Ft.map(Gt=>({scale:xt.scaleName(Gt.channel)})),update:Ht.join(" && ")+` ? ${zt} : {}`}]})}const Bt=Ft.map(zt=>zt.signals.data),Vt=`unit: ${unitName(xt)}, fields: ${kt+TUPLE_FIELDS}, values`;return Ct.concat({name:Mt,...jt?{init:`{${Vt}: ${assembleInit(jt)}}`}:{},...Bt.length?{on:[{events:[{signal:Bt.join(" || ")}],update:`${Bt.join(" && ")} ? {${Vt}: [${Bt}]} : null`}]}:{}})}},topLevelSignals:(xt,$t,Ct)=>(isUnitModel(xt)&&xt.hasProjection&&$t.init&&(Ct.filter(Mt=>Mt.name===GEO_INIT_TICK).length||Ct.unshift({name:GEO_INIT_TICK,value:null,on:[{events:"timer{1}",update:`${GEO_INIT_TICK} === null ? {} : ${GEO_INIT_TICK}`}]})),Ct),marks:(xt,$t,Ct)=>{const kt=$t.name,{x:Mt,y:Ft}=$t.project.hasChannel,jt=Mt==null?void 0:Mt.signals.visual,Bt=Ft==null?void 0:Ft.signals.visual,Vt=`data(${$($t.name+STORE)})`;if(scaleBindings.defined($t)||!Mt&&!Ft)return Ct;const zt={x:Mt!==void 0?{signal:`${jt}[0]`}:{value:0},y:Ft!==void 0?{signal:`${Bt}[0]`}:{value:0},x2:Mt!==void 0?{signal:`${jt}[1]`}:{field:{group:"width"}},y2:Ft!==void 0?{signal:`${Bt}[1]`}:{field:{group:"height"}}};if($t.resolve==="global")for(const Xt of keys(zt))zt[Xt]=[{test:`${Vt}.length && ${Vt}[0].unit === ${unitName(xt)}`,...zt[Xt]},{value:0}];const{fill:Ht,fillOpacity:Gt,cursor:qt,...Wt}=$t.mark,Yt=keys(Wt).reduce((Xt,Qt)=>(Xt[Qt]=[{test:[Mt!==void 0&&`${jt}[0] !== ${jt}[1]`,Ft!==void 0&&`${Bt}[0] !== ${Bt}[1]`].filter(Jt=>Jt).join(" && "),value:Wt[Qt]},{value:null}],Xt),{}),Kt=qt??($t.translate?"move":null);return[{name:`${kt+BRUSH}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:Ht},fillOpacity:{value:Gt}},update:zt}},...Ct,{name:kt+BRUSH,type:"rect",clip:!0,encode:{enter:{...Kt?{cursor:{value:Kt}}:{},fill:{value:"transparent"}},update:{...zt,...Yt}}}]}};function channelSignals(xt,$t,Ct,kt){const Mt=!xt.hasProjection,Ft=Ct.channel,jt=Ct.signals.visual,Bt=$(Mt?xt.scaleName(Ft):xt.projectionName()),Vt=qt=>`scale(${Bt}, ${qt})`,zt=xt.getSizeSignalRef(Ft===X?"width":"height").signal,Ht=`${Ft}(unit)`,Gt=$t.events.reduce((qt,Wt)=>[...qt,{events:Wt.between[0],update:`[${Ht}, ${Ht}]`},{events:Wt,update:`[${jt}[0], clamp(${Ht}, 0, ${zt})]`}],[]);if(Mt){const qt=Ct.signals.data,Wt=scaleBindings.defined($t),Yt=xt.getScaleComponent(Ft),Kt=Yt?Yt.get("type"):void 0,Xt=kt?{init:assembleInit(kt,!0,Vt)}:{value:[]};return Gt.push({events:{signal:$t.name+SCALE_TRIGGER},update:hasContinuousDomain(Kt)?`[${Vt(`${qt}[0]`)}, ${Vt(`${qt}[1]`)}]`:"[0, 0]"}),Wt?[{name:qt,on:[]}]:[{name:jt,...Xt,on:Gt},{name:qt,...kt?{init:assembleInit(kt)}:{},on:[{events:{signal:jt},update:`${jt}[0] === ${jt}[1] ? null : invert(${Bt}, ${jt})`}]}]}else{const qt=Ft===X?0:1,Wt=$t.name+INIT,Yt=kt?{init:`[${Wt}[0][${qt}], ${Wt}[1][${qt}]]`}:{value:[]};return[{name:jt,...Yt,on:Gt}]}}const point$1={defined:xt=>xt.type==="point",signals:(xt,$t,Ct)=>{const kt=$t.name,Mt=kt+TUPLE_FIELDS,Ft=$t.project,jt="(item().isVoronoi ? datum.datum : datum)",Bt=vals(xt.component.selection??{}).reduce((Gt,qt)=>qt.type==="interval"?Gt.concat(qt.name+BRUSH):Gt,[]).map(Gt=>`indexof(item().mark.name, '${Gt}') < 0`).join(" && "),Vt=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${Bt?` && ${Bt}`:""}`;let zt=`unit: ${unitName(xt)}, `;if($t.project.hasSelectionId)zt+=`${SELECTION_ID}: ${jt}[${$(SELECTION_ID)}]`;else{const Gt=Ft.items.map(qt=>{const Wt=xt.fieldDef(qt.channel);return Wt!=null&&Wt.bin?`[${jt}[${$(xt.vgField(qt.channel,{}))}], ${jt}[${$(xt.vgField(qt.channel,{binSuffix:"end"}))}]]`:`${jt}[${$(qt.field)}]`}).join(", ");zt+=`fields: ${Mt}, values: [${Gt}]`}const Ht=$t.events;return Ct.concat([{name:kt+TUPLE,on:Ht?[{events:Ht,update:`${Vt} ? {${zt}} : null`,force:!0}]:[]}])}};function wrapCondition(xt,$t,Ct,kt){const Mt=isConditionalDef($t)&&$t.condition,Ft=kt($t);if(Mt){const Bt=array$2(Mt).map(Vt=>{const zt=kt(Vt);if(isConditionalParameter(Vt)){const{param:Ht,empty:Gt}=Vt;return{test:parseSelectionPredicate(xt,{param:Ht,empty:Gt}),...zt}}else return{test:expression(xt,Vt.test),...zt}});return{[Ct]:[...Bt,...Ft!==void 0?[Ft]:[]]}}else return Ft!==void 0?{[Ct]:Ft}:{}}function text$1(xt,$t="text"){const Ct=xt.encoding[$t];return wrapCondition(xt,Ct,$t,kt=>textRef(kt,xt.config))}function textRef(xt,$t,Ct="datum"){if(xt){if(isValueDef(xt))return signalOrValueRef(xt.value);if(isFieldOrDatumDef(xt)){const{format:kt,formatType:Mt}=getFormatMixins(xt);return formatSignalRef({fieldOrDatumDef:xt,format:kt,formatType:Mt,expr:Ct,config:$t})}}}function tooltip(xt,$t={}){const{encoding:Ct,markDef:kt,config:Mt,stack:Ft}=xt,jt=Ct.tooltip;if(isArray(jt))return{tooltip:tooltipRefForEncoding({tooltip:jt},Ft,Mt,$t)};{const Bt=$t.reactiveGeom?"datum.datum":"datum";return wrapCondition(xt,jt,"tooltip",Vt=>{const zt=textRef(Vt,Mt,Bt);if(zt)return zt;if(Vt===null)return;let Ht=getMarkPropOrConfig("tooltip",kt,Mt);if(Ht===!0&&(Ht={content:"encoding"}),isString(Ht))return{value:Ht};if(isObject(Ht))return isSignalRef(Ht)?Ht:Ht.content==="encoding"?tooltipRefForEncoding(Ct,Ft,Mt,$t):{signal:Bt}})}}function tooltipData(xt,$t,Ct,{reactiveGeom:kt}={}){const Mt={...Ct,...Ct.tooltipFormat},Ft={},jt=kt?"datum.datum":"datum",Bt=[];function Vt(Ht,Gt){const qt=getMainRangeChannel(Gt),Wt=isTypedFieldDef(Ht)?Ht:{...Ht,type:xt[qt].type},Yt=Wt.title||defaultTitle(Wt,Mt),Kt=array$2(Yt).join(", ").replaceAll(/"/g,'\\"');let Xt;if(isXorY(Gt)){const Qt=Gt==="x"?"x2":"y2",Jt=getFieldDef(xt[Qt]);if(isBinned(Wt.bin)&&Jt){const Zt=vgField(Wt,{expr:jt}),sn=vgField(Jt,{expr:jt}),{format:ln,formatType:dn}=getFormatMixins(Wt);Xt=binFormatExpression(Zt,sn,ln,dn,Mt),Ft[Qt]=!0}}if((isXorY(Gt)||Gt===THETA||Gt===RADIUS)&&$t&&$t.fieldChannel===Gt&&$t.offset==="normalize"){const{format:Qt,formatType:Jt}=getFormatMixins(Wt);Xt=formatSignalRef({fieldOrDatumDef:Wt,format:Qt,formatType:Jt,expr:jt,config:Mt,normalizeStack:!0}).signal}Xt??(Xt=textRef(Wt,Mt,jt).signal),Bt.push({channel:Gt,key:Kt,value:Xt})}forEach(xt,(Ht,Gt)=>{isFieldDef(Ht)?Vt(Ht,Gt):hasConditionalFieldDef(Ht)&&Vt(Ht.condition,Gt)});const zt={};for(const{channel:Ht,key:Gt,value:qt}of Bt)!Ft[Ht]&&!zt[Gt]&&(zt[Gt]=qt);return zt}function tooltipRefForEncoding(xt,$t,Ct,{reactiveGeom:kt}={}){const Mt=tooltipData(xt,$t,Ct,{reactiveGeom:kt}),Ft=entries$1(Mt).map(([jt,Bt])=>`"${jt}": ${Bt}`);return Ft.length>0?{signal:`{${Ft.join(", ")}}`}:void 0}function aria(xt){const{markDef:$t,config:Ct}=xt,kt=getMarkPropOrConfig("aria",$t,Ct);return kt===!1?{}:{...kt?{aria:kt}:{},...ariaRoleDescription(xt),...description$1(xt)}}function ariaRoleDescription(xt){const{mark:$t,markDef:Ct,config:kt}=xt;if(kt.aria===!1)return{};const Mt=getMarkPropOrConfig("ariaRoleDescription",Ct,kt);return Mt!=null?{ariaRoleDescription:{value:Mt}}:$t in VG_MARK_INDEX?{}:{ariaRoleDescription:{value:$t}}}function description$1(xt){const{encoding:$t,markDef:Ct,config:kt,stack:Mt}=xt,Ft=$t.description;if(Ft)return wrapCondition(xt,Ft,"description",Vt=>textRef(Vt,xt.config));const jt=getMarkPropOrConfig("description",Ct,kt);if(jt!=null)return{description:signalOrValueRef(jt)};if(kt.aria===!1)return{};const Bt=tooltipData($t,Mt,kt);if(!isEmpty(Bt))return{description:{signal:entries$1(Bt).map(([Vt,zt],Ht)=>`"${Ht>0?"; ":""}${Vt}: " + (${zt})`).join(" + ")}}}function nonPosition(xt,$t,Ct={}){const{markDef:kt,encoding:Mt,config:Ft}=$t,{vgChannel:jt}=Ct;let{defaultRef:Bt,defaultValue:Vt}=Ct;Bt===void 0&&(Vt??(Vt=getMarkPropOrConfig(xt,kt,Ft,{vgChannel:jt,ignoreVgConfig:!0})),Vt!==void 0&&(Bt=signalOrValueRef(Vt)));const zt=Mt[xt];return wrapCondition($t,zt,jt??xt,Ht=>midPoint({channel:xt,channelDef:Ht,markDef:kt,config:Ft,scaleName:$t.scaleName(xt),scale:$t.getScaleComponent(xt),stack:null,defaultRef:Bt}))}function color(xt,$t={filled:void 0}){const{markDef:Ct,encoding:kt,config:Mt}=xt,{type:Ft}=Ct,jt=$t.filled??getMarkPropOrConfig("filled",Ct,Mt),Bt=contains(["bar","point","circle","square","geoshape"],Ft)?"transparent":void 0,Vt=getMarkPropOrConfig(jt===!0?"color":void 0,Ct,Mt,{vgChannel:"fill"})??Mt.mark[jt===!0&&"color"]??Bt,zt=getMarkPropOrConfig(jt===!1?"color":void 0,Ct,Mt,{vgChannel:"stroke"})??Mt.mark[jt===!1&&"color"],Ht=jt?"fill":"stroke",Gt={...Vt?{fill:signalOrValueRef(Vt)}:{},...zt?{stroke:signalOrValueRef(zt)}:{}};return Ct.color&&(jt?Ct.fill:Ct.stroke)&&warn(droppingColor("property",{fill:"fill"in Ct,stroke:"stroke"in Ct})),{...Gt,...nonPosition("color",xt,{vgChannel:Ht,defaultValue:jt?Vt:zt}),...nonPosition("fill",xt,{defaultValue:kt.fill?Vt:void 0}),...nonPosition("stroke",xt,{defaultValue:kt.stroke?zt:void 0})}}function zindex(xt){const{encoding:$t,mark:Ct}=xt,kt=$t.order;return!isPathMark(Ct)&&isValueDef(kt)?wrapCondition(xt,kt,"zindex",Mt=>signalOrValueRef(Mt.value)):{}}function positionOffset({channel:xt,markDef:$t,encoding:Ct={},model:kt,bandPosition:Mt}){const Ft=`${xt}Offset`,jt=$t[Ft],Bt=Ct[Ft];if((Ft==="xOffset"||Ft==="yOffset")&&Bt)return{offsetType:"encoding",offset:midPoint({channel:Ft,channelDef:Bt,markDef:$t,config:kt==null?void 0:kt.config,scaleName:kt.scaleName(Ft),scale:kt.getScaleComponent(Ft),stack:null,defaultRef:signalOrValueRef(jt),bandPosition:Mt})};const Vt=$t[Ft];return Vt?{offsetType:"visual",offset:Vt}:{}}function pointPosition(xt,$t,{defaultPos:Ct,vgChannel:kt}){const{encoding:Mt,markDef:Ft,config:jt,stack:Bt}=$t,Vt=Mt[xt],zt=Mt[getSecondaryRangeChannel(xt)],Ht=$t.scaleName(xt),Gt=$t.getScaleComponent(xt),{offset:qt,offsetType:Wt}=positionOffset({channel:xt,markDef:Ft,encoding:Mt,model:$t,bandPosition:.5}),Yt=pointPositionDefaultRef({model:$t,defaultPos:Ct,channel:xt,scaleName:Ht,scale:Gt}),Kt=!Vt&&isXorY(xt)&&(Mt.latitude||Mt.longitude)?{field:$t.getName(xt)}:positionRef({channel:xt,channelDef:Vt,channel2Def:zt,markDef:Ft,config:jt,scaleName:Ht,scale:Gt,stack:Bt,offset:qt,defaultRef:Yt,bandPosition:Wt==="encoding"?0:void 0});return Kt?{[kt||xt]:Kt}:void 0}function positionRef(xt){const{channel:$t,channelDef:Ct,scaleName:kt,stack:Mt,offset:Ft,markDef:jt}=xt;if(isFieldOrDatumDef(Ct)&&Mt&&$t===Mt.fieldChannel){if(isFieldDef(Ct)){let Bt=Ct.bandPosition;if(Bt===void 0&&jt.type==="text"&&($t==="radius"||$t==="theta")&&(Bt=.5),Bt!==void 0)return interpolatedSignalRef({scaleName:kt,fieldOrDatumDef:Ct,startSuffix:"start",bandPosition:Bt,offset:Ft})}return valueRefForFieldOrDatumDef(Ct,kt,{suffix:"end"},{offset:Ft})}return midPointRefWithPositionInvalidTest(xt)}function pointPositionDefaultRef({model:xt,defaultPos:$t,channel:Ct,scaleName:kt,scale:Mt}){const{markDef:Ft,config:jt}=xt;return()=>{const Bt=getMainRangeChannel(Ct),Vt=getVgPositionChannel(Ct),zt=getMarkPropOrConfig(Ct,Ft,jt,{vgChannel:Vt});if(zt!==void 0)return widthHeightValueOrSignalRef(Ct,zt);switch($t){case"zeroOrMin":case"zeroOrMax":if(kt){const Ht=Mt.get("type");if(!contains([ScaleType.LOG,ScaleType.TIME,ScaleType.UTC],Ht)){if(Mt.domainDefinitelyIncludesZero())return{scale:kt,value:0}}}if($t==="zeroOrMin")return Bt==="y"?{field:{group:"height"}}:{value:0};switch(Bt){case"radius":return{signal:`min(${xt.width.signal},${xt.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":return{...xt[getSizeChannel(Ct)],mult:.5}}}}const ALIGNED_X_CHANNEL={left:"x",center:"xc",right:"x2"},BASELINED_Y_CHANNEL={top:"y",middle:"yc",bottom:"y2"};function vgAlignedPositionChannel(xt,$t,Ct,kt="middle"){if(xt==="radius"||xt==="theta")return getVgPositionChannel(xt);const Mt=xt==="x"?"align":"baseline",Ft=getMarkPropOrConfig(Mt,$t,Ct);let jt;return isSignalRef(Ft)?(warn(rangeMarkAlignmentCannotBeExpression(Mt)),jt=void 0):jt=Ft,xt==="x"?ALIGNED_X_CHANNEL[jt||(kt==="top"?"left":"center")]:BASELINED_Y_CHANNEL[jt||kt]}function pointOrRangePosition(xt,$t,{defaultPos:Ct,defaultPos2:kt,range:Mt}){return Mt?rangePosition(xt,$t,{defaultPos:Ct,defaultPos2:kt}):pointPosition(xt,$t,{defaultPos:Ct})}function rangePosition(xt,$t,{defaultPos:Ct,defaultPos2:kt}){const{markDef:Mt,config:Ft}=$t,jt=getSecondaryRangeChannel(xt),Bt=getSizeChannel(xt),Vt=pointPosition2OrSize($t,kt,jt),zt=Vt[Bt]?vgAlignedPositionChannel(xt,Mt,Ft):getVgPositionChannel(xt);return{...pointPosition(xt,$t,{defaultPos:Ct,vgChannel:zt}),...Vt}}function pointPosition2OrSize(xt,$t,Ct){const{encoding:kt,mark:Mt,markDef:Ft,stack:jt,config:Bt}=xt,Vt=getMainRangeChannel(Ct),zt=getSizeChannel(Ct),Ht=getVgPositionChannel(Ct),Gt=kt[Vt],qt=xt.scaleName(Vt),Wt=xt.getScaleComponent(Vt),{offset:Yt}=Ct in kt||Ct in Ft?positionOffset({channel:Ct,markDef:Ft,encoding:kt,model:xt}):positionOffset({channel:Vt,markDef:Ft,encoding:kt,model:xt});if(!Gt&&(Ct==="x2"||Ct==="y2")&&(kt.latitude||kt.longitude)){const Xt=getSizeChannel(Ct),Qt=xt.markDef[Xt];return Qt!=null?{[Xt]:{value:Qt}}:{[Ht]:{field:xt.getName(Ct)}}}const Kt=position2Ref({channel:Ct,channelDef:Gt,channel2Def:kt[Ct],markDef:Ft,config:Bt,scaleName:qt,scale:Wt,stack:jt,offset:Yt,defaultRef:void 0});return Kt!==void 0?{[Ht]:Kt}:position2orSize(Ct,Ft)||position2orSize(Ct,{[Ct]:getMarkStyleConfig(Ct,Ft,Bt.style),[zt]:getMarkStyleConfig(zt,Ft,Bt.style)})||position2orSize(Ct,Bt[Mt])||position2orSize(Ct,Bt.mark)||{[Ht]:pointPositionDefaultRef({model:xt,defaultPos:$t,channel:Ct,scaleName:qt,scale:Wt})()}}function position2Ref({channel:xt,channelDef:$t,channel2Def:Ct,markDef:kt,config:Mt,scaleName:Ft,scale:jt,stack:Bt,offset:Vt,defaultRef:zt}){return isFieldOrDatumDef($t)&&Bt&&xt.charAt(0)===Bt.fieldChannel.charAt(0)?valueRefForFieldOrDatumDef($t,Ft,{suffix:"start"},{offset:Vt}):midPointRefWithPositionInvalidTest({channel:xt,channelDef:Ct,scaleName:Ft,scale:jt,stack:Bt,markDef:kt,config:Mt,offset:Vt,defaultRef:zt})}function position2orSize(xt,$t){const Ct=getSizeChannel(xt),kt=getVgPositionChannel(xt);if($t[kt]!==void 0)return{[kt]:widthHeightValueOrSignalRef(xt,$t[kt])};if($t[xt]!==void 0)return{[kt]:widthHeightValueOrSignalRef(xt,$t[xt])};if($t[Ct]){const Mt=$t[Ct];if(isRelativeBandSize(Mt))warn(relativeBandSizeNotSupported(Ct));else return{[Ct]:widthHeightValueOrSignalRef(xt,Mt)}}}function rectPosition(xt,$t){const{config:Ct,encoding:kt,markDef:Mt}=xt,Ft=Mt.type,jt=getSecondaryRangeChannel($t),Bt=getSizeChannel($t),Vt=kt[$t],zt=kt[jt],Ht=xt.getScaleComponent($t),Gt=Ht?Ht.get("type"):void 0,qt=Mt.orient,Wt=kt[Bt]??kt.size??getMarkPropOrConfig("size",Mt,Ct,{vgChannel:Bt}),Yt=getOffsetChannel($t),Kt=Ft==="bar"&&($t==="x"?qt==="vertical":qt==="horizontal");return isFieldDef(Vt)&&(isBinning(Vt.bin)||isBinned(Vt.bin)||Vt.timeUnit&&!zt)&&!(Wt&&!isRelativeBandSize(Wt))&&!kt[Yt]&&!hasDiscreteDomain(Gt)?rectBinPosition({fieldDef:Vt,fieldDef2:zt,channel:$t,model:xt}):(isFieldOrDatumDef(Vt)&&hasDiscreteDomain(Gt)||Kt)&&!zt?positionAndSize(Vt,$t,xt):rangePosition($t,xt,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function defaultSizeRef(xt,$t,Ct,kt,Mt,Ft,jt){if(isRelativeBandSize(Mt))if(Ct){const Vt=Ct.get("type");if(Vt==="band"){let zt=`bandwidth('${$t}')`;Mt.band!==1&&(zt=`${Mt.band} * ${zt}`);const Ht=getMarkConfig("minBandSize",{type:jt},kt);return{signal:Ht?`max(${signalOrStringValue(Ht)}, ${zt})`:zt}}else Mt.band!==1&&(warn(cannotUseRelativeBandSizeWithNonBandScale(Vt)),Mt=void 0)}else return{mult:Mt.band,field:{group:xt}};else{if(isSignalRef(Mt))return Mt;if(Mt)return{value:Mt}}if(Ct){const Vt=Ct.get("range");if(isVgRangeStep(Vt)&&isNumber$1(Vt.step))return{value:Vt.step-2}}if(!Ft){const{bandPaddingInner:Vt,barBandPaddingInner:zt,rectBandPaddingInner:Ht}=kt.scale,Gt=getFirstDefined(Vt,jt==="bar"?zt:Ht);if(isSignalRef(Gt))return{signal:`(1 - (${Gt.signal})) * ${xt}`};if(isNumber$1(Gt))return{signal:`${1-Gt} * ${xt}`}}return{value:getViewConfigDiscreteStep(kt.view,xt)-2}}function positionAndSize(xt,$t,Ct){var pn,yn;const{markDef:kt,encoding:Mt,config:Ft,stack:jt}=Ct,Bt=kt.orient,Vt=Ct.scaleName($t),zt=Ct.getScaleComponent($t),Ht=getSizeChannel($t),Gt=getSecondaryRangeChannel($t),qt=getOffsetChannel($t),Wt=Ct.scaleName(qt),Yt=Ct.getScaleComponent(getOffsetScaleChannel($t)),Kt=Bt==="horizontal"&&$t==="y"||Bt==="vertical"&&$t==="x";let Xt;(Mt.size||kt.size)&&(Kt?Xt=nonPosition("size",Ct,{vgChannel:Ht,defaultRef:signalOrValueRef(kt.size)}):warn(cannotApplySizeToNonOrientedMark(kt.type)));const Qt=!!Xt,Jt=getBandSize({channel:$t,fieldDef:xt,markDef:kt,config:Ft,scaleType:(pn=zt||Yt)==null?void 0:pn.get("type"),useVlSizeChannel:Kt});Xt=Xt||{[Ht]:defaultSizeRef(Ht,Wt||Vt,Yt||zt,Ft,Jt,!!xt,kt.type)};const Zt=((yn=zt||Yt)==null?void 0:yn.get("type"))==="band"&&isRelativeBandSize(Jt)&&!Qt?"top":"middle",sn=vgAlignedPositionChannel($t,kt,Ft,Zt),ln=sn==="xc"||sn==="yc",{offset:dn,offsetType:hn}=positionOffset({channel:$t,markDef:kt,encoding:Mt,model:Ct,bandPosition:ln?.5:0}),cn=midPointRefWithPositionInvalidTest({channel:$t,channelDef:xt,markDef:kt,config:Ft,scaleName:Vt,scale:zt,stack:jt,offset:dn,defaultRef:pointPositionDefaultRef({model:Ct,defaultPos:"mid",channel:$t,scaleName:Vt,scale:zt}),bandPosition:ln?hn==="encoding"?0:.5:isSignalRef(Jt)?{signal:`(1-${Jt})/2`}:isRelativeBandSize(Jt)?(1-Jt.band)/2:0});if(Ht)return{[sn]:cn,...Xt};{const gn=getVgPositionChannel(Gt),En=Xt[Ht],bn=dn?{...En,offset:dn}:En;return{[sn]:cn,[gn]:isArray(cn)?[cn[0],{...cn[1],offset:bn}]:{...cn,offset:bn}}}}function getBinSpacing(xt,$t,Ct,kt,Mt,Ft,jt){if(isPolarPositionChannel(xt))return 0;const Bt=xt==="x"||xt==="y2",Vt=Bt?-$t/2:$t/2;if(isSignalRef(Ct)||isSignalRef(Mt)||isSignalRef(kt)||Ft){const zt=signalOrStringValue(Ct),Ht=signalOrStringValue(Mt),Gt=signalOrStringValue(kt),qt=signalOrStringValue(Ft),Yt=Ft?`(${jt} < ${qt} ? ${Bt?"":"-"}0.5 * (${qt} - (${jt})) : ${Vt})`:Vt,Kt=Gt?`${Gt} + `:"",Xt=zt?`(${zt} ? -1 : 1) * `:"",Qt=Ht?`(${Ht} + ${Yt})`:Yt;return{signal:Kt+Xt+Qt}}else return Mt=Mt||0,kt+(Ct?-Mt-Vt:+Mt+Vt)}function rectBinPosition({fieldDef:xt,fieldDef2:$t,channel:Ct,model:kt}){var yn;const{config:Mt,markDef:Ft,encoding:jt}=kt,Bt=kt.getScaleComponent(Ct),Vt=kt.scaleName(Ct),zt=Bt?Bt.get("type"):void 0,Ht=Bt.get("reverse"),Gt=getBandSize({channel:Ct,fieldDef:xt,markDef:Ft,config:Mt,scaleType:zt}),qt=(yn=kt.component.axes[Ct])==null?void 0:yn[0],Wt=(qt==null?void 0:qt.get("translate"))??.5,Yt=isXorY(Ct)?getMarkPropOrConfig("binSpacing",Ft,Mt)??0:0,Kt=getSecondaryRangeChannel(Ct),Xt=getVgPositionChannel(Ct),Qt=getVgPositionChannel(Kt),Jt=getMarkConfig("minBandSize",Ft,Mt),{offset:Zt}=positionOffset({channel:Ct,markDef:Ft,encoding:jt,model:kt,bandPosition:0}),{offset:sn}=positionOffset({channel:Kt,markDef:Ft,encoding:jt,model:kt,bandPosition:0}),ln=binSizeExpr({fieldDef:xt,scaleName:Vt}),dn=getBinSpacing(Ct,Yt,Ht,Wt,Zt,Jt,ln),hn=getBinSpacing(Kt,Yt,Ht,Wt,sn??Zt,Jt,ln),cn=isSignalRef(Gt)?{signal:`(1-${Gt.signal})/2`}:isRelativeBandSize(Gt)?(1-Gt.band)/2:.5,pn=getBandPosition({fieldDef:xt,fieldDef2:$t,markDef:Ft,config:Mt});if(isBinning(xt.bin)||xt.timeUnit){const gn=xt.timeUnit&&pn!==.5;return{[Qt]:rectBinRef({fieldDef:xt,scaleName:Vt,bandPosition:cn,offset:hn,useRectOffsetField:gn}),[Xt]:rectBinRef({fieldDef:xt,scaleName:Vt,bandPosition:isSignalRef(cn)?{signal:`1-${cn.signal}`}:1-cn,offset:dn,useRectOffsetField:gn})}}else if(isBinned(xt.bin)){const gn=valueRefForFieldOrDatumDef(xt,Vt,{},{offset:hn});if(isFieldDef($t))return{[Qt]:gn,[Xt]:valueRefForFieldOrDatumDef($t,Vt,{},{offset:dn})};if(isBinParams(xt.bin)&&xt.bin.step)return{[Qt]:gn,[Xt]:{signal:`scale("${Vt}", ${vgField(xt,{expr:"datum"})} + ${xt.bin.step})`,offset:dn}}}warn(channelRequiredForBinned(Kt))}function rectBinRef({fieldDef:xt,scaleName:$t,bandPosition:Ct,offset:kt,useRectOffsetField:Mt}){return interpolatedSignalRef({scaleName:$t,fieldOrDatumDef:xt,bandPosition:Ct,offset:kt,...Mt?{startSuffix:OFFSETTED_RECT_START_SUFFIX,endSuffix:OFFSETTED_RECT_END_SUFFIX}:{}})}const ALWAYS_IGNORE=new Set(["aria","width","height"]);function baseEncodeEntry(xt,$t){const{fill:Ct=void 0,stroke:kt=void 0}=$t.color==="include"?color(xt):{};return{...markDefProperties(xt.markDef,$t),...wrapAllFieldsInvalid(xt,"fill",Ct),...wrapAllFieldsInvalid(xt,"stroke",kt),...nonPosition("opacity",xt),...nonPosition("fillOpacity",xt),...nonPosition("strokeOpacity",xt),...nonPosition("strokeWidth",xt),...nonPosition("strokeDash",xt),...zindex(xt),...tooltip(xt),...text$1(xt,"href"),...aria(xt)}}function wrapAllFieldsInvalid(xt,$t,Ct){const{config:kt,mark:Mt,markDef:Ft}=xt;if(getMarkPropOrConfig("invalid",Ft,kt)==="hide"&&Ct&&!isPathMark(Mt)){const Bt=allFieldsInvalidPredicate$1(xt,{invalid:!0,channels:SCALE_CHANNELS});if(Bt)return{[$t]:[{test:Bt,value:null},...array$2(Ct)]}}return Ct?{[$t]:Ct}:{}}function markDefProperties(xt,$t){return VG_MARK_CONFIGS.reduce((Ct,kt)=>(!ALWAYS_IGNORE.has(kt)&&xt[kt]!==void 0&&$t[kt]!=="ignore"&&(Ct[kt]=signalOrValueRef(xt[kt])),Ct),{})}function allFieldsInvalidPredicate$1(xt,{invalid:$t=!1,channels:Ct}){const kt=Ct.reduce((Ft,jt)=>{const Bt=xt.getScaleComponent(jt);if(Bt){const Vt=Bt.get("type"),zt=xt.vgField(jt,{expr:"datum"});zt&&hasContinuousDomain(Vt)&&(Ft[zt]=!0)}return Ft},{}),Mt=keys(kt);if(Mt.length>0){const Ft=$t?"||":"&&";return Mt.map(jt=>fieldInvalidPredicate(jt,$t)).join(` ${Ft} `)}}function defined(xt){const{config:$t,markDef:Ct}=xt;if(getMarkPropOrConfig("invalid",Ct,$t)){const Mt=allFieldsInvalidPredicate(xt,{channels:POSITION_SCALE_CHANNELS});if(Mt)return{defined:{signal:Mt}}}return{}}function allFieldsInvalidPredicate(xt,{invalid:$t=!1,channels:Ct}){const kt=Ct.reduce((Ft,jt)=>{var Vt;const Bt=xt.getScaleComponent(jt);if(Bt){const zt=Bt.get("type"),Ht=xt.vgField(jt,{expr:"datum",binSuffix:(Vt=xt.stack)!=null&&Vt.impute?"mid":void 0});Ht&&hasContinuousDomain(zt)&&(Ft[Ht]=!0)}return Ft},{}),Mt=keys(kt);if(Mt.length>0){const Ft=$t?"||":"&&";return Mt.map(jt=>fieldInvalidPredicate(jt,$t)).join(` ${Ft} `)}}function valueIfDefined(xt,$t){if($t!==void 0)return{[xt]:signalOrValueRef($t)}}const VORONOI="voronoi",nearest={defined:xt=>xt.type==="point"&&xt.nearest,parse:(xt,$t)=>{if($t.events)for(const Ct of $t.events)Ct.markname=xt.getName(VORONOI)},marks:(xt,$t,Ct)=>{const{x:kt,y:Mt}=$t.project.hasChannel,Ft=xt.mark;if(isPathMark(Ft))return warn(nearestNotSupportForContinuous(Ft)),Ct;const jt={name:xt.getName(VORONOI),type:"path",interactive:!0,from:{data:xt.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...tooltip(xt,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:kt||!Mt?"datum.datum.x || 0":"0"},y:{expr:Mt||!kt?"datum.datum.y || 0":"0"},size:[xt.getSizeSignalRef("width"),xt.getSizeSignalRef("height")]}]};let Bt=0,Vt=!1;return Ct.forEach((zt,Ht)=>{const Gt=zt.name??"";Gt===xt.component.mark[0].name?Bt=Ht:Gt.indexOf(VORONOI)>=0&&(Vt=!0)}),Vt||Ct.splice(Bt+1,0,jt),Ct}},inputBindings={defined:xt=>xt.type==="point"&&xt.resolve==="global"&&xt.bind&&xt.bind!=="scales"&&!isLegendBinding(xt.bind),parse:(xt,$t,Ct)=>disableDirectManipulation($t,Ct),topLevelSignals:(xt,$t,Ct)=>{const kt=$t.name,Mt=$t.project,Ft=$t.bind,jt=$t.init&&$t.init[0],Bt=nearest.defined($t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return Mt.items.forEach((Vt,zt)=>{const Ht=varName(`${kt}_${Vt.field}`);Ct.filter(qt=>qt.name===Ht).length||Ct.unshift({name:Ht,...jt?{init:assembleInit(jt[zt])}:{value:null},on:$t.events?[{events:$t.events,update:`datum && item().mark.marktype !== 'group' ? ${Bt}[${$(Vt.field)}] : null`}]:[],bind:Ft[Vt.field]??Ft[Vt.channel]??Ft})}),Ct},signals:(xt,$t,Ct)=>{const kt=$t.name,Mt=$t.project,Ft=Ct.filter(zt=>zt.name===kt+TUPLE)[0],jt=kt+TUPLE_FIELDS,Bt=Mt.items.map(zt=>varName(`${kt}_${zt.field}`)),Vt=Bt.map(zt=>`${zt} !== null`).join(" && ");return Bt.length&&(Ft.update=`${Vt} ? {fields: ${jt}, values: [${Bt.join(", ")}]} : null`),delete Ft.value,delete Ft.on,Ct}},TOGGLE="_toggle",toggle={defined:xt=>xt.type==="point"&&!!xt.toggle,signals:(xt,$t,Ct)=>Ct.concat({name:$t.name+TOGGLE,value:!1,on:[{events:$t.events,update:$t.toggle}]}),modifyExpr:(xt,$t)=>{const Ct=$t.name+TUPLE,kt=$t.name+TOGGLE;return`${kt} ? null : ${Ct}, `+($t.resolve==="global"?`${kt} ? null : true, `:`${kt} ? null : {unit: ${unitName(xt)}}, `)+`${kt} ? ${Ct} : null`}},clear={defined:xt=>xt.clear!==void 0&&xt.clear!==!1,parse:(xt,$t)=>{$t.clear&&($t.clear=isString($t.clear)?eventSelector($t.clear,"view"):$t.clear)},topLevelSignals:(xt,$t,Ct)=>{if(inputBindings.defined($t))for(const kt of $t.project.items){const Mt=Ct.findIndex(Ft=>Ft.name===varName(`${$t.name}_${kt.field}`));Mt!==-1&&Ct[Mt].on.push({events:$t.clear,update:"null"})}return Ct},signals:(xt,$t,Ct)=>{function kt(Mt,Ft){Mt!==-1&&Ct[Mt].on&&Ct[Mt].on.push({events:$t.clear,update:Ft})}if($t.type==="interval")for(const Mt of $t.project.items){const Ft=Ct.findIndex(jt=>jt.name===Mt.signals.visual);if(kt(Ft,"[0, 0]"),Ft===-1){const jt=Ct.findIndex(Bt=>Bt.name===Mt.signals.data);kt(jt,"null")}}else{let Mt=Ct.findIndex(Ft=>Ft.name===$t.name+TUPLE);kt(Mt,"null"),toggle.defined($t)&&(Mt=Ct.findIndex(Ft=>Ft.name===$t.name+TOGGLE),kt(Mt,"false"))}return Ct}},legendBindings={defined:xt=>{const $t=xt.resolve==="global"&&xt.bind&&isLegendBinding(xt.bind),Ct=xt.project.items.length===1&&xt.project.items[0].field!==SELECTION_ID;return $t&&!Ct&&warn(LEGEND_BINDINGS_MUST_HAVE_PROJECTION),$t&&Ct},parse:(xt,$t,Ct)=>{const kt=duplicate(Ct);if(kt.select=isString(kt.select)?{type:kt.select,toggle:$t.toggle}:{...kt.select,toggle:$t.toggle},disableDirectManipulation($t,kt),isObject(Ct.select)&&(Ct.select.on||Ct.select.clear)){const jt='event.item && indexof(event.item.mark.role, "legend") < 0';for(const Bt of $t.events)Bt.filter=array$2(Bt.filter??[]),Bt.filter.includes(jt)||Bt.filter.push(jt)}const Mt=isLegendStreamBinding($t.bind)?$t.bind.legend:"click",Ft=isString(Mt)?eventSelector(Mt,"view"):array$2(Mt);$t.bind={legend:{merge:Ft}}},topLevelSignals:(xt,$t,Ct)=>{const kt=$t.name,Mt=isLegendStreamBinding($t.bind)&&$t.bind.legend,Ft=jt=>Bt=>{const Vt=duplicate(Bt);return Vt.markname=jt,Vt};for(const jt of $t.project.items){if(!jt.hasLegend)continue;const Bt=`${varName(jt.field)}_legend`,Vt=`${kt}_${Bt}`;if(Ct.filter(Ht=>Ht.name===Vt).length===0){const Ht=Mt.merge.map(Ft(`${Bt}_symbols`)).concat(Mt.merge.map(Ft(`${Bt}_labels`))).concat(Mt.merge.map(Ft(`${Bt}_entries`)));Ct.unshift({name:Vt,...$t.init?{}:{value:null},on:[{events:Ht,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:Mt.merge,update:`!event.item || !datum ? null : ${Vt}`,force:!0}]})}}return Ct},signals:(xt,$t,Ct)=>{const kt=$t.name,Mt=$t.project,Ft=Ct.find(qt=>qt.name===kt+TUPLE),jt=kt+TUPLE_FIELDS,Bt=Mt.items.filter(qt=>qt.hasLegend).map(qt=>varName(`${kt}_${varName(qt.field)}_legend`)),zt=`${Bt.map(qt=>`${qt} !== null`).join(" && ")} ? {fields: ${jt}, values: [${Bt.join(", ")}]} : null`;$t.events&&Bt.length>0?Ft.on.push({events:Bt.map(qt=>({signal:qt})),update:zt}):Bt.length>0&&(Ft.update=zt,delete Ft.value,delete Ft.on);const Ht=Ct.find(qt=>qt.name===kt+TOGGLE),Gt=isLegendStreamBinding($t.bind)&&$t.bind.legend;return Ht&&($t.events?Ht.on.push({...Ht.on[0],events:Gt}):Ht.on[0].events=Gt),Ct}};function parseInteractiveLegend(xt,$t,Ct){var Mt;const kt=(Mt=xt.fieldDef($t))==null?void 0:Mt.field;for(const Ft of vals(xt.component.selection??{})){const jt=Ft.project.hasField[kt]??Ft.project.hasChannel[$t];if(jt&&legendBindings.defined(Ft)){const Bt=Ct.get("selections")??[];Bt.push(Ft.name),Ct.set("selections",Bt,!1),jt.hasLegend=!0}}}const ANCHOR$1="_translate_anchor",DELTA$1="_translate_delta",translate={defined:xt=>xt.type==="interval"&&xt.translate,signals:(xt,$t,Ct)=>{const kt=$t.name,Mt=scaleBindings.defined($t),Ft=kt+ANCHOR$1,{x:jt,y:Bt}=$t.project.hasChannel;let Vt=eventSelector($t.translate,"scope");return Mt||(Vt=Vt.map(zt=>(zt.between[0].markname=kt+BRUSH,zt))),Ct.push({name:Ft,value:{},on:[{events:Vt.map(zt=>zt.between[0]),update:"{x: x(unit), y: y(unit)"+(jt!==void 0?`, extent_x: ${Mt?domain(xt,X):`slice(${jt.signals.visual})`}`:"")+(Bt!==void 0?`, extent_y: ${Mt?domain(xt,Y):`slice(${Bt.signals.visual})`}`:"")+"}"}]},{name:kt+DELTA$1,value:{},on:[{events:Vt,update:`{x: ${Ft}.x - x(unit), y: ${Ft}.y - y(unit)}`}]}),jt!==void 0&&onDelta$1(xt,$t,jt,"width",Ct),Bt!==void 0&&onDelta$1(xt,$t,Bt,"height",Ct),Ct}};function onDelta$1(xt,$t,Ct,kt,Mt){const Ft=$t.name,jt=Ft+ANCHOR$1,Bt=Ft+DELTA$1,Vt=Ct.channel,zt=scaleBindings.defined($t),Ht=Mt.filter(ln=>ln.name===Ct.signals[zt?"data":"visual"])[0],Gt=xt.getSizeSignalRef(kt).signal,qt=xt.getScaleComponent(Vt),Wt=qt&&qt.get("type"),Yt=qt&&qt.get("reverse"),Kt=zt?Vt===X?Yt?"":"-":Yt?"-":"":"",Xt=`${jt}.extent_${Vt}`,Qt=`${Kt}${Bt}.${Vt} / ${zt?`${Gt}`:`span(${Xt})`}`,Jt=!zt||!qt?"panLinear":Wt==="log"?"panLog":Wt==="symlog"?"panSymlog":Wt==="pow"?"panPow":"panLinear",Zt=zt?Wt==="pow"?`, ${qt.get("exponent")??1}`:Wt==="symlog"?`, ${qt.get("constant")??1}`:"":"",sn=`${Jt}(${Xt}, ${Qt}${Zt})`;Ht.on.push({events:{signal:Bt},update:zt?sn:`clampRange(${sn}, 0, ${Gt})`})}const ANCHOR="_zoom_anchor",DELTA="_zoom_delta",zoom={defined:xt=>xt.type==="interval"&&xt.zoom,signals:(xt,$t,Ct)=>{const kt=$t.name,Mt=scaleBindings.defined($t),Ft=kt+DELTA,{x:jt,y:Bt}=$t.project.hasChannel,Vt=$(xt.scaleName(X)),zt=$(xt.scaleName(Y));let Ht=eventSelector($t.zoom,"scope");return Mt||(Ht=Ht.map(Gt=>(Gt.markname=kt+BRUSH,Gt))),Ct.push({name:kt+ANCHOR,on:[{events:Ht,update:Mt?"{"+[Vt?`x: invert(${Vt}, x(unit))`:"",zt?`y: invert(${zt}, y(unit))`:""].filter(Gt=>Gt).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:Ft,on:[{events:Ht,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),jt!==void 0&&onDelta(xt,$t,jt,"width",Ct),Bt!==void 0&&onDelta(xt,$t,Bt,"height",Ct),Ct}};function onDelta(xt,$t,Ct,kt,Mt){const Ft=$t.name,jt=Ct.channel,Bt=scaleBindings.defined($t),Vt=Mt.filter(Jt=>Jt.name===Ct.signals[Bt?"data":"visual"])[0],zt=xt.getSizeSignalRef(kt).signal,Ht=xt.getScaleComponent(jt),Gt=Ht&&Ht.get("type"),qt=Bt?domain(xt,jt):Vt.name,Wt=Ft+DELTA,Yt=`${Ft}${ANCHOR}.${jt}`,Kt=!Bt||!Ht?"zoomLinear":Gt==="log"?"zoomLog":Gt==="symlog"?"zoomSymlog":Gt==="pow"?"zoomPow":"zoomLinear",Xt=Bt?Gt==="pow"?`, ${Ht.get("exponent")??1}`:Gt==="symlog"?`, ${Ht.get("constant")??1}`:"":"",Qt=`${Kt}(${qt}, ${Yt}, ${Wt}${Xt})`;Vt.on.push({events:{signal:Wt},update:Bt?Qt:`clampRange(${Qt}, 0, ${zt})`})}const STORE="_store",TUPLE="_tuple",MODIFY="_modify",VL_SELECTION_RESOLVE="vlSelectionResolve",selectionCompilers=[point$1,interval,project,toggle,inputBindings,scaleBindings,legendBindings,clear,translate,zoom,nearest];function getFacetModel(xt){let $t=xt.parent;for(;$t&&!isFacetModel($t);)$t=$t.parent;return $t}function unitName(xt,{escape:$t}={escape:!0}){let Ct=$t?$(xt.name):xt.name;const kt=getFacetModel(xt);if(kt){const{facet:Mt}=kt;for(const Ft of FACET_CHANNELS)Mt[Ft]&&(Ct+=` + '__facet_${Ft}_' + (facet[${$(kt.vgField(Ft))}])`)}return Ct}function requiresSelectionId(xt){return vals(xt.component.selection??{}).reduce(($t,Ct)=>$t||Ct.project.hasSelectionId,!1)}function disableDirectManipulation(xt,$t){(isString($t.select)||!$t.select.on)&&delete xt.events,(isString($t.select)||!$t.select.clear)&&delete xt.clear,(isString($t.select)||!$t.select.toggle)&&delete xt.toggle}function getName(xt){const $t=[];return xt.type==="Identifier"?[xt.name]:xt.type==="Literal"?[xt.value]:(xt.type==="MemberExpression"&&($t.push(...getName(xt.object)),$t.push(...getName(xt.property))),$t)}function startsWithDatum(xt){return xt.object.type==="MemberExpression"?startsWithDatum(xt.object):xt.object.name==="datum"}function getDependentFields(xt){const $t=parser$1(xt),Ct=new Set;return $t.visit(kt=>{kt.type==="MemberExpression"&&startsWithDatum(kt)&&Ct.add(getName(kt).slice(1).join("."))}),Ct}class FilterNode extends DataFlowNode{clone(){return new FilterNode(null,this.model,duplicate(this.filter))}constructor($t,Ct,kt){super($t),this.model=Ct,this.filter=kt,this.expr=expression(this.model,this.filter,this),this._dependentFields=getDependentFields(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function parseUnitSelection(xt,$t){const Ct={},kt=xt.config.selection;if(!$t||!$t.length)return Ct;for(const Mt of $t){const Ft=varName(Mt.name),jt=Mt.select,Bt=isString(jt)?jt:jt.type,Vt=isObject(jt)?duplicate(jt):{type:Bt},zt=kt[Bt];for(const qt in zt)qt==="fields"||qt==="encodings"||(qt==="mark"&&(Vt[qt]={...zt[qt],...Vt[qt]}),(Vt[qt]===void 0||Vt[qt]===!0)&&(Vt[qt]=duplicate(zt[qt]??Vt[qt])));const Ht=Ct[Ft]={...Vt,name:Ft,type:Bt,init:Mt.value,bind:Mt.bind,events:isString(Vt.on)?eventSelector(Vt.on,"scope"):array$2(duplicate(Vt.on))},Gt=duplicate(Mt);for(const qt of selectionCompilers)qt.defined(Ht)&&qt.parse&&qt.parse(xt,Ht,Gt)}return Ct}function parseSelectionPredicate(xt,$t,Ct,kt="datum"){const Mt=isString($t)?$t:$t.param,Ft=varName(Mt),jt=$(Ft+STORE);let Bt;try{Bt=xt.getSelectionComponent(Ft,Mt)}catch{return`!!${Ft}`}if(Bt.project.timeUnit){const qt=Ct??xt.component.data.raw,Wt=Bt.project.timeUnit.clone();qt.parent?Wt.insertAsParentOf(qt):qt.parent=Wt}const Vt=Bt.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",zt=Bt.resolve==="global"?")":`, ${$(Bt.resolve)})`,Ht=`${Vt}${jt}, ${kt}${zt}`,Gt=`length(data(${jt}))`;return $t.empty===!1?`${Gt} && ${Ht}`:`!${Gt} || ${Ht}`}function parseSelectionExtent(xt,$t,Ct){const kt=varName($t),Mt=Ct.encoding;let Ft=Ct.field,jt;try{jt=xt.getSelectionComponent(kt,$t)}catch{return kt}if(!Mt&&!Ft)Ft=jt.project.items[0].field,jt.project.items.length>1&&warn(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${$(Ft)}.`);else if(Mt&&!Ft){const Bt=jt.project.items.filter(Vt=>Vt.channel===Mt);!Bt.length||Bt.length>1?(Ft=jt.project.items[0].field,warn((Bt.length?"Multiple ":"No ")+`matching ${$(Mt)} encoding found for selection ${$(Ct.param)}. Using "field": ${$(Ft)}.`)):Ft=Bt[0].field}return`${jt.name}[${$(replacePathInField(Ft))}]`}function materializeSelections(xt,$t){for(const[Ct,kt]of entries$1(xt.component.selection??{})){const Mt=xt.getName(`lookup_${Ct}`);xt.component.data.outputNodes[Mt]=kt.materialized=new OutputNode(new FilterNode($t,xt,{param:Ct}),Mt,DataSourceType.Lookup,xt.component.data.outputNodeRefCounts)}}function expression(xt,$t,Ct){return logicalExpr($t,kt=>isString(kt)?kt:isSelectionPredicate(kt)?parseSelectionPredicate(xt,kt,Ct):fieldFilterExpression(kt))}function assembleTitle(xt,$t){if(xt)return isArray(xt)&&!isText(xt)?xt.map(Ct=>defaultTitle(Ct,$t)).join(", "):xt}function setAxisEncode(xt,$t,Ct,kt){var Mt,Ft;xt.encode??(xt.encode={}),(Mt=xt.encode)[$t]??(Mt[$t]={}),(Ft=xt.encode[$t]).update??(Ft.update={}),xt.encode[$t].update[Ct]=kt}function assembleAxis(xt,$t,Ct,kt={header:!1}){var Gt,qt;const{disable:Mt,orient:Ft,scale:jt,labelExpr:Bt,title:Vt,zindex:zt,...Ht}=xt.combine();if(!Mt){for(const Wt in Ht){const Yt=AXIS_PROPERTY_TYPE[Wt],Kt=Ht[Wt];if(Yt&&Yt!==$t&&Yt!=="both")delete Ht[Wt];else if(isConditionalAxisValue(Kt)){const{condition:Xt,...Qt}=Kt,Jt=array$2(Xt),Zt=CONDITIONAL_AXIS_PROP_INDEX[Wt];if(Zt){const{vgProp:sn,part:ln}=Zt,dn=[...Jt.map(hn=>{const{test:cn,...pn}=hn;return{test:expression(null,cn),...pn}}),Qt];setAxisEncode(Ht,ln,sn,dn),delete Ht[Wt]}else if(Zt===null){const sn={signal:Jt.map(ln=>{const{test:dn,...hn}=ln;return`${expression(null,dn)} ? ${exprFromValueRefOrSignalRef(hn)} : `}).join("")+exprFromValueRefOrSignalRef(Qt)};Ht[Wt]=sn}}else if(isSignalRef(Kt)){const Xt=CONDITIONAL_AXIS_PROP_INDEX[Wt];if(Xt){const{vgProp:Qt,part:Jt}=Xt;setAxisEncode(Ht,Jt,Qt,Kt),delete Ht[Wt]}}contains(["labelAlign","labelBaseline"],Wt)&&Ht[Wt]===null&&delete Ht[Wt]}if($t==="grid"){if(!Ht.grid)return;if(Ht.encode){const{grid:Wt}=Ht.encode;Ht.encode={...Wt?{grid:Wt}:{}},isEmpty(Ht.encode)&&delete Ht.encode}return{scale:jt,orient:Ft,...Ht,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:getFirstDefined(zt,0)}}else{if(!kt.header&&xt.mainExtracted)return;if(Bt!==void 0){let Yt=Bt;(qt=(Gt=Ht.encode)==null?void 0:Gt.labels)!=null&&qt.update&&isSignalRef(Ht.encode.labels.update.text)&&(Yt=replaceAll(Bt,"datum.label",Ht.encode.labels.update.text.signal)),setAxisEncode(Ht,"labels","text",{signal:Yt})}if(Ht.labelAlign===null&&delete Ht.labelAlign,Ht.encode){for(const Yt of AXIS_PARTS)xt.hasAxisPart(Yt)||delete Ht.encode[Yt];isEmpty(Ht.encode)&&delete Ht.encode}const Wt=assembleTitle(Vt,Ct);return{scale:jt,orient:Ft,grid:!1,...Wt?{title:Wt}:{},...Ht,...Ct.aria===!1?{aria:!1}:{},zindex:getFirstDefined(zt,0)}}}}function assembleAxisSignals(xt){const{axes:$t}=xt.component,Ct=[];for(const kt of POSITION_SCALE_CHANNELS)if($t[kt]){for(const Mt of $t[kt])if(!Mt.get("disable")&&!Mt.get("gridScale")){const Ft=kt==="x"?"height":"width",jt=xt.getSizeSignalRef(Ft).signal;Ft!==jt&&Ct.push({name:Ft,update:jt})}}return Ct}function assembleAxes(xt,$t){const{x:Ct=[],y:kt=[]}=xt;return[...Ct.map(Mt=>assembleAxis(Mt,"grid",$t)),...kt.map(Mt=>assembleAxis(Mt,"grid",$t)),...Ct.map(Mt=>assembleAxis(Mt,"main",$t)),...kt.map(Mt=>assembleAxis(Mt,"main",$t))].filter(Mt=>Mt)}function getAxisConfigFromConfigTypes(xt,$t,Ct,kt){return Object.assign.apply(null,[{},...xt.map(Mt=>{if(Mt==="axisOrient"){const Ft=Ct==="x"?"bottom":"left",jt=$t[Ct==="x"?"axisBottom":"axisLeft"]||{},Bt=$t[Ct==="x"?"axisTop":"axisRight"]||{},Vt=new Set([...keys(jt),...keys(Bt)]),zt={};for(const Ht of Vt.values())zt[Ht]={signal:`${kt.signal} === "${Ft}" ? ${signalOrStringValue(jt[Ht])} : ${signalOrStringValue(Bt[Ht])}`};return zt}return $t[Mt]})])}function getAxisConfigs(xt,$t,Ct,kt){const Mt=$t==="band"?["axisDiscrete","axisBand"]:$t==="point"?["axisDiscrete","axisPoint"]:isQuantitative($t)?["axisQuantitative"]:$t==="time"||$t==="utc"?["axisTemporal"]:[],Ft=xt==="x"?"axisX":"axisY",jt=isSignalRef(Ct)?"axisOrient":`axis${titleCase(Ct)}`,Bt=[...Mt,...Mt.map(zt=>Ft+zt.substr(4))],Vt=["axis",jt,Ft];return{vlOnlyAxisConfig:getAxisConfigFromConfigTypes(Bt,kt,xt,Ct),vgAxisConfig:getAxisConfigFromConfigTypes(Vt,kt,xt,Ct),axisConfigStyle:getAxisConfigStyle([...Vt,...Bt],kt)}}function getAxisConfigStyle(xt,$t){var kt;const Ct=[{}];for(const Mt of xt){let Ft=(kt=$t[Mt])==null?void 0:kt.style;if(Ft){Ft=array$2(Ft);for(const jt of Ft)Ct.push($t.style[jt])}}return Object.assign.apply(null,Ct)}function getAxisConfig(xt,$t,Ct,kt={}){var Ft;const Mt=getStyleConfig(xt,Ct,$t);if(Mt!==void 0)return{configFrom:"style",configValue:Mt};for(const jt of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((Ft=kt[jt])==null?void 0:Ft[xt])!==void 0)return{configFrom:jt,configValue:kt[jt][xt]};return{}}const axisRules={scale:({model:xt,channel:$t})=>xt.scaleName($t),format:({format:xt})=>xt,formatType:({formatType:xt})=>xt,grid:({fieldOrDatumDef:xt,axis:$t,scaleType:Ct})=>$t.grid??defaultGrid(Ct,xt),gridScale:({model:xt,channel:$t})=>gridScale(xt,$t),labelAlign:({axis:xt,labelAngle:$t,orient:Ct,channel:kt})=>xt.labelAlign||defaultLabelAlign($t,Ct,kt),labelAngle:({labelAngle:xt})=>xt,labelBaseline:({axis:xt,labelAngle:$t,orient:Ct,channel:kt})=>xt.labelBaseline||defaultLabelBaseline($t,Ct,kt),labelFlush:({axis:xt,fieldOrDatumDef:$t,channel:Ct})=>xt.labelFlush??defaultLabelFlush($t.type,Ct),labelOverlap:({axis:xt,fieldOrDatumDef:$t,scaleType:Ct})=>xt.labelOverlap??defaultLabelOverlap$1($t.type,Ct,isFieldDef($t)&&!!$t.timeUnit,isFieldDef($t)?$t.sort:void 0),orient:({orient:xt})=>xt,tickCount:({channel:xt,model:$t,axis:Ct,fieldOrDatumDef:kt,scaleType:Mt})=>{const Ft=xt==="x"?"width":xt==="y"?"height":void 0,jt=Ft?$t.getSizeSignalRef(Ft):void 0;return Ct.tickCount??defaultTickCount({fieldOrDatumDef:kt,scaleType:Mt,size:jt,values:Ct.values})},tickMinStep:defaultTickMinStep,title:({axis:xt,model:$t,channel:Ct})=>{if(xt.title!==void 0)return xt.title;const kt=getFieldDefTitle($t,Ct);if(kt!==void 0)return kt;const Mt=$t.typedFieldDef(Ct),Ft=Ct==="x"?"x2":"y2",jt=$t.fieldDef(Ft);return mergeTitleFieldDefs(Mt?[toFieldDefBase(Mt)]:[],isFieldDef(jt)?[toFieldDefBase(jt)]:[])},values:({axis:xt,fieldOrDatumDef:$t})=>values$1(xt,$t),zindex:({axis:xt,fieldOrDatumDef:$t,mark:Ct})=>xt.zindex??defaultZindex(Ct,$t)};function defaultGrid(xt,$t){return!hasDiscreteDomain(xt)&&isFieldDef($t)&&!isBinning($t==null?void 0:$t.bin)&&!isBinned($t==null?void 0:$t.bin)}function gridScale(xt,$t){const Ct=$t==="x"?"y":"x";if(xt.getScaleComponent(Ct))return xt.scaleName(Ct)}function getLabelAngle(xt,$t,Ct,kt,Mt){const Ft=$t==null?void 0:$t.labelAngle;if(Ft!==void 0)return isSignalRef(Ft)?Ft:normalizeAngle(Ft);{const{configValue:jt}=getAxisConfig("labelAngle",kt,$t==null?void 0:$t.style,Mt);return jt!==void 0?normalizeAngle(jt):Ct===X&&contains([NOMINAL,ORDINAL],xt.type)&&!(isFieldDef(xt)&&xt.timeUnit)?270:void 0}}function normalizeAngleExpr(xt){return`(((${xt.signal} % 360) + 360) % 360)`}function defaultLabelBaseline(xt,$t,Ct,kt){if(xt!==void 0)if(Ct==="x"){if(isSignalRef(xt)){const Mt=normalizeAngleExpr(xt),Ft=isSignalRef($t)?`(${$t.signal} === "top")`:$t==="top";return{signal:`(45 < ${Mt} && ${Mt} < 135) || (225 < ${Mt} && ${Mt} < 315) ? "middle" :(${Mt} <= 45 || 315 <= ${Mt}) === ${Ft} ? "bottom" : "top"`}}if(45<xt&&xt<135||225<xt&&xt<315)return"middle";if(isSignalRef($t)){const Mt=xt<=45||315<=xt?"===":"!==";return{signal:`${$t.signal} ${Mt} "top" ? "bottom" : "top"`}}return(xt<=45||315<=xt)==($t==="top")?"bottom":"top"}else{if(isSignalRef(xt)){const Mt=normalizeAngleExpr(xt),Ft=isSignalRef($t)?`(${$t.signal} === "left")`:$t==="left";return{signal:`${Mt} <= 45 || 315 <= ${Mt} || (135 <= ${Mt} && ${Mt} <= 225) ? ${kt?'"middle"':"null"} : (45 <= ${Mt} && ${Mt} <= 135) === ${Ft} ? "top" : "bottom"`}}if(xt<=45||315<=xt||135<=xt&&xt<=225)return kt?"middle":null;if(isSignalRef($t)){const Mt=45<=xt&&xt<=135?"===":"!==";return{signal:`${$t.signal} ${Mt} "left" ? "top" : "bottom"`}}return(45<=xt&&xt<=135)==($t==="left")?"top":"bottom"}}function defaultLabelAlign(xt,$t,Ct){if(xt===void 0)return;const kt=Ct==="x",Mt=kt?0:90,Ft=kt?"bottom":"left";if(isSignalRef(xt)){const jt=normalizeAngleExpr(xt),Bt=isSignalRef($t)?`(${$t.signal} === "${Ft}")`:$t===Ft;return{signal:`(${Mt?`(${jt} + 90)`:jt} % 180 === 0) ? ${kt?null:'"center"'} :(${Mt} < ${jt} && ${jt} < ${180+Mt}) === ${Bt} ? "left" : "right"`}}if((xt+Mt)%180===0)return kt?null:"center";if(isSignalRef($t)){const jt=Mt<xt&&xt<180+Mt?"===":"!==";return{signal:`${`${$t.signal} ${jt} "${Ft}"`} ? "left" : "right"`}}return(Mt<xt&&xt<180+Mt)==($t===Ft)?"left":"right"}function defaultLabelFlush(xt,$t){if($t==="x"&&contains(["quantitative","temporal"],xt))return!0}function defaultLabelOverlap$1(xt,$t,Ct,kt){if(Ct&&!isObject(kt)||xt!=="nominal"&&xt!=="ordinal")return $t==="log"||$t==="symlog"?"greedy":!0}function defaultOrient(xt){return xt==="x"?"bottom":"left"}function defaultTickCount({fieldOrDatumDef:xt,scaleType:$t,size:Ct,values:kt}){var Mt;if(!kt&&!hasDiscreteDomain($t)&&$t!=="log"){if(isFieldDef(xt)){if(isBinning(xt.bin))return{signal:`ceil(${Ct.signal}/10)`};if(xt.timeUnit&&contains(["month","hours","day","quarter"],(Mt=normalizeTimeUnit(xt.timeUnit))==null?void 0:Mt.unit))return}return{signal:`ceil(${Ct.signal}/40)`}}}function defaultTickMinStep({format:xt,fieldOrDatumDef:$t}){if(xt==="d")return 1;if(isFieldDef($t)){const{timeUnit:Ct}=$t;if(Ct){const kt=durationExpr(Ct);if(kt)return{signal:kt}}}}function getFieldDefTitle(xt,$t){const Ct=$t==="x"?"x2":"y2",kt=xt.fieldDef($t),Mt=xt.fieldDef(Ct),Ft=kt?kt.title:void 0,jt=Mt?Mt.title:void 0;if(Ft&&jt)return mergeTitle(Ft,jt);if(Ft)return Ft;if(jt)return jt;if(Ft!==void 0)return Ft;if(jt!==void 0)return jt}function values$1(xt,$t){const Ct=xt.values;if(isArray(Ct))return valueArray($t,Ct);if(isSignalRef(Ct))return Ct}function defaultZindex(xt,$t){return xt==="rect"&&isDiscrete($t)?1:0}class CalculateNode extends DataFlowNode{clone(){return new CalculateNode(null,duplicate(this.transform))}constructor($t,Ct){super($t),this.transform=Ct,this._dependentFields=getDependentFields(this.transform.calculate)}static parseAllForSortIndex($t,Ct){return Ct.forEachFieldDef((kt,Mt)=>{if(isScaleFieldDef(kt)&&isSortArray(kt.sort)){const{field:Ft,timeUnit:jt}=kt,Bt=kt.sort,Vt=Bt.map((zt,Ht)=>`${fieldFilterExpression({field:Ft,timeUnit:jt,equal:zt})} ? ${Ht} : `).join("")+Bt.length;$t=new CalculateNode($t,{calculate:Vt,as:sortArrayIndexField(kt,Mt,{forAs:!0})})}}),$t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${hash(this.transform)}`}}function sortArrayIndexField(xt,$t,Ct){return vgField(xt,{prefix:$t,suffix:"sort_index",...Ct})}function getHeaderChannel(xt,$t){return contains(["top","bottom"],$t)?"column":contains(["left","right"],$t)||xt==="row"?"row":"column"}function getHeaderProperty(xt,$t,Ct,kt){const Mt=kt==="row"?Ct.headerRow:kt==="column"?Ct.headerColumn:Ct.headerFacet;return getFirstDefined(($t||{})[xt],Mt[xt],Ct.header[xt])}function getHeaderProperties(xt,$t,Ct,kt){const Mt={};for(const Ft of xt){const jt=getHeaderProperty(Ft,$t||{},Ct,kt);jt!==void 0&&(Mt[Ft]=jt)}return Mt}const HEADER_CHANNELS=["row","column"],HEADER_TYPES=["header","footer"];function assembleTitleGroup(xt,$t){const Ct=xt.component.layoutHeaders[$t].title,kt=xt.config?xt.config:void 0,Mt=xt.component.layoutHeaders[$t].facetFieldDef?xt.component.layoutHeaders[$t].facetFieldDef:void 0,{titleAnchor:Ft,titleAngle:jt,titleOrient:Bt}=getHeaderProperties(["titleAnchor","titleAngle","titleOrient"],Mt.header,kt,$t),Vt=getHeaderChannel($t,Bt),zt=normalizeAngle(jt);return{name:`${$t}-title`,type:"group",role:`${Vt}-title`,title:{text:Ct,...$t==="row"?{orient:"left"}:{},style:"guide-title",...defaultHeaderGuideBaseline(zt,Vt),...defaultHeaderGuideAlign(Vt,zt,Ft),...assembleHeaderProperties(kt,Mt,$t,HEADER_TITLE_PROPERTIES,HEADER_TITLE_PROPERTIES_MAP)}}}function defaultHeaderGuideAlign(xt,$t,Ct="middle"){switch(Ct){case"start":return{align:"left"};case"end":return{align:"right"}}const kt=defaultLabelAlign($t,xt==="row"?"left":"top",xt==="row"?"y":"x");return kt?{align:kt}:{}}function defaultHeaderGuideBaseline(xt,$t){const Ct=defaultLabelBaseline(xt,$t==="row"?"left":"top",$t==="row"?"y":"x",!0);return Ct?{baseline:Ct}:{}}function assembleHeaderGroups(xt,$t){const Ct=xt.component.layoutHeaders[$t],kt=[];for(const Mt of HEADER_TYPES)if(Ct[Mt])for(const Ft of Ct[Mt]){const jt=assembleHeaderGroup(xt,$t,Mt,Ct,Ft);jt!=null&&kt.push(jt)}return kt}function getSort$1(xt,$t){const{sort:Ct}=xt;return isSortField(Ct)?{field:vgField(Ct,{expr:"datum"}),order:Ct.order??"ascending"}:isArray(Ct)?{field:sortArrayIndexField(xt,$t,{expr:"datum"}),order:"ascending"}:{field:vgField(xt,{expr:"datum"}),order:Ct??"ascending"}}function assembleLabelTitle(xt,$t,Ct){const{format:kt,formatType:Mt,labelAngle:Ft,labelAnchor:jt,labelOrient:Bt,labelExpr:Vt}=getHeaderProperties(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],xt.header,Ct,$t),zt=formatSignalRef({fieldOrDatumDef:xt,format:kt,formatType:Mt,expr:"parent",config:Ct}).signal,Ht=getHeaderChannel($t,Bt);return{text:{signal:Vt?replaceAll(replaceAll(Vt,"datum.label",zt),"datum.value",vgField(xt,{expr:"parent"})):zt},...$t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...defaultHeaderGuideBaseline(Ft,Ht),...defaultHeaderGuideAlign(Ht,Ft,jt),...assembleHeaderProperties(Ct,xt,$t,HEADER_LABEL_PROPERTIES,HEADER_LABEL_PROPERTIES_MAP)}}function assembleHeaderGroup(xt,$t,Ct,kt,Mt){if(Mt){let Ft=null;const{facetFieldDef:jt}=kt,Bt=xt.config?xt.config:void 0;if(jt&&Mt.labels){const{labelOrient:Gt}=getHeaderProperties(["labelOrient"],jt.header,Bt,$t);($t==="row"&&!contains(["top","bottom"],Gt)||$t==="column"&&!contains(["left","right"],Gt))&&(Ft=assembleLabelTitle(jt,$t,Bt))}const Vt=isFacetModel(xt)&&!isFacetMapping(xt.facet),zt=Mt.axes,Ht=(zt==null?void 0:zt.length)>0;if(Ft||Ht){const Gt=$t==="row"?"height":"width";return{name:xt.getName(`${$t}_${Ct}`),type:"group",role:`${$t}-${Ct}`,...kt.facetFieldDef?{from:{data:xt.getName(`${$t}_domain`)},sort:getSort$1(jt,$t)}:{},...Ht&&Vt?{from:{data:xt.getName(`facet_domain_${$t}`)}}:{},...Ft?{title:Ft}:{},...Mt.sizeSignal?{encode:{update:{[Gt]:Mt.sizeSignal}}}:{},...Ht?{axes:zt}:{}}}}return null}const LAYOUT_TITLE_BAND={column:{start:0,end:1},row:{start:1,end:0}};function getLayoutTitleBand(xt,$t){return LAYOUT_TITLE_BAND[$t][xt]}function assembleLayoutTitleBand(xt,$t){const Ct={};for(const kt of FACET_CHANNELS){const Mt=xt[kt];if(Mt!=null&&Mt.facetFieldDef){const{titleAnchor:Ft,titleOrient:jt}=getHeaderProperties(["titleAnchor","titleOrient"],Mt.facetFieldDef.header,$t,kt),Bt=getHeaderChannel(kt,jt),Vt=getLayoutTitleBand(Ft,Bt);Vt!==void 0&&(Ct[Bt]=Vt)}}return isEmpty(Ct)?void 0:Ct}function assembleHeaderProperties(xt,$t,Ct,kt,Mt){const Ft={};for(const jt of kt){if(!Mt[jt])continue;const Bt=getHeaderProperty(jt,$t==null?void 0:$t.header,xt,Ct);Bt!==void 0&&(Ft[Mt[jt]]=Bt)}return Ft}function assembleLayoutSignals(xt){return[...sizeSignals(xt,"width"),...sizeSignals(xt,"height"),...sizeSignals(xt,"childWidth"),...sizeSignals(xt,"childHeight")]}function sizeSignals(xt,$t){const Ct=$t==="width"?"x":"y",kt=xt.component.layoutSize.get($t);if(!kt||kt==="merged")return[];const Mt=xt.getSizeSignalRef($t).signal;if(kt==="step"){const Ft=xt.getScaleComponent(Ct);if(Ft){const jt=Ft.get("type"),Bt=Ft.get("range");if(hasDiscreteDomain(jt)&&isVgRangeStep(Bt)){const Vt=xt.scaleName(Ct);return isFacetModel(xt.parent)&&xt.parent.component.resolve.scale[Ct]==="independent"?[stepSignal(Vt,Bt)]:[stepSignal(Vt,Bt),{name:Mt,update:sizeExpr(Vt,Ft,`domain('${Vt}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(kt=="container"){const Ft=Mt.endsWith("width"),jt=Ft?"containerSize()[0]":"containerSize()[1]",Bt=getViewConfigContinuousSize(xt.config.view,Ft?"width":"height"),Vt=`isFinite(${jt}) ? ${jt} : ${Bt}`;return[{name:Mt,init:Vt,on:[{update:Vt,events:"window:resize"}]}]}else return[{name:Mt,value:kt}]}function stepSignal(xt,$t){const Ct=`${xt}_step`;return isSignalRef($t.step)?{name:Ct,update:$t.step.signal}:{name:Ct,value:$t.step}}function sizeExpr(xt,$t,Ct){const kt=$t.get("type"),Mt=$t.get("padding"),Ft=getFirstDefined($t.get("paddingOuter"),Mt);let jt=$t.get("paddingInner");return jt=kt==="band"?jt!==void 0?jt:Mt:1,`bandspace(${Ct}, ${signalOrStringValue(jt)}, ${signalOrStringValue(Ft)}) * ${xt}_step`}function getSizeTypeFromLayoutSizeType(xt){return xt==="childWidth"?"width":xt==="childHeight"?"height":xt}function guideEncodeEntry(xt,$t){return keys(xt).reduce((Ct,kt)=>{const Mt=xt[kt];return{...Ct,...wrapCondition($t,Mt,kt,Ft=>signalOrValueRef(Ft.value))}},{})}function defaultScaleResolve(xt,$t){if(isFacetModel($t))return xt==="theta"?"independent":"shared";if(isLayerModel($t))return"shared";if(isConcatModel($t))return isXorY(xt)||xt==="theta"||xt==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function parseGuideResolve(xt,$t){const Ct=xt.scale[$t],kt=isXorY($t)?"axis":"legend";return Ct==="independent"?(xt[kt][$t]==="shared"&&warn(independentScaleMeansIndependentGuide($t)),"independent"):xt[kt][$t]||"shared"}const LEGEND_COMPONENT_PROPERTY_INDEX={...COMMON_LEGEND_PROPERTY_INDEX,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},LEGEND_COMPONENT_PROPERTIES=keys(LEGEND_COMPONENT_PROPERTY_INDEX);class LegendComponent extends Split{}const legendEncodeRules={symbols,gradient,labels:labels$1,entries};function symbols(xt,{fieldOrDatumDef:$t,model:Ct,channel:kt,legendCmpt:Mt,legendType:Ft}){if(Ft!=="symbol")return;const{markDef:jt,encoding:Bt,config:Vt,mark:zt}=Ct,Ht=jt.filled&&zt!=="trail";let Gt={...applyMarkConfig({},Ct,FILL_STROKE_CONFIG),...color(Ct,{filled:Ht})};const qt=Mt.get("symbolOpacity")??Vt.legend.symbolOpacity,Wt=Mt.get("symbolFillColor")??Vt.legend.symbolFillColor,Yt=Mt.get("symbolStrokeColor")??Vt.legend.symbolStrokeColor,Kt=qt===void 0?getMaxValue(Bt.opacity)??jt.opacity:void 0;if(Gt.fill){if(kt==="fill"||Ht&&kt===COLOR)delete Gt.fill;else if(Gt.fill.field)Wt?delete Gt.fill:(Gt.fill=signalOrValueRef(Vt.legend.symbolBaseFillColor??"black"),Gt.fillOpacity=signalOrValueRef(Kt??1));else if(isArray(Gt.fill)){const Xt=getFirstConditionValue(Bt.fill??Bt.color)??jt.fill??(Ht&&jt.color);Xt&&(Gt.fill=signalOrValueRef(Xt))}}if(Gt.stroke){if(kt==="stroke"||!Ht&&kt===COLOR)delete Gt.stroke;else if(Gt.stroke.field||Yt)delete Gt.stroke;else if(isArray(Gt.stroke)){const Xt=getFirstDefined(getFirstConditionValue(Bt.stroke||Bt.color),jt.stroke,Ht?jt.color:void 0);Xt&&(Gt.stroke={value:Xt})}}if(kt!==OPACITY){const Xt=isFieldDef($t)&&selectedCondition(Ct,Mt,$t);Xt?Gt.opacity=[{test:Xt,...signalOrValueRef(Kt??1)},signalOrValueRef(Vt.legend.unselectedOpacity)]:Kt&&(Gt.opacity=signalOrValueRef(Kt))}return Gt={...Gt,...xt},isEmpty(Gt)?void 0:Gt}function gradient(xt,{model:$t,legendType:Ct,legendCmpt:kt}){if(Ct!=="gradient")return;const{config:Mt,markDef:Ft,encoding:jt}=$t;let Bt={};const zt=(kt.get("gradientOpacity")??Mt.legend.gradientOpacity)===void 0?getMaxValue(jt.opacity)||Ft.opacity:void 0;return zt&&(Bt.opacity=signalOrValueRef(zt)),Bt={...Bt,...xt},isEmpty(Bt)?void 0:Bt}function labels$1(xt,{fieldOrDatumDef:$t,model:Ct,channel:kt,legendCmpt:Mt}){const Ft=Ct.legend(kt)||{},jt=Ct.config,Bt=isFieldDef($t)?selectedCondition(Ct,Mt,$t):void 0,Vt=Bt?[{test:Bt,value:1},{value:jt.legend.unselectedOpacity}]:void 0,{format:zt,formatType:Ht}=Ft;let Gt;isCustomFormatType(Ht)?Gt=formatCustomType({fieldOrDatumDef:$t,field:"datum.value",format:zt,formatType:Ht,config:jt}):zt===void 0&&Ht===void 0&&jt.customFormatTypes&&($t.type==="quantitative"&&jt.numberFormatType?Gt=formatCustomType({fieldOrDatumDef:$t,field:"datum.value",format:jt.numberFormat,formatType:jt.numberFormatType,config:jt}):$t.type==="temporal"&&jt.timeFormatType&&isFieldDef($t)&&$t.timeUnit===void 0&&(Gt=formatCustomType({fieldOrDatumDef:$t,field:"datum.value",format:jt.timeFormat,formatType:jt.timeFormatType,config:jt})));const qt={...Vt?{opacity:Vt}:{},...Gt?{text:Gt}:{},...xt};return isEmpty(qt)?void 0:qt}function entries(xt,{legendCmpt:$t}){const Ct=$t.get("selections");return Ct!=null&&Ct.length?{...xt,fill:{value:"transparent"}}:xt}function getMaxValue(xt){return getConditionValue(xt,($t,Ct)=>Math.max($t,Ct.value))}function getFirstConditionValue(xt){return getConditionValue(xt,($t,Ct)=>getFirstDefined($t,Ct.value))}function getConditionValue(xt,$t){if(hasConditionalValueDef(xt))return array$2(xt.condition).reduce($t,xt.value);if(isValueDef(xt))return xt.value}function selectedCondition(xt,$t,Ct){const kt=$t.get("selections");if(!(kt!=null&&kt.length))return;const Mt=$(Ct.field);return kt.map(Ft=>`(!length(data(${$(varName(Ft)+STORE)})) || (${Ft}[${Mt}] && indexof(${Ft}[${Mt}], datum.value) >= 0))`).join(" || ")}const legendRules={direction:({direction:xt})=>xt,format:({fieldOrDatumDef:xt,legend:$t,config:Ct})=>{const{format:kt,formatType:Mt}=$t;return guideFormat(xt,xt.type,kt,Mt,Ct,!1)},formatType:({legend:xt,fieldOrDatumDef:$t,scaleType:Ct})=>{const{formatType:kt}=xt;return guideFormatType(kt,$t,Ct)},gradientLength:xt=>{const{legend:$t,legendConfig:Ct}=xt;return $t.gradientLength??Ct.gradientLength??defaultGradientLength(xt)},labelOverlap:({legend:xt,legendConfig:$t,scaleType:Ct})=>xt.labelOverlap??$t.labelOverlap??defaultLabelOverlap(Ct),symbolType:({legend:xt,markDef:$t,channel:Ct,encoding:kt})=>xt.symbolType??defaultSymbolType($t.type,Ct,kt.shape,$t.shape),title:({fieldOrDatumDef:xt,config:$t})=>title(xt,$t,{allowDisabling:!0}),type:({legendType:xt,scaleType:$t,channel:Ct})=>{if(isColorChannel(Ct)&&isContinuousToContinuous($t)){if(xt==="gradient")return}else if(xt==="symbol")return;return xt},values:({fieldOrDatumDef:xt,legend:$t})=>values($t,xt)};function values(xt,$t){const Ct=xt.values;if(isArray(Ct))return valueArray($t,Ct);if(isSignalRef(Ct))return Ct}function defaultSymbolType(xt,$t,Ct,kt){if($t!=="shape"){const Mt=getFirstConditionValue(Ct)??kt;if(Mt)return Mt}switch(xt){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function getLegendType(xt){const{legend:$t}=xt;return getFirstDefined($t.type,defaultType$1(xt))}function defaultType$1({channel:xt,timeUnit:$t,scaleType:Ct}){if(isColorChannel(xt)){if(contains(["quarter","month","day"],$t))return"symbol";if(isContinuousToContinuous(Ct))return"gradient"}return"symbol"}function getDirection({legendConfig:xt,legendType:$t,orient:Ct,legend:kt}){return kt.direction??xt[$t?"gradientDirection":"symbolDirection"]??defaultDirection(Ct,$t)}function defaultDirection(xt,$t){switch(xt){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return $t==="gradient"?"horizontal":void 0}}function defaultGradientLength({legendConfig:xt,model:$t,direction:Ct,orient:kt,scaleType:Mt}){const{gradientHorizontalMaxLength:Ft,gradientHorizontalMinLength:jt,gradientVerticalMaxLength:Bt,gradientVerticalMinLength:Vt}=xt;if(isContinuousToContinuous(Mt))return Ct==="horizontal"?kt==="top"||kt==="bottom"?gradientLengthSignal($t,"width",jt,Ft):jt:gradientLengthSignal($t,"height",Vt,Bt)}function gradientLengthSignal(xt,$t,Ct,kt){return{signal:`clamp(${xt.getSizeSignalRef($t).signal}, ${Ct}, ${kt})`}}function defaultLabelOverlap(xt){if(contains(["quantile","threshold","log","symlog"],xt))return"greedy"}function parseLegend(xt){const $t=isUnitModel(xt)?parseUnitLegend(xt):parseNonUnitLegend(xt);return xt.component.legends=$t,$t}function parseUnitLegend(xt){const{encoding:$t}=xt,Ct={};for(const kt of[COLOR,...LEGEND_SCALE_CHANNELS]){const Mt=getFieldOrDatumDef($t[kt]);!Mt||!xt.getScaleComponent(kt)||kt===SHAPE&&isFieldDef(Mt)&&Mt.type===GEOJSON||(Ct[kt]=parseLegendForChannel(xt,kt))}return Ct}function getLegendDefWithScale(xt,$t){const Ct=xt.scaleName($t);if(xt.mark==="trail"){if($t==="color")return{stroke:Ct};if($t==="size")return{strokeWidth:Ct}}return $t==="color"?xt.markDef.filled?{fill:Ct}:{stroke:Ct}:{[$t]:Ct}}function isExplicit$1(xt,$t,Ct,kt){switch($t){case"disable":return Ct!==void 0;case"values":return!!(Ct!=null&&Ct.values);case"title":if($t==="title"&&xt===(kt==null?void 0:kt.title))return!0}return xt===(Ct||{})[$t]}function parseLegendForChannel(xt,$t){var sn;let Ct=xt.legend($t);const{markDef:kt,encoding:Mt,config:Ft}=xt,jt=Ft.legend,Bt=new LegendComponent({},getLegendDefWithScale(xt,$t));parseInteractiveLegend(xt,$t,Bt);const Vt=Ct!==void 0?!Ct:jt.disable;if(Bt.set("disable",Vt,Ct!==void 0),Vt)return Bt;Ct=Ct||{};const zt=xt.getScaleComponent($t).get("type"),Ht=getFieldOrDatumDef(Mt[$t]),Gt=isFieldDef(Ht)?(sn=normalizeTimeUnit(Ht.timeUnit))==null?void 0:sn.unit:void 0,qt=Ct.orient||Ft.legend.orient||"right",Wt=getLegendType({legend:Ct,channel:$t,timeUnit:Gt,scaleType:zt}),Yt=getDirection({legend:Ct,legendType:Wt,orient:qt,legendConfig:jt}),Kt={legend:Ct,channel:$t,model:xt,markDef:kt,encoding:Mt,fieldOrDatumDef:Ht,legendConfig:jt,config:Ft,scaleType:zt,orient:qt,legendType:Wt,direction:Yt};for(const ln of LEGEND_COMPONENT_PROPERTIES){if(Wt==="gradient"&&ln.startsWith("symbol")||Wt==="symbol"&&ln.startsWith("gradient"))continue;const dn=ln in legendRules?legendRules[ln](Kt):Ct[ln];if(dn!==void 0){const hn=isExplicit$1(dn,ln,Ct,xt.fieldDef($t));(hn||Ft.legend[ln]===void 0)&&Bt.set(ln,dn,hn)}}const Xt=(Ct==null?void 0:Ct.encoding)??{},Qt=Bt.get("selections"),Jt={},Zt={fieldOrDatumDef:Ht,model:xt,channel:$t,legendCmpt:Bt,legendType:Wt};for(const ln of["labels","legend","title","symbols","gradient","entries"]){const dn=guideEncodeEntry(Xt[ln]??{},xt),hn=ln in legendEncodeRules?legendEncodeRules[ln](dn,Zt):dn;hn!==void 0&&!isEmpty(hn)&&(Jt[ln]={...Qt!=null&&Qt.length&&isFieldDef(Ht)?{name:`${varName(Ht.field)}_legend_${ln}`}:{},...Qt!=null&&Qt.length?{interactive:!!Qt}:{},update:hn})}return isEmpty(Jt)||Bt.set("encode",Jt,!!(Ct!=null&&Ct.encoding)),Bt}function parseNonUnitLegend(xt){const{legends:$t,resolve:Ct}=xt.component;for(const kt of xt.children){parseLegend(kt);for(const Mt of keys(kt.component.legends))Ct.legend[Mt]=parseGuideResolve(xt.component.resolve,Mt),Ct.legend[Mt]==="shared"&&($t[Mt]=mergeLegendComponent($t[Mt],kt.component.legends[Mt]),$t[Mt]||(Ct.legend[Mt]="independent",delete $t[Mt]))}for(const kt of keys($t))for(const Mt of xt.children)Mt.component.legends[kt]&&Ct.legend[kt]==="shared"&&delete Mt.component.legends[kt];return $t}function mergeLegendComponent(xt,$t){var Ft,jt,Bt,Vt;if(!xt)return $t.clone();const Ct=xt.getWithExplicit("orient"),kt=$t.getWithExplicit("orient");if(Ct.explicit&&kt.explicit&&Ct.value!==kt.value)return;let Mt=!1;for(const zt of LEGEND_COMPONENT_PROPERTIES){const Ht=mergeValuesWithExplicit(xt.getWithExplicit(zt),$t.getWithExplicit(zt),zt,"legend",(Gt,qt)=>{switch(zt){case"symbolType":return mergeSymbolType(Gt,qt);case"title":return mergeTitleComponent(Gt,qt);case"type":return Mt=!0,makeImplicit("symbol")}return defaultTieBreaker(Gt,qt,zt,"legend")});xt.setWithExplicit(zt,Ht)}return Mt&&((jt=(Ft=xt.implicit)==null?void 0:Ft.encode)!=null&&jt.gradient&&deleteNestedProperty(xt.implicit,["encode","gradient"]),(Vt=(Bt=xt.explicit)==null?void 0:Bt.encode)!=null&&Vt.gradient&&deleteNestedProperty(xt.explicit,["encode","gradient"])),xt}function mergeSymbolType(xt,$t){return $t.value==="circle"?$t:xt}function setLegendEncode(xt,$t,Ct,kt){var Mt,Ft;xt.encode??(xt.encode={}),(Mt=xt.encode)[$t]??(Mt[$t]={}),(Ft=xt.encode[$t]).update??(Ft.update={}),xt.encode[$t].update[Ct]=kt}function assembleLegends(xt){const $t=xt.component.legends,Ct={};for(const Mt of keys($t)){const Ft=xt.getScaleComponent(Mt),jt=stringify$1(Ft.get("domains"));if(Ct[jt])for(const Bt of Ct[jt])mergeLegendComponent(Bt,$t[Mt])||Ct[jt].push($t[Mt]);else Ct[jt]=[$t[Mt].clone()]}return vals(Ct).flat().map(Mt=>assembleLegend(Mt,xt.config)).filter(Mt=>Mt!==void 0)}function assembleLegend(xt,$t){var jt,Bt,Vt;const{disable:Ct,labelExpr:kt,selections:Mt,...Ft}=xt.combine();if(!Ct){if($t.aria===!1&&Ft.aria==null&&(Ft.aria=!1),(jt=Ft.encode)!=null&&jt.symbols){const zt=Ft.encode.symbols.update;zt.fill&&zt.fill.value!=="transparent"&&!zt.stroke&&!Ft.stroke&&(zt.stroke={value:"transparent"});for(const Ht of LEGEND_SCALE_CHANNELS)Ft[Ht]&&delete zt[Ht]}if(Ft.title||delete Ft.title,kt!==void 0){let zt=kt;(Vt=(Bt=Ft.encode)==null?void 0:Bt.labels)!=null&&Vt.update&&isSignalRef(Ft.encode.labels.update.text)&&(zt=replaceAll(kt,"datum.label",Ft.encode.labels.update.text.signal)),setLegendEncode(Ft,"labels","text",{signal:zt})}return Ft}}function assembleProjections(xt){return isLayerModel(xt)||isConcatModel(xt)?assembleProjectionsForModelAndChildren(xt):assembleProjectionForModel(xt)}function assembleProjectionsForModelAndChildren(xt){return xt.children.reduce(($t,Ct)=>$t.concat(Ct.assembleProjections()),assembleProjectionForModel(xt))}function assembleProjectionForModel(xt){const $t=xt.component.projection;if(!$t||$t.merged)return[];const Ct=$t.combine(),{name:kt}=Ct;if($t.data){const Mt={signal:`[${$t.size.map(jt=>jt.signal).join(", ")}]`},Ft=$t.data.reduce((jt,Bt)=>{const Vt=isSignalRef(Bt)?Bt.signal:`data('${xt.lookupDataSource(Bt)}')`;return contains(jt,Vt)||jt.push(Vt),jt},[]);if(Ft.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:kt,size:Mt,fit:{signal:Ft.length>1?`[${Ft.join(", ")}]`:Ft[0]},...Ct}]}else return[{name:kt,translate:{signal:"[width / 2, height / 2]"},...Ct}]}const PROJECTION_PROPERTIES=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class ProjectionComponent extends Split{constructor($t,Ct,kt,Mt){super({...Ct},{name:$t}),this.specifiedProjection=Ct,this.size=kt,this.data=Mt,this.merged=!1}get isFit(){return!!this.data}}function parseProjection(xt){xt.component.projection=isUnitModel(xt)?parseUnitProjection(xt):parseNonUnitProjections(xt)}function parseUnitProjection(xt){if(xt.hasProjection){const $t=replaceExprRef(xt.specifiedProjection),Ct=!($t&&($t.scale!=null||$t.translate!=null)),kt=Ct?[xt.getSizeSignalRef("width"),xt.getSizeSignalRef("height")]:void 0,Mt=Ct?gatherFitData(xt):void 0,Ft=new ProjectionComponent(xt.projectionName(!0),{...replaceExprRef(xt.config.projection),...$t},kt,Mt);return Ft.get("type")||Ft.set("type","equalEarth",!1),Ft}}function gatherFitData(xt){const $t=[],{encoding:Ct}=xt;for(const kt of[[LONGITUDE,LATITUDE],[LONGITUDE2,LATITUDE2]])(getFieldOrDatumDef(Ct[kt[0]])||getFieldOrDatumDef(Ct[kt[1]]))&&$t.push({signal:xt.getName(`geojson_${$t.length}`)});return xt.channelHasField(SHAPE)&&xt.typedFieldDef(SHAPE).type===GEOJSON&&$t.push({signal:xt.getName(`geojson_${$t.length}`)}),$t.length===0&&$t.push(xt.requestDataName(DataSourceType.Main)),$t}function mergeIfNoConflict(xt,$t){const Ct=every(PROJECTION_PROPERTIES,Mt=>!!(!has$1(xt.explicit,Mt)&&!has$1($t.explicit,Mt)||has$1(xt.explicit,Mt)&&has$1($t.explicit,Mt)&&deepEqual(xt.get(Mt),$t.get(Mt))));if(deepEqual(xt.size,$t.size)){if(Ct)return xt;if(deepEqual(xt.explicit,{}))return $t;if(deepEqual($t.explicit,{}))return xt}return null}function parseNonUnitProjections(xt){if(xt.children.length===0)return;let $t;for(const kt of xt.children)parseProjection(kt);const Ct=every(xt.children,kt=>{const Mt=kt.component.projection;if(Mt)if($t){const Ft=mergeIfNoConflict($t,Mt);return Ft&&($t=Ft),!!Ft}else return $t=Mt,!0;else return!0});if($t&&Ct){const kt=xt.projectionName(!0),Mt=new ProjectionComponent(kt,$t.specifiedProjection,$t.size,duplicate($t.data));for(const Ft of xt.children){const jt=Ft.component.projection;jt&&(jt.isFit&&Mt.data.push(...Ft.component.projection.data),Ft.renameProjection(jt.get("name"),kt),jt.merged=!0)}return Mt}}function rangeFormula(xt,$t,Ct,kt){if(binRequiresRange($t,Ct)){const Mt=isUnitModel(xt)?xt.axis(Ct)??xt.legend(Ct)??{}:{},Ft=vgField($t,{expr:"datum"}),jt=vgField($t,{expr:"datum",binSuffix:"end"});return{formulaAs:vgField($t,{binSuffix:"range",forAs:!0}),formula:binFormatExpression(Ft,jt,Mt.format,Mt.formatType,kt)}}return{}}function binKey(xt,$t){return`${binToString(xt)}_${$t}`}function getSignalsFromModel(xt,$t){return{signal:xt.getName(`${$t}_bins`),extentSignal:xt.getName(`${$t}_extent`)}}function getBinSignalName(xt,$t,Ct){const kt=normalizeBin(Ct,void 0)??{},Mt=binKey(kt,$t);return xt.getName(`${Mt}_bins`)}function isBinTransform(xt){return"as"in xt}function createBinComponent(xt,$t,Ct){let kt,Mt;isBinTransform(xt)?kt=isString(xt.as)?[xt.as,`${xt.as}_end`]:[xt.as[0],xt.as[1]]:kt=[vgField(xt,{forAs:!0}),vgField(xt,{binSuffix:"end",forAs:!0})];const Ft={...normalizeBin($t,void 0)},jt=binKey(Ft,xt.field),{signal:Bt,extentSignal:Vt}=getSignalsFromModel(Ct,jt);if(isParameterExtent(Ft.extent)){const Ht=Ft.extent;Mt=parseSelectionExtent(Ct,Ht.param,Ht),delete Ft.extent}const zt={bin:Ft,field:xt.field,as:[kt],...Bt?{signal:Bt}:{},...Vt?{extentSignal:Vt}:{},...Mt?{span:Mt}:{}};return{key:jt,binComponent:zt}}class BinNode extends DataFlowNode{clone(){return new BinNode(null,duplicate(this.bins))}constructor($t,Ct){super($t),this.bins=Ct}static makeFromEncoding($t,Ct){const kt=Ct.reduceFieldDef((Mt,Ft,jt)=>{if(isTypedFieldDef(Ft)&&isBinning(Ft.bin)){const{key:Bt,binComponent:Vt}=createBinComponent(Ft,Ft.bin,Ct);Mt[Bt]={...Vt,...Mt[Bt],...rangeFormula(Ct,Ft,jt,Ct.config)}}return Mt},{});return isEmpty(kt)?null:new BinNode($t,kt)}static makeFromTransform($t,Ct,kt){const{key:Mt,binComponent:Ft}=createBinComponent(Ct,Ct.bin,kt);return new BinNode($t,{[Mt]:Ft})}merge($t,Ct){for(const kt of keys($t.bins))kt in this.bins?(Ct($t.bins[kt].signal,this.bins[kt].signal),this.bins[kt].as=unique([...this.bins[kt].as,...$t.bins[kt].as],hash)):this.bins[kt]=$t.bins[kt];for(const kt of $t.children)$t.removeChild(kt),kt.parent=this;$t.remove()}producedFields(){return new Set(vals(this.bins).map($t=>$t.as).flat(2))}dependentFields(){return new Set(vals(this.bins).map($t=>$t.field))}hash(){return`Bin ${hash(this.bins)}`}assemble(){return vals(this.bins).flatMap($t=>{const Ct=[],[kt,...Mt]=$t.as,{extent:Ft,...jt}=$t.bin,Bt={type:"bin",field:replacePathInField($t.field),as:kt,signal:$t.signal,...isParameterExtent(Ft)?{extent:null}:{extent:Ft},...$t.span?{span:{signal:`span(${$t.span})`}}:{},...jt};!Ft&&$t.extentSignal&&(Ct.push({type:"extent",field:replacePathInField($t.field),signal:$t.extentSignal}),Bt.extent={signal:$t.extentSignal}),Ct.push(Bt);for(const Vt of Mt)for(let zt=0;zt<2;zt++)Ct.push({type:"formula",expr:vgField({field:kt[zt]},{expr:"datum"}),as:Vt[zt]});return $t.formula&&Ct.push({type:"formula",expr:$t.formula,as:$t.formulaAs}),Ct})}}function addDimension(xt,$t,Ct,kt){var Ft;const Mt=isUnitModel(kt)?kt.encoding[getSecondaryRangeChannel($t)]:void 0;if(isTypedFieldDef(Ct)&&isUnitModel(kt)&&hasBandEnd(Ct,Mt,kt.markDef,kt.config)){xt.add(vgField(Ct,{})),xt.add(vgField(Ct,{suffix:"end"}));const{mark:jt,markDef:Bt,config:Vt}=kt,zt=getBandPosition({fieldDef:Ct,markDef:Bt,config:Vt});isRectBasedMark(jt)&&zt!==.5&&isXorY($t)&&(xt.add(vgField(Ct,{suffix:OFFSETTED_RECT_START_SUFFIX})),xt.add(vgField(Ct,{suffix:OFFSETTED_RECT_END_SUFFIX}))),Ct.bin&&binRequiresRange(Ct,$t)&&xt.add(vgField(Ct,{binSuffix:"range"}))}else if(isGeoPositionChannel($t)){const jt=getPositionChannelFromLatLong($t);xt.add(kt.getName(jt))}else xt.add(vgField(Ct));return isScaleFieldDef(Ct)&&isFieldRange((Ft=Ct.scale)==null?void 0:Ft.range)&&xt.add(Ct.scale.range.field),xt}function mergeMeasures(xt,$t){for(const Ct of keys($t)){const kt=$t[Ct];for(const Mt of keys(kt))Ct in xt?xt[Ct][Mt]=new Set([...xt[Ct][Mt]??[],...kt[Mt]]):xt[Ct]={[Mt]:kt[Mt]}}}class AggregateNode extends DataFlowNode{clone(){return new AggregateNode(null,new Set(this.dimensions),duplicate(this.measures))}constructor($t,Ct,kt){super($t),this.dimensions=Ct,this.measures=kt}get groupBy(){return this.dimensions}static makeFromEncoding($t,Ct){let kt=!1;Ct.forEachFieldDef(jt=>{jt.aggregate&&(kt=!0)});const Mt={},Ft=new Set;return!kt||(Ct.forEachFieldDef((jt,Bt)=>{const{aggregate:Vt,field:zt}=jt;if(Vt)if(Vt==="count")Mt["*"]??(Mt["*"]={}),Mt["*"].count=new Set([vgField(jt,{forAs:!0})]);else{if(isArgminDef(Vt)||isArgmaxDef(Vt)){const Ht=isArgminDef(Vt)?"argmin":"argmax",Gt=Vt[Ht];Mt[Gt]??(Mt[Gt]={}),Mt[Gt][Ht]=new Set([vgField({op:Ht,field:Gt},{forAs:!0})])}else Mt[zt]??(Mt[zt]={}),Mt[zt][Vt]=new Set([vgField(jt,{forAs:!0})]);isScaleChannel(Bt)&&Ct.scaleDomain(Bt)==="unaggregated"&&(Mt[zt]??(Mt[zt]={}),Mt[zt].min=new Set([vgField({field:zt,aggregate:"min"},{forAs:!0})]),Mt[zt].max=new Set([vgField({field:zt,aggregate:"max"},{forAs:!0})]))}else addDimension(Ft,Bt,jt,Ct)}),Ft.size+keys(Mt).length===0)?null:new AggregateNode($t,Ft,Mt)}static makeFromTransform($t,Ct){const kt=new Set,Mt={};for(const Ft of Ct.aggregate){const{op:jt,field:Bt,as:Vt}=Ft;jt&&(jt==="count"?(Mt["*"]??(Mt["*"]={}),Mt["*"].count=new Set([Vt||vgField(Ft,{forAs:!0})])):(Mt[Bt]??(Mt[Bt]={}),Mt[Bt][jt]=new Set([Vt||vgField(Ft,{forAs:!0})])))}for(const Ft of Ct.groupby??[])kt.add(Ft);return kt.size+keys(Mt).length===0?null:new AggregateNode($t,kt,Mt)}merge($t){return setEqual(this.dimensions,$t.dimensions)?(mergeMeasures(this.measures,$t.measures),!0):(debug$2("different dimensions, cannot merge"),!1)}addDimensions($t){$t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...keys(this.measures)])}producedFields(){const $t=new Set;for(const Ct of keys(this.measures))for(const kt of keys(this.measures[Ct])){const Mt=this.measures[Ct][kt];Mt.size===0?$t.add(`${kt}_${Ct}`):Mt.forEach($t.add,$t)}return $t}hash(){return`Aggregate ${hash({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const $t=[],Ct=[],kt=[];for(const Ft of keys(this.measures))for(const jt of keys(this.measures[Ft]))for(const Bt of this.measures[Ft][jt])kt.push(Bt),$t.push(jt),Ct.push(Ft==="*"?null:replacePathInField(Ft));return{type:"aggregate",groupby:[...this.dimensions].map(replacePathInField),ops:$t,fields:Ct,as:kt}}}class FacetNode extends DataFlowNode{constructor($t,Ct,kt,Mt){super($t),this.model=Ct,this.name=kt,this.data=Mt;for(const Ft of FACET_CHANNELS){const jt=Ct.facet[Ft];if(jt){const{bin:Bt,sort:Vt}=jt;this[Ft]={name:Ct.getName(`${Ft}_domain`),fields:[vgField(jt),...isBinning(Bt)?[vgField(jt,{binSuffix:"end"})]:[]],...isSortField(Vt)?{sortField:Vt}:isArray(Vt)?{sortIndexField:sortArrayIndexField(jt,Ft)}:{}}}}this.childModel=Ct.child}hash(){let $t="Facet";for(const Ct of FACET_CHANNELS)this[Ct]&&($t+=` ${Ct.charAt(0)}:${hash(this[Ct])}`);return $t}get fields(){var Ct;const $t=[];for(const kt of FACET_CHANNELS)(Ct=this[kt])!=null&&Ct.fields&&$t.push(...this[kt].fields);return $t}dependentFields(){const $t=new Set(this.fields);for(const Ct of FACET_CHANNELS)this[Ct]&&(this[Ct].sortField&&$t.add(this[Ct].sortField.field),this[Ct].sortIndexField&&$t.add(this[Ct].sortIndexField));return $t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const $t={};for(const Ct of POSITION_SCALE_CHANNELS){const kt=this.childModel.component.scales[Ct];if(kt&&!kt.merged){const Mt=kt.get("type"),Ft=kt.get("range");if(hasDiscreteDomain(Mt)&&isVgRangeStep(Ft)){const jt=assembleDomain(this.childModel,Ct),Bt=getFieldFromDomain(jt);Bt?$t[Ct]=Bt:warn(unknownField(Ct))}}}return $t}assembleRowColumnHeaderData($t,Ct,kt){const Mt={row:"y",column:"x",facet:void 0}[$t],Ft=[],jt=[],Bt=[];Mt&&kt&&kt[Mt]&&(Ct?(Ft.push(`distinct_${kt[Mt]}`),jt.push("max")):(Ft.push(kt[Mt]),jt.push("distinct")),Bt.push(`distinct_${kt[Mt]}`));const{sortField:Vt,sortIndexField:zt}=this[$t];if(Vt){const{op:Ht=DEFAULT_SORT_OP,field:Gt}=Vt;Ft.push(Gt),jt.push(Ht),Bt.push(vgField(Vt,{forAs:!0}))}else zt&&(Ft.push(zt),jt.push("max"),Bt.push(zt));return{name:this[$t].name,source:Ct??this.data,transform:[{type:"aggregate",groupby:this[$t].fields,...Ft.length?{fields:Ft,ops:jt,as:Bt}:{}}]}}assembleFacetHeaderData($t){var Vt;const{columns:Ct}=this.model.layout,{layoutHeaders:kt}=this.model.component,Mt=[],Ft={};for(const zt of HEADER_CHANNELS){for(const Ht of HEADER_TYPES){const Gt=(kt[zt]&&kt[zt][Ht])??[];for(const qt of Gt)if(((Vt=qt.axes)==null?void 0:Vt.length)>0){Ft[zt]=!0;break}}if(Ft[zt]){const Ht=`length(data("${this.facet.name}"))`,Gt=zt==="row"?Ct?{signal:`ceil(${Ht} / ${Ct})`}:1:Ct?{signal:`min(${Ht}, ${Ct})`}:{signal:Ht};Mt.push({name:`${this.facet.name}_${zt}`,transform:[{type:"sequence",start:0,stop:Gt}]})}}const{row:jt,column:Bt}=Ft;return(jt||Bt)&&Mt.unshift(this.assembleRowColumnHeaderData("facet",null,$t)),Mt}assemble(){const $t=[];let Ct=null;const kt=this.getChildIndependentFieldsWithStep(),{column:Mt,row:Ft,facet:jt}=this;if(Mt&&Ft&&(kt.x||kt.y)){Ct=`cross_${this.column.name}_${this.row.name}`;const Bt=[].concat(kt.x??[],kt.y??[]),Vt=Bt.map(()=>"distinct");$t.push({name:Ct,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:Bt,ops:Vt}]})}for(const Bt of[COLUMN,ROW])this[Bt]&&$t.push(this.assembleRowColumnHeaderData(Bt,Ct,kt));if(jt){const Bt=this.assembleFacetHeaderData(kt);Bt&&$t.push(...Bt)}return $t}}function unquote(xt){return xt.startsWith("'")&&xt.endsWith("'")||xt.startsWith('"')&&xt.endsWith('"')?xt.slice(1,-1):xt}function parseExpression(xt,$t){const Ct=accessPathWithDatum(xt);if($t==="number")return`toNumber(${Ct})`;if($t==="boolean")return`toBoolean(${Ct})`;if($t==="string")return`toString(${Ct})`;if($t==="date")return`toDate(${Ct})`;if($t==="flatten")return Ct;if($t.startsWith("date:")){const kt=unquote($t.slice(5,$t.length));return`timeParse(${Ct},'${kt}')`}else if($t.startsWith("utc:")){const kt=unquote($t.slice(4,$t.length));return`utcParse(${Ct},'${kt}')`}else return warn(unrecognizedParse($t)),null}function getImplicitFromFilterTransform(xt){const $t={};return forEachLeaf(xt.filter,Ct=>{if(isFieldPredicate(Ct)){let kt=null;isFieldEqualPredicate(Ct)?kt=signalRefOrValue(Ct.equal):isFieldLTEPredicate(Ct)?kt=signalRefOrValue(Ct.lte):isFieldLTPredicate(Ct)?kt=signalRefOrValue(Ct.lt):isFieldGTPredicate(Ct)?kt=signalRefOrValue(Ct.gt):isFieldGTEPredicate(Ct)?kt=signalRefOrValue(Ct.gte):isFieldRangePredicate(Ct)?kt=Ct.range[0]:isFieldOneOfPredicate(Ct)&&(kt=(Ct.oneOf??Ct.in)[0]),kt&&(isDateTime(kt)?$t[Ct.field]="date":isNumber$1(kt)?$t[Ct.field]="number":isString(kt)&&($t[Ct.field]="string")),Ct.timeUnit&&($t[Ct.field]="date")}}),$t}function getImplicitFromEncoding(xt){const $t={};function Ct(kt){isFieldOrDatumDefForTimeFormat(kt)?$t[kt.field]="date":kt.type==="quantitative"&&isMinMaxOp(kt.aggregate)?$t[kt.field]="number":accessPathDepth(kt.field)>1?kt.field in $t||($t[kt.field]="flatten"):isScaleFieldDef(kt)&&isSortField(kt.sort)&&accessPathDepth(kt.sort.field)>1&&(kt.sort.field in $t||($t[kt.sort.field]="flatten"))}if((isUnitModel(xt)||isFacetModel(xt))&&xt.forEachFieldDef((kt,Mt)=>{if(isTypedFieldDef(kt))Ct(kt);else{const Ft=getMainRangeChannel(Mt),jt=xt.fieldDef(Ft);Ct({...kt,type:jt.type})}}),isUnitModel(xt)){const{mark:kt,markDef:Mt,encoding:Ft}=xt;if(isPathMark(kt)&&!xt.encoding.order){const jt=Mt.orient==="horizontal"?"y":"x",Bt=Ft[jt];isFieldDef(Bt)&&Bt.type==="quantitative"&&!(Bt.field in $t)&&($t[Bt.field]="number")}}return $t}function getImplicitFromSelection(xt){const $t={};if(isUnitModel(xt)&&xt.component.selection)for(const Ct of keys(xt.component.selection)){const kt=xt.component.selection[Ct];for(const Mt of kt.project.items)!Mt.channel&&accessPathDepth(Mt.field)>1&&($t[Mt.field]="flatten")}return $t}class ParseNode extends DataFlowNode{clone(){return new ParseNode(null,duplicate(this._parse))}constructor($t,Ct){super($t),this._parse=Ct}hash(){return`Parse ${hash(this._parse)}`}static makeExplicit($t,Ct,kt){var jt;let Mt={};const Ft=Ct.data;return!isGenerator(Ft)&&((jt=Ft==null?void 0:Ft.format)!=null&&jt.parse)&&(Mt=Ft.format.parse),this.makeWithAncestors($t,Mt,{},kt)}static makeWithAncestors($t,Ct,kt,Mt){for(const Bt of keys(kt)){const Vt=Mt.getWithExplicit(Bt);Vt.value!==void 0&&(Vt.explicit||Vt.value===kt[Bt]||Vt.value==="derived"||kt[Bt]==="flatten"?delete kt[Bt]:warn(differentParse(Bt,kt[Bt],Vt.value)))}for(const Bt of keys(Ct)){const Vt=Mt.get(Bt);Vt!==void 0&&(Vt===Ct[Bt]?delete Ct[Bt]:warn(differentParse(Bt,Ct[Bt],Vt)))}const Ft=new Split(Ct,kt);Mt.copyAll(Ft);const jt={};for(const Bt of keys(Ft.combine())){const Vt=Ft.get(Bt);Vt!==null&&(jt[Bt]=Vt)}return keys(jt).length===0||Mt.parseNothing?null:new ParseNode($t,jt)}get parse(){return this._parse}merge($t){this._parse={...this._parse,...$t.parse},$t.remove()}assembleFormatParse(){const $t={};for(const Ct of keys(this._parse)){const kt=this._parse[Ct];accessPathDepth(Ct)===1&&($t[Ct]=kt)}return $t}producedFields(){return new Set(keys(this._parse))}dependentFields(){return new Set(keys(this._parse))}assembleTransforms($t=!1){return keys(this._parse).filter(Ct=>$t?accessPathDepth(Ct)>1:!0).map(Ct=>{const kt=parseExpression(Ct,this._parse[Ct]);return kt?{type:"formula",expr:kt,as:removePathFromField(Ct)}:null}).filter(Ct=>Ct!==null)}}class IdentifierNode extends DataFlowNode{clone(){return new IdentifierNode(null)}constructor($t){super($t)}dependentFields(){return new Set}producedFields(){return new Set([SELECTION_ID])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:SELECTION_ID}}}class GraticuleNode extends DataFlowNode{clone(){return new GraticuleNode(null,this.params)}constructor($t,Ct){super($t),this.params=Ct}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${hash(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}}class SequenceNode extends DataFlowNode{clone(){return new SequenceNode(null,this.params)}constructor($t,Ct){super($t),this.params=Ct}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${hash(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class SourceNode extends DataFlowNode{constructor($t){super(null),$t??($t={name:"source"});let Ct;if(isGenerator($t)||(Ct=$t.format?{...omit($t.format,["parse"])}:{}),isInlineData($t))this._data={values:$t.values};else if(isUrlData($t)){if(this._data={url:$t.url},!Ct.type){let kt=/(?:\.([^.]+))?$/.exec($t.url)[1];contains(["json","csv","tsv","dsv","topojson"],kt)||(kt="json"),Ct.type=kt}}else isSphereGenerator($t)?this._data={values:[{type:"Sphere"}]}:(isNamedData($t)||isGenerator($t))&&(this._data={});this._generator=isGenerator($t),$t.name&&(this._name=$t.name),Ct&&!isEmpty(Ct)&&(this._data.format=Ct)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName($t){this._name=$t}set parent($t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var __classPrivateFieldSet=function(xt,$t,Ct,kt,Mt){if(kt==="m")throw new TypeError("Private method is not writable");if(kt==="a"&&!Mt)throw new TypeError("Private accessor was defined without a setter");if(typeof $t=="function"?xt!==$t||!Mt:!$t.has(xt))throw new TypeError("Cannot write private member to an object whose class did not declare it");return kt==="a"?Mt.call(xt,Ct):Mt?Mt.value=Ct:$t.set(xt,Ct),Ct},__classPrivateFieldGet=function(xt,$t,Ct,kt){if(Ct==="a"&&!kt)throw new TypeError("Private accessor was defined without a getter");if(typeof $t=="function"?xt!==$t||!kt:!$t.has(xt))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Ct==="m"?kt:Ct==="a"?kt.call(xt):kt?kt.value:$t.get(xt)},_Optimizer_modified;function isDataSourceNode(xt){return xt instanceof SourceNode||xt instanceof GraticuleNode||xt instanceof SequenceNode}class Optimizer{constructor(){_Optimizer_modified.set(this,void 0),__classPrivateFieldSet(this,_Optimizer_modified,!1,"f")}setModified(){__classPrivateFieldSet(this,_Optimizer_modified,!0,"f")}get modifiedFlag(){return __classPrivateFieldGet(this,_Optimizer_modified,"f")}}_Optimizer_modified=new WeakMap;class BottomUpOptimizer extends Optimizer{getNodeDepths($t,Ct,kt){kt.set($t,Ct);for(const Mt of $t.children)this.getNodeDepths(Mt,Ct+1,kt);return kt}optimize($t){const kt=[...this.getNodeDepths($t,0,new Map).entries()].sort((Mt,Ft)=>Ft[1]-Mt[1]);for(const Mt of kt)this.run(Mt[0]);return this.modifiedFlag}}class TopDownOptimizer extends Optimizer{optimize($t){this.run($t);for(const Ct of $t.children)this.optimize(Ct);return this.modifiedFlag}}class MergeIdenticalNodes extends TopDownOptimizer{mergeNodes($t,Ct){const kt=Ct.shift();for(const Mt of Ct)$t.removeChild(Mt),Mt.parent=kt,Mt.remove()}run($t){const Ct=$t.children.map(Mt=>Mt.hash()),kt={};for(let Mt=0;Mt<Ct.length;Mt++)kt[Ct[Mt]]===void 0?kt[Ct[Mt]]=[$t.children[Mt]]:kt[Ct[Mt]].push($t.children[Mt]);for(const Mt of keys(kt))kt[Mt].length>1&&(this.setModified(),this.mergeNodes($t,kt[Mt]))}}class RemoveUnnecessaryIdentifierNodes extends TopDownOptimizer{constructor($t){super(),this.requiresSelectionId=$t&&requiresSelectionId($t)}run($t){$t instanceof IdentifierNode&&(this.requiresSelectionId&&(isDataSourceNode($t.parent)||$t.parent instanceof AggregateNode||$t.parent instanceof ParseNode)||(this.setModified(),$t.remove()))}}class RemoveDuplicateTimeUnits extends Optimizer{optimize($t){return this.run($t,new Set),this.modifiedFlag}run($t,Ct){let kt=new Set;$t instanceof TimeUnitNode&&(kt=$t.producedFields(),hasIntersection(kt,Ct)&&(this.setModified(),$t.removeFormulas(Ct),$t.producedFields.length===0&&$t.remove()));for(const Mt of $t.children)this.run(Mt,new Set([...Ct,...kt]))}}class RemoveUnnecessaryOutputNodes extends TopDownOptimizer{constructor(){super()}run($t){$t instanceof OutputNode&&!$t.isRequired()&&(this.setModified(),$t.remove())}}class MoveParseUp extends BottomUpOptimizer{run($t){if(!isDataSourceNode($t)&&!($t.numChildren()>1)){for(const Ct of $t.children)if(Ct instanceof ParseNode)if($t instanceof ParseNode)this.setModified(),$t.merge(Ct);else{if(fieldIntersection($t.producedFields(),Ct.dependentFields()))continue;this.setModified(),Ct.swapWithParent()}}}}class MergeParse extends BottomUpOptimizer{run($t){const Ct=[...$t.children],kt=$t.children.filter(Mt=>Mt instanceof ParseNode);if($t.numChildren()>1&&kt.length>=1){const Mt={},Ft=new Set;for(const jt of kt){const Bt=jt.parse;for(const Vt of keys(Bt))Vt in Mt?Mt[Vt]!==Bt[Vt]&&Ft.add(Vt):Mt[Vt]=Bt[Vt]}for(const jt of Ft)delete Mt[jt];if(!isEmpty(Mt)){this.setModified();const jt=new ParseNode($t,Mt);for(const Bt of Ct){if(Bt instanceof ParseNode)for(const Vt of keys(Mt))delete Bt.parse[Vt];$t.removeChild(Bt),Bt.parent=jt,Bt instanceof ParseNode&&keys(Bt.parse).length===0&&Bt.remove()}}}}}class RemoveUnusedSubtrees extends BottomUpOptimizer{run($t){$t instanceof OutputNode||$t.numChildren()>0||$t instanceof FacetNode||$t instanceof SourceNode||(this.setModified(),$t.remove())}}class MergeTimeUnits extends BottomUpOptimizer{run($t){const Ct=$t.children.filter(Mt=>Mt instanceof TimeUnitNode),kt=Ct.pop();for(const Mt of Ct)this.setModified(),kt.merge(Mt)}}class MergeAggregates extends BottomUpOptimizer{run($t){const Ct=$t.children.filter(Mt=>Mt instanceof AggregateNode),kt={};for(const Mt of Ct){const Ft=hash(Mt.groupBy);Ft in kt||(kt[Ft]=[]),kt[Ft].push(Mt)}for(const Mt of keys(kt)){const Ft=kt[Mt];if(Ft.length>1){const jt=Ft.pop();for(const Bt of Ft)jt.merge(Bt)&&($t.removeChild(Bt),Bt.parent=jt,Bt.remove(),this.setModified())}}}}class MergeBins extends BottomUpOptimizer{constructor($t){super(),this.model=$t}run($t){const Ct=!(isDataSourceNode($t)||$t instanceof FilterNode||$t instanceof ParseNode||$t instanceof IdentifierNode),kt=[],Mt=[];for(const Ft of $t.children)Ft instanceof BinNode&&(Ct&&!fieldIntersection($t.producedFields(),Ft.dependentFields())?kt.push(Ft):Mt.push(Ft));if(kt.length>0){const Ft=kt.pop();for(const jt of kt)Ft.merge(jt,this.model.renameSignal.bind(this.model));this.setModified(),$t instanceof BinNode?$t.merge(Ft,this.model.renameSignal.bind(this.model)):Ft.swapWithParent()}if(Mt.length>1){const Ft=Mt.pop();for(const jt of Mt)Ft.merge(jt,this.model.renameSignal.bind(this.model));this.setModified()}}}class MergeOutputs extends BottomUpOptimizer{run($t){const Ct=[...$t.children];if(!some(Ct,jt=>jt instanceof OutputNode)||$t.numChildren()<=1)return;const Mt=[];let Ft;for(const jt of Ct)if(jt instanceof OutputNode){let Bt=jt;for(;Bt.numChildren()===1;){const[Vt]=Bt.children;if(Vt instanceof OutputNode)Bt=Vt;else break}Mt.push(...Bt.children),Ft?($t.removeChild(jt),jt.parent=Ft.parent,Ft.parent.removeChild(Ft),Ft.parent=Bt,this.setModified()):Ft=Bt}else Mt.push(jt);if(Mt.length){this.setModified();for(const jt of Mt)jt.parent.removeChild(jt),jt.parent=Ft}}}class JoinAggregateTransformNode extends DataFlowNode{clone(){return new JoinAggregateTransformNode(null,duplicate(this.transform))}constructor($t,Ct){super($t),this.transform=Ct}addDimensions($t){this.transform.groupby=unique(this.transform.groupby.concat($t),Ct=>Ct)}dependentFields(){const $t=new Set;return this.transform.groupby&&this.transform.groupby.forEach($t.add,$t),this.transform.joinaggregate.map(Ct=>Ct.field).filter(Ct=>Ct!==void 0).forEach($t.add,$t),$t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName($t){return $t.as??vgField($t)}hash(){return`JoinAggregateTransform ${hash(this.transform)}`}assemble(){const $t=[],Ct=[],kt=[];for(const Ft of this.transform.joinaggregate)Ct.push(Ft.op),kt.push(this.getDefaultName(Ft)),$t.push(Ft.field===void 0?null:Ft.field);const Mt=this.transform.groupby;return{type:"joinaggregate",as:kt,ops:Ct,fields:$t,...Mt!==void 0?{groupby:Mt}:{}}}}function getStackByFields(xt){return xt.stack.stackBy.reduce(($t,Ct)=>{const kt=Ct.fieldDef,Mt=vgField(kt);return Mt&&$t.push(Mt),$t},[])}function isValidAsArray(xt){return isArray(xt)&&xt.every($t=>isString($t))&&xt.length>1}class StackNode extends DataFlowNode{clone(){return new StackNode(null,duplicate(this._stack))}constructor($t,Ct){super($t),this._stack=Ct}static makeFromTransform($t,Ct){const{stack:kt,groupby:Mt,as:Ft,offset:jt="zero"}=Ct,Bt=[],Vt=[];if(Ct.sort!==void 0)for(const Gt of Ct.sort)Bt.push(Gt.field),Vt.push(getFirstDefined(Gt.order,"ascending"));const zt={field:Bt,order:Vt};let Ht;return isValidAsArray(Ft)?Ht=Ft:isString(Ft)?Ht=[Ft,`${Ft}_end`]:Ht=[`${Ct.stack}_start`,`${Ct.stack}_end`],new StackNode($t,{dimensionFieldDefs:[],stackField:kt,groupby:Mt,offset:jt,sort:zt,facetby:[],as:Ht})}static makeFromEncoding($t,Ct){const kt=Ct.stack,{encoding:Mt}=Ct;if(!kt)return null;const{groupbyChannels:Ft,fieldChannel:jt,offset:Bt,impute:Vt}=kt,zt=Ft.map(Wt=>{const Yt=Mt[Wt];return getFieldDef(Yt)}).filter(Wt=>!!Wt),Ht=getStackByFields(Ct),Gt=Ct.encoding.order;let qt;if(isArray(Gt)||isFieldDef(Gt))qt=sortParams(Gt);else{const Wt=isOrderOnlyDef(Gt)?Gt.sort:jt==="y"?"descending":"ascending";qt=Ht.reduce((Yt,Kt)=>(Yt.field.includes(Kt)||(Yt.field.push(Kt),Yt.order.push(Wt)),Yt),{field:[],order:[]})}return new StackNode($t,{dimensionFieldDefs:zt,stackField:Ct.vgField(jt),facetby:[],stackby:Ht,sort:qt,offset:Bt,impute:Vt,as:[Ct.vgField(jt,{suffix:"start",forAs:!0}),Ct.vgField(jt,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions($t){this._stack.facetby.push(...$t)}dependentFields(){const $t=new Set;return $t.add(this._stack.stackField),this.getGroupbyFields().forEach($t.add,$t),this._stack.facetby.forEach($t.add,$t),this._stack.sort.field.forEach($t.add,$t),$t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${hash(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:$t,impute:Ct,groupby:kt}=this._stack;return $t.length>0?$t.map(Mt=>Mt.bin?Ct?[vgField(Mt,{binSuffix:"mid"})]:[vgField(Mt,{}),vgField(Mt,{binSuffix:"end"})]:[vgField(Mt)]).flat():kt??[]}assemble(){const $t=[],{facetby:Ct,dimensionFieldDefs:kt,stackField:Mt,stackby:Ft,sort:jt,offset:Bt,impute:Vt,as:zt}=this._stack;if(Vt)for(const Ht of kt){const{bandPosition:Gt=.5,bin:qt}=Ht;if(qt){const Wt=vgField(Ht,{expr:"datum"}),Yt=vgField(Ht,{expr:"datum",binSuffix:"end"});$t.push({type:"formula",expr:`${Gt}*${Wt}+${1-Gt}*${Yt}`,as:vgField(Ht,{binSuffix:"mid",forAs:!0})})}$t.push({type:"impute",field:Mt,groupby:[...Ft,...Ct],key:vgField(Ht,{binSuffix:"mid"}),method:"value",value:0})}return $t.push({type:"stack",groupby:[...this.getGroupbyFields(),...Ct],field:Mt,sort:jt,as:zt,offset:Bt}),$t}}class WindowTransformNode extends DataFlowNode{clone(){return new WindowTransformNode(null,duplicate(this.transform))}constructor($t,Ct){super($t),this.transform=Ct}addDimensions($t){this.transform.groupby=unique(this.transform.groupby.concat($t),Ct=>Ct)}dependentFields(){const $t=new Set;return(this.transform.groupby??[]).forEach($t.add,$t),(this.transform.sort??[]).forEach(Ct=>$t.add(Ct.field)),this.transform.window.map(Ct=>Ct.field).filter(Ct=>Ct!==void 0).forEach($t.add,$t),$t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName($t){return $t.as??vgField($t)}hash(){return`WindowTransform ${hash(this.transform)}`}assemble(){const $t=[],Ct=[],kt=[],Mt=[];for(const Gt of this.transform.window)Ct.push(Gt.op),kt.push(this.getDefaultName(Gt)),Mt.push(Gt.param===void 0?null:Gt.param),$t.push(Gt.field===void 0?null:Gt.field);const Ft=this.transform.frame,jt=this.transform.groupby;if(Ft&&Ft[0]===null&&Ft[1]===null&&Ct.every(Gt=>isAggregateOp(Gt)))return{type:"joinaggregate",as:kt,ops:Ct,fields:$t,...jt!==void 0?{groupby:jt}:{}};const Bt=[],Vt=[];if(this.transform.sort!==void 0)for(const Gt of this.transform.sort)Bt.push(Gt.field),Vt.push(Gt.order??"ascending");const zt={field:Bt,order:Vt},Ht=this.transform.ignorePeers;return{type:"window",params:Mt,as:kt,ops:Ct,fields:$t,sort:zt,...Ht!==void 0?{ignorePeers:Ht}:{},...jt!==void 0?{groupby:jt}:{},...Ft!==void 0?{frame:Ft}:{}}}}function cloneSubtree(xt){function $t(Ct){if(!(Ct instanceof FacetNode)){const kt=Ct.clone();if(kt instanceof OutputNode){const Mt=FACET_SCALE_PREFIX+kt.getSource();kt.setSource(Mt),xt.model.component.data.outputNodes[Mt]=kt}else(kt instanceof AggregateNode||kt instanceof StackNode||kt instanceof WindowTransformNode||kt instanceof JoinAggregateTransformNode)&&kt.addDimensions(xt.fields);for(const Mt of Ct.children.flatMap($t))Mt.parent=kt;return[kt]}return Ct.children.flatMap($t)}return $t}function moveFacetDown(xt){if(xt instanceof FacetNode)if(xt.numChildren()===1&&!(xt.children[0]instanceof OutputNode)){const $t=xt.children[0];($t instanceof AggregateNode||$t instanceof StackNode||$t instanceof WindowTransformNode||$t instanceof JoinAggregateTransformNode)&&$t.addDimensions(xt.fields),$t.swapWithParent(),moveFacetDown(xt)}else{const $t=xt.model.component.data.main;moveMainDownToFacet($t);const Ct=cloneSubtree(xt),kt=xt.children.map(Ct).flat();for(const Mt of kt)Mt.parent=$t}else xt.children.map(moveFacetDown)}function moveMainDownToFacet(xt){if(xt instanceof OutputNode&&xt.type===DataSourceType.Main&&xt.numChildren()===1){const $t=xt.children[0];$t instanceof FacetNode||($t.swapWithParent(),moveMainDownToFacet(xt))}}const FACET_SCALE_PREFIX="scale_",MAX_OPTIMIZATION_RUNS=5;function checkLinks(xt){for(const $t of xt){for(const Ct of $t.children)if(Ct.parent!==$t)return!1;if(!checkLinks($t.children))return!1}return!0}function runOptimizer(xt,$t){let Ct=!1;for(const kt of $t)Ct=xt.optimize(kt)||Ct;return Ct}function optimizationDataflowHelper(xt,$t,Ct){let kt=xt.sources,Mt=!1;return Mt=runOptimizer(new RemoveUnnecessaryOutputNodes,kt)||Mt,Mt=runOptimizer(new RemoveUnnecessaryIdentifierNodes($t),kt)||Mt,kt=kt.filter(Ft=>Ft.numChildren()>0),Mt=runOptimizer(new RemoveUnusedSubtrees,kt)||Mt,kt=kt.filter(Ft=>Ft.numChildren()>0),Ct||(Mt=runOptimizer(new MoveParseUp,kt)||Mt,Mt=runOptimizer(new MergeBins($t),kt)||Mt,Mt=runOptimizer(new RemoveDuplicateTimeUnits,kt)||Mt,Mt=runOptimizer(new MergeParse,kt)||Mt,Mt=runOptimizer(new MergeAggregates,kt)||Mt,Mt=runOptimizer(new MergeTimeUnits,kt)||Mt,Mt=runOptimizer(new MergeIdenticalNodes,kt)||Mt,Mt=runOptimizer(new MergeOutputs,kt)||Mt),xt.sources=kt,Mt}function optimizeDataflow(xt,$t){checkLinks(xt.sources);let Ct=0,kt=0;for(let Mt=0;Mt<MAX_OPTIMIZATION_RUNS&&optimizationDataflowHelper(xt,$t,!0);Mt++)Ct++;xt.sources.map(moveFacetDown);for(let Mt=0;Mt<MAX_OPTIMIZATION_RUNS&&optimizationDataflowHelper(xt,$t,!1);Mt++)kt++;checkLinks(xt.sources),Math.max(Ct,kt)===MAX_OPTIMIZATION_RUNS&&warn(`Maximum optimization runs(${MAX_OPTIMIZATION_RUNS}) reached.`)}class SignalRefWrapper{constructor($t){Object.defineProperty(this,"signal",{enumerable:!0,get:$t})}static fromName($t,Ct){return new SignalRefWrapper(()=>$t(Ct))}}function parseScaleDomain(xt){isUnitModel(xt)?parseUnitScaleDomain(xt):parseNonUnitScaleDomain(xt)}function parseUnitScaleDomain(xt){const $t=xt.component.scales;for(const Ct of keys($t)){const kt=parseDomainForChannel(xt,Ct);if($t[Ct].setWithExplicit("domains",kt),parseSelectionDomain(xt,Ct),xt.component.data.isFaceted){let Ft=xt;for(;!isFacetModel(Ft)&&Ft.parent;)Ft=Ft.parent;if(Ft.component.resolve.scale[Ct]==="shared")for(const Bt of kt.value)isDataRefDomain(Bt)&&(Bt.data=FACET_SCALE_PREFIX+Bt.data.replace(FACET_SCALE_PREFIX,""))}}}function parseNonUnitScaleDomain(xt){for(const Ct of xt.children)parseScaleDomain(Ct);const $t=xt.component.scales;for(const Ct of keys($t)){let kt,Mt=null;for(const Ft of xt.children){const jt=Ft.component.scales[Ct];if(jt){kt===void 0?kt=jt.getWithExplicit("domains"):kt=mergeValuesWithExplicit(kt,jt.getWithExplicit("domains"),"domains","scale",domainsTieBreaker);const Bt=jt.get("selectionExtent");Mt&&Bt&&Mt.param!==Bt.param&&warn(NEEDS_SAME_SELECTION),Mt=Bt}}$t[Ct].setWithExplicit("domains",kt),Mt&&$t[Ct].set("selectionExtent",Mt,!0)}}function normalizeUnaggregatedDomain(xt,$t,Ct,kt){if(xt==="unaggregated"){const{valid:Mt,reason:Ft}=canUseUnaggregatedDomain($t,Ct);if(!Mt){warn(Ft);return}}else if(xt===void 0&&kt.useUnaggregatedDomain){const{valid:Mt}=canUseUnaggregatedDomain($t,Ct);if(Mt)return"unaggregated"}return xt}function parseDomainForChannel(xt,$t){const Ct=xt.getScaleComponent($t).get("type"),{encoding:kt}=xt,Mt=normalizeUnaggregatedDomain(xt.scaleDomain($t),xt.typedFieldDef($t),Ct,xt.config.scale);return Mt!==xt.scaleDomain($t)&&(xt.specifiedScales[$t]={...xt.specifiedScales[$t],domain:Mt}),$t==="x"&&getFieldOrDatumDef(kt.x2)?getFieldOrDatumDef(kt.x)?mergeValuesWithExplicit(parseSingleChannelDomain(Ct,Mt,xt,"x"),parseSingleChannelDomain(Ct,Mt,xt,"x2"),"domain","scale",domainsTieBreaker):parseSingleChannelDomain(Ct,Mt,xt,"x2"):$t==="y"&&getFieldOrDatumDef(kt.y2)?getFieldOrDatumDef(kt.y)?mergeValuesWithExplicit(parseSingleChannelDomain(Ct,Mt,xt,"y"),parseSingleChannelDomain(Ct,Mt,xt,"y2"),"domain","scale",domainsTieBreaker):parseSingleChannelDomain(Ct,Mt,xt,"y2"):parseSingleChannelDomain(Ct,Mt,xt,$t)}function mapDomainToDataSignal(xt,$t,Ct){return xt.map(kt=>({signal:`{data: ${valueExpr(kt,{timeUnit:Ct,type:$t})}}`}))}function convertDomainIfItIsDateTime(xt,$t,Ct){var Mt;const kt=(Mt=normalizeTimeUnit(Ct))==null?void 0:Mt.unit;return $t==="temporal"||kt?mapDomainToDataSignal(xt,$t,kt):[xt]}function parseSingleChannelDomain(xt,$t,Ct,kt){const{encoding:Mt,markDef:Ft,mark:jt,config:Bt,stack:Vt}=Ct,zt=getFieldOrDatumDef(Mt[kt]),{type:Ht}=zt,Gt=zt.timeUnit;if(isDomainUnionWith($t)){const Yt=parseSingleChannelDomain(xt,void 0,Ct,kt),Kt=convertDomainIfItIsDateTime($t.unionWith,Ht,Gt);return makeExplicit([...Kt,...Yt.value])}else{if(isSignalRef($t))return makeExplicit([$t]);if($t&&$t!=="unaggregated"&&!isParameterDomain($t))return makeExplicit(convertDomainIfItIsDateTime($t,Ht,Gt))}if(Vt&&kt===Vt.fieldChannel){if(Vt.offset==="normalize")return makeImplicit([[0,1]]);const Yt=Ct.requestDataName(DataSourceType.Main);return makeImplicit([{data:Yt,field:Ct.vgField(kt,{suffix:"start"})},{data:Yt,field:Ct.vgField(kt,{suffix:"end"})}])}const qt=isScaleChannel(kt)&&isFieldDef(zt)?domainSort(Ct,kt,xt):void 0;if(isDatumDef(zt)){const Yt=convertDomainIfItIsDateTime([zt.datum],Ht,Gt);return makeImplicit(Yt)}const Wt=zt;if($t==="unaggregated"){const Yt=Ct.requestDataName(DataSourceType.Main),{field:Kt}=zt;return makeImplicit([{data:Yt,field:vgField({field:Kt,aggregate:"min"})},{data:Yt,field:vgField({field:Kt,aggregate:"max"})}])}else if(isBinning(Wt.bin)){if(hasDiscreteDomain(xt))return makeImplicit(xt==="bin-ordinal"?[]:[{data:isBoolean(qt)?Ct.requestDataName(DataSourceType.Main):Ct.requestDataName(DataSourceType.Raw),field:Ct.vgField(kt,binRequiresRange(Wt,kt)?{binSuffix:"range"}:{}),sort:qt===!0||!isObject(qt)?{field:Ct.vgField(kt,{}),op:"min"}:qt}]);{const{bin:Yt}=Wt;if(isBinning(Yt)){const Kt=getBinSignalName(Ct,Wt.field,Yt);return makeImplicit([new SignalRefWrapper(()=>{const Xt=Ct.getSignalName(Kt);return`[${Xt}.start, ${Xt}.stop]`})])}else return makeImplicit([{data:Ct.requestDataName(DataSourceType.Main),field:Ct.vgField(kt,{})}])}}else if(Wt.timeUnit&&contains(["time","utc"],xt)){const Yt=Mt[getSecondaryRangeChannel(kt)];if(hasBandEnd(Wt,Yt,Ft,Bt)){const Kt=Ct.requestDataName(DataSourceType.Main),Xt=getBandPosition({fieldDef:Wt,fieldDef2:Yt,markDef:Ft,config:Bt}),Qt=isRectBasedMark(jt)&&Xt!==.5&&isXorY(kt);return makeImplicit([{data:Kt,field:Ct.vgField(kt,Qt?{suffix:OFFSETTED_RECT_START_SUFFIX}:{})},{data:Kt,field:Ct.vgField(kt,{suffix:Qt?OFFSETTED_RECT_END_SUFFIX:"end"})}])}}return makeImplicit(qt?[{data:isBoolean(qt)?Ct.requestDataName(DataSourceType.Main):Ct.requestDataName(DataSourceType.Raw),field:Ct.vgField(kt),sort:qt}]:[{data:Ct.requestDataName(DataSourceType.Main),field:Ct.vgField(kt)}])}function normalizeSortField(xt,$t){const{op:Ct,field:kt,order:Mt}=xt;return{op:Ct??($t?"sum":DEFAULT_SORT_OP),...kt?{field:replacePathInField(kt)}:{},...Mt?{order:Mt}:{}}}function parseSelectionDomain(xt,$t){var Bt;const Ct=xt.component.scales[$t],kt=xt.specifiedScales[$t].domain,Mt=(Bt=xt.fieldDef($t))==null?void 0:Bt.bin,Ft=isParameterDomain(kt)&&kt,jt=isBinParams(Mt)&&isParameterExtent(Mt.extent)&&Mt.extent;(Ft||jt)&&Ct.set("selectionExtent",Ft??jt,!0)}function domainSort(xt,$t,Ct){if(!hasDiscreteDomain(Ct))return;const kt=xt.fieldDef($t),Mt=kt.sort;if(isSortArray(Mt))return{op:"min",field:sortArrayIndexField(kt,$t),order:"ascending"};const{stack:Ft}=xt,jt=Ft?new Set([...Ft.groupbyFields,...Ft.stackBy.map(Bt=>Bt.fieldDef.field)]):void 0;if(isSortField(Mt)){const Bt=Ft&&!jt.has(Mt.field);return normalizeSortField(Mt,Bt)}else if(isSortByEncoding(Mt)){const{encoding:Bt,order:Vt}=Mt,zt=xt.fieldDef(Bt),{aggregate:Ht,field:Gt}=zt,qt=Ft&&!jt.has(Gt);if(isArgminDef(Ht)||isArgmaxDef(Ht))return normalizeSortField({field:vgField(zt),order:Vt},qt);if(isAggregateOp(Ht)||!Ht)return normalizeSortField({op:Ht,field:Gt,order:Vt},qt)}else{if(Mt==="descending")return{op:"min",field:xt.vgField($t),order:"descending"};if(contains(["ascending",void 0],Mt))return!0}}function canUseUnaggregatedDomain(xt,$t){const{aggregate:Ct,type:kt}=xt;return Ct?isString(Ct)&&!SHARED_DOMAIN_OPS.has(Ct)?{valid:!1,reason:unaggregateDomainWithNonSharedDomainOp(Ct)}:kt==="quantitative"&&$t==="log"?{valid:!1,reason:unaggregatedDomainWithLogScale(xt)}:{valid:!0}:{valid:!1,reason:unaggregateDomainHasNoEffectForRawField(xt)}}function domainsTieBreaker(xt,$t,Ct,kt){return xt.explicit&&$t.explicit&&warn(mergeConflictingDomainProperty(Ct,kt,xt.value,$t.value)),{explicit:xt.explicit,value:[...xt.value,...$t.value]}}function mergeDomains(xt){const $t=unique(xt.map(jt=>{if(isDataRefDomain(jt)){const{sort:Bt,...Vt}=jt;return Vt}return jt}),hash),Ct=unique(xt.map(jt=>{if(isDataRefDomain(jt)){const Bt=jt.sort;return Bt!==void 0&&!isBoolean(Bt)&&("op"in Bt&&Bt.op==="count"&&delete Bt.field,Bt.order==="ascending"&&delete Bt.order),Bt}}).filter(jt=>jt!==void 0),hash);if($t.length===0)return;if($t.length===1){const jt=xt[0];if(isDataRefDomain(jt)&&Ct.length>0){let Bt=Ct[0];if(Ct.length>1){warn(MORE_THAN_ONE_SORT);const Vt=Ct.filter(zt=>isObject(zt)&&"op"in zt&&zt.op!=="min");Ct.every(zt=>isObject(zt)&&"op"in zt)&&Vt.length===1?Bt=Vt[0]:Bt=!0}else if(isObject(Bt)&&"field"in Bt){const Vt=Bt.field;jt.field===Vt&&(Bt=Bt.order?{order:Bt.order}:!0)}return{...jt,sort:Bt}}return jt}const kt=unique(Ct.map(jt=>isBoolean(jt)||!("op"in jt)||isString(jt.op)&&jt.op in MULTIDOMAIN_SORT_OP_INDEX?jt:(warn(domainSortDropped(jt)),!0)),hash);let Mt;kt.length===1?Mt=kt[0]:kt.length>1&&(warn(MORE_THAN_ONE_SORT),Mt=!0);const Ft=unique(xt.map(jt=>isDataRefDomain(jt)?jt.data:null),jt=>jt);return Ft.length===1&&Ft[0]!==null?{data:Ft[0],fields:$t.map(Bt=>Bt.field),...Mt?{sort:Mt}:{}}:{fields:$t,...Mt?{sort:Mt}:{}}}function getFieldFromDomain(xt){if(isDataRefDomain(xt)&&isString(xt.field))return xt.field;if(isDataRefUnionedDomain(xt)){let $t;for(const Ct of xt.fields)if(isDataRefDomain(Ct)&&isString(Ct.field)){if(!$t)$t=Ct.field;else if($t!==Ct.field)return warn(FACETED_INDEPENDENT_DIFFERENT_SOURCES),$t}return warn(FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES),$t}else if(isFieldRefUnionDomain(xt)){warn(FACETED_INDEPENDENT_SAME_SOURCE);const $t=xt.fields[0];return isString($t)?$t:void 0}}function assembleDomain(xt,$t){const kt=xt.component.scales[$t].get("domains").map(Mt=>(isDataRefDomain(Mt)&&(Mt.data=xt.lookupDataSource(Mt.data)),Mt));return mergeDomains(kt)}function assembleScales(xt){return isLayerModel(xt)||isConcatModel(xt)?xt.children.reduce(($t,Ct)=>$t.concat(assembleScales(Ct)),assembleScalesForModel(xt)):assembleScalesForModel(xt)}function assembleScalesForModel(xt){return keys(xt.component.scales).reduce(($t,Ct)=>{const kt=xt.component.scales[Ct];if(kt.merged)return $t;const Mt=kt.combine(),{name:Ft,type:jt,selectionExtent:Bt,domains:Vt,range:zt,reverse:Ht,...Gt}=Mt,qt=assembleScaleRange(Mt.range,Ft,Ct,xt),Wt=assembleDomain(xt,Ct),Yt=Bt?assembleSelectionScaleDomain(xt,Bt,kt,Wt):null;return $t.push({name:Ft,type:jt,...Wt?{domain:Wt}:{},...Yt?{domainRaw:Yt}:{},range:qt,...Ht!==void 0?{reverse:Ht}:{},...Gt}),$t},[])}function assembleScaleRange(xt,$t,Ct,kt){if(isXorY(Ct)){if(isVgRangeStep(xt))return{step:{signal:`${$t}_step`}}}else if(isObject(xt)&&isDataRefDomain(xt))return{...xt,data:kt.lookupDataSource(xt.data)};return xt}class ScaleComponent extends Split{constructor($t,Ct){super({},{name:$t}),this.merged=!1,this.setWithExplicit("type",Ct)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:some(this.get("domains"),$t=>isArray($t)&&$t.length===2&&isNumber$1($t[0])&&$t[0]<=0&&isNumber$1($t[1])&&$t[1]>=0)}}const RANGE_PROPERTIES=["range","scheme"];function parseUnitScaleRange(xt){const $t=xt.component.scales;for(const Ct of SCALE_CHANNELS){const kt=$t[Ct];if(!kt)continue;const Mt=parseRangeForChannel(Ct,xt);kt.setWithExplicit("range",Mt)}}function getBinStepSignal(xt,$t){const Ct=xt.fieldDef($t);if(Ct!=null&&Ct.bin){const{bin:kt,field:Mt}=Ct,Ft=getSizeChannel($t),jt=xt.getName(Ft);if(isObject(kt)&&kt.binned&&kt.step!==void 0)return new SignalRefWrapper(()=>{const Bt=xt.scaleName($t),Vt=`(domain("${Bt}")[1] - domain("${Bt}")[0]) / ${kt.step}`;return`${xt.getSignalName(jt)} / (${Vt})`});if(isBinning(kt)){const Bt=getBinSignalName(xt,Mt,kt);return new SignalRefWrapper(()=>{const Vt=xt.getSignalName(Bt),zt=`(${Vt}.stop - ${Vt}.start) / ${Vt}.step`;return`${xt.getSignalName(jt)} / (${zt})`})}}}function parseRangeForChannel(xt,$t){const Ct=$t.specifiedScales[xt],{size:kt}=$t,Ft=$t.getScaleComponent(xt).get("type");for(const Gt of RANGE_PROPERTIES)if(Ct[Gt]!==void 0){const qt=scaleTypeSupportProperty(Ft,Gt),Wt=channelScalePropertyIncompatability(xt,Gt);if(!qt)warn(scalePropertyNotWorkWithScaleType(Ft,Gt,xt));else if(Wt)warn(Wt);else switch(Gt){case"range":{const Yt=Ct.range;if(isArray(Yt)){if(isXorY(xt))return makeExplicit(Yt.map(Kt=>{if(Kt==="width"||Kt==="height"){const Xt=$t.getName(Kt),Qt=$t.getSignalName.bind($t);return SignalRefWrapper.fromName(Qt,Xt)}return Kt}))}else if(isObject(Yt))return makeExplicit({data:$t.requestDataName(DataSourceType.Main),field:Yt.field,sort:{op:"min",field:$t.vgField(xt)}});return makeExplicit(Yt)}case"scheme":return makeExplicit(parseScheme(Ct[Gt]))}}const jt=xt===X||xt==="xOffset"?"width":"height",Bt=kt[jt];if(isStep(Bt)){if(isXorY(xt))if(hasDiscreteDomain(Ft)){const Gt=getPositionStep(Bt,$t,xt);if(Gt)return makeExplicit({step:Gt})}else warn(stepDropped(jt));else if(isXorYOffset(xt)){const Gt=xt===XOFFSET?"x":"y";if($t.getScaleComponent(Gt).get("type")==="band"){const Yt=getOffsetStep(Bt,Ft);if(Yt)return makeExplicit(Yt)}}}const{rangeMin:Vt,rangeMax:zt}=Ct,Ht=defaultRange(xt,$t);return(Vt!==void 0||zt!==void 0)&&scaleTypeSupportProperty(Ft,"rangeMin")&&isArray(Ht)&&Ht.length===2?makeExplicit([Vt??Ht[0],zt??Ht[1]]):makeImplicit(Ht)}function parseScheme(xt){return isExtendedScheme(xt)?{scheme:xt.name,...omit(xt,["name"])}:{scheme:xt}}function fullWidthOrHeightRange(xt,$t,Ct,{center:kt}={}){const Mt=getSizeChannel(xt),Ft=$t.getName(Mt),jt=$t.getSignalName.bind($t);return xt===Y&&hasContinuousDomain(Ct)?kt?[SignalRefWrapper.fromName(Bt=>`${jt(Bt)}/2`,Ft),SignalRefWrapper.fromName(Bt=>`-${jt(Bt)}/2`,Ft)]:[SignalRefWrapper.fromName(jt,Ft),0]:kt?[SignalRefWrapper.fromName(Bt=>`-${jt(Bt)}/2`,Ft),SignalRefWrapper.fromName(Bt=>`${jt(Bt)}/2`,Ft)]:[0,SignalRefWrapper.fromName(jt,Ft)]}function defaultRange(xt,$t){const{size:Ct,config:kt,mark:Mt,encoding:Ft}=$t,{type:jt}=getFieldOrDatumDef(Ft[xt]),Vt=$t.getScaleComponent(xt).get("type"),{domain:zt,domainMid:Ht}=$t.specifiedScales[xt];switch(xt){case X:case Y:{if(contains(["point","band"],Vt)){const Gt=getDiscretePositionSize(xt,Ct,kt.view);if(isStep(Gt))return{step:getPositionStep(Gt,$t,xt)}}return fullWidthOrHeightRange(xt,$t,Vt)}case XOFFSET:case YOFFSET:return getOffsetRange(xt,$t,Vt);case SIZE:{const Gt=$t.component.scales[xt].get("zero"),qt=sizeRangeMin(Mt,Gt,kt),Wt=sizeRangeMax(Mt,Ct,$t,kt);return isContinuousToDiscrete(Vt)?interpolateRange(qt,Wt,defaultContinuousToDiscreteCount(Vt,kt,zt,xt)):[qt,Wt]}case THETA:return[0,Math.PI*2];case ANGLE:return[0,360];case RADIUS:return[0,new SignalRefWrapper(()=>{const Gt=$t.getSignalName(isFacetModel($t.parent)?"child_width":"width"),qt=$t.getSignalName(isFacetModel($t.parent)?"child_height":"height");return`min(${Gt},${qt})/2`})];case STROKEWIDTH:return[kt.scale.minStrokeWidth,kt.scale.maxStrokeWidth];case STROKEDASH:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case SHAPE:return"symbol";case COLOR:case FILL:case STROKE:return Vt==="ordinal"?jt==="nominal"?"category":"ordinal":Ht!==void 0?"diverging":Mt==="rect"||Mt==="geoshape"?"heatmap":"ramp";case OPACITY:case FILLOPACITY:case STROKEOPACITY:return[kt.scale.minOpacity,kt.scale.maxOpacity]}}function getPositionStep(xt,$t,Ct){const{encoding:kt}=$t,Mt=$t.getScaleComponent(Ct),Ft=getOffsetScaleChannel(Ct),jt=kt[Ft];if(getStepFor({step:xt,offsetIsDiscrete:isFieldOrDatumDef(jt)&&isDiscrete$1(jt.type)})==="offset"&&channelHasFieldOrDatum(kt,Ft)){const Vt=$t.getScaleComponent(Ft);let Ht=`domain('${$t.scaleName(Ft)}').length`;if(Vt.get("type")==="band"){const qt=Vt.get("paddingInner")??Vt.get("padding")??0,Wt=Vt.get("paddingOuter")??Vt.get("padding")??0;Ht=`bandspace(${Ht}, ${qt}, ${Wt})`}const Gt=Mt.get("paddingInner")??Mt.get("padding");return{signal:`${xt.step} * ${Ht} / (1-${exprFromSignalRefOrValue(Gt)})`}}else return xt.step}function getOffsetStep(xt,$t){if(getStepFor({step:xt,offsetIsDiscrete:hasDiscreteDomain($t)})==="offset")return{step:xt.step}}function getOffsetRange(xt,$t,Ct){const kt=xt===XOFFSET?"x":"y",Mt=$t.getScaleComponent(kt);if(!Mt)return fullWidthOrHeightRange(kt,$t,Ct,{center:!0});const Ft=Mt.get("type"),jt=$t.scaleName(kt),{markDef:Bt,config:Vt}=$t;if(Ft==="band"){const zt=getDiscretePositionSize(kt,$t.size,$t.config.view);if(isStep(zt)){const Ht=getOffsetStep(zt,Ct);if(Ht)return Ht}return[0,{signal:`bandwidth('${jt}')`}]}else{const zt=$t.encoding[kt];if(isFieldDef(zt)&&zt.timeUnit){const Ht=durationExpr(zt.timeUnit,Yt=>`scale('${jt}', ${Yt})`),Gt=$t.config.scale.bandWithNestedOffsetPaddingInner,qt=getBandPosition({fieldDef:zt,markDef:Bt,config:Vt})-.5,Wt=qt!==0?` + ${qt}`:"";if(Gt){const Yt=isSignalRef(Gt)?`${Gt.signal}/2`+Wt:`${Gt/2+qt}`,Kt=isSignalRef(Gt)?`(1 - ${Gt.signal}/2)`+Wt:`${1-Gt/2+qt}`;return[{signal:`${Yt} * (${Ht})`},{signal:`${Kt} * (${Ht})`}]}return[0,{signal:Ht}]}return never(`Cannot use ${xt} scale if ${kt} scale is not discrete.`)}}function getDiscretePositionSize(xt,$t,Ct){const kt=xt===X?"width":"height",Mt=$t[kt];return Mt||getViewConfigDiscreteSize(Ct,kt)}function defaultContinuousToDiscreteCount(xt,$t,Ct,kt){switch(xt){case"quantile":return $t.scale.quantileCount;case"quantize":return $t.scale.quantizeCount;case"threshold":return Ct!==void 0&&isArray(Ct)?Ct.length+1:(warn(domainRequiredForThresholdScale(kt)),3)}}function interpolateRange(xt,$t,Ct){const kt=()=>{const Mt=signalOrStringValue($t),Ft=signalOrStringValue(xt),jt=`(${Mt} - ${Ft}) / (${Ct} - 1)`;return`sequence(${Ft}, ${Mt} + ${jt}, ${jt})`};return isSignalRef($t)?new SignalRefWrapper(kt):{signal:kt()}}function sizeRangeMin(xt,$t,Ct){if($t)return isSignalRef($t)?{signal:`${$t.signal} ? 0 : ${sizeRangeMin(xt,!1,Ct)}`}:0;switch(xt){case"bar":case"tick":return Ct.scale.minBandSize;case"line":case"trail":case"rule":return Ct.scale.minStrokeWidth;case"text":return Ct.scale.minFontSize;case"point":case"square":case"circle":return Ct.scale.minSize}throw new Error(incompatibleChannel("size",xt))}const MAX_SIZE_RANGE_STEP_RATIO=.95;function sizeRangeMax(xt,$t,Ct,kt){const Mt={x:getBinStepSignal(Ct,"x"),y:getBinStepSignal(Ct,"y")};switch(xt){case"bar":case"tick":{if(kt.scale.maxBandSize!==void 0)return kt.scale.maxBandSize;const Ft=minXYStep($t,Mt,kt.view);return isNumber$1(Ft)?Ft-1:new SignalRefWrapper(()=>`${Ft.signal} - 1`)}case"line":case"trail":case"rule":return kt.scale.maxStrokeWidth;case"text":return kt.scale.maxFontSize;case"point":case"square":case"circle":{if(kt.scale.maxSize)return kt.scale.maxSize;const Ft=minXYStep($t,Mt,kt.view);return isNumber$1(Ft)?Math.pow(MAX_SIZE_RANGE_STEP_RATIO*Ft,2):new SignalRefWrapper(()=>`pow(${MAX_SIZE_RANGE_STEP_RATIO} * ${Ft.signal}, 2)`)}}throw new Error(incompatibleChannel("size",xt))}function minXYStep(xt,$t,Ct){const kt=isStep(xt.width)?xt.width.step:getViewConfigDiscreteStep(Ct,"width"),Mt=isStep(xt.height)?xt.height.step:getViewConfigDiscreteStep(Ct,"height");return $t.x||$t.y?new SignalRefWrapper(()=>`min(${[$t.x?$t.x.signal:kt,$t.y?$t.y.signal:Mt].join(", ")})`):Math.min(kt,Mt)}function parseScaleProperty(xt,$t){isUnitModel(xt)?parseUnitScaleProperty(xt,$t):parseNonUnitScaleProperty(xt,$t)}function parseUnitScaleProperty(xt,$t){const Ct=xt.component.scales,{config:kt,encoding:Mt,markDef:Ft,specifiedScales:jt}=xt;for(const Bt of keys(Ct)){const Vt=jt[Bt],zt=Ct[Bt],Ht=xt.getScaleComponent(Bt),Gt=getFieldOrDatumDef(Mt[Bt]),qt=Vt[$t],Wt=Ht.get("type"),Yt=Ht.get("padding"),Kt=Ht.get("paddingInner"),Xt=scaleTypeSupportProperty(Wt,$t),Qt=channelScalePropertyIncompatability(Bt,$t);if(qt!==void 0&&(Xt?Qt&&warn(Qt):warn(scalePropertyNotWorkWithScaleType(Wt,$t,Bt))),Xt&&Qt===void 0)if(qt!==void 0){const Jt=Gt.timeUnit,Zt=Gt.type;switch($t){case"domainMax":case"domainMin":isDateTime(Vt[$t])||Zt==="temporal"||Jt?zt.set($t,{signal:valueExpr(Vt[$t],{type:Zt,timeUnit:Jt})},!0):zt.set($t,Vt[$t],!0);break;default:zt.copyKeyFromObject($t,Vt)}}else{const Jt=$t in scaleRules?scaleRules[$t]({model:xt,channel:Bt,fieldOrDatumDef:Gt,scaleType:Wt,scalePadding:Yt,scalePaddingInner:Kt,domain:Vt.domain,domainMin:Vt.domainMin,domainMax:Vt.domainMax,markDef:Ft,config:kt,hasNestedOffsetScale:channelHasNestedOffsetScale(Mt,Bt),hasSecondaryRangeChannel:!!Mt[getSecondaryRangeChannel(Bt)]}):kt.scale[$t];Jt!==void 0&&zt.set($t,Jt,!1)}}}const scaleRules={bins:({model:xt,fieldOrDatumDef:$t})=>isFieldDef($t)?bins(xt,$t):void 0,interpolate:({channel:xt,fieldOrDatumDef:$t})=>interpolate(xt,$t.type),nice:({scaleType:xt,channel:$t,domain:Ct,domainMin:kt,domainMax:Mt,fieldOrDatumDef:Ft})=>nice(xt,$t,Ct,kt,Mt,Ft),padding:({channel:xt,scaleType:$t,fieldOrDatumDef:Ct,markDef:kt,config:Mt})=>padding(xt,$t,Mt.scale,Ct,kt,Mt.bar),paddingInner:({scalePadding:xt,channel:$t,markDef:Ct,scaleType:kt,config:Mt,hasNestedOffsetScale:Ft})=>paddingInner(xt,$t,Ct.type,kt,Mt.scale,Ft),paddingOuter:({scalePadding:xt,channel:$t,scaleType:Ct,scalePaddingInner:kt,config:Mt,hasNestedOffsetScale:Ft})=>paddingOuter(xt,$t,Ct,kt,Mt.scale,Ft),reverse:({fieldOrDatumDef:xt,scaleType:$t,channel:Ct,config:kt})=>{const Mt=isFieldDef(xt)?xt.sort:void 0;return reverse($t,Mt,Ct,kt.scale)},zero:({channel:xt,fieldOrDatumDef:$t,domain:Ct,markDef:kt,scaleType:Mt,config:Ft,hasSecondaryRangeChannel:jt})=>zero(xt,$t,Ct,kt,Mt,Ft.scale,jt)};function parseScaleRange(xt){isUnitModel(xt)?parseUnitScaleRange(xt):parseNonUnitScaleProperty(xt,"range")}function parseNonUnitScaleProperty(xt,$t){const Ct=xt.component.scales;for(const kt of xt.children)$t==="range"?parseScaleRange(kt):parseScaleProperty(kt,$t);for(const kt of keys(Ct)){let Mt;for(const Ft of xt.children){const jt=Ft.component.scales[kt];if(jt){const Bt=jt.getWithExplicit($t);Mt=mergeValuesWithExplicit(Mt,Bt,$t,"scale",tieBreakByComparing((Vt,zt)=>{switch($t){case"range":return Vt.step&&zt.step?Vt.step-zt.step:0}return 0}))}}Ct[kt].setWithExplicit($t,Mt)}}function bins(xt,$t){const Ct=$t.bin;if(isBinning(Ct)){const kt=getBinSignalName(xt,$t.field,Ct);return new SignalRefWrapper(()=>xt.getSignalName(kt))}else if(isBinned(Ct)&&isBinParams(Ct)&&Ct.step!==void 0)return{step:Ct.step}}function interpolate(xt,$t){if(contains([COLOR,FILL,STROKE],xt)&&$t!=="nominal")return"hcl"}function nice(xt,$t,Ct,kt,Mt,Ft){var jt;if(!((jt=getFieldDef(Ft))!=null&&jt.bin||isArray(Ct)||Mt!=null||kt!=null||contains([ScaleType.TIME,ScaleType.UTC],xt)))return isXorY($t)?!0:void 0}function padding(xt,$t,Ct,kt,Mt,Ft){if(isXorY(xt)){if(isContinuousToContinuous($t)){if(Ct.continuousPadding!==void 0)return Ct.continuousPadding;const{type:jt,orient:Bt}=Mt;if(jt==="bar"&&!(isFieldDef(kt)&&(kt.bin||kt.timeUnit))&&(Bt==="vertical"&&xt==="x"||Bt==="horizontal"&&xt==="y"))return Ft.continuousBandSize}if($t===ScaleType.POINT)return Ct.pointPadding}}function paddingInner(xt,$t,Ct,kt,Mt,Ft=!1){if(xt===void 0){if(isXorY($t)){const{bandPaddingInner:jt,barBandPaddingInner:Bt,rectBandPaddingInner:Vt,bandWithNestedOffsetPaddingInner:zt}=Mt;return Ft?zt:getFirstDefined(jt,Ct==="bar"?Bt:Vt)}else if(isXorYOffset($t)&&kt===ScaleType.BAND)return Mt.offsetBandPaddingInner}}function paddingOuter(xt,$t,Ct,kt,Mt,Ft=!1){if(xt===void 0){if(isXorY($t)){const{bandPaddingOuter:jt,bandWithNestedOffsetPaddingOuter:Bt}=Mt;if(Ft)return Bt;if(Ct===ScaleType.BAND)return getFirstDefined(jt,isSignalRef(kt)?{signal:`${kt.signal}/2`}:kt/2)}else if(isXorYOffset($t)){if(Ct===ScaleType.POINT)return .5;if(Ct===ScaleType.BAND)return Mt.offsetBandPaddingOuter}}}function reverse(xt,$t,Ct,kt){if(Ct==="x"&&kt.xReverse!==void 0)return hasContinuousDomain(xt)&&$t==="descending"?isSignalRef(kt.xReverse)?{signal:`!${kt.xReverse.signal}`}:!kt.xReverse:kt.xReverse;if(hasContinuousDomain(xt)&&$t==="descending")return!0}function zero(xt,$t,Ct,kt,Mt,Ft,jt){if(!!Ct&&Ct!=="unaggregated"&&hasContinuousDomain(Mt)){if(isArray(Ct)){const Vt=Ct[0],zt=Ct[Ct.length-1];if(isNumber$1(Vt)&&Vt<=0&&isNumber$1(zt)&&zt>=0)return!0}return!1}if(xt==="size"&&$t.type==="quantitative"&&!isContinuousToDiscrete(Mt))return!0;if(!(isFieldDef($t)&&$t.bin)&&contains([...POSITION_SCALE_CHANNELS,...POLAR_POSITION_SCALE_CHANNELS],xt)){const{orient:Vt,type:zt}=kt;return contains(["bar","area","line","trail"],zt)&&(Vt==="horizontal"&&xt==="y"||Vt==="vertical"&&xt==="x")?!1:contains(["bar","area"],zt)&&!jt?!0:Ft==null?void 0:Ft.zero}return!1}function scaleType(xt,$t,Ct,kt,Mt=!1){const Ft=defaultType($t,Ct,kt,Mt),{type:jt}=xt;return isScaleChannel($t)?jt!==void 0?channelSupportScaleType($t,jt)?isFieldDef(Ct)&&!scaleTypeSupportDataType(jt,Ct.type)?(warn(scaleTypeNotWorkWithFieldDef(jt,Ft)),Ft):jt:(warn(scaleTypeNotWorkWithChannel($t,jt,Ft)),Ft):Ft:null}function defaultType(xt,$t,Ct,kt){var Mt;switch($t.type){case"nominal":case"ordinal":{if(isColorChannel(xt)||rangeType(xt)==="discrete")return xt==="shape"&&$t.type==="ordinal"&&warn(discreteChannelCannotEncode(xt,"ordinal")),"ordinal";if(isXorY(xt)||isXorYOffset(xt)){if(contains(["rect","bar","image","rule"],Ct.type)||kt)return"band"}else if(Ct.type==="arc"&&xt in POLAR_POSITION_SCALE_CHANNEL_INDEX)return"band";const Ft=Ct[getSizeChannel(xt)];return isRelativeBandSize(Ft)||isPositionFieldOrDatumDef($t)&&((Mt=$t.axis)!=null&&Mt.tickBand)?"band":"point"}case"temporal":return isColorChannel(xt)?"time":rangeType(xt)==="discrete"?(warn(discreteChannelCannotEncode(xt,"temporal")),"ordinal"):isFieldDef($t)&&$t.timeUnit&&normalizeTimeUnit($t.timeUnit).utc?"utc":"time";case"quantitative":return isColorChannel(xt)?isFieldDef($t)&&isBinning($t.bin)?"bin-ordinal":"linear":rangeType(xt)==="discrete"?(warn(discreteChannelCannotEncode(xt,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(invalidFieldType($t.type))}function parseScales(xt,{ignoreRange:$t}={}){parseScaleCore(xt),parseScaleDomain(xt);for(const Ct of NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES)parseScaleProperty(xt,Ct);$t||parseScaleRange(xt)}function parseScaleCore(xt){isUnitModel(xt)?xt.component.scales=parseUnitScaleCore(xt):xt.component.scales=parseNonUnitScaleCore(xt)}function parseUnitScaleCore(xt){const{encoding:$t,mark:Ct,markDef:kt}=xt,Mt={};for(const Ft of SCALE_CHANNELS){const jt=getFieldOrDatumDef($t[Ft]);if(jt&&Ct===GEOSHAPE&&Ft===SHAPE&&jt.type===GEOJSON)continue;let Bt=jt&&jt.scale;if(jt&&Bt!==null&&Bt!==!1){Bt??(Bt={});const Vt=channelHasNestedOffsetScale($t,Ft),zt=scaleType(Bt,Ft,jt,kt,Vt);Mt[Ft]=new ScaleComponent(xt.scaleName(`${Ft}`,!0),{value:zt,explicit:Bt.type===zt})}}return Mt}const scaleTypeTieBreaker=tieBreakByComparing((xt,$t)=>scaleTypePrecedence(xt)-scaleTypePrecedence($t));function parseNonUnitScaleCore(xt){var $t;const Ct=xt.component.scales={},kt={},Mt=xt.component.resolve;for(const Ft of xt.children){parseScaleCore(Ft);for(const jt of keys(Ft.component.scales))if(($t=Mt.scale)[jt]??($t[jt]=defaultScaleResolve(jt,xt)),Mt.scale[jt]==="shared"){const Bt=kt[jt],Vt=Ft.component.scales[jt].getWithExplicit("type");Bt?scaleCompatible(Bt.value,Vt.value)?kt[jt]=mergeValuesWithExplicit(Bt,Vt,"type","scale",scaleTypeTieBreaker):(Mt.scale[jt]="independent",delete kt[jt]):kt[jt]=Vt}}for(const Ft of keys(kt)){const jt=xt.scaleName(Ft,!0),Bt=kt[Ft];Ct[Ft]=new ScaleComponent(jt,Bt);for(const Vt of xt.children){const zt=Vt.component.scales[Ft];zt&&(Vt.renameScale(zt.get("name"),jt),zt.merged=!0)}}return Ct}class NameMap{constructor(){this.nameMap={}}rename($t,Ct){this.nameMap[$t]=Ct}has($t){return this.nameMap[$t]!==void 0}get($t){for(;this.nameMap[$t]&&$t!==this.nameMap[$t];)$t=this.nameMap[$t];return $t}}function isUnitModel(xt){return(xt==null?void 0:xt.type)==="unit"}function isFacetModel(xt){return(xt==null?void 0:xt.type)==="facet"}function isConcatModel(xt){return(xt==null?void 0:xt.type)==="concat"}function isLayerModel(xt){return(xt==null?void 0:xt.type)==="layer"}class Model{constructor($t,Ct,kt,Mt,Ft,jt,Bt){this.type=Ct,this.parent=kt,this.config=Ft,this.correctDataNames=Vt=>{var zt,Ht,Gt;return(zt=Vt.from)!=null&&zt.data&&(Vt.from.data=this.lookupDataSource(Vt.from.data)),(Gt=(Ht=Vt.from)==null?void 0:Ht.facet)!=null&&Gt.data&&(Vt.from.facet.data=this.lookupDataSource(Vt.from.facet.data)),Vt},this.parent=kt,this.config=Ft,this.view=replaceExprRef(Bt),this.name=$t.name??Mt,this.title=isText($t.title)?{text:$t.title}:$t.title?replaceExprRef($t.title):void 0,this.scaleNameMap=kt?kt.scaleNameMap:new NameMap,this.projectionNameMap=kt?kt.projectionNameMap:new NameMap,this.signalNameMap=kt?kt.signalNameMap:new NameMap,this.data=$t.data,this.description=$t.description,this.transforms=normalizeTransform($t.transform??[]),this.layout=Ct==="layer"||Ct==="unit"?{}:extractCompositionLayout($t,Ct,Ft),this.component={data:{sources:kt?kt.component.data.sources:[],outputNodes:kt?kt.component.data.outputNodes:{},outputNodeRefCounts:kt?kt.component.data.outputNodeRefCounts:{},isFaceted:isFacetSpec($t)||(kt==null?void 0:kt.component.data.isFaceted)&&$t.data===void 0},layoutSize:new Split,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...jt?duplicate(jt):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){parseScales(this)}parseProjection(){parseProjection(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){parseLegend(this)}assembleEncodeFromView($t){const{style:Ct,...kt}=$t,Mt={};for(const Ft of keys(kt)){const jt=kt[Ft];jt!==void 0&&(Mt[Ft]=signalOrValueRef(jt))}return Mt}assembleGroupEncodeEntry($t){let Ct={};return this.view&&(Ct=this.assembleEncodeFromView(this.view)),!$t&&(this.description&&(Ct.description=signalOrValueRef(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...Ct}:isEmpty(Ct)?void 0:Ct}assembleLayout(){if(!this.layout)return;const{spacing:$t,...Ct}=this.layout,{component:kt,config:Mt}=this,Ft=assembleLayoutTitleBand(kt.layoutHeaders,Mt);return{padding:$t,...this.assembleDefaultLayout(),...Ct,...Ft?{titleBand:Ft}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:$t}=this.component;let Ct=[];for(const kt of FACET_CHANNELS)$t[kt].title&&Ct.push(assembleTitleGroup(this,kt));for(const kt of HEADER_CHANNELS)Ct=Ct.concat(assembleHeaderGroups(this,kt));return Ct}assembleAxes(){return assembleAxes(this.component.axes,this.config)}assembleLegends(){return assembleLegends(this)}assembleProjections(){return assembleProjections(this)}assembleTitle(){const{encoding:$t,...Ct}=this.title??{},kt={...extractTitleConfig(this.config.title).nonMarkTitleProperties,...Ct,...$t?{encode:{update:$t}}:{}};if(kt.text)return contains(["unit","layer"],this.type)?contains(["middle",void 0],kt.anchor)&&(kt.frame??(kt.frame="group")):kt.anchor??(kt.anchor="start"),isEmpty(kt)?void 0:kt}assembleGroup($t=[]){const Ct={};$t=$t.concat(this.assembleSignals()),$t.length>0&&(Ct.signals=$t);const kt=this.assembleLayout();kt&&(Ct.layout=kt),Ct.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const Mt=!this.parent||isFacetModel(this.parent)?assembleScales(this):[];Mt.length>0&&(Ct.scales=Mt);const Ft=this.assembleAxes();Ft.length>0&&(Ct.axes=Ft);const jt=this.assembleLegends();return jt.length>0&&(Ct.legends=jt),Ct}getName($t){return varName((this.name?`${this.name}_`:"")+$t)}getDataName($t){return this.getName(DataSourceType[$t].toLowerCase())}requestDataName($t){const Ct=this.getDataName($t),kt=this.component.data.outputNodeRefCounts;return kt[Ct]=(kt[Ct]||0)+1,Ct}getSizeSignalRef($t){if(isFacetModel(this.parent)){const Ct=getSizeTypeFromLayoutSizeType($t),kt=getPositionScaleChannel(Ct),Mt=this.component.scales[kt];if(Mt&&!Mt.merged){const Ft=Mt.get("type"),jt=Mt.get("range");if(hasDiscreteDomain(Ft)&&isVgRangeStep(jt)){const Bt=Mt.get("name"),Vt=assembleDomain(this,kt),zt=getFieldFromDomain(Vt);if(zt){const Ht=vgField({aggregate:"distinct",field:zt},{expr:"datum"});return{signal:sizeExpr(Bt,Mt,Ht)}}else return warn(unknownField(kt)),null}}}return{signal:this.signalNameMap.get(this.getName($t))}}lookupDataSource($t){const Ct=this.component.data.outputNodes[$t];return Ct?Ct.getSource():$t}getSignalName($t){return this.signalNameMap.get($t)}renameSignal($t,Ct){this.signalNameMap.rename($t,Ct)}renameScale($t,Ct){this.scaleNameMap.rename($t,Ct)}renameProjection($t,Ct){this.projectionNameMap.rename($t,Ct)}scaleName($t,Ct){if(Ct)return this.getName($t);if(isChannel($t)&&isScaleChannel($t)&&this.component.scales[$t]||this.scaleNameMap.has(this.getName($t)))return this.scaleNameMap.get(this.getName($t))}projectionName($t){if($t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent($t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const Ct=this.component.scales[$t];return Ct&&!Ct.merged?Ct:this.parent?this.parent.getScaleComponent($t):void 0}getSelectionComponent($t,Ct){let kt=this.component.selection[$t];if(!kt&&this.parent&&(kt=this.parent.getSelectionComponent($t,Ct)),!kt)throw new Error(selectionNotFound(Ct));return kt}hasAxisOrientSignalRef(){var $t,Ct;return(($t=this.component.axes.x)==null?void 0:$t.some(kt=>kt.hasOrientSignalRef()))||((Ct=this.component.axes.y)==null?void 0:Ct.some(kt=>kt.hasOrientSignalRef()))}}class ModelWithField extends Model{vgField($t,Ct={}){const kt=this.fieldDef($t);if(kt)return vgField(kt,Ct)}reduceFieldDef($t,Ct){return reduce(this.getMapping(),(kt,Mt,Ft)=>{const jt=getFieldDef(Mt);return jt?$t(kt,jt,Ft):kt},Ct)}forEachFieldDef($t,Ct){forEach(this.getMapping(),(kt,Mt)=>{const Ft=getFieldDef(kt);Ft&&$t(Ft,Mt)},Ct)}}class DensityTransformNode extends DataFlowNode{clone(){return new DensityTransformNode(null,duplicate(this.transform))}constructor($t,Ct){super($t),this.transform=Ct,this.transform=duplicate(Ct);const kt=this.transform.as??[void 0,void 0];this.transform.as=[kt[0]??"value",kt[1]??"density"];const Mt=this.transform.resolve??"shared";this.transform.resolve=Mt}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${hash(this.transform)}`}assemble(){const{density:$t,...Ct}=this.transform,kt={type:"kde",field:$t,...Ct};return kt.resolve=this.transform.resolve,kt}}class ExtentTransformNode extends DataFlowNode{clone(){return new ExtentTransformNode(null,duplicate(this.transform))}constructor($t,Ct){super($t),this.transform=Ct,this.transform=duplicate(Ct)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${hash(this.transform)}`}assemble(){const{extent:$t,param:Ct}=this.transform;return{type:"extent",field:$t,signal:Ct}}}class FilterInvalidNode extends DataFlowNode{clone(){return new FilterInvalidNode(null,{...this.filter})}constructor($t,Ct){super($t),this.filter=Ct}static make($t,Ct){const{config:kt,mark:Mt,markDef:Ft}=Ct;if(getMarkPropOrConfig("invalid",Ft,kt)!=="filter")return null;const Bt=Ct.reduceFieldDef((Vt,zt,Ht)=>{const Gt=isScaleChannel(Ht)&&Ct.getScaleComponent(Ht);if(Gt){const qt=Gt.get("type");hasContinuousDomain(qt)&&zt.aggregate!=="count"&&!isPathMark(Mt)&&(Vt[zt.field]=zt)}return Vt},{});return keys(Bt).length?new FilterInvalidNode($t,Bt):null}dependentFields(){return new Set(keys(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${hash(this.filter)}`}assemble(){const $t=keys(this.filter).reduce((Ct,kt)=>{const Mt=this.filter[kt],Ft=vgField(Mt,{expr:"datum"});return Mt!==null&&(Mt.type==="temporal"?Ct.push(`(isDate(${Ft}) || (isValid(${Ft}) && isFinite(+${Ft})))`):Mt.type==="quantitative"&&(Ct.push(`isValid(${Ft})`),Ct.push(`isFinite(+${Ft})`))),Ct},[]);return $t.length>0?{type:"filter",expr:$t.join(" && ")}:null}}class FlattenTransformNode extends DataFlowNode{clone(){return new FlattenTransformNode(this.parent,duplicate(this.transform))}constructor($t,Ct){super($t),this.transform=Ct,this.transform=duplicate(Ct);const{flatten:kt,as:Mt=[]}=this.transform;this.transform.as=kt.map((Ft,jt)=>Mt[jt]??Ft)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${hash(this.transform)}`}assemble(){const{flatten:$t,as:Ct}=this.transform;return{type:"flatten",fields:$t,as:Ct}}}class FoldTransformNode extends DataFlowNode{clone(){return new FoldTransformNode(null,duplicate(this.transform))}constructor($t,Ct){super($t),this.transform=Ct,this.transform=duplicate(Ct);const kt=this.transform.as??[void 0,void 0];this.transform.as=[kt[0]??"key",kt[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${hash(this.transform)}`}assemble(){const{fold:$t,as:Ct}=this.transform;return{type:"fold",fields:$t,as:Ct}}}class GeoJSONNode extends DataFlowNode{clone(){return new GeoJSONNode(null,duplicate(this.fields),this.geojson,this.signal)}static parseAll($t,Ct){if(Ct.component.projection&&!Ct.component.projection.isFit)return $t;let kt=0;for(const Mt of[[LONGITUDE,LATITUDE],[LONGITUDE2,LATITUDE2]]){const Ft=Mt.map(jt=>{const Bt=getFieldOrDatumDef(Ct.encoding[jt]);return isFieldDef(Bt)?Bt.field:isDatumDef(Bt)?{expr:`${Bt.datum}`}:isValueDef(Bt)?{expr:`${Bt.value}`}:void 0});(Ft[0]||Ft[1])&&($t=new GeoJSONNode($t,Ft,null,Ct.getName(`geojson_${kt++}`)))}if(Ct.channelHasField(SHAPE)){const Mt=Ct.typedFieldDef(SHAPE);Mt.type===GEOJSON&&($t=new GeoJSONNode($t,null,Mt.field,Ct.getName(`geojson_${kt++}`)))}return $t}constructor($t,Ct,kt,Mt){super($t),this.fields=Ct,this.geojson=kt,this.signal=Mt}dependentFields(){const $t=(this.fields??[]).filter(isString);return new Set([...this.geojson?[this.geojson]:[],...$t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${hash(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class GeoPointNode extends DataFlowNode{clone(){return new GeoPointNode(null,this.projection,duplicate(this.fields),duplicate(this.as))}constructor($t,Ct,kt,Mt){super($t),this.projection=Ct,this.fields=kt,this.as=Mt}static parseAll($t,Ct){if(!Ct.projectionName())return $t;for(const kt of[[LONGITUDE,LATITUDE],[LONGITUDE2,LATITUDE2]]){const Mt=kt.map(jt=>{const Bt=getFieldOrDatumDef(Ct.encoding[jt]);return isFieldDef(Bt)?Bt.field:isDatumDef(Bt)?{expr:`${Bt.datum}`}:isValueDef(Bt)?{expr:`${Bt.value}`}:void 0}),Ft=kt[0]===LONGITUDE2?"2":"";(Mt[0]||Mt[1])&&($t=new GeoPointNode($t,Ct.projectionName(),Mt,[Ct.getName(`x${Ft}`),Ct.getName(`y${Ft}`)]))}return $t}dependentFields(){return new Set(this.fields.filter(isString))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${hash(this.fields)} ${hash(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class ImputeNode extends DataFlowNode{clone(){return new ImputeNode(null,duplicate(this.transform))}constructor($t,Ct){super($t),this.transform=Ct}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence($t){const{start:Ct=0,stop:kt,step:Mt}=$t;return{signal:`sequence(${[Ct,kt,...Mt?[Mt]:[]].join(",")})`}}static makeFromTransform($t,Ct){return new ImputeNode($t,Ct)}static makeFromEncoding($t,Ct){const kt=Ct.encoding,Mt=kt.x,Ft=kt.y;if(isFieldDef(Mt)&&isFieldDef(Ft)){const jt=Mt.impute?Mt:Ft.impute?Ft:void 0;if(jt===void 0)return;const Bt=Mt.impute?Ft:Ft.impute?Mt:void 0,{method:Vt,value:zt,frame:Ht,keyvals:Gt}=jt.impute,qt=pathGroupingFields(Ct.mark,kt);return new ImputeNode($t,{impute:jt.field,key:Bt.field,...Vt?{method:Vt}:{},...zt!==void 0?{value:zt}:{},...Ht?{frame:Ht}:{},...Gt!==void 0?{keyvals:Gt}:{},...qt.length?{groupby:qt}:{}})}return null}hash(){return`Impute ${hash(this.transform)}`}assemble(){const{impute:$t,key:Ct,keyvals:kt,method:Mt,groupby:Ft,value:jt,frame:Bt=[null,null]}=this.transform,Vt={type:"impute",field:$t,key:Ct,...kt?{keyvals:isImputeSequence(kt)?this.processSequence(kt):kt}:{},method:"value",...Ft?{groupby:Ft}:{},value:!Mt||Mt==="value"?jt:null};if(Mt&&Mt!=="value"){const zt={type:"window",as:[`imputed_${$t}_value`],ops:[Mt],fields:[$t],frame:Bt,ignorePeers:!1,...Ft?{groupby:Ft}:{}},Ht={type:"formula",expr:`datum.${$t} === null ? datum.imputed_${$t}_value : datum.${$t}`,as:$t};return[Vt,zt,Ht]}else return[Vt]}}class LoessTransformNode extends DataFlowNode{clone(){return new LoessTransformNode(null,duplicate(this.transform))}constructor($t,Ct){super($t),this.transform=Ct,this.transform=duplicate(Ct);const kt=this.transform.as??[void 0,void 0];this.transform.as=[kt[0]??Ct.on,kt[1]??Ct.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${hash(this.transform)}`}assemble(){const{loess:$t,on:Ct,...kt}=this.transform;return{type:"loess",x:Ct,y:$t,...kt}}}class LookupNode extends DataFlowNode{clone(){return new LookupNode(null,duplicate(this.transform),this.secondary)}constructor($t,Ct,kt){super($t),this.transform=Ct,this.secondary=kt}static make($t,Ct,kt,Mt){const Ft=Ct.component.data.sources,{from:jt}=kt;let Bt=null;if(isLookupData(jt)){let Vt=findSource(jt.data,Ft);Vt||(Vt=new SourceNode(jt.data),Ft.push(Vt));const zt=Ct.getName(`lookup_${Mt}`);Bt=new OutputNode(Vt,zt,DataSourceType.Lookup,Ct.component.data.outputNodeRefCounts),Ct.component.data.outputNodes[zt]=Bt}else if(isLookupSelection(jt)){const Vt=jt.param;kt={as:Vt,...kt};let zt;try{zt=Ct.getSelectionComponent(varName(Vt),Vt)}catch{throw new Error(cannotLookupVariableParameter(Vt))}if(Bt=zt.materialized,!Bt)throw new Error(noSameUnitLookup(Vt))}return new LookupNode($t,kt,Bt.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?array$2(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${hash({transform:this.transform,secondary:this.secondary})}`}assemble(){let $t;if(this.transform.from.fields)$t={values:this.transform.from.fields,...this.transform.as?{as:array$2(this.transform.as)}:{}};else{let Ct=this.transform.as;isString(Ct)||(warn(NO_FIELDS_NEEDS_AS),Ct="_lookup"),$t={as:[Ct]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...$t,...this.transform.default?{default:this.transform.default}:{}}}}class QuantileTransformNode extends DataFlowNode{clone(){return new QuantileTransformNode(null,duplicate(this.transform))}constructor($t,Ct){super($t),this.transform=Ct,this.transform=duplicate(Ct);const kt=this.transform.as??[void 0,void 0];this.transform.as=[kt[0]??"prob",kt[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${hash(this.transform)}`}assemble(){const{quantile:$t,...Ct}=this.transform;return{type:"quantile",field:$t,...Ct}}}class RegressionTransformNode extends DataFlowNode{clone(){return new RegressionTransformNode(null,duplicate(this.transform))}constructor($t,Ct){super($t),this.transform=Ct,this.transform=duplicate(Ct);const kt=this.transform.as??[void 0,void 0];this.transform.as=[kt[0]??Ct.on,kt[1]??Ct.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${hash(this.transform)}`}assemble(){const{regression:$t,on:Ct,...kt}=this.transform;return{type:"regression",x:Ct,y:$t,...kt}}}class PivotTransformNode extends DataFlowNode{clone(){return new PivotTransformNode(null,duplicate(this.transform))}constructor($t,Ct){super($t),this.transform=Ct}addDimensions($t){this.transform.groupby=unique((this.transform.groupby??[]).concat($t),Ct=>Ct)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${hash(this.transform)}`}assemble(){const{pivot:$t,value:Ct,groupby:kt,limit:Mt,op:Ft}=this.transform;return{type:"pivot",field:$t,value:Ct,...Mt!==void 0?{limit:Mt}:{},...Ft!==void 0?{op:Ft}:{},...kt!==void 0?{groupby:kt}:{}}}}class SampleTransformNode extends DataFlowNode{clone(){return new SampleTransformNode(null,duplicate(this.transform))}constructor($t,Ct){super($t),this.transform=Ct}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${hash(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function makeWalkTree(xt){let $t=0;function Ct(kt,Mt){if(kt instanceof SourceNode&&!kt.isGenerator&&!isUrlData(kt.data)&&(xt.push(Mt),Mt={name:null,source:Mt.name,transform:[]}),kt instanceof ParseNode&&(kt.parent instanceof SourceNode&&!Mt.source?(Mt.format={...Mt.format,parse:kt.assembleFormatParse()},Mt.transform.push(...kt.assembleTransforms(!0))):Mt.transform.push(...kt.assembleTransforms())),kt instanceof FacetNode){Mt.name||(Mt.name=`data_${$t++}`),!Mt.source||Mt.transform.length>0?(xt.push(Mt),kt.data=Mt.name):kt.data=Mt.source,xt.push(...kt.assemble());return}switch((kt instanceof GraticuleNode||kt instanceof SequenceNode||kt instanceof FilterInvalidNode||kt instanceof FilterNode||kt instanceof CalculateNode||kt instanceof GeoPointNode||kt instanceof AggregateNode||kt instanceof LookupNode||kt instanceof WindowTransformNode||kt instanceof JoinAggregateTransformNode||kt instanceof FoldTransformNode||kt instanceof FlattenTransformNode||kt instanceof DensityTransformNode||kt instanceof LoessTransformNode||kt instanceof QuantileTransformNode||kt instanceof RegressionTransformNode||kt instanceof IdentifierNode||kt instanceof SampleTransformNode||kt instanceof PivotTransformNode||kt instanceof ExtentTransformNode)&&Mt.transform.push(kt.assemble()),(kt instanceof BinNode||kt instanceof TimeUnitNode||kt instanceof ImputeNode||kt instanceof StackNode||kt instanceof GeoJSONNode)&&Mt.transform.push(...kt.assemble()),kt instanceof OutputNode&&(Mt.source&&Mt.transform.length===0?kt.setSource(Mt.source):kt.parent instanceof OutputNode?kt.setSource(Mt.name):(Mt.name||(Mt.name=`data_${$t++}`),kt.setSource(Mt.name),kt.numChildren()===1&&(xt.push(Mt),Mt={name:null,source:Mt.name,transform:[]}))),kt.numChildren()){case 0:kt instanceof OutputNode&&(!Mt.source||Mt.transform.length>0)&&xt.push(Mt);break;case 1:Ct(kt.children[0],Mt);break;default:{Mt.name||(Mt.name=`data_${$t++}`);let Ft=Mt.name;!Mt.source||Mt.transform.length>0?xt.push(Mt):Ft=Mt.source;for(const jt of kt.children)Ct(jt,{name:null,source:Ft,transform:[]});break}}}return Ct}function assembleFacetData(xt){const $t=[],Ct=makeWalkTree($t);for(const kt of xt.children)Ct(kt,{source:xt.name,name:null,transform:[]});return $t}function assembleRootData(xt,$t){const Ct=[],kt=makeWalkTree(Ct);let Mt=0;for(const jt of xt.sources){jt.hasName()||(jt.dataName=`source_${Mt++}`);const Bt=jt.assemble();kt(jt,Bt)}for(const jt of Ct)jt.transform.length===0&&delete jt.transform;let Ft=0;for(const[jt,Bt]of Ct.entries())(Bt.transform??[]).length===0&&!Bt.source&&Ct.splice(Ft++,0,Ct.splice(jt,1)[0]);for(const jt of Ct)for(const Bt of jt.transform??[])Bt.type==="lookup"&&(Bt.from=xt.outputNodes[Bt.from].getSource());for(const jt of Ct)jt.name in $t&&(jt.values=$t[jt.name]);return Ct}function getHeaderType(xt){return xt==="top"||xt==="left"||isSignalRef(xt)?"header":"footer"}function parseFacetHeaders(xt){for(const $t of FACET_CHANNELS)parseFacetHeader(xt,$t);mergeChildAxis(xt,"x"),mergeChildAxis(xt,"y")}function parseFacetHeader(xt,$t){var jt;const{facet:Ct,config:kt,child:Mt,component:Ft}=xt;if(xt.channelHasField($t)){const Bt=Ct[$t],Vt=getHeaderProperty("title",null,kt,$t);let zt=title(Bt,kt,{allowDisabling:!0,includeDefault:Vt===void 0||!!Vt});Mt.component.layoutHeaders[$t].title&&(zt=isArray(zt)?zt.join(", "):zt,zt+=` / ${Mt.component.layoutHeaders[$t].title}`,Mt.component.layoutHeaders[$t].title=null);const Ht=getHeaderProperty("labelOrient",Bt.header,kt,$t),Gt=Bt.header!==null?getFirstDefined((jt=Bt.header)==null?void 0:jt.labels,kt.header.labels,!0):!1,qt=contains(["bottom","right"],Ht)?"footer":"header";Ft.layoutHeaders[$t]={title:Bt.header!==null?zt:null,facetFieldDef:Bt,[qt]:$t==="facet"?[]:[makeHeaderComponent(xt,$t,Gt)]}}}function makeHeaderComponent(xt,$t,Ct){const kt=$t==="row"?"height":"width";return{labels:Ct,sizeSignal:xt.child.component.layoutSize.get(kt)?xt.child.getSizeSignalRef(kt):void 0,axes:[]}}function mergeChildAxis(xt,$t){const{child:Ct}=xt;if(Ct.component.axes[$t]){const{layoutHeaders:kt,resolve:Mt}=xt.component;if(Mt.axis[$t]=parseGuideResolve(Mt,$t),Mt.axis[$t]==="shared"){const Ft=$t==="x"?"column":"row",jt=kt[Ft];for(const Bt of Ct.component.axes[$t]){const Vt=getHeaderType(Bt.get("orient"));jt[Vt]??(jt[Vt]=[makeHeaderComponent(xt,Ft,!1)]);const zt=assembleAxis(Bt,"main",xt.config,{header:!0});zt&&jt[Vt][0].axes.push(zt),Bt.mainExtracted=!0}}}}function parseLayerLayoutSize(xt){parseChildrenLayoutSize(xt),parseNonUnitLayoutSizeForChannel(xt,"width"),parseNonUnitLayoutSizeForChannel(xt,"height")}function parseConcatLayoutSize(xt){parseChildrenLayoutSize(xt);const $t=xt.layout.columns===1?"width":"childWidth",Ct=xt.layout.columns===void 0?"height":"childHeight";parseNonUnitLayoutSizeForChannel(xt,$t),parseNonUnitLayoutSizeForChannel(xt,Ct)}function parseChildrenLayoutSize(xt){for(const $t of xt.children)$t.parseLayoutSize()}function parseNonUnitLayoutSizeForChannel(xt,$t){const Ct=getSizeTypeFromLayoutSizeType($t),kt=getPositionScaleChannel(Ct),Mt=xt.component.resolve,Ft=xt.component.layoutSize;let jt;for(const Bt of xt.children){const Vt=Bt.component.layoutSize.getWithExplicit(Ct),zt=Mt.scale[kt]??defaultScaleResolve(kt,xt);if(zt==="independent"&&Vt.value==="step"){jt=void 0;break}if(jt){if(zt==="independent"&&jt.value!==Vt.value){jt=void 0;break}jt=mergeValuesWithExplicit(jt,Vt,Ct,"")}else jt=Vt}if(jt){for(const Bt of xt.children)xt.renameSignal(Bt.getName(Ct),xt.getName($t)),Bt.component.layoutSize.set(Ct,"merged",!1);Ft.setWithExplicit($t,jt)}else Ft.setWithExplicit($t,{explicit:!1,value:void 0})}function parseUnitLayoutSize(xt){const{size:$t,component:Ct}=xt;for(const kt of POSITION_SCALE_CHANNELS){const Mt=getSizeChannel(kt);if($t[Mt]){const Ft=$t[Mt];Ct.layoutSize.set(Mt,isStep(Ft)?"step":Ft,!0)}else{const Ft=defaultUnitSize(xt,Mt);Ct.layoutSize.set(Mt,Ft,!1)}}}function defaultUnitSize(xt,$t){const Ct=$t==="width"?"x":"y",kt=xt.config,Mt=xt.getScaleComponent(Ct);if(Mt){const Ft=Mt.get("type"),jt=Mt.get("range");if(hasDiscreteDomain(Ft)){const Bt=getViewConfigDiscreteSize(kt.view,$t);return isVgRangeStep(jt)||isStep(Bt)?"step":Bt}else return getViewConfigContinuousSize(kt.view,$t)}else{if(xt.hasProjection||xt.mark==="arc")return getViewConfigContinuousSize(kt.view,$t);{const Ft=getViewConfigDiscreteSize(kt.view,$t);return isStep(Ft)?Ft.step:Ft}}}function facetSortFieldName(xt,$t,Ct){return vgField($t,{suffix:`by_${vgField(xt)}`,...Ct})}class FacetModel extends ModelWithField{constructor($t,Ct,kt,Mt){super($t,"facet",Ct,kt,Mt,$t.resolve),this.child=buildModel($t.spec,this,this.getName("child"),void 0,Mt),this.children=[this.child],this.facet=this.initFacet($t.facet)}initFacet($t){if(!isFacetMapping($t))return{facet:this.initFacetFieldDef($t,"facet")};const Ct=keys($t),kt={};for(const Mt of Ct){if(![ROW,COLUMN].includes(Mt)){warn(incompatibleChannel(Mt,"facet"));break}const Ft=$t[Mt];if(Ft.field===void 0){warn(emptyFieldDef(Ft,Mt));break}kt[Mt]=this.initFacetFieldDef(Ft,Mt)}return kt}initFacetFieldDef($t,Ct){const kt=initFieldDef($t,Ct);return kt.header?kt.header=replaceExprRef(kt.header):kt.header===null&&(kt.header=null),kt}channelHasField($t){return!!this.facet[$t]}fieldDef($t){return this.facet[$t]}parseData(){this.component.data=parseData(this),this.child.parseData()}parseLayoutSize(){parseChildrenLayoutSize(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),parseFacetHeaders(this)}assembleSelectionTopLevelSignals($t){return this.child.assembleSelectionTopLevelSignals($t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData($t){return this.child.assembleSelectionData($t)}getHeaderLayoutMixins(){const $t={};for(const Ct of FACET_CHANNELS)for(const kt of HEADER_TYPES){const Mt=this.component.layoutHeaders[Ct],Ft=Mt[kt],{facetFieldDef:jt}=Mt;if(jt){const Bt=getHeaderProperty("titleOrient",jt.header,this.config,Ct);if(["right","bottom"].includes(Bt)){const Vt=getHeaderChannel(Ct,Bt);$t.titleAnchor??($t.titleAnchor={}),$t.titleAnchor[Vt]="end"}}if(Ft!=null&&Ft[0]){const Bt=Ct==="row"?"height":"width",Vt=kt==="header"?"headerBand":"footerBand";Ct!=="facet"&&!this.child.component.layoutSize.get(Bt)&&($t[Vt]??($t[Vt]={}),$t[Vt][Ct]=.5),Mt.title&&($t.offset??($t.offset={}),$t.offset[Ct==="row"?"rowTitle":"columnTitle"]=10)}}return $t}assembleDefaultLayout(){const{column:$t,row:Ct}=this.facet,kt=$t?this.columnDistinctSignal():Ct?1:void 0;let Mt="all";return(!Ct&&this.component.resolve.scale.x==="independent"||!$t&&this.component.resolve.scale.y==="independent")&&(Mt="none"),{...this.getHeaderLayoutMixins(),...kt?{columns:kt}:{},bounds:"full",align:Mt}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof FacetModel))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup($t){return this.parent&&this.parent instanceof FacetModel?{...this.channelHasField("column")?{encode:{update:{columns:{field:vgField(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup($t)}:super.assembleGroup($t)}getCardinalityAggregateForChild(){const $t=[],Ct=[],kt=[];if(this.child instanceof FacetModel){if(this.child.channelHasField("column")){const Mt=vgField(this.child.facet.column);$t.push(Mt),Ct.push("distinct"),kt.push(`distinct_${Mt}`)}}else for(const Mt of POSITION_SCALE_CHANNELS){const Ft=this.child.component.scales[Mt];if(Ft&&!Ft.merged){const jt=Ft.get("type"),Bt=Ft.get("range");if(hasDiscreteDomain(jt)&&isVgRangeStep(Bt)){const Vt=assembleDomain(this.child,Mt),zt=getFieldFromDomain(Vt);zt?($t.push(zt),Ct.push("distinct"),kt.push(`distinct_${zt}`)):warn(unknownField(Mt))}}}return{fields:$t,ops:Ct,as:kt}}assembleFacet(){const{name:$t,data:Ct}=this.component.data.facetRoot,{row:kt,column:Mt}=this.facet,{fields:Ft,ops:jt,as:Bt}=this.getCardinalityAggregateForChild(),Vt=[];for(const Ht of FACET_CHANNELS){const Gt=this.facet[Ht];if(Gt){Vt.push(vgField(Gt));const{bin:qt,sort:Wt}=Gt;if(isBinning(qt)&&Vt.push(vgField(Gt,{binSuffix:"end"})),isSortField(Wt)){const{field:Yt,op:Kt=DEFAULT_SORT_OP}=Wt,Xt=facetSortFieldName(Gt,Wt);kt&&Mt?(Ft.push(Xt),jt.push("max"),Bt.push(Xt)):(Ft.push(Yt),jt.push(Kt),Bt.push(Xt))}else if(isArray(Wt)){const Yt=sortArrayIndexField(Gt,Ht);Ft.push(Yt),jt.push("max"),Bt.push(Yt)}}}const zt=!!kt&&!!Mt;return{name:$t,data:Ct,groupby:Vt,...zt||Ft.length>0?{aggregate:{...zt?{cross:zt}:{},...Ft.length?{fields:Ft,ops:jt,as:Bt}:{}}}:{}}}facetSortFields($t){const{facet:Ct}=this,kt=Ct[$t];return kt?isSortField(kt.sort)?[facetSortFieldName(kt,kt.sort,{expr:"datum"})]:isArray(kt.sort)?[sortArrayIndexField(kt,$t,{expr:"datum"})]:[vgField(kt,{expr:"datum"})]:[]}facetSortOrder($t){const{facet:Ct}=this,kt=Ct[$t];if(kt){const{sort:Mt}=kt;return[(isSortField(Mt)?Mt.order:!isArray(Mt)&&Mt)||"ascending"]}return[]}assembleLabelTitle(){var Mt;const{facet:$t,config:Ct}=this;if($t.facet)return assembleLabelTitle($t.facet,"facet",Ct);const kt={row:["top","bottom"],column:["left","right"]};for(const Ft of HEADER_CHANNELS)if($t[Ft]){const jt=getHeaderProperty("labelOrient",(Mt=$t[Ft])==null?void 0:Mt.header,Ct,Ft);if(kt[Ft].includes(jt))return assembleLabelTitle($t[Ft],Ft,Ct)}}assembleMarks(){const{child:$t}=this,Ct=this.component.data.facetRoot,kt=assembleFacetData(Ct),Mt=$t.assembleGroupEncodeEntry(!1),Ft=this.assembleLabelTitle()||$t.assembleTitle(),jt=$t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...Ft?{title:Ft}:{},...jt?{style:jt}:{},from:{facet:this.assembleFacet()},sort:{field:FACET_CHANNELS.map(Vt=>this.facetSortFields(Vt)).flat(),order:FACET_CHANNELS.map(Vt=>this.facetSortOrder(Vt)).flat()},...kt.length>0?{data:kt}:{},...Mt?{encode:{update:Mt}}:{},...$t.assembleGroup(assembleFacetSignals(this,[]))}]}getMapping(){return this.facet}}function makeJoinAggregateFromFacet(xt,$t){const{row:Ct,column:kt}=$t;if(Ct&&kt){let Mt=null;for(const Ft of[Ct,kt])if(isSortField(Ft.sort)){const{field:jt,op:Bt=DEFAULT_SORT_OP}=Ft.sort;xt=Mt=new JoinAggregateTransformNode(xt,{joinaggregate:[{op:Bt,field:jt,as:facetSortFieldName(Ft,Ft.sort,{forAs:!0})}],groupby:[vgField(Ft)]})}return Mt}return null}function findSource(xt,$t){var Ct,kt,Mt,Ft;for(const jt of $t){const Bt=jt.data;if(xt.name&&jt.hasName()&&xt.name!==jt.dataName)continue;const Vt=(Ct=xt.format)==null?void 0:Ct.mesh,zt=(kt=Bt.format)==null?void 0:kt.feature;if(Vt&&zt)continue;const Ht=(Mt=xt.format)==null?void 0:Mt.feature;if((Ht||zt)&&Ht!==zt)continue;const Gt=(Ft=Bt.format)==null?void 0:Ft.mesh;if(!((Vt||Gt)&&Vt!==Gt)){if(isInlineData(xt)&&isInlineData(Bt)){if(deepEqual(xt.values,Bt.values))return jt}else if(isUrlData(xt)&&isUrlData(Bt)){if(xt.url===Bt.url)return jt}else if(isNamedData(xt)&&xt.name===jt.dataName)return jt}}return null}function parseRoot(xt,$t){if(xt.data||!xt.parent){if(xt.data===null){const kt=new SourceNode({values:[]});return $t.push(kt),kt}const Ct=findSource(xt.data,$t);if(Ct)return isGenerator(xt.data)||(Ct.data.format=mergeDeep$1({},xt.data.format,Ct.data.format)),!Ct.hasName()&&xt.data.name&&(Ct.dataName=xt.data.name),Ct;{const kt=new SourceNode(xt.data);return $t.push(kt),kt}}else return xt.parent.component.data.facetRoot?xt.parent.component.data.facetRoot:xt.parent.component.data.main}function parseTransformArray(xt,$t,Ct){let kt=0;for(const Mt of $t.transforms){let Ft,jt;if(isCalculate(Mt))jt=xt=new CalculateNode(xt,Mt),Ft="derived";else if(isFilter(Mt)){const Bt=getImplicitFromFilterTransform(Mt);jt=xt=ParseNode.makeWithAncestors(xt,{},Bt,Ct)??xt,xt=new FilterNode(xt,$t,Mt.filter)}else if(isBin(Mt))jt=xt=BinNode.makeFromTransform(xt,Mt,$t),Ft="number";else if(isTimeUnit(Mt))Ft="date",Ct.getWithExplicit(Mt.field).value===void 0&&(xt=new ParseNode(xt,{[Mt.field]:Ft}),Ct.set(Mt.field,Ft,!1)),jt=xt=TimeUnitNode.makeFromTransform(xt,Mt);else if(isAggregate(Mt))jt=xt=AggregateNode.makeFromTransform(xt,Mt),Ft="number",requiresSelectionId($t)&&(xt=new IdentifierNode(xt));else if(isLookup(Mt))jt=xt=LookupNode.make(xt,$t,Mt,kt++),Ft="derived";else if(isWindow(Mt))jt=xt=new WindowTransformNode(xt,Mt),Ft="number";else if(isJoinAggregate(Mt))jt=xt=new JoinAggregateTransformNode(xt,Mt),Ft="number";else if(isStack(Mt))jt=xt=StackNode.makeFromTransform(xt,Mt),Ft="derived";else if(isFold(Mt))jt=xt=new FoldTransformNode(xt,Mt),Ft="derived";else if(isExtent(Mt))jt=xt=new ExtentTransformNode(xt,Mt),Ft="derived";else if(isFlatten(Mt))jt=xt=new FlattenTransformNode(xt,Mt),Ft="derived";else if(isPivot(Mt))jt=xt=new PivotTransformNode(xt,Mt),Ft="derived";else if(isSample(Mt))xt=new SampleTransformNode(xt,Mt);else if(isImpute(Mt))jt=xt=ImputeNode.makeFromTransform(xt,Mt),Ft="derived";else if(isDensity(Mt))jt=xt=new DensityTransformNode(xt,Mt),Ft="derived";else if(isQuantile(Mt))jt=xt=new QuantileTransformNode(xt,Mt),Ft="derived";else if(isRegression(Mt))jt=xt=new RegressionTransformNode(xt,Mt),Ft="derived";else if(isLoess(Mt))jt=xt=new LoessTransformNode(xt,Mt),Ft="derived";else{warn(invalidTransformIgnored(Mt));continue}if(jt&&Ft!==void 0)for(const Bt of jt.producedFields()??[])Ct.set(Bt,Ft,!1)}return xt}function parseData(xt){var Wt;let $t=parseRoot(xt,xt.component.data.sources);const{outputNodes:Ct,outputNodeRefCounts:kt}=xt.component.data,Mt=xt.data,jt=!(Mt&&(isGenerator(Mt)||isUrlData(Mt)||isInlineData(Mt)))&&xt.parent?xt.parent.component.data.ancestorParse.clone():new AncestorParse;isGenerator(Mt)?(isSequenceGenerator(Mt)?$t=new SequenceNode($t,Mt.sequence):isGraticuleGenerator(Mt)&&($t=new GraticuleNode($t,Mt.graticule)),jt.parseNothing=!0):((Wt=Mt==null?void 0:Mt.format)==null?void 0:Wt.parse)===null&&(jt.parseNothing=!0),$t=ParseNode.makeExplicit($t,xt,jt)??$t,$t=new IdentifierNode($t);const Bt=xt.parent&&isLayerModel(xt.parent);(isUnitModel(xt)||isFacetModel(xt))&&Bt&&($t=BinNode.makeFromEncoding($t,xt)??$t),xt.transforms.length>0&&($t=parseTransformArray($t,xt,jt));const Vt=getImplicitFromSelection(xt),zt=getImplicitFromEncoding(xt);$t=ParseNode.makeWithAncestors($t,{},{...Vt,...zt},jt)??$t,isUnitModel(xt)&&($t=GeoJSONNode.parseAll($t,xt),$t=GeoPointNode.parseAll($t,xt)),(isUnitModel(xt)||isFacetModel(xt))&&(Bt||($t=BinNode.makeFromEncoding($t,xt)??$t),$t=TimeUnitNode.makeFromEncoding($t,xt)??$t,$t=CalculateNode.parseAllForSortIndex($t,xt));const Ht=$t=makeOutputNode(DataSourceType.Raw,xt,$t);if(isUnitModel(xt)){const Yt=AggregateNode.makeFromEncoding($t,xt);Yt&&($t=Yt,requiresSelectionId(xt)&&($t=new IdentifierNode($t))),$t=ImputeNode.makeFromEncoding($t,xt)??$t,$t=StackNode.makeFromEncoding($t,xt)??$t}isUnitModel(xt)&&($t=FilterInvalidNode.make($t,xt)??$t);const Gt=$t=makeOutputNode(DataSourceType.Main,xt,$t);isUnitModel(xt)&&materializeSelections(xt,Gt);let qt=null;if(isFacetModel(xt)){const Yt=xt.getName("facet");$t=makeJoinAggregateFromFacet($t,xt.facet)??$t,qt=new FacetNode($t,xt,Yt,Gt.getSource()),Ct[Yt]=qt}return{...xt.component.data,outputNodes:Ct,outputNodeRefCounts:kt,raw:Ht,main:Gt,facetRoot:qt,ancestorParse:jt}}function makeOutputNode(xt,$t,Ct){const{outputNodes:kt,outputNodeRefCounts:Mt}=$t.component.data,Ft=$t.getDataName(xt),jt=new OutputNode(Ct,Ft,xt,Mt);return kt[Ft]=jt,jt}class ConcatModel extends Model{constructor($t,Ct,kt,Mt){var Ft,jt,Bt,Vt;super($t,"concat",Ct,kt,Mt,$t.resolve),(((jt=(Ft=$t.resolve)==null?void 0:Ft.axis)==null?void 0:jt.x)==="shared"||((Vt=(Bt=$t.resolve)==null?void 0:Bt.axis)==null?void 0:Vt.y)==="shared")&&warn(CONCAT_CANNOT_SHARE_AXIS),this.children=this.getChildren($t).map((zt,Ht)=>buildModel(zt,this,this.getName(`concat_${Ht}`),void 0,Mt))}parseData(){this.component.data=parseData(this);for(const $t of this.children)$t.parseData()}parseSelections(){this.component.selection={};for(const $t of this.children){$t.parseSelections();for(const Ct of keys($t.component.selection))this.component.selection[Ct]=$t.component.selection[Ct]}}parseMarkGroup(){for(const $t of this.children)$t.parseMarkGroup()}parseAxesAndHeaders(){for(const $t of this.children)$t.parseAxesAndHeaders()}getChildren($t){return isVConcatSpec($t)?$t.vconcat:isHConcatSpec($t)?$t.hconcat:$t.concat}parseLayoutSize(){parseConcatLayoutSize(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals($t){return this.children.reduce((Ct,kt)=>kt.assembleSelectionTopLevelSignals(Ct),$t)}assembleSignals(){return this.children.forEach($t=>$t.assembleSignals()),[]}assembleLayoutSignals(){const $t=assembleLayoutSignals(this);for(const Ct of this.children)$t.push(...Ct.assembleLayoutSignals());return $t}assembleSelectionData($t){return this.children.reduce((Ct,kt)=>kt.assembleSelectionData(Ct),$t)}assembleMarks(){return this.children.map($t=>{const Ct=$t.assembleTitle(),kt=$t.assembleGroupStyle(),Mt=$t.assembleGroupEncodeEntry(!1);return{type:"group",name:$t.getName("group"),...Ct?{title:Ct}:{},...kt?{style:kt}:{},...Mt?{encode:{update:Mt}}:{},...$t.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){const $t=this.layout.columns;return{...$t!=null?{columns:$t}:{},bounds:"full",align:"each"}}}function isFalseOrNull(xt){return xt===!1||xt===null}const AXIS_COMPONENT_PROPERTIES_INDEX={disable:1,gridScale:1,scale:1,...COMMON_AXIS_PROPERTIES_INDEX,labelExpr:1,encode:1},AXIS_COMPONENT_PROPERTIES=keys(AXIS_COMPONENT_PROPERTIES_INDEX);class AxisComponent extends Split{constructor($t={},Ct={},kt=!1){super(),this.explicit=$t,this.implicit=Ct,this.mainExtracted=kt}clone(){return new AxisComponent(duplicate(this.explicit),duplicate(this.implicit),this.mainExtracted)}hasAxisPart($t){return $t==="axis"?!0:$t==="grid"||$t==="title"?!!this.get($t):!isFalseOrNull(this.get($t))}hasOrientSignalRef(){return isSignalRef(this.explicit.orient)}}function labels(xt,$t,Ct){const{encoding:kt,config:Mt}=xt,Ft=getFieldOrDatumDef(kt[$t])??getFieldOrDatumDef(kt[getSecondaryRangeChannel($t)]),jt=xt.axis($t)||{},{format:Bt,formatType:Vt}=jt;if(isCustomFormatType(Vt))return{text:formatCustomType({fieldOrDatumDef:Ft,field:"datum.value",format:Bt,formatType:Vt,config:Mt}),...Ct};if(Bt===void 0&&Vt===void 0&&Mt.customFormatTypes){if(channelDefType(Ft)==="quantitative"){if(isPositionFieldOrDatumDef(Ft)&&Ft.stack==="normalize"&&Mt.normalizedNumberFormatType)return{text:formatCustomType({fieldOrDatumDef:Ft,field:"datum.value",format:Mt.normalizedNumberFormat,formatType:Mt.normalizedNumberFormatType,config:Mt}),...Ct};if(Mt.numberFormatType)return{text:formatCustomType({fieldOrDatumDef:Ft,field:"datum.value",format:Mt.numberFormat,formatType:Mt.numberFormatType,config:Mt}),...Ct}}if(channelDefType(Ft)==="temporal"&&Mt.timeFormatType&&isFieldDef(Ft)&&!Ft.timeUnit)return{text:formatCustomType({fieldOrDatumDef:Ft,field:"datum.value",format:Mt.timeFormat,formatType:Mt.timeFormatType,config:Mt}),...Ct}}return Ct}function parseUnitAxes(xt){return POSITION_SCALE_CHANNELS.reduce(($t,Ct)=>(xt.component.scales[Ct]&&($t[Ct]=[parseAxis(Ct,xt)]),$t),{})}const OPPOSITE_ORIENT={bottom:"top",top:"bottom",left:"right",right:"left"};function parseLayerAxes(xt){const{axes:$t,resolve:Ct}=xt.component,kt={top:0,bottom:0,right:0,left:0};for(const Mt of xt.children){Mt.parseAxesAndHeaders();for(const Ft of keys(Mt.component.axes))Ct.axis[Ft]=parseGuideResolve(xt.component.resolve,Ft),Ct.axis[Ft]==="shared"&&($t[Ft]=mergeAxisComponents($t[Ft],Mt.component.axes[Ft]),$t[Ft]||(Ct.axis[Ft]="independent",delete $t[Ft]))}for(const Mt of POSITION_SCALE_CHANNELS){for(const Ft of xt.children)if(Ft.component.axes[Mt]){if(Ct.axis[Mt]==="independent"){$t[Mt]=($t[Mt]??[]).concat(Ft.component.axes[Mt]);for(const jt of Ft.component.axes[Mt]){const{value:Bt,explicit:Vt}=jt.getWithExplicit("orient");if(!isSignalRef(Bt)){if(kt[Bt]>0&&!Vt){const zt=OPPOSITE_ORIENT[Bt];kt[Bt]>kt[zt]&&jt.set("orient",zt,!1)}kt[Bt]++}}}delete Ft.component.axes[Mt]}if(Ct.axis[Mt]==="independent"&&$t[Mt]&&$t[Mt].length>1)for(const[Ft,jt]of($t[Mt]||[]).entries())Ft>0&&jt.get("grid")&&!jt.explicit.grid&&(jt.implicit.grid=!1)}}function mergeAxisComponents(xt,$t){if(xt){if(xt.length!==$t.length)return;const Ct=xt.length;for(let kt=0;kt<Ct;kt++){const Mt=xt[kt],Ft=$t[kt];if(!!Mt!=!!Ft)return;if(Mt&&Ft){const jt=Mt.getWithExplicit("orient"),Bt=Ft.getWithExplicit("orient");if(jt.explicit&&Bt.explicit&&jt.value!==Bt.value)return;xt[kt]=mergeAxisComponent(Mt,Ft)}}}else return $t.map(Ct=>Ct.clone());return xt}function mergeAxisComponent(xt,$t){for(const Ct of AXIS_COMPONENT_PROPERTIES){const kt=mergeValuesWithExplicit(xt.getWithExplicit(Ct),$t.getWithExplicit(Ct),Ct,"axis",(Mt,Ft)=>{switch(Ct){case"title":return mergeTitleComponent(Mt,Ft);case"gridScale":return{explicit:Mt.explicit,value:getFirstDefined(Mt.value,Ft.value)}}return defaultTieBreaker(Mt,Ft,Ct,"axis")});xt.setWithExplicit(Ct,kt)}return xt}function isExplicit(xt,$t,Ct,kt,Mt){if($t==="disable")return Ct!==void 0;switch(Ct=Ct||{},$t){case"titleAngle":case"labelAngle":return xt===(isSignalRef(Ct.labelAngle)?Ct.labelAngle:normalizeAngle(Ct.labelAngle));case"values":return!!Ct.values;case"encode":return!!Ct.encoding||!!Ct.labelAngle;case"title":if(xt===getFieldDefTitle(kt,Mt))return!0}return xt===Ct[$t]}const propsToAlwaysIncludeConfig=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function parseAxis(xt,$t){var Qt,Jt;let Ct=$t.axis(xt);const kt=new AxisComponent,Mt=getFieldOrDatumDef($t.encoding[xt]),{mark:Ft,config:jt}=$t,Bt=(Ct==null?void 0:Ct.orient)||((Qt=jt[xt==="x"?"axisX":"axisY"])==null?void 0:Qt.orient)||((Jt=jt.axis)==null?void 0:Jt.orient)||defaultOrient(xt),Vt=$t.getScaleComponent(xt).get("type"),zt=getAxisConfigs(xt,Vt,Bt,$t.config),Ht=Ct!==void 0?!Ct:getAxisConfig("disable",jt.style,Ct==null?void 0:Ct.style,zt).configValue;if(kt.set("disable",Ht,Ct!==void 0),Ht)return kt;Ct=Ct||{};const Gt=getLabelAngle(Mt,Ct,xt,jt.style,zt),qt=guideFormatType(Ct.formatType,Mt,Vt),Wt=guideFormat(Mt,Mt.type,Ct.format,Ct.formatType,jt,!0),Yt={fieldOrDatumDef:Mt,axis:Ct,channel:xt,model:$t,scaleType:Vt,orient:Bt,labelAngle:Gt,format:Wt,formatType:qt,mark:Ft,config:jt};for(const Zt of AXIS_COMPONENT_PROPERTIES){const sn=Zt in axisRules?axisRules[Zt](Yt):isAxisProperty(Zt)?Ct[Zt]:void 0,ln=sn!==void 0,dn=isExplicit(sn,Zt,Ct,$t,xt);if(ln&&dn)kt.set(Zt,sn,dn);else{const{configValue:hn=void 0,configFrom:cn=void 0}=isAxisProperty(Zt)&&Zt!=="values"?getAxisConfig(Zt,jt.style,Ct.style,zt):{},pn=hn!==void 0;ln&&!pn?kt.set(Zt,sn,dn):(cn!=="vgAxisConfig"||propsToAlwaysIncludeConfig.has(Zt)&&pn||isConditionalAxisValue(hn)||isSignalRef(hn))&&kt.set(Zt,hn,!1)}}const Kt=Ct.encoding??{},Xt=AXIS_PARTS.reduce((Zt,sn)=>{if(!kt.hasAxisPart(sn))return Zt;const ln=guideEncodeEntry(Kt[sn]??{},$t),dn=sn==="labels"?labels($t,xt,ln):ln;return dn!==void 0&&!isEmpty(dn)&&(Zt[sn]={update:dn}),Zt},{});return isEmpty(Xt)||kt.set("encode",Xt,!!Ct.encoding||Ct.labelAngle!==void 0),kt}function initLayoutSize({encoding:xt,size:$t}){for(const Ct of POSITION_SCALE_CHANNELS){const kt=getSizeChannel(Ct);isStep($t[kt])&&isContinuousFieldOrDatumDef(xt[Ct])&&(delete $t[kt],warn(stepDropped(kt)))}return $t}const arc={vgMark:"arc",encodeEntry:xt=>({...baseEncodeEntry(xt,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...pointPosition("x",xt,{defaultPos:"mid"}),...pointPosition("y",xt,{defaultPos:"mid"}),...rectPosition(xt,"radius"),...rectPosition(xt,"theta")})},area={vgMark:"area",encodeEntry:xt=>({...baseEncodeEntry(xt,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...pointOrRangePosition("x",xt,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:xt.markDef.orient==="horizontal"}),...pointOrRangePosition("y",xt,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:xt.markDef.orient==="vertical"}),...defined(xt)})},bar={vgMark:"rect",encodeEntry:xt=>({...baseEncodeEntry(xt,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...rectPosition(xt,"x"),...rectPosition(xt,"y")})},geoshape={vgMark:"shape",encodeEntry:xt=>({...baseEncodeEntry(xt,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:xt=>{const{encoding:$t}=xt,Ct=$t.shape;return[{type:"geoshape",projection:xt.projectionName(),...Ct&&isFieldDef(Ct)&&Ct.type===GEOJSON?{field:vgField(Ct,{expr:"datum"})}:{}}]}},image={vgMark:"image",encodeEntry:xt=>({...baseEncodeEntry(xt,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...rectPosition(xt,"x"),...rectPosition(xt,"y"),...text$1(xt,"url")})},line={vgMark:"line",encodeEntry:xt=>({...baseEncodeEntry(xt,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...pointPosition("x",xt,{defaultPos:"mid"}),...pointPosition("y",xt,{defaultPos:"mid"}),...nonPosition("size",xt,{vgChannel:"strokeWidth"}),...defined(xt)})},trail={vgMark:"trail",encodeEntry:xt=>({...baseEncodeEntry(xt,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...pointPosition("x",xt,{defaultPos:"mid"}),...pointPosition("y",xt,{defaultPos:"mid"}),...nonPosition("size",xt),...defined(xt)})};function encodeEntry(xt,$t){const{config:Ct}=xt;return{...baseEncodeEntry(xt,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...pointPosition("x",xt,{defaultPos:"mid"}),...pointPosition("y",xt,{defaultPos:"mid"}),...nonPosition("size",xt),...nonPosition("angle",xt),...shapeMixins(xt,Ct,$t)}}function shapeMixins(xt,$t,Ct){return Ct?{shape:{value:Ct}}:nonPosition("shape",xt)}const point={vgMark:"symbol",encodeEntry:xt=>encodeEntry(xt)},circle={vgMark:"symbol",encodeEntry:xt=>encodeEntry(xt,"circle")},square={vgMark:"symbol",encodeEntry:xt=>encodeEntry(xt,"square")},rect={vgMark:"rect",encodeEntry:xt=>({...baseEncodeEntry(xt,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...rectPosition(xt,"x"),...rectPosition(xt,"y")})},rule={vgMark:"rule",encodeEntry:xt=>{const{markDef:$t}=xt,Ct=$t.orient;return!xt.encoding.x&&!xt.encoding.y&&!xt.encoding.latitude&&!xt.encoding.longitude?{}:{...baseEncodeEntry(xt,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...pointOrRangePosition("x",xt,{defaultPos:Ct==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:Ct!=="vertical"}),...pointOrRangePosition("y",xt,{defaultPos:Ct==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:Ct!=="horizontal"}),...nonPosition("size",xt,{vgChannel:"strokeWidth"})}}},text={vgMark:"text",encodeEntry:xt=>{const{config:$t,encoding:Ct}=xt;return{...baseEncodeEntry(xt,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...pointPosition("x",xt,{defaultPos:"mid"}),...pointPosition("y",xt,{defaultPos:"mid"}),...text$1(xt),...nonPosition("size",xt,{vgChannel:"fontSize"}),...nonPosition("angle",xt),...valueIfDefined("align",align(xt.markDef,Ct,$t)),...valueIfDefined("baseline",baseline(xt.markDef,Ct,$t)),...pointPosition("radius",xt,{defaultPos:null}),...pointPosition("theta",xt,{defaultPos:null})}}};function align(xt,$t,Ct){if(getMarkPropOrConfig("align",xt,Ct)===void 0)return"center"}function baseline(xt,$t,Ct){if(getMarkPropOrConfig("baseline",xt,Ct)===void 0)return"middle"}const tick={vgMark:"rect",encodeEntry:xt=>{const{config:$t,markDef:Ct}=xt,kt=Ct.orient,Mt=kt==="horizontal"?"width":"height",Ft=kt==="horizontal"?"height":"width";return{...baseEncodeEntry(xt,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...pointPosition("x",xt,{defaultPos:"mid",vgChannel:"xc"}),...pointPosition("y",xt,{defaultPos:"mid",vgChannel:"yc"}),...nonPosition("size",xt,{defaultValue:defaultSize(xt),vgChannel:Mt}),[Ft]:signalOrValueRef(getMarkPropOrConfig("thickness",Ct,$t))}}};function defaultSize(xt){const{config:$t,markDef:Ct}=xt,{orient:kt}=Ct,Mt=kt==="horizontal"?"width":"height",Ft=xt.getScaleComponent(kt==="horizontal"?"x":"y"),jt=getMarkPropOrConfig("size",Ct,$t,{vgChannel:Mt})??$t.tick.bandSize;if(jt!==void 0)return jt;{const Bt=Ft?Ft.get("range"):void 0;return Bt&&isVgRangeStep(Bt)&&isNumber$1(Bt.step)?Bt.step*3/4:getViewConfigDiscreteStep($t.view,Mt)*3/4}}const markCompiler={arc,area,bar,circle,geoshape,image,line,point,rect,rule,square,text,tick,trail};function parseMarkGroups(xt){if(contains([LINE,AREA,TRAIL],xt.mark)){const $t=pathGroupingFields(xt.mark,xt.encoding);if($t.length>0)return getPathGroups(xt,$t)}else if(xt.mark===BAR){const $t=VG_CORNERRADIUS_CHANNELS.some(Ct=>getMarkPropOrConfig(Ct,xt.markDef,xt.config));if(xt.stack&&!xt.fieldDef("size")&&$t)return getGroupsForStackedBarWithCornerRadius(xt)}return getMarkGroup(xt)}const FACETED_PATH_PREFIX="faceted_path_";function getPathGroups(xt,$t){return[{name:xt.getName("pathgroup"),type:"group",from:{facet:{name:FACETED_PATH_PREFIX+xt.requestDataName(DataSourceType.Main),data:xt.requestDataName(DataSourceType.Main),groupby:$t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:getMarkGroup(xt,{fromPrefix:FACETED_PATH_PREFIX})}]}const STACK_GROUP_PREFIX="stack_group_";function getGroupsForStackedBarWithCornerRadius(xt){var zt;const[$t]=getMarkGroup(xt,{fromPrefix:STACK_GROUP_PREFIX}),Ct=xt.scaleName(xt.stack.fieldChannel),kt=(Ht={})=>xt.vgField(xt.stack.fieldChannel,Ht),Mt=(Ht,Gt)=>{const qt=[kt({prefix:"min",suffix:"start",expr:Gt}),kt({prefix:"max",suffix:"start",expr:Gt}),kt({prefix:"min",suffix:"end",expr:Gt}),kt({prefix:"max",suffix:"end",expr:Gt})];return`${Ht}(${qt.map(Wt=>`scale('${Ct}',${Wt})`).join(",")})`};let Ft,jt;xt.stack.fieldChannel==="x"?(Ft={...pick($t.encode.update,["y","yc","y2","height",...VG_CORNERRADIUS_CHANNELS]),x:{signal:Mt("min","datum")},x2:{signal:Mt("max","datum")},clip:{value:!0}},jt={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},$t.encode.update={...omit($t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(Ft={...pick($t.encode.update,["x","xc","x2","width"]),y:{signal:Mt("min","datum")},y2:{signal:Mt("max","datum")},clip:{value:!0}},jt={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},$t.encode.update={...omit($t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const Ht of VG_CORNERRADIUS_CHANNELS){const Gt=getMarkConfig(Ht,xt.markDef,xt.config);$t.encode.update[Ht]?(Ft[Ht]=$t.encode.update[Ht],delete $t.encode.update[Ht]):Gt&&(Ft[Ht]=signalOrValueRef(Gt)),Gt&&($t.encode.update[Ht]={value:0})}const Bt=[];if(((zt=xt.stack.groupbyChannels)==null?void 0:zt.length)>0)for(const Ht of xt.stack.groupbyChannels){const Gt=xt.fieldDef(Ht),qt=vgField(Gt);qt&&Bt.push(qt),(Gt!=null&&Gt.bin||Gt!=null&&Gt.timeUnit)&&Bt.push(vgField(Gt,{binSuffix:"end"}))}return Ft=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((Ht,Gt)=>{if($t.encode.update[Gt])return{...Ht,[Gt]:$t.encode.update[Gt]};{const qt=getMarkConfig(Gt,xt.markDef,xt.config);return qt!==void 0?{...Ht,[Gt]:signalOrValueRef(qt)}:Ht}},Ft),Ft.stroke&&(Ft.strokeForeground={value:!0},Ft.strokeOffset={value:0}),[{type:"group",from:{facet:{data:xt.requestDataName(DataSourceType.Main),name:STACK_GROUP_PREFIX+xt.requestDataName(DataSourceType.Main),groupby:Bt,aggregate:{fields:[kt({suffix:"start"}),kt({suffix:"start"}),kt({suffix:"end"}),kt({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:Ft},marks:[{type:"group",encode:{update:jt},marks:[$t]}]}]}function getSort(xt){var Bt;const{encoding:$t,stack:Ct,mark:kt,markDef:Mt,config:Ft}=xt,jt=$t.order;if(!(!isArray(jt)&&isValueDef(jt)&&isNullOrFalse(jt.value)||!jt&&isNullOrFalse(getMarkPropOrConfig("order",Mt,Ft)))){if((isArray(jt)||isFieldDef(jt))&&!Ct)return sortParams(jt,{expr:"datum"});if(isPathMark(kt)){const Vt=Mt.orient==="horizontal"?"y":"x",zt=$t[Vt];if(isFieldDef(zt)){const Ht=zt.sort;if(isArray(Ht))return{field:vgField(zt,{prefix:Vt,suffix:"sort_index",expr:"datum"})};if(isSortField(Ht))return{field:vgField({aggregate:isAggregate$1(xt.encoding)?Ht.op:void 0,field:Ht.field},{expr:"datum"})};if(isSortByEncoding(Ht)){const Gt=xt.fieldDef(Ht.encoding);return{field:vgField(Gt,{expr:"datum"}),order:Ht.order}}else return Ht===null?void 0:{field:vgField(zt,{binSuffix:(Bt=xt.stack)!=null&&Bt.impute?"mid":void 0,expr:"datum"})}}return}}}function getMarkGroup(xt,$t={fromPrefix:""}){const{mark:Ct,markDef:kt,encoding:Mt,config:Ft}=xt,jt=getFirstDefined(kt.clip,scaleClip(xt),projectionClip(xt)),Bt=getStyles(kt),Vt=Mt.key,zt=getSort(xt),Ht=interactiveFlag(xt),Gt=getMarkPropOrConfig("aria",kt,Ft),qt=markCompiler[Ct].postEncodingTransform?markCompiler[Ct].postEncodingTransform(xt):null;return[{name:xt.getName("marks"),type:markCompiler[Ct].vgMark,...jt?{clip:jt}:{},...Bt?{style:Bt}:{},...Vt?{key:Vt.field}:{},...zt?{sort:zt}:{},...Ht||{},...Gt===!1?{aria:Gt}:{},from:{data:$t.fromPrefix+xt.requestDataName(DataSourceType.Main)},encode:{update:markCompiler[Ct].encodeEntry(xt)},...qt?{transform:qt}:{}}]}function scaleClip(xt){const $t=xt.getScaleComponent("x"),Ct=xt.getScaleComponent("y");return $t!=null&&$t.get("selectionExtent")||Ct!=null&&Ct.get("selectionExtent")?!0:void 0}function projectionClip(xt){const $t=xt.component.projection;return $t&&!$t.isFit?!0:void 0}function interactiveFlag(xt){if(!xt.component.selection)return null;const $t=keys(xt.component.selection).length;let Ct=$t,kt=xt.parent;for(;kt&&Ct===0;)Ct=keys(kt.component.selection).length,kt=kt.parent;return Ct?{interactive:$t>0||xt.mark==="geoshape"||!!xt.encoding.tooltip||!!xt.markDef.tooltip}:null}class UnitModel extends ModelWithField{constructor($t,Ct,kt,Mt={},Ft){super($t,"unit",Ct,kt,Ft,void 0,isFrameMixins($t)?$t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const jt=isMarkDef($t.mark)?{...$t.mark}:{type:$t.mark},Bt=jt.type;jt.filled===void 0&&(jt.filled=defaultFilled(jt,Ft,{graticule:$t.data&&isGraticuleGenerator($t.data)}));const Vt=this.encoding=initEncoding($t.encoding||{},Bt,jt.filled,Ft);this.markDef=initMarkdef(jt,Vt,Ft),this.size=initLayoutSize({encoding:Vt,size:isFrameMixins($t)?{...Mt,...$t.width?{width:$t.width}:{},...$t.height?{height:$t.height}:{}}:Mt}),this.stack=stack(this.markDef,Vt),this.specifiedScales=this.initScales(Bt,Vt),this.specifiedAxes=this.initAxes(Vt),this.specifiedLegends=this.initLegends(Vt),this.specifiedProjection=$t.projection,this.selection=($t.params??[]).filter(zt=>isSelectionParameter(zt))}get hasProjection(){const{encoding:$t}=this,Ct=this.mark===GEOSHAPE,kt=$t&&GEOPOSITION_CHANNELS.some(Mt=>isFieldOrDatumDef($t[Mt]));return Ct||kt}scaleDomain($t){const Ct=this.specifiedScales[$t];return Ct?Ct.domain:void 0}axis($t){return this.specifiedAxes[$t]}legend($t){return this.specifiedLegends[$t]}initScales($t,Ct){return SCALE_CHANNELS.reduce((kt,Mt)=>{const Ft=getFieldOrDatumDef(Ct[Mt]);return Ft&&(kt[Mt]=this.initScale(Ft.scale??{})),kt},{})}initScale($t){const{domain:Ct,range:kt}=$t,Mt=replaceExprRef($t);return isArray(Ct)&&(Mt.domain=Ct.map(signalRefOrValue)),isArray(kt)&&(Mt.range=kt.map(signalRefOrValue)),Mt}initAxes($t){return POSITION_SCALE_CHANNELS.reduce((Ct,kt)=>{const Mt=$t[kt];if(isFieldOrDatumDef(Mt)||kt===X&&isFieldOrDatumDef($t.x2)||kt===Y&&isFieldOrDatumDef($t.y2)){const Ft=isFieldOrDatumDef(Mt)?Mt.axis:void 0;Ct[kt]=Ft&&this.initAxis({...Ft})}return Ct},{})}initAxis($t){const Ct=keys($t),kt={};for(const Mt of Ct){const Ft=$t[Mt];kt[Mt]=isConditionalAxisValue(Ft)?signalOrValueRefWithCondition(Ft):signalRefOrValue(Ft)}return kt}initLegends($t){return NONPOSITION_SCALE_CHANNELS.reduce((Ct,kt)=>{const Mt=getFieldOrDatumDef($t[kt]);if(Mt&&supportLegend(kt)){const Ft=Mt.legend;Ct[kt]=Ft&&replaceExprRef(Ft)}return Ct},{})}parseData(){this.component.data=parseData(this)}parseLayoutSize(){parseUnitLayoutSize(this)}parseSelections(){this.component.selection=parseUnitSelection(this,this.selection)}parseMarkGroup(){this.component.mark=parseMarkGroups(this)}parseAxesAndHeaders(){this.component.axes=parseUnitAxes(this)}assembleSelectionTopLevelSignals($t){return assembleTopLevelSignals(this,$t)}assembleSignals(){return[...assembleAxisSignals(this),...assembleUnitSelectionSignals(this,[])]}assembleSelectionData($t){return assembleUnitSelectionData(this,$t)}assembleLayout(){return null}assembleLayoutSignals(){return assembleLayoutSignals(this)}assembleMarks(){let $t=this.component.mark??[];return(!this.parent||!isLayerModel(this.parent))&&($t=assembleUnitSelectionMarks(this,$t)),$t.map(this.correctDataNames)}assembleGroupStyle(){const{style:$t}=this.view||{};return $t!==void 0?$t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField($t){return channelHasField(this.encoding,$t)}fieldDef($t){const Ct=this.encoding[$t];return getFieldDef(Ct)}typedFieldDef($t){const Ct=this.fieldDef($t);return isTypedFieldDef(Ct)?Ct:null}}class LayerModel extends Model{constructor($t,Ct,kt,Mt,Ft){super($t,"layer",Ct,kt,Ft,$t.resolve,$t.view);const jt={...Mt,...$t.width?{width:$t.width}:{},...$t.height?{height:$t.height}:{}};this.children=$t.layer.map((Bt,Vt)=>{if(isLayerSpec(Bt))return new LayerModel(Bt,this,this.getName(`layer_${Vt}`),jt,Ft);if(isUnitSpec(Bt))return new UnitModel(Bt,this,this.getName(`layer_${Vt}`),jt,Ft);throw new Error(invalidSpec(Bt))})}parseData(){this.component.data=parseData(this);for(const $t of this.children)$t.parseData()}parseLayoutSize(){parseLayerLayoutSize(this)}parseSelections(){this.component.selection={};for(const $t of this.children){$t.parseSelections();for(const Ct of keys($t.component.selection))this.component.selection[Ct]=$t.component.selection[Ct]}}parseMarkGroup(){for(const $t of this.children)$t.parseMarkGroup()}parseAxesAndHeaders(){parseLayerAxes(this)}assembleSelectionTopLevelSignals($t){return this.children.reduce((Ct,kt)=>kt.assembleSelectionTopLevelSignals(Ct),$t)}assembleSignals(){return this.children.reduce(($t,Ct)=>$t.concat(Ct.assembleSignals()),assembleAxisSignals(this))}assembleLayoutSignals(){return this.children.reduce(($t,Ct)=>$t.concat(Ct.assembleLayoutSignals()),assembleLayoutSignals(this))}assembleSelectionData($t){return this.children.reduce((Ct,kt)=>kt.assembleSelectionData(Ct),$t)}assembleGroupStyle(){const $t=new Set;for(const kt of this.children)for(const Mt of array$2(kt.assembleGroupStyle()))$t.add(Mt);const Ct=Array.from($t);return Ct.length>1?Ct:Ct.length===1?Ct[0]:void 0}assembleTitle(){let $t=super.assembleTitle();if($t)return $t;for(const Ct of this.children)if($t=Ct.assembleTitle(),$t)return $t}assembleLayout(){return null}assembleMarks(){return assembleLayerSelectionMarks(this,this.children.flatMap($t=>$t.assembleMarks()))}assembleLegends(){return this.children.reduce(($t,Ct)=>$t.concat(Ct.assembleLegends()),assembleLegends(this))}}function buildModel(xt,$t,Ct,kt,Mt){if(isFacetSpec(xt))return new FacetModel(xt,$t,Ct,Mt);if(isLayerSpec(xt))return new LayerModel(xt,$t,Ct,kt,Mt);if(isUnitSpec(xt))return new UnitModel(xt,$t,Ct,kt,Mt);if(isAnyConcatSpec(xt))return new ConcatModel(xt,$t,Ct,Mt);throw new Error(invalidSpec(xt))}function compile(xt,$t={}){$t.logger&&set($t.logger),$t.fieldTitle&&setTitleFormatter($t.fieldTitle);try{const Ct=initConfig(mergeConfig($t.config,xt.config)),kt=normalize(xt,Ct),Mt=buildModel(kt,null,"",void 0,Ct);return Mt.parse(),optimizeDataflow(Mt.component.data,Mt),{spec:assembleTopLevelModel(Mt,getTopLevelProperties(xt,kt.autosize,Ct,Mt),xt.datasets,xt.usermeta),normalized:kt}}finally{$t.logger&&reset(),$t.fieldTitle&&resetTitleFormatter()}}function getTopLevelProperties(xt,$t,Ct,kt){const Mt=kt.component.layoutSize.get("width"),Ft=kt.component.layoutSize.get("height");if($t===void 0?($t={type:"pad"},kt.hasAxisOrientSignalRef()&&($t.resize=!0)):isString($t)&&($t={type:$t}),Mt&&Ft&&isFitType($t.type)){if(Mt==="step"&&Ft==="step")warn(droppingFit()),$t.type="pad";else if(Mt==="step"||Ft==="step"){const jt=Mt==="step"?"width":"height";warn(droppingFit(getPositionScaleChannel(jt)));const Bt=jt==="width"?"height":"width";$t.type=getFitType(Bt)}}return{...keys($t).length===1&&$t.type?$t.type==="pad"?{}:{autosize:$t.type}:{autosize:$t},...extractTopLevelProperties(Ct,!1),...extractTopLevelProperties(xt,!0)}}function assembleTopLevelModel(xt,$t,Ct={},kt){const Mt=xt.config?stripAndRedirectConfig(xt.config):void 0,Ft=[].concat(xt.assembleSelectionData([]),assembleRootData(xt.component.data,Ct)),jt=xt.assembleProjections(),Bt=xt.assembleTitle(),Vt=xt.assembleGroupStyle(),zt=xt.assembleGroupEncodeEntry(!0);let Ht=xt.assembleLayoutSignals();Ht=Ht.filter(Wt=>(Wt.name==="width"||Wt.name==="height")&&Wt.value!==void 0?($t[Wt.name]=+Wt.value,!1):!0);const{params:Gt,...qt}=$t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...xt.description?{description:xt.description}:{},...qt,...Bt?{title:Bt}:{},...Vt?{style:Vt}:{},...zt?{encode:{update:zt}}:{},data:Ft,...jt.length>0?{projections:jt}:{},...xt.assembleGroup([...Ht,...xt.assembleSelectionTopLevelSignals([]),...assembleParameterSignals(Gt)]),...Mt?{config:Mt}:{},...kt?{usermeta:kt}:{}}}const version$2=pkg$1.version,vegaLiteImport=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth,accessPathWithDatum,compile,contains,deepEqual,deleteNestedProperty,duplicate,entries:entries$1,every,fieldIntersection,flatAccessWithDatum,getFirstDefined,hasIntersection,hash,internalField,isBoolean,isEmpty,isEqual,isInternalField,isNullOrFalse,isNumeric,keys,logicalExpr,mergeDeep:mergeDeep$1,never,normalize,normalizeAngle,omit,pick,prefixGenerator,removePathFromField,replaceAll,replacePathInField,resetIdCounter,setEqual,some,stringify:stringify$1,titleCase,unique,uniqueId,vals,varName,version:version$2},Symbol.toStringTag,{value:"Module"}));function e(xt){const[$t,Ct]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(xt).slice(1,3);return{library:$t,version:Ct}}var name="vega-themes",version$1="2.15.0",description="Themes for stylized Vega and Vega-Lite visualizations.",keywords=["vega","vega-lite","themes","style"],license="BSD-3-Clause",author={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},contributors=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],main="build/vega-themes.js",module="build/vega-themes.module.js",unpkg="build/vega-themes.min.js",jsdelivr="build/vega-themes.min.js",types="build/vega-themes.module.d.ts",repository={type:"git",url:"https://github.com/vega/vega-themes.git"},files=["src","build"],scripts={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",format:"eslint . --fix",lint:"eslint .",release:"release-it"},devDependencies={"@babel/core":"^7.24.6","@babel/plugin-transform-runtime":"^7.24.6","@babel/preset-env":"^7.24.6","@babel/preset-typescript":"^7.24.6","@release-it/conventional-changelog":"^8.0.1","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4","@typescript-eslint/eslint-plugin":"^7.11.0","@typescript-eslint/parser":"^7.11.0","browser-sync":"^3.0.2",concurrently:"^8.2.2",eslint:"^8.45.0","eslint-config-prettier":"^9.1.0","eslint-plugin-prettier":"^5.1.3","gh-pages":"^6.1.1",prettier:"^3.2.5","release-it":"^17.3.0",rollup:"^4.18.0","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.4.5",typescript:"^5.4.5",vega:"^5.25.0","vega-lite":"^5.9.3"},peerDependencies={vega:"*","vega-lite":"*"},dependencies={},pkg={name,version:version$1,description,keywords,license,author,contributors,main,module,unpkg,jsdelivr,types,repository,files,scripts,devDependencies,peerDependencies,dependencies};const lightColor="#fff",medColor="#888",darkTheme={background:"#333",view:{stroke:medColor},title:{color:lightColor,subtitleColor:lightColor},style:{"guide-label":{fill:lightColor},"guide-title":{fill:lightColor}},axis:{domainColor:lightColor,gridColor:medColor,tickColor:lightColor}},markColor$7="#4572a7",excelTheme={background:"#fff",arc:{fill:markColor$7},area:{fill:markColor$7},line:{stroke:markColor$7,strokeWidth:2},path:{stroke:markColor$7},rect:{fill:markColor$7},shape:{stroke:markColor$7},symbol:{fill:markColor$7,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},markColor$6="#30a2da",axisColor$2="#cbcbcb",guideLabelColor="#999",guideTitleColor="#333",backgroundColor$2="#f0f0f0",blackTitle="#333",fiveThirtyEightTheme={arc:{fill:markColor$6},area:{fill:markColor$6},axis:{domainColor:axisColor$2,grid:!0,gridColor:axisColor$2,gridWidth:1,labelColor:guideLabelColor,labelFontSize:10,titleColor:guideTitleColor,tickColor:axisColor$2,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:backgroundColor$2,group:{fill:backgroundColor$2},legend:{labelColor:blackTitle,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:blackTitle,titleFontSize:14,titlePadding:10},line:{stroke:markColor$6,strokeWidth:2},path:{stroke:markColor$6,strokeWidth:.5},rect:{fill:markColor$6},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:markColor$6},bar:{binSpacing:2,fill:markColor$6,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},markColor$5="#000",ggplot2Theme={group:{fill:"#e5e5e5"},arc:{fill:markColor$5},area:{fill:markColor$5},line:{stroke:markColor$5},path:{stroke:markColor$5},rect:{fill:markColor$5},shape:{stroke:markColor$5},symbol:{fill:markColor$5,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},headlineFontSize=22,headlineFontWeight="normal",labelFont$1="Benton Gothic, sans-serif",labelFontSize=11.5,labelFontWeight="normal",markColor$4="#82c6df",titleFont="Benton Gothic Bold, sans-serif",titleFontWeight="normal",titleFontSize$1=13,colorSchemes$1={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},latimesTheme={background:"#ffffff",title:{anchor:"start",color:"#000000",font:titleFont,fontSize:headlineFontSize,fontWeight:headlineFontWeight},arc:{fill:markColor$4},area:{fill:markColor$4},line:{stroke:markColor$4,strokeWidth:2},path:{stroke:markColor$4},rect:{fill:markColor$4},shape:{stroke:markColor$4},symbol:{fill:markColor$4,size:30},axis:{labelFont:labelFont$1,labelFontSize,labelFontWeight,titleFont,titleFontSize:titleFontSize$1,titleFontWeight},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:labelFont$1,labelFontSize,symbolType:"square",titleFont,titleFontSize:titleFontSize$1,titleFontWeight},range:{category:colorSchemes$1["category-6"],diverging:colorSchemes$1["fireandice-6"],heatmap:colorSchemes$1["fire-7"],ordinal:colorSchemes$1["fire-7"],ramp:colorSchemes$1["fire-7"]}},markColor$3="#ab5787",axisColor$1="#979797",quartzTheme={background:"#f9f9f9",arc:{fill:markColor$3},area:{fill:markColor$3},line:{stroke:markColor$3},path:{stroke:markColor$3},rect:{fill:markColor$3},shape:{stroke:markColor$3},symbol:{fill:markColor$3,size:30},axis:{domainColor:axisColor$1,domainWidth:.5,gridWidth:.2,labelColor:axisColor$1,tickColor:axisColor$1,tickWidth:.2,titleColor:axisColor$1},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},markColor$2="#3e5c69",voxTheme={background:"#fff",arc:{fill:markColor$2},area:{fill:markColor$2},line:{stroke:markColor$2},path:{stroke:markColor$2},rect:{fill:markColor$2},shape:{stroke:markColor$2},symbol:{fill:markColor$2},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},markColor$1="#1696d2",axisColor="#000000",backgroundColor$1="#FFFFFF",font="Lato",labelFont="Lato",sourceFont="Lato",gridColor$1="#DEDDDD",titleFontSize=18,colorSchemes={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},urbanInstituteTheme={background:backgroundColor$1,title:{anchor:"start",fontSize:titleFontSize,font},axisX:{domain:!0,domainColor:axisColor,domainWidth:1,grid:!1,labelFontSize:12,labelFont,labelAngle:0,tickColor:axisColor,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:font},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:gridColor$1,gridWidth:1,labelFontSize:12,labelFont,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:font,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:font,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:colorSchemes["six-groups-cat-1"],diverging:colorSchemes["diverging-colors"],heatmap:colorSchemes["diverging-colors"],ordinal:colorSchemes["six-groups-seq"],ramp:colorSchemes["shades-blue"]},area:{fill:markColor$1},rect:{fill:markColor$1},line:{color:markColor$1,stroke:markColor$1,strokeWidth:5},trail:{color:markColor$1,stroke:markColor$1,strokeWidth:0,size:1},path:{stroke:markColor$1,strokeWidth:.5},point:{filled:!0},text:{font:sourceFont,color:markColor$1,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:markColor$1,stroke:null}},arc:{fill:markColor$1},shape:{stroke:markColor$1},symbol:{fill:markColor$1,size:30}},markColor="#3366CC",gridColor="#ccc",defaultFont$1="Arial, sans-serif",googlechartsTheme={arc:{fill:markColor},area:{fill:markColor},path:{stroke:markColor},rect:{fill:markColor},shape:{stroke:markColor},symbol:{stroke:markColor},circle:{fill:markColor},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:defaultFont$1,fontSize:12},"guide-title":{font:defaultFont$1,fontSize:12},"group-title":{font:defaultFont$1,fontSize:12}},title:{font:defaultFont$1,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor,tickColor:gridColor,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},ptToPx=xt=>xt*(1/3+1),fontSmallPx=ptToPx(9),legendFontPx=ptToPx(10),fontLargePx=ptToPx(12),fontStandard="Segoe UI",fontTitle="wf_standard-font, helvetica, arial, sans-serif",firstLevelElementColor="#252423",secondLevelElementColor="#605E5C",backgroundColor="transparent",backgroundSecondaryColor="#C8C6C4",paletteColor1="#118DFF",paletteColor2="#12239E",paletteColor3="#E66C37",paletteColor4="#6B007B",paletteColor5="#E044A7",paletteColor6="#744EC2",paletteColor7="#D9B300",paletteColor8="#D64550",divergentColorMax=paletteColor1,divergentColorMin="#DEEFFF",divergentPalette=[divergentColorMin,divergentColorMax],ordinalPalette=[divergentColorMin,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",divergentColorMax],powerbiTheme={view:{stroke:backgroundColor},background:backgroundColor,font:fontStandard,header:{titleFont:fontTitle,titleFontSize:fontLargePx,titleColor:firstLevelElementColor,labelFont:fontStandard,labelFontSize:legendFontPx,labelColor:secondLevelElementColor},axis:{ticks:!1,grid:!1,domain:!1,labelColor:secondLevelElementColor,labelFontSize:fontSmallPx,titleFont:fontTitle,titleColor:firstLevelElementColor,titleFontSize:fontLargePx,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:backgroundSecondaryColor,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:paletteColor1},line:{stroke:paletteColor1,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:fontStandard,fontSize:fontSmallPx,fill:secondLevelElementColor},arc:{fill:paletteColor1},area:{fill:paletteColor1,line:!0,opacity:.6},path:{stroke:paletteColor1},rect:{fill:paletteColor1},point:{fill:paletteColor1,filled:!0,size:75},shape:{stroke:paletteColor1},symbol:{fill:paletteColor1,strokeWidth:1.5,size:50},legend:{titleFont:fontStandard,titleFontWeight:"bold",titleColor:secondLevelElementColor,labelFont:fontStandard,labelFontSize:legendFontPx,labelColor:secondLevelElementColor,symbolType:"circle",symbolSize:75},range:{category:[paletteColor1,paletteColor2,paletteColor3,paletteColor4,paletteColor5,paletteColor6,paletteColor7,paletteColor8],diverging:divergentPalette,heatmap:divergentPalette,ordinal:ordinalPalette}},defaultFont='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',condensedFont='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',fontWeight=400,TOKENS={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},darkCategories=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],lightCategories=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function genCarbonConfig({theme:xt,background:$t}){const Ct=["white","g10"].includes(xt)?"light":"dark",kt=TOKENS.gridBg[xt],Mt=TOKENS.textPrimary[xt],Ft=TOKENS.textSecondary[xt],jt=Ct==="dark"?darkCategories:lightCategories,Bt=Ct==="dark"?"#d4bbff":"#6929c4";return{background:$t,arc:{fill:Bt},area:{fill:Bt},path:{stroke:Bt},rect:{fill:Bt},shape:{stroke:Bt},symbol:{stroke:Bt},circle:{fill:Bt},view:{fill:kt,stroke:kt},group:{fill:kt},title:{color:Mt,anchor:"start",dy:-15,fontSize:16,font:defaultFont,fontWeight:600},axis:{labelColor:Ft,labelFontSize:12,labelFont:condensedFont,labelFontWeight:fontWeight,titleColor:Mt,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:TOKENS.layerAccent01[xt],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:defaultFont,fill:Ft,fontWeight},"guide-title":{font:defaultFont,fill:Ft,fontWeight}},range:{category:jt,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const carbonwhite=genCarbonConfig({theme:"white",background:"#ffffff"}),carbong10=genCarbonConfig({theme:"g10",background:"#f4f4f4"}),carbong90=genCarbonConfig({theme:"g90",background:"#262626"}),carbong100=genCarbonConfig({theme:"g100",background:"#161616"}),version=pkg.version,themes=Object.freeze(Object.defineProperty({__proto__:null,carbong10,carbong100,carbong90,carbonwhite,dark:darkTheme,excel:excelTheme,fivethirtyeight:fiveThirtyEightTheme,ggplot2:ggplot2Theme,googlecharts:googlechartsTheme,latimes:latimesTheme,powerbi:powerbiTheme,quartz:quartzTheme,urbaninstitute:urbanInstituteTheme,version,vox:voxTheme},Symbol.toStringTag,{value:"Module"}));function formatValue(xt,$t,Ct,kt){if(isArray(xt))return`[${xt.map(Mt=>$t(isString(Mt)?Mt:stringify(Mt,Ct))).join(", ")}]`;if(isObject(xt)){let Mt="";const{title:Ft,image:jt,...Bt}=xt;Ft&&(Mt+=`<h2>${$t(Ft)}</h2>`),jt&&(Mt+=`<img src="${new URL($t(jt),kt||location.href).href}">`);const Vt=Object.keys(Bt);if(Vt.length>0){Mt+="<table>";for(const zt of Vt){let Ht=Bt[zt];Ht!==void 0&&(isObject(Ht)&&(Ht=stringify(Ht,Ct)),Mt+=`<tr><td class="key">${$t(zt)}</td><td class="value">${$t(Ht)}</td></tr>`)}Mt+="</table>"}return Mt||"{}"}return $t(xt)}function replacer(xt){const $t=[];return function(Ct,kt){if(typeof kt!="object"||kt===null)return kt;const Mt=$t.indexOf(this)+1;return $t.length=Mt,$t.length>xt?"[Object]":$t.indexOf(kt)>=0?"[Circular]":($t.push(kt),kt)}}function stringify(xt,$t){return JSON.stringify(xt,replacer($t))}var defaultStyle=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black;
}
#vg-tooltip-element.visible {
  visibility: visible;
}
#vg-tooltip-element h2 {
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 13px;
}
#vg-tooltip-element table {
  border-spacing: 0;
}
#vg-tooltip-element table tr {
  border: none;
}
#vg-tooltip-element table tr td {
  overflow: hidden;
  text-overflow: ellipsis;
  padding-top: 2px;
  padding-bottom: 2px;
}
#vg-tooltip-element table tr td.key {
  color: #808080;
  max-width: 150px;
  text-align: right;
  padding-right: 4px;
}
#vg-tooltip-element table tr td.value {
  display: block;
  max-width: 300px;
  max-height: 7em;
  text-align: left;
}
#vg-tooltip-element.dark-theme {
  background-color: rgba(32, 32, 32, 0.9);
  border: 1px solid #f5f5f5;
  color: white;
}
#vg-tooltip-element.dark-theme td.key {
  color: #bfbfbf;
}
`;const EL_ID="vg-tooltip-element",DEFAULT_OPTIONS={offsetX:10,offsetY:10,id:EL_ID,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:escapeHTML,maxDepth:2,formatTooltip:formatValue,baseURL:""};function escapeHTML(xt){return String(xt).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function createDefaultStyle(xt){if(!/^[A-Za-z]+[-:.\w]*$/.test(xt))throw new Error("Invalid HTML ID");return defaultStyle.toString().replace(EL_ID,xt)}function calculatePosition(xt,$t,Ct,kt){let Mt=xt.clientX+Ct;Mt+$t.width>window.innerWidth&&(Mt=+xt.clientX-Ct-$t.width);let Ft=xt.clientY+kt;return Ft+$t.height>window.innerHeight&&(Ft=+xt.clientY-kt-$t.height),{x:Mt,y:Ft}}class Handler{constructor($t){this.options={...DEFAULT_OPTIONS,...$t};const Ct=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const kt=document.createElement("style");kt.setAttribute("id",this.options.styleId),kt.innerHTML=createDefaultStyle(Ct);const Mt=document.head;Mt.childNodes.length>0?Mt.insertBefore(kt,Mt.childNodes[0]):Mt.appendChild(kt)}}tooltipHandler($t,Ct,kt,Mt){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(document.fullscreenElement??document.body).appendChild(this.el)),Mt==null||Mt===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(Mt,this.options.sanitize,this.options.maxDepth,this.options.baseURL),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:Ft,y:jt}=calculatePosition(Ct,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.style.top=`${jt}px`,this.el.style.left=`${Ft}px`}}var define_process_env_default={};function getDefaultExportFromCjs(xt){return xt&&xt.__esModule&&Object.prototype.hasOwnProperty.call(xt,"default")?xt.default:xt}var iterator,hasRequiredIterator;function requireIterator(){return hasRequiredIterator||(hasRequiredIterator=1,iterator=function(xt){xt.prototype[Symbol.iterator]=function*(){for(let $t=this.head;$t;$t=$t.next)yield $t.value}}),iterator}var yallist=Yallist$1;Yallist$1.Node=Node$1;Yallist$1.create=Yallist$1;function Yallist$1(xt){var $t=this;if($t instanceof Yallist$1||($t=new Yallist$1),$t.tail=null,$t.head=null,$t.length=0,xt&&typeof xt.forEach=="function")xt.forEach(function(Mt){$t.push(Mt)});else if(arguments.length>0)for(var Ct=0,kt=arguments.length;Ct<kt;Ct++)$t.push(arguments[Ct]);return $t}Yallist$1.prototype.removeNode=function(xt){if(xt.list!==this)throw new Error("removing node which does not belong to this list");var $t=xt.next,Ct=xt.prev;return $t&&($t.prev=Ct),Ct&&(Ct.next=$t),xt===this.head&&(this.head=$t),xt===this.tail&&(this.tail=Ct),xt.list.length--,xt.next=null,xt.prev=null,xt.list=null,$t};Yallist$1.prototype.unshiftNode=function(xt){if(xt!==this.head){xt.list&&xt.list.removeNode(xt);var $t=this.head;xt.list=this,xt.next=$t,$t&&($t.prev=xt),this.head=xt,this.tail||(this.tail=xt),this.length++}};Yallist$1.prototype.pushNode=function(xt){if(xt!==this.tail){xt.list&&xt.list.removeNode(xt);var $t=this.tail;xt.list=this,xt.prev=$t,$t&&($t.next=xt),this.tail=xt,this.head||(this.head=xt),this.length++}};Yallist$1.prototype.push=function(){for(var xt=0,$t=arguments.length;xt<$t;xt++)push(this,arguments[xt]);return this.length};Yallist$1.prototype.unshift=function(){for(var xt=0,$t=arguments.length;xt<$t;xt++)unshift(this,arguments[xt]);return this.length};Yallist$1.prototype.pop=function(){if(this.tail){var xt=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,xt}};Yallist$1.prototype.shift=function(){if(this.head){var xt=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,xt}};Yallist$1.prototype.forEach=function(xt,$t){$t=$t||this;for(var Ct=this.head,kt=0;Ct!==null;kt++)xt.call($t,Ct.value,kt,this),Ct=Ct.next};Yallist$1.prototype.forEachReverse=function(xt,$t){$t=$t||this;for(var Ct=this.tail,kt=this.length-1;Ct!==null;kt--)xt.call($t,Ct.value,kt,this),Ct=Ct.prev};Yallist$1.prototype.get=function(xt){for(var $t=0,Ct=this.head;Ct!==null&&$t<xt;$t++)Ct=Ct.next;if($t===xt&&Ct!==null)return Ct.value};Yallist$1.prototype.getReverse=function(xt){for(var $t=0,Ct=this.tail;Ct!==null&&$t<xt;$t++)Ct=Ct.prev;if($t===xt&&Ct!==null)return Ct.value};Yallist$1.prototype.map=function(xt,$t){$t=$t||this;for(var Ct=new Yallist$1,kt=this.head;kt!==null;)Ct.push(xt.call($t,kt.value,this)),kt=kt.next;return Ct};Yallist$1.prototype.mapReverse=function(xt,$t){$t=$t||this;for(var Ct=new Yallist$1,kt=this.tail;kt!==null;)Ct.push(xt.call($t,kt.value,this)),kt=kt.prev;return Ct};Yallist$1.prototype.reduce=function(xt,$t){var Ct,kt=this.head;if(arguments.length>1)Ct=$t;else if(this.head)kt=this.head.next,Ct=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var Mt=0;kt!==null;Mt++)Ct=xt(Ct,kt.value,Mt),kt=kt.next;return Ct};Yallist$1.prototype.reduceReverse=function(xt,$t){var Ct,kt=this.tail;if(arguments.length>1)Ct=$t;else if(this.tail)kt=this.tail.prev,Ct=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var Mt=this.length-1;kt!==null;Mt--)Ct=xt(Ct,kt.value,Mt),kt=kt.prev;return Ct};Yallist$1.prototype.toArray=function(){for(var xt=new Array(this.length),$t=0,Ct=this.head;Ct!==null;$t++)xt[$t]=Ct.value,Ct=Ct.next;return xt};Yallist$1.prototype.toArrayReverse=function(){for(var xt=new Array(this.length),$t=0,Ct=this.tail;Ct!==null;$t++)xt[$t]=Ct.value,Ct=Ct.prev;return xt};Yallist$1.prototype.slice=function(xt,$t){$t=$t||this.length,$t<0&&($t+=this.length),xt=xt||0,xt<0&&(xt+=this.length);var Ct=new Yallist$1;if($t<xt||$t<0)return Ct;xt<0&&(xt=0),$t>this.length&&($t=this.length);for(var kt=0,Mt=this.head;Mt!==null&&kt<xt;kt++)Mt=Mt.next;for(;Mt!==null&&kt<$t;kt++,Mt=Mt.next)Ct.push(Mt.value);return Ct};Yallist$1.prototype.sliceReverse=function(xt,$t){$t=$t||this.length,$t<0&&($t+=this.length),xt=xt||0,xt<0&&(xt+=this.length);var Ct=new Yallist$1;if($t<xt||$t<0)return Ct;xt<0&&(xt=0),$t>this.length&&($t=this.length);for(var kt=this.length,Mt=this.tail;Mt!==null&&kt>$t;kt--)Mt=Mt.prev;for(;Mt!==null&&kt>xt;kt--,Mt=Mt.prev)Ct.push(Mt.value);return Ct};Yallist$1.prototype.splice=function(xt,$t,...Ct){xt>this.length&&(xt=this.length-1),xt<0&&(xt=this.length+xt);for(var kt=0,Mt=this.head;Mt!==null&&kt<xt;kt++)Mt=Mt.next;for(var Ft=[],kt=0;Mt&&kt<$t;kt++)Ft.push(Mt.value),Mt=this.removeNode(Mt);Mt===null&&(Mt=this.tail),Mt!==this.head&&Mt!==this.tail&&(Mt=Mt.prev);for(var kt=0;kt<Ct.length;kt++)Mt=insert(this,Mt,Ct[kt]);return Ft};Yallist$1.prototype.reverse=function(){for(var xt=this.head,$t=this.tail,Ct=xt;Ct!==null;Ct=Ct.prev){var kt=Ct.prev;Ct.prev=Ct.next,Ct.next=kt}return this.head=$t,this.tail=xt,this};function insert(xt,$t,Ct){var kt=$t===xt.head?new Node$1(Ct,null,$t,xt):new Node$1(Ct,$t,$t.next,xt);return kt.next===null&&(xt.tail=kt),kt.prev===null&&(xt.head=kt),xt.length++,kt}function push(xt,$t){xt.tail=new Node$1($t,xt.tail,null,xt),xt.head||(xt.head=xt.tail),xt.length++}function unshift(xt,$t){xt.head=new Node$1($t,null,xt.head,xt),xt.tail||(xt.tail=xt.head),xt.length++}function Node$1(xt,$t,Ct,kt){if(!(this instanceof Node$1))return new Node$1(xt,$t,Ct,kt);this.list=kt,this.value=xt,$t?($t.next=this,this.prev=$t):this.prev=null,Ct?(Ct.prev=this,this.next=Ct):this.next=null}try{requireIterator()(Yallist$1)}catch(xt){}const Yallist=yallist,MAX=Symbol("max"),LENGTH=Symbol("length"),LENGTH_CALCULATOR=Symbol("lengthCalculator"),ALLOW_STALE=Symbol("allowStale"),MAX_AGE=Symbol("maxAge"),DISPOSE=Symbol("dispose"),NO_DISPOSE_ON_SET=Symbol("noDisposeOnSet"),LRU_LIST=Symbol("lruList"),CACHE=Symbol("cache"),UPDATE_AGE_ON_GET=Symbol("updateAgeOnGet"),naiveLength=()=>1;class LRUCache{constructor($t){if(typeof $t=="number"&&($t={max:$t}),$t||($t={}),$t.max&&(typeof $t.max!="number"||$t.max<0))throw new TypeError("max must be a non-negative number");this[MAX]=$t.max||1/0;const Ct=$t.length||naiveLength;if(this[LENGTH_CALCULATOR]=typeof Ct!="function"?naiveLength:Ct,this[ALLOW_STALE]=$t.stale||!1,$t.maxAge&&typeof $t.maxAge!="number")throw new TypeError("maxAge must be a number");this[MAX_AGE]=$t.maxAge||0,this[DISPOSE]=$t.dispose,this[NO_DISPOSE_ON_SET]=$t.noDisposeOnSet||!1,this[UPDATE_AGE_ON_GET]=$t.updateAgeOnGet||!1,this.reset()}set max($t){if(typeof $t!="number"||$t<0)throw new TypeError("max must be a non-negative number");this[MAX]=$t||1/0,trim(this)}get max(){return this[MAX]}set allowStale($t){this[ALLOW_STALE]=!!$t}get allowStale(){return this[ALLOW_STALE]}set maxAge($t){if(typeof $t!="number")throw new TypeError("maxAge must be a non-negative number");this[MAX_AGE]=$t,trim(this)}get maxAge(){return this[MAX_AGE]}set lengthCalculator($t){typeof $t!="function"&&($t=naiveLength),$t!==this[LENGTH_CALCULATOR]&&(this[LENGTH_CALCULATOR]=$t,this[LENGTH]=0,this[LRU_LIST].forEach(Ct=>{Ct.length=this[LENGTH_CALCULATOR](Ct.value,Ct.key),this[LENGTH]+=Ct.length})),trim(this)}get lengthCalculator(){return this[LENGTH_CALCULATOR]}get length(){return this[LENGTH]}get itemCount(){return this[LRU_LIST].length}rforEach($t,Ct){Ct=Ct||this;for(let kt=this[LRU_LIST].tail;kt!==null;){const Mt=kt.prev;forEachStep(this,$t,kt,Ct),kt=Mt}}forEach($t,Ct){Ct=Ct||this;for(let kt=this[LRU_LIST].head;kt!==null;){const Mt=kt.next;forEachStep(this,$t,kt,Ct),kt=Mt}}keys(){return this[LRU_LIST].toArray().map($t=>$t.key)}values(){return this[LRU_LIST].toArray().map($t=>$t.value)}reset(){this[DISPOSE]&&this[LRU_LIST]&&this[LRU_LIST].length&&this[LRU_LIST].forEach($t=>this[DISPOSE]($t.key,$t.value)),this[CACHE]=new Map,this[LRU_LIST]=new Yallist,this[LENGTH]=0}dump(){return this[LRU_LIST].map($t=>isStale(this,$t)?!1:{k:$t.key,v:$t.value,e:$t.now+($t.maxAge||0)}).toArray().filter($t=>$t)}dumpLru(){return this[LRU_LIST]}set($t,Ct,kt){if(kt=kt||this[MAX_AGE],kt&&typeof kt!="number")throw new TypeError("maxAge must be a number");const Mt=kt?Date.now():0,Ft=this[LENGTH_CALCULATOR](Ct,$t);if(this[CACHE].has($t)){if(Ft>this[MAX])return del(this,this[CACHE].get($t)),!1;const Vt=this[CACHE].get($t).value;return this[DISPOSE]&&(this[NO_DISPOSE_ON_SET]||this[DISPOSE]($t,Vt.value)),Vt.now=Mt,Vt.maxAge=kt,Vt.value=Ct,this[LENGTH]+=Ft-Vt.length,Vt.length=Ft,this.get($t),trim(this),!0}const jt=new Entry($t,Ct,Ft,Mt,kt);return jt.length>this[MAX]?(this[DISPOSE]&&this[DISPOSE]($t,Ct),!1):(this[LENGTH]+=jt.length,this[LRU_LIST].unshift(jt),this[CACHE].set($t,this[LRU_LIST].head),trim(this),!0)}has($t){if(!this[CACHE].has($t))return!1;const Ct=this[CACHE].get($t).value;return!isStale(this,Ct)}get($t){return get(this,$t,!0)}peek($t){return get(this,$t,!1)}pop(){const $t=this[LRU_LIST].tail;return $t?(del(this,$t),$t.value):null}del($t){del(this,this[CACHE].get($t))}load($t){this.reset();const Ct=Date.now();for(let kt=$t.length-1;kt>=0;kt--){const Mt=$t[kt],Ft=Mt.e||0;if(Ft===0)this.set(Mt.k,Mt.v);else{const jt=Ft-Ct;jt>0&&this.set(Mt.k,Mt.v,jt)}}}prune(){this[CACHE].forEach(($t,Ct)=>get(this,Ct,!1))}}const get=(xt,$t,Ct)=>{const kt=xt[CACHE].get($t);if(kt){const Mt=kt.value;if(isStale(xt,Mt)){if(del(xt,kt),!xt[ALLOW_STALE])return}else Ct&&(xt[UPDATE_AGE_ON_GET]&&(kt.value.now=Date.now()),xt[LRU_LIST].unshiftNode(kt));return Mt.value}},isStale=(xt,$t)=>{if(!$t||!$t.maxAge&&!xt[MAX_AGE])return!1;const Ct=Date.now()-$t.now;return $t.maxAge?Ct>$t.maxAge:xt[MAX_AGE]&&Ct>xt[MAX_AGE]},trim=xt=>{if(xt[LENGTH]>xt[MAX])for(let $t=xt[LRU_LIST].tail;xt[LENGTH]>xt[MAX]&&$t!==null;){const Ct=$t.prev;del(xt,$t),$t=Ct}},del=(xt,$t)=>{if($t){const Ct=$t.value;xt[DISPOSE]&&xt[DISPOSE](Ct.key,Ct.value),xt[LENGTH]-=Ct.length,xt[CACHE].delete(Ct.key),xt[LRU_LIST].removeNode($t)}};class Entry{constructor($t,Ct,kt,Mt,Ft){this.key=$t,this.value=Ct,this.length=kt,this.now=Mt,this.maxAge=Ft||0}}const forEachStep=(xt,$t,Ct,kt)=>{let Mt=Ct.value;isStale(xt,Mt)&&(del(xt,Ct),xt[ALLOW_STALE]||(Mt=void 0)),Mt&&$t.call(kt,Mt.value,Mt.key,xt)};var lruCache=LRUCache;const looseOption=Object.freeze({loose:!0}),emptyOpts=Object.freeze({}),parseOptions$1=xt=>xt?typeof xt!="object"?looseOption:xt:emptyOpts;var parseOptions_1=parseOptions$1,re$1={exports:{}};const SEMVER_SPEC_VERSION="2.0.0",MAX_LENGTH$1=256,MAX_SAFE_INTEGER$1=Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH=16,MAX_SAFE_BUILD_LENGTH=MAX_LENGTH$1-6,RELEASE_TYPES=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var constants={MAX_LENGTH:MAX_LENGTH$1,MAX_SAFE_COMPONENT_LENGTH,MAX_SAFE_BUILD_LENGTH,MAX_SAFE_INTEGER:MAX_SAFE_INTEGER$1,RELEASE_TYPES,SEMVER_SPEC_VERSION,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const debug$1=typeof process=="object"&&define_process_env_default&&define_process_env_default.NODE_DEBUG&&/\bsemver\b/i.test(define_process_env_default.NODE_DEBUG)?(...xt)=>console.error("SEMVER",...xt):()=>{};var debug_1=debug$1;(function(xt,$t){const{MAX_SAFE_COMPONENT_LENGTH:Ct,MAX_SAFE_BUILD_LENGTH:kt,MAX_LENGTH:Mt}=constants,Ft=debug_1;$t=xt.exports={};const jt=$t.re=[],Bt=$t.safeRe=[],Vt=$t.src=[],zt=$t.t={};let Ht=0;const Gt="[a-zA-Z0-9-]",qt=[["\\s",1],["\\d",Mt],[Gt,kt]],Wt=Kt=>{for(const[Xt,Qt]of qt)Kt=Kt.split(`${Xt}*`).join(`${Xt}{0,${Qt}}`).split(`${Xt}+`).join(`${Xt}{1,${Qt}}`);return Kt},Yt=(Kt,Xt,Qt)=>{const Jt=Wt(Xt),Zt=Ht++;Ft(Kt,Zt,Xt),zt[Kt]=Zt,Vt[Zt]=Xt,jt[Zt]=new RegExp(Xt,Qt?"g":void 0),Bt[Zt]=new RegExp(Jt,Qt?"g":void 0)};Yt("NUMERICIDENTIFIER","0|[1-9]\\d*"),Yt("NUMERICIDENTIFIERLOOSE","\\d+"),Yt("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Gt}*`),Yt("MAINVERSION",`(${Vt[zt.NUMERICIDENTIFIER]})\\.(${Vt[zt.NUMERICIDENTIFIER]})\\.(${Vt[zt.NUMERICIDENTIFIER]})`),Yt("MAINVERSIONLOOSE",`(${Vt[zt.NUMERICIDENTIFIERLOOSE]})\\.(${Vt[zt.NUMERICIDENTIFIERLOOSE]})\\.(${Vt[zt.NUMERICIDENTIFIERLOOSE]})`),Yt("PRERELEASEIDENTIFIER",`(?:${Vt[zt.NUMERICIDENTIFIER]}|${Vt[zt.NONNUMERICIDENTIFIER]})`),Yt("PRERELEASEIDENTIFIERLOOSE",`(?:${Vt[zt.NUMERICIDENTIFIERLOOSE]}|${Vt[zt.NONNUMERICIDENTIFIER]})`),Yt("PRERELEASE",`(?:-(${Vt[zt.PRERELEASEIDENTIFIER]}(?:\\.${Vt[zt.PRERELEASEIDENTIFIER]})*))`),Yt("PRERELEASELOOSE",`(?:-?(${Vt[zt.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${Vt[zt.PRERELEASEIDENTIFIERLOOSE]})*))`),Yt("BUILDIDENTIFIER",`${Gt}+`),Yt("BUILD",`(?:\\+(${Vt[zt.BUILDIDENTIFIER]}(?:\\.${Vt[zt.BUILDIDENTIFIER]})*))`),Yt("FULLPLAIN",`v?${Vt[zt.MAINVERSION]}${Vt[zt.PRERELEASE]}?${Vt[zt.BUILD]}?`),Yt("FULL",`^${Vt[zt.FULLPLAIN]}$`),Yt("LOOSEPLAIN",`[v=\\s]*${Vt[zt.MAINVERSIONLOOSE]}${Vt[zt.PRERELEASELOOSE]}?${Vt[zt.BUILD]}?`),Yt("LOOSE",`^${Vt[zt.LOOSEPLAIN]}$`),Yt("GTLT","((?:<|>)?=?)"),Yt("XRANGEIDENTIFIERLOOSE",`${Vt[zt.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),Yt("XRANGEIDENTIFIER",`${Vt[zt.NUMERICIDENTIFIER]}|x|X|\\*`),Yt("XRANGEPLAIN",`[v=\\s]*(${Vt[zt.XRANGEIDENTIFIER]})(?:\\.(${Vt[zt.XRANGEIDENTIFIER]})(?:\\.(${Vt[zt.XRANGEIDENTIFIER]})(?:${Vt[zt.PRERELEASE]})?${Vt[zt.BUILD]}?)?)?`),Yt("XRANGEPLAINLOOSE",`[v=\\s]*(${Vt[zt.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Vt[zt.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Vt[zt.XRANGEIDENTIFIERLOOSE]})(?:${Vt[zt.PRERELEASELOOSE]})?${Vt[zt.BUILD]}?)?)?`),Yt("XRANGE",`^${Vt[zt.GTLT]}\\s*${Vt[zt.XRANGEPLAIN]}$`),Yt("XRANGELOOSE",`^${Vt[zt.GTLT]}\\s*${Vt[zt.XRANGEPLAINLOOSE]}$`),Yt("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Ct}})(?:\\.(\\d{1,${Ct}}))?(?:\\.(\\d{1,${Ct}}))?`),Yt("COERCE",`${Vt[zt.COERCEPLAIN]}(?:$|[^\\d])`),Yt("COERCEFULL",Vt[zt.COERCEPLAIN]+`(?:${Vt[zt.PRERELEASE]})?(?:${Vt[zt.BUILD]})?(?:$|[^\\d])`),Yt("COERCERTL",Vt[zt.COERCE],!0),Yt("COERCERTLFULL",Vt[zt.COERCEFULL],!0),Yt("LONETILDE","(?:~>?)"),Yt("TILDETRIM",`(\\s*)${Vt[zt.LONETILDE]}\\s+`,!0),$t.tildeTrimReplace="$1~",Yt("TILDE",`^${Vt[zt.LONETILDE]}${Vt[zt.XRANGEPLAIN]}$`),Yt("TILDELOOSE",`^${Vt[zt.LONETILDE]}${Vt[zt.XRANGEPLAINLOOSE]}$`),Yt("LONECARET","(?:\\^)"),Yt("CARETTRIM",`(\\s*)${Vt[zt.LONECARET]}\\s+`,!0),$t.caretTrimReplace="$1^",Yt("CARET",`^${Vt[zt.LONECARET]}${Vt[zt.XRANGEPLAIN]}$`),Yt("CARETLOOSE",`^${Vt[zt.LONECARET]}${Vt[zt.XRANGEPLAINLOOSE]}$`),Yt("COMPARATORLOOSE",`^${Vt[zt.GTLT]}\\s*(${Vt[zt.LOOSEPLAIN]})$|^$`),Yt("COMPARATOR",`^${Vt[zt.GTLT]}\\s*(${Vt[zt.FULLPLAIN]})$|^$`),Yt("COMPARATORTRIM",`(\\s*)${Vt[zt.GTLT]}\\s*(${Vt[zt.LOOSEPLAIN]}|${Vt[zt.XRANGEPLAIN]})`,!0),$t.comparatorTrimReplace="$1$2$3",Yt("HYPHENRANGE",`^\\s*(${Vt[zt.XRANGEPLAIN]})\\s+-\\s+(${Vt[zt.XRANGEPLAIN]})\\s*$`),Yt("HYPHENRANGELOOSE",`^\\s*(${Vt[zt.XRANGEPLAINLOOSE]})\\s+-\\s+(${Vt[zt.XRANGEPLAINLOOSE]})\\s*$`),Yt("STAR","(<|>)?=?\\s*\\*"),Yt("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),Yt("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(re$1,re$1.exports);var reExports=re$1.exports;const numeric=/^[0-9]+$/,compareIdentifiers$1=(xt,$t)=>{const Ct=numeric.test(xt),kt=numeric.test($t);return Ct&&kt&&(xt=+xt,$t=+$t),xt===$t?0:Ct&&!kt?-1:kt&&!Ct?1:xt<$t?-1:1},rcompareIdentifiers=(xt,$t)=>compareIdentifiers$1($t,xt);var identifiers={compareIdentifiers:compareIdentifiers$1,rcompareIdentifiers};const debug=debug_1,{MAX_LENGTH,MAX_SAFE_INTEGER}=constants,{safeRe:re,t}=reExports,parseOptions=parseOptions_1,{compareIdentifiers}=identifiers;let SemVer$1=class Cl{constructor($t,Ct){if(Ct=parseOptions(Ct),$t instanceof Cl){if($t.loose===!!Ct.loose&&$t.includePrerelease===!!Ct.includePrerelease)return $t;$t=$t.version}else if(typeof $t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof $t}".`);if($t.length>MAX_LENGTH)throw new TypeError(`version is longer than ${MAX_LENGTH} characters`);debug("SemVer",$t,Ct),this.options=Ct,this.loose=!!Ct.loose,this.includePrerelease=!!Ct.includePrerelease;const kt=$t.trim().match(Ct.loose?re[t.LOOSE]:re[t.FULL]);if(!kt)throw new TypeError(`Invalid Version: ${$t}`);if(this.raw=$t,this.major=+kt[1],this.minor=+kt[2],this.patch=+kt[3],this.major>MAX_SAFE_INTEGER||this.major<0)throw new TypeError("Invalid major version");if(this.minor>MAX_SAFE_INTEGER||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>MAX_SAFE_INTEGER||this.patch<0)throw new TypeError("Invalid patch version");kt[4]?this.prerelease=kt[4].split(".").map(Mt=>{if(/^[0-9]+$/.test(Mt)){const Ft=+Mt;if(Ft>=0&&Ft<MAX_SAFE_INTEGER)return Ft}return Mt}):this.prerelease=[],this.build=kt[5]?kt[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare($t){if(debug("SemVer.compare",this.version,this.options,$t),!($t instanceof Cl)){if(typeof $t=="string"&&$t===this.version)return 0;$t=new Cl($t,this.options)}return $t.version===this.version?0:this.compareMain($t)||this.comparePre($t)}compareMain($t){return $t instanceof Cl||($t=new Cl($t,this.options)),compareIdentifiers(this.major,$t.major)||compareIdentifiers(this.minor,$t.minor)||compareIdentifiers(this.patch,$t.patch)}comparePre($t){if($t instanceof Cl||($t=new Cl($t,this.options)),this.prerelease.length&&!$t.prerelease.length)return-1;if(!this.prerelease.length&&$t.prerelease.length)return 1;if(!this.prerelease.length&&!$t.prerelease.length)return 0;let Ct=0;do{const kt=this.prerelease[Ct],Mt=$t.prerelease[Ct];if(debug("prerelease compare",Ct,kt,Mt),kt===void 0&&Mt===void 0)return 0;if(Mt===void 0)return 1;if(kt===void 0)return-1;if(kt===Mt)continue;return compareIdentifiers(kt,Mt)}while(++Ct)}compareBuild($t){$t instanceof Cl||($t=new Cl($t,this.options));let Ct=0;do{const kt=this.build[Ct],Mt=$t.build[Ct];if(debug("prerelease compare",Ct,kt,Mt),kt===void 0&&Mt===void 0)return 0;if(Mt===void 0)return 1;if(kt===void 0)return-1;if(kt===Mt)continue;return compareIdentifiers(kt,Mt)}while(++Ct)}inc($t,Ct,kt){switch($t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",Ct,kt);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",Ct,kt);break;case"prepatch":this.prerelease.length=0,this.inc("patch",Ct,kt),this.inc("pre",Ct,kt);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",Ct,kt),this.inc("pre",Ct,kt);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const Mt=Number(kt)?1:0;if(!Ct&&kt===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[Mt];else{let Ft=this.prerelease.length;for(;--Ft>=0;)typeof this.prerelease[Ft]=="number"&&(this.prerelease[Ft]++,Ft=-2);if(Ft===-1){if(Ct===this.prerelease.join(".")&&kt===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(Mt)}}if(Ct){let Ft=[Ct,Mt];kt===!1&&(Ft=[Ct]),compareIdentifiers(this.prerelease[0],Ct)===0?isNaN(this.prerelease[1])&&(this.prerelease=Ft):this.prerelease=Ft}break}default:throw new Error(`invalid increment argument: ${$t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var semver=SemVer$1;const SemVer2=semver,compare$6=(xt,$t,Ct)=>new SemVer2(xt,Ct).compare(new SemVer2($t,Ct));var compare_1=compare$6;const compare$5=compare_1,eq$1=(xt,$t,Ct)=>compare$5(xt,$t,Ct)===0;var eq_1=eq$1;const compare$4=compare_1,neq$1=(xt,$t,Ct)=>compare$4(xt,$t,Ct)!==0;var neq_1=neq$1;const compare$3=compare_1,gt$1=(xt,$t,Ct)=>compare$3(xt,$t,Ct)>0;var gt_1=gt$1;const compare$2=compare_1,gte$1=(xt,$t,Ct)=>compare$2(xt,$t,Ct)>=0;var gte_1=gte$1;const compare$1=compare_1,lt$1=(xt,$t,Ct)=>compare$1(xt,$t,Ct)<0;var lt_1=lt$1;const compare=compare_1,lte$1=(xt,$t,Ct)=>compare(xt,$t,Ct)<=0;var lte_1=lte$1;const eq=eq_1,neq=neq_1,gt=gt_1,gte=gte_1,lt=lt_1,lte=lte_1,cmp=(xt,$t,Ct,kt)=>{switch($t){case"===":return typeof xt=="object"&&(xt=xt.version),typeof Ct=="object"&&(Ct=Ct.version),xt===Ct;case"!==":return typeof xt=="object"&&(xt=xt.version),typeof Ct=="object"&&(Ct=Ct.version),xt!==Ct;case"":case"=":case"==":return eq(xt,Ct,kt);case"!=":return neq(xt,Ct,kt);case">":return gt(xt,Ct,kt);case">=":return gte(xt,Ct,kt);case"<":return lt(xt,Ct,kt);case"<=":return lte(xt,Ct,kt);default:throw new TypeError(`Invalid operator: ${$t}`)}};var cmp_1=cmp,comparator,hasRequiredComparator;function requireComparator(){if(hasRequiredComparator)return comparator;hasRequiredComparator=1;const xt=Symbol("SemVer ANY");class $t{static get ANY(){return xt}constructor(Ht,Gt){if(Gt=Ct(Gt),Ht instanceof $t){if(Ht.loose===!!Gt.loose)return Ht;Ht=Ht.value}Ht=Ht.trim().split(/\s+/).join(" "),jt("comparator",Ht,Gt),this.options=Gt,this.loose=!!Gt.loose,this.parse(Ht),this.semver===xt?this.value="":this.value=this.operator+this.semver.version,jt("comp",this)}parse(Ht){const Gt=this.options.loose?kt[Mt.COMPARATORLOOSE]:kt[Mt.COMPARATOR],qt=Ht.match(Gt);if(!qt)throw new TypeError(`Invalid comparator: ${Ht}`);this.operator=qt[1]!==void 0?qt[1]:"",this.operator==="="&&(this.operator=""),qt[2]?this.semver=new Bt(qt[2],this.options.loose):this.semver=xt}toString(){return this.value}test(Ht){if(jt("Comparator.test",Ht,this.options.loose),this.semver===xt||Ht===xt)return!0;if(typeof Ht=="string")try{Ht=new Bt(Ht,this.options)}catch{return!1}return Ft(Ht,this.operator,this.semver,this.options)}intersects(Ht,Gt){if(!(Ht instanceof $t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Vt(Ht.value,Gt).test(this.value):Ht.operator===""?Ht.value===""?!0:new Vt(this.value,Gt).test(Ht.semver):(Gt=Ct(Gt),Gt.includePrerelease&&(this.value==="<0.0.0-0"||Ht.value==="<0.0.0-0")||!Gt.includePrerelease&&(this.value.startsWith("<0.0.0")||Ht.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&Ht.operator.startsWith(">")||this.operator.startsWith("<")&&Ht.operator.startsWith("<")||this.semver.version===Ht.semver.version&&this.operator.includes("=")&&Ht.operator.includes("=")||Ft(this.semver,"<",Ht.semver,Gt)&&this.operator.startsWith(">")&&Ht.operator.startsWith("<")||Ft(this.semver,">",Ht.semver,Gt)&&this.operator.startsWith("<")&&Ht.operator.startsWith(">")))}}comparator=$t;const Ct=parseOptions_1,{safeRe:kt,t:Mt}=reExports,Ft=cmp_1,jt=debug_1,Bt=semver,Vt=requireRange();return comparator}var range,hasRequiredRange;function requireRange(){if(hasRequiredRange)return range;hasRequiredRange=1;class xt{constructor(xn,Cn){if(Cn=kt(Cn),xn instanceof xt)return xn.loose===!!Cn.loose&&xn.includePrerelease===!!Cn.includePrerelease?xn:new xt(xn.raw,Cn);if(xn instanceof Mt)return this.raw=xn.value,this.set=[[xn]],this.format(),this;if(this.options=Cn,this.loose=!!Cn.loose,this.includePrerelease=!!Cn.includePrerelease,this.raw=xn.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map($n=>this.parseRange($n.trim())).filter($n=>$n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const $n=this.set[0];if(this.set=this.set.filter(wn=>!Yt(wn[0])),this.set.length===0)this.set=[$n];else if(this.set.length>1){for(const wn of this.set)if(wn.length===1&&Kt(wn[0])){this.set=[wn];break}}}this.format()}format(){return this.range=this.set.map(xn=>xn.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(xn){const $n=((this.options.includePrerelease&&qt)|(this.options.loose&&Wt))+":"+xn,wn=Ct.get($n);if(wn)return wn;const Rn=this.options.loose,Dn=Rn?Bt[Vt.HYPHENRANGELOOSE]:Bt[Vt.HYPHENRANGE];xn=xn.replace(Dn,gn(this.options.includePrerelease)),Ft("hyphen replace",xn),xn=xn.replace(Bt[Vt.COMPARATORTRIM],zt),Ft("comparator trim",xn),xn=xn.replace(Bt[Vt.TILDETRIM],Ht),Ft("tilde trim",xn),xn=xn.replace(Bt[Vt.CARETTRIM],Gt),Ft("caret trim",xn);let An=xn.split(" ").map(Tn=>Qt(Tn,this.options)).join(" ").split(/\s+/).map(Tn=>yn(Tn,this.options));Rn&&(An=An.filter(Tn=>(Ft("loose invalid filter",Tn,this.options),!!Tn.match(Bt[Vt.COMPARATORLOOSE])))),Ft("range list",An);const Sn=new Map,vn=An.map(Tn=>new Mt(Tn,this.options));for(const Tn of vn){if(Yt(Tn))return[Tn];Sn.set(Tn.value,Tn)}Sn.size>1&&Sn.has("")&&Sn.delete("");const _n=[...Sn.values()];return Ct.set($n,_n),_n}intersects(xn,Cn){if(!(xn instanceof xt))throw new TypeError("a Range is required");return this.set.some($n=>Xt($n,Cn)&&xn.set.some(wn=>Xt(wn,Cn)&&$n.every(Rn=>wn.every(Dn=>Rn.intersects(Dn,Cn)))))}test(xn){if(!xn)return!1;if(typeof xn=="string")try{xn=new jt(xn,this.options)}catch{return!1}for(let Cn=0;Cn<this.set.length;Cn++)if(En(this.set[Cn],xn,this.options))return!0;return!1}}range=xt;const $t=lruCache,Ct=new $t({max:1e3}),kt=parseOptions_1,Mt=requireComparator(),Ft=debug_1,jt=semver,{safeRe:Bt,t:Vt,comparatorTrimReplace:zt,tildeTrimReplace:Ht,caretTrimReplace:Gt}=reExports,{FLAG_INCLUDE_PRERELEASE:qt,FLAG_LOOSE:Wt}=constants,Yt=bn=>bn.value==="<0.0.0-0",Kt=bn=>bn.value==="",Xt=(bn,xn)=>{let Cn=!0;const $n=bn.slice();let wn=$n.pop();for(;Cn&&$n.length;)Cn=$n.every(Rn=>wn.intersects(Rn,xn)),wn=$n.pop();return Cn},Qt=(bn,xn)=>(Ft("comp",bn,xn),bn=ln(bn,xn),Ft("caret",bn),bn=Zt(bn,xn),Ft("tildes",bn),bn=hn(bn,xn),Ft("xrange",bn),bn=pn(bn,xn),Ft("stars",bn),bn),Jt=bn=>!bn||bn.toLowerCase()==="x"||bn==="*",Zt=(bn,xn)=>bn.trim().split(/\s+/).map(Cn=>sn(Cn,xn)).join(" "),sn=(bn,xn)=>{const Cn=xn.loose?Bt[Vt.TILDELOOSE]:Bt[Vt.TILDE];return bn.replace(Cn,($n,wn,Rn,Dn,An)=>{Ft("tilde",bn,$n,wn,Rn,Dn,An);let Sn;return Jt(wn)?Sn="":Jt(Rn)?Sn=`>=${wn}.0.0 <${+wn+1}.0.0-0`:Jt(Dn)?Sn=`>=${wn}.${Rn}.0 <${wn}.${+Rn+1}.0-0`:An?(Ft("replaceTilde pr",An),Sn=`>=${wn}.${Rn}.${Dn}-${An} <${wn}.${+Rn+1}.0-0`):Sn=`>=${wn}.${Rn}.${Dn} <${wn}.${+Rn+1}.0-0`,Ft("tilde return",Sn),Sn})},ln=(bn,xn)=>bn.trim().split(/\s+/).map(Cn=>dn(Cn,xn)).join(" "),dn=(bn,xn)=>{Ft("caret",bn,xn);const Cn=xn.loose?Bt[Vt.CARETLOOSE]:Bt[Vt.CARET],$n=xn.includePrerelease?"-0":"";return bn.replace(Cn,(wn,Rn,Dn,An,Sn)=>{Ft("caret",bn,wn,Rn,Dn,An,Sn);let vn;return Jt(Rn)?vn="":Jt(Dn)?vn=`>=${Rn}.0.0${$n} <${+Rn+1}.0.0-0`:Jt(An)?Rn==="0"?vn=`>=${Rn}.${Dn}.0${$n} <${Rn}.${+Dn+1}.0-0`:vn=`>=${Rn}.${Dn}.0${$n} <${+Rn+1}.0.0-0`:Sn?(Ft("replaceCaret pr",Sn),Rn==="0"?Dn==="0"?vn=`>=${Rn}.${Dn}.${An}-${Sn} <${Rn}.${Dn}.${+An+1}-0`:vn=`>=${Rn}.${Dn}.${An}-${Sn} <${Rn}.${+Dn+1}.0-0`:vn=`>=${Rn}.${Dn}.${An}-${Sn} <${+Rn+1}.0.0-0`):(Ft("no pr"),Rn==="0"?Dn==="0"?vn=`>=${Rn}.${Dn}.${An}${$n} <${Rn}.${Dn}.${+An+1}-0`:vn=`>=${Rn}.${Dn}.${An}${$n} <${Rn}.${+Dn+1}.0-0`:vn=`>=${Rn}.${Dn}.${An} <${+Rn+1}.0.0-0`),Ft("caret return",vn),vn})},hn=(bn,xn)=>(Ft("replaceXRanges",bn,xn),bn.split(/\s+/).map(Cn=>cn(Cn,xn)).join(" ")),cn=(bn,xn)=>{bn=bn.trim();const Cn=xn.loose?Bt[Vt.XRANGELOOSE]:Bt[Vt.XRANGE];return bn.replace(Cn,($n,wn,Rn,Dn,An,Sn)=>{Ft("xRange",bn,$n,wn,Rn,Dn,An,Sn);const vn=Jt(Rn),_n=vn||Jt(Dn),Tn=_n||Jt(An),Pn=Tn;return wn==="="&&Pn&&(wn=""),Sn=xn.includePrerelease?"-0":"",vn?wn===">"||wn==="<"?$n="<0.0.0-0":$n="*":wn&&Pn?(_n&&(Dn=0),An=0,wn===">"?(wn=">=",_n?(Rn=+Rn+1,Dn=0,An=0):(Dn=+Dn+1,An=0)):wn==="<="&&(wn="<",_n?Rn=+Rn+1:Dn=+Dn+1),wn==="<"&&(Sn="-0"),$n=`${wn+Rn}.${Dn}.${An}${Sn}`):_n?$n=`>=${Rn}.0.0${Sn} <${+Rn+1}.0.0-0`:Tn&&($n=`>=${Rn}.${Dn}.0${Sn} <${Rn}.${+Dn+1}.0-0`),Ft("xRange return",$n),$n})},pn=(bn,xn)=>(Ft("replaceStars",bn,xn),bn.trim().replace(Bt[Vt.STAR],"")),yn=(bn,xn)=>(Ft("replaceGTE0",bn,xn),bn.trim().replace(Bt[xn.includePrerelease?Vt.GTE0PRE:Vt.GTE0],"")),gn=bn=>(xn,Cn,$n,wn,Rn,Dn,An,Sn,vn,_n,Tn,Pn,Ln)=>(Jt($n)?Cn="":Jt(wn)?Cn=`>=${$n}.0.0${bn?"-0":""}`:Jt(Rn)?Cn=`>=${$n}.${wn}.0${bn?"-0":""}`:Dn?Cn=`>=${Cn}`:Cn=`>=${Cn}${bn?"-0":""}`,Jt(vn)?Sn="":Jt(_n)?Sn=`<${+vn+1}.0.0-0`:Jt(Tn)?Sn=`<${vn}.${+_n+1}.0-0`:Pn?Sn=`<=${vn}.${_n}.${Tn}-${Pn}`:bn?Sn=`<${vn}.${_n}.${+Tn+1}-0`:Sn=`<=${Sn}`,`${Cn} ${Sn}`.trim()),En=(bn,xn,Cn)=>{for(let $n=0;$n<bn.length;$n++)if(!bn[$n].test(xn))return!1;if(xn.prerelease.length&&!Cn.includePrerelease){for(let $n=0;$n<bn.length;$n++)if(Ft(bn[$n].semver),bn[$n].semver!==Mt.ANY&&bn[$n].semver.prerelease.length>0){const wn=bn[$n].semver;if(wn.major===xn.major&&wn.minor===xn.minor&&wn.patch===xn.patch)return!0}return!1}return!0};return range}const Range=requireRange(),satisfies=(xt,$t,Ct)=>{try{$t=new Range($t,Ct)}catch{return!1}return $t.test(xt)};var satisfies_1=satisfies,satisfies$1=getDefaultExportFromCjs(satisfies_1);function post(xt,$t,Ct){const kt=xt.open($t),Mt=1e4,Ft=250,{origin:jt}=new URL($t);let Bt=~~(Mt/Ft);function Vt(Ht){Ht.source===kt&&(Bt=0,xt.removeEventListener("message",Vt,!1))}xt.addEventListener("message",Vt,!1);function zt(){Bt<=0||(kt.postMessage(Ct,jt),setTimeout(zt,Ft),Bt-=1)}setTimeout(zt,Ft)}var embedStyle=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function mergeDeep(xt,...$t){for(const Ct of $t)deepMerge_(xt,Ct);return xt}function deepMerge_(xt,$t){for(const Ct of Object.keys($t))writeConfig(xt,Ct,$t[Ct],!0)}const vega=vegaImport;let vegaLite=vegaLiteImport;const w=typeof window<"u"?window:void 0;var ip;vegaLite===void 0&&((ip=w==null?void 0:w.vl)!=null&&ip.compile)&&(vegaLite=w.vl);const DEFAULT_ACTIONS={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},I18N={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},NAMES={vega:"Vega","vega-lite":"Vega-Lite"},VERSION={vega:vega.version,"vega-lite":vegaLite?vegaLite.version:"not available"},PREPROCESSOR={vega:xt=>xt,"vega-lite":(xt,$t)=>vegaLite.compile(xt,{config:$t}).spec},SVG_CIRCLES=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,CHART_WRAPPER_CLASS="chart-wrapper";function isTooltipHandler(xt){return typeof xt=="function"}function viewSource(xt,$t,Ct,kt){const Mt=`<html><head>${$t}</head><body><pre><code class="json">`,Ft=`</code></pre>${Ct}</body></html>`,jt=window.open("");jt.document.write(Mt+xt+Ft),jt.document.title=`${NAMES[kt]} JSON Source`}function guessMode(xt,$t){if(xt.$schema){const Ct=e(xt.$schema);$t&&$t!==Ct.library&&console.warn(`The given visualization spec is written in ${NAMES[Ct.library]}, but mode argument sets ${NAMES[$t]??$t}.`);const kt=Ct.library;return satisfies$1(VERSION[kt],`^${Ct.version.slice(1)}`)||console.warn(`The input spec uses ${NAMES[kt]} ${Ct.version}, but the current version of ${NAMES[kt]} is v${VERSION[kt]}.`),kt}return"mark"in xt||"encoding"in xt||"layer"in xt||"hconcat"in xt||"vconcat"in xt||"facet"in xt||"repeat"in xt?"vega-lite":"marks"in xt||"signals"in xt||"scales"in xt||"axes"in xt?"vega":$t??"vega"}function isLoader(xt){return!!(xt&&"load"in xt)}function createLoader(xt){return isLoader(xt)?xt:vega.loader(xt)}function embedOptionsFromUsermeta(xt){var Ct;const $t=((Ct=xt.usermeta)==null?void 0:Ct.embedOptions)??{};return isString($t.defaultStyle)&&($t.defaultStyle=!1),$t}async function embed(xt,$t,Ct={}){let kt,Mt;isString($t)?(Mt=createLoader(Ct.loader),kt=JSON.parse(await Mt.load($t))):kt=$t;const Ft=embedOptionsFromUsermeta(kt),jt=Ft.loader;(!Mt||jt)&&(Mt=createLoader(Ct.loader??jt));const Bt=await loadOpts(Ft,Mt),Vt=await loadOpts(Ct,Mt),zt={...mergeDeep(Vt,Bt),config:mergeConfig(Vt.config??{},Bt.config??{})};return await _embed(xt,kt,zt,Mt)}async function loadOpts(xt,$t){const Ct=isString(xt.config)?JSON.parse(await $t.load(xt.config)):xt.config??{},kt=isString(xt.patch)?JSON.parse(await $t.load(xt.patch)):xt.patch;return{...xt,...kt?{patch:kt}:{},...Ct?{config:Ct}:{}}}function getRoot(xt){const $t=xt.getRootNode?xt.getRootNode():document;return $t instanceof ShadowRoot?{root:$t,rootContainer:$t}:{root:document,rootContainer:document.head??document.body}}async function _embed(xt,$t,Ct={},kt){const Mt=Ct.theme?mergeConfig(themes[Ct.theme],Ct.config??{}):Ct.config,Ft=isBoolean$2(Ct.actions)?Ct.actions:mergeDeep({},DEFAULT_ACTIONS,Ct.actions??{}),jt={...I18N,...Ct.i18n},Bt=Ct.renderer??"canvas",Vt=Ct.logLevel??vega.Warn,zt=Ct.downloadFileName??"visualization",Ht=typeof xt=="string"?document.querySelector(xt):xt;if(!Ht)throw new Error(`${xt} does not exist`);if(Ct.defaultStyle!==!1){const ln="vega-embed-style",{root:dn,rootContainer:hn}=getRoot(Ht);if(!dn.getElementById(ln)){const cn=document.createElement("style");cn.id=ln,cn.innerHTML=Ct.defaultStyle===void 0||Ct.defaultStyle===!0?embedStyle.toString():Ct.defaultStyle,hn.appendChild(cn)}}const Gt=guessMode($t,Ct.mode);let qt=PREPROCESSOR[Gt]($t,Mt);if(Gt==="vega-lite"&&qt.$schema){const ln=e(qt.$schema);satisfies$1(VERSION.vega,`^${ln.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${ln.version}, but current version is v${VERSION.vega}.`)}Ht.classList.add("vega-embed"),Ft&&Ht.classList.add("has-actions"),Ht.innerHTML="";let Wt=Ht;if(Ft){const ln=document.createElement("div");ln.classList.add(CHART_WRAPPER_CLASS),Ht.appendChild(ln),Wt=ln}const Yt=Ct.patch;if(Yt&&(qt=Yt instanceof Function?Yt(qt):applyPatch(qt,Yt,!0,!1).newDocument),Ct.formatLocale&&vega.formatLocale(Ct.formatLocale),Ct.timeFormatLocale&&vega.timeFormatLocale(Ct.timeFormatLocale),Ct.expressionFunctions)for(const ln in Ct.expressionFunctions){const dn=Ct.expressionFunctions[ln];"fn"in dn?vega.expressionFunction(ln,dn.fn,dn.visitor):dn instanceof Function&&vega.expressionFunction(ln,dn)}const{ast:Kt}=Ct,Xt=vega.parse(qt,Gt==="vega-lite"?{}:Mt,{ast:Kt}),Qt=new(Ct.viewClass||vega.View)(Xt,{loader:kt,logLevel:Vt,renderer:Bt,...Kt?{expr:vega.expressionInterpreter??Ct.expr??expression$1}:{}});if(Qt.addSignalListener("autosize",(ln,dn)=>{const{type:hn}=dn;hn=="fit-x"?(Wt.classList.add("fit-x"),Wt.classList.remove("fit-y")):hn=="fit-y"?(Wt.classList.remove("fit-x"),Wt.classList.add("fit-y")):hn=="fit"?Wt.classList.add("fit-x","fit-y"):Wt.classList.remove("fit-x","fit-y")}),Ct.tooltip!==!1){const{loader:ln,tooltip:dn}=Ct,hn=ln&&!isLoader(ln)?ln==null?void 0:ln.baseURL:void 0,cn=isTooltipHandler(dn)?dn:new Handler({baseURL:hn,...dn===!0?{}:dn}).call;Qt.tooltip(cn)}let{hover:Jt}=Ct;if(Jt===void 0&&(Jt=Gt==="vega"),Jt){const{hoverSet:ln,updateSet:dn}=typeof Jt=="boolean"?{}:Jt;Qt.hover(ln,dn)}Ct&&(Ct.width!=null&&Qt.width(Ct.width),Ct.height!=null&&Qt.height(Ct.height),Ct.padding!=null&&Qt.padding(Ct.padding)),await Qt.initialize(Wt,Ct.bind).runAsync();let Zt;if(Ft!==!1){let ln=Ht;if(Ct.defaultStyle!==!1||Ct.forceActionsMenu){const hn=document.createElement("details");hn.title=jt.CLICK_TO_VIEW_ACTIONS,Ht.append(hn),ln=hn;const cn=document.createElement("summary");cn.innerHTML=SVG_CIRCLES,hn.append(cn),Zt=pn=>{hn.contains(pn.target)||hn.removeAttribute("open")},document.addEventListener("click",Zt)}const dn=document.createElement("div");if(ln.append(dn),dn.classList.add("vega-actions"),Ft===!0||Ft.export!==!1){for(const hn of["svg","png"])if(Ft===!0||Ft.export===!0||Ft.export[hn]){const cn=jt[`${hn.toUpperCase()}_ACTION`],pn=document.createElement("a"),yn=isObject(Ct.scaleFactor)?Ct.scaleFactor[hn]:Ct.scaleFactor;pn.text=cn,pn.href="#",pn.target="_blank",pn.download=`${zt}.${hn}`,pn.addEventListener("mousedown",async function(gn){gn.preventDefault();const En=await Qt.toImageURL(hn,yn);this.href=En}),dn.append(pn)}}if(Ft===!0||Ft.source!==!1){const hn=document.createElement("a");hn.text=jt.SOURCE_ACTION,hn.href="#",hn.addEventListener("click",function(cn){viewSource(stringify$2($t),Ct.sourceHeader??"",Ct.sourceFooter??"",Gt),cn.preventDefault()}),dn.append(hn)}if(Gt==="vega-lite"&&(Ft===!0||Ft.compiled!==!1)){const hn=document.createElement("a");hn.text=jt.COMPILED_ACTION,hn.href="#",hn.addEventListener("click",function(cn){viewSource(stringify$2(qt),Ct.sourceHeader??"",Ct.sourceFooter??"","vega"),cn.preventDefault()}),dn.append(hn)}if(Ft===!0||Ft.editor!==!1){const hn=Ct.editorUrl??"https://vega.github.io/editor/",cn=document.createElement("a");cn.text=jt.EDITOR_ACTION,cn.href="#",cn.addEventListener("click",function(pn){post(window,hn,{config:Mt,mode:Gt,renderer:Bt,spec:stringify$2($t)}),pn.preventDefault()}),dn.append(cn)}}function sn(){Zt&&document.removeEventListener("click",Zt),Qt.finalize()}return{view:Qt,spec:$t,vgSpec:qt,finalize:sn,embedOptions:Ct}}function isFunction(xt){return!!xt&&{}.toString.call(xt)==="[object Function]"}function updateSingleDatasetInView(xt,$t,Ct){Ct&&(isFunction(Ct)?Ct(xt.data($t)):xt.change($t,vega.changeset().remove(()=>!0).insert(Ct)))}function updateMultipleDatasetsInView(xt,$t){Object.keys($t).forEach(Ct=>{updateSingleDatasetInView(xt,Ct,$t[Ct])})}function getUniqueFieldNames(xt){const $t=new Set;return xt.forEach(Ct=>{Object.keys(Ct).forEach(kt=>{$t.add(kt)})}),$t}const NOOP=()=>{};function addSignalListenersToView(xt,$t){const Ct=Object.keys($t);return Ct.forEach(kt=>{try{xt.addSignalListener(kt,$t[kt])}catch(Mt){console.warn("Cannot add invalid signal listener.",Mt)}}),Ct.length>0}function computeSpecChanges(xt,$t){if(xt===$t)return!1;const Ct={width:!1,height:!1,isExpensive:!1},kt=getUniqueFieldNames([xt,$t]);return kt.has("width")&&(!("width"in xt)||!("width"in $t)||xt.width!==$t.width)&&("width"in xt&&typeof xt.width=="number"?Ct.width=xt.width:Ct.isExpensive=!0),kt.has("height")&&(!("height"in xt)||!("height"in $t)||xt.height!==$t.height)&&("height"in xt&&typeof xt.height=="number"?Ct.height=xt.height:Ct.isExpensive=!0),kt.delete("width"),kt.delete("height"),[...kt].some(Mt=>!(Mt in xt)||!(Mt in $t)||!equal$5(xt[Mt],$t[Mt]))&&(Ct.isExpensive=!0),Ct.width!==!1||Ct.height!==!1||Ct.isExpensive?Ct:!1}function removeSignalListenersFromView(xt,$t){const Ct=Object.keys($t);return Ct.forEach(kt=>{try{xt.removeSignalListener(kt,$t[kt])}catch(Mt){console.warn("Cannot remove invalid signal listener.",Mt)}}),Ct.length>0}function combineSpecWithDimension(xt){const{spec:$t,width:Ct,height:kt}=xt;return typeof Ct<"u"&&typeof kt<"u"?{...$t,width:Ct,height:kt}:typeof Ct<"u"?{...$t,width:Ct}:typeof kt<"u"?{...$t,height:kt}:$t}function _defineProperty$1(xt,$t,Ct){return $t in xt?Object.defineProperty(xt,$t,{value:Ct,enumerable:!0,configurable:!0,writable:!0}):xt[$t]=Ct,xt}class VegaEmbed extends React$1.PureComponent{constructor(){super(...arguments),_defineProperty$1(this,"containerRef",React$1.createRef()),_defineProperty$1(this,"resultPromise",void 0),_defineProperty$1(this,"handleError",$t=>{const{onError:Ct=NOOP}=this.props;Ct($t,this.containerRef.current),console.warn($t)}),_defineProperty$1(this,"modifyView",$t=>{this.resultPromise&&this.resultPromise.then(Ct=>(Ct&&$t(Ct.view),!0)).catch(this.handleError)})}componentDidMount(){this.createView()}componentDidUpdate($t){const Ct=getUniqueFieldNames([this.props,$t]);if(Ct.delete("className"),Ct.delete("signalListeners"),Ct.delete("spec"),Ct.delete("style"),Ct.delete("width"),Ct.delete("height"),Array.from(Ct).some(kt=>this.props[kt]!==$t[kt]))this.clearView(),this.createView();else{const kt=computeSpecChanges(combineSpecWithDimension(this.props),combineSpecWithDimension($t)),{signalListeners:Mt}=this.props,{signalListeners:Ft}=$t;if(kt)if(kt.isExpensive)this.clearView(),this.createView();else{const jt=!shallowEqual(Mt,Ft);this.modifyView(Bt=>{kt.width!==!1&&Bt.width(kt.width),kt.height!==!1&&Bt.height(kt.height),jt&&(Ft&&removeSignalListenersFromView(Bt,Ft),Mt&&addSignalListenersToView(Bt,Mt)),Bt.run()})}else shallowEqual(Mt,Ft)||this.modifyView(jt=>{Ft&&removeSignalListenersFromView(jt,Ft),Mt&&addSignalListenersToView(jt,Mt),jt.run()})}}componentWillUnmount(){this.clearView()}createView(){const{spec:$t,onNewView:Ct,signalListeners:kt={},width:Mt,height:Ft,...jt}=this.props;if(this.containerRef.current){const Bt=combineSpecWithDimension(this.props);this.resultPromise=embed(this.containerRef.current,Bt,jt).then(Vt=>{if(Vt){const{view:zt}=Vt;addSignalListenersToView(zt,kt)&&zt.run()}return Vt}).catch(this.handleError),Ct&&this.modifyView(Ct)}}clearView(){return this.resultPromise&&this.resultPromise.then($t=>{$t&&$t.finalize()}).catch(this.handleError),this.resultPromise=void 0,this}render(){const{className:$t,style:Ct}=this.props;return React$1.createElement("div",{ref:this.containerRef,className:$t,style:Ct})}}_defineProperty$1(VegaEmbed,"propTypes",{className:_pt.string,onError:_pt.func});function _extends$1(){return _extends$1=Object.assign||function(xt){for(var $t=1;$t<arguments.length;$t++){var Ct=arguments[$t];for(var kt in Ct)Object.prototype.hasOwnProperty.call(Ct,kt)&&(xt[kt]=Ct[kt])}return xt},_extends$1.apply(this,arguments)}function _defineProperty(xt,$t,Ct){return $t in xt?Object.defineProperty(xt,$t,{value:Ct,enumerable:!0,configurable:!0,writable:!0}):xt[$t]=Ct,xt}const EMPTY={};class Vega extends React$1.PureComponent{constructor(){super(...arguments),_defineProperty(this,"vegaEmbed",React$1.createRef()),_defineProperty(this,"handleNewView",$t=>{this.update();const{onNewView:Ct=NOOP}=this.props;Ct($t)})}componentDidMount(){this.update()}componentDidUpdate($t){shallowEqual(this.props.data,$t.data)||this.update()}update(){const{data:$t}=this.props;this.vegaEmbed.current&&$t&&Object.keys($t).length>0&&this.vegaEmbed.current.modifyView(Ct=>{updateMultipleDatasetsInView(Ct,$t),Ct.resize().run()})}render(){const{data:$t,...Ct}=this.props;return React$1.createElement(VegaEmbed,_extends$1({ref:this.vegaEmbed},Ct,{onNewView:this.handleNewView}))}}_defineProperty(Vega,"defaultProps",{data:EMPTY});function _extends(){return _extends=Object.assign||function(xt){for(var $t=1;$t<arguments.length;$t++){var Ct=arguments[$t];for(var kt in Ct)Object.prototype.hasOwnProperty.call(Ct,kt)&&(xt[kt]=Ct[kt])}return xt},_extends.apply(this,arguments)}function VegaLite(xt){return React$1.createElement(Vega,_extends({},xt,{mode:"vega-lite"}))}function isWithinRange(xt,$t){const Ct=Object.values(xt).map(kt=>[kt.startTime,kt.endTime]).flat();return $t[0]===null||$t[1]===null?!1:Math.min(...Ct)>=$t[0].getTime()&&Math.max(...Ct)<=$t[1].getTime()}function SummaryPanel(xt){const{studyId:$t,allParticipants:Ct,config:kt}=xt,Mt=useNavigate(),[Ft,jt]=useResizeObserver$1(),Bt=Ct.filter(Zt=>Zt.completed).map(Zt=>Math.max(...Object.values(Zt.answers).map(sn=>sn.endTime).filter(sn=>sn!==void 0))).filter(Zt=>Number.isFinite(Zt)),[Vt,zt]=reactExports.useState([new Date(new Date(Math.min(...Bt.length>0?Bt:[new Date().getTime()])).setHours(0,0,0,0)),new Date(new Date(Math.max(...Bt.length>0?Bt:[new Date().getTime()])).setHours(24,0,0,0))]),[Ht,Gt,qt,Wt]=reactExports.useMemo(()=>{const Zt=Ct.filter(dn=>!dn.rejected&&dn.completed),sn=Ct.filter(dn=>!dn.rejected&&!dn.completed),ln=Ct.filter(dn=>dn.rejected);return[Zt,sn,ln,Zt.filter(dn=>isWithinRange(dn.answers,Vt))]},[Ct,Vt]),Yt=reactExports.useMemo(()=>{var Zt,sn;return Wt.length>0?[{Date:(Zt=Vt[0])==null?void 0:Zt.getTime(),Participants:0},...Wt.map(ln=>Math.max(...Object.values(ln.answers).map(dn=>dn.endTime).flat())).sort((ln,dn)=>ln-dn).map((ln,dn)=>({Date:ln,Participants:dn})),{Date:(sn=Vt[1])==null?void 0:sn.getTime(),Participants:Wt.length}]:[]},[Wt,Vt]),Kt=reactExports.useMemo(()=>{var Zt,sn;return{width:jt.width-40-8,height:200,mark:{type:"line",interpolate:"step-before"},encoding:{x:{field:"Date",type:"temporal",scale:{domain:[(Zt=Vt[0])==null?void 0:Zt.getTime(),(sn=Vt[1])==null?void 0:sn.getTime()]}},y:{field:"Participants",type:"quantitative"}},data:{values:Yt}}},[jt.width,Vt,Yt]),[Xt,{close:Qt,open:Jt}]=useDisclosure(!1);return jsxRuntimeExports.jsx(Container,{children:jsxRuntimeExports.jsxs(Card,{ref:Ft,padding:"lg",shadow:"md",withBorder:!0,children:[jsxRuntimeExports.jsxs(Flex,{align:"center",mb:"xs",justify:"space-between",children:[jsxRuntimeExports.jsxs(Flex,{direction:"row",align:"center",children:[jsxRuntimeExports.jsx(Title,{order:5,children:$t}),jsxRuntimeExports.jsx(ParticipantStatusBadges,{completed:Ht.length,inProgress:Gt.length,rejected:qt.length,filteredCompleted:Wt.length})]}),jsxRuntimeExports.jsxs(Group$1,{children:[jsxRuntimeExports.jsx(DownloadButtons,{allParticipants:Ct,studyId:$t}),jsxRuntimeExports.jsxs(Popover,{opened:Xt,children:[jsxRuntimeExports.jsx(Popover.Target,{children:jsxRuntimeExports.jsx(Button,{onClick:()=>Mt(`/analysis/stats/${$t}`),onMouseEnter:Jt,onMouseLeave:Qt,px:4,children:jsxRuntimeExports.jsx(IconChartHistogram,{})})}),jsxRuntimeExports.jsx(Popover.Dropdown,{children:jsxRuntimeExports.jsx(Text,{children:"Analyze and manage study data"})})]})]})]}),jsxRuntimeExports.jsx(DatePickerInput,{type:"range",label:"Time Filter",placeholder:"Select a date range",value:Vt,onChange:zt}),Yt.length>0?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Text,{mt:16,children:"Finished Participants"}),jsxRuntimeExports.jsx(VegaLite,{spec:Kt,actions:!1})]}):jsxRuntimeExports.jsx(Box,{h:293.4,children:jsxRuntimeExports.jsx(Center$2,{style:{height:"100%"},children:jsxRuntimeExports.jsx(Text,{children:"Not enough participants for chart"})})})]})})}function SummaryBlock(xt){const{globalConfig:$t}=xt,[Ct,kt]=reactExports.useState(!1),[Mt,Ft]=reactExports.useState({}),[jt,Bt]=reactExports.useState({}),[Vt,zt]=reactExports.useState({}),{storageEngine:Ht}=useStorageEngine(),{user:Gt}=useAuth();reactExports.useEffect(()=>{(async()=>{kt(!0);const Yt={},Kt={},Xt={},Qt=async Zt=>{const sn=await getStudyConfig(Zt,$t);if(Ht){if(Yt[Zt]=await Ht.getAllParticipantsDataByStudy(Zt),sn===null)return;if(Kt[Zt]=sn,Ht instanceof FirebaseStorageEngine){const ln=await Ht.getModes(Zt);Xt[Zt]=ln.analyticsInterfacePubliclyAccessible}}};await(async()=>{const Zt=$t.configsList.map(sn=>Qt(sn));try{await Promise.all(Zt),Ft(Yt),Bt(Kt),zt(Xt)}catch(sn){console.error("Error fetching data:",sn)}finally{kt(!1)}})()})()},[$t,Ht]);const qt=$t.configsList.map(Wt=>Mt[Wt]&&(Vt[Wt]||Gt.isAdmin?jsxRuntimeExports.jsx(Grid.Col,{span:{md:12,xl:6},children:jsxRuntimeExports.jsx(SummaryPanel,{studyId:Wt,allParticipants:Mt[Wt],config:jt[Wt]})},`${Wt}-panel`):null));return jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsx(Title,{mb:20,order:4,children:"Your Studies:"}),jsxRuntimeExports.jsxs(Grid,{children:[qt.length>0?qt:jsxRuntimeExports.jsx(Container,{mt:100,children:jsxRuntimeExports.jsx(Text,{children:"No studies to show. If you believe that this is in error, make sure that you are logged in."})}),jsxRuntimeExports.jsx(LoadingOverlay,{visible:Ct})]})]})}function AnalysisDashboard({globalConfig:xt}){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AppHeader,{studyIds:xt.configsList}),jsxRuntimeExports.jsx(AppShell.Main,{children:jsxRuntimeExports.jsx(Container,{fluid:!0,children:jsxRuntimeExports.jsx(SummaryBlock,{globalConfig:xt})})})]})}function GlobalSettings(){const{user:xt,triggerAuth:$t}=useAuth(),{storageEngine:Ct}=useStorageEngine(),[kt,Mt]=reactExports.useState(!1),[Ft,jt]=reactExports.useState([]),[Bt,Vt]=reactExports.useState(!1),[zt,Ht]=reactExports.useState(!1),[Gt,qt]=reactExports.useState(!1),[Wt,Yt]=reactExports.useState(!1),[Kt,Xt]=reactExports.useState(""),[Qt,Jt]=reactExports.useState(null),Zt=useForm({initialValues:{email:""},validate:{email:isEmail("Invalid email")}});reactExports.useEffect(()=>{(async()=>{if(Vt(!0),Ct instanceof FirebaseStorageEngine){const gn=await(Ct==null?void 0:Ct.getUserManagementData("authentication"));Mt(gn==null?void 0:gn.isEnabled);const En=await(Ct==null?void 0:Ct.getUserManagementData("adminUsers"));En&&En.adminUsersList&&jt(En==null?void 0:En.adminUsersList.map(bn=>bn.email))}else Mt(!1);Vt(!1)})()},[Ct]);const sn=async()=>{if(Vt(!0),Ct instanceof FirebaseStorageEngine){const yn=await signInWithGoogle(Ct,Vt);yn&&yn.email&&Jt({email:yn.email,uid:yn.uid}),Yt(!0)}Vt(!1)},ln=async yn=>{Vt(!0),Ct instanceof FirebaseStorageEngine&&yn&&(await Ct.changeAuth(!0),await Ct.addAdminUser(yn),jt([yn.email]),Mt(!0),$t()),Yt(!1),Vt(!1)},dn=async()=>{if(Vt(!0),Ct instanceof FirebaseStorageEngine){await Ct.addAdminUser({email:Zt.values.email,uid:null});const yn=await Ct.getUserManagementData("adminUsers");jt(yn==null?void 0:yn.adminUsersList.map(gn=>gn.email))}Vt(!1),Ht(!1),Zt.setValues({email:""})},hn=yn=>{qt(!0),Xt(yn)},cn=async()=>{if(Vt(!0),Ct instanceof FirebaseStorageEngine){await Ct.removeAdminUser(Kt);const yn=await Ct.getUserManagementData("adminUsers");jt(yn==null?void 0:yn.adminUsersList.map(gn=>gn.email))}qt(!1),Vt(!1)},pn=reactExports.useMemo(()=>Ct instanceof FirebaseStorageEngine,[Ct]);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Container,{children:jsxRuntimeExports.jsxs(Card,{withBorder:!0,style:{backgroundColor:"#FAFAFA"},children:[jsxRuntimeExports.jsx(Title,{mb:20,order:3,children:"Authentication"}),kt?jsxRuntimeExports.jsx(Flex,{children:jsxRuntimeExports.jsx(Text,{children:"Authentication is enabled."})}):jsxRuntimeExports.jsxs(Flex,{justify:"space-between",children:[jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(Text,{children:"Authentication is currently disabled."})}),jsxRuntimeExports.jsx(Tooltip,{label:"You can only enable auth when using Firebase",disabled:pn,children:jsxRuntimeExports.jsx(Button,{onClick:yn=>pn?sn():yn.preventDefault(),color:"green","data-disabled":pn?void 0:!0,style:{"&[dataDisabled]":{pointerEvents:"all"}},children:"Enable Authentication"})})]}),kt?jsxRuntimeExports.jsxs(Flex,{mt:40,direction:"column",children:[jsxRuntimeExports.jsxs(Flex,{style:{borderBottom:"1px solid #dedede"},direction:"row",justify:"space-between",mb:15,pb:15,children:[jsxRuntimeExports.jsx(Title,{order:6,children:"Enabled Users"}),jsxRuntimeExports.jsx(IconUserPlus,{style:{cursor:"pointer"},onClick:()=>Ht(!0)})]}),Ft.length>0?Ft.map(yn=>{var gn;return jsxRuntimeExports.jsxs(Flex,{justify:"space-between",mb:10,children:[jsxRuntimeExports.jsx(Text,{children:yn}),yn===((gn=xt.user)==null?void 0:gn.email)?jsxRuntimeExports.jsx(Text,{color:"blue",size:"xs",children:"You"}):jsxRuntimeExports.jsx(ActionIcon,{variant:"subtle",onClick:()=>hn(yn),children:jsxRuntimeExports.jsx(IconTrashX,{color:"red"})})]},yn)}):null]}):null]})}),jsxRuntimeExports.jsx(Modal,{opened:zt,onClose:()=>Ht(!1),title:"Add Admin User",children:jsxRuntimeExports.jsxs(Box,{component:"form",onSubmit:Zt.onSubmit(()=>dn()),children:[jsxRuntimeExports.jsx(TextInput,{leftSection:jsxRuntimeExports.jsx(IconAt,{}),placeholder:"User Gmail Account",...Zt.getInputProps("email")}),jsxRuntimeExports.jsxs(Flex,{mt:30,justify:"right",children:[jsxRuntimeExports.jsx(Button,{mr:5,variant:"subtle",color:"red",onClick:()=>Ht(!1),children:"Cancel"}),jsxRuntimeExports.jsx(Button,{type:"submit",children:"Save"})]})]})}),jsxRuntimeExports.jsxs(Modal,{opened:Gt,size:"large",onClose:()=>qt(!1),title:jsxRuntimeExports.jsxs(Text,{fw:700,children:["Remove",Kt,"?"]}),children:[jsxRuntimeExports.jsxs(Text,{mt:40,children:["Are you sure you want to remove",jsxRuntimeExports.jsx("b",{children:Kt})," ","as an administrator?"]}),jsxRuntimeExports.jsxs(Flex,{mt:40,justify:"right",children:[jsxRuntimeExports.jsx(Button,{mr:5,variant:"subtle",color:"red",onClick:()=>qt(!1),children:"Cancel"}),jsxRuntimeExports.jsx(Button,{onClick:()=>cn(),children:"Yes, I'm sure."})]})]}),jsxRuntimeExports.jsxs(Modal,{opened:Wt,size:"md",onClose:()=>qt(!1),title:jsxRuntimeExports.jsx(Text,{fw:700,children:"Enable Authentication?"}),children:[jsxRuntimeExports.jsxs(Text,{mt:40,children:["User"," ",jsxRuntimeExports.jsx("b",{children:Qt==null?void 0:Qt.email})," ","will be added as an administrator to this application. After enabling authentication, you'll be able to add additional users below. This action cannot be undone."]}),jsxRuntimeExports.jsxs(Flex,{mt:40,justify:"right",children:[jsxRuntimeExports.jsx(Button,{mr:5,variant:"subtle",color:"red",onClick:()=>Yt(!1),children:"Cancel"}),jsxRuntimeExports.jsx(Button,{onClick:()=>ln(Qt),children:"Yes, I'm sure."})]})]}),jsxRuntimeExports.jsx(LoadingOverlay,{visible:Bt})]})}class LocalStorageEngine extends StorageEngine{constructor(){super("localStorage");so(this,"studyDatabase");so(this,"studyId")}async connect(){this.connected=!0}async initializeStudyDb(Ct,kt){this.studyId=Ct,this.studyDatabase=await localforage.createInstance({name:Ct});const Mt=await this.getCurrentConfigHash(),Ft=await hash$1(JSON.stringify(kt));Mt&&Mt!==Ft&&(await this.studyDatabase.removeItem("sequenceArray"),await this.clearCurrentParticipantId()),this.studyDatabase.setItem("currentConfigHash",Ft);const jt=await this.studyDatabase.getItem("configs");await this.studyDatabase.setItem("configs",{...jt,[Ft]:kt})}async initializeParticipantSession(Ct,kt,Mt,Ft,jt){var Gt;if(!this._verifyStudyDatabase(this.studyDatabase))throw new Error("Study database not initialized");if(await this.getCurrentParticipantId(jt),!this.currentParticipantId)throw new Error("Participant not initialized");const Bt=await this.studyDatabase.getItem(this.currentParticipantId);if(Bt)return Bt;const Vt=await this.getModes(Ct),zt=await hash$1(JSON.stringify(Mt)),Ht={participantId:this.currentParticipantId,participantConfigHash:zt,sequence:await this.getSequence(),answers:{},searchParams:kt,metadata:Ft,completed:!1,rejected:!1};return Vt.dataCollectionEnabled&&await((Gt=this.studyDatabase)==null?void 0:Gt.setItem(this.currentParticipantId,Ht)),Ht}async getCurrentConfigHash(){if(!this._verifyStudyDatabase(this.studyDatabase))throw new Error("Study database not initialized");return await this.studyDatabase.getItem("currentConfigHash")}async getAllConfigsFromHash(Ct,kt){return await localforage.createInstance({name:kt}).getItem("configs")||{}}async getCurrentParticipantId(Ct){if(!this._verifyStudyDatabase(this.studyDatabase))throw new Error("Study database not initialized");const kt=await this.studyDatabase.getItem("currentParticipant");if(Ct)return this.currentParticipantId=Ct,await this.studyDatabase.setItem("currentParticipant",Ct),Ct;if(kt)return this.currentParticipantId=kt,kt;const Mt=v4();return await this.studyDatabase.setItem("currentParticipant",Mt),this.currentParticipantId=Mt,Mt}async clearCurrentParticipantId(){if(!this._verifyStudyDatabase(this.studyDatabase))throw new Error("Study database not initialized");await this.studyDatabase.removeItem("currentParticipant")}async saveAnswers(Ct){if(!this._verifyStudyDatabase(this.studyDatabase))throw new Error("Study database not initialized");if(!this.currentParticipantId)throw new Error("Participant not initialized");const kt=await this.studyDatabase.getItem(this.currentParticipantId);if(!kt)throw new Error("Participant not initialized");kt.answers=Ct,await this.studyDatabase.setItem(this.currentParticipantId,kt)}async setSequenceArray(Ct){if(!this._verifyStudyDatabase(this.studyDatabase))throw new Error("Study database not initialized");this.studyDatabase.setItem("sequenceArray",Ct)}async getSequence(){if(!this._verifyStudyDatabase(this.studyDatabase))throw new Error("Study database not initialized");const Ct=await this.studyDatabase.getItem("sequenceArray");if(!Ct)throw new Error("Latin square not initialized");if(!this.studyId)throw new Error("Study ID not initialized");const kt=await this.getModes(this.studyId),Mt=kt.dataCollectionEnabled?Ct.pop():Ct[Math.floor(Math.random()*Ct.length-1)];if(!Mt)throw new Error("Latin square is empty");return kt.dataCollectionEnabled&&await this.studyDatabase.setItem("sequenceArray",Ct),Mt}async getSequenceArray(){if(!this._verifyStudyDatabase(this.studyDatabase))throw new Error("Study database not initialized");return await this.studyDatabase.getItem("sequenceArray")}async getAllParticipantsData(){if(!this._verifyStudyDatabase(this.studyDatabase))throw new Error("Study database not initialized");const Ct=[];return await this.studyDatabase.iterate((kt,Mt)=>{Mt!=="config"&&Mt!=="currentParticipant"&&Mt!=="sequenceArray"&&Mt!=="configs"&&Mt!=="currentConfigHash"&&Mt!=="modes"&&Ct.push(kt)}),Ct}async getAllParticipantsDataByStudy(Ct){const kt=localforage.createInstance({name:Ct}),Mt=[];return await kt.iterate((Ft,jt)=>{jt!=="config"&&jt!=="currentParticipant"&&jt!=="sequenceArray"&&jt!=="configs"&&jt!=="currentConfigHash"&&jt!=="modes"&&Mt.push(Ft)}),Mt}async getParticipantData(){if(!this._verifyStudyDatabase(this.studyDatabase))throw new Error("Study database not initialized");const Ct=await this.studyDatabase.getItem("currentParticipant");return Ct?await this.studyDatabase.getItem(Ct):null}async nextParticipant(){if(!this._verifyStudyDatabase(this.studyDatabase))throw new Error("Study database not initialized");const Ct=v4();this.studyDatabase.setItem("currentParticipant",Ct)}async verifyCompletion(){if(!this._verifyStudyDatabase(this.studyDatabase))throw new Error("Study database not initialized");const Ct=await this.getParticipantData();if(!Ct)throw new Error("Participant not initialized");return Ct.completed=!0,await this.studyDatabase.setItem(this.currentParticipantId,Ct),!0}async validateUser(Ct){return!0}async rejectParticipant(Ct,kt){if(!this._verifyStudyDatabase(this.studyDatabase))throw new Error("Study database not initialized");const Mt=await this.studyDatabase.getItem(kt);if(!Mt)throw new Error("Participant not found");if(Mt.rejected)return;Mt.rejected=!0;const Ft=await this.studyDatabase.getItem("sequenceArray");Ft&&(Ft.unshift(Mt.sequence),this.setSequenceArray(Ft)),await this.studyDatabase.setItem(kt,Mt)}async setMode(Ct,kt,Mt){this.studyDatabase=await localforage.createInstance({name:Ct});const Ft=await this.studyDatabase.getItem("modes");if(!Ft)throw new Error("Modes not initialized");Ft[kt]=Mt,this.studyDatabase.setItem("modes",Ft)}async getModes(Ct){this.studyDatabase=await localforage.createInstance({name:Ct});const kt=await this.studyDatabase.getItem("modes");if(kt)return kt;const Mt={dataCollectionEnabled:!0,studyNavigatorEnabled:!0,analyticsInterfacePubliclyAccessible:!0};return this.studyDatabase.setItem("modes",Mt),Mt}_verifyStudyDatabase(Ct){return Ct!==void 0}}async function initializeStorageEngine(){let xt,$t=!1;{const Ct=new FirebaseStorageEngine;await Ct.connect(),Ct.isConnected()?xt=Ct:$t=!0}if($t){const Ct=new LocalStorageEngine;await Ct.connect(),xt=Ct}return xt}async function fetchGlobalConfigArray(){const $t=await(await fetch(`${PREFIX$1}global.json`)).text();return parseGlobalConfig($t)}function GlobalConfigParser(){const[xt,$t]=reactExports.useState(null),[Ct,kt]=reactExports.useState({});reactExports.useEffect(()=>{async function Bt(){xt&&kt(await fetchStudyConfigs(xt))}Bt()},[xt]),reactExports.useEffect(()=>{xt||fetchGlobalConfigArray().then(Bt=>{$t(Bt)})},[xt]);const{storageEngine:Mt,setStorageEngine:Ft}=useStorageEngine();reactExports.useEffect(()=>{if(Mt!==void 0)return;async function Bt(){const Vt=await initializeStorageEngine();Ft(Vt)}Bt()},[Ft,Mt]);const jt=async Bt=>Mt instanceof FirebaseStorageEngine?!(await Mt.getModes(Bt)).analyticsInterfacePubliclyAccessible:!1;return xt?jsxRuntimeExports.jsx(BrowserRouter,{basename:PREFIX$1,children:jsxRuntimeExports.jsx(AuthProvider,{children:jsxRuntimeExports.jsx(ModalsProvider,{children:jsxRuntimeExports.jsx(AppShell,{padding:"md",header:{height:70},children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AppHeader,{studyIds:xt.configsList}),jsxRuntimeExports.jsx(ConfigSwitcher,{globalConfig:xt,studyConfigs:Ct})]})}),jsxRuntimeExports.jsx(Route,{path:"/:studyId/*",element:jsxRuntimeExports.jsx(Shell,{globalConfig:xt})}),jsxRuntimeExports.jsx(Route,{path:"/analysis/dashboard",element:jsxRuntimeExports.jsx(AnalysisDashboard,{globalConfig:xt})}),jsxRuntimeExports.jsx(Route,{path:"/analysis",element:jsxRuntimeExports.jsx(NavigateWithParams,{to:"/analysis/dashboard"})}),jsxRuntimeExports.jsx(Route,{path:"/analysis/stats/:studyId/:tab",element:jsxRuntimeExports.jsx(ProtectedRoute,{paramToCheck:"studyId",paramCallback:jt,children:jsxRuntimeExports.jsx(AnalysisInterface,{globalConfig:xt})})}),jsxRuntimeExports.jsx(Route,{path:"/analysis/stats/:studyId",element:jsxRuntimeExports.jsx(NavigateWithParams,{to:"./table",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:"/settings",element:jsxRuntimeExports.jsxs(ProtectedRoute,{children:[jsxRuntimeExports.jsx(AppHeader,{studyIds:xt.configsList}),jsxRuntimeExports.jsx(AppShell.Main,{children:jsxRuntimeExports.jsx(GlobalSettings,{})})]})}),jsxRuntimeExports.jsx(Route,{path:"/login",element:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AppHeader,{studyIds:xt.configsList}),jsxRuntimeExports.jsx(AppShell.Main,{children:jsxRuntimeExports.jsx(Login,{})})]})})]})})})})}):null}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React$1.StrictMode,{children:jsxRuntimeExports.jsx(StorageEngineProvider,{children:jsxRuntimeExports.jsx(MantineProvider,{children:jsxRuntimeExports.jsx(GlobalConfigParser,{})})})}))});export default Jp();
